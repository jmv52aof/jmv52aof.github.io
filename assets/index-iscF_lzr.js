function hN(e,t){for(var a=0;a<t.length;a++){const o=t[a];if(typeof o!="string"&&!Array.isArray(o)){for(const h in o)if(h!=="default"&&!(h in e)){const y=Object.getOwnPropertyDescriptor(o,h);y&&Object.defineProperty(e,h,y.get?y:{enumerable:!0,get:()=>o[h]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const h of document.querySelectorAll('link[rel="modulepreload"]'))o(h);new MutationObserver(h=>{for(const y of h)if(y.type==="childList")for(const b of y.addedNodes)b.tagName==="LINK"&&b.rel==="modulepreload"&&o(b)}).observe(document,{childList:!0,subtree:!0});function a(h){const y={};return h.integrity&&(y.integrity=h.integrity),h.referrerPolicy&&(y.referrerPolicy=h.referrerPolicy),h.crossOrigin==="use-credentials"?y.credentials="include":h.crossOrigin==="anonymous"?y.credentials="omit":y.credentials="same-origin",y}function o(h){if(h.ep)return;h.ep=!0;const y=a(h);fetch(h.href,y)}})();var Nx=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ei(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var cT={exports:{}},Ov={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var l6;function gH(){if(l6)return Ov;l6=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function a(o,h,y){var b=null;if(y!==void 0&&(b=""+y),h.key!==void 0&&(b=""+h.key),"key"in h){y={};for(var i in h)i!=="key"&&(y[i]=h[i])}else y=h;return h=y.ref,{$$typeof:e,type:o,key:b,ref:h!==void 0?h:null,props:y}}return Ov.Fragment=t,Ov.jsx=a,Ov.jsxs=a,Ov}var c6;function yH(){return c6||(c6=1,cT.exports=gH()),cT.exports}var ve=yH(),uT={exports:{}},kr={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var u6;function vH(){if(u6)return kr;u6=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),h=Symbol.for("react.profiler"),y=Symbol.for("react.consumer"),b=Symbol.for("react.context"),i=Symbol.for("react.forward_ref"),C=Symbol.for("react.suspense"),I=Symbol.for("react.memo"),j=Symbol.for("react.lazy"),F=Symbol.iterator;function G(et){return et===null||typeof et!="object"?null:(et=F&&et[F]||et["@@iterator"],typeof et=="function"?et:null)}var X={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Y=Object.assign,J={};function ee(et,$t,rn){this.props=et,this.context=$t,this.refs=J,this.updater=rn||X}ee.prototype.isReactComponent={},ee.prototype.setState=function(et,$t){if(typeof et!="object"&&typeof et!="function"&&et!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,et,$t,"setState")},ee.prototype.forceUpdate=function(et){this.updater.enqueueForceUpdate(this,et,"forceUpdate")};function oe(){}oe.prototype=ee.prototype;function ge(et,$t,rn){this.props=et,this.context=$t,this.refs=J,this.updater=rn||X}var fe=ge.prototype=new oe;fe.constructor=ge,Y(fe,ee.prototype),fe.isPureReactComponent=!0;var xe=Array.isArray,ae={H:null,A:null,T:null,S:null},me=Object.prototype.hasOwnProperty;function we(et,$t,rn,Nt,xn,rr){return rn=rr.ref,{$$typeof:e,type:et,key:$t,ref:rn!==void 0?rn:null,props:rr}}function Ge(et,$t){return we(et.type,$t,void 0,void 0,void 0,et.props)}function He(et){return typeof et=="object"&&et!==null&&et.$$typeof===e}function ye(et){var $t={"=":"=0",":":"=2"};return"$"+et.replace(/[=:]/g,function(rn){return $t[rn]})}var ke=/\/+/g;function dt(et,$t){return typeof et=="object"&&et!==null&&et.key!=null?ye(""+et.key):$t.toString(36)}function vt(){}function jt(et){switch(et.status){case"fulfilled":return et.value;case"rejected":throw et.reason;default:switch(typeof et.status=="string"?et.then(vt,vt):(et.status="pending",et.then(function($t){et.status==="pending"&&(et.status="fulfilled",et.value=$t)},function($t){et.status==="pending"&&(et.status="rejected",et.reason=$t)})),et.status){case"fulfilled":return et.value;case"rejected":throw et.reason}}throw et}function _t(et,$t,rn,Nt,xn){var rr=typeof et;(rr==="undefined"||rr==="boolean")&&(et=null);var Xn=!1;if(et===null)Xn=!0;else switch(rr){case"bigint":case"string":case"number":Xn=!0;break;case"object":switch(et.$$typeof){case e:case t:Xn=!0;break;case j:return Xn=et._init,_t(Xn(et._payload),$t,rn,Nt,xn)}}if(Xn)return xn=xn(et),Xn=Nt===""?"."+dt(et,0):Nt,xe(xn)?(rn="",Xn!=null&&(rn=Xn.replace(ke,"$&/")+"/"),_t(xn,$t,rn,"",function(yn){return yn})):xn!=null&&(He(xn)&&(xn=Ge(xn,rn+(xn.key==null||et&&et.key===xn.key?"":(""+xn.key).replace(ke,"$&/")+"/")+Xn)),$t.push(xn)),1;Xn=0;var yi=Nt===""?".":Nt+":";if(xe(et))for(var ir=0;ir<et.length;ir++)Nt=et[ir],rr=yi+dt(Nt,ir),Xn+=_t(Nt,$t,rn,rr,xn);else if(ir=G(et),typeof ir=="function")for(et=ir.call(et),ir=0;!(Nt=et.next()).done;)Nt=Nt.value,rr=yi+dt(Nt,ir++),Xn+=_t(Nt,$t,rn,rr,xn);else if(rr==="object"){if(typeof et.then=="function")return _t(jt(et),$t,rn,Nt,xn);throw $t=String(et),Error("Objects are not valid as a React child (found: "+($t==="[object Object]"?"object with keys {"+Object.keys(et).join(", ")+"}":$t)+"). If you meant to render a collection of children, use an array instead.")}return Xn}function gt(et,$t,rn){if(et==null)return et;var Nt=[],xn=0;return _t(et,Nt,"","",function(rr){return $t.call(rn,rr,xn++)}),Nt}function Vt(et){if(et._status===-1){var $t=et._result;$t=$t(),$t.then(function(rn){(et._status===0||et._status===-1)&&(et._status=1,et._result=rn)},function(rn){(et._status===0||et._status===-1)&&(et._status=2,et._result=rn)}),et._status===-1&&(et._status=0,et._result=$t)}if(et._status===1)return et._result.default;throw et._result}var Ht=typeof reportError=="function"?reportError:function(et){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var $t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof et=="object"&&et!==null&&typeof et.message=="string"?String(et.message):String(et),error:et});if(!window.dispatchEvent($t))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",et);return}console.error(et)};function Bt(){}return kr.Children={map:gt,forEach:function(et,$t,rn){gt(et,function(){$t.apply(this,arguments)},rn)},count:function(et){var $t=0;return gt(et,function(){$t++}),$t},toArray:function(et){return gt(et,function($t){return $t})||[]},only:function(et){if(!He(et))throw Error("React.Children.only expected to receive a single React element child.");return et}},kr.Component=ee,kr.Fragment=a,kr.Profiler=h,kr.PureComponent=ge,kr.StrictMode=o,kr.Suspense=C,kr.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=ae,kr.act=function(){throw Error("act(...) is not supported in production builds of React.")},kr.cache=function(et){return function(){return et.apply(null,arguments)}},kr.cloneElement=function(et,$t,rn){if(et==null)throw Error("The argument must be a React element, but you passed "+et+".");var Nt=Y({},et.props),xn=et.key,rr=void 0;if($t!=null)for(Xn in $t.ref!==void 0&&(rr=void 0),$t.key!==void 0&&(xn=""+$t.key),$t)!me.call($t,Xn)||Xn==="key"||Xn==="__self"||Xn==="__source"||Xn==="ref"&&$t.ref===void 0||(Nt[Xn]=$t[Xn]);var Xn=arguments.length-2;if(Xn===1)Nt.children=rn;else if(1<Xn){for(var yi=Array(Xn),ir=0;ir<Xn;ir++)yi[ir]=arguments[ir+2];Nt.children=yi}return we(et.type,xn,void 0,void 0,rr,Nt)},kr.createContext=function(et){return et={$$typeof:b,_currentValue:et,_currentValue2:et,_threadCount:0,Provider:null,Consumer:null},et.Provider=et,et.Consumer={$$typeof:y,_context:et},et},kr.createElement=function(et,$t,rn){var Nt,xn={},rr=null;if($t!=null)for(Nt in $t.key!==void 0&&(rr=""+$t.key),$t)me.call($t,Nt)&&Nt!=="key"&&Nt!=="__self"&&Nt!=="__source"&&(xn[Nt]=$t[Nt]);var Xn=arguments.length-2;if(Xn===1)xn.children=rn;else if(1<Xn){for(var yi=Array(Xn),ir=0;ir<Xn;ir++)yi[ir]=arguments[ir+2];xn.children=yi}if(et&&et.defaultProps)for(Nt in Xn=et.defaultProps,Xn)xn[Nt]===void 0&&(xn[Nt]=Xn[Nt]);return we(et,rr,void 0,void 0,null,xn)},kr.createRef=function(){return{current:null}},kr.forwardRef=function(et){return{$$typeof:i,render:et}},kr.isValidElement=He,kr.lazy=function(et){return{$$typeof:j,_payload:{_status:-1,_result:et},_init:Vt}},kr.memo=function(et,$t){return{$$typeof:I,type:et,compare:$t===void 0?null:$t}},kr.startTransition=function(et){var $t=ae.T,rn={};ae.T=rn;try{var Nt=et(),xn=ae.S;xn!==null&&xn(rn,Nt),typeof Nt=="object"&&Nt!==null&&typeof Nt.then=="function"&&Nt.then(Bt,Ht)}catch(rr){Ht(rr)}finally{ae.T=$t}},kr.unstable_useCacheRefresh=function(){return ae.H.useCacheRefresh()},kr.use=function(et){return ae.H.use(et)},kr.useActionState=function(et,$t,rn){return ae.H.useActionState(et,$t,rn)},kr.useCallback=function(et,$t){return ae.H.useCallback(et,$t)},kr.useContext=function(et){return ae.H.useContext(et)},kr.useDebugValue=function(){},kr.useDeferredValue=function(et,$t){return ae.H.useDeferredValue(et,$t)},kr.useEffect=function(et,$t){return ae.H.useEffect(et,$t)},kr.useId=function(){return ae.H.useId()},kr.useImperativeHandle=function(et,$t,rn){return ae.H.useImperativeHandle(et,$t,rn)},kr.useInsertionEffect=function(et,$t){return ae.H.useInsertionEffect(et,$t)},kr.useLayoutEffect=function(et,$t){return ae.H.useLayoutEffect(et,$t)},kr.useMemo=function(et,$t){return ae.H.useMemo(et,$t)},kr.useOptimistic=function(et,$t){return ae.H.useOptimistic(et,$t)},kr.useReducer=function(et,$t,rn){return ae.H.useReducer(et,$t,rn)},kr.useRef=function(et){return ae.H.useRef(et)},kr.useState=function(et){return ae.H.useState(et)},kr.useSyncExternalStore=function(et,$t,rn){return ae.H.useSyncExternalStore(et,$t,rn)},kr.useTransition=function(){return ae.H.useTransition()},kr.version="19.0.0",kr}var h6;function Kd(){return h6||(h6=1,uT.exports=vH()),uT.exports}var Ie=Kd();const Ot=Ei(Ie),f6=hN({__proto__:null,default:Ot},[Ie]);var hT={exports:{}},Pv={},fT={exports:{}},dT={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var d6;function xH(){return d6||(d6=1,function(e){function t(gt,Vt){var Ht=gt.length;gt.push(Vt);e:for(;0<Ht;){var Bt=Ht-1>>>1,et=gt[Bt];if(0<h(et,Vt))gt[Bt]=Vt,gt[Ht]=et,Ht=Bt;else break e}}function a(gt){return gt.length===0?null:gt[0]}function o(gt){if(gt.length===0)return null;var Vt=gt[0],Ht=gt.pop();if(Ht!==Vt){gt[0]=Ht;e:for(var Bt=0,et=gt.length,$t=et>>>1;Bt<$t;){var rn=2*(Bt+1)-1,Nt=gt[rn],xn=rn+1,rr=gt[xn];if(0>h(Nt,Ht))xn<et&&0>h(rr,Nt)?(gt[Bt]=rr,gt[xn]=Ht,Bt=xn):(gt[Bt]=Nt,gt[rn]=Ht,Bt=rn);else if(xn<et&&0>h(rr,Ht))gt[Bt]=rr,gt[xn]=Ht,Bt=xn;else break e}}return Vt}function h(gt,Vt){var Ht=gt.sortIndex-Vt.sortIndex;return Ht!==0?Ht:gt.id-Vt.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var y=performance;e.unstable_now=function(){return y.now()}}else{var b=Date,i=b.now();e.unstable_now=function(){return b.now()-i}}var C=[],I=[],j=1,F=null,G=3,X=!1,Y=!1,J=!1,ee=typeof setTimeout=="function"?setTimeout:null,oe=typeof clearTimeout=="function"?clearTimeout:null,ge=typeof setImmediate<"u"?setImmediate:null;function fe(gt){for(var Vt=a(I);Vt!==null;){if(Vt.callback===null)o(I);else if(Vt.startTime<=gt)o(I),Vt.sortIndex=Vt.expirationTime,t(C,Vt);else break;Vt=a(I)}}function xe(gt){if(J=!1,fe(gt),!Y)if(a(C)!==null)Y=!0,jt();else{var Vt=a(I);Vt!==null&&_t(xe,Vt.startTime-gt)}}var ae=!1,me=-1,we=5,Ge=-1;function He(){return!(e.unstable_now()-Ge<we)}function ye(){if(ae){var gt=e.unstable_now();Ge=gt;var Vt=!0;try{e:{Y=!1,J&&(J=!1,oe(me),me=-1),X=!0;var Ht=G;try{t:{for(fe(gt),F=a(C);F!==null&&!(F.expirationTime>gt&&He());){var Bt=F.callback;if(typeof Bt=="function"){F.callback=null,G=F.priorityLevel;var et=Bt(F.expirationTime<=gt);if(gt=e.unstable_now(),typeof et=="function"){F.callback=et,fe(gt),Vt=!0;break t}F===a(C)&&o(C),fe(gt)}else o(C);F=a(C)}if(F!==null)Vt=!0;else{var $t=a(I);$t!==null&&_t(xe,$t.startTime-gt),Vt=!1}}break e}finally{F=null,G=Ht,X=!1}Vt=void 0}}finally{Vt?ke():ae=!1}}}var ke;if(typeof ge=="function")ke=function(){ge(ye)};else if(typeof MessageChannel<"u"){var dt=new MessageChannel,vt=dt.port2;dt.port1.onmessage=ye,ke=function(){vt.postMessage(null)}}else ke=function(){ee(ye,0)};function jt(){ae||(ae=!0,ke())}function _t(gt,Vt){me=ee(function(){gt(e.unstable_now())},Vt)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(gt){gt.callback=null},e.unstable_continueExecution=function(){Y||X||(Y=!0,jt())},e.unstable_forceFrameRate=function(gt){0>gt||125<gt?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):we=0<gt?Math.floor(1e3/gt):5},e.unstable_getCurrentPriorityLevel=function(){return G},e.unstable_getFirstCallbackNode=function(){return a(C)},e.unstable_next=function(gt){switch(G){case 1:case 2:case 3:var Vt=3;break;default:Vt=G}var Ht=G;G=Vt;try{return gt()}finally{G=Ht}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(gt,Vt){switch(gt){case 1:case 2:case 3:case 4:case 5:break;default:gt=3}var Ht=G;G=gt;try{return Vt()}finally{G=Ht}},e.unstable_scheduleCallback=function(gt,Vt,Ht){var Bt=e.unstable_now();switch(typeof Ht=="object"&&Ht!==null?(Ht=Ht.delay,Ht=typeof Ht=="number"&&0<Ht?Bt+Ht:Bt):Ht=Bt,gt){case 1:var et=-1;break;case 2:et=250;break;case 5:et=1073741823;break;case 4:et=1e4;break;default:et=5e3}return et=Ht+et,gt={id:j++,callback:Vt,priorityLevel:gt,startTime:Ht,expirationTime:et,sortIndex:-1},Ht>Bt?(gt.sortIndex=Ht,t(I,gt),a(C)===null&&gt===a(I)&&(J?(oe(me),me=-1):J=!0,_t(xe,Ht-Bt))):(gt.sortIndex=et,t(C,gt),Y||X||(Y=!0,jt())),gt},e.unstable_shouldYield=He,e.unstable_wrapCallback=function(gt){var Vt=G;return function(){var Ht=G;G=Vt;try{return gt.apply(this,arguments)}finally{G=Ht}}}}(dT)),dT}var p6;function bH(){return p6||(p6=1,fT.exports=xH()),fT.exports}var pT={exports:{}},As={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var m6;function wH(){if(m6)return As;m6=1;var e=Kd();function t(C){var I="https://react.dev/errors/"+C;if(1<arguments.length){I+="?args[]="+encodeURIComponent(arguments[1]);for(var j=2;j<arguments.length;j++)I+="&args[]="+encodeURIComponent(arguments[j])}return"Minified React error #"+C+"; visit "+I+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(){}var o={d:{f:a,r:function(){throw Error(t(522))},D:a,C:a,L:a,m:a,X:a,S:a,M:a},p:0,findDOMNode:null},h=Symbol.for("react.portal");function y(C,I,j){var F=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:h,key:F==null?null:""+F,children:C,containerInfo:I,implementation:j}}var b=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function i(C,I){if(C==="font")return"";if(typeof I=="string")return I==="use-credentials"?I:""}return As.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=o,As.createPortal=function(C,I){var j=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!I||I.nodeType!==1&&I.nodeType!==9&&I.nodeType!==11)throw Error(t(299));return y(C,I,null,j)},As.flushSync=function(C){var I=b.T,j=o.p;try{if(b.T=null,o.p=2,C)return C()}finally{b.T=I,o.p=j,o.d.f()}},As.preconnect=function(C,I){typeof C=="string"&&(I?(I=I.crossOrigin,I=typeof I=="string"?I==="use-credentials"?I:"":void 0):I=null,o.d.C(C,I))},As.prefetchDNS=function(C){typeof C=="string"&&o.d.D(C)},As.preinit=function(C,I){if(typeof C=="string"&&I&&typeof I.as=="string"){var j=I.as,F=i(j,I.crossOrigin),G=typeof I.integrity=="string"?I.integrity:void 0,X=typeof I.fetchPriority=="string"?I.fetchPriority:void 0;j==="style"?o.d.S(C,typeof I.precedence=="string"?I.precedence:void 0,{crossOrigin:F,integrity:G,fetchPriority:X}):j==="script"&&o.d.X(C,{crossOrigin:F,integrity:G,fetchPriority:X,nonce:typeof I.nonce=="string"?I.nonce:void 0})}},As.preinitModule=function(C,I){if(typeof C=="string")if(typeof I=="object"&&I!==null){if(I.as==null||I.as==="script"){var j=i(I.as,I.crossOrigin);o.d.M(C,{crossOrigin:j,integrity:typeof I.integrity=="string"?I.integrity:void 0,nonce:typeof I.nonce=="string"?I.nonce:void 0})}}else I==null&&o.d.M(C)},As.preload=function(C,I){if(typeof C=="string"&&typeof I=="object"&&I!==null&&typeof I.as=="string"){var j=I.as,F=i(j,I.crossOrigin);o.d.L(C,j,{crossOrigin:F,integrity:typeof I.integrity=="string"?I.integrity:void 0,nonce:typeof I.nonce=="string"?I.nonce:void 0,type:typeof I.type=="string"?I.type:void 0,fetchPriority:typeof I.fetchPriority=="string"?I.fetchPriority:void 0,referrerPolicy:typeof I.referrerPolicy=="string"?I.referrerPolicy:void 0,imageSrcSet:typeof I.imageSrcSet=="string"?I.imageSrcSet:void 0,imageSizes:typeof I.imageSizes=="string"?I.imageSizes:void 0,media:typeof I.media=="string"?I.media:void 0})}},As.preloadModule=function(C,I){if(typeof C=="string")if(I){var j=i(I.as,I.crossOrigin);o.d.m(C,{as:typeof I.as=="string"&&I.as!=="script"?I.as:void 0,crossOrigin:j,integrity:typeof I.integrity=="string"?I.integrity:void 0})}else o.d.m(C)},As.requestFormReset=function(C){o.d.r(C)},As.unstable_batchedUpdates=function(C,I){return C(I)},As.useFormState=function(C,I,j){return b.H.useFormState(C,I,j)},As.useFormStatus=function(){return b.H.useHostTransitionStatus()},As.version="19.0.0",As}var _6;function fN(){if(_6)return pT.exports;_6=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),pT.exports=wH(),pT.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var g6;function SH(){if(g6)return Pv;g6=1;var e=bH(),t=Kd(),a=fN();function o(f){var g="https://react.dev/errors/"+f;if(1<arguments.length){g+="?args[]="+encodeURIComponent(arguments[1]);for(var T=2;T<arguments.length;T++)g+="&args[]="+encodeURIComponent(arguments[T])}return"Minified React error #"+f+"; visit "+g+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function h(f){return!(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)}var y=Symbol.for("react.element"),b=Symbol.for("react.transitional.element"),i=Symbol.for("react.portal"),C=Symbol.for("react.fragment"),I=Symbol.for("react.strict_mode"),j=Symbol.for("react.profiler"),F=Symbol.for("react.provider"),G=Symbol.for("react.consumer"),X=Symbol.for("react.context"),Y=Symbol.for("react.forward_ref"),J=Symbol.for("react.suspense"),ee=Symbol.for("react.suspense_list"),oe=Symbol.for("react.memo"),ge=Symbol.for("react.lazy"),fe=Symbol.for("react.offscreen"),xe=Symbol.for("react.memo_cache_sentinel"),ae=Symbol.iterator;function me(f){return f===null||typeof f!="object"?null:(f=ae&&f[ae]||f["@@iterator"],typeof f=="function"?f:null)}var we=Symbol.for("react.client.reference");function Ge(f){if(f==null)return null;if(typeof f=="function")return f.$$typeof===we?null:f.displayName||f.name||null;if(typeof f=="string")return f;switch(f){case C:return"Fragment";case i:return"Portal";case j:return"Profiler";case I:return"StrictMode";case J:return"Suspense";case ee:return"SuspenseList"}if(typeof f=="object")switch(f.$$typeof){case X:return(f.displayName||"Context")+".Provider";case G:return(f._context.displayName||"Context")+".Consumer";case Y:var g=f.render;return f=f.displayName,f||(f=g.displayName||g.name||"",f=f!==""?"ForwardRef("+f+")":"ForwardRef"),f;case oe:return g=f.displayName||null,g!==null?g:Ge(f.type)||"Memo";case ge:g=f._payload,f=f._init;try{return Ge(f(g))}catch{}}return null}var He=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ye=Object.assign,ke,dt;function vt(f){if(ke===void 0)try{throw Error()}catch(T){var g=T.stack.trim().match(/\n( *(at )?)/);ke=g&&g[1]||"",dt=-1<T.stack.indexOf(`
    at`)?" (<anonymous>)":-1<T.stack.indexOf("@")?"@unknown:0:0":""}return`
`+ke+f+dt}var jt=!1;function _t(f,g){if(!f||jt)return"";jt=!0;var T=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var k={DetermineComponentFrameRoot:function(){try{if(g){var mn=function(){throw Error()};if(Object.defineProperty(mn.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(mn,[])}catch(Qt){var Ft=Qt}Reflect.construct(f,[],mn)}else{try{mn.call()}catch(Qt){Ft=Qt}f.call(mn.prototype)}}else{try{throw Error()}catch(Qt){Ft=Qt}(mn=f())&&typeof mn.catch=="function"&&mn.catch(function(){})}}catch(Qt){if(Qt&&Ft&&typeof Qt.stack=="string")return[Qt.stack,Ft.stack]}return[null,null]}};k.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var V=Object.getOwnPropertyDescriptor(k.DetermineComponentFrameRoot,"name");V&&V.configurable&&Object.defineProperty(k.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var Q=k.DetermineComponentFrameRoot(),be=Q[0],Be=Q[1];if(be&&Be){var rt=be.split(`
`),Tt=Be.split(`
`);for(V=k=0;k<rt.length&&!rt[k].includes("DetermineComponentFrameRoot");)k++;for(;V<Tt.length&&!Tt[V].includes("DetermineComponentFrameRoot");)V++;if(k===rt.length||V===Tt.length)for(k=rt.length-1,V=Tt.length-1;1<=k&&0<=V&&rt[k]!==Tt[V];)V--;for(;1<=k&&0<=V;k--,V--)if(rt[k]!==Tt[V]){if(k!==1||V!==1)do if(k--,V--,0>V||rt[k]!==Tt[V]){var en=`
`+rt[k].replace(" at new "," at ");return f.displayName&&en.includes("<anonymous>")&&(en=en.replace("<anonymous>",f.displayName)),en}while(1<=k&&0<=V);break}}}finally{jt=!1,Error.prepareStackTrace=T}return(T=f?f.displayName||f.name:"")?vt(T):""}function gt(f){switch(f.tag){case 26:case 27:case 5:return vt(f.type);case 16:return vt("Lazy");case 13:return vt("Suspense");case 19:return vt("SuspenseList");case 0:case 15:return f=_t(f.type,!1),f;case 11:return f=_t(f.type.render,!1),f;case 1:return f=_t(f.type,!0),f;default:return""}}function Vt(f){try{var g="";do g+=gt(f),f=f.return;while(f);return g}catch(T){return`
Error generating stack: `+T.message+`
`+T.stack}}function Ht(f){var g=f,T=f;if(f.alternate)for(;g.return;)g=g.return;else{f=g;do g=f,g.flags&4098&&(T=g.return),f=g.return;while(f)}return g.tag===3?T:null}function Bt(f){if(f.tag===13){var g=f.memoizedState;if(g===null&&(f=f.alternate,f!==null&&(g=f.memoizedState)),g!==null)return g.dehydrated}return null}function et(f){if(Ht(f)!==f)throw Error(o(188))}function $t(f){var g=f.alternate;if(!g){if(g=Ht(f),g===null)throw Error(o(188));return g!==f?null:f}for(var T=f,k=g;;){var V=T.return;if(V===null)break;var Q=V.alternate;if(Q===null){if(k=V.return,k!==null){T=k;continue}break}if(V.child===Q.child){for(Q=V.child;Q;){if(Q===T)return et(V),f;if(Q===k)return et(V),g;Q=Q.sibling}throw Error(o(188))}if(T.return!==k.return)T=V,k=Q;else{for(var be=!1,Be=V.child;Be;){if(Be===T){be=!0,T=V,k=Q;break}if(Be===k){be=!0,k=V,T=Q;break}Be=Be.sibling}if(!be){for(Be=Q.child;Be;){if(Be===T){be=!0,T=Q,k=V;break}if(Be===k){be=!0,k=Q,T=V;break}Be=Be.sibling}if(!be)throw Error(o(189))}}if(T.alternate!==k)throw Error(o(190))}if(T.tag!==3)throw Error(o(188));return T.stateNode.current===T?f:g}function rn(f){var g=f.tag;if(g===5||g===26||g===27||g===6)return f;for(f=f.child;f!==null;){if(g=rn(f),g!==null)return g;f=f.sibling}return null}var Nt=Array.isArray,xn=a.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,rr={pending:!1,data:null,method:null,action:null},Xn=[],yi=-1;function ir(f){return{current:f}}function yn(f){0>yi||(f.current=Xn[yi],Xn[yi]=null,yi--)}function Ne(f,g){yi++,Xn[yi]=f.current,f.current=g}var Qn=ir(null),fn=ir(null),Dr=ir(null),Pt=ir(null);function Pr(f,g){switch(Ne(Dr,g),Ne(fn,f),Ne(Qn,null),f=g.nodeType,f){case 9:case 11:g=(g=g.documentElement)&&(g=g.namespaceURI)?Fy(g):0;break;default:if(f=f===8?g.parentNode:g,g=f.tagName,f=f.namespaceURI)f=Fy(f),g=B_(f,g);else switch(g){case"svg":g=1;break;case"math":g=2;break;default:g=0}}yn(Qn),Ne(Qn,g)}function Cr(){yn(Qn),yn(fn),yn(Dr)}function zi(f){f.memoizedState!==null&&Ne(Pt,f);var g=Qn.current,T=B_(g,f.type);g!==T&&(Ne(fn,f),Ne(Qn,T))}function $n(f){fn.current===f&&(yn(Qn),yn(fn)),Pt.current===f&&(yn(Pt),Od._currentValue=rr)}var si=Object.prototype.hasOwnProperty,ha=e.unstable_scheduleCallback,Pa=e.unstable_cancelCallback,co=e.unstable_shouldYield,Rs=e.unstable_requestPaint,Bn=e.unstable_now,jo=e.unstable_getCurrentPriorityLevel,is=e.unstable_ImmediatePriority,Tl=e.unstable_UserBlockingPriority,fa=e.unstable_NormalPriority,El=e.unstable_LowPriority,hc=e.unstable_IdlePriority,uh=e.log,hh=e.unstable_setDisableYieldValue,da=null,Ia=null;function fh(f){if(Ia&&typeof Ia.onCommitFiberRoot=="function")try{Ia.onCommitFiberRoot(da,f,void 0,(f.current.flags&128)===128)}catch{}}function ra(f){if(typeof uh=="function"&&hh(f),Ia&&typeof Ia.setStrictMode=="function")try{Ia.setStrictMode(da,f)}catch{}}var pa=Math.clz32?Math.clz32:rp,qn=Math.log,tl=Math.LN2;function rp(f){return f>>>=0,f===0?32:31-(qn(f)/tl|0)|0}var Za=128,as=4194304;function os(f){var g=f&42;if(g!==0)return g;switch(f&-f){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return f&4194176;case 4194304:case 8388608:case 16777216:case 33554432:return f&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return f}}function Al(f,g){var T=f.pendingLanes;if(T===0)return 0;var k=0,V=f.suspendedLanes,Q=f.pingedLanes,be=f.warmLanes;f=f.finishedLanes!==0;var Be=T&134217727;return Be!==0?(T=Be&~V,T!==0?k=os(T):(Q&=Be,Q!==0?k=os(Q):f||(be=Be&~be,be!==0&&(k=os(be))))):(Be=T&~V,Be!==0?k=os(Be):Q!==0?k=os(Q):f||(be=T&~be,be!==0&&(k=os(be)))),k===0?0:g!==0&&g!==k&&!(g&V)&&(V=k&-k,be=g&-g,V>=be||V===32&&(be&4194176)!==0)?g:k}function nl(f,g){return(f.pendingLanes&~(f.suspendedLanes&~f.pingedLanes)&g)===0}function ip(f,g){switch(f){case 1:case 2:case 4:case 8:return g+250;case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return g+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function _u(){var f=Za;return Za<<=1,!(Za&4194176)&&(Za=128),f}function Of(){var f=as;return as<<=1,!(as&62914560)&&(as=4194304),f}function dh(f){for(var g=[],T=0;31>T;T++)g.push(f);return g}function vi(f,g){f.pendingLanes|=g,g!==268435456&&(f.suspendedLanes=0,f.pingedLanes=0,f.warmLanes=0)}function Pf(f,g,T,k,V,Q){var be=f.pendingLanes;f.pendingLanes=T,f.suspendedLanes=0,f.pingedLanes=0,f.warmLanes=0,f.expiredLanes&=T,f.entangledLanes&=T,f.errorRecoveryDisabledLanes&=T,f.shellSuspendCounter=0;var Be=f.entanglements,rt=f.expirationTimes,Tt=f.hiddenUpdates;for(T=be&~T;0<T;){var en=31-pa(T),mn=1<<en;Be[en]=0,rt[en]=-1;var Ft=Tt[en];if(Ft!==null)for(Tt[en]=null,en=0;en<Ft.length;en++){var Qt=Ft[en];Qt!==null&&(Qt.lane&=-536870913)}T&=~mn}k!==0&&If(f,k,0),Q!==0&&V===0&&f.tag!==0&&(f.suspendedLanes|=Q&~(be&~g))}function If(f,g,T){f.pendingLanes|=g,f.suspendedLanes&=~g;var k=31-pa(g);f.entangledLanes|=g,f.entanglements[k]=f.entanglements[k]|1073741824|T&4194218}function ph(f,g){var T=f.entangledLanes|=g;for(f=f.entanglements;T;){var k=31-pa(T),V=1<<k;V&g|f[k]&g&&(f[k]|=g),T&=~V}}function ma(f){return f&=-f,2<f?8<f?f&134217727?32:268435456:8:2}function Ds(){var f=xn.p;return f!==0?f:(f=window.event,f===void 0?32:ox(f.type))}function ft(f,g){var T=xn.p;try{return xn.p=f,g()}finally{xn.p=T}}var le=Math.random().toString(36).slice(2),pe="__reactFiber$"+le,Se="__reactProps$"+le,Le="__reactContainer$"+le,je="__reactEvents$"+le,We="__reactListeners$"+le,it="__reactHandles$"+le,Ye="__reactResources$"+le,ct="__reactMarker$"+le;function lt(f){delete f[pe],delete f[Se],delete f[je],delete f[We],delete f[it]}function ut(f){var g=f[pe];if(g)return g;for(var T=f.parentNode;T;){if(g=T[Le]||T[pe]){if(T=g.alternate,g.child!==null||T!==null&&T.child!==null)for(f=Y2(f);f!==null;){if(T=f[pe])return T;f=Y2(f)}return g}f=T,T=f.parentNode}return null}function Ct(f){if(f=f[pe]||f[Le]){var g=f.tag;if(g===5||g===6||g===13||g===26||g===27||g===3)return f}return null}function Zt(f){var g=f.tag;if(g===5||g===26||g===27||g===6)return f.stateNode;throw Error(o(33))}function Xt(f){var g=f[Ye];return g||(g=f[Ye]={hoistableStyles:new Map,hoistableScripts:new Map}),g}function gn(f){f[ct]=!0}var Cn=new Set,On={};function wn(f,g){er(f,g),er(f+"Capture",g)}function er(f,g){for(On[f]=g,f=0;f<g.length;f++)Cn.add(g[f])}var tr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Yn=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),dr={},vr={};function Pi(f){return si.call(vr,f)?!0:si.call(dr,f)?!1:Yn.test(f)?vr[f]=!0:(dr[f]=!0,!1)}function Uo(f,g,T){if(Pi(g))if(T===null)f.removeAttribute(g);else{switch(typeof T){case"undefined":case"function":case"symbol":f.removeAttribute(g);return;case"boolean":var k=g.toLowerCase().slice(0,5);if(k!=="data-"&&k!=="aria-"){f.removeAttribute(g);return}}f.setAttribute(g,""+T)}}function Ai(f,g,T){if(T===null)f.removeAttribute(g);else{switch(typeof T){case"undefined":case"function":case"symbol":case"boolean":f.removeAttribute(g);return}f.setAttribute(g,""+T)}}function ii(f,g,T,k){if(k===null)f.removeAttribute(T);else{switch(typeof k){case"undefined":case"function":case"symbol":case"boolean":f.removeAttribute(T);return}f.setAttributeNS(g,T,""+k)}}function di(f){switch(typeof f){case"bigint":case"boolean":case"number":case"string":case"undefined":return f;case"object":return f;default:return""}}function mh(f){var g=f.type;return(f=f.nodeName)&&f.toLowerCase()==="input"&&(g==="checkbox"||g==="radio")}function Cl(f){var g=mh(f)?"checked":"value",T=Object.getOwnPropertyDescriptor(f.constructor.prototype,g),k=""+f[g];if(!f.hasOwnProperty(g)&&typeof T<"u"&&typeof T.get=="function"&&typeof T.set=="function"){var V=T.get,Q=T.set;return Object.defineProperty(f,g,{configurable:!0,get:function(){return V.call(this)},set:function(be){k=""+be,Q.call(this,be)}}),Object.defineProperty(f,g,{enumerable:T.enumerable}),{getValue:function(){return k},setValue:function(be){k=""+be},stopTracking:function(){f._valueTracker=null,delete f[g]}}}}function fc(f){f._valueTracker||(f._valueTracker=Cl(f))}function ap(f){if(!f)return!1;var g=f._valueTracker;if(!g)return!0;var T=g.getValue(),k="";return f&&(k=mh(f)?f.checked?"true":"false":f.value),f=k,f!==T?(g.setValue(f),!0):!1}function Rf(f){if(f=f||(typeof document<"u"?document:void 0),typeof f>"u")return null;try{return f.activeElement||f.body}catch{return f.body}}var Sm=/[\n"\\]/g;function So(f){return f.replace(Sm,function(g){return"\\"+g.charCodeAt(0).toString(16)+" "})}function Ra(f,g,T,k,V,Q,be,Be){f.name="",be!=null&&typeof be!="function"&&typeof be!="symbol"&&typeof be!="boolean"?f.type=be:f.removeAttribute("type"),g!=null?be==="number"?(g===0&&f.value===""||f.value!=g)&&(f.value=""+di(g)):f.value!==""+di(g)&&(f.value=""+di(g)):be!=="submit"&&be!=="reset"||f.removeAttribute("value"),g!=null?Ls(f,be,di(g)):T!=null?Ls(f,be,di(T)):k!=null&&f.removeAttribute("value"),V==null&&Q!=null&&(f.defaultChecked=!!Q),V!=null&&(f.checked=V&&typeof V!="function"&&typeof V!="symbol"),Be!=null&&typeof Be!="function"&&typeof Be!="symbol"&&typeof Be!="boolean"?f.name=""+di(Be):f.removeAttribute("name")}function ss(f,g,T,k,V,Q,be,Be){if(Q!=null&&typeof Q!="function"&&typeof Q!="symbol"&&typeof Q!="boolean"&&(f.type=Q),g!=null||T!=null){if(!(Q!=="submit"&&Q!=="reset"||g!=null))return;T=T!=null?""+di(T):"",g=g!=null?""+di(g):T,Be||g===f.value||(f.value=g),f.defaultValue=g}k=k??V,k=typeof k!="function"&&typeof k!="symbol"&&!!k,f.checked=Be?f.checked:!!k,f.defaultChecked=!!k,be!=null&&typeof be!="function"&&typeof be!="symbol"&&typeof be!="boolean"&&(f.name=be)}function Ls(f,g,T){g==="number"&&Rf(f.ownerDocument)===f||f.defaultValue===""+T||(f.defaultValue=""+T)}function uo(f,g,T,k){if(f=f.options,g){g={};for(var V=0;V<T.length;V++)g["$"+T[V]]=!0;for(T=0;T<f.length;T++)V=g.hasOwnProperty("$"+f[T].value),f[T].selected!==V&&(f[T].selected=V),V&&k&&(f[T].defaultSelected=!0)}else{for(T=""+di(T),g=null,V=0;V<f.length;V++){if(f[V].value===T){f[V].selected=!0,k&&(f[V].defaultSelected=!0);return}g!==null||f[V].disabled||(g=f[V])}g!==null&&(g.selected=!0)}}function ls(f,g,T){if(g!=null&&(g=""+di(g),g!==f.value&&(f.value=g),T==null)){f.defaultValue!==g&&(f.defaultValue=g);return}f.defaultValue=T!=null?""+di(T):""}function ks(f,g,T,k){if(g==null){if(k!=null){if(T!=null)throw Error(o(92));if(Nt(k)){if(1<k.length)throw Error(o(93));k=k[0]}T=k}T==null&&(T=""),g=T}T=di(g),f.defaultValue=T,k=f.textContent,k===T&&k!==""&&k!==null&&(f.value=k)}function Ml(f,g){if(g){var T=f.firstChild;if(T&&T===f.lastChild&&T.nodeType===3){T.nodeValue=g;return}}f.textContent=g}var Tm=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Ol(f,g,T){var k=g.indexOf("--")===0;T==null||typeof T=="boolean"||T===""?k?f.setProperty(g,""):g==="float"?f.cssFloat="":f[g]="":k?f.setProperty(g,T):typeof T!="number"||T===0||Tm.has(g)?g==="float"?f.cssFloat=T:f[g]=(""+T).trim():f[g]=T+"px"}function Pl(f,g,T){if(g!=null&&typeof g!="object")throw Error(o(62));if(f=f.style,T!=null){for(var k in T)!T.hasOwnProperty(k)||g!=null&&g.hasOwnProperty(k)||(k.indexOf("--")===0?f.setProperty(k,""):k==="float"?f.cssFloat="":f[k]="");for(var V in g)k=g[V],g.hasOwnProperty(V)&&T[V]!==k&&Ol(f,V,k)}else for(var Q in g)g.hasOwnProperty(Q)&&Ol(f,Q,g[Q])}function op(f){if(f.indexOf("-")===-1)return!1;switch(f){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Em=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),cs=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function _r(f){return cs.test(""+f)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":f}var Df=null;function Mn(f){return f=f.target||f.srcElement||window,f.correspondingUseElement&&(f=f.correspondingUseElement),f.nodeType===3?f.parentNode:f}var gu=null,Il=null;function Lf(f){var g=Ct(f);if(g&&(f=g.stateNode)){var T=f[Se]||null;e:switch(f=g.stateNode,g.type){case"input":if(Ra(f,T.value,T.defaultValue,T.defaultValue,T.checked,T.defaultChecked,T.type,T.name),g=T.name,T.type==="radio"&&g!=null){for(T=f;T.parentNode;)T=T.parentNode;for(T=T.querySelectorAll('input[name="'+So(""+g)+'"][type="radio"]'),g=0;g<T.length;g++){var k=T[g];if(k!==f&&k.form===f.form){var V=k[Se]||null;if(!V)throw Error(o(90));Ra(k,V.value,V.defaultValue,V.defaultValue,V.checked,V.defaultChecked,V.type,V.name)}}for(g=0;g<T.length;g++)k=T[g],k.form===f.form&&ap(k)}break e;case"textarea":ls(f,T.value,T.defaultValue);break e;case"select":g=T.value,g!=null&&uo(f,!!T.multiple,g,!1)}}}var Kn=!1;function kf(f,g,T){if(Kn)return f(g,T);Kn=!0;try{var k=f(g);return k}finally{if(Kn=!1,(gu!==null||Il!==null)&&(t0(),gu&&(g=gu,f=Il,Il=gu=null,Lf(g),f)))for(g=0;g<f.length;g++)Lf(f[g])}}function zs(f,g){var T=f.stateNode;if(T===null)return null;var k=T[Se]||null;if(k===null)return null;T=k[g];e:switch(g){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(k=!k.disabled)||(f=f.type,k=!(f==="button"||f==="input"||f==="select"||f==="textarea")),f=!k;break e;default:f=!1}if(f)return null;if(T&&typeof T!="function")throw Error(o(231,g,typeof T));return T}var _n=!1;if(tr)try{var xr={};Object.defineProperty(xr,"passive",{get:function(){_n=!0}}),window.addEventListener("test",xr,xr),window.removeEventListener("test",xr,xr)}catch{_n=!1}var ar=null,_a=null,us=null;function gr(){if(us)return us;var f,g=_a,T=g.length,k,V="value"in ar?ar.value:ar.textContent,Q=V.length;for(f=0;f<T&&g[f]===V[f];f++);var be=T-f;for(k=1;k<=be&&g[T-k]===V[Q-k];k++);return us=V.slice(f,1<k?1-k:void 0)}function dc(f){var g=f.keyCode;return"charCode"in f?(f=f.charCode,f===0&&g===13&&(f=13)):f=g,f===10&&(f=13),32<=f||f===13?f:0}function Vo(){return!0}function _h(){return!1}function Wr(f){function g(T,k,V,Q,be){this._reactName=T,this._targetInst=V,this.type=k,this.nativeEvent=Q,this.target=be,this.currentTarget=null;for(var Be in f)f.hasOwnProperty(Be)&&(T=f[Be],this[Be]=T?T(Q):Q[Be]);return this.isDefaultPrevented=(Q.defaultPrevented!=null?Q.defaultPrevented:Q.returnValue===!1)?Vo:_h,this.isPropagationStopped=_h,this}return ye(g.prototype,{preventDefault:function(){this.defaultPrevented=!0;var T=this.nativeEvent;T&&(T.preventDefault?T.preventDefault():typeof T.returnValue!="unknown"&&(T.returnValue=!1),this.isDefaultPrevented=Vo)},stopPropagation:function(){var T=this.nativeEvent;T&&(T.stopPropagation?T.stopPropagation():typeof T.cancelBubble!="unknown"&&(T.cancelBubble=!0),this.isPropagationStopped=Vo)},persist:function(){},isPersistent:Vo}),g}var Xr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(f){return f.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},gh=Wr(Xr),ga=ye({},Xr,{view:0,detail:0}),sp=Wr(ga),yu,yh,Rl,ia=ye({},ga,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Mm,button:0,buttons:0,relatedTarget:function(f){return f.relatedTarget===void 0?f.fromElement===f.srcElement?f.toElement:f.fromElement:f.relatedTarget},movementX:function(f){return"movementX"in f?f.movementX:(f!==Rl&&(Rl&&f.type==="mousemove"?(yu=f.screenX-Rl.screenX,yh=f.screenY-Rl.screenY):yh=yu=0,Rl=f),yu)},movementY:function(f){return"movementY"in f?f.movementY:yh}}),Bs=Wr(ia),Da=ye({},ia,{dataTransfer:0}),Am=Wr(Da),Dl=ye({},ga,{relatedTarget:0}),ai=Wr(Dl),hs=ye({},Xr,{animationName:0,elapsedTime:0,pseudoElement:0}),ya=Wr(hs),Ii=ye({},Xr,{clipboardData:function(f){return"clipboardData"in f?f.clipboardData:window.clipboardData}}),zf=Wr(Ii),Ns=ye({},Xr,{data:0}),pc=Wr(Ns),Bf={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Fs={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Cm={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ll(f){var g=this.nativeEvent;return g.getModifierState?g.getModifierState(f):(f=Cm[f])?!!g[f]:!1}function Mm(){return Ll}var Om=ye({},ga,{key:function(f){if(f.key){var g=Bf[f.key]||f.key;if(g!=="Unidentified")return g}return f.type==="keypress"?(f=dc(f),f===13?"Enter":String.fromCharCode(f)):f.type==="keydown"||f.type==="keyup"?Fs[f.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Mm,charCode:function(f){return f.type==="keypress"?dc(f):0},keyCode:function(f){return f.type==="keydown"||f.type==="keyup"?f.keyCode:0},which:function(f){return f.type==="keypress"?dc(f):f.type==="keydown"||f.type==="keyup"?f.keyCode:0}}),ho=Wr(Om),Pm=ye({},ia,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Nf=Wr(Pm),Ff=ye({},ga,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Mm}),jf=Wr(Ff),Ay=ye({},Xr,{propertyName:0,elapsedTime:0,pseudoElement:0}),Cy=Wr(Ay),Uf=ye({},ia,{deltaX:function(f){return"deltaX"in f?f.deltaX:"wheelDeltaX"in f?-f.wheelDeltaX:0},deltaY:function(f){return"deltaY"in f?f.deltaY:"wheelDeltaY"in f?-f.wheelDeltaY:"wheelDelta"in f?-f.wheelDelta:0},deltaZ:0,deltaMode:0}),Vf=Wr(Uf),My=ye({},Xr,{newState:0,oldState:0}),vh=Wr(My),Im=[9,13,27,32],js=tr&&"CompositionEvent"in window,fs=null;tr&&"documentMode"in document&&(fs=document.documentMode);var Oy=tr&&"TextEvent"in window&&!fs,lp=tr&&(!js||fs&&8<fs&&11>=fs),r_=" ",Rm=!1;function i_(f,g){switch(f){case"keyup":return Im.indexOf(g.keyCode)!==-1;case"keydown":return g.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function cp(f){return f=f.detail,typeof f=="object"&&"data"in f?f.data:null}var ds=!1;function Jn(f,g){switch(f){case"compositionend":return cp(g);case"keypress":return g.which!==32?null:(Rm=!0,r_);case"textInput":return f=g.data,f===r_&&Rm?null:f;default:return null}}function Tn(f,g){if(ds)return f==="compositionend"||!js&&i_(f,g)?(f=gr(),us=_a=ar=null,ds=!1,f):null;switch(f){case"paste":return null;case"keypress":if(!(g.ctrlKey||g.altKey||g.metaKey)||g.ctrlKey&&g.altKey){if(g.char&&1<g.char.length)return g.char;if(g.which)return String.fromCharCode(g.which)}return null;case"compositionend":return lp&&g.locale!=="ko"?null:g.data;default:return null}}var up={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Dn(f){var g=f&&f.nodeName&&f.nodeName.toLowerCase();return g==="input"?!!up[f.type]:g==="textarea"}function vu(f,g,T,k){gu?Il?Il.push(k):Il=[k]:gu=k,g=o0(g,"onChange"),0<g.length&&(T=new gh("onChange","change",null,T,k),f.push({event:T,listeners:g}))}var mc=null,Rn=null;function xh(f){q2(f,0)}function rl(f){var g=Zt(f);if(ap(g))return f}function hp(f,g){if(f==="change")return g}var $f=!1;if(tr){var Wa;if(tr){var aa="oninput"in document;if(!aa){var Kt=document.createElement("div");Kt.setAttribute("oninput","return;"),aa=typeof Kt.oninput=="function"}Wa=aa}else Wa=!1;$f=Wa&&(!document.documentMode||9<document.documentMode)}function fp(){mc&&(mc.detachEvent("onpropertychange",qf),Rn=mc=null)}function qf(f){if(f.propertyName==="value"&&rl(Rn)){var g=[];vu(g,Rn,f,Mn(f)),kf(xh,g)}}function Gf(f,g,T){f==="focusin"?(fp(),mc=g,Rn=T,mc.attachEvent("onpropertychange",qf)):f==="focusout"&&fp()}function _c(f){if(f==="selectionchange"||f==="keyup"||f==="keydown")return rl(Rn)}function va(f,g){if(f==="click")return rl(g)}function kl(f,g){if(f==="input"||f==="change")return rl(g)}function Dm(f,g){return f===g&&(f!==0||1/f===1/g)||f!==f&&g!==g}var xa=typeof Object.is=="function"?Object.is:Dm;function Us(f,g){if(xa(f,g))return!0;if(typeof f!="object"||f===null||typeof g!="object"||g===null)return!1;var T=Object.keys(f),k=Object.keys(g);if(T.length!==k.length)return!1;for(k=0;k<T.length;k++){var V=T[k];if(!si.call(g,V)||!xa(f[V],g[V]))return!1}return!0}function gc(f){for(;f&&f.firstChild;)f=f.firstChild;return f}function dp(f,g){var T=gc(f);f=0;for(var k;T;){if(T.nodeType===3){if(k=f+T.textContent.length,f<=g&&k>=g)return{node:T,offset:g-f};f=k}e:{for(;T;){if(T.nextSibling){T=T.nextSibling;break e}T=T.parentNode}T=void 0}T=gc(T)}}function a_(f,g){return f&&g?f===g?!0:f&&f.nodeType===3?!1:g&&g.nodeType===3?a_(f,g.parentNode):"contains"in f?f.contains(g):f.compareDocumentPosition?!!(f.compareDocumentPosition(g)&16):!1:!1}function pp(f){f=f!=null&&f.ownerDocument!=null&&f.ownerDocument.defaultView!=null?f.ownerDocument.defaultView:window;for(var g=Rf(f.document);g instanceof f.HTMLIFrameElement;){try{var T=typeof g.contentWindow.location.href=="string"}catch{T=!1}if(T)f=g.contentWindow;else break;g=Rf(f.document)}return g}function Lm(f){var g=f&&f.nodeName&&f.nodeName.toLowerCase();return g&&(g==="input"&&(f.type==="text"||f.type==="search"||f.type==="tel"||f.type==="url"||f.type==="password")||g==="textarea"||f.contentEditable==="true")}function o_(f,g){var T=pp(g);g=f.focusedElem;var k=f.selectionRange;if(T!==g&&g&&g.ownerDocument&&a_(g.ownerDocument.documentElement,g)){if(k!==null&&Lm(g)){if(f=k.start,T=k.end,T===void 0&&(T=f),"selectionStart"in g)g.selectionStart=f,g.selectionEnd=Math.min(T,g.value.length);else if(T=(f=g.ownerDocument||document)&&f.defaultView||window,T.getSelection){T=T.getSelection();var V=g.textContent.length,Q=Math.min(k.start,V);k=k.end===void 0?Q:Math.min(k.end,V),!T.extend&&Q>k&&(V=k,k=Q,Q=V),V=dp(g,Q);var be=dp(g,k);V&&be&&(T.rangeCount!==1||T.anchorNode!==V.node||T.anchorOffset!==V.offset||T.focusNode!==be.node||T.focusOffset!==be.offset)&&(f=f.createRange(),f.setStart(V.node,V.offset),T.removeAllRanges(),Q>k?(T.addRange(f),T.extend(be.node,be.offset)):(f.setEnd(be.node,be.offset),T.addRange(f)))}}for(f=[],T=g;T=T.parentNode;)T.nodeType===1&&f.push({element:T,left:T.scrollLeft,top:T.scrollTop});for(typeof g.focus=="function"&&g.focus(),g=0;g<f.length;g++)T=f[g],T.element.scrollLeft=T.left,T.element.scrollTop=T.top}}var km=tr&&"documentMode"in document&&11>=document.documentMode,yc=null,zm=null,bh=null,zl=!1;function s_(f,g,T){var k=T.window===T?T.document:T.nodeType===9?T:T.ownerDocument;zl||yc==null||yc!==Rf(k)||(k=yc,"selectionStart"in k&&Lm(k)?k={start:k.selectionStart,end:k.selectionEnd}:(k=(k.ownerDocument&&k.ownerDocument.defaultView||window).getSelection(),k={anchorNode:k.anchorNode,anchorOffset:k.anchorOffset,focusNode:k.focusNode,focusOffset:k.focusOffset}),bh&&Us(bh,k)||(bh=k,k=o0(zm,"onSelect"),0<k.length&&(g=new gh("onSelect","select",null,g,T),f.push({event:g,listeners:k}),g.target=yc)))}function vc(f,g){var T={};return T[f.toLowerCase()]=g.toLowerCase(),T["Webkit"+f]="webkit"+g,T["Moz"+f]="moz"+g,T}var xc={animationend:vc("Animation","AnimationEnd"),animationiteration:vc("Animation","AnimationIteration"),animationstart:vc("Animation","AnimationStart"),transitionrun:vc("Transition","TransitionRun"),transitionstart:vc("Transition","TransitionStart"),transitioncancel:vc("Transition","TransitionCancel"),transitionend:vc("Transition","TransitionEnd")},xu={},Bm={};tr&&(Bm=document.createElement("div").style,"AnimationEvent"in window||(delete xc.animationend.animation,delete xc.animationiteration.animation,delete xc.animationstart.animation),"TransitionEvent"in window||delete xc.transitionend.transition);function La(f){if(xu[f])return xu[f];if(!xc[f])return f;var g=xc[f],T;for(T in g)if(g.hasOwnProperty(T)&&T in Bm)return xu[f]=g[T];return f}var Hf=La("animationend"),wh=La("animationiteration"),Zf=La("animationstart"),bc=La("transitionrun"),mp=La("transitionstart"),Nm=La("transitioncancel"),wc=La("transitionend"),bu=new Map,Sh="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll scrollEnd toggle touchMove waiting wheel".split(" ");function fo(f,g){bu.set(f,g),wn(g,[f])}var ka=[],ps=0,Sc=0;function Tc(){for(var f=ps,g=Sc=ps=0;g<f;){var T=ka[g];ka[g++]=null;var k=ka[g];ka[g++]=null;var V=ka[g];ka[g++]=null;var Q=ka[g];if(ka[g++]=null,k!==null&&V!==null){var be=k.pending;be===null?V.next=V:(V.next=be.next,be.next=V),k.pending=V}Q!==0&&Ec(T,V,Q)}}function wu(f,g,T,k){ka[ps++]=f,ka[ps++]=g,ka[ps++]=T,ka[ps++]=k,Sc|=k,f.lanes|=k,f=f.alternate,f!==null&&(f.lanes|=k)}function Su(f,g,T,k){return wu(f,g,T,k),sr(f)}function $o(f,g){return wu(f,null,null,g),sr(f)}function Ec(f,g,T){f.lanes|=T;var k=f.alternate;k!==null&&(k.lanes|=T);for(var V=!1,Q=f.return;Q!==null;)Q.childLanes|=T,k=Q.alternate,k!==null&&(k.childLanes|=T),Q.tag===22&&(f=Q.stateNode,f===null||f._visibility&1||(V=!0)),f=Q,Q=Q.return;V&&g!==null&&f.tag===3&&(Q=f.stateNode,V=31-pa(T),Q=Q.hiddenUpdates,f=Q[V],f===null?Q[V]=[g]:f.push(g),g.lane=T|536870912)}function sr(f){if(50<Zc)throw Zc=0,yd=null,Error(o(185));for(var g=f.return;g!==null;)f=g,g=f.return;return f.tag===3?f.stateNode:null}var Tu={},Eu=new WeakMap;function qo(f,g){if(typeof f=="object"&&f!==null){var T=Eu.get(f);return T!==void 0?T:(g={value:f,source:g,stack:Vt(g)},Eu.set(f,g),g)}return{value:f,source:g,stack:Vt(g)}}var Au=[],Th=0,jr=null,Eh=0,To=[],Eo=0,Bl=null,il=1,al="";function Cu(f,g){Au[Th++]=Eh,Au[Th++]=jr,jr=f,Eh=g}function Ah(f,g,T){To[Eo++]=il,To[Eo++]=al,To[Eo++]=Bl,Bl=f;var k=il;f=al;var V=32-pa(k)-1;k&=~(1<<V),T+=1;var Q=32-pa(g)+V;if(30<Q){var be=V-V%5;Q=(k&(1<<be)-1).toString(32),k>>=be,V-=be,il=1<<32-pa(g)+V|T<<V|k,al=Q+f}else il=1<<Q|T<<V|k,al=f}function Mu(f){f.return!==null&&(Cu(f,1),Ah(f,1,0))}function _p(f){for(;f===jr;)jr=Au[--Th],Au[Th]=null,Eh=Au[--Th],Au[Th]=null;for(;f===Bl;)Bl=To[--Eo],To[Eo]=null,al=To[--Eo],To[Eo]=null,il=To[--Eo],To[Eo]=null}var li=null,ba=null,Ur=!1,Ao=null,ms=!1,Wf=Error(o(519));function ol(f){var g=Error(o(418,""));throw Mh(qo(g,f)),Wf}function gp(f){var g=f.stateNode,T=f.type,k=f.memoizedProps;switch(g[pe]=f,g[Se]=k,T){case"dialog":Hr("cancel",g),Hr("close",g);break;case"iframe":case"object":case"embed":Hr("load",g);break;case"video":case"audio":for(T=0;T<a0.length;T++)Hr(a0[T],g);break;case"source":Hr("error",g);break;case"img":case"image":case"link":Hr("error",g),Hr("load",g);break;case"details":Hr("toggle",g);break;case"input":Hr("invalid",g),ss(g,k.value,k.defaultValue,k.checked,k.defaultChecked,k.type,k.name,!0),fc(g);break;case"select":Hr("invalid",g);break;case"textarea":Hr("invalid",g),ks(g,k.value,k.defaultValue,k.children),fc(g)}T=k.children,typeof T!="string"&&typeof T!="number"&&typeof T!="bigint"||g.textContent===""+T||k.suppressHydrationWarning===!0||Td(g.textContent,T)?(k.popover!=null&&(Hr("beforetoggle",g),Hr("toggle",g)),k.onScroll!=null&&Hr("scroll",g),k.onScrollEnd!=null&&Hr("scrollend",g),k.onClick!=null&&(g.onclick=Yc),g=!0):g=!1,g||ol(f)}function yp(f){for(li=f.return;li;)switch(li.tag){case 3:case 27:ms=!0;return;case 5:case 13:ms=!1;return;default:li=li.return}}function Ac(f){if(f!==li)return!1;if(!Ur)return yp(f),Ur=!0,!1;var g=!1,T;if((T=f.tag!==3&&f.tag!==27)&&((T=f.tag===5)&&(T=f.type,T=!(T!=="form"&&T!=="button")||l0(f.type,f.memoizedProps)),T=!T),T&&(g=!0),g&&ba&&ol(f),yp(f),f.tag===13){if(f=f.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(o(317));e:{for(f=f.nextSibling,g=0;f;){if(f.nodeType===8)if(T=f.data,T==="/$"){if(g===0){ba=Kl(f.nextSibling);break e}g--}else T!=="$"&&T!=="$!"&&T!=="$?"||g++;f=f.nextSibling}ba=null}}else ba=li?Kl(f.stateNode.nextSibling):null;return!0}function Ch(){ba=li=null,Ur=!1}function Mh(f){Ao===null?Ao=[f]:Ao.push(f)}var sl=Error(o(460)),l_=Error(o(474)),Fm={then:function(){}};function c_(f){return f=f.status,f==="fulfilled"||f==="rejected"}function vp(){}function u_(f,g,T){switch(T=f[T],T===void 0?f.push(g):T!==g&&(g.then(vp,vp),g=T),g.status){case"fulfilled":return g.value;case"rejected":throw f=g.reason,f===sl?Error(o(483)):f;default:if(typeof g.status=="string")g.then(vp,vp);else{if(f=Pn,f!==null&&100<f.shellSuspendCounter)throw Error(o(482));f=g,f.status="pending",f.then(function(k){if(g.status==="pending"){var V=g;V.status="fulfilled",V.value=k}},function(k){if(g.status==="pending"){var V=g;V.status="rejected",V.reason=k}})}switch(g.status){case"fulfilled":return g.value;case"rejected":throw f=g.reason,f===sl?Error(o(483)):f}throw Xf=g,sl}}var Xf=null;function xp(){if(Xf===null)throw Error(o(459));var f=Xf;return Xf=null,f}var Cc=null,Mc=0;function Nl(f){var g=Mc;return Mc+=1,Cc===null&&(Cc=[]),u_(Cc,f,g)}function Ou(f,g){g=g.props.ref,f.ref=g!==void 0?g:null}function Yf(f,g){throw g.$$typeof===y?Error(o(525)):(f=Object.prototype.toString.call(g),Error(o(31,f==="[object Object]"?"object with keys {"+Object.keys(g).join(", ")+"}":f)))}function jm(f){var g=f._init;return g(f._payload)}function bp(f){function g(Mt,xt){if(f){var Dt=Mt.deletions;Dt===null?(Mt.deletions=[xt],Mt.flags|=16):Dt.push(xt)}}function T(Mt,xt){if(!f)return null;for(;xt!==null;)g(Mt,xt),xt=xt.sibling;return null}function k(Mt){for(var xt=new Map;Mt!==null;)Mt.key!==null?xt.set(Mt.key,Mt):xt.set(Mt.index,Mt),Mt=Mt.sibling;return xt}function V(Mt,xt){return Mt=Gt(Mt,xt),Mt.index=0,Mt.sibling=null,Mt}function Q(Mt,xt,Dt){return Mt.index=Dt,f?(Dt=Mt.alternate,Dt!==null?(Dt=Dt.index,Dt<xt?(Mt.flags|=33554434,xt):Dt):(Mt.flags|=33554434,xt)):(Mt.flags|=1048576,xt)}function be(Mt){return f&&Mt.alternate===null&&(Mt.flags|=33554434),Mt}function Be(Mt,xt,Dt,un){return xt===null||xt.tag!==6?(xt=on(Dt,Mt.mode,un),xt.return=Mt,xt):(xt=V(xt,Dt),xt.return=Mt,xt)}function rt(Mt,xt,Dt,un){var Un=Dt.type;return Un===C?en(Mt,xt,Dt.props.children,un,Dt.key):xt!==null&&(xt.elementType===Un||typeof Un=="object"&&Un!==null&&Un.$$typeof===ge&&jm(Un)===xt.type)?(xt=V(xt,Dt.props),Ou(xt,Dt),xt.return=Mt,xt):(xt=At(Dt.type,Dt.key,Dt.props,null,Mt.mode,un),Ou(xt,Dt),xt.return=Mt,xt)}function Tt(Mt,xt,Dt,un){return xt===null||xt.tag!==4||xt.stateNode.containerInfo!==Dt.containerInfo||xt.stateNode.implementation!==Dt.implementation?(xt=dn(Dt,Mt.mode,un),xt.return=Mt,xt):(xt=V(xt,Dt.children||[]),xt.return=Mt,xt)}function en(Mt,xt,Dt,un,Un){return xt===null||xt.tag!==7?(xt=zt(Dt,Mt.mode,un,Un),xt.return=Mt,xt):(xt=V(xt,Dt),xt.return=Mt,xt)}function mn(Mt,xt,Dt){if(typeof xt=="string"&&xt!==""||typeof xt=="number"||typeof xt=="bigint")return xt=on(""+xt,Mt.mode,Dt),xt.return=Mt,xt;if(typeof xt=="object"&&xt!==null){switch(xt.$$typeof){case b:return Dt=At(xt.type,xt.key,xt.props,null,Mt.mode,Dt),Ou(Dt,xt),Dt.return=Mt,Dt;case i:return xt=dn(xt,Mt.mode,Dt),xt.return=Mt,xt;case ge:var un=xt._init;return xt=un(xt._payload),mn(Mt,xt,Dt)}if(Nt(xt)||me(xt))return xt=zt(xt,Mt.mode,Dt,null),xt.return=Mt,xt;if(typeof xt.then=="function")return mn(Mt,Nl(xt),Dt);if(xt.$$typeof===X)return mn(Mt,jp(Mt,xt),Dt);Yf(Mt,xt)}return null}function Ft(Mt,xt,Dt,un){var Un=xt!==null?xt.key:null;if(typeof Dt=="string"&&Dt!==""||typeof Dt=="number"||typeof Dt=="bigint")return Un!==null?null:Be(Mt,xt,""+Dt,un);if(typeof Dt=="object"&&Dt!==null){switch(Dt.$$typeof){case b:return Dt.key===Un?rt(Mt,xt,Dt,un):null;case i:return Dt.key===Un?Tt(Mt,xt,Dt,un):null;case ge:return Un=Dt._init,Dt=Un(Dt._payload),Ft(Mt,xt,Dt,un)}if(Nt(Dt)||me(Dt))return Un!==null?null:en(Mt,xt,Dt,un,null);if(typeof Dt.then=="function")return Ft(Mt,xt,Nl(Dt),un);if(Dt.$$typeof===X)return Ft(Mt,xt,jp(Mt,Dt),un);Yf(Mt,Dt)}return null}function Qt(Mt,xt,Dt,un,Un){if(typeof un=="string"&&un!==""||typeof un=="number"||typeof un=="bigint")return Mt=Mt.get(Dt)||null,Be(xt,Mt,""+un,Un);if(typeof un=="object"&&un!==null){switch(un.$$typeof){case b:return Mt=Mt.get(un.key===null?Dt:un.key)||null,rt(xt,Mt,un,Un);case i:return Mt=Mt.get(un.key===null?Dt:un.key)||null,Tt(xt,Mt,un,Un);case ge:var wr=un._init;return un=wr(un._payload),Qt(Mt,xt,Dt,un,Un)}if(Nt(un)||me(un))return Mt=Mt.get(Dt)||null,en(xt,Mt,un,Un,null);if(typeof un.then=="function")return Qt(Mt,xt,Dt,Nl(un),Un);if(un.$$typeof===X)return Qt(Mt,xt,Dt,jp(xt,un),Un);Yf(xt,un)}return null}function Hn(Mt,xt,Dt,un){for(var Un=null,wr=null,nr=xt,fr=xt=0,Ja=null;nr!==null&&fr<Dt.length;fr++){nr.index>fr?(Ja=nr,nr=null):Ja=nr.sibling;var Jr=Ft(Mt,nr,Dt[fr],un);if(Jr===null){nr===null&&(nr=Ja);break}f&&nr&&Jr.alternate===null&&g(Mt,nr),xt=Q(Jr,xt,fr),wr===null?Un=Jr:wr.sibling=Jr,wr=Jr,nr=Ja}if(fr===Dt.length)return T(Mt,nr),Ur&&Cu(Mt,fr),Un;if(nr===null){for(;fr<Dt.length;fr++)nr=mn(Mt,Dt[fr],un),nr!==null&&(xt=Q(nr,xt,fr),wr===null?Un=nr:wr.sibling=nr,wr=nr);return Ur&&Cu(Mt,fr),Un}for(nr=k(nr);fr<Dt.length;fr++)Ja=Qt(nr,Mt,fr,Dt[fr],un),Ja!==null&&(f&&Ja.alternate!==null&&nr.delete(Ja.key===null?fr:Ja.key),xt=Q(Ja,xt,fr),wr===null?Un=Ja:wr.sibling=Ja,wr=Ja);return f&&nr.forEach(function(sf){return g(Mt,sf)}),Ur&&Cu(Mt,fr),Un}function Ar(Mt,xt,Dt,un){if(Dt==null)throw Error(o(151));for(var Un=null,wr=null,nr=xt,fr=xt=0,Ja=null,Jr=Dt.next();nr!==null&&!Jr.done;fr++,Jr=Dt.next()){nr.index>fr?(Ja=nr,nr=null):Ja=nr.sibling;var sf=Ft(Mt,nr,Jr.value,un);if(sf===null){nr===null&&(nr=Ja);break}f&&nr&&sf.alternate===null&&g(Mt,nr),xt=Q(sf,xt,fr),wr===null?Un=sf:wr.sibling=sf,wr=sf,nr=Ja}if(Jr.done)return T(Mt,nr),Ur&&Cu(Mt,fr),Un;if(nr===null){for(;!Jr.done;fr++,Jr=Dt.next())Jr=mn(Mt,Jr.value,un),Jr!==null&&(xt=Q(Jr,xt,fr),wr===null?Un=Jr:wr.sibling=Jr,wr=Jr);return Ur&&Cu(Mt,fr),Un}for(nr=k(nr);!Jr.done;fr++,Jr=Dt.next())Jr=Qt(nr,Mt,fr,Jr.value,un),Jr!==null&&(f&&Jr.alternate!==null&&nr.delete(Jr.key===null?fr:Jr.key),xt=Q(Jr,xt,fr),wr===null?Un=Jr:wr.sibling=Jr,wr=Jr);return f&&nr.forEach(function(y3){return g(Mt,y3)}),Ur&&Cu(Mt,fr),Un}function Qi(Mt,xt,Dt,un){if(typeof Dt=="object"&&Dt!==null&&Dt.type===C&&Dt.key===null&&(Dt=Dt.props.children),typeof Dt=="object"&&Dt!==null){switch(Dt.$$typeof){case b:e:{for(var Un=Dt.key;xt!==null;){if(xt.key===Un){if(Un=Dt.type,Un===C){if(xt.tag===7){T(Mt,xt.sibling),un=V(xt,Dt.props.children),un.return=Mt,Mt=un;break e}}else if(xt.elementType===Un||typeof Un=="object"&&Un!==null&&Un.$$typeof===ge&&jm(Un)===xt.type){T(Mt,xt.sibling),un=V(xt,Dt.props),Ou(un,Dt),un.return=Mt,Mt=un;break e}T(Mt,xt);break}else g(Mt,xt);xt=xt.sibling}Dt.type===C?(un=zt(Dt.props.children,Mt.mode,un,Dt.key),un.return=Mt,Mt=un):(un=At(Dt.type,Dt.key,Dt.props,null,Mt.mode,un),Ou(un,Dt),un.return=Mt,Mt=un)}return be(Mt);case i:e:{for(Un=Dt.key;xt!==null;){if(xt.key===Un)if(xt.tag===4&&xt.stateNode.containerInfo===Dt.containerInfo&&xt.stateNode.implementation===Dt.implementation){T(Mt,xt.sibling),un=V(xt,Dt.children||[]),un.return=Mt,Mt=un;break e}else{T(Mt,xt);break}else g(Mt,xt);xt=xt.sibling}un=dn(Dt,Mt.mode,un),un.return=Mt,Mt=un}return be(Mt);case ge:return Un=Dt._init,Dt=Un(Dt._payload),Qi(Mt,xt,Dt,un)}if(Nt(Dt))return Hn(Mt,xt,Dt,un);if(me(Dt)){if(Un=me(Dt),typeof Un!="function")throw Error(o(150));return Dt=Un.call(Dt),Ar(Mt,xt,Dt,un)}if(typeof Dt.then=="function")return Qi(Mt,xt,Nl(Dt),un);if(Dt.$$typeof===X)return Qi(Mt,xt,jp(Mt,Dt),un);Yf(Mt,Dt)}return typeof Dt=="string"&&Dt!==""||typeof Dt=="number"||typeof Dt=="bigint"?(Dt=""+Dt,xt!==null&&xt.tag===6?(T(Mt,xt.sibling),un=V(xt,Dt),un.return=Mt,Mt=un):(T(Mt,xt),un=on(Dt,Mt.mode,un),un.return=Mt,Mt=un),be(Mt)):T(Mt,xt)}return function(Mt,xt,Dt,un){try{Mc=0;var Un=Qi(Mt,xt,Dt,un);return Cc=null,Un}catch(nr){if(nr===sl)throw nr;var wr=St(29,nr,null,Mt.mode);return wr.lanes=un,wr.return=Mt,wr}finally{}}}var Co=bp(!0),wp=bp(!1),za=ir(null),Pu=ir(0);function Oh(f,g){f=Ci,Ne(Pu,f),Ne(za,g),Ci=f|g.baseLanes}function Sp(){Ne(Pu,Ci),Ne(za,za.current)}function Ph(){Ci=Pu.current,yn(za),yn(Pu)}var eo=ir(null),_s=null;function Oc(f){var g=f.alternate;Ne(wa,wa.current&1),Ne(eo,f),_s===null&&(g===null||za.current!==null||g.memoizedState!==null)&&(_s=f)}function Tp(f){if(f.tag===22){if(Ne(wa,wa.current),Ne(eo,f),_s===null){var g=f.alternate;g!==null&&g.memoizedState!==null&&(_s=f)}}else Go()}function Go(){Ne(wa,wa.current),Ne(eo,eo.current)}function Fl(f){yn(eo),_s===f&&(_s=null),yn(wa)}var wa=ir(0);function Kf(f){for(var g=f;g!==null;){if(g.tag===13){var T=g.memoizedState;if(T!==null&&(T=T.dehydrated,T===null||T.data==="$?"||T.data==="$!"))return g}else if(g.tag===19&&g.memoizedProps.revealOrder!==void 0){if(g.flags&128)return g}else if(g.child!==null){g.child.return=g,g=g.child;continue}if(g===f)break;for(;g.sibling===null;){if(g.return===null||g.return===f)return null;g=g.return}g.sibling.return=g.return,g=g.sibling}return null}var h_=typeof AbortController<"u"?AbortController:function(){var f=[],g=this.signal={aborted:!1,addEventListener:function(T,k){f.push(k)}};this.abort=function(){g.aborted=!0,f.forEach(function(T){return T()})}},Ep=e.unstable_scheduleCallback,Ih=e.unstable_NormalPriority,Ri={$$typeof:X,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Rh(){return{controller:new h_,data:new Map,refCount:0}}function jl(f){f.refCount--,f.refCount===0&&Ep(Ih,function(){f.controller.abort()})}var Dh=null,Iu=0,ll=0,Pc=null;function f_(f,g){if(Dh===null){var T=Dh=[];Iu=0,ll=I_(),Pc={status:"pending",value:void 0,then:function(k){T.push(k)}}}return Iu++,g.then(d_,d_),g}function d_(){if(--Iu===0&&Dh!==null){Pc!==null&&(Pc.status="fulfilled");var f=Dh;Dh=null,ll=0,Pc=null;for(var g=0;g<f.length;g++)(0,f[g])()}}function Ru(f,g){var T=[],k={status:"pending",value:null,reason:null,then:function(V){T.push(V)}};return f.then(function(){k.status="fulfilled",k.value=g;for(var V=0;V<T.length;V++)(0,T[V])(g)},function(V){for(k.status="rejected",k.reason=V,V=0;V<T.length;V++)(0,T[V])(void 0)}),k}var Jf=He.S;He.S=function(f,g){typeof g=="object"&&g!==null&&typeof g.then=="function"&&f_(f,g),Jf!==null&&Jf(f,g)};var hn=ir(null);function Qf(){var f=hn.current;return f!==null?f:Pn.pooledCache}function Lh(f,g){g===null?Ne(hn,hn.current):Ne(hn,g.pool)}function Ul(){var f=Qf();return f===null?null:{parent:Ri._currentValue,pool:f}}var Mo=0,Yt=null,ti=null,oa=null,Ap=!1,Vl=!1,$l=!1,kh=0,zh=0,Ic=null,ed=0;function Di(){throw Error(o(321))}function td(f,g){if(g===null)return!1;for(var T=0;T<g.length&&T<f.length;T++)if(!xa(f[T],g[T]))return!1;return!0}function gs(f,g,T,k,V,Q){return Mo=Q,Yt=g,g.memoizedState=null,g.updateQueue=null,g.lanes=0,He.H=f===null||f.memoizedState===null?qs:mo,$l=!1,Q=T(k,V),$l=!1,Vl&&(Q=ql(g,T,k,V)),po(f),Q}function po(f){He.H=xs;var g=ti!==null&&ti.next!==null;if(Mo=0,oa=ti=Yt=null,Ap=!1,zh=0,Ic=null,g)throw Error(o(300));f===null||Ta||(f=f.dependencies,f!==null&&dl(f)&&(Ta=!0))}function ql(f,g,T,k){Yt=f;var V=0;do{if(Vl&&(Ic=null),zh=0,Vl=!1,25<=V)throw Error(o(301));if(V+=1,oa=ti=null,f.updateQueue!=null){var Q=f.updateQueue;Q.lastEffect=null,Q.events=null,Q.stores=null,Q.memoCache!=null&&(Q.memoCache.index=0)}He.H=hl,Q=g(T,k)}while(Vl);return Q}function Um(){var f=He.H,g=f.useState()[0];return g=typeof g.then=="function"?Dc(g):g,f=f.useState()[0],(ti!==null?ti.memoizedState:null)!==f&&(Yt.flags|=1024),g}function nd(){var f=kh!==0;return kh=0,f}function Rc(f,g,T){g.updateQueue=f.updateQueue,g.flags&=-2053,f.lanes&=~T}function Bh(f){if(Ap){for(f=f.memoizedState;f!==null;){var g=f.queue;g!==null&&(g.pending=null),f=f.next}Ap=!1}Mo=0,oa=ti=Yt=null,Vl=!1,zh=kh=0,Ic=null}function Ba(){var f={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return oa===null?Yt.memoizedState=oa=f:oa=oa.next=f,oa}function Yr(){if(ti===null){var f=Yt.alternate;f=f!==null?f.memoizedState:null}else f=ti.next;var g=oa===null?Yt.memoizedState:oa.next;if(g!==null)oa=g,ti=f;else{if(f===null)throw Yt.alternate===null?Error(o(467)):Error(o(310));ti=f,f={memoizedState:ti.memoizedState,baseState:ti.baseState,baseQueue:ti.baseQueue,queue:ti.queue,next:null},oa===null?Yt.memoizedState=oa=f:oa=oa.next=f}return oa}var zr;zr=function(){return{lastEffect:null,events:null,stores:null,memoCache:null}};function Dc(f){var g=zh;return zh+=1,Ic===null&&(Ic=[]),f=u_(Ic,f,g),g=Yt,(oa===null?g.memoizedState:oa.next)===null&&(g=g.alternate,He.H=g===null||g.memoizedState===null?qs:mo),f}function Lc(f){if(f!==null&&typeof f=="object"){if(typeof f.then=="function")return Dc(f);if(f.$$typeof===X)return to(f)}throw Error(o(438,String(f)))}function Nh(f){var g=null,T=Yt.updateQueue;if(T!==null&&(g=T.memoCache),g==null){var k=Yt.alternate;k!==null&&(k=k.updateQueue,k!==null&&(k=k.memoCache,k!=null&&(g={data:k.data.map(function(V){return V.slice()}),index:0})))}if(g==null&&(g={data:[],index:0}),T===null&&(T=zr(),Yt.updateQueue=T),T.memoCache=g,T=g.data[g.index],T===void 0)for(T=g.data[g.index]=Array(f),k=0;k<f;k++)T[k]=xe;return g.index++,T}function Vs(f,g){return typeof g=="function"?g(f):g}function kc(f){var g=Yr();return zc(g,ti,f)}function zc(f,g,T){var k=f.queue;if(k===null)throw Error(o(311));k.lastRenderedReducer=T;var V=f.baseQueue,Q=k.pending;if(Q!==null){if(V!==null){var be=V.next;V.next=Q.next,Q.next=be}g.baseQueue=V=Q,k.pending=null}if(Q=f.baseState,V===null)f.memoizedState=Q;else{g=V.next;var Be=be=null,rt=null,Tt=g,en=!1;do{var mn=Tt.lane&-536870913;if(mn!==Tt.lane?(In&mn)===mn:(Mo&mn)===mn){var Ft=Tt.revertLane;if(Ft===0)rt!==null&&(rt=rt.next={lane:0,revertLane:0,action:Tt.action,hasEagerState:Tt.hasEagerState,eagerState:Tt.eagerState,next:null}),mn===ll&&(en=!0);else if((Mo&Ft)===Ft){Tt=Tt.next,Ft===ll&&(en=!0);continue}else mn={lane:0,revertLane:Tt.revertLane,action:Tt.action,hasEagerState:Tt.hasEagerState,eagerState:Tt.eagerState,next:null},rt===null?(Be=rt=mn,be=Q):rt=rt.next=mn,Yt.lanes|=Ft,Er|=Ft;mn=Tt.action,$l&&T(Q,mn),Q=Tt.hasEagerState?Tt.eagerState:T(Q,mn)}else Ft={lane:mn,revertLane:Tt.revertLane,action:Tt.action,hasEagerState:Tt.hasEagerState,eagerState:Tt.eagerState,next:null},rt===null?(Be=rt=Ft,be=Q):rt=rt.next=Ft,Yt.lanes|=mn,Er|=mn;Tt=Tt.next}while(Tt!==null&&Tt!==g);if(rt===null?be=Q:rt.next=Be,!xa(Q,f.memoizedState)&&(Ta=!0,en&&(T=Pc,T!==null)))throw T;f.memoizedState=Q,f.baseState=be,f.baseQueue=rt,k.lastRenderedState=Q}return V===null&&(k.lanes=0),[f.memoizedState,k.dispatch]}function Bc(f){var g=Yr(),T=g.queue;if(T===null)throw Error(o(311));T.lastRenderedReducer=f;var k=T.dispatch,V=T.pending,Q=g.memoizedState;if(V!==null){T.pending=null;var be=V=V.next;do Q=f(Q,be.action),be=be.next;while(be!==V);xa(Q,g.memoizedState)||(Ta=!0),g.memoizedState=Q,g.baseQueue===null&&(g.baseState=Q),T.lastRenderedState=Q}return[Q,k]}function Du(f,g,T){var k=Yt,V=Yr(),Q=Ur;if(Q){if(T===void 0)throw Error(o(407));T=T()}else T=g();var be=!xa((ti||V).memoizedState,T);if(be&&(V.memoizedState=T,Ta=!0),V=V.queue,$i(Lu.bind(null,k,V,f),[f]),V.getSnapshot!==g||be||oa!==null&&oa.memoizedState.tag&1){if(k.flags|=2048,ys(9,cn.bind(null,k,V,T,g),{destroy:void 0},null),Pn===null)throw Error(o(349));Q||Mo&60||qt(k,g,T)}return T}function qt(f,g,T){f.flags|=16384,f={getSnapshot:g,value:T},g=Yt.updateQueue,g===null?(g=zr(),Yt.updateQueue=g,g.stores=[f]):(T=g.stores,T===null?g.stores=[f]:T.push(f))}function cn(f,g,T,k){g.value=T,g.getSnapshot=k,ni(g)&&st(f)}function Lu(f,g,T){return T(function(){ni(g)&&st(f)})}function ni(f){var g=f.getSnapshot;f=f.value;try{var T=g();return!xa(f,T)}catch{return!0}}function st(f){var g=$o(f,2);g!==null&&Qo(g,f,2)}function Cp(f){var g=Ba();if(typeof f=="function"){var T=f;if(f=T(),$l){ra(!0);try{T()}finally{ra(!1)}}}return g.memoizedState=g.baseState=f,g.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Vs,lastRenderedState:f},g}function rd(f,g,T,k){return f.baseState=T,zc(f,ti,typeof k=="function"?k:Vs)}function Vm(f,g,T,k,V){if(Vh(f))throw Error(o(485));if(f=g.action,f!==null){var Q={payload:V,action:f,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(be){Q.listeners.push(be)}};He.T!==null?T(!0):Q.isTransition=!1,k(Q),T=g.pending,T===null?(Q.next=g.pending=Q,$m(g,Q)):(Q.next=T.next,g.pending=T.next=Q)}}function $m(f,g){var T=g.action,k=g.payload,V=f.state;if(g.isTransition){var Q=He.T,be={};He.T=be;try{var Be=T(V,k),rt=He.S;rt!==null&&rt(be,Be),qm(f,g,Be)}catch(Tt){Nc(f,g,Tt)}finally{He.T=Q}}else try{Q=T(V,k),qm(f,g,Q)}catch(Tt){Nc(f,g,Tt)}}function qm(f,g,T){T!==null&&typeof T=="object"&&typeof T.then=="function"?T.then(function(k){Gm(f,g,k)},function(k){return Nc(f,g,k)}):Gm(f,g,T)}function Gm(f,g,T){g.status="fulfilled",g.value=T,p_(g),f.state=T,g=f.pending,g!==null&&(T=g.next,T===g?f.pending=null:(T=T.next,g.next=T,$m(f,T)))}function Nc(f,g,T){var k=f.pending;if(f.pending=null,k!==null){k=k.next;do g.status="rejected",g.reason=T,p_(g),g=g.next;while(g!==k)}f.action=null}function p_(f){f=f.listeners;for(var g=0;g<f.length;g++)(0,f[g])()}function m_(f,g){return g}function Hm(f,g){if(Ur){var T=Pn.formState;if(T!==null){e:{var k=Yt;if(Ur){if(ba){t:{for(var V=ba,Q=ms;V.nodeType!==8;){if(!Q){V=null;break t}if(V=Kl(V.nextSibling),V===null){V=null;break t}}Q=V.data,V=Q==="F!"||Q==="F"?V:null}if(V){ba=Kl(V.nextSibling),k=V.data==="F!";break e}}ol(k)}k=!1}k&&(g=T[0])}}return T=Ba(),T.memoizedState=T.baseState=g,k={pending:null,lanes:0,dispatch:null,lastRenderedReducer:m_,lastRenderedState:g},T.queue=k,T=Ip.bind(null,Yt,k),k.dispatch=T,k=Cp(!1),Q=cd.bind(null,Yt,!1,k.queue),k=Ba(),V={state:g,dispatch:null,action:f,pending:null},k.queue=V,T=Vm.bind(null,Yt,V,Q,T),V.dispatch=T,k.memoizedState=f,[g,T,!1]}function id(f){var g=Yr();return Gl(g,ti,f)}function Gl(f,g,T){g=zc(f,g,m_)[0],f=kc(Vs)[0],g=typeof g=="object"&&g!==null&&typeof g.then=="function"?Dc(g):g;var k=Yr(),V=k.queue,Q=V.dispatch;return T!==k.memoizedState&&(Yt.flags|=2048,ys(9,Zm.bind(null,V,T),{destroy:void 0},null)),[g,Q,f]}function Zm(f,g){f.action=g}function Mp(f){var g=Yr(),T=ti;if(T!==null)return Gl(g,T,f);Yr(),g=g.memoizedState,T=Yr();var k=T.queue.dispatch;return T.memoizedState=f,[g,k,!1]}function ys(f,g,T,k){return f={tag:f,create:g,inst:T,deps:k,next:null},g=Yt.updateQueue,g===null&&(g=zr(),Yt.updateQueue=g),T=g.lastEffect,T===null?g.lastEffect=f.next=f:(k=T.next,T.next=f,f.next=k,g.lastEffect=f),f}function ad(){return Yr().memoizedState}function Ho(f,g,T,k){var V=Ba();Yt.flags|=f,V.memoizedState=ys(1|g,T,{destroy:void 0},k===void 0?null:k)}function vs(f,g,T,k){var V=Yr();k=k===void 0?null:k;var Q=V.memoizedState.inst;ti!==null&&k!==null&&td(k,ti.memoizedState.deps)?V.memoizedState=ys(g,T,Q,k):(Yt.flags|=f,V.memoizedState=ys(1|g,T,Q,k))}function Wm(f,g){Ho(8390656,8,f,g)}function $i(f,g){vs(2048,8,f,g)}function __(f,g){return vs(4,2,f,g)}function Fh(f,g){return vs(4,4,f,g)}function $r(f,g){if(typeof g=="function"){f=f();var T=g(f);return function(){typeof T=="function"?T():g(null)}}if(g!=null)return f=f(),g.current=f,function(){g.current=null}}function br(f,g,T){T=T!=null?T.concat([f]):null,vs(4,4,$r.bind(null,g,f),T)}function Op(){}function cl(f,g){var T=Yr();g=g===void 0?null:g;var k=T.memoizedState;return g!==null&&td(g,k[1])?k[0]:(T.memoizedState=[f,g],f)}function ku(f,g){var T=Yr();g=g===void 0?null:g;var k=T.memoizedState;if(g!==null&&td(g,k[1]))return k[0];if(k=f(),$l){ra(!0);try{f()}finally{ra(!1)}}return T.memoizedState=[k,g],k}function $s(f,g,T){return T===void 0||Mo&1073741824?f.memoizedState=g:(f.memoizedState=T,f=k2(),Yt.lanes|=f,Er|=f,T)}function od(f,g,T,k){return xa(T,g)?T:za.current!==null?(f=$s(f,T,k),xa(f,g)||(Ta=!0),f):Mo&42?(f=k2(),Yt.lanes|=f,Er|=f,g):(Ta=!0,f.memoizedState=T)}function jh(f,g,T,k,V){var Q=xn.p;xn.p=Q!==0&&8>Q?Q:8;var be=He.T,Be={};He.T=Be,cd(f,!1,g,T);try{var rt=V(),Tt=He.S;if(Tt!==null&&Tt(Be,rt),rt!==null&&typeof rt=="object"&&typeof rt.then=="function"){var en=Ru(rt,k);Uc(f,g,en,Es(f))}else Uc(f,g,k,Es(f))}catch(mn){Uc(f,g,{then:function(){},status:"rejected",reason:mn},Es())}finally{xn.p=Q,He.T=be}}function ul(){}function Sa(f,g,T,k){if(f.tag!==5)throw Error(o(476));var V=sd(f).queue;jh(f,V,g,rr,T===null?ul:function(){return Uh(f),T(k)})}function sd(f){var g=f.memoizedState;if(g!==null)return g;g={memoizedState:rr,baseState:rr,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Vs,lastRenderedState:rr},next:null};var T={};return g.next={memoizedState:T,baseState:T,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Vs,lastRenderedState:T},next:null},f.memoizedState=g,f=f.alternate,f!==null&&(f.memoizedState=g),g}function Uh(f){var g=sd(f).next.queue;Uc(f,g,{},Es())}function ld(){return to(Od)}function Pp(){return Yr().memoizedState}function Fc(){return Yr().memoizedState}function Xm(f){for(var g=f.return;g!==null;){switch(g.tag){case 24:case 3:var T=Es();f=Xo(T);var k=Wl(g,f,T);k!==null&&(Qo(k,g,T),Wh(k,g,T)),g={cache:Rh()},f.payload=g;return}g=g.return}}function jc(f,g,T){var k=Es();T={lane:k,revertLane:0,action:T,hasEagerState:!1,eagerState:null,next:null},Vh(f)?sa(g,T):(T=Su(f,g,T,k),T!==null&&(Qo(T,f,k),Rp(T,g,k)))}function Ip(f,g,T){var k=Es();Uc(f,g,T,k)}function Uc(f,g,T,k){var V={lane:k,revertLane:0,action:T,hasEagerState:!1,eagerState:null,next:null};if(Vh(f))sa(g,V);else{var Q=f.alternate;if(f.lanes===0&&(Q===null||Q.lanes===0)&&(Q=g.lastRenderedReducer,Q!==null))try{var be=g.lastRenderedState,Be=Q(be,T);if(V.hasEagerState=!0,V.eagerState=Be,xa(Be,be))return wu(f,g,V,0),Pn===null&&Tc(),!1}catch{}finally{}if(T=Su(f,g,V,k),T!==null)return Qo(T,f,k),Rp(T,g,k),!0}return!1}function cd(f,g,T,k){if(k={lane:2,revertLane:I_(),action:k,hasEagerState:!1,eagerState:null,next:null},Vh(f)){if(g)throw Error(o(479))}else g=Su(f,T,k,2),g!==null&&Qo(g,f,2)}function Vh(f){var g=f.alternate;return f===Yt||g!==null&&g===Yt}function sa(f,g){Vl=Ap=!0;var T=f.pending;T===null?g.next=g:(g.next=T.next,T.next=g),f.pending=g}function Rp(f,g,T){if(T&4194176){var k=g.lanes;k&=f.pendingLanes,T|=k,g.lanes=T,ph(f,T)}}var xs={readContext:to,use:Lc,useCallback:Di,useContext:Di,useEffect:Di,useImperativeHandle:Di,useLayoutEffect:Di,useInsertionEffect:Di,useMemo:Di,useReducer:Di,useRef:Di,useState:Di,useDebugValue:Di,useDeferredValue:Di,useTransition:Di,useSyncExternalStore:Di,useId:Di};xs.useCacheRefresh=Di,xs.useMemoCache=Di,xs.useHostTransitionStatus=Di,xs.useFormState=Di,xs.useActionState=Di,xs.useOptimistic=Di;var qs={readContext:to,use:Lc,useCallback:function(f,g){return Ba().memoizedState=[f,g===void 0?null:g],f},useContext:to,useEffect:Wm,useImperativeHandle:function(f,g,T){T=T!=null?T.concat([f]):null,Ho(4194308,4,$r.bind(null,g,f),T)},useLayoutEffect:function(f,g){return Ho(4194308,4,f,g)},useInsertionEffect:function(f,g){Ho(4,2,f,g)},useMemo:function(f,g){var T=Ba();g=g===void 0?null:g;var k=f();if($l){ra(!0);try{f()}finally{ra(!1)}}return T.memoizedState=[k,g],k},useReducer:function(f,g,T){var k=Ba();if(T!==void 0){var V=T(g);if($l){ra(!0);try{T(g)}finally{ra(!1)}}}else V=g;return k.memoizedState=k.baseState=V,f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:f,lastRenderedState:V},k.queue=f,f=f.dispatch=jc.bind(null,Yt,f),[k.memoizedState,f]},useRef:function(f){var g=Ba();return f={current:f},g.memoizedState=f},useState:function(f){f=Cp(f);var g=f.queue,T=Ip.bind(null,Yt,g);return g.dispatch=T,[f.memoizedState,T]},useDebugValue:Op,useDeferredValue:function(f,g){var T=Ba();return $s(T,f,g)},useTransition:function(){var f=Cp(!1);return f=jh.bind(null,Yt,f.queue,!0,!1),Ba().memoizedState=f,[!1,f]},useSyncExternalStore:function(f,g,T){var k=Yt,V=Ba();if(Ur){if(T===void 0)throw Error(o(407));T=T()}else{if(T=g(),Pn===null)throw Error(o(349));In&60||qt(k,g,T)}V.memoizedState=T;var Q={value:T,getSnapshot:g};return V.queue=Q,Wm(Lu.bind(null,k,Q,f),[f]),k.flags|=2048,ys(9,cn.bind(null,k,Q,T,g),{destroy:void 0},null),T},useId:function(){var f=Ba(),g=Pn.identifierPrefix;if(Ur){var T=al,k=il;T=(k&~(1<<32-pa(k)-1)).toString(32)+T,g=":"+g+"R"+T,T=kh++,0<T&&(g+="H"+T.toString(32)),g+=":"}else T=ed++,g=":"+g+"r"+T.toString(32)+":";return f.memoizedState=g},useCacheRefresh:function(){return Ba().memoizedState=Xm.bind(null,Yt)}};qs.useMemoCache=Nh,qs.useHostTransitionStatus=ld,qs.useFormState=Hm,qs.useActionState=Hm,qs.useOptimistic=function(f){var g=Ba();g.memoizedState=g.baseState=f;var T={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return g.queue=T,g=cd.bind(null,Yt,!0,T),T.dispatch=g,[f,g]};var mo={readContext:to,use:Lc,useCallback:cl,useContext:to,useEffect:$i,useImperativeHandle:br,useInsertionEffect:__,useLayoutEffect:Fh,useMemo:ku,useReducer:kc,useRef:ad,useState:function(){return kc(Vs)},useDebugValue:Op,useDeferredValue:function(f,g){var T=Yr();return od(T,ti.memoizedState,f,g)},useTransition:function(){var f=kc(Vs)[0],g=Yr().memoizedState;return[typeof f=="boolean"?f:Dc(f),g]},useSyncExternalStore:Du,useId:Pp};mo.useCacheRefresh=Fc,mo.useMemoCache=Nh,mo.useHostTransitionStatus=ld,mo.useFormState=id,mo.useActionState=id,mo.useOptimistic=function(f,g){var T=Yr();return rd(T,ti,f,g)};var hl={readContext:to,use:Lc,useCallback:cl,useContext:to,useEffect:$i,useImperativeHandle:br,useInsertionEffect:__,useLayoutEffect:Fh,useMemo:ku,useReducer:Bc,useRef:ad,useState:function(){return Bc(Vs)},useDebugValue:Op,useDeferredValue:function(f,g){var T=Yr();return ti===null?$s(T,f,g):od(T,ti.memoizedState,f,g)},useTransition:function(){var f=Bc(Vs)[0],g=Yr().memoizedState;return[typeof f=="boolean"?f:Dc(f),g]},useSyncExternalStore:Du,useId:Pp};hl.useCacheRefresh=Fc,hl.useMemoCache=Nh,hl.useHostTransitionStatus=ld,hl.useFormState=Mp,hl.useActionState=Mp,hl.useOptimistic=function(f,g){var T=Yr();return ti!==null?rd(T,ti,f,g):(T.baseState=f,[f,T.queue.dispatch])};function bs(f,g,T,k){g=f.memoizedState,T=T(k,g),T=T==null?g:ye({},g,T),f.memoizedState=T,f.lanes===0&&(f.updateQueue.baseState=T)}var $h={isMounted:function(f){return(f=f._reactInternals)?Ht(f)===f:!1},enqueueSetState:function(f,g,T){f=f._reactInternals;var k=Es(),V=Xo(k);V.payload=g,T!=null&&(V.callback=T),g=Wl(f,V,k),g!==null&&(Qo(g,f,k),Wh(g,f,k))},enqueueReplaceState:function(f,g,T){f=f._reactInternals;var k=Es(),V=Xo(k);V.tag=1,V.payload=g,T!=null&&(V.callback=T),g=Wl(f,V,k),g!==null&&(Qo(g,f,k),Wh(g,f,k))},enqueueForceUpdate:function(f,g){f=f._reactInternals;var T=Es(),k=Xo(T);k.tag=2,g!=null&&(k.callback=g),g=Wl(f,k,T),g!==null&&(Qo(g,f,T),Wh(g,f,T))}};function zu(f,g,T,k,V,Q,be){return f=f.stateNode,typeof f.shouldComponentUpdate=="function"?f.shouldComponentUpdate(k,Q,be):g.prototype&&g.prototype.isPureReactComponent?!Us(T,k)||!Us(V,Q):!0}function Dp(f,g,T,k){f=g.state,typeof g.componentWillReceiveProps=="function"&&g.componentWillReceiveProps(T,k),typeof g.UNSAFE_componentWillReceiveProps=="function"&&g.UNSAFE_componentWillReceiveProps(T,k),g.state!==f&&$h.enqueueReplaceState(g,g.state,null)}function Hl(f,g){var T=g;if("ref"in g){T={};for(var k in g)k!=="ref"&&(T[k]=g[k])}if(f=f.defaultProps){T===g&&(T=ye({},T));for(var V in f)T[V]===void 0&&(T[V]=f[V])}return T}var Vc=typeof reportError=="function"?reportError:function(f){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var g=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof f=="object"&&f!==null&&typeof f.message=="string"?String(f.message):String(f),error:f});if(!window.dispatchEvent(g))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",f);return}console.error(f)};function qh(f){Vc(f)}function Lp(f){console.error(f)}function ud(f){Vc(f)}function hd(f,g){try{var T=f.onUncaughtError;T(g.value,{componentStack:g.stack})}catch(k){setTimeout(function(){throw k})}}function kp(f,g,T){try{var k=f.onCaughtError;k(T.value,{componentStack:T.stack,errorBoundary:g.tag===1?g.stateNode:null})}catch(V){setTimeout(function(){throw V})}}function Bu(f,g,T){return T=Xo(T),T.tag=3,T.payload={element:null},T.callback=function(){hd(f,g)},T}function Ym(f){return f=Xo(f),f.tag=3,f}function Km(f,g,T,k){var V=T.type.getDerivedStateFromError;if(typeof V=="function"){var Q=k.value;f.payload=function(){return V(Q)},f.callback=function(){kp(g,T,k)}}var be=T.stateNode;be!==null&&typeof be.componentDidCatch=="function"&&(f.callback=function(){kp(g,T,k),typeof V!="function"&&(Ea===null?Ea=new Set([this]):Ea.add(this));var Be=k.stack;this.componentDidCatch(k.value,{componentStack:Be!==null?Be:""})})}function g_(f,g,T,k,V){if(T.flags|=32768,k!==null&&typeof k=="object"&&typeof k.then=="function"){if(g=T.alternate,g!==null&&Ss(g,T,V,!0),T=eo.current,T!==null){switch(T.tag){case 13:return _s===null?vd():T.alternate===null&&hr===0&&(hr=3),T.flags&=-257,T.flags|=65536,T.lanes=V,k===Fm?T.flags|=16384:(g=T.updateQueue,g===null?T.updateQueue=new Set([k]):g.add(k),Jh(f,k,V)),!1;case 22:return T.flags|=65536,k===Fm?T.flags|=16384:(g=T.updateQueue,g===null?(g={transitions:null,markerInstances:null,retryQueue:new Set([k])},T.updateQueue=g):(T=g.retryQueue,T===null?g.retryQueue=new Set([k]):T.add(k)),Jh(f,k,V)),!1}throw Error(o(435,T.tag))}return Jh(f,k,V),vd(),!1}if(Ur)return g=eo.current,g!==null?(!(g.flags&65536)&&(g.flags|=256),g.flags|=65536,g.lanes=V,k!==Wf&&(f=Error(o(422),{cause:k}),Mh(qo(f,T)))):(k!==Wf&&(g=Error(o(423),{cause:k}),Mh(qo(g,T))),f=f.current.alternate,f.flags|=65536,V&=-V,f.lanes|=V,k=qo(k,T),V=Bu(f.stateNode,k,V),qc(f,V),hr!==4&&(hr=2)),!1;var Q=Error(o(520),{cause:k});if(Q=qo(Q,T),Or===null?Or=[Q]:Or.push(Q),hr!==4&&(hr=2),g===null)return!0;k=qo(k,T),T=g;do{switch(T.tag){case 3:return T.flags|=65536,f=V&-V,T.lanes|=f,f=Bu(T.stateNode,k,f),qc(T,f),!1;case 1:if(g=T.type,Q=T.stateNode,(T.flags&128)===0&&(typeof g.getDerivedStateFromError=="function"||Q!==null&&typeof Q.componentDidCatch=="function"&&(Ea===null||!Ea.has(Q))))return T.flags|=65536,V&=-V,T.lanes|=V,V=Ym(V),Km(V,f,T,k),qc(T,V),!1}T=T.return}while(T!==null);return!1}var Jm=Error(o(461)),Ta=!1;function Ji(f,g,T,k){g.child=f===null?wp(g,null,T,k):Co(g,f.child,T,k)}function Gh(f,g,T,k,V){T=T.render;var Q=g.ref;if("ref"in k){var be={};for(var Be in k)Be!=="ref"&&(be[Be]=k[Be])}else be=k;return Po(g),k=gs(f,g,T,be,Q,V),Be=nd(),f!==null&&!Ta?(Rc(f,g,V),fl(f,g,V)):(Ur&&Be&&Mu(g),g.flags|=1,Ji(f,g,k,V),g.child)}function _o(f,g,T,k,V){if(f===null){var Q=T.type;return typeof Q=="function"&&!mt(Q)&&Q.defaultProps===void 0&&T.compare===null?(g.tag=15,g.type=Q,Hh(f,g,Q,k,V)):(f=At(T.type,null,k,g,g.mode,V),f.ref=g.ref,f.return=g,g.child=f)}if(Q=f.child,!Np(f,V)){var be=Q.memoizedProps;if(T=T.compare,T=T!==null?T:Us,T(be,k)&&f.ref===g.ref)return fl(f,g,V)}return g.flags|=1,f=Gt(Q,k),f.ref=g.ref,f.return=g,g.child=f}function Hh(f,g,T,k,V){if(f!==null){var Q=f.memoizedProps;if(Us(Q,k)&&f.ref===g.ref)if(Ta=!1,g.pendingProps=k=Q,Np(f,V))f.flags&131072&&(Ta=!0);else return g.lanes=f.lanes,fl(f,g,V)}return ci(f,g,T,k,V)}function Qm(f,g,T){var k=g.pendingProps,V=k.children,Q=(g.stateNode._pendingVisibility&2)!==0,be=f!==null?f.memoizedState:null;if(fd(f,g),k.mode==="hidden"||Q){if(g.flags&128){if(k=be!==null?be.baseLanes|T:T,f!==null){for(V=g.child=f.child,Q=0;V!==null;)Q=Q|V.lanes|V.childLanes,V=V.sibling;g.childLanes=Q&~k}else g.childLanes=0,g.child=null;return y_(f,g,k,T)}if(T&536870912)g.memoizedState={baseLanes:0,cachePool:null},f!==null&&Lh(g,be!==null?be.cachePool:null),be!==null?Oh(g,be):Sp(),Tp(g);else return g.lanes=g.childLanes=536870912,y_(f,g,be!==null?be.baseLanes|T:T,T)}else be!==null?(Lh(g,be.cachePool),Oh(g,be),Go(),g.memoizedState=null):(f!==null&&Lh(g,null),Sp(),Go());return Ji(f,g,V,T),g.child}function y_(f,g,T,k){var V=Qf();return V=V===null?null:{parent:Ri._currentValue,pool:V},g.memoizedState={baseLanes:T,cachePool:V},f!==null&&Lh(g,null),Sp(),Tp(g),f!==null&&Ss(f,g,k,!0),null}function fd(f,g){var T=g.ref;if(T===null)f!==null&&f.ref!==null&&(g.flags|=2097664);else{if(typeof T!="function"&&typeof T!="object")throw Error(o(284));(f===null||f.ref!==T)&&(g.flags|=2097664)}}function ci(f,g,T,k,V){return Po(g),T=gs(f,g,T,k,void 0,V),k=nd(),f!==null&&!Ta?(Rc(f,g,V),fl(f,g,V)):(Ur&&k&&Mu(g),g.flags|=1,Ji(f,g,T,V),g.child)}function dd(f,g,T,k,V,Q){return Po(g),g.updateQueue=null,T=ql(g,k,T,V),po(f),k=nd(),f!==null&&!Ta?(Rc(f,g,Q),fl(f,g,Q)):(Ur&&k&&Mu(g),g.flags|=1,Ji(f,g,T,Q),g.child)}function v_(f,g,T,k,V){if(Po(g),g.stateNode===null){var Q=Tu,be=T.contextType;typeof be=="object"&&be!==null&&(Q=to(be)),Q=new T(k,Q),g.memoizedState=Q.state!==null&&Q.state!==void 0?Q.state:null,Q.updater=$h,g.stateNode=Q,Q._reactInternals=g,Q=g.stateNode,Q.props=k,Q.state=g.memoizedState,Q.refs={},Up(g),be=T.contextType,Q.context=typeof be=="object"&&be!==null?to(be):Tu,Q.state=g.memoizedState,be=T.getDerivedStateFromProps,typeof be=="function"&&(bs(g,T,be,k),Q.state=g.memoizedState),typeof T.getDerivedStateFromProps=="function"||typeof Q.getSnapshotBeforeUpdate=="function"||typeof Q.UNSAFE_componentWillMount!="function"&&typeof Q.componentWillMount!="function"||(be=Q.state,typeof Q.componentWillMount=="function"&&Q.componentWillMount(),typeof Q.UNSAFE_componentWillMount=="function"&&Q.UNSAFE_componentWillMount(),be!==Q.state&&$h.enqueueReplaceState(Q,Q.state,null),Ya(g,k,Q,V),Xa(),Q.state=g.memoizedState),typeof Q.componentDidMount=="function"&&(g.flags|=4194308),k=!0}else if(f===null){Q=g.stateNode;var Be=g.memoizedProps,rt=Hl(T,Be);Q.props=rt;var Tt=Q.context,en=T.contextType;be=Tu,typeof en=="object"&&en!==null&&(be=to(en));var mn=T.getDerivedStateFromProps;en=typeof mn=="function"||typeof Q.getSnapshotBeforeUpdate=="function",Be=g.pendingProps!==Be,en||typeof Q.UNSAFE_componentWillReceiveProps!="function"&&typeof Q.componentWillReceiveProps!="function"||(Be||Tt!==be)&&Dp(g,Q,k,be),Zs=!1;var Ft=g.memoizedState;Q.state=Ft,Ya(g,k,Q,V),Xa(),Tt=g.memoizedState,Be||Ft!==Tt||Zs?(typeof mn=="function"&&(bs(g,T,mn,k),Tt=g.memoizedState),(rt=Zs||zu(g,T,rt,k,Ft,Tt,be))?(en||typeof Q.UNSAFE_componentWillMount!="function"&&typeof Q.componentWillMount!="function"||(typeof Q.componentWillMount=="function"&&Q.componentWillMount(),typeof Q.UNSAFE_componentWillMount=="function"&&Q.UNSAFE_componentWillMount()),typeof Q.componentDidMount=="function"&&(g.flags|=4194308)):(typeof Q.componentDidMount=="function"&&(g.flags|=4194308),g.memoizedProps=k,g.memoizedState=Tt),Q.props=k,Q.state=Tt,Q.context=be,k=rt):(typeof Q.componentDidMount=="function"&&(g.flags|=4194308),k=!1)}else{Q=g.stateNode,Na(f,g),be=g.memoizedProps,en=Hl(T,be),Q.props=en,mn=g.pendingProps,Ft=Q.context,Tt=T.contextType,rt=Tu,typeof Tt=="object"&&Tt!==null&&(rt=to(Tt)),Be=T.getDerivedStateFromProps,(Tt=typeof Be=="function"||typeof Q.getSnapshotBeforeUpdate=="function")||typeof Q.UNSAFE_componentWillReceiveProps!="function"&&typeof Q.componentWillReceiveProps!="function"||(be!==mn||Ft!==rt)&&Dp(g,Q,k,rt),Zs=!1,Ft=g.memoizedState,Q.state=Ft,Ya(g,k,Q,V),Xa();var Qt=g.memoizedState;be!==mn||Ft!==Qt||Zs||f!==null&&f.dependencies!==null&&dl(f.dependencies)?(typeof Be=="function"&&(bs(g,T,Be,k),Qt=g.memoizedState),(en=Zs||zu(g,T,en,k,Ft,Qt,rt)||f!==null&&f.dependencies!==null&&dl(f.dependencies))?(Tt||typeof Q.UNSAFE_componentWillUpdate!="function"&&typeof Q.componentWillUpdate!="function"||(typeof Q.componentWillUpdate=="function"&&Q.componentWillUpdate(k,Qt,rt),typeof Q.UNSAFE_componentWillUpdate=="function"&&Q.UNSAFE_componentWillUpdate(k,Qt,rt)),typeof Q.componentDidUpdate=="function"&&(g.flags|=4),typeof Q.getSnapshotBeforeUpdate=="function"&&(g.flags|=1024)):(typeof Q.componentDidUpdate!="function"||be===f.memoizedProps&&Ft===f.memoizedState||(g.flags|=4),typeof Q.getSnapshotBeforeUpdate!="function"||be===f.memoizedProps&&Ft===f.memoizedState||(g.flags|=1024),g.memoizedProps=k,g.memoizedState=Qt),Q.props=k,Q.state=Qt,Q.context=rt,k=en):(typeof Q.componentDidUpdate!="function"||be===f.memoizedProps&&Ft===f.memoizedState||(g.flags|=4),typeof Q.getSnapshotBeforeUpdate!="function"||be===f.memoizedProps&&Ft===f.memoizedState||(g.flags|=1024),k=!1)}return Q=k,fd(f,g),k=(g.flags&128)!==0,Q||k?(Q=g.stateNode,T=k&&typeof T.getDerivedStateFromError!="function"?null:Q.render(),g.flags|=1,f!==null&&k?(g.child=Co(g,f.child,null,V),g.child=Co(g,null,T,V)):Ji(f,g,T,V),g.memoizedState=Q.state,f=g.child):f=fl(f,g,V),f}function zp(f,g,T,k){return Ch(),g.flags|=256,Ji(f,g,T,k),g.child}var Nu={dehydrated:null,treeContext:null,retryLane:0};function Bp(f){return{baseLanes:f,cachePool:Ul()}}function Fu(f,g,T){return f=f!==null?f.childLanes&~T:0,g&&(f|=Nr),f}function pd(f,g,T){var k=g.pendingProps,V=!1,Q=(g.flags&128)!==0,be;if((be=Q)||(be=f!==null&&f.memoizedState===null?!1:(wa.current&2)!==0),be&&(V=!0,g.flags&=-129),be=(g.flags&32)!==0,g.flags&=-33,f===null){if(Ur){if(V?Oc(g):Go(),Ur){var Be=ba,rt;if(rt=Be){e:{for(rt=Be,Be=ms;rt.nodeType!==8;){if(!Be){Be=null;break e}if(rt=Kl(rt.nextSibling),rt===null){Be=null;break e}}Be=rt}Be!==null?(g.memoizedState={dehydrated:Be,treeContext:Bl!==null?{id:il,overflow:al}:null,retryLane:536870912},rt=St(18,null,null,0),rt.stateNode=Be,rt.return=g,g.child=rt,li=g,ba=null,rt=!0):rt=!1}rt||ol(g)}if(Be=g.memoizedState,Be!==null&&(Be=Be.dehydrated,Be!==null))return Be.data==="$!"?g.lanes=16:g.lanes=536870912,null;Fl(g)}return Be=k.children,k=k.fallback,V?(Go(),V=g.mode,Be=ju({mode:"hidden",children:Be},V),k=zt(k,V,T,null),Be.return=g,k.return=g,Be.sibling=k,g.child=Be,V=g.child,V.memoizedState=Bp(T),V.childLanes=Fu(f,be,T),g.memoizedState=Nu,k):(Oc(g),ws(g,Be))}if(rt=f.memoizedState,rt!==null&&(Be=rt.dehydrated,Be!==null)){if(Q)g.flags&256?(Oc(g),g.flags&=-257,g=pi(f,g,T)):g.memoizedState!==null?(Go(),g.child=f.child,g.flags|=128,g=null):(Go(),V=k.fallback,Be=g.mode,k=ju({mode:"visible",children:k.children},Be),V=zt(V,Be,T,null),V.flags|=2,k.return=g,V.return=g,k.sibling=V,g.child=k,Co(g,f.child,null,T),k=g.child,k.memoizedState=Bp(T),k.childLanes=Fu(f,be,T),g.memoizedState=Nu,g=V);else if(Oc(g),Be.data==="$!"){if(be=Be.nextSibling&&Be.nextSibling.dataset,be)var Tt=be.dgst;be=Tt,k=Error(o(419)),k.stack="",k.digest=be,Mh({value:k,source:null,stack:null}),g=pi(f,g,T)}else if(Ta||Ss(f,g,T,!1),be=(T&f.childLanes)!==0,Ta||be){if(be=Pn,be!==null){if(k=T&-T,k&42)k=1;else switch(k){case 2:k=1;break;case 8:k=4;break;case 32:k=16;break;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:k=64;break;case 268435456:k=134217728;break;default:k=0}if(k=k&(be.suspendedLanes|T)?0:k,k!==0&&k!==rt.retryLane)throw rt.retryLane=k,$o(f,k),Qo(be,f,k),Jm}Be.data==="$?"||vd(),g=pi(f,g,T)}else Be.data==="$?"?(g.flags|=128,g.child=f.child,g=E_.bind(null,f),Be._reactRetry=g,g=null):(f=rt.treeContext,ba=Kl(Be.nextSibling),li=g,Ur=!0,Ao=null,ms=!1,f!==null&&(To[Eo++]=il,To[Eo++]=al,To[Eo++]=Bl,il=f.id,al=f.overflow,Bl=g),g=ws(g,k.children),g.flags|=4096);return g}return V?(Go(),V=k.fallback,Be=g.mode,rt=f.child,Tt=rt.sibling,k=Gt(rt,{mode:"hidden",children:k.children}),k.subtreeFlags=rt.subtreeFlags&31457280,Tt!==null?V=Gt(Tt,V):(V=zt(V,Be,T,null),V.flags|=2),V.return=g,k.return=g,k.sibling=V,g.child=k,k=V,V=g.child,Be=f.child.memoizedState,Be===null?Be=Bp(T):(rt=Be.cachePool,rt!==null?(Tt=Ri._currentValue,rt=rt.parent!==Tt?{parent:Tt,pool:Tt}:rt):rt=Ul(),Be={baseLanes:Be.baseLanes|T,cachePool:rt}),V.memoizedState=Be,V.childLanes=Fu(f,be,T),g.memoizedState=Nu,k):(Oc(g),T=f.child,f=T.sibling,T=Gt(T,{mode:"visible",children:k.children}),T.return=g,T.sibling=null,f!==null&&(be=g.deletions,be===null?(g.deletions=[f],g.flags|=16):be.push(f)),g.child=T,g.memoizedState=null,T)}function ws(f,g){return g=ju({mode:"visible",children:g},f.mode),g.return=f,f.child=g}function ju(f,g){return Wt(f,g,0,null)}function pi(f,g,T){return Co(g,f.child,null,T),f=ws(g,g.pendingProps.children),f.flags|=2,g.memoizedState=null,f}function Zo(f,g,T){f.lanes|=g;var k=f.alternate;k!==null&&(k.lanes|=g),Hs(f.return,g,T)}function $c(f,g,T,k,V){var Q=f.memoizedState;Q===null?f.memoizedState={isBackwards:g,rendering:null,renderingStartTime:0,last:k,tail:T,tailMode:V}:(Q.isBackwards=g,Q.rendering=null,Q.renderingStartTime=0,Q.last=k,Q.tail=T,Q.tailMode=V)}function Zh(f,g,T){var k=g.pendingProps,V=k.revealOrder,Q=k.tail;if(Ji(f,g,k.children,T),k=wa.current,k&2)k=k&1|2,g.flags|=128;else{if(f!==null&&f.flags&128)e:for(f=g.child;f!==null;){if(f.tag===13)f.memoizedState!==null&&Zo(f,T,g);else if(f.tag===19)Zo(f,T,g);else if(f.child!==null){f.child.return=f,f=f.child;continue}if(f===g)break e;for(;f.sibling===null;){if(f.return===null||f.return===g)break e;f=f.return}f.sibling.return=f.return,f=f.sibling}k&=1}switch(Ne(wa,k),V){case"forwards":for(T=g.child,V=null;T!==null;)f=T.alternate,f!==null&&Kf(f)===null&&(V=T),T=T.sibling;T=V,T===null?(V=g.child,g.child=null):(V=T.sibling,T.sibling=null),$c(g,!1,V,T,Q);break;case"backwards":for(T=null,V=g.child,g.child=null;V!==null;){if(f=V.alternate,f!==null&&Kf(f)===null){g.child=V;break}f=V.sibling,V.sibling=T,T=V,V=f}$c(g,!0,T,null,Q);break;case"together":$c(g,!1,null,null,void 0);break;default:g.memoizedState=null}return g.child}function fl(f,g,T){if(f!==null&&(g.dependencies=f.dependencies),Er|=g.lanes,!(T&g.childLanes))if(f!==null){if(Ss(f,g,T,!1),(T&g.childLanes)===0)return null}else return null;if(f!==null&&g.child!==f.child)throw Error(o(153));if(g.child!==null){for(f=g.child,T=Gt(f,f.pendingProps),g.child=T,T.return=g;f.sibling!==null;)f=f.sibling,T=T.sibling=Gt(f,f.pendingProps),T.return=g;T.sibling=null}return g.child}function Np(f,g){return f.lanes&g?!0:(f=f.dependencies,!!(f!==null&&dl(f)))}function md(f,g,T){switch(g.tag){case 3:Pr(g,g.stateNode.containerInfo),Oo(g,Ri,f.memoizedState.cache),Ch();break;case 27:case 5:zi(g);break;case 4:Pr(g,g.stateNode.containerInfo);break;case 10:Oo(g,g.type,g.memoizedProps.value);break;case 13:var k=g.memoizedState;if(k!==null)return k.dehydrated!==null?(Oc(g),g.flags|=128,null):T&g.child.childLanes?pd(f,g,T):(Oc(g),f=fl(f,g,T),f!==null?f.sibling:null);Oc(g);break;case 19:var V=(f.flags&128)!==0;if(k=(T&g.childLanes)!==0,k||(Ss(f,g,T,!1),k=(T&g.childLanes)!==0),V){if(k)return Zh(f,g,T);g.flags|=128}if(V=g.memoizedState,V!==null&&(V.rendering=null,V.tail=null,V.lastEffect=null),Ne(wa,wa.current),k)break;return null;case 22:case 23:return g.lanes=0,Qm(f,g,T);case 24:Oo(g,Ri,f.memoizedState.cache)}return fl(f,g,T)}function Fp(f,g,T){if(f!==null)if(f.memoizedProps!==g.pendingProps)Ta=!0;else{if(!Np(f,T)&&!(g.flags&128))return Ta=!1,md(f,g,T);Ta=!!(f.flags&131072)}else Ta=!1,Ur&&g.flags&1048576&&Ah(g,Eh,g.index);switch(g.lanes=0,g.tag){case 16:e:{f=g.pendingProps;var k=g.elementType,V=k._init;if(k=V(k._payload),g.type=k,typeof k=="function")mt(k)?(f=Hl(k,f),g.tag=1,g=v_(null,g,k,f,T)):(g.tag=0,g=ci(null,g,k,f,T));else{if(k!=null){if(V=k.$$typeof,V===Y){g.tag=11,g=Gh(null,g,k,f,T);break e}else if(V===oe){g.tag=14,g=_o(null,g,k,f,T);break e}}throw g=Ge(k)||k,Error(o(306,g,""))}}return g;case 0:return ci(f,g,g.type,g.pendingProps,T);case 1:return k=g.type,V=Hl(k,g.pendingProps),v_(f,g,k,V,T);case 3:e:{if(Pr(g,g.stateNode.containerInfo),f===null)throw Error(o(387));var Q=g.pendingProps;V=g.memoizedState,k=V.element,Na(f,g),Ya(g,Q,null,T);var be=g.memoizedState;if(Q=be.cache,Oo(g,Ri,Q),Q!==V.cache&&Wo(g,[Ri],T,!0),Xa(),Q=be.element,V.isDehydrated)if(V={element:Q,isDehydrated:!1,cache:be.cache},g.updateQueue.baseState=V,g.memoizedState=V,g.flags&256){g=zp(f,g,Q,T);break e}else if(Q!==k){k=qo(Error(o(424)),g),Mh(k),g=zp(f,g,Q,T);break e}else for(ba=Kl(g.stateNode.containerInfo.firstChild),li=g,Ur=!0,Ao=null,ms=!0,T=wp(g,null,Q,T),g.child=T;T;)T.flags=T.flags&-3|4096,T=T.sibling;else{if(Ch(),Q===k){g=fl(f,g,T);break e}Ji(f,g,Q,T)}g=g.child}return g;case 26:return fd(f,g),f===null?(T=Gy(g.type,null,g.pendingProps,null))?g.memoizedState=T:Ur||(T=g.type,f=g.pendingProps,k=Ed(Dr.current).createElement(T),k[pe]=g,k[Se]=f,ao(k,T,f),gn(k),g.stateNode=k):g.memoizedState=Gy(g.type,f.memoizedProps,g.pendingProps,f.memoizedState),null;case 27:return zi(g),f===null&&Ur&&(k=g.stateNode=$y(g.type,g.pendingProps,Dr.current),li=g,ms=!0,ba=Kl(k.firstChild)),k=g.pendingProps.children,f!==null||Ur?Ji(f,g,k,T):g.child=Co(g,null,k,T),fd(f,g),g.child;case 5:return f===null&&Ur&&((V=k=ba)&&(k=o3(k,g.type,g.pendingProps,ms),k!==null?(g.stateNode=k,li=g,ba=Kl(k.firstChild),ms=!1,V=!0):V=!1),V||ol(g)),zi(g),V=g.type,Q=g.pendingProps,be=f!==null?f.memoizedProps:null,k=Q.children,l0(V,Q)?k=null:be!==null&&l0(V,be)&&(g.flags|=32),g.memoizedState!==null&&(V=gs(f,g,Um,null,null,T),Od._currentValue=V),fd(f,g),Ji(f,g,k,T),g.child;case 6:return f===null&&Ur&&((f=T=ba)&&(T=s3(T,g.pendingProps,ms),T!==null?(g.stateNode=T,li=g,ba=null,f=!0):f=!1),f||ol(g)),null;case 13:return pd(f,g,T);case 4:return Pr(g,g.stateNode.containerInfo),k=g.pendingProps,f===null?g.child=Co(g,null,k,T):Ji(f,g,k,T),g.child;case 11:return Gh(f,g,g.type,g.pendingProps,T);case 7:return Ji(f,g,g.pendingProps,T),g.child;case 8:return Ji(f,g,g.pendingProps.children,T),g.child;case 12:return Ji(f,g,g.pendingProps.children,T),g.child;case 10:return k=g.pendingProps,Oo(g,g.type,k.value),Ji(f,g,k.children,T),g.child;case 9:return V=g.type._context,k=g.pendingProps.children,Po(g),V=to(V),k=k(V),g.flags|=1,Ji(f,g,k,T),g.child;case 14:return _o(f,g,g.type,g.pendingProps,T);case 15:return Hh(f,g,g.type,g.pendingProps,T);case 19:return Zh(f,g,T);case 22:return Qm(f,g,T);case 24:return Po(g),k=to(Ri),f===null?(V=Qf(),V===null&&(V=Pn,Q=Rh(),V.pooledCache=Q,Q.refCount++,Q!==null&&(V.pooledCacheLanes|=T),V=Q),g.memoizedState={parent:k,cache:V},Up(g),Oo(g,Ri,V)):(f.lanes&T&&(Na(f,g),Ya(g,null,null,T),Xa()),V=f.memoizedState,Q=g.memoizedState,V.parent!==k?(V={parent:k,cache:k},g.memoizedState=V,g.lanes===0&&(g.memoizedState=g.updateQueue.baseState=V),Oo(g,Ri,k)):(k=Q.cache,Oo(g,Ri,k),k!==V.cache&&Wo(g,[Ri],T,!0))),Ji(f,g,g.pendingProps.children,T),g.child;case 29:throw g.pendingProps}throw Error(o(156,g.tag))}var e0=ir(null),Zl=null,Gs=null;function Oo(f,g,T){Ne(e0,g._currentValue),g._currentValue=T}function go(f){f._currentValue=e0.current,yn(e0)}function Hs(f,g,T){for(;f!==null;){var k=f.alternate;if((f.childLanes&g)!==g?(f.childLanes|=g,k!==null&&(k.childLanes|=g)):k!==null&&(k.childLanes&g)!==g&&(k.childLanes|=g),f===T)break;f=f.return}}function Wo(f,g,T,k){var V=f.child;for(V!==null&&(V.return=f);V!==null;){var Q=V.dependencies;if(Q!==null){var be=V.child;Q=Q.firstContext;e:for(;Q!==null;){var Be=Q;Q=V;for(var rt=0;rt<g.length;rt++)if(Be.context===g[rt]){Q.lanes|=T,Be=Q.alternate,Be!==null&&(Be.lanes|=T),Hs(Q.return,T,f),k||(be=null);break e}Q=Be.next}}else if(V.tag===18){if(be=V.return,be===null)throw Error(o(341));be.lanes|=T,Q=be.alternate,Q!==null&&(Q.lanes|=T),Hs(be,T,f),be=null}else be=V.child;if(be!==null)be.return=V;else for(be=V;be!==null;){if(be===f){be=null;break}if(V=be.sibling,V!==null){V.return=be.return,be=V;break}be=be.return}V=be}}function Ss(f,g,T,k){f=null;for(var V=g,Q=!1;V!==null;){if(!Q){if(V.flags&524288)Q=!0;else if(V.flags&262144)break}if(V.tag===10){var be=V.alternate;if(be===null)throw Error(o(387));if(be=be.memoizedProps,be!==null){var Be=V.type;xa(V.pendingProps.value,be.value)||(f!==null?f.push(Be):f=[Be])}}else if(V===Pt.current){if(be=V.alternate,be===null)throw Error(o(387));be.memoizedState.memoizedState!==V.memoizedState.memoizedState&&(f!==null?f.push(Od):f=[Od])}V=V.return}f!==null&&Wo(g,f,T,k),g.flags|=262144}function dl(f){for(f=f.firstContext;f!==null;){if(!xa(f.context._currentValue,f.memoizedValue))return!0;f=f.next}return!1}function Po(f){Zl=f,Gs=null,f=f.dependencies,f!==null&&(f.firstContext=null)}function to(f){return x_(Zl,f)}function jp(f,g){return Zl===null&&Po(f),x_(f,g)}function x_(f,g){var T=g._currentValue;if(g={context:g,memoizedValue:T,next:null},Gs===null){if(f===null)throw Error(o(308));Gs=g,f.dependencies={lanes:0,firstContext:g},f.flags|=524288}else Gs=Gs.next=g;return T}var Zs=!1;function Up(f){f.updateQueue={baseState:f.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Na(f,g){f=f.updateQueue,g.updateQueue===f&&(g.updateQueue={baseState:f.baseState,firstBaseUpdate:f.firstBaseUpdate,lastBaseUpdate:f.lastBaseUpdate,shared:f.shared,callbacks:null})}function Xo(f){return{lane:f,tag:0,payload:null,callback:null,next:null}}function Wl(f,g,T){var k=f.updateQueue;if(k===null)return null;if(k=k.shared,sn&2){var V=k.pending;return V===null?g.next=g:(g.next=V.next,V.next=g),k.pending=g,g=sr(f),Ec(f,null,T),g}return wu(f,k,g,T),sr(f)}function Wh(f,g,T){if(g=g.updateQueue,g!==null&&(g=g.shared,(T&4194176)!==0)){var k=g.lanes;k&=f.pendingLanes,T|=k,g.lanes=T,ph(f,T)}}function qc(f,g){var T=f.updateQueue,k=f.alternate;if(k!==null&&(k=k.updateQueue,T===k)){var V=null,Q=null;if(T=T.firstBaseUpdate,T!==null){do{var be={lane:T.lane,tag:T.tag,payload:T.payload,callback:null,next:null};Q===null?V=Q=be:Q=Q.next=be,T=T.next}while(T!==null);Q===null?V=Q=g:Q=Q.next=g}else V=Q=g;T={baseState:k.baseState,firstBaseUpdate:V,lastBaseUpdate:Q,shared:k.shared,callbacks:k.callbacks},f.updateQueue=T;return}f=T.lastBaseUpdate,f===null?T.firstBaseUpdate=g:f.next=g,T.lastBaseUpdate=g}var Xh=!1;function Xa(){if(Xh){var f=Pc;if(f!==null)throw f}}function Ya(f,g,T,k){Xh=!1;var V=f.updateQueue;Zs=!1;var Q=V.firstBaseUpdate,be=V.lastBaseUpdate,Be=V.shared.pending;if(Be!==null){V.shared.pending=null;var rt=Be,Tt=rt.next;rt.next=null,be===null?Q=Tt:be.next=Tt,be=rt;var en=f.alternate;en!==null&&(en=en.updateQueue,Be=en.lastBaseUpdate,Be!==be&&(Be===null?en.firstBaseUpdate=Tt:Be.next=Tt,en.lastBaseUpdate=rt))}if(Q!==null){var mn=V.baseState;be=0,en=Tt=rt=null,Be=Q;do{var Ft=Be.lane&-536870913,Qt=Ft!==Be.lane;if(Qt?(In&Ft)===Ft:(k&Ft)===Ft){Ft!==0&&Ft===ll&&(Xh=!0),en!==null&&(en=en.next={lane:0,tag:Be.tag,payload:Be.payload,callback:null,next:null});e:{var Hn=f,Ar=Be;Ft=g;var Qi=T;switch(Ar.tag){case 1:if(Hn=Ar.payload,typeof Hn=="function"){mn=Hn.call(Qi,mn,Ft);break e}mn=Hn;break e;case 3:Hn.flags=Hn.flags&-65537|128;case 0:if(Hn=Ar.payload,Ft=typeof Hn=="function"?Hn.call(Qi,mn,Ft):Hn,Ft==null)break e;mn=ye({},mn,Ft);break e;case 2:Zs=!0}}Ft=Be.callback,Ft!==null&&(f.flags|=64,Qt&&(f.flags|=8192),Qt=V.callbacks,Qt===null?V.callbacks=[Ft]:Qt.push(Ft))}else Qt={lane:Ft,tag:Be.tag,payload:Be.payload,callback:Be.callback,next:null},en===null?(Tt=en=Qt,rt=mn):en=en.next=Qt,be|=Ft;if(Be=Be.next,Be===null){if(Be=V.shared.pending,Be===null)break;Qt=Be,Be=Qt.next,Qt.next=null,V.lastBaseUpdate=Qt,V.shared.pending=null}}while(!0);en===null&&(rt=mn),V.baseState=rt,V.firstBaseUpdate=Tt,V.lastBaseUpdate=en,Q===null&&(V.shared.lanes=0),Er|=be,f.lanes=be,f.memoizedState=mn}}function Uu(f,g){if(typeof f!="function")throw Error(o(191,f));f.call(g)}function Gc(f,g){var T=f.callbacks;if(T!==null)for(f.callbacks=null,f=0;f<T.length;f++)Uu(T[f],g)}function Ws(f,g){try{var T=g.updateQueue,k=T!==null?T.lastEffect:null;if(k!==null){var V=k.next;T=V;do{if((T.tag&f)===f){k=void 0;var Q=T.create,be=T.inst;k=Q(),be.destroy=k}T=T.next}while(T!==V)}}catch(Be){Mi(g,g.return,Be)}}function pl(f,g,T){try{var k=g.updateQueue,V=k!==null?k.lastEffect:null;if(V!==null){var Q=V.next;k=Q;do{if((k.tag&f)===f){var be=k.inst,Be=be.destroy;if(Be!==void 0){be.destroy=void 0,V=g;var rt=T;try{Be()}catch(Tt){Mi(V,rt,Tt)}}}k=k.next}while(k!==Q)}}catch(Tt){Mi(g,g.return,Tt)}}function pr(f){var g=f.updateQueue;if(g!==null){var T=f.stateNode;try{Gc(g,T)}catch(k){Mi(f,f.return,k)}}}function Xl(f,g,T){T.props=Hl(f.type,f.memoizedProps),T.state=f.memoizedState;try{T.componentWillUnmount()}catch(k){Mi(f,g,k)}}function Vu(f,g){try{var T=f.ref;if(T!==null){var k=f.stateNode;switch(f.tag){case 26:case 27:case 5:var V=k;break;default:V=k}typeof T=="function"?f.refCleanup=T(V):T.current=V}}catch(Q){Mi(f,g,Q)}}function Yo(f,g){var T=f.ref,k=f.refCleanup;if(T!==null)if(typeof k=="function")try{k()}catch(V){Mi(f,g,V)}finally{f.refCleanup=null,f=f.alternate,f!=null&&(f.refCleanup=null)}else if(typeof T=="function")try{T(null)}catch(V){Mi(f,g,V)}else T.current=null}function _d(f){var g=f.type,T=f.memoizedProps,k=f.stateNode;try{e:switch(g){case"button":case"input":case"select":case"textarea":T.autoFocus&&k.focus();break e;case"img":T.src?k.src=T.src:T.srcSet&&(k.srcset=T.srcSet)}}catch(V){Mi(f,f.return,V)}}function Xs(f,g,T){try{var k=f.stateNode;Z2(k,f.type,T,g),k[Se]=g}catch(V){Mi(f,f.return,V)}}function Ts(f){return f.tag===5||f.tag===3||f.tag===26||f.tag===27||f.tag===4}function Fa(f){e:for(;;){for(;f.sibling===null;){if(f.return===null||Ts(f.return))return null;f=f.return}for(f.sibling.return=f.return,f=f.sibling;f.tag!==5&&f.tag!==6&&f.tag!==27&&f.tag!==18;){if(f.flags&2||f.child===null||f.tag===4)continue e;f.child.return=f,f=f.child}if(!(f.flags&2))return f.stateNode}}function no(f,g,T){var k=f.tag;if(k===5||k===6)f=f.stateNode,g?T.nodeType===8?T.parentNode.insertBefore(f,g):T.insertBefore(f,g):(T.nodeType===8?(g=T.parentNode,g.insertBefore(f,T)):(g=T,g.appendChild(f)),T=T._reactRootContainer,T!=null||g.onclick!==null||(g.onclick=Yc));else if(k!==4&&k!==27&&(f=f.child,f!==null))for(no(f,g,T),f=f.sibling;f!==null;)no(f,g,T),f=f.sibling}function qi(f,g,T){var k=f.tag;if(k===5||k===6)f=f.stateNode,g?T.insertBefore(f,g):T.appendChild(f);else if(k!==4&&k!==27&&(f=f.child,f!==null))for(qi(f,g,T),f=f.sibling;f!==null;)qi(f,g,T),f=f.sibling}var ml=!1,Br=!1,gd=!1,$u=typeof WeakSet=="function"?WeakSet:Set,p=null,r=!1;function l(f,g){if(f=f.containerInfo,Zp=m0,f=pp(f),Lm(f)){if("selectionStart"in f)var T={start:f.selectionStart,end:f.selectionEnd};else e:{T=(T=f.ownerDocument)&&T.defaultView||window;var k=T.getSelection&&T.getSelection();if(k&&k.rangeCount!==0){T=k.anchorNode;var V=k.anchorOffset,Q=k.focusNode;k=k.focusOffset;try{T.nodeType,Q.nodeType}catch{T=null;break e}var be=0,Be=-1,rt=-1,Tt=0,en=0,mn=f,Ft=null;t:for(;;){for(var Qt;mn!==T||V!==0&&mn.nodeType!==3||(Be=be+V),mn!==Q||k!==0&&mn.nodeType!==3||(rt=be+k),mn.nodeType===3&&(be+=mn.nodeValue.length),(Qt=mn.firstChild)!==null;)Ft=mn,mn=Qt;for(;;){if(mn===f)break t;if(Ft===T&&++Tt===V&&(Be=be),Ft===Q&&++en===k&&(rt=be),(Qt=mn.nextSibling)!==null)break;mn=Ft,Ft=mn.parentNode}mn=Qt}T=Be===-1||rt===-1?null:{start:Be,end:rt}}else T=null}T=T||{start:0,end:0}}else T=null;for(z_={focusedElem:f,selectionRange:T},m0=!1,p=g;p!==null;)if(g=p,f=g.child,(g.subtreeFlags&1028)!==0&&f!==null)f.return=g,p=f;else for(;p!==null;){switch(g=p,Q=g.alternate,f=g.flags,g.tag){case 0:break;case 11:case 15:break;case 1:if(f&1024&&Q!==null){f=void 0,T=g,V=Q.memoizedProps,Q=Q.memoizedState,k=T.stateNode;try{var Hn=Hl(T.type,V,T.elementType===T.type);f=k.getSnapshotBeforeUpdate(Hn,Q),k.__reactInternalSnapshotBeforeUpdate=f}catch(Ar){Mi(T,T.return,Ar)}}break;case 3:if(f&1024){if(f=g.stateNode.containerInfo,T=f.nodeType,T===9)c0(f);else if(T===1)switch(f.nodeName){case"HEAD":case"HTML":case"BODY":c0(f);break;default:f.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if(f&1024)throw Error(o(163))}if(f=g.sibling,f!==null){f.return=g.return,p=f;break}p=g.return}return Hn=r,r=!1,Hn}function m(f,g,T){var k=T.flags;switch(T.tag){case 0:case 11:case 15:he(f,T),k&4&&Ws(5,T);break;case 1:if(he(f,T),k&4)if(f=T.stateNode,g===null)try{f.componentDidMount()}catch(Be){Mi(T,T.return,Be)}else{var V=Hl(T.type,g.memoizedProps);g=g.memoizedState;try{f.componentDidUpdate(V,g,f.__reactInternalSnapshotBeforeUpdate)}catch(Be){Mi(T,T.return,Be)}}k&64&&pr(T),k&512&&Vu(T,T.return);break;case 3:if(he(f,T),k&64&&(k=T.updateQueue,k!==null)){if(f=null,T.child!==null)switch(T.child.tag){case 27:case 5:f=T.child.stateNode;break;case 1:f=T.child.stateNode}try{Gc(k,f)}catch(Be){Mi(T,T.return,Be)}}break;case 26:he(f,T),k&512&&Vu(T,T.return);break;case 27:case 5:he(f,T),g===null&&k&4&&_d(T),k&512&&Vu(T,T.return);break;case 12:he(f,T);break;case 13:he(f,T),k&4&&U(f,T);break;case 22:if(V=T.memoizedState!==null||ml,!V){g=g!==null&&g.memoizedState!==null||Br;var Q=ml,be=Br;ml=V,(Br=g)&&!be?Pe(f,T,(T.subtreeFlags&8772)!==0):he(f,T),ml=Q,Br=be}k&512&&(T.memoizedProps.mode==="manual"?Vu(T,T.return):Yo(T,T.return));break;default:he(f,T)}}function x(f){var g=f.alternate;g!==null&&(f.alternate=null,x(g)),f.child=null,f.deletions=null,f.sibling=null,f.tag===5&&(g=f.stateNode,g!==null&&lt(g)),f.stateNode=null,f.return=null,f.dependencies=null,f.memoizedProps=null,f.memoizedState=null,f.pendingProps=null,f.stateNode=null,f.updateQueue=null}var w=null,A=!1;function D(f,g,T){for(T=T.child;T!==null;)N(f,g,T),T=T.sibling}function N(f,g,T){if(Ia&&typeof Ia.onCommitFiberUnmount=="function")try{Ia.onCommitFiberUnmount(da,T)}catch{}switch(T.tag){case 26:Br||Yo(T,g),D(f,g,T),T.memoizedState?T.memoizedState.count--:T.stateNode&&(T=T.stateNode,T.parentNode.removeChild(T));break;case 27:Br||Yo(T,g);var k=w,V=A;for(w=T.stateNode,D(f,g,T),T=T.stateNode,g=T.attributes;g.length;)T.removeAttributeNode(g[0]);lt(T),w=k,A=V;break;case 5:Br||Yo(T,g);case 6:V=w;var Q=A;if(w=null,D(f,g,T),w=V,A=Q,w!==null)if(A)try{f=w,k=T.stateNode,f.nodeType===8?f.parentNode.removeChild(k):f.removeChild(k)}catch(be){Mi(T,g,be)}else try{w.removeChild(T.stateNode)}catch(be){Mi(T,g,be)}break;case 18:w!==null&&(A?(g=w,T=T.stateNode,g.nodeType===8?F_(g.parentNode,T):g.nodeType===1&&F_(g,T),y0(g)):F_(w,T.stateNode));break;case 4:k=w,V=A,w=T.stateNode.containerInfo,A=!0,D(f,g,T),w=k,A=V;break;case 0:case 11:case 14:case 15:Br||pl(2,T,g),Br||pl(4,T,g),D(f,g,T);break;case 1:Br||(Yo(T,g),k=T.stateNode,typeof k.componentWillUnmount=="function"&&Xl(T,g,k)),D(f,g,T);break;case 21:D(f,g,T);break;case 22:Br||Yo(T,g),Br=(k=Br)||T.memoizedState!==null,D(f,g,T),Br=k;break;default:D(f,g,T)}}function U(f,g){if(g.memoizedState===null&&(f=g.alternate,f!==null&&(f=f.memoizedState,f!==null&&(f=f.dehydrated,f!==null))))try{y0(f)}catch(T){Mi(g,g.return,T)}}function $(f){switch(f.tag){case 13:case 19:var g=f.stateNode;return g===null&&(g=f.stateNode=new $u),g;case 22:return f=f.stateNode,g=f._retryCache,g===null&&(g=f._retryCache=new $u),g;default:throw Error(o(435,f.tag))}}function Z(f,g){var T=$(f);g.forEach(function(k){var V=U2.bind(null,f,k);T.has(k)||(T.add(k),k.then(V,V))})}function W(f,g){var T=g.deletions;if(T!==null)for(var k=0;k<T.length;k++){var V=T[k],Q=f,be=g,Be=be;e:for(;Be!==null;){switch(Be.tag){case 27:case 5:w=Be.stateNode,A=!1;break e;case 3:w=Be.stateNode.containerInfo,A=!0;break e;case 4:w=Be.stateNode.containerInfo,A=!0;break e}Be=Be.return}if(w===null)throw Error(o(160));N(Q,be,V),w=null,A=!1,Q=V.alternate,Q!==null&&(Q.return=null),V.return=null}if(g.subtreeFlags&13878)for(g=g.child;g!==null;)ue(g,f),g=g.sibling}var te=null;function ue(f,g){var T=f.alternate,k=f.flags;switch(f.tag){case 0:case 11:case 14:case 15:W(g,f),se(f),k&4&&(pl(3,f,f.return),Ws(3,f),pl(5,f,f.return));break;case 1:W(g,f),se(f),k&512&&(Br||T===null||Yo(T,T.return)),k&64&&ml&&(f=f.updateQueue,f!==null&&(k=f.callbacks,k!==null&&(T=f.shared.hiddenCallbacks,f.shared.hiddenCallbacks=T===null?k:T.concat(k))));break;case 26:var V=te;if(W(g,f),se(f),k&512&&(Br||T===null||Yo(T,T.return)),k&4){var Q=T!==null?T.memoizedState:null;if(k=f.memoizedState,T===null)if(k===null)if(f.stateNode===null){e:{k=f.type,T=f.memoizedProps,V=V.ownerDocument||V;t:switch(k){case"title":Q=V.getElementsByTagName("title")[0],(!Q||Q[ct]||Q[pe]||Q.namespaceURI==="http://www.w3.org/2000/svg"||Q.hasAttribute("itemprop"))&&(Q=V.createElement(k),V.head.insertBefore(Q,V.querySelector("head > title"))),ao(Q,k,T),Q[pe]=f,gn(Q),k=Q;break e;case"link":var be=Zy("link","href",V).get(k+(T.href||""));if(be){for(var Be=0;Be<be.length;Be++)if(Q=be[Be],Q.getAttribute("href")===(T.href==null?null:T.href)&&Q.getAttribute("rel")===(T.rel==null?null:T.rel)&&Q.getAttribute("title")===(T.title==null?null:T.title)&&Q.getAttribute("crossorigin")===(T.crossOrigin==null?null:T.crossOrigin)){be.splice(Be,1);break t}}Q=V.createElement(k),ao(Q,k,T),V.head.appendChild(Q);break;case"meta":if(be=Zy("meta","content",V).get(k+(T.content||""))){for(Be=0;Be<be.length;Be++)if(Q=be[Be],Q.getAttribute("content")===(T.content==null?null:""+T.content)&&Q.getAttribute("name")===(T.name==null?null:T.name)&&Q.getAttribute("property")===(T.property==null?null:T.property)&&Q.getAttribute("http-equiv")===(T.httpEquiv==null?null:T.httpEquiv)&&Q.getAttribute("charset")===(T.charSet==null?null:T.charSet)){be.splice(Be,1);break t}}Q=V.createElement(k),ao(Q,k,T),V.head.appendChild(Q);break;default:throw Error(o(468,k))}Q[pe]=f,gn(Q),k=Q}f.stateNode=k}else rx(V,f.type,f.stateNode);else f.stateNode=nx(V,k,f.memoizedProps);else Q!==k?(Q===null?T.stateNode!==null&&(T=T.stateNode,T.parentNode.removeChild(T)):Q.count--,k===null?rx(V,f.type,f.stateNode):nx(V,k,f.memoizedProps)):k===null&&f.stateNode!==null&&Xs(f,f.memoizedProps,T.memoizedProps)}break;case 27:if(k&4&&f.alternate===null){V=f.stateNode,Q=f.memoizedProps;try{for(var rt=V.firstChild;rt;){var Tt=rt.nextSibling,en=rt.nodeName;rt[ct]||en==="HEAD"||en==="BODY"||en==="SCRIPT"||en==="STYLE"||en==="LINK"&&rt.rel.toLowerCase()==="stylesheet"||V.removeChild(rt),rt=Tt}for(var mn=f.type,Ft=V.attributes;Ft.length;)V.removeAttributeNode(Ft[0]);ao(V,mn,Q),V[pe]=f,V[Se]=Q}catch(Hn){Mi(f,f.return,Hn)}}case 5:if(W(g,f),se(f),k&512&&(Br||T===null||Yo(T,T.return)),f.flags&32){V=f.stateNode;try{Ml(V,"")}catch(Hn){Mi(f,f.return,Hn)}}k&4&&f.stateNode!=null&&(V=f.memoizedProps,Xs(f,V,T!==null?T.memoizedProps:V)),k&1024&&(gd=!0);break;case 6:if(W(g,f),se(f),k&4){if(f.stateNode===null)throw Error(o(162));k=f.memoizedProps,T=f.stateNode;try{T.nodeValue=k}catch(Hn){Mi(f,f.return,Hn)}}break;case 3:if(f0=null,V=te,te=Qh(g.containerInfo),W(g,f),te=V,se(f),k&4&&T!==null&&T.memoizedState.isDehydrated)try{y0(g.containerInfo)}catch(Hn){Mi(f,f.return,Hn)}gd&&(gd=!1,de(f));break;case 4:k=te,te=Qh(f.stateNode.containerInfo),W(g,f),se(f),te=k;break;case 12:W(g,f),se(f);break;case 13:W(g,f),se(f),f.child.flags&8192&&f.memoizedState!==null!=(T!==null&&T.memoizedState!==null)&&(ro=Bn()),k&4&&(k=f.updateQueue,k!==null&&(f.updateQueue=null,Z(f,k)));break;case 22:if(k&512&&(Br||T===null||Yo(T,T.return)),rt=f.memoizedState!==null,Tt=T!==null&&T.memoizedState!==null,en=ml,mn=Br,ml=en||rt,Br=mn||Tt,W(g,f),Br=mn,ml=en,se(f),g=f.stateNode,g._current=f,g._visibility&=-3,g._visibility|=g._pendingVisibility&2,k&8192&&(g._visibility=rt?g._visibility&-2:g._visibility|1,rt&&(g=ml||Br,T===null||Tt||g||Te(f)),f.memoizedProps===null||f.memoizedProps.mode!=="manual"))e:for(T=null,g=f;;){if(g.tag===5||g.tag===26||g.tag===27){if(T===null){Tt=T=g;try{if(V=Tt.stateNode,rt)Q=V.style,typeof Q.setProperty=="function"?Q.setProperty("display","none","important"):Q.display="none";else{be=Tt.stateNode,Be=Tt.memoizedProps.style;var Qt=Be!=null&&Be.hasOwnProperty("display")?Be.display:null;be.style.display=Qt==null||typeof Qt=="boolean"?"":(""+Qt).trim()}}catch(Hn){Mi(Tt,Tt.return,Hn)}}}else if(g.tag===6){if(T===null){Tt=g;try{Tt.stateNode.nodeValue=rt?"":Tt.memoizedProps}catch(Hn){Mi(Tt,Tt.return,Hn)}}}else if((g.tag!==22&&g.tag!==23||g.memoizedState===null||g===f)&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===f)break e;for(;g.sibling===null;){if(g.return===null||g.return===f)break e;T===g&&(T=null),g=g.return}T===g&&(T=null),g.sibling.return=g.return,g=g.sibling}k&4&&(k=f.updateQueue,k!==null&&(T=k.retryQueue,T!==null&&(k.retryQueue=null,Z(f,T))));break;case 19:W(g,f),se(f),k&4&&(k=f.updateQueue,k!==null&&(f.updateQueue=null,Z(f,k)));break;case 21:break;default:W(g,f),se(f)}}function se(f){var g=f.flags;if(g&2){try{if(f.tag!==27){e:{for(var T=f.return;T!==null;){if(Ts(T)){var k=T;break e}T=T.return}throw Error(o(160))}switch(k.tag){case 27:var V=k.stateNode,Q=Fa(f);qi(f,Q,V);break;case 5:var be=k.stateNode;k.flags&32&&(Ml(be,""),k.flags&=-33);var Be=Fa(f);qi(f,Be,be);break;case 3:case 4:var rt=k.stateNode.containerInfo,Tt=Fa(f);no(f,Tt,rt);break;default:throw Error(o(161))}}}catch(en){Mi(f,f.return,en)}f.flags&=-3}g&4096&&(f.flags&=-4097)}function de(f){if(f.subtreeFlags&1024)for(f=f.child;f!==null;){var g=f;de(g),g.tag===5&&g.flags&1024&&g.stateNode.reset(),f=f.sibling}}function he(f,g){if(g.subtreeFlags&8772)for(g=g.child;g!==null;)m(f,g.alternate,g),g=g.sibling}function Te(f){for(f=f.child;f!==null;){var g=f;switch(g.tag){case 0:case 11:case 14:case 15:pl(4,g,g.return),Te(g);break;case 1:Yo(g,g.return);var T=g.stateNode;typeof T.componentWillUnmount=="function"&&Xl(g,g.return,T),Te(g);break;case 26:case 27:case 5:Yo(g,g.return),Te(g);break;case 22:Yo(g,g.return),g.memoizedState===null&&Te(g);break;default:Te(g)}f=f.sibling}}function Pe(f,g,T){for(T=T&&(g.subtreeFlags&8772)!==0,g=g.child;g!==null;){var k=g.alternate,V=f,Q=g,be=Q.flags;switch(Q.tag){case 0:case 11:case 15:Pe(V,Q,T),Ws(4,Q);break;case 1:if(Pe(V,Q,T),k=Q,V=k.stateNode,typeof V.componentDidMount=="function")try{V.componentDidMount()}catch(Tt){Mi(k,k.return,Tt)}if(k=Q,V=k.updateQueue,V!==null){var Be=k.stateNode;try{var rt=V.shared.hiddenCallbacks;if(rt!==null)for(V.shared.hiddenCallbacks=null,V=0;V<rt.length;V++)Uu(rt[V],Be)}catch(Tt){Mi(k,k.return,Tt)}}T&&be&64&&pr(Q),Vu(Q,Q.return);break;case 26:case 27:case 5:Pe(V,Q,T),T&&k===null&&be&4&&_d(Q),Vu(Q,Q.return);break;case 12:Pe(V,Q,T);break;case 13:Pe(V,Q,T),T&&be&4&&U(V,Q);break;case 22:Q.memoizedState===null&&Pe(V,Q,T),Vu(Q,Q.return);break;default:Pe(V,Q,T)}g=g.sibling}}function Me(f,g){var T=null;f!==null&&f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(T=f.memoizedState.cachePool.pool),f=null,g.memoizedState!==null&&g.memoizedState.cachePool!==null&&(f=g.memoizedState.cachePool.pool),f!==T&&(f!=null&&f.refCount++,T!=null&&jl(T))}function Fe(f,g){f=null,g.alternate!==null&&(f=g.alternate.memoizedState.cache),g=g.memoizedState.cache,g!==f&&(g.refCount++,f!=null&&jl(f))}function Re(f,g,T,k){if(g.subtreeFlags&10256)for(g=g.child;g!==null;)ze(f,g,T,k),g=g.sibling}function ze(f,g,T,k){var V=g.flags;switch(g.tag){case 0:case 11:case 15:Re(f,g,T,k),V&2048&&Ws(9,g);break;case 3:Re(f,g,T,k),V&2048&&(f=null,g.alternate!==null&&(f=g.alternate.memoizedState.cache),g=g.memoizedState.cache,g!==f&&(g.refCount++,f!=null&&jl(f)));break;case 12:if(V&2048){Re(f,g,T,k),f=g.stateNode;try{var Q=g.memoizedProps,be=Q.id,Be=Q.onPostCommit;typeof Be=="function"&&Be(be,g.alternate===null?"mount":"update",f.passiveEffectDuration,-0)}catch(rt){Mi(g,g.return,rt)}}else Re(f,g,T,k);break;case 23:break;case 22:Q=g.stateNode,g.memoizedState!==null?Q._visibility&4?Re(f,g,T,k):$e(f,g):Q._visibility&4?Re(f,g,T,k):(Q._visibility|=4,De(f,g,T,k,(g.subtreeFlags&10256)!==0)),V&2048&&Me(g.alternate,g);break;case 24:Re(f,g,T,k),V&2048&&Fe(g.alternate,g);break;default:Re(f,g,T,k)}}function De(f,g,T,k,V){for(V=V&&(g.subtreeFlags&10256)!==0,g=g.child;g!==null;){var Q=f,be=g,Be=T,rt=k,Tt=be.flags;switch(be.tag){case 0:case 11:case 15:De(Q,be,Be,rt,V),Ws(8,be);break;case 23:break;case 22:var en=be.stateNode;be.memoizedState!==null?en._visibility&4?De(Q,be,Be,rt,V):$e(Q,be):(en._visibility|=4,De(Q,be,Be,rt,V)),V&&Tt&2048&&Me(be.alternate,be);break;case 24:De(Q,be,Be,rt,V),V&&Tt&2048&&Fe(be.alternate,be);break;default:De(Q,be,Be,rt,V)}g=g.sibling}}function $e(f,g){if(g.subtreeFlags&10256)for(g=g.child;g!==null;){var T=f,k=g,V=k.flags;switch(k.tag){case 22:$e(T,k),V&2048&&Me(k.alternate,k);break;case 24:$e(T,k),V&2048&&Fe(k.alternate,k);break;default:$e(T,k)}g=g.sibling}}var Xe=8192;function ht(f){if(f.subtreeFlags&Xe)for(f=f.child;f!==null;)ot(f),f=f.sibling}function ot(f){switch(f.tag){case 26:ht(f),f.flags&Xe&&f.memoizedState!==null&&d3(te,f.memoizedState,f.memoizedProps);break;case 5:ht(f);break;case 3:case 4:var g=te;te=Qh(f.stateNode.containerInfo),ht(f),te=g;break;case 22:f.memoizedState===null&&(g=f.alternate,g!==null&&g.memoizedState!==null?(g=Xe,Xe=16777216,ht(f),Xe=g):ht(f));break;default:ht(f)}}function Et(f){var g=f.alternate;if(g!==null&&(f=g.child,f!==null)){g.child=null;do g=f.sibling,f.sibling=null,f=g;while(f!==null)}}function yt(f){var g=f.deletions;if(f.flags&16){if(g!==null)for(var T=0;T<g.length;T++){var k=g[T];p=k,Lt(k,f)}Et(f)}if(f.subtreeFlags&10256)for(f=f.child;f!==null;)nt(f),f=f.sibling}function nt(f){switch(f.tag){case 0:case 11:case 15:yt(f),f.flags&2048&&pl(9,f,f.return);break;case 3:yt(f);break;case 12:yt(f);break;case 22:var g=f.stateNode;f.memoizedState!==null&&g._visibility&4&&(f.return===null||f.return.tag!==13)?(g._visibility&=-5,pt(f)):yt(f);break;default:yt(f)}}function pt(f){var g=f.deletions;if(f.flags&16){if(g!==null)for(var T=0;T<g.length;T++){var k=g[T];p=k,Lt(k,f)}Et(f)}for(f=f.child;f!==null;){switch(g=f,g.tag){case 0:case 11:case 15:pl(8,g,g.return),pt(g);break;case 22:T=g.stateNode,T._visibility&4&&(T._visibility&=-5,pt(g));break;default:pt(g)}f=f.sibling}}function Lt(f,g){for(;p!==null;){var T=p;switch(T.tag){case 0:case 11:case 15:pl(8,T,g);break;case 23:case 22:if(T.memoizedState!==null&&T.memoizedState.cachePool!==null){var k=T.memoizedState.cachePool.pool;k!=null&&k.refCount++}break;case 24:jl(T.memoizedState.cache)}if(k=T.child,k!==null)k.return=T,p=k;else e:for(T=f;p!==null;){k=p;var V=k.sibling,Q=k.return;if(x(k),k===T){p=null;break e}if(V!==null){V.return=Q,p=V;break e}p=Q}}}function tt(f,g,T,k){this.tag=f,this.key=T,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=g,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=k,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function St(f,g,T,k){return new tt(f,g,T,k)}function mt(f){return f=f.prototype,!(!f||!f.isReactComponent)}function Gt(f,g){var T=f.alternate;return T===null?(T=St(f.tag,g,f.key,f.mode),T.elementType=f.elementType,T.type=f.type,T.stateNode=f.stateNode,T.alternate=f,f.alternate=T):(T.pendingProps=g,T.type=f.type,T.flags=0,T.subtreeFlags=0,T.deletions=null),T.flags=f.flags&31457280,T.childLanes=f.childLanes,T.lanes=f.lanes,T.child=f.child,T.memoizedProps=f.memoizedProps,T.memoizedState=f.memoizedState,T.updateQueue=f.updateQueue,g=f.dependencies,T.dependencies=g===null?null:{lanes:g.lanes,firstContext:g.firstContext},T.sibling=f.sibling,T.index=f.index,T.ref=f.ref,T.refCleanup=f.refCleanup,T}function It(f,g){f.flags&=31457282;var T=f.alternate;return T===null?(f.childLanes=0,f.lanes=g,f.child=null,f.subtreeFlags=0,f.memoizedProps=null,f.memoizedState=null,f.updateQueue=null,f.dependencies=null,f.stateNode=null):(f.childLanes=T.childLanes,f.lanes=T.lanes,f.child=T.child,f.subtreeFlags=0,f.deletions=null,f.memoizedProps=T.memoizedProps,f.memoizedState=T.memoizedState,f.updateQueue=T.updateQueue,f.type=T.type,g=T.dependencies,f.dependencies=g===null?null:{lanes:g.lanes,firstContext:g.firstContext}),f}function At(f,g,T,k,V,Q){var be=0;if(k=f,typeof f=="function")mt(f)&&(be=1);else if(typeof f=="string")be=h3(f,T,Qn.current)?26:f==="html"||f==="head"||f==="body"?27:5;else e:switch(f){case C:return zt(T.children,V,Q,g);case I:be=8,V|=24;break;case j:return f=St(12,T,g,V|2),f.elementType=j,f.lanes=Q,f;case J:return f=St(13,T,g,V),f.elementType=J,f.lanes=Q,f;case ee:return f=St(19,T,g,V),f.elementType=ee,f.lanes=Q,f;case fe:return Wt(T,V,Q,g);default:if(typeof f=="object"&&f!==null)switch(f.$$typeof){case F:case X:be=10;break e;case G:be=9;break e;case Y:be=11;break e;case oe:be=14;break e;case ge:be=16,k=null;break e}be=29,T=Error(o(130,f===null?"null":typeof f,"")),k=null}return g=St(be,T,g,V),g.elementType=f,g.type=k,g.lanes=Q,g}function zt(f,g,T,k){return f=St(7,f,k,g),f.lanes=T,f}function Wt(f,g,T,k){f=St(22,f,k,g),f.elementType=fe,f.lanes=T;var V={_visibility:1,_pendingVisibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null,_current:null,detach:function(){var Q=V._current;if(Q===null)throw Error(o(456));if(!(V._pendingVisibility&2)){var be=$o(Q,2);be!==null&&(V._pendingVisibility|=2,Qo(be,Q,2))}},attach:function(){var Q=V._current;if(Q===null)throw Error(o(456));if(V._pendingVisibility&2){var be=$o(Q,2);be!==null&&(V._pendingVisibility&=-3,Qo(be,Q,2))}}};return f.stateNode=V,f}function on(f,g,T){return f=St(6,f,null,g),f.lanes=T,f}function dn(f,g,T){return g=St(4,f.children!==null?f.children:[],f.key,g),g.lanes=T,g.stateNode={containerInfo:f.containerInfo,pendingChildren:null,implementation:f.implementation},g}function En(f){f.flags|=4}function Sn(f,g){if(g.type!=="stylesheet"||g.state.loading&4)f.flags&=-16777217;else if(f.flags|=16777216,!ix(g)){if(g=eo.current,g!==null&&((In&4194176)===In?_s!==null:(In&62914560)!==In&&!(In&536870912)||g!==_s))throw Xf=Fm,l_;f.flags|=8192}}function bn(f,g){g!==null&&(f.flags|=4),f.flags&16384&&(g=f.tag!==22?Of():536870912,f.lanes|=g,xi|=g)}function Ln(f,g){if(!Ur)switch(f.tailMode){case"hidden":g=f.tail;for(var T=null;g!==null;)g.alternate!==null&&(T=g),g=g.sibling;T===null?f.tail=null:T.sibling=null;break;case"collapsed":T=f.tail;for(var k=null;T!==null;)T.alternate!==null&&(k=T),T=T.sibling;k===null?g||f.tail===null?f.tail=null:f.tail.sibling=null:k.sibling=null}}function kn(f){var g=f.alternate!==null&&f.alternate.child===f.child,T=0,k=0;if(g)for(var V=f.child;V!==null;)T|=V.lanes|V.childLanes,k|=V.subtreeFlags&31457280,k|=V.flags&31457280,V.return=f,V=V.sibling;else for(V=f.child;V!==null;)T|=V.lanes|V.childLanes,k|=V.subtreeFlags,k|=V.flags,V.return=f,V=V.sibling;return f.subtreeFlags|=k,f.childLanes=T,g}function Mr(f,g,T){var k=g.pendingProps;switch(_p(g),g.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return kn(g),null;case 1:return kn(g),null;case 3:return T=g.stateNode,k=null,f!==null&&(k=f.memoizedState.cache),g.memoizedState.cache!==k&&(g.flags|=2048),go(Ri),Cr(),T.pendingContext&&(T.context=T.pendingContext,T.pendingContext=null),(f===null||f.child===null)&&(Ac(g)?En(g):f===null||f.memoizedState.isDehydrated&&!(g.flags&256)||(g.flags|=1024,Ao!==null&&(b_(Ao),Ao=null))),kn(g),null;case 26:return T=g.memoizedState,f===null?(En(g),T!==null?(kn(g),Sn(g,T)):(kn(g),g.flags&=-16777217)):T?T!==f.memoizedState?(En(g),kn(g),Sn(g,T)):(kn(g),g.flags&=-16777217):(f.memoizedProps!==k&&En(g),kn(g),g.flags&=-16777217),null;case 27:$n(g),T=Dr.current;var V=g.type;if(f!==null&&g.stateNode!=null)f.memoizedProps!==k&&En(g);else{if(!k){if(g.stateNode===null)throw Error(o(166));return kn(g),null}f=Qn.current,Ac(g)?gp(g):(f=$y(V,k,T),g.stateNode=f,En(g))}return kn(g),null;case 5:if($n(g),T=g.type,f!==null&&g.stateNode!=null)f.memoizedProps!==k&&En(g);else{if(!k){if(g.stateNode===null)throw Error(o(166));return kn(g),null}if(f=Qn.current,Ac(g))gp(g);else{switch(V=Ed(Dr.current),f){case 1:f=V.createElementNS("http://www.w3.org/2000/svg",T);break;case 2:f=V.createElementNS("http://www.w3.org/1998/Math/MathML",T);break;default:switch(T){case"svg":f=V.createElementNS("http://www.w3.org/2000/svg",T);break;case"math":f=V.createElementNS("http://www.w3.org/1998/Math/MathML",T);break;case"script":f=V.createElement("div"),f.innerHTML="<script><\/script>",f=f.removeChild(f.firstChild);break;case"select":f=typeof k.is=="string"?V.createElement("select",{is:k.is}):V.createElement("select"),k.multiple?f.multiple=!0:k.size&&(f.size=k.size);break;default:f=typeof k.is=="string"?V.createElement(T,{is:k.is}):V.createElement(T)}}f[pe]=g,f[Se]=k;e:for(V=g.child;V!==null;){if(V.tag===5||V.tag===6)f.appendChild(V.stateNode);else if(V.tag!==4&&V.tag!==27&&V.child!==null){V.child.return=V,V=V.child;continue}if(V===g)break e;for(;V.sibling===null;){if(V.return===null||V.return===g)break e;V=V.return}V.sibling.return=V.return,V=V.sibling}g.stateNode=f;e:switch(ao(f,T,k),T){case"button":case"input":case"select":case"textarea":f=!!k.autoFocus;break e;case"img":f=!0;break e;default:f=!1}f&&En(g)}}return kn(g),g.flags&=-16777217,null;case 6:if(f&&g.stateNode!=null)f.memoizedProps!==k&&En(g);else{if(typeof k!="string"&&g.stateNode===null)throw Error(o(166));if(f=Dr.current,Ac(g)){if(f=g.stateNode,T=g.memoizedProps,k=null,V=li,V!==null)switch(V.tag){case 27:case 5:k=V.memoizedProps}f[pe]=g,f=!!(f.nodeValue===T||k!==null&&k.suppressHydrationWarning===!0||Td(f.nodeValue,T)),f||ol(g)}else f=Ed(f).createTextNode(k),f[pe]=g,g.stateNode=f}return kn(g),null;case 13:if(k=g.memoizedState,f===null||f.memoizedState!==null&&f.memoizedState.dehydrated!==null){if(V=Ac(g),k!==null&&k.dehydrated!==null){if(f===null){if(!V)throw Error(o(318));if(V=g.memoizedState,V=V!==null?V.dehydrated:null,!V)throw Error(o(317));V[pe]=g}else Ch(),!(g.flags&128)&&(g.memoizedState=null),g.flags|=4;kn(g),V=!1}else Ao!==null&&(b_(Ao),Ao=null),V=!0;if(!V)return g.flags&256?(Fl(g),g):(Fl(g),null)}if(Fl(g),g.flags&128)return g.lanes=T,g;if(T=k!==null,f=f!==null&&f.memoizedState!==null,T){k=g.child,V=null,k.alternate!==null&&k.alternate.memoizedState!==null&&k.alternate.memoizedState.cachePool!==null&&(V=k.alternate.memoizedState.cachePool.pool);var Q=null;k.memoizedState!==null&&k.memoizedState.cachePool!==null&&(Q=k.memoizedState.cachePool.pool),Q!==V&&(k.flags|=2048)}return T!==f&&T&&(g.child.flags|=8192),bn(g,g.updateQueue),kn(g),null;case 4:return Cr(),f===null&&D_(g.stateNode.containerInfo),kn(g),null;case 10:return go(g.type),kn(g),null;case 19:if(yn(wa),V=g.memoizedState,V===null)return kn(g),null;if(k=(g.flags&128)!==0,Q=V.rendering,Q===null)if(k)Ln(V,!1);else{if(hr!==0||f!==null&&f.flags&128)for(f=g.child;f!==null;){if(Q=Kf(f),Q!==null){for(g.flags|=128,Ln(V,!1),f=Q.updateQueue,g.updateQueue=f,bn(g,f),g.subtreeFlags=0,f=T,T=g.child;T!==null;)It(T,f),T=T.sibling;return Ne(wa,wa.current&1|2),g.child}f=f.sibling}V.tail!==null&&Bn()>ja&&(g.flags|=128,k=!0,Ln(V,!1),g.lanes=4194304)}else{if(!k)if(f=Kf(Q),f!==null){if(g.flags|=128,k=!0,f=f.updateQueue,g.updateQueue=f,bn(g,f),Ln(V,!0),V.tail===null&&V.tailMode==="hidden"&&!Q.alternate&&!Ur)return kn(g),null}else 2*Bn()-V.renderingStartTime>ja&&T!==536870912&&(g.flags|=128,k=!0,Ln(V,!1),g.lanes=4194304);V.isBackwards?(Q.sibling=g.child,g.child=Q):(f=V.last,f!==null?f.sibling=Q:g.child=Q,V.last=Q)}return V.tail!==null?(g=V.tail,V.rendering=g,V.tail=g.sibling,V.renderingStartTime=Bn(),g.sibling=null,f=wa.current,Ne(wa,k?f&1|2:f&1),g):(kn(g),null);case 22:case 23:return Fl(g),Ph(),k=g.memoizedState!==null,f!==null?f.memoizedState!==null!==k&&(g.flags|=8192):k&&(g.flags|=8192),k?T&536870912&&!(g.flags&128)&&(kn(g),g.subtreeFlags&6&&(g.flags|=8192)):kn(g),T=g.updateQueue,T!==null&&bn(g,T.retryQueue),T=null,f!==null&&f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(T=f.memoizedState.cachePool.pool),k=null,g.memoizedState!==null&&g.memoizedState.cachePool!==null&&(k=g.memoizedState.cachePool.pool),k!==T&&(g.flags|=2048),f!==null&&yn(hn),null;case 24:return T=null,f!==null&&(T=f.memoizedState.cache),g.memoizedState.cache!==T&&(g.flags|=2048),go(Ri),kn(g),null;case 25:return null}throw Error(o(156,g.tag))}function ui(f,g){switch(_p(g),g.tag){case 1:return f=g.flags,f&65536?(g.flags=f&-65537|128,g):null;case 3:return go(Ri),Cr(),f=g.flags,f&65536&&!(f&128)?(g.flags=f&-65537|128,g):null;case 26:case 27:case 5:return $n(g),null;case 13:if(Fl(g),f=g.memoizedState,f!==null&&f.dehydrated!==null){if(g.alternate===null)throw Error(o(340));Ch()}return f=g.flags,f&65536?(g.flags=f&-65537|128,g):null;case 19:return yn(wa),null;case 4:return Cr(),null;case 10:return go(g.type),null;case 22:case 23:return Fl(g),Ph(),f!==null&&yn(hn),f=g.flags,f&65536?(g.flags=f&-65537|128,g):null;case 24:return go(Ri),null;case 25:return null;default:return null}}function qr(f,g){switch(_p(g),g.tag){case 3:go(Ri),Cr();break;case 26:case 27:case 5:$n(g);break;case 4:Cr();break;case 13:Fl(g);break;case 19:yn(wa);break;case 10:go(g.type);break;case 22:case 23:Fl(g),Ph(),f!==null&&yn(hn);break;case 24:go(Ri)}}var Fn={getCacheForType:function(f){var g=to(Ri),T=g.data.get(f);return T===void 0&&(T=f(),g.data.set(f,T)),T}},mr=typeof WeakMap=="function"?WeakMap:Map,sn=0,Pn=null,An=null,In=0,or=0,Gr=null,Kr=!1,hi=!1,yo=!1,Ci=0,hr=0,Er=0,Tr=0,cr=0,Nr=0,xi=0,Or=null,bi=null,Io=!1,ro=0,ja=1/0,Ko=null,Ea=null,io=!1,Jo=null,Ro=0,Yl=0,Hc=null,Zc=0,yd=null;function Es(){if(sn&2&&In!==0)return In&-In;if(He.T!==null){var f=ll;return f!==0?f:I_()}return Ds()}function k2(){Nr===0&&(Nr=!(In&536870912)||Ur?_u():536870912);var f=eo.current;return f!==null&&(f.flags|=32),Nr}function Qo(f,g,T){(f===Pn&&or===2||f.cancelPendingCommit!==null)&&(Yh(f,0),Wc(f,In,Nr,!1)),vi(f,T),(!(sn&2)||f!==Pn)&&(f===Pn&&(!(sn&2)&&(Tr|=T),hr===4&&Wc(f,In,Nr,!1)),Ys(f))}function Py(f,g,T){if(sn&6)throw Error(o(327));var k=!T&&(g&60)===0&&(g&f.expiredLanes)===0||nl(f,g),V=k?n0(f,g):Dy(f,g,!0),Q=k;do{if(V===0){hi&&!k&&Wc(f,g,0,!1);break}else if(V===6)Wc(f,g,0,!Kr);else{if(T=f.current.alternate,Q&&!z2(T)){V=Dy(f,g,!1),Q=!1;continue}if(V===2){if(Q=g,f.errorRecoveryDisabledLanes&Q)var be=0;else be=f.pendingLanes&-536870913,be=be!==0?be:be&536870912?536870912:0;if(be!==0){g=be;e:{var Be=f;V=Or;var rt=Be.current.memoizedState.isDehydrated;if(rt&&(Yh(Be,be).flags|=256),be=Dy(Be,be,!1),be!==2){if(yo&&!rt){Be.errorRecoveryDisabledLanes|=Q,Tr|=Q,V=4;break e}Q=bi,bi=V,Q!==null&&b_(Q)}V=be}if(Q=!1,V!==2)continue}}if(V===1){Yh(f,0),Wc(f,g,0,!0);break}e:{switch(k=f,V){case 0:case 1:throw Error(o(345));case 4:if((g&4194176)===g){Wc(k,g,Nr,!Kr);break e}break;case 2:bi=null;break;case 3:case 5:break;default:throw Error(o(329))}if(k.finishedWork=T,k.finishedLanes=g,(g&62914560)===g&&(Q=ro+300-Bn(),10<Q)){if(Wc(k,g,Nr,!Kr),Al(k,0)!==0)break e;k.timeoutHandle=jy(Iy.bind(null,k,T,bi,Ko,Io,g,Nr,Tr,xi,Kr,2,-0,0),Q);break e}Iy(k,T,bi,Ko,Io,g,Nr,Tr,xi,Kr,0,-0,0)}}break}while(!0);Ys(f)}function b_(f){bi===null?bi=f:bi.push.apply(bi,f)}function Iy(f,g,T,k,V,Q,be,Be,rt,Tt,en,mn,Ft){var Qt=g.subtreeFlags;if((Qt&8192||(Qt&16785408)===16785408)&&(d0={stylesheets:null,count:0,unsuspend:f3},ot(g),g=p3(),g!==null)){f.cancelPendingCommit=g(F2.bind(null,f,T,k,V,be,Be,rt,1,mn,Ft)),Wc(f,Q,be,!Tt);return}F2(f,T,k,V,be,Be,rt,en,mn,Ft)}function z2(f){for(var g=f;;){var T=g.tag;if((T===0||T===11||T===15)&&g.flags&16384&&(T=g.updateQueue,T!==null&&(T=T.stores,T!==null)))for(var k=0;k<T.length;k++){var V=T[k],Q=V.getSnapshot;V=V.value;try{if(!xa(Q(),V))return!1}catch{return!1}}if(T=g.child,g.subtreeFlags&16384&&T!==null)T.return=g,g=T;else{if(g===f)break;for(;g.sibling===null;){if(g.return===null||g.return===f)return!0;g=g.return}g.sibling.return=g.return,g=g.sibling}}return!0}function Wc(f,g,T,k){g&=~cr,g&=~Tr,f.suspendedLanes|=g,f.pingedLanes&=~g,k&&(f.warmLanes|=g),k=f.expirationTimes;for(var V=g;0<V;){var Q=31-pa(V),be=1<<Q;k[Q]=-1,V&=~be}T!==0&&If(f,T,g)}function t0(){return sn&6?!0:(i0(0),!1)}function w_(){if(An!==null){if(or===0)var f=An.return;else f=An,Gs=Zl=null,Bh(f),Cc=null,Mc=0,f=An;for(;f!==null;)qr(f.alternate,f),f=f.return;An=null}}function Yh(f,g){f.finishedWork=null,f.finishedLanes=0;var T=f.timeoutHandle;T!==-1&&(f.timeoutHandle=-1,W2(T)),T=f.cancelPendingCommit,T!==null&&(f.cancelPendingCommit=null,T()),w_(),Pn=f,An=T=Gt(f.current,null),In=g,or=0,Gr=null,Kr=!1,hi=nl(f,g),yo=!1,xi=Nr=cr=Tr=Er=hr=0,bi=Or=null,Io=!1,g&8&&(g|=g&32);var k=f.entangledLanes;if(k!==0)for(f=f.entanglements,k&=g;0<k;){var V=31-pa(k),Q=1<<V;g|=f[V],k&=~Q}return Ci=g,Tc(),T}function qu(f,g){Yt=null,He.H=xs,g===sl?(g=xp(),or=3):g===l_?(g=xp(),or=4):or=g===Jm?8:g!==null&&typeof g=="object"&&typeof g.then=="function"?6:1,Gr=g,An===null&&(hr=1,hd(f,qo(g,f.current)))}function Aa(){var f=He.H;return He.H=xs,f===null?xs:f}function Ry(){var f=He.A;return He.A=Fn,f}function vd(){hr=4,Kr||(In&4194176)!==In&&eo.current!==null||(hi=!0),!(Er&134217727)&&!(Tr&134217727)||Pn===null||Wc(Pn,In,Nr,!1)}function Dy(f,g,T){var k=sn;sn|=2;var V=Aa(),Q=Ry();(Pn!==f||In!==g)&&(Ko=null,Yh(f,g)),g=!1;var be=hr;e:do try{if(or!==0&&An!==null){var Be=An,rt=Gr;switch(or){case 8:w_(),be=6;break e;case 3:case 2:case 6:eo.current===null&&(g=!0);var Tt=or;if(or=0,Gr=null,$p(f,Be,rt,Tt),T&&hi){be=0;break e}break;default:Tt=or,or=0,Gr=null,$p(f,Be,rt,Tt)}}QS(),be=hr;break}catch(en){qu(f,en)}while(!0);return g&&f.shellSuspendCounter++,Gs=Zl=null,sn=k,He.H=V,He.A=Q,An===null&&(Pn=null,In=0,Tc()),be}function QS(){for(;An!==null;)Kh(An)}function n0(f,g){var T=sn;sn|=2;var k=Aa(),V=Ry();Pn!==f||In!==g?(Ko=null,ja=Bn()+500,Yh(f,g)):hi=nl(f,g);e:do try{if(or!==0&&An!==null){g=An;var Q=Gr;t:switch(or){case 1:or=0,Gr=null,$p(f,g,Q,1);break;case 2:if(c_(Q)){or=0,Gr=null,Vp(g);break}g=function(){or===2&&Pn===f&&(or=7),Ys(f)},Q.then(g,g);break e;case 3:or=7;break e;case 4:or=5;break e;case 7:c_(Q)?(or=0,Gr=null,Vp(g)):(or=0,Gr=null,$p(f,g,Q,7));break;case 5:var be=null;switch(An.tag){case 26:be=An.memoizedState;case 5:case 27:var Be=An;if(!be||ix(be)){or=0,Gr=null;var rt=Be.sibling;if(rt!==null)An=rt;else{var Tt=Be.return;Tt!==null?(An=Tt,S_(Tt)):An=null}break t}}or=0,Gr=null,$p(f,g,Q,5);break;case 6:or=0,Gr=null,$p(f,g,Q,6);break;case 8:w_(),hr=6;break e;default:throw Error(o(462))}}B2();break}catch(en){qu(f,en)}while(!0);return Gs=Zl=null,He.H=k,He.A=V,sn=T,An!==null?0:(Pn=null,In=0,Tc(),hr)}function B2(){for(;An!==null&&!co();)Kh(An)}function Kh(f){var g=Fp(f.alternate,f,Ci);f.memoizedProps=f.pendingProps,g===null?S_(f):An=g}function Vp(f){var g=f,T=g.alternate;switch(g.tag){case 15:case 0:g=dd(T,g,g.pendingProps,g.type,void 0,In);break;case 11:g=dd(T,g,g.pendingProps,g.type.render,g.ref,In);break;case 5:Bh(g);default:qr(T,g),g=An=It(g,Ci),g=Fp(T,g,Ci)}f.memoizedProps=f.pendingProps,g===null?S_(f):An=g}function $p(f,g,T,k){Gs=Zl=null,Bh(g),Cc=null,Mc=0;var V=g.return;try{if(g_(f,V,g,T,In)){hr=1,hd(f,qo(T,f.current)),An=null;return}}catch(Q){if(V!==null)throw An=V,Q;hr=1,hd(f,qo(T,f.current)),An=null;return}g.flags&32768?(Ur||k===1?f=!0:hi||In&536870912?f=!1:(Kr=f=!0,(k===2||k===3||k===6)&&(k=eo.current,k!==null&&k.tag===13&&(k.flags|=16384))),N2(g,f)):S_(g)}function S_(f){var g=f;do{if(g.flags&32768){N2(g,Kr);return}f=g.return;var T=Mr(g.alternate,g,Ci);if(T!==null){An=T;return}if(g=g.sibling,g!==null){An=g;return}An=g=f}while(g!==null);hr===0&&(hr=5)}function N2(f,g){do{var T=ui(f.alternate,f);if(T!==null){T.flags&=32767,An=T;return}if(T=f.return,T!==null&&(T.flags|=32768,T.subtreeFlags=0,T.deletions=null),!g&&(f=f.sibling,f!==null)){An=f;return}An=f=T}while(f!==null);hr=6,An=null}function F2(f,g,T,k,V,Q,be,Be,rt,Tt){var en=He.T,mn=xn.p;try{xn.p=2,He.T=null,e3(f,g,T,k,mn,V,Q,be,Be,rt,Tt)}finally{He.T=en,xn.p=mn}}function e3(f,g,T,k,V,Q,be,Be){do qp();while(Jo!==null);if(sn&6)throw Error(o(327));var rt=f.finishedWork;if(k=f.finishedLanes,rt===null)return null;if(f.finishedWork=null,f.finishedLanes=0,rt===f.current)throw Error(o(177));f.callbackNode=null,f.callbackPriority=0,f.cancelPendingCommit=null;var Tt=rt.lanes|rt.childLanes;if(Tt|=Sc,Pf(f,k,Tt,Q,be,Be),f===Pn&&(An=Pn=null,In=0),!(rt.subtreeFlags&10256)&&!(rt.flags&10256)||io||(io=!0,Yl=Tt,Hc=T,A_(fa,function(){return qp(),null})),T=(rt.flags&15990)!==0,rt.subtreeFlags&15990||T?(T=He.T,He.T=null,Q=xn.p,xn.p=2,be=sn,sn|=4,l(f,rt),ue(rt,f),o_(z_,f.containerInfo),m0=!!Zp,z_=Zp=null,f.current=rt,m(f,rt.alternate,rt),Rs(),sn=be,xn.p=Q,He.T=T):f.current=rt,io?(io=!1,Jo=f,Ro=k):j2(f,Tt),Tt=f.pendingLanes,Tt===0&&(Ea=null),fh(rt.stateNode),Ys(f),g!==null)for(V=f.onRecoverableError,rt=0;rt<g.length;rt++)Tt=g[rt],V(Tt.value,{componentStack:Tt.stack});return Ro&3&&qp(),Tt=f.pendingLanes,k&4194218&&Tt&42?f===yd?Zc++:(Zc=0,yd=f):Zc=0,i0(0),null}function j2(f,g){(f.pooledCacheLanes&=g)===0&&(g=f.pooledCache,g!=null&&(f.pooledCache=null,jl(g)))}function qp(){if(Jo!==null){var f=Jo,g=Yl;Yl=0;var T=ma(Ro),k=He.T,V=xn.p;try{if(xn.p=32>T?32:T,He.T=null,Jo===null)var Q=!1;else{T=Hc,Hc=null;var be=Jo,Be=Ro;if(Jo=null,Ro=0,sn&6)throw Error(o(331));var rt=sn;if(sn|=4,nt(be.current),ze(be,be.current,Be,T),sn=rt,i0(0,!1),Ia&&typeof Ia.onPostCommitFiberRoot=="function")try{Ia.onPostCommitFiberRoot(da,be)}catch{}Q=!0}return Q}finally{xn.p=V,He.T=k,j2(f,g)}}return!1}function T_(f,g,T){g=qo(T,g),g=Bu(f.stateNode,g,2),f=Wl(f,g,2),f!==null&&(vi(f,2),Ys(f))}function Mi(f,g,T){if(f.tag===3)T_(f,f,T);else for(;g!==null;){if(g.tag===3){T_(g,f,T);break}else if(g.tag===1){var k=g.stateNode;if(typeof g.type.getDerivedStateFromError=="function"||typeof k.componentDidCatch=="function"&&(Ea===null||!Ea.has(k))){f=qo(T,f),T=Ym(2),k=Wl(g,T,2),k!==null&&(Km(T,k,g,f),vi(k,2),Ys(k));break}}g=g.return}}function Jh(f,g,T){var k=f.pingCache;if(k===null){k=f.pingCache=new mr;var V=new Set;k.set(g,V)}else V=k.get(g),V===void 0&&(V=new Set,k.set(g,V));V.has(T)||(yo=!0,V.add(T),f=t3.bind(null,f,g,T),g.then(f,f))}function t3(f,g,T){var k=f.pingCache;k!==null&&k.delete(g),f.pingedLanes|=f.suspendedLanes&T,f.warmLanes&=~T,Pn===f&&(In&T)===T&&(hr===4||hr===3&&(In&62914560)===In&&300>Bn()-ro?!(sn&2)&&Yh(f,0):cr|=T,xi===In&&(xi=0)),Ys(f)}function Gi(f,g){g===0&&(g=Of()),f=$o(f,g),f!==null&&(vi(f,g),Ys(f))}function E_(f){var g=f.memoizedState,T=0;g!==null&&(T=g.retryLane),Gi(f,T)}function U2(f,g){var T=0;switch(f.tag){case 13:var k=f.stateNode,V=f.memoizedState;V!==null&&(T=V.retryLane);break;case 19:k=f.stateNode;break;case 22:k=f.stateNode._retryCache;break;default:throw Error(o(314))}k!==null&&k.delete(g),Gi(f,T)}function A_(f,g){return ha(f,g)}var xd=null,Xc=null,C_=!1,r0=!1,bd=!1,Gu=0;function Ys(f){f!==Xc&&f.next===null&&(Xc===null?xd=Xc=f:Xc=Xc.next=f),r0=!0,C_||(C_=!0,$2(V2))}function i0(f,g){if(!bd&&r0){bd=!0;do for(var T=!1,k=xd;k!==null;){if(f!==0){var V=k.pendingLanes;if(V===0)var Q=0;else{var be=k.suspendedLanes,Be=k.pingedLanes;Q=(1<<31-pa(42|f)+1)-1,Q&=V&~(be&~Be),Q=Q&201326677?Q&201326677|1:Q?Q|2:0}Q!==0&&(T=!0,P_(k,Q))}else Q=In,Q=Al(k,k===Pn?Q:0),!(Q&3)||nl(k,Q)||(T=!0,P_(k,Q));k=k.next}while(T);bd=!1}}function V2(){r0=C_=!1;var f=0;Gu!==0&&(a3()&&(f=Gu),Gu=0);for(var g=Bn(),T=null,k=xd;k!==null;){var V=k.next,Q=M_(k,g);Q===0?(k.next=null,T===null?xd=V:T.next=V,V===null&&(Xc=T)):(T=k,(f!==0||Q&3)&&(r0=!0)),k=V}i0(f)}function M_(f,g){for(var T=f.suspendedLanes,k=f.pingedLanes,V=f.expirationTimes,Q=f.pendingLanes&-62914561;0<Q;){var be=31-pa(Q),Be=1<<be,rt=V[be];rt===-1?(!(Be&T)||Be&k)&&(V[be]=ip(Be,g)):rt<=g&&(f.expiredLanes|=Be),Q&=~Be}if(g=Pn,T=In,T=Al(f,f===g?T:0),k=f.callbackNode,T===0||f===g&&or===2||f.cancelPendingCommit!==null)return k!==null&&k!==null&&Pa(k),f.callbackNode=null,f.callbackPriority=0;if(!(T&3)||nl(f,T)){if(g=T&-T,g===f.callbackPriority)return g;switch(k!==null&&Pa(k),ma(T)){case 2:case 8:T=Tl;break;case 32:T=fa;break;case 268435456:T=hc;break;default:T=fa}return k=O_.bind(null,f),T=ha(T,k),f.callbackPriority=g,f.callbackNode=T,g}return k!==null&&k!==null&&Pa(k),f.callbackPriority=2,f.callbackNode=null,2}function O_(f,g){var T=f.callbackNode;if(qp()&&f.callbackNode!==T)return null;var k=In;return k=Al(f,f===Pn?k:0),k===0?null:(Py(f,k,g),M_(f,Bn()),f.callbackNode!=null&&f.callbackNode===T?O_.bind(null,f):null)}function P_(f,g){if(qp())return null;Py(f,g,!0)}function $2(f){X2(function(){sn&6?ha(is,f):f()})}function I_(){return Gu===0&&(Gu=_u()),Gu}function Ly(f){return f==null||typeof f=="symbol"||typeof f=="boolean"?null:typeof f=="function"?f:_r(""+f)}function ky(f,g){var T=g.ownerDocument.createElement("input");return T.name=g.name,T.value=g.value,f.id&&T.setAttribute("form",f.id),g.parentNode.insertBefore(T,g),f=new FormData(f),T.parentNode.removeChild(T),f}function zy(f,g,T,k,V){if(g==="submit"&&T&&T.stateNode===V){var Q=Ly((V[Se]||null).action),be=k.submitter;be&&(g=(g=be[Se]||null)?Ly(g.formAction):be.getAttribute("formAction"),g!==null&&(Q=g,be=null));var Be=new gh("action","action",null,k,V);f.push({event:Be,listeners:[{instance:null,listener:function(){if(k.defaultPrevented){if(Gu!==0){var rt=be?ky(V,be):new FormData(V);Sa(T,{pending:!0,data:rt,method:V.method,action:Q},null,rt)}}else typeof Q=="function"&&(Be.preventDefault(),rt=be?ky(V,be):new FormData(V),Sa(T,{pending:!0,data:rt,method:V.method,action:Q},Q,rt))},currentTarget:V}]})}}for(var _l=0;_l<Sh.length;_l++){var R_=Sh[_l],n3=R_.toLowerCase(),r3=R_[0].toUpperCase()+R_.slice(1);fo(n3,"on"+r3)}fo(Hf,"onAnimationEnd"),fo(wh,"onAnimationIteration"),fo(Zf,"onAnimationStart"),fo("dblclick","onDoubleClick"),fo("focusin","onFocus"),fo("focusout","onBlur"),fo(bc,"onTransitionRun"),fo(mp,"onTransitionStart"),fo(Nm,"onTransitionCancel"),fo(wc,"onTransitionEnd"),er("onMouseEnter",["mouseout","mouseover"]),er("onMouseLeave",["mouseout","mouseover"]),er("onPointerEnter",["pointerout","pointerover"]),er("onPointerLeave",["pointerout","pointerover"]),wn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),wn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),wn("onBeforeInput",["compositionend","keypress","textInput","paste"]),wn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),wn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),wn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var a0="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),i3=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(a0));function q2(f,g){g=(g&4)!==0;for(var T=0;T<f.length;T++){var k=f[T],V=k.event;k=k.listeners;e:{var Q=void 0;if(g)for(var be=k.length-1;0<=be;be--){var Be=k[be],rt=Be.instance,Tt=Be.currentTarget;if(Be=Be.listener,rt!==Q&&V.isPropagationStopped())break e;Q=Be,V.currentTarget=Tt;try{Q(V)}catch(en){Vc(en)}V.currentTarget=null,Q=rt}else for(be=0;be<k.length;be++){if(Be=k[be],rt=Be.instance,Tt=Be.currentTarget,Be=Be.listener,rt!==Q&&V.isPropagationStopped())break e;Q=Be,V.currentTarget=Tt;try{Q(V)}catch(en){Vc(en)}V.currentTarget=null,Q=rt}}}}function Hr(f,g){var T=g[je];T===void 0&&(T=g[je]=new Set);var k=f+"__bubble";T.has(k)||(L_(g,f,2,!1),T.add(k))}function By(f,g,T){var k=0;g&&(k|=4),L_(T,f,k,g)}var Gp="_reactListening"+Math.random().toString(36).slice(2);function D_(f){if(!f[Gp]){f[Gp]=!0,Cn.forEach(function(T){T!=="selectionchange"&&(i3.has(T)||By(T,!1,f),By(T,!0,f))});var g=f.nodeType===9?f:f.ownerDocument;g===null||g[Gp]||(g[Gp]=!0,By("selectionchange",!1,g))}}function L_(f,g,T,k){switch(ox(g)){case 2:var V=ax;break;case 8:V=tv;break;default:V=q_}T=V.bind(null,g,T,f),V=void 0,!_n||g!=="touchstart"&&g!=="touchmove"&&g!=="wheel"||(V=!0),k?V!==void 0?f.addEventListener(g,T,{capture:!0,passive:V}):f.addEventListener(g,T,!0):V!==void 0?f.addEventListener(g,T,{passive:V}):f.addEventListener(g,T,!1)}function k_(f,g,T,k,V){var Q=k;if(!(g&1)&&!(g&2)&&k!==null)e:for(;;){if(k===null)return;var be=k.tag;if(be===3||be===4){var Be=k.stateNode.containerInfo;if(Be===V||Be.nodeType===8&&Be.parentNode===V)break;if(be===4)for(be=k.return;be!==null;){var rt=be.tag;if((rt===3||rt===4)&&(rt=be.stateNode.containerInfo,rt===V||rt.nodeType===8&&rt.parentNode===V))return;be=be.return}for(;Be!==null;){if(be=ut(Be),be===null)return;if(rt=be.tag,rt===5||rt===6||rt===26||rt===27){k=Q=be;continue e}Be=Be.parentNode}}k=k.return}kf(function(){var Tt=Q,en=Mn(T),mn=[];e:{var Ft=bu.get(f);if(Ft!==void 0){var Qt=gh,Hn=f;switch(f){case"keypress":if(dc(T)===0)break e;case"keydown":case"keyup":Qt=ho;break;case"focusin":Hn="focus",Qt=ai;break;case"focusout":Hn="blur",Qt=ai;break;case"beforeblur":case"afterblur":Qt=ai;break;case"click":if(T.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Qt=Bs;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Qt=Am;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Qt=jf;break;case Hf:case wh:case Zf:Qt=ya;break;case wc:Qt=Cy;break;case"scroll":case"scrollend":Qt=sp;break;case"wheel":Qt=Vf;break;case"copy":case"cut":case"paste":Qt=zf;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Qt=Nf;break;case"toggle":case"beforetoggle":Qt=vh}var Ar=(g&4)!==0,Qi=!Ar&&(f==="scroll"||f==="scrollend"),Mt=Ar?Ft!==null?Ft+"Capture":null:Ft;Ar=[];for(var xt=Tt,Dt;xt!==null;){var un=xt;if(Dt=un.stateNode,un=un.tag,un!==5&&un!==26&&un!==27||Dt===null||Mt===null||(un=zs(xt,Mt),un!=null&&Ar.push(wd(xt,un,Dt))),Qi)break;xt=xt.return}0<Ar.length&&(Ft=new Qt(Ft,Hn,null,T,en),mn.push({event:Ft,listeners:Ar}))}}if(!(g&7)){e:{if(Ft=f==="mouseover"||f==="pointerover",Qt=f==="mouseout"||f==="pointerout",Ft&&T!==Df&&(Hn=T.relatedTarget||T.fromElement)&&(ut(Hn)||Hn[Le]))break e;if((Qt||Ft)&&(Ft=en.window===en?en:(Ft=en.ownerDocument)?Ft.defaultView||Ft.parentWindow:window,Qt?(Hn=T.relatedTarget||T.toElement,Qt=Tt,Hn=Hn?ut(Hn):null,Hn!==null&&(Qi=Ht(Hn),Ar=Hn.tag,Hn!==Qi||Ar!==5&&Ar!==27&&Ar!==6)&&(Hn=null)):(Qt=null,Hn=Tt),Qt!==Hn)){if(Ar=Bs,un="onMouseLeave",Mt="onMouseEnter",xt="mouse",(f==="pointerout"||f==="pointerover")&&(Ar=Nf,un="onPointerLeave",Mt="onPointerEnter",xt="pointer"),Qi=Qt==null?Ft:Zt(Qt),Dt=Hn==null?Ft:Zt(Hn),Ft=new Ar(un,xt+"leave",Qt,T,en),Ft.target=Qi,Ft.relatedTarget=Dt,un=null,ut(en)===Tt&&(Ar=new Ar(Mt,xt+"enter",Hn,T,en),Ar.target=Dt,Ar.relatedTarget=Qi,un=Ar),Qi=un,Qt&&Hn)t:{for(Ar=Qt,Mt=Hn,xt=0,Dt=Ar;Dt;Dt=Sd(Dt))xt++;for(Dt=0,un=Mt;un;un=Sd(un))Dt++;for(;0<xt-Dt;)Ar=Sd(Ar),xt--;for(;0<Dt-xt;)Mt=Sd(Mt),Dt--;for(;xt--;){if(Ar===Mt||Mt!==null&&Ar===Mt.alternate)break t;Ar=Sd(Ar),Mt=Sd(Mt)}Ar=null}else Ar=null;Qt!==null&&s0(mn,Ft,Qt,Ar,!1),Hn!==null&&Qi!==null&&s0(mn,Qi,Hn,Ar,!0)}}e:{if(Ft=Tt?Zt(Tt):window,Qt=Ft.nodeName&&Ft.nodeName.toLowerCase(),Qt==="select"||Qt==="input"&&Ft.type==="file")var Un=hp;else if(Dn(Ft))if($f)Un=kl;else{Un=_c;var wr=Gf}else Qt=Ft.nodeName,!Qt||Qt.toLowerCase()!=="input"||Ft.type!=="checkbox"&&Ft.type!=="radio"?Tt&&op(Tt.elementType)&&(Un=hp):Un=va;if(Un&&(Un=Un(f,Tt))){vu(mn,Un,T,en);break e}wr&&wr(f,Ft,Tt),f==="focusout"&&Tt&&Ft.type==="number"&&Tt.memoizedProps.value!=null&&Ls(Ft,"number",Ft.value)}switch(wr=Tt?Zt(Tt):window,f){case"focusin":(Dn(wr)||wr.contentEditable==="true")&&(yc=wr,zm=Tt,bh=null);break;case"focusout":bh=zm=yc=null;break;case"mousedown":zl=!0;break;case"contextmenu":case"mouseup":case"dragend":zl=!1,s_(mn,T,en);break;case"selectionchange":if(km)break;case"keydown":case"keyup":s_(mn,T,en)}var nr;if(js)e:{switch(f){case"compositionstart":var fr="onCompositionStart";break e;case"compositionend":fr="onCompositionEnd";break e;case"compositionupdate":fr="onCompositionUpdate";break e}fr=void 0}else ds?i_(f,T)&&(fr="onCompositionEnd"):f==="keydown"&&T.keyCode===229&&(fr="onCompositionStart");fr&&(lp&&T.locale!=="ko"&&(ds||fr!=="onCompositionStart"?fr==="onCompositionEnd"&&ds&&(nr=gr()):(ar=en,_a="value"in ar?ar.value:ar.textContent,ds=!0)),wr=o0(Tt,fr),0<wr.length&&(fr=new pc(fr,f,null,T,en),mn.push({event:fr,listeners:wr}),nr?fr.data=nr:(nr=cp(T),nr!==null&&(fr.data=nr)))),(nr=Oy?Jn(f,T):Tn(f,T))&&(fr=o0(Tt,"onBeforeInput"),0<fr.length&&(wr=new pc("onBeforeInput","beforeinput",null,T,en),mn.push({event:wr,listeners:fr}),wr.data=nr)),zy(mn,f,Tt,T,en)}q2(mn,g)})}function wd(f,g,T){return{instance:f,listener:g,currentTarget:T}}function o0(f,g){for(var T=g+"Capture",k=[];f!==null;){var V=f,Q=V.stateNode;V=V.tag,V!==5&&V!==26&&V!==27||Q===null||(V=zs(f,T),V!=null&&k.unshift(wd(f,V,Q)),V=zs(f,g),V!=null&&k.push(wd(f,V,Q))),f=f.return}return k}function Sd(f){if(f===null)return null;do f=f.return;while(f&&f.tag!==5&&f.tag!==27);return f||null}function s0(f,g,T,k,V){for(var Q=g._reactName,be=[];T!==null&&T!==k;){var Be=T,rt=Be.alternate,Tt=Be.stateNode;if(Be=Be.tag,rt!==null&&rt===k)break;Be!==5&&Be!==26&&Be!==27||Tt===null||(rt=Tt,V?(Tt=zs(T,Q),Tt!=null&&be.unshift(wd(T,Tt,rt))):V||(Tt=zs(T,Q),Tt!=null&&be.push(wd(T,Tt,rt)))),T=T.return}be.length!==0&&f.push({event:g,listeners:be})}var G2=/\r\n?/g,H2=/\u0000|\uFFFD/g;function Ny(f){return(typeof f=="string"?f:""+f).replace(G2,`
`).replace(H2,"")}function Td(f,g){return g=Ny(g),Ny(f)===g}function Yc(){}function mi(f,g,T,k,V,Q){switch(T){case"children":typeof k=="string"?g==="body"||g==="textarea"&&k===""||Ml(f,k):(typeof k=="number"||typeof k=="bigint")&&g!=="body"&&Ml(f,""+k);break;case"className":Ai(f,"class",k);break;case"tabIndex":Ai(f,"tabindex",k);break;case"dir":case"role":case"viewBox":case"width":case"height":Ai(f,T,k);break;case"style":Pl(f,k,Q);break;case"data":if(g!=="object"){Ai(f,"data",k);break}case"src":case"href":if(k===""&&(g!=="a"||T!=="href")){f.removeAttribute(T);break}if(k==null||typeof k=="function"||typeof k=="symbol"||typeof k=="boolean"){f.removeAttribute(T);break}k=_r(""+k),f.setAttribute(T,k);break;case"action":case"formAction":if(typeof k=="function"){f.setAttribute(T,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof Q=="function"&&(T==="formAction"?(g!=="input"&&mi(f,g,"name",V.name,V,null),mi(f,g,"formEncType",V.formEncType,V,null),mi(f,g,"formMethod",V.formMethod,V,null),mi(f,g,"formTarget",V.formTarget,V,null)):(mi(f,g,"encType",V.encType,V,null),mi(f,g,"method",V.method,V,null),mi(f,g,"target",V.target,V,null)));if(k==null||typeof k=="symbol"||typeof k=="boolean"){f.removeAttribute(T);break}k=_r(""+k),f.setAttribute(T,k);break;case"onClick":k!=null&&(f.onclick=Yc);break;case"onScroll":k!=null&&Hr("scroll",f);break;case"onScrollEnd":k!=null&&Hr("scrollend",f);break;case"dangerouslySetInnerHTML":if(k!=null){if(typeof k!="object"||!("__html"in k))throw Error(o(61));if(T=k.__html,T!=null){if(V.children!=null)throw Error(o(60));f.innerHTML=T}}break;case"multiple":f.multiple=k&&typeof k!="function"&&typeof k!="symbol";break;case"muted":f.muted=k&&typeof k!="function"&&typeof k!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(k==null||typeof k=="function"||typeof k=="boolean"||typeof k=="symbol"){f.removeAttribute("xlink:href");break}T=_r(""+k),f.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",T);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":k!=null&&typeof k!="function"&&typeof k!="symbol"?f.setAttribute(T,""+k):f.removeAttribute(T);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":k&&typeof k!="function"&&typeof k!="symbol"?f.setAttribute(T,""):f.removeAttribute(T);break;case"capture":case"download":k===!0?f.setAttribute(T,""):k!==!1&&k!=null&&typeof k!="function"&&typeof k!="symbol"?f.setAttribute(T,k):f.removeAttribute(T);break;case"cols":case"rows":case"size":case"span":k!=null&&typeof k!="function"&&typeof k!="symbol"&&!isNaN(k)&&1<=k?f.setAttribute(T,k):f.removeAttribute(T);break;case"rowSpan":case"start":k==null||typeof k=="function"||typeof k=="symbol"||isNaN(k)?f.removeAttribute(T):f.setAttribute(T,k);break;case"popover":Hr("beforetoggle",f),Hr("toggle",f),Uo(f,"popover",k);break;case"xlinkActuate":ii(f,"http://www.w3.org/1999/xlink","xlink:actuate",k);break;case"xlinkArcrole":ii(f,"http://www.w3.org/1999/xlink","xlink:arcrole",k);break;case"xlinkRole":ii(f,"http://www.w3.org/1999/xlink","xlink:role",k);break;case"xlinkShow":ii(f,"http://www.w3.org/1999/xlink","xlink:show",k);break;case"xlinkTitle":ii(f,"http://www.w3.org/1999/xlink","xlink:title",k);break;case"xlinkType":ii(f,"http://www.w3.org/1999/xlink","xlink:type",k);break;case"xmlBase":ii(f,"http://www.w3.org/XML/1998/namespace","xml:base",k);break;case"xmlLang":ii(f,"http://www.w3.org/XML/1998/namespace","xml:lang",k);break;case"xmlSpace":ii(f,"http://www.w3.org/XML/1998/namespace","xml:space",k);break;case"is":Uo(f,"is",k);break;case"innerText":case"textContent":break;default:(!(2<T.length)||T[0]!=="o"&&T[0]!=="O"||T[1]!=="n"&&T[1]!=="N")&&(T=Em.get(T)||T,Uo(f,T,k))}}function Hp(f,g,T,k,V,Q){switch(T){case"style":Pl(f,k,Q);break;case"dangerouslySetInnerHTML":if(k!=null){if(typeof k!="object"||!("__html"in k))throw Error(o(61));if(T=k.__html,T!=null){if(V.children!=null)throw Error(o(60));f.innerHTML=T}}break;case"children":typeof k=="string"?Ml(f,k):(typeof k=="number"||typeof k=="bigint")&&Ml(f,""+k);break;case"onScroll":k!=null&&Hr("scroll",f);break;case"onScrollEnd":k!=null&&Hr("scrollend",f);break;case"onClick":k!=null&&(f.onclick=Yc);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!On.hasOwnProperty(T))e:{if(T[0]==="o"&&T[1]==="n"&&(V=T.endsWith("Capture"),g=T.slice(2,V?T.length-7:void 0),Q=f[Se]||null,Q=Q!=null?Q[T]:null,typeof Q=="function"&&f.removeEventListener(g,Q,V),typeof k=="function")){typeof Q!="function"&&Q!==null&&(T in f?f[T]=null:f.hasAttribute(T)&&f.removeAttribute(T)),f.addEventListener(g,k,V);break e}T in f?f[T]=k:k===!0?f.setAttribute(T,""):Uo(f,T,k)}}}function ao(f,g,T){switch(g){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Hr("error",f),Hr("load",f);var k=!1,V=!1,Q;for(Q in T)if(T.hasOwnProperty(Q)){var be=T[Q];if(be!=null)switch(Q){case"src":k=!0;break;case"srcSet":V=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(o(137,g));default:mi(f,g,Q,be,T,null)}}V&&mi(f,g,"srcSet",T.srcSet,T,null),k&&mi(f,g,"src",T.src,T,null);return;case"input":Hr("invalid",f);var Be=Q=be=V=null,rt=null,Tt=null;for(k in T)if(T.hasOwnProperty(k)){var en=T[k];if(en!=null)switch(k){case"name":V=en;break;case"type":be=en;break;case"checked":rt=en;break;case"defaultChecked":Tt=en;break;case"value":Q=en;break;case"defaultValue":Be=en;break;case"children":case"dangerouslySetInnerHTML":if(en!=null)throw Error(o(137,g));break;default:mi(f,g,k,en,T,null)}}ss(f,Q,Be,rt,Tt,be,V,!1),fc(f);return;case"select":Hr("invalid",f),k=be=Q=null;for(V in T)if(T.hasOwnProperty(V)&&(Be=T[V],Be!=null))switch(V){case"value":Q=Be;break;case"defaultValue":be=Be;break;case"multiple":k=Be;default:mi(f,g,V,Be,T,null)}g=Q,T=be,f.multiple=!!k,g!=null?uo(f,!!k,g,!1):T!=null&&uo(f,!!k,T,!0);return;case"textarea":Hr("invalid",f),Q=V=k=null;for(be in T)if(T.hasOwnProperty(be)&&(Be=T[be],Be!=null))switch(be){case"value":k=Be;break;case"defaultValue":V=Be;break;case"children":Q=Be;break;case"dangerouslySetInnerHTML":if(Be!=null)throw Error(o(91));break;default:mi(f,g,be,Be,T,null)}ks(f,k,V,Q),fc(f);return;case"option":for(rt in T)if(T.hasOwnProperty(rt)&&(k=T[rt],k!=null))switch(rt){case"selected":f.selected=k&&typeof k!="function"&&typeof k!="symbol";break;default:mi(f,g,rt,k,T,null)}return;case"dialog":Hr("cancel",f),Hr("close",f);break;case"iframe":case"object":Hr("load",f);break;case"video":case"audio":for(k=0;k<a0.length;k++)Hr(a0[k],f);break;case"image":Hr("error",f),Hr("load",f);break;case"details":Hr("toggle",f);break;case"embed":case"source":case"link":Hr("error",f),Hr("load",f);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Tt in T)if(T.hasOwnProperty(Tt)&&(k=T[Tt],k!=null))switch(Tt){case"children":case"dangerouslySetInnerHTML":throw Error(o(137,g));default:mi(f,g,Tt,k,T,null)}return;default:if(op(g)){for(en in T)T.hasOwnProperty(en)&&(k=T[en],k!==void 0&&Hp(f,g,en,k,T,void 0));return}}for(Be in T)T.hasOwnProperty(Be)&&(k=T[Be],k!=null&&mi(f,g,Be,k,T,null))}function Z2(f,g,T,k){switch(g){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var V=null,Q=null,be=null,Be=null,rt=null,Tt=null,en=null;for(Qt in T){var mn=T[Qt];if(T.hasOwnProperty(Qt)&&mn!=null)switch(Qt){case"checked":break;case"value":break;case"defaultValue":rt=mn;default:k.hasOwnProperty(Qt)||mi(f,g,Qt,null,k,mn)}}for(var Ft in k){var Qt=k[Ft];if(mn=T[Ft],k.hasOwnProperty(Ft)&&(Qt!=null||mn!=null))switch(Ft){case"type":Q=Qt;break;case"name":V=Qt;break;case"checked":Tt=Qt;break;case"defaultChecked":en=Qt;break;case"value":be=Qt;break;case"defaultValue":Be=Qt;break;case"children":case"dangerouslySetInnerHTML":if(Qt!=null)throw Error(o(137,g));break;default:Qt!==mn&&mi(f,g,Ft,Qt,k,mn)}}Ra(f,be,Be,rt,Tt,en,Q,V);return;case"select":Qt=be=Be=Ft=null;for(Q in T)if(rt=T[Q],T.hasOwnProperty(Q)&&rt!=null)switch(Q){case"value":break;case"multiple":Qt=rt;default:k.hasOwnProperty(Q)||mi(f,g,Q,null,k,rt)}for(V in k)if(Q=k[V],rt=T[V],k.hasOwnProperty(V)&&(Q!=null||rt!=null))switch(V){case"value":Ft=Q;break;case"defaultValue":Be=Q;break;case"multiple":be=Q;default:Q!==rt&&mi(f,g,V,Q,k,rt)}g=Be,T=be,k=Qt,Ft!=null?uo(f,!!T,Ft,!1):!!k!=!!T&&(g!=null?uo(f,!!T,g,!0):uo(f,!!T,T?[]:"",!1));return;case"textarea":Qt=Ft=null;for(Be in T)if(V=T[Be],T.hasOwnProperty(Be)&&V!=null&&!k.hasOwnProperty(Be))switch(Be){case"value":break;case"children":break;default:mi(f,g,Be,null,k,V)}for(be in k)if(V=k[be],Q=T[be],k.hasOwnProperty(be)&&(V!=null||Q!=null))switch(be){case"value":Ft=V;break;case"defaultValue":Qt=V;break;case"children":break;case"dangerouslySetInnerHTML":if(V!=null)throw Error(o(91));break;default:V!==Q&&mi(f,g,be,V,k,Q)}ls(f,Ft,Qt);return;case"option":for(var Hn in T)if(Ft=T[Hn],T.hasOwnProperty(Hn)&&Ft!=null&&!k.hasOwnProperty(Hn))switch(Hn){case"selected":f.selected=!1;break;default:mi(f,g,Hn,null,k,Ft)}for(rt in k)if(Ft=k[rt],Qt=T[rt],k.hasOwnProperty(rt)&&Ft!==Qt&&(Ft!=null||Qt!=null))switch(rt){case"selected":f.selected=Ft&&typeof Ft!="function"&&typeof Ft!="symbol";break;default:mi(f,g,rt,Ft,k,Qt)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ar in T)Ft=T[Ar],T.hasOwnProperty(Ar)&&Ft!=null&&!k.hasOwnProperty(Ar)&&mi(f,g,Ar,null,k,Ft);for(Tt in k)if(Ft=k[Tt],Qt=T[Tt],k.hasOwnProperty(Tt)&&Ft!==Qt&&(Ft!=null||Qt!=null))switch(Tt){case"children":case"dangerouslySetInnerHTML":if(Ft!=null)throw Error(o(137,g));break;default:mi(f,g,Tt,Ft,k,Qt)}return;default:if(op(g)){for(var Qi in T)Ft=T[Qi],T.hasOwnProperty(Qi)&&Ft!==void 0&&!k.hasOwnProperty(Qi)&&Hp(f,g,Qi,void 0,k,Ft);for(en in k)Ft=k[en],Qt=T[en],!k.hasOwnProperty(en)||Ft===Qt||Ft===void 0&&Qt===void 0||Hp(f,g,en,Ft,k,Qt);return}}for(var Mt in T)Ft=T[Mt],T.hasOwnProperty(Mt)&&Ft!=null&&!k.hasOwnProperty(Mt)&&mi(f,g,Mt,null,k,Ft);for(mn in k)Ft=k[mn],Qt=T[mn],!k.hasOwnProperty(mn)||Ft===Qt||Ft==null&&Qt==null||mi(f,g,mn,Ft,k,Qt)}var Zp=null,z_=null;function Ed(f){return f.nodeType===9?f:f.ownerDocument}function Fy(f){switch(f){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function B_(f,g){if(f===0)switch(g){case"svg":return 1;case"math":return 2;default:return 0}return f===1&&g==="foreignObject"?0:f}function l0(f,g){return f==="textarea"||f==="noscript"||typeof g.children=="string"||typeof g.children=="number"||typeof g.children=="bigint"||typeof g.dangerouslySetInnerHTML=="object"&&g.dangerouslySetInnerHTML!==null&&g.dangerouslySetInnerHTML.__html!=null}var N_=null;function a3(){var f=window.event;return f&&f.type==="popstate"?f===N_?!1:(N_=f,!0):(N_=null,!1)}var jy=typeof setTimeout=="function"?setTimeout:void 0,W2=typeof clearTimeout=="function"?clearTimeout:void 0,Uy=typeof Promise=="function"?Promise:void 0,X2=typeof queueMicrotask=="function"?queueMicrotask:typeof Uy<"u"?function(f){return Uy.resolve(null).then(f).catch(Vy)}:jy;function Vy(f){setTimeout(function(){throw f})}function F_(f,g){var T=g,k=0;do{var V=T.nextSibling;if(f.removeChild(T),V&&V.nodeType===8)if(T=V.data,T==="/$"){if(k===0){f.removeChild(V),y0(g);return}k--}else T!=="$"&&T!=="$?"&&T!=="$!"||k++;T=V}while(T);y0(g)}function c0(f){var g=f.firstChild;for(g&&g.nodeType===10&&(g=g.nextSibling);g;){var T=g;switch(g=g.nextSibling,T.nodeName){case"HTML":case"HEAD":case"BODY":c0(T),lt(T);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(T.rel.toLowerCase()==="stylesheet")continue}f.removeChild(T)}}function o3(f,g,T,k){for(;f.nodeType===1;){var V=T;if(f.nodeName.toLowerCase()!==g.toLowerCase()){if(!k&&(f.nodeName!=="INPUT"||f.type!=="hidden"))break}else if(k){if(!f[ct])switch(g){case"meta":if(!f.hasAttribute("itemprop"))break;return f;case"link":if(Q=f.getAttribute("rel"),Q==="stylesheet"&&f.hasAttribute("data-precedence"))break;if(Q!==V.rel||f.getAttribute("href")!==(V.href==null?null:V.href)||f.getAttribute("crossorigin")!==(V.crossOrigin==null?null:V.crossOrigin)||f.getAttribute("title")!==(V.title==null?null:V.title))break;return f;case"style":if(f.hasAttribute("data-precedence"))break;return f;case"script":if(Q=f.getAttribute("src"),(Q!==(V.src==null?null:V.src)||f.getAttribute("type")!==(V.type==null?null:V.type)||f.getAttribute("crossorigin")!==(V.crossOrigin==null?null:V.crossOrigin))&&Q&&f.hasAttribute("async")&&!f.hasAttribute("itemprop"))break;return f;default:return f}}else if(g==="input"&&f.type==="hidden"){var Q=V.name==null?null:""+V.name;if(V.type==="hidden"&&f.getAttribute("name")===Q)return f}else return f;if(f=Kl(f.nextSibling),f===null)break}return null}function s3(f,g,T){if(g==="")return null;for(;f.nodeType!==3;)if((f.nodeType!==1||f.nodeName!=="INPUT"||f.type!=="hidden")&&!T||(f=Kl(f.nextSibling),f===null))return null;return f}function Kl(f){for(;f!=null;f=f.nextSibling){var g=f.nodeType;if(g===1||g===3)break;if(g===8){if(g=f.data,g==="$"||g==="$!"||g==="$?"||g==="F!"||g==="F")break;if(g==="/$")return null}}return f}function Y2(f){f=f.previousSibling;for(var g=0;f;){if(f.nodeType===8){var T=f.data;if(T==="$"||T==="$!"||T==="$?"){if(g===0)return f;g--}else T==="/$"&&g++}f=f.previousSibling}return null}function $y(f,g,T){switch(g=Ed(T),f){case"html":if(f=g.documentElement,!f)throw Error(o(452));return f;case"head":if(f=g.head,!f)throw Error(o(453));return f;case"body":if(f=g.body,!f)throw Error(o(454));return f;default:throw Error(o(451))}}var Ka=new Map,Wp=new Set;function Qh(f){return typeof f.getRootNode=="function"?f.getRootNode():f.ownerDocument}var gl=xn.d;xn.d={f:u0,r:K2,D:J2,C:l3,L:c3,m:Q2,X:ex,S:j_,M:u3};function u0(){var f=gl.f(),g=t0();return f||g}function K2(f){var g=Ct(f);g!==null&&g.tag===5&&g.type==="form"?Uh(g):gl.r(f)}var Ad=typeof document>"u"?null:document;function qy(f,g,T){var k=Ad;if(k&&typeof g=="string"&&g){var V=So(g);V='link[rel="'+f+'"][href="'+V+'"]',typeof T=="string"&&(V+='[crossorigin="'+T+'"]'),Wp.has(V)||(Wp.add(V),f={rel:f,crossOrigin:T,href:g},k.querySelector(V)===null&&(g=k.createElement("link"),ao(g,"link",f),gn(g),k.head.appendChild(g)))}}function J2(f){gl.D(f),qy("dns-prefetch",f,null)}function l3(f,g){gl.C(f,g),qy("preconnect",f,g)}function c3(f,g,T){gl.L(f,g,T);var k=Ad;if(k&&f&&g){var V='link[rel="preload"][as="'+So(g)+'"]';g==="image"&&T&&T.imageSrcSet?(V+='[imagesrcset="'+So(T.imageSrcSet)+'"]',typeof T.imageSizes=="string"&&(V+='[imagesizes="'+So(T.imageSizes)+'"]')):V+='[href="'+So(f)+'"]';var Q=V;switch(g){case"style":Q=ef(f);break;case"script":Q=Cd(f)}Ka.has(Q)||(f=ye({rel:"preload",href:g==="image"&&T&&T.imageSrcSet?void 0:f,as:g},T),Ka.set(Q,f),k.querySelector(V)!==null||g==="style"&&k.querySelector(Xp(Q))||g==="script"&&k.querySelector(Yp(Q))||(g=k.createElement("link"),ao(g,"link",f),gn(g),k.head.appendChild(g)))}}function Q2(f,g){gl.m(f,g);var T=Ad;if(T&&f){var k=g&&typeof g.as=="string"?g.as:"script",V='link[rel="modulepreload"][as="'+So(k)+'"][href="'+So(f)+'"]',Q=V;switch(k){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":Q=Cd(f)}if(!Ka.has(Q)&&(f=ye({rel:"modulepreload",href:f},g),Ka.set(Q,f),T.querySelector(V)===null)){switch(k){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(T.querySelector(Yp(Q)))return}k=T.createElement("link"),ao(k,"link",f),gn(k),T.head.appendChild(k)}}}function j_(f,g,T){gl.S(f,g,T);var k=Ad;if(k&&f){var V=Xt(k).hoistableStyles,Q=ef(f);g=g||"default";var be=V.get(Q);if(!be){var Be={loading:0,preload:null};if(be=k.querySelector(Xp(Q)))Be.loading=5;else{f=ye({rel:"stylesheet",href:f,"data-precedence":g},T),(T=Ka.get(Q))&&U_(f,T);var rt=be=k.createElement("link");gn(rt),ao(rt,"link",f),rt._p=new Promise(function(Tt,en){rt.onload=Tt,rt.onerror=en}),rt.addEventListener("load",function(){Be.loading|=1}),rt.addEventListener("error",function(){Be.loading|=2}),Be.loading|=4,h0(be,g,k)}be={type:"stylesheet",instance:be,count:1,state:Be},V.set(Q,be)}}}function ex(f,g){gl.X(f,g);var T=Ad;if(T&&f){var k=Xt(T).hoistableScripts,V=Cd(f),Q=k.get(V);Q||(Q=T.querySelector(Yp(V)),Q||(f=ye({src:f,async:!0},g),(g=Ka.get(V))&&Md(f,g),Q=T.createElement("script"),gn(Q),ao(Q,"link",f),T.head.appendChild(Q)),Q={type:"script",instance:Q,count:1,state:null},k.set(V,Q))}}function u3(f,g){gl.M(f,g);var T=Ad;if(T&&f){var k=Xt(T).hoistableScripts,V=Cd(f),Q=k.get(V);Q||(Q=T.querySelector(Yp(V)),Q||(f=ye({src:f,async:!0,type:"module"},g),(g=Ka.get(V))&&Md(f,g),Q=T.createElement("script"),gn(Q),ao(Q,"link",f),T.head.appendChild(Q)),Q={type:"script",instance:Q,count:1,state:null},k.set(V,Q))}}function Gy(f,g,T,k){var V=(V=Dr.current)?Qh(V):null;if(!V)throw Error(o(446));switch(f){case"meta":case"title":return null;case"style":return typeof T.precedence=="string"&&typeof T.href=="string"?(g=ef(T.href),T=Xt(V).hoistableStyles,k=T.get(g),k||(k={type:"style",instance:null,count:0,state:null},T.set(g,k)),k):{type:"void",instance:null,count:0,state:null};case"link":if(T.rel==="stylesheet"&&typeof T.href=="string"&&typeof T.precedence=="string"){f=ef(T.href);var Q=Xt(V).hoistableStyles,be=Q.get(f);if(be||(V=V.ownerDocument||V,be={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},Q.set(f,be),(Q=V.querySelector(Xp(f)))&&!Q._p&&(be.instance=Q,be.state.loading=5),Ka.has(f)||(T={rel:"preload",as:"style",href:T.href,crossOrigin:T.crossOrigin,integrity:T.integrity,media:T.media,hrefLang:T.hrefLang,referrerPolicy:T.referrerPolicy},Ka.set(f,T),Q||tx(V,f,T,be.state))),g&&k===null)throw Error(o(528,""));return be}if(g&&k!==null)throw Error(o(529,""));return null;case"script":return g=T.async,T=T.src,typeof T=="string"&&g&&typeof g!="function"&&typeof g!="symbol"?(g=Cd(T),T=Xt(V).hoistableScripts,k=T.get(g),k||(k={type:"script",instance:null,count:0,state:null},T.set(g,k)),k):{type:"void",instance:null,count:0,state:null};default:throw Error(o(444,f))}}function ef(f){return'href="'+So(f)+'"'}function Xp(f){return'link[rel="stylesheet"]['+f+"]"}function Hy(f){return ye({},f,{"data-precedence":f.precedence,precedence:null})}function tx(f,g,T,k){f.querySelector('link[rel="preload"][as="style"]['+g+"]")?k.loading=1:(g=f.createElement("link"),k.preload=g,g.addEventListener("load",function(){return k.loading|=1}),g.addEventListener("error",function(){return k.loading|=2}),ao(g,"link",T),gn(g),f.head.appendChild(g))}function Cd(f){return'[src="'+So(f)+'"]'}function Yp(f){return"script[async]"+f}function nx(f,g,T){if(g.count++,g.instance===null)switch(g.type){case"style":var k=f.querySelector('style[data-href~="'+So(T.href)+'"]');if(k)return g.instance=k,gn(k),k;var V=ye({},T,{"data-href":T.href,"data-precedence":T.precedence,href:null,precedence:null});return k=(f.ownerDocument||f).createElement("style"),gn(k),ao(k,"style",V),h0(k,T.precedence,f),g.instance=k;case"stylesheet":V=ef(T.href);var Q=f.querySelector(Xp(V));if(Q)return g.state.loading|=4,g.instance=Q,gn(Q),Q;k=Hy(T),(V=Ka.get(V))&&U_(k,V),Q=(f.ownerDocument||f).createElement("link"),gn(Q);var be=Q;return be._p=new Promise(function(Be,rt){be.onload=Be,be.onerror=rt}),ao(Q,"link",k),g.state.loading|=4,h0(Q,T.precedence,f),g.instance=Q;case"script":return Q=Cd(T.src),(V=f.querySelector(Yp(Q)))?(g.instance=V,gn(V),V):(k=T,(V=Ka.get(Q))&&(k=ye({},T),Md(k,V)),f=f.ownerDocument||f,V=f.createElement("script"),gn(V),ao(V,"link",k),f.head.appendChild(V),g.instance=V);case"void":return null;default:throw Error(o(443,g.type))}else g.type==="stylesheet"&&!(g.state.loading&4)&&(k=g.instance,g.state.loading|=4,h0(k,T.precedence,f));return g.instance}function h0(f,g,T){for(var k=T.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),V=k.length?k[k.length-1]:null,Q=V,be=0;be<k.length;be++){var Be=k[be];if(Be.dataset.precedence===g)Q=Be;else if(Q!==V)break}Q?Q.parentNode.insertBefore(f,Q.nextSibling):(g=T.nodeType===9?T.head:T,g.insertBefore(f,g.firstChild))}function U_(f,g){f.crossOrigin==null&&(f.crossOrigin=g.crossOrigin),f.referrerPolicy==null&&(f.referrerPolicy=g.referrerPolicy),f.title==null&&(f.title=g.title)}function Md(f,g){f.crossOrigin==null&&(f.crossOrigin=g.crossOrigin),f.referrerPolicy==null&&(f.referrerPolicy=g.referrerPolicy),f.integrity==null&&(f.integrity=g.integrity)}var f0=null;function Zy(f,g,T){if(f0===null){var k=new Map,V=f0=new Map;V.set(T,k)}else V=f0,k=V.get(T),k||(k=new Map,V.set(T,k));if(k.has(f))return k;for(k.set(f,null),T=T.getElementsByTagName(f),V=0;V<T.length;V++){var Q=T[V];if(!(Q[ct]||Q[pe]||f==="link"&&Q.getAttribute("rel")==="stylesheet")&&Q.namespaceURI!=="http://www.w3.org/2000/svg"){var be=Q.getAttribute(g)||"";be=f+be;var Be=k.get(be);Be?Be.push(Q):k.set(be,[Q])}}return k}function rx(f,g,T){f=f.ownerDocument||f,f.head.insertBefore(T,g==="title"?f.querySelector("head > title"):null)}function h3(f,g,T){if(T===1||g.itemProp!=null)return!1;switch(f){case"meta":case"title":return!0;case"style":if(typeof g.precedence!="string"||typeof g.href!="string"||g.href==="")break;return!0;case"link":if(typeof g.rel!="string"||typeof g.href!="string"||g.href===""||g.onLoad||g.onError)break;switch(g.rel){case"stylesheet":return f=g.disabled,typeof g.precedence=="string"&&f==null;default:return!0}case"script":if(g.async&&typeof g.async!="function"&&typeof g.async!="symbol"&&!g.onLoad&&!g.onError&&g.src&&typeof g.src=="string")return!0}return!1}function ix(f){return!(f.type==="stylesheet"&&!(f.state.loading&3))}var d0=null;function f3(){}function d3(f,g,T){if(d0===null)throw Error(o(475));var k=d0;if(g.type==="stylesheet"&&(typeof T.media!="string"||matchMedia(T.media).matches!==!1)&&!(g.state.loading&4)){if(g.instance===null){var V=ef(T.href),Q=f.querySelector(Xp(V));if(Q){f=Q._p,f!==null&&typeof f=="object"&&typeof f.then=="function"&&(k.count++,k=p0.bind(k),f.then(k,k)),g.state.loading|=4,g.instance=Q,gn(Q);return}Q=f.ownerDocument||f,T=Hy(T),(V=Ka.get(V))&&U_(T,V),Q=Q.createElement("link"),gn(Q);var be=Q;be._p=new Promise(function(Be,rt){be.onload=Be,be.onerror=rt}),ao(Q,"link",T),g.instance=Q}k.stylesheets===null&&(k.stylesheets=new Map),k.stylesheets.set(g,f),(f=g.state.preload)&&!(g.state.loading&3)&&(k.count++,g=p0.bind(k),f.addEventListener("load",g),f.addEventListener("error",g))}}function p3(){if(d0===null)throw Error(o(475));var f=d0;return f.stylesheets&&f.count===0&&Wy(f,f.stylesheets),0<f.count?function(g){var T=setTimeout(function(){if(f.stylesheets&&Wy(f,f.stylesheets),f.unsuspend){var k=f.unsuspend;f.unsuspend=null,k()}},6e4);return f.unsuspend=g,function(){f.unsuspend=null,clearTimeout(T)}}:null}function p0(){if(this.count--,this.count===0){if(this.stylesheets)Wy(this,this.stylesheets);else if(this.unsuspend){var f=this.unsuspend;this.unsuspend=null,f()}}}var V_=null;function Wy(f,g){f.stylesheets=null,f.unsuspend!==null&&(f.count++,V_=new Map,g.forEach(m3,f),V_=null,p0.call(f))}function m3(f,g){if(!(g.state.loading&4)){var T=V_.get(f);if(T)var k=T.get(null);else{T=new Map,V_.set(f,T);for(var V=f.querySelectorAll("link[data-precedence],style[data-precedence]"),Q=0;Q<V.length;Q++){var be=V[Q];(be.nodeName==="LINK"||be.getAttribute("media")!=="not all")&&(T.set(be.dataset.precedence,be),k=be)}k&&T.set(null,k)}V=g.instance,be=V.getAttribute("data-precedence"),Q=T.get(be)||k,Q===k&&T.set(null,V),T.set(be,V),this.count++,k=p0.bind(this),V.addEventListener("load",k),V.addEventListener("error",k),Q?Q.parentNode.insertBefore(V,Q.nextSibling):(f=f.nodeType===9?f.head:f,f.insertBefore(V,f.firstChild)),g.state.loading|=4}}var Od={$$typeof:X,Provider:null,Consumer:null,_currentValue:rr,_currentValue2:rr,_threadCount:0};function Xy(f,g,T,k,V,Q,be,Be){this.tag=1,this.containerInfo=f,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=dh(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.finishedLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=dh(0),this.hiddenUpdates=dh(null),this.identifierPrefix=k,this.onUncaughtError=V,this.onCaughtError=Q,this.onRecoverableError=be,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Be,this.incompleteTransitions=new Map}function Yy(f,g,T,k,V,Q,be,Be,rt,Tt,en,mn){return f=new Xy(f,g,T,be,Be,rt,Tt,mn),g=1,Q===!0&&(g|=24),Q=St(3,null,null,g),f.current=Q,Q.stateNode=f,g=Rh(),g.refCount++,f.pooledCache=g,g.refCount++,Q.memoizedState={element:k,isDehydrated:T,cache:g},Up(Q),f}function Ky(f){return f?(f=Tu,f):Tu}function Jy(f,g,T,k,V,Q){V=Ky(V),k.context===null?k.context=V:k.pendingContext=V,k=Xo(g),k.payload={element:T},Q=Q===void 0?null:Q,Q!==null&&(k.callback=Q),T=Wl(f,k,g),T!==null&&(Qo(T,f,g),Wh(T,f,g))}function Qy(f,g){if(f=f.memoizedState,f!==null&&f.dehydrated!==null){var T=f.retryLane;f.retryLane=T!==0&&T<g?T:g}}function $_(f,g){Qy(f,g),(f=f.alternate)&&Qy(f,g)}function ev(f){if(f.tag===13){var g=$o(f,67108864);g!==null&&Qo(g,f,67108864),$_(f,67108864)}}var m0=!0;function ax(f,g,T,k){var V=He.T;He.T=null;var Q=xn.p;try{xn.p=2,q_(f,g,T,k)}finally{xn.p=Q,He.T=V}}function tv(f,g,T,k){var V=He.T;He.T=null;var Q=xn.p;try{xn.p=8,q_(f,g,T,k)}finally{xn.p=Q,He.T=V}}function q_(f,g,T,k){if(m0){var V=nv(k);if(V===null)k_(f,g,k,tf,T),Ua(f,k);else if(iv(V,f,g,T,k))k.stopPropagation();else if(Ua(f,k),g&4&&-1<_3.indexOf(f)){for(;V!==null;){var Q=Ct(V);if(Q!==null)switch(Q.tag){case 3:if(Q=Q.stateNode,Q.current.memoizedState.isDehydrated){var be=os(Q.pendingLanes);if(be!==0){var Be=Q;for(Be.pendingLanes|=2,Be.entangledLanes|=2;be;){var rt=1<<31-pa(be);Be.entanglements[1]|=rt,be&=~rt}Ys(Q),!(sn&6)&&(ja=Bn()+500,i0(0))}}break;case 13:Be=$o(Q,2),Be!==null&&Qo(Be,Q,2),t0(),$_(Q,2)}if(Q=nv(k),Q===null&&k_(f,g,k,tf,T),Q===V)break;V=Q}V!==null&&k.stopPropagation()}else k_(f,g,k,null,T)}}function nv(f){return f=Mn(f),G_(f)}var tf=null;function G_(f){if(tf=null,f=ut(f),f!==null){var g=Ht(f);if(g===null)f=null;else{var T=g.tag;if(T===13){if(f=Bt(g),f!==null)return f;f=null}else if(T===3){if(g.stateNode.current.memoizedState.isDehydrated)return g.tag===3?g.stateNode.containerInfo:null;f=null}else g!==f&&(f=null)}}return tf=f,null}function ox(f){switch(f){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(jo()){case is:return 2;case Tl:return 8;case fa:case El:return 32;case hc:return 268435456;default:return 32}default:return 32}}var rv=!1,nf=null,rf=null,af=null,_0=new Map,g0=new Map,Hu=[],_3="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Ua(f,g){switch(f){case"focusin":case"focusout":nf=null;break;case"dragenter":case"dragleave":rf=null;break;case"mouseover":case"mouseout":af=null;break;case"pointerover":case"pointerout":_0.delete(g.pointerId);break;case"gotpointercapture":case"lostpointercapture":g0.delete(g.pointerId)}}function es(f,g,T,k,V,Q){return f===null||f.nativeEvent!==Q?(f={blockedOn:g,domEventName:T,eventSystemFlags:k,nativeEvent:Q,targetContainers:[V]},g!==null&&(g=Ct(g),g!==null&&ev(g)),f):(f.eventSystemFlags|=k,g=f.targetContainers,V!==null&&g.indexOf(V)===-1&&g.push(V),f)}function iv(f,g,T,k,V){switch(g){case"focusin":return nf=es(nf,f,g,T,k,V),!0;case"dragenter":return rf=es(rf,f,g,T,k,V),!0;case"mouseover":return af=es(af,f,g,T,k,V),!0;case"pointerover":var Q=V.pointerId;return _0.set(Q,es(_0.get(Q)||null,f,g,T,k,V)),!0;case"gotpointercapture":return Q=V.pointerId,g0.set(Q,es(g0.get(Q)||null,f,g,T,k,V)),!0}return!1}function H_(f){var g=ut(f.target);if(g!==null){var T=Ht(g);if(T!==null){if(g=T.tag,g===13){if(g=Bt(T),g!==null){f.blockedOn=g,ft(f.priority,function(){if(T.tag===13){var k=Es(),V=$o(T,k);V!==null&&Qo(V,T,k),$_(T,k)}});return}}else if(g===3&&T.stateNode.current.memoizedState.isDehydrated){f.blockedOn=T.tag===3?T.stateNode.containerInfo:null;return}}}f.blockedOn=null}function Pd(f){if(f.blockedOn!==null)return!1;for(var g=f.targetContainers;0<g.length;){var T=nv(f.nativeEvent);if(T===null){T=f.nativeEvent;var k=new T.constructor(T.type,T);Df=k,T.target.dispatchEvent(k),Df=null}else return g=Ct(T),g!==null&&ev(g),f.blockedOn=T,!1;g.shift()}return!0}function Id(f,g,T){Pd(f)&&T.delete(g)}function g3(){rv=!1,nf!==null&&Pd(nf)&&(nf=null),rf!==null&&Pd(rf)&&(rf=null),af!==null&&Pd(af)&&(af=null),_0.forEach(Id),g0.forEach(Id)}function Z_(f,g){f.blockedOn===g&&(f.blockedOn=null,rv||(rv=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,g3)))}var of=null;function sx(f){of!==f&&(of=f,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){of===f&&(of=null);for(var g=0;g<f.length;g+=3){var T=f[g],k=f[g+1],V=f[g+2];if(typeof k!="function"){if(G_(k||T)===null)continue;break}var Q=Ct(T);Q!==null&&(f.splice(g,3),g-=3,Sa(Q,{pending:!0,data:V,method:T.method,action:k},k,V))}}))}function y0(f){function g(rt){return Z_(rt,f)}nf!==null&&Z_(nf,f),rf!==null&&Z_(rf,f),af!==null&&Z_(af,f),_0.forEach(g),g0.forEach(g);for(var T=0;T<Hu.length;T++){var k=Hu[T];k.blockedOn===f&&(k.blockedOn=null)}for(;0<Hu.length&&(T=Hu[0],T.blockedOn===null);)H_(T),T.blockedOn===null&&Hu.shift();if(T=(f.ownerDocument||f).$$reactFormReplay,T!=null)for(k=0;k<T.length;k+=3){var V=T[k],Q=T[k+1],be=V[Se]||null;if(typeof Q=="function")be||sx(T);else if(be){var Be=null;if(Q&&Q.hasAttribute("formAction")){if(V=Q,be=Q[Se]||null)Be=be.formAction;else if(G_(V)!==null)continue}else Be=be.action;typeof Be=="function"?T[k+1]=Be:(T.splice(k,3),k-=3),sx(T)}}}function W_(f){this._internalRoot=f}Kp.prototype.render=W_.prototype.render=function(f){var g=this._internalRoot;if(g===null)throw Error(o(409));var T=g.current,k=Es();Jy(T,k,f,g,null,null)},Kp.prototype.unmount=W_.prototype.unmount=function(){var f=this._internalRoot;if(f!==null){this._internalRoot=null;var g=f.containerInfo;f.tag===0&&qp(),Jy(f.current,2,null,f,null,null),t0(),g[Le]=null}};function Kp(f){this._internalRoot=f}Kp.prototype.unstable_scheduleHydration=function(f){if(f){var g=Ds();f={blockedOn:null,target:f,priority:g};for(var T=0;T<Hu.length&&g!==0&&g<Hu[T].priority;T++);Hu.splice(T,0,f),T===0&&H_(f)}};var av=t.version;if(av!=="19.0.0")throw Error(o(527,av,"19.0.0"));xn.findDOMNode=function(f){var g=f._reactInternals;if(g===void 0)throw typeof f.render=="function"?Error(o(188)):(f=Object.keys(f).join(","),Error(o(268,f)));return f=$t(g),f=f!==null?rn(f):null,f=f===null?null:f.stateNode,f};var ov={bundleType:0,version:"19.0.0",rendererPackageName:"react-dom",currentDispatcherRef:He,findFiberByHostInstance:ut,reconcilerVersion:"19.0.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var X_=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!X_.isDisabled&&X_.supportsFiber)try{da=X_.inject(ov),Ia=X_}catch{}}return Pv.createRoot=function(f,g){if(!h(f))throw Error(o(299));var T=!1,k="",V=qh,Q=Lp,be=ud,Be=null;return g!=null&&(g.unstable_strictMode===!0&&(T=!0),g.identifierPrefix!==void 0&&(k=g.identifierPrefix),g.onUncaughtError!==void 0&&(V=g.onUncaughtError),g.onCaughtError!==void 0&&(Q=g.onCaughtError),g.onRecoverableError!==void 0&&(be=g.onRecoverableError),g.unstable_transitionCallbacks!==void 0&&(Be=g.unstable_transitionCallbacks)),g=Yy(f,1,!1,null,null,T,k,V,Q,be,Be,null),f[Le]=g.current,D_(f.nodeType===8?f.parentNode:f),new W_(g)},Pv.hydrateRoot=function(f,g,T){if(!h(f))throw Error(o(299));var k=!1,V="",Q=qh,be=Lp,Be=ud,rt=null,Tt=null;return T!=null&&(T.unstable_strictMode===!0&&(k=!0),T.identifierPrefix!==void 0&&(V=T.identifierPrefix),T.onUncaughtError!==void 0&&(Q=T.onUncaughtError),T.onCaughtError!==void 0&&(be=T.onCaughtError),T.onRecoverableError!==void 0&&(Be=T.onRecoverableError),T.unstable_transitionCallbacks!==void 0&&(rt=T.unstable_transitionCallbacks),T.formState!==void 0&&(Tt=T.formState)),g=Yy(f,1,!0,g,T??null,k,V,Q,be,Be,rt,Tt),g.context=Ky(null),T=g.current,k=Es(),V=Xo(k),V.callback=null,Wl(T,V,k),g.current.lanes=k,vi(g,k),Ys(g),f[Le]=g.current,D_(f),new Kp(g)},Pv.version="19.0.0",Pv}var y6;function TH(){if(y6)return hT.exports;y6=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),hT.exports=SH(),hT.exports}var EH=TH(),Iv={},v6;function AH(){if(v6)return Iv;v6=1,Object.defineProperty(Iv,"__esModule",{value:!0}),Iv.parse=b,Iv.serialize=I;const e=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,t=/^[\u0021-\u003A\u003C-\u007E]*$/,a=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,o=/^[\u0020-\u003A\u003D-\u007E]*$/,h=Object.prototype.toString,y=(()=>{const G=function(){};return G.prototype=Object.create(null),G})();function b(G,X){const Y=new y,J=G.length;if(J<2)return Y;const ee=(X==null?void 0:X.decode)||j;let oe=0;do{const ge=G.indexOf("=",oe);if(ge===-1)break;const fe=G.indexOf(";",oe),xe=fe===-1?J:fe;if(ge>xe){oe=G.lastIndexOf(";",ge-1)+1;continue}const ae=i(G,oe,ge),me=C(G,ge,ae),we=G.slice(ae,me);if(Y[we]===void 0){let Ge=i(G,ge+1,xe),He=C(G,xe,Ge);const ye=ee(G.slice(Ge,He));Y[we]=ye}oe=xe+1}while(oe<J);return Y}function i(G,X,Y){do{const J=G.charCodeAt(X);if(J!==32&&J!==9)return X}while(++X<Y);return Y}function C(G,X,Y){for(;X>Y;){const J=G.charCodeAt(--X);if(J!==32&&J!==9)return X+1}return Y}function I(G,X,Y){const J=(Y==null?void 0:Y.encode)||encodeURIComponent;if(!e.test(G))throw new TypeError(`argument name is invalid: ${G}`);const ee=J(X);if(!t.test(ee))throw new TypeError(`argument val is invalid: ${X}`);let oe=G+"="+ee;if(!Y)return oe;if(Y.maxAge!==void 0){if(!Number.isInteger(Y.maxAge))throw new TypeError(`option maxAge is invalid: ${Y.maxAge}`);oe+="; Max-Age="+Y.maxAge}if(Y.domain){if(!a.test(Y.domain))throw new TypeError(`option domain is invalid: ${Y.domain}`);oe+="; Domain="+Y.domain}if(Y.path){if(!o.test(Y.path))throw new TypeError(`option path is invalid: ${Y.path}`);oe+="; Path="+Y.path}if(Y.expires){if(!F(Y.expires)||!Number.isFinite(Y.expires.valueOf()))throw new TypeError(`option expires is invalid: ${Y.expires}`);oe+="; Expires="+Y.expires.toUTCString()}if(Y.httpOnly&&(oe+="; HttpOnly"),Y.secure&&(oe+="; Secure"),Y.partitioned&&(oe+="; Partitioned"),Y.priority)switch(typeof Y.priority=="string"?Y.priority.toLowerCase():void 0){case"low":oe+="; Priority=Low";break;case"medium":oe+="; Priority=Medium";break;case"high":oe+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${Y.priority}`)}if(Y.sameSite)switch(typeof Y.sameSite=="string"?Y.sameSite.toLowerCase():Y.sameSite){case!0:case"strict":oe+="; SameSite=Strict";break;case"lax":oe+="; SameSite=Lax";break;case"none":oe+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${Y.sameSite}`)}return oe}function j(G){if(G.indexOf("%")===-1)return G;try{return decodeURIComponent(G)}catch{return G}}function F(G){return h.call(G)==="[object Date]"}return Iv}AH();/**
 * react-router v7.1.5
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var x6="popstate";function CH(e={}){function t(h,y){let{pathname:b="/",search:i="",hash:C=""}=W0(h.location.hash.substring(1));return!b.startsWith("/")&&!b.startsWith(".")&&(b="/"+b),e5("",{pathname:b,search:i,hash:C},y.state&&y.state.usr||null,y.state&&y.state.key||"default")}function a(h,y){let b=h.document.querySelector("base"),i="";if(b&&b.getAttribute("href")){let C=h.location.href,I=C.indexOf("#");i=I===-1?C:C.slice(0,I)}return i+"#"+(typeof y=="string"?y:w1(y))}function o(h,y){uu(h.pathname.charAt(0)==="/",`relative pathnames are not supported in hash history.push(${JSON.stringify(y)})`)}return OH(t,a,o,e)}function Oa(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function uu(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function MH(){return Math.random().toString(36).substring(2,10)}function b6(e,t){return{usr:e.state,key:e.key,idx:t}}function e5(e,t,a=null,o){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof t=="string"?W0(t):t,state:a,key:t&&t.key||o||MH()}}function w1({pathname:e="/",search:t="",hash:a=""}){return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),a&&a!=="#"&&(e+=a.charAt(0)==="#"?a:"#"+a),e}function W0(e){let t={};if(e){let a=e.indexOf("#");a>=0&&(t.hash=e.substring(a),e=e.substring(0,a));let o=e.indexOf("?");o>=0&&(t.search=e.substring(o),e=e.substring(0,o)),e&&(t.pathname=e)}return t}function OH(e,t,a,o={}){let{window:h=document.defaultView,v5Compat:y=!1}=o,b=h.history,i="POP",C=null,I=j();I==null&&(I=0,b.replaceState({...b.state,idx:I},""));function j(){return(b.state||{idx:null}).idx}function F(){i="POP";let ee=j(),oe=ee==null?null:ee-I;I=ee,C&&C({action:i,location:J.location,delta:oe})}function G(ee,oe){i="PUSH";let ge=e5(J.location,ee,oe);a&&a(ge,ee),I=j()+1;let fe=b6(ge,I),xe=J.createHref(ge);try{b.pushState(fe,"",xe)}catch(ae){if(ae instanceof DOMException&&ae.name==="DataCloneError")throw ae;h.location.assign(xe)}y&&C&&C({action:i,location:J.location,delta:1})}function X(ee,oe){i="REPLACE";let ge=e5(J.location,ee,oe);a&&a(ge,ee),I=j();let fe=b6(ge,I),xe=J.createHref(ge);b.replaceState(fe,"",xe),y&&C&&C({action:i,location:J.location,delta:0})}function Y(ee){let oe=h.location.origin!=="null"?h.location.origin:h.location.href,ge=typeof ee=="string"?ee:w1(ee);return ge=ge.replace(/ $/,"%20"),Oa(oe,`No window.location.(origin|href) available to create URL for href: ${ge}`),new URL(ge,oe)}let J={get action(){return i},get location(){return e(h,b)},listen(ee){if(C)throw new Error("A history only accepts one active listener");return h.addEventListener(x6,F),C=ee,()=>{h.removeEventListener(x6,F),C=null}},createHref(ee){return t(h,ee)},createURL:Y,encodeLocation(ee){let oe=Y(ee);return{pathname:oe.pathname,search:oe.search,hash:oe.hash}},push:G,replace:X,go(ee){return b.go(ee)}};return J}function dN(e,t,a="/"){return PH(e,t,a,!1)}function PH(e,t,a,o){let h=typeof t=="string"?W0(t):t,y=fm(h.pathname||"/",a);if(y==null)return null;let b=pN(e);IH(b);let i=null;for(let C=0;i==null&&C<b.length;++C){let I=VH(y);i=jH(b[C],I,o)}return i}function pN(e,t=[],a=[],o=""){let h=(y,b,i)=>{let C={relativePath:i===void 0?y.path||"":i,caseSensitive:y.caseSensitive===!0,childrenIndex:b,route:y};C.relativePath.startsWith("/")&&(Oa(C.relativePath.startsWith(o),`Absolute route path "${C.relativePath}" nested under path "${o}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),C.relativePath=C.relativePath.slice(o.length));let I=Ud([o,C.relativePath]),j=a.concat(C);y.children&&y.children.length>0&&(Oa(y.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${I}".`),pN(y.children,t,j,I)),!(y.path==null&&!y.index)&&t.push({path:I,score:NH(I,y.index),routesMeta:j})};return e.forEach((y,b)=>{var i;if(y.path===""||!((i=y.path)!=null&&i.includes("?")))h(y,b);else for(let C of mN(y.path))h(y,b,C)}),t}function mN(e){let t=e.split("/");if(t.length===0)return[];let[a,...o]=t,h=a.endsWith("?"),y=a.replace(/\?$/,"");if(o.length===0)return h?[y,""]:[y];let b=mN(o.join("/")),i=[];return i.push(...b.map(C=>C===""?y:[y,C].join("/"))),h&&i.push(...b),i.map(C=>e.startsWith("/")&&C===""?"/":C)}function IH(e){e.sort((t,a)=>t.score!==a.score?a.score-t.score:FH(t.routesMeta.map(o=>o.childrenIndex),a.routesMeta.map(o=>o.childrenIndex)))}var RH=/^:[\w-]+$/,DH=3,LH=2,kH=1,zH=10,BH=-2,w6=e=>e==="*";function NH(e,t){let a=e.split("/"),o=a.length;return a.some(w6)&&(o+=BH),t&&(o+=LH),a.filter(h=>!w6(h)).reduce((h,y)=>h+(RH.test(y)?DH:y===""?kH:zH),o)}function FH(e,t){return e.length===t.length&&e.slice(0,-1).every((o,h)=>o===t[h])?e[e.length-1]-t[t.length-1]:0}function jH(e,t,a=!1){let{routesMeta:o}=e,h={},y="/",b=[];for(let i=0;i<o.length;++i){let C=o[i],I=i===o.length-1,j=y==="/"?t:t.slice(y.length)||"/",F=Ib({path:C.relativePath,caseSensitive:C.caseSensitive,end:I},j),G=C.route;if(!F&&I&&a&&!o[o.length-1].route.index&&(F=Ib({path:C.relativePath,caseSensitive:C.caseSensitive,end:!1},j)),!F)return null;Object.assign(h,F.params),b.push({params:h,pathname:Ud([y,F.pathname]),pathnameBase:HH(Ud([y,F.pathnameBase])),route:G}),F.pathnameBase!=="/"&&(y=Ud([y,F.pathnameBase]))}return b}function Ib(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[a,o]=UH(e.path,e.caseSensitive,e.end),h=t.match(a);if(!h)return null;let y=h[0],b=y.replace(/(.)\/+$/,"$1"),i=h.slice(1);return{params:o.reduce((I,{paramName:j,isOptional:F},G)=>{if(j==="*"){let Y=i[G]||"";b=y.slice(0,y.length-Y.length).replace(/(.)\/+$/,"$1")}const X=i[G];return F&&!X?I[j]=void 0:I[j]=(X||"").replace(/%2F/g,"/"),I},{}),pathname:y,pathnameBase:b,pattern:e}}function UH(e,t=!1,a=!0){uu(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let o=[],h="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(b,i,C)=>(o.push({paramName:i,isOptional:C!=null}),C?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(o.push({paramName:"*"}),h+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):a?h+="\\/*$":e!==""&&e!=="/"&&(h+="(?:(?=\\/|$))"),[new RegExp(h,t?void 0:"i"),o]}function VH(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return uu(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function fm(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let a=t.endsWith("/")?t.length-1:t.length,o=e.charAt(a);return o&&o!=="/"?null:e.slice(a)||"/"}function $H(e,t="/"){let{pathname:a,search:o="",hash:h=""}=typeof e=="string"?W0(e):e;return{pathname:a?a.startsWith("/")?a:qH(a,t):t,search:ZH(o),hash:WH(h)}}function qH(e,t){let a=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(h=>{h===".."?a.length>1&&a.pop():h!=="."&&a.push(h)}),a.length>1?a.join("/"):"/"}function mT(e,t,a,o){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(o)}].  Please separate it out to the \`to.${a}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function GH(e){return e.filter((t,a)=>a===0||t.route.path&&t.route.path.length>0)}function _N(e){let t=GH(e);return t.map((a,o)=>o===t.length-1?a.pathname:a.pathnameBase)}function gN(e,t,a,o=!1){let h;typeof e=="string"?h=W0(e):(h={...e},Oa(!h.pathname||!h.pathname.includes("?"),mT("?","pathname","search",h)),Oa(!h.pathname||!h.pathname.includes("#"),mT("#","pathname","hash",h)),Oa(!h.search||!h.search.includes("#"),mT("#","search","hash",h)));let y=e===""||h.pathname==="",b=y?"/":h.pathname,i;if(b==null)i=a;else{let F=t.length-1;if(!o&&b.startsWith("..")){let G=b.split("/");for(;G[0]==="..";)G.shift(),F-=1;h.pathname=G.join("/")}i=F>=0?t[F]:"/"}let C=$H(h,i),I=b&&b!=="/"&&b.endsWith("/"),j=(y||b===".")&&a.endsWith("/");return!C.pathname.endsWith("/")&&(I||j)&&(C.pathname+="/"),C}var Ud=e=>e.join("/").replace(/\/\/+/g,"/"),HH=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),ZH=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,WH=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function XH(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}var yN=["POST","PUT","PATCH","DELETE"];new Set(yN);var YH=["GET",...yN];new Set(YH);var fy=Ie.createContext(null);fy.displayName="DataRouter";var Rw=Ie.createContext(null);Rw.displayName="DataRouterState";var vN=Ie.createContext({isTransitioning:!1});vN.displayName="ViewTransition";var KH=Ie.createContext(new Map);KH.displayName="Fetchers";var JH=Ie.createContext(null);JH.displayName="Await";var wf=Ie.createContext(null);wf.displayName="Navigation";var d2=Ie.createContext(null);d2.displayName="Location";var Sf=Ie.createContext({outlet:null,matches:[],isDataRoute:!1});Sf.displayName="Route";var K4=Ie.createContext(null);K4.displayName="RouteError";function QH(e,{relative:t}={}){Oa(p2(),"useHref() may be used only in the context of a <Router> component.");let{basename:a,navigator:o}=Ie.useContext(wf),{hash:h,pathname:y,search:b}=m2(e,{relative:t}),i=y;return a!=="/"&&(i=y==="/"?a:Ud([a,y])),o.createHref({pathname:i,search:b,hash:h})}function p2(){return Ie.useContext(d2)!=null}function Jd(){return Oa(p2(),"useLocation() may be used only in the context of a <Router> component."),Ie.useContext(d2).location}var xN="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function bN(e){Ie.useContext(wf).static||Ie.useLayoutEffect(e)}function zo(){let{isDataRoute:e}=Ie.useContext(Sf);return e?dZ():eZ()}function eZ(){Oa(p2(),"useNavigate() may be used only in the context of a <Router> component.");let e=Ie.useContext(fy),{basename:t,navigator:a}=Ie.useContext(wf),{matches:o}=Ie.useContext(Sf),{pathname:h}=Jd(),y=JSON.stringify(_N(o)),b=Ie.useRef(!1);return bN(()=>{b.current=!0}),Ie.useCallback((C,I={})=>{if(uu(b.current,xN),!b.current)return;if(typeof C=="number"){a.go(C);return}let j=gN(C,JSON.parse(y),h,I.relative==="path");e==null&&t!=="/"&&(j.pathname=j.pathname==="/"?t:Ud([t,j.pathname])),(I.replace?a.replace:a.push)(j,I.state,I)},[t,a,y,h,e])}Ie.createContext(null);function tZ(){let{matches:e}=Ie.useContext(Sf),t=e[e.length-1];return t?t.params:{}}function m2(e,{relative:t}={}){let{matches:a}=Ie.useContext(Sf),{pathname:o}=Jd(),h=JSON.stringify(_N(a));return Ie.useMemo(()=>gN(e,JSON.parse(h),o,t==="path"),[e,h,o,t])}function nZ(e,t){return wN(e,t)}function wN(e,t,a,o){var ge;Oa(p2(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:h,static:y}=Ie.useContext(wf),{matches:b}=Ie.useContext(Sf),i=b[b.length-1],C=i?i.params:{},I=i?i.pathname:"/",j=i?i.pathnameBase:"/",F=i&&i.route;{let fe=F&&F.path||"";SN(I,!F||fe.endsWith("*")||fe.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${I}" (under <Route path="${fe}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${fe}"> to <Route path="${fe==="/"?"*":`${fe}/*`}">.`)}let G=Jd(),X;if(t){let fe=typeof t=="string"?W0(t):t;Oa(j==="/"||((ge=fe.pathname)==null?void 0:ge.startsWith(j)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${j}" but pathname "${fe.pathname}" was given in the \`location\` prop.`),X=fe}else X=G;let Y=X.pathname||"/",J=Y;if(j!=="/"){let fe=j.replace(/^\//,"").split("/");J="/"+Y.replace(/^\//,"").split("/").slice(fe.length).join("/")}let ee=!y&&a&&a.matches&&a.matches.length>0?a.matches:dN(e,{pathname:J});uu(F||ee!=null,`No routes matched location "${X.pathname}${X.search}${X.hash}" `),uu(ee==null||ee[ee.length-1].route.element!==void 0||ee[ee.length-1].route.Component!==void 0||ee[ee.length-1].route.lazy!==void 0,`Matched leaf route at location "${X.pathname}${X.search}${X.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let oe=sZ(ee&&ee.map(fe=>Object.assign({},fe,{params:Object.assign({},C,fe.params),pathname:Ud([j,h.encodeLocation?h.encodeLocation(fe.pathname).pathname:fe.pathname]),pathnameBase:fe.pathnameBase==="/"?j:Ud([j,h.encodeLocation?h.encodeLocation(fe.pathnameBase).pathname:fe.pathnameBase])})),b,a,o);return t&&oe?Ie.createElement(d2.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...X},navigationType:"POP"}},oe):oe}function rZ(){let e=fZ(),t=XH(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),a=e instanceof Error?e.stack:null,o="rgba(200,200,200, 0.5)",h={padding:"0.5rem",backgroundColor:o},y={padding:"2px 4px",backgroundColor:o},b=null;return console.error("Error handled by React Router default ErrorBoundary:",e),b=Ie.createElement(Ie.Fragment,null,Ie.createElement("p",null," Hey developer "),Ie.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",Ie.createElement("code",{style:y},"ErrorBoundary")," or"," ",Ie.createElement("code",{style:y},"errorElement")," prop on your route.")),Ie.createElement(Ie.Fragment,null,Ie.createElement("h2",null,"Unexpected Application Error!"),Ie.createElement("h3",{style:{fontStyle:"italic"}},t),a?Ie.createElement("pre",{style:h},a):null,b)}var iZ=Ie.createElement(rZ,null),aZ=class extends Ie.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?Ie.createElement(Sf.Provider,{value:this.props.routeContext},Ie.createElement(K4.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function oZ({routeContext:e,match:t,children:a}){let o=Ie.useContext(fy);return o&&o.static&&o.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(o.staticContext._deepestRenderedBoundaryId=t.route.id),Ie.createElement(Sf.Provider,{value:e},a)}function sZ(e,t=[],a=null,o=null){if(e==null){if(!a)return null;if(a.errors)e=a.matches;else if(t.length===0&&!a.initialized&&a.matches.length>0)e=a.matches;else return null}let h=e,y=a==null?void 0:a.errors;if(y!=null){let C=h.findIndex(I=>I.route.id&&(y==null?void 0:y[I.route.id])!==void 0);Oa(C>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(y).join(",")}`),h=h.slice(0,Math.min(h.length,C+1))}let b=!1,i=-1;if(a)for(let C=0;C<h.length;C++){let I=h[C];if((I.route.HydrateFallback||I.route.hydrateFallbackElement)&&(i=C),I.route.id){let{loaderData:j,errors:F}=a,G=I.route.loader&&!j.hasOwnProperty(I.route.id)&&(!F||F[I.route.id]===void 0);if(I.route.lazy||G){b=!0,i>=0?h=h.slice(0,i+1):h=[h[0]];break}}}return h.reduceRight((C,I,j)=>{let F,G=!1,X=null,Y=null;a&&(F=y&&I.route.id?y[I.route.id]:void 0,X=I.route.errorElement||iZ,b&&(i<0&&j===0?(SN("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),G=!0,Y=null):i===j&&(G=!0,Y=I.route.hydrateFallbackElement||null)));let J=t.concat(h.slice(0,j+1)),ee=()=>{let oe;return F?oe=X:G?oe=Y:I.route.Component?oe=Ie.createElement(I.route.Component,null):I.route.element?oe=I.route.element:oe=C,Ie.createElement(oZ,{match:I,routeContext:{outlet:C,matches:J,isDataRoute:a!=null},children:oe})};return a&&(I.route.ErrorBoundary||I.route.errorElement||j===0)?Ie.createElement(aZ,{location:a.location,revalidation:a.revalidation,component:X,error:F,children:ee(),routeContext:{outlet:null,matches:J,isDataRoute:!0}}):ee()},null)}function J4(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function lZ(e){let t=Ie.useContext(fy);return Oa(t,J4(e)),t}function cZ(e){let t=Ie.useContext(Rw);return Oa(t,J4(e)),t}function uZ(e){let t=Ie.useContext(Sf);return Oa(t,J4(e)),t}function Q4(e){let t=uZ(e),a=t.matches[t.matches.length-1];return Oa(a.route.id,`${e} can only be used on routes that contain a unique "id"`),a.route.id}function hZ(){return Q4("useRouteId")}function fZ(){var o;let e=Ie.useContext(K4),t=cZ("useRouteError"),a=Q4("useRouteError");return e!==void 0?e:(o=t.errors)==null?void 0:o[a]}function dZ(){let{router:e}=lZ("useNavigate"),t=Q4("useNavigate"),a=Ie.useRef(!1);return bN(()=>{a.current=!0}),Ie.useCallback(async(h,y={})=>{uu(a.current,xN),a.current&&(typeof h=="number"?e.navigate(h):await e.navigate(h,{fromRouteId:t,...y}))},[e,t])}var S6={};function SN(e,t,a){!t&&!S6[e]&&(S6[e]=!0,uu(!1,a))}Ie.memo(pZ);function pZ({routes:e,future:t,state:a}){return wN(e,void 0,a,t)}function th(e){Oa(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function mZ({basename:e="/",children:t=null,location:a,navigationType:o="POP",navigator:h,static:y=!1}){Oa(!p2(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let b=e.replace(/^\/*/,"/"),i=Ie.useMemo(()=>({basename:b,navigator:h,static:y,future:{}}),[b,h,y]);typeof a=="string"&&(a=W0(a));let{pathname:C="/",search:I="",hash:j="",state:F=null,key:G="default"}=a,X=Ie.useMemo(()=>{let Y=fm(C,b);return Y==null?null:{location:{pathname:Y,search:I,hash:j,state:F,key:G},navigationType:o}},[b,C,I,j,F,G,o]);return uu(X!=null,`<Router basename="${b}"> is not able to match the URL "${C}${I}${j}" because it does not start with the basename, so the <Router> won't render anything.`),X==null?null:Ie.createElement(wf.Provider,{value:i},Ie.createElement(d2.Provider,{children:t,value:X}))}function _Z({children:e,location:t}){return nZ(t5(e),t)}function t5(e,t=[]){let a=[];return Ie.Children.forEach(e,(o,h)=>{if(!Ie.isValidElement(o))return;let y=[...t,h];if(o.type===Ie.Fragment){a.push.apply(a,t5(o.props.children,y));return}Oa(o.type===th,`[${typeof o.type=="string"?o.type:o.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Oa(!o.props.index||!o.props.children,"An index route cannot have child routes.");let b={id:o.props.id||y.join("-"),caseSensitive:o.props.caseSensitive,element:o.props.element,Component:o.props.Component,index:o.props.index,path:o.props.path,loader:o.props.loader,action:o.props.action,hydrateFallbackElement:o.props.hydrateFallbackElement,HydrateFallback:o.props.HydrateFallback,errorElement:o.props.errorElement,ErrorBoundary:o.props.ErrorBoundary,hasErrorBoundary:o.props.hasErrorBoundary===!0||o.props.ErrorBoundary!=null||o.props.errorElement!=null,shouldRevalidate:o.props.shouldRevalidate,handle:o.props.handle,lazy:o.props.lazy};o.props.children&&(b.children=t5(o.props.children,y)),a.push(b)}),a}var xb="get",bb="application/x-www-form-urlencoded";function Dw(e){return e!=null&&typeof e.tagName=="string"}function gZ(e){return Dw(e)&&e.tagName.toLowerCase()==="button"}function yZ(e){return Dw(e)&&e.tagName.toLowerCase()==="form"}function vZ(e){return Dw(e)&&e.tagName.toLowerCase()==="input"}function xZ(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function bZ(e,t){return e.button===0&&(!t||t==="_self")&&!xZ(e)}function n5(e=""){return new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,a)=>{let o=e[a];return t.concat(Array.isArray(o)?o.map(h=>[a,h]):[[a,o]])},[]))}function wZ(e,t){let a=n5(e);return t&&t.forEach((o,h)=>{a.has(h)||t.getAll(h).forEach(y=>{a.append(h,y)})}),a}var Fx=null;function SZ(){if(Fx===null)try{new FormData(document.createElement("form"),0),Fx=!1}catch{Fx=!0}return Fx}var TZ=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function _T(e){return e!=null&&!TZ.has(e)?(uu(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${bb}"`),null):e}function EZ(e,t){let a,o,h,y,b;if(yZ(e)){let i=e.getAttribute("action");o=i?fm(i,t):null,a=e.getAttribute("method")||xb,h=_T(e.getAttribute("enctype"))||bb,y=new FormData(e)}else if(gZ(e)||vZ(e)&&(e.type==="submit"||e.type==="image")){let i=e.form;if(i==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let C=e.getAttribute("formaction")||i.getAttribute("action");if(o=C?fm(C,t):null,a=e.getAttribute("formmethod")||i.getAttribute("method")||xb,h=_T(e.getAttribute("formenctype"))||_T(i.getAttribute("enctype"))||bb,y=new FormData(i,e),!SZ()){let{name:I,type:j,value:F}=e;if(j==="image"){let G=I?`${I}.`:"";y.append(`${G}x`,"0"),y.append(`${G}y`,"0")}else I&&y.append(I,F)}}else{if(Dw(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');a=xb,o=null,h=bb,b=e}return y&&h==="text/plain"&&(b=y,y=void 0),{action:o,method:a.toLowerCase(),encType:h,formData:y,body:b}}function eO(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}async function AZ(e,t){if(e.id in t)return t[e.id];try{let a=await import(e.module);return t[e.id]=a,a}catch(a){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(a),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function CZ(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function MZ(e,t,a){let o=await Promise.all(e.map(async h=>{let y=t.routes[h.route.id];if(y){let b=await AZ(y,a);return b.links?b.links():[]}return[]}));return RZ(o.flat(1).filter(CZ).filter(h=>h.rel==="stylesheet"||h.rel==="preload").map(h=>h.rel==="stylesheet"?{...h,rel:"prefetch",as:"style"}:{...h,rel:"prefetch"}))}function T6(e,t,a,o,h,y){let b=(C,I)=>a[I]?C.route.id!==a[I].route.id:!0,i=(C,I)=>{var j;return a[I].pathname!==C.pathname||((j=a[I].route.path)==null?void 0:j.endsWith("*"))&&a[I].params["*"]!==C.params["*"]};return y==="assets"?t.filter((C,I)=>b(C,I)||i(C,I)):y==="data"?t.filter((C,I)=>{var F;let j=o.routes[C.route.id];if(!j||!j.hasLoader)return!1;if(b(C,I)||i(C,I))return!0;if(C.route.shouldRevalidate){let G=C.route.shouldRevalidate({currentUrl:new URL(h.pathname+h.search+h.hash,window.origin),currentParams:((F=a[0])==null?void 0:F.params)||{},nextUrl:new URL(e,window.origin),nextParams:C.params,defaultShouldRevalidate:!0});if(typeof G=="boolean")return G}return!0}):[]}function OZ(e,t){return PZ(e.map(a=>{let o=t.routes[a.route.id];if(!o)return[];let h=[o.module];return o.imports&&(h=h.concat(o.imports)),h}).flat(1))}function PZ(e){return[...new Set(e)]}function IZ(e){let t={},a=Object.keys(e).sort();for(let o of a)t[o]=e[o];return t}function RZ(e,t){let a=new Set;return new Set(t),e.reduce((o,h)=>{let y=JSON.stringify(IZ(h));return a.has(y)||(a.add(y),o.push({key:y,link:h})),o},[])}function DZ(e){let t=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return t.pathname==="/"?t.pathname="_root.data":t.pathname=`${t.pathname.replace(/\/$/,"")}.data`,t}function LZ(){let e=Ie.useContext(fy);return eO(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function kZ(){let e=Ie.useContext(Rw);return eO(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var tO=Ie.createContext(void 0);tO.displayName="FrameworkContext";function TN(){let e=Ie.useContext(tO);return eO(e,"You must render this element inside a <HydratedRouter> element"),e}function zZ(e,t){let a=Ie.useContext(tO),[o,h]=Ie.useState(!1),[y,b]=Ie.useState(!1),{onFocus:i,onBlur:C,onMouseEnter:I,onMouseLeave:j,onTouchStart:F}=t,G=Ie.useRef(null);Ie.useEffect(()=>{if(e==="render"&&b(!0),e==="viewport"){let J=oe=>{oe.forEach(ge=>{b(ge.isIntersecting)})},ee=new IntersectionObserver(J,{threshold:.5});return G.current&&ee.observe(G.current),()=>{ee.disconnect()}}},[e]),Ie.useEffect(()=>{if(o){let J=setTimeout(()=>{b(!0)},100);return()=>{clearTimeout(J)}}},[o]);let X=()=>{h(!0)},Y=()=>{h(!1),b(!1)};return a?e!=="intent"?[y,G,{}]:[y,G,{onFocus:Rv(i,X),onBlur:Rv(C,Y),onMouseEnter:Rv(I,X),onMouseLeave:Rv(j,Y),onTouchStart:Rv(F,X)}]:[!1,G,{}]}function Rv(e,t){return a=>{e&&e(a),a.defaultPrevented||t(a)}}function BZ({page:e,...t}){let{router:a}=LZ(),o=Ie.useMemo(()=>dN(a.routes,e,a.basename),[a.routes,e,a.basename]);return o?Ie.createElement(FZ,{page:e,matches:o,...t}):null}function NZ(e){let{manifest:t,routeModules:a}=TN(),[o,h]=Ie.useState([]);return Ie.useEffect(()=>{let y=!1;return MZ(e,t,a).then(b=>{y||h(b)}),()=>{y=!0}},[e,t,a]),o}function FZ({page:e,matches:t,...a}){let o=Jd(),{manifest:h,routeModules:y}=TN(),{loaderData:b,matches:i}=kZ(),C=Ie.useMemo(()=>T6(e,t,i,h,o,"data"),[e,t,i,h,o]),I=Ie.useMemo(()=>T6(e,t,i,h,o,"assets"),[e,t,i,h,o]),j=Ie.useMemo(()=>{if(e===o.pathname+o.search+o.hash)return[];let X=new Set,Y=!1;if(t.forEach(ee=>{var ge;let oe=h.routes[ee.route.id];!oe||!oe.hasLoader||(!C.some(fe=>fe.route.id===ee.route.id)&&ee.route.id in b&&((ge=y[ee.route.id])!=null&&ge.shouldRevalidate)||oe.hasClientLoader?Y=!0:X.add(ee.route.id))}),X.size===0)return[];let J=DZ(e);return Y&&X.size>0&&J.searchParams.set("_routes",t.filter(ee=>X.has(ee.route.id)).map(ee=>ee.route.id).join(",")),[J.pathname+J.search]},[b,o,h,C,t,e,y]),F=Ie.useMemo(()=>OZ(I,h),[I,h]),G=NZ(I);return Ie.createElement(Ie.Fragment,null,j.map(X=>Ie.createElement("link",{key:X,rel:"prefetch",as:"fetch",href:X,...a})),F.map(X=>Ie.createElement("link",{key:X,rel:"modulepreload",href:X,...a})),G.map(({key:X,link:Y})=>Ie.createElement("link",{key:X,...Y})))}function jZ(...e){return t=>{e.forEach(a=>{typeof a=="function"?a(t):a!=null&&(a.current=t)})}}var EN=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{EN&&(window.__reactRouterVersion="7.1.5")}catch{}function UZ({basename:e,children:t,window:a}){let o=Ie.useRef();o.current==null&&(o.current=CH({window:a,v5Compat:!0}));let h=o.current,[y,b]=Ie.useState({action:h.action,location:h.location}),i=Ie.useCallback(C=>{Ie.startTransition(()=>b(C))},[b]);return Ie.useLayoutEffect(()=>h.listen(i),[h,i]),Ie.createElement(mZ,{basename:e,children:t,location:y.location,navigationType:y.action,navigator:h})}var AN=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,CN=Ie.forwardRef(function({onClick:t,discover:a="render",prefetch:o="none",relative:h,reloadDocument:y,replace:b,state:i,target:C,to:I,preventScrollReset:j,viewTransition:F,...G},X){let{basename:Y}=Ie.useContext(wf),J=typeof I=="string"&&AN.test(I),ee,oe=!1;if(typeof I=="string"&&J&&(ee=I,EN))try{let He=new URL(window.location.href),ye=I.startsWith("//")?new URL(He.protocol+I):new URL(I),ke=fm(ye.pathname,Y);ye.origin===He.origin&&ke!=null?I=ke+ye.search+ye.hash:oe=!0}catch{uu(!1,`<Link to="${I}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let ge=QH(I,{relative:h}),[fe,xe,ae]=zZ(o,G),me=GZ(I,{replace:b,state:i,target:C,preventScrollReset:j,relative:h,viewTransition:F});function we(He){t&&t(He),He.defaultPrevented||me(He)}let Ge=Ie.createElement("a",{...G,...ae,href:ee||ge,onClick:oe||y?t:we,ref:jZ(X,xe),target:C,"data-discover":!J&&a==="render"?"true":void 0});return fe&&!J?Ie.createElement(Ie.Fragment,null,Ge,Ie.createElement(BZ,{page:ge})):Ge});CN.displayName="Link";var VZ=Ie.forwardRef(function({"aria-current":t="page",caseSensitive:a=!1,className:o="",end:h=!1,style:y,to:b,viewTransition:i,children:C,...I},j){let F=m2(b,{relative:I.relative}),G=Jd(),X=Ie.useContext(Rw),{navigator:Y,basename:J}=Ie.useContext(wf),ee=X!=null&&YZ(F)&&i===!0,oe=Y.encodeLocation?Y.encodeLocation(F).pathname:F.pathname,ge=G.pathname,fe=X&&X.navigation&&X.navigation.location?X.navigation.location.pathname:null;a||(ge=ge.toLowerCase(),fe=fe?fe.toLowerCase():null,oe=oe.toLowerCase()),fe&&J&&(fe=fm(fe,J)||fe);const xe=oe!=="/"&&oe.endsWith("/")?oe.length-1:oe.length;let ae=ge===oe||!h&&ge.startsWith(oe)&&ge.charAt(xe)==="/",me=fe!=null&&(fe===oe||!h&&fe.startsWith(oe)&&fe.charAt(oe.length)==="/"),we={isActive:ae,isPending:me,isTransitioning:ee},Ge=ae?t:void 0,He;typeof o=="function"?He=o(we):He=[o,ae?"active":null,me?"pending":null,ee?"transitioning":null].filter(Boolean).join(" ");let ye=typeof y=="function"?y(we):y;return Ie.createElement(CN,{...I,"aria-current":Ge,className:He,ref:j,style:ye,to:b,viewTransition:i},typeof C=="function"?C(we):C)});VZ.displayName="NavLink";var $Z=Ie.forwardRef(({discover:e="render",fetcherKey:t,navigate:a,reloadDocument:o,replace:h,state:y,method:b=xb,action:i,onSubmit:C,relative:I,preventScrollReset:j,viewTransition:F,...G},X)=>{let Y=WZ(),J=XZ(i,{relative:I}),ee=b.toLowerCase()==="get"?"get":"post",oe=typeof i=="string"&&AN.test(i),ge=fe=>{if(C&&C(fe),fe.defaultPrevented)return;fe.preventDefault();let xe=fe.nativeEvent.submitter,ae=(xe==null?void 0:xe.getAttribute("formmethod"))||b;Y(xe||fe.currentTarget,{fetcherKey:t,method:ae,navigate:a,replace:h,state:y,relative:I,preventScrollReset:j,viewTransition:F})};return Ie.createElement("form",{ref:X,method:ee,action:J,onSubmit:o?C:ge,...G,"data-discover":!oe&&e==="render"?"true":void 0})});$Z.displayName="Form";function qZ(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function MN(e){let t=Ie.useContext(fy);return Oa(t,qZ(e)),t}function GZ(e,{target:t,replace:a,state:o,preventScrollReset:h,relative:y,viewTransition:b}={}){let i=zo(),C=Jd(),I=m2(e,{relative:y});return Ie.useCallback(j=>{if(bZ(j,t)){j.preventDefault();let F=a!==void 0?a:w1(C)===w1(I);i(e,{replace:F,state:o,preventScrollReset:h,relative:y,viewTransition:b})}},[C,i,I,a,o,t,e,h,y,b])}function nO(e){uu(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let t=Ie.useRef(n5(e)),a=Ie.useRef(!1),o=Jd(),h=Ie.useMemo(()=>wZ(o.search,a.current?null:t.current),[o.search]),y=zo(),b=Ie.useCallback((i,C)=>{const I=n5(typeof i=="function"?i(h):i);a.current=!0,y("?"+I,C)},[y,h]);return[h,b]}var HZ=0,ZZ=()=>`__${String(++HZ)}__`;function WZ(){let{router:e}=MN("useSubmit"),{basename:t}=Ie.useContext(wf),a=hZ();return Ie.useCallback(async(o,h={})=>{let{action:y,method:b,encType:i,formData:C,body:I}=EZ(o,t);if(h.navigate===!1){let j=h.fetcherKey||ZZ();await e.fetch(j,a,h.action||y,{preventScrollReset:h.preventScrollReset,formData:C,body:I,formMethod:h.method||b,formEncType:h.encType||i,flushSync:h.flushSync})}else await e.navigate(h.action||y,{preventScrollReset:h.preventScrollReset,formData:C,body:I,formMethod:h.method||b,formEncType:h.encType||i,replace:h.replace,state:h.state,fromRouteId:a,flushSync:h.flushSync,viewTransition:h.viewTransition})},[e,t,a])}function XZ(e,{relative:t}={}){let{basename:a}=Ie.useContext(wf),o=Ie.useContext(Sf);Oa(o,"useFormAction must be used inside a RouteContext");let[h]=o.matches.slice(-1),y={...m2(e||".",{relative:t})},b=Jd();if(e==null){y.search=b.search;let i=new URLSearchParams(y.search),C=i.getAll("index");if(C.some(j=>j==="")){i.delete("index"),C.filter(F=>F).forEach(F=>i.append("index",F));let j=i.toString();y.search=j?`?${j}`:""}}return(!e||e===".")&&h.route.index&&(y.search=y.search?y.search.replace(/^\?/,"?index&"):"?index"),a!=="/"&&(y.pathname=y.pathname==="/"?a:Ud([a,y.pathname])),w1(y)}function YZ(e,t={}){let a=Ie.useContext(vN);Oa(a!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:o}=MN("useViewTransitionState"),h=m2(e,{relative:t.relative});if(!a.isTransitioning)return!1;let y=fm(a.currentLocation.pathname,o)||a.currentLocation.pathname,b=fm(a.nextLocation.pathname,o)||a.nextLocation.pathname;return Ib(h.pathname,b)!=null||Ib(h.pathname,y)!=null}new TextEncoder;const Lw="/stations-list/",rO="/stations/filters/",_2="/station/",dy="/charging-sessions-history/",ON=dy+"filters/",kw="/charging-session/",S1="/rfid-card/",PN=S1+"add/",IN="/payment-method/",KZ="_stationsList__station_1fjlu_1",JZ={stationsList__station:KZ},iO="data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M9.5%2010C11.1569%2010%2012.5%208.65688%2012.5%207.00002C12.5%205.34317%2011.1569%204.00002%209.5%204.00002C7.84315%204.00002%206.5%205.34317%206.5%207.00002C6.5%208.65688%207.84315%2010%209.5%2010Z'%20stroke='%23373435'%20stroke-width='1.5'/%3e%3cpath%20d='M14.5%2020C12.8431%2020%2011.5%2018.6569%2011.5%2017C11.5%2015.3432%2012.8431%2014%2014.5%2014C16.1569%2014%2017.5%2015.3432%2017.5%2017C17.5%2018.6569%2016.1569%2020%2014.5%2020Z'%20stroke='%23373435'%20stroke-width='1.5'/%3e%3cpath%20d='M15%207.0415L22%207.0415'%20stroke='%23373435'%20stroke-width='1.5'%20stroke-linecap='round'/%3e%3cpath%20d='M9%2017.0415L2%2017.0415'%20stroke='%23373435'%20stroke-width='1.5'%20stroke-linecap='round'/%3e%3cpath%20d='M2%207.0415L4%207.0415'%20stroke='%23373435'%20stroke-width='1.5'%20stroke-linecap='round'/%3e%3cpath%20d='M22%2017.0415L20%2017.0415'%20stroke='%23373435'%20stroke-width='1.5'%20stroke-linecap='round'/%3e%3c/svg%3e",QZ="_button_1udis_1",eW="_fill_1udis_14",tW="_outlined_1udis_31",nW="_outlinedDisabled_1udis_48",rW="_fillDisabled_1udis_49",jx={button:QZ,fill:eW,outlined:tW,outlinedDisabled:nW,fillDisabled:rW};function zw(e){const t=()=>{e.disabled||e.onClick()};return ve.jsx("button",{onClick:t,disabled:e.disabled,className:`${jx.button} ${jx[e.variant]} ${e.disabled?jx[e.variant+"Disabled"]:""}`,children:ve.jsx("img",{src:e.iconSrc,alt:"Icon",className:jx[`${e.variant}__icon`]})})}const iW="data:image/svg+xml,%3csvg%20width='20'%20height='26'%20viewBox='0%200%2020%2026'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M10%2023.4993C15.5228%2023.4993%2020%2019.0221%2020%2013.4993C20%207.97642%2015.5228%203.49927%2010%203.49927C4.47715%203.49927%200%207.97642%200%2013.4993C0%2019.0221%204.47715%2023.4993%2010%2023.4993ZM4.5%2016.9999C5.32843%2016.9999%206%2016.3283%206%2015.4999C6%2014.6715%205.32843%2013.9999%204.5%2013.9999C3.67157%2013.9999%203%2014.6715%203%2015.4999C3%2016.3283%203.67157%2016.9999%204.5%2016.9999ZM12%2019.4999C12%2020.6045%2011.1046%2021.4999%2010%2021.4999C8.89543%2021.4999%208%2020.6045%208%2019.4999C8%2018.3953%208.89543%2017.4999%2010%2017.4999C11.1046%2017.4999%2012%2018.3953%2012%2019.4999ZM15.5%2016.9999C16.3284%2016.9999%2017%2016.3283%2017%2015.4999C17%2014.6715%2016.3284%2013.9999%2015.5%2013.9999C14.6716%2013.9999%2014%2014.6715%2014%2015.4999C14%2016.3283%2014.6716%2016.9999%2015.5%2016.9999ZM16%209.49991C16%2010.6045%2015.1046%2011.4999%2014%2011.4999C12.8954%2011.4999%2012%2010.6045%2012%209.49991C12%208.39534%2012.8954%207.49991%2014%207.49991C15.1046%207.49991%2016%208.39534%2016%209.49991ZM6%2011.4999C7.10457%2011.4999%208%2010.6045%208%209.49991C8%208.39534%207.10457%207.49991%206%207.49991C4.89543%207.49991%204%208.39534%204%209.49991C4%2010.6045%204.89543%2011.4999%206%2011.4999Z'%20fill='%23373435'/%3e%3c/svg%3e",aW="data:image/svg+xml,%3csvg%20width='20'%20height='26'%20viewBox='0%200%2020%2026'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M10%2021.4996C15.5228%2021.4996%2020%2017.0224%2020%2011.4996C20%208.84988%2018.9694%206.44107%2017.2873%204.65172C17.1953%204.55385%2017.0661%204.5002%2016.9318%204.5002L10%204.5H3.0682C2.93386%204.5%202.80472%204.55364%202.7127%204.65152C1.03055%206.44088%200%208.84988%200%2011.4996C0%2017.0224%204.47715%2021.4996%2010%2021.4996ZM6.99976%2010.0006C7.82818%2010.0006%208.49976%209.32904%208.49976%208.50061C8.49976%207.67218%207.82818%207.00061%206.99976%207.00061C6.17133%207.00061%205.49976%207.67218%205.49976%208.50061C5.49976%209.32904%206.17133%2010.0006%206.99976%2010.0006ZM8.99963%2016.0002C8.99963%2017.1048%208.1042%2018.0002%206.99963%2018.0002C5.89506%2018.0002%204.99963%2017.1048%204.99963%2016.0002C4.99963%2014.8957%205.89506%2014.0002%206.99963%2014.0002C8.1042%2014.0002%208.99963%2014.8957%208.99963%2016.0002ZM12.9998%2010.0006C13.8282%2010.0006%2014.4998%209.32904%2014.4998%208.50061C14.4998%207.67218%2013.8282%207.00061%2012.9998%207.00061C12.1713%207.00061%2011.4998%207.67218%2011.4998%208.50061C11.4998%209.32904%2012.1713%2010.0006%2012.9998%2010.0006ZM14.9996%2016.0002C14.9996%2017.1048%2014.1042%2018.0002%2012.9996%2018.0002C11.8951%2018.0002%2010.9996%2017.1048%2010.9996%2016.0002C10.9996%2014.8957%2011.8951%2014.0002%2012.9996%2014.0002C14.1042%2014.0002%2014.9996%2014.8957%2014.9996%2016.0002ZM9.99963%2014.0007C11.1042%2014.0007%2011.9996%2013.1053%2011.9996%2012.0007C11.9996%2010.8962%2011.1042%2010.0007%209.99963%2010.0007C8.89506%2010.0007%207.99963%2010.8962%207.99963%2012.0007C7.99963%2013.1053%208.89506%2014.0007%209.99963%2014.0007ZM17.9999%2012.0007C17.9999%2013.1053%2017.1044%2014.0007%2015.9999%2014.0007C14.8953%2014.0007%2013.9999%2013.1053%2013.9999%2012.0007C13.9999%2010.8962%2014.8953%2010.0007%2015.9999%2010.0007C17.1044%2010.0007%2017.9999%2010.8962%2017.9999%2012.0007ZM4.00012%2014.0007C5.10469%2014.0007%206.00012%2013.1053%206.00012%2012.0007C6.00012%2010.8962%205.10469%2010.0007%204.00012%2010.0007C2.89555%2010.0007%202.00012%2010.8962%202.00012%2012.0007C2.00012%2013.1053%202.89555%2014.0007%204.00012%2014.0007Z'%20fill='%23373435'/%3e%3c/svg%3e",oW="data:image/svg+xml,%3csvg%20width='20'%20height='26'%20viewBox='0%200%2020%2026'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M20%2010.0002C20%2013.9581%2017.7006%2017.379%2014.3649%2018.9999H17.9999C18.276%2018.9999%2018.4999%2019.2237%2018.4999%2019.4999V25.4999C18.4999%2025.776%2018.276%2025.9999%2017.9999%2025.9999H1.99988C1.72374%2025.9999%201.49988%2025.776%201.49988%2025.4999V19.4999C1.49988%2019.2237%201.72374%2018.9999%201.99988%2018.9999H5.63512C2.29936%2017.379%200%2013.9581%200%2010.0002C0%204.4774%204.47715%200.000244141%2010%200.000244141C15.5228%200.000244141%2020%204.4774%2020%2010.0002ZM14.4998%2024.5004C15.6043%2024.5004%2016.4998%2023.6049%2016.4998%2022.5004C16.4998%2021.3958%2015.6043%2020.5004%2014.4998%2020.5004C13.3952%2020.5004%2012.4998%2021.3958%2012.4998%2022.5004C12.4998%2023.6049%2013.3952%2024.5004%2014.4998%2024.5004ZM7.49951%2022.5004C7.49951%2023.6049%206.60408%2024.5004%205.49951%2024.5004C4.39494%2024.5004%203.49951%2023.6049%203.49951%2022.5004C3.49951%2021.3958%204.39494%2020.5004%205.49951%2020.5004C6.60408%2020.5004%207.49951%2021.3958%207.49951%2022.5004ZM4.5%2013.5009C5.32843%2013.5009%206%2012.8293%206%2012.0009C6%2011.1725%205.32843%2010.5009%204.5%2010.5009C3.67157%2010.5009%203%2011.1725%203%2012.0009C3%2012.8293%203.67157%2013.5009%204.5%2013.5009ZM12%2016.0009C12%2017.1055%2011.1046%2018.0009%2010%2018.0009C8.89543%2018.0009%208%2017.1055%208%2016.0009C8%2014.8963%208.89543%2014.0009%2010%2014.0009C11.1046%2014.0009%2012%2014.8963%2012%2016.0009ZM15.5%2013.5009C16.3284%2013.5009%2017%2012.8293%2017%2012.0009C17%2011.1725%2016.3284%2010.5009%2015.5%2010.5009C14.6716%2010.5009%2014%2011.1725%2014%2012.0009C14%2012.8293%2014.6716%2013.5009%2015.5%2013.5009ZM16%206.00089C16%207.10545%2015.1046%208.00089%2014%208.00089C12.8954%208.00089%2012%207.10545%2012%206.00089C12%204.89632%2012.8954%204.00089%2014%204.00089C15.1046%204.00089%2016%204.89632%2016%206.00089ZM6%208.00089C7.10457%208.00089%208%207.10545%208%206.00089C8%204.89632%207.10457%204.00089%206%204.00089C4.89543%204.00089%204%204.89632%204%206.00089C4%207.10545%204.89543%208.00089%206%208.00089Z'%20fill='%23373435'/%3e%3c/svg%3e",sW="data:image/svg+xml,%3csvg%20width='20'%20height='26'%20viewBox='0%200%2020%2026'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M20%208.49958C20%2012.4578%2017.7002%2015.8789%2014.364%2017.4996H17.9999C18.276%2017.4996%2018.4999%2017.7235%2018.4999%2017.9996V23.9996C18.4999%2024.2758%2018.276%2024.4996%2017.9999%2024.4996H1.99988C1.72374%2024.4996%201.49988%2024.2758%201.49988%2023.9996V17.9996C1.49988%2017.7235%201.72374%2017.4996%201.99988%2017.4996H5.63598C2.29975%2015.8789%200%2012.4578%200%208.49958C0%205.84988%201.03055%203.44088%202.7127%201.65152C2.80472%201.55364%202.93386%201.5%203.0682%201.5H10L16.9318%201.5002C17.0661%201.5002%2017.1953%201.55385%2017.2873%201.65172C18.9694%203.44107%2020%205.84988%2020%208.49958ZM6.99976%207.00061C7.82818%207.00061%208.49976%206.32904%208.49976%205.50061C8.49976%204.67218%207.82818%204.00061%206.99976%204.00061C6.17133%204.00061%205.49976%204.67218%205.49976%205.50061C5.49976%206.32904%206.17133%207.00061%206.99976%207.00061ZM8.99963%2013.0002C8.99963%2014.1048%208.1042%2015.0002%206.99963%2015.0002C5.89506%2015.0002%204.99963%2014.1048%204.99963%2013.0002C4.99963%2011.8957%205.89506%2011.0002%206.99963%2011.0002C8.1042%2011.0002%208.99963%2011.8957%208.99963%2013.0002ZM12.9998%207.00061C13.8282%207.00061%2014.4998%206.32904%2014.4998%205.50061C14.4998%204.67218%2013.8282%204.00061%2012.9998%204.00061C12.1713%204.00061%2011.4998%204.67218%2011.4998%205.50061C11.4998%206.32904%2012.1713%207.00061%2012.9998%207.00061ZM14.9996%2013.0002C14.9996%2014.1048%2014.1042%2015.0002%2012.9996%2015.0002C11.8951%2015.0002%2010.9996%2014.1048%2010.9996%2013.0002C10.9996%2011.8957%2011.8951%2011.0002%2012.9996%2011.0002C14.1042%2011.0002%2014.9996%2011.8957%2014.9996%2013.0002ZM14.4998%2023.0001C15.6043%2023.0001%2016.4998%2022.1047%2016.4998%2021.0001C16.4998%2019.8956%2015.6043%2019.0001%2014.4998%2019.0001C13.3952%2019.0001%2012.4998%2019.8956%2012.4998%2021.0001C12.4998%2022.1047%2013.3952%2023.0001%2014.4998%2023.0001ZM7.49951%2021.0001C7.49951%2022.1047%206.60408%2023.0001%205.49951%2023.0001C4.39494%2023.0001%203.49951%2022.1047%203.49951%2021.0001C3.49951%2019.8956%204.39494%2019.0001%205.49951%2019.0001C6.60408%2019.0001%207.49951%2019.8956%207.49951%2021.0001ZM9.99963%2011.0007C11.1042%2011.0007%2011.9996%2010.1053%2011.9996%209.00073C11.9996%207.89616%2011.1042%207.00073%209.99963%207.00073C8.89506%207.00073%207.99963%207.89616%207.99963%209.00073C7.99963%2010.1053%208.89506%2011.0007%209.99963%2011.0007ZM17.9999%209.00073C17.9999%2010.1053%2017.1044%2011.0007%2015.9999%2011.0007C14.8953%2011.0007%2013.9999%2010.1053%2013.9999%209.00073C13.9999%207.89616%2014.8953%207.00073%2015.9999%207.00073C17.1044%207.00073%2017.9999%207.89616%2017.9999%209.00073ZM4.00012%2011.0007C5.10469%2011.0007%206.00012%2010.1053%206.00012%209.00073C6.00012%207.89616%205.10469%207.00073%204.00012%207.00073C2.89555%207.00073%202.00012%207.89616%202.00012%209.00073C2.00012%2010.1053%202.89555%2011.0007%204.00012%2011.0007Z'%20fill='%23373435'/%3e%3c/svg%3e",lW="data:image/svg+xml,%3csvg%20width='20'%20height='26'%20viewBox='0%200%2020%2026'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M10%2021.4996C15.5228%2021.4996%2020%2017.0224%2020%2011.4996C20%208.84988%2018.9694%206.44107%2017.2873%204.65172C17.1953%204.55385%2017.0661%204.5002%2016.9318%204.5002L10%204.5H3.0682C2.93386%204.5%202.80472%204.55364%202.7127%204.65152C1.03055%206.44088%200%208.84988%200%2011.4996C0%2017.0224%204.47715%2021.4996%2010%2021.4996ZM7.49976%208.50061C7.49976%208.77675%207.2759%209.00061%206.99976%209.00061C6.72361%209.00061%206.49976%208.77675%206.49976%208.50061C6.49976%208.22447%206.72361%208.00061%206.99976%208.00061C7.2759%208.00061%207.49976%208.22447%207.49976%208.50061ZM8.49976%208.50061C8.49976%209.32904%207.82818%2010.0006%206.99976%2010.0006C6.17133%2010.0006%205.49976%209.32904%205.49976%208.50061C5.49976%207.67218%206.17133%207.00061%206.99976%207.00061C7.82818%207.00061%208.49976%207.67218%208.49976%208.50061ZM6.99963%2017.0002C7.55192%2017.0002%207.99963%2016.5525%207.99963%2016.0002C7.99963%2015.448%207.55192%2015.0002%206.99963%2015.0002C6.44735%2015.0002%205.99963%2015.448%205.99963%2016.0002C5.99963%2016.5525%206.44735%2017.0002%206.99963%2017.0002ZM6.99963%2018.0002C8.1042%2018.0002%208.99963%2017.1048%208.99963%2016.0002C8.99963%2014.8957%208.1042%2014.0002%206.99963%2014.0002C5.89506%2014.0002%204.99963%2014.8957%204.99963%2016.0002C4.99963%2017.1048%205.89506%2018.0002%206.99963%2018.0002ZM13.4998%208.50061C13.4998%208.77675%2013.2759%209.00061%2012.9998%209.00061C12.7236%209.00061%2012.4998%208.77675%2012.4998%208.50061C12.4998%208.22447%2012.7236%208.00061%2012.9998%208.00061C13.2759%208.00061%2013.4998%208.22447%2013.4998%208.50061ZM14.4998%208.50061C14.4998%209.32904%2013.8282%2010.0006%2012.9998%2010.0006C12.1713%2010.0006%2011.4998%209.32904%2011.4998%208.50061C11.4998%207.67218%2012.1713%207.00061%2012.9998%207.00061C13.8282%207.00061%2014.4998%207.67218%2014.4998%208.50061ZM12.9996%2017.0002C13.5519%2017.0002%2013.9996%2016.5525%2013.9996%2016.0002C13.9996%2015.448%2013.5519%2015.0002%2012.9996%2015.0002C12.4473%2015.0002%2011.9996%2015.448%2011.9996%2016.0002C11.9996%2016.5525%2012.4473%2017.0002%2012.9996%2017.0002ZM12.9996%2018.0002C14.1042%2018.0002%2014.9996%2017.1048%2014.9996%2016.0002C14.9996%2014.8957%2014.1042%2014.0002%2012.9996%2014.0002C11.8951%2014.0002%2010.9996%2014.8957%2010.9996%2016.0002C10.9996%2017.1048%2011.8951%2018.0002%2012.9996%2018.0002ZM10.9996%2012.0007C10.9996%2012.553%2010.5519%2013.0007%209.99963%2013.0007C9.44735%2013.0007%208.99963%2012.553%208.99963%2012.0007C8.99963%2011.4484%209.44735%2011.0007%209.99963%2011.0007C10.5519%2011.0007%2010.9996%2011.4484%2010.9996%2012.0007ZM11.9996%2012.0007C11.9996%2013.1053%2011.1042%2014.0007%209.99963%2014.0007C8.89506%2014.0007%207.99963%2013.1053%207.99963%2012.0007C7.99963%2010.8962%208.89506%2010.0007%209.99963%2010.0007C11.1042%2010.0007%2011.9996%2010.8962%2011.9996%2012.0007ZM15.9999%2013.0007C16.5522%2013.0007%2016.9999%2012.553%2016.9999%2012.0007C16.9999%2011.4484%2016.5522%2011.0007%2015.9999%2011.0007C15.4476%2011.0007%2014.9999%2011.4484%2014.9999%2012.0007C14.9999%2012.553%2015.4476%2013.0007%2015.9999%2013.0007ZM15.9999%2014.0007C17.1044%2014.0007%2017.9999%2013.1053%2017.9999%2012.0007C17.9999%2010.8962%2017.1044%2010.0007%2015.9999%2010.0007C14.8953%2010.0007%2013.9999%2010.8962%2013.9999%2012.0007C13.9999%2013.1053%2014.8953%2014.0007%2015.9999%2014.0007ZM5.00012%2012.0007C5.00012%2012.553%204.55241%2013.0007%204.00012%2013.0007C3.44784%2013.0007%203.00012%2012.553%203.00012%2012.0007C3.00012%2011.4484%203.44784%2011.0007%204.00012%2011.0007C4.55241%2011.0007%205.00012%2011.4484%205.00012%2012.0007ZM6.00012%2012.0007C6.00012%2013.1053%205.10469%2014.0007%204.00012%2014.0007C2.89555%2014.0007%202.00012%2013.1053%202.00012%2012.0007C2.00012%2010.8962%202.89555%2010.0007%204.00012%2010.0007C5.10469%2010.0007%206.00012%2010.8962%206.00012%2012.0007Z'%20fill='%23373435'/%3e%3c/svg%3e",cW="data:image/svg+xml,%3csvg%20width='20'%20height='26'%20viewBox='0%200%2020%2026'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M10%2021.4996C15.5228%2021.4996%2020%2017.0224%2020%2011.4996C20%208.84988%2018.9694%206.44107%2017.2873%204.65172C17.1953%204.55385%2017.0661%204.5002%2016.9318%204.5002L10%204.5H3.0682C2.93386%204.5%202.80472%204.55364%202.7127%204.65152C1.03055%206.44088%200%208.84988%200%2011.4996C0%2017.0224%204.47715%2021.4996%2010%2021.4996ZM4%2014.5C5.65685%2014.5%207%2013.1569%207%2011.5C7%209.84315%205.65685%208.5%204%208.5C2.34315%208.5%201%209.84315%201%2011.5C1%2013.1569%202.34315%2014.5%204%2014.5ZM19%2011.5C19%2013.1569%2017.6569%2014.5%2016%2014.5C14.3431%2014.5%2013%2013.1569%2013%2011.5C13%209.84315%2014.3431%208.5%2016%208.5C17.6569%208.5%2019%209.84315%2019%2011.5ZM10%2019C10.8284%2019%2011.5%2018.3284%2011.5%2017.5C11.5%2016.6716%2010.8284%2016%2010%2016C9.17157%2016%208.5%2016.6716%208.5%2017.5C8.5%2018.3284%209.17157%2019%2010%2019ZM7%2017.5C7%2018.0523%206.55228%2018.5%206%2018.5C5.44772%2018.5%205%2018.0523%205%2017.5C5%2016.9477%205.44772%2016.5%206%2016.5C6.55228%2016.5%207%2016.9477%207%2017.5ZM14%2018.5C14.5523%2018.5%2015%2018.0523%2015%2017.5C15%2016.9477%2014.5523%2016.5%2014%2016.5C13.4477%2016.5%2013%2016.9477%2013%2017.5C13%2018.0523%2013.4477%2018.5%2014%2018.5ZM11%206.5C11%207.05228%2010.5523%207.5%2010%207.5C9.44771%207.5%209%207.05228%209%206.5C9%205.94772%209.44771%205.5%2010%205.5C10.5523%205.5%2011%205.94772%2011%206.5ZM13%207.5C13.5523%207.5%2014%207.05228%2014%206.5C14%205.94772%2013.5523%205.5%2013%205.5C12.4477%205.5%2012%205.94772%2012%206.5C12%207.05228%2012.4477%207.5%2013%207.5ZM8%206.5C8%207.05228%207.55228%207.5%207%207.5C6.44772%207.5%206%207.05228%206%206.5C6%205.94772%206.44772%205.5%207%205.5C7.55228%205.5%208%205.94772%208%206.5ZM10%2010.5C10.5523%2010.5%2011%2010.0523%2011%209.5C11%208.94772%2010.5523%208.5%2010%208.5C9.44771%208.5%209%208.94772%209%209.5C9%2010.0523%209.44771%2010.5%2010%2010.5Z'%20fill='%23373435'/%3e%3c/svg%3e",uW="data:image/svg+xml,%3csvg%20width='20'%20height='26'%20viewBox='0%200%2020%2026'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M20%2013C20%2018.5228%2015.5228%2023%2010%2023C4.47715%2023%200%2018.5228%200%2013C0%2010.9662%200.607169%209.07413%201.65013%207.49529L0.900438%206.73775C0.717242%206.55263%200.717242%206.25251%200.900438%206.06739L3.10891%203.83582C3.2921%203.6507%203.58912%203.6507%203.77232%203.83582L4.54555%204.61715C6.11422%203.59438%207.9877%203%2010%203C12.0123%203%2013.8858%203.59438%2015.4544%204.61715L16.2277%203.83582C16.4109%203.6507%2016.7079%203.6507%2016.8911%203.83582L19.0996%206.06739C19.2828%206.25251%2019.2828%206.55263%2019.0996%206.73775L18.3499%207.49529C19.3928%209.07413%2020%2010.9662%2020%2013ZM11.9357%209.08218C12.2884%208.65122%2012.5%208.10032%2012.5%207.5C12.5%206.90031%2012.2888%206.34993%2011.9368%205.91916L10.3548%207.50122L11.9357%209.08218ZM11.5822%209.43574L10.0012%207.85478L8.41916%209.43684C8.84993%209.78885%209.40031%2010%2010%2010C10.6003%2010%2011.1512%209.78841%2011.5822%209.43574ZM8.06536%209.08353C7.71203%208.65236%207.5%208.10094%207.5%207.5C7.5%206.89968%207.71159%206.34878%208.06426%205.91782L9.64767%207.50122L8.06536%209.08353ZM8.41782%205.56426L10.0012%207.14767L11.5835%205.56536C11.1524%205.21203%2010.6009%205%2010%205C9.39968%205%208.84878%205.21159%208.41782%205.56426ZM12.5%2018.5006C12.5%2019.101%2012.2884%2019.6519%2011.9357%2020.0828L10.3548%2018.5019L11.9368%2016.9198C12.2888%2017.3506%2012.5%2017.9009%2012.5%2018.5006ZM10.0012%2018.8554L11.5822%2020.4364C11.1512%2020.789%2010.6003%2021.0006%2010%2021.0006C9.40031%2021.0006%208.84993%2020.7895%208.41916%2020.4375L10.0012%2018.8554ZM7.5%2018.5006C7.5%2019.1016%207.71203%2019.653%208.06536%2020.0842L9.64767%2018.5019L8.06426%2016.9185C7.71159%2017.3494%207.5%2017.9003%207.5%2018.5006ZM10.0012%2018.1483L8.41782%2016.5649C8.84878%2016.2122%209.39968%2016.0006%2010%2016.0006C10.6009%2016.0006%2011.1524%2016.2127%2011.5835%2016.566L10.0012%2018.1483ZM18%2013C18%2014.3807%2016.8807%2015.5%2015.5%2015.5C14.1193%2015.5%2013%2014.3807%2013%2013C13%2011.6193%2014.1193%2010.5%2015.5%2010.5C16.8807%2010.5%2018%2011.6193%2018%2013ZM4.5%2015.5C5.88071%2015.5%207%2014.3807%207%2013C7%2011.6193%205.88071%2010.5%204.5%2010.5C3.11929%2010.5%202%2011.6193%202%2013C2%2014.3807%203.11929%2015.5%204.5%2015.5Z'%20fill='%23373435'/%3e%3c/svg%3e",hW="data:image/svg+xml,%3csvg%20width='20'%20height='26'%20viewBox='0%200%2020%2026'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M10%2021.4996C15.5228%2021.4996%2020%2017.0224%2020%2011.4996V10.5006C20%207.18697%2017.3138%204.50015%2014.0001%204.50008L10%204.5H5.99997C2.6863%204.5%201.85829e-05%207.18678%202.62218e-06%2010.5005L0%2011.4996C0%2017.0224%204.47715%2021.4996%2010%2021.4996ZM10%2018C10.8284%2018%2011.5%2017.3284%2011.5%2016.5C11.5%2015.6716%2010.8284%2015%2010%2015C9.17157%2015%208.5%2015.6716%208.5%2016.5C8.5%2017.3284%209.17157%2018%2010%2018ZM7%2017C7%2017.5523%206.55228%2018%206%2018C5.44772%2018%205%2017.5523%205%2017C5%2016.4477%205.44772%2016%206%2016C6.55228%2016%207%2016.4477%207%2017ZM14%2018C14.5523%2018%2015%2017.5523%2015%2017C15%2016.4477%2014.5523%2016%2014%2016C13.4477%2016%2013%2016.4477%2013%2017C13%2017.5523%2013.4477%2018%2014%2018ZM8%208.5C8%2010.1569%206.65685%2011.5%205%2011.5C3.34315%2011.5%202%2010.1569%202%208.5C2%206.84315%203.34315%205.5%205%205.5C6.65685%205.5%208%206.84315%208%208.5ZM15%2011.5C16.6569%2011.5%2018%2010.1569%2018%208.5C18%206.84315%2016.6569%205.5%2015%205.5C13.3431%205.5%2012%206.84315%2012%208.5C12%2010.1569%2013.3431%2011.5%2015%2011.5Z'%20fill='%23373435'/%3e%3c/svg%3e",fW="/assets/unknown-type-lli7bkbL.png";var r5;(e=>{e.AVAILABLE="",e.CHARGING="",e.INOPERATIVE=" "})(r5||(r5={}));const g2={"Type 1":iW,"Type 2":aW,CCS1:oW,CCS2:sW,"GB/T (AC)":lW,"GB/T (DC)":cW,CHAdeMO:uW,Tesla:hW,:fW},RN={:"green",:"orange",:"grey"," ":"grey",:"grey"},Rb=["Type 1","Type 2","CCS1","CCS2","GB/T (AC)","GB/T (DC)","CHAdeMO","Tesla"],wg={connectors:[...Rb],onlyAvailableStations:!1,minimalPower:0,isModified:!1,shouldUpdateStations:!1},aO={:"green",:"orange"," ":"grey"},E6=2,DN={stationFilters:{connectors:[...Rb],onlyAvailableStations:!1,minimalPower:0,isModified:!1,shouldUpdateStations:!0},stations:[],sessionFilters:{connectors:[...Rb],onlyPaidSessions:!1,durationInHours:0,isModified:!1,shouldUpdateSessions:!0},sessions:[],position:void 0,isInitTelegramSdk:void 0},dW=15,Bo=Ie.createContext({...DN,setStationFilters:e=>{},setStations:e=>{},setSessionFilters:e=>{},setSessions:e=>{},showSnackbar:e=>{},setPosition:e=>{},setRfidCard:e=>{},setActiveChargingSession:e=>{},setPaymentMethod:e=>{}}),pW=e=>Math.round(e.max_electric_power/1e3*E6)/E6,i5=(e,t)=>({minElectricPower:e.minimalPower,standards:e.connectors,stationStatus:e.onlyAvailableStations?r5.AVAILABLE:void 0,latitude:t==null?void 0:t.latitude.toString(),longitude:t==null?void 0:t.longitude.toString()});async function bl(e){const t=new Headers;e.token&&t.set("Authorization","Bearer "+e.token);const a={method:e.method,headers:t,keepalive:e.keepalive};e.content&&(e.isFiles?a.body=e.content:(a.body=JSON.stringify(e.content,(o,h)=>{if(h!==null)return h}),t.set("Content-Type","application/json")));try{const o=await fetch(e.url,a);let h;try{h=await(e.responseIsString?o.text():o.json())}catch{}return{data:h!=null&&h.error?void 0:h,error:h!=null&&h.error?{status:h==null?void 0:h.status,error:h==null?void 0:h.error,message:h==null?void 0:h.message}:void 0}}catch{return{error:{status:500,error:"InternalServerError",message:"  "}}}}const LN="https://94f72dc0a746.vps.myjino.ru/app/api/locations/",oO="https://94f72dc0a746.vps.myjino.ru/app/api/sessions/",sO="https://94f72dc0a746.vps.myjino.ru/app/api/card/",kN="https://94f72dc0a746.vps.myjino.ru/app/api/payment/",Bw=kN+"method/",mW="https://94f72dc0a746.vps.myjino.ru/auth/login/",_W=async e=>bl({url:mW,method:"POST",content:e.userInitData}),gW=e=>{switch(e){case"AVAILABLE":return"";case"CHARGING":return"";case"INOPERATIVE":return" ";default:throw new Error("Conversion for station status not exists")}},yW=e=>{switch(e){case"AVAILABLE":return"";case"CHARGING":return"";case"INOPERATIVE":return"";case"OUTOFORDER":return"";case"UNKNOWN":return" ";default:throw new Error("Conversion for connector status not exists")}},zN=e=>{switch(e){case"CCS1":return"CCS1";case"CCS2":return"CCS2";case"CHADEMO":return"CHAdeMO";case"GBT_AC":return"GB/T (AC)";case"GBT_DC":return"GB/T (DC)";case"TESLA":return"Tesla";case"TYPE_1":return"Type 1";case"TYPE_2":return"Type 2";default:return""}},BN=e=>{switch(e){case"CABLE":return"";case"SOCKET":return"";default:throw new Error("Conversion for connector format not exists")}},NN=e=>{switch(e){case"AC_1_PHASE":return"AC";case"AC_2_PHASE":case"AC_2_PHASE_SPLIT":return"AC-2";case"AC_3_PHASE":return"AC-3";case"DC":return"DC";default:throw new Error("Conversion for connector power type not exists")}},vW=e=>{switch(e){case"ENERGY":return"";case"FLAT":return" ";case"PARKING_TIME":return" ";case"TIME":return"";default:throw new Error("Conversion for tariff type not exists")}},xW=e=>{switch(e){case"RUB":return"";default:throw new Error("Conversion for tariff currency not exists")}},bW=e=>({latitude:e.latitude,longitude:e.longitude}),wW=e=>({weekday:e.weekday,occupancy_in_percentage:e.occupancy_in_percentage}),SW=e=>({evse_uid:e.evse_uid,id:e.id,status:yW(e.status),standard:zN(e.standard),format:BN(e.format),power_type:NN(e.power_type),max_voltage:e.max_voltage,max_amperage:e.max_amperage,max_electric_power:e.max_electric_power,tariffs:e.tariffs?e.tariffs.map(t=>FN(t)):[]}),FN=e=>({type:vW(e.type),price:e.price,currency:xW(e.currency)}),A6=e=>({id:e.id+"",name:e.name,address:e.address,status:gW(e.status),description:e.description,coordinates:bW(e.coordinates),connectors:e.connectors.map(t=>SW(t)),images:e.images,metres_to_station:e.metres_to_station,occupation:e.occupation?e.occupation.map(t=>wW(t)):[]}),TW=e=>{switch(e){case"":return"AVAILABLE";case"":return"CHARGING";case" ":return"INOPERATIVE";default:throw new Error("Conversion for station status not exists")}},jN=e=>{switch(e){case"CCS1":return"CCS1";case"CCS2":return"CCS2";case"CHAdeMO":return"CHADEMO";case"GB/T (AC)":return"GBT_AC";case"GB/T (DC)":return"GBT_DC";case"Tesla":return"TESLA";case"Type 1":return"TYPE_1";case"Type 2":return"TYPE_2";default:return"OTHER"}},EW=e=>({station_id:e.station_id,station_name:e.station_name,station_address:e.station_address,evse_uid:e.evse_uid,connector_id:e.connector_id,standard:zN(e.standard),format:BN(e.format),power_type:NN(e.power_type),max_electric_power:e.max_electric_power}),gT=e=>e<10?`0${e}`:`${e}`,h1=e=>new Date(e.year,e.month-1,e.day,e.hours,e.minutes,e.seconds),Nw=e=>({year:e.getUTCFullYear(),month:e.getUTCMonth()+1,day:e.getUTCDate(),hours:e.getUTCHours(),minutes:e.getUTCMinutes(),seconds:e.getUTCSeconds()}),UN=(e,t,a)=>`${gT(e)}:${gT(t)}:${gT(a)}`,VN=(e,t,a)=>{const o=`${e===0?"":`${e}`} ${t===0?"":`${t}`} ${a===0?"":`${a}`}`;return o.trim().length>0?o:"0"},Db=(e,t)=>{const a=h1(e).getTime(),o=h1(t).getTime();return Nw(new Date(a<o?o-a:a-o))},C6=(e,t)=>{const a=new Date(e);return Nw(a)},AW=e=>{switch(e){case"ACTIVE":return"";case"COMPLETED":return"";case"INVALID":return""}throw new Error("Conversion for charging session status not exists")},CW=e=>{switch(e){case"PAID":return"";case"UNPAID":return""}throw new Error("Conversion for payment status not exists")},M6=e=>({id:e.id,connector_info:EW(e.connector_info),tariffs:e.tariffs?e.tariffs.map(t=>FN(t)):void 0,status:AW(e.status),charged_kwh:e.charged_kwh,current_power:e.current_power,max_power:e.max_power,min_power:e.min_power,start_date:C6(e.start_date),end_date:e.end_date?C6(e.end_date):void 0,total_cost:e.total_cost,payment_method:e.payment_method,payment_status:e.payment_status?CW(e.payment_status):void 0,battery_percentage:e.battery_percentage}),MW=e=>{switch(e){case"":return"ACTIVE";case"":return"COMPLETED";case"":return"INVALID"}throw new Error("Conversion for charging session status not exists")},lc=e=>e.length?"?"+e.map(t=>t.value!==void 0?`${t.key}=${encodeURIComponent(t.value)}`:void 0).filter(t=>t!==void 0).join("&"):"",OW=e=>{var a;const t=[];return e.priceGreaterThan!==void 0&&t.push({key:"priceGreaterThan",value:e.priceGreaterThan}),e.totalHoursGreaterThan!==void 0&&t.push({key:"totalHoursGreaterThan",value:e.totalHoursGreaterThan}),e.status!==void 0&&t.push({key:"status",value:MW(e.status)}),(a=e.standards)!=null&&a.length&&t.push({key:"standards",value:e.standards.map(o=>jN(o)).join(",")}),e.limit!==void 0&&t.push({key:"limit",value:e.limit}),e.offset!==void 0&&t.push({key:"offset",value:e.offset}),t},PW=async e=>bl({url:oO+lc(OW(e)),method:"GET",token:e.token}),IW=async e=>bl({url:oO+e.id,method:"GET",token:e.token}),RW=async e=>bl({url:oO+e.id+"/stop/",method:"POST",token:e.token}),DW=async e=>bl({url:kN+"retry/"+e.sessionId,method:"POST",token:e.token}),LW=async e=>bl({url:Bw+"new/",method:"POST",token:e.token}),kW=async e=>bl({url:Bw,method:"GET",token:e.token,responseIsString:!0}),zW=async e=>bl({url:Bw+"payurl/",method:"GET",token:e.token,responseIsString:!0}),BW=async e=>bl({url:Bw+"detach/",method:"DELETE",token:e.token}),NW=async e=>bl({url:sO,method:"GET",token:e.token}),FW=async e=>bl({url:sO+"attach/"+lc([{key:"visualCardNumber",value:e.visualCardNumber}]),method:"PUT",token:e.token}),jW=async e=>bl({url:sO+"detach/"+lc([{key:"visualCardNumber",value:e.visualCardNumber}]),method:"DELETE",token:e.token}),UW=e=>({visual_number:e.visual_number,group:e.group}),VW=e=>{var a;const t=[];return e.partOfName!==void 0&&t.push({key:"partOfName",value:e.partOfName}),e.latitude!==void 0&&t.push({key:"latitude",value:e.latitude}),e.longitude!==void 0&&t.push({key:"longitude",value:e.longitude}),e.stationStatus!==void 0&&t.push({key:"stationStatus",value:TW(e.stationStatus)}),e.minElectricPower!==void 0&&t.push({key:"minElectricPower",value:e.minElectricPower}),(a=e.standards)!=null&&a.length&&t.push({key:"standards",value:e.standards.map(o=>jN(o)).join(",")}),e.limit!==void 0&&t.push({key:"limit",value:e.limit}),e.offset!==void 0&&t.push({key:"offset",value:e.offset}),t},$W=e=>{const t=[];return e.latitude!==void 0&&t.push({key:"latitude",value:e.latitude}),e.longitude!==void 0&&t.push({key:"longitude",value:e.longitude}),t},qW=async e=>bl({url:LN+lc(VW(e)),method:"GET",token:e.token}),GW=async e=>bl({url:LN+e.id+lc($W(e)),method:"GET",token:e.token}),X0=()=>{const e="eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiI1Nzc4NjYzNTMzIiwiaWF0IjoxNzQyMjMwNTIyLCJleHAiOjE3NDM0NDAxMjJ9.0PWkpt7n-eP0WXqA_KQiaPOnnnpnr7li0lO0KN-_VglUCn2lPWboe9za--BvPu7rclHjjQw0rxv2ZtiMN3GNOg";return{authorizationTelegramUserFromApi:async J=>{const ee=await _W(J);if(ee.data)return ee.data.token},getStationsFromApi:async J=>{const ee=await qW({...J,token:e});return ee.data?ee.data.map(oe=>A6(oe)):[]},getStationByIdFromApi:async J=>{const ee=await GW({...J,token:e});if(ee.data)return A6(ee.data)},getChargingSessionsFromApi:async J=>{const ee=await PW({...J,token:e});return ee.data?ee.data.map(oe=>M6(oe)):[]},getChargingSessionByIdFromApi:async J=>{const ee=await IW({...J,token:e});if(ee.data)return M6(ee.data)},stopChargingSessionFromApi:async J=>(await RW({...J,token:e})).error,getRfidCardFromApi:async J=>{const ee=await NW({...J,token:e});if(ee.data)return UW(ee.data)},attachRfidCardFromApi:async J=>(await FW({...J,token:e})).error,detachRfidCardFromApi:async J=>(await jW({...J,token:e})).error,retryPaymentForChargingSessionFromApi:async J=>(await DW({...J,token:e})).error,createPaymentMethodFromApi:async J=>(await LW({...J,token:e})).error,getPaymentMethodFromApi:async J=>{const ee=await kW({...J,token:e});if(ee.data!==void 0)return ee.data},getPaymentUrlFromApi:async J=>{const ee=await zW({...J,token:e});if(ee.data!==void 0)return ee.data},deletePaymentMethodFromApi:async J=>(await BW({...J,token:e})).error}},HW=()=>{const{getStationsFromApi:e}=X0(),{stationFilters:t,setStations:a,position:o}=Ie.useContext(Bo),[h,y]=Ie.useState(!0);return Ie.useEffect(()=>{if(!t.shouldUpdateStations){y(!1);return}e(i5(t,o)).then(i=>{a(i)}).finally(()=>y(!1))},[]),{getByOffsetAndLimit:(i,C)=>e({...i5(t),offset:i,limit:C}),loading:h}};var T1;(e=>{e.PREVIOUS_PAGE="prev_page"})(T1||(T1={}));var zg;(e=>{e.MAIN="main",e.STATIONS_LIST="stations_list"})(zg||(zg={}));var E1;(e=>{e.PREVIOUS_PAGE="prev_page"})(E1||(E1={}));var A1;(e=>{e.MAIN="main",e.SESSIONS_LIST="sessions_list"})(A1||(A1={}));var Hd;(e=>{e.PREVIOUS_PAGE="prev_page",e.FROM_CHARGING_SESSION_ID="from_charging_session_id"})(Hd||(Hd={}));var Vd;(e=>{e.MAIN="main",e.STATIONS_LIST="stations_list",e.ACTIVE_SESSION="active_session",e.SESSIONS_LIST="sessions_list"})(Vd||(Vd={}));const ZW="_listLayout__list_1bmnb_1",WW="_list__item_1bmnb_5",XW="_listLayout__blockButton_1bmnb_9",YW="_list_noSelection_1bmnb_15",Ux={listLayout__list:ZW,list__item:WW,listLayout__blockButton:XW,list_noSelection:YW},KW=(e,t)=>e==="fill"&&t?"fillWithIcon":e==="text"&&t?"textWithIcon":e,JW="_button_zodu3_1",QW="_outlined_zodu3_22",eX="_fill_zodu3_27",tX="_fillWithIcon_zodu3_32",nX="_icon_zodu3_37",rX="_iconSmall_zodu3_43",iX="_text_zodu3_49",aX="_textWithIcon_zodu3_57",oX="_outlinedDisabled_zodu3_119",sX="_fillDisabled_zodu3_120",lX="_fillWithIconDisabled_zodu3_121",cX="_iconDisabled_zodu3_122",uX="_iconSmallDisabled_zodu3_123",hX="_textDisabled_zodu3_124",fX="_textWithIconDisabled_zodu3_125",yT={button:JW,outlined:QW,fill:eX,fillWithIcon:tX,icon:nX,iconSmall:rX,text:iX,textWithIcon:aX,outlinedDisabled:oX,fillDisabled:sX,fillWithIconDisabled:lX,iconDisabled:cX,iconSmallDisabled:uX,textDisabled:hX,textWithIconDisabled:fX};function vf(e){const t=()=>{!e.loading&&!e.disabled&&e.onClick()},a=KW(e.variant,!!e.iconSrc);return ve.jsxs("button",{onClick:t,disabled:e.disabled,className:`${yT.button} ${yT[a]} ${e.disabled?yT[a+"Disabled"]:""}`,children:[e.iconSrc&&!e.loading&&ve.jsx("img",{src:e.iconSrc,alt:"Icon"}),e.text&&!a.startsWith("icon")&&ve.jsx("a",{children:e.text})]})}var vT={exports:{}},xT,O6;function dX(){if(O6)return xT;O6=1;var e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return xT=e,xT}var bT,P6;function pX(){if(P6)return bT;P6=1;var e=dX();function t(){}function a(){}return a.resetWarningCache=t,bT=function(){function o(b,i,C,I,j,F){if(F!==e){var G=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw G.name="Invariant Violation",G}}o.isRequired=o;function h(){return o}var y={array:o,bigint:o,bool:o,func:o,number:o,object:o,string:o,symbol:o,any:o,arrayOf:h,element:o,elementType:o,instanceOf:h,node:o,objectOf:h,oneOf:h,oneOfType:h,shape:h,exact:h,checkPropTypes:a,resetWarningCache:t};return y.PropTypes=y,y},bT}var I6;function mX(){return I6||(I6=1,vT.exports=pX()()),vT.exports}var _X=mX();const wi=Ei(_X);function $N(e){var t,a,o="";if(typeof e=="string"||typeof e=="number")o+=e;else if(typeof e=="object")if(Array.isArray(e)){var h=e.length;for(t=0;t<h;t++)e[t]&&(a=$N(e[t]))&&(o&&(o+=" "),o+=a)}else for(a in e)e[a]&&(o&&(o+=" "),o+=a);return o}function oi(){for(var e,t,a=0,o="",h=arguments.length;a<h;a++)(e=arguments[a])&&(t=$N(e))&&(o&&(o+=" "),o+=t);return o}function gX(e,t,a=void 0){const o={};for(const h in e){const y=e[h];let b="",i=!0;for(let C=0;C<y.length;C+=1){const I=y[C];I&&(b+=(i===!0?"":" ")+t(I),i=!1,a&&a[I]&&(b+=" "+a[I]))}o[h]=b}return o}function q0(e,...t){const a=new URL(`https://mui.com/production-error/?code=${e}`);return t.forEach(o=>a.searchParams.append("args[]",o)),`Minified MUI error #${e}; visit ${a} for the full message.`}function Bg(e){if(typeof e!="string")throw new Error(q0(7));return e.charAt(0).toUpperCase()+e.slice(1)}var wT={exports:{}},Li={};/**
 * @license React
 * react-is.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var R6;function yX(){if(R6)return Li;R6=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),h=Symbol.for("react.profiler"),y=Symbol.for("react.consumer"),b=Symbol.for("react.context"),i=Symbol.for("react.forward_ref"),C=Symbol.for("react.suspense"),I=Symbol.for("react.suspense_list"),j=Symbol.for("react.memo"),F=Symbol.for("react.lazy"),G=Symbol.for("react.offscreen"),X=Symbol.for("react.client.reference");function Y(J){if(typeof J=="object"&&J!==null){var ee=J.$$typeof;switch(ee){case e:switch(J=J.type,J){case a:case h:case o:case C:case I:return J;default:switch(J=J&&J.$$typeof,J){case b:case i:case F:case j:return J;case y:return J;default:return ee}}case t:return ee}}}return Li.ContextConsumer=y,Li.ContextProvider=b,Li.Element=e,Li.ForwardRef=i,Li.Fragment=a,Li.Lazy=F,Li.Memo=j,Li.Portal=t,Li.Profiler=h,Li.StrictMode=o,Li.Suspense=C,Li.SuspenseList=I,Li.isContextConsumer=function(J){return Y(J)===y},Li.isContextProvider=function(J){return Y(J)===b},Li.isElement=function(J){return typeof J=="object"&&J!==null&&J.$$typeof===e},Li.isForwardRef=function(J){return Y(J)===i},Li.isFragment=function(J){return Y(J)===a},Li.isLazy=function(J){return Y(J)===F},Li.isMemo=function(J){return Y(J)===j},Li.isPortal=function(J){return Y(J)===t},Li.isProfiler=function(J){return Y(J)===h},Li.isStrictMode=function(J){return Y(J)===o},Li.isSuspense=function(J){return Y(J)===C},Li.isSuspenseList=function(J){return Y(J)===I},Li.isValidElementType=function(J){return typeof J=="string"||typeof J=="function"||J===a||J===h||J===o||J===C||J===I||J===G||typeof J=="object"&&J!==null&&(J.$$typeof===F||J.$$typeof===j||J.$$typeof===b||J.$$typeof===y||J.$$typeof===i||J.$$typeof===X||J.getModuleId!==void 0)},Li.typeOf=Y,Li}var D6;function vX(){return D6||(D6=1,wT.exports=yX()),wT.exports}var qN=vX();function zd(e){if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function GN(e){if(Ie.isValidElement(e)||qN.isValidElementType(e)||!zd(e))return e;const t={};return Object.keys(e).forEach(a=>{t[a]=GN(e[a])}),t}function oc(e,t,a={clone:!0}){const o=a.clone?{...e}:e;return zd(e)&&zd(t)&&Object.keys(t).forEach(h=>{Ie.isValidElement(t[h])||qN.isValidElementType(t[h])?o[h]=t[h]:zd(t[h])&&Object.prototype.hasOwnProperty.call(e,h)&&zd(e[h])?o[h]=oc(e[h],t[h],a):a.clone?o[h]=zd(t[h])?GN(t[h]):t[h]:o[h]=t[h]}),o}function f1(e,t){return t?oc(e,t,{clone:!1}):e}function xX(e,t){if(!e.containerQueries)return t;const a=Object.keys(t).filter(o=>o.startsWith("@container")).sort((o,h)=>{var b,i;const y=/min-width:\s*([0-9.]+)/;return+(((b=o.match(y))==null?void 0:b[1])||0)-+(((i=h.match(y))==null?void 0:i[1])||0)});return a.length?a.reduce((o,h)=>{const y=t[h];return delete o[h],o[h]=y,o},{...t}):t}function bX(e,t){return t==="@"||t.startsWith("@")&&(e.some(a=>t.startsWith(`@${a}`))||!!t.match(/^@\d/))}function wX(e,t){const a=t.match(/^@([^/]+)?\/?(.+)?$/);if(!a)return null;const[,o,h]=a,y=Number.isNaN(+o)?o||0:+o;return e.containerQueries(h).up(y)}function SX(e){const t=(y,b)=>y.replace("@media",b?`@container ${b}`:"@container");function a(y,b){y.up=(...i)=>t(e.breakpoints.up(...i),b),y.down=(...i)=>t(e.breakpoints.down(...i),b),y.between=(...i)=>t(e.breakpoints.between(...i),b),y.only=(...i)=>t(e.breakpoints.only(...i),b),y.not=(...i)=>{const C=t(e.breakpoints.not(...i),b);return C.includes("not all and")?C.replace("not all and ","").replace("min-width:","width<").replace("max-width:","width>").replace("and","or"):C}}const o={},h=y=>(a(o,y),o);return a(h),{...e,containerQueries:h}}const Fw={xs:0,sm:600,md:900,lg:1200,xl:1536},L6={keys:["xs","sm","md","lg","xl"],up:e=>`@media (min-width:${Fw[e]}px)`},TX={containerQueries:e=>({up:t=>{let a=typeof t=="number"?t:Fw[t]||t;return typeof a=="number"&&(a=`${a}px`),e?`@container ${e} (min-width:${a})`:`@container (min-width:${a})`}})};function Zd(e,t,a){const o=e.theme||{};if(Array.isArray(t)){const y=o.breakpoints||L6;return t.reduce((b,i,C)=>(b[y.up(y.keys[C])]=a(t[C]),b),{})}if(typeof t=="object"){const y=o.breakpoints||L6;return Object.keys(t).reduce((b,i)=>{if(bX(y.keys,i)){const C=wX(o.containerQueries?o:TX,i);C&&(b[C]=a(t[i],i))}else if(Object.keys(y.values||Fw).includes(i)){const C=y.up(i);b[C]=a(t[i],i)}else{const C=i;b[C]=t[C]}return b},{})}return a(t)}function EX(e={}){var a;return((a=e.keys)==null?void 0:a.reduce((o,h)=>{const y=e.up(h);return o[y]={},o},{}))||{}}function AX(e,t){return e.reduce((a,o)=>{const h=a[o];return(!h||Object.keys(h).length===0)&&delete a[o],a},t)}function jw(e,t,a=!0){if(!t||typeof t!="string")return null;if(e&&e.vars&&a){const o=`vars.${t}`.split(".").reduce((h,y)=>h&&h[y]?h[y]:null,e);if(o!=null)return o}return t.split(".").reduce((o,h)=>o&&o[h]!=null?o[h]:null,e)}function Lb(e,t,a,o=a){let h;return typeof e=="function"?h=e(a):Array.isArray(e)?h=e[a]||o:h=jw(e,a)||o,t&&(h=t(h,o,e)),h}function Qa(e){const{prop:t,cssProperty:a=e.prop,themeKey:o,transform:h}=e,y=b=>{if(b[t]==null)return null;const i=b[t],C=b.theme,I=jw(C,o)||{};return Zd(b,i,F=>{let G=Lb(I,h,F);return F===G&&typeof F=="string"&&(G=Lb(I,h,`${t}${F==="default"?"":Bg(F)}`,F)),a===!1?G:{[a]:G}})};return y.propTypes={},y.filterProps=[t],y}function CX(e){const t={};return a=>(t[a]===void 0&&(t[a]=e(a)),t[a])}const MX={m:"margin",p:"padding"},OX={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},k6={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},PX=CX(e=>{if(e.length>2)if(k6[e])e=k6[e];else return[e];const[t,a]=e.split(""),o=MX[t],h=OX[a]||"";return Array.isArray(h)?h.map(y=>o+y):[o+h]}),lO=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],cO=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"];[...lO,...cO];function y2(e,t,a,o){const h=jw(e,t,!0)??a;return typeof h=="number"||typeof h=="string"?y=>typeof y=="string"?y:typeof h=="string"?`calc(${y} * ${h})`:h*y:Array.isArray(h)?y=>{if(typeof y=="string")return y;const b=Math.abs(y),i=h[b];return y>=0?i:typeof i=="number"?-i:`-${i}`}:typeof h=="function"?h:()=>{}}function uO(e){return y2(e,"spacing",8)}function v2(e,t){return typeof t=="string"||t==null?t:e(t)}function IX(e,t){return a=>e.reduce((o,h)=>(o[h]=v2(t,a),o),{})}function RX(e,t,a,o){if(!t.includes(a))return null;const h=PX(a),y=IX(h,o),b=e[a];return Zd(e,b,y)}function HN(e,t){const a=uO(e.theme);return Object.keys(e).map(o=>RX(e,t,o,a)).reduce(f1,{})}function Va(e){return HN(e,lO)}Va.propTypes={};Va.filterProps=lO;function $a(e){return HN(e,cO)}$a.propTypes={};$a.filterProps=cO;function Uw(...e){const t=e.reduce((o,h)=>(h.filterProps.forEach(y=>{o[y]=h}),o),{}),a=o=>Object.keys(o).reduce((h,y)=>t[y]?f1(h,t[y](o)):h,{});return a.propTypes={},a.filterProps=e.reduce((o,h)=>o.concat(h.filterProps),[]),a}function ou(e){return typeof e!="number"?e:`${e}px solid`}function du(e,t){return Qa({prop:e,themeKey:"borders",transform:t})}const DX=du("border",ou),LX=du("borderTop",ou),kX=du("borderRight",ou),zX=du("borderBottom",ou),BX=du("borderLeft",ou),NX=du("borderColor"),FX=du("borderTopColor"),jX=du("borderRightColor"),UX=du("borderBottomColor"),VX=du("borderLeftColor"),$X=du("outline",ou),qX=du("outlineColor"),Vw=e=>{if(e.borderRadius!==void 0&&e.borderRadius!==null){const t=y2(e.theme,"shape.borderRadius",4),a=o=>({borderRadius:v2(t,o)});return Zd(e,e.borderRadius,a)}return null};Vw.propTypes={};Vw.filterProps=["borderRadius"];Uw(DX,LX,kX,zX,BX,NX,FX,jX,UX,VX,Vw,$X,qX);const $w=e=>{if(e.gap!==void 0&&e.gap!==null){const t=y2(e.theme,"spacing",8),a=o=>({gap:v2(t,o)});return Zd(e,e.gap,a)}return null};$w.propTypes={};$w.filterProps=["gap"];const qw=e=>{if(e.columnGap!==void 0&&e.columnGap!==null){const t=y2(e.theme,"spacing",8),a=o=>({columnGap:v2(t,o)});return Zd(e,e.columnGap,a)}return null};qw.propTypes={};qw.filterProps=["columnGap"];const Gw=e=>{if(e.rowGap!==void 0&&e.rowGap!==null){const t=y2(e.theme,"spacing",8),a=o=>({rowGap:v2(t,o)});return Zd(e,e.rowGap,a)}return null};Gw.propTypes={};Gw.filterProps=["rowGap"];const GX=Qa({prop:"gridColumn"}),HX=Qa({prop:"gridRow"}),ZX=Qa({prop:"gridAutoFlow"}),WX=Qa({prop:"gridAutoColumns"}),XX=Qa({prop:"gridAutoRows"}),YX=Qa({prop:"gridTemplateColumns"}),KX=Qa({prop:"gridTemplateRows"}),JX=Qa({prop:"gridTemplateAreas"}),QX=Qa({prop:"gridArea"});Uw($w,qw,Gw,GX,HX,ZX,WX,XX,YX,KX,JX,QX);function Pg(e,t){return t==="grey"?t:e}const eY=Qa({prop:"color",themeKey:"palette",transform:Pg}),tY=Qa({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:Pg}),nY=Qa({prop:"backgroundColor",themeKey:"palette",transform:Pg});Uw(eY,tY,nY);function rc(e){return e<=1&&e!==0?`${e*100}%`:e}const rY=Qa({prop:"width",transform:rc}),hO=e=>{if(e.maxWidth!==void 0&&e.maxWidth!==null){const t=a=>{var h,y,b,i,C;const o=((b=(y=(h=e.theme)==null?void 0:h.breakpoints)==null?void 0:y.values)==null?void 0:b[a])||Fw[a];return o?((C=(i=e.theme)==null?void 0:i.breakpoints)==null?void 0:C.unit)!=="px"?{maxWidth:`${o}${e.theme.breakpoints.unit}`}:{maxWidth:o}:{maxWidth:rc(a)}};return Zd(e,e.maxWidth,t)}return null};hO.filterProps=["maxWidth"];const iY=Qa({prop:"minWidth",transform:rc}),aY=Qa({prop:"height",transform:rc}),oY=Qa({prop:"maxHeight",transform:rc}),sY=Qa({prop:"minHeight",transform:rc});Qa({prop:"size",cssProperty:"width",transform:rc});Qa({prop:"size",cssProperty:"height",transform:rc});const lY=Qa({prop:"boxSizing"});Uw(rY,hO,iY,aY,oY,sY,lY);const Hw={border:{themeKey:"borders",transform:ou},borderTop:{themeKey:"borders",transform:ou},borderRight:{themeKey:"borders",transform:ou},borderBottom:{themeKey:"borders",transform:ou},borderLeft:{themeKey:"borders",transform:ou},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},outline:{themeKey:"borders",transform:ou},outlineColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:Vw},color:{themeKey:"palette",transform:Pg},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:Pg},backgroundColor:{themeKey:"palette",transform:Pg},p:{style:$a},pt:{style:$a},pr:{style:$a},pb:{style:$a},pl:{style:$a},px:{style:$a},py:{style:$a},padding:{style:$a},paddingTop:{style:$a},paddingRight:{style:$a},paddingBottom:{style:$a},paddingLeft:{style:$a},paddingX:{style:$a},paddingY:{style:$a},paddingInline:{style:$a},paddingInlineStart:{style:$a},paddingInlineEnd:{style:$a},paddingBlock:{style:$a},paddingBlockStart:{style:$a},paddingBlockEnd:{style:$a},m:{style:Va},mt:{style:Va},mr:{style:Va},mb:{style:Va},ml:{style:Va},mx:{style:Va},my:{style:Va},margin:{style:Va},marginTop:{style:Va},marginRight:{style:Va},marginBottom:{style:Va},marginLeft:{style:Va},marginX:{style:Va},marginY:{style:Va},marginInline:{style:Va},marginInlineStart:{style:Va},marginInlineEnd:{style:Va},marginBlock:{style:Va},marginBlockStart:{style:Va},marginBlockEnd:{style:Va},displayPrint:{cssProperty:!1,transform:e=>({"@media print":{display:e}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:$w},rowGap:{style:Gw},columnGap:{style:qw},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:rc},maxWidth:{style:hO},minWidth:{transform:rc},height:{transform:rc},maxHeight:{transform:rc},minHeight:{transform:rc},boxSizing:{},font:{themeKey:"font"},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}};function cY(...e){const t=e.reduce((o,h)=>o.concat(Object.keys(h)),[]),a=new Set(t);return e.every(o=>a.size===Object.keys(o).length)}function uY(e,t){return typeof e=="function"?e(t):e}function hY(){function e(a,o,h,y){const b={[a]:o,theme:h},i=y[a];if(!i)return{[a]:o};const{cssProperty:C=a,themeKey:I,transform:j,style:F}=i;if(o==null)return null;if(I==="typography"&&o==="inherit")return{[a]:o};const G=jw(h,I)||{};return F?F(b):Zd(b,o,Y=>{let J=Lb(G,j,Y);return Y===J&&typeof Y=="string"&&(J=Lb(G,j,`${a}${Y==="default"?"":Bg(Y)}`,Y)),C===!1?J:{[C]:J}})}function t(a){const{sx:o,theme:h={}}=a||{};if(!o)return null;const y=h.unstable_sxConfig??Hw;function b(i){let C=i;if(typeof i=="function")C=i(h);else if(typeof i!="object")return i;if(!C)return null;const I=EX(h.breakpoints),j=Object.keys(I);let F=I;return Object.keys(C).forEach(G=>{const X=uY(C[G],h);if(X!=null)if(typeof X=="object")if(y[G])F=f1(F,e(G,X,h,y));else{const Y=Zd({theme:h},X,J=>({[G]:J}));cY(Y,X)?F[G]=t({sx:X,theme:h}):F=f1(F,Y)}else F=f1(F,e(G,X,h,y))}),xX(h,AX(j,F))}return Array.isArray(o)?o.map(b):b(o)}return t}const Ng=hY();Ng.filterProps=["sx"];function a5(){return a5=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)({}).hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},a5.apply(null,arguments)}function fY(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]}function dY(e){var t=document.createElement("style");return t.setAttribute("data-emotion",e.key),e.nonce!==void 0&&t.setAttribute("nonce",e.nonce),t.appendChild(document.createTextNode("")),t.setAttribute("data-s",""),t}var pY=function(){function e(a){var o=this;this._insertTag=function(h){var y;o.tags.length===0?o.insertionPoint?y=o.insertionPoint.nextSibling:o.prepend?y=o.container.firstChild:y=o.before:y=o.tags[o.tags.length-1].nextSibling,o.container.insertBefore(h,y),o.tags.push(h)},this.isSpeedy=a.speedy===void 0?!0:a.speedy,this.tags=[],this.ctr=0,this.nonce=a.nonce,this.key=a.key,this.container=a.container,this.prepend=a.prepend,this.insertionPoint=a.insertionPoint,this.before=null}var t=e.prototype;return t.hydrate=function(o){o.forEach(this._insertTag)},t.insert=function(o){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(dY(this));var h=this.tags[this.tags.length-1];if(this.isSpeedy){var y=fY(h);try{y.insertRule(o,y.cssRules.length)}catch{}}else h.appendChild(document.createTextNode(o));this.ctr++},t.flush=function(){this.tags.forEach(function(o){var h;return(h=o.parentNode)==null?void 0:h.removeChild(o)}),this.tags=[],this.ctr=0},e}(),Ms="-ms-",kb="-moz-",_i="-webkit-",ZN="comm",fO="rule",dO="decl",mY="@import",WN="@keyframes",_Y="@layer",gY=Math.abs,Zw=String.fromCharCode,yY=Object.assign;function vY(e,t){return ns(e,0)^45?(((t<<2^ns(e,0))<<2^ns(e,1))<<2^ns(e,2))<<2^ns(e,3):0}function XN(e){return e.trim()}function xY(e,t){return(e=t.exec(e))?e[0]:e}function gi(e,t,a){return e.replace(t,a)}function o5(e,t){return e.indexOf(t)}function ns(e,t){return e.charCodeAt(t)|0}function C1(e,t,a){return e.slice(t,a)}function ff(e){return e.length}function pO(e){return e.length}function Vx(e,t){return t.push(e),e}function bY(e,t){return e.map(t).join("")}var Ww=1,Fg=1,YN=0,xl=0,so=0,py="";function Xw(e,t,a,o,h,y,b){return{value:e,root:t,parent:a,type:o,props:h,children:y,line:Ww,column:Fg,length:b,return:""}}function Dv(e,t){return yY(Xw("",null,null,"",null,null,0),e,{length:-e.length},t)}function wY(){return so}function SY(){return so=xl>0?ns(py,--xl):0,Fg--,so===10&&(Fg=1,Ww--),so}function sc(){return so=xl<YN?ns(py,xl++):0,Fg++,so===10&&(Fg=1,Ww++),so}function mf(){return ns(py,xl)}function wb(){return xl}function x2(e,t){return C1(py,e,t)}function M1(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function KN(e){return Ww=Fg=1,YN=ff(py=e),xl=0,[]}function JN(e){return py="",e}function Sb(e){return XN(x2(xl-1,s5(e===91?e+2:e===40?e+1:e)))}function TY(e){for(;(so=mf())&&so<33;)sc();return M1(e)>2||M1(so)>3?"":" "}function EY(e,t){for(;--t&&sc()&&!(so<48||so>102||so>57&&so<65||so>70&&so<97););return x2(e,wb()+(t<6&&mf()==32&&sc()==32))}function s5(e){for(;sc();)switch(so){case e:return xl;case 34:case 39:e!==34&&e!==39&&s5(so);break;case 40:e===41&&s5(e);break;case 92:sc();break}return xl}function AY(e,t){for(;sc()&&e+so!==57;)if(e+so===84&&mf()===47)break;return"/*"+x2(t,xl-1)+"*"+Zw(e===47?e:sc())}function CY(e){for(;!M1(mf());)sc();return x2(e,xl)}function MY(e){return JN(Tb("",null,null,null,[""],e=KN(e),0,[0],e))}function Tb(e,t,a,o,h,y,b,i,C){for(var I=0,j=0,F=b,G=0,X=0,Y=0,J=1,ee=1,oe=1,ge=0,fe="",xe=h,ae=y,me=o,we=fe;ee;)switch(Y=ge,ge=sc()){case 40:if(Y!=108&&ns(we,F-1)==58){o5(we+=gi(Sb(ge),"&","&\f"),"&\f")!=-1&&(oe=-1);break}case 34:case 39:case 91:we+=Sb(ge);break;case 9:case 10:case 13:case 32:we+=TY(Y);break;case 92:we+=EY(wb()-1,7);continue;case 47:switch(mf()){case 42:case 47:Vx(OY(AY(sc(),wb()),t,a),C);break;default:we+="/"}break;case 123*J:i[I++]=ff(we)*oe;case 125*J:case 59:case 0:switch(ge){case 0:case 125:ee=0;case 59+j:oe==-1&&(we=gi(we,/\f/g,"")),X>0&&ff(we)-F&&Vx(X>32?B6(we+";",o,a,F-1):B6(gi(we," ","")+";",o,a,F-2),C);break;case 59:we+=";";default:if(Vx(me=z6(we,t,a,I,j,h,i,fe,xe=[],ae=[],F),y),ge===123)if(j===0)Tb(we,t,me,me,xe,y,F,i,ae);else switch(G===99&&ns(we,3)===110?100:G){case 100:case 108:case 109:case 115:Tb(e,me,me,o&&Vx(z6(e,me,me,0,0,h,i,fe,h,xe=[],F),ae),h,ae,F,i,o?xe:ae);break;default:Tb(we,me,me,me,[""],ae,0,i,ae)}}I=j=X=0,J=oe=1,fe=we="",F=b;break;case 58:F=1+ff(we),X=Y;default:if(J<1){if(ge==123)--J;else if(ge==125&&J++==0&&SY()==125)continue}switch(we+=Zw(ge),ge*J){case 38:oe=j>0?1:(we+="\f",-1);break;case 44:i[I++]=(ff(we)-1)*oe,oe=1;break;case 64:mf()===45&&(we+=Sb(sc())),G=mf(),j=F=ff(fe=we+=CY(wb())),ge++;break;case 45:Y===45&&ff(we)==2&&(J=0)}}return y}function z6(e,t,a,o,h,y,b,i,C,I,j){for(var F=h-1,G=h===0?y:[""],X=pO(G),Y=0,J=0,ee=0;Y<o;++Y)for(var oe=0,ge=C1(e,F+1,F=gY(J=b[Y])),fe=e;oe<X;++oe)(fe=XN(J>0?G[oe]+" "+ge:gi(ge,/&\f/g,G[oe])))&&(C[ee++]=fe);return Xw(e,t,a,h===0?fO:i,C,I,j)}function OY(e,t,a){return Xw(e,t,a,ZN,Zw(wY()),C1(e,2,-2),0)}function B6(e,t,a,o){return Xw(e,t,a,dO,C1(e,0,o),C1(e,o+1,-1),o)}function Ig(e,t){for(var a="",o=pO(e),h=0;h<o;h++)a+=t(e[h],h,e,t)||"";return a}function PY(e,t,a,o){switch(e.type){case _Y:if(e.children.length)break;case mY:case dO:return e.return=e.return||e.value;case ZN:return"";case WN:return e.return=e.value+"{"+Ig(e.children,o)+"}";case fO:e.value=e.props.join(",")}return ff(a=Ig(e.children,o))?e.return=e.value+"{"+a+"}":""}function IY(e){var t=pO(e);return function(a,o,h,y){for(var b="",i=0;i<t;i++)b+=e[i](a,o,h,y)||"";return b}}function RY(e){return function(t){t.root||(t=t.return)&&e(t)}}function QN(e){var t=Object.create(null);return function(a){return t[a]===void 0&&(t[a]=e(a)),t[a]}}var DY=function(t,a,o){for(var h=0,y=0;h=y,y=mf(),h===38&&y===12&&(a[o]=1),!M1(y);)sc();return x2(t,xl)},LY=function(t,a){var o=-1,h=44;do switch(M1(h)){case 0:h===38&&mf()===12&&(a[o]=1),t[o]+=DY(xl-1,a,o);break;case 2:t[o]+=Sb(h);break;case 4:if(h===44){t[++o]=mf()===58?"&\f":"",a[o]=t[o].length;break}default:t[o]+=Zw(h)}while(h=sc());return t},kY=function(t,a){return JN(LY(KN(t),a))},N6=new WeakMap,zY=function(t){if(!(t.type!=="rule"||!t.parent||t.length<1)){for(var a=t.value,o=t.parent,h=t.column===o.column&&t.line===o.line;o.type!=="rule";)if(o=o.parent,!o)return;if(!(t.props.length===1&&a.charCodeAt(0)!==58&&!N6.get(o))&&!h){N6.set(t,!0);for(var y=[],b=kY(a,y),i=o.props,C=0,I=0;C<b.length;C++)for(var j=0;j<i.length;j++,I++)t.props[I]=y[C]?b[C].replace(/&\f/g,i[j]):i[j]+" "+b[C]}}},BY=function(t){if(t.type==="decl"){var a=t.value;a.charCodeAt(0)===108&&a.charCodeAt(2)===98&&(t.return="",t.value="")}};function eF(e,t){switch(vY(e,t)){case 5103:return _i+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return _i+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return _i+e+kb+e+Ms+e+e;case 6828:case 4268:return _i+e+Ms+e+e;case 6165:return _i+e+Ms+"flex-"+e+e;case 5187:return _i+e+gi(e,/(\w+).+(:[^]+)/,_i+"box-$1$2"+Ms+"flex-$1$2")+e;case 5443:return _i+e+Ms+"flex-item-"+gi(e,/flex-|-self/,"")+e;case 4675:return _i+e+Ms+"flex-line-pack"+gi(e,/align-content|flex-|-self/,"")+e;case 5548:return _i+e+Ms+gi(e,"shrink","negative")+e;case 5292:return _i+e+Ms+gi(e,"basis","preferred-size")+e;case 6060:return _i+"box-"+gi(e,"-grow","")+_i+e+Ms+gi(e,"grow","positive")+e;case 4554:return _i+gi(e,/([^-])(transform)/g,"$1"+_i+"$2")+e;case 6187:return gi(gi(gi(e,/(zoom-|grab)/,_i+"$1"),/(image-set)/,_i+"$1"),e,"")+e;case 5495:case 3959:return gi(e,/(image-set\([^]*)/,_i+"$1$`$1");case 4968:return gi(gi(e,/(.+:)(flex-)?(.*)/,_i+"box-pack:$3"+Ms+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+_i+e+e;case 4095:case 3583:case 4068:case 2532:return gi(e,/(.+)-inline(.+)/,_i+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(ff(e)-1-t>6)switch(ns(e,t+1)){case 109:if(ns(e,t+4)!==45)break;case 102:return gi(e,/(.+:)(.+)-([^]+)/,"$1"+_i+"$2-$3$1"+kb+(ns(e,t+3)==108?"$3":"$2-$3"))+e;case 115:return~o5(e,"stretch")?eF(gi(e,"stretch","fill-available"),t)+e:e}break;case 4949:if(ns(e,t+1)!==115)break;case 6444:switch(ns(e,ff(e)-3-(~o5(e,"!important")&&10))){case 107:return gi(e,":",":"+_i)+e;case 101:return gi(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+_i+(ns(e,14)===45?"inline-":"")+"box$3$1"+_i+"$2$3$1"+Ms+"$2box$3")+e}break;case 5936:switch(ns(e,t+11)){case 114:return _i+e+Ms+gi(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return _i+e+Ms+gi(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return _i+e+Ms+gi(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return _i+e+Ms+e+e}return e}var NY=function(t,a,o,h){if(t.length>-1&&!t.return)switch(t.type){case dO:t.return=eF(t.value,t.length);break;case WN:return Ig([Dv(t,{value:gi(t.value,"@","@"+_i)})],h);case fO:if(t.length)return bY(t.props,function(y){switch(xY(y,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return Ig([Dv(t,{props:[gi(y,/:(read-\w+)/,":"+kb+"$1")]})],h);case"::placeholder":return Ig([Dv(t,{props:[gi(y,/:(plac\w+)/,":"+_i+"input-$1")]}),Dv(t,{props:[gi(y,/:(plac\w+)/,":"+kb+"$1")]}),Dv(t,{props:[gi(y,/:(plac\w+)/,Ms+"input-$1")]})],h)}return""})}},FY=[NY],jY=function(t){var a=t.key;if(a==="css"){var o=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(o,function(J){var ee=J.getAttribute("data-emotion");ee.indexOf(" ")!==-1&&(document.head.appendChild(J),J.setAttribute("data-s",""))})}var h=t.stylisPlugins||FY,y={},b,i=[];b=t.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+a+' "]'),function(J){for(var ee=J.getAttribute("data-emotion").split(" "),oe=1;oe<ee.length;oe++)y[ee[oe]]=!0;i.push(J)});var C,I=[zY,BY];{var j,F=[PY,RY(function(J){j.insert(J)})],G=IY(I.concat(h,F)),X=function(ee){return Ig(MY(ee),G)};C=function(ee,oe,ge,fe){j=ge,X(ee?ee+"{"+oe.styles+"}":oe.styles),fe&&(Y.inserted[oe.name]=!0)}}var Y={key:a,sheet:new pY({key:a,container:b,nonce:t.nonce,speedy:t.speedy,prepend:t.prepend,insertionPoint:t.insertionPoint}),nonce:t.nonce,inserted:y,registered:{},insert:C};return Y.sheet.hydrate(i),Y},ST={exports:{}},Si={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var F6;function UY(){if(F6)return Si;F6=1;var e=typeof Symbol=="function"&&Symbol.for,t=e?Symbol.for("react.element"):60103,a=e?Symbol.for("react.portal"):60106,o=e?Symbol.for("react.fragment"):60107,h=e?Symbol.for("react.strict_mode"):60108,y=e?Symbol.for("react.profiler"):60114,b=e?Symbol.for("react.provider"):60109,i=e?Symbol.for("react.context"):60110,C=e?Symbol.for("react.async_mode"):60111,I=e?Symbol.for("react.concurrent_mode"):60111,j=e?Symbol.for("react.forward_ref"):60112,F=e?Symbol.for("react.suspense"):60113,G=e?Symbol.for("react.suspense_list"):60120,X=e?Symbol.for("react.memo"):60115,Y=e?Symbol.for("react.lazy"):60116,J=e?Symbol.for("react.block"):60121,ee=e?Symbol.for("react.fundamental"):60117,oe=e?Symbol.for("react.responder"):60118,ge=e?Symbol.for("react.scope"):60119;function fe(ae){if(typeof ae=="object"&&ae!==null){var me=ae.$$typeof;switch(me){case t:switch(ae=ae.type,ae){case C:case I:case o:case y:case h:case F:return ae;default:switch(ae=ae&&ae.$$typeof,ae){case i:case j:case Y:case X:case b:return ae;default:return me}}case a:return me}}}function xe(ae){return fe(ae)===I}return Si.AsyncMode=C,Si.ConcurrentMode=I,Si.ContextConsumer=i,Si.ContextProvider=b,Si.Element=t,Si.ForwardRef=j,Si.Fragment=o,Si.Lazy=Y,Si.Memo=X,Si.Portal=a,Si.Profiler=y,Si.StrictMode=h,Si.Suspense=F,Si.isAsyncMode=function(ae){return xe(ae)||fe(ae)===C},Si.isConcurrentMode=xe,Si.isContextConsumer=function(ae){return fe(ae)===i},Si.isContextProvider=function(ae){return fe(ae)===b},Si.isElement=function(ae){return typeof ae=="object"&&ae!==null&&ae.$$typeof===t},Si.isForwardRef=function(ae){return fe(ae)===j},Si.isFragment=function(ae){return fe(ae)===o},Si.isLazy=function(ae){return fe(ae)===Y},Si.isMemo=function(ae){return fe(ae)===X},Si.isPortal=function(ae){return fe(ae)===a},Si.isProfiler=function(ae){return fe(ae)===y},Si.isStrictMode=function(ae){return fe(ae)===h},Si.isSuspense=function(ae){return fe(ae)===F},Si.isValidElementType=function(ae){return typeof ae=="string"||typeof ae=="function"||ae===o||ae===I||ae===y||ae===h||ae===F||ae===G||typeof ae=="object"&&ae!==null&&(ae.$$typeof===Y||ae.$$typeof===X||ae.$$typeof===b||ae.$$typeof===i||ae.$$typeof===j||ae.$$typeof===ee||ae.$$typeof===oe||ae.$$typeof===ge||ae.$$typeof===J)},Si.typeOf=fe,Si}var j6;function VY(){return j6||(j6=1,ST.exports=UY()),ST.exports}var TT,U6;function $Y(){if(U6)return TT;U6=1;var e=VY(),t={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},a={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},o={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},h={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},y={};y[e.ForwardRef]=o,y[e.Memo]=h;function b(Y){return e.isMemo(Y)?h:y[Y.$$typeof]||t}var i=Object.defineProperty,C=Object.getOwnPropertyNames,I=Object.getOwnPropertySymbols,j=Object.getOwnPropertyDescriptor,F=Object.getPrototypeOf,G=Object.prototype;function X(Y,J,ee){if(typeof J!="string"){if(G){var oe=F(J);oe&&oe!==G&&X(Y,oe,ee)}var ge=C(J);I&&(ge=ge.concat(I(J)));for(var fe=b(Y),xe=b(J),ae=0;ae<ge.length;++ae){var me=ge[ae];if(!a[me]&&!(ee&&ee[me])&&!(xe&&xe[me])&&!(fe&&fe[me])){var we=j(J,me);try{i(Y,me,we)}catch{}}}}return Y}return TT=X,TT}$Y();var qY=!0;function tF(e,t,a){var o="";return a.split(" ").forEach(function(h){e[h]!==void 0?t.push(e[h]+";"):h&&(o+=h+" ")}),o}var mO=function(t,a,o){var h=t.key+"-"+a.name;(o===!1||qY===!1)&&t.registered[h]===void 0&&(t.registered[h]=a.styles)},nF=function(t,a,o){mO(t,a,o);var h=t.key+"-"+a.name;if(t.inserted[a.name]===void 0){var y=a;do t.insert(a===y?"."+h:"",y,t.sheet,!0),y=y.next;while(y!==void 0)}};function GY(e){for(var t=0,a,o=0,h=e.length;h>=4;++o,h-=4)a=e.charCodeAt(o)&255|(e.charCodeAt(++o)&255)<<8|(e.charCodeAt(++o)&255)<<16|(e.charCodeAt(++o)&255)<<24,a=(a&65535)*1540483477+((a>>>16)*59797<<16),a^=a>>>24,t=(a&65535)*1540483477+((a>>>16)*59797<<16)^(t&65535)*1540483477+((t>>>16)*59797<<16);switch(h){case 3:t^=(e.charCodeAt(o+2)&255)<<16;case 2:t^=(e.charCodeAt(o+1)&255)<<8;case 1:t^=e.charCodeAt(o)&255,t=(t&65535)*1540483477+((t>>>16)*59797<<16)}return t^=t>>>13,t=(t&65535)*1540483477+((t>>>16)*59797<<16),((t^t>>>15)>>>0).toString(36)}var HY={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},ZY=/[A-Z]|^ms/g,WY=/_EMO_([^_]+?)_([^]*?)_EMO_/g,rF=function(t){return t.charCodeAt(1)===45},V6=function(t){return t!=null&&typeof t!="boolean"},ET=QN(function(e){return rF(e)?e:e.replace(ZY,"-$&").toLowerCase()}),$6=function(t,a){switch(t){case"animation":case"animationName":if(typeof a=="string")return a.replace(WY,function(o,h,y){return df={name:h,styles:y,next:df},h})}return HY[t]!==1&&!rF(t)&&typeof a=="number"&&a!==0?a+"px":a};function O1(e,t,a){if(a==null)return"";var o=a;if(o.__emotion_styles!==void 0)return o;switch(typeof a){case"boolean":return"";case"object":{var h=a;if(h.anim===1)return df={name:h.name,styles:h.styles,next:df},h.name;var y=a;if(y.styles!==void 0){var b=y.next;if(b!==void 0)for(;b!==void 0;)df={name:b.name,styles:b.styles,next:df},b=b.next;var i=y.styles+";";return i}return XY(e,t,a)}case"function":{if(e!==void 0){var C=df,I=a(e);return df=C,O1(e,t,I)}break}}var j=a;if(t==null)return j;var F=t[j];return F!==void 0?F:j}function XY(e,t,a){var o="";if(Array.isArray(a))for(var h=0;h<a.length;h++)o+=O1(e,t,a[h])+";";else for(var y in a){var b=a[y];if(typeof b!="object"){var i=b;t!=null&&t[i]!==void 0?o+=y+"{"+t[i]+"}":V6(i)&&(o+=ET(y)+":"+$6(y,i)+";")}else if(Array.isArray(b)&&typeof b[0]=="string"&&(t==null||t[b[0]]===void 0))for(var C=0;C<b.length;C++)V6(b[C])&&(o+=ET(y)+":"+$6(y,b[C])+";");else{var I=O1(e,t,b);switch(y){case"animation":case"animationName":{o+=ET(y)+":"+I+";";break}default:o+=y+"{"+I+"}"}}}return o}var q6=/label:\s*([^\s;{]+)\s*(;|$)/g,df;function Yw(e,t,a){if(e.length===1&&typeof e[0]=="object"&&e[0]!==null&&e[0].styles!==void 0)return e[0];var o=!0,h="";df=void 0;var y=e[0];if(y==null||y.raw===void 0)o=!1,h+=O1(a,t,y);else{var b=y;h+=b[0]}for(var i=1;i<e.length;i++)if(h+=O1(a,t,e[i]),o){var C=y;h+=C[i]}q6.lastIndex=0;for(var I="",j;(j=q6.exec(h))!==null;)I+="-"+j[1];var F=GY(h)+I;return{name:F,styles:h,next:df}}var YY=function(t){return t()},KY=f6.useInsertionEffect?f6.useInsertionEffect:!1,iF=KY||YY,aF=Ie.createContext(typeof HTMLElement<"u"?jY({key:"css"}):null);aF.Provider;var oF=function(t){return Ie.forwardRef(function(a,o){var h=Ie.useContext(aF);return t(a,h,o)})},sF=Ie.createContext({}),_O={}.hasOwnProperty,l5="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",JY=function(t,a){var o={};for(var h in a)_O.call(a,h)&&(o[h]=a[h]);return o[l5]=t,o},QY=function(t){var a=t.cache,o=t.serialized,h=t.isStringTag;return mO(a,o,h),iF(function(){return nF(a,o,h)}),null},eK=oF(function(e,t,a){var o=e.css;typeof o=="string"&&t.registered[o]!==void 0&&(o=t.registered[o]);var h=e[l5],y=[o],b="";typeof e.className=="string"?b=tF(t.registered,y,e.className):e.className!=null&&(b=e.className+" ");var i=Yw(y,void 0,Ie.useContext(sF));b+=t.key+"-"+i.name;var C={};for(var I in e)_O.call(e,I)&&I!=="css"&&I!==l5&&(C[I]=e[I]);return C.className=b,a&&(C.ref=a),Ie.createElement(Ie.Fragment,null,Ie.createElement(QY,{cache:t,serialized:i,isStringTag:typeof h=="string"}),Ie.createElement(h,C))}),tK=eK,G6=function(t,a){var o=arguments;if(a==null||!_O.call(a,"css"))return Ie.createElement.apply(void 0,o);var h=o.length,y=new Array(h);y[0]=tK,y[1]=JY(t,a);for(var b=2;b<h;b++)y[b]=o[b];return Ie.createElement.apply(null,y)};(function(e){var t;t||(t=e.JSX||(e.JSX={}))})(G6||(G6={}));function gO(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return Yw(t)}function lF(){var e=gO.apply(void 0,arguments),t="animation-"+e.name;return{name:t,styles:"@keyframes "+t+"{"+e.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}var nK=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|disableRemotePlayback|download|draggable|encType|enterKeyHint|fetchpriority|fetchPriority|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,rK=QN(function(e){return nK.test(e)||e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)<91}),iK=rK,aK=function(t){return t!=="theme"},H6=function(t){return typeof t=="string"&&t.charCodeAt(0)>96?iK:aK},Z6=function(t,a,o){var h;if(a){var y=a.shouldForwardProp;h=t.__emotion_forwardProp&&y?function(b){return t.__emotion_forwardProp(b)&&y(b)}:y}return typeof h!="function"&&o&&(h=t.__emotion_forwardProp),h},oK=function(t){var a=t.cache,o=t.serialized,h=t.isStringTag;return mO(a,o,h),iF(function(){return nF(a,o,h)}),null},sK=function e(t,a){var o=t.__emotion_real===t,h=o&&t.__emotion_base||t,y,b;a!==void 0&&(y=a.label,b=a.target);var i=Z6(t,a,o),C=i||H6(h),I=!C("as");return function(){var j=arguments,F=o&&t.__emotion_styles!==void 0?t.__emotion_styles.slice(0):[];if(y!==void 0&&F.push("label:"+y+";"),j[0]==null||j[0].raw===void 0)F.push.apply(F,j);else{var G=j[0];F.push(G[0]);for(var X=j.length,Y=1;Y<X;Y++)F.push(j[Y],G[Y])}var J=oF(function(ee,oe,ge){var fe=I&&ee.as||h,xe="",ae=[],me=ee;if(ee.theme==null){me={};for(var we in ee)me[we]=ee[we];me.theme=Ie.useContext(sF)}typeof ee.className=="string"?xe=tF(oe.registered,ae,ee.className):ee.className!=null&&(xe=ee.className+" ");var Ge=Yw(F.concat(ae),oe.registered,me);xe+=oe.key+"-"+Ge.name,b!==void 0&&(xe+=" "+b);var He=I&&i===void 0?H6(fe):C,ye={};for(var ke in ee)I&&ke==="as"||He(ke)&&(ye[ke]=ee[ke]);return ye.className=xe,ge&&(ye.ref=ge),Ie.createElement(Ie.Fragment,null,Ie.createElement(oK,{cache:oe,serialized:Ge,isStringTag:typeof fe=="string"}),Ie.createElement(fe,ye))});return J.displayName=y!==void 0?y:"Styled("+(typeof h=="string"?h:h.displayName||h.name||"Component")+")",J.defaultProps=t.defaultProps,J.__emotion_real=J,J.__emotion_base=h,J.__emotion_styles=F,J.__emotion_forwardProp=i,Object.defineProperty(J,"toString",{value:function(){return"."+b}}),J.withComponent=function(ee,oe){var ge=e(ee,a5({},a,oe,{shouldForwardProp:Z6(J,oe,!0)}));return ge.apply(void 0,F)},J}},lK=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],c5=sK.bind(null);lK.forEach(function(e){c5[e]=c5(e)});/**
 * @mui/styled-engine v6.4.6
 *
 * @license MIT
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */function cK(e,t){return c5(e,t)}function uK(e,t){Array.isArray(e.__emotion_styles)&&(e.__emotion_styles=t(e.__emotion_styles))}const W6=[];function X6(e){return W6[0]=e,Yw(W6)}const hK=e=>{const t=Object.keys(e).map(a=>({key:a,val:e[a]}))||[];return t.sort((a,o)=>a.val-o.val),t.reduce((a,o)=>({...a,[o.key]:o.val}),{})};function fK(e){const{values:t={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:a="px",step:o=5,...h}=e,y=hK(t),b=Object.keys(y);function i(G){return`@media (min-width:${typeof t[G]=="number"?t[G]:G}${a})`}function C(G){return`@media (max-width:${(typeof t[G]=="number"?t[G]:G)-o/100}${a})`}function I(G,X){const Y=b.indexOf(X);return`@media (min-width:${typeof t[G]=="number"?t[G]:G}${a}) and (max-width:${(Y!==-1&&typeof t[b[Y]]=="number"?t[b[Y]]:X)-o/100}${a})`}function j(G){return b.indexOf(G)+1<b.length?I(G,b[b.indexOf(G)+1]):i(G)}function F(G){const X=b.indexOf(G);return X===0?i(b[1]):X===b.length-1?C(b[X]):I(G,b[b.indexOf(G)+1]).replace("@media","@media not all and")}return{keys:b,values:y,up:i,down:C,between:I,only:j,not:F,unit:a,...h}}const dK={borderRadius:4};function cF(e=8,t=uO({spacing:e})){if(e.mui)return e;const a=(...o)=>(o.length===0?[1]:o).map(y=>{const b=t(y);return typeof b=="number"?`${b}px`:b}).join(" ");return a.mui=!0,a}function pK(e,t){var o;const a=this;if(a.vars){if(!((o=a.colorSchemes)!=null&&o[e])||typeof a.getColorSchemeSelector!="function")return{};let h=a.getColorSchemeSelector(e);return h==="&"?t:((h.includes("data-")||h.includes("."))&&(h=`*:where(${h.replace(/\s*&$/,"")}) &`),{[h]:t})}return a.palette.mode===e?t:{}}function uF(e={},...t){const{breakpoints:a={},palette:o={},spacing:h,shape:y={},...b}=e,i=fK(a),C=cF(h);let I=oc({breakpoints:i,direction:"ltr",components:{},palette:{mode:"light",...o},spacing:C,shape:{...dK,...y}},b);return I=SX(I),I.applyStyles=pK,I=t.reduce((j,F)=>oc(j,F),I),I.unstable_sxConfig={...Hw,...b==null?void 0:b.unstable_sxConfig},I.unstable_sx=function(F){return Ng({sx:F,theme:this})},I}const Y6=e=>e,mK=()=>{let e=Y6;return{configure(t){e=t},generate(t){return e(t)},reset(){e=Y6}}},_K=mK(),gK={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function hF(e,t,a="Mui"){const o=gK[t];return o?`${a}-${o}`:`${_K.generate(e)}-${t}`}function yK(e,t,a="Mui"){const o={};return t.forEach(h=>{o[h]=hF(e,h,a)}),o}function fF(e){const{variants:t,...a}=e,o={variants:t,style:X6(a),isProcessed:!0};return o.style===a||t&&t.forEach(h=>{typeof h.style!="function"&&(h.style=X6(h.style))}),o}const vK=uF();function AT(e){return e!=="ownerState"&&e!=="theme"&&e!=="sx"&&e!=="as"}function xK(e){return e?(t,a)=>a[e]:null}function bK(e,t,a){e.theme=TK(e.theme)?a:e.theme[t]||e.theme}function Eb(e,t){const a=typeof t=="function"?t(e):t;if(Array.isArray(a))return a.flatMap(o=>Eb(e,o));if(Array.isArray(a==null?void 0:a.variants)){let o;if(a.isProcessed)o=a.style;else{const{variants:h,...y}=a;o=y}return dF(e,a.variants,[o])}return a!=null&&a.isProcessed?a.style:a}function dF(e,t,a=[]){var h;let o;e:for(let y=0;y<t.length;y+=1){const b=t[y];if(typeof b.props=="function"){if(o??(o={...e,...e.ownerState,ownerState:e.ownerState}),!b.props(o))continue}else for(const i in b.props)if(e[i]!==b.props[i]&&((h=e.ownerState)==null?void 0:h[i])!==b.props[i])continue e;typeof b.style=="function"?(o??(o={...e,...e.ownerState,ownerState:e.ownerState}),a.push(b.style(o))):a.push(b.style)}return a}function wK(e={}){const{themeId:t,defaultTheme:a=vK,rootShouldForwardProp:o=AT,slotShouldForwardProp:h=AT}=e;function y(i){bK(i,t,a)}return(i,C={})=>{uK(i,ae=>ae.filter(me=>me!==Ng));const{name:I,slot:j,skipVariantsResolver:F,skipSx:G,overridesResolver:X=xK(AK(j)),...Y}=C,J=F!==void 0?F:j&&j!=="Root"&&j!=="root"||!1,ee=G||!1;let oe=AT;j==="Root"||j==="root"?oe=o:j?oe=h:EK(i)&&(oe=void 0);const ge=cK(i,{shouldForwardProp:oe,label:SK(),...Y}),fe=ae=>{if(typeof ae=="function"&&ae.__emotion_real!==ae)return function(we){return Eb(we,ae)};if(zd(ae)){const me=fF(ae);return me.variants?function(Ge){return Eb(Ge,me)}:me.style}return ae},xe=(...ae)=>{const me=[],we=ae.map(fe),Ge=[];if(me.push(y),I&&X&&Ge.push(function(dt){var gt,Vt;const jt=(Vt=(gt=dt.theme.components)==null?void 0:gt[I])==null?void 0:Vt.styleOverrides;if(!jt)return null;const _t={};for(const Ht in jt)_t[Ht]=Eb(dt,jt[Ht]);return X(dt,_t)}),I&&!J&&Ge.push(function(dt){var _t,gt;const vt=dt.theme,jt=(gt=(_t=vt==null?void 0:vt.components)==null?void 0:_t[I])==null?void 0:gt.variants;return jt?dF(dt,jt):null}),ee||Ge.push(Ng),Array.isArray(we[0])){const ke=we.shift(),dt=new Array(me.length).fill(""),vt=new Array(Ge.length).fill("");let jt;jt=[...dt,...ke,...vt],jt.raw=[...dt,...ke.raw,...vt],me.unshift(jt)}const He=[...me,...we,...Ge],ye=ge(...He);return i.muiName&&(ye.muiName=i.muiName),ye};return ge.withConfig&&(xe.withConfig=ge.withConfig),xe}}function SK(e,t){return void 0}function TK(e){for(const t in e)return!1;return!0}function EK(e){return typeof e=="string"&&e.charCodeAt(0)>96}function AK(e){return e&&e.charAt(0).toLowerCase()+e.slice(1)}function u5(e,t){const a={...t};for(const o in e)if(Object.prototype.hasOwnProperty.call(e,o)){const h=o;if(h==="components"||h==="slots")a[h]={...e[h],...a[h]};else if(h==="componentsProps"||h==="slotProps"){const y=e[h],b=t[h];if(!b)a[h]=y||{};else if(!y)a[h]=b;else{a[h]={...b};for(const i in y)if(Object.prototype.hasOwnProperty.call(y,i)){const C=i;a[h][C]=u5(y[C],b[C])}}}else a[h]===void 0&&(a[h]=e[h])}return a}function CK(e,t=Number.MIN_SAFE_INTEGER,a=Number.MAX_SAFE_INTEGER){return Math.max(t,Math.min(e,a))}function yO(e,t=0,a=1){return CK(e,t,a)}function MK(e){e=e.slice(1);const t=new RegExp(`.{1,${e.length>=6?2:1}}`,"g");let a=e.match(t);return a&&a[0].length===1&&(a=a.map(o=>o+o)),a?`rgb${a.length===4?"a":""}(${a.map((o,h)=>h<3?parseInt(o,16):Math.round(parseInt(o,16)/255*1e3)/1e3).join(", ")})`:""}function dm(e){if(e.type)return e;if(e.charAt(0)==="#")return dm(MK(e));const t=e.indexOf("("),a=e.substring(0,t);if(!["rgb","rgba","hsl","hsla","color"].includes(a))throw new Error(q0(9,e));let o=e.substring(t+1,e.length-1),h;if(a==="color"){if(o=o.split(" "),h=o.shift(),o.length===4&&o[3].charAt(0)==="/"&&(o[3]=o[3].slice(1)),!["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].includes(h))throw new Error(q0(10,h))}else o=o.split(",");return o=o.map(y=>parseFloat(y)),{type:a,values:o,colorSpace:h}}const OK=e=>{const t=dm(e);return t.values.slice(0,3).map((a,o)=>t.type.includes("hsl")&&o!==0?`${a}%`:a).join(" ")},r1=(e,t)=>{try{return OK(e)}catch{return e}};function Kw(e){const{type:t,colorSpace:a}=e;let{values:o}=e;return t.includes("rgb")?o=o.map((h,y)=>y<3?parseInt(h,10):h):t.includes("hsl")&&(o[1]=`${o[1]}%`,o[2]=`${o[2]}%`),t.includes("color")?o=`${a} ${o.join(" ")}`:o=`${o.join(", ")}`,`${t}(${o})`}function pF(e){e=dm(e);const{values:t}=e,a=t[0],o=t[1]/100,h=t[2]/100,y=o*Math.min(h,1-h),b=(I,j=(I+a/30)%12)=>h-y*Math.max(Math.min(j-3,9-j,1),-1);let i="rgb";const C=[Math.round(b(0)*255),Math.round(b(8)*255),Math.round(b(4)*255)];return e.type==="hsla"&&(i+="a",C.push(t[3])),Kw({type:i,values:C})}function h5(e){e=dm(e);let t=e.type==="hsl"||e.type==="hsla"?dm(pF(e)).values:e.values;return t=t.map(a=>(e.type!=="color"&&(a/=255),a<=.03928?a/12.92:((a+.055)/1.055)**2.4)),Number((.2126*t[0]+.7152*t[1]+.0722*t[2]).toFixed(3))}function PK(e,t){const a=h5(e),o=h5(t);return(Math.max(a,o)+.05)/(Math.min(a,o)+.05)}function IK(e,t){return e=dm(e),t=yO(t),(e.type==="rgb"||e.type==="hsl")&&(e.type+="a"),e.type==="color"?e.values[3]=`/${t}`:e.values[3]=t,Kw(e)}function $x(e,t,a){try{return IK(e,t)}catch{return e}}function vO(e,t){if(e=dm(e),t=yO(t),e.type.includes("hsl"))e.values[2]*=1-t;else if(e.type.includes("rgb")||e.type.includes("color"))for(let a=0;a<3;a+=1)e.values[a]*=1-t;return Kw(e)}function Fi(e,t,a){try{return vO(e,t)}catch{return e}}function xO(e,t){if(e=dm(e),t=yO(t),e.type.includes("hsl"))e.values[2]+=(100-e.values[2])*t;else if(e.type.includes("rgb"))for(let a=0;a<3;a+=1)e.values[a]+=(255-e.values[a])*t;else if(e.type.includes("color"))for(let a=0;a<3;a+=1)e.values[a]+=(1-e.values[a])*t;return Kw(e)}function ji(e,t,a){try{return xO(e,t)}catch{return e}}function RK(e,t=.15){return h5(e)>.5?vO(e,t):xO(e,t)}function qx(e,t,a){try{return RK(e,t)}catch{return e}}const DK=Ie.createContext(void 0);function LK(e){const{theme:t,name:a,props:o}=e;if(!t||!t.components||!t.components[a])return o;const h=t.components[a];return h.defaultProps?u5(h.defaultProps,o):!h.styleOverrides&&!h.variants?u5(h,o):o}function kK({props:e,name:t}){const a=Ie.useContext(DK);return LK({props:e,name:t,theme:{components:a}})}const K6={theme:void 0};function zK(e){let t,a;return function(h){let y=t;return(y===void 0||h.theme!==a)&&(K6.theme=h.theme,y=fF(e(K6)),t=y,a=h.theme),y}}function BK(e=""){function t(...o){if(!o.length)return"";const h=o[0];return typeof h=="string"&&!h.match(/(#|\(|\)|(-?(\d*\.)?\d+)(px|em|%|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc))|^(-?(\d*\.)?\d+)$|(\d+ \d+ \d+)/)?`, var(--${e?`${e}-`:""}${h}${t(...o.slice(1))})`:`, ${h}`}return(o,...h)=>`var(--${e?`${e}-`:""}${o}${t(...h)})`}const J6=(e,t,a,o=[])=>{let h=e;t.forEach((y,b)=>{b===t.length-1?Array.isArray(h)?h[Number(y)]=a:h&&typeof h=="object"&&(h[y]=a):h&&typeof h=="object"&&(h[y]||(h[y]=o.includes(y)?[]:{}),h=h[y])})},NK=(e,t,a)=>{function o(h,y=[],b=[]){Object.entries(h).forEach(([i,C])=>{(!a||a&&!a([...y,i]))&&C!=null&&(typeof C=="object"&&Object.keys(C).length>0?o(C,[...y,i],Array.isArray(C)?[...b,i]:b):t([...y,i],C,b))})}o(e)},FK=(e,t)=>typeof t=="number"?["lineHeight","fontWeight","opacity","zIndex"].some(o=>e.includes(o))||e[e.length-1].toLowerCase().includes("opacity")?t:`${t}px`:t;function CT(e,t){const{prefix:a,shouldSkipGeneratingVar:o}=t||{},h={},y={},b={};return NK(e,(i,C,I)=>{if((typeof C=="string"||typeof C=="number")&&(!o||!o(i,C))){const j=`--${a?`${a}-`:""}${i.join("-")}`,F=FK(i,C);Object.assign(h,{[j]:F}),J6(y,i,`var(${j})`,I),J6(b,i,`var(${j}, ${F})`,I)}},i=>i[0]==="vars"),{css:h,vars:y,varsWithDefaults:b}}function jK(e,t={}){const{getSelector:a=ee,disableCssColorScheme:o,colorSchemeSelector:h}=t,{colorSchemes:y={},components:b,defaultColorScheme:i="light",...C}=e,{vars:I,css:j,varsWithDefaults:F}=CT(C,t);let G=F;const X={},{[i]:Y,...J}=y;if(Object.entries(J||{}).forEach(([fe,xe])=>{const{vars:ae,css:me,varsWithDefaults:we}=CT(xe,t);G=oc(G,we),X[fe]={css:me,vars:ae}}),Y){const{css:fe,vars:xe,varsWithDefaults:ae}=CT(Y,t);G=oc(G,ae),X[i]={css:fe,vars:xe}}function ee(fe,xe){var me,we;let ae=h;if(h==="class"&&(ae=".%s"),h==="data"&&(ae="[data-%s]"),h!=null&&h.startsWith("data-")&&!h.includes("%s")&&(ae=`[${h}="%s"]`),fe){if(ae==="media")return e.defaultColorScheme===fe?":root":{[`@media (prefers-color-scheme: ${((we=(me=y[fe])==null?void 0:me.palette)==null?void 0:we.mode)||fe})`]:{":root":xe}};if(ae)return e.defaultColorScheme===fe?`:root, ${ae.replace("%s",String(fe))}`:ae.replace("%s",String(fe))}return":root"}return{vars:G,generateThemeVars:()=>{let fe={...I};return Object.entries(X).forEach(([,{vars:xe}])=>{fe=oc(fe,xe)}),fe},generateStyleSheets:()=>{var Ge,He;const fe=[],xe=e.defaultColorScheme||"light";function ae(ye,ke){Object.keys(ke).length&&fe.push(typeof ye=="string"?{[ye]:{...ke}}:ye)}ae(a(void 0,{...j}),j);const{[xe]:me,...we}=X;if(me){const{css:ye}=me,ke=(He=(Ge=y[xe])==null?void 0:Ge.palette)==null?void 0:He.mode,dt=!o&&ke?{colorScheme:ke,...ye}:{...ye};ae(a(xe,{...dt}),dt)}return Object.entries(we).forEach(([ye,{css:ke}])=>{var jt,_t;const dt=(_t=(jt=y[ye])==null?void 0:jt.palette)==null?void 0:_t.mode,vt=!o&&dt?{colorScheme:dt,...ke}:{...ke};ae(a(ye,{...vt}),vt)}),fe}}}function UK(e){return function(a){return e==="media"?`@media (prefers-color-scheme: ${a})`:e?e.startsWith("data-")&&!e.includes("%s")?`[${e}="${a}"] &`:e==="class"?`.${a} &`:e==="data"?`[data-${a}] &`:`${e.replace("%s",a)} &`:"&"}}const P1={black:"#000",white:"#fff"},VK={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"},lg={50:"#f3e5f5",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",700:"#7b1fa2"},cg={300:"#e57373",400:"#ef5350",500:"#f44336",700:"#d32f2f",800:"#c62828"},Lv={300:"#ffb74d",400:"#ffa726",500:"#ff9800",700:"#f57c00",900:"#e65100"},ug={50:"#e3f2fd",200:"#90caf9",400:"#42a5f5",700:"#1976d2",800:"#1565c0"},hg={300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",700:"#0288d1",900:"#01579b"},fg={300:"#81c784",400:"#66bb6a",500:"#4caf50",700:"#388e3c",800:"#2e7d32",900:"#1b5e20"};function mF(){return{text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:P1.white,default:P1.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}}}const $K=mF();function _F(){return{text:{primary:P1.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:P1.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}}}const Q6=_F();function eD(e,t,a,o){const h=o.light||o,y=o.dark||o*1.5;e[t]||(e.hasOwnProperty(a)?e[t]=e[a]:t==="light"?e.light=xO(e.main,h):t==="dark"&&(e.dark=vO(e.main,y)))}function qK(e="light"){return e==="dark"?{main:ug[200],light:ug[50],dark:ug[400]}:{main:ug[700],light:ug[400],dark:ug[800]}}function GK(e="light"){return e==="dark"?{main:lg[200],light:lg[50],dark:lg[400]}:{main:lg[500],light:lg[300],dark:lg[700]}}function HK(e="light"){return e==="dark"?{main:cg[500],light:cg[300],dark:cg[700]}:{main:cg[700],light:cg[400],dark:cg[800]}}function ZK(e="light"){return e==="dark"?{main:hg[400],light:hg[300],dark:hg[700]}:{main:hg[700],light:hg[500],dark:hg[900]}}function WK(e="light"){return e==="dark"?{main:fg[400],light:fg[300],dark:fg[700]}:{main:fg[800],light:fg[500],dark:fg[900]}}function XK(e="light"){return e==="dark"?{main:Lv[400],light:Lv[300],dark:Lv[700]}:{main:"#ed6c02",light:Lv[500],dark:Lv[900]}}function bO(e){const{mode:t="light",contrastThreshold:a=3,tonalOffset:o=.2,...h}=e,y=e.primary||qK(t),b=e.secondary||GK(t),i=e.error||HK(t),C=e.info||ZK(t),I=e.success||WK(t),j=e.warning||XK(t);function F(J){return PK(J,Q6.text.primary)>=a?Q6.text.primary:$K.text.primary}const G=({color:J,name:ee,mainShade:oe=500,lightShade:ge=300,darkShade:fe=700})=>{if(J={...J},!J.main&&J[oe]&&(J.main=J[oe]),!J.hasOwnProperty("main"))throw new Error(q0(11,ee?` (${ee})`:"",oe));if(typeof J.main!="string")throw new Error(q0(12,ee?` (${ee})`:"",JSON.stringify(J.main)));return eD(J,"light",ge,o),eD(J,"dark",fe,o),J.contrastText||(J.contrastText=F(J.main)),J};let X;return t==="light"?X=mF():t==="dark"&&(X=_F()),oc({common:{...P1},mode:t,primary:G({color:y,name:"primary"}),secondary:G({color:b,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:G({color:i,name:"error"}),warning:G({color:j,name:"warning"}),info:G({color:C,name:"info"}),success:G({color:I,name:"success"}),grey:VK,contrastThreshold:a,getContrastText:F,augmentColor:G,tonalOffset:o,...X},h)}function YK(e){const t={};return Object.entries(e).forEach(o=>{const[h,y]=o;typeof y=="object"&&(t[h]=`${y.fontStyle?`${y.fontStyle} `:""}${y.fontVariant?`${y.fontVariant} `:""}${y.fontWeight?`${y.fontWeight} `:""}${y.fontStretch?`${y.fontStretch} `:""}${y.fontSize||""}${y.lineHeight?`/${y.lineHeight} `:""}${y.fontFamily||""}`)}),t}function KK(e,t){return{toolbar:{minHeight:56,[e.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[e.up("sm")]:{minHeight:64}},...t}}function JK(e){return Math.round(e*1e5)/1e5}const tD={textTransform:"uppercase"},nD='"Roboto", "Helvetica", "Arial", sans-serif';function QK(e,t){const{fontFamily:a=nD,fontSize:o=14,fontWeightLight:h=300,fontWeightRegular:y=400,fontWeightMedium:b=500,fontWeightBold:i=700,htmlFontSize:C=16,allVariants:I,pxToRem:j,...F}=typeof t=="function"?t(e):t,G=o/14,X=j||(ee=>`${ee/C*G}rem`),Y=(ee,oe,ge,fe,xe)=>({fontFamily:a,fontWeight:ee,fontSize:X(oe),lineHeight:ge,...a===nD?{letterSpacing:`${JK(fe/oe)}em`}:{},...xe,...I}),J={h1:Y(h,96,1.167,-1.5),h2:Y(h,60,1.2,-.5),h3:Y(y,48,1.167,0),h4:Y(y,34,1.235,.25),h5:Y(y,24,1.334,0),h6:Y(b,20,1.6,.15),subtitle1:Y(y,16,1.75,.15),subtitle2:Y(b,14,1.57,.1),body1:Y(y,16,1.5,.15),body2:Y(y,14,1.43,.15),button:Y(b,14,1.75,.4,tD),caption:Y(y,12,1.66,.4),overline:Y(y,12,2.66,1,tD),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return oc({htmlFontSize:C,pxToRem:X,fontFamily:a,fontSize:o,fontWeightLight:h,fontWeightRegular:y,fontWeightMedium:b,fontWeightBold:i,...J},F,{clone:!1})}const eJ=.2,tJ=.14,nJ=.12;function ca(...e){return[`${e[0]}px ${e[1]}px ${e[2]}px ${e[3]}px rgba(0,0,0,${eJ})`,`${e[4]}px ${e[5]}px ${e[6]}px ${e[7]}px rgba(0,0,0,${tJ})`,`${e[8]}px ${e[9]}px ${e[10]}px ${e[11]}px rgba(0,0,0,${nJ})`].join(",")}const rJ=["none",ca(0,2,1,-1,0,1,1,0,0,1,3,0),ca(0,3,1,-2,0,2,2,0,0,1,5,0),ca(0,3,3,-2,0,3,4,0,0,1,8,0),ca(0,2,4,-1,0,4,5,0,0,1,10,0),ca(0,3,5,-1,0,5,8,0,0,1,14,0),ca(0,3,5,-1,0,6,10,0,0,1,18,0),ca(0,4,5,-2,0,7,10,1,0,2,16,1),ca(0,5,5,-3,0,8,10,1,0,3,14,2),ca(0,5,6,-3,0,9,12,1,0,3,16,2),ca(0,6,6,-3,0,10,14,1,0,4,18,3),ca(0,6,7,-4,0,11,15,1,0,4,20,3),ca(0,7,8,-4,0,12,17,2,0,5,22,4),ca(0,7,8,-4,0,13,19,2,0,5,24,4),ca(0,7,9,-4,0,14,21,2,0,5,26,4),ca(0,8,9,-5,0,15,22,2,0,6,28,5),ca(0,8,10,-5,0,16,24,2,0,6,30,5),ca(0,8,11,-5,0,17,26,2,0,6,32,5),ca(0,9,11,-5,0,18,28,2,0,7,34,6),ca(0,9,12,-6,0,19,29,2,0,7,36,6),ca(0,10,13,-6,0,20,31,3,0,8,38,7),ca(0,10,13,-6,0,21,33,3,0,8,40,7),ca(0,10,14,-6,0,22,35,3,0,8,42,7),ca(0,11,14,-7,0,23,36,3,0,9,44,8),ca(0,11,15,-7,0,24,38,3,0,9,46,8)],iJ={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},aJ={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function rD(e){return`${Math.round(e)}ms`}function oJ(e){if(!e)return 0;const t=e/36;return Math.min(Math.round((4+15*t**.25+t/5)*10),3e3)}function sJ(e){const t={...iJ,...e.easing},a={...aJ,...e.duration};return{getAutoHeightDuration:oJ,create:(h=["all"],y={})=>{const{duration:b=a.standard,easing:i=t.easeInOut,delay:C=0,...I}=y;return(Array.isArray(h)?h:[h]).map(j=>`${j} ${typeof b=="string"?b:rD(b)} ${i} ${typeof C=="string"?C:rD(C)}`).join(",")},...e,easing:t,duration:a}}const lJ={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500};function cJ(e){return zd(e)||typeof e>"u"||typeof e=="string"||typeof e=="boolean"||typeof e=="number"||Array.isArray(e)}function gF(e={}){const t={...e};function a(o){const h=Object.entries(o);for(let y=0;y<h.length;y++){const[b,i]=h[y];!cJ(i)||b.startsWith("unstable_")?delete o[b]:zd(i)&&(o[b]={...i},a(o[b]))}}return a(t),`import { unstable_createBreakpoints as createBreakpoints, createTransitions } from '@mui/material/styles';

const theme = ${JSON.stringify(t,null,2)};

theme.breakpoints = createBreakpoints(theme.breakpoints || {});
theme.transitions = createTransitions(theme.transitions || {});

export default theme;`}function f5(e={},...t){const{breakpoints:a,mixins:o={},spacing:h,palette:y={},transitions:b={},typography:i={},shape:C,...I}=e;if(e.vars&&e.generateThemeVars===void 0)throw new Error(q0(20));const j=bO(y),F=uF(e);let G=oc(F,{mixins:KK(F.breakpoints,o),palette:j,shadows:rJ.slice(),typography:QK(j,i),transitions:sJ(b),zIndex:{...lJ}});return G=oc(G,I),G=t.reduce((X,Y)=>oc(X,Y),G),G.unstable_sxConfig={...Hw,...I==null?void 0:I.unstable_sxConfig},G.unstable_sx=function(Y){return Ng({sx:Y,theme:this})},G.toRuntimeSource=gF,G}function uJ(e){let t;return e<1?t=5.11916*e**2:t=4.5*Math.log(e+1)+2,Math.round(t*10)/1e3}const hJ=[...Array(25)].map((e,t)=>{if(t===0)return"none";const a=uJ(t);return`linear-gradient(rgba(255 255 255 / ${a}), rgba(255 255 255 / ${a}))`});function yF(e){return{inputPlaceholder:e==="dark"?.5:.42,inputUnderline:e==="dark"?.7:.42,switchTrackDisabled:e==="dark"?.2:.12,switchTrack:e==="dark"?.3:.38}}function vF(e){return e==="dark"?hJ:[]}function fJ(e){const{palette:t={mode:"light"},opacity:a,overlays:o,...h}=e,y=bO(t);return{palette:y,opacity:{...yF(y.mode),...a},overlays:o||vF(y.mode),...h}}function dJ(e){var t;return!!e[0].match(/(cssVarPrefix|colorSchemeSelector|rootSelector|typography|mixins|breakpoints|direction|transitions)/)||!!e[0].match(/sxConfig$/)||e[0]==="palette"&&!!((t=e[1])!=null&&t.match(/(mode|contrastThreshold|tonalOffset)/))}const pJ=e=>[...[...Array(25)].map((t,a)=>`--${e?`${e}-`:""}overlays-${a}`),`--${e?`${e}-`:""}palette-AppBar-darkBg`,`--${e?`${e}-`:""}palette-AppBar-darkColor`],mJ=e=>(t,a)=>{const o=e.rootSelector||":root",h=e.colorSchemeSelector;let y=h;if(h==="class"&&(y=".%s"),h==="data"&&(y="[data-%s]"),h!=null&&h.startsWith("data-")&&!h.includes("%s")&&(y=`[${h}="%s"]`),e.defaultColorScheme===t){if(t==="dark"){const b={};return pJ(e.cssVarPrefix).forEach(i=>{b[i]=a[i],delete a[i]}),y==="media"?{[o]:a,"@media (prefers-color-scheme: dark)":{[o]:b}}:y?{[y.replace("%s",t)]:b,[`${o}, ${y.replace("%s",t)}`]:a}:{[o]:{...a,...b}}}if(y&&y!=="media")return`${o}, ${y.replace("%s",String(t))}`}else if(t){if(y==="media")return{[`@media (prefers-color-scheme: ${String(t)})`]:{[o]:a}};if(y)return y.replace("%s",String(t))}return o};function _J(e,t){t.forEach(a=>{e[a]||(e[a]={})})}function tn(e,t,a){!e[t]&&a&&(e[t]=a)}function i1(e){return typeof e!="string"||!e.startsWith("hsl")?e:pF(e)}function Rd(e,t){`${t}Channel`in e||(e[`${t}Channel`]=r1(i1(e[t])))}function gJ(e){return typeof e=="number"?`${e}px`:typeof e=="string"||typeof e=="function"||Array.isArray(e)?e:"8px"}const cf=e=>{try{return e()}catch{}},yJ=(e="mui")=>BK(e);function MT(e,t,a,o){if(!t)return;t=t===!0?{}:t;const h=o==="dark"?"dark":"light";if(!a){e[o]=fJ({...t,palette:{mode:h,...t==null?void 0:t.palette}});return}const{palette:y,...b}=f5({...a,palette:{mode:h,...t==null?void 0:t.palette}});return e[o]={...t,palette:y,opacity:{...yF(h),...t==null?void 0:t.opacity},overlays:(t==null?void 0:t.overlays)||vF(h)},b}function vJ(e={},...t){const{colorSchemes:a={light:!0},defaultColorScheme:o,disableCssColorScheme:h=!1,cssVarPrefix:y="mui",shouldSkipGeneratingVar:b=dJ,colorSchemeSelector:i=a.light&&a.dark?"media":void 0,rootSelector:C=":root",...I}=e,j=Object.keys(a)[0],F=o||(a.light&&j!=="light"?"light":j),G=yJ(y),{[F]:X,light:Y,dark:J,...ee}=a,oe={...ee};let ge=X;if((F==="dark"&&!("dark"in a)||F==="light"&&!("light"in a))&&(ge=!0),!ge)throw new Error(q0(21,F));const fe=MT(oe,ge,I,F);Y&&!oe.light&&MT(oe,Y,void 0,"light"),J&&!oe.dark&&MT(oe,J,void 0,"dark");let xe={defaultColorScheme:F,...fe,cssVarPrefix:y,colorSchemeSelector:i,rootSelector:C,getCssVar:G,colorSchemes:oe,font:{...YK(fe.typography),...fe.font},spacing:gJ(I.spacing)};Object.keys(xe.colorSchemes).forEach(He=>{const ye=xe.colorSchemes[He].palette,ke=dt=>{const vt=dt.split("-"),jt=vt[1],_t=vt[2];return G(dt,ye[jt][_t])};if(ye.mode==="light"&&(tn(ye.common,"background","#fff"),tn(ye.common,"onBackground","#000")),ye.mode==="dark"&&(tn(ye.common,"background","#000"),tn(ye.common,"onBackground","#fff")),_J(ye,["Alert","AppBar","Avatar","Button","Chip","FilledInput","LinearProgress","Skeleton","Slider","SnackbarContent","SpeedDialAction","StepConnector","StepContent","Switch","TableCell","Tooltip"]),ye.mode==="light"){tn(ye.Alert,"errorColor",Fi(ye.error.light,.6)),tn(ye.Alert,"infoColor",Fi(ye.info.light,.6)),tn(ye.Alert,"successColor",Fi(ye.success.light,.6)),tn(ye.Alert,"warningColor",Fi(ye.warning.light,.6)),tn(ye.Alert,"errorFilledBg",ke("palette-error-main")),tn(ye.Alert,"infoFilledBg",ke("palette-info-main")),tn(ye.Alert,"successFilledBg",ke("palette-success-main")),tn(ye.Alert,"warningFilledBg",ke("palette-warning-main")),tn(ye.Alert,"errorFilledColor",cf(()=>ye.getContrastText(ye.error.main))),tn(ye.Alert,"infoFilledColor",cf(()=>ye.getContrastText(ye.info.main))),tn(ye.Alert,"successFilledColor",cf(()=>ye.getContrastText(ye.success.main))),tn(ye.Alert,"warningFilledColor",cf(()=>ye.getContrastText(ye.warning.main))),tn(ye.Alert,"errorStandardBg",ji(ye.error.light,.9)),tn(ye.Alert,"infoStandardBg",ji(ye.info.light,.9)),tn(ye.Alert,"successStandardBg",ji(ye.success.light,.9)),tn(ye.Alert,"warningStandardBg",ji(ye.warning.light,.9)),tn(ye.Alert,"errorIconColor",ke("palette-error-main")),tn(ye.Alert,"infoIconColor",ke("palette-info-main")),tn(ye.Alert,"successIconColor",ke("palette-success-main")),tn(ye.Alert,"warningIconColor",ke("palette-warning-main")),tn(ye.AppBar,"defaultBg",ke("palette-grey-100")),tn(ye.Avatar,"defaultBg",ke("palette-grey-400")),tn(ye.Button,"inheritContainedBg",ke("palette-grey-300")),tn(ye.Button,"inheritContainedHoverBg",ke("palette-grey-A100")),tn(ye.Chip,"defaultBorder",ke("palette-grey-400")),tn(ye.Chip,"defaultAvatarColor",ke("palette-grey-700")),tn(ye.Chip,"defaultIconColor",ke("palette-grey-700")),tn(ye.FilledInput,"bg","rgba(0, 0, 0, 0.06)"),tn(ye.FilledInput,"hoverBg","rgba(0, 0, 0, 0.09)"),tn(ye.FilledInput,"disabledBg","rgba(0, 0, 0, 0.12)"),tn(ye.LinearProgress,"primaryBg",ji(ye.primary.main,.62)),tn(ye.LinearProgress,"secondaryBg",ji(ye.secondary.main,.62)),tn(ye.LinearProgress,"errorBg",ji(ye.error.main,.62)),tn(ye.LinearProgress,"infoBg",ji(ye.info.main,.62)),tn(ye.LinearProgress,"successBg",ji(ye.success.main,.62)),tn(ye.LinearProgress,"warningBg",ji(ye.warning.main,.62)),tn(ye.Skeleton,"bg",`rgba(${ke("palette-text-primaryChannel")} / 0.11)`),tn(ye.Slider,"primaryTrack",ji(ye.primary.main,.62)),tn(ye.Slider,"secondaryTrack",ji(ye.secondary.main,.62)),tn(ye.Slider,"errorTrack",ji(ye.error.main,.62)),tn(ye.Slider,"infoTrack",ji(ye.info.main,.62)),tn(ye.Slider,"successTrack",ji(ye.success.main,.62)),tn(ye.Slider,"warningTrack",ji(ye.warning.main,.62));const dt=qx(ye.background.default,.8);tn(ye.SnackbarContent,"bg",dt),tn(ye.SnackbarContent,"color",cf(()=>ye.getContrastText(dt))),tn(ye.SpeedDialAction,"fabHoverBg",qx(ye.background.paper,.15)),tn(ye.StepConnector,"border",ke("palette-grey-400")),tn(ye.StepContent,"border",ke("palette-grey-400")),tn(ye.Switch,"defaultColor",ke("palette-common-white")),tn(ye.Switch,"defaultDisabledColor",ke("palette-grey-100")),tn(ye.Switch,"primaryDisabledColor",ji(ye.primary.main,.62)),tn(ye.Switch,"secondaryDisabledColor",ji(ye.secondary.main,.62)),tn(ye.Switch,"errorDisabledColor",ji(ye.error.main,.62)),tn(ye.Switch,"infoDisabledColor",ji(ye.info.main,.62)),tn(ye.Switch,"successDisabledColor",ji(ye.success.main,.62)),tn(ye.Switch,"warningDisabledColor",ji(ye.warning.main,.62)),tn(ye.TableCell,"border",ji($x(ye.divider,1),.88)),tn(ye.Tooltip,"bg",$x(ye.grey[700],.92))}if(ye.mode==="dark"){tn(ye.Alert,"errorColor",ji(ye.error.light,.6)),tn(ye.Alert,"infoColor",ji(ye.info.light,.6)),tn(ye.Alert,"successColor",ji(ye.success.light,.6)),tn(ye.Alert,"warningColor",ji(ye.warning.light,.6)),tn(ye.Alert,"errorFilledBg",ke("palette-error-dark")),tn(ye.Alert,"infoFilledBg",ke("palette-info-dark")),tn(ye.Alert,"successFilledBg",ke("palette-success-dark")),tn(ye.Alert,"warningFilledBg",ke("palette-warning-dark")),tn(ye.Alert,"errorFilledColor",cf(()=>ye.getContrastText(ye.error.dark))),tn(ye.Alert,"infoFilledColor",cf(()=>ye.getContrastText(ye.info.dark))),tn(ye.Alert,"successFilledColor",cf(()=>ye.getContrastText(ye.success.dark))),tn(ye.Alert,"warningFilledColor",cf(()=>ye.getContrastText(ye.warning.dark))),tn(ye.Alert,"errorStandardBg",Fi(ye.error.light,.9)),tn(ye.Alert,"infoStandardBg",Fi(ye.info.light,.9)),tn(ye.Alert,"successStandardBg",Fi(ye.success.light,.9)),tn(ye.Alert,"warningStandardBg",Fi(ye.warning.light,.9)),tn(ye.Alert,"errorIconColor",ke("palette-error-main")),tn(ye.Alert,"infoIconColor",ke("palette-info-main")),tn(ye.Alert,"successIconColor",ke("palette-success-main")),tn(ye.Alert,"warningIconColor",ke("palette-warning-main")),tn(ye.AppBar,"defaultBg",ke("palette-grey-900")),tn(ye.AppBar,"darkBg",ke("palette-background-paper")),tn(ye.AppBar,"darkColor",ke("palette-text-primary")),tn(ye.Avatar,"defaultBg",ke("palette-grey-600")),tn(ye.Button,"inheritContainedBg",ke("palette-grey-800")),tn(ye.Button,"inheritContainedHoverBg",ke("palette-grey-700")),tn(ye.Chip,"defaultBorder",ke("palette-grey-700")),tn(ye.Chip,"defaultAvatarColor",ke("palette-grey-300")),tn(ye.Chip,"defaultIconColor",ke("palette-grey-300")),tn(ye.FilledInput,"bg","rgba(255, 255, 255, 0.09)"),tn(ye.FilledInput,"hoverBg","rgba(255, 255, 255, 0.13)"),tn(ye.FilledInput,"disabledBg","rgba(255, 255, 255, 0.12)"),tn(ye.LinearProgress,"primaryBg",Fi(ye.primary.main,.5)),tn(ye.LinearProgress,"secondaryBg",Fi(ye.secondary.main,.5)),tn(ye.LinearProgress,"errorBg",Fi(ye.error.main,.5)),tn(ye.LinearProgress,"infoBg",Fi(ye.info.main,.5)),tn(ye.LinearProgress,"successBg",Fi(ye.success.main,.5)),tn(ye.LinearProgress,"warningBg",Fi(ye.warning.main,.5)),tn(ye.Skeleton,"bg",`rgba(${ke("palette-text-primaryChannel")} / 0.13)`),tn(ye.Slider,"primaryTrack",Fi(ye.primary.main,.5)),tn(ye.Slider,"secondaryTrack",Fi(ye.secondary.main,.5)),tn(ye.Slider,"errorTrack",Fi(ye.error.main,.5)),tn(ye.Slider,"infoTrack",Fi(ye.info.main,.5)),tn(ye.Slider,"successTrack",Fi(ye.success.main,.5)),tn(ye.Slider,"warningTrack",Fi(ye.warning.main,.5));const dt=qx(ye.background.default,.98);tn(ye.SnackbarContent,"bg",dt),tn(ye.SnackbarContent,"color",cf(()=>ye.getContrastText(dt))),tn(ye.SpeedDialAction,"fabHoverBg",qx(ye.background.paper,.15)),tn(ye.StepConnector,"border",ke("palette-grey-600")),tn(ye.StepContent,"border",ke("palette-grey-600")),tn(ye.Switch,"defaultColor",ke("palette-grey-300")),tn(ye.Switch,"defaultDisabledColor",ke("palette-grey-600")),tn(ye.Switch,"primaryDisabledColor",Fi(ye.primary.main,.55)),tn(ye.Switch,"secondaryDisabledColor",Fi(ye.secondary.main,.55)),tn(ye.Switch,"errorDisabledColor",Fi(ye.error.main,.55)),tn(ye.Switch,"infoDisabledColor",Fi(ye.info.main,.55)),tn(ye.Switch,"successDisabledColor",Fi(ye.success.main,.55)),tn(ye.Switch,"warningDisabledColor",Fi(ye.warning.main,.55)),tn(ye.TableCell,"border",Fi($x(ye.divider,1),.68)),tn(ye.Tooltip,"bg",$x(ye.grey[700],.92))}Rd(ye.background,"default"),Rd(ye.background,"paper"),Rd(ye.common,"background"),Rd(ye.common,"onBackground"),Rd(ye,"divider"),Object.keys(ye).forEach(dt=>{const vt=ye[dt];dt!=="tonalOffset"&&vt&&typeof vt=="object"&&(vt.main&&tn(ye[dt],"mainChannel",r1(i1(vt.main))),vt.light&&tn(ye[dt],"lightChannel",r1(i1(vt.light))),vt.dark&&tn(ye[dt],"darkChannel",r1(i1(vt.dark))),vt.contrastText&&tn(ye[dt],"contrastTextChannel",r1(i1(vt.contrastText))),dt==="text"&&(Rd(ye[dt],"primary"),Rd(ye[dt],"secondary")),dt==="action"&&(vt.active&&Rd(ye[dt],"active"),vt.selected&&Rd(ye[dt],"selected")))})}),xe=t.reduce((He,ye)=>oc(He,ye),xe);const ae={prefix:y,disableCssColorScheme:h,shouldSkipGeneratingVar:b,getSelector:mJ(xe)},{vars:me,generateThemeVars:we,generateStyleSheets:Ge}=jK(xe,ae);return xe.vars=me,Object.entries(xe.colorSchemes[xe.defaultColorScheme]).forEach(([He,ye])=>{xe[He]=ye}),xe.generateThemeVars=we,xe.generateStyleSheets=Ge,xe.generateSpacing=function(){return cF(I.spacing,uO(this))},xe.getColorSchemeSelector=UK(i),xe.spacing=xe.generateSpacing(),xe.shouldSkipGeneratingVar=b,xe.unstable_sxConfig={...Hw,...I==null?void 0:I.unstable_sxConfig},xe.unstable_sx=function(ye){return Ng({sx:ye,theme:this})},xe.toRuntimeSource=gF,xe}function iD(e,t,a){e.colorSchemes&&a&&(e.colorSchemes[t]={...a!==!0&&a,palette:bO({...a===!0?{}:a.palette,mode:t})})}function xJ(e={},...t){const{palette:a,cssVariables:o=!1,colorSchemes:h=a?void 0:{light:!0},defaultColorScheme:y=a==null?void 0:a.mode,...b}=e,i=y||"light",C=h==null?void 0:h[i],I={...h,...a?{[i]:{...typeof C!="boolean"&&C,palette:a}}:void 0};if(o===!1){if(!("colorSchemes"in e))return f5(e,...t);let j=a;"palette"in e||I[i]&&(I[i]!==!0?j=I[i].palette:i==="dark"&&(j={mode:"dark"}));const F=f5({...e,palette:j},...t);return F.defaultColorScheme=i,F.colorSchemes=I,F.palette.mode==="light"&&(F.colorSchemes.light={...I.light!==!0&&I.light,palette:F.palette},iD(F,"dark",I.dark)),F.palette.mode==="dark"&&(F.colorSchemes.dark={...I.dark!==!0&&I.dark,palette:F.palette},iD(F,"light",I.light)),F}return!a&&!("light"in I)&&i==="light"&&(I.light=!0),vJ({...b,colorSchemes:I,defaultColorScheme:i,...typeof o!="boolean"&&o},...t)}const bJ=xJ(),wJ="$$material";function SJ(e){return e!=="ownerState"&&e!=="theme"&&e!=="sx"&&e!=="as"}const TJ=e=>SJ(e)&&e!=="classes",wO=wK({themeId:wJ,defaultTheme:bJ,rootShouldForwardProp:TJ}),xF=zK;function EJ(e){return kK(e)}function AJ(e){return typeof e.main=="string"}function CJ(e,t=[]){if(!AJ(e))return!1;for(const a of t)if(!e.hasOwnProperty(a)||typeof e[a]!="string")return!1;return!0}function MJ(e=[]){return([,t])=>t&&CJ(t,e)}function OJ(e){return hF("MuiCircularProgress",e)}yK("MuiCircularProgress",["root","determinate","indeterminate","colorPrimary","colorSecondary","svg","circle","circleDeterminate","circleIndeterminate","circleDisableShrink"]);const im=44,d5=lF`
  0% {
    transform: rotate(0deg);
  }

  100% {
    transform: rotate(360deg);
  }
`,p5=lF`
  0% {
    stroke-dasharray: 1px, 200px;
    stroke-dashoffset: 0;
  }

  50% {
    stroke-dasharray: 100px, 200px;
    stroke-dashoffset: -15px;
  }

  100% {
    stroke-dasharray: 1px, 200px;
    stroke-dashoffset: -126px;
  }
`,PJ=typeof d5!="string"?gO`
        animation: ${d5} 1.4s linear infinite;
      `:null,IJ=typeof p5!="string"?gO`
        animation: ${p5} 1.4s ease-in-out infinite;
      `:null,RJ=e=>{const{classes:t,variant:a,color:o,disableShrink:h}=e,y={root:["root",a,`color${Bg(o)}`],svg:["svg"],circle:["circle",`circle${Bg(a)}`,h&&"circleDisableShrink"]};return gX(y,OJ,t)},DJ=wO("span",{name:"MuiCircularProgress",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:a}=e;return[t.root,t[a.variant],t[`color${Bg(a.color)}`]]}})(xF(({theme:e})=>({display:"inline-block",variants:[{props:{variant:"determinate"},style:{transition:e.transitions.create("transform")}},{props:{variant:"indeterminate"},style:PJ||{animation:`${d5} 1.4s linear infinite`}},...Object.entries(e.palette).filter(MJ()).map(([t])=>({props:{color:t},style:{color:(e.vars||e).palette[t].main}}))]}))),LJ=wO("svg",{name:"MuiCircularProgress",slot:"Svg",overridesResolver:(e,t)=>t.svg})({display:"block"}),kJ=wO("circle",{name:"MuiCircularProgress",slot:"Circle",overridesResolver:(e,t)=>{const{ownerState:a}=e;return[t.circle,t[`circle${Bg(a.variant)}`],a.disableShrink&&t.circleDisableShrink]}})(xF(({theme:e})=>({stroke:"currentColor",variants:[{props:{variant:"determinate"},style:{transition:e.transitions.create("stroke-dashoffset")}},{props:{variant:"indeterminate"},style:{strokeDasharray:"80px, 200px",strokeDashoffset:0}},{props:({ownerState:t})=>t.variant==="indeterminate"&&!t.disableShrink,style:IJ||{animation:`${p5} 1.4s ease-in-out infinite`}}]}))),zJ=Ie.forwardRef(function(t,a){const o=EJ({props:t,name:"MuiCircularProgress"}),{className:h,color:y="primary",disableShrink:b=!1,size:i=40,style:C,thickness:I=3.6,value:j=0,variant:F="indeterminate",...G}=o,X={...o,color:y,disableShrink:b,size:i,thickness:I,value:j,variant:F},Y=RJ(X),J={},ee={},oe={};if(F==="determinate"){const ge=2*Math.PI*((im-I)/2);J.strokeDasharray=ge.toFixed(3),oe["aria-valuenow"]=Math.round(j),J.strokeDashoffset=`${((100-j)/100*ge).toFixed(3)}px`,ee.transform="rotate(-90deg)"}return ve.jsx(DJ,{className:oi(Y.root,h),style:{width:i,height:i,...ee,...C},ownerState:X,ref:a,role:"progressbar",...oe,...G,children:ve.jsx(LJ,{className:Y.svg,ownerState:X,viewBox:`${im/2} ${im/2} ${im} ${im}`,children:ve.jsx(kJ,{className:Y.circle,style:J,ownerState:X,cx:im,cy:im,r:(im-I)/2,fill:"none",strokeWidth:I})})})}),BJ="_loader_1n2lq_1",NJ={loader:BJ};function jg(e){return ve.jsx("div",{className:NJ.loader,children:ve.jsx(zJ,{className:e.className})})}const bF="data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M18%2015L12%209L6%2015'%20stroke='%23373435'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",FJ="_block_10teq_1",jJ="_block__icon_10teq_18",UJ="_block__text_10teq_24",OT={block:FJ,block__icon:jJ,block__text:UJ};function VJ(e){return ve.jsxs("div",{className:OT.block,children:[ve.jsx("img",{className:OT.block__icon,src:e.iconSrc,alt:"Icon"}),ve.jsx("a",{className:OT.block__text,children:e.text})]})}const $J="data:image/svg+xml,%3csvg%20width='64'%20height='64'%20viewBox='0%200%2064%2064'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%20%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M26.6663%205.33345H23.9997C16.4572%205.33345%2012.686%205.33345%2010.3428%207.6766C7.99967%2010.0197%207.99967%2013.791%207.99967%2021.3334V56.6668H5.33301C4.22844%2056.6668%203.33301%2057.5622%203.33301%2058.6668C3.33301%2059.7713%204.22844%2060.6668%205.33301%2060.6668H45.9997C47.1042%2060.6668%2047.9997%2059.7713%2047.9997%2058.6668C47.9997%2057.5622%2047.1042%2056.6668%2045.9997%2056.6668H42.6663V47.3335H46.8568C47.8562%2047.3335%2048.6663%2048.1437%2048.6663%2049.143V49.3335C48.6663%2052.6472%2051.3526%2055.3335%2054.6663%2055.3335C57.9801%2055.3335%2060.6663%2052.6472%2060.6663%2049.3335V20.2715C60.6664%2019.8537%2060.6664%2019.5655%2060.6506%2019.2844C60.5022%2016.6418%2059.3122%2014.1658%2057.3414%2012.3991C57.1317%2012.2112%2056.9066%2012.0311%2056.5804%2011.7702L53.2491%209.10512C52.3865%208.4151%2051.128%208.55494%2050.4379%209.41747C49.7479%2010.28%2049.8878%2011.5386%2050.7503%2012.2286L54.0385%2014.8592C54.4238%2015.1674%2054.5558%2015.2739%2054.6714%2015.3775C55.8538%2016.4376%2056.5678%2017.9232%2056.6569%2019.5087C56.6656%2019.6637%2056.6663%2019.8333%2056.6663%2020.3267V21.3334H54.6663C52.4572%2021.3334%2050.6663%2023.1243%2050.6663%2025.3334V31.7837C50.6663%2033.5055%2051.7681%2035.034%2053.4014%2035.5785L56.6663%2036.6668V49.3335C56.6663%2050.4381%2055.7709%2051.3335%2054.6663%2051.3335C53.5618%2051.3335%2052.6663%2050.4381%2052.6663%2049.3335V49.143C52.6663%2045.9345%2050.0653%2043.3335%2046.8568%2043.3335H42.6663V21.3334C42.6663%2013.791%2042.6663%2010.0197%2040.3232%207.6766C37.9801%205.33345%2034.2088%205.33345%2026.6663%205.33345ZM26.362%2024.9518C27.3092%2025.5201%2027.6163%2026.7486%2027.048%2027.6958L24.8654%2031.3334H29.333C30.0536%2031.3334%2030.7184%2031.721%2031.0734%2032.3481C31.4284%2032.9751%2031.4187%2033.7446%2031.048%2034.3624L27.048%2041.0291C26.4797%2041.9763%2025.2512%2042.2834%2024.304%2041.7151C23.3569%2041.1468%2023.0497%2039.9183%2023.618%2038.9711L25.8006%2035.3334H21.333C20.6125%2035.3334%2019.9476%2034.9459%2019.5926%2034.3188C19.2376%2033.6918%2019.2473%2032.9223%2019.618%2032.3045L23.618%2025.6378C24.1863%2024.6906%2025.4148%2024.3835%2026.362%2024.9518Z'%20fill='%238E949F'%20/%3e%3c/svg%3e",wF=()=>{const[e,t]=Ie.useState({width:window.innerWidth,height:window.innerHeight});return Ie.useEffect(()=>{window.onresize=()=>{t({width:window.innerWidth,height:window.innerHeight})}},[]),{windowSizes:e}},qJ=113;function SF(e){const{windowSizes:t}=wF(),[a,o]=Ie.useState(0),[h,y]=Ie.useState(!1),[b,i]=Ie.useState(!0),C=Ie.useRef(null),[I,j]=Ie.useState(!1),[F,G]=Ie.useState(!1),[X,Y]=Ie.useState(0),[J,ee]=Ie.useState(0),[oe,ge]=Ie.useState([]);Ie.useEffect(()=>{xe()},[]);const fe=dW,xe=()=>{e.items||(y(!0),e.getData(a,fe).then(ye=>{ye.length<fe?i(!1):o(dt=>dt+fe);const ke=oe.concat(ye);ge(ke),e.onDataLoad(ke)}).finally(()=>{y(!1)}))},ae=ye=>{const ke=ye.target,dt=ke.scrollHeight<=ke.scrollTop+ke.clientHeight,vt=ke.scrollHeight>ke.clientHeight,jt=ke.scrollTop>0;j(!!(vt&&jt)),dt&&b&&xe()},me=()=>{C.current&&C.current.scrollTo({top:0,behavior:"smooth"})},we=ye=>{G(!0),Y(ye.clientX),ee(ye.clientY)},Ge=ye=>{if(!F)return;const ke=C.current;if(!ke)return;const dt=ye.clientX-X,vt=ye.clientY-J;ke.scrollTop-=vt,ke.scrollLeft-=dt,Y(ye.clientX),ee(ye.clientY),ye.preventDefault()},He=()=>{G(!1)};return ve.jsxs("div",{children:[ve.jsxs("div",{ref:C,onScroll:ae,onMouseDown:we,onMouseMove:Ge,onMouseUp:He,onMouseLeave:He,className:Ux.listLayout__list,style:{height:t.height-qJ+"px"},children:[(h&&e.items.length===0||e.loading)&&ve.jsx(jg,{}),!h&&e.items.length===0&&!e.loading&&ve.jsx(VJ,{text:"    ",iconSrc:$J}),e.items.length>0&&!e.loading&&ve.jsx("div",{className:Ux.list_noSelection,children:e.items.map((ye,ke)=>ve.jsx("div",{className:Ux.list__item,children:ye},ke))})]}),h&&e.items.length>0&&ve.jsx(jg,{}),I&&ve.jsx("div",{className:Ux.listLayout__blockButton,children:ve.jsx(vf,{onClick:me,variant:"iconSmall",iconSrc:bF})})]})}const GJ="_contentBlockLayout_hmsvr_1",HJ={contentBlockLayout:GJ};function ko(e){return ve.jsx("div",{className:`${HJ.contentBlockLayout} ${e.className??""}`,children:e.children})}const ZJ="_stationCard_hg7rg_1",WJ="_stationCard__header_hg7rg_11",XJ="_header__mainInfo_hg7rg_18",YJ="_path__icon_hg7rg_25",KJ="_mainInfo__texts_hg7rg_35",JJ="_texts__name_hg7rg_41",QJ="_texts__description_hg7rg_54",eQ="_path__text_hg7rg_55",tQ="_content__path_hg7rg_70",nQ="_stationCard__body_hg7rg_78",rQ="_body__connectorsList_hg7rg_85",iQ="_connectorsList_hg7rg_90",eu={stationCard:ZJ,stationCard__header:WJ,header__mainInfo:XJ,path__icon:YJ,mainInfo__texts:KJ,texts__name:JJ,texts__description:QJ,path__text:eQ,content__path:tQ,stationCard__body:nQ,body__connectorsList:rQ,connectorsList:iQ},TF="/assets/path-ck7PA2gW.svg",aQ="_connector_x9hex_1",oQ="_connector__wrap_x9hex_7",sQ="_connector__icon_x9hex_14",lQ="_connector__content_x9hex_21",cQ="_content__main_x9hex_28",uQ="_main__standard_x9hex_37",hQ="_main__power_x9hex_46",fQ="_content__additional_x9hex_55",dQ="_additional__verticalSplit_x9hex_65",pQ="_connector__horizontalSplit_x9hex_75",uf={connector:aQ,connector__wrap:oQ,connector__icon:sQ,connector__content:lQ,content__main:cQ,main__standard:uQ,main__power:hQ,content__additional:fQ,additional__verticalSplit:dQ,connector__horizontalSplit:pQ},mQ="_status_6yzdt_1",_Q="_green_6yzdt_14",gQ="_orange_6yzdt_19",yQ="_red_6yzdt_24",vQ="_grey_6yzdt_29",xQ="_text_6yzdt_34",PT={status:mQ,green:_Q,orange:gQ,red:yQ,grey:vQ,text:xQ};function Jw(e){const t=e.color,o={fontSize:{small:12,medium:14,large:16}[e.textSize]+"px"};return ve.jsx("div",{className:`${PT.status} ${e.className??""} ${PT[t]}`,children:ve.jsx("p",{className:PT.text,style:o,children:e.text})})}function bQ(e){return ve.jsxs("div",{className:uf.connector,children:[ve.jsxs("div",{className:uf.connector__wrap,children:[ve.jsx("img",{src:g2[e.connector.standard],alt:e.connector.standard,className:uf.connector__icon}),ve.jsxs("div",{className:uf.connector__content,children:[ve.jsxs("div",{className:uf.content__main,children:[ve.jsx("p",{className:uf.main__standard,children:e.connector.standard}),ve.jsxs("p",{className:uf.main__power,children:[pW(e.connector)," "]})]}),ve.jsxs("div",{className:uf.content__additional,children:[ve.jsx("div",{className:uf.additional__verticalSplit}),ve.jsx(Jw,{textSize:"small",text:e.connector.status,color:RN[e.connector.status]})]})]})]}),!e.isLast&&ve.jsx("div",{className:uf.connector__horizontalSplit})]})}const wQ="_marker_1r2ud_1",SQ="_marker_green_1r2ud_17",TQ="_marker_orange_1r2ud_21",EQ="_marker_grey_1r2ud_25",aD={marker:wQ,marker_green:SQ,marker_orange:TQ,marker_grey:EQ},AQ="data:image/svg+xml,%3csvg%20width='14'%20height='13'%20viewBox='0%200%2014%2013'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M5.83335%200.166672H5.25002C3.6001%200.166672%202.77515%200.166672%202.26258%200.679235C1.75002%201.1918%201.75002%202.01676%201.75002%203.66667V11.3958H1.16669C0.925062%2011.3958%200.729187%2011.5917%200.729187%2011.8333C0.729187%2012.075%200.925062%2012.2708%201.16669%2012.2708H10.0625C10.3041%2012.2708%2010.5%2012.075%2010.5%2011.8333C10.5%2011.5917%2010.3041%2011.3958%2010.0625%2011.3958H9.33335V9.35419H10.25C10.4686%209.35419%2010.6459%209.53141%2010.6459%209.75002V9.79169C10.6459%2010.5166%2011.2335%2011.1042%2011.9584%2011.1042C12.6832%2011.1042%2013.2709%2010.5166%2013.2709%209.79169V3.43437C13.2709%203.34298%2013.2709%203.27993%2013.2674%203.21844C13.2349%202.64037%2012.9746%202.09875%2012.5435%201.71228C12.4977%201.67118%2012.4484%201.63179%2012.3771%201.57471L11.6483%200.991724C11.4596%200.840783%2011.1843%200.871373%2011.0334%201.06005C10.8824%201.24873%2010.913%201.52404%2011.1017%201.67498L11.821%202.25042C11.9053%202.31785%2011.9342%202.34115%2011.9594%202.36382C12.2181%202.5957%2012.3743%202.92067%2012.3938%203.26751C12.3957%203.30141%2012.3959%203.33851%2012.3959%203.44645V3.66667H11.9584C11.4751%203.66667%2011.0834%204.05842%2011.0834%204.54167V5.95267C11.0834%206.3293%2011.3244%206.66367%2011.6817%206.78277L12.3959%207.02084V9.79169C12.3959%2010.0333%2012.2%2010.2292%2011.9584%2010.2292C11.7167%2010.2292%2011.5209%2010.0333%2011.5209%209.79169V9.75002C11.5209%209.04816%2010.9519%208.47919%2010.25%208.47919H9.33335V3.66667C9.33335%202.01676%209.33335%201.1918%208.82079%200.679235C8.30823%200.166672%207.48327%200.166672%205.83335%200.166672ZM5.76678%204.45819C5.97397%204.5825%206.04115%204.85124%205.91684%205.05843L5.4394%205.85417H6.41669C6.57431%205.85417%206.71974%205.93896%206.7974%206.07612C6.87506%206.21328%206.87293%206.38161%206.79184%206.51676L5.91684%207.9751C5.79253%208.18229%205.52379%208.24947%205.3166%208.12516C5.1094%208.00084%205.04222%207.7321%205.16653%207.52491L5.64398%206.72917H4.66669C4.50907%206.72917%204.36363%206.64439%204.28597%206.50723C4.20832%206.37007%204.21044%206.20174%204.29153%206.06658L5.16653%204.60825C5.29085%204.40105%205.55959%204.33387%205.76678%204.45819Z'%20fill='white'/%3e%3c/svg%3e";function EF(e){return ve.jsx("div",{className:`${aD.marker} ${aD[`marker_${e.color}`]}`,children:ve.jsx("img",{src:AQ,alt:"Station marker"})})}function AF(e){const t=()=>{e.onClick&&e.onClick()},a=e.station.connectors.length>0?e.station.connectors:[e.station.connectors[0]];return ve.jsxs("div",{className:eu.stationCard,onClick:t,children:[ve.jsxs("div",{className:eu.stationCard__header,children:[ve.jsxs("div",{className:eu.header__mainInfo,children:[ve.jsx(EF,{color:aO[e.station.status]}),ve.jsxs("div",{className:eu.mainInfo__texts,children:[ve.jsx("p",{className:eu.texts__name,children:e.station.name}),ve.jsx("p",{className:eu.texts__description,children:e.station.address})]})]}),e.station.metres_to_station!==void 0&&e.showDistance&&ve.jsxs("div",{className:eu.content__path,children:[ve.jsx("div",{className:eu.path__icon,children:ve.jsx("img",{src:TF,alt:"path"})}),ve.jsxs("p",{className:eu.path__text,children:[e.station.metres_to_station," "]})]})]}),ve.jsx("div",{className:eu.stationCard__body,children:ve.jsx("div",{className:eu.body__connectorsList,children:ve.jsx("div",{className:eu.connectorsList,children:a.map((o,h)=>ve.jsx(bQ,{connector:o,isLast:h===a.length-1},o.id))})})})]})}const CQ="_returnButton_vefju_1",MQ="_returnButton_disabled_vefju_16",oD={returnButton:CQ,returnButton_disabled:MQ};function OQ(e){return ve.jsx("button",{className:`${oD.returnButton} ${e.disabled?oD.returnButton_disabled:""}`,onClick:e.onClick,disabled:e.disabled,children:ve.jsx("img",{src:e.iconSrc,alt:"returnButton"})})}const PQ="data:image/svg+xml,%3csvg%20width='18'%20height='14'%20viewBox='0%200%2018%2014'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M17%207H1M1%207L7%201M1%207L7%2013'%20stroke='%23373435'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",IQ="_header_1vyst_1",RQ="_header__left_1vyst_10",DQ="_header__right_1vyst_11",LQ="_header__title_1vyst_15",kQ="_title__text_1vyst_26",kv={header:IQ,header__left:RQ,header__right:DQ,header__title:LQ,title__text:kQ};function zQ(e){const{isInitTelegramSdk:t}=Ie.useContext(Bo);return ve.jsxs("div",{className:kv.header,children:[(!t||!1)&&ve.jsx("div",{className:kv.header__left,children:ve.jsx(OQ,{onClick:e.onReturn,iconSrc:PQ})}),ve.jsx("div",{className:kv.header__title,children:ve.jsx("a",{className:kv.title__text,children:e.title})}),ve.jsx("div",{className:kv.header__right,children:e.content})]})}const BQ="_page_kv1d5_1",CF={page:BQ},NQ="_page__loader_7rido_1",FQ={page__loader:NQ};function Qd(e){return ve.jsxs("div",{className:`${CF.page} ${e.className}`,children:[ve.jsx(zQ,{onReturn:e.onReturn,title:e.title,content:e.headerContent}),e.loading?ve.jsx("div",{className:FQ.page__loader,children:ve.jsx(jg,{})}):e.children]})}function jQ(){const e=zo(),{stations:t,setStations:a}=Ie.useContext(Bo),{getByOffsetAndLimit:o,loading:h}=HW(),y=()=>{e(rO+lc([{key:T1.PREVIOUS_PAGE,value:zg.STATIONS_LIST}]))},b=i=>{e(_2+i+lc([{key:Hd.PREVIOUS_PAGE,value:Vd.STATIONS_LIST}]))};return ve.jsx(Qd,{onReturn:()=>e("/"),title:" ",headerContent:ve.jsx(zw,{iconSrc:iO,onClick:y,variant:"fill"}),children:ve.jsx(SF,{items:t.map((i,C)=>ve.jsx(ko,{className:JZ.stationsList__station,children:ve.jsx(AF,{onClick:()=>b(i.id),station:i,showDistance:!0})},C)),getData:(i,C)=>o(i,C),onDataLoad:i=>a(i),loading:h})})}const UQ="_carousel_8jrs2_1",VQ="_carousel__item_8jrs2_27",$Q="_item__image_8jrs2_35",IT={carousel:UQ,carousel__item:VQ,item__image:$Q};var Gx={},dg={},Ca={},RT={},sD;function SO(){return sD||(sD=1,function(e){function t(b,i,C){var I=i.slidesToShow,j=i.currentSlide;return C.length>2*I?b+2*I:j>=C.length?C.length+b:b}function a(b,i){if(i.length>2*b){for(var C={},I=i.length-2*b,j=i.length-I,F=I,G=0;G<j;G++)C[G]=F,F++;var X=i.length+j,Y=X+i.slice(0,2*b).length,J=0;for(G=X;G<=Y;G++)C[G]=J,J++;var ee=X,oe=0;for(G=j;G<ee;G++)C[G]=oe,oe++;return C}C={};var ge=3*i.length,fe=0;for(G=0;G<ge;G++)C[G]=fe,++fe===i.length&&(fe=0);return C}function o(b,i){return i.length<b?i:i.length>2*b?i.slice(i.length-2*b,i.length).concat(i,i.slice(0,2*b)):i.concat(i,i)}function h(b,i){return i.length>2*b?2*b:i.length}function y(b,i,C){var I,j=b.currentSlide,F=b.slidesToShow,G=b.itemWidth,X=b.totalItems,Y=0,J=0,ee=j===0,oe=i.length-(i.length-2*F);return i.length<F?(J=Y=0,ee=I=!1):i.length>2*F?((I=j>=oe+i.length)&&(J=-G*(Y=j-i.length)),ee&&(J=-G*(Y=oe+(i.length-2*F)))):((I=j>=2*i.length)&&(J=-G*(Y=j-i.length)),ee&&(J=C.showDots?-G*(Y=i.length):-G*(Y=X/3))),{isReachingTheEnd:I,isReachingTheStart:ee,nextSlide:Y,nextPosition:J}}Object.defineProperty(e,"__esModule",{value:!0}),e.getOriginalCounterPart=t,e.getOriginalIndexLookupTableByClones=a,e.getClones=o,e.getInitialSlideInInfiniteMode=h,e.checkClonesPosition=y}(RT)),RT}var pg={},lD;function MF(){if(lD)return pg;lD=1,Object.defineProperty(pg,"__esModule",{value:!0});function e(o,h,y,b){var i=0,C=b||y;return h&&C&&(i=o[C].partialVisibilityGutter||o[C].paritialVisibilityGutter),i}function t(o,h){var y;return h[o]&&(y=(100/h[o].items).toFixed(1)),y}function a(o,h,y){return Math.round(y/(h+(o.centerMode?1:0)))}return pg.getPartialVisibilityGutter=e,pg.getWidthFromDeviceType=t,pg.getItemClientSideWidth=a,pg}var ec={},cD;function G0(){if(cD)return ec;cD=1,Object.defineProperty(ec,"__esModule",{value:!0});var e=MF();function t(F){var G=F.slidesToShow;return F.totalItems<G}function a(F,G){var X,Y=F.domLoaded,J=F.slidesToShow,ee=F.containerWidth,oe=F.itemWidth,ge=G.deviceType,fe=G.responsive,xe=G.ssr,ae=G.partialVisbile,me=G.partialVisible,we=!!(Y&&J&&ee&&oe);xe&&ge&&!we&&(X=e.getWidthFromDeviceType(ge,fe));var Ge=!!(xe&&ge&&!we&&X);return{shouldRenderOnSSR:Ge,flexBisis:X,domFullyLoaded:we,partialVisibilityGutter:e.getPartialVisibilityGutter(fe,ae||me,ge,F.deviceType),shouldRenderAtAll:Ge||we}}function o(F,G){var X=G.currentSlide,Y=G.slidesToShow;return X<=F&&F<X+Y}function h(F,G,X){var Y=X||F.transform;return!G.infinite&&F.currentSlide===0||t(F)?Y:Y+F.itemWidth/2}function y(F){return!(0<F.currentSlide)}function b(F){var G=F.currentSlide,X=F.totalItems;return!(G+F.slidesToShow<X)}function i(F,G,X,Y){G===void 0&&(G=0);var J=F.currentSlide,ee=F.slidesToShow,oe=b(F),ge=!X.infinite&&oe,fe=Y||F.transform;if(t(F))return fe;var xe=fe+J*G;return ge?xe+(F.containerWidth-(F.itemWidth-G)*ee):xe}function C(F,G){return F.rtl?-1*G:G}function I(F,G,X){var Y=G.partialVisbile,J=G.partialVisible,ee=G.responsive,oe=G.deviceType,ge=G.centerMode,fe=X||F.transform,xe=e.getPartialVisibilityGutter(ee,Y||J,oe,F.deviceType);return C(G,J||Y?i(F,xe,G,X):ge?h(F,G,X):fe)}function j(F,G){var X=F.domLoaded,Y=F.slidesToShow,J=F.containerWidth,ee=F.itemWidth,oe=G.deviceType,ge=G.responsive,fe=G.slidesToSlide||1,xe=!!(X&&Y&&J&&ee);return G.ssr&&G.deviceType&&!xe&&Object.keys(ge).forEach(function(ae){var me=ge[ae].slidesToSlide;oe===ae&&me&&(fe=me)}),xe&&Object.keys(ge).forEach(function(ae){var me=ge[ae],we=me.breakpoint,Ge=me.slidesToSlide,He=we.max,ye=we.min;Ge&&window.innerWidth>=ye&&window.innerWidth<=He&&(fe=Ge)}),fe}return ec.notEnoughChildren=t,ec.getInitialState=a,ec.getIfSlideIsVisbile=o,ec.getTransformForCenterMode=h,ec.isInLeftEnd=y,ec.isInRightEnd=b,ec.getTransformForPartialVsibile=i,ec.parsePosition=C,ec.getTransform=I,ec.getSlidesToSlide=j,ec}var Hx={},uD;function qQ(){if(uD)return Hx;uD=1,Object.defineProperty(Hx,"__esModule",{value:!0});var e=function(t,a,o){var h;return function(){var y=arguments;h||(t.apply(this,y),h=!0,typeof o=="function"&&o(!0),setTimeout(function(){h=!1,typeof o=="function"&&o(!1)},a))}};return Hx.default=e,Hx}var DT={},hD;function GQ(){return hD||(hD=1,function(e){function t(a,o){var h=o.partialVisbile,y=o.partialVisible,b=o.centerMode,i=o.ssr,C=o.responsive;if((h||y)&&b)throw new Error("center mode can not be used at the same time with partialVisible");if(!C)throw i?new Error("ssr mode need to be used in conjunction with responsive prop"):new Error("Responsive prop is needed for deciding the amount of items to show on the screen");if(C&&typeof C!="object")throw new Error("responsive prop must be an object")}Object.defineProperty(e,"__esModule",{value:!0}),e.default=t}(DT)),DT}var Zx={},fD;function HQ(){if(fD)return Zx;fD=1,Object.defineProperty(Zx,"__esModule",{value:!0});var e=G0();function t(a,o,h){h===void 0&&(h=0);var y,b,i=a.slidesToShow,C=a.currentSlide,I=a.itemWidth,j=a.totalItems,F=e.getSlidesToSlide(a,o),G=C+1+h+i+(0<h?0:F);return b=G<=j?-I*(y=C+h+(0<h?0:F)):j<G&&C!==j-i?-I*(y=j-i):y=void 0,{nextSlides:y,nextPosition:b}}return Zx.populateNextSlides=t,Zx}var Wx={},dD;function ZQ(){if(dD)return Wx;dD=1,Object.defineProperty(Wx,"__esModule",{value:!0});var e=Kd(),t=G0(),a=G0();function o(h,y,b){b===void 0&&(b=0);var i,C,I=h.currentSlide,j=h.itemWidth,F=h.slidesToShow,G=y.children,X=y.showDots,Y=y.infinite,J=t.getSlidesToSlide(h,y),ee=I-b-(0<b?0:J),oe=(e.Children.toArray(G).length-F)%J;return C=0<=ee?(i=ee,X&&!Y&&0<oe&&a.isInRightEnd(h)&&(i=I-oe),-j*i):i=ee<0&&I!==0?0:void 0,{nextSlides:i,nextPosition:C}}return Wx.populatePreviousSlides=o,Wx}var LT={},pD;function WQ(){return pD||(pD=1,function(e){function t(a,o,h,y,b,i){var C,I,j=a.itemWidth,F=a.slidesToShow,G=a.totalItems,X=a.currentSlide,Y=o.infinite,J=!1,ee=Math.round((h-y)/j),oe=Math.round((y-h)/j),ge=h<b;if(b<h&&ee<=F){C="right";var fe=Math.abs(-j*(G-F)),xe=i-(y-b),ae=X===G-F;(Math.abs(xe)<=fe||ae&&Y)&&(I=xe,J=!0)}return ge&&oe<=F&&(C="left",((xe=i+(b-y))<=0||X===0&&Y)&&(J=!0,I=xe)),{direction:C,nextPosition:I,canContinue:J}}Object.defineProperty(e,"__esModule",{value:!0}),e.populateSlidesOnMouseTouchMove=t}(LT)),LT}var mD;function OF(){if(mD)return Ca;mD=1,Object.defineProperty(Ca,"__esModule",{value:!0});var e=SO();Ca.getOriginalCounterPart=e.getOriginalCounterPart,Ca.getClones=e.getClones,Ca.checkClonesPosition=e.checkClonesPosition,Ca.getInitialSlideInInfiniteMode=e.getInitialSlideInInfiniteMode;var t=MF();Ca.getWidthFromDeviceType=t.getWidthFromDeviceType,Ca.getPartialVisibilityGutter=t.getPartialVisibilityGutter,Ca.getItemClientSideWidth=t.getItemClientSideWidth;var a=G0();Ca.getInitialState=a.getInitialState,Ca.getIfSlideIsVisbile=a.getIfSlideIsVisbile,Ca.getTransformForCenterMode=a.getTransformForCenterMode,Ca.getTransformForPartialVsibile=a.getTransformForPartialVsibile,Ca.isInLeftEnd=a.isInLeftEnd,Ca.isInRightEnd=a.isInRightEnd,Ca.notEnoughChildren=a.notEnoughChildren,Ca.getSlidesToSlide=a.getSlidesToSlide;var o=qQ();Ca.throttle=o.default;var h=GQ();Ca.throwError=h.default;var y=HQ();Ca.populateNextSlides=y.populateNextSlides;var b=ZQ();Ca.populatePreviousSlides=b.populatePreviousSlides;var i=WQ();return Ca.populateSlidesOnMouseTouchMove=i.populateSlidesOnMouseTouchMove,Ca}var M0={},_D;function XQ(){if(_D)return M0;_D=1;var e=M0&&M0.__extends||function(){var h=function(y,b){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,C){i.__proto__=C}||function(i,C){for(var I in C)C.hasOwnProperty(I)&&(i[I]=C[I])})(y,b)};return function(y,b){function i(){this.constructor=y}h(y,b),y.prototype=b===null?Object.create(b):(i.prototype=b.prototype,new i)}}();Object.defineProperty(M0,"__esModule",{value:!0});var t=Kd();function a(h){return"clientY"in h}M0.isMouseMoveEvent=a;var o=function(h){function y(){return h!==null&&h.apply(this,arguments)||this}return e(y,h),y}(t.Component);return M0.default=o,M0}var Xx={},Yx={},gD;function YQ(){if(gD)return Yx;gD=1,Object.defineProperty(Yx,"__esModule",{value:!0});var e=SO(),t=G0();function a(o,h,y,b){var i={},C=t.getSlidesToSlide(h,y);return Array(o).fill(0).forEach(function(I,j){var F=e.getOriginalCounterPart(j,h,b);if(j===0)i[0]=F;else{var G=i[j-1]+C;i[j]=G}}),i}return Yx.getLookupTableForNextSlides=a,Yx}var yD;function KQ(){if(yD)return Xx;yD=1,Object.defineProperty(Xx,"__esModule",{value:!0});var e=Kd(),t=SO(),a=YQ(),o=G0(),h=function(y){var b=y.props,i=y.state,C=y.goToSlide,I=y.getState,j=b.showDots,F=b.customDot,G=b.dotListClass,X=b.infinite,Y=b.children;if(!j||o.notEnoughChildren(i))return null;var J,ee=i.currentSlide,oe=i.slidesToShow,ge=o.getSlidesToSlide(i,b),fe=e.Children.toArray(Y);J=X?Math.ceil(fe.length/ge):Math.ceil((fe.length-oe)/ge)+1;var xe=a.getLookupTableForNextSlides(J,i,b,fe),ae=t.getOriginalIndexLookupTableByClones(oe,fe),me=ae[ee];return e.createElement("ul",{className:"react-multi-carousel-dot-list "+G},Array(J).fill(0).map(function(we,Ge){var He,ye;if(X){ye=xe[Ge];var ke=ae[ye];He=me===ke||ke<=me&&me<ke+ge}else{var dt=fe.length-oe,vt=Ge*ge;He=(ye=dt<vt?dt:vt)===ee||ye<ee&&ee<ye+ge&&ee<fe.length-oe}return F?e.cloneElement(F,{index:Ge,active:He,key:Ge,onClick:function(){return C(ye)},carouselState:I()}):e.createElement("li",{"data-index":Ge,key:Ge,className:"react-multi-carousel-dot "+(He?"react-multi-carousel-dot--active":"")},e.createElement("button",{"aria-label":"Go to slide "+(Ge+1),onClick:function(){return C(ye)}}))}))};return Xx.default=h,Xx}var zv={},vD;function JQ(){if(vD)return zv;vD=1,Object.defineProperty(zv,"__esModule",{value:!0});var e=Kd(),t=function(o){var h=o.customLeftArrow,y=o.getState,b=o.previous,i=o.disabled,C=o.rtl;if(h)return e.cloneElement(h,{onClick:function(){return b()},carouselState:y(),disabled:i,rtl:C});var I=C?"rtl":"";return e.createElement("button",{"aria-label":"Go to previous slide",className:"react-multiple-carousel__arrow react-multiple-carousel__arrow--left "+I,onClick:function(){return b()},type:"button",disabled:i})};zv.LeftArrow=t;var a=function(o){var h=o.customRightArrow,y=o.getState,b=o.next,i=o.disabled,C=o.rtl;if(h)return e.cloneElement(h,{onClick:function(){return b()},carouselState:y(),disabled:i,rtl:C});var I=C?"rtl":"";return e.createElement("button",{"aria-label":"Go to next slide",className:"react-multiple-carousel__arrow react-multiple-carousel__arrow--right "+I,onClick:function(){return b()},type:"button",disabled:i})};return zv.RightArrow=a,zv}var Kx={},xD;function QQ(){if(xD)return Kx;xD=1,Object.defineProperty(Kx,"__esModule",{value:!0});var e=Kd(),t=OF(),a=function(o){var h=o.props,y=o.state,b=o.goToSlide,i=o.clones,C=o.notEnoughChildren,I=y.itemWidth,j=h.children,F=h.infinite,G=h.itemClass,X=h.itemAriaLabel,Y=h.partialVisbile,J=h.partialVisible,ee=t.getInitialState(y,h),oe=ee.flexBisis,ge=ee.shouldRenderOnSSR,fe=ee.domFullyLoaded,xe=ee.partialVisibilityGutter;return ee.shouldRenderAtAll?(Y&&console.warn('WARNING: Please correct props name: "partialVisible" as old typo will be removed in future versions!'),e.createElement(e.Fragment,null,(F?i:e.Children.toArray(j)).map(function(ae,me){return e.createElement("li",{key:me,"data-index":me,onClick:function(){h.focusOnSelect&&b(me)},"aria-hidden":t.getIfSlideIsVisbile(me,y)?"false":"true","aria-label":X||(ae.props.ariaLabel?ae.props.ariaLabel:null),style:{flex:ge?"1 0 "+oe+"%":"auto",position:"relative",width:fe?((Y||J)&&xe&&!C?I-xe:I)+"px":"auto"},className:"react-multi-carousel-item "+(t.getIfSlideIsVisbile(me,y)?"react-multi-carousel-item--active":"")+" "+G},ae)}))):null};return Kx.default=a,Kx}var bD;function eee(){if(bD)return dg;bD=1;var e=dg&&dg.__extends||function(){var F=function(G,X){return(F=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(Y,J){Y.__proto__=J}||function(Y,J){for(var ee in J)J.hasOwnProperty(ee)&&(Y[ee]=J[ee])})(G,X)};return function(G,X){function Y(){this.constructor=G}F(G,X),G.prototype=X===null?Object.create(X):(Y.prototype=X.prototype,new Y)}}();Object.defineProperty(dg,"__esModule",{value:!0});var t=Kd(),a=OF(),o=XQ(),h=KQ(),y=JQ(),b=QQ(),i=G0(),C=400,I="transform 400ms ease-in-out",j=function(F){function G(X){var Y=F.call(this,X)||this;return Y.containerRef=t.createRef(),Y.listRef=t.createRef(),Y.state={itemWidth:0,slidesToShow:0,currentSlide:0,totalItems:t.Children.count(X.children),deviceType:"",domLoaded:!1,transform:0,containerWidth:0},Y.onResize=Y.onResize.bind(Y),Y.handleDown=Y.handleDown.bind(Y),Y.handleMove=Y.handleMove.bind(Y),Y.handleOut=Y.handleOut.bind(Y),Y.onKeyUp=Y.onKeyUp.bind(Y),Y.handleEnter=Y.handleEnter.bind(Y),Y.setIsInThrottle=Y.setIsInThrottle.bind(Y),Y.next=a.throttle(Y.next.bind(Y),X.transitionDuration||C,Y.setIsInThrottle),Y.previous=a.throttle(Y.previous.bind(Y),X.transitionDuration||C,Y.setIsInThrottle),Y.goToSlide=a.throttle(Y.goToSlide.bind(Y),X.transitionDuration||C,Y.setIsInThrottle),Y.onMove=!1,Y.initialX=0,Y.lastX=0,Y.isAnimationAllowed=!1,Y.direction="",Y.initialY=0,Y.isInThrottle=!1,Y.transformPlaceHolder=0,Y}return e(G,F),G.prototype.resetTotalItems=function(){var X=this,Y=t.Children.count(this.props.children),J=a.notEnoughChildren(this.state)?0:Math.max(0,Math.min(this.state.currentSlide,Y));this.setState({totalItems:Y,currentSlide:J},function(){X.setContainerAndItemWidth(X.state.slidesToShow,!0)})},G.prototype.setIsInThrottle=function(X){X===void 0&&(X=!1),this.isInThrottle=X},G.prototype.setTransformDirectly=function(X,Y){var J=this.props.additionalTransfrom;this.transformPlaceHolder=X;var ee=i.getTransform(this.state,this.props,this.transformPlaceHolder);this.listRef&&this.listRef.current&&(this.setAnimationDirectly(Y),this.listRef.current.style.transform="translate3d("+(ee+J)+"px,0,0)")},G.prototype.setAnimationDirectly=function(X){this.listRef&&this.listRef.current&&(this.listRef.current.style.transition=X?this.props.customTransition||I:"none")},G.prototype.componentDidMount=function(){this.setState({domLoaded:!0}),this.setItemsToShow(),window.addEventListener("resize",this.onResize),this.onResize(!0),this.props.keyBoardControl&&window.addEventListener("keyup",this.onKeyUp),this.props.autoPlay&&(this.autoPlay=setInterval(this.next,this.props.autoPlaySpeed))},G.prototype.setClones=function(X,Y,J,ee){var oe=this;ee===void 0&&(ee=!1),this.isAnimationAllowed=!1;var ge=t.Children.toArray(this.props.children),fe=a.getInitialSlideInInfiniteMode(X||this.state.slidesToShow,ge),xe=a.getClones(this.state.slidesToShow,ge),ae=ge.length<this.state.slidesToShow?0:this.state.currentSlide;this.setState({totalItems:xe.length,currentSlide:J&&!ee?ae:fe},function(){oe.correctItemsPosition(Y||oe.state.itemWidth)})},G.prototype.setItemsToShow=function(X,Y){var J=this,ee=this.props.responsive;Object.keys(ee).forEach(function(oe){var ge=ee[oe],fe=ge.breakpoint,xe=ge.items,ae=fe.max,me=fe.min,we=[window.innerWidth];window.screen&&window.screen.width&&we.push(window.screen.width);var Ge=Math.min.apply(Math,we);me<=Ge&&Ge<=ae&&(J.setState({slidesToShow:xe,deviceType:oe}),J.setContainerAndItemWidth(xe,X,Y))})},G.prototype.setContainerAndItemWidth=function(X,Y,J){var ee=this;if(this.containerRef&&this.containerRef.current){var oe=this.containerRef.current.offsetWidth,ge=a.getItemClientSideWidth(this.props,X,oe);this.setState({containerWidth:oe,itemWidth:ge},function(){ee.props.infinite&&ee.setClones(X,ge,Y,J)}),Y&&this.correctItemsPosition(ge)}},G.prototype.correctItemsPosition=function(X,Y,J){Y&&(this.isAnimationAllowed=!0),!Y&&this.isAnimationAllowed&&(this.isAnimationAllowed=!1);var ee=this.state.totalItems<this.state.slidesToShow?0:-X*this.state.currentSlide;J&&this.setTransformDirectly(ee,!0),this.setState({transform:ee})},G.prototype.onResize=function(X){var Y;Y=!!this.props.infinite&&(typeof X!="boolean"||!X),this.setItemsToShow(Y)},G.prototype.componentDidUpdate=function(X,Y){var J=this,ee=X.keyBoardControl,oe=X.autoPlay,ge=X.children,fe=Y.containerWidth,xe=Y.domLoaded,ae=Y.currentSlide;if(this.containerRef&&this.containerRef.current&&this.containerRef.current.offsetWidth!==fe&&(this.itemsToShowTimeout&&clearTimeout(this.itemsToShowTimeout),this.itemsToShowTimeout=setTimeout(function(){J.setItemsToShow(!0)},this.props.transitionDuration||C)),ee&&!this.props.keyBoardControl&&window.removeEventListener("keyup",this.onKeyUp),!ee&&this.props.keyBoardControl&&window.addEventListener("keyup",this.onKeyUp),oe&&!this.props.autoPlay&&this.autoPlay&&(clearInterval(this.autoPlay),this.autoPlay=void 0),oe||!this.props.autoPlay||this.autoPlay||(this.autoPlay=setInterval(this.next,this.props.autoPlaySpeed)),ge.length!==this.props.children.length?G.clonesTimeout=setTimeout(function(){J.props.infinite?J.setClones(J.state.slidesToShow,J.state.itemWidth,!0,!0):J.resetTotalItems()},this.props.transitionDuration||C):this.props.infinite&&this.state.currentSlide!==ae&&this.correctClonesPosition({domLoaded:xe}),this.transformPlaceHolder!==this.state.transform&&(this.transformPlaceHolder=this.state.transform),this.props.autoPlay&&this.props.rewind&&!this.props.infinite&&a.isInRightEnd(this.state)){var me=this.props.transitionDuration||C;G.isInThrottleTimeout=setTimeout(function(){J.setIsInThrottle(!1),J.resetAutoplayInterval(),J.goToSlide(0,void 0,!!J.props.rewindWithAnimation)},me+this.props.autoPlaySpeed)}},G.prototype.correctClonesPosition=function(X){var Y=this,J=X.domLoaded,ee=t.Children.toArray(this.props.children),oe=a.checkClonesPosition(this.state,ee,this.props),ge=oe.isReachingTheEnd,fe=oe.isReachingTheStart,xe=oe.nextSlide,ae=oe.nextPosition;this.state.domLoaded&&J&&(ge||fe)&&(this.isAnimationAllowed=!1,G.transformTimeout=setTimeout(function(){Y.setState({transform:ae,currentSlide:xe})},this.props.transitionDuration||C))},G.prototype.next=function(X){var Y=this;X===void 0&&(X=0);var J=this.props,ee=J.afterChange,oe=J.beforeChange;if(!a.notEnoughChildren(this.state)){var ge=a.populateNextSlides(this.state,this.props,X),fe=ge.nextSlides,xe=ge.nextPosition,ae=this.state.currentSlide;fe!==void 0&&xe!==void 0&&(typeof oe=="function"&&oe(fe,this.getState()),this.isAnimationAllowed=!0,this.props.shouldResetAutoplay&&this.resetAutoplayInterval(),this.setState({transform:xe,currentSlide:fe},function(){typeof ee=="function"&&(G.afterChangeTimeout=setTimeout(function(){ee(ae,Y.getState())},Y.props.transitionDuration||C))}))}},G.prototype.previous=function(X){var Y=this;X===void 0&&(X=0);var J=this.props,ee=J.afterChange,oe=J.beforeChange;if(!a.notEnoughChildren(this.state)){var ge=a.populatePreviousSlides(this.state,this.props,X),fe=ge.nextSlides,xe=ge.nextPosition;if(fe!==void 0&&xe!==void 0){var ae=this.state.currentSlide;typeof oe=="function"&&oe(fe,this.getState()),this.isAnimationAllowed=!0,this.props.shouldResetAutoplay&&this.resetAutoplayInterval(),this.setState({transform:xe,currentSlide:fe},function(){typeof ee=="function"&&(G.afterChangeTimeout2=setTimeout(function(){ee(ae,Y.getState())},Y.props.transitionDuration||C))})}}},G.prototype.resetAutoplayInterval=function(){this.props.autoPlay&&(clearInterval(this.autoPlay),this.autoPlay=setInterval(this.next,this.props.autoPlaySpeed))},G.prototype.componentWillUnmount=function(){window.removeEventListener("resize",this.onResize),this.props.keyBoardControl&&window.removeEventListener("keyup",this.onKeyUp),this.props.autoPlay&&this.autoPlay&&(clearInterval(this.autoPlay),this.autoPlay=void 0),this.itemsToShowTimeout&&clearTimeout(this.itemsToShowTimeout),G.clonesTimeout&&clearTimeout(G.clonesTimeout),G.isInThrottleTimeout&&clearTimeout(G.isInThrottleTimeout),G.transformTimeout&&clearTimeout(G.transformTimeout),G.afterChangeTimeout&&clearTimeout(G.afterChangeTimeout),G.afterChangeTimeout2&&clearTimeout(G.afterChangeTimeout2),G.afterChangeTimeout3&&clearTimeout(G.afterChangeTimeout3)},G.prototype.resetMoveStatus=function(){this.onMove=!1,this.initialX=0,this.lastX=0,this.direction="",this.initialY=0},G.prototype.getCords=function(X){var Y=X.clientX,J=X.clientY;return{clientX:i.parsePosition(this.props,Y),clientY:i.parsePosition(this.props,J)}},G.prototype.handleDown=function(X){if(!(!o.isMouseMoveEvent(X)&&!this.props.swipeable||o.isMouseMoveEvent(X)&&!this.props.draggable||this.isInThrottle)){var Y=this.getCords(o.isMouseMoveEvent(X)?X:X.touches[0]),J=Y.clientX,ee=Y.clientY;this.onMove=!0,this.initialX=J,this.initialY=ee,this.lastX=J,this.isAnimationAllowed=!1}},G.prototype.handleMove=function(X){if(!(!o.isMouseMoveEvent(X)&&!this.props.swipeable||o.isMouseMoveEvent(X)&&!this.props.draggable||a.notEnoughChildren(this.state))){var Y=this.getCords(o.isMouseMoveEvent(X)?X:X.touches[0]),J=Y.clientX,ee=Y.clientY,oe=this.initialX-J,ge=this.initialY-ee;if(this.onMove){if(!(Math.abs(oe)>Math.abs(ge)))return;var fe=a.populateSlidesOnMouseTouchMove(this.state,this.props,this.initialX,this.lastX,J,this.transformPlaceHolder),xe=fe.direction,ae=fe.nextPosition,me=fe.canContinue;xe&&(this.direction=xe,me&&ae!==void 0&&this.setTransformDirectly(ae)),this.lastX=J}}},G.prototype.handleOut=function(X){this.props.autoPlay&&!this.autoPlay&&(this.autoPlay=setInterval(this.next,this.props.autoPlaySpeed));var Y=X.type==="touchend"&&!this.props.swipeable,J=(X.type==="mouseleave"||X.type==="mouseup")&&!this.props.draggable;if(!Y&&!J&&this.onMove){if(this.setAnimationDirectly(!0),this.direction==="right")if(this.initialX-this.lastX>=this.props.minimumTouchDrag){var ee=Math.round((this.initialX-this.lastX)/this.state.itemWidth);this.next(ee)}else this.correctItemsPosition(this.state.itemWidth,!0,!0);this.direction==="left"&&(this.lastX-this.initialX>this.props.minimumTouchDrag?(ee=Math.round((this.lastX-this.initialX)/this.state.itemWidth),this.previous(ee)):this.correctItemsPosition(this.state.itemWidth,!0,!0)),this.resetMoveStatus()}},G.prototype.isInViewport=function(X){var Y=X.getBoundingClientRect(),J=Y.top,ee=J===void 0?0:J,oe=Y.left,ge=oe===void 0?0:oe,fe=Y.bottom,xe=fe===void 0?0:fe,ae=Y.right,me=ae===void 0?0:ae;return 0<=ee&&0<=ge&&xe<=(window.innerHeight||document.documentElement.clientHeight)&&me<=(window.innerWidth||document.documentElement.clientWidth)},G.prototype.isChildOfCarousel=function(X){return!!(X instanceof Element&&this.listRef&&this.listRef.current)&&this.listRef.current.contains(X)},G.prototype.onKeyUp=function(X){var Y=X.target;switch(X.keyCode){case 37:if(this.isChildOfCarousel(Y))return this.previous();break;case 39:if(this.isChildOfCarousel(Y))return this.next();break;case 9:if(this.isChildOfCarousel(Y)&&Y instanceof HTMLInputElement&&this.isInViewport(Y))return this.next()}},G.prototype.handleEnter=function(X){o.isMouseMoveEvent(X)&&this.autoPlay&&this.props.autoPlay&&this.props.pauseOnHover&&(clearInterval(this.autoPlay),this.autoPlay=void 0)},G.prototype.goToSlide=function(X,Y,J){var ee=this;if(J===void 0&&(J=!0),!this.isInThrottle){var oe=this.state.itemWidth,ge=this.props,fe=ge.afterChange,xe=ge.beforeChange,ae=this.state.currentSlide;typeof xe!="function"||Y&&(typeof Y!="object"||Y.skipBeforeChange)||xe(X,this.getState()),this.isAnimationAllowed=J,this.props.shouldResetAutoplay&&this.resetAutoplayInterval(),this.setState({currentSlide:X,transform:-oe*X},function(){ee.props.infinite&&ee.correctClonesPosition({domLoaded:!0}),typeof fe!="function"||Y&&(typeof Y!="object"||Y.skipAfterChange)||(G.afterChangeTimeout3=setTimeout(function(){fe(ae,ee.getState())},ee.props.transitionDuration||C))})}},G.prototype.getState=function(){return this.state},G.prototype.renderLeftArrow=function(X){var Y=this,J=this.props,ee=J.customLeftArrow,oe=J.rtl;return t.createElement(y.LeftArrow,{customLeftArrow:ee,getState:function(){return Y.getState()},previous:this.previous,disabled:X,rtl:oe})},G.prototype.renderRightArrow=function(X){var Y=this,J=this.props,ee=J.customRightArrow,oe=J.rtl;return t.createElement(y.RightArrow,{customRightArrow:ee,getState:function(){return Y.getState()},next:this.next,disabled:X,rtl:oe})},G.prototype.renderButtonGroups=function(){var X=this,Y=this.props.customButtonGroup;return Y?t.cloneElement(Y,{previous:function(){return X.previous()},next:function(){return X.next()},goToSlide:function(J,ee){return X.goToSlide(J,ee)},carouselState:this.getState()}):null},G.prototype.renderDotsList=function(){var X=this;return t.createElement(h.default,{state:this.state,props:this.props,goToSlide:this.goToSlide,getState:function(){return X.getState()}})},G.prototype.renderCarouselItems=function(){var X=[];if(this.props.infinite){var Y=t.Children.toArray(this.props.children);X=a.getClones(this.state.slidesToShow,Y)}return t.createElement(b.default,{clones:X,goToSlide:this.goToSlide,state:this.state,notEnoughChildren:a.notEnoughChildren(this.state),props:this.props})},G.prototype.render=function(){var X=this.props,Y=X.deviceType,J=X.arrows,ee=X.renderArrowsWhenDisabled,oe=X.removeArrowOnDeviceType,ge=X.infinite,fe=X.containerClass,xe=X.sliderClass,ae=X.customTransition,me=X.additionalTransfrom,we=X.renderDotsOutside,Ge=X.renderButtonGroupOutside,He=X.className,ye=X.rtl,ke=a.getInitialState(this.state,this.props),dt=ke.shouldRenderOnSSR,vt=ke.shouldRenderAtAll,jt=a.isInLeftEnd(this.state),_t=a.isInRightEnd(this.state),gt=J&&!(oe&&(Y&&-1<oe.indexOf(Y)||this.state.deviceType&&-1<oe.indexOf(this.state.deviceType)))&&!a.notEnoughChildren(this.state)&&vt,Vt=!ge&&jt,Ht=!ge&&_t,Bt=i.getTransform(this.state,this.props);return t.createElement(t.Fragment,null,t.createElement("div",{className:"react-multi-carousel-list "+fe+" "+He,dir:ye?"rtl":"ltr",ref:this.containerRef},t.createElement("ul",{ref:this.listRef,className:"react-multi-carousel-track "+xe,style:{transition:this.isAnimationAllowed?ae||I:"none",overflow:dt?"hidden":"unset",transform:"translate3d("+(Bt+me)+"px,0,0)"},onMouseMove:this.handleMove,onMouseDown:this.handleDown,onMouseUp:this.handleOut,onMouseEnter:this.handleEnter,onMouseLeave:this.handleOut,onTouchStart:this.handleDown,onTouchMove:this.handleMove,onTouchEnd:this.handleOut},this.renderCarouselItems()),gt&&(!Vt||ee)&&this.renderLeftArrow(Vt),gt&&(!Ht||ee)&&this.renderRightArrow(Ht),vt&&!Ge&&this.renderButtonGroups(),vt&&!we&&this.renderDotsList()),vt&&we&&this.renderDotsList(),vt&&Ge&&this.renderButtonGroups())},G.defaultProps={slidesToSlide:1,infinite:!1,draggable:!0,swipeable:!0,arrows:!0,renderArrowsWhenDisabled:!1,containerClass:"",sliderClass:"",itemClass:"",keyBoardControl:!0,autoPlaySpeed:3e3,showDots:!1,renderDotsOutside:!1,renderButtonGroupOutside:!1,minimumTouchDrag:80,className:"",dotListClass:"",focusOnSelect:!1,centerMode:!1,additionalTransfrom:0,pauseOnHover:!0,shouldResetAutoplay:!0,rewind:!1,rtl:!1,rewindWithAnimation:!1},G}(t.Component);return dg.default=j,dg}var wD;function tee(){if(wD)return Gx;wD=1,Object.defineProperty(Gx,"__esModule",{value:!0});var e=eee();return Gx.default=e.default,Gx}var kT,SD;function nee(){return SD||(SD=1,kT=tee()),kT}var ree=nee();const iee=Ei(ree);function aee(e){const t={mobile:{breakpoint:{max:3e3,min:0},partialVisibilityGutter:0,items:1}};return ve.jsx(iee,{responsive:t,infinite:!1,autoPlay:!1,arrows:!0,showDots:!0,swipeable:!0,draggable:!0,containerClass:IT.carousel,itemClass:IT.carousel__item,beforeChange:a=>{var o;(o=window.getSelection())==null||o.removeAllRanges()},children:e.imageSources.map((a,o)=>ve.jsx("img",{src:a,alt:`Slide ${o}`,className:IT.item__image,draggable:!1,onDragStart:h=>h.preventDefault()},o))})}const oee="_photos_bj1br_1",see="_photos__infoBar_bj1br_8",lee="_infoBar__substrate_bj1br_17",cee="_substrate__customStatus_bj1br_29",uee="_infoBar__customRating_bj1br_34",hee="_customRating__text_bj1br_50",mg={photos:oee,photos__infoBar:see,infoBar__substrate:lee,substrate__customStatus:cee,infoBar__customRating:uee,customRating__text:hee},fee="data:image/svg+xml,%3csvg%20width='16.67'%20height='16.67'%20viewBox='0%200%2020%2020'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M7.15316%203.40838C8.41981%201.13613%209.05314%200%2010%200C10.9469%200%2011.5802%201.13612%2012.8468%203.40837L13.1745%203.99623C13.5345%204.64193%2013.7144%204.96479%2013.9951%205.17781C14.2757%205.39083%2014.6251%205.4699%2015.3241%205.62805L15.9605%205.77203C18.4201%206.32856%2019.65%206.60682%2019.9426%207.54773C20.2352%208.48864%2019.3968%209.46907%2017.7199%2011.4299L17.2861%2011.9372C16.8096%2012.4944%2016.5713%2012.773%2016.4641%2013.1177C16.357%2013.4624%2016.393%2013.8341%2016.465%2014.5776L16.5306%2015.2544C16.7841%2017.8706%2016.9109%2019.1787%2016.1449%2019.7602C15.3788%2020.3417%2014.2273%2019.8115%2011.9243%2018.7512L11.3285%2018.4768C10.6741%2018.1755%2010.3469%2018.0248%2010%2018.0248C9.65315%2018.0248%209.32593%2018.1755%208.67149%2018.4768L8.07567%2018.7512C5.77268%2019.8115%204.62118%2020.3417%203.85515%2019.7602C3.08912%2019.1787%203.21588%2017.8706%203.4694%2015.2544L3.53498%2014.5776C3.60703%2013.8341%203.64305%2013.4624%203.53586%2013.1177C3.42868%2012.773%203.19043%2012.4944%202.71392%2011.9372L2.2801%2011.4299C0.603249%209.46907%20-0.235175%208.48864%200.057421%207.54773C0.350017%206.60682%201.57986%206.32856%204.03954%205.77203L4.67589%205.62805C5.37485%205.4699%205.72433%205.39083%206.00494%205.17781C6.28555%204.96479%206.46553%204.64194%206.82547%203.99623L7.15316%203.40838Z'%20fill='%23F89520'/%3e%3c/svg%3e";function dee(e){const t=aO[e.stationStatus];return ve.jsxs("div",{className:mg.photos,children:[ve.jsxs("div",{className:mg.photos__infoBar,children:[ve.jsx("div",{className:mg.infoBar__substrate,children:ve.jsx(Jw,{textSize:"large",text:e.stationStatus,className:mg.substrate__customStatus,color:t})}),e.rating&&ve.jsxs("div",{className:mg.infoBar__customRating,children:[ve.jsx("img",{src:fee,alt:"Rating"}),ve.jsxs("p",{className:mg.customRating__text,children:[" ",e.rating]})]})]}),ve.jsx(aee,{imageSources:e.imageSources})]})}const pee="_connector_62jlf_1",mee="_connector__status_62jlf_12",_ee="_connector__title_62jlf_19",gee="_text_62jlf_28",yee="_connector__image_62jlf_36",vee="_connector__info_62jlf_42",xee="_info__column_62jlf_52",bee="_connector__lineSeparator_62jlf_58",wee="_connector__tariffsBlock_62jlf_66",See="_tariffsBlock__tariffs_62jlf_73",Tee="_tariffs__icon_62jlf_80",Eee="_tariffs__list_62jlf_86",Aee="_text_blue_62jlf_92",Cee="_text_green_62jlf_100",Mee="_text_orange_62jlf_104",Do={connector:pee,connector__status:mee,connector__title:_ee,text:gee,connector__image:yee,connector__info:vee,info__column:xee,connector__lineSeparator:bee,connector__tariffsBlock:wee,tariffsBlock__tariffs:See,tariffs__icon:Tee,tariffs__list:Eee,text_blue:Aee,text_green:Cee,text_orange:Mee},Oee={AC:"green","AC-2":"green","AC-3":"green",DC:"orange"},PF="data:image/svg+xml,%3csvg%20width='18'%20height='18'%20viewBox='0%200%2018%2018'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M4.5%206H7.5'%20stroke='%23373435'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20d='M15.625%206.75H13.6731C12.3348%206.75%2011.25%207.75736%2011.25%209C11.25%2010.2426%2012.3348%2011.25%2013.6731%2011.25H15.625C15.6875%2011.25%2015.7187%2011.25%2015.7451%2011.2484C16.1496%2011.2238%2016.4718%2010.9246%2016.4983%2010.5491C16.5%2010.5246%2016.5%2010.4955%2016.5%2010.4375V7.5625C16.5%207.50447%2016.5%207.47545%2016.4983%207.45095C16.4718%207.07538%2016.1496%206.77622%2015.7451%206.75161C15.7187%206.75%2015.6875%206.75%2015.625%206.75Z'%20stroke='%23373435'%20stroke-width='1.5'/%3e%3cpath%20d='M16.0238%206.4502C15.9654%205.04597%2015.7774%204.185%2015.1713%203.57887C14.2926%202.7002%2012.8784%202.7002%2010.05%202.7002L7.79999%202.7002C4.97156%202.7002%203.55735%202.7002%202.67867%203.57888C1.79999%204.45755%201.79999%205.87177%201.79999%208.7002C1.79999%2011.5286%201.79999%2012.9428%202.67867%2013.8215C3.55735%2014.7002%204.97156%2014.7002%207.79999%2014.7002H10.05C12.8784%2014.7002%2014.2926%2014.7002%2015.1713%2013.8215C15.7774%2013.2154%2015.9654%2012.3544%2016.0238%2010.9502'%20stroke='%23373435'%20stroke-width='1.5'/%3e%3cpath%20d='M13.95%209H13.956'%20stroke='%23373435'%20stroke-width='2'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",IF={:""," ":"",:""," ":""};function Pee(e){return ve.jsxs("div",{className:Do.connector,children:[ve.jsx(Jw,{text:e.info.status,color:RN[e.info.status],textSize:"medium",className:Do.connector__status}),ve.jsx("div",{className:Do.connector__title,children:e.info.standard}),ve.jsx("img",{src:g2[e.info.standard],className:Do.connector__image,alt:"Connector"}),ve.jsxs("div",{className:Do.connector__info,children:[ve.jsxs("div",{className:Do.info__column,children:[ve.jsxs("a",{className:Do.text,children:[e.info.max_electric_power," "]}),ve.jsxs("a",{className:Do.text,children:[e.info.max_amperage," "]})]}),ve.jsxs("div",{className:Do.info__column,children:[ve.jsx("a",{className:Do.text,children:e.info.format}),ve.jsx("a",{className:`${Do.text} ${Do["text_"+Oee[e.info.power_type]]}`,children:e.info.power_type})]})]}),ve.jsx("div",{className:Do.connector__lineSeparator}),ve.jsx("div",{className:Do.connector__tariffsBlock,children:ve.jsxs("div",{className:Do.tariffsBlock__tariffs,children:[ve.jsx("img",{src:PF,alt:"Wallet",className:Do.tariffs__icon}),ve.jsx("div",{className:Do.tariffs__list,children:e.info.tariffs.map((t,a)=>ve.jsxs("a",{className:Do.text_blue,children:[t.price," ",t.currency,"/",IF[t.type]]},a))})]})})]})}const Iee="_block_122he_1",Ree="_block__chart_122he_7",Dee="_chart__text_122he_13",Lee="_chart__procentage_122he_21",Jx={block:Iee,block__chart:Ree,chart__text:Dee,chart__procentage:Lee},kee=166,zee={1:"",2:"",3:"",4:"",5:"",6:"",7:""};var Qs;(e=>{e.TOP_EDGE_DISTANCE=6,e.BOTTOM_EDGE_DISTANCE=17,e.RIGHT_EDGE_DISTANCE=6,e.LEFT_EDGE_DISTANCE=25,e.DISTANCE_BETWEEN_BOTTOM_AND_TEXT=2})(Qs||(Qs={}));const Qx=20;var sm;(e=>{e.MIN_GREEN=200,e.MAX_BLUE=128,e.MIN_BLUE=229,e.MAX_GREEN=112})(sm||(sm={}));const Ab=kee-Qs.BOTTOM_EDGE_DISTANCE-Qs.TOP_EDGE_DISTANCE,Bee=Ab/4;var zb;(e=>{e.INACTIVE_COLUMN_COLOR="#C8CED8",e.LINE_STROKE_COLOR="#E8E8EE"})(zb||(zb={}));var Bb;(e=>{e.SMALL=3,e.NORMAL=5})(Bb||(Bb={}));const Nee=2,Fee=15,jee=5,Uee=5,Vee=7,m5=7,$ee=e=>{const t=Math.round(sm.MIN_GREEN-e/100*(sm.MIN_GREEN-sm.MAX_GREEN)),a=Math.round(sm.MIN_BLUE-e/100*(sm.MIN_BLUE-sm.MAX_BLUE));return`#00${t.toString(16).padStart(2,"0")}${a.toString(16).padStart(2,"0")}`},qee=e=>{const t=[];let a=0;for(let o=1;o<=m5;o++){const h={weekday:o,occupancy_in_percentage:0};a<e.length&&e[a].weekday===o&&(h.occupancy_in_percentage=e[a].occupancy_in_percentage,a++),t.push(h)}return t};function Gee(e){const t=Ie.useRef(null),[a,o]=Ie.useState({}),[h,y]=Ie.useState([window.innerWidth,window.innerHeight]),b="middle",i=Ie.useMemo(()=>{const I=e.data.sort((j,F)=>j.weekday===F.weekday?0:j.weekday>F.weekday?1:-1);return e.data.length<7?qee(I):I},[e.data]);Ie.useEffect(()=>{if(t.current!==null){const I=t.current.clientWidth,j=I-Qs.RIGHT_EDGE_DISTANCE-Qs.LEFT_EDGE_DISTANCE,F=(j-Qx*m5)/(m5-1);o({clientWidth:I,width:j,distanceBetweenColums:F})}},[t,h]),Ie.useEffect(()=>{const I=()=>y([window.innerWidth,window.innerHeight]);return window.addEventListener("resize",I),()=>window.removeEventListener("resize",I)},[]);const C=()=>{const I=[];for(let j=Qs.TOP_EDGE_DISTANCE,F=4;j<=Ab+Qs.TOP_EDGE_DISTANCE,F>=0;j+=Bee,F--)I.push(ve.jsxs("text",{x:Qs.LEFT_EDGE_DISTANCE/2,y:j+Qs.TOP_EDGE_DISTANCE/2,textAnchor:b,className:Jx.chart__procentage,children:[25*F,"%"]},F)),F!==0&&I.push(ve.jsx("line",{x1:Qs.LEFT_EDGE_DISTANCE+F,y1:j,x2:a.clientWidth,y2:j,stroke:zb.LINE_STROKE_COLOR,strokeWidth:Nee,strokeDasharray:Fee},j));return I};return ve.jsx("div",{className:Jx.block,ref:t,children:ve.jsxs("svg",{className:Jx.block__chart,children:[C(),i.map((I,j)=>{const F=Qs.LEFT_EDGE_DISTANCE+j*(Qx+a.distanceBetweenColums),G=I.occupancy_in_percentage<Uee?jee:I.occupancy_in_percentage*Ab/100,X=Ab+Qs.TOP_EDGE_DISTANCE-G;return ve.jsxs("g",{children:[ve.jsx("rect",{x:F,y:X,rx:G>=Vee?Bb.NORMAL:Bb.SMALL,fill:I.occupancy_in_percentage===0?zb.INACTIVE_COLUMN_COLOR:$ee(I.occupancy_in_percentage),width:Qx,height:G}),ve.jsx("text",{x:F+Qx/2,y:X+G+Qs.BOTTOM_EDGE_DISTANCE-Qs.DISTANCE_BETWEEN_BOTTOM_AND_TEXT,textAnchor:b,className:Jx.chart__text,children:zee[I.weekday]})]},j)})]})})}const Hee="data:image/svg+xml,%3csvg%20width='18'%20height='20'%20viewBox='0%200%2018%2020'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M4.5%207.75L9%2012.25L13.5%207.75'%20stroke='%23373435'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",Zee="_expandButton_1tj5j_1",Wee="_expandButton_text_1tj5j_11",TD={expandButton:Zee,expandButton_text:Wee};function Xee(e){return ve.jsxs("button",{className:`${TD.expandButton} ${TD.expandButton_text}`,onClick:()=>e.onClick(e.isOpen),children:[e.isOpen?"":"",ve.jsx("img",{src:e.isOpen?bF:Hee,alt:"arrow"})]})}const Yee="_page_eqv1w_1",Kee="_page__block_eqv1w_5",Jee="_block__content_eqv1w_11",Qee="_content__distance_eqv1w_17",ete="_page__lineSeparator_eqv1w_29",tte="_title_eqv1w_35",nte="_text_subTitle_eqv1w_44",rte="_text_eqv1w_44",ite="_description__footer_eqv1w_61",ate="_text_collapsed_eqv1w_67",ote="_text_expanded_eqv1w_73",ste="_text_distance_eqv1w_77",lte="_page__connectors_eqv1w_86",cte="_page__support_eqv1w_93",oo={page:Yee,page__block:Kee,block__content:Jee,content__distance:Qee,page__lineSeparator:ete,title:tte,text_subTitle:nte,text:rte,description__footer:ite,text_collapsed:ate,text_expanded:ote,text_distance:ste,page__connectors:lte,page__support:cte},ute=()=>{const[e]=nO(),[t,a]=Ie.useState({});return Ie.useEffect(()=>{const o=e.get(Hd.PREVIOUS_PAGE),h=e.get(Hd.FROM_CHARGING_SESSION_ID);a({prev_page:o,from_charging_session_id:h})},[e]),{pageQueries:t}},hte=()=>{const{id:e}=tZ(),{position:t}=Ie.useContext(Bo),{getStationByIdFromApi:a}=X0(),[o,h]=Ie.useState(),[y,b]=Ie.useState(!0);return Ie.useEffect(()=>{e!==void 0&&a({id:e,latitude:t==null?void 0:t.latitude.toString(),longitude:t==null?void 0:t.longitude.toString()}).then(i=>{i&&h(i)}).finally(()=>b(!1))},[e]),{station:o,loading:y}};function RF(){return ve.jsx("div",{children:" "})}function fte(){const e=zo(),{pageQueries:t}=ute(),{loading:a,station:o}=hte(),[h,y]=Ie.useState(!1),b=o==null?void 0:o.description,i=Ie.useMemo(()=>b?b.length>50:!1,[b]);if(a)return ve.jsx(jg,{});if(!o)return ve.jsx(RF,{});const C=()=>{y(!h)},I=()=>!h&&i?(b==null?void 0:b.slice(0,50))+"...":b,j=i,F=()=>o.metres_to_station?(o.metres_to_station/1e3).toLocaleString("ru-RU",{minimumFractionDigits:0,maximumFractionDigits:2}):void 0,G=()=>{switch(t.prev_page){case Vd.STATIONS_LIST:return Lw;case Vd.ACTIVE_SESSION:return kw+(t.from_charging_session_id??"");case Vd.SESSIONS_LIST:return dy}return"/"};return ve.jsxs(Qd,{onReturn:()=>e(G()),title:o.name,className:oo.page,children:[o.images&&o.images.length!==0&&ve.jsx(dee,{imageSources:o.images,stationStatus:o.status}),ve.jsxs("div",{className:oo.page__block,children:[ve.jsx("a",{className:oo.text_subTitle,children:""}),ve.jsx(ko,{children:ve.jsxs("div",{className:oo.block__content,children:[ve.jsx("a",{className:oo.text,children:o.address}),F()&&ve.jsxs("div",{className:oo.content__distance,children:[ve.jsx("img",{src:TF,alt:"path"}),ve.jsxs("a",{className:oo.text_distance,children:[F()," "]})]})]})})]}),b&&ve.jsxs("div",{className:oo.page__block,children:[ve.jsx("a",{className:oo.text_subTitle,children:""}),ve.jsxs(ko,{children:[ve.jsx("div",{children:ve.jsx("a",{className:`${oo.text} ${h?oo.text_expanded:oo.text_collapsed}`,children:I()})}),j&&ve.jsx("div",{className:oo.description__footer,children:ve.jsx(Xee,{onClick:C,isOpen:h})})]})]}),ve.jsx("div",{className:oo.page__lineSeparator}),ve.jsx("div",{className:oo.page__connectors,children:o.connectors.map((X,Y)=>ve.jsx(Pee,{info:X},Y))}),ve.jsx("div",{className:oo.page__lineSeparator}),ve.jsxs("div",{className:oo.page__block,children:[ve.jsx("a",{className:oo.text_subTitle,children:" "}),ve.jsx(ko,{children:ve.jsx(Gee,{data:o.occupation})})]}),ve.jsxs("div",{className:oo.page__support,children:[ve.jsxs("a",{className:oo.title,children:["   ? ",ve.jsx("br",{}),"  !"]}),ve.jsx(vf,{variant:"fill",text:"",onClick:()=>window.location.replace("https://t.me/egine_cpo")})]})]})}const dte="_stationFilters_i0ieu_1",pte="_stationFilters__onlyAvailable_i0ieu_9",mte="_onlyAvailable__text_i0ieu_16",_te="_stationFilters__minimalPower_i0ieu_25",gte="_minimalPower__text_i0ieu_34",yte="_tittle__text_i0ieu_35",vte="_stationFilters__connectors_i0ieu_43",xte="_connectors__tittle_i0ieu_50",bte="_connectors__row_i0ieu_57",wte="_connectors__lastRow_i0ieu_58",Ste="_stationFilters__footer_i0ieu_72",tu={stationFilters:dte,stationFilters__onlyAvailable:pte,onlyAvailable__text:mte,stationFilters__minimalPower:_te,minimalPower__text:gte,tittle__text:yte,stationFilters__connectors:vte,connectors__tittle:xte,connectors__row:bte,connectors__lastRow:wte,stationFilters__footer:Ste},Tte="_card_72hxq_1",Ete="_card_enabled_72hxq_14",Ate="_card_disabled_72hxq_19",Cte="_card__content_72hxq_24",Mte="_content__icon_72hxq_31",Ote="_content__text_72hxq_42",_g={card:Tte,card_enabled:Ete,card_disabled:Ate,card__content:Cte,content__icon:Mte,content__text:Ote};function Os(e){const[t,a]=Ie.useState(e.enabled??!0);Ie.useEffect(()=>{a(e.enabled??!0)},[e.enabled]);const o=()=>{e.disabled||(a(!t),e.onChange(!t))};return ve.jsx("div",{className:`${_g.card} ${t?_g.card_enabled:""} ${e.disabled?_g.card_disabled:""}`,onClick:o,children:ve.jsxs("div",{className:_g.card__content,children:[ve.jsx("div",{className:_g.content__icon,children:ve.jsx("img",{src:g2[e.connector],alt:e.connector})}),ve.jsx("a",{className:_g.content__text,children:e.connector})]})})}const Pte="_resetButton_183ut_1",Ite="_resetButton__icon_183ut_15",Rte="_resetButton_active_183ut_19",Dte="_resetButton_disabled_183ut_23",eb={resetButton:Pte,resetButton__icon:Ite,resetButton_active:Rte,resetButton_disabled:Dte};function DF(e){return ve.jsxs("button",{className:`${eb.resetButton} ${e.disabled?eb.resetButton_disabled:eb.resetButton_active}`,onClick:e.onClick,disabled:e.disabled,children:[ve.jsx("img",{src:e.iconSrc,alt:"resetFiltersIcon",className:eb.resetButton__icon}),ve.jsx("span",{children:e.text})]})}const LF="data:image/svg+xml,%3csvg%20width='25'%20height='24'%20viewBox='0%200%2025%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M4.17981%2011.3333H3.42981H4.17981ZM4.17981%2013L3.65157%2013.5324C3.94398%2013.8225%204.41565%2013.8225%204.70805%2013.5324L4.17981%2013ZM6.38787%2011.8657C6.68191%2011.574%206.68377%2011.0991%206.39203%2010.8051C6.10029%2010.511%205.62542%2010.5092%205.33138%2010.8009L6.38787%2011.8657ZM3.02824%2010.8009C2.7342%2010.5092%202.25933%2010.511%201.96759%2010.8051C1.67585%2011.0991%201.67772%2011.574%201.97176%2011.8657L3.02824%2010.8009ZM19.1156%207.39279C19.3325%207.74565%2019.7944%207.85585%2020.1473%207.63892C20.5001%207.42199%2020.6103%206.96007%2020.3934%206.60721L19.1156%207.39279ZM12.5789%202.25C7.53155%202.25%203.42981%206.3112%203.42981%2011.3333H4.92981C4.92981%207.15072%208.34884%203.75%2012.5789%203.75V2.25ZM3.42981%2011.3333L3.42981%2013H4.92981L4.92981%2011.3333H3.42981ZM4.70805%2013.5324L6.38787%2011.8657L5.33138%2010.8009L3.65157%2012.4676L4.70805%2013.5324ZM4.70805%2012.4676L3.02824%2010.8009L1.97176%2011.8657L3.65157%2013.5324L4.70805%2012.4676ZM20.3934%206.60721C18.787%203.99427%2015.8873%202.25%2012.5789%202.25V3.75C15.3484%203.75%2017.7727%205.20845%2019.1156%207.39279L20.3934%206.60721Z'%20fill='%23373435'/%3e%3cpath%20d='M20.8139%2011L21.3411%2010.4666C21.049%2010.1778%2020.5788%2010.1778%2020.2867%2010.4666L20.8139%2011ZM18.6004%2012.1333C18.3058%2012.4244%2018.3031%2012.8993%2018.5942%2013.1939C18.8854%2013.4885%2019.3603%2013.4913%2019.6549%2013.2001L18.6004%2012.1333ZM21.9729%2013.2001C22.2675%2013.4913%2022.7424%2013.4885%2023.0335%2013.1939C23.3247%2012.8993%2023.322%2012.4244%2023.0274%2012.1332L21.9729%2013.2001ZM5.81794%2016.6061C5.6004%2016.2536%205.1383%2016.1442%204.78581%2016.3618C4.43331%2016.5793%204.32391%2017.0414%204.54144%2017.3939L5.81794%2016.6061ZM12.3827%2021.75C17.4451%2021.75%2021.5639%2017.6915%2021.5639%2012.6667H20.0639C20.0639%2016.8466%2016.6332%2020.25%2012.3827%2020.25V21.75ZM21.5639%2012.6667V11H20.0639V12.6667H21.5639ZM20.2867%2010.4666L18.6004%2012.1333L19.6549%2013.2001L21.3411%2011.5334L20.2867%2010.4666ZM20.2867%2011.5334L21.9729%2013.2001L23.0274%2012.1332L21.3411%2010.4666L20.2867%2011.5334ZM4.54144%2017.3939C6.15405%2020.007%209.06403%2021.75%2012.3827%2021.75V20.25C9.60023%2020.25%207.16584%2018.7903%205.81794%2016.6061L4.54144%2017.3939Z'%20fill='%23373435'/%3e%3c/svg%3e",Lte="_on_yyim3_11",kte="_switch__toggle_yyim3_17",zte="_off_yyim3_20",Bte="_disabled_yyim3_29",Bv={switch:"_switch_yyim3_1",on:Lte,switch__toggle:kte,off:zte,disabled:Bte};function kF(e){const[t,a]=Ie.useState(e.enabled??!0);Ie.useEffect(()=>{a(e.enabled??!0)},[e.enabled]);const o=()=>{e.disabled||(a(!t),e.onChange(!t))};return ve.jsx("div",{className:`${Bv.switch} ${t?Bv.on:Bv.off} ${e.disabled?Bv.disabled:""}`,onClick:o,children:ve.jsx("div",{className:Bv.switch__toggle})})}const Nte=e=>e.connectors.length===wg.connectors.length&&e.connectors.every(t=>wg.connectors.includes(t))&&e.onlyAvailableStations===wg.onlyAvailableStations&&e.minimalPower===wg.minimalPower&&e.isModified===wg.isModified,Fte="_sliderContainer_rgl5h_1",jte="_slider_rgl5h_1",Ute="_slider__pointer_rgl5h_16",Vte="_slider__legendContainer_rgl5h_32",$te="_legendContainer__text_rgl5h_38",gg={sliderContainer:Fte,slider:jte,slider__pointer:Ute,slider__legendContainer:Vte,legendContainer__text:$te},zF=({items:e,onChange:t,current:a,orderedItemKeys:o})=>{if(JSON.stringify(Object.keys(e).slice(0).sort())!=JSON.stringify(o.slice(0).sort()))throw new Error("Items keys does not equal to orderedItemKeys, check you parameters");const[h,y]=Ie.useState(0),[b,i]=Ie.useState(0),[C,I]=Ie.useState(!1),j=Ie.useRef(null),F=Ie.useRef(null),G=Ie.useRef(null),X=Ie.useMemo(()=>o,[o]);Ie.useEffect(()=>{if(a!==void 0){const me=X.findIndex(Ge=>e[Ge]===a);y((me===-1?0:me)/(X.length-1)*100)}},[a]);const Y=me=>{I(!0),xe(me.clientX),xe(me.clientX)},J=me=>{I(!0),xe(me.touches[0].clientX)},ee=me=>{C&&xe(me.clientX)},oe=me=>{C&&xe(me.touches[0].clientX)},ge=()=>{C&&(I(!1),ae(),t(e[X[b]]))},fe=()=>{C&&(I(!1),ae(),t(e[X[b]]))},xe=me=>{if(j.current){const we=j.current.getBoundingClientRect(),Ge=me-we.left,He=we.width,ye=Math.round(Ge/He*(X.length-1));i(Math.max(0,Math.min(X.length-1,ye)));let ke=Ge;ke<0?ke=0:ke>He&&(ke=He),y(ke/He*100)}},ae=()=>{if(j.current&&F.current&&G.current){const we=F.current.getElementsByClassName(gg.legendContainer__text)[b].getBoundingClientRect(),Ge=G.current.getBoundingClientRect(),He=j.current.getBoundingClientRect();if(b===X.length-1)y((He.width-Ge.width/2)/He.width*100);else if(b===0)y(Ge.width/2/He.width*100);else{const ye=we.left-He.left+we.width/2;y(ye/He.width*100)}}};return Ie.useEffect(()=>(document.addEventListener("mousemove",ee),document.addEventListener("mouseup",ge),document.addEventListener("touchmove",oe),document.addEventListener("touchend",fe),()=>{document.removeEventListener("mousemove",ee),document.removeEventListener("mouseup",ge),document.removeEventListener("touchmove",oe),document.removeEventListener("touchend",fe)}),[C,b]),ve.jsxs("div",{className:gg.sliderContainer,children:[ve.jsx("div",{ref:j,className:gg.slider,onMouseDown:Y,onTouchStart:J,children:ve.jsx("div",{className:gg.slider__pointer,style:{left:`${h}%`,transition:C?"none":void 0,borderColor:C?"#13A69D":void 0},ref:G})}),ve.jsx("div",{className:gg.slider__legendContainer,ref:F,children:X.map((me,we)=>ve.jsx("div",{className:gg.legendContainer__text,children:me},we))})]})};function qte(){const{stationFilters:e,setStationFilters:t,showSnackbar:a}=Ie.useContext(Bo),o=(C,I)=>{t({...e,connectors:I?[...e.connectors,C]:e.connectors.filter(j=>j!==C),isModified:!0})},h=C=>{t({...e,onlyAvailableStations:C,isModified:!0})},y=C=>{t({...e,minimalPower:C*1e3,isModified:!0})},b=()=>{t({...e,isModified:!1,shouldUpdateStations:!0}),a("success"," ")},i=()=>{t({...wg,shouldUpdateStations:!0}),a("success"," ")};return ve.jsxs("div",{className:tu.stationFilters,children:[ve.jsx(ko,{children:ve.jsxs("div",{className:tu.stationFilters__onlyAvailable,children:[ve.jsx("p",{className:tu.onlyAvailable__text,children:" "}),ve.jsx(kF,{onChange:h,enabled:e.onlyAvailableStations})]})}),ve.jsxs("div",{className:tu.stationFilters__minimalPower,children:[ve.jsx("span",{className:tu.minimalPower__text,children:" , "}),ve.jsx(ko,{children:ve.jsx(zF,{onChange:C=>y(C),items:{3:3,18:18,35:35,50:50,75:75,">100":100},orderedItemKeys:["3","18","35","50","75",">100"],current:e.minimalPower/1e3})})]}),ve.jsxs("div",{className:tu.stationFilters__connectors,children:[ve.jsx("div",{className:tu.connectors__tittle,children:ve.jsx("span",{className:tu.tittle__text,children:""})}),ve.jsx(ko,{children:ve.jsxs("div",{className:tu.connectors__row,children:[ve.jsx(Os,{onChange:C=>o("Type 1",C),connector:"Type 1",enabled:e.connectors.includes("Type 1")}),ve.jsx(Os,{onChange:C=>o("Type 2",C),connector:"Type 2",enabled:e.connectors.includes("Type 2")}),ve.jsx(Os,{onChange:C=>o("CCS1",C),connector:"CCS1",enabled:e.connectors.includes("CCS1")})]})}),ve.jsx(ko,{children:ve.jsxs("div",{className:tu.connectors__row,children:[ve.jsx(Os,{onChange:C=>o("CCS2",C),connector:"CCS2",enabled:e.connectors.includes("CCS2")}),ve.jsx(Os,{onChange:C=>o("GB/T (AC)",C),connector:"GB/T (AC)",enabled:e.connectors.includes("GB/T (AC)")}),ve.jsx(Os,{onChange:C=>o("GB/T (DC)",C),connector:"GB/T (DC)",enabled:e.connectors.includes("GB/T (DC)")})]})}),ve.jsx(ko,{children:ve.jsxs("div",{className:tu.connectors__lastRow,children:[ve.jsx(Os,{onChange:C=>o("CHAdeMO",C),connector:"CHAdeMO",enabled:e.connectors.includes("CHAdeMO")}),ve.jsx(Os,{onChange:C=>o("Tesla",C),connector:"Tesla",enabled:e.connectors.includes("Tesla")})]})})]}),ve.jsxs("div",{className:tu.stationFilters__footer,children:[ve.jsx(DF,{onClick:i,disabled:Nte(e),iconSrc:LF,text:" "}),ve.jsx(vf,{onClick:b,variant:"fill",text:"",disabled:!e.isModified})]})]})}const Gte=()=>{const[e]=nO(),[t,a]=Ie.useState({});return Ie.useEffect(()=>{const o=e.get(T1.PREVIOUS_PAGE);a({prev_page:o})},[e]),{pageQueries:t}},Hte="_page_w9u5j_1",Zte={page:Hte};function Wte(){const e=zo(),{pageQueries:t}=Gte(),a=()=>{switch(t.prev_page){case zg.MAIN:return"/";case zg.STATIONS_LIST:return Lw}};return ve.jsx(Qd,{onReturn:()=>{const o=a();o&&e(o)},title:"",className:Zte.page,children:ve.jsx(qte,{})})}const Xte="_sessionFilters_18mkz_1",Yte="_sessionFilters__onlyPaid_18mkz_9",Kte="_onlyPaid__text_18mkz_16",Jte="_sessionFilters__minimalDuration_18mkz_25",Qte="_minimalDuration__text_18mkz_34",ene="_tittle__text_18mkz_35",tne="_sessionFilters__connectors_18mkz_43",nne="_connectors__tittle_18mkz_51",rne="_connectors__row_18mkz_58",ine="_connectors__lastRow_18mkz_59",ane="_sessionFilters__footer_18mkz_73",nu={sessionFilters:Xte,sessionFilters__onlyPaid:Yte,onlyPaid__text:Kte,sessionFilters__minimalDuration:Jte,minimalDuration__text:Qte,tittle__text:ene,sessionFilters__connectors:tne,connectors__tittle:nne,connectors__row:rne,connectors__lastRow:ine,sessionFilters__footer:ane},one="_snackbar_x4yha_1",sne="_snackbar__icon_x4yha_13",lne="_snackbar__text_x4yha_19",cne="_snackbar_success_x4yha_27",une="_snackbar_warning_x4yha_31",hne="_snackbar_error_x4yha_35",tb={snackbar:one,snackbar__icon:sne,snackbar__text:lne,snackbar_success:cne,snackbar_warning:une,snackbar_error:hne},BF="data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3ccircle%20cx='12'%20cy='12'%20r='10'%20fill='%2327AE60'/%3e%3cpath%20d='M8.5%2012.5L10.5%2014.5L15.5%209.5'%20stroke='white'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",TO="data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3ccircle%20cx='12'%20cy='12'%20r='10'%20fill='%23F89520'/%3e%3cpath%20d='M12%207V13'%20stroke='white'%20stroke-width='1.5'%20stroke-linecap='round'/%3e%3ccircle%20cx='12'%20cy='16'%20r='1'%20fill='white'/%3e%3c/svg%3e",fne="data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M5.31171%2010.7615C8.23007%205.58716%209.68925%203%2012%203C14.3107%203%2015.7699%205.58716%2018.6883%2010.7615L19.0519%2011.4063C21.4771%2015.7061%2022.6897%2017.856%2021.5937%2019.428C20.4978%2021%2017.7864%2021%2012.3637%2021H11.6363C6.21356%2021%203.50217%2021%202.40626%2019.428C1.31034%2017.856%202.52291%2015.7061%204.94805%2011.4063L5.31171%2010.7615Z'%20fill='%23F63255'/%3e%3cpath%20d='M12%208V13'%20stroke='white'%20stroke-width='1.5'%20stroke-linecap='round'/%3e%3ccircle%20cx='12'%20cy='16'%20r='1'%20fill='white'/%3e%3c/svg%3e";function dne(e){const a=(()=>{switch(e.variant){case"success":return BF;case"warning":return TO;case"error":return fne;default:throw new Error("Snackbar variant does not exist")}})();return ve.jsxs("div",{className:`${tb.snackbar} ${tb[`snackbar_${e.variant}`]}`,children:[ve.jsx("img",{src:a,alt:e.variant,className:tb.snackbar__icon}),ve.jsx("p",{className:tb.snackbar__text,children:e.text})]})}const pne="_snackbarLayout_f6q6s_1",mne={snackbarLayout:pne};function _5(e){return ve.jsx("div",{className:mne.snackbarLayout,children:ve.jsx(dne,{variant:e.variant,text:e.text})})}var Nb;(e=>{e.CHARGING="",e.COMPLETED="",e.INVALID=""})(Nb||(Nb={}));const _ne={:"green",:"red",:"grey"},Sg={connectors:[...Rb],onlyPaidSessions:!1,minimalPower:0,isModified:!1,shouldUpdateSessions:!1},gne=e=>e.connectors.length===Sg.connectors.length&&e.connectors.every(t=>Sg.connectors.includes(t))&&e.onlyPaidSessions===Sg.onlyAvailableSessions&&e.durationInHours===Sg.minimalPower&&e.isModified===Sg.isModified;function yne(){const{sessionFilters:e,setSessionFilters:t}=Ie.useContext(Bo),[a,o]=Ie.useState(!1),[h,y]=Ie.useState(!1),b=(F,G)=>{console.log("setSessionFilters:",t),t({...e,connectors:G?[...e.connectors,F]:e.connectors.filter(X=>X!==F),isModified:!0})},i=F=>{t({...e,onlyPaidSessions:F,isModified:!0})},C=F=>{t({...e,durationInHours:F,isModified:!0})},I=()=>{o(!0),t({...e,isModified:!1,shouldUpdateSessions:!0})},j=()=>{y(!0),t({...Sg,shouldUpdateSessions:!0})};return ve.jsxs("div",{className:nu.sessionFilters,children:[ve.jsx(ko,{children:ve.jsxs("div",{className:nu.sessionFilters__onlyPaid,children:[ve.jsx("p",{className:nu.onlyPaid__text,children:" "}),ve.jsx(kF,{onChange:i,enabled:e.onlyPaidSessions})]})}),ve.jsxs("div",{className:nu.sessionFilters__minimalDuration,children:[ve.jsx("span",{className:nu.minimalDuration__text,children:" , "}),ve.jsx(ko,{children:ve.jsx(zF,{onChange:F=>C(F),orderedItemKeys:["<1","2","3","5","8",">12"],items:{"<1":0,2:2,3:3,5:5,8:8,">12":12},current:e.durationInHours})})]}),ve.jsxs("div",{className:nu.sessionFilters__connectors,children:[ve.jsx("div",{className:nu.connectors__tittle,children:ve.jsx("a",{className:nu.tittle__text,children:""})}),ve.jsx(ko,{children:ve.jsxs("div",{className:nu.connectors__row,children:[ve.jsx(Os,{onChange:F=>b("Type 1",F),connector:"Type 1",enabled:e.connectors.includes("Type 1")}),ve.jsx(Os,{onChange:F=>b("Type 2",F),connector:"Type 2",enabled:e.connectors.includes("Type 2")}),ve.jsx(Os,{onChange:F=>b("CCS1",F),connector:"CCS1",enabled:e.connectors.includes("CCS1")})]})}),ve.jsx(ko,{children:ve.jsxs("div",{className:nu.connectors__row,children:[ve.jsx(Os,{onChange:F=>b("CCS2",F),connector:"CCS2",enabled:e.connectors.includes("CCS2")}),ve.jsx(Os,{onChange:F=>b("GB/T (AC)",F),connector:"GB/T (AC)",enabled:e.connectors.includes("GB/T (AC)")}),ve.jsx(Os,{onChange:F=>b("GB/T (DC)",F),connector:"GB/T (DC)",enabled:e.connectors.includes("GB/T (DC)")})]})}),ve.jsx(ko,{children:ve.jsxs("div",{className:nu.connectors__lastRow,children:[ve.jsx(Os,{onChange:F=>b("CHAdeMO",F),connector:"CHAdeMO",enabled:e.connectors.includes("CHAdeMO")}),ve.jsx(Os,{onChange:F=>b("Tesla",F),connector:"Tesla",enabled:e.connectors.includes("Tesla")})]})})]}),a&&ve.jsx(_5,{variant:"success",text:" "}),h&&ve.jsx(_5,{variant:"success",text:" "}),ve.jsxs("div",{className:nu.sessionFilters__footer,children:[ve.jsx(DF,{onClick:j,disabled:gne(e),iconSrc:LF,text:" "}),ve.jsx(vf,{onClick:I,variant:"fill",text:"",disabled:!e.isModified})]})]})}function vne(){const e=zo();return ve.jsx(Qd,{onReturn:()=>e(dy),title:"",className:CF.page,children:ve.jsx(yne,{})})}const xne="_date__text_mwn2c_13",bne="_main__sessionCard_mwn2c_29",wne="_sessionsMap__date_mwn2c_47",zT={date__text:xne,main__sessionCard:bne,sessionsMap__date:wne},Sne="_sessionCard_1g9lo_1",Tne="_sessionCard__header_1g9lo_9",Ene="_header__content_1g9lo_10",Ane="_content__connector_1g9lo_23",Cne="_content__station_1g9lo_28",Mne="_station__mainInfo_1g9lo_35",One="_mainInfo__texts_1g9lo_41",Pne="_texts__name_1g9lo_47",Ine="_texts__address_1g9lo_57",Rne="_station__button_1g9lo_67",Dne="_sessionCard__gradientButton_1g9lo_75",Ju={sessionCard:Sne,sessionCard__header:Tne,header__content:Ene,content__connector:Ane,content__station:Cne,station__mainInfo:Mne,mainInfo__texts:One,texts__name:Pne,texts__address:Ine,station__button:Rne,sessionCard__gradientButton:Dne},Lne="_connector_kb4e8_1",kne="_connector__icon_kb4e8_7",zne="_connector__standard_kb4e8_18",Bne="_standard__text_kb4e8_24",Nv={connector:Lne,connector__icon:kne,connector__standard:zne,standard__text:Bne};function Nne(e){return ve.jsxs("div",{className:Nv.connector,children:[ve.jsx("div",{className:Nv.connector__icon,children:ve.jsx("img",{src:g2[e.connector.standard],alt:e.connector.standard,className:Nv.connector__icon})}),ve.jsx("div",{className:Nv.connector__standard,children:ve.jsx("p",{className:Nv.standard__text,children:e.connector.standard})})]})}const Fne="_gradientButton_pqovy_1",jne="_button__arrowIcon_pqovy_17",Une="_orange_pqovy_21",Vne="_button__alert_pqovy_25",$ne="_alert__icon_pqovy_30",qne="_alert__message_pqovy_41",Gne="_message__text_pqovy_47",O0={gradientButton:Fne,button__arrowIcon:jne,orange:Une,button__alert:Vne,alert__icon:$ne,alert__message:qne,message__text:Gne},Hne="data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3ccircle%20cx='12'%20cy='12'%20r='10'%20fill='%23373435'/%3e%3cpath%20d='M12%207V13'%20stroke='white'%20stroke-width='1.5'%20stroke-linecap='round'/%3e%3ccircle%20cx='12'%20cy='16'%20r='0.5'%20fill='white'%20stroke='white'/%3e%3c/svg%3e",NF="data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M9%2018L15%2012L9%206'%20stroke='white'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e";function Zne(e){return ve.jsxs("button",{"data-gradient-button":"true",onClick:e.onClick,className:`${O0.gradientButton} ${O0[e.gradientTemplate]}`,children:[ve.jsxs("div",{className:O0.button__alert,children:[ve.jsx("img",{className:O0.alert__icon,src:Hne}),ve.jsx("div",{className:O0.alert__message,children:ve.jsx("p",{className:O0.message__text,children:"  "})})]}),ve.jsx("img",{className:O0.button__arrowIcon,src:NF})]})}const Wne="_horizontalSplit_di3nz_1",Xne="_sessionCard__chargingInfo_di3nz_8",Yne="_texts__row_di3nz_9",Kne="_activeSessionTexts__powerInfo_di3nz_10",Jne="_powerInfo__row_di3nz_11",Qne="_times__duration_di3nz_12",ere="_texts__paymentMethod_di3nz_13",tre="_chargingInfo__icon_di3nz_18",nre="_chargingInfo__texts_di3nz_27",rre="_row__label_di3nz_35",ire="_row__value_di3nz_46",are="_sessionCard__session_di3nz_56",ore="_sessionCard__payment_di3nz_57",sre="_session__icon_di3nz_63",lre="_session__times_di3nz_72",cre="_times__start_di3nz_79",ure="_texts__amount_di3nz_81",hre="_bateryInfo__row_di3nz_83",fre="_payment__icon_di3nz_89",dre="_payment__texts_di3nz_98",pre="_chargingInfo__activeSessionTexts_di3nz_105",mre="_activeSessionTexts__bateryInfo_di3nz_114",Sr={horizontalSplit:Wne,sessionCard__chargingInfo:Xne,texts__row:Yne,activeSessionTexts__powerInfo:Kne,powerInfo__row:Jne,times__duration:Qne,texts__paymentMethod:ere,chargingInfo__icon:tre,chargingInfo__texts:nre,row__label:rre,row__value:ire,sessionCard__session:are,sessionCard__payment:ore,session__icon:sre,session__times:lre,times__start:cre,texts__amount:ure,bateryInfo__row:hre,payment__icon:fre,payment__texts:dre,chargingInfo__activeSessionTexts:pre,activeSessionTexts__bateryInfo:mre},FF="data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M22%209.5V14.5M10.75%209.5L8.25%2012H12L9.5%2014.5M2%208.25V15.75C2%2016.4404%202.55965%2017%203.25%2017H18.25C18.9404%2017%2019.5%2016.4404%2019.5%2015.75V8.25C19.5%207.55965%2018.9404%207%2018.25%207H3.25C2.55965%207%202%207.55965%202%208.25Z'%20stroke='%23373435'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",jF="data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M12%202.625C6.61425%202.625%202.25%206.99%202.25%2012.375C2.25%2017.76%206.61425%2022.125%2012%2022.125C17.3842%2022.125%2021.75%2017.76%2021.75%2012.375C21.75%206.99%2017.385%202.625%2012%202.625ZM11.9213%2020.2703C7.572%2020.2703%204.04625%2016.7445%204.04625%2012.3953C4.04625%208.046%207.572%204.52025%2011.9213%204.52025C16.2698%204.52025%2019.7962%208.046%2019.7962%2012.3953C19.7962%2016.7445%2016.2698%2020.2703%2011.9213%2020.2703ZM14.1975%2012.8483H11.9625V9.07425C11.9625%208.66475%2011.6302%208.33175%2011.2208%208.33175C10.8113%208.33175%2010.4782%208.664%2010.4782%209.07425V13.59C10.4782%2014.0003%2010.8105%2014.3317%2011.2208%2014.3317H14.1975C14.6077%2014.3317%2014.94%2014.0003%2014.94%2013.59C14.94%2013.1805%2014.6077%2012.8483%2014.1975%2012.8483Z'%20fill='%23373435'/%3e%3c/svg%3e",_re="data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M19.2389%205.02051C20.7014%205.02051%2021.8973%206.16221%2021.9839%207.60299L21.9889%207.77051V16.2756C21.9889%2017.7381%2020.8472%2018.934%2019.4064%2019.0206L19.2389%2019.0256H4.76105C3.29852%2019.0256%202.10264%2017.8839%202.01607%2016.4431L2.01105%2016.2756V7.77051C2.01105%206.30798%203.15275%205.1121%204.59352%205.02553L4.76105%205.02051H19.2389ZM20.488%2010.9945H3.51005L3.51105%2016.2756C3.51105%2016.9228%204.00292%2017.4551%204.63324%2017.5191L4.76105%2017.5256H19.2389C19.8861%2017.5256%2020.4184%2017.0337%2020.4824%2016.4034L20.4889%2016.2756L20.488%2010.9945ZM18.2529%2014.4998C18.6671%2014.4998%2019.0029%2014.8356%2019.0029%2015.2498C19.0029%2015.6295%2018.7207%2015.9433%2018.3547%2015.993L18.2529%2015.9998H15.7529C15.3387%2015.9998%2015.0029%2015.664%2015.0029%2015.2498C15.0029%2014.8701%2015.2851%2014.5563%2015.6511%2014.5066L15.7529%2014.4998H18.2529ZM19.2389%206.52051H4.76105C4.11384%206.52051%203.58151%207.01238%203.5175%207.6427L3.51105%207.77051L3.51005%209.49451H20.488L20.4889%207.77051C20.4889%207.1233%2019.997%206.59097%2019.3667%206.52696L19.2389%206.52051Z'%20fill='%23373435'/%3e%3c/svg%3e";function gre(e){var a,o;const t=e.sessionValues.end_date===void 0?Db(Nw(new Date),e.sessionValues.start_date):Db(e.sessionValues.end_date,e.sessionValues.start_date);return ve.jsxs(ve.Fragment,{children:[ve.jsx("div",{className:Sr.horizontalSplit}),ve.jsxs("div",{className:Sr.sessionCard__chargingInfo,children:[ve.jsx("div",{className:Sr.chargingInfo__icon,children:ve.jsx("img",{src:FF,alt:"batteryImage",className:Sr.chargingInfo__icon})}),e.isActive?ve.jsxs("div",{className:Sr.chargingInfo__activeSessionTexts,children:[ve.jsxs("div",{className:Sr.activeSessionTexts__bateryInfo,children:[ve.jsxs("div",{className:Sr.bateryInfo__row,children:[ve.jsx("p",{className:Sr.row__label,children:":"}),ve.jsxs("p",{className:Sr.row__value,children:[e.sessionValues.charged_kwh," "]})]}),ve.jsxs("div",{className:Sr.bateryInfo__row,children:[ve.jsx("p",{className:Sr.row__label,children:" :"}),ve.jsxs("p",{className:Sr.row__value,children:[e.sessionValues.battery_percentage,"%"]})]})]}),ve.jsx("div",{className:Sr.activeSessionTexts__powerInfo,children:ve.jsxs("div",{className:Sr.powerInfo__row,children:[ve.jsx("p",{className:Sr.row__label,children:":"}),ve.jsxs("p",{className:Sr.row__value,children:[e.sessionValues.current_power," "]})]})})]}):ve.jsxs("div",{className:Sr.chargingInfo__texts,children:[ve.jsxs("div",{className:Sr.texts__row,children:[ve.jsx("p",{className:Sr.row__label,children:":"}),ve.jsxs("p",{className:Sr.row__value,children:[e.sessionValues.charged_kwh," "]})]}),ve.jsxs("div",{className:Sr.texts__row,children:[ve.jsx("p",{className:Sr.row__label,children:" :"}),ve.jsxs("p",{className:Sr.row__value,children:[e.sessionValues.max_power," "]})]}),ve.jsxs("div",{className:Sr.texts__row,children:[ve.jsx("p",{className:Sr.row__label,children:" :"}),ve.jsxs("p",{className:Sr.row__value,children:[e.sessionValues.min_power," "]})]})]})]}),ve.jsx("div",{className:Sr.horizontalSplit}),ve.jsxs("div",{className:Sr.sessionCard__session,children:[ve.jsx("div",{className:Sr.session__icon,children:ve.jsx("img",{src:jF,alt:"clockImage",className:Sr.session__icon})}),ve.jsxs("div",{className:Sr.session__times,children:[ve.jsxs("div",{className:Sr.times__start,children:[ve.jsx("p",{className:Sr.row__label,children:":"}),ve.jsx("p",{className:Sr.row__value,children:UN(e.sessionValues.start_date.hours,e.sessionValues.start_date.minutes,e.sessionValues.start_date.seconds)})]}),ve.jsxs("div",{className:Sr.times__duration,children:[ve.jsx("p",{className:Sr.row__label,children:":"}),ve.jsx("p",{className:Sr.row__value,children:VN(t.hours,t.minutes,t.seconds)})]})]})]}),!e.isActive&&ve.jsxs(ve.Fragment,{children:[ve.jsx("div",{className:Sr.horizontalSplit}),ve.jsxs("div",{className:Sr.sessionCard__payment,children:[ve.jsx("div",{className:Sr.payment__icon,children:ve.jsx("img",{src:_re,alt:"paymentImage",className:Sr.payment__icon})}),ve.jsxs("div",{className:Sr.payment__texts,children:[ve.jsxs("div",{className:Sr.texts__amount,children:[ve.jsx("p",{className:Sr.row__label,children:":"}),ve.jsxs("p",{className:Sr.row__value,children:[e.sessionValues.total_cost," ",((o=(a=e.sessionValues.tariffs)==null?void 0:a[0])==null?void 0:o.currency)||"","."]})]}),ve.jsxs("div",{className:Sr.texts__paymentMethod,children:[ve.jsx("p",{className:Sr.row__label,children:" :"}),ve.jsx("p",{className:Sr.row__value,children:e.sessionValues.payment_method})]})]})]})]})]})}const UF="data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M22%2013.9979C21.9711%2017.4119%2021.7815%2019.294%2020.5404%2020.5352C19.0755%2022%2016.7179%2022%2012.0026%2022C7.28733%2022%204.9297%2022%203.46485%2020.5352C2%2019.0703%202%2016.7127%202%2011.9974C2%207.28212%202%204.92448%203.46485%203.45963C4.70599%202.21848%206.58807%202.02895%2010.0021%202'%20stroke='%23373435'%20stroke-width='1.5'%20stroke-linecap='round'/%3e%3cpath%20d='M16%208L22%202M22%202H17.5M22%202V6.5'%20stroke='%23373435'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e";function yre(e){const t=e.session.status==="",a=e.session.payment_status==="",o=zo(),h=()=>{o(kw+e.session.id+lc([{key:E1.PREVIOUS_PAGE,value:A1.SESSIONS_LIST}]))},y=()=>{o(_2+e.session.connector_info.station_id+lc([{key:Hd.PREVIOUS_PAGE,value:Vd.SESSIONS_LIST}]))};return ve.jsxs("div",{className:Ju.sessionCard,children:[ve.jsx("div",{className:Ju.sessionCard__header,children:ve.jsxs("div",{className:Ju.header__content,children:[ve.jsx("div",{className:Ju.content__connector,children:ve.jsx(Nne,{connector:e.session.connector_info})}),ve.jsxs("div",{className:Ju.content__station,children:[ve.jsxs("div",{className:Ju.station__mainInfo,children:[ve.jsxs("div",{className:Ju.mainInfo__texts,children:[ve.jsx("p",{className:Ju.texts__name,children:e.session.connector_info.station_name}),ve.jsx("p",{className:Ju.texts__address,children:e.session.connector_info.station_address})]}),ve.jsx(Jw,{textSize:"medium",text:e.session.status,color:_ne[e.session.status]})]}),ve.jsx("div",{className:Ju.station__button,children:ve.jsx(zw,{onClick:t?h:y,variant:"fill",iconSrc:t?NF:UF})})]})]})}),ve.jsx(gre,{isActive:t,sessionValues:e.session}),a&&ve.jsx("div",{className:Ju.sessionCard__gradientButton,children:ve.jsx(Zne,{onClick:()=>{},gradientTemplate:"orange"})})]})}const vre=e=>{const a=[...e].sort((o,h)=>{const y=h1(o.start_date);return h1(h.start_date).getTime()-y.getTime()}).reduce((o,h)=>{const y=h1(h.start_date),b=new Intl.DateTimeFormat("ru-RU",{day:"numeric",month:"long",year:"numeric"}).format(y);return o[b]||(o[b]=[]),o[b].push(h),o},{});return Object.keys(a).forEach(o=>{a[o].sort((h,y)=>h.status===""?-1:1)}),a};function xre(){const[e,t]=Ie.useState(!0),[a,o]=Ie.useState([]),h=zo(),y=()=>{h(ON)},i=vre([{id:"1",connector_info:{station_id:"1",station_name:"  ",station_address:". , . , 110",evse_uid:"1",connector_id:"1",standard:"CCS2",format:"",power_type:"AC",max_electric_power:36},status:"",charged_kwh:22,start_date:{year:2025,month:2,day:7,hours:13,minutes:2,seconds:48},end_date:{year:2025,month:2,day:7,hours:14,minutes:50,seconds:48},max_power:36,min_power:6.2,current_power:16.6,battery_percentage:66.67,payment_method:"-",total_cost:637.28,payment_status:""},{id:"2",connector_info:{station_id:"2",station_name:"  ",station_address:". , . , 110",evse_uid:"1",connector_id:"1",standard:"CCS2",format:"",power_type:"AC",max_electric_power:36},status:"",charged_kwh:22,start_date:{year:2025,month:2,day:7,hours:13,minutes:2,seconds:48},end_date:{year:2025,month:2,day:7,hours:14,minutes:50,seconds:48},max_power:36,min_power:6.2,current_power:16.6,battery_percentage:66.67,payment_method:"-",total_cost:637.28,payment_status:""},{id:"3",connector_info:{station_id:"2",station_name:"  ",station_address:". , . , 110",evse_uid:"1",connector_id:"1",standard:"CHAdeMO",format:"",power_type:"AC",max_electric_power:36},status:"",charged_kwh:22,start_date:{year:2025,month:2,day:5,hours:13,minutes:2,seconds:48},end_date:{year:2025,month:2,day:5,hours:15,minutes:8,seconds:48},max_power:36,min_power:6.2,current_power:16.6,battery_percentage:66.67,payment_method:"-",total_cost:637.28,payment_status:""},{id:"4",connector_info:{station_id:"2",station_name:"  ",station_address:". , . , 110",evse_uid:"1",connector_id:"1",standard:"GB/T (DC)",format:"",power_type:"AC",max_electric_power:36},status:"",charged_kwh:22,start_date:{year:2025,month:2,day:5,hours:13,minutes:2,seconds:48},end_date:{year:2025,month:2,day:5,hours:15,minutes:8,seconds:48},max_power:36,min_power:6.2,current_power:16.6,battery_percentage:66.67,payment_method:"-",total_cost:637.28,payment_status:""},{id:"5",connector_info:{station_id:"2",station_name:"  ",station_address:". , . , 110",evse_uid:"1",connector_id:"1",standard:"GB/T (DC)",format:"",power_type:"AC",max_electric_power:36},status:"",charged_kwh:22,start_date:{year:2025,month:1,day:15,hours:13,minutes:2,seconds:48},end_date:{year:2025,month:1,day:15,hours:15,minutes:8,seconds:48},max_power:36,min_power:6.2,current_power:16.6,battery_percentage:66.67,payment_method:"-",total_cost:637.28,payment_status:""}]),C=(G,X)=>Object.keys(i).slice(G,G+X).flatMap(oe=>{const[ge,fe,xe]=oe.split(" ");return[ve.jsx("div",{className:zT.sessionsMap__date,children:ve.jsxs("p",{className:zT.date__text,children:[`${ge} ${fe}`," "]})},`date-${oe}`),...i[oe].map(ae=>ve.jsx(ko,{className:zT.main__sessionCard,children:ve.jsx(yre,{session:ae})},ae.id))]}),I=(G,X)=>new Promise(Y=>{setTimeout(()=>{const J=C(G,X);Y(J)},1e3)}).finally(()=>{t(!1)});Ie.useEffect(()=>{I(0,10).then(G=>{o(G)})},[]);const j=Object.keys(i).length,F=()=>{if(a.length>0&&a.length<j){const G=a.length;I(G,15).then(X=>{X&&X.length>0&&o(Y=>[...Y,...X])})}};return ve.jsx(Qd,{onReturn:()=>h("/"),title:" ",headerContent:ve.jsx(zw,{iconSrc:iO,onClick:y,variant:"fill"}),children:ve.jsx(SF,{items:a,loading:e,getData:I,onDataLoad:F})})}const bre="_buttonBlock_1ppc0_1",wre="_info_1ppc0_13",ED={buttonBlock:bre,info:wre},Sre="_contentBlock_ker7g_1",Tre="_contentBlock__title_ker7g_8",Ere="_contentBlock__content_ker7g_17",Are="_content__items_ker7g_25",Cre="_content__icon_ker7g_35",Mre="_items__item_ker7g_40",Ore="_item__text_ker7g_46",Pre="_item__text_color_ker7g_46",am={contentBlock:Sre,contentBlock__title:Tre,contentBlock__content:Ere,content__items:Are,content__icon:Cre,items__item:Mre,item__text:Ore,item__text_color:Pre};function BT(e){return ve.jsxs("div",{className:am.contentBlock,children:[ve.jsx("p",{className:am.contentBlock__title,children:e.title}),ve.jsxs(ko,{className:am.contentBlock__content,children:[ve.jsx("img",{className:am.content__icon,src:e.iconSrc}),ve.jsx("div",{className:am.content__items,children:e.items.map((t,a)=>(t.checkVisible===void 0||t.checkVisible(t.value))&&ve.jsxs("div",{className:am.items__item,children:[ve.jsx("p",{className:am.item__text,children:t.description}),ve.jsx("p",{className:am.item__text_color,children:t.value})]},a))})]})]})}const Ire="data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M18.8092%2010.6244L18.8086%2010.6247L18.8092%2010.6244ZM18.8092%2010.6244L18.8136%2010.6225L18.8179%2010.616L18.8136%2010.6225L18.8179%2010.6207L18.8136%2010.6226L18.8114%2010.6258L18.8136%2010.6226L18.8092%2010.6244ZM5.32985%2013.3124L15.9429%201.94224L13.5694%209.71865L13.2737%2010.6876H14.2867H18.6701L8.05767%2022.0571L10.4306%2014.2813L10.7263%2013.3124H9.71326H5.32985Z'%20stroke='%23373435'%20stroke-width='1.5'/%3e%3c/svg%3e",Fv=e=>e!=="";var NT,AD;function wl(){if(AD)return NT;AD=1;var e=Array.isArray;return NT=e,NT}var FT,CD;function VF(){if(CD)return FT;CD=1;var e=typeof Nx=="object"&&Nx&&Nx.Object===Object&&Nx;return FT=e,FT}var jT,MD;function Tf(){if(MD)return jT;MD=1;var e=VF(),t=typeof self=="object"&&self&&self.Object===Object&&self,a=e||t||Function("return this")();return jT=a,jT}var UT,OD;function b2(){if(OD)return UT;OD=1;var e=Tf(),t=e.Symbol;return UT=t,UT}var VT,PD;function Rre(){if(PD)return VT;PD=1;var e=b2(),t=Object.prototype,a=t.hasOwnProperty,o=t.toString,h=e?e.toStringTag:void 0;function y(b){var i=a.call(b,h),C=b[h];try{b[h]=void 0;var I=!0}catch{}var j=o.call(b);return I&&(i?b[h]=C:delete b[h]),j}return VT=y,VT}var $T,ID;function Dre(){if(ID)return $T;ID=1;var e=Object.prototype,t=e.toString;function a(o){return t.call(o)}return $T=a,$T}var qT,RD;function ep(){if(RD)return qT;RD=1;var e=b2(),t=Rre(),a=Dre(),o="[object Null]",h="[object Undefined]",y=e?e.toStringTag:void 0;function b(i){return i==null?i===void 0?h:o:y&&y in Object(i)?t(i):a(i)}return qT=b,qT}var GT,DD;function tp(){if(DD)return GT;DD=1;function e(t){return t!=null&&typeof t=="object"}return GT=e,GT}var HT,LD;function my(){if(LD)return HT;LD=1;var e=ep(),t=tp(),a="[object Symbol]";function o(h){return typeof h=="symbol"||t(h)&&e(h)==a}return HT=o,HT}var ZT,kD;function EO(){if(kD)return ZT;kD=1;var e=wl(),t=my(),a=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,o=/^\w*$/;function h(y,b){if(e(y))return!1;var i=typeof y;return i=="number"||i=="symbol"||i=="boolean"||y==null||t(y)?!0:o.test(y)||!a.test(y)||b!=null&&y in Object(b)}return ZT=h,ZT}var WT,zD;function gm(){if(zD)return WT;zD=1;function e(t){var a=typeof t;return t!=null&&(a=="object"||a=="function")}return WT=e,WT}var XT,BD;function AO(){if(BD)return XT;BD=1;var e=ep(),t=gm(),a="[object AsyncFunction]",o="[object Function]",h="[object GeneratorFunction]",y="[object Proxy]";function b(i){if(!t(i))return!1;var C=e(i);return C==o||C==h||C==a||C==y}return XT=b,XT}var YT,ND;function Lre(){if(ND)return YT;ND=1;var e=Tf(),t=e["__core-js_shared__"];return YT=t,YT}var KT,FD;function kre(){if(FD)return KT;FD=1;var e=Lre(),t=function(){var o=/[^.]+$/.exec(e&&e.keys&&e.keys.IE_PROTO||"");return o?"Symbol(src)_1."+o:""}();function a(o){return!!t&&t in o}return KT=a,KT}var JT,jD;function $F(){if(jD)return JT;jD=1;var e=Function.prototype,t=e.toString;function a(o){if(o!=null){try{return t.call(o)}catch{}try{return o+""}catch{}}return""}return JT=a,JT}var QT,UD;function zre(){if(UD)return QT;UD=1;var e=AO(),t=kre(),a=gm(),o=$F(),h=/[\\^$.*+?()[\]{}|]/g,y=/^\[object .+?Constructor\]$/,b=Function.prototype,i=Object.prototype,C=b.toString,I=i.hasOwnProperty,j=RegExp("^"+C.call(I).replace(h,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function F(G){if(!a(G)||t(G))return!1;var X=e(G)?j:y;return X.test(o(G))}return QT=F,QT}var eE,VD;function Bre(){if(VD)return eE;VD=1;function e(t,a){return t==null?void 0:t[a]}return eE=e,eE}var tE,$D;function Y0(){if($D)return tE;$D=1;var e=zre(),t=Bre();function a(o,h){var y=t(o,h);return e(y)?y:void 0}return tE=a,tE}var nE,qD;function Qw(){if(qD)return nE;qD=1;var e=Y0(),t=e(Object,"create");return nE=t,nE}var rE,GD;function Nre(){if(GD)return rE;GD=1;var e=Qw();function t(){this.__data__=e?e(null):{},this.size=0}return rE=t,rE}var iE,HD;function Fre(){if(HD)return iE;HD=1;function e(t){var a=this.has(t)&&delete this.__data__[t];return this.size-=a?1:0,a}return iE=e,iE}var aE,ZD;function jre(){if(ZD)return aE;ZD=1;var e=Qw(),t="__lodash_hash_undefined__",a=Object.prototype,o=a.hasOwnProperty;function h(y){var b=this.__data__;if(e){var i=b[y];return i===t?void 0:i}return o.call(b,y)?b[y]:void 0}return aE=h,aE}var oE,WD;function Ure(){if(WD)return oE;WD=1;var e=Qw(),t=Object.prototype,a=t.hasOwnProperty;function o(h){var y=this.__data__;return e?y[h]!==void 0:a.call(y,h)}return oE=o,oE}var sE,XD;function Vre(){if(XD)return sE;XD=1;var e=Qw(),t="__lodash_hash_undefined__";function a(o,h){var y=this.__data__;return this.size+=this.has(o)?0:1,y[o]=e&&h===void 0?t:h,this}return sE=a,sE}var lE,YD;function $re(){if(YD)return lE;YD=1;var e=Nre(),t=Fre(),a=jre(),o=Ure(),h=Vre();function y(b){var i=-1,C=b==null?0:b.length;for(this.clear();++i<C;){var I=b[i];this.set(I[0],I[1])}}return y.prototype.clear=e,y.prototype.delete=t,y.prototype.get=a,y.prototype.has=o,y.prototype.set=h,lE=y,lE}var cE,KD;function qre(){if(KD)return cE;KD=1;function e(){this.__data__=[],this.size=0}return cE=e,cE}var uE,JD;function CO(){if(JD)return uE;JD=1;function e(t,a){return t===a||t!==t&&a!==a}return uE=e,uE}var hE,QD;function eS(){if(QD)return hE;QD=1;var e=CO();function t(a,o){for(var h=a.length;h--;)if(e(a[h][0],o))return h;return-1}return hE=t,hE}var fE,eL;function Gre(){if(eL)return fE;eL=1;var e=eS(),t=Array.prototype,a=t.splice;function o(h){var y=this.__data__,b=e(y,h);if(b<0)return!1;var i=y.length-1;return b==i?y.pop():a.call(y,b,1),--this.size,!0}return fE=o,fE}var dE,tL;function Hre(){if(tL)return dE;tL=1;var e=eS();function t(a){var o=this.__data__,h=e(o,a);return h<0?void 0:o[h][1]}return dE=t,dE}var pE,nL;function Zre(){if(nL)return pE;nL=1;var e=eS();function t(a){return e(this.__data__,a)>-1}return pE=t,pE}var mE,rL;function Wre(){if(rL)return mE;rL=1;var e=eS();function t(a,o){var h=this.__data__,y=e(h,a);return y<0?(++this.size,h.push([a,o])):h[y][1]=o,this}return mE=t,mE}var _E,iL;function tS(){if(iL)return _E;iL=1;var e=qre(),t=Gre(),a=Hre(),o=Zre(),h=Wre();function y(b){var i=-1,C=b==null?0:b.length;for(this.clear();++i<C;){var I=b[i];this.set(I[0],I[1])}}return y.prototype.clear=e,y.prototype.delete=t,y.prototype.get=a,y.prototype.has=o,y.prototype.set=h,_E=y,_E}var gE,aL;function MO(){if(aL)return gE;aL=1;var e=Y0(),t=Tf(),a=e(t,"Map");return gE=a,gE}var yE,oL;function Xre(){if(oL)return yE;oL=1;var e=$re(),t=tS(),a=MO();function o(){this.size=0,this.__data__={hash:new e,map:new(a||t),string:new e}}return yE=o,yE}var vE,sL;function Yre(){if(sL)return vE;sL=1;function e(t){var a=typeof t;return a=="string"||a=="number"||a=="symbol"||a=="boolean"?t!=="__proto__":t===null}return vE=e,vE}var xE,lL;function nS(){if(lL)return xE;lL=1;var e=Yre();function t(a,o){var h=a.__data__;return e(o)?h[typeof o=="string"?"string":"hash"]:h.map}return xE=t,xE}var bE,cL;function Kre(){if(cL)return bE;cL=1;var e=nS();function t(a){var o=e(this,a).delete(a);return this.size-=o?1:0,o}return bE=t,bE}var wE,uL;function Jre(){if(uL)return wE;uL=1;var e=nS();function t(a){return e(this,a).get(a)}return wE=t,wE}var SE,hL;function Qre(){if(hL)return SE;hL=1;var e=nS();function t(a){return e(this,a).has(a)}return SE=t,SE}var TE,fL;function eie(){if(fL)return TE;fL=1;var e=nS();function t(a,o){var h=e(this,a),y=h.size;return h.set(a,o),this.size+=h.size==y?0:1,this}return TE=t,TE}var EE,dL;function OO(){if(dL)return EE;dL=1;var e=Xre(),t=Kre(),a=Jre(),o=Qre(),h=eie();function y(b){var i=-1,C=b==null?0:b.length;for(this.clear();++i<C;){var I=b[i];this.set(I[0],I[1])}}return y.prototype.clear=e,y.prototype.delete=t,y.prototype.get=a,y.prototype.has=o,y.prototype.set=h,EE=y,EE}var AE,pL;function qF(){if(pL)return AE;pL=1;var e=OO(),t="Expected a function";function a(o,h){if(typeof o!="function"||h!=null&&typeof h!="function")throw new TypeError(t);var y=function(){var b=arguments,i=h?h.apply(this,b):b[0],C=y.cache;if(C.has(i))return C.get(i);var I=o.apply(this,b);return y.cache=C.set(i,I)||C,I};return y.cache=new(a.Cache||e),y}return a.Cache=e,AE=a,AE}var CE,mL;function tie(){if(mL)return CE;mL=1;var e=qF(),t=500;function a(o){var h=e(o,function(b){return y.size===t&&y.clear(),b}),y=h.cache;return h}return CE=a,CE}var ME,_L;function nie(){if(_L)return ME;_L=1;var e=tie(),t=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,a=/\\(\\)?/g,o=e(function(h){var y=[];return h.charCodeAt(0)===46&&y.push(""),h.replace(t,function(b,i,C,I){y.push(C?I.replace(a,"$1"):i||b)}),y});return ME=o,ME}var OE,gL;function PO(){if(gL)return OE;gL=1;function e(t,a){for(var o=-1,h=t==null?0:t.length,y=Array(h);++o<h;)y[o]=a(t[o],o,t);return y}return OE=e,OE}var PE,yL;function rie(){if(yL)return PE;yL=1;var e=b2(),t=PO(),a=wl(),o=my(),h=e?e.prototype:void 0,y=h?h.toString:void 0;function b(i){if(typeof i=="string")return i;if(a(i))return t(i,b)+"";if(o(i))return y?y.call(i):"";var C=i+"";return C=="0"&&1/i==-1/0?"-0":C}return PE=b,PE}var IE,vL;function GF(){if(vL)return IE;vL=1;var e=rie();function t(a){return a==null?"":e(a)}return IE=t,IE}var RE,xL;function HF(){if(xL)return RE;xL=1;var e=wl(),t=EO(),a=nie(),o=GF();function h(y,b){return e(y)?y:t(y,b)?[y]:a(o(y))}return RE=h,RE}var DE,bL;function rS(){if(bL)return DE;bL=1;var e=my();function t(a){if(typeof a=="string"||e(a))return a;var o=a+"";return o=="0"&&1/a==-1/0?"-0":o}return DE=t,DE}var LE,wL;function IO(){if(wL)return LE;wL=1;var e=HF(),t=rS();function a(o,h){h=e(h,o);for(var y=0,b=h.length;o!=null&&y<b;)o=o[t(h[y++])];return y&&y==b?o:void 0}return LE=a,LE}var kE,SL;function ZF(){if(SL)return kE;SL=1;var e=IO();function t(a,o,h){var y=a==null?void 0:e(a,o);return y===void 0?h:y}return kE=t,kE}var iie=ZF();const ah=Ei(iie);var zE,TL;function aie(){if(TL)return zE;TL=1;function e(t){return t==null}return zE=e,zE}var oie=aie();const ei=Ei(oie);var BE,EL;function sie(){if(EL)return BE;EL=1;var e=ep(),t=wl(),a=tp(),o="[object String]";function h(y){return typeof y=="string"||!t(y)&&a(y)&&e(y)==o}return BE=h,BE}var lie=sie();const w2=Ei(lie);var cie=AO();const Vr=Ei(cie);var uie=gm();const _y=Ei(uie);var NE={exports:{}},Ti={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var AL;function hie(){if(AL)return Ti;AL=1;var e=Symbol.for("react.element"),t=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),h=Symbol.for("react.profiler"),y=Symbol.for("react.provider"),b=Symbol.for("react.context"),i=Symbol.for("react.server_context"),C=Symbol.for("react.forward_ref"),I=Symbol.for("react.suspense"),j=Symbol.for("react.suspense_list"),F=Symbol.for("react.memo"),G=Symbol.for("react.lazy"),X=Symbol.for("react.offscreen"),Y;Y=Symbol.for("react.module.reference");function J(ee){if(typeof ee=="object"&&ee!==null){var oe=ee.$$typeof;switch(oe){case e:switch(ee=ee.type,ee){case a:case h:case o:case I:case j:return ee;default:switch(ee=ee&&ee.$$typeof,ee){case i:case b:case C:case G:case F:case y:return ee;default:return oe}}case t:return oe}}}return Ti.ContextConsumer=b,Ti.ContextProvider=y,Ti.Element=e,Ti.ForwardRef=C,Ti.Fragment=a,Ti.Lazy=G,Ti.Memo=F,Ti.Portal=t,Ti.Profiler=h,Ti.StrictMode=o,Ti.Suspense=I,Ti.SuspenseList=j,Ti.isAsyncMode=function(){return!1},Ti.isConcurrentMode=function(){return!1},Ti.isContextConsumer=function(ee){return J(ee)===b},Ti.isContextProvider=function(ee){return J(ee)===y},Ti.isElement=function(ee){return typeof ee=="object"&&ee!==null&&ee.$$typeof===e},Ti.isForwardRef=function(ee){return J(ee)===C},Ti.isFragment=function(ee){return J(ee)===a},Ti.isLazy=function(ee){return J(ee)===G},Ti.isMemo=function(ee){return J(ee)===F},Ti.isPortal=function(ee){return J(ee)===t},Ti.isProfiler=function(ee){return J(ee)===h},Ti.isStrictMode=function(ee){return J(ee)===o},Ti.isSuspense=function(ee){return J(ee)===I},Ti.isSuspenseList=function(ee){return J(ee)===j},Ti.isValidElementType=function(ee){return typeof ee=="string"||typeof ee=="function"||ee===a||ee===h||ee===o||ee===I||ee===j||ee===X||typeof ee=="object"&&ee!==null&&(ee.$$typeof===G||ee.$$typeof===F||ee.$$typeof===y||ee.$$typeof===b||ee.$$typeof===C||ee.$$typeof===Y||ee.getModuleId!==void 0)},Ti.typeOf=J,Ti}var CL;function fie(){return CL||(CL=1,NE.exports=hie()),NE.exports}var die=fie(),FE,ML;function WF(){if(ML)return FE;ML=1;var e=ep(),t=tp(),a="[object Number]";function o(h){return typeof h=="number"||t(h)&&e(h)==a}return FE=o,FE}var jE,OL;function pie(){if(OL)return jE;OL=1;var e=WF();function t(a){return e(a)&&a!=+a}return jE=t,jE}var mie=pie();const S2=Ei(mie);var _ie=WF();const gie=Ei(_ie);var lu=function(t){return t===0?0:t>0?1:-1},N0=function(t){return w2(t)&&t.indexOf("%")===t.length-1},Nn=function(t){return gie(t)&&!S2(t)},bo=function(t){return Nn(t)||w2(t)},yie=0,iS=function(t){var a=++yie;return"".concat(t||"").concat(a)},yl=function(t,a){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,h=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!Nn(t)&&!w2(t))return o;var y;if(N0(t)){var b=t.indexOf("%");y=a*parseFloat(t.slice(0,b))/100}else y=+t;return S2(y)&&(y=o),h&&y>a&&(y=a),y},Tg=function(t){if(!t)return null;var a=Object.keys(t);return a&&a.length?t[a[0]]:null},vie=function(t){if(!Array.isArray(t))return!1;for(var a=t.length,o={},h=0;h<a;h++)if(!o[t[h]])o[t[h]]=!0;else return!0;return!1},PL=function(t,a){return Nn(t)&&Nn(a)?function(o){return t+o*(a-t)}:function(){return a}};function g5(e,t,a){return!e||!e.length?null:e.find(function(o){return o&&(typeof t=="function"?t(o):ah(o,t))===a})}function y5(e,t){for(var a in e)if({}.hasOwnProperty.call(e,a)&&(!{}.hasOwnProperty.call(t,a)||e[a]!==t[a]))return!1;for(var o in t)if({}.hasOwnProperty.call(t,o)&&!{}.hasOwnProperty.call(e,o))return!1;return!0}function v5(e){"@babel/helpers - typeof";return v5=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},v5(e)}var xie=["viewBox","children"],bie=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],IL=["points","pathLength"],UE={svg:xie,polygon:IL,polyline:IL},RO=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],Fb=function(t,a){if(!t||typeof t=="function"||typeof t=="boolean")return null;var o=t;if(Ie.isValidElement(t)&&(o=t.props),!_y(o))return null;var h={};return Object.keys(o).forEach(function(y){RO.includes(y)&&(h[y]=a||function(b){return o[y](o,b)})}),h},wie=function(t,a,o){return function(h){return t(a,o,h),null}},aS=function(t,a,o){if(!_y(t)||v5(t)!=="object")return null;var h=null;return Object.keys(t).forEach(function(y){var b=t[y];RO.includes(y)&&typeof b=="function"&&(h||(h={}),h[y]=wie(b,a,o))}),h},Sie=["children"],Tie=["children"];function RL(e,t){if(e==null)return{};var a=Eie(e,t),o,h;if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(e);for(h=0;h<y.length;h++)o=y[h],!(t.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(a[o]=e[o])}return a}function Eie(e,t){if(e==null)return{};var a={};for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){if(t.indexOf(o)>=0)continue;a[o]=e[o]}return a}var DL={click:"onClick",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart",contextmenu:"onContextMenu",dblclick:"onDoubleClick"},$d=function(t){return typeof t=="string"?t:t?t.displayName||t.name||"Component":""},LL=null,VE=null,DO=function e(t){if(t===LL&&Array.isArray(VE))return VE;var a=[];return Ie.Children.forEach(t,function(o){ei(o)||(die.isFragment(o)?a=a.concat(e(o.props.children)):a.push(o))}),VE=a,LL=t,a};function _f(e,t){var a=[],o=[];return Array.isArray(t)?o=t.map(function(h){return $d(h)}):o=[$d(t)],DO(e).forEach(function(h){var y=ah(h,"type.displayName")||ah(h,"type.name");o.indexOf(y)!==-1&&a.push(h)}),a}function au(e,t){var a=_f(e,t);return a&&a[0]}var kL=function(t){if(!t||!t.props)return!1;var a=t.props,o=a.width,h=a.height;return!(!Nn(o)||o<=0||!Nn(h)||h<=0)},Aie=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColormatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-url","foreignObject","g","glyph","glyphRef","hkern","image","line","lineGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],Cie=function(t){return t&&t.type&&w2(t.type)&&Aie.indexOf(t.type)>=0},Mie=function(t,a,o,h){var y,b=(y=UE==null?void 0:UE[h])!==null&&y!==void 0?y:[];return!Vr(t)&&(h&&b.includes(a)||bie.includes(a))||o&&RO.includes(a)},Fr=function(t,a,o){if(!t||typeof t=="function"||typeof t=="boolean")return null;var h=t;if(Ie.isValidElement(t)&&(h=t.props),!_y(h))return null;var y={};return Object.keys(h).forEach(function(b){var i;Mie((i=h)===null||i===void 0?void 0:i[b],b,a,o)&&(y[b]=h[b])}),y},x5=function e(t,a){if(t===a)return!0;var o=Ie.Children.count(t);if(o!==Ie.Children.count(a))return!1;if(o===0)return!0;if(o===1)return zL(Array.isArray(t)?t[0]:t,Array.isArray(a)?a[0]:a);for(var h=0;h<o;h++){var y=t[h],b=a[h];if(Array.isArray(y)||Array.isArray(b)){if(!e(y,b))return!1}else if(!zL(y,b))return!1}return!0},zL=function(t,a){if(ei(t)&&ei(a))return!0;if(!ei(t)&&!ei(a)){var o=t.props||{},h=o.children,y=RL(o,Sie),b=a.props||{},i=b.children,C=RL(b,Tie);return h&&i?y5(y,C)&&x5(h,i):!h&&!i?y5(y,C):!1}return!1},BL=function(t,a){var o=[],h={};return DO(t).forEach(function(y,b){if(Cie(y))o.push(y);else if(y){var i=$d(y.type),C=a[i]||{},I=C.handler,j=C.once;if(I&&(!j||!h[i])){var F=I(y,i,b);o.push(F),h[i]=!0}}}),o},Oie=function(t){var a=t&&t.type;return a&&DL[a]?DL[a]:null},Pie=function(t,a){return DO(a).indexOf(t)},Iie=["children","width","height","viewBox","className","style","title","desc"];function b5(){return b5=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},b5.apply(this,arguments)}function Rie(e,t){if(e==null)return{};var a=Die(e,t),o,h;if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(e);for(h=0;h<y.length;h++)o=y[h],!(t.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(a[o]=e[o])}return a}function Die(e,t){if(e==null)return{};var a={};for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){if(t.indexOf(o)>=0)continue;a[o]=e[o]}return a}function w5(e){var t=e.children,a=e.width,o=e.height,h=e.viewBox,y=e.className,b=e.style,i=e.title,C=e.desc,I=Rie(e,Iie),j=h||{width:a,height:o,x:0,y:0},F=oi("recharts-surface",y);return Ot.createElement("svg",b5({},Fr(I,!0,"svg"),{className:F,width:a,height:o,style:b,viewBox:"".concat(j.x," ").concat(j.y," ").concat(j.width," ").concat(j.height)}),Ot.createElement("title",null,i),Ot.createElement("desc",null,C),t)}var Lie=["children","className"];function S5(){return S5=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},S5.apply(this,arguments)}function kie(e,t){if(e==null)return{};var a=zie(e,t),o,h;if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(e);for(h=0;h<y.length;h++)o=y[h],!(t.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(a[o]=e[o])}return a}function zie(e,t){if(e==null)return{};var a={};for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){if(t.indexOf(o)>=0)continue;a[o]=e[o]}return a}var Ga=Ot.forwardRef(function(e,t){var a=e.children,o=e.className,h=kie(e,Lie),y=oi("recharts-layer",o);return Ot.createElement("g",S5({className:y},Fr(h,!0),{ref:t}),a)}),qd=function(t,a){for(var o=arguments.length,h=new Array(o>2?o-2:0),y=2;y<o;y++)h[y-2]=arguments[y]},$E,NL;function Bie(){if(NL)return $E;NL=1;function e(t,a,o){var h=-1,y=t.length;a<0&&(a=-a>y?0:y+a),o=o>y?y:o,o<0&&(o+=y),y=a>o?0:o-a>>>0,a>>>=0;for(var b=Array(y);++h<y;)b[h]=t[h+a];return b}return $E=e,$E}var qE,FL;function Nie(){if(FL)return qE;FL=1;var e=Bie();function t(a,o,h){var y=a.length;return h=h===void 0?y:h,!o&&h>=y?a:e(a,o,h)}return qE=t,qE}var GE,jL;function XF(){if(jL)return GE;jL=1;var e="\\ud800-\\udfff",t="\\u0300-\\u036f",a="\\ufe20-\\ufe2f",o="\\u20d0-\\u20ff",h=t+a+o,y="\\ufe0e\\ufe0f",b="\\u200d",i=RegExp("["+b+e+h+y+"]");function C(I){return i.test(I)}return GE=C,GE}var HE,UL;function Fie(){if(UL)return HE;UL=1;function e(t){return t.split("")}return HE=e,HE}var ZE,VL;function jie(){if(VL)return ZE;VL=1;var e="\\ud800-\\udfff",t="\\u0300-\\u036f",a="\\ufe20-\\ufe2f",o="\\u20d0-\\u20ff",h=t+a+o,y="\\ufe0e\\ufe0f",b="["+e+"]",i="["+h+"]",C="\\ud83c[\\udffb-\\udfff]",I="(?:"+i+"|"+C+")",j="[^"+e+"]",F="(?:\\ud83c[\\udde6-\\uddff]){2}",G="[\\ud800-\\udbff][\\udc00-\\udfff]",X="\\u200d",Y=I+"?",J="["+y+"]?",ee="(?:"+X+"(?:"+[j,F,G].join("|")+")"+J+Y+")*",oe=J+Y+ee,ge="(?:"+[j+i+"?",i,F,G,b].join("|")+")",fe=RegExp(C+"(?="+C+")|"+ge+oe,"g");function xe(ae){return ae.match(fe)||[]}return ZE=xe,ZE}var WE,$L;function Uie(){if($L)return WE;$L=1;var e=Fie(),t=XF(),a=jie();function o(h){return t(h)?a(h):e(h)}return WE=o,WE}var XE,qL;function Vie(){if(qL)return XE;qL=1;var e=Nie(),t=XF(),a=Uie(),o=GF();function h(y){return function(b){b=o(b);var i=t(b)?a(b):void 0,C=i?i[0]:b.charAt(0),I=i?e(i,1).join(""):b.slice(1);return C[y]()+I}}return XE=h,XE}var YE,GL;function $ie(){if(GL)return YE;GL=1;var e=Vie(),t=e("toUpperCase");return YE=t,YE}var qie=$ie();const oS=Ei(qie);function Wi(e){return function(){return e}}const YF=Math.cos,jb=Math.sin,oh=Math.sqrt,Ub=Math.PI,sS=2*Ub,T5=Math.PI,E5=2*T5,L0=1e-6,Gie=E5-L0;function KF(e){this._+=e[0];for(let t=1,a=e.length;t<a;++t)this._+=arguments[t]+e[t]}function Hie(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return KF;const a=10**t;return function(o){this._+=o[0];for(let h=1,y=o.length;h<y;++h)this._+=Math.round(arguments[h]*a)/a+o[h]}}class Zie{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?KF:Hie(t)}moveTo(t,a){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+a}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,a){this._append`L${this._x1=+t},${this._y1=+a}`}quadraticCurveTo(t,a,o,h){this._append`Q${+t},${+a},${this._x1=+o},${this._y1=+h}`}bezierCurveTo(t,a,o,h,y,b){this._append`C${+t},${+a},${+o},${+h},${this._x1=+y},${this._y1=+b}`}arcTo(t,a,o,h,y){if(t=+t,a=+a,o=+o,h=+h,y=+y,y<0)throw new Error(`negative radius: ${y}`);let b=this._x1,i=this._y1,C=o-t,I=h-a,j=b-t,F=i-a,G=j*j+F*F;if(this._x1===null)this._append`M${this._x1=t},${this._y1=a}`;else if(G>L0)if(!(Math.abs(F*C-I*j)>L0)||!y)this._append`L${this._x1=t},${this._y1=a}`;else{let X=o-b,Y=h-i,J=C*C+I*I,ee=X*X+Y*Y,oe=Math.sqrt(J),ge=Math.sqrt(G),fe=y*Math.tan((T5-Math.acos((J+G-ee)/(2*oe*ge)))/2),xe=fe/ge,ae=fe/oe;Math.abs(xe-1)>L0&&this._append`L${t+xe*j},${a+xe*F}`,this._append`A${y},${y},0,0,${+(F*X>j*Y)},${this._x1=t+ae*C},${this._y1=a+ae*I}`}}arc(t,a,o,h,y,b){if(t=+t,a=+a,o=+o,b=!!b,o<0)throw new Error(`negative radius: ${o}`);let i=o*Math.cos(h),C=o*Math.sin(h),I=t+i,j=a+C,F=1^b,G=b?h-y:y-h;this._x1===null?this._append`M${I},${j}`:(Math.abs(this._x1-I)>L0||Math.abs(this._y1-j)>L0)&&this._append`L${I},${j}`,o&&(G<0&&(G=G%E5+E5),G>Gie?this._append`A${o},${o},0,1,${F},${t-i},${a-C}A${o},${o},0,1,${F},${this._x1=I},${this._y1=j}`:G>L0&&this._append`A${o},${o},0,${+(G>=T5)},${F},${this._x1=t+o*Math.cos(y)},${this._y1=a+o*Math.sin(y)}`)}rect(t,a,o,h){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+a}h${o=+o}v${+h}h${-o}Z`}toString(){return this._}}function LO(e){let t=3;return e.digits=function(a){if(!arguments.length)return t;if(a==null)t=null;else{const o=Math.floor(a);if(!(o>=0))throw new RangeError(`invalid digits: ${a}`);t=o}return e},()=>new Zie(t)}function kO(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function JF(e){this._context=e}JF.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function lS(e){return new JF(e)}function QF(e){return e[0]}function ej(e){return e[1]}function tj(e,t){var a=Wi(!0),o=null,h=lS,y=null,b=LO(i);e=typeof e=="function"?e:e===void 0?QF:Wi(e),t=typeof t=="function"?t:t===void 0?ej:Wi(t);function i(C){var I,j=(C=kO(C)).length,F,G=!1,X;for(o==null&&(y=h(X=b())),I=0;I<=j;++I)!(I<j&&a(F=C[I],I,C))===G&&((G=!G)?y.lineStart():y.lineEnd()),G&&y.point(+e(F,I,C),+t(F,I,C));if(X)return y=null,X+""||null}return i.x=function(C){return arguments.length?(e=typeof C=="function"?C:Wi(+C),i):e},i.y=function(C){return arguments.length?(t=typeof C=="function"?C:Wi(+C),i):t},i.defined=function(C){return arguments.length?(a=typeof C=="function"?C:Wi(!!C),i):a},i.curve=function(C){return arguments.length?(h=C,o!=null&&(y=h(o)),i):h},i.context=function(C){return arguments.length?(C==null?o=y=null:y=h(o=C),i):o},i}function nb(e,t,a){var o=null,h=Wi(!0),y=null,b=lS,i=null,C=LO(I);e=typeof e=="function"?e:e===void 0?QF:Wi(+e),t=typeof t=="function"?t:Wi(t===void 0?0:+t),a=typeof a=="function"?a:a===void 0?ej:Wi(+a);function I(F){var G,X,Y,J=(F=kO(F)).length,ee,oe=!1,ge,fe=new Array(J),xe=new Array(J);for(y==null&&(i=b(ge=C())),G=0;G<=J;++G){if(!(G<J&&h(ee=F[G],G,F))===oe)if(oe=!oe)X=G,i.areaStart(),i.lineStart();else{for(i.lineEnd(),i.lineStart(),Y=G-1;Y>=X;--Y)i.point(fe[Y],xe[Y]);i.lineEnd(),i.areaEnd()}oe&&(fe[G]=+e(ee,G,F),xe[G]=+t(ee,G,F),i.point(o?+o(ee,G,F):fe[G],a?+a(ee,G,F):xe[G]))}if(ge)return i=null,ge+""||null}function j(){return tj().defined(h).curve(b).context(y)}return I.x=function(F){return arguments.length?(e=typeof F=="function"?F:Wi(+F),o=null,I):e},I.x0=function(F){return arguments.length?(e=typeof F=="function"?F:Wi(+F),I):e},I.x1=function(F){return arguments.length?(o=F==null?null:typeof F=="function"?F:Wi(+F),I):o},I.y=function(F){return arguments.length?(t=typeof F=="function"?F:Wi(+F),a=null,I):t},I.y0=function(F){return arguments.length?(t=typeof F=="function"?F:Wi(+F),I):t},I.y1=function(F){return arguments.length?(a=F==null?null:typeof F=="function"?F:Wi(+F),I):a},I.lineX0=I.lineY0=function(){return j().x(e).y(t)},I.lineY1=function(){return j().x(e).y(a)},I.lineX1=function(){return j().x(o).y(t)},I.defined=function(F){return arguments.length?(h=typeof F=="function"?F:Wi(!!F),I):h},I.curve=function(F){return arguments.length?(b=F,y!=null&&(i=b(y)),I):b},I.context=function(F){return arguments.length?(F==null?y=i=null:i=b(y=F),I):y},I}class nj{constructor(t,a){this._context=t,this._x=a}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,a){switch(t=+t,a=+a,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,a):this._context.moveTo(t,a);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,a,t,a):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+a)/2,t,this._y0,t,a);break}}this._x0=t,this._y0=a}}function Wie(e){return new nj(e,!0)}function Xie(e){return new nj(e,!1)}const zO={draw(e,t){const a=oh(t/Ub);e.moveTo(a,0),e.arc(0,0,a,0,sS)}},Yie={draw(e,t){const a=oh(t/5)/2;e.moveTo(-3*a,-a),e.lineTo(-a,-a),e.lineTo(-a,-3*a),e.lineTo(a,-3*a),e.lineTo(a,-a),e.lineTo(3*a,-a),e.lineTo(3*a,a),e.lineTo(a,a),e.lineTo(a,3*a),e.lineTo(-a,3*a),e.lineTo(-a,a),e.lineTo(-3*a,a),e.closePath()}},rj=oh(1/3),Kie=rj*2,Jie={draw(e,t){const a=oh(t/Kie),o=a*rj;e.moveTo(0,-a),e.lineTo(o,0),e.lineTo(0,a),e.lineTo(-o,0),e.closePath()}},Qie={draw(e,t){const a=oh(t),o=-a/2;e.rect(o,o,a,a)}},eae=.8908130915292852,ij=jb(Ub/10)/jb(7*Ub/10),tae=jb(sS/10)*ij,nae=-YF(sS/10)*ij,rae={draw(e,t){const a=oh(t*eae),o=tae*a,h=nae*a;e.moveTo(0,-a),e.lineTo(o,h);for(let y=1;y<5;++y){const b=sS*y/5,i=YF(b),C=jb(b);e.lineTo(C*a,-i*a),e.lineTo(i*o-C*h,C*o+i*h)}e.closePath()}},KE=oh(3),iae={draw(e,t){const a=-oh(t/(KE*3));e.moveTo(0,a*2),e.lineTo(-KE*a,-a),e.lineTo(KE*a,-a),e.closePath()}},ru=-.5,iu=oh(3)/2,A5=1/oh(12),aae=(A5/2+1)*3,oae={draw(e,t){const a=oh(t/aae),o=a/2,h=a*A5,y=o,b=a*A5+a,i=-y,C=b;e.moveTo(o,h),e.lineTo(y,b),e.lineTo(i,C),e.lineTo(ru*o-iu*h,iu*o+ru*h),e.lineTo(ru*y-iu*b,iu*y+ru*b),e.lineTo(ru*i-iu*C,iu*i+ru*C),e.lineTo(ru*o+iu*h,ru*h-iu*o),e.lineTo(ru*y+iu*b,ru*b-iu*y),e.lineTo(ru*i+iu*C,ru*C-iu*i),e.closePath()}};function sae(e,t){let a=null,o=LO(h);e=typeof e=="function"?e:Wi(e||zO),t=typeof t=="function"?t:Wi(t===void 0?64:+t);function h(){let y;if(a||(a=y=o()),e.apply(this,arguments).draw(a,+t.apply(this,arguments)),y)return a=null,y+""||null}return h.type=function(y){return arguments.length?(e=typeof y=="function"?y:Wi(y),h):e},h.size=function(y){return arguments.length?(t=typeof y=="function"?y:Wi(+y),h):t},h.context=function(y){return arguments.length?(a=y??null,h):a},h}function Vb(){}function $b(e,t,a){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+a)/6)}function aj(e){this._context=e}aj.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:$b(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:$b(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function lae(e){return new aj(e)}function oj(e){this._context=e}oj.prototype={areaStart:Vb,areaEnd:Vb,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:$b(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function cae(e){return new oj(e)}function sj(e){this._context=e}sj.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var a=(this._x0+4*this._x1+e)/6,o=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(a,o):this._context.moveTo(a,o);break;case 3:this._point=4;default:$b(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function uae(e){return new sj(e)}function lj(e){this._context=e}lj.prototype={areaStart:Vb,areaEnd:Vb,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function hae(e){return new lj(e)}function HL(e){return e<0?-1:1}function ZL(e,t,a){var o=e._x1-e._x0,h=t-e._x1,y=(e._y1-e._y0)/(o||h<0&&-0),b=(a-e._y1)/(h||o<0&&-0),i=(y*h+b*o)/(o+h);return(HL(y)+HL(b))*Math.min(Math.abs(y),Math.abs(b),.5*Math.abs(i))||0}function WL(e,t){var a=e._x1-e._x0;return a?(3*(e._y1-e._y0)/a-t)/2:t}function JE(e,t,a){var o=e._x0,h=e._y0,y=e._x1,b=e._y1,i=(y-o)/3;e._context.bezierCurveTo(o+i,h+i*t,y-i,b-i*a,y,b)}function qb(e){this._context=e}qb.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:JE(this,this._t0,WL(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var a=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,JE(this,WL(this,a=ZL(this,e,t)),a);break;default:JE(this,this._t0,a=ZL(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=a}}};function cj(e){this._context=new uj(e)}(cj.prototype=Object.create(qb.prototype)).point=function(e,t){qb.prototype.point.call(this,t,e)};function uj(e){this._context=e}uj.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,a,o,h,y){this._context.bezierCurveTo(t,e,o,a,y,h)}};function fae(e){return new qb(e)}function dae(e){return new cj(e)}function hj(e){this._context=e}hj.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,a=e.length;if(a)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),a===2)this._context.lineTo(e[1],t[1]);else for(var o=XL(e),h=XL(t),y=0,b=1;b<a;++y,++b)this._context.bezierCurveTo(o[0][y],h[0][y],o[1][y],h[1][y],e[b],t[b]);(this._line||this._line!==0&&a===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function XL(e){var t,a=e.length-1,o,h=new Array(a),y=new Array(a),b=new Array(a);for(h[0]=0,y[0]=2,b[0]=e[0]+2*e[1],t=1;t<a-1;++t)h[t]=1,y[t]=4,b[t]=4*e[t]+2*e[t+1];for(h[a-1]=2,y[a-1]=7,b[a-1]=8*e[a-1]+e[a],t=1;t<a;++t)o=h[t]/y[t-1],y[t]-=o,b[t]-=o*b[t-1];for(h[a-1]=b[a-1]/y[a-1],t=a-2;t>=0;--t)h[t]=(b[t]-h[t+1])/y[t];for(y[a-1]=(e[a]+h[a-1])/2,t=0;t<a-1;++t)y[t]=2*e[t+1]-h[t+1];return[h,y]}function pae(e){return new hj(e)}function cS(e,t){this._context=e,this._t=t}cS.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var a=this._x*(1-this._t)+e*this._t;this._context.lineTo(a,this._y),this._context.lineTo(a,t)}break}}this._x=e,this._y=t}};function mae(e){return new cS(e,.5)}function _ae(e){return new cS(e,0)}function gae(e){return new cS(e,1)}function Ug(e,t){if((b=e.length)>1)for(var a=1,o,h,y=e[t[0]],b,i=y.length;a<b;++a)for(h=y,y=e[t[a]],o=0;o<i;++o)y[o][1]+=y[o][0]=isNaN(h[o][1])?h[o][0]:h[o][1]}function C5(e){for(var t=e.length,a=new Array(t);--t>=0;)a[t]=t;return a}function yae(e,t){return e[t]}function vae(e){const t=[];return t.key=e,t}function xae(){var e=Wi([]),t=C5,a=Ug,o=yae;function h(y){var b=Array.from(e.apply(this,arguments),vae),i,C=b.length,I=-1,j;for(const F of y)for(i=0,++I;i<C;++i)(b[i][I]=[0,+o(F,b[i].key,I,y)]).data=F;for(i=0,j=kO(t(b));i<C;++i)b[j[i]].index=i;return a(b,j),b}return h.keys=function(y){return arguments.length?(e=typeof y=="function"?y:Wi(Array.from(y)),h):e},h.value=function(y){return arguments.length?(o=typeof y=="function"?y:Wi(+y),h):o},h.order=function(y){return arguments.length?(t=y==null?C5:typeof y=="function"?y:Wi(Array.from(y)),h):t},h.offset=function(y){return arguments.length?(a=y??Ug,h):a},h}function bae(e,t){if((o=e.length)>0){for(var a,o,h=0,y=e[0].length,b;h<y;++h){for(b=a=0;a<o;++a)b+=e[a][h][1]||0;if(b)for(a=0;a<o;++a)e[a][h][1]/=b}Ug(e,t)}}function wae(e,t){if((h=e.length)>0){for(var a=0,o=e[t[0]],h,y=o.length;a<y;++a){for(var b=0,i=0;b<h;++b)i+=e[b][a][1]||0;o[a][1]+=o[a][0]=-i/2}Ug(e,t)}}function Sae(e,t){if(!(!((b=e.length)>0)||!((y=(h=e[t[0]]).length)>0))){for(var a=0,o=1,h,y,b;o<y;++o){for(var i=0,C=0,I=0;i<b;++i){for(var j=e[t[i]],F=j[o][1]||0,G=j[o-1][1]||0,X=(F-G)/2,Y=0;Y<i;++Y){var J=e[t[Y]],ee=J[o][1]||0,oe=J[o-1][1]||0;X+=ee-oe}C+=F,I+=X*F}h[o-1][1]+=h[o-1][0]=a,C&&(a-=I/C)}h[o-1][1]+=h[o-1][0]=a,Ug(e,t)}}function I1(e){"@babel/helpers - typeof";return I1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},I1(e)}var Tae=["type","size","sizeType"];function M5(){return M5=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},M5.apply(this,arguments)}function YL(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(h){return Object.getOwnPropertyDescriptor(e,h).enumerable})),a.push.apply(a,o)}return a}function KL(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?YL(Object(a),!0).forEach(function(o){Eae(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):YL(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function Eae(e,t,a){return t=Aae(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Aae(e){var t=Cae(e,"string");return I1(t)=="symbol"?t:t+""}function Cae(e,t){if(I1(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t);if(I1(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Mae(e,t){if(e==null)return{};var a=Oae(e,t),o,h;if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(e);for(h=0;h<y.length;h++)o=y[h],!(t.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(a[o]=e[o])}return a}function Oae(e,t){if(e==null)return{};var a={};for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){if(t.indexOf(o)>=0)continue;a[o]=e[o]}return a}var fj={symbolCircle:zO,symbolCross:Yie,symbolDiamond:Jie,symbolSquare:Qie,symbolStar:rae,symbolTriangle:iae,symbolWye:oae},Pae=Math.PI/180,Iae=function(t){var a="symbol".concat(oS(t));return fj[a]||zO},Rae=function(t,a,o){if(a==="area")return t;switch(o){case"cross":return 5*t*t/9;case"diamond":return .5*t*t/Math.sqrt(3);case"square":return t*t;case"star":{var h=18*Pae;return 1.25*t*t*(Math.tan(h)-Math.tan(h*2)*Math.pow(Math.tan(h),2))}case"triangle":return Math.sqrt(3)*t*t/4;case"wye":return(21-10*Math.sqrt(3))*t*t/8;default:return Math.PI*t*t/4}},Dae=function(t,a){fj["symbol".concat(oS(t))]=a},BO=function(t){var a=t.type,o=a===void 0?"circle":a,h=t.size,y=h===void 0?64:h,b=t.sizeType,i=b===void 0?"area":b,C=Mae(t,Tae),I=KL(KL({},C),{},{type:o,size:y,sizeType:i}),j=function(){var ee=Iae(o),oe=sae().type(ee).size(Rae(y,i,o));return oe()},F=I.className,G=I.cx,X=I.cy,Y=Fr(I,!0);return G===+G&&X===+X&&y===+y?Ot.createElement("path",M5({},Y,{className:oi("recharts-symbols",F),transform:"translate(".concat(G,", ").concat(X,")"),d:j()})):null};BO.registerSymbol=Dae;function Vg(e){"@babel/helpers - typeof";return Vg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vg(e)}function O5(){return O5=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},O5.apply(this,arguments)}function JL(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(h){return Object.getOwnPropertyDescriptor(e,h).enumerable})),a.push.apply(a,o)}return a}function Lae(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?JL(Object(a),!0).forEach(function(o){R1(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):JL(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function kae(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zae(e,t){for(var a=0;a<t.length;a++){var o=t[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,pj(o.key),o)}}function Bae(e,t,a){return t&&zae(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Nae(e,t,a){return t=Gb(t),Fae(e,dj()?Reflect.construct(t,a||[],Gb(e).constructor):t.apply(e,a))}function Fae(e,t){if(t&&(Vg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return jae(e)}function jae(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function dj(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(dj=function(){return!!e})()}function Gb(e){return Gb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)},Gb(e)}function Uae(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&P5(e,t)}function P5(e,t){return P5=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,h){return o.__proto__=h,o},P5(e,t)}function R1(e,t,a){return t=pj(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function pj(e){var t=Vae(e,"string");return Vg(t)=="symbol"?t:t+""}function Vae(e,t){if(Vg(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t);if(Vg(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Qu=32,NO=function(e){function t(){return kae(this,t),Nae(this,t,arguments)}return Uae(t,e),Bae(t,[{key:"renderIcon",value:function(o){var h=this.props.inactiveColor,y=Qu/2,b=Qu/6,i=Qu/3,C=o.inactive?h:o.color;if(o.type==="plainline")return Ot.createElement("line",{strokeWidth:4,fill:"none",stroke:C,strokeDasharray:o.payload.strokeDasharray,x1:0,y1:y,x2:Qu,y2:y,className:"recharts-legend-icon"});if(o.type==="line")return Ot.createElement("path",{strokeWidth:4,fill:"none",stroke:C,d:"M0,".concat(y,"h").concat(i,`
            A`).concat(b,",").concat(b,",0,1,1,").concat(2*i,",").concat(y,`
            H`).concat(Qu,"M").concat(2*i,",").concat(y,`
            A`).concat(b,",").concat(b,",0,1,1,").concat(i,",").concat(y),className:"recharts-legend-icon"});if(o.type==="rect")return Ot.createElement("path",{stroke:"none",fill:C,d:"M0,".concat(Qu/8,"h").concat(Qu,"v").concat(Qu*3/4,"h").concat(-32,"z"),className:"recharts-legend-icon"});if(Ot.isValidElement(o.legendIcon)){var I=Lae({},o);return delete I.legendIcon,Ot.cloneElement(o.legendIcon,I)}return Ot.createElement(BO,{fill:C,cx:y,cy:y,size:Qu,sizeType:"diameter",type:o.type})}},{key:"renderItems",value:function(){var o=this,h=this.props,y=h.payload,b=h.iconSize,i=h.layout,C=h.formatter,I=h.inactiveColor,j={x:0,y:0,width:Qu,height:Qu},F={display:i==="horizontal"?"inline-block":"block",marginRight:10},G={display:"inline-block",verticalAlign:"middle",marginRight:4};return y.map(function(X,Y){var J=X.formatter||C,ee=oi(R1(R1({"recharts-legend-item":!0},"legend-item-".concat(Y),!0),"inactive",X.inactive));if(X.type==="none")return null;var oe=Vr(X.value)?null:X.value;qd(!Vr(X.value),`The name property is also required when using a function for the dataKey of a chart's cartesian components. Ex: <Bar name="Name of my Data"/>`);var ge=X.inactive?I:X.color;return Ot.createElement("li",O5({className:ee,style:F,key:"legend-item-".concat(Y)},aS(o.props,X,Y)),Ot.createElement(w5,{width:b,height:b,viewBox:j,style:G},o.renderIcon(X)),Ot.createElement("span",{className:"recharts-legend-item-text",style:{color:ge}},J?J(oe,X,Y):oe))})}},{key:"render",value:function(){var o=this.props,h=o.payload,y=o.layout,b=o.align;if(!h||!h.length)return null;var i={padding:0,margin:0,textAlign:y==="horizontal"?b:"left"};return Ot.createElement("ul",{className:"recharts-default-legend",style:i},this.renderItems())}}])}(Ie.PureComponent);R1(NO,"displayName","Legend");R1(NO,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"middle",inactiveColor:"#ccc"});var QE,QL;function $ae(){if(QL)return QE;QL=1;var e=tS();function t(){this.__data__=new e,this.size=0}return QE=t,QE}var eA,ek;function qae(){if(ek)return eA;ek=1;function e(t){var a=this.__data__,o=a.delete(t);return this.size=a.size,o}return eA=e,eA}var tA,tk;function Gae(){if(tk)return tA;tk=1;function e(t){return this.__data__.get(t)}return tA=e,tA}var nA,nk;function Hae(){if(nk)return nA;nk=1;function e(t){return this.__data__.has(t)}return nA=e,nA}var rA,rk;function Zae(){if(rk)return rA;rk=1;var e=tS(),t=MO(),a=OO(),o=200;function h(y,b){var i=this.__data__;if(i instanceof e){var C=i.__data__;if(!t||C.length<o-1)return C.push([y,b]),this.size=++i.size,this;i=this.__data__=new a(C)}return i.set(y,b),this.size=i.size,this}return rA=h,rA}var iA,ik;function mj(){if(ik)return iA;ik=1;var e=tS(),t=$ae(),a=qae(),o=Gae(),h=Hae(),y=Zae();function b(i){var C=this.__data__=new e(i);this.size=C.size}return b.prototype.clear=t,b.prototype.delete=a,b.prototype.get=o,b.prototype.has=h,b.prototype.set=y,iA=b,iA}var aA,ak;function Wae(){if(ak)return aA;ak=1;var e="__lodash_hash_undefined__";function t(a){return this.__data__.set(a,e),this}return aA=t,aA}var oA,ok;function Xae(){if(ok)return oA;ok=1;function e(t){return this.__data__.has(t)}return oA=e,oA}var sA,sk;function _j(){if(sk)return sA;sk=1;var e=OO(),t=Wae(),a=Xae();function o(h){var y=-1,b=h==null?0:h.length;for(this.__data__=new e;++y<b;)this.add(h[y])}return o.prototype.add=o.prototype.push=t,o.prototype.has=a,sA=o,sA}var lA,lk;function gj(){if(lk)return lA;lk=1;function e(t,a){for(var o=-1,h=t==null?0:t.length;++o<h;)if(a(t[o],o,t))return!0;return!1}return lA=e,lA}var cA,ck;function yj(){if(ck)return cA;ck=1;function e(t,a){return t.has(a)}return cA=e,cA}var uA,uk;function vj(){if(uk)return uA;uk=1;var e=_j(),t=gj(),a=yj(),o=1,h=2;function y(b,i,C,I,j,F){var G=C&o,X=b.length,Y=i.length;if(X!=Y&&!(G&&Y>X))return!1;var J=F.get(b),ee=F.get(i);if(J&&ee)return J==i&&ee==b;var oe=-1,ge=!0,fe=C&h?new e:void 0;for(F.set(b,i),F.set(i,b);++oe<X;){var xe=b[oe],ae=i[oe];if(I)var me=G?I(ae,xe,oe,i,b,F):I(xe,ae,oe,b,i,F);if(me!==void 0){if(me)continue;ge=!1;break}if(fe){if(!t(i,function(we,Ge){if(!a(fe,Ge)&&(xe===we||j(xe,we,C,I,F)))return fe.push(Ge)})){ge=!1;break}}else if(!(xe===ae||j(xe,ae,C,I,F))){ge=!1;break}}return F.delete(b),F.delete(i),ge}return uA=y,uA}var hA,hk;function Yae(){if(hk)return hA;hk=1;var e=Tf(),t=e.Uint8Array;return hA=t,hA}var fA,fk;function Kae(){if(fk)return fA;fk=1;function e(t){var a=-1,o=Array(t.size);return t.forEach(function(h,y){o[++a]=[y,h]}),o}return fA=e,fA}var dA,dk;function FO(){if(dk)return dA;dk=1;function e(t){var a=-1,o=Array(t.size);return t.forEach(function(h){o[++a]=h}),o}return dA=e,dA}var pA,pk;function Jae(){if(pk)return pA;pk=1;var e=b2(),t=Yae(),a=CO(),o=vj(),h=Kae(),y=FO(),b=1,i=2,C="[object Boolean]",I="[object Date]",j="[object Error]",F="[object Map]",G="[object Number]",X="[object RegExp]",Y="[object Set]",J="[object String]",ee="[object Symbol]",oe="[object ArrayBuffer]",ge="[object DataView]",fe=e?e.prototype:void 0,xe=fe?fe.valueOf:void 0;function ae(me,we,Ge,He,ye,ke,dt){switch(Ge){case ge:if(me.byteLength!=we.byteLength||me.byteOffset!=we.byteOffset)return!1;me=me.buffer,we=we.buffer;case oe:return!(me.byteLength!=we.byteLength||!ke(new t(me),new t(we)));case C:case I:case G:return a(+me,+we);case j:return me.name==we.name&&me.message==we.message;case X:case J:return me==we+"";case F:var vt=h;case Y:var jt=He&b;if(vt||(vt=y),me.size!=we.size&&!jt)return!1;var _t=dt.get(me);if(_t)return _t==we;He|=i,dt.set(me,we);var gt=o(vt(me),vt(we),He,ye,ke,dt);return dt.delete(me),gt;case ee:if(xe)return xe.call(me)==xe.call(we)}return!1}return pA=ae,pA}var mA,mk;function xj(){if(mk)return mA;mk=1;function e(t,a){for(var o=-1,h=a.length,y=t.length;++o<h;)t[y+o]=a[o];return t}return mA=e,mA}var _A,_k;function Qae(){if(_k)return _A;_k=1;var e=xj(),t=wl();function a(o,h,y){var b=h(o);return t(o)?b:e(b,y(o))}return _A=a,_A}var gA,gk;function eoe(){if(gk)return gA;gk=1;function e(t,a){for(var o=-1,h=t==null?0:t.length,y=0,b=[];++o<h;){var i=t[o];a(i,o,t)&&(b[y++]=i)}return b}return gA=e,gA}var yA,yk;function toe(){if(yk)return yA;yk=1;function e(){return[]}return yA=e,yA}var vA,vk;function noe(){if(vk)return vA;vk=1;var e=eoe(),t=toe(),a=Object.prototype,o=a.propertyIsEnumerable,h=Object.getOwnPropertySymbols,y=h?function(b){return b==null?[]:(b=Object(b),e(h(b),function(i){return o.call(b,i)}))}:t;return vA=y,vA}var xA,xk;function roe(){if(xk)return xA;xk=1;function e(t,a){for(var o=-1,h=Array(t);++o<t;)h[o]=a(o);return h}return xA=e,xA}var bA,bk;function ioe(){if(bk)return bA;bk=1;var e=ep(),t=tp(),a="[object Arguments]";function o(h){return t(h)&&e(h)==a}return bA=o,bA}var wA,wk;function jO(){if(wk)return wA;wk=1;var e=ioe(),t=tp(),a=Object.prototype,o=a.hasOwnProperty,h=a.propertyIsEnumerable,y=e(function(){return arguments}())?e:function(b){return t(b)&&o.call(b,"callee")&&!h.call(b,"callee")};return wA=y,wA}var a1={exports:{}},SA,Sk;function aoe(){if(Sk)return SA;Sk=1;function e(){return!1}return SA=e,SA}a1.exports;var Tk;function bj(){return Tk||(Tk=1,function(e,t){var a=Tf(),o=aoe(),h=t&&!t.nodeType&&t,y=h&&!0&&e&&!e.nodeType&&e,b=y&&y.exports===h,i=b?a.Buffer:void 0,C=i?i.isBuffer:void 0,I=C||o;e.exports=I}(a1,a1.exports)),a1.exports}var TA,Ek;function UO(){if(Ek)return TA;Ek=1;var e=9007199254740991,t=/^(?:0|[1-9]\d*)$/;function a(o,h){var y=typeof o;return h=h??e,!!h&&(y=="number"||y!="symbol"&&t.test(o))&&o>-1&&o%1==0&&o<h}return TA=a,TA}var EA,Ak;function VO(){if(Ak)return EA;Ak=1;var e=9007199254740991;function t(a){return typeof a=="number"&&a>-1&&a%1==0&&a<=e}return EA=t,EA}var AA,Ck;function ooe(){if(Ck)return AA;Ck=1;var e=ep(),t=VO(),a=tp(),o="[object Arguments]",h="[object Array]",y="[object Boolean]",b="[object Date]",i="[object Error]",C="[object Function]",I="[object Map]",j="[object Number]",F="[object Object]",G="[object RegExp]",X="[object Set]",Y="[object String]",J="[object WeakMap]",ee="[object ArrayBuffer]",oe="[object DataView]",ge="[object Float32Array]",fe="[object Float64Array]",xe="[object Int8Array]",ae="[object Int16Array]",me="[object Int32Array]",we="[object Uint8Array]",Ge="[object Uint8ClampedArray]",He="[object Uint16Array]",ye="[object Uint32Array]",ke={};ke[ge]=ke[fe]=ke[xe]=ke[ae]=ke[me]=ke[we]=ke[Ge]=ke[He]=ke[ye]=!0,ke[o]=ke[h]=ke[ee]=ke[y]=ke[oe]=ke[b]=ke[i]=ke[C]=ke[I]=ke[j]=ke[F]=ke[G]=ke[X]=ke[Y]=ke[J]=!1;function dt(vt){return a(vt)&&t(vt.length)&&!!ke[e(vt)]}return AA=dt,AA}var CA,Mk;function wj(){if(Mk)return CA;Mk=1;function e(t){return function(a){return t(a)}}return CA=e,CA}var o1={exports:{}};o1.exports;var Ok;function soe(){return Ok||(Ok=1,function(e,t){var a=VF(),o=t&&!t.nodeType&&t,h=o&&!0&&e&&!e.nodeType&&e,y=h&&h.exports===o,b=y&&a.process,i=function(){try{var C=h&&h.require&&h.require("util").types;return C||b&&b.binding&&b.binding("util")}catch{}}();e.exports=i}(o1,o1.exports)),o1.exports}var MA,Pk;function Sj(){if(Pk)return MA;Pk=1;var e=ooe(),t=wj(),a=soe(),o=a&&a.isTypedArray,h=o?t(o):e;return MA=h,MA}var OA,Ik;function loe(){if(Ik)return OA;Ik=1;var e=roe(),t=jO(),a=wl(),o=bj(),h=UO(),y=Sj(),b=Object.prototype,i=b.hasOwnProperty;function C(I,j){var F=a(I),G=!F&&t(I),X=!F&&!G&&o(I),Y=!F&&!G&&!X&&y(I),J=F||G||X||Y,ee=J?e(I.length,String):[],oe=ee.length;for(var ge in I)(j||i.call(I,ge))&&!(J&&(ge=="length"||X&&(ge=="offset"||ge=="parent")||Y&&(ge=="buffer"||ge=="byteLength"||ge=="byteOffset")||h(ge,oe)))&&ee.push(ge);return ee}return OA=C,OA}var PA,Rk;function coe(){if(Rk)return PA;Rk=1;var e=Object.prototype;function t(a){var o=a&&a.constructor,h=typeof o=="function"&&o.prototype||e;return a===h}return PA=t,PA}var IA,Dk;function Tj(){if(Dk)return IA;Dk=1;function e(t,a){return function(o){return t(a(o))}}return IA=e,IA}var RA,Lk;function uoe(){if(Lk)return RA;Lk=1;var e=Tj(),t=e(Object.keys,Object);return RA=t,RA}var DA,kk;function hoe(){if(kk)return DA;kk=1;var e=coe(),t=uoe(),a=Object.prototype,o=a.hasOwnProperty;function h(y){if(!e(y))return t(y);var b=[];for(var i in Object(y))o.call(y,i)&&i!="constructor"&&b.push(i);return b}return DA=h,DA}var LA,zk;function T2(){if(zk)return LA;zk=1;var e=AO(),t=VO();function a(o){return o!=null&&t(o.length)&&!e(o)}return LA=a,LA}var kA,Bk;function uS(){if(Bk)return kA;Bk=1;var e=loe(),t=hoe(),a=T2();function o(h){return a(h)?e(h):t(h)}return kA=o,kA}var zA,Nk;function foe(){if(Nk)return zA;Nk=1;var e=Qae(),t=noe(),a=uS();function o(h){return e(h,a,t)}return zA=o,zA}var BA,Fk;function doe(){if(Fk)return BA;Fk=1;var e=foe(),t=1,a=Object.prototype,o=a.hasOwnProperty;function h(y,b,i,C,I,j){var F=i&t,G=e(y),X=G.length,Y=e(b),J=Y.length;if(X!=J&&!F)return!1;for(var ee=X;ee--;){var oe=G[ee];if(!(F?oe in b:o.call(b,oe)))return!1}var ge=j.get(y),fe=j.get(b);if(ge&&fe)return ge==b&&fe==y;var xe=!0;j.set(y,b),j.set(b,y);for(var ae=F;++ee<X;){oe=G[ee];var me=y[oe],we=b[oe];if(C)var Ge=F?C(we,me,oe,b,y,j):C(me,we,oe,y,b,j);if(!(Ge===void 0?me===we||I(me,we,i,C,j):Ge)){xe=!1;break}ae||(ae=oe=="constructor")}if(xe&&!ae){var He=y.constructor,ye=b.constructor;He!=ye&&"constructor"in y&&"constructor"in b&&!(typeof He=="function"&&He instanceof He&&typeof ye=="function"&&ye instanceof ye)&&(xe=!1)}return j.delete(y),j.delete(b),xe}return BA=h,BA}var NA,jk;function poe(){if(jk)return NA;jk=1;var e=Y0(),t=Tf(),a=e(t,"DataView");return NA=a,NA}var FA,Uk;function moe(){if(Uk)return FA;Uk=1;var e=Y0(),t=Tf(),a=e(t,"Promise");return FA=a,FA}var jA,Vk;function Ej(){if(Vk)return jA;Vk=1;var e=Y0(),t=Tf(),a=e(t,"Set");return jA=a,jA}var UA,$k;function _oe(){if($k)return UA;$k=1;var e=Y0(),t=Tf(),a=e(t,"WeakMap");return UA=a,UA}var VA,qk;function goe(){if(qk)return VA;qk=1;var e=poe(),t=MO(),a=moe(),o=Ej(),h=_oe(),y=ep(),b=$F(),i="[object Map]",C="[object Object]",I="[object Promise]",j="[object Set]",F="[object WeakMap]",G="[object DataView]",X=b(e),Y=b(t),J=b(a),ee=b(o),oe=b(h),ge=y;return(e&&ge(new e(new ArrayBuffer(1)))!=G||t&&ge(new t)!=i||a&&ge(a.resolve())!=I||o&&ge(new o)!=j||h&&ge(new h)!=F)&&(ge=function(fe){var xe=y(fe),ae=xe==C?fe.constructor:void 0,me=ae?b(ae):"";if(me)switch(me){case X:return G;case Y:return i;case J:return I;case ee:return j;case oe:return F}return xe}),VA=ge,VA}var $A,Gk;function yoe(){if(Gk)return $A;Gk=1;var e=mj(),t=vj(),a=Jae(),o=doe(),h=goe(),y=wl(),b=bj(),i=Sj(),C=1,I="[object Arguments]",j="[object Array]",F="[object Object]",G=Object.prototype,X=G.hasOwnProperty;function Y(J,ee,oe,ge,fe,xe){var ae=y(J),me=y(ee),we=ae?j:h(J),Ge=me?j:h(ee);we=we==I?F:we,Ge=Ge==I?F:Ge;var He=we==F,ye=Ge==F,ke=we==Ge;if(ke&&b(J)){if(!b(ee))return!1;ae=!0,He=!1}if(ke&&!He)return xe||(xe=new e),ae||i(J)?t(J,ee,oe,ge,fe,xe):a(J,ee,we,oe,ge,fe,xe);if(!(oe&C)){var dt=He&&X.call(J,"__wrapped__"),vt=ye&&X.call(ee,"__wrapped__");if(dt||vt){var jt=dt?J.value():J,_t=vt?ee.value():ee;return xe||(xe=new e),fe(jt,_t,oe,ge,xe)}}return ke?(xe||(xe=new e),o(J,ee,oe,ge,fe,xe)):!1}return $A=Y,$A}var qA,Hk;function $O(){if(Hk)return qA;Hk=1;var e=yoe(),t=tp();function a(o,h,y,b,i){return o===h?!0:o==null||h==null||!t(o)&&!t(h)?o!==o&&h!==h:e(o,h,y,b,a,i)}return qA=a,qA}var GA,Zk;function voe(){if(Zk)return GA;Zk=1;var e=mj(),t=$O(),a=1,o=2;function h(y,b,i,C){var I=i.length,j=I,F=!C;if(y==null)return!j;for(y=Object(y);I--;){var G=i[I];if(F&&G[2]?G[1]!==y[G[0]]:!(G[0]in y))return!1}for(;++I<j;){G=i[I];var X=G[0],Y=y[X],J=G[1];if(F&&G[2]){if(Y===void 0&&!(X in y))return!1}else{var ee=new e;if(C)var oe=C(Y,J,X,y,b,ee);if(!(oe===void 0?t(J,Y,a|o,C,ee):oe))return!1}}return!0}return GA=h,GA}var HA,Wk;function Aj(){if(Wk)return HA;Wk=1;var e=gm();function t(a){return a===a&&!e(a)}return HA=t,HA}var ZA,Xk;function xoe(){if(Xk)return ZA;Xk=1;var e=Aj(),t=uS();function a(o){for(var h=t(o),y=h.length;y--;){var b=h[y],i=o[b];h[y]=[b,i,e(i)]}return h}return ZA=a,ZA}var WA,Yk;function Cj(){if(Yk)return WA;Yk=1;function e(t,a){return function(o){return o==null?!1:o[t]===a&&(a!==void 0||t in Object(o))}}return WA=e,WA}var XA,Kk;function boe(){if(Kk)return XA;Kk=1;var e=voe(),t=xoe(),a=Cj();function o(h){var y=t(h);return y.length==1&&y[0][2]?a(y[0][0],y[0][1]):function(b){return b===h||e(b,h,y)}}return XA=o,XA}var YA,Jk;function woe(){if(Jk)return YA;Jk=1;function e(t,a){return t!=null&&a in Object(t)}return YA=e,YA}var KA,Qk;function Soe(){if(Qk)return KA;Qk=1;var e=HF(),t=jO(),a=wl(),o=UO(),h=VO(),y=rS();function b(i,C,I){C=e(C,i);for(var j=-1,F=C.length,G=!1;++j<F;){var X=y(C[j]);if(!(G=i!=null&&I(i,X)))break;i=i[X]}return G||++j!=F?G:(F=i==null?0:i.length,!!F&&h(F)&&o(X,F)&&(a(i)||t(i)))}return KA=b,KA}var JA,ez;function Toe(){if(ez)return JA;ez=1;var e=woe(),t=Soe();function a(o,h){return o!=null&&t(o,h,e)}return JA=a,JA}var QA,tz;function Eoe(){if(tz)return QA;tz=1;var e=$O(),t=ZF(),a=Toe(),o=EO(),h=Aj(),y=Cj(),b=rS(),i=1,C=2;function I(j,F){return o(j)&&h(F)?y(b(j),F):function(G){var X=t(G,j);return X===void 0&&X===F?a(G,j):e(F,X,i|C)}}return QA=I,QA}var eC,nz;function gy(){if(nz)return eC;nz=1;function e(t){return t}return eC=e,eC}var tC,rz;function Aoe(){if(rz)return tC;rz=1;function e(t){return function(a){return a==null?void 0:a[t]}}return tC=e,tC}var nC,iz;function Coe(){if(iz)return nC;iz=1;var e=IO();function t(a){return function(o){return e(o,a)}}return nC=t,nC}var rC,az;function Moe(){if(az)return rC;az=1;var e=Aoe(),t=Coe(),a=EO(),o=rS();function h(y){return a(y)?e(o(y)):t(y)}return rC=h,rC}var iC,oz;function Ef(){if(oz)return iC;oz=1;var e=boe(),t=Eoe(),a=gy(),o=wl(),h=Moe();function y(b){return typeof b=="function"?b:b==null?a:typeof b=="object"?o(b)?t(b[0],b[1]):e(b):h(b)}return iC=y,iC}var aC,sz;function Mj(){if(sz)return aC;sz=1;function e(t,a,o,h){for(var y=t.length,b=o+(h?1:-1);h?b--:++b<y;)if(a(t[b],b,t))return b;return-1}return aC=e,aC}var oC,lz;function Ooe(){if(lz)return oC;lz=1;function e(t){return t!==t}return oC=e,oC}var sC,cz;function Poe(){if(cz)return sC;cz=1;function e(t,a,o){for(var h=o-1,y=t.length;++h<y;)if(t[h]===a)return h;return-1}return sC=e,sC}var lC,uz;function Ioe(){if(uz)return lC;uz=1;var e=Mj(),t=Ooe(),a=Poe();function o(h,y,b){return y===y?a(h,y,b):e(h,t,b)}return lC=o,lC}var cC,hz;function Roe(){if(hz)return cC;hz=1;var e=Ioe();function t(a,o){var h=a==null?0:a.length;return!!h&&e(a,o,0)>-1}return cC=t,cC}var uC,fz;function Doe(){if(fz)return uC;fz=1;function e(t,a,o){for(var h=-1,y=t==null?0:t.length;++h<y;)if(o(a,t[h]))return!0;return!1}return uC=e,uC}var hC,dz;function Loe(){if(dz)return hC;dz=1;function e(){}return hC=e,hC}var fC,pz;function koe(){if(pz)return fC;pz=1;var e=Ej(),t=Loe(),a=FO(),o=1/0,h=e&&1/a(new e([,-0]))[1]==o?function(y){return new e(y)}:t;return fC=h,fC}var dC,mz;function zoe(){if(mz)return dC;mz=1;var e=_j(),t=Roe(),a=Doe(),o=yj(),h=koe(),y=FO(),b=200;function i(C,I,j){var F=-1,G=t,X=C.length,Y=!0,J=[],ee=J;if(j)Y=!1,G=a;else if(X>=b){var oe=I?null:h(C);if(oe)return y(oe);Y=!1,G=o,ee=new e}else ee=I?[]:J;e:for(;++F<X;){var ge=C[F],fe=I?I(ge):ge;if(ge=j||ge!==0?ge:0,Y&&fe===fe){for(var xe=ee.length;xe--;)if(ee[xe]===fe)continue e;I&&ee.push(fe),J.push(ge)}else G(ee,fe,j)||(ee!==J&&ee.push(fe),J.push(ge))}return J}return dC=i,dC}var pC,_z;function Boe(){if(_z)return pC;_z=1;var e=Ef(),t=zoe();function a(o,h){return o&&o.length?t(o,e(h,2)):[]}return pC=a,pC}var Noe=Boe();const gz=Ei(Noe);function Oj(e,t,a){return t===!0?gz(e,a):Vr(t)?gz(e,t):e}function $g(e){"@babel/helpers - typeof";return $g=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$g(e)}var Foe=["ref"];function yz(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(h){return Object.getOwnPropertyDescriptor(e,h).enumerable})),a.push.apply(a,o)}return a}function Dd(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?yz(Object(a),!0).forEach(function(o){hS(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):yz(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function joe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function vz(e,t){for(var a=0;a<t.length;a++){var o=t[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,Ij(o.key),o)}}function Uoe(e,t,a){return t&&vz(e.prototype,t),a&&vz(e,a),Object.defineProperty(e,"prototype",{writable:!1}),e}function Voe(e,t,a){return t=Hb(t),$oe(e,Pj()?Reflect.construct(t,a||[],Hb(e).constructor):t.apply(e,a))}function $oe(e,t){if(t&&($g(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return qoe(e)}function qoe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Pj(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Pj=function(){return!!e})()}function Hb(e){return Hb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)},Hb(e)}function Goe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&I5(e,t)}function I5(e,t){return I5=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,h){return o.__proto__=h,o},I5(e,t)}function hS(e,t,a){return t=Ij(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Ij(e){var t=Hoe(e,"string");return $g(t)=="symbol"?t:t+""}function Hoe(e,t){if($g(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t);if($g(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function Zoe(e,t){if(e==null)return{};var a=Woe(e,t),o,h;if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(e);for(h=0;h<y.length;h++)o=y[h],!(t.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(a[o]=e[o])}return a}function Woe(e,t){if(e==null)return{};var a={};for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){if(t.indexOf(o)>=0)continue;a[o]=e[o]}return a}function Xoe(e){return e.value}function Yoe(e,t){if(Ot.isValidElement(e))return Ot.cloneElement(e,t);if(typeof e=="function")return Ot.createElement(e,t);t.ref;var a=Zoe(t,Foe);return Ot.createElement(NO,a)}var xz=1,Rg=function(e){function t(){var a;joe(this,t);for(var o=arguments.length,h=new Array(o),y=0;y<o;y++)h[y]=arguments[y];return a=Voe(this,t,[].concat(h)),hS(a,"lastBoundingBox",{width:-1,height:-1}),a}return Goe(t,e),Uoe(t,[{key:"componentDidMount",value:function(){this.updateBBox()}},{key:"componentDidUpdate",value:function(){this.updateBBox()}},{key:"getBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var o=this.wrapperNode.getBoundingClientRect();return o.height=this.wrapperNode.offsetHeight,o.width=this.wrapperNode.offsetWidth,o}return null}},{key:"updateBBox",value:function(){var o=this.props.onBBoxUpdate,h=this.getBBox();h?(Math.abs(h.width-this.lastBoundingBox.width)>xz||Math.abs(h.height-this.lastBoundingBox.height)>xz)&&(this.lastBoundingBox.width=h.width,this.lastBoundingBox.height=h.height,o&&o(h)):(this.lastBoundingBox.width!==-1||this.lastBoundingBox.height!==-1)&&(this.lastBoundingBox.width=-1,this.lastBoundingBox.height=-1,o&&o(null))}},{key:"getBBoxSnapshot",value:function(){return this.lastBoundingBox.width>=0&&this.lastBoundingBox.height>=0?Dd({},this.lastBoundingBox):{width:0,height:0}}},{key:"getDefaultPosition",value:function(o){var h=this.props,y=h.layout,b=h.align,i=h.verticalAlign,C=h.margin,I=h.chartWidth,j=h.chartHeight,F,G;if(!o||(o.left===void 0||o.left===null)&&(o.right===void 0||o.right===null))if(b==="center"&&y==="vertical"){var X=this.getBBoxSnapshot();F={left:((I||0)-X.width)/2}}else F=b==="right"?{right:C&&C.right||0}:{left:C&&C.left||0};if(!o||(o.top===void 0||o.top===null)&&(o.bottom===void 0||o.bottom===null))if(i==="middle"){var Y=this.getBBoxSnapshot();G={top:((j||0)-Y.height)/2}}else G=i==="bottom"?{bottom:C&&C.bottom||0}:{top:C&&C.top||0};return Dd(Dd({},F),G)}},{key:"render",value:function(){var o=this,h=this.props,y=h.content,b=h.width,i=h.height,C=h.wrapperStyle,I=h.payloadUniqBy,j=h.payload,F=Dd(Dd({position:"absolute",width:b||"auto",height:i||"auto"},this.getDefaultPosition(C)),C);return Ot.createElement("div",{className:"recharts-legend-wrapper",style:F,ref:function(X){o.wrapperNode=X}},Yoe(y,Dd(Dd({},this.props),{},{payload:Oj(j,I,Xoe)})))}}],[{key:"getWithHeight",value:function(o,h){var y=Dd(Dd({},this.defaultProps),o.props),b=y.layout;return b==="vertical"&&Nn(o.props.height)?{height:o.props.height}:b==="horizontal"?{width:o.props.width||h}:null}}])}(Ie.PureComponent);hS(Rg,"displayName","Legend");hS(Rg,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"bottom"});var mC,bz;function Koe(){if(bz)return mC;bz=1;var e=b2(),t=jO(),a=wl(),o=e?e.isConcatSpreadable:void 0;function h(y){return a(y)||t(y)||!!(o&&y&&y[o])}return mC=h,mC}var _C,wz;function Rj(){if(wz)return _C;wz=1;var e=xj(),t=Koe();function a(o,h,y,b,i){var C=-1,I=o.length;for(y||(y=t),i||(i=[]);++C<I;){var j=o[C];h>0&&y(j)?h>1?a(j,h-1,y,b,i):e(i,j):b||(i[i.length]=j)}return i}return _C=a,_C}var gC,Sz;function Joe(){if(Sz)return gC;Sz=1;function e(t){return function(a,o,h){for(var y=-1,b=Object(a),i=h(a),C=i.length;C--;){var I=i[t?C:++y];if(o(b[I],I,b)===!1)break}return a}}return gC=e,gC}var yC,Tz;function Qoe(){if(Tz)return yC;Tz=1;var e=Joe(),t=e();return yC=t,yC}var vC,Ez;function Dj(){if(Ez)return vC;Ez=1;var e=Qoe(),t=uS();function a(o,h){return o&&e(o,h,t)}return vC=a,vC}var xC,Az;function ese(){if(Az)return xC;Az=1;var e=T2();function t(a,o){return function(h,y){if(h==null)return h;if(!e(h))return a(h,y);for(var b=h.length,i=o?b:-1,C=Object(h);(o?i--:++i<b)&&y(C[i],i,C)!==!1;);return h}}return xC=t,xC}var bC,Cz;function qO(){if(Cz)return bC;Cz=1;var e=Dj(),t=ese(),a=t(e);return bC=a,bC}var wC,Mz;function Lj(){if(Mz)return wC;Mz=1;var e=qO(),t=T2();function a(o,h){var y=-1,b=t(o)?Array(o.length):[];return e(o,function(i,C,I){b[++y]=h(i,C,I)}),b}return wC=a,wC}var SC,Oz;function tse(){if(Oz)return SC;Oz=1;function e(t,a){var o=t.length;for(t.sort(a);o--;)t[o]=t[o].value;return t}return SC=e,SC}var TC,Pz;function nse(){if(Pz)return TC;Pz=1;var e=my();function t(a,o){if(a!==o){var h=a!==void 0,y=a===null,b=a===a,i=e(a),C=o!==void 0,I=o===null,j=o===o,F=e(o);if(!I&&!F&&!i&&a>o||i&&C&&j&&!I&&!F||y&&C&&j||!h&&j||!b)return 1;if(!y&&!i&&!F&&a<o||F&&h&&b&&!y&&!i||I&&h&&b||!C&&b||!j)return-1}return 0}return TC=t,TC}var EC,Iz;function rse(){if(Iz)return EC;Iz=1;var e=nse();function t(a,o,h){for(var y=-1,b=a.criteria,i=o.criteria,C=b.length,I=h.length;++y<C;){var j=e(b[y],i[y]);if(j){if(y>=I)return j;var F=h[y];return j*(F=="desc"?-1:1)}}return a.index-o.index}return EC=t,EC}var AC,Rz;function ise(){if(Rz)return AC;Rz=1;var e=PO(),t=IO(),a=Ef(),o=Lj(),h=tse(),y=wj(),b=rse(),i=gy(),C=wl();function I(j,F,G){F.length?F=e(F,function(J){return C(J)?function(ee){return t(ee,J.length===1?J[0]:J)}:J}):F=[i];var X=-1;F=e(F,y(a));var Y=o(j,function(J,ee,oe){var ge=e(F,function(fe){return fe(J)});return{criteria:ge,index:++X,value:J}});return h(Y,function(J,ee){return b(J,ee,G)})}return AC=I,AC}var CC,Dz;function ase(){if(Dz)return CC;Dz=1;function e(t,a,o){switch(o.length){case 0:return t.call(a);case 1:return t.call(a,o[0]);case 2:return t.call(a,o[0],o[1]);case 3:return t.call(a,o[0],o[1],o[2])}return t.apply(a,o)}return CC=e,CC}var MC,Lz;function ose(){if(Lz)return MC;Lz=1;var e=ase(),t=Math.max;function a(o,h,y){return h=t(h===void 0?o.length-1:h,0),function(){for(var b=arguments,i=-1,C=t(b.length-h,0),I=Array(C);++i<C;)I[i]=b[h+i];i=-1;for(var j=Array(h+1);++i<h;)j[i]=b[i];return j[h]=y(I),e(o,this,j)}}return MC=a,MC}var OC,kz;function sse(){if(kz)return OC;kz=1;function e(t){return function(){return t}}return OC=e,OC}var PC,zz;function kj(){if(zz)return PC;zz=1;var e=Y0(),t=function(){try{var a=e(Object,"defineProperty");return a({},"",{}),a}catch{}}();return PC=t,PC}var IC,Bz;function lse(){if(Bz)return IC;Bz=1;var e=sse(),t=kj(),a=gy(),o=t?function(h,y){return t(h,"toString",{configurable:!0,enumerable:!1,value:e(y),writable:!0})}:a;return IC=o,IC}var RC,Nz;function cse(){if(Nz)return RC;Nz=1;var e=800,t=16,a=Date.now;function o(h){var y=0,b=0;return function(){var i=a(),C=t-(i-b);if(b=i,C>0){if(++y>=e)return arguments[0]}else y=0;return h.apply(void 0,arguments)}}return RC=o,RC}var DC,Fz;function use(){if(Fz)return DC;Fz=1;var e=lse(),t=cse(),a=t(e);return DC=a,DC}var LC,jz;function hse(){if(jz)return LC;jz=1;var e=gy(),t=ose(),a=use();function o(h,y){return a(t(h,y,e),h+"")}return LC=o,LC}var kC,Uz;function fS(){if(Uz)return kC;Uz=1;var e=CO(),t=T2(),a=UO(),o=gm();function h(y,b,i){if(!o(i))return!1;var C=typeof b;return(C=="number"?t(i)&&a(b,i.length):C=="string"&&b in i)?e(i[b],y):!1}return kC=h,kC}var zC,Vz;function fse(){if(Vz)return zC;Vz=1;var e=Rj(),t=ise(),a=hse(),o=fS(),h=a(function(y,b){if(y==null)return[];var i=b.length;return i>1&&o(y,b[0],b[1])?b=[]:i>2&&o(b[0],b[1],b[2])&&(b=[b[0]]),t(y,e(b,1),[])});return zC=h,zC}var dse=fse();const GO=Ei(dse);function D1(e){"@babel/helpers - typeof";return D1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},D1(e)}function R5(){return R5=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},R5.apply(this,arguments)}function pse(e,t){return yse(e)||gse(e,t)||_se(e,t)||mse()}function mse(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _se(e,t){if(e){if(typeof e=="string")return $z(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return $z(e,t)}}function $z(e,t){(t==null||t>e.length)&&(t=e.length);for(var a=0,o=new Array(t);a<t;a++)o[a]=e[a];return o}function gse(e,t){var a=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(a!=null){var o,h,y,b,i=[],C=!0,I=!1;try{if(y=(a=a.call(e)).next,t!==0)for(;!(C=(o=y.call(a)).done)&&(i.push(o.value),i.length!==t);C=!0);}catch(j){I=!0,h=j}finally{try{if(!C&&a.return!=null&&(b=a.return(),Object(b)!==b))return}finally{if(I)throw h}}return i}}function yse(e){if(Array.isArray(e))return e}function qz(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(h){return Object.getOwnPropertyDescriptor(e,h).enumerable})),a.push.apply(a,o)}return a}function BC(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?qz(Object(a),!0).forEach(function(o){vse(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):qz(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function vse(e,t,a){return t=xse(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function xse(e){var t=bse(e,"string");return D1(t)=="symbol"?t:t+""}function bse(e,t){if(D1(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t);if(D1(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function wse(e){return Array.isArray(e)&&bo(e[0])&&bo(e[1])?e.join(" ~ "):e}var Sse=function(t){var a=t.separator,o=a===void 0?" : ":a,h=t.contentStyle,y=h===void 0?{}:h,b=t.itemStyle,i=b===void 0?{}:b,C=t.labelStyle,I=C===void 0?{}:C,j=t.payload,F=t.formatter,G=t.itemSorter,X=t.wrapperClassName,Y=t.labelClassName,J=t.label,ee=t.labelFormatter,oe=t.accessibilityLayer,ge=oe===void 0?!1:oe,fe=function(){if(j&&j.length){var dt={padding:0,margin:0},vt=(G?GO(j,G):j).map(function(jt,_t){if(jt.type==="none")return null;var gt=BC({display:"block",paddingTop:4,paddingBottom:4,color:jt.color||"#000"},i),Vt=jt.formatter||F||wse,Ht=jt.value,Bt=jt.name,et=Ht,$t=Bt;if(Vt&&et!=null&&$t!=null){var rn=Vt(Ht,Bt,jt,_t,j);if(Array.isArray(rn)){var Nt=pse(rn,2);et=Nt[0],$t=Nt[1]}else et=rn}return Ot.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(_t),style:gt},bo($t)?Ot.createElement("span",{className:"recharts-tooltip-item-name"},$t):null,bo($t)?Ot.createElement("span",{className:"recharts-tooltip-item-separator"},o):null,Ot.createElement("span",{className:"recharts-tooltip-item-value"},et),Ot.createElement("span",{className:"recharts-tooltip-item-unit"},jt.unit||""))});return Ot.createElement("ul",{className:"recharts-tooltip-item-list",style:dt},vt)}return null},xe=BC({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},y),ae=BC({margin:0},I),me=!ei(J),we=me?J:"",Ge=oi("recharts-default-tooltip",X),He=oi("recharts-tooltip-label",Y);me&&ee&&j!==void 0&&j!==null&&(we=ee(J,j));var ye=ge?{role:"status","aria-live":"assertive"}:{};return Ot.createElement("div",R5({className:Ge,style:xe},ye),Ot.createElement("p",{className:He,style:ae},Ot.isValidElement(we)?we:"".concat(we)),fe())};function L1(e){"@babel/helpers - typeof";return L1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},L1(e)}function rb(e,t,a){return t=Tse(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Tse(e){var t=Ese(e,"string");return L1(t)=="symbol"?t:t+""}function Ese(e,t){if(L1(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t);if(L1(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var jv="recharts-tooltip-wrapper",Ase={visibility:"hidden"};function Cse(e){var t=e.coordinate,a=e.translateX,o=e.translateY;return oi(jv,rb(rb(rb(rb({},"".concat(jv,"-right"),Nn(a)&&t&&Nn(t.x)&&a>=t.x),"".concat(jv,"-left"),Nn(a)&&t&&Nn(t.x)&&a<t.x),"".concat(jv,"-bottom"),Nn(o)&&t&&Nn(t.y)&&o>=t.y),"".concat(jv,"-top"),Nn(o)&&t&&Nn(t.y)&&o<t.y))}function Gz(e){var t=e.allowEscapeViewBox,a=e.coordinate,o=e.key,h=e.offsetTopLeft,y=e.position,b=e.reverseDirection,i=e.tooltipDimension,C=e.viewBox,I=e.viewBoxDimension;if(y&&Nn(y[o]))return y[o];var j=a[o]-i-h,F=a[o]+h;if(t[o])return b[o]?j:F;if(b[o]){var G=j,X=C[o];return G<X?Math.max(F,C[o]):Math.max(j,C[o])}var Y=F+i,J=C[o]+I;return Y>J?Math.max(j,C[o]):Math.max(F,C[o])}function Mse(e){var t=e.translateX,a=e.translateY,o=e.useTranslate3d;return{transform:o?"translate3d(".concat(t,"px, ").concat(a,"px, 0)"):"translate(".concat(t,"px, ").concat(a,"px)")}}function Ose(e){var t=e.allowEscapeViewBox,a=e.coordinate,o=e.offsetTopLeft,h=e.position,y=e.reverseDirection,b=e.tooltipBox,i=e.useTranslate3d,C=e.viewBox,I,j,F;return b.height>0&&b.width>0&&a?(j=Gz({allowEscapeViewBox:t,coordinate:a,key:"x",offsetTopLeft:o,position:h,reverseDirection:y,tooltipDimension:b.width,viewBox:C,viewBoxDimension:C.width}),F=Gz({allowEscapeViewBox:t,coordinate:a,key:"y",offsetTopLeft:o,position:h,reverseDirection:y,tooltipDimension:b.height,viewBox:C,viewBoxDimension:C.height}),I=Mse({translateX:j,translateY:F,useTranslate3d:i})):I=Ase,{cssProperties:I,cssClasses:Cse({translateX:j,translateY:F,coordinate:a})}}function qg(e){"@babel/helpers - typeof";return qg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qg(e)}function Hz(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(h){return Object.getOwnPropertyDescriptor(e,h).enumerable})),a.push.apply(a,o)}return a}function Zz(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?Hz(Object(a),!0).forEach(function(o){L5(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Hz(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function Pse(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ise(e,t){for(var a=0;a<t.length;a++){var o=t[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,Bj(o.key),o)}}function Rse(e,t,a){return t&&Ise(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Dse(e,t,a){return t=Zb(t),Lse(e,zj()?Reflect.construct(t,a||[],Zb(e).constructor):t.apply(e,a))}function Lse(e,t){if(t&&(qg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return kse(e)}function kse(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function zj(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(zj=function(){return!!e})()}function Zb(e){return Zb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)},Zb(e)}function zse(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&D5(e,t)}function D5(e,t){return D5=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,h){return o.__proto__=h,o},D5(e,t)}function L5(e,t,a){return t=Bj(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Bj(e){var t=Bse(e,"string");return qg(t)=="symbol"?t:t+""}function Bse(e,t){if(qg(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t);if(qg(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Wz=1,Nse=function(e){function t(){var a;Pse(this,t);for(var o=arguments.length,h=new Array(o),y=0;y<o;y++)h[y]=arguments[y];return a=Dse(this,t,[].concat(h)),L5(a,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0},lastBoundingBox:{width:-1,height:-1}}),L5(a,"handleKeyDown",function(b){if(b.key==="Escape"){var i,C,I,j;a.setState({dismissed:!0,dismissedAtCoordinate:{x:(i=(C=a.props.coordinate)===null||C===void 0?void 0:C.x)!==null&&i!==void 0?i:0,y:(I=(j=a.props.coordinate)===null||j===void 0?void 0:j.y)!==null&&I!==void 0?I:0}})}}),a}return zse(t,e),Rse(t,[{key:"updateBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var o=this.wrapperNode.getBoundingClientRect();(Math.abs(o.width-this.state.lastBoundingBox.width)>Wz||Math.abs(o.height-this.state.lastBoundingBox.height)>Wz)&&this.setState({lastBoundingBox:{width:o.width,height:o.height}})}else(this.state.lastBoundingBox.width!==-1||this.state.lastBoundingBox.height!==-1)&&this.setState({lastBoundingBox:{width:-1,height:-1}})}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown),this.updateBBox()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(){var o,h;this.props.active&&this.updateBBox(),this.state.dismissed&&(((o=this.props.coordinate)===null||o===void 0?void 0:o.x)!==this.state.dismissedAtCoordinate.x||((h=this.props.coordinate)===null||h===void 0?void 0:h.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}},{key:"render",value:function(){var o=this,h=this.props,y=h.active,b=h.allowEscapeViewBox,i=h.animationDuration,C=h.animationEasing,I=h.children,j=h.coordinate,F=h.hasPayload,G=h.isAnimationActive,X=h.offset,Y=h.position,J=h.reverseDirection,ee=h.useTranslate3d,oe=h.viewBox,ge=h.wrapperStyle,fe=Ose({allowEscapeViewBox:b,coordinate:j,offsetTopLeft:X,position:Y,reverseDirection:J,tooltipBox:this.state.lastBoundingBox,useTranslate3d:ee,viewBox:oe}),xe=fe.cssClasses,ae=fe.cssProperties,me=Zz(Zz({transition:G&&y?"transform ".concat(i,"ms ").concat(C):void 0},ae),{},{pointerEvents:"none",visibility:!this.state.dismissed&&y&&F?"visible":"hidden",position:"absolute",top:0,left:0},ge);return Ot.createElement("div",{tabIndex:-1,className:xe,style:me,ref:function(Ge){o.wrapperNode=Ge}},I)}}])}(Ie.PureComponent),Fse=function(){return!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout)},dS={isSsr:Fse()};function Gg(e){"@babel/helpers - typeof";return Gg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gg(e)}function Xz(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(h){return Object.getOwnPropertyDescriptor(e,h).enumerable})),a.push.apply(a,o)}return a}function Yz(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?Xz(Object(a),!0).forEach(function(o){HO(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Xz(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function jse(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Use(e,t){for(var a=0;a<t.length;a++){var o=t[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,Fj(o.key),o)}}function Vse(e,t,a){return t&&Use(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function $se(e,t,a){return t=Wb(t),qse(e,Nj()?Reflect.construct(t,a||[],Wb(e).constructor):t.apply(e,a))}function qse(e,t){if(t&&(Gg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Gse(e)}function Gse(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Nj(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Nj=function(){return!!e})()}function Wb(e){return Wb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)},Wb(e)}function Hse(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&k5(e,t)}function k5(e,t){return k5=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,h){return o.__proto__=h,o},k5(e,t)}function HO(e,t,a){return t=Fj(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Fj(e){var t=Zse(e,"string");return Gg(t)=="symbol"?t:t+""}function Zse(e,t){if(Gg(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t);if(Gg(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function Wse(e){return e.dataKey}function Xse(e,t){return Ot.isValidElement(e)?Ot.cloneElement(e,t):typeof e=="function"?Ot.createElement(e,t):Ot.createElement(Sse,t)}var Ld=function(e){function t(){return jse(this,t),$se(this,t,arguments)}return Hse(t,e),Vse(t,[{key:"render",value:function(){var o=this,h=this.props,y=h.active,b=h.allowEscapeViewBox,i=h.animationDuration,C=h.animationEasing,I=h.content,j=h.coordinate,F=h.filterNull,G=h.isAnimationActive,X=h.offset,Y=h.payload,J=h.payloadUniqBy,ee=h.position,oe=h.reverseDirection,ge=h.useTranslate3d,fe=h.viewBox,xe=h.wrapperStyle,ae=Y??[];F&&ae.length&&(ae=Oj(Y.filter(function(we){return we.value!=null&&(we.hide!==!0||o.props.includeHidden)}),J,Wse));var me=ae.length>0;return Ot.createElement(Nse,{allowEscapeViewBox:b,animationDuration:i,animationEasing:C,isAnimationActive:G,active:y,coordinate:j,hasPayload:me,offset:X,position:ee,reverseDirection:oe,useTranslate3d:ge,viewBox:fe,wrapperStyle:xe},Xse(I,Yz(Yz({},this.props),{},{payload:ae})))}}])}(Ie.PureComponent);HO(Ld,"displayName","Tooltip");HO(Ld,"defaultProps",{accessibilityLayer:!1,allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",contentStyle:{},coordinate:{x:0,y:0},cursor:!0,cursorStyle:{},filterNull:!0,isAnimationActive:!dS.isSsr,itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,viewBox:{x:0,y:0,height:0,width:0},wrapperStyle:{}});var NC,Kz;function Yse(){if(Kz)return NC;Kz=1;var e=Tf(),t=function(){return e.Date.now()};return NC=t,NC}var FC,Jz;function Kse(){if(Jz)return FC;Jz=1;var e=/\s/;function t(a){for(var o=a.length;o--&&e.test(a.charAt(o)););return o}return FC=t,FC}var jC,Qz;function Jse(){if(Qz)return jC;Qz=1;var e=Kse(),t=/^\s+/;function a(o){return o&&o.slice(0,e(o)+1).replace(t,"")}return jC=a,jC}var UC,e9;function jj(){if(e9)return UC;e9=1;var e=Jse(),t=gm(),a=my(),o=NaN,h=/^[-+]0x[0-9a-f]+$/i,y=/^0b[01]+$/i,b=/^0o[0-7]+$/i,i=parseInt;function C(I){if(typeof I=="number")return I;if(a(I))return o;if(t(I)){var j=typeof I.valueOf=="function"?I.valueOf():I;I=t(j)?j+"":j}if(typeof I!="string")return I===0?I:+I;I=e(I);var F=y.test(I);return F||b.test(I)?i(I.slice(2),F?2:8):h.test(I)?o:+I}return UC=C,UC}var VC,t9;function Qse(){if(t9)return VC;t9=1;var e=gm(),t=Yse(),a=jj(),o="Expected a function",h=Math.max,y=Math.min;function b(i,C,I){var j,F,G,X,Y,J,ee=0,oe=!1,ge=!1,fe=!0;if(typeof i!="function")throw new TypeError(o);C=a(C)||0,e(I)&&(oe=!!I.leading,ge="maxWait"in I,G=ge?h(a(I.maxWait)||0,C):G,fe="trailing"in I?!!I.trailing:fe);function xe(vt){var jt=j,_t=F;return j=F=void 0,ee=vt,X=i.apply(_t,jt),X}function ae(vt){return ee=vt,Y=setTimeout(Ge,C),oe?xe(vt):X}function me(vt){var jt=vt-J,_t=vt-ee,gt=C-jt;return ge?y(gt,G-_t):gt}function we(vt){var jt=vt-J,_t=vt-ee;return J===void 0||jt>=C||jt<0||ge&&_t>=G}function Ge(){var vt=t();if(we(vt))return He(vt);Y=setTimeout(Ge,me(vt))}function He(vt){return Y=void 0,fe&&j?xe(vt):(j=F=void 0,X)}function ye(){Y!==void 0&&clearTimeout(Y),ee=0,j=J=F=Y=void 0}function ke(){return Y===void 0?X:He(t())}function dt(){var vt=t(),jt=we(vt);if(j=arguments,F=this,J=vt,jt){if(Y===void 0)return ae(J);if(ge)return clearTimeout(Y),Y=setTimeout(Ge,C),xe(J)}return Y===void 0&&(Y=setTimeout(Ge,C)),X}return dt.cancel=ye,dt.flush=ke,dt}return VC=b,VC}var $C,n9;function ele(){if(n9)return $C;n9=1;var e=Qse(),t=gm(),a="Expected a function";function o(h,y,b){var i=!0,C=!0;if(typeof h!="function")throw new TypeError(a);return t(b)&&(i="leading"in b?!!b.leading:i,C="trailing"in b?!!b.trailing:C),e(h,y,{leading:i,maxWait:y,trailing:C})}return $C=o,$C}var tle=ele();const Uj=Ei(tle);function k1(e){"@babel/helpers - typeof";return k1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},k1(e)}function r9(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(h){return Object.getOwnPropertyDescriptor(e,h).enumerable})),a.push.apply(a,o)}return a}function ib(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?r9(Object(a),!0).forEach(function(o){nle(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r9(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function nle(e,t,a){return t=rle(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function rle(e){var t=ile(e,"string");return k1(t)=="symbol"?t:t+""}function ile(e,t){if(k1(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t);if(k1(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ale(e,t){return cle(e)||lle(e,t)||sle(e,t)||ole()}function ole(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function sle(e,t){if(e){if(typeof e=="string")return i9(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return i9(e,t)}}function i9(e,t){(t==null||t>e.length)&&(t=e.length);for(var a=0,o=new Array(t);a<t;a++)o[a]=e[a];return o}function lle(e,t){var a=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(a!=null){var o,h,y,b,i=[],C=!0,I=!1;try{if(y=(a=a.call(e)).next,t!==0)for(;!(C=(o=y.call(a)).done)&&(i.push(o.value),i.length!==t);C=!0);}catch(j){I=!0,h=j}finally{try{if(!C&&a.return!=null&&(b=a.return(),Object(b)!==b))return}finally{if(I)throw h}}return i}}function cle(e){if(Array.isArray(e))return e}var ule=Ie.forwardRef(function(e,t){var a=e.aspect,o=e.initialDimension,h=o===void 0?{width:-1,height:-1}:o,y=e.width,b=y===void 0?"100%":y,i=e.height,C=i===void 0?"100%":i,I=e.minWidth,j=I===void 0?0:I,F=e.minHeight,G=e.maxHeight,X=e.children,Y=e.debounce,J=Y===void 0?0:Y,ee=e.id,oe=e.className,ge=e.onResize,fe=e.style,xe=fe===void 0?{}:fe,ae=Ie.useRef(null),me=Ie.useRef();me.current=ge,Ie.useImperativeHandle(t,function(){return Object.defineProperty(ae.current,"current",{get:function(){return console.warn("The usage of ref.current.current is deprecated and will no longer be supported."),ae.current},configurable:!0})});var we=Ie.useState({containerWidth:h.width,containerHeight:h.height}),Ge=ale(we,2),He=Ge[0],ye=Ge[1],ke=Ie.useCallback(function(vt,jt){ye(function(_t){var gt=Math.round(vt),Vt=Math.round(jt);return _t.containerWidth===gt&&_t.containerHeight===Vt?_t:{containerWidth:gt,containerHeight:Vt}})},[]);Ie.useEffect(function(){var vt=function(Bt){var et,$t=Bt[0].contentRect,rn=$t.width,Nt=$t.height;ke(rn,Nt),(et=me.current)===null||et===void 0||et.call(me,rn,Nt)};J>0&&(vt=Uj(vt,J,{trailing:!0,leading:!1}));var jt=new ResizeObserver(vt),_t=ae.current.getBoundingClientRect(),gt=_t.width,Vt=_t.height;return ke(gt,Vt),jt.observe(ae.current),function(){jt.disconnect()}},[ke,J]);var dt=Ie.useMemo(function(){var vt=He.containerWidth,jt=He.containerHeight;if(vt<0||jt<0)return null;qd(N0(b)||N0(C),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,b,C),qd(!a||a>0,"The aspect(%s) must be greater than zero.",a);var _t=N0(b)?vt:b,gt=N0(C)?jt:C;a&&a>0&&(_t?gt=_t/a:gt&&(_t=gt*a),G&&gt>G&&(gt=G)),qd(_t>0||gt>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,_t,gt,b,C,j,F,a);var Vt=!Array.isArray(X)&&$d(X.type).endsWith("Chart");return Ot.Children.map(X,function(Ht){return Ot.isValidElement(Ht)?Ie.cloneElement(Ht,ib({width:_t,height:gt},Vt?{style:ib({height:"100%",width:"100%",maxHeight:gt,maxWidth:_t},Ht.props.style)}:{})):Ht})},[a,X,C,G,F,j,He,b]);return Ot.createElement("div",{id:ee?"".concat(ee):void 0,className:oi("recharts-responsive-container",oe),style:ib(ib({},xe),{},{width:b,height:C,minWidth:j,minHeight:F,maxHeight:G}),ref:ae},dt)}),Vj=function(t){return null};Vj.displayName="Cell";function z1(e){"@babel/helpers - typeof";return z1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},z1(e)}function a9(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(h){return Object.getOwnPropertyDescriptor(e,h).enumerable})),a.push.apply(a,o)}return a}function z5(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?a9(Object(a),!0).forEach(function(o){hle(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):a9(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function hle(e,t,a){return t=fle(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function fle(e){var t=dle(e,"string");return z1(t)=="symbol"?t:t+""}function dle(e,t){if(z1(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t);if(z1(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var yg={widthCache:{},cacheCount:0},ple=2e3,mle={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},o9="recharts_measurement_span";function _le(e){var t=z5({},e);return Object.keys(t).forEach(function(a){t[a]||delete t[a]}),t}var s9=function(t){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||dS.isSsr)return{width:0,height:0};var o=_le(a),h=JSON.stringify({text:t,copyStyle:o});if(yg.widthCache[h])return yg.widthCache[h];try{var y=document.getElementById(o9);y||(y=document.createElement("span"),y.setAttribute("id",o9),y.setAttribute("aria-hidden","true"),document.body.appendChild(y));var b=z5(z5({},mle),o);Object.assign(y.style,b),y.textContent="".concat(t);var i=y.getBoundingClientRect(),C={width:i.width,height:i.height};return yg.widthCache[h]=C,++yg.cacheCount>ple&&(yg.cacheCount=0,yg.widthCache={}),C}catch{return{width:0,height:0}}},gle=function(t){return{top:t.top+window.scrollY-document.documentElement.clientTop,left:t.left+window.scrollX-document.documentElement.clientLeft}};function B1(e){"@babel/helpers - typeof";return B1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},B1(e)}function Xb(e,t){return ble(e)||xle(e,t)||vle(e,t)||yle()}function yle(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vle(e,t){if(e){if(typeof e=="string")return l9(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return l9(e,t)}}function l9(e,t){(t==null||t>e.length)&&(t=e.length);for(var a=0,o=new Array(t);a<t;a++)o[a]=e[a];return o}function xle(e,t){var a=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(a!=null){var o,h,y,b,i=[],C=!0,I=!1;try{if(y=(a=a.call(e)).next,t===0){if(Object(a)!==a)return;C=!1}else for(;!(C=(o=y.call(a)).done)&&(i.push(o.value),i.length!==t);C=!0);}catch(j){I=!0,h=j}finally{try{if(!C&&a.return!=null&&(b=a.return(),Object(b)!==b))return}finally{if(I)throw h}}return i}}function ble(e){if(Array.isArray(e))return e}function wle(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c9(e,t){for(var a=0;a<t.length;a++){var o=t[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,Tle(o.key),o)}}function Sle(e,t,a){return t&&c9(e.prototype,t),a&&c9(e,a),Object.defineProperty(e,"prototype",{writable:!1}),e}function Tle(e){var t=Ele(e,"string");return B1(t)=="symbol"?t:t+""}function Ele(e,t){if(B1(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t);if(B1(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var u9=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,h9=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,Ale=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,Cle=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,$j={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},Mle=Object.keys($j),Eg="NaN";function Ole(e,t){return e*$j[t]}var ab=function(){function e(t,a){wle(this,e),this.num=t,this.unit=a,this.num=t,this.unit=a,Number.isNaN(t)&&(this.unit=""),a!==""&&!Ale.test(a)&&(this.num=NaN,this.unit=""),Mle.includes(a)&&(this.num=Ole(t,a),this.unit="px")}return Sle(e,[{key:"add",value:function(a){return this.unit!==a.unit?new e(NaN,""):new e(this.num+a.num,this.unit)}},{key:"subtract",value:function(a){return this.unit!==a.unit?new e(NaN,""):new e(this.num-a.num,this.unit)}},{key:"multiply",value:function(a){return this.unit!==""&&a.unit!==""&&this.unit!==a.unit?new e(NaN,""):new e(this.num*a.num,this.unit||a.unit)}},{key:"divide",value:function(a){return this.unit!==""&&a.unit!==""&&this.unit!==a.unit?new e(NaN,""):new e(this.num/a.num,this.unit||a.unit)}},{key:"toString",value:function(){return"".concat(this.num).concat(this.unit)}},{key:"isNaN",value:function(){return Number.isNaN(this.num)}}],[{key:"parse",value:function(a){var o,h=(o=Cle.exec(a))!==null&&o!==void 0?o:[],y=Xb(h,3),b=y[1],i=y[2];return new e(parseFloat(b),i??"")}}])}();function qj(e){if(e.includes(Eg))return Eg;for(var t=e;t.includes("*")||t.includes("/");){var a,o=(a=u9.exec(t))!==null&&a!==void 0?a:[],h=Xb(o,4),y=h[1],b=h[2],i=h[3],C=ab.parse(y??""),I=ab.parse(i??""),j=b==="*"?C.multiply(I):C.divide(I);if(j.isNaN())return Eg;t=t.replace(u9,j.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var F,G=(F=h9.exec(t))!==null&&F!==void 0?F:[],X=Xb(G,4),Y=X[1],J=X[2],ee=X[3],oe=ab.parse(Y??""),ge=ab.parse(ee??""),fe=J==="+"?oe.add(ge):oe.subtract(ge);if(fe.isNaN())return Eg;t=t.replace(h9,fe.toString())}return t}var f9=/\(([^()]*)\)/;function Ple(e){for(var t=e;t.includes("(");){var a=f9.exec(t),o=Xb(a,2),h=o[1];t=t.replace(f9,qj(h))}return t}function Ile(e){var t=e.replace(/\s+/g,"");return t=Ple(t),t=qj(t),t}function Rle(e){try{return Ile(e)}catch{return Eg}}function qC(e){var t=Rle(e.slice(5,-1));return t===Eg?"":t}var Dle=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],Lle=["dx","dy","angle","className","breakAll"];function B5(){return B5=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},B5.apply(this,arguments)}function d9(e,t){if(e==null)return{};var a=kle(e,t),o,h;if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(e);for(h=0;h<y.length;h++)o=y[h],!(t.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(a[o]=e[o])}return a}function kle(e,t){if(e==null)return{};var a={};for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){if(t.indexOf(o)>=0)continue;a[o]=e[o]}return a}function p9(e,t){return Fle(e)||Nle(e,t)||Ble(e,t)||zle()}function zle(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ble(e,t){if(e){if(typeof e=="string")return m9(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return m9(e,t)}}function m9(e,t){(t==null||t>e.length)&&(t=e.length);for(var a=0,o=new Array(t);a<t;a++)o[a]=e[a];return o}function Nle(e,t){var a=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(a!=null){var o,h,y,b,i=[],C=!0,I=!1;try{if(y=(a=a.call(e)).next,t===0){if(Object(a)!==a)return;C=!1}else for(;!(C=(o=y.call(a)).done)&&(i.push(o.value),i.length!==t);C=!0);}catch(j){I=!0,h=j}finally{try{if(!C&&a.return!=null&&(b=a.return(),Object(b)!==b))return}finally{if(I)throw h}}return i}}function Fle(e){if(Array.isArray(e))return e}var Gj=/[ \f\n\r\t\v\u2028\u2029]+/,Hj=function(t){var a=t.children,o=t.breakAll,h=t.style;try{var y=[];ei(a)||(o?y=a.toString().split(""):y=a.toString().split(Gj));var b=y.map(function(C){return{word:C,width:s9(C,h).width}}),i=o?0:s9("",h).width;return{wordsWithComputedWidth:b,spaceWidth:i}}catch{return null}},jle=function(t,a,o,h,y){var b=t.maxLines,i=t.children,C=t.style,I=t.breakAll,j=Nn(b),F=i,G=function(){var _t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return _t.reduce(function(gt,Vt){var Ht=Vt.word,Bt=Vt.width,et=gt[gt.length-1];if(et&&(h==null||y||et.width+Bt+o<Number(h)))et.words.push(Ht),et.width+=Bt+o;else{var $t={words:[Ht],width:Bt};gt.push($t)}return gt},[])},X=G(a),Y=function(_t){return _t.reduce(function(gt,Vt){return gt.width>Vt.width?gt:Vt})};if(!j)return X;for(var J="",ee=function(_t){var gt=F.slice(0,_t),Vt=Hj({breakAll:I,style:C,children:gt+J}).wordsWithComputedWidth,Ht=G(Vt),Bt=Ht.length>b||Y(Ht).width>Number(h);return[Bt,Ht]},oe=0,ge=F.length-1,fe=0,xe;oe<=ge&&fe<=F.length-1;){var ae=Math.floor((oe+ge)/2),me=ae-1,we=ee(me),Ge=p9(we,2),He=Ge[0],ye=Ge[1],ke=ee(ae),dt=p9(ke,1),vt=dt[0];if(!He&&!vt&&(oe=ae+1),He&&vt&&(ge=ae-1),!He&&vt){xe=ye;break}fe++}return xe||X},_9=function(t){var a=ei(t)?[]:t.toString().split(Gj);return[{words:a}]},Ule=function(t){var a=t.width,o=t.scaleToFit,h=t.children,y=t.style,b=t.breakAll,i=t.maxLines;if((a||o)&&!dS.isSsr){var C,I,j=Hj({breakAll:b,children:h,style:y});if(j){var F=j.wordsWithComputedWidth,G=j.spaceWidth;C=F,I=G}else return _9(h);return jle({breakAll:b,children:h,maxLines:i,style:y},C,I,a,o)}return _9(h)},g9="#808080",Hg=function(t){var a=t.x,o=a===void 0?0:a,h=t.y,y=h===void 0?0:h,b=t.lineHeight,i=b===void 0?"1em":b,C=t.capHeight,I=C===void 0?"0.71em":C,j=t.scaleToFit,F=j===void 0?!1:j,G=t.textAnchor,X=G===void 0?"start":G,Y=t.verticalAnchor,J=Y===void 0?"end":Y,ee=t.fill,oe=ee===void 0?g9:ee,ge=d9(t,Dle),fe=Ie.useMemo(function(){return Ule({breakAll:ge.breakAll,children:ge.children,maxLines:ge.maxLines,scaleToFit:F,style:ge.style,width:ge.width})},[ge.breakAll,ge.children,ge.maxLines,F,ge.style,ge.width]),xe=ge.dx,ae=ge.dy,me=ge.angle,we=ge.className,Ge=ge.breakAll,He=d9(ge,Lle);if(!bo(o)||!bo(y))return null;var ye=o+(Nn(xe)?xe:0),ke=y+(Nn(ae)?ae:0),dt;switch(J){case"start":dt=qC("calc(".concat(I,")"));break;case"middle":dt=qC("calc(".concat((fe.length-1)/2," * -").concat(i," + (").concat(I," / 2))"));break;default:dt=qC("calc(".concat(fe.length-1," * -").concat(i,")"));break}var vt=[];if(F){var jt=fe[0].width,_t=ge.width;vt.push("scale(".concat((Nn(_t)?_t/jt:1)/jt,")"))}return me&&vt.push("rotate(".concat(me,", ").concat(ye,", ").concat(ke,")")),vt.length&&(He.transform=vt.join(" ")),Ot.createElement("text",B5({},Fr(He,!0),{x:ye,y:ke,className:oi("recharts-text",we),textAnchor:X,fill:oe.includes("url")?g9:oe}),fe.map(function(gt,Vt){var Ht=gt.words.join(Ge?"":" ");return Ot.createElement("tspan",{x:ye,dy:Vt===0?dt:i,key:"".concat(Ht,"-").concat(Vt)},Ht)}))};function hm(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function Vle(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function ZO(e){let t,a,o;e.length!==2?(t=hm,a=(i,C)=>hm(e(i),C),o=(i,C)=>e(i)-C):(t=e===hm||e===Vle?e:$le,a=e,o=e);function h(i,C,I=0,j=i.length){if(I<j){if(t(C,C)!==0)return j;do{const F=I+j>>>1;a(i[F],C)<0?I=F+1:j=F}while(I<j)}return I}function y(i,C,I=0,j=i.length){if(I<j){if(t(C,C)!==0)return j;do{const F=I+j>>>1;a(i[F],C)<=0?I=F+1:j=F}while(I<j)}return I}function b(i,C,I=0,j=i.length){const F=h(i,C,I,j-1);return F>I&&o(i[F-1],C)>-o(i[F],C)?F-1:F}return{left:h,center:b,right:y}}function $le(){return 0}function Zj(e){return e===null?NaN:+e}function*qle(e,t){for(let a of e)a!=null&&(a=+a)>=a&&(yield a)}const Gle=ZO(hm),E2=Gle.right;ZO(Zj).center;class y9 extends Map{constructor(t,a=Wle){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:a}}),t!=null)for(const[o,h]of t)this.set(o,h)}get(t){return super.get(v9(this,t))}has(t){return super.has(v9(this,t))}set(t,a){return super.set(Hle(this,t),a)}delete(t){return super.delete(Zle(this,t))}}function v9({_intern:e,_key:t},a){const o=t(a);return e.has(o)?e.get(o):a}function Hle({_intern:e,_key:t},a){const o=t(a);return e.has(o)?e.get(o):(e.set(o,a),a)}function Zle({_intern:e,_key:t},a){const o=t(a);return e.has(o)&&(a=e.get(o),e.delete(o)),a}function Wle(e){return e!==null&&typeof e=="object"?e.valueOf():e}function Xle(e=hm){if(e===hm)return Wj;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,a)=>{const o=e(t,a);return o||o===0?o:(e(a,a)===0)-(e(t,t)===0)}}function Wj(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const Yle=Math.sqrt(50),Kle=Math.sqrt(10),Jle=Math.sqrt(2);function Yb(e,t,a){const o=(t-e)/Math.max(0,a),h=Math.floor(Math.log10(o)),y=o/Math.pow(10,h),b=y>=Yle?10:y>=Kle?5:y>=Jle?2:1;let i,C,I;return h<0?(I=Math.pow(10,-h)/b,i=Math.round(e*I),C=Math.round(t*I),i/I<e&&++i,C/I>t&&--C,I=-I):(I=Math.pow(10,h)*b,i=Math.round(e/I),C=Math.round(t/I),i*I<e&&++i,C*I>t&&--C),C<i&&.5<=a&&a<2?Yb(e,t,a*2):[i,C,I]}function N5(e,t,a){if(t=+t,e=+e,a=+a,!(a>0))return[];if(e===t)return[e];const o=t<e,[h,y,b]=o?Yb(t,e,a):Yb(e,t,a);if(!(y>=h))return[];const i=y-h+1,C=new Array(i);if(o)if(b<0)for(let I=0;I<i;++I)C[I]=(y-I)/-b;else for(let I=0;I<i;++I)C[I]=(y-I)*b;else if(b<0)for(let I=0;I<i;++I)C[I]=(h+I)/-b;else for(let I=0;I<i;++I)C[I]=(h+I)*b;return C}function F5(e,t,a){return t=+t,e=+e,a=+a,Yb(e,t,a)[2]}function j5(e,t,a){t=+t,e=+e,a=+a;const o=t<e,h=o?F5(t,e,a):F5(e,t,a);return(o?-1:1)*(h<0?1/-h:h)}function x9(e,t){let a;for(const o of e)o!=null&&(a<o||a===void 0&&o>=o)&&(a=o);return a}function b9(e,t){let a;for(const o of e)o!=null&&(a>o||a===void 0&&o>=o)&&(a=o);return a}function Xj(e,t,a=0,o=1/0,h){if(t=Math.floor(t),a=Math.floor(Math.max(0,a)),o=Math.floor(Math.min(e.length-1,o)),!(a<=t&&t<=o))return e;for(h=h===void 0?Wj:Xle(h);o>a;){if(o-a>600){const C=o-a+1,I=t-a+1,j=Math.log(C),F=.5*Math.exp(2*j/3),G=.5*Math.sqrt(j*F*(C-F)/C)*(I-C/2<0?-1:1),X=Math.max(a,Math.floor(t-I*F/C+G)),Y=Math.min(o,Math.floor(t+(C-I)*F/C+G));Xj(e,t,X,Y,h)}const y=e[t];let b=a,i=o;for(Uv(e,a,t),h(e[o],y)>0&&Uv(e,a,o);b<i;){for(Uv(e,b,i),++b,--i;h(e[b],y)<0;)++b;for(;h(e[i],y)>0;)--i}h(e[a],y)===0?Uv(e,a,i):(++i,Uv(e,i,o)),i<=t&&(a=i+1),t<=i&&(o=i-1)}return e}function Uv(e,t,a){const o=e[t];e[t]=e[a],e[a]=o}function Qle(e,t,a){if(e=Float64Array.from(qle(e)),!(!(o=e.length)||isNaN(t=+t))){if(t<=0||o<2)return b9(e);if(t>=1)return x9(e);var o,h=(o-1)*t,y=Math.floor(h),b=x9(Xj(e,y).subarray(0,y+1)),i=b9(e.subarray(y+1));return b+(i-b)*(h-y)}}function ece(e,t,a=Zj){if(!(!(o=e.length)||isNaN(t=+t))){if(t<=0||o<2)return+a(e[0],0,e);if(t>=1)return+a(e[o-1],o-1,e);var o,h=(o-1)*t,y=Math.floor(h),b=+a(e[y],y,e),i=+a(e[y+1],y+1,e);return b+(i-b)*(h-y)}}function tce(e,t,a){e=+e,t=+t,a=(h=arguments.length)<2?(t=e,e=0,1):h<3?1:+a;for(var o=-1,h=Math.max(0,Math.ceil((t-e)/a))|0,y=new Array(h);++o<h;)y[o]=e+o*a;return y}function pu(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function np(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const U5=Symbol("implicit");function WO(){var e=new y9,t=[],a=[],o=U5;function h(y){let b=e.get(y);if(b===void 0){if(o!==U5)return o;e.set(y,b=t.push(y)-1)}return a[b%a.length]}return h.domain=function(y){if(!arguments.length)return t.slice();t=[],e=new y9;for(const b of y)e.has(b)||e.set(b,t.push(b)-1);return h},h.range=function(y){return arguments.length?(a=Array.from(y),h):a.slice()},h.unknown=function(y){return arguments.length?(o=y,h):o},h.copy=function(){return WO(t,a).unknown(o)},pu.apply(h,arguments),h}function N1(){var e=WO().unknown(void 0),t=e.domain,a=e.range,o=0,h=1,y,b,i=!1,C=0,I=0,j=.5;delete e.unknown;function F(){var G=t().length,X=h<o,Y=X?h:o,J=X?o:h;y=(J-Y)/Math.max(1,G-C+I*2),i&&(y=Math.floor(y)),Y+=(J-Y-y*(G-C))*j,b=y*(1-C),i&&(Y=Math.round(Y),b=Math.round(b));var ee=tce(G).map(function(oe){return Y+y*oe});return a(X?ee.reverse():ee)}return e.domain=function(G){return arguments.length?(t(G),F()):t()},e.range=function(G){return arguments.length?([o,h]=G,o=+o,h=+h,F()):[o,h]},e.rangeRound=function(G){return[o,h]=G,o=+o,h=+h,i=!0,F()},e.bandwidth=function(){return b},e.step=function(){return y},e.round=function(G){return arguments.length?(i=!!G,F()):i},e.padding=function(G){return arguments.length?(C=Math.min(1,I=+G),F()):C},e.paddingInner=function(G){return arguments.length?(C=Math.min(1,G),F()):C},e.paddingOuter=function(G){return arguments.length?(I=+G,F()):I},e.align=function(G){return arguments.length?(j=Math.max(0,Math.min(1,G)),F()):j},e.copy=function(){return N1(t(),[o,h]).round(i).paddingInner(C).paddingOuter(I).align(j)},pu.apply(F(),arguments)}function Yj(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return Yj(t())},e}function d1(){return Yj(N1.apply(null,arguments).paddingInner(1))}function XO(e,t,a){e.prototype=t.prototype=a,a.constructor=e}function Kj(e,t){var a=Object.create(e.prototype);for(var o in t)a[o]=t[o];return a}function A2(){}var F1=.7,Kb=1/F1,Dg="\\s*([+-]?\\d+)\\s*",j1="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",gf="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",nce=/^#([0-9a-f]{3,8})$/,rce=new RegExp(`^rgb\\(${Dg},${Dg},${Dg}\\)$`),ice=new RegExp(`^rgb\\(${gf},${gf},${gf}\\)$`),ace=new RegExp(`^rgba\\(${Dg},${Dg},${Dg},${j1}\\)$`),oce=new RegExp(`^rgba\\(${gf},${gf},${gf},${j1}\\)$`),sce=new RegExp(`^hsl\\(${j1},${gf},${gf}\\)$`),lce=new RegExp(`^hsla\\(${j1},${gf},${gf},${j1}\\)$`),w9={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};XO(A2,U1,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:S9,formatHex:S9,formatHex8:cce,formatHsl:uce,formatRgb:T9,toString:T9});function S9(){return this.rgb().formatHex()}function cce(){return this.rgb().formatHex8()}function uce(){return Jj(this).formatHsl()}function T9(){return this.rgb().formatRgb()}function U1(e){var t,a;return e=(e+"").trim().toLowerCase(),(t=nce.exec(e))?(a=t[1].length,t=parseInt(t[1],16),a===6?E9(t):a===3?new vl(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):a===8?ob(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):a===4?ob(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=rce.exec(e))?new vl(t[1],t[2],t[3],1):(t=ice.exec(e))?new vl(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=ace.exec(e))?ob(t[1],t[2],t[3],t[4]):(t=oce.exec(e))?ob(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=sce.exec(e))?M9(t[1],t[2]/100,t[3]/100,1):(t=lce.exec(e))?M9(t[1],t[2]/100,t[3]/100,t[4]):w9.hasOwnProperty(e)?E9(w9[e]):e==="transparent"?new vl(NaN,NaN,NaN,0):null}function E9(e){return new vl(e>>16&255,e>>8&255,e&255,1)}function ob(e,t,a,o){return o<=0&&(e=t=a=NaN),new vl(e,t,a,o)}function hce(e){return e instanceof A2||(e=U1(e)),e?(e=e.rgb(),new vl(e.r,e.g,e.b,e.opacity)):new vl}function V5(e,t,a,o){return arguments.length===1?hce(e):new vl(e,t,a,o??1)}function vl(e,t,a,o){this.r=+e,this.g=+t,this.b=+a,this.opacity=+o}XO(vl,V5,Kj(A2,{brighter(e){return e=e==null?Kb:Math.pow(Kb,e),new vl(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?F1:Math.pow(F1,e),new vl(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new vl(U0(this.r),U0(this.g),U0(this.b),Jb(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:A9,formatHex:A9,formatHex8:fce,formatRgb:C9,toString:C9}));function A9(){return`#${F0(this.r)}${F0(this.g)}${F0(this.b)}`}function fce(){return`#${F0(this.r)}${F0(this.g)}${F0(this.b)}${F0((isNaN(this.opacity)?1:this.opacity)*255)}`}function C9(){const e=Jb(this.opacity);return`${e===1?"rgb(":"rgba("}${U0(this.r)}, ${U0(this.g)}, ${U0(this.b)}${e===1?")":`, ${e})`}`}function Jb(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function U0(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function F0(e){return e=U0(e),(e<16?"0":"")+e.toString(16)}function M9(e,t,a,o){return o<=0?e=t=a=NaN:a<=0||a>=1?e=t=NaN:t<=0&&(e=NaN),new rh(e,t,a,o)}function Jj(e){if(e instanceof rh)return new rh(e.h,e.s,e.l,e.opacity);if(e instanceof A2||(e=U1(e)),!e)return new rh;if(e instanceof rh)return e;e=e.rgb();var t=e.r/255,a=e.g/255,o=e.b/255,h=Math.min(t,a,o),y=Math.max(t,a,o),b=NaN,i=y-h,C=(y+h)/2;return i?(t===y?b=(a-o)/i+(a<o)*6:a===y?b=(o-t)/i+2:b=(t-a)/i+4,i/=C<.5?y+h:2-y-h,b*=60):i=C>0&&C<1?0:b,new rh(b,i,C,e.opacity)}function dce(e,t,a,o){return arguments.length===1?Jj(e):new rh(e,t,a,o??1)}function rh(e,t,a,o){this.h=+e,this.s=+t,this.l=+a,this.opacity=+o}XO(rh,dce,Kj(A2,{brighter(e){return e=e==null?Kb:Math.pow(Kb,e),new rh(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?F1:Math.pow(F1,e),new rh(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,a=this.l,o=a+(a<.5?a:1-a)*t,h=2*a-o;return new vl(GC(e>=240?e-240:e+120,h,o),GC(e,h,o),GC(e<120?e+240:e-120,h,o),this.opacity)},clamp(){return new rh(O9(this.h),sb(this.s),sb(this.l),Jb(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Jb(this.opacity);return`${e===1?"hsl(":"hsla("}${O9(this.h)}, ${sb(this.s)*100}%, ${sb(this.l)*100}%${e===1?")":`, ${e})`}`}}));function O9(e){return e=(e||0)%360,e<0?e+360:e}function sb(e){return Math.max(0,Math.min(1,e||0))}function GC(e,t,a){return(e<60?t+(a-t)*e/60:e<180?a:e<240?t+(a-t)*(240-e)/60:t)*255}const YO=e=>()=>e;function pce(e,t){return function(a){return e+a*t}}function mce(e,t,a){return e=Math.pow(e,a),t=Math.pow(t,a)-e,a=1/a,function(o){return Math.pow(e+o*t,a)}}function _ce(e){return(e=+e)==1?Qj:function(t,a){return a-t?mce(t,a,e):YO(isNaN(t)?a:t)}}function Qj(e,t){var a=t-e;return a?pce(e,a):YO(isNaN(e)?t:e)}const P9=function e(t){var a=_ce(t);function o(h,y){var b=a((h=V5(h)).r,(y=V5(y)).r),i=a(h.g,y.g),C=a(h.b,y.b),I=Qj(h.opacity,y.opacity);return function(j){return h.r=b(j),h.g=i(j),h.b=C(j),h.opacity=I(j),h+""}}return o.gamma=e,o}(1);function gce(e,t){t||(t=[]);var a=e?Math.min(t.length,e.length):0,o=t.slice(),h;return function(y){for(h=0;h<a;++h)o[h]=e[h]*(1-y)+t[h]*y;return o}}function yce(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function vce(e,t){var a=t?t.length:0,o=e?Math.min(a,e.length):0,h=new Array(o),y=new Array(a),b;for(b=0;b<o;++b)h[b]=yy(e[b],t[b]);for(;b<a;++b)y[b]=t[b];return function(i){for(b=0;b<o;++b)y[b]=h[b](i);return y}}function xce(e,t){var a=new Date;return e=+e,t=+t,function(o){return a.setTime(e*(1-o)+t*o),a}}function Qb(e,t){return e=+e,t=+t,function(a){return e*(1-a)+t*a}}function bce(e,t){var a={},o={},h;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(h in t)h in e?a[h]=yy(e[h],t[h]):o[h]=t[h];return function(y){for(h in a)o[h]=a[h](y);return o}}var $5=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,HC=new RegExp($5.source,"g");function wce(e){return function(){return e}}function Sce(e){return function(t){return e(t)+""}}function Tce(e,t){var a=$5.lastIndex=HC.lastIndex=0,o,h,y,b=-1,i=[],C=[];for(e=e+"",t=t+"";(o=$5.exec(e))&&(h=HC.exec(t));)(y=h.index)>a&&(y=t.slice(a,y),i[b]?i[b]+=y:i[++b]=y),(o=o[0])===(h=h[0])?i[b]?i[b]+=h:i[++b]=h:(i[++b]=null,C.push({i:b,x:Qb(o,h)})),a=HC.lastIndex;return a<t.length&&(y=t.slice(a),i[b]?i[b]+=y:i[++b]=y),i.length<2?C[0]?Sce(C[0].x):wce(t):(t=C.length,function(I){for(var j=0,F;j<t;++j)i[(F=C[j]).i]=F.x(I);return i.join("")})}function yy(e,t){var a=typeof t,o;return t==null||a==="boolean"?YO(t):(a==="number"?Qb:a==="string"?(o=U1(t))?(t=o,P9):Tce:t instanceof U1?P9:t instanceof Date?xce:yce(t)?gce:Array.isArray(t)?vce:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?bce:Qb)(e,t)}function KO(e,t){return e=+e,t=+t,function(a){return Math.round(e*(1-a)+t*a)}}function Ece(e,t){t===void 0&&(t=e,e=yy);for(var a=0,o=t.length-1,h=t[0],y=new Array(o<0?0:o);a<o;)y[a]=e(h,h=t[++a]);return function(b){var i=Math.max(0,Math.min(o-1,Math.floor(b*=o)));return y[i](b-i)}}function Ace(e){return function(){return e}}function ew(e){return+e}var I9=[0,1];function el(e){return e}function q5(e,t){return(t-=e=+e)?function(a){return(a-e)/t}:Ace(isNaN(t)?NaN:.5)}function Cce(e,t){var a;return e>t&&(a=e,e=t,t=a),function(o){return Math.max(e,Math.min(t,o))}}function Mce(e,t,a){var o=e[0],h=e[1],y=t[0],b=t[1];return h<o?(o=q5(h,o),y=a(b,y)):(o=q5(o,h),y=a(y,b)),function(i){return y(o(i))}}function Oce(e,t,a){var o=Math.min(e.length,t.length)-1,h=new Array(o),y=new Array(o),b=-1;for(e[o]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++b<o;)h[b]=q5(e[b],e[b+1]),y[b]=a(t[b],t[b+1]);return function(i){var C=E2(e,i,1,o)-1;return y[C](h[C](i))}}function C2(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function pS(){var e=I9,t=I9,a=yy,o,h,y,b=el,i,C,I;function j(){var G=Math.min(e.length,t.length);return b!==el&&(b=Cce(e[0],e[G-1])),i=G>2?Oce:Mce,C=I=null,F}function F(G){return G==null||isNaN(G=+G)?y:(C||(C=i(e.map(o),t,a)))(o(b(G)))}return F.invert=function(G){return b(h((I||(I=i(t,e.map(o),Qb)))(G)))},F.domain=function(G){return arguments.length?(e=Array.from(G,ew),j()):e.slice()},F.range=function(G){return arguments.length?(t=Array.from(G),j()):t.slice()},F.rangeRound=function(G){return t=Array.from(G),a=KO,j()},F.clamp=function(G){return arguments.length?(b=G?!0:el,j()):b!==el},F.interpolate=function(G){return arguments.length?(a=G,j()):a},F.unknown=function(G){return arguments.length?(y=G,F):y},function(G,X){return o=G,h=X,j()}}function JO(){return pS()(el,el)}function Pce(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function tw(e,t){if((a=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var a,o=e.slice(0,a);return[o.length>1?o[0]+o.slice(2):o,+e.slice(a+1)]}function Zg(e){return e=tw(Math.abs(e)),e?e[1]:NaN}function Ice(e,t){return function(a,o){for(var h=a.length,y=[],b=0,i=e[0],C=0;h>0&&i>0&&(C+i+1>o&&(i=Math.max(1,o-C)),y.push(a.substring(h-=i,h+i)),!((C+=i+1)>o));)i=e[b=(b+1)%e.length];return y.reverse().join(t)}}function Rce(e){return function(t){return t.replace(/[0-9]/g,function(a){return e[+a]})}}var Dce=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function V1(e){if(!(t=Dce.exec(e)))throw new Error("invalid format: "+e);var t;return new QO({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}V1.prototype=QO.prototype;function QO(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}QO.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Lce(e){e:for(var t=e.length,a=1,o=-1,h;a<t;++a)switch(e[a]){case".":o=h=a;break;case"0":o===0&&(o=a),h=a;break;default:if(!+e[a])break e;o>0&&(o=0);break}return o>0?e.slice(0,o)+e.slice(h+1):e}var eU;function kce(e,t){var a=tw(e,t);if(!a)return e+"";var o=a[0],h=a[1],y=h-(eU=Math.max(-8,Math.min(8,Math.floor(h/3)))*3)+1,b=o.length;return y===b?o:y>b?o+new Array(y-b+1).join("0"):y>0?o.slice(0,y)+"."+o.slice(y):"0."+new Array(1-y).join("0")+tw(e,Math.max(0,t+y-1))[0]}function R9(e,t){var a=tw(e,t);if(!a)return e+"";var o=a[0],h=a[1];return h<0?"0."+new Array(-h).join("0")+o:o.length>h+1?o.slice(0,h+1)+"."+o.slice(h+1):o+new Array(h-o.length+2).join("0")}const D9={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:Pce,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>R9(e*100,t),r:R9,s:kce,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function L9(e){return e}var k9=Array.prototype.map,z9=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function zce(e){var t=e.grouping===void 0||e.thousands===void 0?L9:Ice(k9.call(e.grouping,Number),e.thousands+""),a=e.currency===void 0?"":e.currency[0]+"",o=e.currency===void 0?"":e.currency[1]+"",h=e.decimal===void 0?".":e.decimal+"",y=e.numerals===void 0?L9:Rce(k9.call(e.numerals,String)),b=e.percent===void 0?"%":e.percent+"",i=e.minus===void 0?"":e.minus+"",C=e.nan===void 0?"NaN":e.nan+"";function I(F){F=V1(F);var G=F.fill,X=F.align,Y=F.sign,J=F.symbol,ee=F.zero,oe=F.width,ge=F.comma,fe=F.precision,xe=F.trim,ae=F.type;ae==="n"?(ge=!0,ae="g"):D9[ae]||(fe===void 0&&(fe=12),xe=!0,ae="g"),(ee||G==="0"&&X==="=")&&(ee=!0,G="0",X="=");var me=J==="$"?a:J==="#"&&/[boxX]/.test(ae)?"0"+ae.toLowerCase():"",we=J==="$"?o:/[%p]/.test(ae)?b:"",Ge=D9[ae],He=/[defgprs%]/.test(ae);fe=fe===void 0?6:/[gprs]/.test(ae)?Math.max(1,Math.min(21,fe)):Math.max(0,Math.min(20,fe));function ye(ke){var dt=me,vt=we,jt,_t,gt;if(ae==="c")vt=Ge(ke)+vt,ke="";else{ke=+ke;var Vt=ke<0||1/ke<0;if(ke=isNaN(ke)?C:Ge(Math.abs(ke),fe),xe&&(ke=Lce(ke)),Vt&&+ke==0&&Y!=="+"&&(Vt=!1),dt=(Vt?Y==="("?Y:i:Y==="-"||Y==="("?"":Y)+dt,vt=(ae==="s"?z9[8+eU/3]:"")+vt+(Vt&&Y==="("?")":""),He){for(jt=-1,_t=ke.length;++jt<_t;)if(gt=ke.charCodeAt(jt),48>gt||gt>57){vt=(gt===46?h+ke.slice(jt+1):ke.slice(jt))+vt,ke=ke.slice(0,jt);break}}}ge&&!ee&&(ke=t(ke,1/0));var Ht=dt.length+ke.length+vt.length,Bt=Ht<oe?new Array(oe-Ht+1).join(G):"";switch(ge&&ee&&(ke=t(Bt+ke,Bt.length?oe-vt.length:1/0),Bt=""),X){case"<":ke=dt+ke+vt+Bt;break;case"=":ke=dt+Bt+ke+vt;break;case"^":ke=Bt.slice(0,Ht=Bt.length>>1)+dt+ke+vt+Bt.slice(Ht);break;default:ke=Bt+dt+ke+vt;break}return y(ke)}return ye.toString=function(){return F+""},ye}function j(F,G){var X=I((F=V1(F),F.type="f",F)),Y=Math.max(-8,Math.min(8,Math.floor(Zg(G)/3)))*3,J=Math.pow(10,-Y),ee=z9[8+Y/3];return function(oe){return X(J*oe)+ee}}return{format:I,formatPrefix:j}}var lb,eP,tU;Bce({thousands:",",grouping:[3],currency:["$",""]});function Bce(e){return lb=zce(e),eP=lb.format,tU=lb.formatPrefix,lb}function Nce(e){return Math.max(0,-Zg(Math.abs(e)))}function Fce(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Zg(t)/3)))*3-Zg(Math.abs(e)))}function jce(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Zg(t)-Zg(e))+1}function nU(e,t,a,o){var h=j5(e,t,a),y;switch(o=V1(o??",f"),o.type){case"s":{var b=Math.max(Math.abs(e),Math.abs(t));return o.precision==null&&!isNaN(y=Fce(h,b))&&(o.precision=y),tU(o,b)}case"":case"e":case"g":case"p":case"r":{o.precision==null&&!isNaN(y=jce(h,Math.max(Math.abs(e),Math.abs(t))))&&(o.precision=y-(o.type==="e"));break}case"f":case"%":{o.precision==null&&!isNaN(y=Nce(h))&&(o.precision=y-(o.type==="%")*2);break}}return eP(o)}function ym(e){var t=e.domain;return e.ticks=function(a){var o=t();return N5(o[0],o[o.length-1],a??10)},e.tickFormat=function(a,o){var h=t();return nU(h[0],h[h.length-1],a??10,o)},e.nice=function(a){a==null&&(a=10);var o=t(),h=0,y=o.length-1,b=o[h],i=o[y],C,I,j=10;for(i<b&&(I=b,b=i,i=I,I=h,h=y,y=I);j-- >0;){if(I=F5(b,i,a),I===C)return o[h]=b,o[y]=i,t(o);if(I>0)b=Math.floor(b/I)*I,i=Math.ceil(i/I)*I;else if(I<0)b=Math.ceil(b*I)/I,i=Math.floor(i*I)/I;else break;C=I}return e},e}function nw(){var e=JO();return e.copy=function(){return C2(e,nw())},pu.apply(e,arguments),ym(e)}function rU(e){var t;function a(o){return o==null||isNaN(o=+o)?t:o}return a.invert=a,a.domain=a.range=function(o){return arguments.length?(e=Array.from(o,ew),a):e.slice()},a.unknown=function(o){return arguments.length?(t=o,a):t},a.copy=function(){return rU(e).unknown(t)},e=arguments.length?Array.from(e,ew):[0,1],ym(a)}function iU(e,t){e=e.slice();var a=0,o=e.length-1,h=e[a],y=e[o],b;return y<h&&(b=a,a=o,o=b,b=h,h=y,y=b),e[a]=t.floor(h),e[o]=t.ceil(y),e}function B9(e){return Math.log(e)}function N9(e){return Math.exp(e)}function Uce(e){return-Math.log(-e)}function Vce(e){return-Math.exp(-e)}function $ce(e){return isFinite(e)?+("1e"+e):e<0?0:e}function qce(e){return e===10?$ce:e===Math.E?Math.exp:t=>Math.pow(e,t)}function Gce(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function F9(e){return(t,a)=>-e(-t,a)}function tP(e){const t=e(B9,N9),a=t.domain;let o=10,h,y;function b(){return h=Gce(o),y=qce(o),a()[0]<0?(h=F9(h),y=F9(y),e(Uce,Vce)):e(B9,N9),t}return t.base=function(i){return arguments.length?(o=+i,b()):o},t.domain=function(i){return arguments.length?(a(i),b()):a()},t.ticks=i=>{const C=a();let I=C[0],j=C[C.length-1];const F=j<I;F&&([I,j]=[j,I]);let G=h(I),X=h(j),Y,J;const ee=i==null?10:+i;let oe=[];if(!(o%1)&&X-G<ee){if(G=Math.floor(G),X=Math.ceil(X),I>0){for(;G<=X;++G)for(Y=1;Y<o;++Y)if(J=G<0?Y/y(-G):Y*y(G),!(J<I)){if(J>j)break;oe.push(J)}}else for(;G<=X;++G)for(Y=o-1;Y>=1;--Y)if(J=G>0?Y/y(-G):Y*y(G),!(J<I)){if(J>j)break;oe.push(J)}oe.length*2<ee&&(oe=N5(I,j,ee))}else oe=N5(G,X,Math.min(X-G,ee)).map(y);return F?oe.reverse():oe},t.tickFormat=(i,C)=>{if(i==null&&(i=10),C==null&&(C=o===10?"s":","),typeof C!="function"&&(!(o%1)&&(C=V1(C)).precision==null&&(C.trim=!0),C=eP(C)),i===1/0)return C;const I=Math.max(1,o*i/t.ticks().length);return j=>{let F=j/y(Math.round(h(j)));return F*o<o-.5&&(F*=o),F<=I?C(j):""}},t.nice=()=>a(iU(a(),{floor:i=>y(Math.floor(h(i))),ceil:i=>y(Math.ceil(h(i)))})),t}function aU(){const e=tP(pS()).domain([1,10]);return e.copy=()=>C2(e,aU()).base(e.base()),pu.apply(e,arguments),e}function j9(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function U9(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function nP(e){var t=1,a=e(j9(t),U9(t));return a.constant=function(o){return arguments.length?e(j9(t=+o),U9(t)):t},ym(a)}function oU(){var e=nP(pS());return e.copy=function(){return C2(e,oU()).constant(e.constant())},pu.apply(e,arguments)}function V9(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function Hce(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function Zce(e){return e<0?-e*e:e*e}function rP(e){var t=e(el,el),a=1;function o(){return a===1?e(el,el):a===.5?e(Hce,Zce):e(V9(a),V9(1/a))}return t.exponent=function(h){return arguments.length?(a=+h,o()):a},ym(t)}function iP(){var e=rP(pS());return e.copy=function(){return C2(e,iP()).exponent(e.exponent())},pu.apply(e,arguments),e}function Wce(){return iP.apply(null,arguments).exponent(.5)}function $9(e){return Math.sign(e)*e*e}function Xce(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function sU(){var e=JO(),t=[0,1],a=!1,o;function h(y){var b=Xce(e(y));return isNaN(b)?o:a?Math.round(b):b}return h.invert=function(y){return e.invert($9(y))},h.domain=function(y){return arguments.length?(e.domain(y),h):e.domain()},h.range=function(y){return arguments.length?(e.range((t=Array.from(y,ew)).map($9)),h):t.slice()},h.rangeRound=function(y){return h.range(y).round(!0)},h.round=function(y){return arguments.length?(a=!!y,h):a},h.clamp=function(y){return arguments.length?(e.clamp(y),h):e.clamp()},h.unknown=function(y){return arguments.length?(o=y,h):o},h.copy=function(){return sU(e.domain(),t).round(a).clamp(e.clamp()).unknown(o)},pu.apply(h,arguments),ym(h)}function lU(){var e=[],t=[],a=[],o;function h(){var b=0,i=Math.max(1,t.length);for(a=new Array(i-1);++b<i;)a[b-1]=ece(e,b/i);return y}function y(b){return b==null||isNaN(b=+b)?o:t[E2(a,b)]}return y.invertExtent=function(b){var i=t.indexOf(b);return i<0?[NaN,NaN]:[i>0?a[i-1]:e[0],i<a.length?a[i]:e[e.length-1]]},y.domain=function(b){if(!arguments.length)return e.slice();e=[];for(let i of b)i!=null&&!isNaN(i=+i)&&e.push(i);return e.sort(hm),h()},y.range=function(b){return arguments.length?(t=Array.from(b),h()):t.slice()},y.unknown=function(b){return arguments.length?(o=b,y):o},y.quantiles=function(){return a.slice()},y.copy=function(){return lU().domain(e).range(t).unknown(o)},pu.apply(y,arguments)}function cU(){var e=0,t=1,a=1,o=[.5],h=[0,1],y;function b(C){return C!=null&&C<=C?h[E2(o,C,0,a)]:y}function i(){var C=-1;for(o=new Array(a);++C<a;)o[C]=((C+1)*t-(C-a)*e)/(a+1);return b}return b.domain=function(C){return arguments.length?([e,t]=C,e=+e,t=+t,i()):[e,t]},b.range=function(C){return arguments.length?(a=(h=Array.from(C)).length-1,i()):h.slice()},b.invertExtent=function(C){var I=h.indexOf(C);return I<0?[NaN,NaN]:I<1?[e,o[0]]:I>=a?[o[a-1],t]:[o[I-1],o[I]]},b.unknown=function(C){return arguments.length&&(y=C),b},b.thresholds=function(){return o.slice()},b.copy=function(){return cU().domain([e,t]).range(h).unknown(y)},pu.apply(ym(b),arguments)}function uU(){var e=[.5],t=[0,1],a,o=1;function h(y){return y!=null&&y<=y?t[E2(e,y,0,o)]:a}return h.domain=function(y){return arguments.length?(e=Array.from(y),o=Math.min(e.length,t.length-1),h):e.slice()},h.range=function(y){return arguments.length?(t=Array.from(y),o=Math.min(e.length,t.length-1),h):t.slice()},h.invertExtent=function(y){var b=t.indexOf(y);return[e[b-1],e[b]]},h.unknown=function(y){return arguments.length?(a=y,h):a},h.copy=function(){return uU().domain(e).range(t).unknown(a)},pu.apply(h,arguments)}const ZC=new Date,WC=new Date;function wo(e,t,a,o){function h(y){return e(y=arguments.length===0?new Date:new Date(+y)),y}return h.floor=y=>(e(y=new Date(+y)),y),h.ceil=y=>(e(y=new Date(y-1)),t(y,1),e(y),y),h.round=y=>{const b=h(y),i=h.ceil(y);return y-b<i-y?b:i},h.offset=(y,b)=>(t(y=new Date(+y),b==null?1:Math.floor(b)),y),h.range=(y,b,i)=>{const C=[];if(y=h.ceil(y),i=i==null?1:Math.floor(i),!(y<b)||!(i>0))return C;let I;do C.push(I=new Date(+y)),t(y,i),e(y);while(I<y&&y<b);return C},h.filter=y=>wo(b=>{if(b>=b)for(;e(b),!y(b);)b.setTime(b-1)},(b,i)=>{if(b>=b)if(i<0)for(;++i<=0;)for(;t(b,-1),!y(b););else for(;--i>=0;)for(;t(b,1),!y(b););}),a&&(h.count=(y,b)=>(ZC.setTime(+y),WC.setTime(+b),e(ZC),e(WC),Math.floor(a(ZC,WC))),h.every=y=>(y=Math.floor(y),!isFinite(y)||!(y>0)?null:y>1?h.filter(o?b=>o(b)%y===0:b=>h.count(0,b)%y===0):h)),h}const rw=wo(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);rw.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?wo(t=>{t.setTime(Math.floor(t/e)*e)},(t,a)=>{t.setTime(+t+a*e)},(t,a)=>(a-t)/e):rw);rw.range;const Fd=1e3,cu=Fd*60,jd=cu*60,Wd=jd*24,aP=Wd*7,q9=Wd*30,XC=Wd*365,j0=wo(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*Fd)},(e,t)=>(t-e)/Fd,e=>e.getUTCSeconds());j0.range;const oP=wo(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Fd)},(e,t)=>{e.setTime(+e+t*cu)},(e,t)=>(t-e)/cu,e=>e.getMinutes());oP.range;const sP=wo(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*cu)},(e,t)=>(t-e)/cu,e=>e.getUTCMinutes());sP.range;const lP=wo(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Fd-e.getMinutes()*cu)},(e,t)=>{e.setTime(+e+t*jd)},(e,t)=>(t-e)/jd,e=>e.getHours());lP.range;const cP=wo(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*jd)},(e,t)=>(t-e)/jd,e=>e.getUTCHours());cP.range;const M2=wo(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*cu)/Wd,e=>e.getDate()-1);M2.range;const mS=wo(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Wd,e=>e.getUTCDate()-1);mS.range;const hU=wo(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Wd,e=>Math.floor(e/Wd));hU.range;function K0(e){return wo(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,a)=>{t.setDate(t.getDate()+a*7)},(t,a)=>(a-t-(a.getTimezoneOffset()-t.getTimezoneOffset())*cu)/aP)}const _S=K0(0),iw=K0(1),Yce=K0(2),Kce=K0(3),Wg=K0(4),Jce=K0(5),Qce=K0(6);_S.range;iw.range;Yce.range;Kce.range;Wg.range;Jce.range;Qce.range;function J0(e){return wo(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,a)=>{t.setUTCDate(t.getUTCDate()+a*7)},(t,a)=>(a-t)/aP)}const gS=J0(0),aw=J0(1),eue=J0(2),tue=J0(3),Xg=J0(4),nue=J0(5),rue=J0(6);gS.range;aw.range;eue.range;tue.range;Xg.range;nue.range;rue.range;const uP=wo(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());uP.range;const hP=wo(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());hP.range;const Xd=wo(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());Xd.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:wo(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,a)=>{t.setFullYear(t.getFullYear()+a*e)});Xd.range;const Yd=wo(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());Yd.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:wo(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,a)=>{t.setUTCFullYear(t.getUTCFullYear()+a*e)});Yd.range;function fU(e,t,a,o,h,y){const b=[[j0,1,Fd],[j0,5,5*Fd],[j0,15,15*Fd],[j0,30,30*Fd],[y,1,cu],[y,5,5*cu],[y,15,15*cu],[y,30,30*cu],[h,1,jd],[h,3,3*jd],[h,6,6*jd],[h,12,12*jd],[o,1,Wd],[o,2,2*Wd],[a,1,aP],[t,1,q9],[t,3,3*q9],[e,1,XC]];function i(I,j,F){const G=j<I;G&&([I,j]=[j,I]);const X=F&&typeof F.range=="function"?F:C(I,j,F),Y=X?X.range(I,+j+1):[];return G?Y.reverse():Y}function C(I,j,F){const G=Math.abs(j-I)/F,X=ZO(([,,ee])=>ee).right(b,G);if(X===b.length)return e.every(j5(I/XC,j/XC,F));if(X===0)return rw.every(Math.max(j5(I,j,F),1));const[Y,J]=b[G/b[X-1][2]<b[X][2]/G?X-1:X];return Y.every(J)}return[i,C]}const[iue,aue]=fU(Yd,hP,gS,hU,cP,sP),[oue,sue]=fU(Xd,uP,_S,M2,lP,oP);function YC(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function KC(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Vv(e,t,a){return{y:e,m:t,d:a,H:0,M:0,S:0,L:0}}function lue(e){var t=e.dateTime,a=e.date,o=e.time,h=e.periods,y=e.days,b=e.shortDays,i=e.months,C=e.shortMonths,I=$v(h),j=qv(h),F=$v(y),G=qv(y),X=$v(b),Y=qv(b),J=$v(i),ee=qv(i),oe=$v(C),ge=qv(C),fe={a:Vt,A:Ht,b:Bt,B:et,c:null,d:Y9,e:Y9,f:Iue,g:Uue,G:$ue,H:Mue,I:Oue,j:Pue,L:dU,m:Rue,M:Due,p:$t,q:rn,Q:Q9,s:e8,S:Lue,u:kue,U:zue,V:Bue,w:Nue,W:Fue,x:null,X:null,y:jue,Y:Vue,Z:que,"%":J9},xe={a:Nt,A:xn,b:rr,B:Xn,c:null,d:K9,e:K9,f:Wue,g:ihe,G:ohe,H:Gue,I:Hue,j:Zue,L:mU,m:Xue,M:Yue,p:yi,q:ir,Q:Q9,s:e8,S:Kue,u:Jue,U:Que,V:ehe,w:the,W:nhe,x:null,X:null,y:rhe,Y:ahe,Z:she,"%":J9},ae={a:ye,A:ke,b:dt,B:vt,c:jt,d:W9,e:W9,f:Tue,g:Z9,G:H9,H:X9,I:X9,j:xue,L:Sue,m:vue,M:bue,p:He,q:yue,Q:Aue,s:Cue,S:wue,u:due,U:pue,V:mue,w:fue,W:_ue,x:_t,X:gt,y:Z9,Y:H9,Z:gue,"%":Eue};fe.x=me(a,fe),fe.X=me(o,fe),fe.c=me(t,fe),xe.x=me(a,xe),xe.X=me(o,xe),xe.c=me(t,xe);function me(yn,Ne){return function(Qn){var fn=[],Dr=-1,Pt=0,Pr=yn.length,Cr,zi,$n;for(Qn instanceof Date||(Qn=new Date(+Qn));++Dr<Pr;)yn.charCodeAt(Dr)===37&&(fn.push(yn.slice(Pt,Dr)),(zi=G9[Cr=yn.charAt(++Dr)])!=null?Cr=yn.charAt(++Dr):zi=Cr==="e"?" ":"0",($n=Ne[Cr])&&(Cr=$n(Qn,zi)),fn.push(Cr),Pt=Dr+1);return fn.push(yn.slice(Pt,Dr)),fn.join("")}}function we(yn,Ne){return function(Qn){var fn=Vv(1900,void 0,1),Dr=Ge(fn,yn,Qn+="",0),Pt,Pr;if(Dr!=Qn.length)return null;if("Q"in fn)return new Date(fn.Q);if("s"in fn)return new Date(fn.s*1e3+("L"in fn?fn.L:0));if(Ne&&!("Z"in fn)&&(fn.Z=0),"p"in fn&&(fn.H=fn.H%12+fn.p*12),fn.m===void 0&&(fn.m="q"in fn?fn.q:0),"V"in fn){if(fn.V<1||fn.V>53)return null;"w"in fn||(fn.w=1),"Z"in fn?(Pt=KC(Vv(fn.y,0,1)),Pr=Pt.getUTCDay(),Pt=Pr>4||Pr===0?aw.ceil(Pt):aw(Pt),Pt=mS.offset(Pt,(fn.V-1)*7),fn.y=Pt.getUTCFullYear(),fn.m=Pt.getUTCMonth(),fn.d=Pt.getUTCDate()+(fn.w+6)%7):(Pt=YC(Vv(fn.y,0,1)),Pr=Pt.getDay(),Pt=Pr>4||Pr===0?iw.ceil(Pt):iw(Pt),Pt=M2.offset(Pt,(fn.V-1)*7),fn.y=Pt.getFullYear(),fn.m=Pt.getMonth(),fn.d=Pt.getDate()+(fn.w+6)%7)}else("W"in fn||"U"in fn)&&("w"in fn||(fn.w="u"in fn?fn.u%7:"W"in fn?1:0),Pr="Z"in fn?KC(Vv(fn.y,0,1)).getUTCDay():YC(Vv(fn.y,0,1)).getDay(),fn.m=0,fn.d="W"in fn?(fn.w+6)%7+fn.W*7-(Pr+5)%7:fn.w+fn.U*7-(Pr+6)%7);return"Z"in fn?(fn.H+=fn.Z/100|0,fn.M+=fn.Z%100,KC(fn)):YC(fn)}}function Ge(yn,Ne,Qn,fn){for(var Dr=0,Pt=Ne.length,Pr=Qn.length,Cr,zi;Dr<Pt;){if(fn>=Pr)return-1;if(Cr=Ne.charCodeAt(Dr++),Cr===37){if(Cr=Ne.charAt(Dr++),zi=ae[Cr in G9?Ne.charAt(Dr++):Cr],!zi||(fn=zi(yn,Qn,fn))<0)return-1}else if(Cr!=Qn.charCodeAt(fn++))return-1}return fn}function He(yn,Ne,Qn){var fn=I.exec(Ne.slice(Qn));return fn?(yn.p=j.get(fn[0].toLowerCase()),Qn+fn[0].length):-1}function ye(yn,Ne,Qn){var fn=X.exec(Ne.slice(Qn));return fn?(yn.w=Y.get(fn[0].toLowerCase()),Qn+fn[0].length):-1}function ke(yn,Ne,Qn){var fn=F.exec(Ne.slice(Qn));return fn?(yn.w=G.get(fn[0].toLowerCase()),Qn+fn[0].length):-1}function dt(yn,Ne,Qn){var fn=oe.exec(Ne.slice(Qn));return fn?(yn.m=ge.get(fn[0].toLowerCase()),Qn+fn[0].length):-1}function vt(yn,Ne,Qn){var fn=J.exec(Ne.slice(Qn));return fn?(yn.m=ee.get(fn[0].toLowerCase()),Qn+fn[0].length):-1}function jt(yn,Ne,Qn){return Ge(yn,t,Ne,Qn)}function _t(yn,Ne,Qn){return Ge(yn,a,Ne,Qn)}function gt(yn,Ne,Qn){return Ge(yn,o,Ne,Qn)}function Vt(yn){return b[yn.getDay()]}function Ht(yn){return y[yn.getDay()]}function Bt(yn){return C[yn.getMonth()]}function et(yn){return i[yn.getMonth()]}function $t(yn){return h[+(yn.getHours()>=12)]}function rn(yn){return 1+~~(yn.getMonth()/3)}function Nt(yn){return b[yn.getUTCDay()]}function xn(yn){return y[yn.getUTCDay()]}function rr(yn){return C[yn.getUTCMonth()]}function Xn(yn){return i[yn.getUTCMonth()]}function yi(yn){return h[+(yn.getUTCHours()>=12)]}function ir(yn){return 1+~~(yn.getUTCMonth()/3)}return{format:function(yn){var Ne=me(yn+="",fe);return Ne.toString=function(){return yn},Ne},parse:function(yn){var Ne=we(yn+="",!1);return Ne.toString=function(){return yn},Ne},utcFormat:function(yn){var Ne=me(yn+="",xe);return Ne.toString=function(){return yn},Ne},utcParse:function(yn){var Ne=we(yn+="",!0);return Ne.toString=function(){return yn},Ne}}}var G9={"-":"",_:" ",0:"0"},No=/^\s*\d+/,cue=/^%/,uue=/[\\^$*+?|[\]().{}]/g;function fi(e,t,a){var o=e<0?"-":"",h=(o?-e:e)+"",y=h.length;return o+(y<a?new Array(a-y+1).join(t)+h:h)}function hue(e){return e.replace(uue,"\\$&")}function $v(e){return new RegExp("^(?:"+e.map(hue).join("|")+")","i")}function qv(e){return new Map(e.map((t,a)=>[t.toLowerCase(),a]))}function fue(e,t,a){var o=No.exec(t.slice(a,a+1));return o?(e.w=+o[0],a+o[0].length):-1}function due(e,t,a){var o=No.exec(t.slice(a,a+1));return o?(e.u=+o[0],a+o[0].length):-1}function pue(e,t,a){var o=No.exec(t.slice(a,a+2));return o?(e.U=+o[0],a+o[0].length):-1}function mue(e,t,a){var o=No.exec(t.slice(a,a+2));return o?(e.V=+o[0],a+o[0].length):-1}function _ue(e,t,a){var o=No.exec(t.slice(a,a+2));return o?(e.W=+o[0],a+o[0].length):-1}function H9(e,t,a){var o=No.exec(t.slice(a,a+4));return o?(e.y=+o[0],a+o[0].length):-1}function Z9(e,t,a){var o=No.exec(t.slice(a,a+2));return o?(e.y=+o[0]+(+o[0]>68?1900:2e3),a+o[0].length):-1}function gue(e,t,a){var o=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(a,a+6));return o?(e.Z=o[1]?0:-(o[2]+(o[3]||"00")),a+o[0].length):-1}function yue(e,t,a){var o=No.exec(t.slice(a,a+1));return o?(e.q=o[0]*3-3,a+o[0].length):-1}function vue(e,t,a){var o=No.exec(t.slice(a,a+2));return o?(e.m=o[0]-1,a+o[0].length):-1}function W9(e,t,a){var o=No.exec(t.slice(a,a+2));return o?(e.d=+o[0],a+o[0].length):-1}function xue(e,t,a){var o=No.exec(t.slice(a,a+3));return o?(e.m=0,e.d=+o[0],a+o[0].length):-1}function X9(e,t,a){var o=No.exec(t.slice(a,a+2));return o?(e.H=+o[0],a+o[0].length):-1}function bue(e,t,a){var o=No.exec(t.slice(a,a+2));return o?(e.M=+o[0],a+o[0].length):-1}function wue(e,t,a){var o=No.exec(t.slice(a,a+2));return o?(e.S=+o[0],a+o[0].length):-1}function Sue(e,t,a){var o=No.exec(t.slice(a,a+3));return o?(e.L=+o[0],a+o[0].length):-1}function Tue(e,t,a){var o=No.exec(t.slice(a,a+6));return o?(e.L=Math.floor(o[0]/1e3),a+o[0].length):-1}function Eue(e,t,a){var o=cue.exec(t.slice(a,a+1));return o?a+o[0].length:-1}function Aue(e,t,a){var o=No.exec(t.slice(a));return o?(e.Q=+o[0],a+o[0].length):-1}function Cue(e,t,a){var o=No.exec(t.slice(a));return o?(e.s=+o[0],a+o[0].length):-1}function Y9(e,t){return fi(e.getDate(),t,2)}function Mue(e,t){return fi(e.getHours(),t,2)}function Oue(e,t){return fi(e.getHours()%12||12,t,2)}function Pue(e,t){return fi(1+M2.count(Xd(e),e),t,3)}function dU(e,t){return fi(e.getMilliseconds(),t,3)}function Iue(e,t){return dU(e,t)+"000"}function Rue(e,t){return fi(e.getMonth()+1,t,2)}function Due(e,t){return fi(e.getMinutes(),t,2)}function Lue(e,t){return fi(e.getSeconds(),t,2)}function kue(e){var t=e.getDay();return t===0?7:t}function zue(e,t){return fi(_S.count(Xd(e)-1,e),t,2)}function pU(e){var t=e.getDay();return t>=4||t===0?Wg(e):Wg.ceil(e)}function Bue(e,t){return e=pU(e),fi(Wg.count(Xd(e),e)+(Xd(e).getDay()===4),t,2)}function Nue(e){return e.getDay()}function Fue(e,t){return fi(iw.count(Xd(e)-1,e),t,2)}function jue(e,t){return fi(e.getFullYear()%100,t,2)}function Uue(e,t){return e=pU(e),fi(e.getFullYear()%100,t,2)}function Vue(e,t){return fi(e.getFullYear()%1e4,t,4)}function $ue(e,t){var a=e.getDay();return e=a>=4||a===0?Wg(e):Wg.ceil(e),fi(e.getFullYear()%1e4,t,4)}function que(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+fi(t/60|0,"0",2)+fi(t%60,"0",2)}function K9(e,t){return fi(e.getUTCDate(),t,2)}function Gue(e,t){return fi(e.getUTCHours(),t,2)}function Hue(e,t){return fi(e.getUTCHours()%12||12,t,2)}function Zue(e,t){return fi(1+mS.count(Yd(e),e),t,3)}function mU(e,t){return fi(e.getUTCMilliseconds(),t,3)}function Wue(e,t){return mU(e,t)+"000"}function Xue(e,t){return fi(e.getUTCMonth()+1,t,2)}function Yue(e,t){return fi(e.getUTCMinutes(),t,2)}function Kue(e,t){return fi(e.getUTCSeconds(),t,2)}function Jue(e){var t=e.getUTCDay();return t===0?7:t}function Que(e,t){return fi(gS.count(Yd(e)-1,e),t,2)}function _U(e){var t=e.getUTCDay();return t>=4||t===0?Xg(e):Xg.ceil(e)}function ehe(e,t){return e=_U(e),fi(Xg.count(Yd(e),e)+(Yd(e).getUTCDay()===4),t,2)}function the(e){return e.getUTCDay()}function nhe(e,t){return fi(aw.count(Yd(e)-1,e),t,2)}function rhe(e,t){return fi(e.getUTCFullYear()%100,t,2)}function ihe(e,t){return e=_U(e),fi(e.getUTCFullYear()%100,t,2)}function ahe(e,t){return fi(e.getUTCFullYear()%1e4,t,4)}function ohe(e,t){var a=e.getUTCDay();return e=a>=4||a===0?Xg(e):Xg.ceil(e),fi(e.getUTCFullYear()%1e4,t,4)}function she(){return"+0000"}function J9(){return"%"}function Q9(e){return+e}function e8(e){return Math.floor(+e/1e3)}var vg,gU,yU;lhe({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function lhe(e){return vg=lue(e),gU=vg.format,vg.parse,yU=vg.utcFormat,vg.utcParse,vg}function che(e){return new Date(e)}function uhe(e){return e instanceof Date?+e:+new Date(+e)}function fP(e,t,a,o,h,y,b,i,C,I){var j=JO(),F=j.invert,G=j.domain,X=I(".%L"),Y=I(":%S"),J=I("%I:%M"),ee=I("%I %p"),oe=I("%a %d"),ge=I("%b %d"),fe=I("%B"),xe=I("%Y");function ae(me){return(C(me)<me?X:i(me)<me?Y:b(me)<me?J:y(me)<me?ee:o(me)<me?h(me)<me?oe:ge:a(me)<me?fe:xe)(me)}return j.invert=function(me){return new Date(F(me))},j.domain=function(me){return arguments.length?G(Array.from(me,uhe)):G().map(che)},j.ticks=function(me){var we=G();return e(we[0],we[we.length-1],me??10)},j.tickFormat=function(me,we){return we==null?ae:I(we)},j.nice=function(me){var we=G();return(!me||typeof me.range!="function")&&(me=t(we[0],we[we.length-1],me??10)),me?G(iU(we,me)):j},j.copy=function(){return C2(j,fP(e,t,a,o,h,y,b,i,C,I))},j}function hhe(){return pu.apply(fP(oue,sue,Xd,uP,_S,M2,lP,oP,j0,gU).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function fhe(){return pu.apply(fP(iue,aue,Yd,hP,gS,mS,cP,sP,j0,yU).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function yS(){var e=0,t=1,a,o,h,y,b=el,i=!1,C;function I(F){return F==null||isNaN(F=+F)?C:b(h===0?.5:(F=(y(F)-a)*h,i?Math.max(0,Math.min(1,F)):F))}I.domain=function(F){return arguments.length?([e,t]=F,a=y(e=+e),o=y(t=+t),h=a===o?0:1/(o-a),I):[e,t]},I.clamp=function(F){return arguments.length?(i=!!F,I):i},I.interpolator=function(F){return arguments.length?(b=F,I):b};function j(F){return function(G){var X,Y;return arguments.length?([X,Y]=G,b=F(X,Y),I):[b(0),b(1)]}}return I.range=j(yy),I.rangeRound=j(KO),I.unknown=function(F){return arguments.length?(C=F,I):C},function(F){return y=F,a=F(e),o=F(t),h=a===o?0:1/(o-a),I}}function vm(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function vU(){var e=ym(yS()(el));return e.copy=function(){return vm(e,vU())},np.apply(e,arguments)}function xU(){var e=tP(yS()).domain([1,10]);return e.copy=function(){return vm(e,xU()).base(e.base())},np.apply(e,arguments)}function bU(){var e=nP(yS());return e.copy=function(){return vm(e,bU()).constant(e.constant())},np.apply(e,arguments)}function dP(){var e=rP(yS());return e.copy=function(){return vm(e,dP()).exponent(e.exponent())},np.apply(e,arguments)}function dhe(){return dP.apply(null,arguments).exponent(.5)}function wU(){var e=[],t=el;function a(o){if(o!=null&&!isNaN(o=+o))return t((E2(e,o,1)-1)/(e.length-1))}return a.domain=function(o){if(!arguments.length)return e.slice();e=[];for(let h of o)h!=null&&!isNaN(h=+h)&&e.push(h);return e.sort(hm),a},a.interpolator=function(o){return arguments.length?(t=o,a):t},a.range=function(){return e.map((o,h)=>t(h/(e.length-1)))},a.quantiles=function(o){return Array.from({length:o+1},(h,y)=>Qle(e,y/o))},a.copy=function(){return wU(t).domain(e)},np.apply(a,arguments)}function vS(){var e=0,t=.5,a=1,o=1,h,y,b,i,C,I=el,j,F=!1,G;function X(J){return isNaN(J=+J)?G:(J=.5+((J=+j(J))-y)*(o*J<o*y?i:C),I(F?Math.max(0,Math.min(1,J)):J))}X.domain=function(J){return arguments.length?([e,t,a]=J,h=j(e=+e),y=j(t=+t),b=j(a=+a),i=h===y?0:.5/(y-h),C=y===b?0:.5/(b-y),o=y<h?-1:1,X):[e,t,a]},X.clamp=function(J){return arguments.length?(F=!!J,X):F},X.interpolator=function(J){return arguments.length?(I=J,X):I};function Y(J){return function(ee){var oe,ge,fe;return arguments.length?([oe,ge,fe]=ee,I=Ece(J,[oe,ge,fe]),X):[I(0),I(.5),I(1)]}}return X.range=Y(yy),X.rangeRound=Y(KO),X.unknown=function(J){return arguments.length?(G=J,X):G},function(J){return j=J,h=J(e),y=J(t),b=J(a),i=h===y?0:.5/(y-h),C=y===b?0:.5/(b-y),o=y<h?-1:1,X}}function SU(){var e=ym(vS()(el));return e.copy=function(){return vm(e,SU())},np.apply(e,arguments)}function TU(){var e=tP(vS()).domain([.1,1,10]);return e.copy=function(){return vm(e,TU()).base(e.base())},np.apply(e,arguments)}function EU(){var e=nP(vS());return e.copy=function(){return vm(e,EU()).constant(e.constant())},np.apply(e,arguments)}function pP(){var e=rP(vS());return e.copy=function(){return vm(e,pP()).exponent(e.exponent())},np.apply(e,arguments)}function phe(){return pP.apply(null,arguments).exponent(.5)}const t8=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:N1,scaleDiverging:SU,scaleDivergingLog:TU,scaleDivergingPow:pP,scaleDivergingSqrt:phe,scaleDivergingSymlog:EU,scaleIdentity:rU,scaleImplicit:U5,scaleLinear:nw,scaleLog:aU,scaleOrdinal:WO,scalePoint:d1,scalePow:iP,scaleQuantile:lU,scaleQuantize:cU,scaleRadial:sU,scaleSequential:vU,scaleSequentialLog:xU,scaleSequentialPow:dP,scaleSequentialQuantile:wU,scaleSequentialSqrt:dhe,scaleSequentialSymlog:bU,scaleSqrt:Wce,scaleSymlog:oU,scaleThreshold:uU,scaleTime:hhe,scaleUtc:fhe,tickFormat:nU},Symbol.toStringTag,{value:"Module"}));var JC,n8;function xS(){if(n8)return JC;n8=1;var e=my();function t(a,o,h){for(var y=-1,b=a.length;++y<b;){var i=a[y],C=o(i);if(C!=null&&(I===void 0?C===C&&!e(C):h(C,I)))var I=C,j=i}return j}return JC=t,JC}var QC,r8;function AU(){if(r8)return QC;r8=1;function e(t,a){return t>a}return QC=e,QC}var eM,i8;function mhe(){if(i8)return eM;i8=1;var e=xS(),t=AU(),a=gy();function o(h){return h&&h.length?e(h,a,t):void 0}return eM=o,eM}var _he=mhe();const bS=Ei(_he);var tM,a8;function CU(){if(a8)return tM;a8=1;function e(t,a){return t<a}return tM=e,tM}var nM,o8;function ghe(){if(o8)return nM;o8=1;var e=xS(),t=CU(),a=gy();function o(h){return h&&h.length?e(h,a,t):void 0}return nM=o,nM}var yhe=ghe();const wS=Ei(yhe);var rM,s8;function vhe(){if(s8)return rM;s8=1;var e=PO(),t=Ef(),a=Lj(),o=wl();function h(y,b){var i=o(y)?e:a;return i(y,t(b,3))}return rM=h,rM}var iM,l8;function xhe(){if(l8)return iM;l8=1;var e=Rj(),t=vhe();function a(o,h){return e(t(o,h),1)}return iM=a,iM}var bhe=xhe();const whe=Ei(bhe);var aM,c8;function She(){if(c8)return aM;c8=1;var e=$O();function t(a,o){return e(a,o)}return aM=t,aM}var The=She();const mP=Ei(The);var vy=1e9,Ehe={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},gP,ua=!0,hu="[DecimalError] ",V0=hu+"Invalid argument: ",_P=hu+"Exponent out of range: ",xy=Math.floor,k0=Math.pow,Ahe=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,ic,Lo=1e7,na=7,MU=9007199254740991,ow=xy(MU/na),Vn={};Vn.absoluteValue=Vn.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};Vn.comparedTo=Vn.cmp=function(e){var t,a,o,h,y=this;if(e=new y.constructor(e),y.s!==e.s)return y.s||-e.s;if(y.e!==e.e)return y.e>e.e^y.s<0?1:-1;for(o=y.d.length,h=e.d.length,t=0,a=o<h?o:h;t<a;++t)if(y.d[t]!==e.d[t])return y.d[t]>e.d[t]^y.s<0?1:-1;return o===h?0:o>h^y.s<0?1:-1};Vn.decimalPlaces=Vn.dp=function(){var e=this,t=e.d.length-1,a=(t-e.e)*na;if(t=e.d[t],t)for(;t%10==0;t/=10)a--;return a<0?0:a};Vn.dividedBy=Vn.div=function(e){return Gd(this,new this.constructor(e))};Vn.dividedToIntegerBy=Vn.idiv=function(e){var t=this,a=t.constructor;return Vi(Gd(t,new a(e),0,1),a.precision)};Vn.equals=Vn.eq=function(e){return!this.cmp(e)};Vn.exponent=function(){return lo(this)};Vn.greaterThan=Vn.gt=function(e){return this.cmp(e)>0};Vn.greaterThanOrEqualTo=Vn.gte=function(e){return this.cmp(e)>=0};Vn.isInteger=Vn.isint=function(){return this.e>this.d.length-2};Vn.isNegative=Vn.isneg=function(){return this.s<0};Vn.isPositive=Vn.ispos=function(){return this.s>0};Vn.isZero=function(){return this.s===0};Vn.lessThan=Vn.lt=function(e){return this.cmp(e)<0};Vn.lessThanOrEqualTo=Vn.lte=function(e){return this.cmp(e)<1};Vn.logarithm=Vn.log=function(e){var t,a=this,o=a.constructor,h=o.precision,y=h+5;if(e===void 0)e=new o(10);else if(e=new o(e),e.s<1||e.eq(ic))throw Error(hu+"NaN");if(a.s<1)throw Error(hu+(a.s?"NaN":"-Infinity"));return a.eq(ic)?new o(0):(ua=!1,t=Gd($1(a,y),$1(e,y),y),ua=!0,Vi(t,h))};Vn.minus=Vn.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?IU(t,e):OU(t,(e.s=-e.s,e))};Vn.modulo=Vn.mod=function(e){var t,a=this,o=a.constructor,h=o.precision;if(e=new o(e),!e.s)throw Error(hu+"NaN");return a.s?(ua=!1,t=Gd(a,e,0,1).times(e),ua=!0,a.minus(t)):Vi(new o(a),h)};Vn.naturalExponential=Vn.exp=function(){return PU(this)};Vn.naturalLogarithm=Vn.ln=function(){return $1(this)};Vn.negated=Vn.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};Vn.plus=Vn.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?OU(t,e):IU(t,(e.s=-e.s,e))};Vn.precision=Vn.sd=function(e){var t,a,o,h=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(V0+e);if(t=lo(h)+1,o=h.d.length-1,a=o*na+1,o=h.d[o],o){for(;o%10==0;o/=10)a--;for(o=h.d[0];o>=10;o/=10)a++}return e&&t>a?t:a};Vn.squareRoot=Vn.sqrt=function(){var e,t,a,o,h,y,b,i=this,C=i.constructor;if(i.s<1){if(!i.s)return new C(0);throw Error(hu+"NaN")}for(e=lo(i),ua=!1,h=Math.sqrt(+i),h==0||h==1/0?(t=pf(i.d),(t.length+e)%2==0&&(t+="0"),h=Math.sqrt(t),e=xy((e+1)/2)-(e<0||e%2),h==1/0?t="5e"+e:(t=h.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),o=new C(t)):o=new C(h.toString()),a=C.precision,h=b=a+3;;)if(y=o,o=y.plus(Gd(i,y,b+2)).times(.5),pf(y.d).slice(0,b)===(t=pf(o.d)).slice(0,b)){if(t=t.slice(b-3,b+1),h==b&&t=="4999"){if(Vi(y,a+1,0),y.times(y).eq(i)){o=y;break}}else if(t!="9999")break;b+=4}return ua=!0,Vi(o,a)};Vn.times=Vn.mul=function(e){var t,a,o,h,y,b,i,C,I,j=this,F=j.constructor,G=j.d,X=(e=new F(e)).d;if(!j.s||!e.s)return new F(0);for(e.s*=j.s,a=j.e+e.e,C=G.length,I=X.length,C<I&&(y=G,G=X,X=y,b=C,C=I,I=b),y=[],b=C+I,o=b;o--;)y.push(0);for(o=I;--o>=0;){for(t=0,h=C+o;h>o;)i=y[h]+X[o]*G[h-o-1]+t,y[h--]=i%Lo|0,t=i/Lo|0;y[h]=(y[h]+t)%Lo|0}for(;!y[--b];)y.pop();return t?++a:y.shift(),e.d=y,e.e=a,ua?Vi(e,F.precision):e};Vn.toDecimalPlaces=Vn.todp=function(e,t){var a=this,o=a.constructor;return a=new o(a),e===void 0?a:(xf(e,0,vy),t===void 0?t=o.rounding:xf(t,0,8),Vi(a,e+lo(a)+1,t))};Vn.toExponential=function(e,t){var a,o=this,h=o.constructor;return e===void 0?a=H0(o,!0):(xf(e,0,vy),t===void 0?t=h.rounding:xf(t,0,8),o=Vi(new h(o),e+1,t),a=H0(o,!0,e+1)),a};Vn.toFixed=function(e,t){var a,o,h=this,y=h.constructor;return e===void 0?H0(h):(xf(e,0,vy),t===void 0?t=y.rounding:xf(t,0,8),o=Vi(new y(h),e+lo(h)+1,t),a=H0(o.abs(),!1,e+lo(o)+1),h.isneg()&&!h.isZero()?"-"+a:a)};Vn.toInteger=Vn.toint=function(){var e=this,t=e.constructor;return Vi(new t(e),lo(e)+1,t.rounding)};Vn.toNumber=function(){return+this};Vn.toPower=Vn.pow=function(e){var t,a,o,h,y,b,i=this,C=i.constructor,I=12,j=+(e=new C(e));if(!e.s)return new C(ic);if(i=new C(i),!i.s){if(e.s<1)throw Error(hu+"Infinity");return i}if(i.eq(ic))return i;if(o=C.precision,e.eq(ic))return Vi(i,o);if(t=e.e,a=e.d.length-1,b=t>=a,y=i.s,b){if((a=j<0?-j:j)<=MU){for(h=new C(ic),t=Math.ceil(o/na+4),ua=!1;a%2&&(h=h.times(i),h8(h.d,t)),a=xy(a/2),a!==0;)i=i.times(i),h8(i.d,t);return ua=!0,e.s<0?new C(ic).div(h):Vi(h,o)}}else if(y<0)throw Error(hu+"NaN");return y=y<0&&e.d[Math.max(t,a)]&1?-1:1,i.s=1,ua=!1,h=e.times($1(i,o+I)),ua=!0,h=PU(h),h.s=y,h};Vn.toPrecision=function(e,t){var a,o,h=this,y=h.constructor;return e===void 0?(a=lo(h),o=H0(h,a<=y.toExpNeg||a>=y.toExpPos)):(xf(e,1,vy),t===void 0?t=y.rounding:xf(t,0,8),h=Vi(new y(h),e,t),a=lo(h),o=H0(h,e<=a||a<=y.toExpNeg,e)),o};Vn.toSignificantDigits=Vn.tosd=function(e,t){var a=this,o=a.constructor;return e===void 0?(e=o.precision,t=o.rounding):(xf(e,1,vy),t===void 0?t=o.rounding:xf(t,0,8)),Vi(new o(a),e,t)};Vn.toString=Vn.valueOf=Vn.val=Vn.toJSON=Vn[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=lo(e),a=e.constructor;return H0(e,t<=a.toExpNeg||t>=a.toExpPos)};function OU(e,t){var a,o,h,y,b,i,C,I,j=e.constructor,F=j.precision;if(!e.s||!t.s)return t.s||(t=new j(e)),ua?Vi(t,F):t;if(C=e.d,I=t.d,b=e.e,h=t.e,C=C.slice(),y=b-h,y){for(y<0?(o=C,y=-y,i=I.length):(o=I,h=b,i=C.length),b=Math.ceil(F/na),i=b>i?b+1:i+1,y>i&&(y=i,o.length=1),o.reverse();y--;)o.push(0);o.reverse()}for(i=C.length,y=I.length,i-y<0&&(y=i,o=I,I=C,C=o),a=0;y;)a=(C[--y]=C[y]+I[y]+a)/Lo|0,C[y]%=Lo;for(a&&(C.unshift(a),++h),i=C.length;C[--i]==0;)C.pop();return t.d=C,t.e=h,ua?Vi(t,F):t}function xf(e,t,a){if(e!==~~e||e<t||e>a)throw Error(V0+e)}function pf(e){var t,a,o,h=e.length-1,y="",b=e[0];if(h>0){for(y+=b,t=1;t<h;t++)o=e[t]+"",a=na-o.length,a&&(y+=lm(a)),y+=o;b=e[t],o=b+"",a=na-o.length,a&&(y+=lm(a))}else if(b===0)return"0";for(;b%10===0;)b/=10;return y+b}var Gd=function(){function e(o,h){var y,b=0,i=o.length;for(o=o.slice();i--;)y=o[i]*h+b,o[i]=y%Lo|0,b=y/Lo|0;return b&&o.unshift(b),o}function t(o,h,y,b){var i,C;if(y!=b)C=y>b?1:-1;else for(i=C=0;i<y;i++)if(o[i]!=h[i]){C=o[i]>h[i]?1:-1;break}return C}function a(o,h,y){for(var b=0;y--;)o[y]-=b,b=o[y]<h[y]?1:0,o[y]=b*Lo+o[y]-h[y];for(;!o[0]&&o.length>1;)o.shift()}return function(o,h,y,b){var i,C,I,j,F,G,X,Y,J,ee,oe,ge,fe,xe,ae,me,we,Ge,He=o.constructor,ye=o.s==h.s?1:-1,ke=o.d,dt=h.d;if(!o.s)return new He(o);if(!h.s)throw Error(hu+"Division by zero");for(C=o.e-h.e,we=dt.length,ae=ke.length,X=new He(ye),Y=X.d=[],I=0;dt[I]==(ke[I]||0);)++I;if(dt[I]>(ke[I]||0)&&--C,y==null?ge=y=He.precision:b?ge=y+(lo(o)-lo(h))+1:ge=y,ge<0)return new He(0);if(ge=ge/na+2|0,I=0,we==1)for(j=0,dt=dt[0],ge++;(I<ae||j)&&ge--;I++)fe=j*Lo+(ke[I]||0),Y[I]=fe/dt|0,j=fe%dt|0;else{for(j=Lo/(dt[0]+1)|0,j>1&&(dt=e(dt,j),ke=e(ke,j),we=dt.length,ae=ke.length),xe=we,J=ke.slice(0,we),ee=J.length;ee<we;)J[ee++]=0;Ge=dt.slice(),Ge.unshift(0),me=dt[0],dt[1]>=Lo/2&&++me;do j=0,i=t(dt,J,we,ee),i<0?(oe=J[0],we!=ee&&(oe=oe*Lo+(J[1]||0)),j=oe/me|0,j>1?(j>=Lo&&(j=Lo-1),F=e(dt,j),G=F.length,ee=J.length,i=t(F,J,G,ee),i==1&&(j--,a(F,we<G?Ge:dt,G))):(j==0&&(i=j=1),F=dt.slice()),G=F.length,G<ee&&F.unshift(0),a(J,F,ee),i==-1&&(ee=J.length,i=t(dt,J,we,ee),i<1&&(j++,a(J,we<ee?Ge:dt,ee))),ee=J.length):i===0&&(j++,J=[0]),Y[I++]=j,i&&J[0]?J[ee++]=ke[xe]||0:(J=[ke[xe]],ee=1);while((xe++<ae||J[0]!==void 0)&&ge--)}return Y[0]||Y.shift(),X.e=C,Vi(X,b?y+lo(X)+1:y)}}();function PU(e,t){var a,o,h,y,b,i,C=0,I=0,j=e.constructor,F=j.precision;if(lo(e)>16)throw Error(_P+lo(e));if(!e.s)return new j(ic);for(ua=!1,i=F,b=new j(.03125);e.abs().gte(.1);)e=e.times(b),I+=5;for(o=Math.log(k0(2,I))/Math.LN10*2+5|0,i+=o,a=h=y=new j(ic),j.precision=i;;){if(h=Vi(h.times(e),i),a=a.times(++C),b=y.plus(Gd(h,a,i)),pf(b.d).slice(0,i)===pf(y.d).slice(0,i)){for(;I--;)y=Vi(y.times(y),i);return j.precision=F,t==null?(ua=!0,Vi(y,F)):y}y=b}}function lo(e){for(var t=e.e*na,a=e.d[0];a>=10;a/=10)t++;return t}function oM(e,t,a){if(t>e.LN10.sd())throw ua=!0,a&&(e.precision=a),Error(hu+"LN10 precision limit exceeded");return Vi(new e(e.LN10),t)}function lm(e){for(var t="";e--;)t+="0";return t}function $1(e,t){var a,o,h,y,b,i,C,I,j,F=1,G=10,X=e,Y=X.d,J=X.constructor,ee=J.precision;if(X.s<1)throw Error(hu+(X.s?"NaN":"-Infinity"));if(X.eq(ic))return new J(0);if(t==null?(ua=!1,I=ee):I=t,X.eq(10))return t==null&&(ua=!0),oM(J,I);if(I+=G,J.precision=I,a=pf(Y),o=a.charAt(0),y=lo(X),Math.abs(y)<15e14){for(;o<7&&o!=1||o==1&&a.charAt(1)>3;)X=X.times(e),a=pf(X.d),o=a.charAt(0),F++;y=lo(X),o>1?(X=new J("0."+a),y++):X=new J(o+"."+a.slice(1))}else return C=oM(J,I+2,ee).times(y+""),X=$1(new J(o+"."+a.slice(1)),I-G).plus(C),J.precision=ee,t==null?(ua=!0,Vi(X,ee)):X;for(i=b=X=Gd(X.minus(ic),X.plus(ic),I),j=Vi(X.times(X),I),h=3;;){if(b=Vi(b.times(j),I),C=i.plus(Gd(b,new J(h),I)),pf(C.d).slice(0,I)===pf(i.d).slice(0,I))return i=i.times(2),y!==0&&(i=i.plus(oM(J,I+2,ee).times(y+""))),i=Gd(i,new J(F),I),J.precision=ee,t==null?(ua=!0,Vi(i,ee)):i;i=C,h+=2}}function u8(e,t){var a,o,h;for((a=t.indexOf("."))>-1&&(t=t.replace(".","")),(o=t.search(/e/i))>0?(a<0&&(a=o),a+=+t.slice(o+1),t=t.substring(0,o)):a<0&&(a=t.length),o=0;t.charCodeAt(o)===48;)++o;for(h=t.length;t.charCodeAt(h-1)===48;)--h;if(t=t.slice(o,h),t){if(h-=o,a=a-o-1,e.e=xy(a/na),e.d=[],o=(a+1)%na,a<0&&(o+=na),o<h){for(o&&e.d.push(+t.slice(0,o)),h-=na;o<h;)e.d.push(+t.slice(o,o+=na));t=t.slice(o),o=na-t.length}else o-=h;for(;o--;)t+="0";if(e.d.push(+t),ua&&(e.e>ow||e.e<-ow))throw Error(_P+a)}else e.s=0,e.e=0,e.d=[0];return e}function Vi(e,t,a){var o,h,y,b,i,C,I,j,F=e.d;for(b=1,y=F[0];y>=10;y/=10)b++;if(o=t-b,o<0)o+=na,h=t,I=F[j=0];else{if(j=Math.ceil((o+1)/na),y=F.length,j>=y)return e;for(I=y=F[j],b=1;y>=10;y/=10)b++;o%=na,h=o-na+b}if(a!==void 0&&(y=k0(10,b-h-1),i=I/y%10|0,C=t<0||F[j+1]!==void 0||I%y,C=a<4?(i||C)&&(a==0||a==(e.s<0?3:2)):i>5||i==5&&(a==4||C||a==6&&(o>0?h>0?I/k0(10,b-h):0:F[j-1])%10&1||a==(e.s<0?8:7))),t<1||!F[0])return C?(y=lo(e),F.length=1,t=t-y-1,F[0]=k0(10,(na-t%na)%na),e.e=xy(-t/na)||0):(F.length=1,F[0]=e.e=e.s=0),e;if(o==0?(F.length=j,y=1,j--):(F.length=j+1,y=k0(10,na-o),F[j]=h>0?(I/k0(10,b-h)%k0(10,h)|0)*y:0),C)for(;;)if(j==0){(F[0]+=y)==Lo&&(F[0]=1,++e.e);break}else{if(F[j]+=y,F[j]!=Lo)break;F[j--]=0,y=1}for(o=F.length;F[--o]===0;)F.pop();if(ua&&(e.e>ow||e.e<-ow))throw Error(_P+lo(e));return e}function IU(e,t){var a,o,h,y,b,i,C,I,j,F,G=e.constructor,X=G.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new G(e),ua?Vi(t,X):t;if(C=e.d,F=t.d,o=t.e,I=e.e,C=C.slice(),b=I-o,b){for(j=b<0,j?(a=C,b=-b,i=F.length):(a=F,o=I,i=C.length),h=Math.max(Math.ceil(X/na),i)+2,b>h&&(b=h,a.length=1),a.reverse(),h=b;h--;)a.push(0);a.reverse()}else{for(h=C.length,i=F.length,j=h<i,j&&(i=h),h=0;h<i;h++)if(C[h]!=F[h]){j=C[h]<F[h];break}b=0}for(j&&(a=C,C=F,F=a,t.s=-t.s),i=C.length,h=F.length-i;h>0;--h)C[i++]=0;for(h=F.length;h>b;){if(C[--h]<F[h]){for(y=h;y&&C[--y]===0;)C[y]=Lo-1;--C[y],C[h]+=Lo}C[h]-=F[h]}for(;C[--i]===0;)C.pop();for(;C[0]===0;C.shift())--o;return C[0]?(t.d=C,t.e=o,ua?Vi(t,X):t):new G(0)}function H0(e,t,a){var o,h=lo(e),y=pf(e.d),b=y.length;return t?(a&&(o=a-b)>0?y=y.charAt(0)+"."+y.slice(1)+lm(o):b>1&&(y=y.charAt(0)+"."+y.slice(1)),y=y+(h<0?"e":"e+")+h):h<0?(y="0."+lm(-h-1)+y,a&&(o=a-b)>0&&(y+=lm(o))):h>=b?(y+=lm(h+1-b),a&&(o=a-h-1)>0&&(y=y+"."+lm(o))):((o=h+1)<b&&(y=y.slice(0,o)+"."+y.slice(o)),a&&(o=a-b)>0&&(h+1===b&&(y+="."),y+=lm(o))),e.s<0?"-"+y:y}function h8(e,t){if(e.length>t)return e.length=t,!0}function RU(e){var t,a,o;function h(y){var b=this;if(!(b instanceof h))return new h(y);if(b.constructor=h,y instanceof h){b.s=y.s,b.e=y.e,b.d=(y=y.d)?y.slice():y;return}if(typeof y=="number"){if(y*0!==0)throw Error(V0+y);if(y>0)b.s=1;else if(y<0)y=-y,b.s=-1;else{b.s=0,b.e=0,b.d=[0];return}if(y===~~y&&y<1e7){b.e=0,b.d=[y];return}return u8(b,y.toString())}else if(typeof y!="string")throw Error(V0+y);if(y.charCodeAt(0)===45?(y=y.slice(1),b.s=-1):b.s=1,Ahe.test(y))u8(b,y);else throw Error(V0+y)}if(h.prototype=Vn,h.ROUND_UP=0,h.ROUND_DOWN=1,h.ROUND_CEIL=2,h.ROUND_FLOOR=3,h.ROUND_HALF_UP=4,h.ROUND_HALF_DOWN=5,h.ROUND_HALF_EVEN=6,h.ROUND_HALF_CEIL=7,h.ROUND_HALF_FLOOR=8,h.clone=RU,h.config=h.set=Che,e===void 0&&(e={}),e)for(o=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<o.length;)e.hasOwnProperty(a=o[t++])||(e[a]=this[a]);return h.config(e),h}function Che(e){if(!e||typeof e!="object")throw Error(hu+"Object expected");var t,a,o,h=["precision",1,vy,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<h.length;t+=3)if((o=e[a=h[t]])!==void 0)if(xy(o)===o&&o>=h[t+1]&&o<=h[t+2])this[a]=o;else throw Error(V0+a+": "+o);if((o=e[a="LN10"])!==void 0)if(o==Math.LN10)this[a]=new this(o);else throw Error(V0+a+": "+o);return this}var gP=RU(Ehe);ic=new gP(1);const ki=gP;function Mhe(e){return Rhe(e)||Ihe(e)||Phe(e)||Ohe()}function Ohe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Phe(e,t){if(e){if(typeof e=="string")return G5(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return G5(e,t)}}function Ihe(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function Rhe(e){if(Array.isArray(e))return G5(e)}function G5(e,t){(t==null||t>e.length)&&(t=e.length);for(var a=0,o=new Array(t);a<t;a++)o[a]=e[a];return o}var Dhe=function(t){return t},DU={},LU=function(t){return t===DU},f8=function(t){return function a(){return arguments.length===0||arguments.length===1&&LU(arguments.length<=0?void 0:arguments[0])?a:t.apply(void 0,arguments)}},Lhe=function e(t,a){return t===1?a:f8(function(){for(var o=arguments.length,h=new Array(o),y=0;y<o;y++)h[y]=arguments[y];var b=h.filter(function(i){return i!==DU}).length;return b>=t?a.apply(void 0,h):e(t-b,f8(function(){for(var i=arguments.length,C=new Array(i),I=0;I<i;I++)C[I]=arguments[I];var j=h.map(function(F){return LU(F)?C.shift():F});return a.apply(void 0,Mhe(j).concat(C))}))})},SS=function(t){return Lhe(t.length,t)},H5=function(t,a){for(var o=[],h=t;h<a;++h)o[h-t]=h;return o},khe=SS(function(e,t){return Array.isArray(t)?t.map(e):Object.keys(t).map(function(a){return t[a]}).map(e)}),zhe=function(){for(var t=arguments.length,a=new Array(t),o=0;o<t;o++)a[o]=arguments[o];if(!a.length)return Dhe;var h=a.reverse(),y=h[0],b=h.slice(1);return function(){return b.reduce(function(i,C){return C(i)},y.apply(void 0,arguments))}},Z5=function(t){return Array.isArray(t)?t.reverse():t.split("").reverse.join("")},kU=function(t){var a=null,o=null;return function(){for(var h=arguments.length,y=new Array(h),b=0;b<h;b++)y[b]=arguments[b];return a&&y.every(function(i,C){return i===a[C]})||(a=y,o=t.apply(void 0,y)),o}};function Bhe(e){var t;return e===0?t=1:t=Math.floor(new ki(e).abs().log(10).toNumber())+1,t}function Nhe(e,t,a){for(var o=new ki(e),h=0,y=[];o.lt(t)&&h<1e5;)y.push(o.toNumber()),o=o.add(a),h++;return y}var Fhe=SS(function(e,t,a){var o=+e,h=+t;return o+a*(h-o)}),jhe=SS(function(e,t,a){var o=t-+e;return o=o||1/0,(a-e)/o}),Uhe=SS(function(e,t,a){var o=t-+e;return o=o||1/0,Math.max(0,Math.min(1,(a-e)/o))});const TS={rangeStep:Nhe,getDigitCount:Bhe,interpolateNumber:Fhe,uninterpolateNumber:jhe,uninterpolateTruncation:Uhe};function W5(e){return qhe(e)||$he(e)||zU(e)||Vhe()}function Vhe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $he(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function qhe(e){if(Array.isArray(e))return X5(e)}function q1(e,t){return Zhe(e)||Hhe(e,t)||zU(e,t)||Ghe()}function Ghe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zU(e,t){if(e){if(typeof e=="string")return X5(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return X5(e,t)}}function X5(e,t){(t==null||t>e.length)&&(t=e.length);for(var a=0,o=new Array(t);a<t;a++)o[a]=e[a];return o}function Hhe(e,t){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(e)))){var a=[],o=!0,h=!1,y=void 0;try{for(var b=e[Symbol.iterator](),i;!(o=(i=b.next()).done)&&(a.push(i.value),!(t&&a.length===t));o=!0);}catch(C){h=!0,y=C}finally{try{!o&&b.return!=null&&b.return()}finally{if(h)throw y}}return a}}function Zhe(e){if(Array.isArray(e))return e}function BU(e){var t=q1(e,2),a=t[0],o=t[1],h=a,y=o;return a>o&&(h=o,y=a),[h,y]}function NU(e,t,a){if(e.lte(0))return new ki(0);var o=TS.getDigitCount(e.toNumber()),h=new ki(10).pow(o),y=e.div(h),b=o!==1?.05:.1,i=new ki(Math.ceil(y.div(b).toNumber())).add(a).mul(b),C=i.mul(h);return t?C:new ki(Math.ceil(C))}function Whe(e,t,a){var o=1,h=new ki(e);if(!h.isint()&&a){var y=Math.abs(e);y<1?(o=new ki(10).pow(TS.getDigitCount(e)-1),h=new ki(Math.floor(h.div(o).toNumber())).mul(o)):y>1&&(h=new ki(Math.floor(e)))}else e===0?h=new ki(Math.floor((t-1)/2)):a||(h=new ki(Math.floor(e)));var b=Math.floor((t-1)/2),i=zhe(khe(function(C){return h.add(new ki(C-b).mul(o)).toNumber()}),H5);return i(0,t)}function FU(e,t,a,o){var h=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((t-e)/(a-1)))return{step:new ki(0),tickMin:new ki(0),tickMax:new ki(0)};var y=NU(new ki(t).sub(e).div(a-1),o,h),b;e<=0&&t>=0?b=new ki(0):(b=new ki(e).add(t).div(2),b=b.sub(new ki(b).mod(y)));var i=Math.ceil(b.sub(e).div(y).toNumber()),C=Math.ceil(new ki(t).sub(b).div(y).toNumber()),I=i+C+1;return I>a?FU(e,t,a,o,h+1):(I<a&&(C=t>0?C+(a-I):C,i=t>0?i:i+(a-I)),{step:y,tickMin:b.sub(new ki(i).mul(y)),tickMax:b.add(new ki(C).mul(y))})}function Xhe(e){var t=q1(e,2),a=t[0],o=t[1],h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,b=Math.max(h,2),i=BU([a,o]),C=q1(i,2),I=C[0],j=C[1];if(I===-1/0||j===1/0){var F=j===1/0?[I].concat(W5(H5(0,h-1).map(function(){return 1/0}))):[].concat(W5(H5(0,h-1).map(function(){return-1/0})),[j]);return a>o?Z5(F):F}if(I===j)return Whe(I,h,y);var G=FU(I,j,b,y),X=G.step,Y=G.tickMin,J=G.tickMax,ee=TS.rangeStep(Y,J.add(new ki(.1).mul(X)),X);return a>o?Z5(ee):ee}function Yhe(e,t){var a=q1(e,2),o=a[0],h=a[1],y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,b=BU([o,h]),i=q1(b,2),C=i[0],I=i[1];if(C===-1/0||I===1/0)return[o,h];if(C===I)return[C];var j=Math.max(t,2),F=NU(new ki(I).sub(C).div(j-1),y,0),G=[].concat(W5(TS.rangeStep(new ki(C),new ki(I).sub(new ki(.99).mul(F)),F)),[I]);return o>h?Z5(G):G}var Khe=kU(Xhe),Jhe=kU(Yhe),Qhe="Invariant failed";function Yg(e,t){throw new Error(Qhe)}var efe=["offset","layout","width","dataKey","data","dataPointFormatter","xAxis","yAxis"];function Kg(e){"@babel/helpers - typeof";return Kg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kg(e)}function sw(){return sw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},sw.apply(this,arguments)}function tfe(e,t){return afe(e)||ife(e,t)||rfe(e,t)||nfe()}function nfe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function rfe(e,t){if(e){if(typeof e=="string")return d8(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return d8(e,t)}}function d8(e,t){(t==null||t>e.length)&&(t=e.length);for(var a=0,o=new Array(t);a<t;a++)o[a]=e[a];return o}function ife(e,t){var a=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(a!=null){var o,h,y,b,i=[],C=!0,I=!1;try{if(y=(a=a.call(e)).next,t!==0)for(;!(C=(o=y.call(a)).done)&&(i.push(o.value),i.length!==t);C=!0);}catch(j){I=!0,h=j}finally{try{if(!C&&a.return!=null&&(b=a.return(),Object(b)!==b))return}finally{if(I)throw h}}return i}}function afe(e){if(Array.isArray(e))return e}function ofe(e,t){if(e==null)return{};var a=sfe(e,t),o,h;if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(e);for(h=0;h<y.length;h++)o=y[h],!(t.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(a[o]=e[o])}return a}function sfe(e,t){if(e==null)return{};var a={};for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){if(t.indexOf(o)>=0)continue;a[o]=e[o]}return a}function lfe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function cfe(e,t){for(var a=0;a<t.length;a++){var o=t[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,VU(o.key),o)}}function ufe(e,t,a){return t&&cfe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function hfe(e,t,a){return t=lw(t),ffe(e,jU()?Reflect.construct(t,a||[],lw(e).constructor):t.apply(e,a))}function ffe(e,t){if(t&&(Kg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return dfe(e)}function dfe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function jU(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(jU=function(){return!!e})()}function lw(e){return lw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)},lw(e)}function pfe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Y5(e,t)}function Y5(e,t){return Y5=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,h){return o.__proto__=h,o},Y5(e,t)}function UU(e,t,a){return t=VU(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function VU(e){var t=mfe(e,"string");return Kg(t)=="symbol"?t:t+""}function mfe(e,t){if(Kg(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t);if(Kg(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var yP=function(e){function t(){return lfe(this,t),hfe(this,t,arguments)}return pfe(t,e),ufe(t,[{key:"render",value:function(){var o=this.props,h=o.offset,y=o.layout,b=o.width,i=o.dataKey,C=o.data,I=o.dataPointFormatter,j=o.xAxis,F=o.yAxis,G=ofe(o,efe),X=Fr(G,!1);this.props.direction==="x"&&j.type!=="number"&&Yg();var Y=C.map(function(J){var ee=I(J,i),oe=ee.x,ge=ee.y,fe=ee.value,xe=ee.errorVal;if(!xe)return null;var ae=[],me,we;if(Array.isArray(xe)){var Ge=tfe(xe,2);me=Ge[0],we=Ge[1]}else me=we=xe;if(y==="vertical"){var He=j.scale,ye=ge+h,ke=ye+b,dt=ye-b,vt=He(fe-me),jt=He(fe+we);ae.push({x1:jt,y1:ke,x2:jt,y2:dt}),ae.push({x1:vt,y1:ye,x2:jt,y2:ye}),ae.push({x1:vt,y1:ke,x2:vt,y2:dt})}else if(y==="horizontal"){var _t=F.scale,gt=oe+h,Vt=gt-b,Ht=gt+b,Bt=_t(fe-me),et=_t(fe+we);ae.push({x1:Vt,y1:et,x2:Ht,y2:et}),ae.push({x1:gt,y1:Bt,x2:gt,y2:et}),ae.push({x1:Vt,y1:Bt,x2:Ht,y2:Bt})}return Ot.createElement(Ga,sw({className:"recharts-errorBar",key:"bar-".concat(ae.map(function($t){return"".concat($t.x1,"-").concat($t.x2,"-").concat($t.y1,"-").concat($t.y2)}))},X),ae.map(function($t){return Ot.createElement("line",sw({},$t,{key:"line-".concat($t.x1,"-").concat($t.x2,"-").concat($t.y1,"-").concat($t.y2)}))}))});return Ot.createElement(Ga,{className:"recharts-errorBars"},Y)}}])}(Ot.Component);UU(yP,"defaultProps",{stroke:"black",strokeWidth:1.5,width:5,offset:0,layout:"horizontal"});UU(yP,"displayName","ErrorBar");function G1(e){"@babel/helpers - typeof";return G1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},G1(e)}function p8(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(h){return Object.getOwnPropertyDescriptor(e,h).enumerable})),a.push.apply(a,o)}return a}function P0(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?p8(Object(a),!0).forEach(function(o){_fe(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):p8(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function _fe(e,t,a){return t=gfe(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function gfe(e){var t=yfe(e,"string");return G1(t)=="symbol"?t:t+""}function yfe(e,t){if(G1(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t);if(G1(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var $U=function(t){var a=t.children,o=t.formattedGraphicalItems,h=t.legendWidth,y=t.legendContent,b=au(a,Rg);if(!b)return null;var i=Rg.defaultProps,C=i!==void 0?P0(P0({},i),b.props):{},I;return b.props&&b.props.payload?I=b.props&&b.props.payload:y==="children"?I=(o||[]).reduce(function(j,F){var G=F.item,X=F.props,Y=X.sectors||X.data||[];return j.concat(Y.map(function(J){return{type:b.props.iconType||G.props.legendType,value:J.name,color:J.fill,payload:J}}))},[]):I=(o||[]).map(function(j){var F=j.item,G=F.type.defaultProps,X=G!==void 0?P0(P0({},G),F.props):{},Y=X.dataKey,J=X.name,ee=X.legendType,oe=X.hide;return{inactive:oe,dataKey:Y,type:C.iconType||ee||"square",color:vP(F),value:J||Y,payload:X}}),P0(P0(P0({},C),Rg.getWithHeight(b,h)),{},{payload:I,item:b})};function H1(e){"@babel/helpers - typeof";return H1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},H1(e)}function m8(e){return wfe(e)||bfe(e)||xfe(e)||vfe()}function vfe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function xfe(e,t){if(e){if(typeof e=="string")return K5(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return K5(e,t)}}function bfe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function wfe(e){if(Array.isArray(e))return K5(e)}function K5(e,t){(t==null||t>e.length)&&(t=e.length);for(var a=0,o=new Array(t);a<t;a++)o[a]=e[a];return o}function _8(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(h){return Object.getOwnPropertyDescriptor(e,h).enumerable})),a.push.apply(a,o)}return a}function qa(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?_8(Object(a),!0).forEach(function(o){Lg(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):_8(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function Lg(e,t,a){return t=Sfe(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Sfe(e){var t=Tfe(e,"string");return H1(t)=="symbol"?t:t+""}function Tfe(e,t){if(H1(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t);if(H1(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ac(e,t,a){return ei(e)||ei(t)?a:bo(t)?ah(e,t,a):Vr(t)?t(e):a}function p1(e,t,a,o){var h=whe(e,function(i){return ac(i,t)});if(a==="number"){var y=h.filter(function(i){return Nn(i)||parseFloat(i)});return y.length?[wS(y),bS(y)]:[1/0,-1/0]}var b=o?h.filter(function(i){return!ei(i)}):h;return b.map(function(i){return bo(i)||i instanceof Date?i:""})}var Efe=function(t){var a,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],h=arguments.length>2?arguments[2]:void 0,y=arguments.length>3?arguments[3]:void 0,b=-1,i=(a=o==null?void 0:o.length)!==null&&a!==void 0?a:0;if(i<=1)return 0;if(y&&y.axisType==="angleAxis"&&Math.abs(Math.abs(y.range[1]-y.range[0])-360)<=1e-6)for(var C=y.range,I=0;I<i;I++){var j=I>0?h[I-1].coordinate:h[i-1].coordinate,F=h[I].coordinate,G=I>=i-1?h[0].coordinate:h[I+1].coordinate,X=void 0;if(lu(F-j)!==lu(G-F)){var Y=[];if(lu(G-F)===lu(C[1]-C[0])){X=G;var J=F+C[1]-C[0];Y[0]=Math.min(J,(J+j)/2),Y[1]=Math.max(J,(J+j)/2)}else{X=j;var ee=G+C[1]-C[0];Y[0]=Math.min(F,(ee+F)/2),Y[1]=Math.max(F,(ee+F)/2)}var oe=[Math.min(F,(X+F)/2),Math.max(F,(X+F)/2)];if(t>oe[0]&&t<=oe[1]||t>=Y[0]&&t<=Y[1]){b=h[I].index;break}}else{var ge=Math.min(j,G),fe=Math.max(j,G);if(t>(ge+F)/2&&t<=(fe+F)/2){b=h[I].index;break}}}else for(var xe=0;xe<i;xe++)if(xe===0&&t<=(o[xe].coordinate+o[xe+1].coordinate)/2||xe>0&&xe<i-1&&t>(o[xe].coordinate+o[xe-1].coordinate)/2&&t<=(o[xe].coordinate+o[xe+1].coordinate)/2||xe===i-1&&t>(o[xe].coordinate+o[xe-1].coordinate)/2){b=o[xe].index;break}return b},vP=function(t){var a,o=t,h=o.type.displayName,y=(a=t.type)!==null&&a!==void 0&&a.defaultProps?qa(qa({},t.type.defaultProps),t.props):t.props,b=y.stroke,i=y.fill,C;switch(h){case"Line":C=b;break;case"Area":case"Radar":C=b&&b!=="none"?b:i;break;default:C=i;break}return C},Afe=function(t){var a=t.barSize,o=t.totalSize,h=t.stackGroups,y=h===void 0?{}:h;if(!y)return{};for(var b={},i=Object.keys(y),C=0,I=i.length;C<I;C++)for(var j=y[i[C]].stackGroups,F=Object.keys(j),G=0,X=F.length;G<X;G++){var Y=j[F[G]],J=Y.items,ee=Y.cateAxisId,oe=J.filter(function(we){return $d(we.type).indexOf("Bar")>=0});if(oe&&oe.length){var ge=oe[0].type.defaultProps,fe=ge!==void 0?qa(qa({},ge),oe[0].props):oe[0].props,xe=fe.barSize,ae=fe[ee];b[ae]||(b[ae]=[]);var me=ei(xe)?a:xe;b[ae].push({item:oe[0],stackList:oe.slice(1),barSize:ei(me)?void 0:yl(me,o,0)})}}return b},Cfe=function(t){var a=t.barGap,o=t.barCategoryGap,h=t.bandSize,y=t.sizeList,b=y===void 0?[]:y,i=t.maxBarSize,C=b.length;if(C<1)return null;var I=yl(a,h,0,!0),j,F=[];if(b[0].barSize===+b[0].barSize){var G=!1,X=h/C,Y=b.reduce(function(xe,ae){return xe+ae.barSize||0},0);Y+=(C-1)*I,Y>=h&&(Y-=(C-1)*I,I=0),Y>=h&&X>0&&(G=!0,X*=.9,Y=C*X);var J=(h-Y)/2>>0,ee={offset:J-I,size:0};j=b.reduce(function(xe,ae){var me={item:ae.item,position:{offset:ee.offset+ee.size+I,size:G?X:ae.barSize}},we=[].concat(m8(xe),[me]);return ee=we[we.length-1].position,ae.stackList&&ae.stackList.length&&ae.stackList.forEach(function(Ge){we.push({item:Ge,position:ee})}),we},F)}else{var oe=yl(o,h,0,!0);h-2*oe-(C-1)*I<=0&&(I=0);var ge=(h-2*oe-(C-1)*I)/C;ge>1&&(ge>>=0);var fe=i===+i?Math.min(ge,i):ge;j=b.reduce(function(xe,ae,me){var we=[].concat(m8(xe),[{item:ae.item,position:{offset:oe+(ge+I)*me+(ge-fe)/2,size:fe}}]);return ae.stackList&&ae.stackList.length&&ae.stackList.forEach(function(Ge){we.push({item:Ge,position:we[we.length-1].position})}),we},F)}return j},Mfe=function(t,a,o,h){var y=o.children,b=o.width,i=o.margin,C=b-(i.left||0)-(i.right||0),I=$U({children:y,legendWidth:C});if(I){var j=h||{},F=j.width,G=j.height,X=I.align,Y=I.verticalAlign,J=I.layout;if((J==="vertical"||J==="horizontal"&&Y==="middle")&&X!=="center"&&Nn(t[X]))return qa(qa({},t),{},Lg({},X,t[X]+(F||0)));if((J==="horizontal"||J==="vertical"&&X==="center")&&Y!=="middle"&&Nn(t[Y]))return qa(qa({},t),{},Lg({},Y,t[Y]+(G||0)))}return t},Ofe=function(t,a,o){return ei(a)?!0:t==="horizontal"?a==="yAxis":t==="vertical"||o==="x"?a==="xAxis":o==="y"?a==="yAxis":!0},qU=function(t,a,o,h,y){var b=a.props.children,i=_f(b,yP).filter(function(I){return Ofe(h,y,I.props.direction)});if(i&&i.length){var C=i.map(function(I){return I.props.dataKey});return t.reduce(function(I,j){var F=ac(j,o);if(ei(F))return I;var G=Array.isArray(F)?[wS(F),bS(F)]:[F,F],X=C.reduce(function(Y,J){var ee=ac(j,J,0),oe=G[0]-Math.abs(Array.isArray(ee)?ee[0]:ee),ge=G[1]+Math.abs(Array.isArray(ee)?ee[1]:ee);return[Math.min(oe,Y[0]),Math.max(ge,Y[1])]},[1/0,-1/0]);return[Math.min(X[0],I[0]),Math.max(X[1],I[1])]},[1/0,-1/0])}return null},Pfe=function(t,a,o,h,y){var b=a.map(function(i){return qU(t,i,o,y,h)}).filter(function(i){return!ei(i)});return b&&b.length?b.reduce(function(i,C){return[Math.min(i[0],C[0]),Math.max(i[1],C[1])]},[1/0,-1/0]):null},GU=function(t,a,o,h,y){var b=a.map(function(C){var I=C.props.dataKey;return o==="number"&&I&&qU(t,C,I,h)||p1(t,I,o,y)});if(o==="number")return b.reduce(function(C,I){return[Math.min(C[0],I[0]),Math.max(C[1],I[1])]},[1/0,-1/0]);var i={};return b.reduce(function(C,I){for(var j=0,F=I.length;j<F;j++)i[I[j]]||(i[I[j]]=!0,C.push(I[j]));return C},[])},HU=function(t,a){return t==="horizontal"&&a==="xAxis"||t==="vertical"&&a==="yAxis"||t==="centric"&&a==="angleAxis"||t==="radial"&&a==="radiusAxis"},s1=function(t,a,o){if(!t)return null;var h=t.scale,y=t.duplicateDomain,b=t.type,i=t.range,C=t.realScaleType==="scaleBand"?h.bandwidth()/2:2,I=(a||o)&&b==="category"&&h.bandwidth?h.bandwidth()/C:0;if(I=t.axisType==="angleAxis"&&(i==null?void 0:i.length)>=2?lu(i[0]-i[1])*2*I:I,a&&(t.ticks||t.niceTicks)){var j=(t.ticks||t.niceTicks).map(function(F){var G=y?y.indexOf(F):F;return{coordinate:h(G)+I,value:F,offset:I}});return j.filter(function(F){return!S2(F.coordinate)})}return t.isCategorical&&t.categoricalDomain?t.categoricalDomain.map(function(F,G){return{coordinate:h(F)+I,value:F,index:G,offset:I}}):h.ticks&&!o?h.ticks(t.tickCount).map(function(F){return{coordinate:h(F)+I,value:F,offset:I}}):h.domain().map(function(F,G){return{coordinate:h(F)+I,value:y?y[F]:F,index:G,offset:I}})},sM=new WeakMap,cb=function(t,a){if(typeof a!="function")return t;sM.has(t)||sM.set(t,new WeakMap);var o=sM.get(t);if(o.has(a))return o.get(a);var h=function(){t.apply(void 0,arguments),a.apply(void 0,arguments)};return o.set(a,h),h},Ife=function(t,a,o){var h=t.scale,y=t.type,b=t.layout,i=t.axisType;if(h==="auto")return b==="radial"&&i==="radiusAxis"?{scale:N1(),realScaleType:"band"}:b==="radial"&&i==="angleAxis"?{scale:nw(),realScaleType:"linear"}:y==="category"&&a&&(a.indexOf("LineChart")>=0||a.indexOf("AreaChart")>=0||a.indexOf("ComposedChart")>=0)?{scale:d1(),realScaleType:"point"}:y==="category"?{scale:N1(),realScaleType:"band"}:{scale:nw(),realScaleType:"linear"};if(w2(h)){var C="scale".concat(oS(h));return{scale:(t8[C]||d1)(),realScaleType:t8[C]?C:"point"}}return Vr(h)?{scale:h}:{scale:d1(),realScaleType:"point"}},g8=1e-4,Rfe=function(t){var a=t.domain();if(!(!a||a.length<=2)){var o=a.length,h=t.range(),y=Math.min(h[0],h[1])-g8,b=Math.max(h[0],h[1])+g8,i=t(a[0]),C=t(a[o-1]);(i<y||i>b||C<y||C>b)&&t.domain([a[0],a[o-1]])}},Dfe=function(t){var a=t.length;if(!(a<=0))for(var o=0,h=t[0].length;o<h;++o)for(var y=0,b=0,i=0;i<a;++i){var C=S2(t[i][o][1])?t[i][o][0]:t[i][o][1];C>=0?(t[i][o][0]=y,t[i][o][1]=y+C,y=t[i][o][1]):(t[i][o][0]=b,t[i][o][1]=b+C,b=t[i][o][1])}},Lfe=function(t){var a=t.length;if(!(a<=0))for(var o=0,h=t[0].length;o<h;++o)for(var y=0,b=0;b<a;++b){var i=S2(t[b][o][1])?t[b][o][0]:t[b][o][1];i>=0?(t[b][o][0]=y,t[b][o][1]=y+i,y=t[b][o][1]):(t[b][o][0]=0,t[b][o][1]=0)}},kfe={sign:Dfe,expand:bae,none:Ug,silhouette:wae,wiggle:Sae,positive:Lfe},zfe=function(t,a,o){var h=a.map(function(i){return i.props.dataKey}),y=kfe[o],b=xae().keys(h).value(function(i,C){return+ac(i,C,0)}).order(C5).offset(y);return b(t)},Bfe=function(t,a,o,h,y,b){if(!t)return null;var i=b?a.reverse():a,C={},I=i.reduce(function(F,G){var X,Y=(X=G.type)!==null&&X!==void 0&&X.defaultProps?qa(qa({},G.type.defaultProps),G.props):G.props,J=Y.stackId,ee=Y.hide;if(ee)return F;var oe=Y[o],ge=F[oe]||{hasStack:!1,stackGroups:{}};if(bo(J)){var fe=ge.stackGroups[J]||{numericAxisId:o,cateAxisId:h,items:[]};fe.items.push(G),ge.hasStack=!0,ge.stackGroups[J]=fe}else ge.stackGroups[iS("_stackId_")]={numericAxisId:o,cateAxisId:h,items:[G]};return qa(qa({},F),{},Lg({},oe,ge))},C),j={};return Object.keys(I).reduce(function(F,G){var X=I[G];if(X.hasStack){var Y={};X.stackGroups=Object.keys(X.stackGroups).reduce(function(J,ee){var oe=X.stackGroups[ee];return qa(qa({},J),{},Lg({},ee,{numericAxisId:o,cateAxisId:h,items:oe.items,stackedData:zfe(t,oe.items,y)}))},Y)}return qa(qa({},F),{},Lg({},G,X))},j)},Nfe=function(t,a){var o=a.realScaleType,h=a.type,y=a.tickCount,b=a.originalDomain,i=a.allowDecimals,C=o||a.scale;if(C!=="auto"&&C!=="linear")return null;if(y&&h==="number"&&b&&(b[0]==="auto"||b[1]==="auto")){var I=t.domain();if(!I.length)return null;var j=Khe(I,y,i);return t.domain([wS(j),bS(j)]),{niceTicks:j}}if(y&&h==="number"){var F=t.domain(),G=Jhe(F,y,i);return{niceTicks:G}}return null},Ffe=function(t,a){var o,h=(o=t.type)!==null&&o!==void 0&&o.defaultProps?qa(qa({},t.type.defaultProps),t.props):t.props,y=h.stackId;if(bo(y)){var b=a[y];if(b){var i=b.items.indexOf(t);return i>=0?b.stackedData[i]:null}}return null},jfe=function(t){return t.reduce(function(a,o){return[wS(o.concat([a[0]]).filter(Nn)),bS(o.concat([a[1]]).filter(Nn))]},[1/0,-1/0])},ZU=function(t,a,o){return Object.keys(t).reduce(function(h,y){var b=t[y],i=b.stackedData,C=i.reduce(function(I,j){var F=jfe(j.slice(a,o+1));return[Math.min(I[0],F[0]),Math.max(I[1],F[1])]},[1/0,-1/0]);return[Math.min(C[0],h[0]),Math.max(C[1],h[1])]},[1/0,-1/0]).map(function(h){return h===1/0||h===-1/0?0:h})},y8=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,v8=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,J5=function(t,a,o){if(Vr(t))return t(a,o);if(!Array.isArray(t))return a;var h=[];if(Nn(t[0]))h[0]=o?t[0]:Math.min(t[0],a[0]);else if(y8.test(t[0])){var y=+y8.exec(t[0])[1];h[0]=a[0]-y}else Vr(t[0])?h[0]=t[0](a[0]):h[0]=a[0];if(Nn(t[1]))h[1]=o?t[1]:Math.max(t[1],a[1]);else if(v8.test(t[1])){var b=+v8.exec(t[1])[1];h[1]=a[1]+b}else Vr(t[1])?h[1]=t[1](a[1]):h[1]=a[1];return h},Q5=function(t,a,o){if(t&&t.scale&&t.scale.bandwidth){var h=t.scale.bandwidth();if(!o||h>0)return h}if(t&&a&&a.length>=2){for(var y=GO(a,function(F){return F.coordinate}),b=1/0,i=1,C=y.length;i<C;i++){var I=y[i],j=y[i-1];b=Math.min((I.coordinate||0)-(j.coordinate||0),b)}return b===1/0?0:b}return o?void 0:0},x8=function(t,a,o){return!t||!t.length||mP(t,ah(o,"type.defaultProps.domain"))?a:t},Ufe=function(t,a){var o=t.type.defaultProps?qa(qa({},t.type.defaultProps),t.props):t.props,h=o.dataKey,y=o.name,b=o.unit,i=o.formatter,C=o.tooltipType,I=o.chartType,j=o.hide;return qa(qa({},Fr(t,!1)),{},{dataKey:h,unit:b,formatter:i,name:y||h,color:vP(t),value:ac(a,h),type:C,payload:a,chartType:I,hide:j})};function Z1(e){"@babel/helpers - typeof";return Z1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Z1(e)}function b8(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(h){return Object.getOwnPropertyDescriptor(e,h).enumerable})),a.push.apply(a,o)}return a}function kd(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?b8(Object(a),!0).forEach(function(o){WU(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):b8(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function WU(e,t,a){return t=Vfe(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Vfe(e){var t=$fe(e,"string");return Z1(t)=="symbol"?t:t+""}function $fe(e,t){if(Z1(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t);if(Z1(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function qfe(e,t){return Wfe(e)||Zfe(e,t)||Hfe(e,t)||Gfe()}function Gfe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Hfe(e,t){if(e){if(typeof e=="string")return w8(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return w8(e,t)}}function w8(e,t){(t==null||t>e.length)&&(t=e.length);for(var a=0,o=new Array(t);a<t;a++)o[a]=e[a];return o}function Zfe(e,t){var a=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(a!=null){var o,h,y,b,i=[],C=!0,I=!1;try{if(y=(a=a.call(e)).next,t!==0)for(;!(C=(o=y.call(a)).done)&&(i.push(o.value),i.length!==t);C=!0);}catch(j){I=!0,h=j}finally{try{if(!C&&a.return!=null&&(b=a.return(),Object(b)!==b))return}finally{if(I)throw h}}return i}}function Wfe(e){if(Array.isArray(e))return e}var cw=Math.PI/180,Xfe=function(t){return t*180/Math.PI},Xi=function(t,a,o,h){return{x:t+Math.cos(-cw*h)*o,y:a+Math.sin(-cw*h)*o}},XU=function(t,a){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(t-(o.left||0)-(o.right||0)),Math.abs(a-(o.top||0)-(o.bottom||0)))/2},Yfe=function(t,a,o,h,y){var b=t.width,i=t.height,C=t.startAngle,I=t.endAngle,j=yl(t.cx,b,b/2),F=yl(t.cy,i,i/2),G=XU(b,i,o),X=yl(t.innerRadius,G,0),Y=yl(t.outerRadius,G,G*.8),J=Object.keys(a);return J.reduce(function(ee,oe){var ge=a[oe],fe=ge.domain,xe=ge.reversed,ae;if(ei(ge.range))h==="angleAxis"?ae=[C,I]:h==="radiusAxis"&&(ae=[X,Y]),xe&&(ae=[ae[1],ae[0]]);else{ae=ge.range;var me=ae,we=qfe(me,2);C=we[0],I=we[1]}var Ge=Ife(ge,y),He=Ge.realScaleType,ye=Ge.scale;ye.domain(fe).range(ae),Rfe(ye);var ke=Nfe(ye,kd(kd({},ge),{},{realScaleType:He})),dt=kd(kd(kd({},ge),ke),{},{range:ae,radius:Y,realScaleType:He,scale:ye,cx:j,cy:F,innerRadius:X,outerRadius:Y,startAngle:C,endAngle:I});return kd(kd({},ee),{},WU({},oe,dt))},{})},Kfe=function(t,a){var o=t.x,h=t.y,y=a.x,b=a.y;return Math.sqrt(Math.pow(o-y,2)+Math.pow(h-b,2))},Jfe=function(t,a){var o=t.x,h=t.y,y=a.cx,b=a.cy,i=Kfe({x:o,y:h},{x:y,y:b});if(i<=0)return{radius:i};var C=(o-y)/i,I=Math.acos(C);return h>b&&(I=2*Math.PI-I),{radius:i,angle:Xfe(I),angleInRadian:I}},Qfe=function(t){var a=t.startAngle,o=t.endAngle,h=Math.floor(a/360),y=Math.floor(o/360),b=Math.min(h,y);return{startAngle:a-b*360,endAngle:o-b*360}},ede=function(t,a){var o=a.startAngle,h=a.endAngle,y=Math.floor(o/360),b=Math.floor(h/360),i=Math.min(y,b);return t+i*360},S8=function(t,a){var o=t.x,h=t.y,y=Jfe({x:o,y:h},a),b=y.radius,i=y.angle,C=a.innerRadius,I=a.outerRadius;if(b<C||b>I)return!1;if(b===0)return!0;var j=Qfe(a),F=j.startAngle,G=j.endAngle,X=i,Y;if(F<=G){for(;X>G;)X-=360;for(;X<F;)X+=360;Y=X>=F&&X<=G}else{for(;X>F;)X-=360;for(;X<G;)X+=360;Y=X>=G&&X<=F}return Y?kd(kd({},a),{},{radius:b,angle:ede(X,a)}):null},YU=function(t){return!Ie.isValidElement(t)&&!Vr(t)&&typeof t!="boolean"?t.className:""};function W1(e){"@babel/helpers - typeof";return W1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},W1(e)}var tde=["offset"];function nde(e){return ode(e)||ade(e)||ide(e)||rde()}function rde(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ide(e,t){if(e){if(typeof e=="string")return e4(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return e4(e,t)}}function ade(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function ode(e){if(Array.isArray(e))return e4(e)}function e4(e,t){(t==null||t>e.length)&&(t=e.length);for(var a=0,o=new Array(t);a<t;a++)o[a]=e[a];return o}function sde(e,t){if(e==null)return{};var a=lde(e,t),o,h;if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(e);for(h=0;h<y.length;h++)o=y[h],!(t.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(a[o]=e[o])}return a}function lde(e,t){if(e==null)return{};var a={};for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){if(t.indexOf(o)>=0)continue;a[o]=e[o]}return a}function T8(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(h){return Object.getOwnPropertyDescriptor(e,h).enumerable})),a.push.apply(a,o)}return a}function xo(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?T8(Object(a),!0).forEach(function(o){cde(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):T8(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function cde(e,t,a){return t=ude(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function ude(e){var t=hde(e,"string");return W1(t)=="symbol"?t:t+""}function hde(e,t){if(W1(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t);if(W1(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function X1(){return X1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},X1.apply(this,arguments)}var fde=function(t){var a=t.value,o=t.formatter,h=ei(t.children)?a:t.children;return Vr(o)?o(h):h},dde=function(t,a){var o=lu(a-t),h=Math.min(Math.abs(a-t),360);return o*h},pde=function(t,a,o){var h=t.position,y=t.viewBox,b=t.offset,i=t.className,C=y,I=C.cx,j=C.cy,F=C.innerRadius,G=C.outerRadius,X=C.startAngle,Y=C.endAngle,J=C.clockWise,ee=(F+G)/2,oe=dde(X,Y),ge=oe>=0?1:-1,fe,xe;h==="insideStart"?(fe=X+ge*b,xe=J):h==="insideEnd"?(fe=Y-ge*b,xe=!J):h==="end"&&(fe=Y+ge*b,xe=J),xe=oe<=0?xe:!xe;var ae=Xi(I,j,ee,fe),me=Xi(I,j,ee,fe+(xe?1:-1)*359),we="M".concat(ae.x,",").concat(ae.y,`
    A`).concat(ee,",").concat(ee,",0,1,").concat(xe?0:1,`,
    `).concat(me.x,",").concat(me.y),Ge=ei(t.id)?iS("recharts-radial-line-"):t.id;return Ot.createElement("text",X1({},o,{dominantBaseline:"central",className:oi("recharts-radial-bar-label",i)}),Ot.createElement("defs",null,Ot.createElement("path",{id:Ge,d:we})),Ot.createElement("textPath",{xlinkHref:"#".concat(Ge)},a))},mde=function(t){var a=t.viewBox,o=t.offset,h=t.position,y=a,b=y.cx,i=y.cy,C=y.innerRadius,I=y.outerRadius,j=y.startAngle,F=y.endAngle,G=(j+F)/2;if(h==="outside"){var X=Xi(b,i,I+o,G),Y=X.x,J=X.y;return{x:Y,y:J,textAnchor:Y>=b?"start":"end",verticalAnchor:"middle"}}if(h==="center")return{x:b,y:i,textAnchor:"middle",verticalAnchor:"middle"};if(h==="centerTop")return{x:b,y:i,textAnchor:"middle",verticalAnchor:"start"};if(h==="centerBottom")return{x:b,y:i,textAnchor:"middle",verticalAnchor:"end"};var ee=(C+I)/2,oe=Xi(b,i,ee,G),ge=oe.x,fe=oe.y;return{x:ge,y:fe,textAnchor:"middle",verticalAnchor:"middle"}},_de=function(t){var a=t.viewBox,o=t.parentViewBox,h=t.offset,y=t.position,b=a,i=b.x,C=b.y,I=b.width,j=b.height,F=j>=0?1:-1,G=F*h,X=F>0?"end":"start",Y=F>0?"start":"end",J=I>=0?1:-1,ee=J*h,oe=J>0?"end":"start",ge=J>0?"start":"end";if(y==="top"){var fe={x:i+I/2,y:C-F*h,textAnchor:"middle",verticalAnchor:X};return xo(xo({},fe),o?{height:Math.max(C-o.y,0),width:I}:{})}if(y==="bottom"){var xe={x:i+I/2,y:C+j+G,textAnchor:"middle",verticalAnchor:Y};return xo(xo({},xe),o?{height:Math.max(o.y+o.height-(C+j),0),width:I}:{})}if(y==="left"){var ae={x:i-ee,y:C+j/2,textAnchor:oe,verticalAnchor:"middle"};return xo(xo({},ae),o?{width:Math.max(ae.x-o.x,0),height:j}:{})}if(y==="right"){var me={x:i+I+ee,y:C+j/2,textAnchor:ge,verticalAnchor:"middle"};return xo(xo({},me),o?{width:Math.max(o.x+o.width-me.x,0),height:j}:{})}var we=o?{width:I,height:j}:{};return y==="insideLeft"?xo({x:i+ee,y:C+j/2,textAnchor:ge,verticalAnchor:"middle"},we):y==="insideRight"?xo({x:i+I-ee,y:C+j/2,textAnchor:oe,verticalAnchor:"middle"},we):y==="insideTop"?xo({x:i+I/2,y:C+G,textAnchor:"middle",verticalAnchor:Y},we):y==="insideBottom"?xo({x:i+I/2,y:C+j-G,textAnchor:"middle",verticalAnchor:X},we):y==="insideTopLeft"?xo({x:i+ee,y:C+G,textAnchor:ge,verticalAnchor:Y},we):y==="insideTopRight"?xo({x:i+I-ee,y:C+G,textAnchor:oe,verticalAnchor:Y},we):y==="insideBottomLeft"?xo({x:i+ee,y:C+j-G,textAnchor:ge,verticalAnchor:X},we):y==="insideBottomRight"?xo({x:i+I-ee,y:C+j-G,textAnchor:oe,verticalAnchor:X},we):_y(y)&&(Nn(y.x)||N0(y.x))&&(Nn(y.y)||N0(y.y))?xo({x:i+yl(y.x,I),y:C+yl(y.y,j),textAnchor:"end",verticalAnchor:"end"},we):xo({x:i+I/2,y:C+j/2,textAnchor:"middle",verticalAnchor:"middle"},we)},gde=function(t){return"cx"in t&&Nn(t.cx)};function rs(e){var t=e.offset,a=t===void 0?5:t,o=sde(e,tde),h=xo({offset:a},o),y=h.viewBox,b=h.position,i=h.value,C=h.children,I=h.content,j=h.className,F=j===void 0?"":j,G=h.textBreakAll;if(!y||ei(i)&&ei(C)&&!Ie.isValidElement(I)&&!Vr(I))return null;if(Ie.isValidElement(I))return Ie.cloneElement(I,h);var X;if(Vr(I)){if(X=Ie.createElement(I,h),Ie.isValidElement(X))return X}else X=fde(h);var Y=gde(y),J=Fr(h,!0);if(Y&&(b==="insideStart"||b==="insideEnd"||b==="end"))return pde(h,X,J);var ee=Y?mde(h):_de(h);return Ot.createElement(Hg,X1({className:oi("recharts-label",F)},J,ee,{breakAll:G}),X)}rs.displayName="Label";var KU=function(t){var a=t.cx,o=t.cy,h=t.angle,y=t.startAngle,b=t.endAngle,i=t.r,C=t.radius,I=t.innerRadius,j=t.outerRadius,F=t.x,G=t.y,X=t.top,Y=t.left,J=t.width,ee=t.height,oe=t.clockWise,ge=t.labelViewBox;if(ge)return ge;if(Nn(J)&&Nn(ee)){if(Nn(F)&&Nn(G))return{x:F,y:G,width:J,height:ee};if(Nn(X)&&Nn(Y))return{x:X,y:Y,width:J,height:ee}}return Nn(F)&&Nn(G)?{x:F,y:G,width:0,height:0}:Nn(a)&&Nn(o)?{cx:a,cy:o,startAngle:y||h||0,endAngle:b||h||0,innerRadius:I||0,outerRadius:j||C||i||0,clockWise:oe}:t.viewBox?t.viewBox:{}},yde=function(t,a){return t?t===!0?Ot.createElement(rs,{key:"label-implicit",viewBox:a}):bo(t)?Ot.createElement(rs,{key:"label-implicit",viewBox:a,value:t}):Ie.isValidElement(t)?t.type===rs?Ie.cloneElement(t,{key:"label-implicit",viewBox:a}):Ot.createElement(rs,{key:"label-implicit",content:t,viewBox:a}):Vr(t)?Ot.createElement(rs,{key:"label-implicit",content:t,viewBox:a}):_y(t)?Ot.createElement(rs,X1({viewBox:a},t,{key:"label-implicit"})):null:null},vde=function(t,a){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!t||!t.children&&o&&!t.label)return null;var h=t.children,y=KU(t),b=_f(h,rs).map(function(C,I){return Ie.cloneElement(C,{viewBox:a||y,key:"label-".concat(I)})});if(!o)return b;var i=yde(t.label,a||y);return[i].concat(nde(b))};rs.parseViewBox=KU;rs.renderCallByParent=vde;var lM,E8;function xde(){if(E8)return lM;E8=1;function e(t){var a=t==null?0:t.length;return a?t[a-1]:void 0}return lM=e,lM}var bde=xde();const wde=Ei(bde);function Y1(e){"@babel/helpers - typeof";return Y1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Y1(e)}var Sde=["valueAccessor"],Tde=["data","dataKey","clockWise","id","textBreakAll"];function Ede(e){return Ode(e)||Mde(e)||Cde(e)||Ade()}function Ade(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Cde(e,t){if(e){if(typeof e=="string")return t4(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return t4(e,t)}}function Mde(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Ode(e){if(Array.isArray(e))return t4(e)}function t4(e,t){(t==null||t>e.length)&&(t=e.length);for(var a=0,o=new Array(t);a<t;a++)o[a]=e[a];return o}function uw(){return uw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},uw.apply(this,arguments)}function A8(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(h){return Object.getOwnPropertyDescriptor(e,h).enumerable})),a.push.apply(a,o)}return a}function C8(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?A8(Object(a),!0).forEach(function(o){Pde(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):A8(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function Pde(e,t,a){return t=Ide(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Ide(e){var t=Rde(e,"string");return Y1(t)=="symbol"?t:t+""}function Rde(e,t){if(Y1(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t);if(Y1(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function M8(e,t){if(e==null)return{};var a=Dde(e,t),o,h;if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(e);for(h=0;h<y.length;h++)o=y[h],!(t.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(a[o]=e[o])}return a}function Dde(e,t){if(e==null)return{};var a={};for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){if(t.indexOf(o)>=0)continue;a[o]=e[o]}return a}var Lde=function(t){return Array.isArray(t.value)?wde(t.value):t.value};function $0(e){var t=e.valueAccessor,a=t===void 0?Lde:t,o=M8(e,Sde),h=o.data,y=o.dataKey,b=o.clockWise,i=o.id,C=o.textBreakAll,I=M8(o,Tde);return!h||!h.length?null:Ot.createElement(Ga,{className:"recharts-label-list"},h.map(function(j,F){var G=ei(y)?a(j,F):ac(j&&j.payload,y),X=ei(i)?{}:{id:"".concat(i,"-").concat(F)};return Ot.createElement(rs,uw({},Fr(j,!0),I,X,{parentViewBox:j.parentViewBox,value:G,textBreakAll:C,viewBox:rs.parseViewBox(ei(b)?j:C8(C8({},j),{},{clockWise:b})),key:"label-".concat(F),index:F}))}))}$0.displayName="LabelList";function kde(e,t){return e?e===!0?Ot.createElement($0,{key:"labelList-implicit",data:t}):Ot.isValidElement(e)||Vr(e)?Ot.createElement($0,{key:"labelList-implicit",data:t,content:e}):_y(e)?Ot.createElement($0,uw({data:t},e,{key:"labelList-implicit"})):null:null}function zde(e,t){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&a&&!e.label)return null;var o=e.children,h=_f(o,$0).map(function(b,i){return Ie.cloneElement(b,{data:t,key:"labelList-".concat(i)})});if(!a)return h;var y=kde(e.label,t);return[y].concat(Ede(h))}$0.renderCallByParent=zde;function K1(e){"@babel/helpers - typeof";return K1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},K1(e)}function n4(){return n4=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},n4.apply(this,arguments)}function O8(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(h){return Object.getOwnPropertyDescriptor(e,h).enumerable})),a.push.apply(a,o)}return a}function P8(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?O8(Object(a),!0).forEach(function(o){Bde(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):O8(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function Bde(e,t,a){return t=Nde(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Nde(e){var t=Fde(e,"string");return K1(t)=="symbol"?t:t+""}function Fde(e,t){if(K1(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t);if(K1(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var jde=function(t,a){var o=lu(a-t),h=Math.min(Math.abs(a-t),359.999);return o*h},ub=function(t){var a=t.cx,o=t.cy,h=t.radius,y=t.angle,b=t.sign,i=t.isExternal,C=t.cornerRadius,I=t.cornerIsExternal,j=C*(i?1:-1)+h,F=Math.asin(C/j)/cw,G=I?y:y+b*F,X=Xi(a,o,j,G),Y=Xi(a,o,h,G),J=I?y-b*F:y,ee=Xi(a,o,j*Math.cos(F*cw),J);return{center:X,circleTangency:Y,lineTangency:ee,theta:F}},JU=function(t){var a=t.cx,o=t.cy,h=t.innerRadius,y=t.outerRadius,b=t.startAngle,i=t.endAngle,C=jde(b,i),I=b+C,j=Xi(a,o,y,b),F=Xi(a,o,y,I),G="M ".concat(j.x,",").concat(j.y,`
    A `).concat(y,",").concat(y,`,0,
    `).concat(+(Math.abs(C)>180),",").concat(+(b>I),`,
    `).concat(F.x,",").concat(F.y,`
  `);if(h>0){var X=Xi(a,o,h,b),Y=Xi(a,o,h,I);G+="L ".concat(Y.x,",").concat(Y.y,`
            A `).concat(h,",").concat(h,`,0,
            `).concat(+(Math.abs(C)>180),",").concat(+(b<=I),`,
            `).concat(X.x,",").concat(X.y," Z")}else G+="L ".concat(a,",").concat(o," Z");return G},Ude=function(t){var a=t.cx,o=t.cy,h=t.innerRadius,y=t.outerRadius,b=t.cornerRadius,i=t.forceCornerRadius,C=t.cornerIsExternal,I=t.startAngle,j=t.endAngle,F=lu(j-I),G=ub({cx:a,cy:o,radius:y,angle:I,sign:F,cornerRadius:b,cornerIsExternal:C}),X=G.circleTangency,Y=G.lineTangency,J=G.theta,ee=ub({cx:a,cy:o,radius:y,angle:j,sign:-F,cornerRadius:b,cornerIsExternal:C}),oe=ee.circleTangency,ge=ee.lineTangency,fe=ee.theta,xe=C?Math.abs(I-j):Math.abs(I-j)-J-fe;if(xe<0)return i?"M ".concat(Y.x,",").concat(Y.y,`
        a`).concat(b,",").concat(b,",0,0,1,").concat(b*2,`,0
        a`).concat(b,",").concat(b,",0,0,1,").concat(-b*2,`,0
      `):JU({cx:a,cy:o,innerRadius:h,outerRadius:y,startAngle:I,endAngle:j});var ae="M ".concat(Y.x,",").concat(Y.y,`
    A`).concat(b,",").concat(b,",0,0,").concat(+(F<0),",").concat(X.x,",").concat(X.y,`
    A`).concat(y,",").concat(y,",0,").concat(+(xe>180),",").concat(+(F<0),",").concat(oe.x,",").concat(oe.y,`
    A`).concat(b,",").concat(b,",0,0,").concat(+(F<0),",").concat(ge.x,",").concat(ge.y,`
  `);if(h>0){var me=ub({cx:a,cy:o,radius:h,angle:I,sign:F,isExternal:!0,cornerRadius:b,cornerIsExternal:C}),we=me.circleTangency,Ge=me.lineTangency,He=me.theta,ye=ub({cx:a,cy:o,radius:h,angle:j,sign:-F,isExternal:!0,cornerRadius:b,cornerIsExternal:C}),ke=ye.circleTangency,dt=ye.lineTangency,vt=ye.theta,jt=C?Math.abs(I-j):Math.abs(I-j)-He-vt;if(jt<0&&b===0)return"".concat(ae,"L").concat(a,",").concat(o,"Z");ae+="L".concat(dt.x,",").concat(dt.y,`
      A`).concat(b,",").concat(b,",0,0,").concat(+(F<0),",").concat(ke.x,",").concat(ke.y,`
      A`).concat(h,",").concat(h,",0,").concat(+(jt>180),",").concat(+(F>0),",").concat(we.x,",").concat(we.y,`
      A`).concat(b,",").concat(b,",0,0,").concat(+(F<0),",").concat(Ge.x,",").concat(Ge.y,"Z")}else ae+="L".concat(a,",").concat(o,"Z");return ae},Vde={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},QU=function(t){var a=P8(P8({},Vde),t),o=a.cx,h=a.cy,y=a.innerRadius,b=a.outerRadius,i=a.cornerRadius,C=a.forceCornerRadius,I=a.cornerIsExternal,j=a.startAngle,F=a.endAngle,G=a.className;if(b<y||j===F)return null;var X=oi("recharts-sector",G),Y=b-y,J=yl(i,Y,0,!0),ee;return J>0&&Math.abs(j-F)<360?ee=Ude({cx:o,cy:h,innerRadius:y,outerRadius:b,cornerRadius:Math.min(J,Y/2),forceCornerRadius:C,cornerIsExternal:I,startAngle:j,endAngle:F}):ee=JU({cx:o,cy:h,innerRadius:y,outerRadius:b,startAngle:j,endAngle:F}),Ot.createElement("path",n4({},Fr(a,!0),{className:X,d:ee,role:"img"}))};function J1(e){"@babel/helpers - typeof";return J1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},J1(e)}function r4(){return r4=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},r4.apply(this,arguments)}function I8(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(h){return Object.getOwnPropertyDescriptor(e,h).enumerable})),a.push.apply(a,o)}return a}function R8(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?I8(Object(a),!0).forEach(function(o){$de(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):I8(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function $de(e,t,a){return t=qde(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function qde(e){var t=Gde(e,"string");return J1(t)=="symbol"?t:t+""}function Gde(e,t){if(J1(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t);if(J1(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var D8={curveBasisClosed:cae,curveBasisOpen:uae,curveBasis:lae,curveBumpX:Wie,curveBumpY:Xie,curveLinearClosed:hae,curveLinear:lS,curveMonotoneX:fae,curveMonotoneY:dae,curveNatural:pae,curveStep:mae,curveStepAfter:gae,curveStepBefore:_ae},hb=function(t){return t.x===+t.x&&t.y===+t.y},Gv=function(t){return t.x},Hv=function(t){return t.y},Hde=function(t,a){if(Vr(t))return t;var o="curve".concat(oS(t));return(o==="curveMonotone"||o==="curveBump")&&a?D8["".concat(o).concat(a==="vertical"?"Y":"X")]:D8[o]||lS},Zde=function(t){var a=t.type,o=a===void 0?"linear":a,h=t.points,y=h===void 0?[]:h,b=t.baseLine,i=t.layout,C=t.connectNulls,I=C===void 0?!1:C,j=Hde(o,i),F=I?y.filter(function(J){return hb(J)}):y,G;if(Array.isArray(b)){var X=I?b.filter(function(J){return hb(J)}):b,Y=F.map(function(J,ee){return R8(R8({},J),{},{base:X[ee]})});return i==="vertical"?G=nb().y(Hv).x1(Gv).x0(function(J){return J.base.x}):G=nb().x(Gv).y1(Hv).y0(function(J){return J.base.y}),G.defined(hb).curve(j),G(Y)}return i==="vertical"&&Nn(b)?G=nb().y(Hv).x1(Gv).x0(b):Nn(b)?G=nb().x(Gv).y1(Hv).y0(b):G=tj().x(Gv).y(Hv),G.defined(hb).curve(j),G(F)},i4=function(t){var a=t.className,o=t.points,h=t.path,y=t.pathRef;if((!o||!o.length)&&!h)return null;var b=o&&o.length?Zde(t):h;return Ot.createElement("path",r4({},Fr(t,!1),Fb(t),{className:oi("recharts-curve",a),d:b,ref:y}))},Wde=Object.getOwnPropertyNames,Xde=Object.getOwnPropertySymbols,Yde=Object.prototype.hasOwnProperty;function L8(e,t){return function(o,h,y){return e(o,h,y)&&t(o,h,y)}}function fb(e){return function(a,o,h){if(!a||!o||typeof a!="object"||typeof o!="object")return e(a,o,h);var y=h.cache,b=y.get(a),i=y.get(o);if(b&&i)return b===o&&i===a;y.set(a,o),y.set(o,a);var C=e(a,o,h);return y.delete(a),y.delete(o),C}}function k8(e){return Wde(e).concat(Xde(e))}var Kde=Object.hasOwn||function(e,t){return Yde.call(e,t)};function Q0(e,t){return e===t||!e&&!t&&e!==e&&t!==t}var Jde="__v",Qde="__o",epe="_owner",z8=Object.getOwnPropertyDescriptor,B8=Object.keys;function tpe(e,t,a){var o=e.length;if(t.length!==o)return!1;for(;o-- >0;)if(!a.equals(e[o],t[o],o,o,e,t,a))return!1;return!0}function npe(e,t){return Q0(e.getTime(),t.getTime())}function rpe(e,t){return e.name===t.name&&e.message===t.message&&e.cause===t.cause&&e.stack===t.stack}function ipe(e,t){return e===t}function N8(e,t,a){var o=e.size;if(o!==t.size)return!1;if(!o)return!0;for(var h=new Array(o),y=e.entries(),b,i,C=0;(b=y.next())&&!b.done;){for(var I=t.entries(),j=!1,F=0;(i=I.next())&&!i.done;){if(h[F]){F++;continue}var G=b.value,X=i.value;if(a.equals(G[0],X[0],C,F,e,t,a)&&a.equals(G[1],X[1],G[0],X[0],e,t,a)){j=h[F]=!0;break}F++}if(!j)return!1;C++}return!0}var ape=Q0;function ope(e,t,a){var o=B8(e),h=o.length;if(B8(t).length!==h)return!1;for(;h-- >0;)if(!eV(e,t,a,o[h]))return!1;return!0}function Zv(e,t,a){var o=k8(e),h=o.length;if(k8(t).length!==h)return!1;for(var y,b,i;h-- >0;)if(y=o[h],!eV(e,t,a,y)||(b=z8(e,y),i=z8(t,y),(b||i)&&(!b||!i||b.configurable!==i.configurable||b.enumerable!==i.enumerable||b.writable!==i.writable)))return!1;return!0}function spe(e,t){return Q0(e.valueOf(),t.valueOf())}function lpe(e,t){return e.source===t.source&&e.flags===t.flags}function F8(e,t,a){var o=e.size;if(o!==t.size)return!1;if(!o)return!0;for(var h=new Array(o),y=e.values(),b,i;(b=y.next())&&!b.done;){for(var C=t.values(),I=!1,j=0;(i=C.next())&&!i.done;){if(!h[j]&&a.equals(b.value,i.value,b.value,i.value,e,t,a)){I=h[j]=!0;break}j++}if(!I)return!1}return!0}function cpe(e,t){var a=e.length;if(t.length!==a)return!1;for(;a-- >0;)if(e[a]!==t[a])return!1;return!0}function upe(e,t){return e.hostname===t.hostname&&e.pathname===t.pathname&&e.protocol===t.protocol&&e.port===t.port&&e.hash===t.hash&&e.username===t.username&&e.password===t.password}function eV(e,t,a,o){return(o===epe||o===Qde||o===Jde)&&(e.$$typeof||t.$$typeof)?!0:Kde(t,o)&&a.equals(e[o],t[o],o,o,e,t,a)}var hpe="[object Arguments]",fpe="[object Boolean]",dpe="[object Date]",ppe="[object Error]",mpe="[object Map]",_pe="[object Number]",gpe="[object Object]",ype="[object RegExp]",vpe="[object Set]",xpe="[object String]",bpe="[object URL]",wpe=Array.isArray,j8=typeof ArrayBuffer=="function"&&ArrayBuffer.isView?ArrayBuffer.isView:null,U8=Object.assign,Spe=Object.prototype.toString.call.bind(Object.prototype.toString);function Tpe(e){var t=e.areArraysEqual,a=e.areDatesEqual,o=e.areErrorsEqual,h=e.areFunctionsEqual,y=e.areMapsEqual,b=e.areNumbersEqual,i=e.areObjectsEqual,C=e.arePrimitiveWrappersEqual,I=e.areRegExpsEqual,j=e.areSetsEqual,F=e.areTypedArraysEqual,G=e.areUrlsEqual;return function(Y,J,ee){if(Y===J)return!0;if(Y==null||J==null)return!1;var oe=typeof Y;if(oe!==typeof J)return!1;if(oe!=="object")return oe==="number"?b(Y,J,ee):oe==="function"?h(Y,J,ee):!1;var ge=Y.constructor;if(ge!==J.constructor)return!1;if(ge===Object)return i(Y,J,ee);if(wpe(Y))return t(Y,J,ee);if(j8!=null&&j8(Y))return F(Y,J,ee);if(ge===Date)return a(Y,J,ee);if(ge===RegExp)return I(Y,J,ee);if(ge===Map)return y(Y,J,ee);if(ge===Set)return j(Y,J,ee);var fe=Spe(Y);return fe===dpe?a(Y,J,ee):fe===ype?I(Y,J,ee):fe===mpe?y(Y,J,ee):fe===vpe?j(Y,J,ee):fe===gpe?typeof Y.then!="function"&&typeof J.then!="function"&&i(Y,J,ee):fe===bpe?G(Y,J,ee):fe===ppe?o(Y,J,ee):fe===hpe?i(Y,J,ee):fe===fpe||fe===_pe||fe===xpe?C(Y,J,ee):!1}}function Epe(e){var t=e.circular,a=e.createCustomConfig,o=e.strict,h={areArraysEqual:o?Zv:tpe,areDatesEqual:npe,areErrorsEqual:rpe,areFunctionsEqual:ipe,areMapsEqual:o?L8(N8,Zv):N8,areNumbersEqual:ape,areObjectsEqual:o?Zv:ope,arePrimitiveWrappersEqual:spe,areRegExpsEqual:lpe,areSetsEqual:o?L8(F8,Zv):F8,areTypedArraysEqual:o?Zv:cpe,areUrlsEqual:upe};if(a&&(h=U8({},h,a(h))),t){var y=fb(h.areArraysEqual),b=fb(h.areMapsEqual),i=fb(h.areObjectsEqual),C=fb(h.areSetsEqual);h=U8({},h,{areArraysEqual:y,areMapsEqual:b,areObjectsEqual:i,areSetsEqual:C})}return h}function Ape(e){return function(t,a,o,h,y,b,i){return e(t,a,i)}}function Cpe(e){var t=e.circular,a=e.comparator,o=e.createState,h=e.equals,y=e.strict;if(o)return function(C,I){var j=o(),F=j.cache,G=F===void 0?t?new WeakMap:void 0:F,X=j.meta;return a(C,I,{cache:G,equals:h,meta:X,strict:y})};if(t)return function(C,I){return a(C,I,{cache:new WeakMap,equals:h,meta:void 0,strict:y})};var b={cache:void 0,equals:h,meta:void 0,strict:y};return function(C,I){return a(C,I,b)}}var Mpe=xm();xm({strict:!0});xm({circular:!0});xm({circular:!0,strict:!0});xm({createInternalComparator:function(){return Q0}});xm({strict:!0,createInternalComparator:function(){return Q0}});xm({circular:!0,createInternalComparator:function(){return Q0}});xm({circular:!0,createInternalComparator:function(){return Q0},strict:!0});function xm(e){e===void 0&&(e={});var t=e.circular,a=t===void 0?!1:t,o=e.createInternalComparator,h=e.createState,y=e.strict,b=y===void 0?!1:y,i=Epe(e),C=Tpe(i),I=o?o(C):Ape(C);return Cpe({circular:a,comparator:C,createState:h,equals:I,strict:b})}function Ope(e){typeof requestAnimationFrame<"u"&&requestAnimationFrame(e)}function V8(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=-1,o=function h(y){a<0&&(a=y),y-a>t?(e(y),a=-1):Ope(h)};requestAnimationFrame(o)}function a4(e){"@babel/helpers - typeof";return a4=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a4(e)}function Ppe(e){return Lpe(e)||Dpe(e)||Rpe(e)||Ipe()}function Ipe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Rpe(e,t){if(e){if(typeof e=="string")return $8(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return $8(e,t)}}function $8(e,t){(t==null||t>e.length)&&(t=e.length);for(var a=0,o=new Array(t);a<t;a++)o[a]=e[a];return o}function Dpe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Lpe(e){if(Array.isArray(e))return e}function kpe(){var e={},t=function(){return null},a=!1,o=function h(y){if(!a){if(Array.isArray(y)){if(!y.length)return;var b=y,i=Ppe(b),C=i[0],I=i.slice(1);if(typeof C=="number"){V8(h.bind(null,I),C);return}h(C),V8(h.bind(null,I));return}a4(y)==="object"&&(e=y,t(e)),typeof y=="function"&&y()}};return{stop:function(){a=!0},start:function(y){a=!1,o(y)},subscribe:function(y){return t=y,function(){t=function(){return null}}}}}function Q1(e){"@babel/helpers - typeof";return Q1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Q1(e)}function q8(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(h){return Object.getOwnPropertyDescriptor(e,h).enumerable})),a.push.apply(a,o)}return a}function G8(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?q8(Object(a),!0).forEach(function(o){tV(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):q8(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function tV(e,t,a){return t=zpe(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function zpe(e){var t=Bpe(e,"string");return Q1(t)==="symbol"?t:String(t)}function Bpe(e,t){if(Q1(e)!=="object"||e===null)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t);if(Q1(o)!=="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Npe=function(t,a){return[Object.keys(t),Object.keys(a)].reduce(function(o,h){return o.filter(function(y){return h.includes(y)})})},Fpe=function(t){return t},jpe=function(t){return t.replace(/([A-Z])/g,function(a){return"-".concat(a.toLowerCase())})},m1=function(t,a){return Object.keys(a).reduce(function(o,h){return G8(G8({},o),{},tV({},h,t(h,a[h])))},{})},H8=function(t,a,o){return t.map(function(h){return"".concat(jpe(h)," ").concat(a,"ms ").concat(o)}).join(",")};function Upe(e,t){return qpe(e)||$pe(e,t)||nV(e,t)||Vpe()}function Vpe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $pe(e,t){var a=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(a!=null){var o,h,y,b,i=[],C=!0,I=!1;try{if(y=(a=a.call(e)).next,t!==0)for(;!(C=(o=y.call(a)).done)&&(i.push(o.value),i.length!==t);C=!0);}catch(j){I=!0,h=j}finally{try{if(!C&&a.return!=null&&(b=a.return(),Object(b)!==b))return}finally{if(I)throw h}}return i}}function qpe(e){if(Array.isArray(e))return e}function Gpe(e){return Wpe(e)||Zpe(e)||nV(e)||Hpe()}function Hpe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function nV(e,t){if(e){if(typeof e=="string")return o4(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return o4(e,t)}}function Zpe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Wpe(e){if(Array.isArray(e))return o4(e)}function o4(e,t){(t==null||t>e.length)&&(t=e.length);for(var a=0,o=new Array(t);a<t;a++)o[a]=e[a];return o}var hw=1e-4,rV=function(t,a){return[0,3*t,3*a-6*t,3*t-3*a+1]},iV=function(t,a){return t.map(function(o,h){return o*Math.pow(a,h)}).reduce(function(o,h){return o+h})},Z8=function(t,a){return function(o){var h=rV(t,a);return iV(h,o)}},Xpe=function(t,a){return function(o){var h=rV(t,a),y=[].concat(Gpe(h.map(function(b,i){return b*i}).slice(1)),[0]);return iV(y,o)}},W8=function(){for(var t=arguments.length,a=new Array(t),o=0;o<t;o++)a[o]=arguments[o];var h=a[0],y=a[1],b=a[2],i=a[3];if(a.length===1)switch(a[0]){case"linear":h=0,y=0,b=1,i=1;break;case"ease":h=.25,y=.1,b=.25,i=1;break;case"ease-in":h=.42,y=0,b=1,i=1;break;case"ease-out":h=.42,y=0,b=.58,i=1;break;case"ease-in-out":h=0,y=0,b=.58,i=1;break;default:{var C=a[0].split("(");if(C[0]==="cubic-bezier"&&C[1].split(")")[0].split(",").length===4){var I=C[1].split(")")[0].split(",").map(function(ee){return parseFloat(ee)}),j=Upe(I,4);h=j[0],y=j[1],b=j[2],i=j[3]}}}var F=Z8(h,b),G=Z8(y,i),X=Xpe(h,b),Y=function(oe){return oe>1?1:oe<0?0:oe},J=function(oe){for(var ge=oe>1?1:oe,fe=ge,xe=0;xe<8;++xe){var ae=F(fe)-ge,me=X(fe);if(Math.abs(ae-ge)<hw||me<hw)return G(fe);fe=Y(fe-ae/me)}return G(fe)};return J.isStepper=!1,J},Ype=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},a=t.stiff,o=a===void 0?100:a,h=t.damping,y=h===void 0?8:h,b=t.dt,i=b===void 0?17:b,C=function(j,F,G){var X=-(j-F)*o,Y=G*y,J=G+(X-Y)*i/1e3,ee=G*i/1e3+j;return Math.abs(ee-F)<hw&&Math.abs(J)<hw?[F,0]:[ee,J]};return C.isStepper=!0,C.dt=i,C},Kpe=function(){for(var t=arguments.length,a=new Array(t),o=0;o<t;o++)a[o]=arguments[o];var h=a[0];if(typeof h=="string")switch(h){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return W8(h);case"spring":return Ype();default:if(h.split("(")[0]==="cubic-bezier")return W8(h)}return typeof h=="function"?h:null};function e2(e){"@babel/helpers - typeof";return e2=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e2(e)}function X8(e){return eme(e)||Qpe(e)||aV(e)||Jpe()}function Jpe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Qpe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function eme(e){if(Array.isArray(e))return l4(e)}function Y8(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(h){return Object.getOwnPropertyDescriptor(e,h).enumerable})),a.push.apply(a,o)}return a}function ts(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?Y8(Object(a),!0).forEach(function(o){s4(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Y8(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function s4(e,t,a){return t=tme(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function tme(e){var t=nme(e,"string");return e2(t)==="symbol"?t:String(t)}function nme(e,t){if(e2(e)!=="object"||e===null)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t);if(e2(o)!=="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function rme(e,t){return ome(e)||ame(e,t)||aV(e,t)||ime()}function ime(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function aV(e,t){if(e){if(typeof e=="string")return l4(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return l4(e,t)}}function l4(e,t){(t==null||t>e.length)&&(t=e.length);for(var a=0,o=new Array(t);a<t;a++)o[a]=e[a];return o}function ame(e,t){var a=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(a!=null){var o,h,y,b,i=[],C=!0,I=!1;try{if(y=(a=a.call(e)).next,t!==0)for(;!(C=(o=y.call(a)).done)&&(i.push(o.value),i.length!==t);C=!0);}catch(j){I=!0,h=j}finally{try{if(!C&&a.return!=null&&(b=a.return(),Object(b)!==b))return}finally{if(I)throw h}}return i}}function ome(e){if(Array.isArray(e))return e}var fw=function(t,a,o){return t+(a-t)*o},c4=function(t){var a=t.from,o=t.to;return a!==o},sme=function e(t,a,o){var h=m1(function(y,b){if(c4(b)){var i=t(b.from,b.to,b.velocity),C=rme(i,2),I=C[0],j=C[1];return ts(ts({},b),{},{from:I,velocity:j})}return b},a);return o<1?m1(function(y,b){return c4(b)?ts(ts({},b),{},{velocity:fw(b.velocity,h[y].velocity,o),from:fw(b.from,h[y].from,o)}):b},a):e(t,h,o-1)};const lme=function(e,t,a,o,h){var y=Npe(e,t),b=y.reduce(function(ee,oe){return ts(ts({},ee),{},s4({},oe,[e[oe],t[oe]]))},{}),i=y.reduce(function(ee,oe){return ts(ts({},ee),{},s4({},oe,{from:e[oe],velocity:0,to:t[oe]}))},{}),C=-1,I,j,F=function(){return null},G=function(){return m1(function(oe,ge){return ge.from},i)},X=function(){return!Object.values(i).filter(c4).length},Y=function(oe){I||(I=oe);var ge=oe-I,fe=ge/a.dt;i=sme(a,i,fe),h(ts(ts(ts({},e),t),G())),I=oe,X()||(C=requestAnimationFrame(F))},J=function(oe){j||(j=oe);var ge=(oe-j)/o,fe=m1(function(ae,me){return fw.apply(void 0,X8(me).concat([a(ge)]))},b);if(h(ts(ts(ts({},e),t),fe)),ge<1)C=requestAnimationFrame(F);else{var xe=m1(function(ae,me){return fw.apply(void 0,X8(me).concat([a(1)]))},b);h(ts(ts(ts({},e),t),xe))}};return F=a.isStepper?Y:J,function(){return requestAnimationFrame(F),function(){cancelAnimationFrame(C)}}};function Jg(e){"@babel/helpers - typeof";return Jg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jg(e)}var cme=["children","begin","duration","attributeName","easing","isActive","steps","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart"];function ume(e,t){if(e==null)return{};var a=hme(e,t),o,h;if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(e);for(h=0;h<y.length;h++)o=y[h],!(t.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(a[o]=e[o])}return a}function hme(e,t){if(e==null)return{};var a={},o=Object.keys(e),h,y;for(y=0;y<o.length;y++)h=o[y],!(t.indexOf(h)>=0)&&(a[h]=e[h]);return a}function cM(e){return mme(e)||pme(e)||dme(e)||fme()}function fme(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function dme(e,t){if(e){if(typeof e=="string")return u4(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return u4(e,t)}}function pme(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function mme(e){if(Array.isArray(e))return u4(e)}function u4(e,t){(t==null||t>e.length)&&(t=e.length);for(var a=0,o=new Array(t);a<t;a++)o[a]=e[a];return o}function K8(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(h){return Object.getOwnPropertyDescriptor(e,h).enumerable})),a.push.apply(a,o)}return a}function eh(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?K8(Object(a),!0).forEach(function(o){l1(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):K8(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function l1(e,t,a){return t=oV(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function _me(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gme(e,t){for(var a=0;a<t.length;a++){var o=t[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,oV(o.key),o)}}function yme(e,t,a){return t&&gme(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function oV(e){var t=vme(e,"string");return Jg(t)==="symbol"?t:String(t)}function vme(e,t){if(Jg(e)!=="object"||e===null)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t);if(Jg(o)!=="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xme(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&h4(e,t)}function h4(e,t){return h4=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,h){return o.__proto__=h,o},h4(e,t)}function bme(e){var t=wme();return function(){var o=dw(e),h;if(t){var y=dw(this).constructor;h=Reflect.construct(o,arguments,y)}else h=o.apply(this,arguments);return f4(this,h)}}function f4(e,t){if(t&&(Jg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return d4(e)}function d4(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function wme(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function dw(e){return dw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)},dw(e)}var pm=function(e){xme(a,e);var t=bme(a);function a(o,h){var y;_me(this,a),y=t.call(this,o,h);var b=y.props,i=b.isActive,C=b.attributeName,I=b.from,j=b.to,F=b.steps,G=b.children,X=b.duration;if(y.handleStyleChange=y.handleStyleChange.bind(d4(y)),y.changeStyle=y.changeStyle.bind(d4(y)),!i||X<=0)return y.state={style:{}},typeof G=="function"&&(y.state={style:j}),f4(y);if(F&&F.length)y.state={style:F[0].style};else if(I){if(typeof G=="function")return y.state={style:I},f4(y);y.state={style:C?l1({},C,I):I}}else y.state={style:{}};return y}return yme(a,[{key:"componentDidMount",value:function(){var h=this.props,y=h.isActive,b=h.canBegin;this.mounted=!0,!(!y||!b)&&this.runAnimation(this.props)}},{key:"componentDidUpdate",value:function(h){var y=this.props,b=y.isActive,i=y.canBegin,C=y.attributeName,I=y.shouldReAnimate,j=y.to,F=y.from,G=this.state.style;if(i){if(!b){var X={style:C?l1({},C,j):j};this.state&&G&&(C&&G[C]!==j||!C&&G!==j)&&this.setState(X);return}if(!(Mpe(h.to,j)&&h.canBegin&&h.isActive)){var Y=!h.canBegin||!h.isActive;this.manager&&this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var J=Y||I?F:h.to;if(this.state&&G){var ee={style:C?l1({},C,J):J};(C&&G[C]!==J||!C&&G!==J)&&this.setState(ee)}this.runAnimation(eh(eh({},this.props),{},{from:J,begin:0}))}}}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var h=this.props.onAnimationEnd;this.unSubscribe&&this.unSubscribe(),this.manager&&(this.manager.stop(),this.manager=null),this.stopJSAnimation&&this.stopJSAnimation(),h&&h()}},{key:"handleStyleChange",value:function(h){this.changeStyle(h)}},{key:"changeStyle",value:function(h){this.mounted&&this.setState({style:h})}},{key:"runJSAnimation",value:function(h){var y=this,b=h.from,i=h.to,C=h.duration,I=h.easing,j=h.begin,F=h.onAnimationEnd,G=h.onAnimationStart,X=lme(b,i,Kpe(I),C,this.changeStyle),Y=function(){y.stopJSAnimation=X()};this.manager.start([G,j,Y,C,F])}},{key:"runStepAnimation",value:function(h){var y=this,b=h.steps,i=h.begin,C=h.onAnimationStart,I=b[0],j=I.style,F=I.duration,G=F===void 0?0:F,X=function(J,ee,oe){if(oe===0)return J;var ge=ee.duration,fe=ee.easing,xe=fe===void 0?"ease":fe,ae=ee.style,me=ee.properties,we=ee.onAnimationEnd,Ge=oe>0?b[oe-1]:ee,He=me||Object.keys(ae);if(typeof xe=="function"||xe==="spring")return[].concat(cM(J),[y.runJSAnimation.bind(y,{from:Ge.style,to:ae,duration:ge,easing:xe}),ge]);var ye=H8(He,ge,xe),ke=eh(eh(eh({},Ge.style),ae),{},{transition:ye});return[].concat(cM(J),[ke,ge,we]).filter(Fpe)};return this.manager.start([C].concat(cM(b.reduce(X,[j,Math.max(G,i)])),[h.onAnimationEnd]))}},{key:"runAnimation",value:function(h){this.manager||(this.manager=kpe());var y=h.begin,b=h.duration,i=h.attributeName,C=h.to,I=h.easing,j=h.onAnimationStart,F=h.onAnimationEnd,G=h.steps,X=h.children,Y=this.manager;if(this.unSubscribe=Y.subscribe(this.handleStyleChange),typeof I=="function"||typeof X=="function"||I==="spring"){this.runJSAnimation(h);return}if(G.length>1){this.runStepAnimation(h);return}var J=i?l1({},i,C):C,ee=H8(Object.keys(J),b,I);Y.start([j,y,eh(eh({},J),{},{transition:ee}),b,F])}},{key:"render",value:function(){var h=this.props,y=h.children;h.begin;var b=h.duration;h.attributeName,h.easing;var i=h.isActive;h.steps,h.from,h.to,h.canBegin,h.onAnimationEnd,h.shouldReAnimate,h.onAnimationReStart;var C=ume(h,cme),I=Ie.Children.count(y),j=this.state.style;if(typeof y=="function")return y(j);if(!i||I===0||b<=0)return y;var F=function(X){var Y=X.props,J=Y.style,ee=J===void 0?{}:J,oe=Y.className,ge=Ie.cloneElement(X,eh(eh({},C),{},{style:eh(eh({},ee),j),className:oe}));return ge};return I===1?F(Ie.Children.only(y)):Ot.createElement("div",null,Ie.Children.map(y,function(G){return F(G)}))}}]),a}(Ie.PureComponent);pm.displayName="Animate";pm.defaultProps={begin:0,duration:1e3,from:"",to:"",attributeName:"",easing:"ease",isActive:!0,canBegin:!0,steps:[],onAnimationEnd:function(){},onAnimationStart:function(){}};pm.propTypes={from:wi.oneOfType([wi.object,wi.string]),to:wi.oneOfType([wi.object,wi.string]),attributeName:wi.string,duration:wi.number,begin:wi.number,easing:wi.oneOfType([wi.string,wi.func]),steps:wi.arrayOf(wi.shape({duration:wi.number.isRequired,style:wi.object.isRequired,easing:wi.oneOfType([wi.oneOf(["ease","ease-in","ease-out","ease-in-out","linear"]),wi.func]),properties:wi.arrayOf("string"),onAnimationEnd:wi.func})),children:wi.oneOfType([wi.node,wi.func]),isActive:wi.bool,canBegin:wi.bool,onAnimationEnd:wi.func,shouldReAnimate:wi.bool,onAnimationStart:wi.func,onAnimationReStart:wi.func};var sV=fN();function t2(e){"@babel/helpers - typeof";return t2=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t2(e)}function pw(){return pw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},pw.apply(this,arguments)}function Sme(e,t){return Cme(e)||Ame(e,t)||Eme(e,t)||Tme()}function Tme(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Eme(e,t){if(e){if(typeof e=="string")return J8(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return J8(e,t)}}function J8(e,t){(t==null||t>e.length)&&(t=e.length);for(var a=0,o=new Array(t);a<t;a++)o[a]=e[a];return o}function Ame(e,t){var a=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(a!=null){var o,h,y,b,i=[],C=!0,I=!1;try{if(y=(a=a.call(e)).next,t!==0)for(;!(C=(o=y.call(a)).done)&&(i.push(o.value),i.length!==t);C=!0);}catch(j){I=!0,h=j}finally{try{if(!C&&a.return!=null&&(b=a.return(),Object(b)!==b))return}finally{if(I)throw h}}return i}}function Cme(e){if(Array.isArray(e))return e}function Q8(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(h){return Object.getOwnPropertyDescriptor(e,h).enumerable})),a.push.apply(a,o)}return a}function e7(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?Q8(Object(a),!0).forEach(function(o){Mme(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Q8(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function Mme(e,t,a){return t=Ome(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Ome(e){var t=Pme(e,"string");return t2(t)=="symbol"?t:t+""}function Pme(e,t){if(t2(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t);if(t2(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var t7=function(t,a,o,h,y){var b=Math.min(Math.abs(o)/2,Math.abs(h)/2),i=h>=0?1:-1,C=o>=0?1:-1,I=h>=0&&o>=0||h<0&&o<0?1:0,j;if(b>0&&y instanceof Array){for(var F=[0,0,0,0],G=0,X=4;G<X;G++)F[G]=y[G]>b?b:y[G];j="M".concat(t,",").concat(a+i*F[0]),F[0]>0&&(j+="A ".concat(F[0],",").concat(F[0],",0,0,").concat(I,",").concat(t+C*F[0],",").concat(a)),j+="L ".concat(t+o-C*F[1],",").concat(a),F[1]>0&&(j+="A ".concat(F[1],",").concat(F[1],",0,0,").concat(I,`,
        `).concat(t+o,",").concat(a+i*F[1])),j+="L ".concat(t+o,",").concat(a+h-i*F[2]),F[2]>0&&(j+="A ".concat(F[2],",").concat(F[2],",0,0,").concat(I,`,
        `).concat(t+o-C*F[2],",").concat(a+h)),j+="L ".concat(t+C*F[3],",").concat(a+h),F[3]>0&&(j+="A ".concat(F[3],",").concat(F[3],",0,0,").concat(I,`,
        `).concat(t,",").concat(a+h-i*F[3])),j+="Z"}else if(b>0&&y===+y&&y>0){var Y=Math.min(b,y);j="M ".concat(t,",").concat(a+i*Y,`
            A `).concat(Y,",").concat(Y,",0,0,").concat(I,",").concat(t+C*Y,",").concat(a,`
            L `).concat(t+o-C*Y,",").concat(a,`
            A `).concat(Y,",").concat(Y,",0,0,").concat(I,",").concat(t+o,",").concat(a+i*Y,`
            L `).concat(t+o,",").concat(a+h-i*Y,`
            A `).concat(Y,",").concat(Y,",0,0,").concat(I,",").concat(t+o-C*Y,",").concat(a+h,`
            L `).concat(t+C*Y,",").concat(a+h,`
            A `).concat(Y,",").concat(Y,",0,0,").concat(I,",").concat(t,",").concat(a+h-i*Y," Z")}else j="M ".concat(t,",").concat(a," h ").concat(o," v ").concat(h," h ").concat(-o," Z");return j},Ime=function(t,a){if(!t||!a)return!1;var o=t.x,h=t.y,y=a.x,b=a.y,i=a.width,C=a.height;if(Math.abs(i)>0&&Math.abs(C)>0){var I=Math.min(y,y+i),j=Math.max(y,y+i),F=Math.min(b,b+C),G=Math.max(b,b+C);return o>=I&&o<=j&&h>=F&&h<=G}return!1},Rme={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},xP=function(t){var a=e7(e7({},Rme),t),o=Ie.useRef(),h=Ie.useState(-1),y=Sme(h,2),b=y[0],i=y[1];Ie.useEffect(function(){if(o.current&&o.current.getTotalLength)try{var xe=o.current.getTotalLength();xe&&i(xe)}catch{}},[]);var C=a.x,I=a.y,j=a.width,F=a.height,G=a.radius,X=a.className,Y=a.animationEasing,J=a.animationDuration,ee=a.animationBegin,oe=a.isAnimationActive,ge=a.isUpdateAnimationActive;if(C!==+C||I!==+I||j!==+j||F!==+F||j===0||F===0)return null;var fe=oi("recharts-rectangle",X);return ge?Ot.createElement(pm,{canBegin:b>0,from:{width:j,height:F,x:C,y:I},to:{width:j,height:F,x:C,y:I},duration:J,animationEasing:Y,isActive:ge},function(xe){var ae=xe.width,me=xe.height,we=xe.x,Ge=xe.y;return Ot.createElement(pm,{canBegin:b>0,from:"0px ".concat(b===-1?1:b,"px"),to:"".concat(b,"px 0px"),attributeName:"strokeDasharray",begin:ee,duration:J,isActive:oe,easing:Y},Ot.createElement("path",pw({},Fr(a,!0),{className:fe,d:t7(we,Ge,ae,me,G),ref:o})))}):Ot.createElement("path",pw({},Fr(a,!0),{className:fe,d:t7(C,I,j,F,G)}))},Dme=["points","className","baseLinePoints","connectNulls"];function Ag(){return Ag=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},Ag.apply(this,arguments)}function Lme(e,t){if(e==null)return{};var a=kme(e,t),o,h;if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(e);for(h=0;h<y.length;h++)o=y[h],!(t.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(a[o]=e[o])}return a}function kme(e,t){if(e==null)return{};var a={};for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){if(t.indexOf(o)>=0)continue;a[o]=e[o]}return a}function n7(e){return Fme(e)||Nme(e)||Bme(e)||zme()}function zme(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Bme(e,t){if(e){if(typeof e=="string")return p4(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return p4(e,t)}}function Nme(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Fme(e){if(Array.isArray(e))return p4(e)}function p4(e,t){(t==null||t>e.length)&&(t=e.length);for(var a=0,o=new Array(t);a<t;a++)o[a]=e[a];return o}var r7=function(t){return t&&t.x===+t.x&&t.y===+t.y},jme=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],a=[[]];return t.forEach(function(o){r7(o)?a[a.length-1].push(o):a[a.length-1].length>0&&a.push([])}),r7(t[0])&&a[a.length-1].push(t[0]),a[a.length-1].length<=0&&(a=a.slice(0,-1)),a},_1=function(t,a){var o=jme(t);a&&(o=[o.reduce(function(y,b){return[].concat(n7(y),n7(b))},[])]);var h=o.map(function(y){return y.reduce(function(b,i,C){return"".concat(b).concat(C===0?"M":"L").concat(i.x,",").concat(i.y)},"")}).join("");return o.length===1?"".concat(h,"Z"):h},Ume=function(t,a,o){var h=_1(t,o);return"".concat(h.slice(-1)==="Z"?h.slice(0,-1):h,"L").concat(_1(a.reverse(),o).slice(1))},Vme=function(t){var a=t.points,o=t.className,h=t.baseLinePoints,y=t.connectNulls,b=Lme(t,Dme);if(!a||!a.length)return null;var i=oi("recharts-polygon",o);if(h&&h.length){var C=b.stroke&&b.stroke!=="none",I=Ume(a,h,y);return Ot.createElement("g",{className:i},Ot.createElement("path",Ag({},Fr(b,!0),{fill:I.slice(-1)==="Z"?b.fill:"none",stroke:"none",d:I})),C?Ot.createElement("path",Ag({},Fr(b,!0),{fill:"none",d:_1(a,y)})):null,C?Ot.createElement("path",Ag({},Fr(b,!0),{fill:"none",d:_1(h,y)})):null)}var j=_1(a,y);return Ot.createElement("path",Ag({},Fr(b,!0),{fill:j.slice(-1)==="Z"?b.fill:"none",className:i,d:j}))};function m4(){return m4=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},m4.apply(this,arguments)}var bP=function(t){var a=t.cx,o=t.cy,h=t.r,y=t.className,b=oi("recharts-dot",y);return a===+a&&o===+o&&h===+h?Ot.createElement("circle",m4({},Fr(t,!1),Fb(t),{className:b,cx:a,cy:o,r:h})):null};function n2(e){"@babel/helpers - typeof";return n2=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n2(e)}var $me=["x","y","top","left","width","height","className"];function _4(){return _4=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},_4.apply(this,arguments)}function i7(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(h){return Object.getOwnPropertyDescriptor(e,h).enumerable})),a.push.apply(a,o)}return a}function qme(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?i7(Object(a),!0).forEach(function(o){Gme(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i7(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function Gme(e,t,a){return t=Hme(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Hme(e){var t=Zme(e,"string");return n2(t)=="symbol"?t:t+""}function Zme(e,t){if(n2(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t);if(n2(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Wme(e,t){if(e==null)return{};var a=Xme(e,t),o,h;if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(e);for(h=0;h<y.length;h++)o=y[h],!(t.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(a[o]=e[o])}return a}function Xme(e,t){if(e==null)return{};var a={};for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){if(t.indexOf(o)>=0)continue;a[o]=e[o]}return a}var Yme=function(t,a,o,h,y,b){return"M".concat(t,",").concat(y,"v").concat(h,"M").concat(b,",").concat(a,"h").concat(o)},Kme=function(t){var a=t.x,o=a===void 0?0:a,h=t.y,y=h===void 0?0:h,b=t.top,i=b===void 0?0:b,C=t.left,I=C===void 0?0:C,j=t.width,F=j===void 0?0:j,G=t.height,X=G===void 0?0:G,Y=t.className,J=Wme(t,$me),ee=qme({x:o,y,top:i,left:I,width:F,height:X},J);return!Nn(o)||!Nn(y)||!Nn(F)||!Nn(X)||!Nn(i)||!Nn(I)?null:Ot.createElement("path",_4({},Fr(ee,!0),{className:oi("recharts-cross",Y),d:Yme(o,y,F,X,i,I)}))},uM,a7;function Jme(){if(a7)return uM;a7=1;var e=xS(),t=AU(),a=Ef();function o(h,y){return h&&h.length?e(h,a(y,2),t):void 0}return uM=o,uM}var Qme=Jme();const e0e=Ei(Qme);var hM,o7;function t0e(){if(o7)return hM;o7=1;var e=xS(),t=Ef(),a=CU();function o(h,y){return h&&h.length?e(h,t(y,2),a):void 0}return hM=o,hM}var n0e=t0e();const r0e=Ei(n0e);var i0e=["cx","cy","angle","ticks","axisLine"],a0e=["ticks","tick","angle","tickFormatter","stroke"];function Qg(e){"@babel/helpers - typeof";return Qg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qg(e)}function g1(){return g1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},g1.apply(this,arguments)}function s7(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(h){return Object.getOwnPropertyDescriptor(e,h).enumerable})),a.push.apply(a,o)}return a}function I0(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?s7(Object(a),!0).forEach(function(o){ES(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):s7(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function l7(e,t){if(e==null)return{};var a=o0e(e,t),o,h;if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(e);for(h=0;h<y.length;h++)o=y[h],!(t.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(a[o]=e[o])}return a}function o0e(e,t){if(e==null)return{};var a={};for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){if(t.indexOf(o)>=0)continue;a[o]=e[o]}return a}function s0e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c7(e,t){for(var a=0;a<t.length;a++){var o=t[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,cV(o.key),o)}}function l0e(e,t,a){return t&&c7(e.prototype,t),a&&c7(e,a),Object.defineProperty(e,"prototype",{writable:!1}),e}function c0e(e,t,a){return t=mw(t),u0e(e,lV()?Reflect.construct(t,a||[],mw(e).constructor):t.apply(e,a))}function u0e(e,t){if(t&&(Qg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return h0e(e)}function h0e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function lV(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(lV=function(){return!!e})()}function mw(e){return mw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)},mw(e)}function f0e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&g4(e,t)}function g4(e,t){return g4=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,h){return o.__proto__=h,o},g4(e,t)}function ES(e,t,a){return t=cV(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function cV(e){var t=d0e(e,"string");return Qg(t)=="symbol"?t:t+""}function d0e(e,t){if(Qg(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t);if(Qg(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var AS=function(e){function t(){return s0e(this,t),c0e(this,t,arguments)}return f0e(t,e),l0e(t,[{key:"getTickValueCoord",value:function(o){var h=o.coordinate,y=this.props,b=y.angle,i=y.cx,C=y.cy;return Xi(i,C,h,b)}},{key:"getTickTextAnchor",value:function(){var o=this.props.orientation,h;switch(o){case"left":h="end";break;case"right":h="start";break;default:h="middle";break}return h}},{key:"getViewBox",value:function(){var o=this.props,h=o.cx,y=o.cy,b=o.angle,i=o.ticks,C=e0e(i,function(j){return j.coordinate||0}),I=r0e(i,function(j){return j.coordinate||0});return{cx:h,cy:y,startAngle:b,endAngle:b,innerRadius:I.coordinate||0,outerRadius:C.coordinate||0}}},{key:"renderAxisLine",value:function(){var o=this.props,h=o.cx,y=o.cy,b=o.angle,i=o.ticks,C=o.axisLine,I=l7(o,i0e),j=i.reduce(function(Y,J){return[Math.min(Y[0],J.coordinate),Math.max(Y[1],J.coordinate)]},[1/0,-1/0]),F=Xi(h,y,j[0],b),G=Xi(h,y,j[1],b),X=I0(I0(I0({},Fr(I,!1)),{},{fill:"none"},Fr(C,!1)),{},{x1:F.x,y1:F.y,x2:G.x,y2:G.y});return Ot.createElement("line",g1({className:"recharts-polar-radius-axis-line"},X))}},{key:"renderTicks",value:function(){var o=this,h=this.props,y=h.ticks,b=h.tick,i=h.angle,C=h.tickFormatter,I=h.stroke,j=l7(h,a0e),F=this.getTickTextAnchor(),G=Fr(j,!1),X=Fr(b,!1),Y=y.map(function(J,ee){var oe=o.getTickValueCoord(J),ge=I0(I0(I0(I0({textAnchor:F,transform:"rotate(".concat(90-i,", ").concat(oe.x,", ").concat(oe.y,")")},G),{},{stroke:"none",fill:I},X),{},{index:ee},oe),{},{payload:J});return Ot.createElement(Ga,g1({className:oi("recharts-polar-radius-axis-tick",YU(b)),key:"tick-".concat(J.coordinate)},aS(o.props,J,ee)),t.renderTickItem(b,ge,C?C(J.value,ee):J.value))});return Ot.createElement(Ga,{className:"recharts-polar-radius-axis-ticks"},Y)}},{key:"render",value:function(){var o=this.props,h=o.ticks,y=o.axisLine,b=o.tick;return!h||!h.length?null:Ot.createElement(Ga,{className:oi("recharts-polar-radius-axis",this.props.className)},y&&this.renderAxisLine(),b&&this.renderTicks(),rs.renderCallByParent(this.props,this.getViewBox()))}}],[{key:"renderTickItem",value:function(o,h,y){var b;return Ot.isValidElement(o)?b=Ot.cloneElement(o,h):Vr(o)?b=o(h):b=Ot.createElement(Hg,g1({},h,{className:"recharts-polar-radius-axis-tick-value"}),y),b}}])}(Ie.PureComponent);ES(AS,"displayName","PolarRadiusAxis");ES(AS,"axisType","radiusAxis");ES(AS,"defaultProps",{type:"number",radiusAxisId:0,cx:0,cy:0,angle:0,orientation:"right",stroke:"#ccc",axisLine:!0,tick:!0,tickCount:5,allowDataOverflow:!1,scale:"auto",allowDuplicatedCategory:!0});function ey(e){"@babel/helpers - typeof";return ey=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ey(e)}function z0(){return z0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},z0.apply(this,arguments)}function u7(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(h){return Object.getOwnPropertyDescriptor(e,h).enumerable})),a.push.apply(a,o)}return a}function R0(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?u7(Object(a),!0).forEach(function(o){CS(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):u7(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function p0e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h7(e,t){for(var a=0;a<t.length;a++){var o=t[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,hV(o.key),o)}}function m0e(e,t,a){return t&&h7(e.prototype,t),a&&h7(e,a),Object.defineProperty(e,"prototype",{writable:!1}),e}function _0e(e,t,a){return t=_w(t),g0e(e,uV()?Reflect.construct(t,a||[],_w(e).constructor):t.apply(e,a))}function g0e(e,t){if(t&&(ey(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return y0e(e)}function y0e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function uV(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(uV=function(){return!!e})()}function _w(e){return _w=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)},_w(e)}function v0e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&y4(e,t)}function y4(e,t){return y4=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,h){return o.__proto__=h,o},y4(e,t)}function CS(e,t,a){return t=hV(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function hV(e){var t=x0e(e,"string");return ey(t)=="symbol"?t:t+""}function x0e(e,t){if(ey(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t);if(ey(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var b0e=Math.PI/180,w0e=1e-5,MS=function(e){function t(){return p0e(this,t),_0e(this,t,arguments)}return v0e(t,e),m0e(t,[{key:"getTickLineCoord",value:function(o){var h=this.props,y=h.cx,b=h.cy,i=h.radius,C=h.orientation,I=h.tickSize,j=I||8,F=Xi(y,b,i,o.coordinate),G=Xi(y,b,i+(C==="inner"?-1:1)*j,o.coordinate);return{x1:F.x,y1:F.y,x2:G.x,y2:G.y}}},{key:"getTickTextAnchor",value:function(o){var h=this.props.orientation,y=Math.cos(-o.coordinate*b0e),b;return y>w0e?b=h==="outer"?"start":"end":y<-1e-5?b=h==="outer"?"end":"start":b="middle",b}},{key:"renderAxisLine",value:function(){var o=this.props,h=o.cx,y=o.cy,b=o.radius,i=o.axisLine,C=o.axisLineType,I=R0(R0({},Fr(this.props,!1)),{},{fill:"none"},Fr(i,!1));if(C==="circle")return Ot.createElement(bP,z0({className:"recharts-polar-angle-axis-line"},I,{cx:h,cy:y,r:b}));var j=this.props.ticks,F=j.map(function(G){return Xi(h,y,b,G.coordinate)});return Ot.createElement(Vme,z0({className:"recharts-polar-angle-axis-line"},I,{points:F}))}},{key:"renderTicks",value:function(){var o=this,h=this.props,y=h.ticks,b=h.tick,i=h.tickLine,C=h.tickFormatter,I=h.stroke,j=Fr(this.props,!1),F=Fr(b,!1),G=R0(R0({},j),{},{fill:"none"},Fr(i,!1)),X=y.map(function(Y,J){var ee=o.getTickLineCoord(Y),oe=o.getTickTextAnchor(Y),ge=R0(R0(R0({textAnchor:oe},j),{},{stroke:"none",fill:I},F),{},{index:J,payload:Y,x:ee.x2,y:ee.y2});return Ot.createElement(Ga,z0({className:oi("recharts-polar-angle-axis-tick",YU(b)),key:"tick-".concat(Y.coordinate)},aS(o.props,Y,J)),i&&Ot.createElement("line",z0({className:"recharts-polar-angle-axis-tick-line"},G,ee)),b&&t.renderTickItem(b,ge,C?C(Y.value,J):Y.value))});return Ot.createElement(Ga,{className:"recharts-polar-angle-axis-ticks"},X)}},{key:"render",value:function(){var o=this.props,h=o.ticks,y=o.radius,b=o.axisLine;return y<=0||!h||!h.length?null:Ot.createElement(Ga,{className:oi("recharts-polar-angle-axis",this.props.className)},b&&this.renderAxisLine(),this.renderTicks())}}],[{key:"renderTickItem",value:function(o,h,y){var b;return Ot.isValidElement(o)?b=Ot.cloneElement(o,h):Vr(o)?b=o(h):b=Ot.createElement(Hg,z0({},h,{className:"recharts-polar-angle-axis-tick-value"}),y),b}}])}(Ie.PureComponent);CS(MS,"displayName","PolarAngleAxis");CS(MS,"axisType","angleAxis");CS(MS,"defaultProps",{type:"category",angleAxisId:0,scale:"auto",cx:0,cy:0,orientation:"outer",axisLine:!0,tickLine:!0,tickSize:8,tick:!0,hide:!1,allowDuplicatedCategory:!0});var fM,f7;function S0e(){if(f7)return fM;f7=1;var e=Tj(),t=e(Object.getPrototypeOf,Object);return fM=t,fM}var dM,d7;function T0e(){if(d7)return dM;d7=1;var e=ep(),t=S0e(),a=tp(),o="[object Object]",h=Function.prototype,y=Object.prototype,b=h.toString,i=y.hasOwnProperty,C=b.call(Object);function I(j){if(!a(j)||e(j)!=o)return!1;var F=t(j);if(F===null)return!0;var G=i.call(F,"constructor")&&F.constructor;return typeof G=="function"&&G instanceof G&&b.call(G)==C}return dM=I,dM}var E0e=T0e();const A0e=Ei(E0e);var pM,p7;function C0e(){if(p7)return pM;p7=1;var e=ep(),t=tp(),a="[object Boolean]";function o(h){return h===!0||h===!1||t(h)&&e(h)==a}return pM=o,pM}var M0e=C0e();const O0e=Ei(M0e);function r2(e){"@babel/helpers - typeof";return r2=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r2(e)}function gw(){return gw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},gw.apply(this,arguments)}function P0e(e,t){return L0e(e)||D0e(e,t)||R0e(e,t)||I0e()}function I0e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function R0e(e,t){if(e){if(typeof e=="string")return m7(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return m7(e,t)}}function m7(e,t){(t==null||t>e.length)&&(t=e.length);for(var a=0,o=new Array(t);a<t;a++)o[a]=e[a];return o}function D0e(e,t){var a=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(a!=null){var o,h,y,b,i=[],C=!0,I=!1;try{if(y=(a=a.call(e)).next,t!==0)for(;!(C=(o=y.call(a)).done)&&(i.push(o.value),i.length!==t);C=!0);}catch(j){I=!0,h=j}finally{try{if(!C&&a.return!=null&&(b=a.return(),Object(b)!==b))return}finally{if(I)throw h}}return i}}function L0e(e){if(Array.isArray(e))return e}function _7(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(h){return Object.getOwnPropertyDescriptor(e,h).enumerable})),a.push.apply(a,o)}return a}function g7(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?_7(Object(a),!0).forEach(function(o){k0e(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):_7(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function k0e(e,t,a){return t=z0e(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function z0e(e){var t=B0e(e,"string");return r2(t)=="symbol"?t:t+""}function B0e(e,t){if(r2(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t);if(r2(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var y7=function(t,a,o,h,y){var b=o-h,i;return i="M ".concat(t,",").concat(a),i+="L ".concat(t+o,",").concat(a),i+="L ".concat(t+o-b/2,",").concat(a+y),i+="L ".concat(t+o-b/2-h,",").concat(a+y),i+="L ".concat(t,",").concat(a," Z"),i},N0e={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},F0e=function(t){var a=g7(g7({},N0e),t),o=Ie.useRef(),h=Ie.useState(-1),y=P0e(h,2),b=y[0],i=y[1];Ie.useEffect(function(){if(o.current&&o.current.getTotalLength)try{var fe=o.current.getTotalLength();fe&&i(fe)}catch{}},[]);var C=a.x,I=a.y,j=a.upperWidth,F=a.lowerWidth,G=a.height,X=a.className,Y=a.animationEasing,J=a.animationDuration,ee=a.animationBegin,oe=a.isUpdateAnimationActive;if(C!==+C||I!==+I||j!==+j||F!==+F||G!==+G||j===0&&F===0||G===0)return null;var ge=oi("recharts-trapezoid",X);return oe?Ot.createElement(pm,{canBegin:b>0,from:{upperWidth:0,lowerWidth:0,height:G,x:C,y:I},to:{upperWidth:j,lowerWidth:F,height:G,x:C,y:I},duration:J,animationEasing:Y,isActive:oe},function(fe){var xe=fe.upperWidth,ae=fe.lowerWidth,me=fe.height,we=fe.x,Ge=fe.y;return Ot.createElement(pm,{canBegin:b>0,from:"0px ".concat(b===-1?1:b,"px"),to:"".concat(b,"px 0px"),attributeName:"strokeDasharray",begin:ee,duration:J,easing:Y},Ot.createElement("path",gw({},Fr(a,!0),{className:ge,d:y7(we,Ge,xe,ae,me),ref:o})))}):Ot.createElement("g",null,Ot.createElement("path",gw({},Fr(a,!0),{className:ge,d:y7(C,I,j,F,G)})))},j0e=["option","shapeType","propTransformer","activeClassName","isActive"];function i2(e){"@babel/helpers - typeof";return i2=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i2(e)}function U0e(e,t){if(e==null)return{};var a=V0e(e,t),o,h;if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(e);for(h=0;h<y.length;h++)o=y[h],!(t.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(a[o]=e[o])}return a}function V0e(e,t){if(e==null)return{};var a={};for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){if(t.indexOf(o)>=0)continue;a[o]=e[o]}return a}function v7(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(h){return Object.getOwnPropertyDescriptor(e,h).enumerable})),a.push.apply(a,o)}return a}function yw(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?v7(Object(a),!0).forEach(function(o){$0e(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):v7(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function $0e(e,t,a){return t=q0e(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function q0e(e){var t=G0e(e,"string");return i2(t)=="symbol"?t:t+""}function G0e(e,t){if(i2(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t);if(i2(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function H0e(e,t){return yw(yw({},t),e)}function Z0e(e,t){return e==="symbols"}function x7(e){var t=e.shapeType,a=e.elementProps;switch(t){case"rectangle":return Ot.createElement(xP,a);case"trapezoid":return Ot.createElement(F0e,a);case"sector":return Ot.createElement(QU,a);case"symbols":if(Z0e(t))return Ot.createElement(BO,a);break;default:return null}}function W0e(e){return Ie.isValidElement(e)?e.props:e}function X0e(e){var t=e.option,a=e.shapeType,o=e.propTransformer,h=o===void 0?H0e:o,y=e.activeClassName,b=y===void 0?"recharts-active-shape":y,i=e.isActive,C=U0e(e,j0e),I;if(Ie.isValidElement(t))I=Ie.cloneElement(t,yw(yw({},C),W0e(t)));else if(Vr(t))I=t(C);else if(A0e(t)&&!O0e(t)){var j=h(t,C);I=Ot.createElement(x7,{shapeType:a,elementProps:j})}else{var F=C;I=Ot.createElement(x7,{shapeType:a,elementProps:F})}return i?Ot.createElement(Ga,{className:b},I):I}function OS(e,t){return t!=null&&"trapezoids"in e.props}function PS(e,t){return t!=null&&"sectors"in e.props}function a2(e,t){return t!=null&&"points"in e.props}function Y0e(e,t){var a,o,h=e.x===(t==null||(a=t.labelViewBox)===null||a===void 0?void 0:a.x)||e.x===t.x,y=e.y===(t==null||(o=t.labelViewBox)===null||o===void 0?void 0:o.y)||e.y===t.y;return h&&y}function K0e(e,t){var a=e.endAngle===t.endAngle,o=e.startAngle===t.startAngle;return a&&o}function J0e(e,t){var a=e.x===t.x,o=e.y===t.y,h=e.z===t.z;return a&&o&&h}function Q0e(e,t){var a;return OS(e,t)?a=Y0e:PS(e,t)?a=K0e:a2(e,t)&&(a=J0e),a}function e_e(e,t){var a;return OS(e,t)?a="trapezoids":PS(e,t)?a="sectors":a2(e,t)&&(a="points"),a}function t_e(e,t){if(OS(e,t)){var a;return(a=t.tooltipPayload)===null||a===void 0||(a=a[0])===null||a===void 0||(a=a.payload)===null||a===void 0?void 0:a.payload}if(PS(e,t)){var o;return(o=t.tooltipPayload)===null||o===void 0||(o=o[0])===null||o===void 0||(o=o.payload)===null||o===void 0?void 0:o.payload}return a2(e,t)?t.payload:{}}function n_e(e){var t=e.activeTooltipItem,a=e.graphicalItem,o=e.itemData,h=e_e(a,t),y=t_e(a,t),b=o.filter(function(C,I){var j=mP(y,C),F=a.props[h].filter(function(Y){var J=Q0e(a,t);return J(Y,t)}),G=a.props[h].indexOf(F[F.length-1]),X=I===G;return j&&X}),i=o.indexOf(b[b.length-1]);return i}var Cb;function ty(e){"@babel/helpers - typeof";return ty=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ty(e)}function Cg(){return Cg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},Cg.apply(this,arguments)}function b7(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(h){return Object.getOwnPropertyDescriptor(e,h).enumerable})),a.push.apply(a,o)}return a}function Zi(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?b7(Object(a),!0).forEach(function(o){su(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):b7(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function r_e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function w7(e,t){for(var a=0;a<t.length;a++){var o=t[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,dV(o.key),o)}}function i_e(e,t,a){return t&&w7(e.prototype,t),a&&w7(e,a),Object.defineProperty(e,"prototype",{writable:!1}),e}function a_e(e,t,a){return t=vw(t),o_e(e,fV()?Reflect.construct(t,a||[],vw(e).constructor):t.apply(e,a))}function o_e(e,t){if(t&&(ty(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return s_e(e)}function s_e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function fV(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(fV=function(){return!!e})()}function vw(e){return vw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)},vw(e)}function l_e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&v4(e,t)}function v4(e,t){return v4=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,h){return o.__proto__=h,o},v4(e,t)}function su(e,t,a){return t=dV(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function dV(e){var t=c_e(e,"string");return ty(t)=="symbol"?t:t+""}function c_e(e,t){if(ty(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t);if(ty(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var bf=function(e){function t(a){var o;return r_e(this,t),o=a_e(this,t,[a]),su(o,"pieRef",null),su(o,"sectorRefs",[]),su(o,"id",iS("recharts-pie-")),su(o,"handleAnimationEnd",function(){var h=o.props.onAnimationEnd;o.setState({isAnimationFinished:!0}),Vr(h)&&h()}),su(o,"handleAnimationStart",function(){var h=o.props.onAnimationStart;o.setState({isAnimationFinished:!1}),Vr(h)&&h()}),o.state={isAnimationFinished:!a.isAnimationActive,prevIsAnimationActive:a.isAnimationActive,prevAnimationId:a.animationId,sectorToFocus:0},o}return l_e(t,e),i_e(t,[{key:"isActiveIndex",value:function(o){var h=this.props.activeIndex;return Array.isArray(h)?h.indexOf(o)!==-1:o===h}},{key:"hasActiveIndex",value:function(){var o=this.props.activeIndex;return Array.isArray(o)?o.length!==0:o||o===0}},{key:"renderLabels",value:function(o){var h=this.props.isAnimationActive;if(h&&!this.state.isAnimationFinished)return null;var y=this.props,b=y.label,i=y.labelLine,C=y.dataKey,I=y.valueKey,j=Fr(this.props,!1),F=Fr(b,!1),G=Fr(i,!1),X=b&&b.offsetRadius||20,Y=o.map(function(J,ee){var oe=(J.startAngle+J.endAngle)/2,ge=Xi(J.cx,J.cy,J.outerRadius+X,oe),fe=Zi(Zi(Zi(Zi({},j),J),{},{stroke:"none"},F),{},{index:ee,textAnchor:t.getTextAnchor(ge.x,J.cx)},ge),xe=Zi(Zi(Zi(Zi({},j),J),{},{fill:"none",stroke:J.fill},G),{},{index:ee,points:[Xi(J.cx,J.cy,J.outerRadius,oe),ge]}),ae=C;return ei(C)&&ei(I)?ae="value":ei(C)&&(ae=I),Ot.createElement(Ga,{key:"label-".concat(J.startAngle,"-").concat(J.endAngle,"-").concat(J.midAngle,"-").concat(ee)},i&&t.renderLabelLineItem(i,xe,"line"),t.renderLabelItem(b,fe,ac(J,ae)))});return Ot.createElement(Ga,{className:"recharts-pie-labels"},Y)}},{key:"renderSectorsStatically",value:function(o){var h=this,y=this.props,b=y.activeShape,i=y.blendStroke,C=y.inactiveShape;return o.map(function(I,j){if((I==null?void 0:I.startAngle)===0&&(I==null?void 0:I.endAngle)===0&&o.length!==1)return null;var F=h.isActiveIndex(j),G=C&&h.hasActiveIndex()?C:null,X=F?b:G,Y=Zi(Zi({},I),{},{stroke:i?I.fill:I.stroke,tabIndex:-1});return Ot.createElement(Ga,Cg({ref:function(ee){ee&&!h.sectorRefs.includes(ee)&&h.sectorRefs.push(ee)},tabIndex:-1,className:"recharts-pie-sector"},aS(h.props,I,j),{key:"sector-".concat(I==null?void 0:I.startAngle,"-").concat(I==null?void 0:I.endAngle,"-").concat(I.midAngle,"-").concat(j)}),Ot.createElement(X0e,Cg({option:X,isActive:F,shapeType:"sector"},Y)))})}},{key:"renderSectorsWithAnimation",value:function(){var o=this,h=this.props,y=h.sectors,b=h.isAnimationActive,i=h.animationBegin,C=h.animationDuration,I=h.animationEasing,j=h.animationId,F=this.state,G=F.prevSectors,X=F.prevIsAnimationActive;return Ot.createElement(pm,{begin:i,duration:C,isActive:b,easing:I,from:{t:0},to:{t:1},key:"pie-".concat(j,"-").concat(X),onAnimationStart:this.handleAnimationStart,onAnimationEnd:this.handleAnimationEnd},function(Y){var J=Y.t,ee=[],oe=y&&y[0],ge=oe.startAngle;return y.forEach(function(fe,xe){var ae=G&&G[xe],me=xe>0?ah(fe,"paddingAngle",0):0;if(ae){var we=PL(ae.endAngle-ae.startAngle,fe.endAngle-fe.startAngle),Ge=Zi(Zi({},fe),{},{startAngle:ge+me,endAngle:ge+we(J)+me});ee.push(Ge),ge=Ge.endAngle}else{var He=fe.endAngle,ye=fe.startAngle,ke=PL(0,He-ye),dt=ke(J),vt=Zi(Zi({},fe),{},{startAngle:ge+me,endAngle:ge+dt+me});ee.push(vt),ge=vt.endAngle}}),Ot.createElement(Ga,null,o.renderSectorsStatically(ee))})}},{key:"attachKeyboardHandlers",value:function(o){var h=this;o.onkeydown=function(y){if(!y.altKey)switch(y.key){case"ArrowLeft":{var b=++h.state.sectorToFocus%h.sectorRefs.length;h.sectorRefs[b].focus(),h.setState({sectorToFocus:b});break}case"ArrowRight":{var i=--h.state.sectorToFocus<0?h.sectorRefs.length-1:h.state.sectorToFocus%h.sectorRefs.length;h.sectorRefs[i].focus(),h.setState({sectorToFocus:i});break}case"Escape":{h.sectorRefs[h.state.sectorToFocus].blur(),h.setState({sectorToFocus:0});break}}}}},{key:"renderSectors",value:function(){var o=this.props,h=o.sectors,y=o.isAnimationActive,b=this.state.prevSectors;return y&&h&&h.length&&(!b||!mP(b,h))?this.renderSectorsWithAnimation():this.renderSectorsStatically(h)}},{key:"componentDidMount",value:function(){this.pieRef&&this.attachKeyboardHandlers(this.pieRef)}},{key:"render",value:function(){var o=this,h=this.props,y=h.hide,b=h.sectors,i=h.className,C=h.label,I=h.cx,j=h.cy,F=h.innerRadius,G=h.outerRadius,X=h.isAnimationActive,Y=this.state.isAnimationFinished;if(y||!b||!b.length||!Nn(I)||!Nn(j)||!Nn(F)||!Nn(G))return null;var J=oi("recharts-pie",i);return Ot.createElement(Ga,{tabIndex:this.props.rootTabIndex,className:J,ref:function(oe){o.pieRef=oe}},this.renderSectors(),C&&this.renderLabels(b),rs.renderCallByParent(this.props,null,!1),(!X||Y)&&$0.renderCallByParent(this.props,b,!1))}}],[{key:"getDerivedStateFromProps",value:function(o,h){return h.prevIsAnimationActive!==o.isAnimationActive?{prevIsAnimationActive:o.isAnimationActive,prevAnimationId:o.animationId,curSectors:o.sectors,prevSectors:[],isAnimationFinished:!0}:o.isAnimationActive&&o.animationId!==h.prevAnimationId?{prevAnimationId:o.animationId,curSectors:o.sectors,prevSectors:h.curSectors,isAnimationFinished:!0}:o.sectors!==h.curSectors?{curSectors:o.sectors,isAnimationFinished:!0}:null}},{key:"getTextAnchor",value:function(o,h){return o>h?"start":o<h?"end":"middle"}},{key:"renderLabelLineItem",value:function(o,h,y){if(Ot.isValidElement(o))return Ot.cloneElement(o,h);if(Vr(o))return o(h);var b=oi("recharts-pie-label-line",typeof o!="boolean"?o.className:"");return Ot.createElement(i4,Cg({},h,{key:y,type:"linear",className:b}))}},{key:"renderLabelItem",value:function(o,h,y){if(Ot.isValidElement(o))return Ot.cloneElement(o,h);var b=y;if(Vr(o)&&(b=o(h),Ot.isValidElement(b)))return b;var i=oi("recharts-pie-label-text",typeof o!="boolean"&&!Vr(o)?o.className:"");return Ot.createElement(Hg,Cg({},h,{alignmentBaseline:"middle",className:i}),b)}}])}(Ie.PureComponent);Cb=bf;su(bf,"displayName","Pie");su(bf,"defaultProps",{stroke:"#fff",fill:"#808080",legendType:"rect",cx:"50%",cy:"50%",startAngle:0,endAngle:360,innerRadius:0,outerRadius:"80%",paddingAngle:0,labelLine:!0,hide:!1,minAngle:0,isAnimationActive:!dS.isSsr,animationBegin:400,animationDuration:1500,animationEasing:"ease",nameKey:"name",blendStroke:!1,rootTabIndex:0});su(bf,"parseDeltaAngle",function(e,t){var a=lu(t-e),o=Math.min(Math.abs(t-e),360);return a*o});su(bf,"getRealPieData",function(e){var t=e.data,a=e.children,o=Fr(e,!1),h=_f(a,Vj);return t&&t.length?t.map(function(y,b){return Zi(Zi(Zi({payload:y},o),y),h&&h[b]&&h[b].props)}):h&&h.length?h.map(function(y){return Zi(Zi({},o),y.props)}):[]});su(bf,"parseCoordinateOfPie",function(e,t){var a=t.top,o=t.left,h=t.width,y=t.height,b=XU(h,y),i=o+yl(e.cx,h,h/2),C=a+yl(e.cy,y,y/2),I=yl(e.innerRadius,b,0),j=yl(e.outerRadius,b,b*.8),F=e.maxRadius||Math.sqrt(h*h+y*y)/2;return{cx:i,cy:C,innerRadius:I,outerRadius:j,maxRadius:F}});su(bf,"getComposedData",function(e){var t=e.item,a=e.offset,o=t.type.defaultProps!==void 0?Zi(Zi({},t.type.defaultProps),t.props):t.props,h=Cb.getRealPieData(o);if(!h||!h.length)return null;var y=o.cornerRadius,b=o.startAngle,i=o.endAngle,C=o.paddingAngle,I=o.dataKey,j=o.nameKey,F=o.valueKey,G=o.tooltipType,X=Math.abs(o.minAngle),Y=Cb.parseCoordinateOfPie(o,a),J=Cb.parseDeltaAngle(b,i),ee=Math.abs(J),oe=I;ei(I)&&ei(F)?(qd(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),oe="value"):ei(I)&&(qd(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),oe=F);var ge=h.filter(function(Ge){return ac(Ge,oe,0)!==0}).length,fe=(ee>=360?ge:ge-1)*C,xe=ee-ge*X-fe,ae=h.reduce(function(Ge,He){var ye=ac(He,oe,0);return Ge+(Nn(ye)?ye:0)},0),me;if(ae>0){var we;me=h.map(function(Ge,He){var ye=ac(Ge,oe,0),ke=ac(Ge,j,He),dt=(Nn(ye)?ye:0)/ae,vt;He?vt=we.endAngle+lu(J)*C*(ye!==0?1:0):vt=b;var jt=vt+lu(J)*((ye!==0?X:0)+dt*xe),_t=(vt+jt)/2,gt=(Y.innerRadius+Y.outerRadius)/2,Vt=[{name:ke,value:ye,payload:Ge,dataKey:oe,type:G}],Ht=Xi(Y.cx,Y.cy,gt,_t);return we=Zi(Zi(Zi({percent:dt,cornerRadius:y,name:ke,tooltipPayload:Vt,midAngle:_t,middleRadius:gt,tooltipPosition:Ht},Ge),Y),{},{value:ac(Ge,oe),startAngle:vt,endAngle:jt,payload:Ge,paddingAngle:lu(J)*C}),we})}return Zi(Zi({},Y),{},{sectors:me,data:h})});var mM,S7;function u_e(){if(S7)return mM;S7=1;var e=Math.ceil,t=Math.max;function a(o,h,y,b){for(var i=-1,C=t(e((h-o)/(y||1)),0),I=Array(C);C--;)I[b?C:++i]=o,o+=y;return I}return mM=a,mM}var _M,T7;function pV(){if(T7)return _M;T7=1;var e=jj(),t=1/0,a=17976931348623157e292;function o(h){if(!h)return h===0?h:0;if(h=e(h),h===t||h===-1/0){var y=h<0?-1:1;return y*a}return h===h?h:0}return _M=o,_M}var gM,E7;function h_e(){if(E7)return gM;E7=1;var e=u_e(),t=fS(),a=pV();function o(h){return function(y,b,i){return i&&typeof i!="number"&&t(y,b,i)&&(b=i=void 0),y=a(y),b===void 0?(b=y,y=0):b=a(b),i=i===void 0?y<b?1:-1:a(i),e(y,b,i,h)}}return gM=o,gM}var yM,A7;function f_e(){if(A7)return yM;A7=1;var e=h_e(),t=e();return yM=t,yM}var d_e=f_e();const xw=Ei(d_e);function o2(e){"@babel/helpers - typeof";return o2=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o2(e)}function C7(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(h){return Object.getOwnPropertyDescriptor(e,h).enumerable})),a.push.apply(a,o)}return a}function M7(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?C7(Object(a),!0).forEach(function(o){mV(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):C7(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function mV(e,t,a){return t=p_e(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function p_e(e){var t=m_e(e,"string");return o2(t)=="symbol"?t:t+""}function m_e(e,t){if(o2(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t);if(o2(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var __e=["Webkit","Moz","O","ms"],g_e=function(t,a){var o=t.replace(/(\w)/,function(y){return y.toUpperCase()}),h=__e.reduce(function(y,b){return M7(M7({},y),{},mV({},b+o,a))},{});return h[t]=a,h};function ny(e){"@babel/helpers - typeof";return ny=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ny(e)}function bw(){return bw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},bw.apply(this,arguments)}function O7(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(h){return Object.getOwnPropertyDescriptor(e,h).enumerable})),a.push.apply(a,o)}return a}function vM(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?O7(Object(a),!0).forEach(function(o){nc(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):O7(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function y_e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function P7(e,t){for(var a=0;a<t.length;a++){var o=t[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,gV(o.key),o)}}function v_e(e,t,a){return t&&P7(e.prototype,t),a&&P7(e,a),Object.defineProperty(e,"prototype",{writable:!1}),e}function x_e(e,t,a){return t=ww(t),b_e(e,_V()?Reflect.construct(t,a||[],ww(e).constructor):t.apply(e,a))}function b_e(e,t){if(t&&(ny(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return w_e(e)}function w_e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _V(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(_V=function(){return!!e})()}function ww(e){return ww=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)},ww(e)}function S_e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&x4(e,t)}function x4(e,t){return x4=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,h){return o.__proto__=h,o},x4(e,t)}function nc(e,t,a){return t=gV(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function gV(e){var t=T_e(e,"string");return ny(t)=="symbol"?t:t+""}function T_e(e,t){if(ny(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t);if(ny(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var E_e=function(t){var a=t.data,o=t.startIndex,h=t.endIndex,y=t.x,b=t.width,i=t.travellerWidth;if(!a||!a.length)return{};var C=a.length,I=d1().domain(xw(0,C)).range([y,y+b-i]),j=I.domain().map(function(F){return I(F)});return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,isTravellerFocused:!1,startX:I(o),endX:I(h),scale:I,scaleValues:j}},I7=function(t){return t.changedTouches&&!!t.changedTouches.length},ry=function(e){function t(a){var o;return y_e(this,t),o=x_e(this,t,[a]),nc(o,"handleDrag",function(h){o.leaveTimer&&(clearTimeout(o.leaveTimer),o.leaveTimer=null),o.state.isTravellerMoving?o.handleTravellerMove(h):o.state.isSlideMoving&&o.handleSlideDrag(h)}),nc(o,"handleTouchMove",function(h){h.changedTouches!=null&&h.changedTouches.length>0&&o.handleDrag(h.changedTouches[0])}),nc(o,"handleDragEnd",function(){o.setState({isTravellerMoving:!1,isSlideMoving:!1},function(){var h=o.props,y=h.endIndex,b=h.onDragEnd,i=h.startIndex;b==null||b({endIndex:y,startIndex:i})}),o.detachDragEndListener()}),nc(o,"handleLeaveWrapper",function(){(o.state.isTravellerMoving||o.state.isSlideMoving)&&(o.leaveTimer=window.setTimeout(o.handleDragEnd,o.props.leaveTimeOut))}),nc(o,"handleEnterSlideOrTraveller",function(){o.setState({isTextActive:!0})}),nc(o,"handleLeaveSlideOrTraveller",function(){o.setState({isTextActive:!1})}),nc(o,"handleSlideDragStart",function(h){var y=I7(h)?h.changedTouches[0]:h;o.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:y.pageX}),o.attachDragEndListener()}),o.travellerDragStartHandlers={startX:o.handleTravellerDragStart.bind(o,"startX"),endX:o.handleTravellerDragStart.bind(o,"endX")},o.state={},o}return S_e(t,e),v_e(t,[{key:"componentWillUnmount",value:function(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}},{key:"getIndex",value:function(o){var h=o.startX,y=o.endX,b=this.state.scaleValues,i=this.props,C=i.gap,I=i.data,j=I.length-1,F=Math.min(h,y),G=Math.max(h,y),X=t.getIndexInRange(b,F),Y=t.getIndexInRange(b,G);return{startIndex:X-X%C,endIndex:Y===j?j:Y-Y%C}}},{key:"getTextOfTick",value:function(o){var h=this.props,y=h.data,b=h.tickFormatter,i=h.dataKey,C=ac(y[o],i,o);return Vr(b)?b(C,o):C}},{key:"attachDragEndListener",value:function(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}},{key:"detachDragEndListener",value:function(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}},{key:"handleSlideDrag",value:function(o){var h=this.state,y=h.slideMoveStartX,b=h.startX,i=h.endX,C=this.props,I=C.x,j=C.width,F=C.travellerWidth,G=C.startIndex,X=C.endIndex,Y=C.onChange,J=o.pageX-y;J>0?J=Math.min(J,I+j-F-i,I+j-F-b):J<0&&(J=Math.max(J,I-b,I-i));var ee=this.getIndex({startX:b+J,endX:i+J});(ee.startIndex!==G||ee.endIndex!==X)&&Y&&Y(ee),this.setState({startX:b+J,endX:i+J,slideMoveStartX:o.pageX})}},{key:"handleTravellerDragStart",value:function(o,h){var y=I7(h)?h.changedTouches[0]:h;this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:o,brushMoveStartX:y.pageX}),this.attachDragEndListener()}},{key:"handleTravellerMove",value:function(o){var h=this.state,y=h.brushMoveStartX,b=h.movingTravellerId,i=h.endX,C=h.startX,I=this.state[b],j=this.props,F=j.x,G=j.width,X=j.travellerWidth,Y=j.onChange,J=j.gap,ee=j.data,oe={startX:this.state.startX,endX:this.state.endX},ge=o.pageX-y;ge>0?ge=Math.min(ge,F+G-X-I):ge<0&&(ge=Math.max(ge,F-I)),oe[b]=I+ge;var fe=this.getIndex(oe),xe=fe.startIndex,ae=fe.endIndex,me=function(){var Ge=ee.length-1;return b==="startX"&&(i>C?xe%J===0:ae%J===0)||i<C&&ae===Ge||b==="endX"&&(i>C?ae%J===0:xe%J===0)||i>C&&ae===Ge};this.setState(nc(nc({},b,I+ge),"brushMoveStartX",o.pageX),function(){Y&&me()&&Y(fe)})}},{key:"handleTravellerMoveKeyboard",value:function(o,h){var y=this,b=this.state,i=b.scaleValues,C=b.startX,I=b.endX,j=this.state[h],F=i.indexOf(j);if(F!==-1){var G=F+o;if(!(G===-1||G>=i.length)){var X=i[G];h==="startX"&&X>=I||h==="endX"&&X<=C||this.setState(nc({},h,X),function(){y.props.onChange(y.getIndex({startX:y.state.startX,endX:y.state.endX}))})}}}},{key:"renderBackground",value:function(){var o=this.props,h=o.x,y=o.y,b=o.width,i=o.height,C=o.fill,I=o.stroke;return Ot.createElement("rect",{stroke:I,fill:C,x:h,y,width:b,height:i})}},{key:"renderPanorama",value:function(){var o=this.props,h=o.x,y=o.y,b=o.width,i=o.height,C=o.data,I=o.children,j=o.padding,F=Ie.Children.only(I);return F?Ot.cloneElement(F,{x:h,y,width:b,height:i,margin:j,compact:!0,data:C}):null}},{key:"renderTravellerLayer",value:function(o,h){var y,b,i=this,C=this.props,I=C.y,j=C.travellerWidth,F=C.height,G=C.traveller,X=C.ariaLabel,Y=C.data,J=C.startIndex,ee=C.endIndex,oe=Math.max(o,this.props.x),ge=vM(vM({},Fr(this.props,!1)),{},{x:oe,y:I,width:j,height:F}),fe=X||"Min value: ".concat((y=Y[J])===null||y===void 0?void 0:y.name,", Max value: ").concat((b=Y[ee])===null||b===void 0?void 0:b.name);return Ot.createElement(Ga,{tabIndex:0,role:"slider","aria-label":fe,"aria-valuenow":o,className:"recharts-brush-traveller",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers[h],onTouchStart:this.travellerDragStartHandlers[h],onKeyDown:function(ae){["ArrowLeft","ArrowRight"].includes(ae.key)&&(ae.preventDefault(),ae.stopPropagation(),i.handleTravellerMoveKeyboard(ae.key==="ArrowRight"?1:-1,h))},onFocus:function(){i.setState({isTravellerFocused:!0})},onBlur:function(){i.setState({isTravellerFocused:!1})},style:{cursor:"col-resize"}},t.renderTraveller(G,ge))}},{key:"renderSlide",value:function(o,h){var y=this.props,b=y.y,i=y.height,C=y.stroke,I=y.travellerWidth,j=Math.min(o,h)+I,F=Math.max(Math.abs(h-o)-I,0);return Ot.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart,style:{cursor:"move"},stroke:"none",fill:C,fillOpacity:.2,x:j,y:b,width:F,height:i})}},{key:"renderText",value:function(){var o=this.props,h=o.startIndex,y=o.endIndex,b=o.y,i=o.height,C=o.travellerWidth,I=o.stroke,j=this.state,F=j.startX,G=j.endX,X=5,Y={pointerEvents:"none",fill:I};return Ot.createElement(Ga,{className:"recharts-brush-texts"},Ot.createElement(Hg,bw({textAnchor:"end",verticalAnchor:"middle",x:Math.min(F,G)-X,y:b+i/2},Y),this.getTextOfTick(h)),Ot.createElement(Hg,bw({textAnchor:"start",verticalAnchor:"middle",x:Math.max(F,G)+C+X,y:b+i/2},Y),this.getTextOfTick(y)))}},{key:"render",value:function(){var o=this.props,h=o.data,y=o.className,b=o.children,i=o.x,C=o.y,I=o.width,j=o.height,F=o.alwaysShowText,G=this.state,X=G.startX,Y=G.endX,J=G.isTextActive,ee=G.isSlideMoving,oe=G.isTravellerMoving,ge=G.isTravellerFocused;if(!h||!h.length||!Nn(i)||!Nn(C)||!Nn(I)||!Nn(j)||I<=0||j<=0)return null;var fe=oi("recharts-brush",y),xe=Ot.Children.count(b)===1,ae=g_e("userSelect","none");return Ot.createElement(Ga,{className:fe,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:ae},this.renderBackground(),xe&&this.renderPanorama(),this.renderSlide(X,Y),this.renderTravellerLayer(X,"startX"),this.renderTravellerLayer(Y,"endX"),(J||ee||oe||ge||F)&&this.renderText())}}],[{key:"renderDefaultTraveller",value:function(o){var h=o.x,y=o.y,b=o.width,i=o.height,C=o.stroke,I=Math.floor(y+i/2)-1;return Ot.createElement(Ot.Fragment,null,Ot.createElement("rect",{x:h,y,width:b,height:i,fill:C,stroke:"none"}),Ot.createElement("line",{x1:h+1,y1:I,x2:h+b-1,y2:I,fill:"none",stroke:"#fff"}),Ot.createElement("line",{x1:h+1,y1:I+2,x2:h+b-1,y2:I+2,fill:"none",stroke:"#fff"}))}},{key:"renderTraveller",value:function(o,h){var y;return Ot.isValidElement(o)?y=Ot.cloneElement(o,h):Vr(o)?y=o(h):y=t.renderDefaultTraveller(h),y}},{key:"getDerivedStateFromProps",value:function(o,h){var y=o.data,b=o.width,i=o.x,C=o.travellerWidth,I=o.updateId,j=o.startIndex,F=o.endIndex;if(y!==h.prevData||I!==h.prevUpdateId)return vM({prevData:y,prevTravellerWidth:C,prevUpdateId:I,prevX:i,prevWidth:b},y&&y.length?E_e({data:y,width:b,x:i,travellerWidth:C,startIndex:j,endIndex:F}):{scale:null,scaleValues:null});if(h.scale&&(b!==h.prevWidth||i!==h.prevX||C!==h.prevTravellerWidth)){h.scale.range([i,i+b-C]);var G=h.scale.domain().map(function(X){return h.scale(X)});return{prevData:y,prevTravellerWidth:C,prevUpdateId:I,prevX:i,prevWidth:b,startX:h.scale(o.startIndex),endX:h.scale(o.endIndex),scaleValues:G}}return null}},{key:"getIndexInRange",value:function(o,h){for(var y=o.length,b=0,i=y-1;i-b>1;){var C=Math.floor((b+i)/2);o[C]>h?i=C:b=C}return h>=o[i]?i:b}}])}(Ie.PureComponent);nc(ry,"displayName","Brush");nc(ry,"defaultProps",{height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1});var xM,R7;function A_e(){if(R7)return xM;R7=1;var e=qO();function t(a,o){var h;return e(a,function(y,b,i){return h=o(y,b,i),!h}),!!h}return xM=t,xM}var bM,D7;function C_e(){if(D7)return bM;D7=1;var e=gj(),t=Ef(),a=A_e(),o=wl(),h=fS();function y(b,i,C){var I=o(b)?e:a;return C&&h(b,i,C)&&(i=void 0),I(b,t(i,3))}return bM=y,bM}var M_e=C_e();const O_e=Ei(M_e);var yf=function(t,a){var o=t.alwaysShow,h=t.ifOverflow;return o&&(h="extendDomain"),h===a},wM,L7;function P_e(){if(L7)return wM;L7=1;var e=kj();function t(a,o,h){o=="__proto__"&&e?e(a,o,{configurable:!0,enumerable:!0,value:h,writable:!0}):a[o]=h}return wM=t,wM}var SM,k7;function I_e(){if(k7)return SM;k7=1;var e=P_e(),t=Dj(),a=Ef();function o(h,y){var b={};return y=a(y,3),t(h,function(i,C,I){e(b,C,y(i,C,I))}),b}return SM=o,SM}var R_e=I_e();const D_e=Ei(R_e);var TM,z7;function L_e(){if(z7)return TM;z7=1;function e(t,a){for(var o=-1,h=t==null?0:t.length;++o<h;)if(!a(t[o],o,t))return!1;return!0}return TM=e,TM}var EM,B7;function k_e(){if(B7)return EM;B7=1;var e=qO();function t(a,o){var h=!0;return e(a,function(y,b,i){return h=!!o(y,b,i),h}),h}return EM=t,EM}var AM,N7;function z_e(){if(N7)return AM;N7=1;var e=L_e(),t=k_e(),a=Ef(),o=wl(),h=fS();function y(b,i,C){var I=o(b)?e:t;return C&&h(b,i,C)&&(i=void 0),I(b,a(i,3))}return AM=y,AM}var B_e=z_e();const N_e=Ei(B_e);function s2(e){"@babel/helpers - typeof";return s2=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s2(e)}function F_e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function F7(e,t){for(var a=0;a<t.length;a++){var o=t[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,yV(o.key),o)}}function j_e(e,t,a){return t&&F7(e.prototype,t),a&&F7(e,a),Object.defineProperty(e,"prototype",{writable:!1}),e}function j7(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(h){return Object.getOwnPropertyDescriptor(e,h).enumerable})),a.push.apply(a,o)}return a}function db(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?j7(Object(a),!0).forEach(function(o){wP(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):j7(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function wP(e,t,a){return t=yV(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function yV(e){var t=U_e(e,"string");return s2(t)=="symbol"?t:t+""}function U_e(e,t){if(s2(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t);if(s2(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var vV=function(t,a){var o=t.x,h=t.y,y=a.x,b=a.y;return{x:Math.min(o,y),y:Math.min(h,b),width:Math.abs(y-o),height:Math.abs(b-h)}},V_e=function(t){var a=t.x1,o=t.y1,h=t.x2,y=t.y2;return vV({x:a,y:o},{x:h,y})},xV=function(){function e(t){F_e(this,e),this.scale=t}return j_e(e,[{key:"domain",get:function(){return this.scale.domain}},{key:"range",get:function(){return this.scale.range}},{key:"rangeMin",get:function(){return this.range()[0]}},{key:"rangeMax",get:function(){return this.range()[1]}},{key:"bandwidth",get:function(){return this.scale.bandwidth}},{key:"apply",value:function(a){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},h=o.bandAware,y=o.position;if(a!==void 0){if(y)switch(y){case"start":return this.scale(a);case"middle":{var b=this.bandwidth?this.bandwidth()/2:0;return this.scale(a)+b}case"end":{var i=this.bandwidth?this.bandwidth():0;return this.scale(a)+i}default:return this.scale(a)}if(h){var C=this.bandwidth?this.bandwidth()/2:0;return this.scale(a)+C}return this.scale(a)}}},{key:"isInRange",value:function(a){var o=this.range(),h=o[0],y=o[o.length-1];return h<=y?a>=h&&a<=y:a>=y&&a<=h}}],[{key:"create",value:function(a){return new e(a)}}])}();wP(xV,"EPS",1e-4);var SP=function(t){var a=Object.keys(t).reduce(function(o,h){return db(db({},o),{},wP({},h,xV.create(t[h])))},{});return db(db({},a),{},{apply:function(h){var y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},b=y.bandAware,i=y.position;return D_e(h,function(C,I){return a[I].apply(C,{bandAware:b,position:i})})},isInRange:function(h){return N_e(h,function(y,b){return a[b].isInRange(y)})}})},CM,U7;function $_e(){if(U7)return CM;U7=1;var e=Ef(),t=T2(),a=uS();function o(h){return function(y,b,i){var C=Object(y);if(!t(y)){var I=e(b,3);y=a(y),b=function(F){return I(C[F],F,C)}}var j=h(y,b,i);return j>-1?C[I?y[j]:j]:void 0}}return CM=o,CM}var MM,V7;function q_e(){if(V7)return MM;V7=1;var e=pV();function t(a){var o=e(a),h=o%1;return o===o?h?o-h:o:0}return MM=t,MM}var OM,$7;function G_e(){if($7)return OM;$7=1;var e=Mj(),t=Ef(),a=q_e(),o=Math.max;function h(y,b,i){var C=y==null?0:y.length;if(!C)return-1;var I=i==null?0:a(i);return I<0&&(I=o(C+I,0)),e(y,t(b,3),I)}return OM=h,OM}var PM,q7;function H_e(){if(q7)return PM;q7=1;var e=$_e(),t=G_e(),a=e(t);return PM=a,PM}H_e();var Z_e=qF();const W_e=Ei(Z_e);var X_e=W_e(function(e){return{x:e.left,y:e.top,width:e.width,height:e.height}},function(e){return["l",e.left,"t",e.top,"w",e.width,"h",e.height].join("")}),bV=Ie.createContext(void 0),wV=Ie.createContext(void 0),SV=Ie.createContext(void 0),Y_e=Ie.createContext({}),TV=Ie.createContext(void 0),K_e=Ie.createContext(0),J_e=Ie.createContext(0),G7=function(t){var a=t.state,o=a.xAxisMap,h=a.yAxisMap,y=a.offset,b=t.clipPathId,i=t.children,C=t.width,I=t.height,j=X_e(y);return Ot.createElement(bV.Provider,{value:o},Ot.createElement(wV.Provider,{value:h},Ot.createElement(Y_e.Provider,{value:y},Ot.createElement(SV.Provider,{value:j},Ot.createElement(TV.Provider,{value:b},Ot.createElement(K_e.Provider,{value:I},Ot.createElement(J_e.Provider,{value:C},i)))))))},Q_e=function(){return Ie.useContext(TV)},ege=function(t){var a=Ie.useContext(bV);a==null&&Yg();var o=a[t];return o==null&&Yg(),o},tge=function(t){var a=Ie.useContext(wV);a==null&&Yg();var o=a[t];return o==null&&Yg(),o},nge=function(){var t=Ie.useContext(SV);return t};function iy(e){"@babel/helpers - typeof";return iy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},iy(e)}function rge(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ige(e,t){for(var a=0;a<t.length;a++){var o=t[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,AV(o.key),o)}}function age(e,t,a){return t&&ige(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function oge(e,t,a){return t=Sw(t),sge(e,EV()?Reflect.construct(t,a||[],Sw(e).constructor):t.apply(e,a))}function sge(e,t){if(t&&(iy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return lge(e)}function lge(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function EV(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(EV=function(){return!!e})()}function Sw(e){return Sw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)},Sw(e)}function cge(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&b4(e,t)}function b4(e,t){return b4=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,h){return o.__proto__=h,o},b4(e,t)}function H7(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(h){return Object.getOwnPropertyDescriptor(e,h).enumerable})),a.push.apply(a,o)}return a}function Z7(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?H7(Object(a),!0).forEach(function(o){TP(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):H7(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function TP(e,t,a){return t=AV(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function AV(e){var t=uge(e,"string");return iy(t)=="symbol"?t:t+""}function uge(e,t){if(iy(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t);if(iy(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function hge(e,t){return mge(e)||pge(e,t)||dge(e,t)||fge()}function fge(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function dge(e,t){if(e){if(typeof e=="string")return W7(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return W7(e,t)}}function W7(e,t){(t==null||t>e.length)&&(t=e.length);for(var a=0,o=new Array(t);a<t;a++)o[a]=e[a];return o}function pge(e,t){var a=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(a!=null){var o,h,y,b,i=[],C=!0,I=!1;try{if(y=(a=a.call(e)).next,t!==0)for(;!(C=(o=y.call(a)).done)&&(i.push(o.value),i.length!==t);C=!0);}catch(j){I=!0,h=j}finally{try{if(!C&&a.return!=null&&(b=a.return(),Object(b)!==b))return}finally{if(I)throw h}}return i}}function mge(e){if(Array.isArray(e))return e}function w4(){return w4=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},w4.apply(this,arguments)}var _ge=function(t,a){var o;return Ot.isValidElement(t)?o=Ot.cloneElement(t,a):Vr(t)?o=t(a):o=Ot.createElement("line",w4({},a,{className:"recharts-reference-line-line"})),o},gge=function(t,a,o,h,y,b,i,C,I){var j=y.x,F=y.y,G=y.width,X=y.height;if(o){var Y=I.y,J=t.y.apply(Y,{position:b});if(yf(I,"discard")&&!t.y.isInRange(J))return null;var ee=[{x:j+G,y:J},{x:j,y:J}];return C==="left"?ee.reverse():ee}if(a){var oe=I.x,ge=t.x.apply(oe,{position:b});if(yf(I,"discard")&&!t.x.isInRange(ge))return null;var fe=[{x:ge,y:F+X},{x:ge,y:F}];return i==="top"?fe.reverse():fe}if(h){var xe=I.segment,ae=xe.map(function(me){return t.apply(me,{position:b})});return yf(I,"discard")&&O_e(ae,function(me){return!t.isInRange(me)})?null:ae}return null};function yge(e){var t=e.x,a=e.y,o=e.segment,h=e.xAxisId,y=e.yAxisId,b=e.shape,i=e.className,C=e.alwaysShow,I=Q_e(),j=ege(h),F=tge(y),G=nge();if(!I||!G)return null;qd(C===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var X=SP({x:j.scale,y:F.scale}),Y=bo(t),J=bo(a),ee=o&&o.length===2,oe=gge(X,Y,J,ee,G,e.position,j.orientation,F.orientation,e);if(!oe)return null;var ge=hge(oe,2),fe=ge[0],xe=fe.x,ae=fe.y,me=ge[1],we=me.x,Ge=me.y,He=yf(e,"hidden")?"url(#".concat(I,")"):void 0,ye=Z7(Z7({clipPath:He},Fr(e,!0)),{},{x1:xe,y1:ae,x2:we,y2:Ge});return Ot.createElement(Ga,{className:oi("recharts-reference-line",i)},_ge(b,ye),rs.renderCallByParent(e,V_e({x1:xe,y1:ae,x2:we,y2:Ge})))}var EP=function(e){function t(){return rge(this,t),oge(this,t,arguments)}return cge(t,e),age(t,[{key:"render",value:function(){return Ot.createElement(yge,this.props)}}])}(Ot.Component);TP(EP,"displayName","ReferenceLine");TP(EP,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});function S4(){return S4=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},S4.apply(this,arguments)}function ay(e){"@babel/helpers - typeof";return ay=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ay(e)}function X7(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(h){return Object.getOwnPropertyDescriptor(e,h).enumerable})),a.push.apply(a,o)}return a}function Y7(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?X7(Object(a),!0).forEach(function(o){IS(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):X7(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function vge(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xge(e,t){for(var a=0;a<t.length;a++){var o=t[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,MV(o.key),o)}}function bge(e,t,a){return t&&xge(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function wge(e,t,a){return t=Tw(t),Sge(e,CV()?Reflect.construct(t,a||[],Tw(e).constructor):t.apply(e,a))}function Sge(e,t){if(t&&(ay(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Tge(e)}function Tge(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function CV(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(CV=function(){return!!e})()}function Tw(e){return Tw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)},Tw(e)}function Ege(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&T4(e,t)}function T4(e,t){return T4=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,h){return o.__proto__=h,o},T4(e,t)}function IS(e,t,a){return t=MV(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function MV(e){var t=Age(e,"string");return ay(t)=="symbol"?t:t+""}function Age(e,t){if(ay(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t);if(ay(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Cge=function(t){var a=t.x,o=t.y,h=t.xAxis,y=t.yAxis,b=SP({x:h.scale,y:y.scale}),i=b.apply({x:a,y:o},{bandAware:!0});return yf(t,"discard")&&!b.isInRange(i)?null:i},RS=function(e){function t(){return vge(this,t),wge(this,t,arguments)}return Ege(t,e),bge(t,[{key:"render",value:function(){var o=this.props,h=o.x,y=o.y,b=o.r,i=o.alwaysShow,C=o.clipPathId,I=bo(h),j=bo(y);if(qd(i===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.'),!I||!j)return null;var F=Cge(this.props);if(!F)return null;var G=F.x,X=F.y,Y=this.props,J=Y.shape,ee=Y.className,oe=yf(this.props,"hidden")?"url(#".concat(C,")"):void 0,ge=Y7(Y7({clipPath:oe},Fr(this.props,!0)),{},{cx:G,cy:X});return Ot.createElement(Ga,{className:oi("recharts-reference-dot",ee)},t.renderDot(J,ge),rs.renderCallByParent(this.props,{x:G-b,y:X-b,width:2*b,height:2*b}))}}])}(Ot.Component);IS(RS,"displayName","ReferenceDot");IS(RS,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#fff",stroke:"#ccc",fillOpacity:1,strokeWidth:1});IS(RS,"renderDot",function(e,t){var a;return Ot.isValidElement(e)?a=Ot.cloneElement(e,t):Vr(e)?a=e(t):a=Ot.createElement(bP,S4({},t,{cx:t.cx,cy:t.cy,className:"recharts-reference-dot-dot"})),a});function E4(){return E4=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},E4.apply(this,arguments)}function oy(e){"@babel/helpers - typeof";return oy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},oy(e)}function K7(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(h){return Object.getOwnPropertyDescriptor(e,h).enumerable})),a.push.apply(a,o)}return a}function J7(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?K7(Object(a),!0).forEach(function(o){DS(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):K7(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function Mge(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Oge(e,t){for(var a=0;a<t.length;a++){var o=t[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,PV(o.key),o)}}function Pge(e,t,a){return t&&Oge(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ige(e,t,a){return t=Ew(t),Rge(e,OV()?Reflect.construct(t,a||[],Ew(e).constructor):t.apply(e,a))}function Rge(e,t){if(t&&(oy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Dge(e)}function Dge(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function OV(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(OV=function(){return!!e})()}function Ew(e){return Ew=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)},Ew(e)}function Lge(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&A4(e,t)}function A4(e,t){return A4=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,h){return o.__proto__=h,o},A4(e,t)}function DS(e,t,a){return t=PV(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function PV(e){var t=kge(e,"string");return oy(t)=="symbol"?t:t+""}function kge(e,t){if(oy(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t);if(oy(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var zge=function(t,a,o,h,y){var b=y.x1,i=y.x2,C=y.y1,I=y.y2,j=y.xAxis,F=y.yAxis;if(!j||!F)return null;var G=SP({x:j.scale,y:F.scale}),X={x:t?G.x.apply(b,{position:"start"}):G.x.rangeMin,y:o?G.y.apply(C,{position:"start"}):G.y.rangeMin},Y={x:a?G.x.apply(i,{position:"end"}):G.x.rangeMax,y:h?G.y.apply(I,{position:"end"}):G.y.rangeMax};return yf(y,"discard")&&(!G.isInRange(X)||!G.isInRange(Y))?null:vV(X,Y)},LS=function(e){function t(){return Mge(this,t),Ige(this,t,arguments)}return Lge(t,e),Pge(t,[{key:"render",value:function(){var o=this.props,h=o.x1,y=o.x2,b=o.y1,i=o.y2,C=o.className,I=o.alwaysShow,j=o.clipPathId;qd(I===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var F=bo(h),G=bo(y),X=bo(b),Y=bo(i),J=this.props.shape;if(!F&&!G&&!X&&!Y&&!J)return null;var ee=zge(F,G,X,Y,this.props);if(!ee&&!J)return null;var oe=yf(this.props,"hidden")?"url(#".concat(j,")"):void 0;return Ot.createElement(Ga,{className:oi("recharts-reference-area",C)},t.renderRect(J,J7(J7({clipPath:oe},Fr(this.props,!0)),ee)),rs.renderCallByParent(this.props,ee))}}])}(Ot.Component);DS(LS,"displayName","ReferenceArea");DS(LS,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#ccc",fillOpacity:.5,stroke:"none",strokeWidth:1});DS(LS,"renderRect",function(e,t){var a;return Ot.isValidElement(e)?a=Ot.cloneElement(e,t):Vr(e)?a=e(t):a=Ot.createElement(xP,E4({},t,{className:"recharts-reference-area-rect"})),a});function Q7(e){return jge(e)||Fge(e)||Nge(e)||Bge()}function Bge(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Nge(e,t){if(e){if(typeof e=="string")return C4(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return C4(e,t)}}function Fge(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function jge(e){if(Array.isArray(e))return C4(e)}function C4(e,t){(t==null||t>e.length)&&(t=e.length);for(var a=0,o=new Array(t);a<t;a++)o[a]=e[a];return o}var M4=function(t,a,o,h,y){var b=_f(t,EP),i=_f(t,RS),C=[].concat(Q7(b),Q7(i)),I=_f(t,LS),j="".concat(h,"Id"),F=h[0],G=a;if(C.length&&(G=C.reduce(function(J,ee){if(ee.props[j]===o&&yf(ee.props,"extendDomain")&&Nn(ee.props[F])){var oe=ee.props[F];return[Math.min(J[0],oe),Math.max(J[1],oe)]}return J},G)),I.length){var X="".concat(F,"1"),Y="".concat(F,"2");G=I.reduce(function(J,ee){if(ee.props[j]===o&&yf(ee.props,"extendDomain")&&Nn(ee.props[X])&&Nn(ee.props[Y])){var oe=ee.props[X],ge=ee.props[Y];return[Math.min(J[0],oe,ge),Math.max(J[1],oe,ge)]}return J},G)}return y&&y.length&&(G=y.reduce(function(J,ee){return Nn(ee)?[Math.min(J[0],ee),Math.max(J[1],ee)]:J},G)),G},IM={exports:{}},eB;function Uge(){return eB||(eB=1,function(e){var t=Object.prototype.hasOwnProperty,a="~";function o(){}Object.create&&(o.prototype=Object.create(null),new o().__proto__||(a=!1));function h(C,I,j){this.fn=C,this.context=I,this.once=j||!1}function y(C,I,j,F,G){if(typeof j!="function")throw new TypeError("The listener must be a function");var X=new h(j,F||C,G),Y=a?a+I:I;return C._events[Y]?C._events[Y].fn?C._events[Y]=[C._events[Y],X]:C._events[Y].push(X):(C._events[Y]=X,C._eventsCount++),C}function b(C,I){--C._eventsCount===0?C._events=new o:delete C._events[I]}function i(){this._events=new o,this._eventsCount=0}i.prototype.eventNames=function(){var I=[],j,F;if(this._eventsCount===0)return I;for(F in j=this._events)t.call(j,F)&&I.push(a?F.slice(1):F);return Object.getOwnPropertySymbols?I.concat(Object.getOwnPropertySymbols(j)):I},i.prototype.listeners=function(I){var j=a?a+I:I,F=this._events[j];if(!F)return[];if(F.fn)return[F.fn];for(var G=0,X=F.length,Y=new Array(X);G<X;G++)Y[G]=F[G].fn;return Y},i.prototype.listenerCount=function(I){var j=a?a+I:I,F=this._events[j];return F?F.fn?1:F.length:0},i.prototype.emit=function(I,j,F,G,X,Y){var J=a?a+I:I;if(!this._events[J])return!1;var ee=this._events[J],oe=arguments.length,ge,fe;if(ee.fn){switch(ee.once&&this.removeListener(I,ee.fn,void 0,!0),oe){case 1:return ee.fn.call(ee.context),!0;case 2:return ee.fn.call(ee.context,j),!0;case 3:return ee.fn.call(ee.context,j,F),!0;case 4:return ee.fn.call(ee.context,j,F,G),!0;case 5:return ee.fn.call(ee.context,j,F,G,X),!0;case 6:return ee.fn.call(ee.context,j,F,G,X,Y),!0}for(fe=1,ge=new Array(oe-1);fe<oe;fe++)ge[fe-1]=arguments[fe];ee.fn.apply(ee.context,ge)}else{var xe=ee.length,ae;for(fe=0;fe<xe;fe++)switch(ee[fe].once&&this.removeListener(I,ee[fe].fn,void 0,!0),oe){case 1:ee[fe].fn.call(ee[fe].context);break;case 2:ee[fe].fn.call(ee[fe].context,j);break;case 3:ee[fe].fn.call(ee[fe].context,j,F);break;case 4:ee[fe].fn.call(ee[fe].context,j,F,G);break;default:if(!ge)for(ae=1,ge=new Array(oe-1);ae<oe;ae++)ge[ae-1]=arguments[ae];ee[fe].fn.apply(ee[fe].context,ge)}}return!0},i.prototype.on=function(I,j,F){return y(this,I,j,F,!1)},i.prototype.once=function(I,j,F){return y(this,I,j,F,!0)},i.prototype.removeListener=function(I,j,F,G){var X=a?a+I:I;if(!this._events[X])return this;if(!j)return b(this,X),this;var Y=this._events[X];if(Y.fn)Y.fn===j&&(!G||Y.once)&&(!F||Y.context===F)&&b(this,X);else{for(var J=0,ee=[],oe=Y.length;J<oe;J++)(Y[J].fn!==j||G&&!Y[J].once||F&&Y[J].context!==F)&&ee.push(Y[J]);ee.length?this._events[X]=ee.length===1?ee[0]:ee:b(this,X)}return this},i.prototype.removeAllListeners=function(I){var j;return I?(j=a?a+I:I,this._events[j]&&b(this,j)):(this._events=new o,this._eventsCount=0),this},i.prototype.off=i.prototype.removeListener,i.prototype.addListener=i.prototype.on,i.prefixed=a,i.EventEmitter=i,e.exports=i}(IM)),IM.exports}var Vge=Uge();const $ge=Ei(Vge);var RM=new $ge,DM="recharts.syncMouseEvents";function l2(e){"@babel/helpers - typeof";return l2=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l2(e)}function qge(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Gge(e,t){for(var a=0;a<t.length;a++){var o=t[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,IV(o.key),o)}}function Hge(e,t,a){return t&&Gge(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function LM(e,t,a){return t=IV(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function IV(e){var t=Zge(e,"string");return l2(t)=="symbol"?t:t+""}function Zge(e,t){if(l2(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t);if(l2(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Wge=function(){function e(){qge(this,e),LM(this,"activeIndex",0),LM(this,"coordinateList",[]),LM(this,"layout","horizontal")}return Hge(e,[{key:"setDetails",value:function(a){var o,h=a.coordinateList,y=h===void 0?null:h,b=a.container,i=b===void 0?null:b,C=a.layout,I=C===void 0?null:C,j=a.offset,F=j===void 0?null:j,G=a.mouseHandlerCallback,X=G===void 0?null:G;this.coordinateList=(o=y??this.coordinateList)!==null&&o!==void 0?o:[],this.container=i??this.container,this.layout=I??this.layout,this.offset=F??this.offset,this.mouseHandlerCallback=X??this.mouseHandlerCallback,this.activeIndex=Math.min(Math.max(this.activeIndex,0),this.coordinateList.length-1)}},{key:"focus",value:function(){this.spoofMouse()}},{key:"keyboardEvent",value:function(a){if(this.coordinateList.length!==0)switch(a.key){case"ArrowRight":{if(this.layout!=="horizontal")return;this.activeIndex=Math.min(this.activeIndex+1,this.coordinateList.length-1),this.spoofMouse();break}case"ArrowLeft":{if(this.layout!=="horizontal")return;this.activeIndex=Math.max(this.activeIndex-1,0),this.spoofMouse();break}}}},{key:"setIndex",value:function(a){this.activeIndex=a}},{key:"spoofMouse",value:function(){var a,o;if(this.layout==="horizontal"&&this.coordinateList.length!==0){var h=this.container.getBoundingClientRect(),y=h.x,b=h.y,i=h.height,C=this.coordinateList[this.activeIndex].coordinate,I=((a=window)===null||a===void 0?void 0:a.scrollX)||0,j=((o=window)===null||o===void 0?void 0:o.scrollY)||0,F=y+C+I,G=b+this.offset.top+i/2+j;this.mouseHandlerCallback({pageX:F,pageY:G})}}}])}();function Xge(e,t,a){if(a==="number"&&t===!0&&Array.isArray(e)){var o=e==null?void 0:e[0],h=e==null?void 0:e[1];if(o&&h&&Nn(o)&&Nn(h))return!0}return!1}function Yge(e,t,a,o){var h=o/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-h:a.left+.5,y:e==="horizontal"?a.top+.5:t.y-h,width:e==="horizontal"?o:a.width-1,height:e==="horizontal"?a.height-1:o}}function RV(e){var t=e.cx,a=e.cy,o=e.radius,h=e.startAngle,y=e.endAngle,b=Xi(t,a,o,h),i=Xi(t,a,o,y);return{points:[b,i],cx:t,cy:a,radius:o,startAngle:h,endAngle:y}}function Kge(e,t,a){var o,h,y,b;if(e==="horizontal")o=t.x,y=o,h=a.top,b=a.top+a.height;else if(e==="vertical")h=t.y,b=h,o=a.left,y=a.left+a.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var i=t.cx,C=t.cy,I=t.innerRadius,j=t.outerRadius,F=t.angle,G=Xi(i,C,I,F),X=Xi(i,C,j,F);o=G.x,h=G.y,y=X.x,b=X.y}else return RV(t);return[{x:o,y:h},{x:y,y:b}]}function c2(e){"@babel/helpers - typeof";return c2=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},c2(e)}function tB(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(h){return Object.getOwnPropertyDescriptor(e,h).enumerable})),a.push.apply(a,o)}return a}function pb(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?tB(Object(a),!0).forEach(function(o){Jge(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):tB(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function Jge(e,t,a){return t=Qge(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Qge(e){var t=eye(e,"string");return c2(t)=="symbol"?t:t+""}function eye(e,t){if(c2(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t);if(c2(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function tye(e){var t,a,o=e.element,h=e.tooltipEventType,y=e.isActive,b=e.activeCoordinate,i=e.activePayload,C=e.offset,I=e.activeTooltipIndex,j=e.tooltipAxisBandSize,F=e.layout,G=e.chartName,X=(t=o.props.cursor)!==null&&t!==void 0?t:(a=o.type.defaultProps)===null||a===void 0?void 0:a.cursor;if(!o||!X||!y||!b||G!=="ScatterChart"&&h!=="axis")return null;var Y,J=i4;if(G==="ScatterChart")Y=b,J=Kme;else if(G==="BarChart")Y=Yge(F,b,C,j),J=xP;else if(F==="radial"){var ee=RV(b),oe=ee.cx,ge=ee.cy,fe=ee.radius,xe=ee.startAngle,ae=ee.endAngle;Y={cx:oe,cy:ge,startAngle:xe,endAngle:ae,innerRadius:fe,outerRadius:fe},J=QU}else Y={points:Kge(F,b,C)},J=i4;var me=pb(pb(pb(pb({stroke:"#ccc",pointerEvents:"none"},C),Y),Fr(X,!1)),{},{payload:i,payloadIndex:I,className:oi("recharts-tooltip-cursor",X.className)});return Ie.isValidElement(X)?Ie.cloneElement(X,me):Ie.createElement(J,me)}var nye=["item"],rye=["children","className","width","height","style","compact","title","desc"];function sy(e){"@babel/helpers - typeof";return sy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sy(e)}function Mg(){return Mg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},Mg.apply(this,arguments)}function nB(e,t){return oye(e)||aye(e,t)||LV(e,t)||iye()}function iye(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function aye(e,t){var a=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(a!=null){var o,h,y,b,i=[],C=!0,I=!1;try{if(y=(a=a.call(e)).next,t!==0)for(;!(C=(o=y.call(a)).done)&&(i.push(o.value),i.length!==t);C=!0);}catch(j){I=!0,h=j}finally{try{if(!C&&a.return!=null&&(b=a.return(),Object(b)!==b))return}finally{if(I)throw h}}return i}}function oye(e){if(Array.isArray(e))return e}function rB(e,t){if(e==null)return{};var a=sye(e,t),o,h;if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(e);for(h=0;h<y.length;h++)o=y[h],!(t.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(a[o]=e[o])}return a}function sye(e,t){if(e==null)return{};var a={};for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){if(t.indexOf(o)>=0)continue;a[o]=e[o]}return a}function lye(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function cye(e,t){for(var a=0;a<t.length;a++){var o=t[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,kV(o.key),o)}}function uye(e,t,a){return t&&cye(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function hye(e,t,a){return t=Aw(t),fye(e,DV()?Reflect.construct(t,a||[],Aw(e).constructor):t.apply(e,a))}function fye(e,t){if(t&&(sy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return dye(e)}function dye(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function DV(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(DV=function(){return!!e})()}function Aw(e){return Aw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)},Aw(e)}function pye(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&O4(e,t)}function O4(e,t){return O4=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,h){return o.__proto__=h,o},O4(e,t)}function ly(e){return gye(e)||_ye(e)||LV(e)||mye()}function mye(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function LV(e,t){if(e){if(typeof e=="string")return P4(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return P4(e,t)}}function _ye(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function gye(e){if(Array.isArray(e))return P4(e)}function P4(e,t){(t==null||t>e.length)&&(t=e.length);for(var a=0,o=new Array(t);a<t;a++)o[a]=e[a];return o}function iB(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(h){return Object.getOwnPropertyDescriptor(e,h).enumerable})),a.push.apply(a,o)}return a}function nn(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?iB(Object(a),!0).forEach(function(o){yr(e,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):iB(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function yr(e,t,a){return t=kV(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function kV(e){var t=yye(e,"string");return sy(t)=="symbol"?t:t+""}function yye(e,t){if(sy(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t);if(sy(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var vye={xAxis:["bottom","top"],yAxis:["left","right"]},xye={width:"100%",height:"100%"},zV={x:0,y:0};function mb(e){return e}var bye=function(t,a){return a==="horizontal"?t.x:a==="vertical"?t.y:a==="centric"?t.angle:t.radius},wye=function(t,a,o,h){var y=a.find(function(j){return j&&j.index===o});if(y){if(t==="horizontal")return{x:y.coordinate,y:h.y};if(t==="vertical")return{x:h.x,y:y.coordinate};if(t==="centric"){var b=y.coordinate,i=h.radius;return nn(nn(nn({},h),Xi(h.cx,h.cy,i,b)),{},{angle:b,radius:i})}var C=y.coordinate,I=h.angle;return nn(nn(nn({},h),Xi(h.cx,h.cy,C,I)),{},{angle:I,radius:C})}return zV},kS=function(t,a){var o=a.graphicalItems,h=a.dataStartIndex,y=a.dataEndIndex,b=(o??[]).reduce(function(i,C){var I=C.props.data;return I&&I.length?[].concat(ly(i),ly(I)):i},[]);return b.length>0?b:t&&t.length&&Nn(h)&&Nn(y)?t.slice(h,y+1):[]};function BV(e){return e==="number"?[0,"auto"]:void 0}var I4=function(t,a,o,h){var y=t.graphicalItems,b=t.tooltipAxis,i=kS(a,t);return o<0||!y||!y.length||o>=i.length?null:y.reduce(function(C,I){var j,F=(j=I.props.data)!==null&&j!==void 0?j:a;F&&t.dataStartIndex+t.dataEndIndex!==0&&t.dataEndIndex-t.dataStartIndex>=o&&(F=F.slice(t.dataStartIndex,t.dataEndIndex+1));var G;if(b.dataKey&&!b.allowDuplicatedCategory){var X=F===void 0?i:F;G=g5(X,b.dataKey,h)}else G=F&&F[o]||i[o];return G?[].concat(ly(C),[Ufe(I,G)]):C},[])},aB=function(t,a,o,h){var y=h||{x:t.chartX,y:t.chartY},b=bye(y,o),i=t.orderedTooltipTicks,C=t.tooltipAxis,I=t.tooltipTicks,j=Efe(b,i,I,C);if(j>=0&&I){var F=I[j]&&I[j].value,G=I4(t,a,j,F),X=wye(o,i,j,y);return{activeTooltipIndex:j,activeLabel:F,activePayload:G,activeCoordinate:X}}return null},Sye=function(t,a){var o=a.axes,h=a.graphicalItems,y=a.axisType,b=a.axisIdKey,i=a.stackGroups,C=a.dataStartIndex,I=a.dataEndIndex,j=t.layout,F=t.children,G=t.stackOffset,X=HU(j,y);return o.reduce(function(Y,J){var ee,oe=J.type.defaultProps!==void 0?nn(nn({},J.type.defaultProps),J.props):J.props,ge=oe.type,fe=oe.dataKey,xe=oe.allowDataOverflow,ae=oe.allowDuplicatedCategory,me=oe.scale,we=oe.ticks,Ge=oe.includeHidden,He=oe[b];if(Y[He])return Y;var ye=kS(t.data,{graphicalItems:h.filter(function(rn){var Nt,xn=b in rn.props?rn.props[b]:(Nt=rn.type.defaultProps)===null||Nt===void 0?void 0:Nt[b];return xn===He}),dataStartIndex:C,dataEndIndex:I}),ke=ye.length,dt,vt,jt;Xge(oe.domain,xe,ge)&&(dt=J5(oe.domain,null,xe),X&&(ge==="number"||me!=="auto")&&(jt=p1(ye,fe,"category")));var _t=BV(ge);if(!dt||dt.length===0){var gt,Vt=(gt=oe.domain)!==null&&gt!==void 0?gt:_t;if(fe){if(dt=p1(ye,fe,ge),ge==="category"&&X){var Ht=vie(dt);ae&&Ht?(vt=dt,dt=xw(0,ke)):ae||(dt=x8(Vt,dt,J).reduce(function(rn,Nt){return rn.indexOf(Nt)>=0?rn:[].concat(ly(rn),[Nt])},[]))}else if(ge==="category")ae?dt=dt.filter(function(rn){return rn!==""&&!ei(rn)}):dt=x8(Vt,dt,J).reduce(function(rn,Nt){return rn.indexOf(Nt)>=0||Nt===""||ei(Nt)?rn:[].concat(ly(rn),[Nt])},[]);else if(ge==="number"){var Bt=Pfe(ye,h.filter(function(rn){var Nt,xn,rr=b in rn.props?rn.props[b]:(Nt=rn.type.defaultProps)===null||Nt===void 0?void 0:Nt[b],Xn="hide"in rn.props?rn.props.hide:(xn=rn.type.defaultProps)===null||xn===void 0?void 0:xn.hide;return rr===He&&(Ge||!Xn)}),fe,y,j);Bt&&(dt=Bt)}X&&(ge==="number"||me!=="auto")&&(jt=p1(ye,fe,"category"))}else X?dt=xw(0,ke):i&&i[He]&&i[He].hasStack&&ge==="number"?dt=G==="expand"?[0,1]:ZU(i[He].stackGroups,C,I):dt=GU(ye,h.filter(function(rn){var Nt=b in rn.props?rn.props[b]:rn.type.defaultProps[b],xn="hide"in rn.props?rn.props.hide:rn.type.defaultProps.hide;return Nt===He&&(Ge||!xn)}),ge,j,!0);if(ge==="number")dt=M4(F,dt,He,y,we),Vt&&(dt=J5(Vt,dt,xe));else if(ge==="category"&&Vt){var et=Vt,$t=dt.every(function(rn){return et.indexOf(rn)>=0});$t&&(dt=et)}}return nn(nn({},Y),{},yr({},He,nn(nn({},oe),{},{axisType:y,domain:dt,categoricalDomain:jt,duplicateDomain:vt,originalDomain:(ee=oe.domain)!==null&&ee!==void 0?ee:_t,isCategorical:X,layout:j})))},{})},Tye=function(t,a){var o=a.graphicalItems,h=a.Axis,y=a.axisType,b=a.axisIdKey,i=a.stackGroups,C=a.dataStartIndex,I=a.dataEndIndex,j=t.layout,F=t.children,G=kS(t.data,{graphicalItems:o,dataStartIndex:C,dataEndIndex:I}),X=G.length,Y=HU(j,y),J=-1;return o.reduce(function(ee,oe){var ge=oe.type.defaultProps!==void 0?nn(nn({},oe.type.defaultProps),oe.props):oe.props,fe=ge[b],xe=BV("number");if(!ee[fe]){J++;var ae;return Y?ae=xw(0,X):i&&i[fe]&&i[fe].hasStack?(ae=ZU(i[fe].stackGroups,C,I),ae=M4(F,ae,fe,y)):(ae=J5(xe,GU(G,o.filter(function(me){var we,Ge,He=b in me.props?me.props[b]:(we=me.type.defaultProps)===null||we===void 0?void 0:we[b],ye="hide"in me.props?me.props.hide:(Ge=me.type.defaultProps)===null||Ge===void 0?void 0:Ge.hide;return He===fe&&!ye}),"number",j),h.defaultProps.allowDataOverflow),ae=M4(F,ae,fe,y)),nn(nn({},ee),{},yr({},fe,nn(nn({axisType:y},h.defaultProps),{},{hide:!0,orientation:ah(vye,"".concat(y,".").concat(J%2),null),domain:ae,originalDomain:xe,isCategorical:Y,layout:j})))}return ee},{})},Eye=function(t,a){var o=a.axisType,h=o===void 0?"xAxis":o,y=a.AxisComp,b=a.graphicalItems,i=a.stackGroups,C=a.dataStartIndex,I=a.dataEndIndex,j=t.children,F="".concat(h,"Id"),G=_f(j,y),X={};return G&&G.length?X=Sye(t,{axes:G,graphicalItems:b,axisType:h,axisIdKey:F,stackGroups:i,dataStartIndex:C,dataEndIndex:I}):b&&b.length&&(X=Tye(t,{Axis:y,graphicalItems:b,axisType:h,axisIdKey:F,stackGroups:i,dataStartIndex:C,dataEndIndex:I})),X},Aye=function(t){var a=Tg(t),o=s1(a,!1,!0);return{tooltipTicks:o,orderedTooltipTicks:GO(o,function(h){return h.coordinate}),tooltipAxis:a,tooltipAxisBandSize:Q5(a,o)}},oB=function(t){var a=t.children,o=t.defaultShowTooltip,h=au(a,ry),y=0,b=0;return t.data&&t.data.length!==0&&(b=t.data.length-1),h&&h.props&&(h.props.startIndex>=0&&(y=h.props.startIndex),h.props.endIndex>=0&&(b=h.props.endIndex)),{chartX:0,chartY:0,dataStartIndex:y,dataEndIndex:b,activeTooltipIndex:-1,isTooltipActive:!!o}},Cye=function(t){return!t||!t.length?!1:t.some(function(a){var o=$d(a&&a.type);return o&&o.indexOf("Bar")>=0})},sB=function(t){return t==="horizontal"?{numericAxisName:"yAxis",cateAxisName:"xAxis"}:t==="vertical"?{numericAxisName:"xAxis",cateAxisName:"yAxis"}:t==="centric"?{numericAxisName:"radiusAxis",cateAxisName:"angleAxis"}:{numericAxisName:"angleAxis",cateAxisName:"radiusAxis"}},Mye=function(t,a){var o=t.props,h=t.graphicalItems,y=t.xAxisMap,b=y===void 0?{}:y,i=t.yAxisMap,C=i===void 0?{}:i,I=o.width,j=o.height,F=o.children,G=o.margin||{},X=au(F,ry),Y=au(F,Rg),J=Object.keys(C).reduce(function(ae,me){var we=C[me],Ge=we.orientation;return!we.mirror&&!we.hide?nn(nn({},ae),{},yr({},Ge,ae[Ge]+we.width)):ae},{left:G.left||0,right:G.right||0}),ee=Object.keys(b).reduce(function(ae,me){var we=b[me],Ge=we.orientation;return!we.mirror&&!we.hide?nn(nn({},ae),{},yr({},Ge,ah(ae,"".concat(Ge))+we.height)):ae},{top:G.top||0,bottom:G.bottom||0}),oe=nn(nn({},ee),J),ge=oe.bottom;X&&(oe.bottom+=X.props.height||ry.defaultProps.height),Y&&a&&(oe=Mfe(oe,h,o,a));var fe=I-oe.left-oe.right,xe=j-oe.top-oe.bottom;return nn(nn({brushBottom:ge},oe),{},{width:Math.max(fe,0),height:Math.max(xe,0)})},Oye=function(t,a){if(a==="xAxis")return t[a].width;if(a==="yAxis")return t[a].height},Pye=function(t){var a=t.chartName,o=t.GraphicalChild,h=t.defaultTooltipEventType,y=h===void 0?"axis":h,b=t.validateTooltipEventTypes,i=b===void 0?["axis"]:b,C=t.axisComponents,I=t.legendContent,j=t.formatAxisMap,F=t.defaultProps,G=function(oe,ge){var fe=ge.graphicalItems,xe=ge.stackGroups,ae=ge.offset,me=ge.updateId,we=ge.dataStartIndex,Ge=ge.dataEndIndex,He=oe.barSize,ye=oe.layout,ke=oe.barGap,dt=oe.barCategoryGap,vt=oe.maxBarSize,jt=sB(ye),_t=jt.numericAxisName,gt=jt.cateAxisName,Vt=Cye(fe),Ht=[];return fe.forEach(function(Bt,et){var $t=kS(oe.data,{graphicalItems:[Bt],dataStartIndex:we,dataEndIndex:Ge}),rn=Bt.type.defaultProps!==void 0?nn(nn({},Bt.type.defaultProps),Bt.props):Bt.props,Nt=rn.dataKey,xn=rn.maxBarSize,rr=rn["".concat(_t,"Id")],Xn=rn["".concat(gt,"Id")],yi={},ir=C.reduce(function(Pa,co){var Rs=ge["".concat(co.axisType,"Map")],Bn=rn["".concat(co.axisType,"Id")];Rs&&Rs[Bn]||co.axisType==="zAxis"||Yg();var jo=Rs[Bn];return nn(nn({},Pa),{},yr(yr({},co.axisType,jo),"".concat(co.axisType,"Ticks"),s1(jo)))},yi),yn=ir[gt],Ne=ir["".concat(gt,"Ticks")],Qn=xe&&xe[rr]&&xe[rr].hasStack&&Ffe(Bt,xe[rr].stackGroups),fn=$d(Bt.type).indexOf("Bar")>=0,Dr=Q5(yn,Ne),Pt=[],Pr=Vt&&Afe({barSize:He,stackGroups:xe,totalSize:Oye(ir,gt)});if(fn){var Cr,zi,$n=ei(xn)?vt:xn,si=(Cr=(zi=Q5(yn,Ne,!0))!==null&&zi!==void 0?zi:$n)!==null&&Cr!==void 0?Cr:0;Pt=Cfe({barGap:ke,barCategoryGap:dt,bandSize:si!==Dr?si:Dr,sizeList:Pr[Xn],maxBarSize:$n}),si!==Dr&&(Pt=Pt.map(function(Pa){return nn(nn({},Pa),{},{position:nn(nn({},Pa.position),{},{offset:Pa.position.offset-si/2})})}))}var ha=Bt&&Bt.type&&Bt.type.getComposedData;ha&&Ht.push({props:nn(nn({},ha(nn(nn({},ir),{},{displayedData:$t,props:oe,dataKey:Nt,item:Bt,bandSize:Dr,barPosition:Pt,offset:ae,stackedData:Qn,layout:ye,dataStartIndex:we,dataEndIndex:Ge}))),{},yr(yr(yr({key:Bt.key||"item-".concat(et)},_t,ir[_t]),gt,ir[gt]),"animationId",me)),childIndex:Pie(Bt,oe.children),item:Bt})}),Ht},X=function(oe,ge){var fe=oe.props,xe=oe.dataStartIndex,ae=oe.dataEndIndex,me=oe.updateId;if(!kL({props:fe}))return null;var we=fe.children,Ge=fe.layout,He=fe.stackOffset,ye=fe.data,ke=fe.reverseStackOrder,dt=sB(Ge),vt=dt.numericAxisName,jt=dt.cateAxisName,_t=_f(we,o),gt=Bfe(ye,_t,"".concat(vt,"Id"),"".concat(jt,"Id"),He,ke),Vt=C.reduce(function(rn,Nt){var xn="".concat(Nt.axisType,"Map");return nn(nn({},rn),{},yr({},xn,Eye(fe,nn(nn({},Nt),{},{graphicalItems:_t,stackGroups:Nt.axisType===vt&&gt,dataStartIndex:xe,dataEndIndex:ae}))))},{}),Ht=Mye(nn(nn({},Vt),{},{props:fe,graphicalItems:_t}),ge==null?void 0:ge.legendBBox);Object.keys(Vt).forEach(function(rn){Vt[rn]=j(fe,Vt[rn],Ht,rn.replace("Map",""),a)});var Bt=Vt["".concat(jt,"Map")],et=Aye(Bt),$t=G(fe,nn(nn({},Vt),{},{dataStartIndex:xe,dataEndIndex:ae,updateId:me,graphicalItems:_t,stackGroups:gt,offset:Ht}));return nn(nn({formattedGraphicalItems:$t,graphicalItems:_t,offset:Ht,stackGroups:gt},et),Vt)},Y=function(ee){function oe(ge){var fe,xe,ae;return lye(this,oe),ae=hye(this,oe,[ge]),yr(ae,"eventEmitterSymbol",Symbol("rechartsEventEmitter")),yr(ae,"accessibilityManager",new Wge),yr(ae,"handleLegendBBoxUpdate",function(me){if(me){var we=ae.state,Ge=we.dataStartIndex,He=we.dataEndIndex,ye=we.updateId;ae.setState(nn({legendBBox:me},X({props:ae.props,dataStartIndex:Ge,dataEndIndex:He,updateId:ye},nn(nn({},ae.state),{},{legendBBox:me}))))}}),yr(ae,"handleReceiveSyncEvent",function(me,we,Ge){if(ae.props.syncId===me){if(Ge===ae.eventEmitterSymbol&&typeof ae.props.syncMethod!="function")return;ae.applySyncEvent(we)}}),yr(ae,"handleBrushChange",function(me){var we=me.startIndex,Ge=me.endIndex;if(we!==ae.state.dataStartIndex||Ge!==ae.state.dataEndIndex){var He=ae.state.updateId;ae.setState(function(){return nn({dataStartIndex:we,dataEndIndex:Ge},X({props:ae.props,dataStartIndex:we,dataEndIndex:Ge,updateId:He},ae.state))}),ae.triggerSyncEvent({dataStartIndex:we,dataEndIndex:Ge})}}),yr(ae,"handleMouseEnter",function(me){var we=ae.getMouseInfo(me);if(we){var Ge=nn(nn({},we),{},{isTooltipActive:!0});ae.setState(Ge),ae.triggerSyncEvent(Ge);var He=ae.props.onMouseEnter;Vr(He)&&He(Ge,me)}}),yr(ae,"triggeredAfterMouseMove",function(me){var we=ae.getMouseInfo(me),Ge=we?nn(nn({},we),{},{isTooltipActive:!0}):{isTooltipActive:!1};ae.setState(Ge),ae.triggerSyncEvent(Ge);var He=ae.props.onMouseMove;Vr(He)&&He(Ge,me)}),yr(ae,"handleItemMouseEnter",function(me){ae.setState(function(){return{isTooltipActive:!0,activeItem:me,activePayload:me.tooltipPayload,activeCoordinate:me.tooltipPosition||{x:me.cx,y:me.cy}}})}),yr(ae,"handleItemMouseLeave",function(){ae.setState(function(){return{isTooltipActive:!1}})}),yr(ae,"handleMouseMove",function(me){me.persist(),ae.throttleTriggeredAfterMouseMove(me)}),yr(ae,"handleMouseLeave",function(me){ae.throttleTriggeredAfterMouseMove.cancel();var we={isTooltipActive:!1};ae.setState(we),ae.triggerSyncEvent(we);var Ge=ae.props.onMouseLeave;Vr(Ge)&&Ge(we,me)}),yr(ae,"handleOuterEvent",function(me){var we=Oie(me),Ge=ah(ae.props,"".concat(we));if(we&&Vr(Ge)){var He,ye;/.*touch.*/i.test(we)?ye=ae.getMouseInfo(me.changedTouches[0]):ye=ae.getMouseInfo(me),Ge((He=ye)!==null&&He!==void 0?He:{},me)}}),yr(ae,"handleClick",function(me){var we=ae.getMouseInfo(me);if(we){var Ge=nn(nn({},we),{},{isTooltipActive:!0});ae.setState(Ge),ae.triggerSyncEvent(Ge);var He=ae.props.onClick;Vr(He)&&He(Ge,me)}}),yr(ae,"handleMouseDown",function(me){var we=ae.props.onMouseDown;if(Vr(we)){var Ge=ae.getMouseInfo(me);we(Ge,me)}}),yr(ae,"handleMouseUp",function(me){var we=ae.props.onMouseUp;if(Vr(we)){var Ge=ae.getMouseInfo(me);we(Ge,me)}}),yr(ae,"handleTouchMove",function(me){me.changedTouches!=null&&me.changedTouches.length>0&&ae.throttleTriggeredAfterMouseMove(me.changedTouches[0])}),yr(ae,"handleTouchStart",function(me){me.changedTouches!=null&&me.changedTouches.length>0&&ae.handleMouseDown(me.changedTouches[0])}),yr(ae,"handleTouchEnd",function(me){me.changedTouches!=null&&me.changedTouches.length>0&&ae.handleMouseUp(me.changedTouches[0])}),yr(ae,"handleDoubleClick",function(me){var we=ae.props.onDoubleClick;if(Vr(we)){var Ge=ae.getMouseInfo(me);we(Ge,me)}}),yr(ae,"handleContextMenu",function(me){var we=ae.props.onContextMenu;if(Vr(we)){var Ge=ae.getMouseInfo(me);we(Ge,me)}}),yr(ae,"triggerSyncEvent",function(me){ae.props.syncId!==void 0&&RM.emit(DM,ae.props.syncId,me,ae.eventEmitterSymbol)}),yr(ae,"applySyncEvent",function(me){var we=ae.props,Ge=we.layout,He=we.syncMethod,ye=ae.state.updateId,ke=me.dataStartIndex,dt=me.dataEndIndex;if(me.dataStartIndex!==void 0||me.dataEndIndex!==void 0)ae.setState(nn({dataStartIndex:ke,dataEndIndex:dt},X({props:ae.props,dataStartIndex:ke,dataEndIndex:dt,updateId:ye},ae.state)));else if(me.activeTooltipIndex!==void 0){var vt=me.chartX,jt=me.chartY,_t=me.activeTooltipIndex,gt=ae.state,Vt=gt.offset,Ht=gt.tooltipTicks;if(!Vt)return;if(typeof He=="function")_t=He(Ht,me);else if(He==="value"){_t=-1;for(var Bt=0;Bt<Ht.length;Bt++)if(Ht[Bt].value===me.activeLabel){_t=Bt;break}}var et=nn(nn({},Vt),{},{x:Vt.left,y:Vt.top}),$t=Math.min(vt,et.x+et.width),rn=Math.min(jt,et.y+et.height),Nt=Ht[_t]&&Ht[_t].value,xn=I4(ae.state,ae.props.data,_t),rr=Ht[_t]?{x:Ge==="horizontal"?Ht[_t].coordinate:$t,y:Ge==="horizontal"?rn:Ht[_t].coordinate}:zV;ae.setState(nn(nn({},me),{},{activeLabel:Nt,activeCoordinate:rr,activePayload:xn,activeTooltipIndex:_t}))}else ae.setState(me)}),yr(ae,"renderCursor",function(me){var we,Ge=ae.state,He=Ge.isTooltipActive,ye=Ge.activeCoordinate,ke=Ge.activePayload,dt=Ge.offset,vt=Ge.activeTooltipIndex,jt=Ge.tooltipAxisBandSize,_t=ae.getTooltipEventType(),gt=(we=me.props.active)!==null&&we!==void 0?we:He,Vt=ae.props.layout,Ht=me.key||"_recharts-cursor";return Ot.createElement(tye,{key:Ht,activeCoordinate:ye,activePayload:ke,activeTooltipIndex:vt,chartName:a,element:me,isActive:gt,layout:Vt,offset:dt,tooltipAxisBandSize:jt,tooltipEventType:_t})}),yr(ae,"renderPolarAxis",function(me,we,Ge){var He=ah(me,"type.axisType"),ye=ah(ae.state,"".concat(He,"Map")),ke=me.type.defaultProps,dt=ke!==void 0?nn(nn({},ke),me.props):me.props,vt=ye&&ye[dt["".concat(He,"Id")]];return Ie.cloneElement(me,nn(nn({},vt),{},{className:oi(He,vt.className),key:me.key||"".concat(we,"-").concat(Ge),ticks:s1(vt,!0)}))}),yr(ae,"renderPolarGrid",function(me){var we=me.props,Ge=we.radialLines,He=we.polarAngles,ye=we.polarRadius,ke=ae.state,dt=ke.radiusAxisMap,vt=ke.angleAxisMap,jt=Tg(dt),_t=Tg(vt),gt=_t.cx,Vt=_t.cy,Ht=_t.innerRadius,Bt=_t.outerRadius;return Ie.cloneElement(me,{polarAngles:Array.isArray(He)?He:s1(_t,!0).map(function(et){return et.coordinate}),polarRadius:Array.isArray(ye)?ye:s1(jt,!0).map(function(et){return et.coordinate}),cx:gt,cy:Vt,innerRadius:Ht,outerRadius:Bt,key:me.key||"polar-grid",radialLines:Ge})}),yr(ae,"renderLegend",function(){var me=ae.state.formattedGraphicalItems,we=ae.props,Ge=we.children,He=we.width,ye=we.height,ke=ae.props.margin||{},dt=He-(ke.left||0)-(ke.right||0),vt=$U({children:Ge,formattedGraphicalItems:me,legendWidth:dt,legendContent:I});if(!vt)return null;var jt=vt.item,_t=rB(vt,nye);return Ie.cloneElement(jt,nn(nn({},_t),{},{chartWidth:He,chartHeight:ye,margin:ke,onBBoxUpdate:ae.handleLegendBBoxUpdate}))}),yr(ae,"renderTooltip",function(){var me,we=ae.props,Ge=we.children,He=we.accessibilityLayer,ye=au(Ge,Ld);if(!ye)return null;var ke=ae.state,dt=ke.isTooltipActive,vt=ke.activeCoordinate,jt=ke.activePayload,_t=ke.activeLabel,gt=ke.offset,Vt=(me=ye.props.active)!==null&&me!==void 0?me:dt;return Ie.cloneElement(ye,{viewBox:nn(nn({},gt),{},{x:gt.left,y:gt.top}),active:Vt,label:_t,payload:Vt?jt:[],coordinate:vt,accessibilityLayer:He})}),yr(ae,"renderBrush",function(me){var we=ae.props,Ge=we.margin,He=we.data,ye=ae.state,ke=ye.offset,dt=ye.dataStartIndex,vt=ye.dataEndIndex,jt=ye.updateId;return Ie.cloneElement(me,{key:me.key||"_recharts-brush",onChange:cb(ae.handleBrushChange,me.props.onChange),data:He,x:Nn(me.props.x)?me.props.x:ke.left,y:Nn(me.props.y)?me.props.y:ke.top+ke.height+ke.brushBottom-(Ge.bottom||0),width:Nn(me.props.width)?me.props.width:ke.width,startIndex:dt,endIndex:vt,updateId:"brush-".concat(jt)})}),yr(ae,"renderReferenceElement",function(me,we,Ge){if(!me)return null;var He=ae,ye=He.clipPathId,ke=ae.state,dt=ke.xAxisMap,vt=ke.yAxisMap,jt=ke.offset,_t=me.type.defaultProps||{},gt=me.props,Vt=gt.xAxisId,Ht=Vt===void 0?_t.xAxisId:Vt,Bt=gt.yAxisId,et=Bt===void 0?_t.yAxisId:Bt;return Ie.cloneElement(me,{key:me.key||"".concat(we,"-").concat(Ge),xAxis:dt[Ht],yAxis:vt[et],viewBox:{x:jt.left,y:jt.top,width:jt.width,height:jt.height},clipPathId:ye})}),yr(ae,"renderActivePoints",function(me){var we=me.item,Ge=me.activePoint,He=me.basePoint,ye=me.childIndex,ke=me.isRange,dt=[],vt=we.props.key,jt=we.item.type.defaultProps!==void 0?nn(nn({},we.item.type.defaultProps),we.item.props):we.item.props,_t=jt.activeDot,gt=jt.dataKey,Vt=nn(nn({index:ye,dataKey:gt,cx:Ge.x,cy:Ge.y,r:4,fill:vP(we.item),strokeWidth:2,stroke:"#fff",payload:Ge.payload,value:Ge.value},Fr(_t,!1)),Fb(_t));return dt.push(oe.renderActiveDot(_t,Vt,"".concat(vt,"-activePoint-").concat(ye))),He?dt.push(oe.renderActiveDot(_t,nn(nn({},Vt),{},{cx:He.x,cy:He.y}),"".concat(vt,"-basePoint-").concat(ye))):ke&&dt.push(null),dt}),yr(ae,"renderGraphicChild",function(me,we,Ge){var He=ae.filterFormatItem(me,we,Ge);if(!He)return null;var ye=ae.getTooltipEventType(),ke=ae.state,dt=ke.isTooltipActive,vt=ke.tooltipAxis,jt=ke.activeTooltipIndex,_t=ke.activeLabel,gt=ae.props.children,Vt=au(gt,Ld),Ht=He.props,Bt=Ht.points,et=Ht.isRange,$t=Ht.baseLine,rn=He.item.type.defaultProps!==void 0?nn(nn({},He.item.type.defaultProps),He.item.props):He.item.props,Nt=rn.activeDot,xn=rn.hide,rr=rn.activeBar,Xn=rn.activeShape,yi=!!(!xn&&dt&&Vt&&(Nt||rr||Xn)),ir={};ye!=="axis"&&Vt&&Vt.props.trigger==="click"?ir={onClick:cb(ae.handleItemMouseEnter,me.props.onClick)}:ye!=="axis"&&(ir={onMouseLeave:cb(ae.handleItemMouseLeave,me.props.onMouseLeave),onMouseEnter:cb(ae.handleItemMouseEnter,me.props.onMouseEnter)});var yn=Ie.cloneElement(me,nn(nn({},He.props),ir));function Ne(co){return typeof vt.dataKey=="function"?vt.dataKey(co.payload):null}if(yi)if(jt>=0){var Qn,fn;if(vt.dataKey&&!vt.allowDuplicatedCategory){var Dr=typeof vt.dataKey=="function"?Ne:"payload.".concat(vt.dataKey.toString());Qn=g5(Bt,Dr,_t),fn=et&&$t&&g5($t,Dr,_t)}else Qn=Bt==null?void 0:Bt[jt],fn=et&&$t&&$t[jt];if(Xn||rr){var Pt=me.props.activeIndex!==void 0?me.props.activeIndex:jt;return[Ie.cloneElement(me,nn(nn(nn({},He.props),ir),{},{activeIndex:Pt})),null,null]}if(!ei(Qn))return[yn].concat(ly(ae.renderActivePoints({item:He,activePoint:Qn,basePoint:fn,childIndex:jt,isRange:et})))}else{var Pr,Cr=(Pr=ae.getItemByXY(ae.state.activeCoordinate))!==null&&Pr!==void 0?Pr:{graphicalItem:yn},zi=Cr.graphicalItem,$n=zi.item,si=$n===void 0?me:$n,ha=zi.childIndex,Pa=nn(nn(nn({},He.props),ir),{},{activeIndex:ha});return[Ie.cloneElement(si,Pa),null,null]}return et?[yn,null,null]:[yn,null]}),yr(ae,"renderCustomized",function(me,we,Ge){return Ie.cloneElement(me,nn(nn({key:"recharts-customized-".concat(Ge)},ae.props),ae.state))}),yr(ae,"renderMap",{CartesianGrid:{handler:mb,once:!0},ReferenceArea:{handler:ae.renderReferenceElement},ReferenceLine:{handler:mb},ReferenceDot:{handler:ae.renderReferenceElement},XAxis:{handler:mb},YAxis:{handler:mb},Brush:{handler:ae.renderBrush,once:!0},Bar:{handler:ae.renderGraphicChild},Line:{handler:ae.renderGraphicChild},Area:{handler:ae.renderGraphicChild},Radar:{handler:ae.renderGraphicChild},RadialBar:{handler:ae.renderGraphicChild},Scatter:{handler:ae.renderGraphicChild},Pie:{handler:ae.renderGraphicChild},Funnel:{handler:ae.renderGraphicChild},Tooltip:{handler:ae.renderCursor,once:!0},PolarGrid:{handler:ae.renderPolarGrid,once:!0},PolarAngleAxis:{handler:ae.renderPolarAxis},PolarRadiusAxis:{handler:ae.renderPolarAxis},Customized:{handler:ae.renderCustomized}}),ae.clipPathId="".concat((fe=ge.id)!==null&&fe!==void 0?fe:iS("recharts"),"-clip"),ae.throttleTriggeredAfterMouseMove=Uj(ae.triggeredAfterMouseMove,(xe=ge.throttleDelay)!==null&&xe!==void 0?xe:1e3/60),ae.state={},ae}return pye(oe,ee),uye(oe,[{key:"componentDidMount",value:function(){var fe,xe;this.addListener(),this.accessibilityManager.setDetails({container:this.container,offset:{left:(fe=this.props.margin.left)!==null&&fe!==void 0?fe:0,top:(xe=this.props.margin.top)!==null&&xe!==void 0?xe:0},coordinateList:this.state.tooltipTicks,mouseHandlerCallback:this.triggeredAfterMouseMove,layout:this.props.layout}),this.displayDefaultTooltip()}},{key:"displayDefaultTooltip",value:function(){var fe=this.props,xe=fe.children,ae=fe.data,me=fe.height,we=fe.layout,Ge=au(xe,Ld);if(Ge){var He=Ge.props.defaultIndex;if(!(typeof He!="number"||He<0||He>this.state.tooltipTicks.length-1)){var ye=this.state.tooltipTicks[He]&&this.state.tooltipTicks[He].value,ke=I4(this.state,ae,He,ye),dt=this.state.tooltipTicks[He].coordinate,vt=(this.state.offset.top+me)/2,jt=we==="horizontal",_t=jt?{x:dt,y:vt}:{y:dt,x:vt},gt=this.state.formattedGraphicalItems.find(function(Ht){var Bt=Ht.item;return Bt.type.name==="Scatter"});gt&&(_t=nn(nn({},_t),gt.props.points[He].tooltipPosition),ke=gt.props.points[He].tooltipPayload);var Vt={activeTooltipIndex:He,isTooltipActive:!0,activeLabel:ye,activePayload:ke,activeCoordinate:_t};this.setState(Vt),this.renderCursor(Ge),this.accessibilityManager.setIndex(He)}}}},{key:"getSnapshotBeforeUpdate",value:function(fe,xe){if(!this.props.accessibilityLayer)return null;if(this.state.tooltipTicks!==xe.tooltipTicks&&this.accessibilityManager.setDetails({coordinateList:this.state.tooltipTicks}),this.props.layout!==fe.layout&&this.accessibilityManager.setDetails({layout:this.props.layout}),this.props.margin!==fe.margin){var ae,me;this.accessibilityManager.setDetails({offset:{left:(ae=this.props.margin.left)!==null&&ae!==void 0?ae:0,top:(me=this.props.margin.top)!==null&&me!==void 0?me:0}})}return null}},{key:"componentDidUpdate",value:function(fe){x5([au(fe.children,Ld)],[au(this.props.children,Ld)])||this.displayDefaultTooltip()}},{key:"componentWillUnmount",value:function(){this.removeListener(),this.throttleTriggeredAfterMouseMove.cancel()}},{key:"getTooltipEventType",value:function(){var fe=au(this.props.children,Ld);if(fe&&typeof fe.props.shared=="boolean"){var xe=fe.props.shared?"axis":"item";return i.indexOf(xe)>=0?xe:y}return y}},{key:"getMouseInfo",value:function(fe){if(!this.container)return null;var xe=this.container,ae=xe.getBoundingClientRect(),me=gle(ae),we={chartX:Math.round(fe.pageX-me.left),chartY:Math.round(fe.pageY-me.top)},Ge=ae.width/xe.offsetWidth||1,He=this.inRange(we.chartX,we.chartY,Ge);if(!He)return null;var ye=this.state,ke=ye.xAxisMap,dt=ye.yAxisMap,vt=this.getTooltipEventType();if(vt!=="axis"&&ke&&dt){var jt=Tg(ke).scale,_t=Tg(dt).scale,gt=jt&&jt.invert?jt.invert(we.chartX):null,Vt=_t&&_t.invert?_t.invert(we.chartY):null;return nn(nn({},we),{},{xValue:gt,yValue:Vt})}var Ht=aB(this.state,this.props.data,this.props.layout,He);return Ht?nn(nn({},we),Ht):null}},{key:"inRange",value:function(fe,xe){var ae=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,me=this.props.layout,we=fe/ae,Ge=xe/ae;if(me==="horizontal"||me==="vertical"){var He=this.state.offset,ye=we>=He.left&&we<=He.left+He.width&&Ge>=He.top&&Ge<=He.top+He.height;return ye?{x:we,y:Ge}:null}var ke=this.state,dt=ke.angleAxisMap,vt=ke.radiusAxisMap;if(dt&&vt){var jt=Tg(dt);return S8({x:we,y:Ge},jt)}return null}},{key:"parseEventsOfWrapper",value:function(){var fe=this.props.children,xe=this.getTooltipEventType(),ae=au(fe,Ld),me={};ae&&xe==="axis"&&(ae.props.trigger==="click"?me={onClick:this.handleClick}:me={onMouseEnter:this.handleMouseEnter,onDoubleClick:this.handleDoubleClick,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onTouchMove:this.handleTouchMove,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd,onContextMenu:this.handleContextMenu});var we=Fb(this.props,this.handleOuterEvent);return nn(nn({},we),me)}},{key:"addListener",value:function(){RM.on(DM,this.handleReceiveSyncEvent)}},{key:"removeListener",value:function(){RM.removeListener(DM,this.handleReceiveSyncEvent)}},{key:"filterFormatItem",value:function(fe,xe,ae){for(var me=this.state.formattedGraphicalItems,we=0,Ge=me.length;we<Ge;we++){var He=me[we];if(He.item===fe||He.props.key===fe.key||xe===$d(He.item.type)&&ae===He.childIndex)return He}return null}},{key:"renderClipPath",value:function(){var fe=this.clipPathId,xe=this.state.offset,ae=xe.left,me=xe.top,we=xe.height,Ge=xe.width;return Ot.createElement("defs",null,Ot.createElement("clipPath",{id:fe},Ot.createElement("rect",{x:ae,y:me,height:we,width:Ge})))}},{key:"getXScales",value:function(){var fe=this.state.xAxisMap;return fe?Object.entries(fe).reduce(function(xe,ae){var me=nB(ae,2),we=me[0],Ge=me[1];return nn(nn({},xe),{},yr({},we,Ge.scale))},{}):null}},{key:"getYScales",value:function(){var fe=this.state.yAxisMap;return fe?Object.entries(fe).reduce(function(xe,ae){var me=nB(ae,2),we=me[0],Ge=me[1];return nn(nn({},xe),{},yr({},we,Ge.scale))},{}):null}},{key:"getXScaleByAxisId",value:function(fe){var xe;return(xe=this.state.xAxisMap)===null||xe===void 0||(xe=xe[fe])===null||xe===void 0?void 0:xe.scale}},{key:"getYScaleByAxisId",value:function(fe){var xe;return(xe=this.state.yAxisMap)===null||xe===void 0||(xe=xe[fe])===null||xe===void 0?void 0:xe.scale}},{key:"getItemByXY",value:function(fe){var xe=this.state,ae=xe.formattedGraphicalItems,me=xe.activeItem;if(ae&&ae.length)for(var we=0,Ge=ae.length;we<Ge;we++){var He=ae[we],ye=He.props,ke=He.item,dt=ke.type.defaultProps!==void 0?nn(nn({},ke.type.defaultProps),ke.props):ke.props,vt=$d(ke.type);if(vt==="Bar"){var jt=(ye.data||[]).find(function(Ht){return Ime(fe,Ht)});if(jt)return{graphicalItem:He,payload:jt}}else if(vt==="RadialBar"){var _t=(ye.data||[]).find(function(Ht){return S8(fe,Ht)});if(_t)return{graphicalItem:He,payload:_t}}else if(OS(He,me)||PS(He,me)||a2(He,me)){var gt=n_e({graphicalItem:He,activeTooltipItem:me,itemData:dt.data}),Vt=dt.activeIndex===void 0?gt:dt.activeIndex;return{graphicalItem:nn(nn({},He),{},{childIndex:Vt}),payload:a2(He,me)?dt.data[gt]:He.props.data[gt]}}}return null}},{key:"render",value:function(){var fe=this;if(!kL(this))return null;var xe=this.props,ae=xe.children,me=xe.className,we=xe.width,Ge=xe.height,He=xe.style,ye=xe.compact,ke=xe.title,dt=xe.desc,vt=rB(xe,rye),jt=Fr(vt,!1);if(ye)return Ot.createElement(G7,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},Ot.createElement(w5,Mg({},jt,{width:we,height:Ge,title:ke,desc:dt}),this.renderClipPath(),BL(ae,this.renderMap)));if(this.props.accessibilityLayer){var _t,gt;jt.tabIndex=(_t=this.props.tabIndex)!==null&&_t!==void 0?_t:0,jt.role=(gt=this.props.role)!==null&&gt!==void 0?gt:"application",jt.onKeyDown=function(Ht){fe.accessibilityManager.keyboardEvent(Ht)},jt.onFocus=function(){fe.accessibilityManager.focus()}}var Vt=this.parseEventsOfWrapper();return Ot.createElement(G7,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},Ot.createElement("div",Mg({className:oi("recharts-wrapper",me),style:nn({position:"relative",cursor:"default",width:we,height:Ge},He)},Vt,{ref:function(Bt){fe.container=Bt}}),Ot.createElement(w5,Mg({},jt,{width:we,height:Ge,title:ke,desc:dt,style:xye}),this.renderClipPath(),BL(ae,this.renderMap)),this.renderLegend(),this.renderTooltip()))}}])}(Ie.Component);yr(Y,"displayName",a),yr(Y,"defaultProps",nn({layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},F)),yr(Y,"getDerivedStateFromProps",function(ee,oe){var ge=ee.dataKey,fe=ee.data,xe=ee.children,ae=ee.width,me=ee.height,we=ee.layout,Ge=ee.stackOffset,He=ee.margin,ye=oe.dataStartIndex,ke=oe.dataEndIndex;if(oe.updateId===void 0){var dt=oB(ee);return nn(nn(nn({},dt),{},{updateId:0},X(nn(nn({props:ee},dt),{},{updateId:0}),oe)),{},{prevDataKey:ge,prevData:fe,prevWidth:ae,prevHeight:me,prevLayout:we,prevStackOffset:Ge,prevMargin:He,prevChildren:xe})}if(ge!==oe.prevDataKey||fe!==oe.prevData||ae!==oe.prevWidth||me!==oe.prevHeight||we!==oe.prevLayout||Ge!==oe.prevStackOffset||!y5(He,oe.prevMargin)){var vt=oB(ee),jt={chartX:oe.chartX,chartY:oe.chartY,isTooltipActive:oe.isTooltipActive},_t=nn(nn({},aB(oe,fe,we)),{},{updateId:oe.updateId+1}),gt=nn(nn(nn({},vt),jt),_t);return nn(nn(nn({},gt),X(nn({props:ee},gt),oe)),{},{prevDataKey:ge,prevData:fe,prevWidth:ae,prevHeight:me,prevLayout:we,prevStackOffset:Ge,prevMargin:He,prevChildren:xe})}if(!x5(xe,oe.prevChildren)){var Vt,Ht,Bt,et,$t=au(xe,ry),rn=$t&&(Vt=(Ht=$t.props)===null||Ht===void 0?void 0:Ht.startIndex)!==null&&Vt!==void 0?Vt:ye,Nt=$t&&(Bt=(et=$t.props)===null||et===void 0?void 0:et.endIndex)!==null&&Bt!==void 0?Bt:ke,xn=rn!==ye||Nt!==ke,rr=!ei(fe),Xn=rr&&!xn?oe.updateId:oe.updateId+1;return nn(nn({updateId:Xn},X(nn(nn({props:ee},oe),{},{updateId:Xn,dataStartIndex:rn,dataEndIndex:Nt}),oe)),{},{prevChildren:xe,dataStartIndex:rn,dataEndIndex:Nt})}return null}),yr(Y,"renderActiveDot",function(ee,oe,ge){var fe;return Ie.isValidElement(ee)?fe=Ie.cloneElement(ee,oe):Vr(ee)?fe=ee(oe):fe=Ot.createElement(bP,oe),Ot.createElement(Ga,{className:"recharts-active-dot",key:ge},fe)});var J=Ie.forwardRef(function(oe,ge){return Ot.createElement(Y,Mg({},oe,{ref:ge}))});return J.displayName=Y.displayName,J},Iye=Pye({chartName:"PieChart",GraphicalChild:bf,validateTooltipEventTypes:["item"],defaultTooltipEventType:"item",legendContent:"children",axisComponents:[{axisType:"angleAxis",AxisComp:MS},{axisType:"radiusAxis",AxisComp:AS}],formatAxisMap:Yfe,defaultProps:{layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"}});const Rye="_chart_1jflt_1",Dye={chart:Rye},lB={blue:{backgroundColor:"#05A6BE33",mainColor:"#05A6BE"}},kM=-90,Lye=-450,kye=1e3;function zye(e){return ve.jsx("div",{className:`${Dye.chart} ${e.className}`,children:ve.jsx(ule,{width:"100%",height:"100%",children:ve.jsxs(Iye,{children:[ve.jsx(bf,{data:[{value:e.maxValue}],dataKey:"value",fill:lB[e.colorTemplate].backgroundColor,animationDuration:0,innerRadius:"55%",outerRadius:"100%",stroke:"none"}),ve.jsx(bf,{data:[{value:e.value}],dataKey:"value",fill:lB[e.colorTemplate].mainColor,innerRadius:"55%",animationDuration:kye,outerRadius:"100%",startAngle:kM,stroke:"none",endAngle:kM+(Lye-kM)*e.value/e.maxValue})]})})})}const Bye="_power_pv1u1_1",Nye="_power__content_pv1u1_5",Fye="_content__icon_pv1u1_16",jye="_content__text_pv1u1_21",Uye="_power__pieChart_pv1u1_29",Wv={power:Bye,power__content:Nye,content__icon:Fye,content__text:jye,power__pieChart:Uye},Vye="data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20clip-path='url(%23clip0_1_383)'%3e%3cpath%20d='M17.1268%200.102663C17.2736%200.18777%2017.3872%200.320148%2017.4491%200.478169C17.5109%200.63619%2017.5173%200.810514%2017.4673%200.972663L14.7658%209.75066H19.7503C19.8968%209.7506%2020.0401%209.79344%2020.1625%209.87389C20.2849%209.95434%2020.3811%2010.0689%2020.4392%2010.2034C20.4972%2010.3378%2020.5146%2010.4864%2020.4893%2010.6306C20.4639%2010.7749%2020.3968%2010.9086%2020.2963%2011.0152L8.2963%2023.7652C8.18019%2023.8886%208.02568%2023.9691%207.85796%2023.9935C7.69024%2024.018%207.51919%2023.9848%207.3727%2023.8996C7.22622%2023.8143%207.11292%2023.682%207.05129%2023.5241C6.98965%2023.3662%206.98331%2023.1921%207.0333%2023.0302L9.7348%2014.2507H4.7503C4.60382%2014.2507%204.46052%2014.2079%204.33811%2014.1274C4.21569%2014.047%204.11951%2013.9325%204.06145%2013.798C4.00338%2013.6635%203.98596%2013.5149%204.01135%2013.3707C4.03674%2013.2264%204.10381%2013.0927%204.2043%2012.9862L16.2043%200.236163C16.3203%200.112861%2016.4745%200.0324155%2016.642%200.00790543C16.8095%20-0.0166046%2016.9804%200.0162624%2017.1268%200.101163V0.102663Z'%20fill='%2305A6BE'/%3e%3c/g%3e%3cdefs%3e%3cclipPath%20id='clip0_1_383'%3e%3crect%20width='24'%20height='24'%20fill='white'/%3e%3c/clipPath%3e%3c/defs%3e%3c/svg%3e";function $ye(e){return ve.jsxs("div",{className:Wv.power,children:[ve.jsxs("div",{className:Wv.power__content,children:[ve.jsx("img",{className:Wv.content__icon,src:Vye}),e.power!==0&&ve.jsxs("span",{className:Wv.content__text,children:[e.power," "]})]}),ve.jsx(zye,{value:e.power,maxValue:e.maxPower,colorTemplate:"blue",className:Wv.power__pieChart})]})}const qye="_content_1oanu_1",Gye="_content__connector_1oanu_9",Hye="_connector__icon_1oanu_17",Zye="_connector__type_1oanu_22",Wye="_content__details_1oanu_27",Xye="_details__station_1oanu_34",Yye="_station__info_1oanu_48",Kye="_info__name_1oanu_55",Jye="_info__address_1oanu_68",Qye="_details__tariffs_1oanu_77",eve="_tariffs__title_1oanu_84",tve="_data__item_1oanu_92",nve="_tariffs__data_1oanu_105",tc={content:qye,content__connector:Gye,connector__icon:Hye,connector__type:Zye,content__details:Wye,details__station:Xye,station__info:Yye,info__name:Kye,info__address:Jye,details__tariffs:Qye,tariffs__title:eve,data__item:tve,tariffs__data:nve};function rve(e){var a;const t=zo();return ve.jsxs(ko,{className:tc.content,children:[ve.jsxs("div",{className:tc.content__connector,children:[ve.jsx("img",{className:tc.connector__icon,src:g2[e.connectorInfo.standard],alt:e.connectorInfo.standard}),ve.jsx("p",{className:tc.connector__type,children:e.connectorInfo.standard})]}),ve.jsxs("div",{className:tc.content__details,children:[ve.jsxs("div",{className:tc.details__station,children:[ve.jsxs("div",{className:tc.station__info,children:[ve.jsx("p",{className:tc.info__name,children:e.connectorInfo.station_name}),ve.jsx("p",{className:tc.info__address,children:e.connectorInfo.station_address})]}),ve.jsx(vf,{variant:"icon",onClick:()=>t(_2+e.connectorInfo.station_id+lc([{key:Hd.PREVIOUS_PAGE,value:Vd.ACTIVE_SESSION},{key:Hd.FROM_CHARGING_SESSION_ID,value:e.sessionId}])),iconSrc:UF})]}),!!((a=e.tariffs)!=null&&a.length)&&ve.jsxs("div",{className:tc.details__tariffs,children:[ve.jsxs("p",{className:tc.tariffs__title,children:[ve.jsx("img",{src:PF}),"  :"]}),ve.jsx("div",{className:tc.tariffs__data,children:e.tariffs.map((o,h)=>ve.jsx("p",{className:tc.data__item,children:`${o.price} ${o.currency}/${IF[o.type]}`},h))})]})]})]})}function ive(e){const t=e.chargingSession.end_date===void 0?Db(Nw(new Date),e.chargingSession.start_date):Db(e.chargingSession.end_date,e.chargingSession.start_date),a=()=>{};return ve.jsxs(ve.Fragment,{children:[ve.jsx($ye,{power:e.chargingSession.current_power??0,maxPower:e.chargingSession.connector_info.max_electric_power??0}),ve.jsx("div",{className:ED.buttonBlock,children:ve.jsx(vf,{variant:"fill",onClick:a,text:""})}),ve.jsxs("div",{className:ED.info,children:[ve.jsx(rve,{sessionId:e.chargingSession.id,connectorInfo:e.chargingSession.connector_info,tariffs:e.chargingSession.tariffs}),ve.jsx(BT,{title:":",iconSrc:FF,items:[{description:":",value:`${e.chargingSession.charged_kwh} `},{description:" :",value:e.chargingSession.battery_percentage?`${e.chargingSession.battery_percentage} %`:"",checkVisible:Fv}]}),ve.jsx(BT,{title:"  :",iconSrc:jF,items:[{description:":",value:UN(e.chargingSession.start_date.hours,e.chargingSession.start_date.minutes,e.chargingSession.start_date.seconds)},{description:":",value:VN(t.hours,t.minutes,t.seconds)}]}),!!e.chargingSession.current_power&&ve.jsx(BT,{title:": ",iconSrc:Ire,items:[{description:":",value:e.chargingSession.max_power?`${e.chargingSession.max_power} `:"",checkVisible:Fv},{description:":",value:e.chargingSession.min_power?`${e.chargingSession.min_power} `:"",checkVisible:Fv},{description:":",value:e.chargingSession.current_power?`${e.chargingSession.current_power} `:"",checkVisible:Fv},{description:":",value:e.chargingSession.min_power&&e.chargingSession.max_power?`${(e.chargingSession.max_power+e.chargingSession.min_power)/2} `:"",checkVisible:Fv}]})]})]})}const ave=()=>{const[e]=nO(),[t,a]=Ie.useState({});return Ie.useEffect(()=>{const o=e.get(E1.PREVIOUS_PAGE);a({prev_page:o})},[e]),{pageQueries:t}},ove=(e,t,a)=>{const[o,h]=Ie.useState(),[y,b]=Ie.useState(!1);return Ie.useEffect(()=>{clearInterval(o),h(y?setInterval(()=>e(),t):void 0)},[y].concat(a)),Ie.useEffect(()=>()=>{clearInterval(o)},[o]),{activate:()=>b(!0),deactivate:()=>b(!1)}},NV=()=>{const{activeChargingSession:e,setActiveChargingSession:t}=Ie.useContext(Bo),{getChargingSessionByIdFromApi:a,getChargingSessionsFromApi:o}=X0(),[h,y]=Ie.useState(!1),[b,i]=Ie.useState(!!e),C=()=>{e||o({status:Nb.INVALID}).then(j=>{j.length>0&&t(j[0])}).finally(()=>{y(!1),i(!0)})},I=()=>{e&&a({id:e.id}).then(j=>{t(Nb.INVALID===(j==null?void 0:j.status)?j:void 0)}).finally(()=>{y(!1),i(!0)})};return ove(()=>{console.log("interval action"),y(!0),e?I():C()},1e4,[e,h]),Ie.useEffect(()=>{C()},[]),{initialized:b}};function sve(){const e=zo(),{pageQueries:t}=ave(),{activeChargingSession:a}=Ie.useContext(Bo),{initialized:o}=NV(),h=()=>{switch(t.prev_page){case A1.SESSIONS_LIST:return dy}return"/"};return!a&&o?ve.jsx(RF,{}):ve.jsx(Qd,{onReturn:()=>e(h()),title:" ",loading:!o,children:ve.jsx(ive,{chargingSession:a})})}var Mb={exports:{}},lve=Mb.exports,cB;function cve(){return cB||(cB=1,function(e,t){(function(a,o){e.exports=o()})(lve,function(){var a,o,h;function y(i,C){if(!a)a=C;else if(!o)o=C;else{var I="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+a+")(sharedChunk); ("+o+")(sharedChunk); self.onerror = null;",j={};a(j),h=C(j),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(h.workerUrl=window.URL.createObjectURL(new Blob([I],{type:"text/javascript"})))}}y(["exports"],function(i){function C(c){return c&&c.__esModule&&Object.prototype.hasOwnProperty.call(c,"default")?c.default:c}var I,j={},F={};function G(){if(I)return F;I=1,Object.defineProperty(F,"__esModule",{value:!0}),F.setMatrixArrayType=function(_){F.ARRAY_TYPE=n=_},F.toRadian=function(_){return _*u},F.equals=function(_,d){return Math.abs(_-d)<=c*Math.max(1,Math.abs(_),Math.abs(d))},F.RANDOM=F.ARRAY_TYPE=F.EPSILON=void 0;var c=1e-6;F.EPSILON=c;var n=typeof Float32Array<"u"?Float32Array:Array;F.ARRAY_TYPE=n;var s=Math.random;F.RANDOM=s;var u=Math.PI/180;return Math.hypot||(Math.hypot=function(){for(var _=0,d=arguments.length;d--;)_+=arguments[d]*arguments[d];return Math.sqrt(_)}),F}var X,Y={};function J(){if(X)return Y;function c(d){return c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(v){return typeof v}:function(v){return v&&typeof Symbol=="function"&&v.constructor===Symbol&&v!==Symbol.prototype?"symbol":typeof v},c(d)}X=1,Object.defineProperty(Y,"__esModule",{value:!0}),Y.create=function(){var d=new n.ARRAY_TYPE(4);return n.ARRAY_TYPE!=Float32Array&&(d[1]=0,d[2]=0),d[0]=1,d[3]=1,d},Y.clone=function(d){var v=new n.ARRAY_TYPE(4);return v[0]=d[0],v[1]=d[1],v[2]=d[2],v[3]=d[3],v},Y.copy=function(d,v){return d[0]=v[0],d[1]=v[1],d[2]=v[2],d[3]=v[3],d},Y.identity=function(d){return d[0]=1,d[1]=0,d[2]=0,d[3]=1,d},Y.fromValues=function(d,v,E,O){var z=new n.ARRAY_TYPE(4);return z[0]=d,z[1]=v,z[2]=E,z[3]=O,z},Y.set=function(d,v,E,O,z){return d[0]=v,d[1]=E,d[2]=O,d[3]=z,d},Y.transpose=function(d,v){if(d===v){var E=v[1];d[1]=v[2],d[2]=E}else d[0]=v[0],d[1]=v[2],d[2]=v[1],d[3]=v[3];return d},Y.invert=function(d,v){var E=v[0],O=v[1],z=v[2],S=v[3],P=E*S-z*O;return P?(d[0]=S*(P=1/P),d[1]=-O*P,d[2]=-z*P,d[3]=E*P,d):null},Y.adjoint=function(d,v){var E=v[0];return d[0]=v[3],d[1]=-v[1],d[2]=-v[2],d[3]=E,d},Y.determinant=function(d){return d[0]*d[3]-d[2]*d[1]},Y.multiply=u,Y.rotate=function(d,v,E){var O=v[0],z=v[1],S=v[2],P=v[3],L=Math.sin(E),M=Math.cos(E);return d[0]=O*M+S*L,d[1]=z*M+P*L,d[2]=O*-L+S*M,d[3]=z*-L+P*M,d},Y.scale=function(d,v,E){var O=v[1],z=v[2],S=v[3],P=E[0],L=E[1];return d[0]=v[0]*P,d[1]=O*P,d[2]=z*L,d[3]=S*L,d},Y.fromRotation=function(d,v){var E=Math.sin(v),O=Math.cos(v);return d[0]=O,d[1]=E,d[2]=-E,d[3]=O,d},Y.fromScaling=function(d,v){return d[0]=v[0],d[1]=0,d[2]=0,d[3]=v[1],d},Y.str=function(d){return"mat2("+d[0]+", "+d[1]+", "+d[2]+", "+d[3]+")"},Y.frob=function(d){return Math.hypot(d[0],d[1],d[2],d[3])},Y.LDU=function(d,v,E,O){return d[2]=O[2]/O[0],E[0]=O[0],E[1]=O[1],E[3]=O[3]-d[2]*E[1],[d,v,E]},Y.add=function(d,v,E){return d[0]=v[0]+E[0],d[1]=v[1]+E[1],d[2]=v[2]+E[2],d[3]=v[3]+E[3],d},Y.subtract=_,Y.exactEquals=function(d,v){return d[0]===v[0]&&d[1]===v[1]&&d[2]===v[2]&&d[3]===v[3]},Y.equals=function(d,v){var E=d[0],O=d[1],z=d[2],S=d[3],P=v[0],L=v[1],M=v[2],R=v[3];return Math.abs(E-P)<=n.EPSILON*Math.max(1,Math.abs(E),Math.abs(P))&&Math.abs(O-L)<=n.EPSILON*Math.max(1,Math.abs(O),Math.abs(L))&&Math.abs(z-M)<=n.EPSILON*Math.max(1,Math.abs(z),Math.abs(M))&&Math.abs(S-R)<=n.EPSILON*Math.max(1,Math.abs(S),Math.abs(R))},Y.multiplyScalar=function(d,v,E){return d[0]=v[0]*E,d[1]=v[1]*E,d[2]=v[2]*E,d[3]=v[3]*E,d},Y.multiplyScalarAndAdd=function(d,v,E,O){return d[0]=v[0]+E[0]*O,d[1]=v[1]+E[1]*O,d[2]=v[2]+E[2]*O,d[3]=v[3]+E[3]*O,d},Y.sub=Y.mul=void 0;var n=function(d,v){if(d&&d.__esModule)return d;if(d===null||c(d)!=="object"&&typeof d!="function")return{default:d};var E=s(void 0);if(E&&E.has(d))return E.get(d);var O={},z=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var S in d)if(S!=="default"&&Object.prototype.hasOwnProperty.call(d,S)){var P=z?Object.getOwnPropertyDescriptor(d,S):null;P&&(P.get||P.set)?Object.defineProperty(O,S,P):O[S]=d[S]}return O.default=d,E&&E.set(d,O),O}(G());function s(d){if(typeof WeakMap!="function")return null;var v=new WeakMap,E=new WeakMap;return(s=function(O){return O?E:v})(d)}function u(d,v,E){var O=v[0],z=v[1],S=v[2],P=v[3],L=E[0],M=E[1],R=E[2],B=E[3];return d[0]=O*L+S*M,d[1]=z*L+P*M,d[2]=O*R+S*B,d[3]=z*R+P*B,d}function _(d,v,E){return d[0]=v[0]-E[0],d[1]=v[1]-E[1],d[2]=v[2]-E[2],d[3]=v[3]-E[3],d}return Y.mul=u,Y.sub=_,Y}var ee,oe={};function ge(){if(ee)return oe;function c(d){return c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(v){return typeof v}:function(v){return v&&typeof Symbol=="function"&&v.constructor===Symbol&&v!==Symbol.prototype?"symbol":typeof v},c(d)}ee=1,Object.defineProperty(oe,"__esModule",{value:!0}),oe.create=function(){var d=new n.ARRAY_TYPE(6);return n.ARRAY_TYPE!=Float32Array&&(d[1]=0,d[2]=0,d[4]=0,d[5]=0),d[0]=1,d[3]=1,d},oe.clone=function(d){var v=new n.ARRAY_TYPE(6);return v[0]=d[0],v[1]=d[1],v[2]=d[2],v[3]=d[3],v[4]=d[4],v[5]=d[5],v},oe.copy=function(d,v){return d[0]=v[0],d[1]=v[1],d[2]=v[2],d[3]=v[3],d[4]=v[4],d[5]=v[5],d},oe.identity=function(d){return d[0]=1,d[1]=0,d[2]=0,d[3]=1,d[4]=0,d[5]=0,d},oe.fromValues=function(d,v,E,O,z,S){var P=new n.ARRAY_TYPE(6);return P[0]=d,P[1]=v,P[2]=E,P[3]=O,P[4]=z,P[5]=S,P},oe.set=function(d,v,E,O,z,S,P){return d[0]=v,d[1]=E,d[2]=O,d[3]=z,d[4]=S,d[5]=P,d},oe.invert=function(d,v){var E=v[0],O=v[1],z=v[2],S=v[3],P=v[4],L=v[5],M=E*S-O*z;return M?(d[0]=S*(M=1/M),d[1]=-O*M,d[2]=-z*M,d[3]=E*M,d[4]=(z*L-S*P)*M,d[5]=(O*P-E*L)*M,d):null},oe.determinant=function(d){return d[0]*d[3]-d[1]*d[2]},oe.multiply=u,oe.rotate=function(d,v,E){var O=v[0],z=v[1],S=v[2],P=v[3],L=v[4],M=v[5],R=Math.sin(E),B=Math.cos(E);return d[0]=O*B+S*R,d[1]=z*B+P*R,d[2]=O*-R+S*B,d[3]=z*-R+P*B,d[4]=L,d[5]=M,d},oe.scale=function(d,v,E){var O=v[1],z=v[2],S=v[3],P=v[4],L=v[5],M=E[0],R=E[1];return d[0]=v[0]*M,d[1]=O*M,d[2]=z*R,d[3]=S*R,d[4]=P,d[5]=L,d},oe.translate=function(d,v,E){var O=v[0],z=v[1],S=v[2],P=v[3],L=v[4],M=v[5],R=E[0],B=E[1];return d[0]=O,d[1]=z,d[2]=S,d[3]=P,d[4]=O*R+S*B+L,d[5]=z*R+P*B+M,d},oe.fromRotation=function(d,v){var E=Math.sin(v),O=Math.cos(v);return d[0]=O,d[1]=E,d[2]=-E,d[3]=O,d[4]=0,d[5]=0,d},oe.fromScaling=function(d,v){return d[0]=v[0],d[1]=0,d[2]=0,d[3]=v[1],d[4]=0,d[5]=0,d},oe.fromTranslation=function(d,v){return d[0]=1,d[1]=0,d[2]=0,d[3]=1,d[4]=v[0],d[5]=v[1],d},oe.str=function(d){return"mat2d("+d[0]+", "+d[1]+", "+d[2]+", "+d[3]+", "+d[4]+", "+d[5]+")"},oe.frob=function(d){return Math.hypot(d[0],d[1],d[2],d[3],d[4],d[5],1)},oe.add=function(d,v,E){return d[0]=v[0]+E[0],d[1]=v[1]+E[1],d[2]=v[2]+E[2],d[3]=v[3]+E[3],d[4]=v[4]+E[4],d[5]=v[5]+E[5],d},oe.subtract=_,oe.multiplyScalar=function(d,v,E){return d[0]=v[0]*E,d[1]=v[1]*E,d[2]=v[2]*E,d[3]=v[3]*E,d[4]=v[4]*E,d[5]=v[5]*E,d},oe.multiplyScalarAndAdd=function(d,v,E,O){return d[0]=v[0]+E[0]*O,d[1]=v[1]+E[1]*O,d[2]=v[2]+E[2]*O,d[3]=v[3]+E[3]*O,d[4]=v[4]+E[4]*O,d[5]=v[5]+E[5]*O,d},oe.exactEquals=function(d,v){return d[0]===v[0]&&d[1]===v[1]&&d[2]===v[2]&&d[3]===v[3]&&d[4]===v[4]&&d[5]===v[5]},oe.equals=function(d,v){var E=d[0],O=d[1],z=d[2],S=d[3],P=d[4],L=d[5],M=v[0],R=v[1],B=v[2],q=v[3],H=v[4],ne=v[5];return Math.abs(E-M)<=n.EPSILON*Math.max(1,Math.abs(E),Math.abs(M))&&Math.abs(O-R)<=n.EPSILON*Math.max(1,Math.abs(O),Math.abs(R))&&Math.abs(z-B)<=n.EPSILON*Math.max(1,Math.abs(z),Math.abs(B))&&Math.abs(S-q)<=n.EPSILON*Math.max(1,Math.abs(S),Math.abs(q))&&Math.abs(P-H)<=n.EPSILON*Math.max(1,Math.abs(P),Math.abs(H))&&Math.abs(L-ne)<=n.EPSILON*Math.max(1,Math.abs(L),Math.abs(ne))},oe.sub=oe.mul=void 0;var n=function(d,v){if(d&&d.__esModule)return d;if(d===null||c(d)!=="object"&&typeof d!="function")return{default:d};var E=s(void 0);if(E&&E.has(d))return E.get(d);var O={},z=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var S in d)if(S!=="default"&&Object.prototype.hasOwnProperty.call(d,S)){var P=z?Object.getOwnPropertyDescriptor(d,S):null;P&&(P.get||P.set)?Object.defineProperty(O,S,P):O[S]=d[S]}return O.default=d,E&&E.set(d,O),O}(G());function s(d){if(typeof WeakMap!="function")return null;var v=new WeakMap,E=new WeakMap;return(s=function(O){return O?E:v})(d)}function u(d,v,E){var O=v[0],z=v[1],S=v[2],P=v[3],L=v[4],M=v[5],R=E[0],B=E[1],q=E[2],H=E[3],ne=E[4],re=E[5];return d[0]=O*R+S*B,d[1]=z*R+P*B,d[2]=O*q+S*H,d[3]=z*q+P*H,d[4]=O*ne+S*re+L,d[5]=z*ne+P*re+M,d}function _(d,v,E){return d[0]=v[0]-E[0],d[1]=v[1]-E[1],d[2]=v[2]-E[2],d[3]=v[3]-E[3],d[4]=v[4]-E[4],d[5]=v[5]-E[5],d}return oe.mul=u,oe.sub=_,oe}var fe,xe={};function ae(){if(fe)return xe;function c(d){return c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(v){return typeof v}:function(v){return v&&typeof Symbol=="function"&&v.constructor===Symbol&&v!==Symbol.prototype?"symbol":typeof v},c(d)}fe=1,Object.defineProperty(xe,"__esModule",{value:!0}),xe.create=function(){var d=new n.ARRAY_TYPE(9);return n.ARRAY_TYPE!=Float32Array&&(d[1]=0,d[2]=0,d[3]=0,d[5]=0,d[6]=0,d[7]=0),d[0]=1,d[4]=1,d[8]=1,d},xe.fromMat4=function(d,v){return d[0]=v[0],d[1]=v[1],d[2]=v[2],d[3]=v[4],d[4]=v[5],d[5]=v[6],d[6]=v[8],d[7]=v[9],d[8]=v[10],d},xe.clone=function(d){var v=new n.ARRAY_TYPE(9);return v[0]=d[0],v[1]=d[1],v[2]=d[2],v[3]=d[3],v[4]=d[4],v[5]=d[5],v[6]=d[6],v[7]=d[7],v[8]=d[8],v},xe.copy=function(d,v){return d[0]=v[0],d[1]=v[1],d[2]=v[2],d[3]=v[3],d[4]=v[4],d[5]=v[5],d[6]=v[6],d[7]=v[7],d[8]=v[8],d},xe.fromValues=function(d,v,E,O,z,S,P,L,M){var R=new n.ARRAY_TYPE(9);return R[0]=d,R[1]=v,R[2]=E,R[3]=O,R[4]=z,R[5]=S,R[6]=P,R[7]=L,R[8]=M,R},xe.set=function(d,v,E,O,z,S,P,L,M,R){return d[0]=v,d[1]=E,d[2]=O,d[3]=z,d[4]=S,d[5]=P,d[6]=L,d[7]=M,d[8]=R,d},xe.identity=function(d){return d[0]=1,d[1]=0,d[2]=0,d[3]=0,d[4]=1,d[5]=0,d[6]=0,d[7]=0,d[8]=1,d},xe.transpose=function(d,v){if(d===v){var E=v[1],O=v[2],z=v[5];d[1]=v[3],d[2]=v[6],d[3]=E,d[5]=v[7],d[6]=O,d[7]=z}else d[0]=v[0],d[1]=v[3],d[2]=v[6],d[3]=v[1],d[4]=v[4],d[5]=v[7],d[6]=v[2],d[7]=v[5],d[8]=v[8];return d},xe.invert=function(d,v){var E=v[0],O=v[1],z=v[2],S=v[3],P=v[4],L=v[5],M=v[6],R=v[7],B=v[8],q=B*P-L*R,H=-B*S+L*M,ne=R*S-P*M,re=E*q+O*H+z*ne;return re?(d[0]=q*(re=1/re),d[1]=(-B*O+z*R)*re,d[2]=(L*O-z*P)*re,d[3]=H*re,d[4]=(B*E-z*M)*re,d[5]=(-L*E+z*S)*re,d[6]=ne*re,d[7]=(-R*E+O*M)*re,d[8]=(P*E-O*S)*re,d):null},xe.adjoint=function(d,v){var E=v[0],O=v[1],z=v[2],S=v[3],P=v[4],L=v[5],M=v[6],R=v[7],B=v[8];return d[0]=P*B-L*R,d[1]=z*R-O*B,d[2]=O*L-z*P,d[3]=L*M-S*B,d[4]=E*B-z*M,d[5]=z*S-E*L,d[6]=S*R-P*M,d[7]=O*M-E*R,d[8]=E*P-O*S,d},xe.determinant=function(d){var v=d[3],E=d[4],O=d[5],z=d[6],S=d[7],P=d[8];return d[0]*(P*E-O*S)+d[1]*(-P*v+O*z)+d[2]*(S*v-E*z)},xe.multiply=u,xe.translate=function(d,v,E){var O=v[0],z=v[1],S=v[2],P=v[3],L=v[4],M=v[5],R=v[6],B=v[7],q=v[8],H=E[0],ne=E[1];return d[0]=O,d[1]=z,d[2]=S,d[3]=P,d[4]=L,d[5]=M,d[6]=H*O+ne*P+R,d[7]=H*z+ne*L+B,d[8]=H*S+ne*M+q,d},xe.rotate=function(d,v,E){var O=v[0],z=v[1],S=v[2],P=v[3],L=v[4],M=v[5],R=v[6],B=v[7],q=v[8],H=Math.sin(E),ne=Math.cos(E);return d[0]=ne*O+H*P,d[1]=ne*z+H*L,d[2]=ne*S+H*M,d[3]=ne*P-H*O,d[4]=ne*L-H*z,d[5]=ne*M-H*S,d[6]=R,d[7]=B,d[8]=q,d},xe.scale=function(d,v,E){var O=E[0],z=E[1];return d[0]=O*v[0],d[1]=O*v[1],d[2]=O*v[2],d[3]=z*v[3],d[4]=z*v[4],d[5]=z*v[5],d[6]=v[6],d[7]=v[7],d[8]=v[8],d},xe.fromTranslation=function(d,v){return d[0]=1,d[1]=0,d[2]=0,d[3]=0,d[4]=1,d[5]=0,d[6]=v[0],d[7]=v[1],d[8]=1,d},xe.fromRotation=function(d,v){var E=Math.sin(v),O=Math.cos(v);return d[0]=O,d[1]=E,d[2]=0,d[3]=-E,d[4]=O,d[5]=0,d[6]=0,d[7]=0,d[8]=1,d},xe.fromScaling=function(d,v){return d[0]=v[0],d[1]=0,d[2]=0,d[3]=0,d[4]=v[1],d[5]=0,d[6]=0,d[7]=0,d[8]=1,d},xe.fromMat2d=function(d,v){return d[0]=v[0],d[1]=v[1],d[2]=0,d[3]=v[2],d[4]=v[3],d[5]=0,d[6]=v[4],d[7]=v[5],d[8]=1,d},xe.fromQuat=function(d,v){var E=v[0],O=v[1],z=v[2],S=v[3],P=E+E,L=O+O,M=z+z,R=E*P,B=O*P,q=O*L,H=z*P,ne=z*L,re=z*M,K=S*P,ie=S*L,ce=S*M;return d[0]=1-q-re,d[3]=B-ce,d[6]=H+ie,d[1]=B+ce,d[4]=1-R-re,d[7]=ne-K,d[2]=H-ie,d[5]=ne+K,d[8]=1-R-q,d},xe.normalFromMat4=function(d,v){var E=v[0],O=v[1],z=v[2],S=v[3],P=v[4],L=v[5],M=v[6],R=v[7],B=v[8],q=v[9],H=v[10],ne=v[11],re=v[12],K=v[13],ie=v[14],ce=v[15],_e=E*L-O*P,Ce=E*M-z*P,Ae=E*R-S*P,Ee=O*M-z*L,Ue=O*R-S*L,Oe=z*R-S*M,Ve=B*K-q*re,Ze=B*ie-H*re,qe=B*ce-ne*re,Ke=q*ie-H*K,Qe=q*ce-ne*K,at=H*ce-ne*ie,Je=_e*at-Ce*Qe+Ae*Ke+Ee*qe-Ue*Ze+Oe*Ve;return Je?(d[0]=(L*at-M*Qe+R*Ke)*(Je=1/Je),d[1]=(M*qe-P*at-R*Ze)*Je,d[2]=(P*Qe-L*qe+R*Ve)*Je,d[3]=(z*Qe-O*at-S*Ke)*Je,d[4]=(E*at-z*qe+S*Ze)*Je,d[5]=(O*qe-E*Qe-S*Ve)*Je,d[6]=(K*Oe-ie*Ue+ce*Ee)*Je,d[7]=(ie*Ae-re*Oe-ce*Ce)*Je,d[8]=(re*Ue-K*Ae+ce*_e)*Je,d):null},xe.projection=function(d,v,E){return d[0]=2/v,d[1]=0,d[2]=0,d[3]=0,d[4]=-2/E,d[5]=0,d[6]=-1,d[7]=1,d[8]=1,d},xe.str=function(d){return"mat3("+d[0]+", "+d[1]+", "+d[2]+", "+d[3]+", "+d[4]+", "+d[5]+", "+d[6]+", "+d[7]+", "+d[8]+")"},xe.frob=function(d){return Math.hypot(d[0],d[1],d[2],d[3],d[4],d[5],d[6],d[7],d[8])},xe.add=function(d,v,E){return d[0]=v[0]+E[0],d[1]=v[1]+E[1],d[2]=v[2]+E[2],d[3]=v[3]+E[3],d[4]=v[4]+E[4],d[5]=v[5]+E[5],d[6]=v[6]+E[6],d[7]=v[7]+E[7],d[8]=v[8]+E[8],d},xe.subtract=_,xe.multiplyScalar=function(d,v,E){return d[0]=v[0]*E,d[1]=v[1]*E,d[2]=v[2]*E,d[3]=v[3]*E,d[4]=v[4]*E,d[5]=v[5]*E,d[6]=v[6]*E,d[7]=v[7]*E,d[8]=v[8]*E,d},xe.multiplyScalarAndAdd=function(d,v,E,O){return d[0]=v[0]+E[0]*O,d[1]=v[1]+E[1]*O,d[2]=v[2]+E[2]*O,d[3]=v[3]+E[3]*O,d[4]=v[4]+E[4]*O,d[5]=v[5]+E[5]*O,d[6]=v[6]+E[6]*O,d[7]=v[7]+E[7]*O,d[8]=v[8]+E[8]*O,d},xe.exactEquals=function(d,v){return d[0]===v[0]&&d[1]===v[1]&&d[2]===v[2]&&d[3]===v[3]&&d[4]===v[4]&&d[5]===v[5]&&d[6]===v[6]&&d[7]===v[7]&&d[8]===v[8]},xe.equals=function(d,v){var E=d[0],O=d[1],z=d[2],S=d[3],P=d[4],L=d[5],M=d[6],R=d[7],B=d[8],q=v[0],H=v[1],ne=v[2],re=v[3],K=v[4],ie=v[5],ce=v[6],_e=v[7],Ce=v[8];return Math.abs(E-q)<=n.EPSILON*Math.max(1,Math.abs(E),Math.abs(q))&&Math.abs(O-H)<=n.EPSILON*Math.max(1,Math.abs(O),Math.abs(H))&&Math.abs(z-ne)<=n.EPSILON*Math.max(1,Math.abs(z),Math.abs(ne))&&Math.abs(S-re)<=n.EPSILON*Math.max(1,Math.abs(S),Math.abs(re))&&Math.abs(P-K)<=n.EPSILON*Math.max(1,Math.abs(P),Math.abs(K))&&Math.abs(L-ie)<=n.EPSILON*Math.max(1,Math.abs(L),Math.abs(ie))&&Math.abs(M-ce)<=n.EPSILON*Math.max(1,Math.abs(M),Math.abs(ce))&&Math.abs(R-_e)<=n.EPSILON*Math.max(1,Math.abs(R),Math.abs(_e))&&Math.abs(B-Ce)<=n.EPSILON*Math.max(1,Math.abs(B),Math.abs(Ce))},xe.sub=xe.mul=void 0;var n=function(d,v){if(d&&d.__esModule)return d;if(d===null||c(d)!=="object"&&typeof d!="function")return{default:d};var E=s(void 0);if(E&&E.has(d))return E.get(d);var O={},z=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var S in d)if(S!=="default"&&Object.prototype.hasOwnProperty.call(d,S)){var P=z?Object.getOwnPropertyDescriptor(d,S):null;P&&(P.get||P.set)?Object.defineProperty(O,S,P):O[S]=d[S]}return O.default=d,E&&E.set(d,O),O}(G());function s(d){if(typeof WeakMap!="function")return null;var v=new WeakMap,E=new WeakMap;return(s=function(O){return O?E:v})(d)}function u(d,v,E){var O=v[0],z=v[1],S=v[2],P=v[3],L=v[4],M=v[5],R=v[6],B=v[7],q=v[8],H=E[0],ne=E[1],re=E[2],K=E[3],ie=E[4],ce=E[5],_e=E[6],Ce=E[7],Ae=E[8];return d[0]=H*O+ne*P+re*R,d[1]=H*z+ne*L+re*B,d[2]=H*S+ne*M+re*q,d[3]=K*O+ie*P+ce*R,d[4]=K*z+ie*L+ce*B,d[5]=K*S+ie*M+ce*q,d[6]=_e*O+Ce*P+Ae*R,d[7]=_e*z+Ce*L+Ae*B,d[8]=_e*S+Ce*M+Ae*q,d}function _(d,v,E){return d[0]=v[0]-E[0],d[1]=v[1]-E[1],d[2]=v[2]-E[2],d[3]=v[3]-E[3],d[4]=v[4]-E[4],d[5]=v[5]-E[5],d[6]=v[6]-E[6],d[7]=v[7]-E[7],d[8]=v[8]-E[8],d}return xe.mul=u,xe.sub=_,xe}var me,we={};function Ge(){if(me)return we;function c(S){return c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(P){return typeof P}:function(P){return P&&typeof Symbol=="function"&&P.constructor===Symbol&&P!==Symbol.prototype?"symbol":typeof P},c(S)}me=1,Object.defineProperty(we,"__esModule",{value:!0}),we.create=function(){var S=new n.ARRAY_TYPE(16);return n.ARRAY_TYPE!=Float32Array&&(S[1]=0,S[2]=0,S[3]=0,S[4]=0,S[6]=0,S[7]=0,S[8]=0,S[9]=0,S[11]=0,S[12]=0,S[13]=0,S[14]=0),S[0]=1,S[5]=1,S[10]=1,S[15]=1,S},we.clone=function(S){var P=new n.ARRAY_TYPE(16);return P[0]=S[0],P[1]=S[1],P[2]=S[2],P[3]=S[3],P[4]=S[4],P[5]=S[5],P[6]=S[6],P[7]=S[7],P[8]=S[8],P[9]=S[9],P[10]=S[10],P[11]=S[11],P[12]=S[12],P[13]=S[13],P[14]=S[14],P[15]=S[15],P},we.copy=function(S,P){return S[0]=P[0],S[1]=P[1],S[2]=P[2],S[3]=P[3],S[4]=P[4],S[5]=P[5],S[6]=P[6],S[7]=P[7],S[8]=P[8],S[9]=P[9],S[10]=P[10],S[11]=P[11],S[12]=P[12],S[13]=P[13],S[14]=P[14],S[15]=P[15],S},we.fromValues=function(S,P,L,M,R,B,q,H,ne,re,K,ie,ce,_e,Ce,Ae){var Ee=new n.ARRAY_TYPE(16);return Ee[0]=S,Ee[1]=P,Ee[2]=L,Ee[3]=M,Ee[4]=R,Ee[5]=B,Ee[6]=q,Ee[7]=H,Ee[8]=ne,Ee[9]=re,Ee[10]=K,Ee[11]=ie,Ee[12]=ce,Ee[13]=_e,Ee[14]=Ce,Ee[15]=Ae,Ee},we.set=function(S,P,L,M,R,B,q,H,ne,re,K,ie,ce,_e,Ce,Ae,Ee){return S[0]=P,S[1]=L,S[2]=M,S[3]=R,S[4]=B,S[5]=q,S[6]=H,S[7]=ne,S[8]=re,S[9]=K,S[10]=ie,S[11]=ce,S[12]=_e,S[13]=Ce,S[14]=Ae,S[15]=Ee,S},we.identity=u,we.transpose=function(S,P){if(S===P){var L=P[1],M=P[2],R=P[3],B=P[6],q=P[7],H=P[11];S[1]=P[4],S[2]=P[8],S[3]=P[12],S[4]=L,S[6]=P[9],S[7]=P[13],S[8]=M,S[9]=B,S[11]=P[14],S[12]=R,S[13]=q,S[14]=H}else S[0]=P[0],S[1]=P[4],S[2]=P[8],S[3]=P[12],S[4]=P[1],S[5]=P[5],S[6]=P[9],S[7]=P[13],S[8]=P[2],S[9]=P[6],S[10]=P[10],S[11]=P[14],S[12]=P[3],S[13]=P[7],S[14]=P[11],S[15]=P[15];return S},we.invert=function(S,P){var L=P[0],M=P[1],R=P[2],B=P[3],q=P[4],H=P[5],ne=P[6],re=P[7],K=P[8],ie=P[9],ce=P[10],_e=P[11],Ce=P[12],Ae=P[13],Ee=P[14],Ue=P[15],Oe=L*H-M*q,Ve=L*ne-R*q,Ze=L*re-B*q,qe=M*ne-R*H,Ke=M*re-B*H,Qe=R*re-B*ne,at=K*Ae-ie*Ce,Je=K*Ee-ce*Ce,wt=K*Ue-_e*Ce,Rt=ie*Ee-ce*Ae,bt=ie*Ue-_e*Ae,an=ce*Ue-_e*Ee,Jt=Oe*an-Ve*bt+Ze*Rt+qe*wt-Ke*Je+Qe*at;return Jt?(S[0]=(H*an-ne*bt+re*Rt)*(Jt=1/Jt),S[1]=(R*bt-M*an-B*Rt)*Jt,S[2]=(Ae*Qe-Ee*Ke+Ue*qe)*Jt,S[3]=(ce*Ke-ie*Qe-_e*qe)*Jt,S[4]=(ne*wt-q*an-re*Je)*Jt,S[5]=(L*an-R*wt+B*Je)*Jt,S[6]=(Ee*Ze-Ce*Qe-Ue*Ve)*Jt,S[7]=(K*Qe-ce*Ze+_e*Ve)*Jt,S[8]=(q*bt-H*wt+re*at)*Jt,S[9]=(M*wt-L*bt-B*at)*Jt,S[10]=(Ce*Ke-Ae*Ze+Ue*Oe)*Jt,S[11]=(ie*Ze-K*Ke-_e*Oe)*Jt,S[12]=(H*Je-q*Rt-ne*at)*Jt,S[13]=(L*Rt-M*Je+R*at)*Jt,S[14]=(Ae*Ve-Ce*qe-Ee*Oe)*Jt,S[15]=(K*qe-ie*Ve+ce*Oe)*Jt,S):null},we.adjoint=function(S,P){var L=P[0],M=P[1],R=P[2],B=P[3],q=P[4],H=P[5],ne=P[6],re=P[7],K=P[8],ie=P[9],ce=P[10],_e=P[11],Ce=P[12],Ae=P[13],Ee=P[14],Ue=P[15];return S[0]=H*(ce*Ue-_e*Ee)-ie*(ne*Ue-re*Ee)+Ae*(ne*_e-re*ce),S[1]=-(M*(ce*Ue-_e*Ee)-ie*(R*Ue-B*Ee)+Ae*(R*_e-B*ce)),S[2]=M*(ne*Ue-re*Ee)-H*(R*Ue-B*Ee)+Ae*(R*re-B*ne),S[3]=-(M*(ne*_e-re*ce)-H*(R*_e-B*ce)+ie*(R*re-B*ne)),S[4]=-(q*(ce*Ue-_e*Ee)-K*(ne*Ue-re*Ee)+Ce*(ne*_e-re*ce)),S[5]=L*(ce*Ue-_e*Ee)-K*(R*Ue-B*Ee)+Ce*(R*_e-B*ce),S[6]=-(L*(ne*Ue-re*Ee)-q*(R*Ue-B*Ee)+Ce*(R*re-B*ne)),S[7]=L*(ne*_e-re*ce)-q*(R*_e-B*ce)+K*(R*re-B*ne),S[8]=q*(ie*Ue-_e*Ae)-K*(H*Ue-re*Ae)+Ce*(H*_e-re*ie),S[9]=-(L*(ie*Ue-_e*Ae)-K*(M*Ue-B*Ae)+Ce*(M*_e-B*ie)),S[10]=L*(H*Ue-re*Ae)-q*(M*Ue-B*Ae)+Ce*(M*re-B*H),S[11]=-(L*(H*_e-re*ie)-q*(M*_e-B*ie)+K*(M*re-B*H)),S[12]=-(q*(ie*Ee-ce*Ae)-K*(H*Ee-ne*Ae)+Ce*(H*ce-ne*ie)),S[13]=L*(ie*Ee-ce*Ae)-K*(M*Ee-R*Ae)+Ce*(M*ce-R*ie),S[14]=-(L*(H*Ee-ne*Ae)-q*(M*Ee-R*Ae)+Ce*(M*ne-R*H)),S[15]=L*(H*ce-ne*ie)-q*(M*ce-R*ie)+K*(M*ne-R*H),S},we.determinant=function(S){var P=S[0],L=S[1],M=S[2],R=S[3],B=S[4],q=S[5],H=S[6],ne=S[7],re=S[8],K=S[9],ie=S[10],ce=S[11],_e=S[12],Ce=S[13],Ae=S[14],Ee=S[15];return(P*q-L*B)*(ie*Ee-ce*Ae)-(P*H-M*B)*(K*Ee-ce*Ce)+(P*ne-R*B)*(K*Ae-ie*Ce)+(L*H-M*q)*(re*Ee-ce*_e)-(L*ne-R*q)*(re*Ae-ie*_e)+(M*ne-R*H)*(re*Ce-K*_e)},we.multiply=_,we.translate=function(S,P,L){var M,R,B,q,H,ne,re,K,ie,ce,_e,Ce,Ae=L[0],Ee=L[1],Ue=L[2];return P===S?(S[12]=P[0]*Ae+P[4]*Ee+P[8]*Ue+P[12],S[13]=P[1]*Ae+P[5]*Ee+P[9]*Ue+P[13],S[14]=P[2]*Ae+P[6]*Ee+P[10]*Ue+P[14],S[15]=P[3]*Ae+P[7]*Ee+P[11]*Ue+P[15]):(R=P[1],B=P[2],q=P[3],H=P[4],ne=P[5],re=P[6],K=P[7],ie=P[8],ce=P[9],_e=P[10],Ce=P[11],S[0]=M=P[0],S[1]=R,S[2]=B,S[3]=q,S[4]=H,S[5]=ne,S[6]=re,S[7]=K,S[8]=ie,S[9]=ce,S[10]=_e,S[11]=Ce,S[12]=M*Ae+H*Ee+ie*Ue+P[12],S[13]=R*Ae+ne*Ee+ce*Ue+P[13],S[14]=B*Ae+re*Ee+_e*Ue+P[14],S[15]=q*Ae+K*Ee+Ce*Ue+P[15]),S},we.scale=function(S,P,L){var M=L[0],R=L[1],B=L[2];return S[0]=P[0]*M,S[1]=P[1]*M,S[2]=P[2]*M,S[3]=P[3]*M,S[4]=P[4]*R,S[5]=P[5]*R,S[6]=P[6]*R,S[7]=P[7]*R,S[8]=P[8]*B,S[9]=P[9]*B,S[10]=P[10]*B,S[11]=P[11]*B,S[12]=P[12],S[13]=P[13],S[14]=P[14],S[15]=P[15],S},we.rotate=function(S,P,L,M){var R,B,q,H,ne,re,K,ie,ce,_e,Ce,Ae,Ee,Ue,Oe,Ve,Ze,qe,Ke,Qe,at,Je,wt,Rt,bt=M[0],an=M[1],Jt=M[2],Ut=Math.hypot(bt,an,Jt);return Ut<n.EPSILON?null:(bt*=Ut=1/Ut,an*=Ut,Jt*=Ut,R=Math.sin(L),B=Math.cos(L),ne=P[1],re=P[2],K=P[3],ce=P[5],_e=P[6],Ce=P[7],Ee=P[9],Ue=P[10],Oe=P[11],Ve=bt*bt*(q=1-B)+B,Ke=bt*an*q-Jt*R,Qe=an*an*q+B,at=Jt*an*q+bt*R,Je=bt*Jt*q+an*R,wt=an*Jt*q-bt*R,Rt=Jt*Jt*q+B,S[0]=(H=P[0])*Ve+(ie=P[4])*(Ze=an*bt*q+Jt*R)+(Ae=P[8])*(qe=Jt*bt*q-an*R),S[1]=ne*Ve+ce*Ze+Ee*qe,S[2]=re*Ve+_e*Ze+Ue*qe,S[3]=K*Ve+Ce*Ze+Oe*qe,S[4]=H*Ke+ie*Qe+Ae*at,S[5]=ne*Ke+ce*Qe+Ee*at,S[6]=re*Ke+_e*Qe+Ue*at,S[7]=K*Ke+Ce*Qe+Oe*at,S[8]=H*Je+ie*wt+Ae*Rt,S[9]=ne*Je+ce*wt+Ee*Rt,S[10]=re*Je+_e*wt+Ue*Rt,S[11]=K*Je+Ce*wt+Oe*Rt,P!==S&&(S[12]=P[12],S[13]=P[13],S[14]=P[14],S[15]=P[15]),S)},we.rotateX=function(S,P,L){var M=Math.sin(L),R=Math.cos(L),B=P[4],q=P[5],H=P[6],ne=P[7],re=P[8],K=P[9],ie=P[10],ce=P[11];return P!==S&&(S[0]=P[0],S[1]=P[1],S[2]=P[2],S[3]=P[3],S[12]=P[12],S[13]=P[13],S[14]=P[14],S[15]=P[15]),S[4]=B*R+re*M,S[5]=q*R+K*M,S[6]=H*R+ie*M,S[7]=ne*R+ce*M,S[8]=re*R-B*M,S[9]=K*R-q*M,S[10]=ie*R-H*M,S[11]=ce*R-ne*M,S},we.rotateY=function(S,P,L){var M=Math.sin(L),R=Math.cos(L),B=P[0],q=P[1],H=P[2],ne=P[3],re=P[8],K=P[9],ie=P[10],ce=P[11];return P!==S&&(S[4]=P[4],S[5]=P[5],S[6]=P[6],S[7]=P[7],S[12]=P[12],S[13]=P[13],S[14]=P[14],S[15]=P[15]),S[0]=B*R-re*M,S[1]=q*R-K*M,S[2]=H*R-ie*M,S[3]=ne*R-ce*M,S[8]=B*M+re*R,S[9]=q*M+K*R,S[10]=H*M+ie*R,S[11]=ne*M+ce*R,S},we.rotateZ=function(S,P,L){var M=Math.sin(L),R=Math.cos(L),B=P[0],q=P[1],H=P[2],ne=P[3],re=P[4],K=P[5],ie=P[6],ce=P[7];return P!==S&&(S[8]=P[8],S[9]=P[9],S[10]=P[10],S[11]=P[11],S[12]=P[12],S[13]=P[13],S[14]=P[14],S[15]=P[15]),S[0]=B*R+re*M,S[1]=q*R+K*M,S[2]=H*R+ie*M,S[3]=ne*R+ce*M,S[4]=re*R-B*M,S[5]=K*R-q*M,S[6]=ie*R-H*M,S[7]=ce*R-ne*M,S},we.fromTranslation=function(S,P){return S[0]=1,S[1]=0,S[2]=0,S[3]=0,S[4]=0,S[5]=1,S[6]=0,S[7]=0,S[8]=0,S[9]=0,S[10]=1,S[11]=0,S[12]=P[0],S[13]=P[1],S[14]=P[2],S[15]=1,S},we.fromScaling=function(S,P){return S[0]=P[0],S[1]=0,S[2]=0,S[3]=0,S[4]=0,S[5]=P[1],S[6]=0,S[7]=0,S[8]=0,S[9]=0,S[10]=P[2],S[11]=0,S[12]=0,S[13]=0,S[14]=0,S[15]=1,S},we.fromRotation=function(S,P,L){var M,R,B,q=L[0],H=L[1],ne=L[2],re=Math.hypot(q,H,ne);return re<n.EPSILON?null:(q*=re=1/re,H*=re,ne*=re,M=Math.sin(P),R=Math.cos(P),S[0]=q*q*(B=1-R)+R,S[1]=H*q*B+ne*M,S[2]=ne*q*B-H*M,S[3]=0,S[4]=q*H*B-ne*M,S[5]=H*H*B+R,S[6]=ne*H*B+q*M,S[7]=0,S[8]=q*ne*B+H*M,S[9]=H*ne*B-q*M,S[10]=ne*ne*B+R,S[11]=0,S[12]=0,S[13]=0,S[14]=0,S[15]=1,S)},we.fromXRotation=function(S,P){var L=Math.sin(P),M=Math.cos(P);return S[0]=1,S[1]=0,S[2]=0,S[3]=0,S[4]=0,S[5]=M,S[6]=L,S[7]=0,S[8]=0,S[9]=-L,S[10]=M,S[11]=0,S[12]=0,S[13]=0,S[14]=0,S[15]=1,S},we.fromYRotation=function(S,P){var L=Math.sin(P),M=Math.cos(P);return S[0]=M,S[1]=0,S[2]=-L,S[3]=0,S[4]=0,S[5]=1,S[6]=0,S[7]=0,S[8]=L,S[9]=0,S[10]=M,S[11]=0,S[12]=0,S[13]=0,S[14]=0,S[15]=1,S},we.fromZRotation=function(S,P){var L=Math.sin(P),M=Math.cos(P);return S[0]=M,S[1]=L,S[2]=0,S[3]=0,S[4]=-L,S[5]=M,S[6]=0,S[7]=0,S[8]=0,S[9]=0,S[10]=1,S[11]=0,S[12]=0,S[13]=0,S[14]=0,S[15]=1,S},we.fromRotationTranslation=d,we.fromQuat2=function(S,P){var L=new n.ARRAY_TYPE(3),M=-P[0],R=-P[1],B=-P[2],q=P[3],H=P[4],ne=P[5],re=P[6],K=P[7],ie=M*M+R*R+B*B+q*q;return ie>0?(L[0]=2*(H*q+K*M+ne*B-re*R)/ie,L[1]=2*(ne*q+K*R+re*M-H*B)/ie,L[2]=2*(re*q+K*B+H*R-ne*M)/ie):(L[0]=2*(H*q+K*M+ne*B-re*R),L[1]=2*(ne*q+K*R+re*M-H*B),L[2]=2*(re*q+K*B+H*R-ne*M)),d(S,P,L),S},we.getTranslation=function(S,P){return S[0]=P[12],S[1]=P[13],S[2]=P[14],S},we.getScaling=v,we.getRotation=function(S,P){var L=new n.ARRAY_TYPE(3);v(L,P);var M=1/L[0],R=1/L[1],B=1/L[2],q=P[0]*M,H=P[1]*R,ne=P[2]*B,re=P[4]*M,K=P[5]*R,ie=P[6]*B,ce=P[8]*M,_e=P[9]*R,Ce=P[10]*B,Ae=q+K+Ce,Ee=0;return Ae>0?(Ee=2*Math.sqrt(Ae+1),S[3]=.25*Ee,S[0]=(ie-_e)/Ee,S[1]=(ce-ne)/Ee,S[2]=(H-re)/Ee):q>K&&q>Ce?(Ee=2*Math.sqrt(1+q-K-Ce),S[3]=(ie-_e)/Ee,S[0]=.25*Ee,S[1]=(H+re)/Ee,S[2]=(ce+ne)/Ee):K>Ce?(Ee=2*Math.sqrt(1+K-q-Ce),S[3]=(ce-ne)/Ee,S[0]=(H+re)/Ee,S[1]=.25*Ee,S[2]=(ie+_e)/Ee):(Ee=2*Math.sqrt(1+Ce-q-K),S[3]=(H-re)/Ee,S[0]=(ce+ne)/Ee,S[1]=(ie+_e)/Ee,S[2]=.25*Ee),S},we.fromRotationTranslationScale=function(S,P,L,M){var R=P[0],B=P[1],q=P[2],H=P[3],ne=R+R,re=B+B,K=q+q,ie=R*ne,ce=R*re,_e=R*K,Ce=B*re,Ae=B*K,Ee=q*K,Ue=H*ne,Oe=H*re,Ve=H*K,Ze=M[0],qe=M[1],Ke=M[2];return S[0]=(1-(Ce+Ee))*Ze,S[1]=(ce+Ve)*Ze,S[2]=(_e-Oe)*Ze,S[3]=0,S[4]=(ce-Ve)*qe,S[5]=(1-(ie+Ee))*qe,S[6]=(Ae+Ue)*qe,S[7]=0,S[8]=(_e+Oe)*Ke,S[9]=(Ae-Ue)*Ke,S[10]=(1-(ie+Ce))*Ke,S[11]=0,S[12]=L[0],S[13]=L[1],S[14]=L[2],S[15]=1,S},we.fromRotationTranslationScaleOrigin=function(S,P,L,M,R){var B=P[0],q=P[1],H=P[2],ne=P[3],re=B+B,K=q+q,ie=H+H,ce=B*re,_e=B*K,Ce=B*ie,Ae=q*K,Ee=q*ie,Ue=H*ie,Oe=ne*re,Ve=ne*K,Ze=ne*ie,qe=M[0],Ke=M[1],Qe=M[2],at=R[0],Je=R[1],wt=R[2],Rt=(1-(Ae+Ue))*qe,bt=(_e+Ze)*qe,an=(Ce-Ve)*qe,Jt=(_e-Ze)*Ke,Ut=(1-(ce+Ue))*Ke,kt=(Ee+Oe)*Ke,vn=(Ce+Ve)*Qe,ln=(Ee-Oe)*Qe,pn=(1-(ce+Ae))*Qe;return S[0]=Rt,S[1]=bt,S[2]=an,S[3]=0,S[4]=Jt,S[5]=Ut,S[6]=kt,S[7]=0,S[8]=vn,S[9]=ln,S[10]=pn,S[11]=0,S[12]=L[0]+at-(Rt*at+Jt*Je+vn*wt),S[13]=L[1]+Je-(bt*at+Ut*Je+ln*wt),S[14]=L[2]+wt-(an*at+kt*Je+pn*wt),S[15]=1,S},we.fromQuat=function(S,P){var L=P[0],M=P[1],R=P[2],B=P[3],q=L+L,H=M+M,ne=R+R,re=L*q,K=M*q,ie=M*H,ce=R*q,_e=R*H,Ce=R*ne,Ae=B*q,Ee=B*H,Ue=B*ne;return S[0]=1-ie-Ce,S[1]=K+Ue,S[2]=ce-Ee,S[3]=0,S[4]=K-Ue,S[5]=1-re-Ce,S[6]=_e+Ae,S[7]=0,S[8]=ce+Ee,S[9]=_e-Ae,S[10]=1-re-ie,S[11]=0,S[12]=0,S[13]=0,S[14]=0,S[15]=1,S},we.frustum=function(S,P,L,M,R,B,q){var H=1/(L-P),ne=1/(R-M),re=1/(B-q);return S[0]=2*B*H,S[1]=0,S[2]=0,S[3]=0,S[4]=0,S[5]=2*B*ne,S[6]=0,S[7]=0,S[8]=(L+P)*H,S[9]=(R+M)*ne,S[10]=(q+B)*re,S[11]=-1,S[12]=0,S[13]=0,S[14]=q*B*2*re,S[15]=0,S},we.perspectiveNO=E,we.perspectiveZO=function(S,P,L,M,R){var B,q=1/Math.tan(P/2);return S[0]=q/L,S[1]=0,S[2]=0,S[3]=0,S[4]=0,S[5]=q,S[6]=0,S[7]=0,S[8]=0,S[9]=0,S[11]=-1,S[12]=0,S[13]=0,S[15]=0,R!=null&&R!==1/0?(S[10]=R*(B=1/(M-R)),S[14]=R*M*B):(S[10]=-1,S[14]=-M),S},we.perspectiveFromFieldOfView=function(S,P,L,M){var R=Math.tan(P.upDegrees*Math.PI/180),B=Math.tan(P.downDegrees*Math.PI/180),q=Math.tan(P.leftDegrees*Math.PI/180),H=Math.tan(P.rightDegrees*Math.PI/180),ne=2/(q+H),re=2/(R+B);return S[0]=ne,S[1]=0,S[2]=0,S[3]=0,S[4]=0,S[5]=re,S[6]=0,S[7]=0,S[8]=-(q-H)*ne*.5,S[9]=(R-B)*re*.5,S[10]=M/(L-M),S[11]=-1,S[12]=0,S[13]=0,S[14]=M*L/(L-M),S[15]=0,S},we.orthoNO=O,we.orthoZO=function(S,P,L,M,R,B,q){var H=1/(P-L),ne=1/(M-R),re=1/(B-q);return S[0]=-2*H,S[1]=0,S[2]=0,S[3]=0,S[4]=0,S[5]=-2*ne,S[6]=0,S[7]=0,S[8]=0,S[9]=0,S[10]=re,S[11]=0,S[12]=(P+L)*H,S[13]=(R+M)*ne,S[14]=B*re,S[15]=1,S},we.lookAt=function(S,P,L,M){var R,B,q,H,ne,re,K,ie,ce,_e,Ce=P[0],Ae=P[1],Ee=P[2],Ue=M[0],Oe=M[1],Ve=M[2],Ze=L[0],qe=L[1],Ke=L[2];return Math.abs(Ce-Ze)<n.EPSILON&&Math.abs(Ae-qe)<n.EPSILON&&Math.abs(Ee-Ke)<n.EPSILON?u(S):(K=Ce-Ze,ie=Ae-qe,ce=Ee-Ke,R=Oe*(ce*=_e=1/Math.hypot(K,ie,ce))-Ve*(ie*=_e),B=Ve*(K*=_e)-Ue*ce,q=Ue*ie-Oe*K,(_e=Math.hypot(R,B,q))?(R*=_e=1/_e,B*=_e,q*=_e):(R=0,B=0,q=0),H=ie*q-ce*B,ne=ce*R-K*q,re=K*B-ie*R,(_e=Math.hypot(H,ne,re))?(H*=_e=1/_e,ne*=_e,re*=_e):(H=0,ne=0,re=0),S[0]=R,S[1]=H,S[2]=K,S[3]=0,S[4]=B,S[5]=ne,S[6]=ie,S[7]=0,S[8]=q,S[9]=re,S[10]=ce,S[11]=0,S[12]=-(R*Ce+B*Ae+q*Ee),S[13]=-(H*Ce+ne*Ae+re*Ee),S[14]=-(K*Ce+ie*Ae+ce*Ee),S[15]=1,S)},we.targetTo=function(S,P,L,M){var R=P[0],B=P[1],q=P[2],H=M[0],ne=M[1],re=M[2],K=R-L[0],ie=B-L[1],ce=q-L[2],_e=K*K+ie*ie+ce*ce;_e>0&&(K*=_e=1/Math.sqrt(_e),ie*=_e,ce*=_e);var Ce=ne*ce-re*ie,Ae=re*K-H*ce,Ee=H*ie-ne*K;return(_e=Ce*Ce+Ae*Ae+Ee*Ee)>0&&(Ce*=_e=1/Math.sqrt(_e),Ae*=_e,Ee*=_e),S[0]=Ce,S[1]=Ae,S[2]=Ee,S[3]=0,S[4]=ie*Ee-ce*Ae,S[5]=ce*Ce-K*Ee,S[6]=K*Ae-ie*Ce,S[7]=0,S[8]=K,S[9]=ie,S[10]=ce,S[11]=0,S[12]=R,S[13]=B,S[14]=q,S[15]=1,S},we.str=function(S){return"mat4("+S[0]+", "+S[1]+", "+S[2]+", "+S[3]+", "+S[4]+", "+S[5]+", "+S[6]+", "+S[7]+", "+S[8]+", "+S[9]+", "+S[10]+", "+S[11]+", "+S[12]+", "+S[13]+", "+S[14]+", "+S[15]+")"},we.frob=function(S){return Math.hypot(S[0],S[1],S[2],S[3],S[4],S[5],S[6],S[7],S[8],S[9],S[10],S[11],S[12],S[13],S[14],S[15])},we.add=function(S,P,L){return S[0]=P[0]+L[0],S[1]=P[1]+L[1],S[2]=P[2]+L[2],S[3]=P[3]+L[3],S[4]=P[4]+L[4],S[5]=P[5]+L[5],S[6]=P[6]+L[6],S[7]=P[7]+L[7],S[8]=P[8]+L[8],S[9]=P[9]+L[9],S[10]=P[10]+L[10],S[11]=P[11]+L[11],S[12]=P[12]+L[12],S[13]=P[13]+L[13],S[14]=P[14]+L[14],S[15]=P[15]+L[15],S},we.subtract=z,we.multiplyScalar=function(S,P,L){return S[0]=P[0]*L,S[1]=P[1]*L,S[2]=P[2]*L,S[3]=P[3]*L,S[4]=P[4]*L,S[5]=P[5]*L,S[6]=P[6]*L,S[7]=P[7]*L,S[8]=P[8]*L,S[9]=P[9]*L,S[10]=P[10]*L,S[11]=P[11]*L,S[12]=P[12]*L,S[13]=P[13]*L,S[14]=P[14]*L,S[15]=P[15]*L,S},we.multiplyScalarAndAdd=function(S,P,L,M){return S[0]=P[0]+L[0]*M,S[1]=P[1]+L[1]*M,S[2]=P[2]+L[2]*M,S[3]=P[3]+L[3]*M,S[4]=P[4]+L[4]*M,S[5]=P[5]+L[5]*M,S[6]=P[6]+L[6]*M,S[7]=P[7]+L[7]*M,S[8]=P[8]+L[8]*M,S[9]=P[9]+L[9]*M,S[10]=P[10]+L[10]*M,S[11]=P[11]+L[11]*M,S[12]=P[12]+L[12]*M,S[13]=P[13]+L[13]*M,S[14]=P[14]+L[14]*M,S[15]=P[15]+L[15]*M,S},we.exactEquals=function(S,P){return S[0]===P[0]&&S[1]===P[1]&&S[2]===P[2]&&S[3]===P[3]&&S[4]===P[4]&&S[5]===P[5]&&S[6]===P[6]&&S[7]===P[7]&&S[8]===P[8]&&S[9]===P[9]&&S[10]===P[10]&&S[11]===P[11]&&S[12]===P[12]&&S[13]===P[13]&&S[14]===P[14]&&S[15]===P[15]},we.equals=function(S,P){var L=S[0],M=S[1],R=S[2],B=S[3],q=S[4],H=S[5],ne=S[6],re=S[7],K=S[8],ie=S[9],ce=S[10],_e=S[11],Ce=S[12],Ae=S[13],Ee=S[14],Ue=S[15],Oe=P[0],Ve=P[1],Ze=P[2],qe=P[3],Ke=P[4],Qe=P[5],at=P[6],Je=P[7],wt=P[8],Rt=P[9],bt=P[10],an=P[11],Jt=P[12],Ut=P[13],kt=P[14],vn=P[15];return Math.abs(L-Oe)<=n.EPSILON*Math.max(1,Math.abs(L),Math.abs(Oe))&&Math.abs(M-Ve)<=n.EPSILON*Math.max(1,Math.abs(M),Math.abs(Ve))&&Math.abs(R-Ze)<=n.EPSILON*Math.max(1,Math.abs(R),Math.abs(Ze))&&Math.abs(B-qe)<=n.EPSILON*Math.max(1,Math.abs(B),Math.abs(qe))&&Math.abs(q-Ke)<=n.EPSILON*Math.max(1,Math.abs(q),Math.abs(Ke))&&Math.abs(H-Qe)<=n.EPSILON*Math.max(1,Math.abs(H),Math.abs(Qe))&&Math.abs(ne-at)<=n.EPSILON*Math.max(1,Math.abs(ne),Math.abs(at))&&Math.abs(re-Je)<=n.EPSILON*Math.max(1,Math.abs(re),Math.abs(Je))&&Math.abs(K-wt)<=n.EPSILON*Math.max(1,Math.abs(K),Math.abs(wt))&&Math.abs(ie-Rt)<=n.EPSILON*Math.max(1,Math.abs(ie),Math.abs(Rt))&&Math.abs(ce-bt)<=n.EPSILON*Math.max(1,Math.abs(ce),Math.abs(bt))&&Math.abs(_e-an)<=n.EPSILON*Math.max(1,Math.abs(_e),Math.abs(an))&&Math.abs(Ce-Jt)<=n.EPSILON*Math.max(1,Math.abs(Ce),Math.abs(Jt))&&Math.abs(Ae-Ut)<=n.EPSILON*Math.max(1,Math.abs(Ae),Math.abs(Ut))&&Math.abs(Ee-kt)<=n.EPSILON*Math.max(1,Math.abs(Ee),Math.abs(kt))&&Math.abs(Ue-vn)<=n.EPSILON*Math.max(1,Math.abs(Ue),Math.abs(vn))},we.sub=we.mul=we.ortho=we.perspective=void 0;var n=function(S,P){if(S&&S.__esModule)return S;if(S===null||c(S)!=="object"&&typeof S!="function")return{default:S};var L=s(void 0);if(L&&L.has(S))return L.get(S);var M={},R=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var B in S)if(B!=="default"&&Object.prototype.hasOwnProperty.call(S,B)){var q=R?Object.getOwnPropertyDescriptor(S,B):null;q&&(q.get||q.set)?Object.defineProperty(M,B,q):M[B]=S[B]}return M.default=S,L&&L.set(S,M),M}(G());function s(S){if(typeof WeakMap!="function")return null;var P=new WeakMap,L=new WeakMap;return(s=function(M){return M?L:P})(S)}function u(S){return S[0]=1,S[1]=0,S[2]=0,S[3]=0,S[4]=0,S[5]=1,S[6]=0,S[7]=0,S[8]=0,S[9]=0,S[10]=1,S[11]=0,S[12]=0,S[13]=0,S[14]=0,S[15]=1,S}function _(S,P,L){var M=P[0],R=P[1],B=P[2],q=P[3],H=P[4],ne=P[5],re=P[6],K=P[7],ie=P[8],ce=P[9],_e=P[10],Ce=P[11],Ae=P[12],Ee=P[13],Ue=P[14],Oe=P[15],Ve=L[0],Ze=L[1],qe=L[2],Ke=L[3];return S[0]=Ve*M+Ze*H+qe*ie+Ke*Ae,S[1]=Ve*R+Ze*ne+qe*ce+Ke*Ee,S[2]=Ve*B+Ze*re+qe*_e+Ke*Ue,S[3]=Ve*q+Ze*K+qe*Ce+Ke*Oe,S[4]=(Ve=L[4])*M+(Ze=L[5])*H+(qe=L[6])*ie+(Ke=L[7])*Ae,S[5]=Ve*R+Ze*ne+qe*ce+Ke*Ee,S[6]=Ve*B+Ze*re+qe*_e+Ke*Ue,S[7]=Ve*q+Ze*K+qe*Ce+Ke*Oe,S[8]=(Ve=L[8])*M+(Ze=L[9])*H+(qe=L[10])*ie+(Ke=L[11])*Ae,S[9]=Ve*R+Ze*ne+qe*ce+Ke*Ee,S[10]=Ve*B+Ze*re+qe*_e+Ke*Ue,S[11]=Ve*q+Ze*K+qe*Ce+Ke*Oe,S[12]=(Ve=L[12])*M+(Ze=L[13])*H+(qe=L[14])*ie+(Ke=L[15])*Ae,S[13]=Ve*R+Ze*ne+qe*ce+Ke*Ee,S[14]=Ve*B+Ze*re+qe*_e+Ke*Ue,S[15]=Ve*q+Ze*K+qe*Ce+Ke*Oe,S}function d(S,P,L){var M=P[0],R=P[1],B=P[2],q=P[3],H=M+M,ne=R+R,re=B+B,K=M*H,ie=M*ne,ce=M*re,_e=R*ne,Ce=R*re,Ae=B*re,Ee=q*H,Ue=q*ne,Oe=q*re;return S[0]=1-(_e+Ae),S[1]=ie+Oe,S[2]=ce-Ue,S[3]=0,S[4]=ie-Oe,S[5]=1-(K+Ae),S[6]=Ce+Ee,S[7]=0,S[8]=ce+Ue,S[9]=Ce-Ee,S[10]=1-(K+_e),S[11]=0,S[12]=L[0],S[13]=L[1],S[14]=L[2],S[15]=1,S}function v(S,P){var L=P[4],M=P[5],R=P[6],B=P[8],q=P[9],H=P[10];return S[0]=Math.hypot(P[0],P[1],P[2]),S[1]=Math.hypot(L,M,R),S[2]=Math.hypot(B,q,H),S}function E(S,P,L,M,R){var B,q=1/Math.tan(P/2);return S[0]=q/L,S[1]=0,S[2]=0,S[3]=0,S[4]=0,S[5]=q,S[6]=0,S[7]=0,S[8]=0,S[9]=0,S[11]=-1,S[12]=0,S[13]=0,S[15]=0,R!=null&&R!==1/0?(S[10]=(R+M)*(B=1/(M-R)),S[14]=2*R*M*B):(S[10]=-1,S[14]=-2*M),S}function O(S,P,L,M,R,B,q){var H=1/(P-L),ne=1/(M-R),re=1/(B-q);return S[0]=-2*H,S[1]=0,S[2]=0,S[3]=0,S[4]=0,S[5]=-2*ne,S[6]=0,S[7]=0,S[8]=0,S[9]=0,S[10]=2*re,S[11]=0,S[12]=(P+L)*H,S[13]=(R+M)*ne,S[14]=(q+B)*re,S[15]=1,S}function z(S,P,L){return S[0]=P[0]-L[0],S[1]=P[1]-L[1],S[2]=P[2]-L[2],S[3]=P[3]-L[3],S[4]=P[4]-L[4],S[5]=P[5]-L[5],S[6]=P[6]-L[6],S[7]=P[7]-L[7],S[8]=P[8]-L[8],S[9]=P[9]-L[9],S[10]=P[10]-L[10],S[11]=P[11]-L[11],S[12]=P[12]-L[12],S[13]=P[13]-L[13],S[14]=P[14]-L[14],S[15]=P[15]-L[15],S}return we.perspective=E,we.ortho=O,we.mul=_,we.sub=z,we}var He,ye={},ke={};function dt(){if(He)return ke;function c(R){return c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(B){return typeof B}:function(B){return B&&typeof Symbol=="function"&&B.constructor===Symbol&&B!==Symbol.prototype?"symbol":typeof B},c(R)}He=1,Object.defineProperty(ke,"__esModule",{value:!0}),ke.create=u,ke.clone=function(R){var B=new n.ARRAY_TYPE(3);return B[0]=R[0],B[1]=R[1],B[2]=R[2],B},ke.length=_,ke.fromValues=function(R,B,q){var H=new n.ARRAY_TYPE(3);return H[0]=R,H[1]=B,H[2]=q,H},ke.copy=function(R,B){return R[0]=B[0],R[1]=B[1],R[2]=B[2],R},ke.set=function(R,B,q,H){return R[0]=B,R[1]=q,R[2]=H,R},ke.add=function(R,B,q){return R[0]=B[0]+q[0],R[1]=B[1]+q[1],R[2]=B[2]+q[2],R},ke.subtract=d,ke.multiply=v,ke.divide=E,ke.ceil=function(R,B){return R[0]=Math.ceil(B[0]),R[1]=Math.ceil(B[1]),R[2]=Math.ceil(B[2]),R},ke.floor=function(R,B){return R[0]=Math.floor(B[0]),R[1]=Math.floor(B[1]),R[2]=Math.floor(B[2]),R},ke.min=function(R,B,q){return R[0]=Math.min(B[0],q[0]),R[1]=Math.min(B[1],q[1]),R[2]=Math.min(B[2],q[2]),R},ke.max=function(R,B,q){return R[0]=Math.max(B[0],q[0]),R[1]=Math.max(B[1],q[1]),R[2]=Math.max(B[2],q[2]),R},ke.round=function(R,B){return R[0]=Math.round(B[0]),R[1]=Math.round(B[1]),R[2]=Math.round(B[2]),R},ke.scale=function(R,B,q){return R[0]=B[0]*q,R[1]=B[1]*q,R[2]=B[2]*q,R},ke.scaleAndAdd=function(R,B,q,H){return R[0]=B[0]+q[0]*H,R[1]=B[1]+q[1]*H,R[2]=B[2]+q[2]*H,R},ke.distance=O,ke.squaredDistance=z,ke.squaredLength=S,ke.negate=function(R,B){return R[0]=-B[0],R[1]=-B[1],R[2]=-B[2],R},ke.inverse=function(R,B){return R[0]=1/B[0],R[1]=1/B[1],R[2]=1/B[2],R},ke.normalize=function(R,B){var q=B[0],H=B[1],ne=B[2],re=q*q+H*H+ne*ne;return re>0&&(re=1/Math.sqrt(re)),R[0]=B[0]*re,R[1]=B[1]*re,R[2]=B[2]*re,R},ke.dot=P,ke.cross=function(R,B,q){var H=B[0],ne=B[1],re=B[2],K=q[0],ie=q[1],ce=q[2];return R[0]=ne*ce-re*ie,R[1]=re*K-H*ce,R[2]=H*ie-ne*K,R},ke.lerp=function(R,B,q,H){var ne=B[0],re=B[1],K=B[2];return R[0]=ne+H*(q[0]-ne),R[1]=re+H*(q[1]-re),R[2]=K+H*(q[2]-K),R},ke.hermite=function(R,B,q,H,ne,re){var K=re*re,ie=K*(2*re-3)+1,ce=K*(re-2)+re,_e=K*(re-1),Ce=K*(3-2*re);return R[0]=B[0]*ie+q[0]*ce+H[0]*_e+ne[0]*Ce,R[1]=B[1]*ie+q[1]*ce+H[1]*_e+ne[1]*Ce,R[2]=B[2]*ie+q[2]*ce+H[2]*_e+ne[2]*Ce,R},ke.bezier=function(R,B,q,H,ne,re){var K=1-re,ie=K*K,ce=re*re,_e=ie*K,Ce=3*re*ie,Ae=3*ce*K,Ee=ce*re;return R[0]=B[0]*_e+q[0]*Ce+H[0]*Ae+ne[0]*Ee,R[1]=B[1]*_e+q[1]*Ce+H[1]*Ae+ne[1]*Ee,R[2]=B[2]*_e+q[2]*Ce+H[2]*Ae+ne[2]*Ee,R},ke.random=function(R,B){B=B||1;var q=2*n.RANDOM()*Math.PI,H=2*n.RANDOM()-1,ne=Math.sqrt(1-H*H)*B;return R[0]=Math.cos(q)*ne,R[1]=Math.sin(q)*ne,R[2]=H*B,R},ke.transformMat4=function(R,B,q){var H=B[0],ne=B[1],re=B[2],K=q[3]*H+q[7]*ne+q[11]*re+q[15];return R[0]=(q[0]*H+q[4]*ne+q[8]*re+q[12])/(K=K||1),R[1]=(q[1]*H+q[5]*ne+q[9]*re+q[13])/K,R[2]=(q[2]*H+q[6]*ne+q[10]*re+q[14])/K,R},ke.transformMat3=function(R,B,q){var H=B[0],ne=B[1],re=B[2];return R[0]=H*q[0]+ne*q[3]+re*q[6],R[1]=H*q[1]+ne*q[4]+re*q[7],R[2]=H*q[2]+ne*q[5]+re*q[8],R},ke.transformQuat=function(R,B,q){var H=q[0],ne=q[1],re=q[2],K=B[0],ie=B[1],ce=B[2],_e=ne*ce-re*ie,Ce=re*K-H*ce,Ae=H*ie-ne*K,Ee=ne*Ae-re*Ce,Ue=re*_e-H*Ae,Oe=H*Ce-ne*_e,Ve=2*q[3];return Ce*=Ve,Ae*=Ve,Ue*=2,Oe*=2,R[0]=K+(_e*=Ve)+(Ee*=2),R[1]=ie+Ce+Ue,R[2]=ce+Ae+Oe,R},ke.rotateX=function(R,B,q,H){var ne=[],re=[];return ne[0]=B[0]-q[0],ne[1]=B[1]-q[1],ne[2]=B[2]-q[2],re[0]=ne[0],re[1]=ne[1]*Math.cos(H)-ne[2]*Math.sin(H),re[2]=ne[1]*Math.sin(H)+ne[2]*Math.cos(H),R[0]=re[0]+q[0],R[1]=re[1]+q[1],R[2]=re[2]+q[2],R},ke.rotateY=function(R,B,q,H){var ne=[],re=[];return ne[0]=B[0]-q[0],ne[1]=B[1]-q[1],ne[2]=B[2]-q[2],re[0]=ne[2]*Math.sin(H)+ne[0]*Math.cos(H),re[1]=ne[1],re[2]=ne[2]*Math.cos(H)-ne[0]*Math.sin(H),R[0]=re[0]+q[0],R[1]=re[1]+q[1],R[2]=re[2]+q[2],R},ke.rotateZ=function(R,B,q,H){var ne=[],re=[];return ne[0]=B[0]-q[0],ne[1]=B[1]-q[1],ne[2]=B[2]-q[2],re[0]=ne[0]*Math.cos(H)-ne[1]*Math.sin(H),re[1]=ne[0]*Math.sin(H)+ne[1]*Math.cos(H),re[2]=ne[2],R[0]=re[0]+q[0],R[1]=re[1]+q[1],R[2]=re[2]+q[2],R},ke.angle=function(R,B){var q=R[0],H=R[1],ne=R[2],re=B[0],K=B[1],ie=B[2],ce=Math.sqrt(q*q+H*H+ne*ne)*Math.sqrt(re*re+K*K+ie*ie),_e=ce&&P(R,B)/ce;return Math.acos(Math.min(Math.max(_e,-1),1))},ke.zero=function(R){return R[0]=0,R[1]=0,R[2]=0,R},ke.str=function(R){return"vec3("+R[0]+", "+R[1]+", "+R[2]+")"},ke.exactEquals=function(R,B){return R[0]===B[0]&&R[1]===B[1]&&R[2]===B[2]},ke.equals=function(R,B){var q=R[0],H=R[1],ne=R[2],re=B[0],K=B[1],ie=B[2];return Math.abs(q-re)<=n.EPSILON*Math.max(1,Math.abs(q),Math.abs(re))&&Math.abs(H-K)<=n.EPSILON*Math.max(1,Math.abs(H),Math.abs(K))&&Math.abs(ne-ie)<=n.EPSILON*Math.max(1,Math.abs(ne),Math.abs(ie))},ke.forEach=ke.sqrLen=ke.len=ke.sqrDist=ke.dist=ke.div=ke.mul=ke.sub=void 0;var n=function(R,B){if(R&&R.__esModule)return R;if(R===null||c(R)!=="object"&&typeof R!="function")return{default:R};var q=s(void 0);if(q&&q.has(R))return q.get(R);var H={},ne=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var re in R)if(re!=="default"&&Object.prototype.hasOwnProperty.call(R,re)){var K=ne?Object.getOwnPropertyDescriptor(R,re):null;K&&(K.get||K.set)?Object.defineProperty(H,re,K):H[re]=R[re]}return H.default=R,q&&q.set(R,H),H}(G());function s(R){if(typeof WeakMap!="function")return null;var B=new WeakMap,q=new WeakMap;return(s=function(H){return H?q:B})(R)}function u(){var R=new n.ARRAY_TYPE(3);return n.ARRAY_TYPE!=Float32Array&&(R[0]=0,R[1]=0,R[2]=0),R}function _(R){return Math.hypot(R[0],R[1],R[2])}function d(R,B,q){return R[0]=B[0]-q[0],R[1]=B[1]-q[1],R[2]=B[2]-q[2],R}function v(R,B,q){return R[0]=B[0]*q[0],R[1]=B[1]*q[1],R[2]=B[2]*q[2],R}function E(R,B,q){return R[0]=B[0]/q[0],R[1]=B[1]/q[1],R[2]=B[2]/q[2],R}function O(R,B){return Math.hypot(B[0]-R[0],B[1]-R[1],B[2]-R[2])}function z(R,B){var q=B[0]-R[0],H=B[1]-R[1],ne=B[2]-R[2];return q*q+H*H+ne*ne}function S(R){var B=R[0],q=R[1],H=R[2];return B*B+q*q+H*H}function P(R,B){return R[0]*B[0]+R[1]*B[1]+R[2]*B[2]}ke.sub=d,ke.mul=v,ke.div=E,ke.dist=O,ke.sqrDist=z,ke.len=_,ke.sqrLen=S;var L,M=(L=u(),function(R,B,q,H,ne,re){var K,ie;for(B||(B=3),q||(q=0),ie=H?Math.min(H*B+q,R.length):R.length,K=q;K<ie;K+=B)L[0]=R[K],L[1]=R[K+1],L[2]=R[K+2],ne(L,L,re),R[K]=L[0],R[K+1]=L[1],R[K+2]=L[2];return R});return ke.forEach=M,ke}var vt,jt,_t={};function gt(){if(vt)return _t;function c(M){return c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(R){return typeof R}:function(R){return R&&typeof Symbol=="function"&&R.constructor===Symbol&&R!==Symbol.prototype?"symbol":typeof R},c(M)}vt=1,Object.defineProperty(_t,"__esModule",{value:!0}),_t.create=u,_t.clone=function(M){var R=new n.ARRAY_TYPE(4);return R[0]=M[0],R[1]=M[1],R[2]=M[2],R[3]=M[3],R},_t.fromValues=function(M,R,B,q){var H=new n.ARRAY_TYPE(4);return H[0]=M,H[1]=R,H[2]=B,H[3]=q,H},_t.copy=function(M,R){return M[0]=R[0],M[1]=R[1],M[2]=R[2],M[3]=R[3],M},_t.set=function(M,R,B,q,H){return M[0]=R,M[1]=B,M[2]=q,M[3]=H,M},_t.add=function(M,R,B){return M[0]=R[0]+B[0],M[1]=R[1]+B[1],M[2]=R[2]+B[2],M[3]=R[3]+B[3],M},_t.subtract=_,_t.multiply=d,_t.divide=v,_t.ceil=function(M,R){return M[0]=Math.ceil(R[0]),M[1]=Math.ceil(R[1]),M[2]=Math.ceil(R[2]),M[3]=Math.ceil(R[3]),M},_t.floor=function(M,R){return M[0]=Math.floor(R[0]),M[1]=Math.floor(R[1]),M[2]=Math.floor(R[2]),M[3]=Math.floor(R[3]),M},_t.min=function(M,R,B){return M[0]=Math.min(R[0],B[0]),M[1]=Math.min(R[1],B[1]),M[2]=Math.min(R[2],B[2]),M[3]=Math.min(R[3],B[3]),M},_t.max=function(M,R,B){return M[0]=Math.max(R[0],B[0]),M[1]=Math.max(R[1],B[1]),M[2]=Math.max(R[2],B[2]),M[3]=Math.max(R[3],B[3]),M},_t.round=function(M,R){return M[0]=Math.round(R[0]),M[1]=Math.round(R[1]),M[2]=Math.round(R[2]),M[3]=Math.round(R[3]),M},_t.scale=function(M,R,B){return M[0]=R[0]*B,M[1]=R[1]*B,M[2]=R[2]*B,M[3]=R[3]*B,M},_t.scaleAndAdd=function(M,R,B,q){return M[0]=R[0]+B[0]*q,M[1]=R[1]+B[1]*q,M[2]=R[2]+B[2]*q,M[3]=R[3]+B[3]*q,M},_t.distance=E,_t.squaredDistance=O,_t.length=z,_t.squaredLength=S,_t.negate=function(M,R){return M[0]=-R[0],M[1]=-R[1],M[2]=-R[2],M[3]=-R[3],M},_t.inverse=function(M,R){return M[0]=1/R[0],M[1]=1/R[1],M[2]=1/R[2],M[3]=1/R[3],M},_t.normalize=function(M,R){var B=R[0],q=R[1],H=R[2],ne=R[3],re=B*B+q*q+H*H+ne*ne;return re>0&&(re=1/Math.sqrt(re)),M[0]=B*re,M[1]=q*re,M[2]=H*re,M[3]=ne*re,M},_t.dot=function(M,R){return M[0]*R[0]+M[1]*R[1]+M[2]*R[2]+M[3]*R[3]},_t.cross=function(M,R,B,q){var H=B[0]*q[1]-B[1]*q[0],ne=B[0]*q[2]-B[2]*q[0],re=B[0]*q[3]-B[3]*q[0],K=B[1]*q[2]-B[2]*q[1],ie=B[1]*q[3]-B[3]*q[1],ce=B[2]*q[3]-B[3]*q[2],_e=R[0],Ce=R[1],Ae=R[2],Ee=R[3];return M[0]=Ce*ce-Ae*ie+Ee*K,M[1]=-_e*ce+Ae*re-Ee*ne,M[2]=_e*ie-Ce*re+Ee*H,M[3]=-_e*K+Ce*ne-Ae*H,M},_t.lerp=function(M,R,B,q){var H=R[0],ne=R[1],re=R[2],K=R[3];return M[0]=H+q*(B[0]-H),M[1]=ne+q*(B[1]-ne),M[2]=re+q*(B[2]-re),M[3]=K+q*(B[3]-K),M},_t.random=function(M,R){var B,q,H,ne,re,K;R=R||1;do re=(B=2*n.RANDOM()-1)*B+(q=2*n.RANDOM()-1)*q;while(re>=1);do K=(H=2*n.RANDOM()-1)*H+(ne=2*n.RANDOM()-1)*ne;while(K>=1);var ie=Math.sqrt((1-re)/K);return M[0]=R*B,M[1]=R*q,M[2]=R*H*ie,M[3]=R*ne*ie,M},_t.transformMat4=function(M,R,B){var q=R[0],H=R[1],ne=R[2],re=R[3];return M[0]=B[0]*q+B[4]*H+B[8]*ne+B[12]*re,M[1]=B[1]*q+B[5]*H+B[9]*ne+B[13]*re,M[2]=B[2]*q+B[6]*H+B[10]*ne+B[14]*re,M[3]=B[3]*q+B[7]*H+B[11]*ne+B[15]*re,M},_t.transformQuat=function(M,R,B){var q=R[0],H=R[1],ne=R[2],re=B[0],K=B[1],ie=B[2],ce=B[3],_e=ce*q+K*ne-ie*H,Ce=ce*H+ie*q-re*ne,Ae=ce*ne+re*H-K*q,Ee=-re*q-K*H-ie*ne;return M[0]=_e*ce+Ee*-re+Ce*-ie-Ae*-K,M[1]=Ce*ce+Ee*-K+Ae*-re-_e*-ie,M[2]=Ae*ce+Ee*-ie+_e*-K-Ce*-re,M[3]=R[3],M},_t.zero=function(M){return M[0]=0,M[1]=0,M[2]=0,M[3]=0,M},_t.str=function(M){return"vec4("+M[0]+", "+M[1]+", "+M[2]+", "+M[3]+")"},_t.exactEquals=function(M,R){return M[0]===R[0]&&M[1]===R[1]&&M[2]===R[2]&&M[3]===R[3]},_t.equals=function(M,R){var B=M[0],q=M[1],H=M[2],ne=M[3],re=R[0],K=R[1],ie=R[2],ce=R[3];return Math.abs(B-re)<=n.EPSILON*Math.max(1,Math.abs(B),Math.abs(re))&&Math.abs(q-K)<=n.EPSILON*Math.max(1,Math.abs(q),Math.abs(K))&&Math.abs(H-ie)<=n.EPSILON*Math.max(1,Math.abs(H),Math.abs(ie))&&Math.abs(ne-ce)<=n.EPSILON*Math.max(1,Math.abs(ne),Math.abs(ce))},_t.forEach=_t.sqrLen=_t.len=_t.sqrDist=_t.dist=_t.div=_t.mul=_t.sub=void 0;var n=function(M,R){if(M&&M.__esModule)return M;if(M===null||c(M)!=="object"&&typeof M!="function")return{default:M};var B=s(void 0);if(B&&B.has(M))return B.get(M);var q={},H=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var ne in M)if(ne!=="default"&&Object.prototype.hasOwnProperty.call(M,ne)){var re=H?Object.getOwnPropertyDescriptor(M,ne):null;re&&(re.get||re.set)?Object.defineProperty(q,ne,re):q[ne]=M[ne]}return q.default=M,B&&B.set(M,q),q}(G());function s(M){if(typeof WeakMap!="function")return null;var R=new WeakMap,B=new WeakMap;return(s=function(q){return q?B:R})(M)}function u(){var M=new n.ARRAY_TYPE(4);return n.ARRAY_TYPE!=Float32Array&&(M[0]=0,M[1]=0,M[2]=0,M[3]=0),M}function _(M,R,B){return M[0]=R[0]-B[0],M[1]=R[1]-B[1],M[2]=R[2]-B[2],M[3]=R[3]-B[3],M}function d(M,R,B){return M[0]=R[0]*B[0],M[1]=R[1]*B[1],M[2]=R[2]*B[2],M[3]=R[3]*B[3],M}function v(M,R,B){return M[0]=R[0]/B[0],M[1]=R[1]/B[1],M[2]=R[2]/B[2],M[3]=R[3]/B[3],M}function E(M,R){return Math.hypot(R[0]-M[0],R[1]-M[1],R[2]-M[2],R[3]-M[3])}function O(M,R){var B=R[0]-M[0],q=R[1]-M[1],H=R[2]-M[2],ne=R[3]-M[3];return B*B+q*q+H*H+ne*ne}function z(M){return Math.hypot(M[0],M[1],M[2],M[3])}function S(M){var R=M[0],B=M[1],q=M[2],H=M[3];return R*R+B*B+q*q+H*H}_t.sub=_,_t.mul=d,_t.div=v,_t.dist=E,_t.sqrDist=O,_t.len=z,_t.sqrLen=S;var P,L=(P=u(),function(M,R,B,q,H,ne){var re,K;for(R||(R=4),B||(B=0),K=q?Math.min(q*R+B,M.length):M.length,re=B;re<K;re+=R)P[0]=M[re],P[1]=M[re+1],P[2]=M[re+2],P[3]=M[re+3],H(P,P,ne),M[re]=P[0],M[re+1]=P[1],M[re+2]=P[2],M[re+3]=P[3];return M});return _t.forEach=L,_t}function Vt(){if(jt)return ye;function c(Oe){return c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Ve){return typeof Ve}:function(Ve){return Ve&&typeof Symbol=="function"&&Ve.constructor===Symbol&&Ve!==Symbol.prototype?"symbol":typeof Ve},c(Oe)}jt=1,Object.defineProperty(ye,"__esModule",{value:!0}),ye.create=E,ye.identity=function(Oe){return Oe[0]=0,Oe[1]=0,Oe[2]=0,Oe[3]=1,Oe},ye.setAxisAngle=O,ye.getAxisAngle=function(Oe,Ve){var Ze=2*Math.acos(Ve[3]),qe=Math.sin(Ze/2);return qe>n.EPSILON?(Oe[0]=Ve[0]/qe,Oe[1]=Ve[1]/qe,Oe[2]=Ve[2]/qe):(Oe[0]=1,Oe[1]=0,Oe[2]=0),Ze},ye.getAngle=function(Oe,Ve){var Ze=B(Oe,Ve);return Math.acos(2*Ze*Ze-1)},ye.multiply=z,ye.rotateX=function(Oe,Ve,Ze){Ze*=.5;var qe=Ve[0],Ke=Ve[1],Qe=Ve[2],at=Ve[3],Je=Math.sin(Ze),wt=Math.cos(Ze);return Oe[0]=qe*wt+at*Je,Oe[1]=Ke*wt+Qe*Je,Oe[2]=Qe*wt-Ke*Je,Oe[3]=at*wt-qe*Je,Oe},ye.rotateY=function(Oe,Ve,Ze){Ze*=.5;var qe=Ve[0],Ke=Ve[1],Qe=Ve[2],at=Ve[3],Je=Math.sin(Ze),wt=Math.cos(Ze);return Oe[0]=qe*wt-Qe*Je,Oe[1]=Ke*wt+at*Je,Oe[2]=Qe*wt+qe*Je,Oe[3]=at*wt-Ke*Je,Oe},ye.rotateZ=function(Oe,Ve,Ze){Ze*=.5;var qe=Ve[0],Ke=Ve[1],Qe=Ve[2],at=Ve[3],Je=Math.sin(Ze),wt=Math.cos(Ze);return Oe[0]=qe*wt+Ke*Je,Oe[1]=Ke*wt-qe*Je,Oe[2]=Qe*wt+at*Je,Oe[3]=at*wt-Qe*Je,Oe},ye.calculateW=function(Oe,Ve){var Ze=Ve[0],qe=Ve[1],Ke=Ve[2];return Oe[0]=Ze,Oe[1]=qe,Oe[2]=Ke,Oe[3]=Math.sqrt(Math.abs(1-Ze*Ze-qe*qe-Ke*Ke)),Oe},ye.exp=S,ye.ln=P,ye.pow=function(Oe,Ve,Ze){return P(Oe,Ve),R(Oe,Oe,Ze),S(Oe,Oe),Oe},ye.slerp=L,ye.random=function(Oe){var Ve=n.RANDOM(),Ze=n.RANDOM(),qe=n.RANDOM(),Ke=Math.sqrt(1-Ve),Qe=Math.sqrt(Ve);return Oe[0]=Ke*Math.sin(2*Math.PI*Ze),Oe[1]=Ke*Math.cos(2*Math.PI*Ze),Oe[2]=Qe*Math.sin(2*Math.PI*qe),Oe[3]=Qe*Math.cos(2*Math.PI*qe),Oe},ye.invert=function(Oe,Ve){var Ze=Ve[0],qe=Ve[1],Ke=Ve[2],Qe=Ve[3],at=Ze*Ze+qe*qe+Ke*Ke+Qe*Qe,Je=at?1/at:0;return Oe[0]=-Ze*Je,Oe[1]=-qe*Je,Oe[2]=-Ke*Je,Oe[3]=Qe*Je,Oe},ye.conjugate=function(Oe,Ve){return Oe[0]=-Ve[0],Oe[1]=-Ve[1],Oe[2]=-Ve[2],Oe[3]=Ve[3],Oe},ye.fromMat3=M,ye.fromEuler=function(Oe,Ve,Ze,qe){var Ke=.5*Math.PI/180;Ve*=Ke,Ze*=Ke,qe*=Ke;var Qe=Math.sin(Ve),at=Math.cos(Ve),Je=Math.sin(Ze),wt=Math.cos(Ze),Rt=Math.sin(qe),bt=Math.cos(qe);return Oe[0]=Qe*wt*bt-at*Je*Rt,Oe[1]=at*Je*bt+Qe*wt*Rt,Oe[2]=at*wt*Rt-Qe*Je*bt,Oe[3]=at*wt*bt+Qe*Je*Rt,Oe},ye.str=function(Oe){return"quat("+Oe[0]+", "+Oe[1]+", "+Oe[2]+", "+Oe[3]+")"},ye.setAxes=ye.sqlerp=ye.rotationTo=ye.equals=ye.exactEquals=ye.normalize=ye.sqrLen=ye.squaredLength=ye.len=ye.length=ye.lerp=ye.dot=ye.scale=ye.mul=ye.add=ye.set=ye.copy=ye.fromValues=ye.clone=void 0;var n=v(G()),s=v(ae()),u=v(dt()),_=v(gt());function d(Oe){if(typeof WeakMap!="function")return null;var Ve=new WeakMap,Ze=new WeakMap;return(d=function(qe){return qe?Ze:Ve})(Oe)}function v(Oe,Ve){if(Oe&&Oe.__esModule)return Oe;if(Oe===null||c(Oe)!=="object"&&typeof Oe!="function")return{default:Oe};var Ze=d(Ve);if(Ze&&Ze.has(Oe))return Ze.get(Oe);var qe={},Ke=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var Qe in Oe)if(Qe!=="default"&&Object.prototype.hasOwnProperty.call(Oe,Qe)){var at=Ke?Object.getOwnPropertyDescriptor(Oe,Qe):null;at&&(at.get||at.set)?Object.defineProperty(qe,Qe,at):qe[Qe]=Oe[Qe]}return qe.default=Oe,Ze&&Ze.set(Oe,qe),qe}function E(){var Oe=new n.ARRAY_TYPE(4);return n.ARRAY_TYPE!=Float32Array&&(Oe[0]=0,Oe[1]=0,Oe[2]=0),Oe[3]=1,Oe}function O(Oe,Ve,Ze){Ze*=.5;var qe=Math.sin(Ze);return Oe[0]=qe*Ve[0],Oe[1]=qe*Ve[1],Oe[2]=qe*Ve[2],Oe[3]=Math.cos(Ze),Oe}function z(Oe,Ve,Ze){var qe=Ve[0],Ke=Ve[1],Qe=Ve[2],at=Ve[3],Je=Ze[0],wt=Ze[1],Rt=Ze[2],bt=Ze[3];return Oe[0]=qe*bt+at*Je+Ke*Rt-Qe*wt,Oe[1]=Ke*bt+at*wt+Qe*Je-qe*Rt,Oe[2]=Qe*bt+at*Rt+qe*wt-Ke*Je,Oe[3]=at*bt-qe*Je-Ke*wt-Qe*Rt,Oe}function S(Oe,Ve){var Ze=Ve[0],qe=Ve[1],Ke=Ve[2],Qe=Ve[3],at=Math.sqrt(Ze*Ze+qe*qe+Ke*Ke),Je=Math.exp(Qe),wt=at>0?Je*Math.sin(at)/at:0;return Oe[0]=Ze*wt,Oe[1]=qe*wt,Oe[2]=Ke*wt,Oe[3]=Je*Math.cos(at),Oe}function P(Oe,Ve){var Ze=Ve[0],qe=Ve[1],Ke=Ve[2],Qe=Ve[3],at=Math.sqrt(Ze*Ze+qe*qe+Ke*Ke),Je=at>0?Math.atan2(at,Qe)/at:0;return Oe[0]=Ze*Je,Oe[1]=qe*Je,Oe[2]=Ke*Je,Oe[3]=.5*Math.log(Ze*Ze+qe*qe+Ke*Ke+Qe*Qe),Oe}function L(Oe,Ve,Ze,qe){var Ke,Qe,at,Je,wt,Rt=Ve[0],bt=Ve[1],an=Ve[2],Jt=Ve[3],Ut=Ze[0],kt=Ze[1],vn=Ze[2],ln=Ze[3];return(Qe=Rt*Ut+bt*kt+an*vn+Jt*ln)<0&&(Qe=-Qe,Ut=-Ut,kt=-kt,vn=-vn,ln=-ln),1-Qe>n.EPSILON?(Ke=Math.acos(Qe),at=Math.sin(Ke),Je=Math.sin((1-qe)*Ke)/at,wt=Math.sin(qe*Ke)/at):(Je=1-qe,wt=qe),Oe[0]=Je*Rt+wt*Ut,Oe[1]=Je*bt+wt*kt,Oe[2]=Je*an+wt*vn,Oe[3]=Je*Jt+wt*ln,Oe}function M(Oe,Ve){var Ze,qe=Ve[0]+Ve[4]+Ve[8];if(qe>0)Ze=Math.sqrt(qe+1),Oe[3]=.5*Ze,Oe[0]=(Ve[5]-Ve[7])*(Ze=.5/Ze),Oe[1]=(Ve[6]-Ve[2])*Ze,Oe[2]=(Ve[1]-Ve[3])*Ze;else{var Ke=0;Ve[4]>Ve[0]&&(Ke=1),Ve[8]>Ve[3*Ke+Ke]&&(Ke=2);var Qe=(Ke+1)%3,at=(Ke+2)%3;Ze=Math.sqrt(Ve[3*Ke+Ke]-Ve[3*Qe+Qe]-Ve[3*at+at]+1),Oe[Ke]=.5*Ze,Oe[3]=(Ve[3*Qe+at]-Ve[3*at+Qe])*(Ze=.5/Ze),Oe[Qe]=(Ve[3*Qe+Ke]+Ve[3*Ke+Qe])*Ze,Oe[at]=(Ve[3*at+Ke]+Ve[3*Ke+at])*Ze}return Oe}ye.clone=_.clone,ye.fromValues=_.fromValues,ye.copy=_.copy,ye.set=_.set,ye.add=_.add,ye.mul=z;var R=_.scale;ye.scale=R;var B=_.dot;ye.dot=B,ye.lerp=_.lerp;var q=_.length;ye.length=q,ye.len=q;var H=_.squaredLength;ye.squaredLength=H,ye.sqrLen=H;var ne=_.normalize;ye.normalize=ne,ye.exactEquals=_.exactEquals,ye.equals=_.equals;var re,K,ie,ce=(re=u.create(),K=u.fromValues(1,0,0),ie=u.fromValues(0,1,0),function(Oe,Ve,Ze){var qe=u.dot(Ve,Ze);return qe<-.999999?(u.cross(re,K,Ve),u.len(re)<1e-6&&u.cross(re,ie,Ve),u.normalize(re,re),O(Oe,re,Math.PI),Oe):qe>.999999?(Oe[0]=0,Oe[1]=0,Oe[2]=0,Oe[3]=1,Oe):(u.cross(re,Ve,Ze),Oe[0]=re[0],Oe[1]=re[1],Oe[2]=re[2],Oe[3]=1+qe,ne(Oe,Oe))});ye.rotationTo=ce;var _e,Ce,Ae=(_e=E(),Ce=E(),function(Oe,Ve,Ze,qe,Ke,Qe){return L(_e,Ve,Ke,Qe),L(Ce,Ze,qe,Qe),L(Oe,_e,Ce,2*Qe*(1-Qe)),Oe});ye.sqlerp=Ae;var Ee,Ue=(Ee=s.create(),function(Oe,Ve,Ze,qe){return Ee[0]=Ze[0],Ee[3]=Ze[1],Ee[6]=Ze[2],Ee[1]=qe[0],Ee[4]=qe[1],Ee[7]=qe[2],Ee[2]=-Ve[0],Ee[5]=-Ve[1],Ee[8]=-Ve[2],ne(Oe,M(Oe,Ee))});return ye.setAxes=Ue,ye}var Ht,Bt={};function et(){if(Ht)return Bt;function c(L){return c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(M){return typeof M}:function(M){return M&&typeof Symbol=="function"&&M.constructor===Symbol&&M!==Symbol.prototype?"symbol":typeof M},c(L)}Ht=1,Object.defineProperty(Bt,"__esModule",{value:!0}),Bt.create=function(){var L=new n.ARRAY_TYPE(8);return n.ARRAY_TYPE!=Float32Array&&(L[0]=0,L[1]=0,L[2]=0,L[4]=0,L[5]=0,L[6]=0,L[7]=0),L[3]=1,L},Bt.clone=function(L){var M=new n.ARRAY_TYPE(8);return M[0]=L[0],M[1]=L[1],M[2]=L[2],M[3]=L[3],M[4]=L[4],M[5]=L[5],M[6]=L[6],M[7]=L[7],M},Bt.fromValues=function(L,M,R,B,q,H,ne,re){var K=new n.ARRAY_TYPE(8);return K[0]=L,K[1]=M,K[2]=R,K[3]=B,K[4]=q,K[5]=H,K[6]=ne,K[7]=re,K},Bt.fromRotationTranslationValues=function(L,M,R,B,q,H,ne){var re=new n.ARRAY_TYPE(8);re[0]=L,re[1]=M,re[2]=R,re[3]=B;var K=.5*q,ie=.5*H,ce=.5*ne;return re[4]=K*B+ie*R-ce*M,re[5]=ie*B+ce*L-K*R,re[6]=ce*B+K*M-ie*L,re[7]=-K*L-ie*M-ce*R,re},Bt.fromRotationTranslation=v,Bt.fromTranslation=function(L,M){return L[0]=0,L[1]=0,L[2]=0,L[3]=1,L[4]=.5*M[0],L[5]=.5*M[1],L[6]=.5*M[2],L[7]=0,L},Bt.fromRotation=function(L,M){return L[0]=M[0],L[1]=M[1],L[2]=M[2],L[3]=M[3],L[4]=0,L[5]=0,L[6]=0,L[7]=0,L},Bt.fromMat4=function(L,M){var R=s.create();u.getRotation(R,M);var B=new n.ARRAY_TYPE(3);return u.getTranslation(B,M),v(L,R,B),L},Bt.copy=E,Bt.identity=function(L){return L[0]=0,L[1]=0,L[2]=0,L[3]=1,L[4]=0,L[5]=0,L[6]=0,L[7]=0,L},Bt.set=function(L,M,R,B,q,H,ne,re,K){return L[0]=M,L[1]=R,L[2]=B,L[3]=q,L[4]=H,L[5]=ne,L[6]=re,L[7]=K,L},Bt.getDual=function(L,M){return L[0]=M[4],L[1]=M[5],L[2]=M[6],L[3]=M[7],L},Bt.setDual=function(L,M){return L[4]=M[0],L[5]=M[1],L[6]=M[2],L[7]=M[3],L},Bt.getTranslation=function(L,M){var R=M[4],B=M[5],q=M[6],H=M[7],ne=-M[0],re=-M[1],K=-M[2],ie=M[3];return L[0]=2*(R*ie+H*ne+B*K-q*re),L[1]=2*(B*ie+H*re+q*ne-R*K),L[2]=2*(q*ie+H*K+R*re-B*ne),L},Bt.translate=function(L,M,R){var B=M[0],q=M[1],H=M[2],ne=M[3],re=.5*R[0],K=.5*R[1],ie=.5*R[2],ce=M[4],_e=M[5],Ce=M[6],Ae=M[7];return L[0]=B,L[1]=q,L[2]=H,L[3]=ne,L[4]=ne*re+q*ie-H*K+ce,L[5]=ne*K+H*re-B*ie+_e,L[6]=ne*ie+B*K-q*re+Ce,L[7]=-B*re-q*K-H*ie+Ae,L},Bt.rotateX=function(L,M,R){var B=-M[0],q=-M[1],H=-M[2],ne=M[3],re=M[4],K=M[5],ie=M[6],ce=M[7],_e=re*ne+ce*B+K*H-ie*q,Ce=K*ne+ce*q+ie*B-re*H,Ae=ie*ne+ce*H+re*q-K*B,Ee=ce*ne-re*B-K*q-ie*H;return s.rotateX(L,M,R),L[4]=_e*(ne=L[3])+Ee*(B=L[0])+Ce*(H=L[2])-Ae*(q=L[1]),L[5]=Ce*ne+Ee*q+Ae*B-_e*H,L[6]=Ae*ne+Ee*H+_e*q-Ce*B,L[7]=Ee*ne-_e*B-Ce*q-Ae*H,L},Bt.rotateY=function(L,M,R){var B=-M[0],q=-M[1],H=-M[2],ne=M[3],re=M[4],K=M[5],ie=M[6],ce=M[7],_e=re*ne+ce*B+K*H-ie*q,Ce=K*ne+ce*q+ie*B-re*H,Ae=ie*ne+ce*H+re*q-K*B,Ee=ce*ne-re*B-K*q-ie*H;return s.rotateY(L,M,R),L[4]=_e*(ne=L[3])+Ee*(B=L[0])+Ce*(H=L[2])-Ae*(q=L[1]),L[5]=Ce*ne+Ee*q+Ae*B-_e*H,L[6]=Ae*ne+Ee*H+_e*q-Ce*B,L[7]=Ee*ne-_e*B-Ce*q-Ae*H,L},Bt.rotateZ=function(L,M,R){var B=-M[0],q=-M[1],H=-M[2],ne=M[3],re=M[4],K=M[5],ie=M[6],ce=M[7],_e=re*ne+ce*B+K*H-ie*q,Ce=K*ne+ce*q+ie*B-re*H,Ae=ie*ne+ce*H+re*q-K*B,Ee=ce*ne-re*B-K*q-ie*H;return s.rotateZ(L,M,R),L[4]=_e*(ne=L[3])+Ee*(B=L[0])+Ce*(H=L[2])-Ae*(q=L[1]),L[5]=Ce*ne+Ee*q+Ae*B-_e*H,L[6]=Ae*ne+Ee*H+_e*q-Ce*B,L[7]=Ee*ne-_e*B-Ce*q-Ae*H,L},Bt.rotateByQuatAppend=function(L,M,R){var B=R[0],q=R[1],H=R[2],ne=R[3],re=M[0],K=M[1],ie=M[2],ce=M[3];return L[0]=re*ne+ce*B+K*H-ie*q,L[1]=K*ne+ce*q+ie*B-re*H,L[2]=ie*ne+ce*H+re*q-K*B,L[3]=ce*ne-re*B-K*q-ie*H,L[4]=(re=M[4])*ne+(ce=M[7])*B+(K=M[5])*H-(ie=M[6])*q,L[5]=K*ne+ce*q+ie*B-re*H,L[6]=ie*ne+ce*H+re*q-K*B,L[7]=ce*ne-re*B-K*q-ie*H,L},Bt.rotateByQuatPrepend=function(L,M,R){var B=M[0],q=M[1],H=M[2],ne=M[3],re=R[0],K=R[1],ie=R[2],ce=R[3];return L[0]=B*ce+ne*re+q*ie-H*K,L[1]=q*ce+ne*K+H*re-B*ie,L[2]=H*ce+ne*ie+B*K-q*re,L[3]=ne*ce-B*re-q*K-H*ie,L[4]=B*(ce=R[7])+ne*(re=R[4])+q*(ie=R[6])-H*(K=R[5]),L[5]=q*ce+ne*K+H*re-B*ie,L[6]=H*ce+ne*ie+B*K-q*re,L[7]=ne*ce-B*re-q*K-H*ie,L},Bt.rotateAroundAxis=function(L,M,R,B){if(Math.abs(B)<n.EPSILON)return E(L,M);var q=Math.hypot(R[0],R[1],R[2]);B*=.5;var H=Math.sin(B),ne=H*R[0]/q,re=H*R[1]/q,K=H*R[2]/q,ie=Math.cos(B),ce=M[0],_e=M[1],Ce=M[2],Ae=M[3];L[0]=ce*ie+Ae*ne+_e*K-Ce*re,L[1]=_e*ie+Ae*re+Ce*ne-ce*K,L[2]=Ce*ie+Ae*K+ce*re-_e*ne,L[3]=Ae*ie-ce*ne-_e*re-Ce*K;var Ee=M[4],Ue=M[5],Oe=M[6],Ve=M[7];return L[4]=Ee*ie+Ve*ne+Ue*K-Oe*re,L[5]=Ue*ie+Ve*re+Oe*ne-Ee*K,L[6]=Oe*ie+Ve*K+Ee*re-Ue*ne,L[7]=Ve*ie-Ee*ne-Ue*re-Oe*K,L},Bt.add=function(L,M,R){return L[0]=M[0]+R[0],L[1]=M[1]+R[1],L[2]=M[2]+R[2],L[3]=M[3]+R[3],L[4]=M[4]+R[4],L[5]=M[5]+R[5],L[6]=M[6]+R[6],L[7]=M[7]+R[7],L},Bt.multiply=O,Bt.scale=function(L,M,R){return L[0]=M[0]*R,L[1]=M[1]*R,L[2]=M[2]*R,L[3]=M[3]*R,L[4]=M[4]*R,L[5]=M[5]*R,L[6]=M[6]*R,L[7]=M[7]*R,L},Bt.lerp=function(L,M,R,B){var q=1-B;return z(M,R)<0&&(B=-B),L[0]=M[0]*q+R[0]*B,L[1]=M[1]*q+R[1]*B,L[2]=M[2]*q+R[2]*B,L[3]=M[3]*q+R[3]*B,L[4]=M[4]*q+R[4]*B,L[5]=M[5]*q+R[5]*B,L[6]=M[6]*q+R[6]*B,L[7]=M[7]*q+R[7]*B,L},Bt.invert=function(L,M){var R=P(M);return L[0]=-M[0]/R,L[1]=-M[1]/R,L[2]=-M[2]/R,L[3]=M[3]/R,L[4]=-M[4]/R,L[5]=-M[5]/R,L[6]=-M[6]/R,L[7]=M[7]/R,L},Bt.conjugate=function(L,M){return L[0]=-M[0],L[1]=-M[1],L[2]=-M[2],L[3]=M[3],L[4]=-M[4],L[5]=-M[5],L[6]=-M[6],L[7]=M[7],L},Bt.normalize=function(L,M){var R=P(M);if(R>0){R=Math.sqrt(R);var B=M[0]/R,q=M[1]/R,H=M[2]/R,ne=M[3]/R,re=M[4],K=M[5],ie=M[6],ce=M[7],_e=B*re+q*K+H*ie+ne*ce;L[0]=B,L[1]=q,L[2]=H,L[3]=ne,L[4]=(re-B*_e)/R,L[5]=(K-q*_e)/R,L[6]=(ie-H*_e)/R,L[7]=(ce-ne*_e)/R}return L},Bt.str=function(L){return"quat2("+L[0]+", "+L[1]+", "+L[2]+", "+L[3]+", "+L[4]+", "+L[5]+", "+L[6]+", "+L[7]+")"},Bt.exactEquals=function(L,M){return L[0]===M[0]&&L[1]===M[1]&&L[2]===M[2]&&L[3]===M[3]&&L[4]===M[4]&&L[5]===M[5]&&L[6]===M[6]&&L[7]===M[7]},Bt.equals=function(L,M){var R=L[0],B=L[1],q=L[2],H=L[3],ne=L[4],re=L[5],K=L[6],ie=L[7],ce=M[0],_e=M[1],Ce=M[2],Ae=M[3],Ee=M[4],Ue=M[5],Oe=M[6],Ve=M[7];return Math.abs(R-ce)<=n.EPSILON*Math.max(1,Math.abs(R),Math.abs(ce))&&Math.abs(B-_e)<=n.EPSILON*Math.max(1,Math.abs(B),Math.abs(_e))&&Math.abs(q-Ce)<=n.EPSILON*Math.max(1,Math.abs(q),Math.abs(Ce))&&Math.abs(H-Ae)<=n.EPSILON*Math.max(1,Math.abs(H),Math.abs(Ae))&&Math.abs(ne-Ee)<=n.EPSILON*Math.max(1,Math.abs(ne),Math.abs(Ee))&&Math.abs(re-Ue)<=n.EPSILON*Math.max(1,Math.abs(re),Math.abs(Ue))&&Math.abs(K-Oe)<=n.EPSILON*Math.max(1,Math.abs(K),Math.abs(Oe))&&Math.abs(ie-Ve)<=n.EPSILON*Math.max(1,Math.abs(ie),Math.abs(Ve))},Bt.sqrLen=Bt.squaredLength=Bt.len=Bt.length=Bt.dot=Bt.mul=Bt.setReal=Bt.getReal=void 0;var n=d(G()),s=d(Vt()),u=d(Ge());function _(L){if(typeof WeakMap!="function")return null;var M=new WeakMap,R=new WeakMap;return(_=function(B){return B?R:M})(L)}function d(L,M){if(L&&L.__esModule)return L;if(L===null||c(L)!=="object"&&typeof L!="function")return{default:L};var R=_(M);if(R&&R.has(L))return R.get(L);var B={},q=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var H in L)if(H!=="default"&&Object.prototype.hasOwnProperty.call(L,H)){var ne=q?Object.getOwnPropertyDescriptor(L,H):null;ne&&(ne.get||ne.set)?Object.defineProperty(B,H,ne):B[H]=L[H]}return B.default=L,R&&R.set(L,B),B}function v(L,M,R){var B=.5*R[0],q=.5*R[1],H=.5*R[2],ne=M[0],re=M[1],K=M[2],ie=M[3];return L[0]=ne,L[1]=re,L[2]=K,L[3]=ie,L[4]=B*ie+q*K-H*re,L[5]=q*ie+H*ne-B*K,L[6]=H*ie+B*re-q*ne,L[7]=-B*ne-q*re-H*K,L}function E(L,M){return L[0]=M[0],L[1]=M[1],L[2]=M[2],L[3]=M[3],L[4]=M[4],L[5]=M[5],L[6]=M[6],L[7]=M[7],L}function O(L,M,R){var B=M[0],q=M[1],H=M[2],ne=M[3],re=R[4],K=R[5],ie=R[6],ce=R[7],_e=M[4],Ce=M[5],Ae=M[6],Ee=M[7],Ue=R[0],Oe=R[1],Ve=R[2],Ze=R[3];return L[0]=B*Ze+ne*Ue+q*Ve-H*Oe,L[1]=q*Ze+ne*Oe+H*Ue-B*Ve,L[2]=H*Ze+ne*Ve+B*Oe-q*Ue,L[3]=ne*Ze-B*Ue-q*Oe-H*Ve,L[4]=B*ce+ne*re+q*ie-H*K+_e*Ze+Ee*Ue+Ce*Ve-Ae*Oe,L[5]=q*ce+ne*K+H*re-B*ie+Ce*Ze+Ee*Oe+Ae*Ue-_e*Ve,L[6]=H*ce+ne*ie+B*K-q*re+Ae*Ze+Ee*Ve+_e*Oe-Ce*Ue,L[7]=ne*ce-B*re-q*K-H*ie+Ee*Ze-_e*Ue-Ce*Oe-Ae*Ve,L}Bt.getReal=s.copy,Bt.setReal=s.copy,Bt.mul=O;var z=s.dot;Bt.dot=z;var S=s.length;Bt.length=S,Bt.len=S;var P=s.squaredLength;return Bt.squaredLength=P,Bt.sqrLen=P,Bt}var $t,rn,Nt={};function xn(){if($t)return Nt;function c(M){return c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(R){return typeof R}:function(R){return R&&typeof Symbol=="function"&&R.constructor===Symbol&&R!==Symbol.prototype?"symbol":typeof R},c(M)}$t=1,Object.defineProperty(Nt,"__esModule",{value:!0}),Nt.create=u,Nt.clone=function(M){var R=new n.ARRAY_TYPE(2);return R[0]=M[0],R[1]=M[1],R},Nt.fromValues=function(M,R){var B=new n.ARRAY_TYPE(2);return B[0]=M,B[1]=R,B},Nt.copy=function(M,R){return M[0]=R[0],M[1]=R[1],M},Nt.set=function(M,R,B){return M[0]=R,M[1]=B,M},Nt.add=function(M,R,B){return M[0]=R[0]+B[0],M[1]=R[1]+B[1],M},Nt.subtract=_,Nt.multiply=d,Nt.divide=v,Nt.ceil=function(M,R){return M[0]=Math.ceil(R[0]),M[1]=Math.ceil(R[1]),M},Nt.floor=function(M,R){return M[0]=Math.floor(R[0]),M[1]=Math.floor(R[1]),M},Nt.min=function(M,R,B){return M[0]=Math.min(R[0],B[0]),M[1]=Math.min(R[1],B[1]),M},Nt.max=function(M,R,B){return M[0]=Math.max(R[0],B[0]),M[1]=Math.max(R[1],B[1]),M},Nt.round=function(M,R){return M[0]=Math.round(R[0]),M[1]=Math.round(R[1]),M},Nt.scale=function(M,R,B){return M[0]=R[0]*B,M[1]=R[1]*B,M},Nt.scaleAndAdd=function(M,R,B,q){return M[0]=R[0]+B[0]*q,M[1]=R[1]+B[1]*q,M},Nt.distance=E,Nt.squaredDistance=O,Nt.length=z,Nt.squaredLength=S,Nt.negate=function(M,R){return M[0]=-R[0],M[1]=-R[1],M},Nt.inverse=function(M,R){return M[0]=1/R[0],M[1]=1/R[1],M},Nt.normalize=function(M,R){var B=R[0],q=R[1],H=B*B+q*q;return H>0&&(H=1/Math.sqrt(H)),M[0]=R[0]*H,M[1]=R[1]*H,M},Nt.dot=function(M,R){return M[0]*R[0]+M[1]*R[1]},Nt.cross=function(M,R,B){var q=R[0]*B[1]-R[1]*B[0];return M[0]=M[1]=0,M[2]=q,M},Nt.lerp=function(M,R,B,q){var H=R[0],ne=R[1];return M[0]=H+q*(B[0]-H),M[1]=ne+q*(B[1]-ne),M},Nt.random=function(M,R){R=R||1;var B=2*n.RANDOM()*Math.PI;return M[0]=Math.cos(B)*R,M[1]=Math.sin(B)*R,M},Nt.transformMat2=function(M,R,B){var q=R[0],H=R[1];return M[0]=B[0]*q+B[2]*H,M[1]=B[1]*q+B[3]*H,M},Nt.transformMat2d=function(M,R,B){var q=R[0],H=R[1];return M[0]=B[0]*q+B[2]*H+B[4],M[1]=B[1]*q+B[3]*H+B[5],M},Nt.transformMat3=function(M,R,B){var q=R[0],H=R[1];return M[0]=B[0]*q+B[3]*H+B[6],M[1]=B[1]*q+B[4]*H+B[7],M},Nt.transformMat4=function(M,R,B){var q=R[0],H=R[1];return M[0]=B[0]*q+B[4]*H+B[12],M[1]=B[1]*q+B[5]*H+B[13],M},Nt.rotate=function(M,R,B,q){var H=R[0]-B[0],ne=R[1]-B[1],re=Math.sin(q),K=Math.cos(q);return M[0]=H*K-ne*re+B[0],M[1]=H*re+ne*K+B[1],M},Nt.angle=function(M,R){var B=M[0],q=M[1],H=R[0],ne=R[1],re=Math.sqrt(B*B+q*q)*Math.sqrt(H*H+ne*ne);return Math.acos(Math.min(Math.max(re&&(B*H+q*ne)/re,-1),1))},Nt.zero=function(M){return M[0]=0,M[1]=0,M},Nt.str=function(M){return"vec2("+M[0]+", "+M[1]+")"},Nt.exactEquals=function(M,R){return M[0]===R[0]&&M[1]===R[1]},Nt.equals=function(M,R){var B=M[0],q=M[1],H=R[0],ne=R[1];return Math.abs(B-H)<=n.EPSILON*Math.max(1,Math.abs(B),Math.abs(H))&&Math.abs(q-ne)<=n.EPSILON*Math.max(1,Math.abs(q),Math.abs(ne))},Nt.forEach=Nt.sqrLen=Nt.sqrDist=Nt.dist=Nt.div=Nt.mul=Nt.sub=Nt.len=void 0;var n=function(M,R){if(M&&M.__esModule)return M;if(M===null||c(M)!=="object"&&typeof M!="function")return{default:M};var B=s(void 0);if(B&&B.has(M))return B.get(M);var q={},H=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var ne in M)if(ne!=="default"&&Object.prototype.hasOwnProperty.call(M,ne)){var re=H?Object.getOwnPropertyDescriptor(M,ne):null;re&&(re.get||re.set)?Object.defineProperty(q,ne,re):q[ne]=M[ne]}return q.default=M,B&&B.set(M,q),q}(G());function s(M){if(typeof WeakMap!="function")return null;var R=new WeakMap,B=new WeakMap;return(s=function(q){return q?B:R})(M)}function u(){var M=new n.ARRAY_TYPE(2);return n.ARRAY_TYPE!=Float32Array&&(M[0]=0,M[1]=0),M}function _(M,R,B){return M[0]=R[0]-B[0],M[1]=R[1]-B[1],M}function d(M,R,B){return M[0]=R[0]*B[0],M[1]=R[1]*B[1],M}function v(M,R,B){return M[0]=R[0]/B[0],M[1]=R[1]/B[1],M}function E(M,R){return Math.hypot(R[0]-M[0],R[1]-M[1])}function O(M,R){var B=R[0]-M[0],q=R[1]-M[1];return B*B+q*q}function z(M){return Math.hypot(M[0],M[1])}function S(M){var R=M[0],B=M[1];return R*R+B*B}Nt.len=z,Nt.sub=_,Nt.mul=d,Nt.div=v,Nt.dist=E,Nt.sqrDist=O,Nt.sqrLen=S;var P,L=(P=u(),function(M,R,B,q,H,ne){var re,K;for(R||(R=2),B||(B=0),K=q?Math.min(q*R+B,M.length):M.length,re=B;re<K;re+=R)P[0]=M[re],P[1]=M[re+1],H(P,P,ne),M[re]=P[0],M[re+1]=P[1];return M});return Nt.forEach=L,Nt}function rr(){if(rn)return j;function c(M){return c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(R){return typeof R}:function(R){return R&&typeof Symbol=="function"&&R.constructor===Symbol&&R!==Symbol.prototype?"symbol":typeof R},c(M)}rn=1,Object.defineProperty(j,"__esModule",{value:!0}),j.vec4=j.vec3=j.vec2=j.quat2=j.quat=j.mat4=j.mat3=j.mat2d=j.mat2=j.glMatrix=void 0;var n=L(G());j.glMatrix=n;var s=L(J());j.mat2=s;var u=L(ge());j.mat2d=u;var _=L(ae());j.mat3=_;var d=L(Ge());j.mat4=d;var v=L(Vt());j.quat=v;var E=L(et());j.quat2=E;var O=L(xn());j.vec2=O;var z=L(dt());j.vec3=z;var S=L(gt());function P(M){if(typeof WeakMap!="function")return null;var R=new WeakMap,B=new WeakMap;return(P=function(q){return q?B:R})(M)}function L(M,R){if(M&&M.__esModule)return M;if(M===null||c(M)!=="object"&&typeof M!="function")return{default:M};var B=P(R);if(B&&B.has(M))return B.get(M);var q={},H=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var ne in M)if(ne!=="default"&&Object.prototype.hasOwnProperty.call(M,ne)){var re=H?Object.getOwnPropertyDescriptor(M,ne):null;re&&(re.get||re.set)?Object.defineProperty(q,ne,re):q[ne]=M[ne]}return q.default=M,B&&B.set(M,q),q}return j.vec4=S,j}var Xn,yi,ir,yn,Ne=rr(),Qn=function(){if(yi)return Xn;function c(n,s,u,_){this.cx=3*n,this.bx=3*(u-n)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*s,this.by=3*(_-s)-this.cy,this.ay=1-this.cy-this.by,this.p1x=n,this.p1y=s,this.p2x=u,this.p2y=_}return yi=1,Xn=c,c.prototype={sampleCurveX:function(n){return((this.ax*n+this.bx)*n+this.cx)*n},sampleCurveY:function(n){return((this.ay*n+this.by)*n+this.cy)*n},sampleCurveDerivativeX:function(n){return(3*this.ax*n+2*this.bx)*n+this.cx},solveCurveX:function(n,s){if(s===void 0&&(s=1e-6),n<0)return 0;if(n>1)return 1;for(var u=n,_=0;_<8;_++){var d=this.sampleCurveX(u)-n;if(Math.abs(d)<s)return u;var v=this.sampleCurveDerivativeX(u);if(Math.abs(v)<1e-6)break;u-=d/v}var E=0,O=1;for(u=n,_=0;_<20&&(d=this.sampleCurveX(u),!(Math.abs(d-n)<s));_++)n>d?E=u:O=u,u=.5*(O-E)+E;return u},solve:function(n,s){return this.sampleCurveY(this.solveCurveX(n,s))}},Xn}(),fn=C(Qn);function Dr(){if(yn)return ir;function c(n,s){this.x=n,this.y=s}return yn=1,ir=c,c.prototype={clone:function(){return new c(this.x,this.y)},add:function(n){return this.clone()._add(n)},sub:function(n){return this.clone()._sub(n)},multByPoint:function(n){return this.clone()._multByPoint(n)},divByPoint:function(n){return this.clone()._divByPoint(n)},mult:function(n){return this.clone()._mult(n)},div:function(n){return this.clone()._div(n)},rotate:function(n){return this.clone()._rotate(n)},rotateAround:function(n,s){return this.clone()._rotateAround(n,s)},matMult:function(n){return this.clone()._matMult(n)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(n){return this.x===n.x&&this.y===n.y},dist:function(n){return Math.sqrt(this.distSqr(n))},distSqr:function(n){var s=n.x-this.x,u=n.y-this.y;return s*s+u*u},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(n){return Math.atan2(this.y-n.y,this.x-n.x)},angleWith:function(n){return this.angleWithSep(n.x,n.y)},angleWithSep:function(n,s){return Math.atan2(this.x*s-this.y*n,this.x*n+this.y*s)},_matMult:function(n){var s=n[2]*this.x+n[3]*this.y;return this.x=n[0]*this.x+n[1]*this.y,this.y=s,this},_add:function(n){return this.x+=n.x,this.y+=n.y,this},_sub:function(n){return this.x-=n.x,this.y-=n.y,this},_mult:function(n){return this.x*=n,this.y*=n,this},_div:function(n){return this.x/=n,this.y/=n,this},_multByPoint:function(n){return this.x*=n.x,this.y*=n.y,this},_divByPoint:function(n){return this.x/=n.x,this.y/=n.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var n=this.y;return this.y=this.x,this.x=-n,this},_rotate:function(n){var s=Math.cos(n),u=Math.sin(n),_=u*this.x+s*this.y;return this.x=s*this.x-u*this.y,this.y=_,this},_rotateAround:function(n,s){var u=Math.cos(n),_=Math.sin(n),d=s.y+_*(this.x-s.x)+u*(this.y-s.y);return this.x=s.x+u*(this.x-s.x)-_*(this.y-s.y),this.y=d,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},c.convert=function(n){return n instanceof c?n:Array.isArray(n)?new c(n[0],n[1]):n},ir}var Pt=C(Dr());function Pr(c,n){if(Array.isArray(c)){if(!Array.isArray(n)||c.length!==n.length)return!1;for(let s=0;s<c.length;s++)if(!Pr(c[s],n[s]))return!1;return!0}if(typeof c=="object"&&c!==null&&n!==null){if(typeof n!="object"||Object.keys(c).length!==Object.keys(n).length)return!1;for(const s in c)if(!Pr(c[s],n[s]))return!1;return!0}return c===n}const Cr=Math.PI/180,zi=180/Math.PI;function $n(c){return c*Cr}function si(c){return c*zi}const ha=[[0,0],[1,0],[1,1],[0,1]];function Pa(c){if(c<=0)return 0;if(c>=1)return 1;const n=c*c,s=n*c;return 4*(c<.5?s:3*(c-n)+s-.75)}function co(c,n,s,u){const _=new fn(c,n,s,u);return function(d){return _.solve(d)}}const Rs=co(.25,.1,.25,1);function Bn(c,n,s){return Math.min(s,Math.max(n,c))}function jo(c,n,s){return(s=Bn((s-c)/(n-c),0,1))*s*(3-2*s)}function is(c,n,s){const u=s-n,_=((c-n)%u+u)%u+n;return _===n?s:_}function Tl(c,n,s){if(!c.length)return s(null,[]);let u=c.length;const _=new Array(c.length);let d=null;c.forEach((v,E)=>{n(v,(O,z)=>{O&&(d=O),_[E]=z,--u==0&&s(d,_)})})}function fa(c,...n){for(const s of n)for(const u in s)c[u]=s[u];return c}let El=1;function hc(){return El++}function uh(c){return c<=1?1:Math.pow(2,Math.ceil(Math.log(c)/Math.LN2))}function hh(c,n){c.forEach(s=>{n[s]&&(n[s]=n[s].bind(n))})}function da(c,n){return c.indexOf(n,c.length-n.length)!==-1}function Ia(c,n,s){const u={};for(const _ in c)u[_]=n.call(this,c[_],_,c);return u}function fh(c,n,s){const u={};for(const _ in c)n.call(this,c[_],_,c)&&(u[_]=c[_]);return u}function ra(c){return Array.isArray(c)?c.map(ra):typeof c=="object"&&c?Ia(c,ra):c}const pa={};function qn(c){pa[c]||(typeof console<"u"&&console.warn(c),pa[c]=!0)}function tl(c,n,s){return(s.y-c.y)*(n.x-c.x)>(n.y-c.y)*(s.x-c.x)}function rp(c){let n=0;for(let s,u,_=0,d=c.length,v=d-1;_<d;v=_++)s=c[_],u=c[v],n+=(u.x-s.x)*(s.y+u.y);return n}function Za([c,n,s]){const u=$n(n+90),_=$n(s);return{x:c*Math.cos(u)*Math.sin(_),y:c*Math.sin(u)*Math.sin(_),z:c*Math.cos(_),azimuthal:n,polar:s}}function as(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function os(c){const n={};if(c.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(s,u,_,d)=>{const v=_||d;return n[u]=!v||v.toLowerCase(),""}),n["max-age"]){const s=parseInt(n["max-age"],10);isNaN(s)?delete n["max-age"]:n["max-age"]=s}return n}let Al=null;function nl(c,n){return[c[4*n],c[4*n+1],c[4*n+2],c[4*n+3]]}function ip(c,n,s,u){for(;n<s;){const _=n+s>>1;c[_]<u?n=_+1:s=_}return n}function _u(c,n,s,u){for(;n<s;){const _=n+s>>1;c[_]<=u?n=_+1:s=_}return n}function Of(c){return c>0?1/(1.001-c):1+c}function dh(c){return c>0?1-1/(1.001-c):-c}const vi={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!vi.API_URL)return null;try{const c=new URL(vi.API_URL);return c.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":c.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",RASTERARRAYS_URL_PREFIX:"rasterarrays/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,DEFAULT_STYLE:"mapbox://styles/mapbox/standard",MAX_PARALLEL_IMAGE_REQUESTS:16,DRACO_URL:"https://api.mapbox.com/mapbox-gl-js/draco_decoder_gltf_v1.5.6.wasm",MESHOPT_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_base_v0.20.wasm",MESHOPT_SIMD_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_simd_v0.20.wasm",GLYPHS_URL:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf",TILES3D_URL_PREFIX:"3dtiles/v1"};function Pf(c){return vi.API_URL_REGEX.test(c)}function If(c){return vi.API_SPRITE_REGEX.test(c)}let ph,ma,Ds,ft,le,pe;function Se(){return ph==null&&(ph=self.OffscreenCanvas&&new OffscreenCanvas(1,1).getContext("2d")&&typeof self.createImageBitmap=="function"),ph}const Le={now:()=>ft!==void 0?ft:performance.now(),setNow(c){ft=c},restoreNow(){ft=void 0},frame(c){const n=requestAnimationFrame(c);return{cancel:()=>cancelAnimationFrame(n)}},getImageData(c,n=0){const{width:s,height:u}=c;le||(le=document.createElement("canvas"));const _=le.getContext("2d",{willReadFrequently:!0});if(!_)throw new Error("failed to create canvas 2d context");return(s>le.width||u>le.height)&&(le.width=s,le.height=u),_.clearRect(-n,-n,s+2*n,u+2*n),_.drawImage(c,0,0,s,u),_.getImageData(-n,-n,s+2*n,u+2*n)},resolveURL:c=>(ma||(ma=document.createElement("a")),ma.href=c,ma.href),get devicePixelRatio(){return window.devicePixelRatio},get prefersReducedMotion(){return!!window.matchMedia&&(Ds==null&&(Ds=window.matchMedia("(prefers-reduced-motion: reduce)")),Ds.matches)},hasCanvasFingerprintNoise(){if(pe!==void 0)return pe;if(!Se())return pe=!1,!1;const c=new OffscreenCanvas(85,1),n=c.getContext("2d",{willReadFrequently:!0});let s=0;for(let _=0;_<c.width;++_)n.fillStyle=`rgba(${s++},${s++},${s++}, 255)`,n.fillRect(_,0,1,1);const u=n.getImageData(0,0,c.width,c.height);s=0;for(let _=0;_<u.data.length;++_)if(_%4!=3&&s++!==u.data[_])return pe=!0,!0;return pe=!1,!1}};function je(c,n){const s=c.indexOf("?");if(s<0)return`${c}?${new URLSearchParams(n).toString()}`;const u=new URLSearchParams(c.slice(s));for(const _ in n)u.set(_,n[_]);return`${c.slice(0,s)}?${u.toString()}`}function We(c,n={persistentParams:[]}){const s=c.indexOf("?");if(s<0)return c;const u=new URLSearchParams,_=new URLSearchParams(c.slice(s));for(const v of n.persistentParams){const E=_.get(v);E&&u.set(v,E)}const d=u.toString();return`${c.slice(0,s)}${d.length>0?`?${d}`:""}`}const it="mapbox-tiles";let Ye=500,ct=50;const lt=["language","worldview","jobid"];let ut,Ct;function Zt(){try{return caches}catch{}}function Xt(){const c=Zt();c&&ut==null&&(ut=c.open(it))}let gn=1/0;const Cn={supported:!1,testSupport:function(c){!er&&wn&&(tr?dr(c):On=c)}};let On,wn,er=!1,tr=!1;const Yn=typeof self<"u"?self:{};function dr(c){const n=c.createTexture();c.bindTexture(c.TEXTURE_2D,n);try{if(c.texImage2D(c.TEXTURE_2D,0,c.RGBA,c.RGBA,c.UNSIGNED_BYTE,wn),c.isContextLost())return;Cn.supported=!0}catch{}c.deleteTexture(n),er=!0}Yn.document&&(wn=Yn.document.createElement("img"),wn.onload=function(){On&&dr(On),On=null,tr=!0},wn.onerror=function(){er=!0,On=null},wn.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const vr={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Iconset:"Iconset",Image:"Image",Model:"Model"};typeof Object.freeze=="function"&&Object.freeze(vr);class Pi extends Error{constructor(n,s,u){s===401&&Pf(u)&&(n+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(n),this.status=s,this.url=u}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const Uo=as()?()=>self.worker&&self.worker.referrer:()=>(location.protocol==="blob:"?parent:self).location.href,Ai=function(c,n){if(!(/^file:/.test(s=c.url)||/^file:/.test(Uo())&&!/^\w+:/.test(s))){if(self.fetch&&self.Request&&self.AbortController&&Request.prototype.hasOwnProperty("signal"))return function(u,_){const d=new AbortController,v=new Request(u.url,{method:u.method||"GET",body:u.body,credentials:u.credentials,headers:u.headers,referrer:Uo(),referrerPolicy:u.referrerPolicy,signal:d.signal});let E=!1,O=!1;const z=(S=v.url).indexOf("sku=")>0&&Pf(S);var S;u.type==="json"&&v.headers.set("Accept","application/json");const P=(M,R,B)=>{if(O)return;if(M&&M.message!=="SecurityError"&&qn(M.toString()),R&&B)return L(R);const q=Date.now();fetch(v).then(H=>{if(H.ok){const ne=z?H.clone():null;return L(H,ne,q)}return _(new Pi(H.statusText,H.status,u.url))}).catch(H=>{H.name!=="AbortError"&&_(new Error(`${H.message} ${u.url}`))})},L=(M,R,B)=>{(u.type==="arrayBuffer"?M.arrayBuffer():u.type==="json"?M.json():M.text()).then(q=>{O||(R&&B&&function(H,ne,re){if(Xt(),ut==null)return;const K=os(ne.headers.get("Cache-Control")||"");if(K["no-store"])return;const ie={status:ne.status,statusText:ne.statusText,headers:new Headers};ne.headers.forEach((Ce,Ae)=>ie.headers.set(Ae,Ce)),K["max-age"]&&ie.headers.set("Expires",new Date(re+1e3*K["max-age"]).toUTCString());const ce=ie.headers.get("Expires");if(!ce||new Date(ce).getTime()-re<42e4)return;let _e=We(H.url,{persistentParams:lt});if(ne.status===206){const Ce=H.headers.get("Range");if(!Ce)return;ie.status=200,_e=je(_e,{range:Ce})}(function(Ce,Ae){if(Ct===void 0)try{new Response(new ReadableStream),Ct=!0}catch{Ct=!1}Ct?Ae(Ce.body):Ce.blob().then(Ae)})(ne,Ce=>{const Ae=new Response((Ee=ne.status)!==200&&Ee!==404&&[101,103,204,205,304].includes(Ee)?null:Ce,ie);var Ee;Xt(),ut!=null&&ut.then(Ue=>Ue.put(_e,Ae)).catch(Ue=>qn(Ue.message))})}(v,R,B),E=!0,_(null,q,M.headers.get("Cache-Control"),M.headers.get("Expires")))}).catch(q=>{O||_(new Error(q.message))})};return z?function(M,R){if(Xt(),ut==null)return R(null);ut.then(B=>{let q=We(M.url,{persistentParams:lt});const H=M.headers.get("Range");H&&(q=je(q,{range:H})),B.match(q).then(ne=>{const re=function(K){if(!K)return!1;const ie=new Date(K.headers.get("Expires")||0),ce=os(K.headers.get("Cache-Control")||"");return ie>Date.now()&&!ce["no-cache"]}(ne);B.delete(q),re&&B.put(q,ne.clone()),R(null,ne,re)}).catch(R)}).catch(R)}(v,P):P(null,null),{cancel:()=>{O=!0,E||d.abort()}}}(c,n);if(as()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",c,n,void 0,!0)}var s;return function(u,_){const d=new XMLHttpRequest;d.open(u.method||"GET",u.url,!0),u.type==="arrayBuffer"&&(d.responseType="arraybuffer");for(const v in u.headers)d.setRequestHeader(v,u.headers[v]);return u.type==="json"&&(d.responseType="text",d.setRequestHeader("Accept","application/json")),d.withCredentials=u.credentials==="include",d.onerror=()=>{_(new Error(d.statusText))},d.onload=()=>{if((d.status>=200&&d.status<300||d.status===0)&&d.response!==null){let v=d.response;if(u.type==="json")try{v=JSON.parse(d.response)}catch(E){return _(E)}_(null,v,d.getResponseHeader("Cache-Control"),d.getResponseHeader("Expires"))}else _(new Pi(d.statusText,d.status,u.url))},d.send(u.body),{cancel:()=>d.abort()}}(c,n)},ii=function(c,n){return Ai(fa(c,{type:"arrayBuffer"}),n)};function di(c){const n=document.createElement("a");return n.href=c,n.protocol===location.protocol&&n.host===location.host}const mh="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let Cl,fc;Cl=[],fc=0;const ap=function(c,n){if(Cn.supported&&(c.headers||(c.headers={}),c.headers.accept="image/webp,*/*"),fc>=vi.MAX_PARALLEL_IMAGE_REQUESTS){const d={requestParameters:c,callback:n,cancelled:!1,cancel(){this.cancelled=!0}};return Cl.push(d),d}fc++;let s=!1;const u=()=>{if(!s)for(s=!0,fc--;Cl.length&&fc<vi.MAX_PARALLEL_IMAGE_REQUESTS;){const d=Cl.shift(),{requestParameters:v,callback:E,cancelled:O}=d;O||(d.cancel=ap(v,E).cancel)}},_=ii(c,(d,v,E,O)=>{u(),d?n(d):v&&(self.createImageBitmap?function(z,S){const P=new Blob([new Uint8Array(z)],{type:"image/png"});createImageBitmap(P).then(L=>{S(null,L)}).catch(L=>{S(new Error(`Could not load image because of ${L.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(v,(z,S)=>n(z,S,E,O)):function(z,S){const P=new Image;P.onload=()=>{S(null,P),URL.revokeObjectURL(P.src),P.onload=null,requestAnimationFrame(()=>{P.src=mh})},P.onerror=()=>S(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const L=new Blob([new Uint8Array(z)],{type:"image/png"});P.src=z.byteLength?URL.createObjectURL(L):mh}(v,(z,S)=>n(z,S,E,O)))});return{cancel:()=>{_.cancel(),u()}}};var Rf,Sm,So,Ra={exports:{}},ss={exports:{}},Ls={exports:{}},uo=function(){if(So)return Ra.exports;So=1;var c=(Rf||(Rf=1,ss.exports=function(s,u){var _,d,v,E,O,z,S,P;for(d=s.length-(_=3&s.length),v=u,O=3432918353,z=461845907,P=0;P<d;)S=255&s.charCodeAt(P)|(255&s.charCodeAt(++P))<<8|(255&s.charCodeAt(++P))<<16|(255&s.charCodeAt(++P))<<24,++P,v=27492+(65535&(E=5*(65535&(v=(v^=S=(65535&(S=(S=(65535&S)*O+(((S>>>16)*O&65535)<<16)&4294967295)<<15|S>>>17))*z+(((S>>>16)*z&65535)<<16)&4294967295)<<13|v>>>19))+((5*(v>>>16)&65535)<<16)&4294967295))+((58964+(E>>>16)&65535)<<16);switch(S=0,_){case 3:S^=(255&s.charCodeAt(P+2))<<16;case 2:S^=(255&s.charCodeAt(P+1))<<8;case 1:v^=S=(65535&(S=(S=(65535&(S^=255&s.charCodeAt(P)))*O+(((S>>>16)*O&65535)<<16)&4294967295)<<15|S>>>17))*z+(((S>>>16)*z&65535)<<16)&4294967295}return v^=s.length,v=2246822507*(65535&(v^=v>>>16))+((2246822507*(v>>>16)&65535)<<16)&4294967295,v=3266489909*(65535&(v^=v>>>13))+((3266489909*(v>>>16)&65535)<<16)&4294967295,(v^=v>>>16)>>>0}),ss.exports),n=(Sm||(Sm=1,Ls.exports=function(s,u){for(var _,d=s.length,v=u^d,E=0;d>=4;)_=1540483477*(65535&(_=255&s.charCodeAt(E)|(255&s.charCodeAt(++E))<<8|(255&s.charCodeAt(++E))<<16|(255&s.charCodeAt(++E))<<24))+((1540483477*(_>>>16)&65535)<<16),v=1540483477*(65535&v)+((1540483477*(v>>>16)&65535)<<16)^(_=1540483477*(65535&(_^=_>>>24))+((1540483477*(_>>>16)&65535)<<16)),d-=4,++E;switch(d){case 3:v^=(255&s.charCodeAt(E+2))<<16;case 2:v^=(255&s.charCodeAt(E+1))<<8;case 1:v=1540483477*(65535&(v^=255&s.charCodeAt(E)))+((1540483477*(v>>>16)&65535)<<16)}return v=1540483477*(65535&(v^=v>>>13))+((1540483477*(v>>>16)&65535)<<16),(v^=v>>>15)>>>0}),Ls.exports);return Ra.exports=c,Ra.exports.murmur3=c,Ra.exports.murmur2=n,Ra.exports}(),ls=C(uo);class ks{constructor(n,...s){fa(this,s[0]||{}),this.type=n}}class Ml extends ks{constructor(n,s={}){super("error",fa({error:n},s))}}function Tm(c,n,s){s[c]&&s[c].indexOf(n)!==-1||(s[c]=s[c]||[],s[c].push(n))}function Ol(c,n,s){if(s&&s[c]){const u=s[c].indexOf(n);u!==-1&&s[c].splice(u,1)}}class Pl{on(n,s){return this._listeners=this._listeners||{},Tm(n,s,this._listeners),this}off(n,s){return Ol(n,s,this._listeners),Ol(n,s,this._oneTimeListeners),this}once(n,s){return s?(this._oneTimeListeners=this._oneTimeListeners||{},Tm(n,s,this._oneTimeListeners),this):new Promise(u=>this.once(n,u))}fire(n,s){const u=typeof n=="string"?new ks(n,s):n,_=u.type;if(this.listens(_)){u.target=this;const d=this._listeners&&this._listeners[_]?this._listeners[_].slice():[];for(const O of d)O.call(this,u);const v=this._oneTimeListeners&&this._oneTimeListeners[_]?this._oneTimeListeners[_].slice():[];for(const O of v)Ol(_,O,this._oneTimeListeners),O.call(this,u);const E=this._eventedParent;E&&(fa(u,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),E.fire(u))}else u instanceof Ml&&console.error(u.error);return this}listens(n){return!!(this._listeners&&this._listeners[n]&&this._listeners[n].length>0||this._oneTimeListeners&&this._oneTimeListeners[n]&&this._oneTimeListeners[n].length>0||this._eventedParent&&this._eventedParent.listens(n))}setEventedParent(n,s){return this._eventedParent=n,this._eventedParentData=s,this}}var op,Em={},cs=function(){if(op)return Em;op=1;var c={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function n(d){return(d=Math.round(d))<0?0:d>255?255:d}function s(d){return n(d[d.length-1]==="%"?parseFloat(d)/100*255:parseInt(d))}function u(d){return(v=d[d.length-1]==="%"?parseFloat(d)/100:parseFloat(d))<0?0:v>1?1:v;var v}function _(d,v,E){return E<0?E+=1:E>1&&(E-=1),6*E<1?d+(v-d)*E*6:2*E<1?v:3*E<2?d+(v-d)*(2/3-E)*6:d}try{Em.parseCSSColor=function(d){var v,E=d.replace(/ /g,"").toLowerCase();if(E in c)return c[E].slice();if(E[0]==="#")return E.length===4?(v=parseInt(E.substr(1),16))>=0&&v<=4095?[(3840&v)>>4|(3840&v)>>8,240&v|(240&v)>>4,15&v|(15&v)<<4,1]:null:E.length===7&&(v=parseInt(E.substr(1),16))>=0&&v<=16777215?[(16711680&v)>>16,(65280&v)>>8,255&v,1]:null;var O=E.indexOf("("),z=E.indexOf(")");if(O!==-1&&z+1===E.length){var S=E.substr(0,O),P=E.substr(O+1,z-(O+1)).split(","),L=1;switch(S){case"rgba":if(P.length!==4)return null;L=u(P.pop());case"rgb":return P.length!==3?null:[s(P[0]),s(P[1]),s(P[2]),L];case"hsla":if(P.length!==4)return null;L=u(P.pop());case"hsl":if(P.length!==3)return null;var M=(parseFloat(P[0])%360+360)%360/360,R=u(P[1]),B=u(P[2]),q=B<=.5?B*(R+1):B+R-B*R,H=2*B-q;return[n(255*_(H,q,M+1/3)),n(255*_(H,q,M)),n(255*_(H,q,M-1/3)),L];default:return null}}return null}}catch{}return Em}();class _r{constructor(n,s,u,_=1){this.r=n,this.g=s,this.b=u,this.a=_}static parse(n){if(!n)return;if(n instanceof _r)return n;if(typeof n!="string")return;const s=cs.parseCSSColor(n);return s?new _r(s[0]/255*s[3],s[1]/255*s[3],s[2]/255*s[3],s[3]):void 0}toStringPremultipliedAlpha(){const[n,s,u,_]=this.a===0?[0,0,0,0]:[255*this.r/this.a,255*this.g/this.a,255*this.b/this.a,this.a];return`rgba(${Math.round(n)},${Math.round(s)},${Math.round(u)},${_})`}toString(){const[n,s,u,_]=[this.r,this.g,this.b,this.a];return`rgba(${Math.round(255*n)},${Math.round(255*s)},${Math.round(255*u)},${_})`}toRenderColor(n){const{r:s,g:u,b:_,a:d}=this;return new Df(n,s,u,_,d)}clone(){return new _r(this.r,this.g,this.b,this.a)}}class Df{constructor(n,s,u,_,d){if(n){const v=n.image.height,E=v*v;s=d===0?0:s/d*(v-1),u=d===0?0:u/d*(v-1),_=d===0?0:_/d*(v-1);const O=Math.floor(s),z=Math.floor(u),S=Math.floor(_),P=Math.ceil(s),L=Math.ceil(u),M=Math.ceil(_),R=s-O,B=u-z,q=_-S,H=n.image.data,ne=4*(O+z*E+S*v),re=4*(O+z*E+M*v),K=4*(O+L*E+S*v),ie=4*(O+L*E+M*v),ce=4*(P+z*E+S*v),_e=4*(P+z*E+M*v),Ce=4*(P+L*E+S*v),Ae=4*(P+L*E+M*v);if(ne<0||Ae>=H.length)throw new Error("out of range");this.r=Mn(Mn(Mn(H[ne],H[re],q),Mn(H[K],H[ie],q),B),Mn(Mn(H[ce],H[_e],q),Mn(H[Ce],H[Ae],q),B),R)/255*d,this.g=Mn(Mn(Mn(H[ne+1],H[re+1],q),Mn(H[K+1],H[ie+1],q),B),Mn(Mn(H[ce+1],H[_e+1],q),Mn(H[Ce+1],H[Ae+1],q),B),R)/255*d,this.b=Mn(Mn(Mn(H[ne+2],H[re+2],q),Mn(H[K+2],H[ie+2],q),B),Mn(Mn(H[ce+2],H[_e+2],q),Mn(H[Ce+2],H[Ae+2],q),B),R)/255*d,this.a=d}else this.r=s,this.g=u,this.b=_,this.a=d}toArray(){const{r:n,g:s,b:u,a:_}=this;return _===0?[0,0,0,0]:[255*n/_,255*s/_,255*u/_,_]}toHslaArray(){if(this.a===0)return[0,0,0,0];const{r:n,g:s,b:u,a:_}=this,d=Math.min(Math.max(n/_,0),1),v=Math.min(Math.max(s/_,0),1),E=Math.min(Math.max(u/_,0),1),O=Math.min(d,v,E),z=Math.max(d,v,E),S=(O+z)/2;if(O===z)return[0,0,100*S,_];const P=z-O,L=S>.5?P/(2-z-O):P/(z+O);let M=0;return z===d?M=(v-E)/P+(v<E?6:0):z===v?M=(E-d)/P+2:z===E&&(M=(d-v)/P+4),M*=60,[Math.min(Math.max(M,0),360),Math.min(Math.max(100*L,0),100),Math.min(Math.max(100*S,0),100),_]}toArray01(){const{r:n,g:s,b:u,a:_}=this;return _===0?[0,0,0,0]:[n/_,s/_,u/_,_]}toArray01Scaled(n){const{r:s,g:u,b:_,a:d}=this;return d===0?[0,0,0]:[s/d*n,u/d*n,_/d*n]}toArray01PremultipliedAlpha(){const{r:n,g:s,b:u,a:_}=this;return[n,s,u,_]}toArray01Linear(){const{r:n,g:s,b:u,a:_}=this;return _===0?[0,0,0,0]:[Math.pow(n/_,2.2),Math.pow(s/_,2.2),Math.pow(u/_,2.2),_]}}function Mn(c,n,s){return c*(1-s)+n*s}function gu(c,n,s){return c.map((u,_)=>Mn(u,n[_],s))}_r.black=new _r(0,0,0,1),_r.white=new _r(1,1,1,1),_r.transparent=new _r(0,0,0,0),_r.red=new _r(1,0,0,1),_r.blue=new _r(0,0,1,1);var Il=Object.freeze({__proto__:null,array:gu,color:function(c,n,s){return new _r(Mn(c.r,n.r,s),Mn(c.g,n.g,s),Mn(c.b,n.b,s),Mn(c.a,n.a,s))},number:Mn});function Lf(c,...n){for(const s of n)for(const u in s)c[u]=s[u];return c}class Kn extends Error{constructor(n,s){super(s),this.message=s,this.key=n}}class kf{constructor(n,s=[]){this.parent=n,this.bindings={};for(const[u,_]of s)this.bindings[u]=_}concat(n){return new kf(this,n)}get(n){if(this.bindings[n])return this.bindings[n];if(this.parent)return this.parent.get(n);throw new Error(`${n} not found in scope.`)}has(n){return!!this.bindings[n]||!!this.parent&&this.parent.has(n)}}const zs={kind:"null"},_n={kind:"number"},xr={kind:"string"},ar={kind:"boolean"},_a={kind:"color"},us={kind:"object"},gr={kind:"value"},dc={kind:"collator"},Vo={kind:"formatted"},_h={kind:"resolvedImage"};function Wr(c,n){return{kind:"array",itemType:c,N:n}}function Xr(c){if(c.kind==="array"){const n=Xr(c.itemType);return typeof c.N=="number"?`array<${n}, ${c.N}>`:c.itemType.kind==="value"?"array":`array<${n}>`}return c.kind}const gh=[zs,_n,xr,ar,_a,Vo,us,Wr(gr),_h];function ga(c,n){if(n.kind==="error")return null;if(c.kind==="array"){if(n.kind==="array"&&(n.N===0&&n.itemType.kind==="value"||!ga(c.itemType,n.itemType))&&(typeof c.N!="number"||c.N===n.N))return null}else{if(c.kind===n.kind)return null;if(c.kind==="value"){for(const s of gh)if(!ga(s,n))return null}}return`Expected ${Xr(c)} but found ${Xr(n)} instead.`}function sp(c,n){return n.some(s=>s.kind===c.kind)}function yu(c,n){return n.some(s=>s==="null"?c===null:s==="array"?Array.isArray(c):s==="object"?c&&!Array.isArray(c)&&typeof c=="object":s===typeof c)}class yh{constructor(n,s,u){this.sensitivity=n?s?"variant":"case":s?"accent":"base",this.locale=u,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(n,s){return this.collator.compare(n,s)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Rl{constructor(n,s,u,_,d){this.text=n.normalize?n.normalize():n,this.image=s,this.scale=u,this.fontStack=_,this.textColor=d}}class ia{constructor(n){this.sections=n}static fromString(n){return new ia([new Rl(n,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(n=>n.text.length!==0||n.image&&n.image.namePrimary)}static factory(n){return n instanceof ia?n:ia.fromString(n)}toString(){return this.sections.length===0?"":this.sections.map(n=>n.text).join("")}serialize(){const n=["format"];for(const s of this.sections){if(s.image){n.push(["image",s.image.namePrimary]);continue}n.push(s.text);const u={};s.fontStack&&(u["text-font"]=["literal",s.fontStack.split(",")]),s.scale&&(u["font-scale"]=s.scale),s.textColor&&(u["text-color"]=["rgba"].concat(s.textColor.toRenderColor(null).toArray())),n.push(u)}return n}}class Bs{constructor(n,s){if(this.id=n,this.options=s||{params:{}},this.options.transform){const{a:u,b:_,c:d,d:v,e:E,f:O}=this.options.transform;this.options.transform=new DOMMatrix([u,_,d,v,E,O])}else this.options.transform=new DOMMatrix([1,0,0,1,0,0])}static deserializeId(n){return JSON.parse(n).id}static deserializeFromString(n){const s=JSON.parse(n),{a:u,b:_,c:d,d:v,e:E,f:O}=s.options.transform;return new DOMMatrix([u,_,d,v,E,O]),new Bs(s.id,s.options)}scaleSelf(n){return this.options.transform=this.options.transform.scale(n),this}serialize(){const n={id:this.id};this.options&&(n.options=this.options);const{a:s,b:u,c:_,d,e:v,f:E}=this.options.transform;return n.options.transform={a:s,b:u,c:_,d,e:v,f:E},JSON.stringify(n)}}class Da{constructor(n){this.namePrimary=n.namePrimary,n.nameSecondary&&(this.nameSecondary=n.nameSecondary),n.optionsPrimary&&(this.optionsPrimary=n.optionsPrimary),n.optionsSecondary&&(this.optionsSecondary=n.optionsSecondary),this.available=n.available}toString(){return this.namePrimary&&this.nameSecondary?`[${this.namePrimary},${this.nameSecondary}]`:this.namePrimary}getPrimary(){return new Bs(this.namePrimary,{params:this.optionsPrimary&&this.optionsPrimary.params||{}})}getSerializedPrimary(){return this.getPrimary().serialize()}getSecondary(){return this.nameSecondary?new Bs(this.nameSecondary,{params:this.optionsSecondary&&this.optionsSecondary.params||{}}):null}static from(n){return typeof n=="string"?Da.build(n):n}static build(n,s,u,_){return n?new Da({namePrimary:n,nameSecondary:s,optionsPrimary:u,optionsSecondary:_,available:!1}):null}}function Am(c,n,s,u){return typeof c=="number"&&c>=0&&c<=255&&typeof n=="number"&&n>=0&&n<=255&&typeof s=="number"&&s>=0&&s<=255?u===void 0||typeof u=="number"&&u>=0&&u<=1?null:`Invalid rgba value [${[c,n,s,u].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof u=="number"?[c,n,s,u]:[c,n,s]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Dl(c){if(c===null||typeof c=="string"||typeof c=="boolean"||typeof c=="number"||c instanceof _r||c instanceof yh||c instanceof ia||c instanceof Da)return!0;if(Array.isArray(c)){for(const n of c)if(!Dl(n))return!1;return!0}if(typeof c=="object"){for(const n in c)if(!Dl(c[n]))return!1;return!0}return!1}function ai(c){if(c===null)return zs;if(typeof c=="string")return xr;if(typeof c=="boolean")return ar;if(typeof c=="number")return _n;if(c instanceof _r)return _a;if(c instanceof yh)return dc;if(c instanceof ia)return Vo;if(c instanceof Da)return _h;if(Array.isArray(c)){const n=c.length;let s;for(const u of c){const _=ai(u);if(s){if(s===_)continue;s=gr;break}s=_}return Wr(s||gr,n)}return us}function hs(c){const n=typeof c;return c===null?"":n==="string"||n==="number"||n==="boolean"?String(c):c instanceof _r?c.toStringPremultipliedAlpha():c instanceof ia||c instanceof Da?c.toString():JSON.stringify(c)}class ya{constructor(n,s){this.type=n,this.value=s}static parse(n,s){if(n.length!==2)return s.error(`'literal' expression requires exactly one argument, but found ${n.length-1} instead.`);if(!Dl(n[1]))return s.error("invalid value");const u=n[1];let _=ai(u);const d=s.expectedType;return _.kind!=="array"||_.N!==0||!d||d.kind!=="array"||typeof d.N=="number"&&d.N!==0||(_=d),new ya(_,u)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof _r?["rgba"].concat(this.value.toRenderColor(null).toArray()):this.value instanceof ia?this.value.serialize():this.value}}class Ii{constructor(n){this.name="ExpressionEvaluationError",this.message=n}toJSON(){return this.message}}const zf={string:xr,number:_n,boolean:ar,object:us};class Ns{constructor(n,s){this.type=n,this.args=s}static parse(n,s){if(n.length<2)return s.error("Expected at least one argument.");let u,_=1;const d=n[0];if(d==="array"){let E,O;if(n.length>2){const z=n[1];if(typeof z!="string"||!(z in zf)||z==="object")return s.error('The item type argument of "array" must be one of string, number, boolean',1);E=zf[z],_++}else E=gr;if(n.length>3){if(n[2]!==null&&(typeof n[2]!="number"||n[2]<0||n[2]!==Math.floor(n[2])))return s.error('The length argument to "array" must be a positive integer literal',2);O=n[2],_++}u=Wr(E,O)}else u=zf[d];const v=[];for(;_<n.length;_++){const E=s.parse(n[_],_,gr);if(!E)return null;v.push(E)}return new Ns(u,v)}evaluate(n){for(let s=0;s<this.args.length;s++){const u=this.args[s].evaluate(n);if(!ga(this.type,ai(u)))return u;if(s===this.args.length-1)throw new Ii(`The expression ${JSON.stringify(this.args[s].serialize())} evaluated to ${Xr(ai(u))} but was expected to be of type ${Xr(this.type)}.`)}return null}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every(n=>n.outputDefined())}serialize(){const n=this.type,s=[n.kind];if(n.kind==="array"){const u=n.itemType;if(u.kind==="string"||u.kind==="number"||u.kind==="boolean"){s.push(u.kind);const _=n.N;(typeof _=="number"||this.args.length>1)&&s.push(_)}}return s.concat(this.args.map(u=>u.serialize()))}}class pc{constructor(n){this.type=Vo,this.sections=n}static parse(n,s){if(n.length<2)return s.error("Expected at least one argument.");const u=n[1];if(!Array.isArray(u)&&typeof u=="object")return s.error("First argument must be an image or text section.");const _=[];let d=!1;for(let v=1;v<=n.length-1;++v){const E=n[v];if(d&&typeof E=="object"&&!Array.isArray(E)){d=!1;let O=null;if(E["font-scale"]&&(O=s.parseObjectValue(E["font-scale"],v,"font-scale",_n),!O))return null;let z=null;if(E["text-font"]&&(z=s.parseObjectValue(E["text-font"],v,"text-font",Wr(xr)),!z))return null;let S=null;if(E["text-color"]&&(S=s.parseObjectValue(E["text-color"],v,"text-color",_a),!S))return null;const P=_[_.length-1];P.scale=O,P.font=z,P.textColor=S}else{const O=s.parse(n[v],v,gr);if(!O)return null;const z=O.type.kind;if(z!=="string"&&z!=="value"&&z!=="null"&&z!=="resolvedImage")return s.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");d=!0,_.push({content:O,scale:null,font:null,textColor:null})}}return new pc(_)}evaluate(n){return new ia(this.sections.map(s=>{const u=s.content.evaluate(n);return ai(u)===_h?new Rl("",u,null,null,null):new Rl(hs(u),null,s.scale?s.scale.evaluate(n):null,s.font?s.font.evaluate(n).join(","):null,s.textColor?s.textColor.evaluate(n):null)}))}eachChild(n){for(const s of this.sections)n(s.content),s.scale&&n(s.scale),s.font&&n(s.font),s.textColor&&n(s.textColor)}outputDefined(){return!1}serialize(){const n=["format"];for(const s of this.sections){n.push(s.content.serialize());const u={};s.scale&&(u["font-scale"]=s.scale.serialize()),s.font&&(u["text-font"]=s.font.serialize()),s.textColor&&(u["text-color"]=s.textColor.serialize()),n.push(u)}return n}}class Bf{constructor(n,s,u,_){this._imageWarnHistory={},this.type=_h,this.inputPrimary=n,this.inputSecondary=s,this.inputPrimaryParams=u,this.inputSecondaryParams=_}static parse(n,s){if(n.length<2)return s.error("Expected two or more arguments.");let u=1;const _=[];function d(){if(u<n.length){const E=s.parse(n[u],u++,xr);return E?(_.push({image:E,options:void 0}),!0):(s.error(_.length?"Secondary image variant is not a string.":"No image name provided."),!1)}return!0}function v(){if(u<n.length){if((E=n[u])===null||typeof E!="object"||Array.isArray(E))return!0;const O=n[u].params,z=s.concat(u);if(!O)return u++,!0;if(typeof O!="object"||O.constructor!==Object)return z.error('Image options "params" should be an object'),!1;const S={},P=z.concat(void 0,"params");for(const L in O){if(!L)return P.error("Image parameter name should be non-empty"),!1;const M=P.concat(void 0,L).parse(O[L],void 0,_a,void 0,{typeAnnotation:"coerce"});if(!M)return!1;S[L]=M}return _[_.length-1].options=S,u++,!0}var E;return!0}for(let E=0;E<2;E++)if(!d()||!v())return;return new Bf(_[0].image,_[1]?_[1].image:void 0,_[0].options,_[1]?_[1].options:void 0)}evaluateParams(n,s){const u={};if(s){for(const _ in s)if(s[_])try{const d=s[_].evaluate(n),v=`Ignoring image parameter "${_}" with semi-transparent color ${d.toString()}`;if(d.a!==1){this._imageWarnHistory[v]||(console.warn(v),this._imageWarnHistory[v]=!0);continue}u[_]=d}catch{continue}if(Object.keys(u).length!==0)return{params:u}}}evaluate(n){const s=Da.build(this.inputPrimary.evaluate(n),this.inputSecondary?this.inputSecondary.evaluate(n):void 0,this.inputPrimaryParams?this.evaluateParams(n,this.inputPrimaryParams):void 0,this.inputSecondaryParams?this.evaluateParams(n,this.inputSecondaryParams):void 0);return s&&n.availableImages&&(s.available=n.availableImages.indexOf(s.namePrimary)>-1,s.nameSecondary&&s.available&&n.availableImages&&(s.available=n.availableImages.indexOf(s.nameSecondary)>-1)),s}eachChild(n){if(n(this.inputPrimary),this.inputPrimaryParams)for(const s in this.inputPrimaryParams)this.inputPrimaryParams[s]&&n(this.inputPrimaryParams[s]);if(this.inputSecondary&&(n(this.inputSecondary),this.inputSecondaryParams))for(const s in this.inputSecondaryParams)this.inputSecondaryParams[s]&&n(this.inputSecondaryParams[s])}outputDefined(){return!1}serializeParams(n){const s={};if(n){for(const u in n)n[u]&&(s[u]=n[u].serialize());return{params:s}}}serialize(){const n=["image",this.inputPrimary.serialize()];return this.inputPrimaryParams&&n.push(this.serializeParams(this.inputPrimaryParams)),this.inputSecondary&&(n.push(this.inputSecondary.serialize()),this.inputSecondaryParams&&n.push(this.serializeParams(this.inputSecondaryParams))),n}}function Fs(c){return c instanceof Number?"number":c instanceof String?"string":c instanceof Boolean?"boolean":Array.isArray(c)?"array":c===null?"null":typeof c}const Cm={"to-boolean":ar,"to-color":_a,"to-number":_n,"to-string":xr};class Ll{constructor(n,s){this.type=n,this.args=s}static parse(n,s){if(n.length<2)return s.error("Expected at least one argument.");const u=n[0],_=[];let d=zs;if(u==="to-array"){if(!Array.isArray(n[1]))return null;const v=n[1].length;if(s.expectedType){if(s.expectedType.kind!=="array")return s.error(`Expected ${s.expectedType.kind} but found array.`);d=Wr(s.expectedType.itemType,v)}else{if(!(v>0&&Dl(n[1][0])))return null;d=Wr(ai(n[1][0]),v)}for(let E=0;E<v;E++){const O=n[1][E];let z;if(Fs(O)==="array")z=s.parse(O,void 0,d.itemType);else{const S=Fs(O);if(S!==d.itemType.kind)return s.error(`Expected ${d.itemType.kind} but found ${S}.`);z=s.registry.literal.parse(["literal",O===void 0?null:O],s)}if(!z)return null;_.push(z)}}else{if((u==="to-boolean"||u==="to-string")&&n.length!==2)return s.error("Expected one argument.");d=Cm[u];for(let v=1;v<n.length;v++){const E=s.parse(n[v],v,gr);if(!E)return null;_.push(E)}}return new Ll(d,_)}evaluate(n){if(this.type.kind==="boolean")return!!this.args[0].evaluate(n);if(this.type.kind==="color"){let s,u;for(const _ of this.args){if(s=_.evaluate(n),u=null,s instanceof _r)return s;if(typeof s=="string"){const d=n.parseColor(s);if(d)return d}else if(Array.isArray(s)&&(u=s.length<3||s.length>4?`Invalid rbga value ${JSON.stringify(s)}: expected an array containing either three or four numeric values.`:Am(s[0],s[1],s[2],s[3]),!u))return new _r(s[0]/255,s[1]/255,s[2]/255,s[3])}throw new Ii(u||`Could not parse color from value '${typeof s=="string"?s:String(JSON.stringify(s))}'`)}if(this.type.kind==="number"){let s=null;for(const u of this.args){if(s=u.evaluate(n),s===null)return 0;const _=Number(s);if(!isNaN(_))return _}throw new Ii(`Could not convert ${JSON.stringify(s)} to number.`)}return this.type.kind==="formatted"?ia.fromString(hs(this.args[0].evaluate(n))):this.type.kind==="resolvedImage"?Da.build(hs(this.args[0].evaluate(n))):this.type.kind==="array"?this.args.map(s=>s.evaluate(n)):hs(this.args[0].evaluate(n))}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every(n=>n.outputDefined())}serialize(){if(this.type.kind==="formatted")return new pc([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new Bf(this.args[0]).serialize();const n=this.type.kind==="array"?[]:[`to-${this.type.kind}`];return this.eachChild(s=>{n.push(s.serialize())}),n}}const Mm=["Unknown","Point","LineString","Polygon"];class Om{constructor(n,s){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null,this.scope=n,this.options=s}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Mm[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}measureLight(n){return this.globals.brightness||0}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const n=this.featureDistanceData.center,s=this.featureDistanceData.scale,{x:u,y:_}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(u*s-n[0])+this.featureDistanceData.bearing[1]*(_*s-n[1])}return 0}parseColor(n){let s=this._parseColorCache[n];return s||(s=this._parseColorCache[n]=_r.parse(n)),s}getConfig(n){return this.options?this.options.get(n):null}}class ho{constructor(n,s,u,_,d){this.name=n,this.type=s,this._evaluate=u,this.args=_,this._overloadIndex=d}evaluate(n){if(!this._evaluate){const s=ho.definitions[this.name];this._evaluate=Array.isArray(s)?s[2]:s.overloads[this._overloadIndex][1]}return this._evaluate(n,this.args)}eachChild(n){this.args.forEach(n)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(n=>n.serialize()))}static parse(n,s){const u=n[0],_=ho.definitions[u];if(!_)return s.error(`Unknown expression "${u}". If you wanted a literal array, use ["literal", [...]].`,0);const d=Array.isArray(_)?_[0]:_.type,v=Array.isArray(_)?[[_[1],_[2]]]:_.overloads,E=[];let O=null,z=-1;for(const[S,P]of v){if(Array.isArray(S)&&S.length!==n.length-1)continue;E.push(S),z++,O=new Tc(s.registry,s.path,null,s.scope,void 0,s._scope,s.options);const L=[];let M=!1;for(let R=1;R<n.length;R++){const B=n[R],q=Array.isArray(S)?S[R-1]:S.type,H=O.parse(B,1+L.length,q);if(!H){M=!0;break}L.push(H)}if(!M)if(Array.isArray(S)&&S.length!==L.length)O.error(`Expected ${S.length} arguments, but found ${L.length} instead.`);else{for(let R=0;R<L.length;R++){const B=Array.isArray(S)?S[R]:S.type,q=L[R];O.concat(R+1).checkSubtype(B,q.type)}if(O.errors.length===0)return new ho(u,d,P,L,z)}}if(E.length===1)s.errors.push(...O.errors);else{const S=(E.length?E:v.map(([L])=>L)).map(Pm).join(" | "),P=[];for(let L=1;L<n.length;L++){const M=s.parse(n[L],1+P.length);if(!M)return null;P.push(Xr(M.type))}s.error(`Expected arguments of type ${S}, but found (${P.join(", ")}) instead.`)}return null}static register(n,s){ho.definitions=s;for(const u in s)n[u]=ho}}function Pm(c){return Array.isArray(c)?`(${c.map(Xr).join(", ")})`:`(${Xr(c.type)}...)`}class Nf{constructor(n,s,u){this.type=dc,this.locale=u,this.caseSensitive=n,this.diacriticSensitive=s}static parse(n,s){if(n.length!==2)return s.error("Expected one argument.");const u=n[1];if(typeof u!="object"||Array.isArray(u))return s.error("Collator options argument must be an object.");const _=u["case-sensitive"]===void 0?s.parse(!1,1,ar):s.parseObjectValue(u["case-sensitive"],1,"case-sensitive",ar);if(!_)return null;const d=u["diacritic-sensitive"]===void 0?s.parse(!1,1,ar):s.parseObjectValue(u["diacritic-sensitive"],1,"diacritic-sensitive",ar);if(!d)return null;let v=null;return u.locale&&(v=s.parseObjectValue(u.locale,1,"locale",xr),!v)?null:new Nf(_,d,v)}evaluate(n){return new yh(this.caseSensitive.evaluate(n),this.diacriticSensitive.evaluate(n),this.locale?this.locale.evaluate(n):null)}eachChild(n){n(this.caseSensitive),n(this.diacriticSensitive),this.locale&&n(this.locale)}outputDefined(){return!1}serialize(){const n={};return n["case-sensitive"]=this.caseSensitive.serialize(),n["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(n.locale=this.locale.serialize()),["collator",n]}}function Ff(c,n,s=0,u=c.length-1,_=Ay){for(;u>s;){if(u-s>600){const O=u-s+1,z=n-s+1,S=Math.log(O),P=.5*Math.exp(2*S/3),L=.5*Math.sqrt(S*P*(O-P)/O)*(z-O/2<0?-1:1);Ff(c,n,Math.max(s,Math.floor(n-z*P/O+L)),Math.min(u,Math.floor(n+(O-z)*P/O+L)),_)}const d=c[n];let v=s,E=u;for(jf(c,s,n),_(c[u],d)>0&&jf(c,s,u);v<E;){for(jf(c,v,E),v++,E--;_(c[v],d)<0;)v++;for(;_(c[E],d)>0;)E--}_(c[s],d)===0?jf(c,s,E):(E++,jf(c,E,u)),E<=n&&(s=E+1),n<=E&&(u=E-1)}}function jf(c,n,s){const u=c[n];c[n]=c[s],c[s]=u}function Ay(c,n){return c<n?-1:c>n?1:0}function Cy(c){let n=0;for(let s,u,_=0,d=c.length,v=d-1;_<d;v=_++)s=c[_],u=c[v],n+=(u.x-s.x)*(s.y+u.y);return n}function Uf(c,n){c[0]=Math.min(c[0],n[0]),c[1]=Math.min(c[1],n[1]),c[2]=Math.max(c[2],n[0]),c[3]=Math.max(c[3],n[1])}function Vf(c,n){return!(c[0]<=n[0]||c[2]>=n[2]||c[1]<=n[1]||c[3]>=n[3])}function My(c,n,s){const u=c[0]-n[0],_=c[1]-n[1],d=c[0]-s[0],v=c[1]-s[1];return u*v-d*_==0&&u*d<=0&&_*v<=0}function vh(c,n,s=!1){let u=!1;for(let E=0,O=n.length;E<O;E++){const z=n[E];for(let S=0,P=z.length,L=P-1;S<P;L=S++){const M=z[L],R=z[S];if(My(c,M,R))return s;(d=M)[1]>(_=c)[1]!=(v=R)[1]>_[1]&&_[0]<(v[0]-d[0])*(_[1]-d[1])/(v[1]-d[1])+d[0]&&(u=!u)}}var _,d,v;return u}function Im(c,n,s,u){const _=u[0]-s[0],d=u[1]-s[1],v=(c[0]-s[0])*d-_*(c[1]-s[1]),E=(n[0]-s[0])*d-_*(n[1]-s[1]);return v>0&&E<0||v<0&&E>0}function js(c,n,s,u){return(_=[u[0]-s[0],u[1]-s[1]])[0]*(d=[n[0]-c[0],n[1]-c[1]])[1]-_[1]*d[0]!=0&&!(!Im(c,n,s,u)||!Im(s,u,c,n));var _,d}const fs=8192;function Oy(c,n){const s=(180+c[0])/360,u=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+c[1]*Math.PI/360)))/360,_=Math.pow(2,n.z);return[Math.round(s*_*fs),Math.round(u*_*fs)]}function lp(c,n){for(let s=0;s<n.length;s++)if(vh(c,n[s]))return!0;return!1}function r_(c,n,s){for(const u of s)for(let _=0,d=u.length,v=d-1;_<d;v=_++)if(js(c,n,u[v],u[_]))return!0;return!1}function Rm(c,n){for(let s=0;s<c.length;++s)if(!vh(c[s],n))return!1;for(let s=0;s<c.length-1;++s)if(r_(c[s],c[s+1],n))return!1;return!0}function i_(c,n){for(let s=0;s<n.length;s++)if(Rm(c,n[s]))return!0;return!1}function cp(c,n,s){const u=[];for(let _=0;_<c.length;_++){const d=[];for(let v=0;v<c[_].length;v++){const E=Oy(c[_][v],s);Uf(n,E),d.push(E)}u.push(d)}return u}function ds(c,n,s){const u=[];for(let _=0;_<c.length;_++){const d=cp(c[_],n,s);u.push(d)}return u}function Jn(c,n,s,u){if(c[0]<s[0]||c[0]>s[2]){const _=.5*u;let d=c[0]-s[0]>_?-u:s[0]-c[0]>_?u:0;d===0&&(d=c[0]-s[2]>_?-u:s[2]-c[0]>_?u:0),c[0]+=d}Uf(n,c)}function Tn(c,n,s,u){const _=Math.pow(2,u.z)*fs,d=[u.x*fs,u.y*fs],v=[];if(!c)return v;for(const E of c)for(const O of E){const z=[O.x+d[0],O.y+d[1]];Jn(z,n,s,_),v.push(z)}return v}function up(c,n,s,u){const _=Math.pow(2,u.z)*fs,d=[u.x*fs,u.y*fs],v=[];if(!c)return v;for(const O of c){const z=[];for(const S of O){const P=[S.x+d[0],S.y+d[1]];Uf(n,P),z.push(P)}v.push(z)}if(n[2]-n[0]<=_/2){(E=n)[0]=E[1]=1/0,E[2]=E[3]=-1/0;for(const O of v)for(const z of O)Jn(z,n,s,_)}var E;return v}class Dn{constructor(n,s){this.type=ar,this.geojson=n,this.geometries=s}static parse(n,s){if(n.length!==2)return s.error(`'within' expression requires exactly one argument, but found ${n.length-1} instead.`);if(Dl(n[1])){const u=n[1];if(u.type==="FeatureCollection")for(let _=0;_<u.features.length;++_){const d=u.features[_].geometry.type;if(d==="Polygon"||d==="MultiPolygon")return new Dn(u,u.features[_].geometry)}else if(u.type==="Feature"){const _=u.geometry.type;if(_==="Polygon"||_==="MultiPolygon")return new Dn(u,u.geometry)}else if(u.type==="Polygon"||u.type==="MultiPolygon")return new Dn(u,u)}return s.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(n){if(n.geometry()!=null&&n.canonicalID()!=null){if(n.geometryType()==="Point")return function(s,u){const _=[1/0,1/0,-1/0,-1/0],d=[1/0,1/0,-1/0,-1/0],v=s.canonicalID();if(!v)return!1;if(u.type==="Polygon"){const E=cp(u.coordinates,d,v),O=Tn(s.geometry(),_,d,v);if(!Vf(_,d))return!1;for(const z of O)if(!vh(z,E))return!1}if(u.type==="MultiPolygon"){const E=ds(u.coordinates,d,v),O=Tn(s.geometry(),_,d,v);if(!Vf(_,d))return!1;for(const z of O)if(!lp(z,E))return!1}return!0}(n,this.geometries);if(n.geometryType()==="LineString")return function(s,u){const _=[1/0,1/0,-1/0,-1/0],d=[1/0,1/0,-1/0,-1/0],v=s.canonicalID();if(!v)return!1;if(u.type==="Polygon"){const E=cp(u.coordinates,d,v),O=up(s.geometry(),_,d,v);if(!Vf(_,d))return!1;for(const z of O)if(!Rm(z,E))return!1}if(u.type==="MultiPolygon"){const E=ds(u.coordinates,d,v),O=up(s.geometry(),_,d,v);if(!Vf(_,d))return!1;for(const z of O)if(!i_(z,E))return!1}return!0}(n,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}const vu={kilometers:1,miles:1e3/1609.344,nauticalmiles:1e3/1852,meters:1e3,metres:1e3,yards:1e3/.9144,feet:1e3/.3048,inches:1e3/.0254},mc=1/298.257223563,Rn=mc*(2-mc),xh=Math.PI/180;class rl{static fromTile(n,s,u){const _=Math.PI*(1-2*(n+.5)/Math.pow(2,s)),d=Math.atan(.5*(Math.exp(_)-Math.exp(-_)))/xh;return new rl(d,u)}static get units(){return vu}constructor(n,s){if(n===void 0)throw new Error("No latitude given.");if(s&&!vu[s])throw new Error(`Unknown unit ${s}. Use one of: ${Object.keys(vu).join(", ")}`);const u=6378.137*xh*(s?vu[s]:1),_=Math.cos(n*xh),d=1/(1-Rn*(1-_*_)),v=Math.sqrt(d);this.kx=u*v*_,this.ky=u*v*d*(1-Rn)}distance(n,s){const u=Wa(n[0]-s[0])*this.kx,_=(n[1]-s[1])*this.ky;return Math.sqrt(u*u+_*_)}bearing(n,s){const u=Wa(s[0]-n[0])*this.kx;return Math.atan2(u,(s[1]-n[1])*this.ky)/xh}destination(n,s,u){const _=u*xh;return this.offset(n,Math.sin(_)*s,Math.cos(_)*s)}offset(n,s,u){return[n[0]+s/this.kx,n[1]+u/this.ky]}lineDistance(n){let s=0;for(let u=0;u<n.length-1;u++)s+=this.distance(n[u],n[u+1]);return s}area(n){let s=0;for(let u=0;u<n.length;u++){const _=n[u];for(let d=0,v=_.length,E=v-1;d<v;E=d++)s+=Wa(_[d][0]-_[E][0])*(_[d][1]+_[E][1])*(u?-1:1)}return Math.abs(s)/2*this.kx*this.ky}along(n,s){let u=0;if(s<=0)return n[0];for(let _=0;_<n.length-1;_++){const d=n[_],v=n[_+1],E=this.distance(d,v);if(u+=E,u>s)return $f(d,v,(s-(u-E))/E)}return n[n.length-1]}pointToSegmentDistance(n,s,u){let[_,d]=s,v=Wa(u[0]-_)*this.kx,E=(u[1]-d)*this.ky;if(v!==0||E!==0){const O=(Wa(n[0]-_)*this.kx*v+(n[1]-d)*this.ky*E)/(v*v+E*E);O>1?(_=u[0],d=u[1]):O>0&&(_+=v/this.kx*O,d+=E/this.ky*O)}return v=Wa(n[0]-_)*this.kx,E=(n[1]-d)*this.ky,Math.sqrt(v*v+E*E)}pointOnLine(n,s){let u=1/0,_=n[0][0],d=n[0][1],v=0,E=0;for(let O=0;O<n.length-1;O++){let z=n[O][0],S=n[O][1],P=Wa(n[O+1][0]-z)*this.kx,L=(n[O+1][1]-S)*this.ky,M=0;P===0&&L===0||(M=(Wa(s[0]-z)*this.kx*P+(s[1]-S)*this.ky*L)/(P*P+L*L),M>1?(z=n[O+1][0],S=n[O+1][1]):M>0&&(z+=P/this.kx*M,S+=L/this.ky*M)),P=Wa(s[0]-z)*this.kx,L=(s[1]-S)*this.ky;const R=P*P+L*L;R<u&&(u=R,_=z,d=S,v=O,E=M)}return{point:[_,d],index:v,t:Math.max(0,Math.min(1,E))}}lineSlice(n,s,u){let _=this.pointOnLine(u,n),d=this.pointOnLine(u,s);if(_.index>d.index||_.index===d.index&&_.t>d.t){const z=_;_=d,d=z}const v=[_.point],E=_.index+1,O=d.index;!hp(u[E],v[0])&&E<=O&&v.push(u[E]);for(let z=E+1;z<=O;z++)v.push(u[z]);return hp(u[O],d.point)||v.push(d.point),v}lineSliceAlong(n,s,u){let _=0;const d=[];for(let v=0;v<u.length-1;v++){const E=u[v],O=u[v+1],z=this.distance(E,O);if(_+=z,_>n&&d.length===0&&d.push($f(E,O,(n-(_-z))/z)),_>=s)return d.push($f(E,O,(s-(_-z))/z)),d;_>n&&d.push(O)}return d}bufferPoint(n,s){const u=s/this.ky,_=s/this.kx;return[n[0]-_,n[1]-u,n[0]+_,n[1]+u]}bufferBBox(n,s){const u=s/this.ky,_=s/this.kx;return[n[0]-_,n[1]-u,n[2]+_,n[3]+u]}insideBBox(n,s){return Wa(n[0]-s[0])>=0&&Wa(n[0]-s[2])<=0&&n[1]>=s[1]&&n[1]<=s[3]}}function hp(c,n){return c[0]===n[0]&&c[1]===n[1]}function $f(c,n,s){const u=Wa(n[0]-c[0]);return[c[0]+u*s,c[1]+(n[1]-c[1])*s]}function Wa(c){for(;c<-180;)c+=360;for(;c>180;)c-=360;return c}class aa{constructor(n=[],s=(u,_)=>u<_?-1:u>_?1:0){if(this.data=n,this.length=this.data.length,this.compare=s,this.length>0)for(let u=(this.length>>1)-1;u>=0;u--)this._down(u)}push(n){this.data.push(n),this._up(this.length++)}pop(){if(this.length===0)return;const n=this.data[0],s=this.data.pop();return--this.length>0&&(this.data[0]=s,this._down(0)),n}peek(){return this.data[0]}_up(n){const{data:s,compare:u}=this,_=s[n];for(;n>0;){const d=n-1>>1,v=s[d];if(u(_,v)>=0)break;s[n]=v,n=d}s[n]=_}_down(n){const{data:s,compare:u}=this,_=this.length>>1,d=s[n];for(;n<_;){let v=1+(n<<1);const E=v+1;if(E<this.length&&u(s[E],s[v])<0&&(v=E),u(s[v],d)>=0)break;s[n]=s[v],n=v}s[n]=d}}var Kt=8192;function fp(c,n){return n.dist-c.dist}const qf=100,Gf=50;function _c(c){const n=[1/0,1/0,-1/0,-1/0];if(n.length!==c.length)return!1;for(let s=0;s<n.length;s++)if(n[s]!==c[s])return!1;return!0}function va(c){return c[1]-c[0]+1}function kl(c,n){const s=c[1]>=c[0]&&c[1]<n;return s||console.warn("Distance Expression: Index is out of range"),s}function Dm(c,n){if(c[0]>c[1])return[null,null];const s=va(c);if(n){if(s===2)return[c,null];const u=Math.floor(s/2);return[[c[0],c[0]+u],[c[0]+u,c[1]]]}{if(s===1)return[c,null];const u=Math.floor(s/2)-1;return[[c[0],c[0]+u],[c[0]+u+1,c[1]]]}}function xa(c,n){const s=[1/0,1/0,-1/0,-1/0];if(!kl(n,c.length))return s;for(let u=n[0];u<=n[1];++u)Uf(s,c[u]);return s}function Us(c){const n=[1/0,1/0,-1/0,-1/0];for(let s=0;s<c.length;++s)for(let u=0;u<c[s].length;++u)Uf(n,c[s][u]);return n}function gc(c,n,s){if(_c(c)||_c(n))return NaN;let u=0,_=0;return c[2]<n[0]&&(u=n[0]-c[2]),c[0]>n[2]&&(u=c[0]-n[2]),c[1]>n[3]&&(_=c[1]-n[3]),c[3]<n[1]&&(_=n[1]-c[3]),s.distance([0,0],[u,_])}function dp(c){return 360*c-180}function a_(c){return 360/Math.PI*Math.atan(Math.exp((180-360*c)*Math.PI/180))-90}function pp(c,n){const s=Math.pow(2,n.z),u=(c.y/Kt+n.y)/s;return[dp((c.x/Kt+n.x)/s),a_(u)]}function Lm(c,n){const s=[];for(let u=0;u<c.length;++u)s.push(pp(c[u],n));return s}function o_(c,n,s){const u=s.pointOnLine(n,c).point;return s.distance(c,u)}function km(c,n,s,u,_){const d=s.slice(u[0],u[1]+1);let v=1/0;for(let E=n[0];E<=n[1];++E)if((v=Math.min(v,o_(c[E],d,_)))===0)return 0;return v}function yc(c,n,s,u,_){const d=Math.min(_.pointToSegmentDistance(c,s,u),_.pointToSegmentDistance(n,s,u)),v=Math.min(_.pointToSegmentDistance(s,c,n),_.pointToSegmentDistance(u,c,n));return Math.min(d,v)}function zm(c,n,s,u,_){if(!kl(n,c.length)||!kl(u,s.length))return NaN;let d=1/0;for(let v=n[0];v<n[1];++v)for(let E=u[0];E<u[1];++E){if(js(c[v],c[v+1],s[E],s[E+1]))return 0;d=Math.min(d,yc(c[v],c[v+1],s[E],s[E+1],_))}return d}function bh(c,n,s,u,_){if(!kl(n,c.length)||!kl(u,s.length))return NaN;let d=1/0;for(let v=n[0];v<=n[1];++v)for(let E=u[0];E<=u[1];++E)if((d=Math.min(d,_.distance(c[v],s[E])))===0)return d;return d}function zl(c,n,s){if(vh(c,n,!0))return 0;let u=1/0;for(const _ of n){const d=_.length;if(d<2)return console.warn("Distance Expression: Invalid polygon!"),NaN;if(_[0]!==_[d-1]&&(u=Math.min(u,s.pointToSegmentDistance(c,_[d-1],_[0])))===0||(u=Math.min(u,o_(c,_,s)))===0)return u}return u}function s_(c,n,s,u){if(!kl(n,c.length))return NaN;for(let d=n[0];d<=n[1];++d)if(vh(c[d],s,!0))return 0;let _=1/0;for(let d=n[0];d<n[1];++d)for(const v of s)for(let E=0,O=v.length,z=O-1;E<O;z=E++){if(js(c[d],c[d+1],v[z],v[E]))return 0;_=Math.min(_,yc(c[d],c[d+1],v[z],v[E],u))}return _}function vc(c,n){for(const s of c)for(let u=0;u<=s.length-1;++u)if(vh(s[u],n,!0))return!0;return!1}function xc(c,n,s,u=1/0){const _=Us(c),d=Us(n);if(u!==1/0&&gc(_,d,s)>=u)return u;if(Vf(_,d)){if(vc(c,n))return 0}else if(vc(n,c))return 0;let v=u;for(const E of c)for(let O=0,z=E.length,S=z-1;O<z;S=O++)for(const P of n)for(let L=0,M=P.length,R=M-1;L<M;R=L++){if(js(E[S],E[O],P[R],P[L]))return 0;v=Math.min(v,yc(E[S],E[O],P[R],P[L],s))}return v}function xu(c,n,s,u,_,d,v){if(d===null||v===null)return;const E=gc(xa(u,d),xa(_,v),s);E<n&&c.push({dist:E,range1:d,range2:v})}function Bm(c,n,s,u,_=1/0){let d=Math.min(u.distance(c[0],s[0][0]),_);if(d===0)return d;const v=new aa([{dist:0,range1:[0,c.length-1],range2:[0,0]}],fp),E=n?Gf:qf,O=Us(s);for(;v.length;){const z=v.pop();if(z.dist>=d)continue;const S=z.range1;if(va(S)<=E){if(!kl(S,c.length))return NaN;if(n){const P=s_(c,S,s,u);if((d=Math.min(d,P))===0)return d}else for(let P=S[0];P<=S[1];++P){const L=zl(c[P],s,u);if((d=Math.min(d,L))===0)return d}}else{const P=Dm(S,n);if(P[0]!==null){const L=gc(xa(c,P[0]),O,u);L<d&&v.push({dist:L,range1:P[0],range2:[0,0]})}if(P[1]!==null){const L=gc(xa(c,P[1]),O,u);L<d&&v.push({dist:L,range1:P[1],range2:[0,0]})}}}return d}function La(c,n,s,u,_,d=1/0){let v=Math.min(d,_.distance(c[0],s[0]));if(v===0)return v;const E=new aa([{dist:0,range1:[0,c.length-1],range2:[0,s.length-1]}],fp),O=n?Gf:qf,z=u?Gf:qf;for(;E.length;){const S=E.pop();if(S.dist>=v)continue;const P=S.range1,L=S.range2;if(va(P)<=O&&va(L)<=z){if(!kl(P,c.length)||!kl(L,s.length))return NaN;if(n&&u?v=Math.min(v,zm(c,P,s,L,_)):n||u?n&&!u?v=Math.min(v,km(s,L,c,P,_)):!n&&u&&(v=Math.min(v,km(c,P,s,L,_))):v=Math.min(v,bh(c,P,s,L,_)),v===0)return v}else{const M=Dm(P,n),R=Dm(L,u);xu(E,v,_,c,s,M[0],R[0]),xu(E,v,_,c,s,M[0],R[1]),xu(E,v,_,c,s,M[1],R[0]),xu(E,v,_,c,s,M[1],R[1])}}return v}function Hf(c,n,s,u,_=1/0){let d=_;const v=xa(c,[0,c.length-1]);for(const E of s)if(!(d!==1/0&&gc(v,xa(E,[0,E.length-1]),u)>=d)&&(d=Math.min(d,La(c,n,E,!0,u,d)),d===0))return d;return d}function wh(c,n,s,u,_=1/0){let d=_;const v=xa(c,[0,c.length-1]);for(const E of s){if(d!==1/0&&gc(v,Us(E),u)>=d)continue;const O=Bm(c,n,E,u,d);if(isNaN(O))return O;if((d=Math.min(d,O))===0)return d}return d}function Zf(c){return c==="Point"||c==="MultiPoint"||c==="LineString"||c==="MultiLineString"||c==="Polygon"||c==="MultiPolygon"}class bc{constructor(n,s){this.type=_n,this.geojson=n,this.geometries=s}static parse(n,s){if(n.length!==2)return s.error(`'distance' expression requires either one argument, but found ' ${n.length-1} instead.`);if(Dl(n[1])){const u=n[1];if(u.type==="FeatureCollection"){for(let _=0;_<u.features.length;++_)if(Zf(u.features[_].geometry.type))return new bc(u,u.features[_].geometry)}else if(u.type==="Feature"){if(Zf(u.geometry.type))return new bc(u,u.geometry)}else if(Zf(u.type))return new bc(u,u)}return s.error("'distance' expression needs to be an array with format ['Distance', GeoJSONObj].")}evaluate(n){const s=n.geometry(),u=n.canonicalID();if(s!=null&&u!=null){if(n.geometryType()==="Point")return function(_,d,v){const E=[];for(const z of _)for(const S of z)E.push(pp(S,d));const O=new rl(E[0][1],"meters");return v.type==="Point"||v.type==="MultiPoint"||v.type==="LineString"?La(E,!1,v.type==="Point"?[v.coordinates]:v.coordinates,v.type==="LineString",O):v.type==="MultiLineString"?Hf(E,!1,v.coordinates,O):v.type==="Polygon"||v.type==="MultiPolygon"?wh(E,!1,v.type==="Polygon"?[v.coordinates]:v.coordinates,O):null}(s,u,this.geometries);if(n.geometryType()==="LineString")return function(_,d,v){const E=[];for(const z of _){const S=[];for(const P of z)S.push(pp(P,d));E.push(S)}const O=new rl(E[0][0][1],"meters");if(v.type==="Point"||v.type==="MultiPoint"||v.type==="LineString")return Hf(v.type==="Point"?[v.coordinates]:v.coordinates,v.type==="LineString",E,O);if(v.type==="MultiLineString"){let z=1/0;for(let S=0;S<v.coordinates.length;S++){const P=Hf(v.coordinates[S],!0,E,O,z);if(isNaN(P))return P;if((z=Math.min(z,P))===0)return z}return z}if(v.type==="Polygon"||v.type==="MultiPolygon"){let z=1/0;for(let S=0;S<E.length;S++){const P=wh(E[S],!0,v.type==="Polygon"?[v.coordinates]:v.coordinates,O,z);if(isNaN(P))return P;if((z=Math.min(z,P))===0)return z}return z}return null}(s,u,this.geometries);if(n.geometryType()==="Polygon")return function(_,d,v){const E=[];for(const z of function(S,P){const L=S.length;if(L<=1)return[S];const M=[];let R,B;for(let q=0;q<L;q++){const H=Cy(S[q]);H!==0&&(S[q].area=Math.abs(H),B===void 0&&(B=H<0),B===H<0?(R&&M.push(R),R=[S[q]]):R.push(S[q]))}return R&&M.push(R),M}(_)){const S=[];for(let P=0;P<z.length;++P)S.push(Lm(z[P],d));E.push(S)}const O=new rl(E[0][0][0][1],"meters");if(v.type==="Point"||v.type==="MultiPoint"||v.type==="LineString")return wh(v.type==="Point"?[v.coordinates]:v.coordinates,v.type==="LineString",E,O);if(v.type==="MultiLineString"){let z=1/0;for(let S=0;S<v.coordinates.length;S++){const P=wh(v.coordinates[S],!0,E,O,z);if(isNaN(P))return P;if((z=Math.min(z,P))===0)return z}return z}return v.type==="Polygon"||v.type==="MultiPolygon"?function(z,S,P){let L=1/0;for(const M of z)for(const R of S){const B=xc(M,R,P,L);if(isNaN(B))return B;if((L=Math.min(L,B))===0)return L}return L}(v.type==="Polygon"?[v.coordinates]:v.coordinates,E,O):null}(s,u,this.geometries);console.warn("Distance Expression: currently only evaluates valid Point/LineString/Polygon geometries.")}else console.warn("Distance Expression: requirs valid feature and canonical information.");return null}eachChild(){}outputDefined(){return!0}serialize(){return["distance",this.geojson]}}function mp(c,n){switch(c){case"string":return hs(n);case"number":return+n;case"boolean":return!!n;case"color":return _r.parse(n);case"formatted":return ia.fromString(hs(n));case"resolvedImage":return Da.build(hs(n))}return n}function Nm(c,n,s,u){return u!==void 0&&(c=u*Math.round(c/u)),n!==void 0&&c<n&&(c=n),s!==void 0&&c>s&&(c=s),c}class wc{constructor(n,s,u){this.type=n,this.key=s,this.scope=u}static parse(n,s){let u=s.expectedType;if(u==null&&(u=gr),n.length<2||n.length>3)return s.error("Invalid number of arguments for 'config' expression.");const _=s.parse(n[1],1);if(!(_ instanceof ya))return s.error("Key name of 'config' expression must be a string literal.");if(n.length>=3){const d=s.parse(n[2],2);return d instanceof ya?new wc(u,hs(_.value),hs(d.value)):s.error("Scope of 'config' expression must be a string literal.")}return new wc(u,hs(_.value))}evaluate(n){const s=[this.key,this.scope,n.scope].filter(Boolean).join(""),u=n.getConfig(s);if(!u)return null;const{type:_,value:d,values:v,minValue:E,maxValue:O,stepValue:z}=u,S=u.default.evaluate(n);let P=S;if(d){const L=n.scope;n.scope=(L||"").split("").slice(1).join(""),P=d.evaluate(n),n.scope=L}return _&&(P=mp(_,P)),P===void 0||E===void 0&&O===void 0&&z===void 0||(typeof P=="number"?P=Nm(P,E,O,z):Array.isArray(P)&&(P=P.map(L=>typeof L=="number"?Nm(L,E,O,z):L))),d!==void 0&&P!==void 0&&v&&!v.includes(P)&&(P=S,_&&(P=mp(_,P))),(_&&_!==this.type||P!==void 0&&ai(P)!==this.type)&&(P=mp(this.type.kind,P)),P}eachChild(){}outputDefined(){return!1}serialize(){const n=["config",this.key];return this.scope&&n.concat(this.key),n}}function bu(c){if(c instanceof ho&&(c.name==="get"&&c.args.length===1||c.name==="feature-state"||c.name==="has"&&c.args.length===1||c.name==="properties"||c.name==="geometry-type"||c.name==="id"||/^filter-/.test(c.name))||c instanceof Dn||c instanceof bc)return!1;let n=!0;return c.eachChild(s=>{n&&!bu(s)&&(n=!1)}),n}function Sh(c){if(c instanceof ho&&c.name==="feature-state")return!1;let n=!0;return c.eachChild(s=>{n&&!Sh(s)&&(n=!1)}),n}function fo(c){if(c instanceof wc)return new Set([c.key]);let n=new Set;return c.eachChild(s=>{n=new Set([...n,...fo(s)])}),n}function ka(c,n){if(c instanceof ho&&n.indexOf(c.name)>=0)return!1;let s=!0;return c.eachChild(u=>{s&&!ka(u,n)&&(s=!1)}),s}class ps{constructor(n,s){this.type=s.type,this.name=n,this.boundExpression=s}static parse(n,s){if(n.length!==2||typeof n[1]!="string")return s.error("'var' expression requires exactly one string literal argument.");const u=n[1];return s.scope.has(u)?new ps(u,s.scope.get(u)):s.error(`Unknown variable "${u}". Make sure "${u}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(n){return this.boundExpression.evaluate(n)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}class Sc{constructor(n,s=[],u,_=new kf,d=[],v,E){this.registry=n,this.path=s,this.key=s.map(O=>typeof O=="string"?`['${O}']`:`[${O}]`).join(""),this.scope=_,this.errors=d,this.expectedType=u,this._scope=v,this.options=E}parse(n,s,u,_,d={}){return s||u?this.concat(s,null,u,_)._parse(n,d):this._parse(n,d)}parseObjectValue(n,s,u,_,d,v={}){return this.concat(s,u,_,d)._parse(n,v)}_parse(n,s){function u(_,d,v){return v==="assert"?new Ns(d,[_]):v==="coerce"?new Ll(d,[_]):_}if(n!==null&&typeof n!="string"&&typeof n!="boolean"&&typeof n!="number"||(n=["literal",n]),Array.isArray(n)){if(n.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const _=typeof n[0]=="string"?this.registry[n[0]]:void 0;if(_){let d=_.parse(n,this);if(!d)return null;if(this.expectedType){const v=this.expectedType,E=d.type;if(v.kind!=="string"&&v.kind!=="number"&&v.kind!=="boolean"&&v.kind!=="object"&&v.kind!=="array"||E.kind!=="value")if(v.kind!=="color"&&v.kind!=="formatted"&&v.kind!=="resolvedImage"||E.kind!=="value"&&E.kind!=="string"){if(this.checkSubtype(v,E))return null}else d=u(d,v,s.typeAnnotation||"coerce");else d=u(d,v,s.typeAnnotation||"assert")}if(!(d instanceof ya)&&d.type.kind!=="resolvedImage"&&wu(d)){const v=new Om(this._scope,this.options);try{d=new ya(d.type,d.evaluate(v))}catch(E){return this.error(E.message),null}}return d}return Ll.parse(["to-array",n],this)}return this.error(n===void 0?"'undefined' value invalid. Use null instead.":typeof n=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof n} instead.`)}concat(n,s,u,_){let d=typeof n=="number"?this.path.concat(n):this.path;d=typeof s=="string"?d.concat(s):d;const v=_?this.scope.concat(_):this.scope;return new Sc(this.registry,d,u||null,v,this.errors,this._scope,this.options)}error(n,...s){const u=`${this.key}${s.map(_=>`[${_}]`).join("")}`;this.errors.push(new Kn(u,n))}checkSubtype(n,s){const u=ga(n,s);return u&&this.error(u),u}}var Tc=Sc;function wu(c){if(c instanceof ps)return wu(c.boundExpression);if(c instanceof ho&&c.name==="error"||c instanceof Nf||c instanceof Dn||c instanceof bc||c instanceof wc)return!1;const n=c instanceof Ll||c instanceof Ns;let s=!0;return c.eachChild(u=>{s=n?s&&wu(u):s&&u instanceof ya}),!!s&&bu(c)&&ka(c,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])}function Su(c,n){const s=c.length-1;let u,_,d=0,v=s,E=0;for(;d<=v;)if(E=Math.floor((d+v)/2),u=c[E],_=c[E+1],u<=n){if(E===s||n<_)return E;d=E+1}else{if(!(u>n))throw new Ii("Input is not a number.");v=E-1}return 0}class $o{constructor(n,s,u){this.type=n,this.input=s,this.labels=[],this.outputs=[];for(const[_,d]of u)this.labels.push(_),this.outputs.push(d)}static parse(n,s){if(n.length-1<4)return s.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if((n.length-1)%2!=0)return s.error("Expected an even number of arguments.");const u=s.parse(n[1],1,_n);if(!u)return null;const _=[];let d=null;s.expectedType&&s.expectedType.kind!=="value"&&(d=s.expectedType);for(let v=1;v<n.length;v+=2){const E=v===1?-1/0:n[v],O=n[v+1],z=v,S=v+1;if(typeof E!="number")return s.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',z);if(_.length&&_[_.length-1][0]>=E)return s.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',z);const P=s.parse(O,S,d);if(!P)return null;d=d||P.type,_.push([E,P])}return new $o(d,u,_)}evaluate(n){const s=this.labels,u=this.outputs;if(s.length===1)return u[0].evaluate(n);const _=this.input.evaluate(n);if(_<=s[0])return u[0].evaluate(n);const d=s.length;return _>=s[d-1]?u[d-1].evaluate(n):u[Su(s,_)].evaluate(n)}eachChild(n){n(this.input);for(const s of this.outputs)n(s)}outputDefined(){return this.outputs.every(n=>n.outputDefined())}serialize(){const n=["step",this.input.serialize()];for(let s=0;s<this.labels.length;s++)s>0&&n.push(this.labels[s]),n.push(this.outputs[s].serialize());return n}}const Ec=.95047,sr=1.08883,Tu=4/29,Eu=6/29,qo=3*Eu*Eu,Au=Eu*Eu*Eu,Th=Math.PI/180,jr=180/Math.PI;function Eh(c){return c>Au?Math.pow(c,1/3):c/qo+Tu}function To(c){return c>Eu?c*c*c:qo*(c-Tu)}function Eo(c){return 255*(c<=.0031308?12.92*c:1.055*Math.pow(c,1/2.4)-.055)}function Bl(c){return(c/=255)<=.04045?c/12.92:Math.pow((c+.055)/1.055,2.4)}function il(c){const n=Bl(c.r),s=Bl(c.g),u=Bl(c.b),_=Eh((.4124564*n+.3575761*s+.1804375*u)/Ec),d=Eh((.2126729*n+.7151522*s+.072175*u)/1);return{l:116*d-16,a:500*(_-d),b:200*(d-Eh((.0193339*n+.119192*s+.9503041*u)/sr)),alpha:c.a}}function al(c){let n=(c.l+16)/116,s=isNaN(c.a)?n:n+c.a/500,u=isNaN(c.b)?n:n-c.b/200;return n=1*To(n),s=Ec*To(s),u=sr*To(u),new _r(Eo(3.2404542*s-1.5371385*n-.4985314*u),Eo(-.969266*s+1.8760108*n+.041556*u),Eo(.0556434*s-.2040259*n+1.0572252*u),c.alpha)}function Cu(c,n,s){const u=n-c;return c+s*(u>180||u<-180?u-360*Math.round(u/360):u)}const Ah={forward:il,reverse:al,interpolate:function(c,n,s){return{l:Mn(c.l,n.l,s),a:Mn(c.a,n.a,s),b:Mn(c.b,n.b,s),alpha:Mn(c.alpha,n.alpha,s)}}},Mu={forward:function(c){const{l:n,a:s,b:u}=il(c),_=Math.atan2(u,s)*jr;return{h:_<0?_+360:_,c:Math.sqrt(s*s+u*u),l:n,alpha:c.a}},reverse:function(c){const n=c.h*Th,s=c.c;return al({l:c.l,a:Math.cos(n)*s,b:Math.sin(n)*s,alpha:c.alpha})},interpolate:function(c,n,s){return{h:Cu(c.h,n.h,s),c:Mn(c.c,n.c,s),l:Mn(c.l,n.l,s),alpha:Mn(c.alpha,n.alpha,s)}}};var _p=Object.freeze({__proto__:null,hcl:Mu,lab:Ah});class li{constructor(n,s,u,_,d,v){this.type=n,this.operator=s,this.interpolation=u,this.input=_,this.dynamicStops=d,this.labels=[],this.outputs=[];for(const[E,O]of v)this.labels.push(E),this.outputs.push(O)}static interpolationFactor(n,s,u,_){let d=0;if(n.name==="exponential")d=ba(s,n.base,u,_);else if(n.name==="linear")d=ba(s,1,u,_);else if(n.name==="cubic-bezier"){const v=n.controlPoints;d=new fn(v[0],v[1],v[2],v[3]).solve(ba(s,1,u,_))}return d}static parse(n,s){let[u,_,d,...v]=n;if(!Array.isArray(_)||_.length===0)return s.error("Expected an interpolation type expression.",1);if(_[0]==="linear")_={name:"linear"};else if(_[0]==="exponential"){const z=_[1];if(typeof z!="number")return s.error("Exponential interpolation requires a numeric base.",1,1);_={name:"exponential",base:z}}else{if(_[0]!=="cubic-bezier")return s.error(`Unknown interpolation type ${String(_[0])}`,1,0);{const z=_.slice(1);if(z.length!==4||z.some(S=>typeof S!="number"||S<0||S>1))return s.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);_={name:"cubic-bezier",controlPoints:z}}}if(n.length-1<3)return s.error(`Expected at least 3 arguments, but found only ${n.length-1}.`);if(n.length-1>3&&(n.length-1)%2!=0)return s.error("Expected an even number of arguments.");if(d=s.parse(d,2,_n),!d)return null;const E=[];let O=null;if(u==="interpolate-hcl"||u==="interpolate-lab"?O=_a:s.expectedType&&s.expectedType.kind!=="value"&&(O=s.expectedType),n.length-1==3){const z=s.parse(v[0],3,gr);return z?new li(O,u,_,d,z,E):null}for(let z=0;z<v.length;z+=2){const S=v[z],P=v[z+1],L=z+3,M=z+4;if(typeof S!="number")return s.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',L);if(E.length&&E[E.length-1][0]>=S)return s.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',L);const R=s.parse(P,M,O);if(!R)return null;O=O||R.type,E.push([S,R])}return O.kind==="number"||O.kind==="color"||O.kind==="array"&&O.itemType.kind==="number"&&typeof O.N=="number"?new li(O,u,_,d,null,E):s.error(`Type ${Xr(O)} is not interpolatable.`)}evaluate(n){let s=this.labels,u=this.outputs;if(this.dynamicStops){const S=this.dynamicStops.evaluate(n);if(S.length%2!=0)throw new Ii("Expected an even number of arguments.");s=[],u=[];for(let P=0;P<S.length;P+=2){const L=S[P],M=new ya(_n,S[P+1]);if(typeof L!="number")throw new Ii('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.');if(s.length&&s[s.length-1]>=L)throw new Ii('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.');s.push(L),u.push(M)}if(s.length===0)throw new Ii("Expected at least one input/output pair.")}if(s.length===1)return u[0].evaluate(n);const _=this.input.evaluate(n);if(_<=s[0])return u[0].evaluate(n);const d=s.length;if(_>=s[d-1])return u[d-1].evaluate(n);const v=Su(s,_),E=li.interpolationFactor(this.interpolation,_,s[v],s[v+1]),O=u[v].evaluate(n),z=u[v+1].evaluate(n);return this.operator==="interpolate"?Il[this.type.kind.toLowerCase()](O,z,E):this.operator==="interpolate-hcl"?Mu.reverse(Mu.interpolate(Mu.forward(O),Mu.forward(z),E)):Ah.reverse(Ah.interpolate(Ah.forward(O),Ah.forward(z),E))}eachChild(n){n(this.input);for(const s of this.outputs)n(s)}outputDefined(){return this.outputs.every(n=>n.outputDefined())}serialize(){let n;n=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const s=[this.operator,n,this.input.serialize()];if(this.dynamicStops)s.push(this.dynamicStops.serialize());else for(let u=0;u<this.labels.length;u++)s.push(this.labels[u],this.outputs[u].serialize());return s}}function ba(c,n,s,u){const _=u-s,d=c-s;return _===0?0:n===1?d/_:(Math.pow(n,d)-1)/(Math.pow(n,_)-1)}class Ur{constructor(n,s){this.type=n,this.args=s}static parse(n,s){if(n.length<2)return s.error("Expectected at least one argument.");let u=null;const _=s.expectedType;_&&_.kind!=="value"&&(u=_);const d=[];for(const E of n.slice(1)){const O=s.parse(E,1+d.length,u,void 0,{typeAnnotation:"omit"});if(!O)return null;u=u||O.type,d.push(O)}const v=_&&d.some(E=>ga(_,E.type));return new Ur(v?gr:u,d)}evaluate(n){let s,u=null,_=0;for(const d of this.args){if(_++,u=d.evaluate(n),u&&u instanceof Da&&!u.available&&(s||(s=u),u=null,_===this.args.length))return s;if(u!==null)break}return u}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every(n=>n.outputDefined())}serialize(){const n=["coalesce"];return this.eachChild(s=>{n.push(s.serialize())}),n}}class Ao{constructor(n,s){this.type=s.type,this.bindings=[].concat(n),this.result=s}evaluate(n){return this.result.evaluate(n)}eachChild(n){for(const s of this.bindings)n(s[1]);n(this.result)}static parse(n,s){if(n.length<4)return s.error(`Expected at least 3 arguments, but found ${n.length-1} instead.`);const u=[];for(let d=1;d<n.length-1;d+=2){const v=n[d];if(typeof v!="string")return s.error(`Expected string, but found ${typeof v} instead.`,d);if(/[^a-zA-Z0-9_]/.test(v))return s.error("Variable names must contain only alphanumeric characters or '_'.",d);const E=s.parse(n[d+1],d+1);if(!E)return null;u.push([v,E])}const _=s.parse(n[n.length-1],n.length-1,s.expectedType,u);return _?new Ao(u,_):null}outputDefined(){return this.result.outputDefined()}serialize(){const n=["let"];for(const[s,u]of this.bindings)n.push(s,u.serialize());return n.push(this.result.serialize()),n}}class ms{constructor(n,s,u){this.type=n,this.index=s,this.input=u}static parse(n,s){if(n.length!==3)return s.error(`Expected 2 arguments, but found ${n.length-1} instead.`);const u=s.parse(n[1],1,_n),_=s.parse(n[2],2,Wr(s.expectedType||gr));return u&&_?new ms(_.type.itemType,u,_):null}evaluate(n){const s=this.index.evaluate(n),u=this.input.evaluate(n);if(s<0)throw new Ii(`Array index out of bounds: ${s} < 0.`);if(s>u.length-1)throw new Ii(`Array index out of bounds: ${s} > ${u.length-1}.`);if(s===Math.floor(s))return u[s];const _=Math.floor(s),d=Math.ceil(s),v=u[_],E=u[d];if(typeof v!="number"||typeof E!="number")throw new Ii(`Cannot interpolate between non-number values at index ${s}.`);const O=s-_;return v*(1-O)+E*O}eachChild(n){n(this.index),n(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}class Wf{constructor(n,s){this.type=ar,this.needle=n,this.haystack=s}static parse(n,s){if(n.length!==3)return s.error(`Expected 2 arguments, but found ${n.length-1} instead.`);const u=s.parse(n[1],1,gr),_=s.parse(n[2],2,gr);return u&&_?sp(u.type,[ar,xr,_n,zs,gr])?new Wf(u,_):s.error(`Expected first argument to be of type boolean, string, number or null, but found ${Xr(u.type)} instead`):null}evaluate(n){const s=this.needle.evaluate(n),u=this.haystack.evaluate(n);if(u==null)return!1;if(!yu(s,["boolean","string","number","null"]))throw new Ii(`Expected first argument to be of type boolean, string, number or null, but found ${Xr(ai(s))} instead.`);if(!yu(u,["string","array"]))throw new Ii(`Expected second argument to be of type array or string, but found ${Xr(ai(u))} instead.`);return u.indexOf(s)>=0}eachChild(n){n(this.needle),n(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}class ol{constructor(n,s,u){this.type=_n,this.needle=n,this.haystack=s,this.fromIndex=u}static parse(n,s){if(n.length<=2||n.length>=5)return s.error(`Expected 3 or 4 arguments, but found ${n.length-1} instead.`);const u=s.parse(n[1],1,gr),_=s.parse(n[2],2,gr);if(!u||!_)return null;if(!sp(u.type,[ar,xr,_n,zs,gr]))return s.error(`Expected first argument to be of type boolean, string, number or null, but found ${Xr(u.type)} instead`);if(n.length===4){const d=s.parse(n[3],3,_n);return d?new ol(u,_,d):null}return new ol(u,_)}evaluate(n){const s=this.needle.evaluate(n),u=this.haystack.evaluate(n);if(!yu(s,["boolean","string","number","null"]))throw new Ii(`Expected first argument to be of type boolean, string, number or null, but found ${Xr(ai(s))} instead.`);if(!yu(u,["string","array"]))throw new Ii(`Expected second argument to be of type array or string, but found ${Xr(ai(u))} instead.`);if(this.fromIndex){const _=this.fromIndex.evaluate(n);return u.indexOf(s,_)}return u.indexOf(s)}eachChild(n){n(this.needle),n(this.haystack),this.fromIndex&&n(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const n=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),n]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}class gp{constructor(n,s,u,_,d,v){this.inputType=n,this.type=s,this.input=u,this.cases=_,this.outputs=d,this.otherwise=v}static parse(n,s){if(n.length<5)return s.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if(n.length%2!=1)return s.error("Expected an even number of arguments.");let u,_;s.expectedType&&s.expectedType.kind!=="value"&&(_=s.expectedType);const d={},v=[];for(let z=2;z<n.length-1;z+=2){let S=n[z];const P=n[z+1];Array.isArray(S)||(S=[S]);const L=s.concat(z);if(S.length===0)return L.error("Expected at least one branch label.");for(const R of S){if(typeof R!="number"&&typeof R!="string")return L.error("Branch labels must be numbers or strings.");if(typeof R=="number"&&Math.abs(R)>Number.MAX_SAFE_INTEGER)return L.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof R=="number"&&Math.floor(R)!==R)return L.error("Numeric branch labels must be integer values.");if(u){if(L.checkSubtype(u,ai(R)))return null}else u=ai(R);if(d[String(R)]!==void 0)return L.error("Branch labels must be unique.");d[String(R)]=v.length}const M=s.parse(P,z,_);if(!M)return null;_=_||M.type,v.push(M)}const E=s.parse(n[1],1,gr);if(!E)return null;const O=s.parse(n[n.length-1],n.length-1,_);return O?E.type.kind!=="value"&&s.concat(1).checkSubtype(u,E.type)?null:new gp(u,_,E,d,v,O):null}evaluate(n){const s=this.input.evaluate(n);return(ai(s)===this.inputType&&this.outputs[this.cases[s]]||this.otherwise).evaluate(n)}eachChild(n){n(this.input),this.outputs.forEach(n),n(this.otherwise)}outputDefined(){return this.outputs.every(n=>n.outputDefined())&&this.otherwise.outputDefined()}serialize(){const n=["match",this.input.serialize()],s=Object.keys(this.cases).sort(),u=[],_={};for(const v of s){const E=_[this.cases[v]];E===void 0?(_[this.cases[v]]=u.length,u.push([this.cases[v],[v]])):u[E][1].push(v)}const d=v=>this.inputType.kind==="number"?Number(v):v;for(const[v,E]of u)n.push(E.length===1?d(E[0]):E.map(d)),n.push(this.outputs[v].serialize());return n.push(this.otherwise.serialize()),n}}class yp{constructor(n,s,u){this.type=n,this.branches=s,this.otherwise=u}static parse(n,s){if(n.length<4)return s.error(`Expected at least 3 arguments, but found only ${n.length-1}.`);if(n.length%2!=0)return s.error("Expected an odd number of arguments.");let u;s.expectedType&&s.expectedType.kind!=="value"&&(u=s.expectedType);const _=[];for(let v=1;v<n.length-1;v+=2){const E=s.parse(n[v],v,ar);if(!E)return null;const O=s.parse(n[v+1],v+1,u);if(!O)return null;_.push([E,O]),u=u||O.type}const d=s.parse(n[n.length-1],n.length-1,u);return d?new yp(u,_,d):null}evaluate(n){for(const[s,u]of this.branches)if(s.evaluate(n))return u.evaluate(n);return this.otherwise.evaluate(n)}eachChild(n){for(const[s,u]of this.branches)n(s),n(u);n(this.otherwise)}outputDefined(){return this.branches.every(([n,s])=>s.outputDefined())&&this.otherwise.outputDefined()}serialize(){const n=["case"];return this.eachChild(s=>{n.push(s.serialize())}),n}}class Ac{constructor(n,s,u,_){this.type=n,this.input=s,this.beginIndex=u,this.endIndex=_}static parse(n,s){if(n.length<=2||n.length>=5)return s.error(`Expected 3 or 4 arguments, but found ${n.length-1} instead.`);const u=s.parse(n[1],1,gr),_=s.parse(n[2],2,_n);if(!u||!_)return null;if(!sp(u.type,[Wr(gr),xr,gr]))return s.error(`Expected first argument to be of type array or string, but found ${Xr(u.type)} instead`);if(n.length===4){const d=s.parse(n[3],3,_n);return d?new Ac(u.type,u,_,d):null}return new Ac(u.type,u,_)}evaluate(n){const s=this.input.evaluate(n),u=this.beginIndex.evaluate(n);if(!yu(s,["string","array"]))throw new Ii(`Expected first argument to be of type array or string, but found ${Xr(ai(s))} instead.`);if(this.endIndex){const _=this.endIndex.evaluate(n);return s.slice(u,_)}return s.slice(u)}eachChild(n){n(this.input),n(this.beginIndex),this.endIndex&&n(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const n=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),n]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}function Ch(c,n){return c==="=="||c==="!="?n.kind==="boolean"||n.kind==="string"||n.kind==="number"||n.kind==="null"||n.kind==="value":n.kind==="string"||n.kind==="number"||n.kind==="value"}function Mh(c,n,s,u){return u.compare(n,s)===0}function sl(c,n,s){const u=c!=="=="&&c!=="!=";return class FV{constructor(d,v,E){this.type=ar,this.lhs=d,this.rhs=v,this.collator=E,this.hasUntypedArgument=d.type.kind==="value"||v.type.kind==="value"}static parse(d,v){if(d.length!==3&&d.length!==4)return v.error("Expected two or three arguments.");const E=d[0];let O=v.parse(d[1],1,gr);if(!O)return null;if(!Ch(E,O.type))return v.concat(1).error(`"${E}" comparisons are not supported for type '${Xr(O.type)}'.`);let z=v.parse(d[2],2,gr);if(!z)return null;if(!Ch(E,z.type))return v.concat(2).error(`"${E}" comparisons are not supported for type '${Xr(z.type)}'.`);if(O.type.kind!==z.type.kind&&O.type.kind!=="value"&&z.type.kind!=="value")return v.error(`Cannot compare types '${Xr(O.type)}' and '${Xr(z.type)}'.`);u&&(O.type.kind==="value"&&z.type.kind!=="value"?O=new Ns(z.type,[O]):O.type.kind!=="value"&&z.type.kind==="value"&&(z=new Ns(O.type,[z])));let S=null;if(d.length===4){if(O.type.kind!=="string"&&z.type.kind!=="string"&&O.type.kind!=="value"&&z.type.kind!=="value")return v.error("Cannot use collator to compare non-string types.");if(S=v.parse(d[3],3,dc),!S)return null}return new FV(O,z,S)}evaluate(d){const v=this.lhs.evaluate(d),E=this.rhs.evaluate(d);if(u&&this.hasUntypedArgument){const O=ai(v),z=ai(E);if(O.kind!==z.kind||O.kind!=="string"&&O.kind!=="number")throw new Ii(`Expected arguments for "${c}" to be (string, string) or (number, number), but found (${O.kind}, ${z.kind}) instead.`)}if(this.collator&&!u&&this.hasUntypedArgument){const O=ai(v),z=ai(E);if(O.kind!=="string"||z.kind!=="string")return n(d,v,E)}return this.collator?s(d,v,E,this.collator.evaluate(d)):n(d,v,E)}eachChild(d){d(this.lhs),d(this.rhs),this.collator&&d(this.collator)}outputDefined(){return!0}serialize(){const d=[c];return this.eachChild(v=>{d.push(v.serialize())}),d}}}const l_=sl("==",function(c,n,s){return n===s},Mh),Fm=sl("!=",function(c,n,s){return n!==s},function(c,n,s,u){return!Mh(0,n,s,u)}),c_=sl("<",function(c,n,s){return n<s},function(c,n,s,u){return u.compare(n,s)<0}),vp=sl(">",function(c,n,s){return n>s},function(c,n,s,u){return u.compare(n,s)>0}),u_=sl("<=",function(c,n,s){return n<=s},function(c,n,s,u){return u.compare(n,s)<=0}),Xf=sl(">=",function(c,n,s){return n>=s},function(c,n,s,u){return u.compare(n,s)>=0});class xp{constructor(n,s,u,_,d,v){this.type=xr,this.number=n,this.locale=s,this.currency=u,this.unit=_,this.minFractionDigits=d,this.maxFractionDigits=v}static parse(n,s){if(n.length!==3)return s.error("Expected two arguments.");const u=s.parse(n[1],1,_n);if(!u)return null;const _=n[2];if(typeof _!="object"||Array.isArray(_))return s.error("NumberFormat options argument must be an object.");let d=null;if(_.locale&&(d=s.parseObjectValue(_.locale,2,"locale",xr),!d))return null;let v=null;if(_.currency&&(v=s.parseObjectValue(_.currency,2,"currency",xr),!v))return null;let E=null;if(_.unit&&(E=s.parseObjectValue(_.unit,2,"unit",xr),!E))return null;let O=null;if(_["min-fraction-digits"]&&(O=s.parseObjectValue(_["min-fraction-digits"],2,"min-fraction-digits",_n),!O))return null;let z=null;return _["max-fraction-digits"]&&(z=s.parseObjectValue(_["max-fraction-digits"],2,"max-fraction-digits",_n),!z)?null:new xp(u,d,v,E,O,z)}evaluate(n){return new Intl.NumberFormat(this.locale?this.locale.evaluate(n):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(n):void 0,unit:this.unit?this.unit.evaluate(n):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(n):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(n):void 0}).format(this.number.evaluate(n))}eachChild(n){n(this.number),this.locale&&n(this.locale),this.currency&&n(this.currency),this.unit&&n(this.unit),this.minFractionDigits&&n(this.minFractionDigits),this.maxFractionDigits&&n(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const n={};return this.locale&&(n.locale=this.locale.serialize()),this.currency&&(n.currency=this.currency.serialize()),this.unit&&(n.unit=this.unit.serialize()),this.minFractionDigits&&(n["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(n["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),n]}}class Cc{constructor(n){this.type=_n,this.input=n}static parse(n,s){if(n.length!==2)return s.error(`Expected 1 argument, but found ${n.length-1} instead.`);const u=s.parse(n[1],1);return u?u.type.kind!=="array"&&u.type.kind!=="string"&&u.type.kind!=="value"?s.error(`Expected argument of type string or array, but found ${Xr(u.type)} instead.`):new Cc(u):null}evaluate(n){const s=this.input.evaluate(n);if(typeof s=="string"||Array.isArray(s))return s.length;throw new Ii(`Expected value to be of type string or array, but found ${Xr(ai(s))} instead.`)}eachChild(n){n(this.input)}outputDefined(){return!1}serialize(){const n=["length"];return this.eachChild(s=>{n.push(s.serialize())}),n}}function Mc(c){return function(){c=1831565813+(c|=0)|0;let n=Math.imul(c^c>>>15,1|c);return n=n+Math.imul(n^n>>>7,61|n)^n,((n^n>>>14)>>>0)/4294967296}}const Nl={"==":l_,"!=":Fm,">":vp,"<":c_,">=":Xf,"<=":u_,array:Ns,at:ms,boolean:Ns,case:yp,coalesce:Ur,collator:Nf,format:pc,image:Bf,in:Wf,"index-of":ol,interpolate:li,"interpolate-hcl":li,"interpolate-lab":li,length:Cc,let:Ao,literal:ya,match:gp,number:Ns,"number-format":xp,object:Ns,slice:Ac,step:$o,string:Ns,"to-boolean":Ll,"to-color":Ll,"to-number":Ll,"to-string":Ll,var:ps,within:Dn,distance:bc,config:wc};function Ou(c,[n,s,u,_]){n=n.evaluate(c),s=s.evaluate(c),u=u.evaluate(c);const d=_?_.evaluate(c):1,v=Am(n,s,u,d);if(v)throw new Ii(v);return new _r(n/255*d,s/255*d,u/255*d,d)}function Yf(c,[n,s,u,_]){n=n.evaluate(c),s=s.evaluate(c),u=u.evaluate(c);const d=_?_.evaluate(c):1,v=function(z,S,P,L){return typeof z=="number"&&z>=0&&z<=360?typeof S=="number"&&S>=0&&S<=100&&typeof P=="number"&&P>=0&&P<=100?L===void 0||typeof L=="number"&&L>=0&&L<=1?null:`Invalid hsla value [${[z,S,P,L].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid hsla value [${(typeof L=="number"?[z,S,P,L]:[z,S,P]).join(", ")}]: 's', and 'l' must be between 0 and 100.`:`Invalid hsla value [${(typeof L=="number"?[z,S,P,L]:[z,S,P]).join(", ")}]: 'h' must be between 0 and 360.`}(n,s,u,d);if(v)throw new Ii(v);const E=`hsla(${n}, ${s}%, ${u}%, ${d})`,O=_r.parse(E);if(!O)throw new Ii(`Failed to parse HSLA color: ${E}`);return O}function jm(c,n){return c in n}function bp(c,n){const s=n[c];return s===void 0?null:s}function Co(c){return{type:c}}function wp(c){return{result:"success",value:c}}function za(c){return{result:"error",value:c}}function Pu(c,n){return!!c&&!!c.parameters&&c.parameters.indexOf(n)>-1}function Oh(c){return c["property-type"]==="data-driven"}function Sp(c){return Pu(c.expression,"measure-light")}function Ph(c){return Pu(c.expression,"zoom")}function eo(c){return!!c.expression&&c.expression.interpolated}function _s(c){return typeof c=="object"&&c!==null&&!Array.isArray(c)}function Oc(c){return c}function Tp(c,n){const s=n.type==="color",u=c.stops&&typeof c.stops[0][0]=="object",_=u||!(u||c.property!==void 0),d=c.type||(eo(n)?"exponential":"interval");if(s&&((c=Lf({},c)).stops&&(c.stops=c.stops.map(z=>[z[0],_r.parse(z[1])])),c.default=_r.parse(c.default?c.default:n.default)),c.colorSpace&&c.colorSpace!=="rgb"&&!_p[c.colorSpace])throw new Error(`Unknown color space: ${c.colorSpace}`);let v,E,O;if(d==="exponential")v=Kf;else if(d==="interval")v=wa;else if(d==="categorical"){v=Fl,E=Object.create(null);for(const z of c.stops)E[z[0]]=z[1];O=typeof c.stops[0][0]}else{if(d!=="identity")throw new Error(`Unknown function type "${d}"`);v=h_}if(u){const z={},S=[];for(let M=0;M<c.stops.length;M++){const R=c.stops[M],B=R[0].zoom;z[B]===void 0&&(z[B]={zoom:B,type:c.type,property:c.property,default:c.default,stops:[]},S.push(B)),z[B].stops.push([R[0].value,R[1]])}const P=[];for(const M of S)P.push([z[M].zoom,Tp(z[M],n)]);const L={name:"linear"};return{kind:"composite",interpolationType:L,interpolationFactor:li.interpolationFactor.bind(void 0,L),zoomStops:P.map(M=>M[0]),evaluate:({zoom:M},R)=>Kf({stops:P,base:c.base},n,M).evaluate(M,R)}}if(_){const z=d==="exponential"?{name:"exponential",base:c.base!==void 0?c.base:1}:null;return{kind:"camera",interpolationType:z,interpolationFactor:li.interpolationFactor.bind(void 0,z),zoomStops:c.stops.map(S=>S[0]),evaluate:({zoom:S})=>v(c,n,S,E,O)}}return{kind:"source",evaluate(z,S){const P=S&&S.properties?S.properties[c.property]:void 0;return P===void 0?Go(c.default,n.default):v(c,n,P,E,O)}}}function Go(c,n,s){return c!==void 0?c:n!==void 0?n:s!==void 0?s:void 0}function Fl(c,n,s,u,_){return Go(typeof s===_?u[s]:void 0,c.default,n.default)}function wa(c,n,s){if(Fs(s)!=="number")return Go(c.default,n.default);const u=c.stops.length;if(u===1||s<=c.stops[0][0])return c.stops[0][1];if(s>=c.stops[u-1][0])return c.stops[u-1][1];const _=Su(c.stops.map(d=>d[0]),s);return c.stops[_][1]}function Kf(c,n,s){const u=c.base!==void 0?c.base:1;if(Fs(s)!=="number")return Go(c.default,n.default);const _=c.stops.length;if(_===1||s<=c.stops[0][0])return c.stops[0][1];if(s>=c.stops[_-1][0])return c.stops[_-1][1];const d=Su(c.stops.map(S=>S[0]),s),v=function(S,P,L,M){const R=M-L,B=S-L;return R===0?0:P===1?B/R:(Math.pow(P,B)-1)/(Math.pow(P,R)-1)}(s,u,c.stops[d][0],c.stops[d+1][0]),E=c.stops[d][1],O=c.stops[d+1][1];let z=Il[n.type]||Oc;if(c.colorSpace&&c.colorSpace!=="rgb"){const S=_p[c.colorSpace];z=(P,L)=>S.reverse(S.interpolate(S.forward(P),S.forward(L),v))}return typeof E.evaluate=="function"?{evaluate(...S){const P=E.evaluate.apply(void 0,S),L=O.evaluate.apply(void 0,S);if(P!==void 0&&L!==void 0)return z(P,L,v)}}:z(E,O,v)}function h_(c,n,s){return n.type==="color"?s=_r.parse(s):n.type==="formatted"?s=ia.fromString(s.toString()):n.type==="resolvedImage"?s=Da.build(s.toString()):Fs(s)===n.type||n.type==="enum"&&n.values[s]||(s=void 0),Go(s,c.default,n.default)}ho.register(Nl,{error:[{kind:"error"},[xr],(c,[n])=>{throw new Ii(n.evaluate(c))}],typeof:[xr,[gr],(c,[n])=>Xr(ai(n.evaluate(c)))],"to-rgba":[Wr(_n,4),[_a],(c,[n])=>n.evaluate(c).toRenderColor(null).toArray()],"to-hsla":[Wr(_n,4),[_a],(c,[n])=>n.evaluate(c).toRenderColor(null).toHslaArray()],rgb:[_a,[_n,_n,_n],Ou],rgba:[_a,[_n,_n,_n,_n],Ou],hsl:[_a,[_n,_n,_n],Yf],hsla:[_a,[_n,_n,_n,_n],Yf],has:{type:ar,overloads:[[[xr],(c,[n])=>jm(n.evaluate(c),c.properties())],[[xr,us],(c,[n,s])=>jm(n.evaluate(c),s.evaluate(c))]]},get:{type:gr,overloads:[[[xr],(c,[n])=>bp(n.evaluate(c),c.properties())],[[xr,us],(c,[n,s])=>bp(n.evaluate(c),s.evaluate(c))]]},"feature-state":[gr,[xr],(c,[n])=>bp(n.evaluate(c),c.featureState||{})],properties:[us,[],c=>c.properties()],"geometry-type":[xr,[],c=>c.geometryType()],id:[gr,[],c=>c.id()],zoom:[_n,[],c=>c.globals.zoom],pitch:[_n,[],c=>c.globals.pitch||0],"distance-from-center":[_n,[],c=>c.distanceFromCenter()],"measure-light":[_n,[xr],(c,[n])=>c.measureLight(n.evaluate(c))],"heatmap-density":[_n,[],c=>c.globals.heatmapDensity||0],"line-progress":[_n,[],c=>c.globals.lineProgress||0],"raster-value":[_n,[],c=>c.globals.rasterValue||0],"raster-particle-speed":[_n,[],c=>c.globals.rasterParticleSpeed||0],"sky-radial-progress":[_n,[],c=>c.globals.skyRadialProgress||0],accumulated:[gr,[],c=>c.globals.accumulated===void 0?null:c.globals.accumulated],"+":[_n,Co(_n),(c,n)=>{let s=0;for(const u of n)s+=u.evaluate(c);return s}],"*":[_n,Co(_n),(c,n)=>{let s=1;for(const u of n)s*=u.evaluate(c);return s}],"-":{type:_n,overloads:[[[_n,_n],(c,[n,s])=>n.evaluate(c)-s.evaluate(c)],[[_n],(c,[n])=>-n.evaluate(c)]]},"/":[_n,[_n,_n],(c,[n,s])=>n.evaluate(c)/s.evaluate(c)],"%":[_n,[_n,_n],(c,[n,s])=>n.evaluate(c)%s.evaluate(c)],ln2:[_n,[],()=>Math.LN2],pi:[_n,[],()=>Math.PI],e:[_n,[],()=>Math.E],"^":[_n,[_n,_n],(c,[n,s])=>Math.pow(n.evaluate(c),s.evaluate(c))],sqrt:[_n,[_n],(c,[n])=>Math.sqrt(n.evaluate(c))],log10:[_n,[_n],(c,[n])=>Math.log(n.evaluate(c))/Math.LN10],ln:[_n,[_n],(c,[n])=>Math.log(n.evaluate(c))],log2:[_n,[_n],(c,[n])=>Math.log(n.evaluate(c))/Math.LN2],sin:[_n,[_n],(c,[n])=>Math.sin(n.evaluate(c))],cos:[_n,[_n],(c,[n])=>Math.cos(n.evaluate(c))],tan:[_n,[_n],(c,[n])=>Math.tan(n.evaluate(c))],asin:[_n,[_n],(c,[n])=>Math.asin(n.evaluate(c))],acos:[_n,[_n],(c,[n])=>Math.acos(n.evaluate(c))],atan:[_n,[_n],(c,[n])=>Math.atan(n.evaluate(c))],min:[_n,Co(_n),(c,n)=>Math.min(...n.map(s=>s.evaluate(c)))],max:[_n,Co(_n),(c,n)=>Math.max(...n.map(s=>s.evaluate(c)))],abs:[_n,[_n],(c,[n])=>Math.abs(n.evaluate(c))],round:[_n,[_n],(c,[n])=>{const s=n.evaluate(c);return s<0?-Math.round(-s):Math.round(s)}],floor:[_n,[_n],(c,[n])=>Math.floor(n.evaluate(c))],ceil:[_n,[_n],(c,[n])=>Math.ceil(n.evaluate(c))],"filter-==":[ar,[xr,gr],(c,[n,s])=>c.properties()[n.value]===s.value],"filter-id-==":[ar,[gr],(c,[n])=>c.id()===n.value],"filter-type-==":[ar,[xr],(c,[n])=>c.geometryType()===n.value],"filter-<":[ar,[xr,gr],(c,[n,s])=>{const u=c.properties()[n.value],_=s.value;return typeof u==typeof _&&u<_}],"filter-id-<":[ar,[gr],(c,[n])=>{const s=c.id(),u=n.value;return typeof s==typeof u&&s<u}],"filter->":[ar,[xr,gr],(c,[n,s])=>{const u=c.properties()[n.value],_=s.value;return typeof u==typeof _&&u>_}],"filter-id->":[ar,[gr],(c,[n])=>{const s=c.id(),u=n.value;return typeof s==typeof u&&s>u}],"filter-<=":[ar,[xr,gr],(c,[n,s])=>{const u=c.properties()[n.value],_=s.value;return typeof u==typeof _&&u<=_}],"filter-id-<=":[ar,[gr],(c,[n])=>{const s=c.id(),u=n.value;return typeof s==typeof u&&s<=u}],"filter->=":[ar,[xr,gr],(c,[n,s])=>{const u=c.properties()[n.value],_=s.value;return typeof u==typeof _&&u>=_}],"filter-id->=":[ar,[gr],(c,[n])=>{const s=c.id(),u=n.value;return typeof s==typeof u&&s>=u}],"filter-has":[ar,[gr],(c,[n])=>n.value in c.properties()],"filter-has-id":[ar,[],c=>c.id()!==null&&c.id()!==void 0],"filter-type-in":[ar,[Wr(xr)],(c,[n])=>n.value.indexOf(c.geometryType())>=0],"filter-id-in":[ar,[Wr(gr)],(c,[n])=>n.value.indexOf(c.id())>=0],"filter-in-small":[ar,[xr,Wr(gr)],(c,[n,s])=>s.value.indexOf(c.properties()[n.value])>=0],"filter-in-large":[ar,[xr,Wr(gr)],(c,[n,s])=>function(u,_,d,v){for(;d<=v;){const E=d+v>>1;if(_[E]===u)return!0;_[E]>u?v=E-1:d=E+1}return!1}(c.properties()[n.value],s.value,0,s.value.length-1)],all:{type:ar,overloads:[[[ar,ar],(c,[n,s])=>n.evaluate(c)&&s.evaluate(c)],[Co(ar),(c,n)=>{for(const s of n)if(!s.evaluate(c))return!1;return!0}]]},any:{type:ar,overloads:[[[ar,ar],(c,[n,s])=>n.evaluate(c)||s.evaluate(c)],[Co(ar),(c,n)=>{for(const s of n)if(s.evaluate(c))return!0;return!1}]]},"!":[ar,[ar],(c,[n])=>!n.evaluate(c)],"is-supported-script":[ar,[xr],(c,[n])=>{const s=c.globals&&c.globals.isSupportedScript;return!s||s(n.evaluate(c))}],upcase:[xr,[xr],(c,[n])=>n.evaluate(c).toUpperCase()],downcase:[xr,[xr],(c,[n])=>n.evaluate(c).toLowerCase()],concat:[xr,Co(gr),(c,n)=>n.map(s=>hs(s.evaluate(c))).join("")],"resolved-locale":[xr,[dc],(c,[n])=>n.evaluate(c).resolvedLocale()],random:[_n,[_n,_n,gr],(c,n)=>{const[s,u,_]=n.map(v=>v.evaluate(c));if(s>u||s===u)return s;let d;if(typeof _=="string")d=function(v){let E=0;if(v.length===0)return E;for(let O=0;O<v.length;O++)E=(E<<5)-E+v.charCodeAt(O),E|=0;return E}(_);else{if(typeof _!="number")throw new Ii(`Invalid seed input: ${_}`);d=_}return s+Mc(d)()*(u-s)}]});class Ep{constructor(n,s,u,_){this.expression=n,this._warningHistory={},this._evaluator=new Om(u,_),this._defaultValue=s?function(d){return d.type==="color"&&(_s(d.default)||Array.isArray(d.default))?new _r(0,0,0,0):d.type==="color"?_r.parse(d.default)||null:d.default===void 0?null:d.default}(s):null,this._enumValues=s&&s.type==="enum"?s.values:null,this.configDependencies=fo(n)}evaluateWithoutErrorHandling(n,s,u,_,d,v,E,O){return this._evaluator.globals=n,this._evaluator.feature=s,this._evaluator.featureState=u,this._evaluator.canonical=_||null,this._evaluator.availableImages=d||null,this._evaluator.formattedSection=v,this._evaluator.featureTileCoord=E||null,this._evaluator.featureDistanceData=O||null,this.expression.evaluate(this._evaluator)}evaluate(n,s,u,_,d,v,E,O){this._evaluator.globals=n,this._evaluator.feature=s||null,this._evaluator.featureState=u||null,this._evaluator.canonical=_||null,this._evaluator.availableImages=d||null,this._evaluator.formattedSection=v||null,this._evaluator.featureTileCoord=E||null,this._evaluator.featureDistanceData=O||null;try{const z=this.expression.evaluate(this._evaluator);if(z==null||typeof z=="number"&&z!=z)return this._defaultValue;if(this._enumValues&&!(z in this._enumValues))throw new Ii(`Expected value to be one of ${Object.keys(this._enumValues).map(S=>JSON.stringify(S)).join(", ")}, but found ${JSON.stringify(z)} instead.`);return z}catch(z){return this._warningHistory[z.message]||(this._warningHistory[z.message]=!0,typeof console<"u"&&console.warn(`Failed to evaluate expression "${JSON.stringify(this.expression.serialize())}". ${z.message}`)),this._defaultValue}}}function Ih(c){return Array.isArray(c)&&c.length>0&&typeof c[0]=="string"&&c[0]in Nl}function Ri(c,n,s,u){const _=new Tc(Nl,[],n?function(v){const E={color:_a,string:xr,number:_n,enum:xr,boolean:ar,formatted:Vo,resolvedImage:_h};return v.type==="array"?Wr(E[v.value]||gr,v.length):E[v.type]}(n):void 0,void 0,void 0,s,u),d=_.parse(c,void 0,void 0,void 0,n&&n.type==="string"?{typeAnnotation:"coerce"}:void 0);return d?wp(new Ep(d,n,s,u)):za(_.errors)}class Rh{constructor(n,s,u,_){this.kind=n,this._styleExpression=s,this.isLightConstant=u,this.isLineProgressConstant=_,this.isStateDependent=n!=="constant"&&!Sh(s.expression),this.configDependencies=fo(s.expression)}evaluateWithoutErrorHandling(n,s,u,_,d,v){return this._styleExpression.evaluateWithoutErrorHandling(n,s,u,_,d,v)}evaluate(n,s,u,_,d,v){return this._styleExpression.evaluate(n,s,u,_,d,v)}}class jl{constructor(n,s,u,_,d,v){this.kind=n,this.zoomStops=u,this._styleExpression=s,this.isStateDependent=n!=="camera"&&!Sh(s.expression),this.isLightConstant=d,this.isLineProgressConstant=v,this.configDependencies=fo(s.expression),this.interpolationType=_}evaluateWithoutErrorHandling(n,s,u,_,d,v){return this._styleExpression.evaluateWithoutErrorHandling(n,s,u,_,d,v)}evaluate(n,s,u,_,d,v){return this._styleExpression.evaluate(n,s,u,_,d,v)}interpolationFactor(n,s,u){return this.interpolationType?li.interpolationFactor(this.interpolationType,n,s,u):0}}function Dh(c,n,s,u){if((c=Ri(c,n,s,u)).result==="error")return c;const _=c.value.expression,d=bu(_);if(!d&&!Oh(n))return za([new Kn("","data expressions not supported")]);const v=ka(_,["zoom","pitch","distance-from-center"]);if(!v&&!Ph(n))return za([new Kn("","zoom expressions not supported")]);const E=ka(_,["measure-light"]);if(!E&&!Sp(n))return za([new Kn("","measure-light expression not supported")]);const O=ka(_,["line-progress"]);if(!O&&!function(P){return Pu(P.expression,"line-progress")}(n))return za([new Kn("","line-progress expression not supported")]);const z=n.expression&&n.expression.relaxZoomRestriction,S=ll(_);return S||v||z?S instanceof Kn?za([S]):S instanceof li&&!eo(n)?za([new Kn("",'"interpolate" expressions cannot be used with this property')]):wp(S?new jl(d&&O?"camera":"composite",c.value,S.labels,S instanceof li?S.interpolation:void 0,E,O):new Rh(d&&O?"constant":"source",c.value,E,O)):za([new Kn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression, or in the properties of atmosphere.')])}class Iu{constructor(n,s){this._parameters=n,this._specification=s,Lf(this,Tp(this._parameters,this._specification))}static deserialize(n){return new Iu(n._parameters,n._specification)}static serialize(n){return{_parameters:n._parameters,_specification:n._specification}}}function ll(c){let n=null;if(c instanceof Ao)n=ll(c.result);else if(c instanceof Ur){for(const s of c.args)if(n=ll(s),n)break}else(c instanceof $o||c instanceof li)&&c.input instanceof ho&&c.input.name==="zoom"&&(n=c);return n instanceof Kn||c.eachChild(s=>{const u=ll(s);u instanceof Kn?n=u:n&&u&&n!==u&&(n=new Kn("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),n}var Pc,f_,d_=function(){if(f_)return Pc;f_=1,Pc=n;var c=3;function n(s,u,_){var d=this.cells=[];if(s instanceof ArrayBuffer){this.arrayBuffer=s;var v=new Int32Array(this.arrayBuffer);s=v[0],this.d=(u=v[1])+2*(_=v[2]);for(var E=0;E<this.d*this.d;E++){var O=v[c+E],z=v[c+E+1];d.push(O===z?null:v.subarray(O,z))}var S=v[c+d.length+1];this.keys=v.subarray(v[c+d.length],S),this.bboxes=v.subarray(S),this.insert=this._insertReadonly}else{this.d=u+2*_;for(var P=0;P<this.d*this.d;P++)d.push([]);this.keys=[],this.bboxes=[]}this.n=u,this.extent=s,this.padding=_,this.scale=u/s,this.uid=0;var L=_/u*s;this.min=-L,this.max=s+L}return n.prototype.insert=function(s,u,_,d,v){this._forEachCell(u,_,d,v,this._insertCell,this.uid++),this.keys.push(s),this.bboxes.push(u),this.bboxes.push(_),this.bboxes.push(d),this.bboxes.push(v)},n.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},n.prototype._insertCell=function(s,u,_,d,v,E){this.cells[v].push(E)},n.prototype.query=function(s,u,_,d,v){var E=this.min,O=this.max;if(s<=E&&u<=E&&O<=_&&O<=d&&!v)return Array.prototype.slice.call(this.keys);var z=[];return this._forEachCell(s,u,_,d,this._queryCell,z,{},v),z},n.prototype._queryCell=function(s,u,_,d,v,E,O,z){var S=this.cells[v];if(S!==null)for(var P=this.keys,L=this.bboxes,M=0;M<S.length;M++){var R=S[M];if(O[R]===void 0){var B=4*R;(z?z(L[B+0],L[B+1],L[B+2],L[B+3]):s<=L[B+2]&&u<=L[B+3]&&_>=L[B+0]&&d>=L[B+1])?(O[R]=!0,E.push(P[R])):O[R]=!1}}},n.prototype._forEachCell=function(s,u,_,d,v,E,O,z){for(var S=this._convertToCellCoord(s),P=this._convertToCellCoord(u),L=this._convertToCellCoord(_),M=this._convertToCellCoord(d),R=S;R<=L;R++)for(var B=P;B<=M;B++){var q=this.d*B+R;if((!z||z(this._convertFromCellCoord(R),this._convertFromCellCoord(B),this._convertFromCellCoord(R+1),this._convertFromCellCoord(B+1)))&&v.call(this,s,u,_,d,q,E,O,z))return}},n.prototype._convertFromCellCoord=function(s){return(s-this.padding)/this.scale},n.prototype._convertToCellCoord=function(s){return Math.max(0,Math.min(this.d-1,Math.floor(s*this.scale)+this.padding))},n.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var s=this.cells,u=c+this.cells.length+1+1,_=0,d=0;d<this.cells.length;d++)_+=this.cells[d].length;var v=new Int32Array(u+_+this.keys.length+this.bboxes.length);v[0]=this.extent,v[1]=this.n,v[2]=this.padding;for(var E=u,O=0;O<s.length;O++){var z=s[O];v[c+O]=E,v.set(z,E),E+=z.length}return v[c+s.length]=E,v.set(this.keys,E),v[c+s.length+1]=E+=this.keys.length,v.set(this.bboxes,E),E+=this.bboxes.length,v.buffer},Pc}(),Ru=C(d_);const Jf={};function hn(c,n,s={}){Object.defineProperty(c,"_classRegistryKey",{value:n,writable:!1}),Jf[n]={klass:c,omit:s.omit||[]}}hn(Object,"Object"),Ru.serialize=function(c,n){const s=c.toArrayBuffer();return n&&n.add(s),{buffer:s}},Ru.deserialize=function(c){return new Ru(c.buffer)},Object.defineProperty(Ru,"name",{value:"Grid"}),hn(Ru,"Grid"),typeof DOMMatrix<"u"&&hn(DOMMatrix,"DOMMatrix"),hn(_r,"Color"),hn(Error,"Error"),hn(ia,"Formatted"),hn(Rl,"FormattedSection"),hn(Pi,"AJAXError"),hn(Da,"ResolvedImage"),hn(Iu,"StylePropertyFunction"),hn(Ep,"StyleExpression",{omit:["_evaluator"]}),hn(Bs,"ImageIdWithOptions"),hn(jl,"ZoomDependentExpression"),hn(Rh,"ZoomConstantExpression"),hn(ho,"CompoundExpression",{omit:["_evaluate"]});for(const c in Nl)Jf[Nl[c]._classRegistryKey]||hn(Nl[c],`Expression${c}`);function Qf(c){return c&&typeof ArrayBuffer<"u"&&(c instanceof ArrayBuffer||c.constructor&&c.constructor.name==="ArrayBuffer")}function Lh(c){return self.ImageBitmap&&c instanceof ImageBitmap}function Ul(c,n){if(c==null||typeof c=="boolean"||typeof c=="number"||typeof c=="string"||c instanceof Boolean||c instanceof Number||c instanceof String||c instanceof Date||c instanceof RegExp)return c;if(Qf(c)||Lh(c))return n&&n.add(c),c;if(ArrayBuffer.isView(c))return n&&n.add(c.buffer),c;if(c instanceof ImageData)return n&&n.add(c.data.buffer),c;if(Array.isArray(c)){const s=[];for(const u of c)s.push(Ul(u,n));return s}if(c instanceof Map){const s={$name:"Map"};for(const[u,_]of c.entries())s[u]=Ul(_);return s}if(c instanceof Set){const s={$name:"Set"};let u=0;for(const _ of c.values())s[++u]=Ul(_);return s}if(typeof c=="object"){const s=c.constructor,u=s._classRegistryKey;if(!u)throw new Error(`Can't serialize object of unregistered class "${u}".`);const _=s.serialize?s.serialize(c,n):{};if(!s.serialize){for(const d in c)c.hasOwnProperty(d)&&(Jf[u].omit.indexOf(d)>=0||(_[d]=Ul(c[d],n)));c instanceof Error&&(_.message=c.message)}if(_.$name)throw new Error("$name property is reserved for worker serialization logic.");return u!=="Object"&&(_.$name=u),_}throw new Error("can't serialize object of type "+typeof c)}function Mo(c){if(c==null||typeof c=="boolean"||typeof c=="number"||typeof c=="string"||c instanceof Boolean||c instanceof Number||c instanceof String||c instanceof Date||c instanceof RegExp||Qf(c)||Lh(c)||ArrayBuffer.isView(c)||c instanceof ImageData)return c;if(Array.isArray(c))return c.map(Mo);if(typeof c=="object"){const n=c.$name||"Object";if(n==="Map"){const _=new Map;for(const d of Object.keys(c))d!=="$name"&&_.set(d,Mo(c[d]));return _}if(n==="Set"){const _=new Set;for(const d of Object.keys(c))d!=="$name"&&_.add(Mo(c[d]));return _}const{klass:s}=Jf[n];if(!s)throw new Error(`Can't deserialize unregistered class "${n}".`);if(s.deserialize)return s.deserialize(c);const u=Object.create(s.prototype);for(const _ of Object.keys(c))_!=="$name"&&(u[_]=Mo(c[_]));return u}throw new Error("can't deserialize object of type "+typeof c)}const Yt={"Latin-1 Supplement":c=>c>=128&&c<=255,Arabic:c=>c>=1536&&c<=1791,"Arabic Supplement":c=>c>=1872&&c<=1919,"Arabic Extended-A":c=>c>=2208&&c<=2303,"Hangul Jamo":c=>c>=4352&&c<=4607,"Unified Canadian Aboriginal Syllabics":c=>c>=5120&&c<=5759,Khmer:c=>c>=6016&&c<=6143,"Unified Canadian Aboriginal Syllabics Extended":c=>c>=6320&&c<=6399,"General Punctuation":c=>c>=8192&&c<=8303,"Letterlike Symbols":c=>c>=8448&&c<=8527,"Number Forms":c=>c>=8528&&c<=8591,"Miscellaneous Technical":c=>c>=8960&&c<=9215,"Control Pictures":c=>c>=9216&&c<=9279,"Optical Character Recognition":c=>c>=9280&&c<=9311,"Enclosed Alphanumerics":c=>c>=9312&&c<=9471,"Geometric Shapes":c=>c>=9632&&c<=9727,"Miscellaneous Symbols":c=>c>=9728&&c<=9983,"Miscellaneous Symbols and Arrows":c=>c>=11008&&c<=11263,"CJK Radicals Supplement":c=>c>=11904&&c<=12031,"Kangxi Radicals":c=>c>=12032&&c<=12255,"Ideographic Description Characters":c=>c>=12272&&c<=12287,"CJK Symbols and Punctuation":c=>c>=12288&&c<=12351,Hiragana:c=>c>=12352&&c<=12447,Katakana:c=>c>=12448&&c<=12543,Bopomofo:c=>c>=12544&&c<=12591,"Hangul Compatibility Jamo":c=>c>=12592&&c<=12687,Kanbun:c=>c>=12688&&c<=12703,"Bopomofo Extended":c=>c>=12704&&c<=12735,"CJK Strokes":c=>c>=12736&&c<=12783,"Katakana Phonetic Extensions":c=>c>=12784&&c<=12799,"Enclosed CJK Letters and Months":c=>c>=12800&&c<=13055,"CJK Compatibility":c=>c>=13056&&c<=13311,"CJK Unified Ideographs Extension A":c=>c>=13312&&c<=19903,"Yijing Hexagram Symbols":c=>c>=19904&&c<=19967,"CJK Unified Ideographs":c=>c>=19968&&c<=40959,"Yi Syllables":c=>c>=40960&&c<=42127,"Yi Radicals":c=>c>=42128&&c<=42191,"Hangul Jamo Extended-A":c=>c>=43360&&c<=43391,"Hangul Syllables":c=>c>=44032&&c<=55215,"Hangul Jamo Extended-B":c=>c>=55216&&c<=55295,"Private Use Area":c=>c>=57344&&c<=63743,"CJK Compatibility Ideographs":c=>c>=63744&&c<=64255,"Arabic Presentation Forms-A":c=>c>=64336&&c<=65023,"Vertical Forms":c=>c>=65040&&c<=65055,"CJK Compatibility Forms":c=>c>=65072&&c<=65103,"Small Form Variants":c=>c>=65104&&c<=65135,"Arabic Presentation Forms-B":c=>c>=65136&&c<=65279,"Halfwidth and Fullwidth Forms":c=>c>=65280&&c<=65519,Osage:c=>c>=66736&&c<=66815,"CJK Unified Ideographs Extension B":c=>c>=131072&&c<=173791};function ti(c){for(const n of c)if(Vl(n.charCodeAt(0)))return!0;return!1}function oa(c){for(const n of c)if(!Ap(n.charCodeAt(0)))return!1;return!0}function Ap(c){return!(Yt.Arabic(c)||Yt["Arabic Supplement"](c)||Yt["Arabic Extended-A"](c)||Yt["Arabic Presentation Forms-A"](c)||Yt["Arabic Presentation Forms-B"](c))}function Vl(c){return!(c!==746&&c!==747&&(c<4352||!(Yt["Bopomofo Extended"](c)||Yt.Bopomofo(c)||Yt["CJK Compatibility Forms"](c)&&!(c>=65097&&c<=65103)||Yt["CJK Compatibility Ideographs"](c)||Yt["CJK Compatibility"](c)||Yt["CJK Radicals Supplement"](c)||Yt["CJK Strokes"](c)||!(!Yt["CJK Symbols and Punctuation"](c)||c>=12296&&c<=12305||c>=12308&&c<=12319||c===12336)||Yt["CJK Unified Ideographs Extension A"](c)||Yt["CJK Unified Ideographs"](c)||Yt["Enclosed CJK Letters and Months"](c)||Yt["Hangul Compatibility Jamo"](c)||Yt["Hangul Jamo Extended-A"](c)||Yt["Hangul Jamo Extended-B"](c)||Yt["Hangul Jamo"](c)||Yt["Hangul Syllables"](c)||Yt.Hiragana(c)||Yt["Ideographic Description Characters"](c)||Yt.Kanbun(c)||Yt["Kangxi Radicals"](c)||Yt["Katakana Phonetic Extensions"](c)||Yt.Katakana(c)&&c!==12540||!(!Yt["Halfwidth and Fullwidth Forms"](c)||c===65288||c===65289||c===65293||c>=65306&&c<=65310||c===65339||c===65341||c===65343||c>=65371&&c<=65503||c===65507||c>=65512&&c<=65519)||!(!Yt["Small Form Variants"](c)||c>=65112&&c<=65118||c>=65123&&c<=65126)||Yt["Unified Canadian Aboriginal Syllabics"](c)||Yt["Unified Canadian Aboriginal Syllabics Extended"](c)||Yt["Vertical Forms"](c)||Yt["Yijing Hexagram Symbols"](c)||Yt["Yi Syllables"](c)||Yt["Yi Radicals"](c))))}function $l(c){return!(Vl(c)||function(n){return!!(Yt["Latin-1 Supplement"](n)&&(n===167||n===169||n===174||n===177||n===188||n===189||n===190||n===215||n===247)||Yt["General Punctuation"](n)&&(n===8214||n===8224||n===8225||n===8240||n===8241||n===8251||n===8252||n===8258||n===8263||n===8264||n===8265||n===8273)||Yt["Letterlike Symbols"](n)||Yt["Number Forms"](n)||Yt["Miscellaneous Technical"](n)&&(n>=8960&&n<=8967||n>=8972&&n<=8991||n>=8996&&n<=9e3||n===9003||n>=9085&&n<=9114||n>=9150&&n<=9165||n===9167||n>=9169&&n<=9179||n>=9186&&n<=9215)||Yt["Control Pictures"](n)&&n!==9251||Yt["Optical Character Recognition"](n)||Yt["Enclosed Alphanumerics"](n)||Yt["Geometric Shapes"](n)||Yt["Miscellaneous Symbols"](n)&&!(n>=9754&&n<=9759)||Yt["Miscellaneous Symbols and Arrows"](n)&&(n>=11026&&n<=11055||n>=11088&&n<=11097||n>=11192&&n<=11243)||Yt["CJK Symbols and Punctuation"](n)||Yt.Katakana(n)||Yt["Private Use Area"](n)||Yt["CJK Compatibility Forms"](n)||Yt["Small Form Variants"](n)||Yt["Halfwidth and Fullwidth Forms"](n)||n===8734||n===8756||n===8757||n>=9984&&n<=10087||n>=10102&&n<=10131||n===65532||n===65533)}(c))}function kh(c){return c>=1424&&c<=2303||Yt["Arabic Presentation Forms-A"](c)||Yt["Arabic Presentation Forms-B"](c)}function zh(c,n){return!(!n&&kh(c)||c>=2304&&c<=3583||c>=3840&&c<=4255||Yt.Khmer(c))}function Ic(c){for(const n of c)if(kh(n.charCodeAt(0)))return!0;return!1}const ed="deferred",Di="loading",td="loaded";let gs=null,po="unavailable",ql=null;const Um=function(c){c&&typeof c=="string"&&c.indexOf("NetworkError")>-1&&(po="error"),gs&&gs(c)};function nd(){Rc.fire(new ks("pluginStateChange",{pluginStatus:po,pluginURL:ql}))}const Rc=new Pl,Bh=function(){return po},Ba=function(){if(po!==ed||!ql)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");po=Di,nd(),ql&&ii({url:ql},c=>{c?Um(c):(po=td,nd())})},Yr={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>po===td||Yr.applyArabicShaping!=null,isLoading:()=>po===Di,setState(c){po=c.pluginStatus,ql=c.pluginURL},isParsed:()=>Yr.applyArabicShaping!=null&&Yr.processBidirectionalText!=null&&Yr.processStyledBidirectionalText!=null,getPluginURL:()=>ql};class zr{constructor(n,s){this.zoom=n,s?(this.now=s.now,this.fadeDuration=s.fadeDuration,this.transition=s.transition,this.pitch=s.pitch,this.brightness=s.brightness):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0,this.brightness=0)}isSupportedScript(n){return function(s,u){for(const _ of s)if(!zh(_.charCodeAt(0),u))return!1;return!0}(n,Yr.isLoaded())}}class Dc{constructor(n,s,u,_){this.property=n,this.value=s,this.expression=function(d,v,E,O){if(_s(d))return new Iu(d,v);if(Ih(d)||Array.isArray(d)&&d.length>0){const z=Dh(d,v,E,O);if(z.result==="error")throw new Error(z.value.map(S=>`${S.key}: ${S.message}`).join(", "));return z.value}{let z=d;return typeof d=="string"&&v.type==="color"&&(z=_r.parse(d)),{kind:"constant",configDependencies:new Set,evaluate:()=>z}}}(s===void 0?n.specification.default:s,n.specification,u,_)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(n,s,u){return this.property.possiblyEvaluate(this,n,s,u)}}class Lc{constructor(n,s,u){this.property=n,this.value=new Dc(n,void 0,s,u)}transitioned(n,s){return new Vs(this.property,this.value,s,fa({},n.transition,this.transition),n.now)}untransitioned(){return new Vs(this.property,this.value,null,{},0)}}class Nh{constructor(n,s,u){this._properties=n,this._values=Object.create(n.defaultTransitionablePropertyValues),this._scope=s,this._options=u,this.configDependencies=new Set}getValue(n){return ra(this._values[n].value.value)}setValue(n,s){this._values.hasOwnProperty(n)||(this._values[n]=new Lc(this._values[n].property,this._scope,this._options)),this._values[n].value=new Dc(this._values[n].property,s===null?void 0:ra(s),this._scope,this._options),this._values[n].value.expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[n].value.expression.configDependencies]))}setTransitionOrValue(n,s){s&&(this._options=s);const u=this._properties.properties;if(n)for(const _ in n){const d=n[_];if(da(_,"-transition")){const v=_.slice(0,-11);u[v]&&this.setTransition(v,d)}else u.hasOwnProperty(_)&&this.setValue(_,d)}}getTransition(n){return ra(this._values[n].transition)}setTransition(n,s){this._values.hasOwnProperty(n)||(this._values[n]=new Lc(this._values[n].property)),this._values[n].transition=ra(s)||void 0}serialize(){const n={};for(const s of Object.keys(this._values)){const u=this.getValue(s);u!==void 0&&(n[s]=u);const _=this.getTransition(s);_!==void 0&&(n[`${s}-transition`]=_)}return n}transitioned(n,s){const u=new kc(this._properties);for(const _ of Object.keys(this._values))u._values[_]=this._values[_].transitioned(n,s._values[_]);return u}untransitioned(){const n=new kc(this._properties);for(const s of Object.keys(this._values))n._values[s]=this._values[s].untransitioned();return n}}class Vs{constructor(n,s,u,_,d){const v=_.delay||0,E=_.duration||0;d=d||0,this.property=n,this.value=s,this.begin=d+v,this.end=this.begin+E,n.specification.transition&&(_.delay||_.duration)&&(this.prior=u)}possiblyEvaluate(n,s,u){const _=n.now||0,d=this.value.possiblyEvaluate(n,s,u),v=this.prior;if(v){if(_>this.end)return this.prior=null,d;if(this.value.isDataDriven())return this.prior=null,d;if(_<this.begin)return v.possiblyEvaluate(n,s,u);{const E=(_-this.begin)/(this.end-this.begin);return this.property.interpolate(v.possiblyEvaluate(n,s,u),d,Pa(E))}}return d}}class kc{constructor(n){this._properties=n,this._values=Object.create(n.defaultTransitioningPropertyValues)}possiblyEvaluate(n,s,u){const _=new Du(this._properties);for(const d of Object.keys(this._values))_._values[d]=this._values[d].possiblyEvaluate(n,s,u);return _}hasTransition(){for(const n of Object.keys(this._values))if(this._values[n].prior)return!0;return!1}}class zc{constructor(n,s,u){this._properties=n,this._values=Object.create(n.defaultPropertyValues),this._scope=s,this._options=u,this.configDependencies=new Set}getValue(n){return ra(this._values[n].value)}setValue(n,s){this._values[n]=new Dc(this._values[n].property,s===null?void 0:ra(s),this._scope,this._options),this._values[n].expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[n].expression.configDependencies]))}serialize(){const n={};for(const s of Object.keys(this._values)){const u=this.getValue(s);u!==void 0&&(n[s]=u)}return n}possiblyEvaluate(n,s,u){const _=new Du(this._properties);for(const d of Object.keys(this._values))_._values[d]=this._values[d].possiblyEvaluate(n,s,u);return _}}class Bc{constructor(n,s,u){this.property=n,this.value=s,this.parameters=u}isConstant(){return this.value.kind==="constant"}constantOr(n){return this.value.kind==="constant"?this.value.value:n}evaluate(n,s,u,_){return this.property.evaluate(this.value,this.parameters,n,s,u,_)}}class Du{constructor(n){this._properties=n,this._values=Object.create(n.defaultPossiblyEvaluatedValues)}get(n){return this._values[n]}}class qt{constructor(n){this.specification=n}possiblyEvaluate(n,s){return n.expression.evaluate(s)}interpolate(n,s,u){const _=Il[this.specification.type];return _?_(n,s,u):n}}class cn{constructor(n,s){this.specification=n,this.overrides=s}possiblyEvaluate(n,s,u,_){return new Bc(this,n.expression.kind==="constant"||n.expression.kind==="camera"?{kind:"constant",value:n.expression.evaluate(s,null,{},u,_)}:n.expression,s)}interpolate(n,s,u){if(n.value.kind!=="constant"||s.value.kind!=="constant")return n;if(n.value.value===void 0||s.value.value===void 0)return new Bc(this,{kind:"constant",value:void 0},n.parameters);const _=Il[this.specification.type];return _?new Bc(this,{kind:"constant",value:_(n.value.value,s.value.value,u)},n.parameters):n}evaluate(n,s,u,_,d,v){return n.kind==="constant"?n.value:n.evaluate(s,u,_,d,v)}}class Lu{constructor(n){this.specification=n}possiblyEvaluate(n,s,u,_){return!!n.expression.evaluate(s,null,{},u,_)}interpolate(){return!1}}class ni{constructor(n){this.properties=n,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const s=new zr(0,{});for(const u in n){const _=n[u];_.specification.overridable&&this.overridableProperties.push(u);const d=this.defaultPropertyValues[u]=new Dc(_,void 0),v=this.defaultTransitionablePropertyValues[u]=new Lc(_);this.defaultTransitioningPropertyValues[u]=v.untransitioned(),this.defaultPossiblyEvaluatedValues[u]=d.possiblyEvaluate(s)}}}hn(cn,"DataDrivenProperty"),hn(qt,"DataConstantProperty"),hn(Lu,"ColorRampProperty");var st=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"fragment":{"type":"boolean"},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360},"pitch":{"type":"number","default":0},"light":{"type":"light"},"lights":{"required":false,"type":"array","value":"light-3d"},"terrain":{"type":"terrain","optional":true},"fog":{"type":"fog"},"snow":{"type":"snow","experimental":true},"rain":{"type":"rain","experimental":true},"camera":{"type":"camera"},"color-theme":{"type":"colorTheme"},"indoor":{"type":"indoor","experimental":true},"imports":{"type":"array","value":"import"},"schema":{"type":"schema"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string","default":"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"},"models":{"type":"models"},"featuresets":{"experimental":true,"type":"featuresets"}},"featuresets":{"experimental":true,"*":{"type":"featureset"}},"featureset":{"experimental":true,"metadata":{"experimental":true,"type":"*"},"selectors":{"experimental":true,"type":"array","value":"selector"}},"selector":{"experimental":true,"layer":{"experimental":true,"type":"string","required":true},"properties":{"experimental":true,"type":"selectorProperty","required":false},"featureNamespace":{"experimental":true,"type":"string","required":false},"_uniqueFeatureID":{"experimental":true,"type":"boolean","private":true,"required":false}},"selectorProperty":{"experimental":true,"*":{"experimental":true,"type":"*"}},"model":{"type":"string","required":true},"import":{"id":{"type":"string","required":true},"url":{"type":"string","required":true},"config":{"type":"config"},"data":{"type":"$root"},"color-theme":{"type":"colorTheme","optional":true}},"config":{"*":{"type":"*"}},"schema":{"*":{"type":"option"}},"option":{"default":{"type":"*","property-type":"data-constant","expression":{},"required":true},"type":{"type":"enum","values":{"string":1,"number":1,"boolean":1,"color":1}},"array":{"type":"boolean"},"minValue":{"type":"number"},"maxValue":{"type":"number"},"stepValue":{"type":"number"},"values":{"type":"array","value":"*"},"metadata":{"type":"*"}},"models":{"*":{"type":"model"}},"light-3d":{"id":{"type":"string","required":true},"properties":{"type":"properties"},"type":{"type":"enum","values":{"ambient":{},"directional":{},"flat":{}}}},"properties":["properties_light_directional","properties_light_ambient","properties_light_flat"],"properties_light_directional":{"direction":{"type":"array","default":[210,30],"minimum":[0,0],"maximum":[360,90],"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"cast-shadows":{"type":"boolean","default":false,"property-type":"data-constant"},"shadow-quality":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"expression":{"parameters":["zoom"]},"experimental":true},"shadow-intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_ambient":{"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_flat":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_raster_array","source_geojson","source_video","source_image","source_model"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":1,"mapbox":1},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_array":{"experimental":true,"type":{"required":true,"type":"enum","values":{"raster-array":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"rasterLayers":{"type":"*"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":1}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"},"dynamic":{"type":"boolean","default":false}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":1}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":1}},"url":{"required":false,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_model":{"type":{"required":true,"type":"enum","values":{"model":1,"batched-model":1}},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"tiles":{"type":"array","value":"string"}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"raster-particle":{"experimental":true},"hillshade":{},"model":{"experimental":true},"background":{},"sky":{},"slot":{},"clip":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"slot":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_clip","layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_raster-particle","layout_hillshade","layout_background","layout_sky","layout_model"],"layout_background":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_model":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"model-id":{"type":"string","default":"","property-type":"data-driven","expression":{"parameters":["zoom","feature"]}}},"layout_clip":{"clip-layer-types":{"type":"array","value":"enum","values":{"model":1,"symbol":1},"default":[],"expression":{},"property-type":"data-constant"},"clip-layer-scope":{"type":"array","value":"string","default":[],"expression":{},"property-type":"data-constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"fill-elevation-reference":{"type":"enum","values":{"none":1,"hd-road-base":1,"hd-road-markup":1},"default":"none","experimental":true,"private":true,"expression":{},"property-type":"data-constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"circle-elevation-reference":{"type":"enum","values":{"none":1,"hd-road-markup":1},"default":"none","experimental":true,"expression":{},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","experimental":true,"default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":1,"round":1,"square":1},"default":"butt","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":1,"round":1,"miter":1,"none":1},"default":"miter","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-z-offset":{"type":"number","experimental":true,"default":0,"expression":{"parameters":["zoom","feature","line-progress"]},"property-type":"data-driven"},"line-elevation-reference":{"type":"enum","values":{"none":1,"sea":1,"ground":1,"hd-road-markup":1},"default":"none","experimental":true,"expression":{},"property-type":"data-constant"},"line-cross-slope":{"type":"number","experimental":true,"expression":{},"property-type":"constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"line-width-unit":{"type":"enum","values":{"pixels":1,"meters":1},"default":"pixels","experimental":true,"private":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":1,"line":1,"line-center":1},"default":"point","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":1,"viewport-y":1,"source":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-z-elevate":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-elevation-reference":{"type":"enum","values":{"sea":1,"ground":1,"hd-road-markup":1},"default":"ground","experimental":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-size-scale-range":{"type":"array","value":"number","length":2,"default":[0.8,2],"minimum":0.1,"maximum":10,"experimental":true,"private":true,"expression":{},"property-type":"data-constant"},"icon-text-fit":{"type":"enum","values":{"none":1,"width":1,"height":1,"both":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size-scale-range":{"type":"array","value":"number","length":2,"default":[0.8,2],"minimum":0.1,"maximum":10,"experimental":true,"private":true,"expression":{},"property-type":"data-constant"},"text-max-width":{"type":"number","default":10,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":1,"left":1,"center":1,"right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","default":0,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":1,"vertical":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":1,"uppercase":1,"lowercase":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster-particle":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_hillshade":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_raster":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_raster-particle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_clip":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_model":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":1,"!=":1,">":1,">=":1,"<":1,"<=":1,"in":1,"!in":1,"all":1,"any":1,"none":1,"has":1,"!has":1}},"geometry_type":{"type":"enum","values":{"Point":1,"LineString":1,"Polygon":1}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":1,"exponential":1,"interval":1,"categorical":1},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":1,"lab":1,"hcl":1},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vertical-range":{"type":"array","default":[0,0],"minimum":0,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}}},"snow":{"density":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],11,0,13,0.85],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"opacity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],11,0,13,0.3],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette-color":{"type":"color","property-type":"data-constant","default":"#ffffff","experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"center-thinning":{"type":"number","property-type":"data-constant","default":0.4,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"direction":{"type":"array","default":[0,50],"minimum":0,"maximum":360,"length":2,"value":"number","property-type":"data-constant","transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"flake-size":{"type":"number","property-type":"data-constant","default":0.71,"minimum":0,"maximum":5,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true}},"rain":{"density":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],11,0,13,0.5],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["measure-light","brightness"],0,"#03113d",0.3,"#a8adbc"],"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"opacity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["measure-light","brightness"],0,0.88,1,0.7],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],11,0,13,1],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["measure-light","brightness"],0,"#001736",0.3,"#464646"],"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"center-thinning":{"type":"number","property-type":"data-constant","default":0.57,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"direction":{"type":"array","default":[0,80],"minimum":0,"maximum":360,"length":2,"value":"number","property-type":"data-constant","transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"droplet-size":{"type":"array","default":[2.6,18.2],"minimum":0,"maximum":50,"length":2,"value":"number","property-type":"data-constant","transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"distortion-strength":{"type":"number","property-type":"data-constant","default":0.7,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true}},"camera":{"camera-projection":{"type":"enum","values":{"perspective":1,"orthographic":1},"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"default":"perspective","property-type":"data-constant"}},"colorTheme":{"data":{"type":"string","property-type":"data-constant","expression":{}}},"indoor":{"floorplanFeaturesetId":{"type":"string","experimental":true,"property-type":"data-constant","expression":{}},"buildingFeaturesetId":{"type":"string","experimental":true,"property-type":"data-constant","expression":{}}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":1,"equalEarth":1,"equirectangular":1,"lambertConformalConic":1,"mercator":1,"naturalEarth":1,"winkelTripel":1,"globe":1},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_raster-particle","paint_hillshade","paint_background","paint_sky","paint_model"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"fill-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-height-alignment":{"type":"enum","experimental":true,"values":{"terrain":1,"flat":1},"default":"flat","property-type":"data-constant"},"fill-extrusion-base-alignment":{"type":"enum","experimental":true,"values":{"terrain":1,"flat":1},"default":"terrain","property-type":"data-constant"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-wall-radius":{"property-type":"data-constant","type":"number","experimental":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-radius":{"property-type":"data-constant","type":"number","experimental":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-attenuation":{"property-type":"data-constant","type":"number","experimental":true,"default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-flood-light-color":{"property-type":"data-constant","type":"color","experimental":true,"default":"#ffffff","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-intensity":{"property-type":"data-constant","type":"number","experimental":true,"default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-wall-radius":{"property-type":"data-driven","type":"number","experimental":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-radius":{"property-type":"data-driven","type":"number","experimental":true,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-attenuation":{"property-type":"data-constant","type":"number","experimental":true,"default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-vertical-scale":{"property-type":"data-constant","type":"number","experimental":true,"default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-rounded-roof":{"property-type":"data-constant","type":"boolean","default":true,"experimental":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"fill-extrusion-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"fill-extrusion-line-width":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-cast-shadows":{"type":"boolean","default":true,"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light","line-progress"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"property-type":"constant"},"line-trim-fade-range":{"type":"array","value":"number","experimental":true,"length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-trim-color":{"type":"color","experimental":true,"default":"transparent","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-border-width":{"type":"number","private":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-border-color":{"type":"color","private":true,"default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-occlusion-opacity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"property-type":"data-constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"text-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-image-cross-fade":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"transition":true},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-color-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"symbol-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-value"]},"property-type":"color-ramp"},"raster-color-mix":{"type":"array","default":[0.2126,0.7152,0.0722,0],"length":4,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color-range":{"type":"array","length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":1,"nearest":1},"default":"linear","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"raster-array-band":{"type":"string","required":false,"experimental":true,"property-type":"data-constant"},"raster-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster-particle":{"raster-particle-array-band":{"type":"string","required":false,"property-type":"data-constant"},"raster-particle-count":{"type":"number","default":512,"minimum":1,"property-type":"data-constant"},"raster-particle-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-particle-speed"]},"property-type":"color-ramp"},"raster-particle-max-speed":{"type":"number","default":1,"minimum":1,"property-type":"data-constant"},"raster-particle-speed-factor":{"type":"number","default":0.2,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-particle-fade-opacity-factor":{"type":"number","default":0.98,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-particle-reset-rate-factor":{"type":"number","default":0.8,"minimum":0,"maximum":1,"property-type":"data-constant"},"raster-particle-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_background":{"background-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":[]},"experimental":true,"property-type":"data-constant"},"background-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":1,"atmosphere":1},"default":"atmosphere","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","default":10,"minimum":0,"maximum":100,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","value":"number","default":[0,0],"length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","default":90,"minimum":0,"maximum":180,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_model":{"model-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"property-type":"data-driven"},"model-rotation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-scale":{"type":"array","value":"number","length":3,"default":[1,1,1],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-translation":{"type":"array","value":"number","length":3,"default":[0,0,0],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-color":{"type":"color","default":"#ffffff","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light","zoom"]},"transition":true},"model-color-mix-intensity":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-type":{"type":"enum","values":{"common-3d":1,"location-indicator":1},"default":"common-3d","property-type":"data-constant"},"model-cast-shadows":{"type":"boolean","default":true,"property-type":"data-constant"},"model-receive-shadows":{"type":"boolean","default":true,"property-type":"data-constant"},"model-ambient-occlusion-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant","transition":true},"model-emissive-strength":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-roughness":{"type":"number","default":1,"minimum":0,"maximum":1,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state"]},"transition":true},"model-height-based-emissive-strength-multiplier":{"type":"array","default":[1,1,1,1,0],"length":5,"value":"number","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"model-front-cutoff":{"type":"array","private":true,"value":"number","property-type":"data-constant","expression":{"interpolated":true,"parameters":["zoom"]},"length":3,"default":[0,0,1],"minimum":[0,0,0],"maximum":[1,1,1]}},"transition":{"duration":{"type":"number","default":300,"minimum":0},"delay":{"type":"number","default":0,"minimum":0}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"*"}}}');function Cp(c){return c instanceof Number||c instanceof String||c instanceof Boolean?c.valueOf():c}function rd(c){if(Array.isArray(c))return c.map(rd);if(c instanceof Object&&!(c instanceof Number||c instanceof String||c instanceof Boolean)){const n={};for(const s in c)n[s]=rd(c[s]);return n}return Cp(c)}function Vm(c){if(c===!0||c===!1)return!0;if(!Array.isArray(c)||c.length===0)return!1;switch(c[0]){case"has":return c.length>=2&&c[1]!=="$id"&&c[1]!=="$type";case"in":return c.length>=3&&(typeof c[1]!="string"||Array.isArray(c[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return c.length!==3||Array.isArray(c[1])||Array.isArray(c[2]);case"any":case"all":for(const n of c.slice(1))if(!Vm(n)&&typeof n!="boolean")return!1;return!0;default:return!0}}function $m(c,n="",s=null,u="fill"){if(c==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};Vm(c)||(c=id(c));const _=c;let d=!0;try{d=function(S){if(!Nc(S))return S;let P=rd(S);return Gm(P),P=qm(P),P}(_)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(_,null,2)}
        `)}let v=null,E=null;if(u!=="background"&&u!=="sky"&&u!=="slot"){E=st[`filter_${u}`];const S=Ri(d,E,n,s);if(S.result==="error")throw new Error(S.value.map(P=>`${P.key}: ${P.message}`).join(", "));v=(P,L,M)=>S.value.evaluate(P,L,{},M)}let O=null,z=null;if(d!==_){const S=Ri(_,E,n,s);if(S.result==="error")throw new Error(S.value.map(P=>`${P.key}: ${P.message}`).join(", "));O=(P,L,M,R,B)=>S.value.evaluate(P,L,{},M,void 0,void 0,R,B),z=!bu(S.value.expression)}return{filter:v,dynamicFilter:O||void 0,needGeometry:Hm(d),needFeature:!!z}}function qm(c){if(!Array.isArray(c))return c;const n=function(s){if(p_.has(s[0])){for(let u=1;u<s.length;u++)if(Nc(s[u]))return!0}return s}(c);return n===!0?n:n.map(s=>qm(s))}function Gm(c){let n=!1;const s=[];if(c[0]==="case"){for(let u=1;u<c.length-1;u+=2)n=n||Nc(c[u]),s.push(c[u+1]);s.push(c[c.length-1])}else if(c[0]==="match"){n=n||Nc(c[1]);for(let u=2;u<c.length-1;u+=2)s.push(c[u+1]);s.push(c[c.length-1])}else if(c[0]==="step"){n=n||Nc(c[1]);for(let u=1;u<c.length-1;u+=2)s.push(c[u+1])}n&&(c.length=0,c.push("any",...s));for(let u=1;u<c.length;u++)Gm(c[u])}function Nc(c){if(!Array.isArray(c))return!1;if((n=c[0])==="pitch"||n==="distance-from-center")return!0;var n;for(let s=1;s<c.length;s++)if(Nc(c[s]))return!0;return!1}const p_=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function m_(c,n){return c<n?-1:c>n?1:0}function Hm(c){if(!Array.isArray(c))return!1;if(c[0]==="within"||c[0]==="distance")return!0;for(let n=1;n<c.length;n++)if(Hm(c[n]))return!0;return!1}function id(c){if(!c)return!0;const n=c[0];return c.length<=1?n!=="any":n==="=="?Gl(c[1],c[2],"=="):n==="!="?ys(Gl(c[1],c[2],"==")):n==="<"||n===">"||n==="<="||n===">="?Gl(c[1],c[2],n):n==="any"?(s=c.slice(1),["any"].concat(s.map(id))):n==="all"?["all"].concat(c.slice(1).map(id)):n==="none"?["all"].concat(c.slice(1).map(id).map(ys)):n==="in"?Zm(c[1],c.slice(2)):n==="!in"?ys(Zm(c[1],c.slice(2))):n==="has"?Mp(c[1]):n!=="!has"||ys(Mp(c[1]));var s}function Gl(c,n,s){switch(c){case"$type":return[`filter-type-${s}`,n];case"$id":return[`filter-id-${s}`,n];default:return[`filter-${s}`,c,n]}}function Zm(c,n){if(n.length===0)return!1;switch(c){case"$type":return["filter-type-in",["literal",n]];case"$id":return["filter-id-in",["literal",n]];default:return n.length>200&&!n.some(s=>typeof s!=typeof n[0])?["filter-in-large",c,["literal",n.sort(m_)]]:["filter-in-small",c,["literal",n]]}}function Mp(c){switch(c){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",c]}}function ys(c){return["!",c]}const ad="";function Ho(c,n){return n?`${c}${ad}${n}`:c}const vs="-transition",Wm=new Set(["fill","line","background","hillshade","raster"]);class $i extends Pl{constructor(n,s,u,_,d){if(super(),this.id=n.id,this.fqid=Ho(this.id,u),this.type=n.type,this.scope=u,this.lut=_,this.options=d,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,this.configDependencies=new Set,n.type!=="custom"){if(this.metadata=n.metadata,this.minzoom=n.minzoom,this.maxzoom=n.maxzoom,n.type&&n.type!=="background"&&n.type!=="sky"&&n.type!=="slot"){this.source=n.source,this.sourceLayer=n["source-layer"],this.filter=n.filter;const v=Ri(this.filter,st[`filter_${n.type}`]);v.result!=="error"&&(this.configDependencies=new Set([...this.configDependencies,...v.value.configDependencies]))}if(n.slot&&(this.slot=n.slot),s.layout&&(this._unevaluatedLayout=new zc(s.layout,this.scope,d),this.configDependencies=new Set([...this.configDependencies,...this._unevaluatedLayout.configDependencies])),s.paint){this._transitionablePaint=new Nh(s.paint,this.scope,d);for(const v in n.paint)this.setPaintProperty(v,n.paint[v]);for(const v in n.layout)this.setLayoutProperty(v,n.layout[v]);this.configDependencies=new Set([...this.configDependencies,...this._transitionablePaint.configDependencies]),this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Du(s.paint)}}}onAdd(n){}onRemove(n){}isDraped(n){return!this.is3D()&&Wm.has(this.type)}getLayoutProperty(n){return n==="visibility"?this.visibility:this._unevaluatedLayout.getValue(n)}setLayoutProperty(n,s){if(this.type==="custom"&&n==="visibility")return void(this.visibility=s);const u=this._unevaluatedLayout;u._properties.properties[n]&&(u.setValue(n,s),this.configDependencies=new Set([...this.configDependencies,...u.configDependencies]),n==="visibility"&&this.possiblyEvaluateVisibility())}possiblyEvaluateVisibility(){this._unevaluatedLayout._values.visibility&&(this.visibility=this._unevaluatedLayout._values.visibility.possiblyEvaluate({zoom:0}))}getPaintProperty(n){return da(n,vs)?this._transitionablePaint.getTransition(n.slice(0,-11)):this._transitionablePaint.getValue(n)}setPaintProperty(n,s){const u=this._transitionablePaint,_=u._properties.properties;if(da(n,vs)){const P=n.slice(0,-11);return _[P]&&u.setTransition(P,s||void 0),!1}if(!_[n])return!1;const d=u._values[n],v=d.value.isDataDriven(),E=d.value;u.setValue(n,s),this.configDependencies=new Set([...this.configDependencies,...u.configDependencies]),this._handleSpecialPaintPropertyUpdate(n);const O=u._values[n].value,z=O.isDataDriven(),S=da(n,"pattern")||n==="line-dasharray";return z||v||S||this._handleOverridablePaintPropertyUpdate(n,E,O)}_handleSpecialPaintPropertyUpdate(n){}getProgramIds(){return null}getDefaultProgramParams(n,s,u){return null}_handleOverridablePaintPropertyUpdate(n,s,u){return!1}isHidden(n){return!!(this.minzoom&&n<this.minzoom)||!!(this.maxzoom&&n>=this.maxzoom)||this.visibility==="none"}updateTransitions(n){this._transitioningPaint=this._transitionablePaint.transitioned(n,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(n,s){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(n,void 0,s)),this.paint=this._transitioningPaint.possiblyEvaluate(n,void 0,s)}serialize(){return fh({id:this.id,type:this.type,slot:this.slot,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()},(n,s)=>!(n===void 0||s==="layout"&&!Object.keys(n).length||s==="paint"&&!Object.keys(n).length))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}hasShadowPass(){return!1}canCastShadows(){return!1}hasLightBeamPass(){return!1}cutoffRange(){return 0}tileCoverLift(){return 0}resize(){}isStateDependent(){for(const n in this.paint._values){const s=this.paint.get(n);if(s instanceof Bc&&Oh(s.property.specification)&&(s.value.kind==="source"||s.value.kind==="composite")&&s.value.isStateDependent)return!0}return!1}compileFilter(n){this._filterCompiled||(this._featureFilter=$m(this.filter,this.scope,n),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}getLayerRenderingStats(){return this._stats}resetLayerRenderingStats(n){this._stats&&(n.renderPass==="shadow"?this._stats.numRenderedVerticesInShadowPass=0:this._stats.numRenderedVerticesInTransparentPass=0)}queryRadius(n){}queryIntersectsFeature(n,s,u,_,d,v,E,O,z){}}const __={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Fh{constructor(n,s){this._structArray=n,this._pos1=s*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class $r{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(n,s){return n._trim(),s&&(n.isTransferred=!0,s.add(n.arrayBuffer)),{length:n.length,arrayBuffer:n.arrayBuffer}}static deserialize(n){const s=Object.create(this.prototype);return s.arrayBuffer=n.arrayBuffer,s.length=n.length,s.capacity=n.arrayBuffer.byteLength/s.bytesPerElement,s._refreshViews(),s}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(n){this.reserve(n),this.length=n}reserve(n){if(n>this.capacity){this.capacity=Math.max(n,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const s=this.uint8;this._refreshViews(),s&&this.uint8.set(s)}}_refreshViews(){throw new Error("StructArray#_refreshViews() must be implemented by each concrete StructArray layout")}emplace(...n){throw new Error("StructArray#emplace() must be implemented by each concrete StructArray layout")}emplaceBack(...n){throw new Error("StructArray#emplaceBack() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function br(c,n=1){let s=0,u=0;return{members:c.map(_=>{const d=__[_.type].BYTES_PER_ELEMENT,v=s=Op(s,Math.max(n,d)),E=_.components||1;return u=Math.max(u,d),s+=d*E,{name:_.name,type:_.type,components:E,offset:v}}),size:Op(s,Math.max(u,n)),alignment:n}}function Op(c,n){return Math.ceil(c/n)*n}class cl extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s){const u=this.length;return this.resize(u+1),this.emplace(u,n,s)}emplace(n,s,u){const _=2*n;return this.int16[_+0]=s,this.int16[_+1]=u,n}}cl.prototype.bytesPerElement=4,hn(cl,"StructArrayLayout2i4");class ku extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s,u){const _=this.length;return this.resize(_+1),this.emplace(_,n,s,u)}emplace(n,s,u,_){const d=3*n;return this.int16[d+0]=s,this.int16[d+1]=u,this.int16[d+2]=_,n}}ku.prototype.bytesPerElement=6,hn(ku,"StructArrayLayout3i6");class $s extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s,u,_){const d=this.length;return this.resize(d+1),this.emplace(d,n,s,u,_)}emplace(n,s,u,_,d){const v=4*n;return this.int16[v+0]=s,this.int16[v+1]=u,this.int16[v+2]=_,this.int16[v+3]=d,n}}$s.prototype.bytesPerElement=8,hn($s,"StructArrayLayout4i8");class od extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s,u,_,d){const v=this.length;return this.resize(v+1),this.emplace(v,n,s,u,_,d)}emplace(n,s,u,_,d,v){const E=5*n;return this.int16[E+0]=s,this.int16[E+1]=u,this.int16[E+2]=_,this.int16[E+3]=d,this.int16[E+4]=v,n}}od.prototype.bytesPerElement=10,hn(od,"StructArrayLayout5i10");class jh extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,u,_,d,v,E){const O=this.length;return this.resize(O+1),this.emplace(O,n,s,u,_,d,v,E)}emplace(n,s,u,_,d,v,E,O){const z=6*n,S=12*n,P=3*n;return this.int16[z+0]=s,this.int16[z+1]=u,this.uint8[S+4]=_,this.uint8[S+5]=d,this.uint8[S+6]=v,this.uint8[S+7]=E,this.float32[P+2]=O,n}}jh.prototype.bytesPerElement=12,hn(jh,"StructArrayLayout2i4ub1f12");class ul extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,u){const _=this.length;return this.resize(_+1),this.emplace(_,n,s,u)}emplace(n,s,u,_){const d=3*n;return this.float32[d+0]=s,this.float32[d+1]=u,this.float32[d+2]=_,n}}ul.prototype.bytesPerElement=12,hn(ul,"StructArrayLayout3f12");class Sa extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,u,_,d){const v=this.length;return this.resize(v+1),this.emplace(v,n,s,u,_,d)}emplace(n,s,u,_,d,v){const E=6*n,O=3*n;return this.uint16[E+0]=s,this.uint16[E+1]=u,this.uint16[E+2]=_,this.uint16[E+3]=d,this.float32[O+2]=v,n}}Sa.prototype.bytesPerElement=12,hn(Sa,"StructArrayLayout4ui1f12");class sd extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,s,u,_){const d=this.length;return this.resize(d+1),this.emplace(d,n,s,u,_)}emplace(n,s,u,_,d){const v=4*n;return this.uint16[v+0]=s,this.uint16[v+1]=u,this.uint16[v+2]=_,this.uint16[v+3]=d,n}}sd.prototype.bytesPerElement=8,hn(sd,"StructArrayLayout4ui8");class Uh extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s,u,_,d,v){const E=this.length;return this.resize(E+1),this.emplace(E,n,s,u,_,d,v)}emplace(n,s,u,_,d,v,E){const O=6*n;return this.int16[O+0]=s,this.int16[O+1]=u,this.int16[O+2]=_,this.int16[O+3]=d,this.int16[O+4]=v,this.int16[O+5]=E,n}}Uh.prototype.bytesPerElement=12,hn(Uh,"StructArrayLayout6i12");class ld extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,s,u,_,d,v,E,O,z,S,P,L){const M=this.length;return this.resize(M+1),this.emplace(M,n,s,u,_,d,v,E,O,z,S,P,L)}emplace(n,s,u,_,d,v,E,O,z,S,P,L,M){const R=12*n;return this.int16[R+0]=s,this.int16[R+1]=u,this.int16[R+2]=_,this.int16[R+3]=d,this.uint16[R+4]=v,this.uint16[R+5]=E,this.uint16[R+6]=O,this.uint16[R+7]=z,this.int16[R+8]=S,this.int16[R+9]=P,this.int16[R+10]=L,this.int16[R+11]=M,n}}ld.prototype.bytesPerElement=24,hn(ld,"StructArrayLayout4i4ui4i24");class Pp extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,u,_,d,v){const E=this.length;return this.resize(E+1),this.emplace(E,n,s,u,_,d,v)}emplace(n,s,u,_,d,v,E){const O=10*n,z=5*n;return this.int16[O+0]=s,this.int16[O+1]=u,this.int16[O+2]=_,this.float32[z+2]=d,this.float32[z+3]=v,this.float32[z+4]=E,n}}Pp.prototype.bytesPerElement=20,hn(Pp,"StructArrayLayout3i3f20");class Fc extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,u,_){const d=this.length;return this.resize(d+1),this.emplace(d,n,s,u,_)}emplace(n,s,u,_,d){const v=4*n;return this.float32[v+0]=s,this.float32[v+1]=u,this.float32[v+2]=_,this.float32[v+3]=d,n}}Fc.prototype.bytesPerElement=16,hn(Fc,"StructArrayLayout4f16");class Xm extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(n){const s=this.length;return this.resize(s+1),this.emplace(s,n)}emplace(n,s){return this.uint32[1*n+0]=s,n}}Xm.prototype.bytesPerElement=4,hn(Xm,"StructArrayLayout1ul4");class jc extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,s){const u=this.length;return this.resize(u+1),this.emplace(u,n,s)}emplace(n,s,u){const _=2*n;return this.uint16[_+0]=s,this.uint16[_+1]=u,n}}jc.prototype.bytesPerElement=4,hn(jc,"StructArrayLayout2ui4");class Ip extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,s,u,_,d,v,E,O,z,S,P,L,M){const R=this.length;return this.resize(R+1),this.emplace(R,n,s,u,_,d,v,E,O,z,S,P,L,M)}emplace(n,s,u,_,d,v,E,O,z,S,P,L,M,R){const B=20*n,q=10*n;return this.int16[B+0]=s,this.int16[B+1]=u,this.int16[B+2]=_,this.int16[B+3]=d,this.int16[B+4]=v,this.float32[q+3]=E,this.float32[q+4]=O,this.float32[q+5]=z,this.float32[q+6]=S,this.int16[B+14]=P,this.uint32[q+8]=L,this.uint16[B+18]=M,this.uint16[B+19]=R,n}}Ip.prototype.bytesPerElement=40,hn(Ip,"StructArrayLayout5i4f1i1ul2ui40");class Uc extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s,u,_,d,v,E){const O=this.length;return this.resize(O+1),this.emplace(O,n,s,u,_,d,v,E)}emplace(n,s,u,_,d,v,E,O){const z=8*n;return this.int16[z+0]=s,this.int16[z+1]=u,this.int16[z+2]=_,this.int16[z+4]=d,this.int16[z+5]=v,this.int16[z+6]=E,this.int16[z+7]=O,n}}Uc.prototype.bytesPerElement=16,hn(Uc,"StructArrayLayout3i2i2i16");class cd extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s,u,_,d){const v=this.length;return this.resize(v+1),this.emplace(v,n,s,u,_,d)}emplace(n,s,u,_,d,v){const E=4*n,O=8*n;return this.float32[E+0]=s,this.float32[E+1]=u,this.float32[E+2]=_,this.int16[O+6]=d,this.int16[O+7]=v,n}}cd.prototype.bytesPerElement=16,hn(cd,"StructArrayLayout2f1f2i16");class Vh extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,u,_,d,v){const E=this.length;return this.resize(E+1),this.emplace(E,n,s,u,_,d,v)}emplace(n,s,u,_,d,v,E){const O=20*n,z=5*n;return this.uint8[O+0]=s,this.uint8[O+1]=u,this.float32[z+1]=_,this.float32[z+2]=d,this.float32[z+3]=v,this.float32[z+4]=E,n}}Vh.prototype.bytesPerElement=20,hn(Vh,"StructArrayLayout2ub4f20");class sa extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,s,u){const _=this.length;return this.resize(_+1),this.emplace(_,n,s,u)}emplace(n,s,u,_){const d=3*n;return this.uint16[d+0]=s,this.uint16[d+1]=u,this.uint16[d+2]=_,n}}sa.prototype.bytesPerElement=6,hn(sa,"StructArrayLayout3ui6");class Rp extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(n,s,u,_,d,v,E,O,z,S,P,L,M,R,B,q,H,ne,re,K,ie){const ce=this.length;return this.resize(ce+1),this.emplace(ce,n,s,u,_,d,v,E,O,z,S,P,L,M,R,B,q,H,ne,re,K,ie)}emplace(n,s,u,_,d,v,E,O,z,S,P,L,M,R,B,q,H,ne,re,K,ie,ce){const _e=30*n,Ce=15*n,Ae=60*n;return this.int16[_e+0]=s,this.int16[_e+1]=u,this.int16[_e+2]=_,this.float32[Ce+2]=d,this.float32[Ce+3]=v,this.uint16[_e+8]=E,this.uint16[_e+9]=O,this.uint32[Ce+5]=z,this.uint32[Ce+6]=S,this.uint32[Ce+7]=P,this.uint16[_e+16]=L,this.uint16[_e+17]=M,this.uint16[_e+18]=R,this.float32[Ce+10]=B,this.float32[Ce+11]=q,this.uint8[Ae+48]=H,this.uint8[Ae+49]=ne,this.uint8[Ae+50]=re,this.uint32[Ce+13]=K,this.int16[_e+28]=ie,this.uint8[Ae+58]=ce,n}}Rp.prototype.bytesPerElement=60,hn(Rp,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class xs extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(n,s,u,_,d,v,E,O,z,S,P,L,M,R,B,q,H,ne,re,K,ie,ce,_e,Ce,Ae,Ee,Ue,Oe,Ve,Ze,qe,Ke){const Qe=this.length;return this.resize(Qe+1),this.emplace(Qe,n,s,u,_,d,v,E,O,z,S,P,L,M,R,B,q,H,ne,re,K,ie,ce,_e,Ce,Ae,Ee,Ue,Oe,Ve,Ze,qe,Ke)}emplace(n,s,u,_,d,v,E,O,z,S,P,L,M,R,B,q,H,ne,re,K,ie,ce,_e,Ce,Ae,Ee,Ue,Oe,Ve,Ze,qe,Ke,Qe){const at=20*n,Je=40*n,wt=80*n;return this.float32[at+0]=s,this.float32[at+1]=u,this.int16[Je+4]=_,this.int16[Je+5]=d,this.int16[Je+6]=v,this.int16[Je+7]=E,this.int16[Je+8]=O,this.int16[Je+9]=z,this.int16[Je+10]=S,this.int16[Je+11]=P,this.int16[Je+12]=L,this.uint16[Je+13]=M,this.uint16[Je+14]=R,this.uint16[Je+15]=B,this.uint16[Je+16]=q,this.uint16[Je+17]=H,this.uint16[Je+18]=ne,this.uint16[Je+19]=re,this.uint16[Je+20]=K,this.uint16[Je+21]=ie,this.uint16[Je+22]=ce,this.uint16[Je+23]=_e,this.uint16[Je+24]=Ce,this.uint16[Je+25]=Ae,this.uint16[Je+26]=Ee,this.uint16[Je+27]=Ue,this.uint32[at+14]=Oe,this.float32[at+15]=Ve,this.float32[at+16]=Ze,this.float32[at+17]=qe,this.float32[at+18]=Ke,this.uint8[wt+76]=Qe,n}}xs.prototype.bytesPerElement=80,hn(xs,"StructArrayLayout2f9i15ui1ul4f1ub80");class qs extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n){const s=this.length;return this.resize(s+1),this.emplace(s,n)}emplace(n,s){return this.float32[1*n+0]=s,n}}qs.prototype.bytesPerElement=4,hn(qs,"StructArrayLayout1f4");class mo extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,u,_,d){const v=this.length;return this.resize(v+1),this.emplace(v,n,s,u,_,d)}emplace(n,s,u,_,d,v){const E=5*n;return this.float32[E+0]=s,this.float32[E+1]=u,this.float32[E+2]=_,this.float32[E+3]=d,this.float32[E+4]=v,n}}mo.prototype.bytesPerElement=20,hn(mo,"StructArrayLayout5f20");class hl extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,u,_,d,v,E){const O=this.length;return this.resize(O+1),this.emplace(O,n,s,u,_,d,v,E)}emplace(n,s,u,_,d,v,E,O){const z=7*n;return this.float32[z+0]=s,this.float32[z+1]=u,this.float32[z+2]=_,this.float32[z+3]=d,this.float32[z+4]=v,this.float32[z+5]=E,this.float32[z+6]=O,n}}hl.prototype.bytesPerElement=28,hn(hl,"StructArrayLayout7f28");class bs extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,u,_,d,v,E,O,z,S,P){const L=this.length;return this.resize(L+1),this.emplace(L,n,s,u,_,d,v,E,O,z,S,P)}emplace(n,s,u,_,d,v,E,O,z,S,P,L){const M=11*n;return this.float32[M+0]=s,this.float32[M+1]=u,this.float32[M+2]=_,this.float32[M+3]=d,this.float32[M+4]=v,this.float32[M+5]=E,this.float32[M+6]=O,this.float32[M+7]=z,this.float32[M+8]=S,this.float32[M+9]=P,this.float32[M+10]=L,n}}bs.prototype.bytesPerElement=44,hn(bs,"StructArrayLayout11f44");class $h extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,u,_,d,v,E,O,z){const S=this.length;return this.resize(S+1),this.emplace(S,n,s,u,_,d,v,E,O,z)}emplace(n,s,u,_,d,v,E,O,z,S){const P=9*n;return this.float32[P+0]=s,this.float32[P+1]=u,this.float32[P+2]=_,this.float32[P+3]=d,this.float32[P+4]=v,this.float32[P+5]=E,this.float32[P+6]=O,this.float32[P+7]=z,this.float32[P+8]=S,n}}$h.prototype.bytesPerElement=36,hn($h,"StructArrayLayout9f36");class zu extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s){const u=this.length;return this.resize(u+1),this.emplace(u,n,s)}emplace(n,s,u){const _=2*n;return this.float32[_+0]=s,this.float32[_+1]=u,n}}zu.prototype.bytesPerElement=8,hn(zu,"StructArrayLayout2f8");class Dp extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,s,u,_){const d=this.length;return this.resize(d+1),this.emplace(d,n,s,u,_)}emplace(n,s,u,_,d){const v=6*n;return this.uint32[3*n+0]=s,this.uint16[v+2]=u,this.uint16[v+3]=_,this.uint16[v+4]=d,n}}Dp.prototype.bytesPerElement=12,hn(Dp,"StructArrayLayout1ul3ui12");class Hl extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n){const s=this.length;return this.resize(s+1),this.emplace(s,n)}emplace(n,s){return this.uint16[1*n+0]=s,n}}Hl.prototype.bytesPerElement=2,hn(Hl,"StructArrayLayout1ui2");class Vc extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,u,_,d,v,E,O,z,S,P,L,M,R,B,q){const H=this.length;return this.resize(H+1),this.emplace(H,n,s,u,_,d,v,E,O,z,S,P,L,M,R,B,q)}emplace(n,s,u,_,d,v,E,O,z,S,P,L,M,R,B,q,H){const ne=16*n;return this.float32[ne+0]=s,this.float32[ne+1]=u,this.float32[ne+2]=_,this.float32[ne+3]=d,this.float32[ne+4]=v,this.float32[ne+5]=E,this.float32[ne+6]=O,this.float32[ne+7]=z,this.float32[ne+8]=S,this.float32[ne+9]=P,this.float32[ne+10]=L,this.float32[ne+11]=M,this.float32[ne+12]=R,this.float32[ne+13]=B,this.float32[ne+14]=q,this.float32[ne+15]=H,n}}Vc.prototype.bytesPerElement=64,hn(Vc,"StructArrayLayout16f64");class qh extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,u,_,d,v,E){const O=this.length;return this.resize(O+1),this.emplace(O,n,s,u,_,d,v,E)}emplace(n,s,u,_,d,v,E,O){const z=10*n,S=5*n;return this.uint16[z+0]=s,this.uint16[z+1]=u,this.uint16[z+2]=_,this.uint16[z+3]=d,this.float32[S+2]=v,this.float32[S+3]=E,this.float32[S+4]=O,n}}qh.prototype.bytesPerElement=20,hn(qh,"StructArrayLayout4ui3f20");class Lp extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n){const s=this.length;return this.resize(s+1),this.emplace(s,n)}emplace(n,s){return this.int16[1*n+0]=s,n}}Lp.prototype.bytesPerElement=2,hn(Lp,"StructArrayLayout1i2");class ud extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer)}emplaceBack(n){const s=this.length;return this.resize(s+1),this.emplace(s,n)}emplace(n,s){return this.uint8[1*n+0]=s,n}}ud.prototype.bytesPerElement=1,hn(ud,"StructArrayLayout1ub1");class hd extends Fh{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}hd.prototype.size=40;class kp extends Ip{get(n){return new hd(this,n)}}hn(kp,"CollisionBoxArray");class Bu extends Fh{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(n){this._structArray.uint8[this._pos1+49]=n}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(n){this._structArray.uint8[this._pos1+50]=n}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(n){this._structArray.uint32[this._pos4+13]=n}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(n){this._structArray.uint8[this._pos1+58]=n}}Bu.prototype.size=60;class Ym extends Rp{get(n){return new Bu(this,n)}}hn(Ym,"PlacedSymbolArray");class Km extends Fh{get tileAnchorX(){return this._structArray.float32[this._pos4+0]}get tileAnchorY(){return this._structArray.float32[this._pos4+1]}get projectedAnchorX(){return this._structArray.int16[this._pos2+4]}get projectedAnchorY(){return this._structArray.int16[this._pos2+5]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+6]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+7]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+11]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get key(){return this._structArray.uint16[this._pos2+13]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+14]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+15]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+17]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+19]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+21]}get featureIndex(){return this._structArray.uint16[this._pos2+22]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+23]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numIconVertices(){return this._structArray.uint16[this._pos2+25]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+26]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+27]}get crossTileID(){return this._structArray.uint32[this._pos4+14]}set crossTileID(n){this._structArray.uint32[this._pos4+14]=n}get textOffset0(){return this._structArray.float32[this._pos4+15]}get textOffset1(){return this._structArray.float32[this._pos4+16]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+17]}get zOffset(){return this._structArray.float32[this._pos4+18]}set zOffset(n){this._structArray.float32[this._pos4+18]=n}get hasIconTextFit(){return this._structArray.uint8[this._pos1+76]}}Km.prototype.size=80;class g_ extends xs{get(n){return new Km(this,n)}}hn(g_,"SymbolInstanceArray");class Jm extends qs{getoffsetX(n){return this.float32[1*n+0]}}hn(Jm,"GlyphOffsetArray");class Ta extends cl{getx(n){return this.int16[2*n+0]}gety(n){return this.int16[2*n+1]}}hn(Ta,"SymbolLineVertexArray");class Ji extends Fh{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}Ji.prototype.size=12;class Gh extends Dp{get(n){return new Ji(this,n)}}hn(Gh,"FeatureIndexArray");class _o extends jc{geta_centroid_pos0(n){return this.uint16[2*n+0]}geta_centroid_pos1(n){return this.uint16[2*n+1]}}hn(_o,"FillExtrusionCentroidArray");class Hh extends Fh{get a_join_normal_inside0(){return this._structArray.int16[this._pos2+0]}get a_join_normal_inside1(){return this._structArray.int16[this._pos2+1]}get a_join_normal_inside2(){return this._structArray.int16[this._pos2+2]}}Hh.prototype.size=6;class Qm extends ku{get(n){return new Hh(this,n)}}hn(Qm,"FillExtrusionWallArray");const y_=br([{name:"a_pos",components:2,type:"Int16"}],4),fd=br([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class ci{constructor(n=[]){this.segments=n}_prepareSegment(n,s,u,_){let d=this.segments[this.segments.length-1];return n>ci.MAX_VERTEX_ARRAY_LENGTH&&qn(`Max vertices per segment is ${ci.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${n}`),(!d||d.vertexLength+n>ci.MAX_VERTEX_ARRAY_LENGTH||d.sortKey!==_)&&(d={vertexOffset:s,primitiveOffset:u,vertexLength:0,primitiveLength:0},_!==void 0&&(d.sortKey=_),this.segments.push(d)),d}prepareSegment(n,s,u,_){return this._prepareSegment(n,s.length,u.length,_)}get(){return this.segments}destroy(){for(const n of this.segments)for(const s in n.vaos)n.vaos[s].destroy()}static simpleSegment(n,s,u,_){return new ci([{vertexOffset:n,primitiveOffset:s,vertexLength:u,primitiveLength:_,vaos:{},sortKey:0}])}}function dd(c,n){return 256*(c=Bn(Math.floor(c),0,255))+Bn(Math.floor(n),0,255)}ci.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,hn(ci,"SegmentVector");const v_=br([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),zp=br([{name:"a_dash",components:4,type:"Uint16"}]);class Nu{constructor(){this.ids=[],this.uniqueIds=[],this.positions=[],this.indexed=!1}add(n,s,u,_){this.ids.push(Bp(n)),this.positions.push(s,u,_)}eachPosition(n,s){const u=Bp(n);let _=0,d=this.ids.length-1;for(;_<d;){const v=_+d>>1;this.ids[v]>=u?d=v:_=v+1}for(;this.ids[_]===u;)s(this.positions[3*_],this.positions[3*_+1],this.positions[3*_+2]),_++}static serialize(n,s){const u=new Float64Array(n.ids),_=new Uint32Array(n.positions);return Fu(u,_,0,u.length-1),s&&(s.add(u.buffer),s.add(_.buffer)),{ids:u,positions:_}}static deserialize(n){const s=new Nu;let u;s.ids=n.ids,s.positions=n.positions;for(const _ of s.ids)_!==u&&s.uniqueIds.push(_),u=_;return s.indexed=!0,s}}function Bp(c){const n=+c;return!isNaN(n)&&Number.MIN_SAFE_INTEGER<=n&&n<=Number.MAX_SAFE_INTEGER?n:ls(String(c))}function Fu(c,n,s,u){for(;s<u;){const _=c[s+u>>1];let d=s-1,v=u+1;for(;;){do d++;while(c[d]<_);do v--;while(c[v]>_);if(d>=v)break;pd(c,d,v),pd(n,3*d,3*v),pd(n,3*d+1,3*v+1),pd(n,3*d+2,3*v+2)}v-s<u-v?(Fu(c,n,s,v),s=v+1):(Fu(c,n,v+1,u),u=v)}}function pd(c,n,s){const u=c[n];c[n]=c[s],c[s]=u}hn(Nu,"FeaturePositionMap");class ws{constructor(n){this.gl=n.gl,this.initialized=!1}fetchUniformLocation(n,s){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(n,s),this.initialized=!0),!!this.location}set(n,s,u){throw new Error("Uniform#set() must be implemented by each concrete Uniform")}}class ju extends ws{constructor(n){super(n),this.current=0}set(n,s,u){this.fetchUniformLocation(n,s)&&this.current!==u&&(this.current=u,this.gl.uniform1i(this.location,u))}}class pi extends ws{constructor(n){super(n),this.current=0}set(n,s,u){this.fetchUniformLocation(n,s)&&this.current!==u&&(this.current=u,this.gl.uniform1f(this.location,u))}}class Zo extends ws{constructor(n){super(n),this.current=[0,0]}set(n,s,u){this.fetchUniformLocation(n,s)&&(u[0]===this.current[0]&&u[1]===this.current[1]||(this.current=u,this.gl.uniform2f(this.location,u[0],u[1])))}}class $c extends ws{constructor(n){super(n),this.current=[0,0,0]}set(n,s,u){this.fetchUniformLocation(n,s)&&(u[0]===this.current[0]&&u[1]===this.current[1]&&u[2]===this.current[2]||(this.current=u,this.gl.uniform3f(this.location,u[0],u[1],u[2])))}}class Zh extends ws{constructor(n){super(n),this.current=[0,0,0,0]}set(n,s,u){this.fetchUniformLocation(n,s)&&(u[0]===this.current[0]&&u[1]===this.current[1]&&u[2]===this.current[2]&&u[3]===this.current[3]||(this.current=u,this.gl.uniform4f(this.location,u[0],u[1],u[2],u[3])))}}class fl extends ws{constructor(n){super(n),this.current=_r.transparent.toRenderColor(null)}set(n,s,u){this.fetchUniformLocation(n,s)&&(u.r===this.current.r&&u.g===this.current.g&&u.b===this.current.b&&u.a===this.current.a||(this.current=u,this.gl.uniform4f(this.location,u.r,u.g,u.b,u.a)))}}const Np=new Float32Array(16);class md extends ws{constructor(n){super(n),this.current=Np}set(n,s,u){if(this.fetchUniformLocation(n,s)){if(u[12]!==this.current[12]||u[0]!==this.current[0])return this.current=u,void this.gl.uniformMatrix4fv(this.location,!1,u);for(let _=1;_<16;_++)if(u[_]!==this.current[_]){this.current=u,this.gl.uniformMatrix4fv(this.location,!1,u);break}}}}const Fp=new Float32Array(9),e0=new Float32Array(4);class Zl extends ws{constructor(n){super(n),this.current=e0}set(n,s,u){if(this.fetchUniformLocation(n,s)){for(let _=0;_<4;_++)if(u[_]!==this.current[_]){this.current=u,this.gl.uniformMatrix2fv(this.location,!1,u);break}}}}function Gs(c){return[dd(255*c.r,255*c.g),dd(255*c.b,255*c.a)]}class Oo{constructor(n,s,u,_){this.value=n,this.uniformNames=s.map(d=>`u_${d}`),this.type=u,this.context=_}setUniform(n,s,u,_,d){const v=_.constantOr(this.value);s.set(n,d,v instanceof _r?v.toRenderColor(this.ignoreLut?null:this.context.lut):v)}getBinding(n,s){return this.type==="color"?new fl(n):new pi(n)}}class go{constructor(n,s){this.uniformNames=s.map(u=>`u_${u}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(n){this.pixelRatio=n.pixelRatio||1,this.pattern=n.tl.concat(n.br)}setUniform(n,s,u,_,d){const v=d==="u_pattern"||d==="u_dash"?this.pattern:d==="u_pixel_ratio"?this.pixelRatio:null;v&&s.set(n,d,v)}getBinding(n,s){return s==="u_pattern"||s==="u_dash"?new Zh(n):new pi(n)}}class Hs{constructor(n,s,u,_){this.expression=n,this.type=u,this.maxValue=0,this.paintVertexAttributes=s.map(d=>({name:`a_${d}`,type:"Float32",components:u==="color"?2:1,offset:0})),this.paintVertexArray=new _}populatePaintArray(n,s,u,_,d,v,E){const O=this.paintVertexArray.length,z=this.expression.kind==="composite"||this.expression.kind==="source"?this.expression.evaluate(new zr(0,{brightness:v}),s,{},d,_,E):this.expression.kind==="constant"&&this.expression.value;!this.lutExpression||this.lutExpression.kind!=="composite"&&this.lutExpression.kind!=="source"||(this.ignoreLut=this.lutExpression.evaluate(new zr(0,{brightness:v}),s,{},d,_,E)==="none"),this.paintVertexArray.resize(n),this._setPaintValue(O,n,z,this.context)}updatePaintArray(n,s,u,_,d,v,E){const O=this.expression.kind==="composite"||this.expression.kind==="source"?this.expression.evaluate({zoom:0,brightness:E},u,_,void 0,d):this.expression.kind==="constant"&&this.expression.value;!this.lutExpression||this.lutExpression.kind!=="composite"&&this.lutExpression.kind!=="source"||(this.ignoreLut=this.lutExpression.evaluate({zoom:0,brightness:E},u,_,void 0,d)==="none"),this._setPaintValue(n,s,O,this.context)}_setPaintValue(n,s,u,_){if(this.type==="color"){const d=Gs(u.toRenderColor(this.ignoreLut?null:_.lut));for(let v=n;v<s;v++)this.paintVertexArray.emplace(v,d[0],d[1])}else{for(let d=n;d<s;d++)this.paintVertexArray.emplace(d,u);this.maxValue=Math.max(this.maxValue,Math.abs(u))}}upload(n){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=n.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.lutExpression&&this.lutExpression.kind!=="constant"&&(this.lutExpression.isStateDependent||!this.lutExpression.isLightConstant)||this.expression.kind!=="constant"&&(this.expression.isStateDependent||!this.expression.isLightConstant)))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Wo{constructor(n,s,u,_,d,v){this.expression=n,this.uniformNames=s.map(E=>`u_${E}_t`),this.type=u,this.useIntegerZoom=_,this.context=d,this.maxValue=0,this.paintVertexAttributes=s.map(E=>({name:`a_${E}`,type:"Float32",components:u==="color"?4:2,offset:0})),this.paintVertexArray=new v}populatePaintArray(n,s,u,_,d,v,E){const O=this.expression.evaluate(new zr(this.context.zoom,{brightness:v}),s,{},d,_,E),z=this.expression.evaluate(new zr(this.context.zoom+1,{brightness:v}),s,{},d,_,E);!this.lutExpression||this.lutExpression.kind!=="composite"&&this.lutExpression.kind!=="source"||(this.ignoreLut=this.lutExpression.evaluate(new zr(this.context.zoom,{brightness:v}),s,{},d,_,E)==="none");const S=this.paintVertexArray.length;this.paintVertexArray.resize(n),this._setPaintValue(S,n,O,z,this.context)}updatePaintArray(n,s,u,_,d,v,E){const O=this.expression.evaluate({zoom:this.context.zoom,brightness:E},u,_,void 0,d),z=this.expression.evaluate({zoom:this.context.zoom+1,brightness:E},u,_,void 0,d);!this.lutExpression||this.lutExpression.kind!=="composite"&&this.lutExpression.kind!=="source"||(this.ignoreLut=this.lutExpression.evaluate({zoom:this.context.zoom,brightness:E},u,_,void 0,d)==="none"),this._setPaintValue(n,s,O,z,this.context)}_setPaintValue(n,s,u,_,d){if(this.type==="color"){const v=Gs(u.toRenderColor(this.ignoreLut?null:d.lut)),E=Gs(u.toRenderColor(this.ignoreLut?null:d.lut));for(let O=n;O<s;O++)this.paintVertexArray.emplace(O,v[0],v[1],E[0],E[1])}else{for(let v=n;v<s;v++)this.paintVertexArray.emplace(v,u,_);this.maxValue=Math.max(this.maxValue,Math.abs(u),Math.abs(_))}}upload(n){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=n.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(n,s,u,_,d){const v=this.useIntegerZoom?Math.floor(u.zoom):u.zoom,E=Bn(this.expression.interpolationFactor(v,this.context.zoom,this.context.zoom+1),0,1);s.set(n,d,E)}getBinding(n,s){return new pi(n)}}class Ss{constructor(n,s,u,_,d){this.expression=n,this.layerId=d,this.paintVertexAttributes=(u==="array"?zp:v_).members;for(let v=0;v<s.length;++v);this.paintVertexArray=new _}populatePaintArray(n,s,u,_){const d=this.paintVertexArray.length;this.paintVertexArray.resize(n),this._setPaintValues(d,n,s.patterns&&s.patterns[this.layerId],u)}updatePaintArray(n,s,u,_,d,v,E){this._setPaintValues(n,s,u.patterns&&u.patterns[this.layerId],v)}_setPaintValues(n,s,u,_){if(!_||!u)return;const d=_[u];if(!d)return;const{tl:v,br:E,pixelRatio:O}=d;for(let z=n;z<s;z++)this.paintVertexArray.emplace(z,v[0],v[1],E[0],E[1],O)}upload(n){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=n.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class dl{constructor(n,s,u=()=>!0){this.binders={},this._buffers=[],this.context=s;const _=[];for(const d in n.paint._values){const v=n.paint.get(d),E=n.paint.get(`${d}-use-theme`);if(d.endsWith("-use-theme")||!u(d)||!(v instanceof Bc&&Oh(v.property.specification)))continue;const O=jp(d,n.type),z=v.value,S=v.property.specification.type,P=!!v.property.useIntegerZoom,L=d==="line-dasharray"||d.endsWith("pattern"),M=d==="line-dasharray"&&n.layout.get("line-cap").value.kind!=="constant"||E&&E.value.kind!=="constant";if(z.kind!=="constant"||M)if(z.kind==="source"||M||L){const R=Up(d,S,"source");this.binders[d]=L?new Ss(z,O,S,R,n.id):new Hs(z,O,S,R),_.push(`/a_${d}`)}else{const R=Up(d,S,"composite");this.binders[d]=new Wo(z,O,S,P,s,R),_.push(`/z_${d}`)}else this.binders[d]=L?new go(z.value,O):new Oo(z.value,O,S,s),_.push(`/u_${d}`);E&&(this.binders[d].ignoreLut=E.constantOr("default")==="none",this.binders[d].lutExpression=E.value,this.binders[d].checkUseTheme=!0)}this.cacheKey=_.sort().join("")}getMaxValue(n){const s=this.binders[n];return s instanceof Hs||s instanceof Wo?s.maxValue:0}populatePaintArrays(n,s,u,_,d,v,E){for(const O in this.binders){const z=this.binders[O];z.context=this.context,z instanceof Hs||z instanceof Wo||z instanceof Ss?z.populatePaintArray(n,s,u,_,d,v,E):z.lutExpression&&z instanceof Oo&&z.lutExpression&&(z.lutExpression.kind==="composite"||z.lutExpression.kind==="source")&&(z.ignoreLut=z.lutExpression.evaluate(new zr(0,{brightness:v}),s,{},d,_,E)==="none")}}setConstantPatternPositions(n){for(const s in this.binders){const u=this.binders[s];u instanceof go&&u.setConstantPatternPositions(n)}}updatePaintArrays(n,s,u,_,d,v,E,O,z){let S=!1;const P=Object.keys(n),L=P.length!==0&&!O,M=L?P:s.uniqueIds;this.context.lut=d.lut;for(const R in this.binders){const B=this.binders[R];if(B.context=this.context,(B instanceof Hs||B instanceof Wo||B instanceof Ss)&&B.expression&&B.expression.kind&&B.expression.kind!=="constant"&&(B.expression.isStateDependent===!0||B.expression.isLightConstant===!1)){const q=d.paint.get(R);B.expression=q.value;for(const H of M){const ne=n[H.toString()];s.eachPosition(H,(re,K,ie)=>{const ce=_.feature(re);B.updatePaintArray(K,ie,ce,ne,v,E,z)})}if(!L)for(const H of u.uniqueIds){const ne=n[H.toString()];u.eachPosition(H,(re,K,ie)=>{const ce=_.feature(re);B.updatePaintArray(K,ie,ce,ne,v,E,z)})}S=!0}}return S}defines(){const n=[];for(const s in this.binders){const u=this.binders[s];(u instanceof Oo||u instanceof go)&&n.push(...u.uniformNames.map(_=>`#define HAS_UNIFORM_${_}`))}return n}getBinderAttributes(){const n=[];for(const s in this.binders){const u=this.binders[s];if(u instanceof Hs||u instanceof Wo||u instanceof Ss)for(let _=0;_<u.paintVertexAttributes.length;_++)n.push(u.paintVertexAttributes[_].name)}return n}getBinderUniforms(){const n=[];for(const s in this.binders){const u=this.binders[s];if(u instanceof Oo||u instanceof go||u instanceof Wo)for(const _ of u.uniformNames)n.push(_)}return n}getPaintVertexBuffers(){return this._buffers}getUniforms(n){const s=[];for(const u in this.binders){const _=this.binders[u];if(_ instanceof Oo||_ instanceof go||_ instanceof Wo)for(const d of _.uniformNames)s.push({name:d,property:u,binding:_.getBinding(n,d)})}return s}setUniforms(n,s,u,_,d){for(const{name:v,property:E,binding:O}of u){if(this.binders[E].checkUseTheme&&this.binders[E]instanceof Oo){const z=_.get(`${E}-use-theme`);z.isConstant()&&(this.binders[E].ignoreLut=z.constantOr("default")==="none")}this.binders[E].setUniform(n,O,d,_.get(E),v)}}updatePaintBuffers(){this._buffers=[];for(const n in this.binders){const s=this.binders[n];(s instanceof Hs||s instanceof Wo||s instanceof Ss)&&s.paintVertexBuffer&&this._buffers.push(s.paintVertexBuffer)}}upload(n){for(const s in this.binders){const u=this.binders[s];(u instanceof Hs||u instanceof Wo||u instanceof Ss)&&u.upload(n)}this.updatePaintBuffers()}destroy(){for(const n in this.binders){const s=this.binders[n];(s instanceof Hs||s instanceof Wo||s instanceof Ss)&&s.destroy()}}}class Po{constructor(n,s,u=()=>!0){this.programConfigurations={};for(const _ of n)this.programConfigurations[_.id]=new dl(_,s,u);this.needsUpload=!1,this._featureMap=new Nu,this._featureMapWithoutIds=new Nu,this._bufferOffset=0,this._idlessCounter=0}populatePaintArrays(n,s,u,_,d,v,E,O){for(const z in this.programConfigurations)this.programConfigurations[z].populatePaintArrays(n,s,_,d,v,E,O);s.id!==void 0?this._featureMap.add(s.id,u,this._bufferOffset,n):(this._featureMapWithoutIds.add(this._idlessCounter,u,this._bufferOffset,n),this._idlessCounter+=1),this._bufferOffset=n,this.needsUpload=!0}updatePaintArrays(n,s,u,_,d,v,E){for(const O of u)this.needsUpload=this.programConfigurations[O.id].updatePaintArrays(n,this._featureMap,this._featureMapWithoutIds,s,O,_,d,v,E||0)||this.needsUpload}get(n){return this.programConfigurations[n]}upload(n){if(this.needsUpload){for(const s in this.programConfigurations)this.programConfigurations[s].upload(n);this.needsUpload=!1}}destroy(){for(const n in this.programConfigurations)this.programConfigurations[n].destroy()}}const to={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-occlusion-opacity":["occlusion_opacity"],"icon-occlusion-opacity":["occlusion_opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-emissive-strength":["emissive_strength"],"icon-emissive-strength":["emissive_strength"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"symbol-z-offset":["z_offset"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function jp(c,n){return to[c]||[c.replace(`${n}-`,"").replace(/-/g,"_")]}const x_={"line-pattern":{source:Sa,composite:Sa},"fill-pattern":{source:Sa,composite:Sa},"fill-extrusion-pattern":{source:Sa,composite:Sa},"line-dasharray":{source:sd,composite:sd}},Zs={color:{source:zu,composite:Fc},number:{source:qs,composite:zu}};function Up(c,n,s){const u=x_[c];return u&&u[s]||Zs[n][s]}hn(Oo,"ConstantBinder"),hn(go,"PatternConstantBinder"),hn(Hs,"SourceExpressionBinder"),hn(Ss,"PatternCompositeBinder"),hn(Wo,"CompositeExpressionBinder"),hn(dl,"ProgramConfiguration",{omit:["_buffers"]}),hn(Po,"ProgramConfigurationSet");const Na=Kt/Math.PI/2,Xo=5,Wl=6,Wh=16383,qc=64,Xh=[qc,32,16],Xa=-Na,Ya=Na;function Uu(c,n,s,u=Na){return s=$n(s),[c*Math.sin(s)*u,-n*u,c*Math.cos(s)*u]}function Gc(c,n,s){return Uu(Math.cos($n(c)),Math.sin($n(c)),n,s)}const Ws=63710088e-1,pl=2*Math.PI*Ws;class pr{constructor(n,s){if(isNaN(n)||isNaN(s))throw new Error(`Invalid LngLat object: (${n}, ${s})`);if(this.lng=+n,this.lat=+s,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new pr(is(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(n){const s=Math.PI/180,u=this.lat*s,_=n.lat*s,d=Math.sin(u)*Math.sin(_)+Math.cos(u)*Math.cos(_)*Math.cos((n.lng-this.lng)*s);return Ws*Math.acos(Math.min(d,1))}toBounds(n=0){const s=360*n/40075017,u=s/Math.cos(Math.PI/180*this.lat);return new Xl({lng:this.lng-u,lat:this.lat-s},{lng:this.lng+u,lat:this.lat+s})}toEcef(n){return Gc(this.lat,this.lng,Na+n*Na/Ws)}static convert(n){if(n instanceof pr)return n;if(Array.isArray(n)&&(n.length===2||n.length===3))return new pr(Number(n[0]),Number(n[1]));if(!Array.isArray(n)&&typeof n=="object"&&n!==null)return new pr(Number("lng"in n?n.lng:n.lon),Number(n.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class Xl{constructor(n,s){if(n)if(s)this.setSouthWest(n).setNorthEast(s);else if(n.length===4){const u=n;this.setSouthWest([u[0],u[1]]).setNorthEast([u[2],u[3]])}else{const u=n;this.setSouthWest(u[0]).setNorthEast(u[1])}}setNorthEast(n){return this._ne=n instanceof pr?new pr(n.lng,n.lat):pr.convert(n),this}setSouthWest(n){return this._sw=n instanceof pr?new pr(n.lng,n.lat):pr.convert(n),this}extend(n){const s=this._sw,u=this._ne;let _,d;if(n instanceof pr)_=n,d=n;else{if(!(n instanceof Xl))return Array.isArray(n)?n.length===4||n.every(Array.isArray)?this.extend(Xl.convert(n)):this.extend(pr.convert(n)):typeof n=="object"&&n!==null&&n.hasOwnProperty("lat")&&(n.hasOwnProperty("lon")||n.hasOwnProperty("lng"))?this.extend(pr.convert(n)):this;if(_=n._sw,d=n._ne,!_||!d)return this}return s||u?(s.lng=Math.min(_.lng,s.lng),s.lat=Math.min(_.lat,s.lat),u.lng=Math.max(d.lng,u.lng),u.lat=Math.max(d.lat,u.lat)):(this._sw=new pr(_.lng,_.lat),this._ne=new pr(d.lng,d.lat)),this}getCenter(){return new pr((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new pr(this.getWest(),this.getNorth())}getSouthEast(){return new pr(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(n){const{lng:s,lat:u}=pr.convert(n);let _=this._sw.lng<=s&&s<=this._ne.lng;return this._sw.lng>this._ne.lng&&(_=this._sw.lng>=s&&s>=this._ne.lng),this._sw.lat<=u&&u<=this._ne.lat&&_}static convert(n){if(n)return n instanceof Xl?n:new Xl(n)}}const Vu=0,Yo=25.5;function _d(c){return pl*Math.cos(c*Math.PI/180)}function Xs(c){return(180+c)/360}function Ts(c){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+c*Math.PI/360)))/360}function Fa(c,n){return c/_d(n)}function no(c){return 360*c-180}function qi(c){return 360/Math.PI*Math.atan(Math.exp((180-360*c)*Math.PI/180))-90}function ml(c,n){return c*_d(qi(n))}const Br=85.051129;function gd(c){return Math.cos($n(Bn(c,-85.051129,Br)))}function $u(c,n){const s=Bn(n,Vu,Yo),u=Math.pow(2,s);return gd(c)*pl/(512*u)}function p(c){return 1/Math.cos(c*Math.PI/180)}function r(c,n=0){const s=Math.exp(Math.PI*(1-(c.y+n/Kt)/(1<<c.z)*2));return 80150034*s/(s*s+1)/Kt/(1<<c.z)}class l{constructor(n,s,u=0){this.x=+n,this.y=+s,this.z=+u}static fromLngLat(n,s=0){const u=pr.convert(n);return new l(Xs(u.lng),Ts(u.lat),Fa(s,u.lat))}toLngLat(){return new pr(no(this.x),qi(this.y))}toAltitude(){return ml(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/pl*p(qi(this.y))}}function m(c,n,s,u,_,d,v,E,O){const z=(n+u)/2,S=(s+_)/2,P=new Pt(z,S);E(P),function(L,M,R,B,q,H){const ne=R-q,re=B-H;return Math.abs((B-M)*ne-(R-L)*re)/Math.hypot(ne,re)}(P.x,P.y,d.x,d.y,v.x,v.y)>=O?(m(c,n,s,z,S,d,P,E,O),m(c,z,S,u,_,P,v,E,O)):c.push(v)}function x(c,n,s){let u=c[0],_=u.x,d=u.y;n(u);const v=[u];for(let E=1;E<c.length;E++){const O=c[E],{x:z,y:S}=O;n(O),m(v,_,d,z,S,u,O,n,s),_=z,d=S,u=O}return v}function w(c,n,s,u){if(u(n,s)){const _=n.add(s)._mult(.5);w(c,n,_,u),w(c,_,s,u)}else c.push(s)}function A(c,n){let s=c[0];const u=[s];for(let _=1;_<c.length;_++){const d=c[_];w(u,s,d,n),s=d}return u}const D=Math.pow(2,14)-1,N=-D-1;function U(c,n){const s=Math.round(c.x*n),u=Math.round(c.y*n);return c.x=Bn(s,N,D),c.y=Bn(u,N,D),(s<c.x||s>c.x+1||u<c.y||u>c.y+1)&&qn("Geometry exceeds allowed extent, reduce your vector tile buffer size"),c}function $(c,n,s){const u=c.loadGeometry(),_=c.extent,d=Kt/_;if(n&&s&&s.projection.isReprojectedInTileSpace){const v=1<<n.z,{scale:E,x:O,y:z,projection:S}=s,P=L=>{const M=no((n.x+L.x/_)/v),R=qi((n.y+L.y/_)/v),B=S.project(M,R);L.x=(B.x*E-O)*_,L.y=(B.y*E-z)*_};for(let L=0;L<u.length;L++)if(c.type!==1)u[L]=x(u[L],P,1);else{const M=[];for(const R of u[L])R.x<0||R.x>=_||R.y<0||R.y>=_||(P(R),M.push(R));u[L]=M}}for(const v of u)for(const E of v)U(E,d);return u}function Z(c,n){return{type:c.type,id:c.id,properties:c.properties,geometry:n?$(c):[]}}function W(c,n,s,u,_){c.emplaceBack(2*n+(u+1)/2,2*s+(_+1)/2)}function te(c,n,s){c.emplaceBack(n.x,n.y,n.z,s[0]*16384,s[1]*16384,s[2]*16384)}class ue{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(s=>s.fqid),this.index=n.index,this.hasPattern=!1,this.projection=n.projection,this.layoutVertexArray=new cl,this.indexArray=new sa,this.segments=new ci,this.programConfigurations=new Po(n.layers,{zoom:n.zoom,lut:n.lut}),this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id)}updateFootprints(n,s){}populate(n,s,u,_){const d=this.layers[0],v=[];let E=null;d.type==="circle"&&(E=d.layout.get("circle-sort-key"));for(const{feature:z,id:S,index:P,sourceLayerIndex:L}of n){const M=this.layers[0]._featureFilter.needGeometry,R=Z(z,M);if(!this.layers[0]._featureFilter.filter(new zr(this.zoom),R,u))continue;const B=E?E.evaluate(R,{},u):void 0,q={id:S,properties:z.properties,type:z.type,sourceLayerIndex:L,index:P,geometry:M?R.geometry:$(z,u,_),patterns:{},sortKey:B};v.push(q)}E&&v.sort((z,S)=>z.sortKey-S.sortKey);let O=null;_.projection.name==="globe"&&(this.globeExtVertexArray=new Uh,O=_.projection);for(const z of v){const{geometry:S,index:P,sourceLayerIndex:L}=z,M=n[P].feature;this.addFeature(z,S,P,s.availableImages,u,O,s.brightness),s.featureIndex.insert(M,S,P,L,this.index)}}update(n,s,u,_,d,v,E){this.programConfigurations.updatePaintArrays(n,s,d,u,_,v,E)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,y_.members),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=n.createVertexBuffer(this.globeExtVertexArray,fd.members))),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(n,s,u,_,d,v,E){for(const O of s)for(const z of O){const S=z.x,P=z.y;if(S<0||S>=Kt||P<0||P>=Kt)continue;if(v){const R=v.projectTilePoint(S,P,d),B=v.upVector(d,S,P),q=this.globeExtVertexArray;te(q,R,B),te(q,R,B),te(q,R,B),te(q,R,B)}const L=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,n.sortKey),M=L.vertexLength;W(this.layoutVertexArray,S,P,-1,-1),W(this.layoutVertexArray,S,P,1,-1),W(this.layoutVertexArray,S,P,1,1),W(this.layoutVertexArray,S,P,-1,1),this.indexArray.emplaceBack(M,M+1,M+2),this.indexArray.emplaceBack(M,M+2,M+3),L.vertexLength+=4,L.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,u,{},_,d,E)}}function se(c,n){for(let s=0;s<c.length;s++)if(De(n,c[s]))return!0;for(let s=0;s<n.length;s++)if(De(c,n[s]))return!0;return!!Pe(c,n)}function de(c,n,s){return!!De(c,n)||!!Fe(n,c,s)}function he(c,n){if(c.length===1)return ze(n,c[0]);for(let s=0;s<n.length;s++){const u=n[s];for(let _=0;_<u.length;_++)if(De(c,u[_]))return!0}for(let s=0;s<c.length;s++)if(ze(n,c[s]))return!0;for(let s=0;s<n.length;s++)if(Pe(c,n[s]))return!0;return!1}function Te(c,n,s){if(c.length>1){if(Pe(c,n))return!0;for(let u=0;u<n.length;u++)if(Fe(n[u],c,s))return!0}for(let u=0;u<c.length;u++)if(Fe(c[u],n,s))return!0;return!1}function Pe(c,n){if(c.length===0||n.length===0)return!1;for(let s=0;s<c.length-1;s++){const u=c[s],_=c[s+1];for(let d=0;d<n.length-1;d++)if(Me(u,_,n[d],n[d+1]))return!0}return!1}function Me(c,n,s,u){return tl(c,s,u)!==tl(n,s,u)&&tl(c,n,s)!==tl(c,n,u)}function Fe(c,n,s){const u=s*s;if(n.length===1)return c.distSqr(n[0])<u;for(let _=1;_<n.length;_++)if(Re(c,n[_-1],n[_])<u)return!0;return!1}function Re(c,n,s){const u=n.distSqr(s);if(u===0)return c.distSqr(n);const _=((c.x-n.x)*(s.x-n.x)+(c.y-n.y)*(s.y-n.y))/u;return c.distSqr(_<0?n:_>1?s:s.sub(n)._mult(_)._add(n))}function ze(c,n){let s,u,_,d=!1;for(let v=0;v<c.length;v++){s=c[v];for(let E=0,O=s.length-1;E<s.length;O=E++)u=s[E],_=s[O],u.y>n.y!=_.y>n.y&&n.x<(_.x-u.x)*(n.y-u.y)/(_.y-u.y)+u.x&&(d=!d)}return d}function De(c,n){let s=!1;for(let u=0,_=c.length-1;u<c.length;_=u++){const d=c[u],v=c[_];d.y>n.y!=v.y>n.y&&n.x<(v.x-d.x)*(n.y-d.y)/(v.y-d.y)+d.x&&(s=!s)}return s}function $e(c,n,s,u,_){for(const v of c)if(n<=v.x&&s<=v.y&&u>=v.x&&_>=v.y)return!0;const d=[new Pt(n,s),new Pt(n,_),new Pt(u,_),new Pt(u,s)];if(c.length>2){for(const v of d)if(De(c,v))return!0}for(let v=0;v<c.length-1;v++)if(Xe(c[v],c[v+1],d))return!0;return!1}function Xe(c,n,s){const u=s[0],_=s[2];if(c.x<u.x&&n.x<u.x||c.x>_.x&&n.x>_.x||c.y<u.y&&n.y<u.y||c.y>_.y&&n.y>_.y)return!1;const d=tl(c,n,s[0]);return d!==tl(c,n,s[1])||d!==tl(c,n,s[2])||d!==tl(c,n,s[3])}function ht(c,n,s,u,_,d){let v=n.y-c.y,E=c.x-n.x;if(d=d||0){const O=v*v+E*E;if(O===0)return!0;const z=Math.sqrt(O);v/=z,E/=z}return!((s.x-c.x)*v+(s.y-c.y)*E-d<0||(u.x-c.x)*v+(u.y-c.y)*E-d<0||(_.x-c.x)*v+(_.y-c.y)*E-d<0)}function ot(c,n,s,u,_,d,v){return!(ht(c,n,u,_,d,v)||ht(n,s,u,_,d,v)||ht(s,c,u,_,d,v)||ht(u,_,c,n,s,v)||ht(_,d,c,n,s,v)||ht(d,u,c,n,s,v))}function Et(c,n,s){const u=n.paint.get(c).value;return u.kind==="constant"?u.value:s.programConfigurations.get(n.id).getMaxValue(c)}function yt(c){return Math.sqrt(c[0]*c[0]+c[1]*c[1])}function nt(c,n,s,u,_){if(!n[0]&&!n[1])return c;const d=Pt.convert(n)._mult(_);s==="viewport"&&d._rotate(-u);const v=[];for(let E=0;E<c.length;E++)v.push(c[E].sub(d));return v}function pt(c,n,s,u){const _=Pt.convert(c)._mult(u);return n==="viewport"&&_._rotate(-s),_}let Lt,tt;hn(ue,"CircleBucket",{omit:["layers"]});var St,mt={exports:{}},Gt=(St||(St=1,function(c,n){(function(s){function u(d,v,E){var O=_(256*d,256*(v=Math.pow(2,E)-v-1),E),z=_(256*(d+1),256*(v+1),E);return O[0]+","+O[1]+","+z[0]+","+z[1]}function _(d,v,E){var O=2*Math.PI*6378137/256/Math.pow(2,E);return[d*O-2*Math.PI*6378137/2,v*O-2*Math.PI*6378137/2]}s.getURL=function(d,v,E,O,z,S){return S=S||{},d+"?"+["bbox="+u(E,O,z),"format="+(S.format||"image/png"),"service="+(S.service||"WMS"),"version="+(S.version||"1.1.1"),"request="+(S.request||"GetMap"),"srs="+(S.srs||"EPSG:3857"),"width="+(S.width||256),"height="+(S.height||256),"layers="+v].join("&")},s.getTileBBox=u,s.getMercCoords=_,Object.defineProperty(s,"__esModule",{value:!0})})(n)}(0,mt.exports)),mt.exports);class It{constructor(n,s,u){this.z=n,this.x=s,this.y=u,this.key=Wt(0,n,n,s,u)}equals(n){return this.z===n.z&&this.x===n.x&&this.y===n.y}url(n,s){const u=Gt.getTileBBox(this.x,this.y,this.z),_=function(d,v,E){let O,z="";for(let S=d;S>0;S--)O=1<<S-1,z+=(v&O?1:0)+(E&O?2:0);return z}(this.z,this.x,this.y);return n[(this.x+this.y)%n.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(s==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",_).replace("{bbox-epsg-3857}",u)}toString(){return`${this.z}/${this.x}/${this.y}`}}class At{constructor(n,s){this.wrap=n,this.canonical=s,this.key=Wt(n,s.z,s.z,s.x,s.y)}}class zt{constructor(n,s,u,_,d){this.overscaledZ=n,this.wrap=s,this.canonical=new It(u,+_,+d),this.key=s===0&&n===u?this.canonical.key:Wt(s,n,u,_,d)}equals(n){return this.overscaledZ===n.overscaledZ&&this.wrap===n.wrap&&this.canonical.equals(n.canonical)}scaledTo(n){const s=this.canonical.z-n;return n>this.canonical.z?new zt(n,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new zt(n,this.wrap,n,this.canonical.x>>s,this.canonical.y>>s)}calculateScaledKey(n,s=!0){if(this.overscaledZ===n&&s)return this.key;if(n>this.canonical.z)return Wt(this.wrap*+s,n,this.canonical.z,this.canonical.x,this.canonical.y);{const u=this.canonical.z-n;return Wt(this.wrap*+s,n,n,this.canonical.x>>u,this.canonical.y>>u)}}isChildOf(n){if(n.wrap!==this.wrap)return!1;const s=this.canonical.z-n.canonical.z;return n.overscaledZ===0||n.overscaledZ<this.overscaledZ&&n.canonical.z<this.canonical.z&&n.canonical.x===this.canonical.x>>s&&n.canonical.y===this.canonical.y>>s}children(n){if(this.overscaledZ>=n)return[new zt(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const s=this.canonical.z+1,u=2*this.canonical.x,_=2*this.canonical.y;return[new zt(s,this.wrap,s,u,_),new zt(s,this.wrap,s,u+1,_),new zt(s,this.wrap,s,u,_+1),new zt(s,this.wrap,s,u+1,_+1)]}isLessThan(n){return this.wrap<n.wrap||!(this.wrap>n.wrap)&&(this.overscaledZ<n.overscaledZ||!(this.overscaledZ>n.overscaledZ)&&(this.canonical.x<n.canonical.x||!(this.canonical.x>n.canonical.x)&&this.canonical.y<n.canonical.y))}wrapped(){return new zt(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(n){return new zt(this.overscaledZ,n,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new At(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function Wt(c,n,s,u,_){const d=1<<Math.min(s,22);let v=d*(_%d)+u%d;return c&&s<22&&(v+=d*d*((c<0?-2*c-1:2*c)%(1<<2*(22-s)))),16*(32*v+s)+(n-s)}const on=[c=>{let n=c.canonical.x-1,s=c.wrap;return n<0&&(n=(1<<c.canonical.z)-1,s--),new zt(c.overscaledZ,s,c.canonical.z,n,c.canonical.y)},c=>{let n=c.canonical.x+1,s=c.wrap;return n===1<<c.canonical.z&&(n=0,s++),new zt(c.overscaledZ,s,c.canonical.z,n,c.canonical.y)},c=>new zt(c.overscaledZ,c.wrap,c.canonical.z,c.canonical.x,(c.canonical.y===0?1<<c.canonical.z:c.canonical.y)-1),c=>new zt(c.overscaledZ,c.wrap,c.canonical.z,c.canonical.x,c.canonical.y===(1<<c.canonical.z)-1?0:c.canonical.y+1)];hn(It,"CanonicalTileID"),hn(zt,"OverscaledTileID",{omit:["projMatrix","expandedProjMatrix"]});const dn=br([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:En}=dn,Sn=br([{name:"a_pos_3",components:3,type:"Int16"}]);var bn=br([{name:"a_pos",type:"Int16",components:2}]);class Ln{constructor(n,s){this.pos=n,this.dir=s}intersectsPlane(n,s,u){const _=Ne.vec3.dot(s,this.dir);if(Math.abs(_)<1e-6)return!1;const d=((n[0]-this.pos[0])*s[0]+(n[1]-this.pos[1])*s[1]+(n[2]-this.pos[2])*s[2])/_;return u[0]=this.pos[0]+this.dir[0]*d,u[1]=this.pos[1]+this.dir[1]*d,u[2]=this.pos[2]+this.dir[2]*d,!0}closestPointOnSphere(n,s,u){if(Ne.vec3.equals(this.pos,n)||s===0)return u[0]=u[1]=u[2]=0,!1;const[_,d,v]=this.dir,E=this.pos[0]-n[0],O=this.pos[1]-n[1],z=this.pos[2]-n[2],S=_*_+d*d+v*v,P=2*(E*_+O*d+z*v),L=P*P-4*S*(E*E+O*O+z*z-s*s);if(L<0){const M=Math.max(-P/2,0),R=E+_*M,B=O+d*M,q=z+v*M,H=Math.hypot(R,B,q);return u[0]=R*s/H,u[1]=B*s/H,u[2]=q*s/H,!1}{const M=(-P-Math.sqrt(L))/(2*S);if(M<0){const R=Math.hypot(E,O,z);return u[0]=E*s/R,u[1]=O*s/R,u[2]=z*s/R,!1}return u[0]=E+_*M,u[1]=O+d*M,u[2]=z+v*M,!0}}}class kn{constructor(n,s,u,_,d){this.TL=n,this.TR=s,this.BR=u,this.BL=_,this.horizon=d}static fromInvProjectionMatrix(n,s,u){const _=[-1,1,1],d=[1,1,1],v=[1,-1,1],E=[-1,-1,1],O=Ne.vec3.transformMat4(_,_,n),z=Ne.vec3.transformMat4(d,d,n),S=Ne.vec3.transformMat4(v,v,n),P=Ne.vec3.transformMat4(E,E,n);return new kn(O,z,S,P,s/u)}}function Mr(c,n,s){let u=1/0,_=-1/0;const d=[];for(const v of c){Ne.vec3.sub(d,v,n);const E=Ne.vec3.dot(d,s);u=Math.min(u,E),_=Math.max(_,E)}return[u,_]}function ui(c,n){let s=!0;for(let u=0;u<c.planes.length;u++){const _=c.planes[u];let d=0;for(let v=0;v<n.length;v++)d+=Ne.vec3.dot(_,n[v])+_[3]>=0;if(d===0)return 0;d!==n.length&&(s=!1)}return s?2:1}function qr(c,n){for(const s of c.projections){const u=Mr(n,c.points[0],s.axis);if(s.projection[1]<u[0]||s.projection[0]>u[1])return 0}return 1}function Fn(c,n){let s=0;const u=[0,0,0,0];for(let _=0;_<c.length;_++)u[0]=c[_][0],u[1]=c[_][1],u[2]=c[_][2],u[3]=1,Ne.vec4.dot(u,n)>=0&&s++;return s}class mr{constructor(n,s){this.points=n||new Array(8).fill([0,0,0]),this.planes=s||new Array(6).fill([0,0,0,0]),this.bounds=sn.fromPoints(this.points),this.projections=[],this.frustumEdges=[Ne.vec3.sub([],this.points[2],this.points[3]),Ne.vec3.sub([],this.points[0],this.points[3]),Ne.vec3.sub([],this.points[4],this.points[0]),Ne.vec3.sub([],this.points[5],this.points[1]),Ne.vec3.sub([],this.points[6],this.points[2]),Ne.vec3.sub([],this.points[7],this.points[3])];for(const u of this.frustumEdges){const _=[0,-u[2],u[1]],d=[u[2],0,-u[0]];this.projections.push({axis:_,projection:Mr(this.points,this.points[0],_)}),this.projections.push({axis:d,projection:Mr(this.points,this.points[0],d)})}}static fromInvProjectionMatrix(n,s,u,_){const d=Math.pow(2,u),v=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(z=>{const S=Ne.vec4.transformMat4([],z,n),P=1/S[3]/s*d;return Ne.vec4.mul(S,S,[P,P,_?1/S[3]:P,P])}),E=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(z=>{const S=Ne.vec3.sub([],v[z[0]],v[z[1]]),P=Ne.vec3.sub([],v[z[2]],v[z[1]]),L=Ne.vec3.normalize([],Ne.vec3.cross([],S,P)),M=-Ne.vec3.dot(L,v[z[1]]);return L.concat(M)}),O=[];for(let z=0;z<v.length;z++)O.push([v[z][0],v[z][1],v[z][2]]);return new mr(O,E)}intersectsPrecise(n,s,u){for(let _=0;_<s.length;_++)if(!Fn(n,s[_]))return 0;for(let _=0;_<this.planes.length;_++)if(!Fn(n,this.planes[_]))return 0;for(const _ of u)for(const d of this.frustumEdges){const v=Ne.vec3.cross([],_,d),E=Ne.vec3.length(v);if(E===0)continue;Ne.vec3.scale(v,v,1/E);const O=Mr(this.points,this.points[0],v),z=Mr(n,this.points[0],v);if(O[0]>z[1]||z[0]>O[1])return 0}return 1}containsPoint(n){for(const s of this.planes){const u=s[3];if(Ne.vec3.dot([s[0],s[1],s[2]],n)+u<0)return!1}return!0}}class sn{static fromPoints(n){const s=[1/0,1/0,1/0],u=[-1/0,-1/0,-1/0];for(const _ of n)Ne.vec3.min(s,s,_),Ne.vec3.max(u,u,_);return new sn(s,u)}static fromTileIdAndHeight(n,s,u){const _=1<<n.canonical.z,d=n.canonical.x,v=n.canonical.y;return new sn([d/_,v/_,s],[(d+1)/_,(v+1)/_,u])}static applyTransform(n,s){const u=n.getCorners();for(let _=0;_<u.length;++_)Ne.vec3.transformMat4(u[_],u[_],s);return sn.fromPoints(u)}static applyTransformFast(n,s){const u=[s[12],s[13],s[14]],_=[...u];for(let d=0;d<3;d++)for(let v=0;v<3;v++){const E=s[4*v+d],O=E*n.min[v],z=E*n.max[v];u[d]+=Math.min(O,z),_[d]+=Math.max(O,z)}return new sn(u,_)}static projectAabbCorners(n,s){const u=n.getCorners();for(let _=0;_<u.length;++_)Ne.vec3.transformMat4(u[_],u[_],s);return u}constructor(n,s){this.min=n,this.max=s,this.center=Ne.vec3.scale([],Ne.vec3.add([],this.min,this.max),.5)}quadrant(n){const s=[n%2==0,n<2],u=Ne.vec3.clone(this.min),_=Ne.vec3.clone(this.max);for(let d=0;d<s.length;d++)u[d]=s[d]?this.min[d]:this.center[d],_[d]=s[d]?this.center[d]:this.max[d];return _[2]=this.max[2],new sn(u,_)}distanceX(n){return Math.max(Math.min(this.max[0],n[0]),this.min[0])-n[0]}distanceY(n){return Math.max(Math.min(this.max[1],n[1]),this.min[1])-n[1]}distanceZ(n){return Math.max(Math.min(this.max[2],n[2]),this.min[2])-n[2]}getCorners(){const n=this.min,s=this.max;return[[n[0],n[1],n[2]],[s[0],n[1],n[2]],[s[0],s[1],n[2]],[n[0],s[1],n[2]],[n[0],n[1],s[2]],[s[0],n[1],s[2]],[s[0],s[1],s[2]],[n[0],s[1],s[2]]]}intersects(n){return this.intersectsAabb(n.bounds)?ui(n,this.getCorners()):0}intersectsFlat(n){return this.intersectsAabb(n.bounds)?ui(n,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsPrecise(n,s){return s||this.intersects(n)?qr(n,this.getCorners()):0}intersectsPreciseFlat(n,s){return s||this.intersectsFlat(n)?qr(n,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsAabb(n){for(let s=0;s<3;++s)if(this.min[s]>n.max[s]||n.min[s]>this.max[s])return!1;return!0}intersectsAabbXY(n){return!(this.min[0]>n.max[0]||n.min[0]>this.max[0]||this.min[1]>n.max[1]||n.min[1]>this.max[1])}encapsulate(n){for(let s=0;s<3;s++)this.min[s]=Math.min(this.min[s],n.min[s]),this.max[s]=Math.max(this.max[s],n.max[s])}encapsulatePoint(n){for(let s=0;s<3;s++)this.min[s]=Math.min(this.min[s],n[s]),this.max[s]=Math.max(this.max[s],n[s])}closestPoint(n){return[Math.max(Math.min(this.max[0],n[0]),this.min[0]),Math.max(Math.min(this.max[1],n[1]),this.min[1]),Math.max(Math.min(this.max[2],n[2]),this.min[2])]}}function Pn(c){return c*Na/Ws}hn(sn,"Aabb");const An=[new sn([Xa,Xa,Xa],[Ya,Ya,Ya]),new sn([Xa,Xa,Xa],[0,0,Ya]),new sn([0,Xa,Xa],[Ya,0,Ya]),new sn([Xa,0,Xa],[0,Ya,Ya]),new sn([0,0,Xa],[Ya,Ya,Ya])];function In(c,n,s,u=!0){const _=Ne.vec3.scale([],c._camera.position,c.worldSize),d=[n,s,1,1];Ne.vec4.transformMat4(d,d,c.pixelMatrixInverse),Ne.vec4.scale(d,d,1/d[3]);const v=Ne.vec3.sub([],d,_),E=Ne.vec3.normalize([],v),O=c.globeMatrix,z=[O[12],O[13],O[14]],S=Ne.vec3.sub([],z,_),P=Ne.vec3.length(S),L=Ne.vec3.normalize([],S),M=c.worldSize/(2*Math.PI),R=Ne.vec3.dot(L,E),B=Math.asin(M/P);if(B<Math.acos(R)){if(!u)return null;const Ue=[],Oe=[];Ne.vec3.scale(Ue,E,P/R),Ne.vec3.normalize(Oe,Ne.vec3.sub(Oe,Ue,S)),Ne.vec3.normalize(E,Ne.vec3.add(E,S,Ne.vec3.scale(E,Oe,Math.tan(B)*P)))}const q=[];new Ln(_,E).closestPointOnSphere(z,M,q);const H=Ne.vec3.normalize([],nl(O,0)),ne=Ne.vec3.normalize([],nl(O,1)),re=Ne.vec3.normalize([],nl(O,2)),K=Ne.vec3.dot(H,q),ie=Ne.vec3.dot(ne,q),ce=Ne.vec3.dot(re,q),_e=si(Math.asin(-ie/M));let Ce=si(Math.atan2(K,ce));Ce=c.center.lng+function(Ue,Oe){const Ve=(Oe-Ue+180)%360-180;return Ve<-180?Ve+360:Ve}(c.center.lng,Ce);const Ae=Xs(Ce),Ee=Bn(Ts(_e),0,1);return new l(Ae,Ee)}class or{constructor(n,s,u){this.a=Ne.vec3.sub([],n,u),this.b=Ne.vec3.sub([],s,u),this.center=u;const _=Ne.vec3.normalize([],this.a),d=Ne.vec3.normalize([],this.b);this.angle=Math.acos(Ne.vec3.dot(_,d))}}function Gr(c,n){if(c.angle===0)return null;let s;return s=c.a[n]===0?1/c.angle*.5*Math.PI:1/c.angle*Math.atan(c.b[n]/c.a[n]/Math.sin(c.angle)-1/Math.tan(c.angle)),s<0||s>1?null:function(u,_,d,v){const E=Math.sin(d);return u*(Math.sin((1-v)*d)/E)+_*(Math.sin(v*d)/E)}(c.a[n],c.b[n],c.angle,Bn(s,0,1))+c.center[n]}function Kr(c){if(c.z<=1)return An[c.z+2*c.y+c.x];const n=Er(hr(c));return sn.fromPoints(n)}function hi(c,n,s){return Ne.vec3.scale(c,c,1-s),Ne.vec3.scaleAndAdd(c,c,n,s)}function yo(c,n,s){for(const u of c)Ne.vec3.transformMat4(u,u,n),Ne.vec3.scale(u,u,s)}function Ci(c,n,s,u){const _=n/c.worldSize,d=c.globeMatrix;if(s.z<=1){const Ae=Kr(s).getCorners();return yo(Ae,d,_),sn.fromPoints(Ae)}const v=hr(s,u),E=Er(v,Na+Pn(c._tileCoverLift));yo(E,d,_);const O=Number.MAX_VALUE,z=[-O,-O,-O],S=[O,O,O];if(v.contains(c.center)){for(const Ue of E)Ne.vec3.min(S,S,Ue),Ne.vec3.max(z,z,Ue);z[2]=0;const Ae=c.point,Ee=[Ae.x*_,Ae.y*_,0];return Ne.vec3.min(S,S,Ee),Ne.vec3.max(z,z,Ee),new sn(S,z)}if(c._tileCoverLift>0){for(const Ae of E)Ne.vec3.min(S,S,Ae),Ne.vec3.max(z,z,Ae);return new sn(S,z)}const P=[d[12]*_,d[13]*_,d[14]*_],L=v.getCenter(),M=Bn(c.center.lat,-85.051129,Br),R=Bn(L.lat,-85.051129,Br),B=Xs(c.center.lng),q=Ts(M);let H=B-Xs(L.lng);const ne=q-Ts(R);H>.5?H-=1:H<-.5&&(H+=1);let re=0;if(Math.abs(H)>Math.abs(ne))re=H>=0?1:3;else{re=ne>=0?0:2;const Ae=[d[4]*_,d[5]*_,d[6]*_],Ee=-Math.sin($n(ne>=0?v.getSouth():v.getNorth()))*Na;Ne.vec3.scaleAndAdd(P,P,Ae,Ee)}const K=E[re],ie=E[(re+1)%4],ce=new or(K,ie,P),_e=[Gr(ce,0)||K[0],Gr(ce,1)||K[1],Gr(ce,2)||K[2]],Ce=ja(c.zoom);if(Ce>0){const Ae=function({x:Ue,y:Oe,z:Ve},Ze,qe,Ke,Qe){const at=1/(1<<Ve);let Je=Ue*at,wt=Je+at,Rt=Oe*at,bt=Rt+at,an=0;const Jt=(Je+wt)/2-Ke;return Jt>.5?an=-1:Jt<-.5&&(an=1),Je=((Je+an)*Ze-(Ke*=Ze))*qe+Ke,wt=((wt+an)*Ze-Ke)*qe+Ke,Rt=(Rt*Ze-(Qe*=Ze))*qe+Qe,bt=(bt*Ze-Qe)*qe+Qe,[[Je,bt,0],[wt,bt,0],[wt,Rt,0],[Je,Rt,0]]}(s,n,c._pixelsPerMercatorPixel,B,q);for(let Ue=0;Ue<E.length;Ue++)hi(E[Ue],Ae[Ue],Ce);const Ee=Ne.vec3.add([],Ae[re],Ae[(re+1)%4]);Ne.vec3.scale(Ee,Ee,.5),hi(_e,Ee,Ce)}for(const Ae of E)Ne.vec3.min(S,S,Ae),Ne.vec3.max(z,z,Ae);return S[2]=Math.min(K[2],ie[2]),Ne.vec3.min(S,S,_e),Ne.vec3.max(z,z,_e),new sn(S,z)}function hr({x:c,y:n,z:s},u=!1){const _=1/(1<<s),d=new pr(no(c*_),n===(1<<s)-1&&u?-90:qi((n+1)*_)),v=new pr(no((c+1)*_),n===0&&u?90:qi(n*_));return new Xl(d,v)}function Er(c,n=Na){const s=$n(c.getNorth()),u=$n(c.getSouth()),_=Math.cos(s),d=Math.cos(u),v=Math.sin(s),E=Math.sin(u),O=c.getWest(),z=c.getEast();return[Uu(d,E,O,n),Uu(d,E,z,n),Uu(_,v,z,n),Uu(_,v,O,n)]}function Tr(c,n,s,u){const _=1<<s.z,d=(c/Kt+s.x)/_;return Gc(qi((n/Kt+s.y)/_),no(d),u)}function cr({min:c,max:n}){return Wh/Math.max(n[0]-c[0],n[1]-c[1],n[2]-c[2])}const Nr=new Float64Array(16);function xi(c){const n=cr(c),s=Ne.mat4.fromScaling(Nr,[n,n,n]);return Ne.mat4.translate(s,s,Ne.vec3.negate([],c.min))}function Or(c){const n=Ne.mat4.fromTranslation(Nr,c.min),s=1/cr(c);return Ne.mat4.scale(n,n,[s,s,s])}function bi(c){const n=Kt/(2*Math.PI);return c/(2*Math.PI)/n}function Io(c,n){return Kt/(512*Math.pow(2,c))*cr(Kr(n))}function ro(c,n,s,u,_){const d=bi(s),v=[c,n,-s/(2*Math.PI)],E=Ne.mat4.identity(new Float64Array(16));return Ne.mat4.translate(E,E,v),Ne.mat4.scale(E,E,[d,d,d]),Ne.mat4.rotateX(E,E,$n(-_)),Ne.mat4.rotateY(E,E,$n(-u)),E}function ja(c){return jo(Xo,Wl,c)}function Ko(c,n){const s=Gc(n.lat,n.lng),u=function(d){const v=Gc(d._center.lat,d._center.lng),E=Ne.vec3.fromValues(0,1,0);let O=Ne.vec3.cross([],E,v);const z=Ne.mat4.fromRotation([],-d.angle,v);O=Ne.vec3.transformMat4(O,O,z),Ne.mat4.fromRotation(z,-d._pitch,O);const S=Ne.vec3.normalize([],v);return Ne.vec3.scale(S,S,Pn(d.cameraToCenterDistance/d.pixelsPerMeter)),Ne.vec3.transformMat4(S,S,z),Ne.vec3.add([],v,S)}(c),_=Ne.vec3.subtract([],u,s);return Ne.vec3.angle(_,s)}function Ea(c,n){return Ko(c,n)>Math.PI/2*1.01}const io=$n(85),Jo=Math.cos(io),Ro=Math.sin(io),Yl=Ne.mat4.create(),Hc=c=>{const n=[];return c.paint.get("circle-pitch-alignment")==="map"&&n.push("PITCH_WITH_MAP"),c.paint.get("circle-pitch-scale")==="map"&&n.push("SCALE_WITH_MAP"),n};function Zc(c,n,s,u,_,d,v,E,O){if(d&&c.queryGeometry.isAboveHorizon)return!1;d&&(O*=c.pixelToTileUnitsFactor);const z=c.tileID.canonical,S=s.projection.upVectorScale(z,s.center.lat,s.worldSize).metersToTile;for(const P of n)for(const L of P){const M=L.add(E),R=_&&s.elevation?s.elevation.exaggeration()*_.getElevationAt(M.x,M.y,!0):0,B=s.projection.projectTilePoint(M.x,M.y,z);if(R>0){const re=s.projection.upVector(z,M.x,M.y);B.x+=re[0]*S*R,B.y+=re[1]*S*R,B.z+=re[2]*S*R}const q=d?M:yd(B.x,B.y,B.z,u),H=d?c.tilespaceRays.map(re=>Qo(re,R)):c.queryGeometry.screenGeometry,ne=Ne.vec4.transformMat4([],[B.x,B.y,B.z,1],u);if(!v&&d?O*=ne[3]/s.cameraToCenterDistance:v&&!d&&(O*=s.cameraToCenterDistance/ne[3]),d){const re=qi((L.y/Kt+z.y)/(1<<z.z));O/=s.projection.pixelsPerMeter(re,1)/Fa(1,re)}if(de(H,q,O))return!0}return!1}function yd(c,n,s,u){const _=Ne.vec4.transformMat4([],[c,n,s,1],u);return new Pt(_[0]/_[3],_[1]/_[3])}const Es=Ne.vec3.fromValues(0,0,0),k2=Ne.vec3.fromValues(0,0,1);function Qo(c,n){const s=Ne.vec3.create();return Es[2]=n,c.intersectsPlane(Es,k2,s),new Pt(s[0],s[1])}class Py extends ue{}let b_,Iy,z2,Wc;function t0(c,{width:n,height:s},u,_){if(_){if(_ instanceof Uint8ClampedArray)_=new Uint8Array(_.buffer);else if(_.length!==n*s*u)throw new RangeError("mismatched image size")}else _=new Uint8Array(n*s*u);return c.width=n,c.height=s,c.data=_,c}function w_(c,n,s){const{width:u,height:_}=n;u===c.width&&_===c.height||(Yh(c,n,{x:0,y:0},{x:0,y:0},{width:Math.min(c.width,u),height:Math.min(c.height,_)},s,null),c.width=u,c.height=_,c.data=n.data)}function Yh(c,n,s,u,_,d,v,E){if(_.width===0||_.height===0)return n;if(_.width>c.width||_.height>c.height||s.x>c.width-_.width||s.y>c.height-_.height)throw new RangeError("out of range source coordinates for image copy");if(_.width>n.width||_.height>n.height||u.x>n.width-_.width||u.y>n.height-_.height)throw new RangeError("out of range destination coordinates for image copy");const O=c.data,z=n.data,S=d===4&&E;for(let P=0;P<_.height;P++){const L=((s.y+P)*c.width+s.x)*d,M=((u.y+P)*n.width+u.x)*d;if(S)for(let R=0;R<_.width;R++){const B=L+R*d+3,q=M+R*d;z[q+0]=255,z[q+1]=255,z[q+2]=255,z[q+3]=O[B]}else if(v)for(let R=0;R<_.width;R++){const B=L+R*d,q=M+R*d,H=O[B+3],ne=new _r(O[B+0]/255*H,O[B+1]/255*H,O[B+2]/255*H,H).toRenderColor(v).toArray();z[q+0]=ne[0],z[q+1]=ne[1],z[q+2]=ne[2],z[q+3]=ne[3]}else for(let R=0;R<_.width*d;R++)z[M+R]=O[L+R]}return n}hn(Py,"HeatmapBucket",{omit:["layers"]});class qu{constructor(n,s){t0(this,n,1,s)}resize(n){w_(this,new qu(n),1)}clone(){return new qu({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(n,s,u,_,d){Yh(n,s,u,_,d,1,null)}}class Aa{constructor(n,s){t0(this,n,4,s)}resize(n){w_(this,new Aa(n),4)}replace(n,s){s?this.data.set(n):this.data=n instanceof Uint8ClampedArray?new Uint8Array(n.buffer):n}clone(){return new Aa({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(n,s,u,_,d,v,E){Yh(n,s,u,_,d,4,v,E)}}class Ry{constructor(n,s){this.width=n.width,this.height=n.height,this.data=s instanceof Uint8Array?new Float32Array(s.buffer):s}}function vd(c){const n={},s=c.resolution||256,u=c.clips?c.clips.length:1,_=c.image||new Aa({width:s,height:u}),d=(v,E,O)=>{n[c.evaluationKey]=O;const z=c.expression.evaluate(n);z&&(_.data[v+E+0]=Math.floor(255*z.r/z.a),_.data[v+E+1]=Math.floor(255*z.g/z.a),_.data[v+E+2]=Math.floor(255*z.b/z.a),_.data[v+E+3]=Math.floor(255*z.a))};if(c.clips)for(let v=0,E=0;v<u;++v,E+=4*s)for(let O=0,z=0;O<s;O++,z+=4){const S=O/(s-1),{start:P,end:L}=c.clips[v];d(E,z,P*(1-S)+L*S)}else for(let v=0,E=0;v<s;v++,E+=4)d(0,E,v/(s-1));return _}hn(qu,"AlphaImage"),hn(Aa,"RGBAImage");const Dy=br([{name:"a_pos",components:2,type:"Int16"}],4),{members:QS}=Dy;function n0(c,n,s=2){const u=n&&n.length,_=u?n[0]*s:c.length;let d=B2(c,0,_,s,!0);const v=[];if(!d||d.next===d.prev)return v;let E,O,z;if(u&&(d=function(S,P,L,M){const R=[];for(let B=0,q=P.length;B<q;B++){const H=B2(S,P[B]*M,B<q-1?P[B+1]*M:S.length,M,!1);H===H.next&&(H.steiner=!0),R.push(Mi(H))}R.sort(e3);for(let B=0;B<R.length;B++)L=j2(R[B],L);return L}(c,n,d,s)),c.length>80*s){E=1/0,O=1/0;let S=-1/0,P=-1/0;for(let L=s;L<_;L+=s){const M=c[L],R=c[L+1];M<E&&(E=M),R<O&&(O=R),M>S&&(S=M),R>P&&(P=R)}z=Math.max(S-E,P-O),z=z!==0?32767/z:0}return Vp(d,v,s,E,O,z,0),v}function B2(c,n,s,u,_){let d;if(_===function(v,E,O,z){let S=0;for(let P=E,L=O-z;P<O;P+=z)S+=(v[L]-v[P])*(v[P+1]+v[L+1]),L=P;return S}(c,n,s,u)>0)for(let v=n;v<s;v+=u)d=r0(v/u|0,c[v],c[v+1],d);else for(let v=s-u;v>=n;v-=u)d=r0(v/u|0,c[v],c[v+1],d);return d&&E_(d,d.next)&&(bd(d),d=d.next),d}function Kh(c,n){if(!c)return c;n||(n=c);let s,u=c;do if(s=!1,u.steiner||!E_(u,u.next)&&Gi(u.prev,u,u.next)!==0)u=u.next;else{if(bd(u),u=n=u.prev,u===u.next)break;s=!0}while(s||u!==n);return n}function Vp(c,n,s,u,_,d,v){if(!c)return;!v&&d&&function(O,z,S,P){let L=O;do L.z===0&&(L.z=T_(L.x,L.y,z,S,P)),L.prevZ=L.prev,L.nextZ=L.next,L=L.next;while(L!==O);L.prevZ.nextZ=null,L.prevZ=null,function(M){let R,B=1;do{let q,H=M;M=null;let ne=null;for(R=0;H;){R++;let re=H,K=0;for(let ce=0;ce<B&&(K++,re=re.nextZ,re);ce++);let ie=B;for(;K>0||ie>0&&re;)K!==0&&(ie===0||!re||H.z<=re.z)?(q=H,H=H.nextZ,K--):(q=re,re=re.nextZ,ie--),ne?ne.nextZ=q:M=q,q.prevZ=ne,ne=q;H=re}ne.nextZ=null,B*=2}while(R>1)}(L)}(c,u,_,d);let E=c;for(;c.prev!==c.next;){const O=c.prev,z=c.next;if(d?S_(c,u,_,d):$p(c))n.push(O.i,c.i,z.i),bd(c),c=z.next,E=z.next;else if((c=z)===E){v?v===1?Vp(c=N2(Kh(c),n),n,s,u,_,d,2):v===2&&F2(c,n,s,u,_,d):Vp(Kh(c),n,s,u,_,d,1);break}}}function $p(c){const n=c.prev,s=c,u=c.next;if(Gi(n,s,u)>=0)return!1;const _=n.x,d=s.x,v=u.x,E=n.y,O=s.y,z=u.y,S=_<d?_<v?_:v:d<v?d:v,P=E<O?E<z?E:z:O<z?O:z,L=_>d?_>v?_:v:d>v?d:v,M=E>O?E>z?E:z:O>z?O:z;let R=u.next;for(;R!==n;){if(R.x>=S&&R.x<=L&&R.y>=P&&R.y<=M&&Jh(_,E,d,O,v,z,R.x,R.y)&&Gi(R.prev,R,R.next)>=0)return!1;R=R.next}return!0}function S_(c,n,s,u){const _=c.prev,d=c,v=c.next;if(Gi(_,d,v)>=0)return!1;const E=_.x,O=d.x,z=v.x,S=_.y,P=d.y,L=v.y,M=E<O?E<z?E:z:O<z?O:z,R=S<P?S<L?S:L:P<L?P:L,B=E>O?E>z?E:z:O>z?O:z,q=S>P?S>L?S:L:P>L?P:L,H=T_(M,R,n,s,u),ne=T_(B,q,n,s,u);let re=c.prevZ,K=c.nextZ;for(;re&&re.z>=H&&K&&K.z<=ne;){if(re.x>=M&&re.x<=B&&re.y>=R&&re.y<=q&&re!==_&&re!==v&&Jh(E,S,O,P,z,L,re.x,re.y)&&Gi(re.prev,re,re.next)>=0||(re=re.prevZ,K.x>=M&&K.x<=B&&K.y>=R&&K.y<=q&&K!==_&&K!==v&&Jh(E,S,O,P,z,L,K.x,K.y)&&Gi(K.prev,K,K.next)>=0))return!1;K=K.nextZ}for(;re&&re.z>=H;){if(re.x>=M&&re.x<=B&&re.y>=R&&re.y<=q&&re!==_&&re!==v&&Jh(E,S,O,P,z,L,re.x,re.y)&&Gi(re.prev,re,re.next)>=0)return!1;re=re.prevZ}for(;K&&K.z<=ne;){if(K.x>=M&&K.x<=B&&K.y>=R&&K.y<=q&&K!==_&&K!==v&&Jh(E,S,O,P,z,L,K.x,K.y)&&Gi(K.prev,K,K.next)>=0)return!1;K=K.nextZ}return!0}function N2(c,n){let s=c;do{const u=s.prev,_=s.next.next;!E_(u,_)&&U2(u,s,s.next,_)&&Xc(u,_)&&Xc(_,u)&&(n.push(u.i,s.i,_.i),bd(s),bd(s.next),s=c=_),s=s.next}while(s!==c);return Kh(s)}function F2(c,n,s,u,_,d){let v=c;do{let E=v.next.next;for(;E!==v.prev;){if(v.i!==E.i&&t3(v,E)){let O=C_(v,E);return v=Kh(v,v.next),O=Kh(O,O.next),Vp(v,n,s,u,_,d,0),void Vp(O,n,s,u,_,d,0)}E=E.next}v=v.next}while(v!==c)}function e3(c,n){return c.x-n.x}function j2(c,n){const s=function(_,d){let v=d;const E=_.x,O=_.y;let z,S=-1/0;do{if(O<=v.y&&O>=v.next.y&&v.next.y!==v.y){const B=v.x+(O-v.y)*(v.next.x-v.x)/(v.next.y-v.y);if(B<=E&&B>S&&(S=B,z=v.x<v.next.x?v:v.next,B===E))return z}v=v.next}while(v!==d);if(!z)return null;const P=z,L=z.x,M=z.y;let R=1/0;v=z;do{if(E>=v.x&&v.x>=L&&E!==v.x&&Jh(O<M?E:S,O,L,M,O<M?S:E,O,v.x,v.y)){const B=Math.abs(O-v.y)/(E-v.x);Xc(v,_)&&(B<R||B===R&&(v.x>z.x||v.x===z.x&&qp(z,v)))&&(z=v,R=B)}v=v.next}while(v!==P);return z}(c,n);if(!s)return n;const u=C_(s,c);return Kh(u,u.next),Kh(s,s.next)}function qp(c,n){return Gi(c.prev,c,n.prev)<0&&Gi(n.next,c,c.next)<0}function T_(c,n,s,u,_){return(c=1431655765&((c=858993459&((c=252645135&((c=16711935&((c=(c-s)*_|0)|c<<8))|c<<4))|c<<2))|c<<1))|(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=(n-u)*_|0)|n<<8))|n<<4))|n<<2))|n<<1))<<1}function Mi(c){let n=c,s=c;do(n.x<s.x||n.x===s.x&&n.y<s.y)&&(s=n),n=n.next;while(n!==c);return s}function Jh(c,n,s,u,_,d,v,E){return(_-v)*(n-E)>=(c-v)*(d-E)&&(c-v)*(u-E)>=(s-v)*(n-E)&&(s-v)*(d-E)>=(_-v)*(u-E)}function t3(c,n){return c.next.i!==n.i&&c.prev.i!==n.i&&!function(s,u){let _=s;do{if(_.i!==s.i&&_.next.i!==s.i&&_.i!==u.i&&_.next.i!==u.i&&U2(_,_.next,s,u))return!0;_=_.next}while(_!==s);return!1}(c,n)&&(Xc(c,n)&&Xc(n,c)&&function(s,u){let _=s,d=!1;const v=(s.x+u.x)/2,E=(s.y+u.y)/2;do _.y>E!=_.next.y>E&&_.next.y!==_.y&&v<(_.next.x-_.x)*(E-_.y)/(_.next.y-_.y)+_.x&&(d=!d),_=_.next;while(_!==s);return d}(c,n)&&(Gi(c.prev,c,n.prev)||Gi(c,n.prev,n))||E_(c,n)&&Gi(c.prev,c,c.next)>0&&Gi(n.prev,n,n.next)>0)}function Gi(c,n,s){return(n.y-c.y)*(s.x-n.x)-(n.x-c.x)*(s.y-n.y)}function E_(c,n){return c.x===n.x&&c.y===n.y}function U2(c,n,s,u){const _=xd(Gi(c,n,s)),d=xd(Gi(c,n,u)),v=xd(Gi(s,u,c)),E=xd(Gi(s,u,n));return _!==d&&v!==E||!(_!==0||!A_(c,s,n))||!(d!==0||!A_(c,u,n))||!(v!==0||!A_(s,c,u))||!(E!==0||!A_(s,n,u))}function A_(c,n,s){return n.x<=Math.max(c.x,s.x)&&n.x>=Math.min(c.x,s.x)&&n.y<=Math.max(c.y,s.y)&&n.y>=Math.min(c.y,s.y)}function xd(c){return c>0?1:c<0?-1:0}function Xc(c,n){return Gi(c.prev,c,c.next)<0?Gi(c,n,c.next)>=0&&Gi(c,c.prev,n)>=0:Gi(c,n,c.prev)<0||Gi(c,c.next,n)<0}function C_(c,n){const s=Gu(c.i,c.x,c.y),u=Gu(n.i,n.x,n.y),_=c.next,d=n.prev;return c.next=n,n.prev=c,s.next=_,_.prev=s,u.next=s,s.prev=u,d.next=u,u.prev=d,u}function r0(c,n,s,u){const _=Gu(c,n,s);return u?(_.next=u.next,_.prev=u,u.next.prev=_,u.next=_):(_.prev=_,_.next=_),_}function bd(c){c.next.prev=c.prev,c.prev.next=c.next,c.prevZ&&(c.prevZ.nextZ=c.nextZ),c.nextZ&&(c.nextZ.prevZ=c.prevZ)}function Gu(c,n,s){return{i:c,x:n,y:s,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function Ys(c,n){const s=c.length;if(s<=1)return[c];const u=[];let _,d;for(let v=0;v<s;v++){const E=rp(c[v]);E!==0&&(c[v].area=Math.abs(E),d===void 0&&(d=E<0),d===E<0?(_&&u.push(_),_=[c[v]]):_.push(c[v]))}if(_&&u.push(_),n>1)for(let v=0;v<u.length;v++)u[v].length<=n||(Ff(u[v],n,1,u[v].length-1,i0),u[v]=u[v].slice(0,n));return u}function i0(c,n){return n.area-c.area}function V2(c,n,s=1){if(!c)return null;const u=typeof c=="string"?c:c.getPrimary().id;n[u]||(n[u]=[]);const _=Da.from(u).getPrimary().scaleSelf(s);return n[u].push(_),_.serialize()}function M_(c,n,s,u){const _=u.patternDependencies;let d=!1;for(const v of n){const E=v.paint.get(`${c}-pattern`);E.isConstant()||(d=!0),V2(E.constantOr(null),_,s)&&(d=!0)}return d}function O_(c,n,s,u,_,d){const v=d.patternDependencies;for(const E of n){const O=E.paint.get(`${c}-pattern`).value;if(O.kind!=="constant"){let z=O.evaluate({zoom:u},s,{},d.availableImages);z=z&&z.name?z.name:z;const S=V2(z,v,_);S&&(s.patterns[E.id]=S)}}return s}class P_{constructor(n){this.zoom=n.zoom,this.pixelRatio=n.pixelRatio,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(s=>s.fqid),this.index=n.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new cl,this.indexArray=new sa,this.indexArray2=new jc,this.programConfigurations=new Po(n.layers,{zoom:n.zoom,lut:n.lut}),this.segments=new ci,this.segments2=new ci,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id),this.projection=n.projection}updateFootprints(n,s){}populate(n,s,u,_){this.hasPattern=M_("fill",this.layers,this.pixelRatio,s);const d=this.layers[0].layout.get("fill-sort-key"),v=[];for(const{feature:E,id:O,index:z,sourceLayerIndex:S}of n){const P=this.layers[0]._featureFilter.needGeometry,L=Z(E,P);if(!this.layers[0]._featureFilter.filter(new zr(this.zoom),L,u))continue;const M=d?d.evaluate(L,{},u,s.availableImages):void 0,R={id:O,properties:E.properties,type:E.type,sourceLayerIndex:S,index:z,geometry:P?L.geometry:$(E,u,_),patterns:{},sortKey:M};v.push(R)}d&&v.sort((E,O)=>E.sortKey-O.sortKey);for(const E of v){const{geometry:O,index:z,sourceLayerIndex:S}=E;if(this.hasPattern){const P=O_("fill",this.layers,E,this.zoom,this.pixelRatio,s);this.patternFeatures.push(P)}else this.addFeature(E,O,z,u,{},s.availableImages,s.brightness,s.elevationFeatures);s.featureIndex.insert(n[z].feature,O,z,S,this.index)}}update(n,s,u,_,d,v,E){this.programConfigurations.updatePaintArrays(n,s,d,u,_,v,E)}addFeatures(n,s,u,_,d,v){for(const E of this.patternFeatures)this.addFeature(E,E.geometry,E.index,s,u,_,v,n.elevationFeatures)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,QS),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.indexBuffer2=n.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(n,s,u,_,d,v=[],E,O){for(const z of Ys(s,500)){let S=0;for(const q of z)S+=q.length;const P=this.segments.prepareSegment(S,this.layoutVertexArray,this.indexArray),L=P.vertexLength,M=[],R=[];for(const q of z){if(q.length===0)continue;q!==z[0]&&R.push(M.length/2);const H=this.segments2.prepareSegment(q.length,this.layoutVertexArray,this.indexArray2),ne=H.vertexLength;this.layoutVertexArray.emplaceBack(q[0].x,q[0].y),this.indexArray2.emplaceBack(ne+q.length-1,ne),M.push(q[0].x),M.push(q[0].y);for(let re=1;re<q.length;re++)this.layoutVertexArray.emplaceBack(q[re].x,q[re].y),this.indexArray2.emplaceBack(ne+re-1,ne+re),M.push(q[re].x),M.push(q[re].y);H.vertexLength+=q.length,H.primitiveLength+=q.length}const B=n0(M,R);for(let q=0;q<B.length;q+=3)this.indexArray.emplaceBack(L+B[q],L+B[q+1],L+B[q+2]);P.vertexLength+=S,P.primitiveLength+=B.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,u,d,v,_,E)}}let $2,I_,Ly,ky;hn(P_,"FillBucket",{omit:["layers","patternFeatures"]});class zy{constructor(n,s,u,_){if(this.triangleCount=s.length/3,this.min=new Pt(0,0),this.max=new Pt(0,0),this.xScale=0,this.yScale=0,this.cellsX=0,this.cellsY=0,this.cells=[],this.payload=[],this.triangleCount===0||n.length===0)return;const[d,v]=[n[0].clone(),n[0].clone()];for(let P=1;P<n.length;++P){const L=n[P];d.x=Math.min(d.x,L.x),d.y=Math.min(d.y,L.y),v.x=Math.max(v.x,L.x),v.y=Math.max(v.y,L.y)}if(_){const P=Math.ceil(Math.max(v.x-d.x,v.y-d.y)/_);u=Math.max(u,P)}if(u===0)return;this.min=d,this.max=v;const E=this.max.sub(this.min);E.x=Math.max(E.x,1),E.y=Math.max(E.y,1);const O=Math.max(E.x,E.y)/u;this.cellsX=Math.max(1,Math.ceil(E.x/O)),this.cellsY=Math.max(1,Math.ceil(E.y/O)),this.xScale=1/O,this.yScale=1/O;const z=[];for(let P=0;P<this.triangleCount;P++){const L=n[s[3*P+0]].sub(this.min),M=n[s[3*P+1]].sub(this.min),R=n[s[3*P+2]].sub(this.min),B=_l(Math.floor(Math.min(L.x,M.x,R.x)),this.xScale,this.cellsX),q=_l(Math.floor(Math.max(L.x,M.x,R.x)),this.xScale,this.cellsX),H=_l(Math.floor(Math.min(L.y,M.y,R.y)),this.yScale,this.cellsY),ne=_l(Math.floor(Math.max(L.y,M.y,R.y)),this.yScale,this.cellsY),re=new Pt(0,0),K=new Pt(0,0),ie=new Pt(0,0),ce=new Pt(0,0);for(let _e=H;_e<=ne;++_e){re.y=K.y=_e*O,ie.y=ce.y=(_e+1)*O;for(let Ce=B;Ce<=q;++Ce)re.x=ie.x=Ce*O,K.x=ce.x=(Ce+1)*O,(ot(L,M,R,re,K,ce)||ot(L,M,R,re,ce,ie))&&z.push({cellIdx:_e*this.cellsX+Ce,triIdx:P})}}if(z.length===0)return;z.sort((P,L)=>P.cellIdx-L.cellIdx||P.triIdx-L.triIdx);let S=0;for(;S<z.length;){const P=z[S].cellIdx,L={start:this.payload.length,len:0};for(;S<z.length&&z[S].cellIdx===P;)++L.len,this.payload.push(z[S++].triIdx);this.cells[P]=L}}_lazyInitLookup(){this.lookup||(this.lookup=new Uint8Array(Math.ceil(this.triangleCount/8))),this.lookup.fill(0)}queryPoint(n,s){if(this.triangleCount===0||this.cells.length===0||n.x>this.max.x||this.min.x>n.x||n.y>this.max.y||this.min.y>n.y)return;const u=_l(n.x-this.min.x,this.xScale,this.cellsX),_=_l(n.y-this.min.y,this.yScale,this.cellsY),d=this.cells[_*this.cellsX+u];if(d){this._lazyInitLookup();for(let v=0;v<d.len;v++){const E=this.payload[d.start+v],O=Math.floor(E/8),z=1<<E%8;if(!(this.lookup[O]&z)&&(this.lookup[O]|=z,s.push(E),s.length===this.triangleCount))return}}}query(n,s,u){if(this.triangleCount===0||this.cells.length===0||n.x>this.max.x||this.min.x>s.x||n.y>this.max.y||this.min.y>s.y)return;this._lazyInitLookup();const _=_l(n.x-this.min.x,this.xScale,this.cellsX),d=_l(s.x-this.min.x,this.xScale,this.cellsX),v=_l(n.y-this.min.y,this.yScale,this.cellsY),E=_l(s.y-this.min.y,this.yScale,this.cellsY);for(let O=v;O<=E;O++)for(let z=_;z<=d;z++){const S=this.cells[O*this.cellsX+z];if(S)for(let P=0;P<S.len;P++){const L=this.payload[S.start+P],M=Math.floor(L/8),R=1<<L%8;if(!(this.lookup[M]&R)&&(this.lookup[M]|=R,u.push(L),u.length===this.triangleCount))return}}}}function _l(c,n,s){return Math.max(0,Math.min(s-1,Math.floor(c*n)))}hn(zy,"TriangleGridIndex");class R_{constructor(n){this.zoom=n.zoom,this.layers=n.layers,this.layerIds=this.layers.map(s=>s.fqid),this.index=n.index,this.hasPattern=!1,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id),this.footprints=[]}updateFootprints(n,s){for(const u of this.footprints)s.push({footprint:u,id:n})}populate(n,s,u,_){const d=[];for(const{feature:v,id:E,index:O,sourceLayerIndex:z}of n){const S=this.layers[0]._featureFilter.needGeometry,P=Z(v,S);if(!this.layers[0]._featureFilter.filter(new zr(this.zoom),P,u))continue;const L={id:E,properties:v.properties,type:v.type,sourceLayerIndex:z,index:O,geometry:S?P.geometry:$(v,u,_),patterns:{}};d.push(L)}for(const v of d){const{geometry:E,index:O,sourceLayerIndex:z}=v;this.addFeature(v,E,O,u,{},s.availableImages,s.brightness),s.featureIndex.insert(n[O].feature,E,O,z,this.index)}}isEmpty(){return this.footprints.length===0}uploadPending(){return!1}upload(n){}update(n,s,u,_,d,v,E){}destroy(){}addFeature(n,s,u,_,d,v=[],E){for(const O of Ys(s,2)){const z=[],S=[],P=[],L=new Pt(1/0,1/0),M=new Pt(-1/0,-1/0);for(const q of O)if(q.length!==0){q!==O[0]&&P.push(S.length/2);for(let H=0;H<q.length;H++)S.push(q[H].x),S.push(q[H].y),z.push(q[H]),L.x=Math.min(L.x,q[H].x),L.y=Math.min(L.y,q[H].y),M.x=Math.max(M.x,q[H].x),M.y=Math.max(M.y,q[H].y)}const R=n0(S,P),B=new zy(z,R,8,256);this.footprints.push({vertices:z,indices:R,grid:B,min:L,max:M})}}}hn(R_,"ClipBucket",{omit:["layers"]});const n3=br([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),r3=br([{name:"a_pos_end",components:4,type:"Int16"},{name:"a_angular_offset_factor",components:1,type:"Int16"}]),a0=br([{name:"a_centroid_pos",components:2,type:"Uint16"}]),i3=br([{name:"a_join_normal_inside",components:3,type:"Int16"}]),q2=br([{name:"a_hidden_by_landmark",components:1,type:"Uint8"}]),Hr=br([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:By}=n3;var Gp,D_,L_,k_,wd,o0,Sd,s0={};function G2(){if(D_)return Gp;D_=1;var c=Dr();function n(_,d,v,E,O){this.properties={},this.extent=v,this.type=0,this._pbf=_,this._geometry=-1,this._keys=E,this._values=O,_.readFields(s,this,d)}function s(_,d,v){_==1?d.id=v.readVarint():_==2?function(E,O){for(var z=E.readVarint()+E.pos;E.pos<z;){var S=O._keys[E.readVarint()],P=O._values[E.readVarint()];O.properties[S]=P}}(v,d):_==3?d.type=v.readVarint():_==4&&(d._geometry=v.pos)}function u(_){for(var d,v,E=0,O=0,z=_.length,S=z-1;O<z;S=O++)E+=((v=_[S]).x-(d=_[O]).x)*(d.y+v.y);return E}return Gp=n,n.types=["Unknown","Point","LineString","Polygon"],n.prototype.loadGeometry=function(){var _=this._pbf;_.pos=this._geometry;for(var d,v=_.readVarint()+_.pos,E=1,O=0,z=0,S=0,P=[];_.pos<v;){if(O<=0){var L=_.readVarint();E=7&L,O=L>>3}if(O--,E===1||E===2)z+=_.readSVarint(),S+=_.readSVarint(),E===1&&(d&&P.push(d),d=[]),d.push(new c(z,S));else{if(E!==7)throw new Error("unknown command "+E);d&&d.push(d[0].clone())}}return d&&P.push(d),P},n.prototype.bbox=function(){var _=this._pbf;_.pos=this._geometry;for(var d=_.readVarint()+_.pos,v=1,E=0,O=0,z=0,S=1/0,P=-1/0,L=1/0,M=-1/0;_.pos<d;){if(E<=0){var R=_.readVarint();v=7&R,E=R>>3}if(E--,v===1||v===2)(O+=_.readSVarint())<S&&(S=O),O>P&&(P=O),(z+=_.readSVarint())<L&&(L=z),z>M&&(M=z);else if(v!==7)throw new Error("unknown command "+v)}return[S,L,P,M]},n.prototype.toGeoJSON=function(_,d,v){var E,O,z=this.extent*Math.pow(2,v),S=this.extent*_,P=this.extent*d,L=this.loadGeometry(),M=n.types[this.type];function R(H){for(var ne=0;ne<H.length;ne++){var re=H[ne];H[ne]=[360*(re.x+S)/z-180,360/Math.PI*Math.atan(Math.exp((180-360*(re.y+P)/z)*Math.PI/180))-90]}}switch(this.type){case 1:var B=[];for(E=0;E<L.length;E++)B[E]=L[E][0];R(L=B);break;case 2:for(E=0;E<L.length;E++)R(L[E]);break;case 3:for(L=function(H){var ne=H.length;if(ne<=1)return[H];for(var re,K,ie=[],ce=0;ce<ne;ce++){var _e=u(H[ce]);_e!==0&&(K===void 0&&(K=_e<0),K===_e<0?(re&&ie.push(re),re=[H[ce]]):re.push(H[ce]))}return re&&ie.push(re),ie}(L),E=0;E<L.length;E++)for(O=0;O<L[E].length;O++)R(L[E][O])}L.length===1?L=L[0]:M="Multi"+M;var q={type:"Feature",geometry:{type:M,coordinates:L},properties:this.properties};return"id"in this&&(q.id=this.id),q},Gp}function H2(){if(k_)return L_;k_=1;var c=G2();function n(u,_){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=u,this._keys=[],this._values=[],this._features=[],u.readFields(s,this,_),this.length=this._features.length}function s(u,_,d){u===15?_.version=d.readVarint():u===1?_.name=d.readString():u===5?_.extent=d.readVarint():u===2?_._features.push(d.pos):u===3?_._keys.push(d.readString()):u===4&&_._values.push(function(v){for(var E=null,O=v.readVarint()+v.pos;v.pos<O;){var z=v.readVarint()>>3;E=z===1?v.readString():z===2?v.readFloat():z===3?v.readDouble():z===4?v.readVarint64():z===5?v.readVarint():z===6?v.readSVarint():z===7?v.readBoolean():null}return E}(d))}return L_=n,n.prototype.feature=function(u){if(u<0||u>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[u];var _=this._pbf.readVarint()+this._pbf.pos;return new c(this._pbf,_,this.extent,this._keys,this._values)},L_}function Ny(){return Sd||(Sd=1,s0.VectorTile=function(){if(o0)return wd;o0=1;var c=H2();function n(s,u,_){if(s===3){var d=new c(_,_.readVarint()+_.pos);d.length&&(u[d.name]=d)}}return wd=function(s,u){this.layers=s.readFields(n,{},u)},wd}(),s0.VectorTileFeature=G2(),s0.VectorTileLayer=H2()),s0}var Td=Ny();class Yc extends Pt{constructor(n,s,u){super(n,s),this.z=u}}class mi extends Yc{constructor(n,s,u,_){super(n,s,u),this.w=_}}function Hp(c,n,s,u){const _=[],d=u===0?(v,E,O,z,S,P)=>{v.push(new Pt(P,O+(P-E)/(z-E)*(S-O)))}:(v,E,O,z,S,P)=>{v.push(new Pt(E+(P-O)/(S-O)*(z-E),P))};for(const v of c){const E=[];for(const O of v){if(O.length<=2)continue;const z=[];for(let L=0;L<O.length-1;L++){const M=O[L].x,R=O[L].y,B=O[L+1].x,q=O[L+1].y,H=u===0?M:R,ne=u===0?B:q;H<n?ne>n&&d(z,M,R,B,q,n):H>s?ne<s&&d(z,M,R,B,q,s):z.push(O[L]),ne<n&&H>=n&&d(z,M,R,B,q,n),ne>s&&H<=s&&d(z,M,R,B,q,s)}let S=O[O.length-1];const P=u===0?S.x:S.y;P>=n&&P<=s&&z.push(S),z.length&&(S=z[z.length-1],z[0].x===S.x&&z[0].y===S.y||z.push(z[0]),E.push(z))}E.length&&_.push(E)}return _}function ao(c,n,s,u){const _=s==="x"?"y":"x",d=(u-c[s])/(n[s]-c[s]);c[_]=c[_]+(n[_]-c[_])*d,c[s]=u,c.hasOwnProperty("z")&&(c.z=Mn(c.z,n.z,d)),c.hasOwnProperty("w")&&(c.w=Mn(c.w,n.w,d))}function Z2(c,n,s,u){const _=s,d=u;for(const v of["x","y"]){let E=c,O=n;E[v]>=O[v]&&(E=n,O=c),E[v]<_&&O[v]>_&&ao(E,O,v,_),E[v]<d&&O[v]>d&&ao(O,E,v,d)}}const Zp=Number.MAX_SAFE_INTEGER;function z_(c,n,s,u){return c.order<n||c.order===Zp||!(c.clipMask&s)||function(_,d){return d.length!==0&&d.find(v=>v===_)===void 0}(u,c.clipScope)}function Ed(c,n){return c.x-n.x||c.y-n.y}function Fy(c,n){return Ed(c.min,n.min)===0&&Ed(c.max,n.max)===0}function B_(c,n){return!(c.min.x>n.max.x||c.max.x<n.min.x||c.min.y>n.max.y||c.max.y<n.min.y)}function l0(c,n){if(c.length!==n.length)return!1;for(let s=0;s<c.length;s++)if(c[s].sourceId!==n[s].sourceId||!Fy(c[s],n[s])||c[s].order!==n[s].order||c[s].clipMask!==n[s].clipMask||!Pr(c[s].clipScope,n[s].clipScope))return!1;return!0}function N_(c,n,s){const u=1/Kt,_=1/(1<<s.canonical.z),d=(n.x*u+s.canonical.x)*_+s.wrap,v=(n.y*u+s.canonical.y)*_;return{min:new Pt((c.x*u+s.canonical.x)*_+s.wrap,(c.y*u+s.canonical.y)*_),max:new Pt(d,v)}}function a3(c,n,s){const u=1<<s.canonical.z,_=((n.x-s.wrap)*u-s.canonical.x)*Kt,d=(n.y*u-s.canonical.y)*Kt;return{min:new Pt(((c.x-s.wrap)*u-s.canonical.x)*Kt,(c.y*u-s.canonical.y)*Kt),max:new Pt(_,d)}}function jy(c,n,s,u,_,d,v){const E=c.indices,O=c.vertices,z=[];for(let S=u;S<u+_;S+=3){const P=n[s[S+0]+d],L=n[s[S+1]+d],M=n[s[S+2]+d],R=Math.min(P.x,L.x,M.x),B=Math.max(P.x,L.x,M.x),q=Math.min(P.y,L.y,M.y),H=Math.max(P.y,L.y,M.y);z.length=0,c.grid.query(new Pt(R,q),new Pt(B,H),z);for(let ne=0;ne<z.length;ne++){const re=z[ne];if(ot(O[E[3*re+0]],O[E[3*re+1]],O[E[3*re+2]],P,L,M,v))return!0}}return!1}function W2(c,n,s,u){if(!c||!s)return!1;let _=c.vertices;if(!n.canonical.equals(u.canonical)||n.wrap!==u.wrap){if(s.vertices.length<c.vertices.length)return W2(s,u,c,n);const d=n.canonical,v=u.canonical,E=Math.pow(2,v.z-d.z);_=c.vertices.map(O=>new Pt((O.x+d.x*Kt)*E-v.x*Kt,(O.y+d.y*Kt)*E-v.y*Kt))}return jy(s,_,c.indices,0,c.indices.length,0,0)}function Uy(c,n,s,u){const _=Math.pow(2,u.z-s.z);return new Pt((c+s.x*Kt)*_-u.x*Kt,(n+s.y*Kt)*_-u.y*Kt)}function X2(c,n){const s=[];n.grid.queryPoint(c,s);const u=n.indices,_=n.vertices;for(let d=0;d<s.length;d++){const v=s[d];if(De([_[u[3*v+0]],_[u[3*v+1]],_[u[3*v+2]]],c))return!0}return!1}const Vy=[new Pt(0,0),new Pt(Kt,0),new Pt(Kt,Kt),new Pt(0,Kt)];function F_(c,n){const s=[];let u=[];if(!n||c.length<2)return[c];if(c.length===2)return Xe(c[0],c[1],Vy)?[c]:[];for(let _=0;_<c.length+2;_++){const d=c[_%c.length],v=c[(_+1)%c.length],E=Xe(_===0?c[c.length-1]:c[(_-1)%c.length],d,Vy),O=Xe(d,v,Vy),z=E||O;z&&u.push(d),z&&O||u.length>0&&(u.length>1&&s.push(u),u=[])}return u.length>1&&s.push(u),s}const c0=Td.VectorTileFeature.types,o3=["fill-extrusion-base","fill-extrusion-height","fill-extrusion-color","fill-extrusion-pattern","fill-extrusion-flood-light-wall-radius","fill-extrusion-line-width","fill-extrusion-emissive-strength"],s3=["fill-extrusion-flood-light-ground-radius"],Kl=Math.pow(2,13),Y2=Math.pow(2,15)-1,$y=new Pt(0,1),Ka=2147483648;function Wp(c,n,s,u,_,d,v,E){c.emplaceBack((n<<1)+v,(s<<1)+d,(Math.floor(u*Kl)<<1)+_,Math.round(E))}function Qh(c,n,s){c.emplaceBack(n.x*Kt,n.y*Kt,s?1:0)}function gl(c,n,s,u,_,d){c.emplaceBack(n.x,n.y,(s.x<<1)+u,(s.y<<1)+_,d)}function u0(c,n,s){c.emplaceBack(n.x,n.y,n.z,s[0]*16384,s[1]*16384,s[2]*16384)}class K2{constructor(){this.vertexOffset=0,this.vertexCount=0,this.indexOffset=0,this.indexCount=0}}class Ad{constructor(){this.centroidXY=new Pt(0,0),this.vertexArrayOffset=0,this.vertexCount=0,this.groundVertexArrayOffset=0,this.groundVertexCount=0,this.flags=0,this.footprintSegIdx=-1,this.footprintSegLen=0,this.polygonSegIdx=-1,this.polygonSegLen=0,this.min=new Pt(Number.MAX_VALUE,Number.MAX_VALUE),this.max=new Pt(-Number.MAX_VALUE,-Number.MAX_VALUE),this.height=0}span(){return new Pt(this.max.x-this.min.x,this.max.y-this.min.y)}}class qy{constructor(){this.acc=new Pt(0,0),this.accCount=0,this.centroidDataIndex=0}startRing(n,s){n.min.x===Number.MAX_VALUE&&(n.min.x=n.max.x=s.x,n.min.y=n.max.y=s.y)}appendEdge(n,s,u){this.accCount++,this.acc._add(s);let _=!!this.borders;s.x<n.min.x?(n.min.x=s.x,_=!0):s.x>n.max.x&&(n.max.x=s.x,_=!0),s.y<n.min.y?(n.min.y=s.y,_=!0):s.y>n.max.y&&(n.max.y=s.y,_=!0),((s.x===0||s.x===Kt)&&s.x===u.x)!=((s.y===0||s.y===Kt)&&s.y===u.y)&&this.processBorderOverlap(s,u),_&&this.checkBorderIntersection(s,u)}checkBorderIntersection(n,s){s.x<0!=n.x<0&&this.addBorderIntersection(0,Mn(s.y,n.y,(0-s.x)/(n.x-s.x))),s.x>Kt!=n.x>Kt&&this.addBorderIntersection(1,Mn(s.y,n.y,(Kt-s.x)/(n.x-s.x))),s.y<0!=n.y<0&&this.addBorderIntersection(2,Mn(s.x,n.x,(0-s.y)/(n.y-s.y))),s.y>Kt!=n.y>Kt&&this.addBorderIntersection(3,Mn(s.x,n.x,(Kt-s.y)/(n.y-s.y)))}addBorderIntersection(n,s){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const u=this.borders[n];s<u[0]&&(u[0]=s),s>u[1]&&(u[1]=s)}processBorderOverlap(n,s){if(n.x===s.x){if(n.y===s.y)return;const u=n.x===0?0:1;this.addBorderIntersection(u,s.y),this.addBorderIntersection(u,n.y)}else{const u=n.y===0?2:3;this.addBorderIntersection(u,s.x),this.addBorderIntersection(u,n.x)}}centroid(){return this.accCount===0?new Pt(0,0):new Pt(Math.floor(Math.max(0,this.acc.x)/this.accCount),Math.floor(Math.max(0,this.acc.y)/this.accCount))}intersectsCount(){return this.borders?this.borders.reduce((n,s)=>n+ +(s[0]!==Number.MAX_VALUE),0):0}}function J2(c,n){const s=c.add(n)._unit(),u=Bn(c.x*s.x+c.y*s.y,-1,1);var _,d,v;return v=Math.acos(u),Math.min(4,Math.max(-4,Math.tan(v)))/4*Y2*((_=c).x*(d=n).y-_.y*d.x<0?-1:1)}const l3=[c=>c.x<0,c=>c.x>Kt,c=>c.y<0,c=>c.y>Kt];function c3(c,n,s,u){const _=[4];if(u===0)return _;s._mult(u);const d=c.sub(s),v=n.sub(s),E=[c,n,d,v];for(let O=0;O<4;O++)for(const z of E)if(l3[O](z)){_.push(O);break}return _}class Q2{constructor(n){this.vertexArray=new od,this.indexArray=new sa,this.programConfigurations=new Po(n.layers,{zoom:n.zoom,lut:n.lut},s=>s3.includes(s)),this._segments=new ci,this.hiddenByLandmarkVertexArray=new ud,this._segmentToGroundQuads={},this._segmentToGroundQuads[0]=[],this._segmentToRegionTriCounts={},this._segmentToRegionTriCounts[0]=[0,0,0,0,0],this.regionSegments={},this.regionSegments[4]=new ci}getDefaultSegment(){return this.regionSegments[4]}hasData(){return this.vertexArray.length!==0}addData(n,s,u,_=!1){const d=n.length;if(d>2){let v=Math.max(0,this._segments.get().length-1);const E=this._segments._prepareSegment(4*d,this.vertexArray.length,2*this._segmentToGroundQuads[v].length);let O;v!==this._segments.get().length-1&&(v++,this._segmentToGroundQuads[v]=[],this._segmentToRegionTriCounts[v]=[0,0,0,0,0]);{const z=n[0],S=n[1];O=J2(z.sub(n[d-1])._perp()._unit(),S.sub(z)._perp()._unit())}for(let z=0;z<d;z++){const S=z===d-1?0:z+1,P=n[z],L=n[S],M=n[S===d-1?0:S+1],R=L.sub(P)._perp()._unit(),B=J2(R,M.sub(L)._perp()._unit()),q=O,H=B;if(ef(P,L,s)||_&&Xp(P,s)&&Xp(L,s)){O=B;continue}const ne=E.vertexLength;gl(this.vertexArray,P,L,1,1,q),gl(this.vertexArray,P,L,1,0,q),gl(this.vertexArray,P,L,0,1,H),gl(this.vertexArray,P,L,0,0,H),E.vertexLength+=4;const re=c3(P,L,R,u);for(const K of re)this._segmentToGroundQuads[v].push({id:ne,region:K}),this._segmentToRegionTriCounts[v][K]+=2,E.primitiveLength+=2;O=B}}}prepareBorderSegments(){if(!this.hasData())return;const n=this._segments.get(),s=n.length;for(let u=0;u<s;u++)this._segmentToGroundQuads[u].sort((_,d)=>_.region-d.region);for(let u=0;u<s;u++){const _=this._segmentToGroundQuads[u],d=n[u],v=this._segmentToRegionTriCounts[u];v.reduce((O,z)=>O+z,0);let E=0;for(let O=0;O<=4;O++){const z=v[O];if(z!==0){let S=this.regionSegments[O];S||(S=this.regionSegments[O]=new ci);const P={vertexOffset:d.vertexOffset,primitiveOffset:d.primitiveOffset+E,vertexLength:d.vertexLength,primitiveLength:z};S.get().push(P)}E+=z}for(let O=0;O<_.length;O++){const z=_[O].id;this.indexArray.emplaceBack(z,z+1,z+3),this.indexArray.emplaceBack(z,z+3,z+2)}}this._segmentToGroundQuads=null,this._segmentToRegionTriCounts=null,this._segments.destroy(),this._segments=null}addPaintPropertiesData(n,s,u,_,d,v){this.hasData()&&this.programConfigurations.populatePaintArrays(this.vertexArray.length,n,s,u,_,d,v)}upload(n){this.hasData()&&(this.vertexBuffer=n.createVertexBuffer(this.vertexArray,r3.members),this.indexBuffer=n.createIndexBuffer(this.indexArray))}uploadPaintProperties(n){this.hasData()&&this.programConfigurations.upload(n)}update(n,s,u,_,d,v,E){this.hasData()&&this.programConfigurations.updatePaintArrays(n,s,u,_,d,v,E)}updateHiddenByLandmark(n){if(!this.hasData())return;const s=n.groundVertexCount+n.groundVertexArrayOffset;if(n.groundVertexCount===0)return;const u=n.flags&Ka?1:0;for(let _=n.groundVertexArrayOffset;_<s;++_)this.hiddenByLandmarkVertexArray.emplace(_,u);this._needsHiddenByLandmarkUpdate=!0}uploadHiddenByLandmark(n){this.hasData()&&this._needsHiddenByLandmarkUpdate&&(!this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexArray.length>0?this.hiddenByLandmarkVertexBuffer=n.createVertexBuffer(this.hiddenByLandmarkVertexArray,q2.members,!0):this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.updateData(this.hiddenByLandmarkVertexArray),this._needsHiddenByLandmarkUpdate=!1)}destroy(){if(this.vertexBuffer){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.destroy(),this._segments&&this._segments.destroy(),this.programConfigurations.destroy();for(let n=0;n<=4;n++){const s=this.regionSegments[n];s&&s.destroy()}}}}class j_{constructor(n){this.zoom=n.zoom,this.canonical=n.canonical,this.overscaling=n.overscaling,this.layers=n.layers,this.pixelRatio=n.pixelRatio,this.layerIds=this.layers.map(s=>s.fqid),this.index=n.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=n.projection,this.activeReplacements=[],this.replacementUpdateTime=0,this.centroidData=[],this.footprintIndices=new sa,this.footprintVertices=new cl,this.footprintSegments=[],this.layoutVertexArray=new $s,this.centroidVertexArray=new _o,this.wallVertexArray=new Qm,this.indexArray=new sa,this.programConfigurations=new Po(n.layers,{zoom:n.zoom,lut:n.lut},s=>o3.includes(s)),this.segments=new ci,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id),this.groundEffect=new Q2(n),this.maxHeight=0,this.partLookup={},this.triangleSubSegments=[],this.polygonSegments=[]}updateFootprints(n,s){}populate(n,s,u,_){this.features=[],this.hasPattern=M_("fill-extrusion",this.layers,this.pixelRatio,s),this.featuresOnBorder=[],this.borderFeatureIndices=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.selfDEMTileTimestamp=Number.MAX_VALUE,this.borderDEMTileTimestamp=[Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE],this.tileToMeter=r(u),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter,this.wallMode=this.layers[0].paint.get("fill-extrusion-line-width").constantOr(1)!==0;for(const{feature:d,id:v,index:E,sourceLayerIndex:O}of n){const z=this.layers[0]._featureFilter.needGeometry,S=Z(d,z);if(!this.layers[0]._featureFilter.filter(new zr(this.zoom),S,u))continue;const P={id:v,sourceLayerIndex:O,index:E,geometry:z?S.geometry:$(d,u,_),properties:d.properties,type:d.type,patterns:{}},L=this.layoutVertexArray.length,M=c0[P.type]==="Polygon";if(this.hasPattern)this.features.push(O_("fill-extrusion",this.layers,P,this.zoom,this.pixelRatio,s));else if(this.wallMode)for(const R of P.geometry)for(const B of F_(R,M))this.addFeature(P,[B],E,u,{},s.availableImages,_,s.brightness);else this.addFeature(P,P.geometry,E,u,{},s.availableImages,_,s.brightness);s.featureIndex.insert(d,P.geometry,E,O,this.index,L)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles(),this.groundEffect.prepareBorderSegments(),this.polygonSegments.length=0}addFeatures(n,s,u,_,d,v){for(const E of this.features){const O=c0[E.type]==="Polygon",{geometry:z}=E;if(this.wallMode)for(const S of z)for(const P of F_(S,O))this.addFeature(E,[P],E.index,s,u,_,d,v);else this.addFeature(E,z,E.index,s,u,_,d,v)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles()}update(n,s,u,_,d,v,E){this.programConfigurations.updatePaintArrays(n,s,d,u,_,v,E),this.groundEffect.update(n,s,d,u,_,v,E)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload||this.groundEffect.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,By),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.wallVertexBuffer=n.createVertexBuffer(this.wallVertexArray,i3.members),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=n.createVertexBuffer(this.layoutVertexExtArray,Hr.members,!0)),this.groundEffect.upload(n)),this.groundEffect.uploadPaintProperties(n),this.programConfigurations.upload(n),this.uploaded=!0}uploadCentroid(n){this.groundEffect.uploadHiddenByLandmark(n),this.needsCentroidUpdate&&(!this.centroidVertexBuffer&&this.centroidVertexArray.length>0?this.centroidVertexBuffer=n.createVertexBuffer(this.centroidVertexArray,a0.members,!0):this.centroidVertexBuffer&&this.centroidVertexBuffer.updateData(this.centroidVertexArray),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.groundEffect.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(n,s,u,_,d,v,E,O){const z=this.layers[0].paint.get("fill-extrusion-flood-light-ground-radius").evaluate(n,{})/this.tileToMeter,S=[new Pt(0,0),new Pt(Kt,Kt)],P=E.projection,L=P.name==="globe",M=this.wallMode||c0[n.type]==="Polygon",R=new qy;R.centroidDataIndex=this.centroidData.length;const B=new Ad,q=this.layers[0].paint.get("fill-extrusion-base").evaluate(n,{},_)<=0,H=this.layers[0].paint.get("fill-extrusion-height").evaluate(n,{},_);let ne;if(B.height=H,B.vertexArrayOffset=this.layoutVertexArray.length,B.groundVertexArrayOffset=this.groundEffect.vertexArray.length,L&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new Uh),this.wallMode){if(L)return void qn("Non zero fill-extrusion-line-width is not yet supported on globe.");if(s.length!==1)return;ne=function(Ee){const Ue=Ee[0].x===Ee[Ee.length-1].x&&Ee[0].y===Ee[Ee.length-1].y;(function(Ut){let kt=0;const vn=Ut.length;for(let ln=0;ln<vn;ln++)kt+=(Ut[(ln+1)%vn].x-Ut[ln].x)*(Ut[(ln+1)%vn].y+Ut[ln].y);return kt>=0})(Ee)||(Ee=Ee.reverse());const Ve={geometry:[],joinNormals:[],indices:[]},Ze=[],qe=[],Ke=[];let Qe=Ee.length;for(;Qe>=2&&Ee[Qe-1].equals(Ee[Qe-2]);)Qe--;if(Qe<(Ue?3:2))return Ve;let at,Je,wt,Rt,bt,an=0;for(;an<Qe-1&&Ee[an].equals(Ee[an+1]);)an++;Ue&&(at=Ee[Qe-2],bt=Ee[an].sub(at)._unit()._perp());for(let Ut=an;Ut<Qe;Ut++){if(wt=Ut===Qe-1?Ue?Ee[an+1]:void 0:Ee[Ut+1],wt&&Ee[Ut].equals(wt))continue;bt&&(Rt=bt),at&&(Je=at),at=Ee[Ut],bt=wt?wt.sub(at)._unit()._perp():Rt,Rt=Rt||bt;let kt=Rt.add(bt);kt.x===0&&kt.y===0||kt._unit();const vn=kt.x*bt.x+kt.y*bt.y,ln=vn!==0?1/vn:1/0,pn=Rt.x*bt.y-Rt.y*bt.x>0;let zn="miter";const Gn=2;zn==="miter"&&ln>Gn&&(zn="bevel"),zn==="bevel"&&(ln>100&&(zn="flipbevel"),ln<Gn&&(zn="miter"));const Zn=(Wn,lr,ur,Zr)=>{const Lr=new Pt(Wn.x,Wn.y),jn=new Pt(Wn.x,Wn.y);Lr.x+=lr.x*Zr,Lr.y+=lr.y*Zr,jn.x-=lr.x*Math.max(ur,1),jn.y-=lr.y*Math.max(ur,1),Ke.push(lr),Ze.push(Lr),qe.push(jn)};if(zn==="miter")kt._mult(ln),Zn(at,kt,0,0);else if(zn==="flipbevel")kt=bt.mult(-1),Zn(at,kt,0,0),Zn(at,kt.mult(-1),0,0);else{const Wn=-Math.sqrt(ln*ln-1),lr=pn?Wn:0,ur=pn?0:Wn;Je&&Zn(at,Rt,lr,ur),wt&&Zn(at,bt,lr,ur)}}Ve.geometry=[...Ze,...qe.reverse(),Ze[0]],Ve.joinNormals=[...Ke,...Ke.reverse(),Ke[Ke.length-1]];const Jt=Ve.geometry.length-1;for(let Ut=0;Ut<Jt/2;Ut++)if(Ut+1<Jt/2){let kt=Ut,vn=Ut+1,ln=Jt-1-Ut,pn=Jt-2-Ut;kt=kt===0?Jt-1:kt-1,vn=vn===0?Jt-1:vn-1,ln=ln===0?Jt-1:ln-1,pn=pn===0?Jt-1:pn-1,Ve.indices.push(ln),Ve.indices.push(vn),Ve.indices.push(kt),Ve.indices.push(ln),Ve.indices.push(pn),Ve.indices.push(vn)}return Ve}(s[0]),s=[ne.geometry]}const re=(Ee,Ue)=>Ee<(Ue.length-1)/2||Ee===Ue.length-1,K=this.wallMode?[s]:Ys(s,500);for(let Ee=K.length-1;Ee>=0;Ee--){const Ue=K[Ee];(Ue.length===0||(ie=Ue[0]).every(Oe=>Oe.x<=0)||ie.every(Oe=>Oe.x>=Kt)||ie.every(Oe=>Oe.y<=0)||ie.every(Oe=>Oe.y>=Kt))&&K.splice(Ee,1)}var ie;let ce;if(L)ce=Yp(K,S,_);else{ce=[];for(const Ee of K)ce.push({polygon:Ee,bounds:S})}const _e=M?this.edgeRadius:0,Ce=_e>0&&this.zoom<17,Ae=(Ee,Ue)=>{if(Ee.length===0)return!1;const Oe=Ee[Ee.length-1];return Ue.x===Oe.x&&Ue.y===Oe.y};for(const{polygon:Ee,bounds:Ue}of ce){let Oe=0,Ve=0;for(const Qe of Ee)M&&!Qe[0].equals(Qe[Qe.length-1])&&Qe.push(Qe[0]),Ve+=M?Qe.length-1:Qe.length;const Ze=this.segments.prepareSegment((M?5:4)*Ve,this.layoutVertexArray,this.indexArray);B.footprintSegIdx<0&&(B.footprintSegIdx=this.footprintSegments.length),B.polygonSegIdx<0&&(B.polygonSegIdx=this.polygonSegments.length);const qe={triangleArrayOffset:this.indexArray.length,triangleCount:0,triangleSegIdx:this.segments.segments.length-1},Ke=new K2;if(Ke.vertexOffset=this.footprintVertices.length,Ke.indexOffset=3*this.footprintIndices.length,Ke.ringIndices=[],M){const Qe=[],at=[];Oe=Ze.vertexLength;for(let wt=0;wt<Ee.length;wt++){const Rt=Ee[wt];Rt.length&&wt!==0&&at.push(Qe.length/2);const bt=[];let an,Jt;an=Rt[1].sub(Rt[0])._perp()._unit(),Ke.ringIndices.push(Rt.length-1);for(let Ut=1;Ut<Rt.length;Ut++){const kt=Rt[Ut],vn=Rt[Ut===Rt.length-1?1:Ut+1],ln=kt.clone();if(_e){Jt=vn.sub(kt)._perp()._unit();const pn=an.add(Jt)._unit(),zn=_e*Math.min(4,1/(an.x*pn.x+an.y*pn.y));ln.x+=zn*pn.x,ln.y+=zn*pn.y,ln.x=Math.round(ln.x),ln.y=Math.round(ln.y),an=Jt}if(!q||_e!==0&&!Ce||Ae(bt,ln)||bt.push(ln),Wp(this.layoutVertexArray,ln.x,ln.y,0,0,1,1,0),this.wallMode){const pn=re(Ut,Rt);Qh(this.wallVertexArray,ne.joinNormals[Ut],!pn)}Ze.vertexLength++,this.footprintVertices.emplaceBack(kt.x,kt.y),Qe.push(kt.x,kt.y),L&&u0(this.layoutVertexExtArray,P.projectTilePoint(ln.x,ln.y,_),P.upVector(_,ln.x,ln.y))}q&&(_e===0||Ce)&&(bt.length!==0&&Ae(bt,bt[0])&&bt.pop(),this.groundEffect.addData(bt,Ue,z))}const Je=this.wallMode?ne.indices:n0(Qe,at);for(let wt=0;wt<Je.length;wt+=3)this.footprintIndices.emplaceBack(Ke.vertexOffset+Je[wt+0],Ke.vertexOffset+Je[wt+1],Ke.vertexOffset+Je[wt+2]),this.indexArray.emplaceBack(Oe+Je[wt],Oe+Je[wt+2],Oe+Je[wt+1]),Ze.primitiveLength++;Ke.indexCount+=Je.length,Ke.vertexCount+=this.footprintVertices.length-Ke.vertexOffset}for(let Qe=0;Qe<Ee.length;Qe++){const at=Ee[Qe];R.startRing(B,at[0]);let Je=at.length>4&&Hy(at[at.length-2],at[0],at[1]),wt=_e?u3(at[at.length-2],at[0],at[1],_e):0;const Rt=[];let bt,an,Jt;an=at[1].sub(at[0])._perp()._unit();let Ut=!0;for(let kt=1,vn=0;kt<at.length;kt++){let ln=at[kt-1],pn=at[kt];const zn=at[kt===at.length-1?1:kt+1];if(R.appendEdge(B,pn,ln),ef(pn,ln,Ue)){_e&&(an=zn.sub(pn)._perp()._unit(),Ut=!Ut);continue}const Gn=pn.sub(ln)._perp(),Zn=Gn.x/(Math.abs(Gn.x)+Math.abs(Gn.y)),Wn=Gn.y>0?1:0,lr=ln.dist(pn);if(vn+lr>32768&&(vn=0),_e){Jt=zn.sub(pn)._perp()._unit();let jn=Gy(ln,pn,zn,ex(an,Jt),_e);isNaN(jn)&&(jn=0);const Ir=pn.sub(ln)._unit();ln=ln.add(Ir.mult(wt))._round(),pn=pn.add(Ir.mult(-jn))._round(),wt=jn,an=Jt,q&&this.zoom>=17&&(Ae(Rt,ln)||Rt.push(ln),Ae(Rt,pn)||Rt.push(pn))}const ur=Ze.vertexLength,Zr=at.length>4&&Hy(ln,pn,zn);let Lr=tx(vn,Je,Ut);if(Wp(this.layoutVertexArray,ln.x,ln.y,Zn,Wn,0,0,Lr),Wp(this.layoutVertexArray,ln.x,ln.y,Zn,Wn,0,1,Lr),this.wallMode){const jn=re(kt-1,at),Ir=ne.joinNormals[kt-1];Qh(this.wallVertexArray,Ir,jn),Qh(this.wallVertexArray,Ir,jn)}if(vn+=lr,Lr=tx(vn,Zr,!Ut),Je=Zr,Wp(this.layoutVertexArray,pn.x,pn.y,Zn,Wn,0,0,Lr),Wp(this.layoutVertexArray,pn.x,pn.y,Zn,Wn,0,1,Lr),this.wallMode){const jn=re(kt,at),Ir=ne.joinNormals[kt];Qh(this.wallVertexArray,Ir,jn),Qh(this.wallVertexArray,Ir,jn)}if(Ze.vertexLength+=4,this.indexArray.emplaceBack(ur+0,ur+1,ur+2),this.indexArray.emplaceBack(ur+1,ur+3,ur+2),Ze.primitiveLength+=2,_e){const jn=Oe+(kt===1?at.length-2:kt-2),Ir=kt===1?Oe:jn+1;if(this.indexArray.emplaceBack(ur+1,jn,ur+3),this.indexArray.emplaceBack(jn,Ir,ur+3),Ze.primitiveLength+=2,bt===void 0&&(bt=ur),!ef(zn,at[kt],Ue)){const Rr=kt===at.length-1?bt:Ze.vertexLength;this.indexArray.emplaceBack(ur+2,ur+3,Rr),this.indexArray.emplaceBack(ur+3,Rr+1,Rr),this.indexArray.emplaceBack(ur+3,Ir,Rr+1),Ze.primitiveLength+=3}Ut=!Ut}if(L){const jn=this.layoutVertexExtArray,Ir=P.projectTilePoint(ln.x,ln.y,_),Rr=P.projectTilePoint(pn.x,pn.y,_),ri=P.upVector(_,ln.x,ln.y),Bi=P.upVector(_,pn.x,pn.y);u0(jn,Ir,ri),u0(jn,Ir,ri),u0(jn,Rr,Bi),u0(jn,Rr,Bi)}}M&&(Oe+=at.length-1),q&&_e&&this.zoom>=17&&(Rt.length!==0&&Ae(Rt,Rt[0])&&Rt.pop(),this.groundEffect.addData(Rt,Ue,z,_e>0))}this.footprintSegments.push(Ke),qe.triangleCount=this.indexArray.length-qe.triangleArrayOffset,this.polygonSegments.push(qe),++B.footprintSegLen,++B.polygonSegLen}if(B.vertexCount=this.layoutVertexArray.length-B.vertexArrayOffset,B.groundVertexCount=this.groundEffect.vertexArray.length-B.groundVertexArrayOffset,B.vertexCount!==0){if(B.centroidXY=R.borders?$y:this.encodeCentroid(R,B),this.centroidData.push(B),R.borders){this.featuresOnBorder.push(R);const Ee=this.featuresOnBorder.length-1;for(let Ue=0;Ue<R.borders.length;Ue++)R.borders[Ue][0]!==Number.MAX_VALUE&&this.borderFeatureIndices[Ue].push(Ee)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,u,d,v,_,O),this.groundEffect.addPaintPropertiesData(n,u,d,v,_,O),this.maxHeight=Math.max(this.maxHeight,H)}}sortBorders(){for(let n=0;n<this.borderFeatureIndices.length;n++)this.borderFeatureIndices[n].sort((s,u)=>this.featuresOnBorder[s].borders[n][0]-this.featuresOnBorder[u].borders[n][0])}splitToSubtiles(){const n=[];for(let E=0;E<this.centroidData.length;E++){const O=this.centroidData[E],z=+(O.min.y+O.max.y>Kt),S=2*z+(+(O.min.x+O.max.x>Kt)^z);for(let P=0;P<O.polygonSegLen;P++){const L=O.polygonSegIdx+P;n.push({centroidIdx:E,subtile:S,polygonSegmentIdx:L,triangleSegmentIdx:this.polygonSegments[L].triangleSegIdx})}}const s=new sa;n.sort((E,O)=>E.triangleSegmentIdx===O.triangleSegmentIdx?E.subtile-O.subtile:E.triangleSegmentIdx-O.triangleSegmentIdx);let u=0,_=0,d=0;for(const E of n){if(E.triangleSegmentIdx!==u)break;d++}const v=n.length;for(;_!==n.length;){u=n[_].triangleSegmentIdx;let E=0,O=_,z=_;for(let S=O;S<d&&n[S].subtile===E;S++)z++;for(;O!==d;){const S=n[O];E=S.subtile;const P=this.centroidData[S.centroidIdx].min.clone(),L=this.centroidData[S.centroidIdx].max.clone(),M={vertexOffset:this.segments.segments[u].vertexOffset,primitiveOffset:s.length,vertexLength:this.segments.segments[u].vertexLength,primitiveLength:0,sortKey:void 0,vaos:{}};for(let R=O;R<z;R++){const B=n[R],q=this.polygonSegments[B.polygonSegmentIdx],H=this.centroidData[B.centroidIdx].min,ne=this.centroidData[B.centroidIdx].max,re=this.indexArray.uint16;for(let K=q.triangleArrayOffset;K<q.triangleArrayOffset+q.triangleCount;K++)s.emplaceBack(re[3*K],re[3*K+1],re[3*K+2]);M.primitiveLength+=q.triangleCount,P.x=Math.min(P.x,H.x),P.y=Math.min(P.y,H.y),L.x=Math.max(L.x,ne.x),L.y=Math.max(L.y,ne.y)}M.primitiveLength>0&&this.triangleSubSegments.push({segment:M,min:P,max:L}),O=z;for(let R=O;R<d&&n[R].subtile===n[O].subtile;R++)z++}_=d;for(let S=_;S<v&&n[S].triangleSegmentIdx===n[_].triangleSegmentIdx;S++)d++}s._trim(),this.indexArray=s}getVisibleSegments(n,s,u){const _=new ci;if(this.wallMode){for(const B of this.triangleSubSegments)_.segments.push(B.segment);return _}let d=0,v=0;const E=1<<n.canonical.z;if(s){const B=s.getMinMaxForTile(n);B&&(d=B.min,v=B.max)}v+=this.maxHeight;const O=n.toUnwrapped();let z;const S=[O.canonical.x/E+O.wrap,O.canonical.y/E],P=[(O.canonical.x+1)/E+O.wrap,(O.canonical.y+1)/E],L=(B,q,H)=>[B[0]*(1-H[0])+q[0]*H[0],B[1]*(1-H[1])+q[1]*H[1]],M=[],R=[];for(const B of this.triangleSubSegments){M[0]=B.min.x/Kt,M[1]=B.min.y/Kt,R[0]=B.max.x/Kt,R[1]=B.max.y/Kt;const q=L(S,P,M),H=L(S,P,R);if(new sn([q[0],q[1],d],[H[0],H[1],v]).intersectsPrecise(u)===0){z&&(_.segments.push(z),z=void 0);continue}const ne=B.segment;z&&z.vertexOffset!==ne.vertexOffset&&(_.segments.push(z),z=void 0),z?(z.vertexLength+=ne.vertexLength,z.primitiveLength+=ne.primitiveLength):z={vertexOffset:ne.vertexOffset,primitiveLength:ne.primitiveLength,vertexLength:ne.vertexLength,primitiveOffset:ne.primitiveOffset,sortKey:void 0,vaos:{}}}return z&&_.segments.push(z),_}encodeCentroid(n,s){const u=n.centroid(),_=s.span(),d=Math.min(7,Math.round(_.x*this.tileToMeter/10)),v=Math.min(7,Math.round(_.y*this.tileToMeter/10));return new Pt(Bn(u.x,1,Kt-1)<<3|d,Bn(u.y,1,Kt-1)<<3|v)}encodeBorderCentroid(n){if(!n.borders)return new Pt(0,0);const s=n.borders,u=Number.MAX_VALUE;if(s[0][0]!==u||s[1][0]!==u){const _=s[0][0]!==u?0:1;return new Pt(6|(s[0][0]!==u?0:65528),(s[_][0]+s[_][1])/2<<3|6)}{const _=s[2][0]!==u?2:3;return new Pt((s[_][0]+s[_][1])/2<<3|6,6|(s[2][0]!==u?0:65528))}}showCentroid(n){const s=this.centroidData[n.centroidDataIndex];s.flags&=Ka,s.centroidXY.x=0,s.centroidXY.y=0,this.writeCentroidToBuffer(s)}writeCentroidToBuffer(n){this.groundEffect.updateHiddenByLandmark(n);const s=n.vertexArrayOffset,u=n.vertexCount+n.vertexArrayOffset,_=n.flags&Ka?$y:n.centroidXY,d=this.centroidVertexArray.geta_centroid_pos0(s);if(this.centroidVertexArray.geta_centroid_pos1(s)!==_.y||d!==_.x){for(let v=s;v<u;++v)this.centroidVertexArray.emplace(v,_.x,_.y);this.needsCentroidUpdate=!0}}createCentroidsBuffer(){this.centroidVertexArray.resize(this.layoutVertexArray.length),this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const n of this.centroidData)this.writeCentroidToBuffer(n)}updateReplacement(n,s,u){if(s.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=s.updateTime;const _=s.getReplacementRegionsForTile(n.toUnwrapped());if(l0(this.activeReplacements,_))return;if(this.activeReplacements=_,this.centroidVertexArray.length===0)this.createCentroidsBuffer();else for(const v of this.centroidData)v.flags&=2147483647;const d=[];for(const v of this.activeReplacements){if(v.order<u)continue;const E=Math.max(1,Math.pow(2,v.footprintTileId.canonical.z-n.canonical.z));for(const O of this.centroidData)if(!(O.flags&Ka||v.min.x>O.max.x||O.min.x>v.max.x||v.min.y>O.max.y||O.min.y>v.max.y))for(let z=0;z<O.footprintSegLen;z++){const S=this.footprintSegments[O.footprintSegIdx+z];if(d.length=0,nx(this.footprintVertices,S.vertexOffset,S.vertexCount,v.footprintTileId.canonical,n.canonical,d),jy(v.footprint,d,this.footprintIndices.uint16,S.indexOffset,S.indexCount,-S.vertexOffset,-E)){O.flags|=Ka;break}}}for(const v of this.centroidData)this.writeCentroidToBuffer(v);this.borderDoneWithNeighborZ=[-1,-1,-1,-1]}footprintContainsPoint(n,s,u){let _=!1;for(let d=0;d<u.footprintSegLen;d++){const v=this.footprintSegments[u.footprintSegIdx+d];let E=0;for(const O of v.ringIndices){for(let z=E,S=O+E-1;z<O+E;S=z++){const P=this.footprintVertices.int16[2*(z+v.vertexOffset)+0],L=this.footprintVertices.int16[2*(z+v.vertexOffset)+1],M=this.footprintVertices.int16[2*(S+v.vertexOffset)+1];L>s!=M>s&&n<(this.footprintVertices.int16[2*(S+v.vertexOffset)+0]-P)*(s-L)/(M-L)+P&&(_=!_)}E=O}}return _}getHeightAtTileCoord(n,s){let u=Number.NEGATIVE_INFINITY,_=!0;const d=4*(n+Kt)*Kt+(s+Kt);if(this.partLookup.hasOwnProperty(d)){const v=this.partLookup[d];return v?{height:v.height,hidden:!!(v.flags&Ka)}:void 0}for(const v of this.centroidData)n>v.max.x||v.min.x>n||s>v.max.y||v.min.y>s||this.footprintContainsPoint(n,s,v)&&v&&v.height>u&&(u=v.height,this.partLookup[d]=v,_=!!(v.flags&Ka));if(u!==Number.NEGATIVE_INFINITY)return{height:u,hidden:_};this.partLookup[d]=void 0}}function ex(c,n){const s=c.add(n)._unit();return c.x*s.x+c.y*s.y}function u3(c,n,s,u){const _=n.sub(c)._perp()._unit(),d=s.sub(n)._perp()._unit();return Gy(c,n,s,ex(_,d),u)}function Gy(c,n,s,u,_){const d=Math.sqrt(1-u*u);return Math.min(c.dist(n)/3,n.dist(s)/3,_*d/u)}function ef(c,n,s){return c.x<s[0].x&&n.x<s[0].x||c.x>s[1].x&&n.x>s[1].x||c.y<s[0].y&&n.y<s[0].y||c.y>s[1].y&&n.y>s[1].y}function Xp(c,n){return c.x<n[0].x||c.x>n[1].x||c.y<n[0].y||c.y>n[1].y}function Hy(c,n,s){if(c.x<0||c.x>=Kt||n.x<0||n.x>=Kt||s.x<0||s.x>=Kt)return!1;const u=s.sub(n),_=u.perp(),d=c.sub(n);return(u.x*d.x+u.y*d.y)/Math.sqrt((u.x*u.x+u.y*u.y)*(d.x*d.x+d.y*d.y))>-.866&&_.x*d.x+_.y*d.y<0}function tx(c,n,s){const u=n?2|c:-3&c;return s?1|u:-2&u}function Cd(){const c=Math.PI/32,n=Math.tan(c),s=Ws;return s*Math.sqrt(1+2*n*n)-s}function Yp(c,n,s){const u=1<<s.z,_=no(s.x/u),d=no((s.x+1)/u),v=qi(s.y/u),E=qi((s.y+1)/u);return function(O,z,S,P,L=0,M){const R=[];if(!O.length||!S||!P)return R;const B=(ce,_e)=>{for(const Ce of ce)R.push({polygon:Ce,bounds:_e})},q=Math.ceil(Math.log2(S)),H=Math.ceil(Math.log2(P)),ne=q-H,re=[];for(let ce=0;ce<Math.abs(ne);ce++)re.push(ne>0?0:1);for(let ce=0;ce<Math.min(q,H);ce++)re.push(0),re.push(1);let K=O;if(K=Hp(K,z[0].y-L,z[1].y+L,1),K=Hp(K,z[0].x-L,z[1].x+L,0),!K.length)return R;const ie=[];for(re.length?ie.push({polygons:K,bounds:z,depth:0}):B(K,z);ie.length;){const ce=ie.pop(),_e=ce.depth,Ce=re[_e],Ae=ce.bounds[0],Ee=ce.bounds[1],Ue=Ce===0?Ae.x:Ae.y,Oe=Ce===0?Ee.x:Ee.y,Ve=M?M(Ce,Ue,Oe):.5*(Ue+Oe),Ze=Hp(ce.polygons,Ue-L,Ve+L,Ce),qe=Hp(ce.polygons,Ve-L,Oe+L,Ce);if(Ze.length){const Ke=[Ae,new Pt(Ce===0?Ve:Ee.x,Ce===1?Ve:Ee.y)];re.length>_e+1?ie.push({polygons:Ze,bounds:Ke,depth:_e+1}):B(Ze,Ke)}if(qe.length){const Ke=[new Pt(Ce===0?Ve:Ae.x,Ce===1?Ve:Ae.y),Ee];re.length>_e+1?ie.push({polygons:qe,bounds:Ke,depth:_e+1}):B(qe,Ke)}}return R}(c,n,Math.ceil((d-_)/11.25),Math.ceil((v-E)/11.25),1,(O,z,S)=>{if(O===0)return .5*(z+S);{const P=qi((s.y+z/Kt)/u);return(Ts(.5*(qi((s.y+S/Kt)/u)+P))*u-s.y)*Kt}})}function nx(c,n,s,u,_,d){const v=Math.pow(2,u.z-_.z);for(let E=0;E<s;E++){let O=c.int16[2*(E+n)+0],z=c.int16[2*(E+n)+1];O=(O+_.x*Kt)*v-u.x*Kt,z=(z+_.y*Kt)*v-u.y*Kt,d.push(new Pt(O,z))}}let h0,U_;function Md(c,n){return c.x*n.x+c.y*n.y}function f0(c,n){if(c.length===1){let s=0;const u=n[s++];let _;for(;!_||u.equals(_);)if(_=n[s++],!_)return 1/0;for(;s<n.length;s++){const d=n[s],v=c[0],E=_.sub(u),O=d.sub(u),z=v.sub(u),S=Md(E,E),P=Md(E,O),L=Md(O,O),M=Md(z,E),R=Md(z,O),B=S*L-P*P,q=(L*M-P*R)/B,H=(S*R-P*M)/B,ne=u.z*(1-q-H)+_.z*q+d.z*H;if(isFinite(ne))return ne}return 1/0}{let s=1/0;for(const u of n)s=Math.min(s,u.z);return s}}function Zy(c,n,s,u,_,d,v,E){const O=v*_.getElevationAt(c,n,!0,!0),z=d[0]!==0,S=z?d[1]===0?v*(d[0]/7-450):v*function(P,L,M){const R=Math.floor(L[0]/8),B=Math.floor(L[1]/8),q=10*(L[0]-8*R),H=10*(L[1]-8*B),ne=P.getElevationAt(R,B,!0,!0),re=P.getMeterToDEM(M),K=Math.floor(.5*(q*re-1)),ie=Math.floor(.5*(H*re-1)),ce=P.tileCoordToPixel(R,B),_e=2*K+1,Ce=2*ie+1,Ae=function(qe,Ke,Qe,at,Je){return[qe.getElevationAtPixel(Ke,Qe,!0),qe.getElevationAtPixel(Ke+Je,Qe,!0),qe.getElevationAtPixel(Ke,Qe+Je,!0),qe.getElevationAtPixel(Ke+at,Qe+Je,!0)]}(P,ce.x-K,ce.y-ie,_e,Ce),Ee=Math.abs(Ae[0]-Ae[1]),Ue=Math.abs(Ae[2]-Ae[3]),Oe=Math.abs(Ae[0]-Ae[2])+Math.abs(Ae[1]-Ae[3]),Ve=Math.min(.25,.5*re*(Ee+Ue)/_e),Ze=Math.min(.25,.5*re*Oe/Ce);return ne+Math.max(Ve*q,Ze*H)}(_,d,E):O;return{base:O+(s===0?-1:s),top:z?Math.max(S+u,O+s+2):O+u}}hn(j_,"FillExtrusionBucket",{omit:["layers","features"]}),hn(Ad,"PartData"),hn(K2,"FootprintSegment"),hn(qy,"BorderCentroidData"),hn(Q2,"GroundEffect");const rx=br([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),h3=br([{name:"a_z_offset_width",components:3,type:"Float32"}],4),{members:ix}=rx,d0=br([{name:"a_packed",components:3,type:"Float32"}]),{members:f3}=d0,d3=br([{name:"a_pattern_data",components:3,type:"Float32"}]),{members:p3}=d3;class p0{constructor(n,s){this.width=n,this.height=s,this.nextRow=0,this.image=new qu({width:n,height:s}),this.positions={},this.uploaded=!1}getDash(n,s){const u=this.getKey(n,s);return this.positions[u]}trim(){const n=this.width,s=this.height=uh(this.nextRow);this.image.resize({width:n,height:s})}getKey(n,s){return n.join(",")+s}getDashRanges(n,s,u){const _=[];let d=n.length%2==1?-n[n.length-1]*u:0,v=n[0]*u,E=!0;_.push({left:d,right:v,isDash:E,zeroLength:n[0]===0});let O=n[0];for(let z=1;z<n.length;z++){E=!E;const S=n[z];d=O*u,O+=S,v=O*u,_.push({left:d,right:v,isDash:E,zeroLength:S===0})}return _}addRoundDash(n,s,u){const _=s/2;for(let d=-u;d<=u;d++){const v=this.width*(this.nextRow+u+d);let E=0,O=n[E];for(let z=0;z<this.width;z++){z/O.right>1&&(O=n[++E]);const S=Math.abs(z-O.left),P=Math.abs(z-O.right),L=Math.min(S,P);let M;const R=d/u*(_+1);if(O.isDash){const B=_-Math.abs(R);M=Math.sqrt(L*L+B*B)}else M=_-Math.sqrt(L*L+R*R);this.image.data[v+z]=Math.max(0,Math.min(255,M+128))}}}addRegularDash(n,s){for(let O=n.length-1;O>=0;--O){const z=n[O],S=n[O+1];z.zeroLength?n.splice(O,1):S&&S.isDash===z.isDash&&(S.left=z.left,n.splice(O,1))}const u=n[0],_=n[n.length-1];u.isDash===_.isDash&&(u.left=_.left-this.width,_.right=u.right+this.width);const d=this.width*this.nextRow;let v=0,E=n[v];for(let O=0;O<this.width;O++){O/E.right>1&&(E=n[++v]);const z=Math.abs(O-E.left),S=Math.abs(O-E.right),P=Math.min(z,S);this.image.data[d+O]=Math.max(0,Math.min(255,(E.isDash?P:-P)+s+128))}}addDash(n,s){const u=this.getKey(n,s);if(this.positions[u])return this.positions[u];const _=s==="round",d=_?7:0,v=2*d+1;if(this.nextRow+v>this.height)return qn("LineAtlas out of space"),null;n.length===0&&n.push(1);let E=0;for(let S=0;S<n.length;S++)n[S]<0&&(qn("Negative value is found in line dasharray, replacing values with 0"),n[S]=0),E+=n[S];if(E!==0){const S=this.width/E,P=this.getDashRanges(n,this.width,S);_?this.addRoundDash(P,S,d):this.addRegularDash(P,s==="square"?.5*S:0)}const O=this.nextRow+d;this.nextRow+=v;const z={tl:[O,d],br:[E,0]};return this.positions[u]=z,z}}hn(p0,"LineAtlas");const V_=Td.VectorTileFeature.types,Wy=Math.cos(Math.PI/180*37.5),m3=Math.cos(Math.PI/180*5);class Od{constructor(n){this.evaluationGlobals={zoom:0,lineProgress:void 0},this.zoom=n.zoom,this.evaluationGlobals.zoom=this.zoom,this.overscaling=n.overscaling,this.pixelRatio=n.pixelRatio,this.layers=n.layers,this.layerIds=this.layers.map(s=>s.fqid),this.index=n.index,this.projection=n.projection,this.hasPattern=!1,this.hasZOffset=!1,this.hasCrossSlope=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(s=>{this.gradients[s.id]={}}),this.layoutVertexArray=new jh,this.layoutVertexArray2=new ul,this.patternVertexArray=new ul,this.indexArray=new sa,this.programConfigurations=new Po(n.layers,{zoom:n.zoom,lut:n.lut}),this.segments=new ci,this.maxLineLength=0,this.zOffsetVertexArray=new ul,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id),this.tessellationStep=n.tessellationStep?n.tessellationStep:Kt/64}updateFootprints(n,s){}populate(n,s,u,_){this.hasPattern=M_("line",this.layers,this.pixelRatio,s);const d=this.layers[0].layout.get("line-sort-key");this.tileToMeter=r(u);const v=this.layers[0].layout.get("line-z-offset"),E=v.isConstant()&&!v.constantOr(0),O=this.layers[0].layout.get("line-elevation-reference");this.hasZOffset=O==="sea"||O==="ground"||!E&&O==="none",this.hasZOffset&&O==="none"&&qn(`line-elevation-reference: ground is used for the layer ${this.layerIds[0]} because non-zero line-z-offset value was found.`);const z=this.layers[0].layout.get("line-cross-slope");this.hasCrossSlope=this.hasZOffset&&z!==void 0;const S=[];for(const{feature:R,id:B,index:q,sourceLayerIndex:H}of n){const ne=this.layers[0]._featureFilter.needGeometry,re=Z(R,ne);if(!this.layers[0]._featureFilter.filter(new zr(this.zoom),re,u))continue;const K=d?d.evaluate(re,{},u):void 0,ie={id:B,properties:R.properties,type:R.type,sourceLayerIndex:H,index:q,geometry:ne?re.geometry:$(R,u,_),patterns:{},sortKey:K};S.push(ie)}d&&S.sort((R,B)=>R.sortKey-B.sortKey);const{lineAtlas:P,featureIndex:L}=s,M=this.addConstantDashes(P);for(const R of S){const{geometry:B,index:q,sourceLayerIndex:H}=R;if(M&&this.addFeatureDashes(R,P),this.hasPattern){const ne=O_("line",this.layers,R,this.zoom,this.pixelRatio,s);this.patternFeatures.push(ne)}else this.addFeature(R,B,q,u,P.positions,s.availableImages,s.brightness);L.insert(n[q].feature,B,q,H,this.index)}}addConstantDashes(n){let s=!1;for(const u of this.layers){const _=u.paint.get("line-dasharray").value,d=u.layout.get("line-cap").value;if(_.kind!=="constant"||d.kind!=="constant")s=!0;else{const v=d.value,E=_.value;if(!E)continue;n.addDash(E,v)}}return s}addFeatureDashes(n,s){const u=this.zoom;for(const _ of this.layers){const d=_.paint.get("line-dasharray").value,v=_.layout.get("line-cap").value;if(d.kind==="constant"&&v.kind==="constant")continue;let E,O;if(d.kind==="constant"){if(E=d.value,!E)continue}else E=d.evaluate({zoom:u},n);O=v.kind==="constant"?v.value:v.evaluate({zoom:u},n),s.addDash(E,O),n.patterns[_.id]=s.getKey(E,O)}}update(n,s,u,_,d,v,E){this.programConfigurations.updatePaintArrays(n,s,d,u,_,v,E)}addFeatures(n,s,u,_,d,v){for(const E of this.patternFeatures)this.addFeature(E,E.geometry,E.index,s,u,_,v)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=n.createVertexBuffer(this.layoutVertexArray2,f3)),this.patternVertexArray.length!==0&&(this.patternVertexBuffer=n.createVertexBuffer(this.patternVertexArray,p3)),!this.zOffsetVertexBuffer&&this.zOffsetVertexArray.length>0&&(this.zOffsetVertexBuffer=n.createVertexBuffer(this.zOffsetVertexArray,h3.members,!0)),this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,ix),this.indexBuffer=n.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy(),this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(n){if(n.properties&&n.properties.hasOwnProperty("mapbox_clip_start")&&n.properties.hasOwnProperty("mapbox_clip_end"))return{start:+n.properties.mapbox_clip_start,end:+n.properties.mapbox_clip_end}}addFeature(n,s,u,_,d,v,E){const O=this.layers[0].layout,z=O.get("line-join").evaluate(n,{}),S=O.get("line-cap").evaluate(n,{}),P=O.get("line-miter-limit"),L=O.get("line-round-limit");this.lineClips=this.lineFeatureClips(n),this.lineFeature=n,this.zOffsetValue=O.get("line-z-offset").value;const M=this.layers[0].paint.get("line-width").value;M.kind!=="constant"&&M.isLineProgressConstant===!1&&(this.variableWidthValue=M);for(const R of s)this.addLine(R,n,_,z,S,P,L);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,u,d,v,_,E)}addLine(n,s,u,_,d,v,E){this.distance=0,this.prevDistance=0,this.scaledDistance=0,this.totalDistance=0,this.totalFeatureLength=0,this.lineSoFar=0,this.currentVertex=void 0;const O=_==="none";if(this.patternJoinNone=this.hasPattern&&O,this.segmentStart=0,this.segmentStartf32=0,this.segmentPoints=[],this.lineClips){this.lineClipsArray.push(this.lineClips);for(let re=0;re<n.length-1;re++)this.totalDistance+=n[re].dist(n[re+1]);this.totalFeatureLength=this.totalDistance/(this.lineClips.end-this.lineClips.start),this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const z=V_[s.type]==="Polygon";let S=n.length;for(;S>=2&&n[S-1].equals(n[S-2]);)S--;let P=0;for(;P<S-1&&n[P].equals(n[P+1]);)P++;if(S<(z?3:2))return;_==="bevel"&&(v=1.05);const L=this.segments.prepareSegment(10*S,this.layoutVertexArray,this.indexArray);let M,R,B,q,H,ne;this.e1=this.e2=-1,z&&(M=n[S-2],H=n[P].sub(M)._unit()._perp());for(let re=P;re<S;re++){if(B=re===S-1?z?n[P+1]:void 0:n[re+1],B&&n[re].equals(B))continue;H&&(q=H),M&&(R=M),M=n[re],ne=this.evaluateLineProgressFeatures(R?R.dist(M):0),H=B?B.sub(M)._unit()._perp():q,q=q||H;const K=R&&B;let ie=K?_:z||O?"butt":d;const ce=q.x*H.x+q.y*H.y;if(O){const Ze=function(qe){if(qe.patternJoinNone){const Ke=qe.segmentPoints.length/2,Qe=qe.lineSoFar-qe.segmentStart;for(let at=0;at<Ke;++at){const Je=qe.segmentPoints[2*at+1],wt=Math.round(qe.segmentPoints[2*at])+.5+.25*Je;qe.patternVertexArray.emplaceBack(wt,Qe,qe.segmentStart),qe.patternVertexArray.emplaceBack(wt,Qe,qe.segmentStart)}qe.segmentPoints.length=0}qe.e1=qe.e2=-1};if(K&&ce<m3){this.updateDistance(R,M),this.addCurrentVertex(M,q,1,1,L,ne),Ze(this),this.addCurrentVertex(M,H,-1,-1,L,ne);continue}if(R){if(!B){this.updateDistance(R,M),this.addCurrentVertex(M,q,1,1,L,ne),Ze(this);continue}ie="miter"}}let _e=q.add(H);_e.x===0&&_e.y===0||_e._unit();const Ce=_e.x*H.x+_e.y*H.y,Ae=Ce!==0?1/Ce:1/0,Ee=2*Math.sqrt(2-2*Ce),Ue=Ce<Wy&&R&&B,Oe=q.x*H.y-q.y*H.x>0,Ve=this.overscaling<=16?15*Kt/(512*this.overscaling):0;if(K&&ie==="round"){if(Ae<E)ie="miter";else if(Ae<=2){const Ze=Xy(M,-10,Kt+10);ie=this.hasZOffset&&(Ze||this.hasCrossSlope)?"miter":"fakeround"}}if(ie==="miter"&&Ae>v&&(ie="bevel"),ie==="bevel"&&(Ae>2&&(ie="flipbevel"),Ae<v&&(ie="miter")),R&&!(ie==="miter"&&Ue)&&this.updateDistance(R,M),ie==="miter")if(Ue){const Ze=M.dist(R);if(Ze>2*Ve){const Ke=M.sub(M.sub(R)._mult(Ve/Ze)._round());this.updateDistance(R,Ke),this.addCurrentVertex(Ke,q,0,0,L,ne),R=Ke}this.updateDistance(R,M),_e._mult(Ae),this.addCurrentVertex(M,_e,0,0,L,ne);const qe=M.dist(B);if(qe>2*Ve){const Ke=M.add(B.sub(M)._mult(Ve/qe)._round());this.updateDistance(M,Ke),this.addCurrentVertex(Ke,H,0,0,L,ne),M=Ke}}else _e._mult(Ae),this.addCurrentVertex(M,_e,0,0,L,ne);else if(ie==="flipbevel"){if(Ae>100)_e=H.mult(-1);else{const Ze=Ae*q.add(H).mag()/q.sub(H).mag();_e._perp()._mult(Ze*(Oe?-1:1))}this.addCurrentVertex(M,_e,0,0,L,ne),this.addCurrentVertex(M,_e.mult(-1),0,0,L,ne)}else if(ie==="bevel"||ie==="fakeround"){ne!=null&&R&&this.addCurrentVertex(M,q,-1,-1,L,ne);const Ze=M.dist(R)<=2*Ve&&ie!=="bevel",qe=_e.mult(Oe?1:-1);qe._mult(Ae);const Ke=H.mult(Oe?-1:1),Qe=q.mult(Oe?-1:1),at=this.evaluateLineProgressFeatures(this.distance);if(ne==null&&(this.addHalfVertex(M,qe.x,qe.y,!1,!Oe,0,L,at),Ze||this.addHalfVertex(M,qe.x+2*Qe.x,qe.y+2*Qe.y,!1,Oe,0,L,at)),ie==="fakeround"){const Je=Math.round(180*Ee/Math.PI/20);this.addHalfVertex(M,Qe.x,Qe.y,!1,Oe,0,L,at);for(let wt=0;wt<Je;wt++){let Rt=wt/Je;if(Rt!==.5){const an=Rt-.5;Rt+=Rt*an*(Rt-1)*((1.0904+ce*(ce*(3.55645-1.43519*ce)-3.2452))*an*an+(.848013+ce*(.215638*ce-1.06021)))}const bt=Ke.sub(Qe)._mult(Rt)._add(Qe)._unit();this.addHalfVertex(M,bt.x,bt.y,!1,Oe,0,L,at)}this.addHalfVertex(M,Ke.x,Ke.y,!1,Oe,0,L,at)}Ze||ne!=null||this.addHalfVertex(M,qe.x+2*Ke.x,qe.y+2*Ke.y,!1,Oe,0,L,at),ne!=null&&B&&this.addCurrentVertex(M,H,1,1,L,ne)}else ie==="butt"?this.addCurrentVertex(M,_e,0,0,L,ne):ie==="square"?(R||this.addCurrentVertex(M,_e,-1,-1,L,ne),this.addCurrentVertex(M,_e,0,0,L,ne),R&&this.addCurrentVertex(M,_e,1,1,L,ne)):ie==="round"&&(R&&(this.addCurrentVertex(M,q,0,0,L,ne),this.addCurrentVertex(M,q,1,1,L,ne,!0)),B&&(this.addCurrentVertex(M,H,-1,-1,L,ne,!0),this.addCurrentVertex(M,H,0,0,L,ne)))}}addVerticesTo(n,s,u,_,d,v,E,O,z,S){const P=(s.w-n.w)/this.tessellationStep|0;let L=0;const M=this.scaledDistance;if(P>1){this.lineSoFar=n.w;const B=(s.x-n.x)/P,q=(s.y-n.y)/P,H=(s.z-n.z)/P,ne=(s.w-n.w)/P;for(let re=1;re<P;++re){n.x+=B,n.y+=q,n.z+=H,this.lineSoFar+=ne,L+=ne;const K=this.evaluateLineProgressFeatures(this.prevDistance+L);this.scaledDistance=(this.prevDistance+L)/this.totalDistance,this.addHalfVertex(n,u,_,S,!1,E,z,K),this.addHalfVertex(n,d,v,S,!0,-O,z,K)}}this.lineSoFar=s.w,this.scaledDistance=M;const R=this.evaluateLineProgressFeatures(this.distance);this.addHalfVertex(s,u,_,S,!1,E,z,R),this.addHalfVertex(s,d,v,S,!0,-O,z,R)}evaluateLineProgressFeatures(n){if(!this.variableWidthValue&&!this.hasZOffset)return null;this.evaluationGlobals.lineProgress=0,this.lineClips?this.evaluationGlobals.lineProgress=Math.min(1,(this.totalFeatureLength*this.lineClips.start+n)/this.totalFeatureLength):qn(`line-progress evaluation for ${this.layerIds[0]} requires enabling 'lineMetrics' for the source.`);let s=0;return this.variableWidthValue&&this.variableWidthValue.kind!=="constant"&&(s=this.variableWidthValue.evaluate(this.evaluationGlobals,this.lineFeature)||0),this.hasZOffset?this.zOffsetValue.kind==="constant"?{zOffset:this.zOffsetValue.value,variableWidth:s}:{zOffset:this.zOffsetValue.evaluate(this.evaluationGlobals,this.lineFeature)||0,variableWidth:s}:{zOffset:0,variableWidth:s}}addCurrentVertex(n,s,u,_,d,v,E=!1){const O=s.x+s.y*u,z=s.y-s.x*u,S=s.y*_-s.x,P=-s.y-s.x*_;if(v!=null){const L=this.hasZOffset,M=-10,R=Kt+10,B=v.zOffset,q=new mi(n.x,n.y,B,this.lineSoFar),H=!!L&&Xy(n,M,R),ne=this.lineSoFar,re=this.distance;if(this.currentVertex)if(H){const K=this.currentVertexIsOutside,ie=this.currentVertex,ce=new mi(n.x,n.y,B,this.lineSoFar);if(Z2(ie,ce,M,R),!Xy(ce,M,R)){if(K){this.e1=this.e2=-1,this.distance-=ie.dist(q),this.lineSoFar=ie.w;const _e=this.evaluateLineProgressFeatures(ie.w-this.totalFeatureLength*(this.lineClips?this.lineClips.start:0));this.addHalfVertex(ie,O,z,E,!1,u,d,_e),this.addHalfVertex(ie,S,P,E,!0,-_,d,_e),this.prevDistance=this.distance}this.distance=this.prevDistance+ie.dist(ce),this.scaledDistance=this.distance/this.totalDistance,this.addVerticesTo(ie,ce,O,z,S,P,u,_,d,E),this.distance=re,this.scaledDistance=this.distance/this.totalDistance}}else{const K=this.currentVertex;if(this.currentVertexIsOutside){Z2(K,q,M,R),this.e1=this.e2=-1,this.distance-=K.dist(q),this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=K.w;const ie=this.evaluateLineProgressFeatures(K.w-this.totalFeatureLength*(this.lineClips?this.lineClips.start:0));this.addHalfVertex(K,O,z,E,!1,u,d,ie),this.addHalfVertex(K,S,P,E,!0,-_,d,ie),this.prevDistance=this.distance,this.distance=re,this.scaledDistance=this.distance/this.totalDistance}this.addVerticesTo(K,q,O,z,S,P,u,_,d,E)}else H||(this.addHalfVertex(n,O,z,E,!1,u,d,v),this.addHalfVertex(n,S,P,E,!0,-_,d,v));this.currentVertex=q,this.currentVertexIsOutside=H,this.lineSoFar=ne}else this.addHalfVertex(n,O,z,E,!1,u,d,v),this.addHalfVertex(n,S,P,E,!0,-_,d,v)}addHalfVertex({x:n,y:s},u,_,d,v,E,O,z){if(this.patternJoinNone&&(this.segmentPoints.length===0&&(this.segmentStart=this.lineSoFar,this.segmentStartf32=Math.fround(this.lineSoFar)),v||this.segmentPoints.push(this.lineSoFar-this.segmentStart,E)),this.layoutVertexArray.emplaceBack((n<<1)+(d?1:0),(s<<1)+(v?1:0),Math.round(63*u)+128,Math.round(63*_)+128,1+(E===0?0:E<0?-1:1),0,this.lineSoFar-this.segmentStartf32),this.lineClips){const P=Mn(this.lineClips.start,this.lineClips.end,this.scaledDistance);this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,P)}const S=O.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,S),O.primitiveLength++),v?this.e2=S:this.e1=S,z!=null&&this.zOffsetVertexArray.emplaceBack(z.zOffset,z.variableWidth,z.variableWidth)}updateScaledDistance(){this.lineClips?(this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=this.totalFeatureLength*this.lineClips.start+this.distance):this.lineSoFar=this.distance}updateDistance(n,s){this.prevDistance=this.distance,this.distance+=n.dist(s),this.updateScaledDistance()}}function Xy(c,n,s){return c.x<n||c.x>s||c.y<n||c.y>s}let Yy,Ky;function Jy(c,n,s){return n*(Kt/(c.tileSize*Math.pow(2,s-c.tileID.overscaledZ)))}hn(Od,"LineBucket",{omit:["layers","patternFeatures","currentVertex","currentVertexIsOutside"]});const Qy=(c,n,s)=>(1-s)*c+s*n;function $_(c,n){return 1/Jy(c,1,n.tileZoom)}function ev(c,n,s,u){return c.translatePosMatrix(u||n.tileID.projMatrix,n,s.paint.get("line-translate"),s.paint.get("line-translate-anchor"))}const m0=c=>{const n=[];ax(c)&&n.push("RENDER_LINE_DASH"),c.paint.get("line-gradient")&&n.push("RENDER_LINE_GRADIENT");const s=c.paint.get("line-trim-offset");s[0]===0&&s[1]===0||n.push("RENDER_LINE_TRIM_OFFSET"),c.paint.get("line-border-width").constantOr(1)!==0&&n.push("RENDER_LINE_BORDER");const u=c.layout.get("line-join").constantOr("miter")==="none",_=!!c.paint.get("line-pattern").constantOr(1);return u&&_&&n.push("LINE_JOIN_NONE"),n};function ax(c){const n=c.paint.get("line-dasharray").value;return n.value||n.kind!=="constant"}let tv;const q_=()=>tv||(tv={layout:Yy||(Yy=new ni({"line-cap":new cn(st.layout_line["line-cap"]),"line-join":new cn(st.layout_line["line-join"]),"line-miter-limit":new qt(st.layout_line["line-miter-limit"]),"line-round-limit":new qt(st.layout_line["line-round-limit"]),"line-sort-key":new cn(st.layout_line["line-sort-key"]),"line-z-offset":new cn(st.layout_line["line-z-offset"]),"line-elevation-reference":new qt(st.layout_line["line-elevation-reference"]),"line-cross-slope":new qt(st.layout_line["line-cross-slope"]),visibility:new qt(st.layout_line.visibility),"line-width-unit":new qt(st.layout_line["line-width-unit"])})),paint:Ky||(Ky=new ni({"line-opacity":new cn(st.paint_line["line-opacity"]),"line-color":new cn(st.paint_line["line-color"]),"line-translate":new qt(st.paint_line["line-translate"]),"line-translate-anchor":new qt(st.paint_line["line-translate-anchor"]),"line-width":new cn(st.paint_line["line-width"]),"line-gap-width":new cn(st.paint_line["line-gap-width"]),"line-offset":new cn(st.paint_line["line-offset"]),"line-blur":new cn(st.paint_line["line-blur"]),"line-dasharray":new cn(st.paint_line["line-dasharray"]),"line-pattern":new cn(st.paint_line["line-pattern"]),"line-gradient":new Lu(st.paint_line["line-gradient"]),"line-trim-offset":new qt(st.paint_line["line-trim-offset"]),"line-trim-fade-range":new qt(st.paint_line["line-trim-fade-range"]),"line-trim-color":new qt(st.paint_line["line-trim-color"]),"line-emissive-strength":new qt(st.paint_line["line-emissive-strength"]),"line-border-width":new cn(st.paint_line["line-border-width"]),"line-border-color":new cn(st.paint_line["line-border-color"]),"line-occlusion-opacity":new qt(st.paint_line["line-occlusion-opacity"]),"line-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"}),"line-gradient-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"}),"line-trim-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"}),"line-border-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"})}))},tv);class nv extends cn{possiblyEvaluate(n,s){return s=new zr(Math.floor(s.zoom),{now:s.now,fadeDuration:s.fadeDuration,transition:s.transition}),super.possiblyEvaluate(n,s)}evaluate(n,s,u,_){return s=fa({},s,{zoom:Math.floor(s.zoom)}),super.evaluate(n,s,u,_)}}let tf;function G_(c,n){return n>0?n+2*c:c}const ox=br([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),rv=br([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),nf=br([{name:"a_projected_pos",components:4,type:"Float32"}],4);br([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const rf=br([{name:"a_auto_z_offset",components:1,type:"Float32"}],4),af=br([{name:"a_texb",components:2,type:"Uint16"}]),_0=br([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_elevation_from_sea",components:2,type:"Float32"}]),g0=br([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"},{name:"a_auto_z_offset",components:1,type:"Float32"}]);br([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Hu=br([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),_3=br([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);br([{name:"triangle",components:3,type:"Uint16"}]),br([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),br([{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Float32",name:"zOffset"},{type:"Uint8",name:"hasIconTextFit"}]),br([{type:"Float32",name:"offsetX"}]),br([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var Ua=24;const es=128;function iv(c,n,s,u,_){if(c.kind==="camera")return c.maxSize;if(c.kind==="composite"){const d=n.possiblyEvaluate(new zr(c.maxZoom),s).evaluate(_,{},s),v=n.possiblyEvaluate(new zr(c.minZoom),s).evaluate(_,{},s);return Math.max(d,v)}return n.possiblyEvaluate(new zr(u)).evaluate(_,{},s)}function H_(c,n){const{expression:s}=n;if(s.kind==="constant")return{kind:"constant",layoutSize:s.evaluate(new zr(c+1))};if(s.kind==="source")return{kind:"source"};{const{zoomStops:u,interpolationType:_}=s;let d=0;for(;d<u.length&&u[d]<=c;)d++;d=Math.max(0,d-1);let v=d;for(;v<u.length&&u[v]<c+1;)v++;v=Math.min(u.length-1,v);const E=u[d],O=u[v];return s.kind==="composite"?{kind:"composite",minZoom:E,maxZoom:O,interpolationType:_}:{kind:"camera",minZoom:E,maxZoom:O,minSize:s.evaluate(new zr(E)),maxSize:s.evaluate(new zr(O)),interpolationType:_}}}function Pd(c,{uSize:n,uSizeT:s},{lowerSize:u,upperSize:_}){return c.kind==="source"?u/es:c.kind==="composite"?Mn(u/es,_/es,s):n}function Id(c,n,s=1){let u=0,_=0;if(c.kind==="constant")_=c.layoutSize*s;else if(c.kind!=="source"){const{interpolationType:d,minZoom:v,maxZoom:E}=c,O=d?Bn(li.interpolationFactor(d,n,v,E),0,1):0;c.kind==="camera"?_=Mn(c.minSize,c.maxSize,O)*s:u=O*s}return{uSizeT:u,uSize:_}}var g3=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:es,evaluateSizeForFeature:Pd,evaluateSizeForZoom:Id,getRasterizedIconSize:iv,getSizeData:H_});function Z_(c,n,s){return c.sections.forEach(u=>{u.text=function(_,d,v){const E=d.layout.get("text-transform").evaluate(v,{});return E==="uppercase"?_=_.toLocaleUpperCase():E==="lowercase"&&(_=_.toLocaleLowerCase()),Yr.applyArabicShaping&&(_=Yr.applyArabicShaping(_)),_}(u.text,n,s)}),c}const of={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};function sx(c){return c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""}function y0(c){return c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""}var W_,Kp,av,ov={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */function X_(){return W_||(W_=1,ov.read=function(c,n,s,u,_){var d,v,E=8*_-u-1,O=(1<<E)-1,z=O>>1,S=-7,P=s?_-1:0,L=s?-1:1,M=c[n+P];for(P+=L,d=M&(1<<-S)-1,M>>=-S,S+=E;S>0;d=256*d+c[n+P],P+=L,S-=8);for(v=d&(1<<-S)-1,d>>=-S,S+=u;S>0;v=256*v+c[n+P],P+=L,S-=8);if(d===0)d=1-z;else{if(d===O)return v?NaN:1/0*(M?-1:1);v+=Math.pow(2,u),d-=z}return(M?-1:1)*v*Math.pow(2,d-u)},ov.write=function(c,n,s,u,_,d){var v,E,O,z=8*d-_-1,S=(1<<z)-1,P=S>>1,L=_===23?Math.pow(2,-24)-Math.pow(2,-77):0,M=u?0:d-1,R=u?1:-1,B=n<0||n===0&&1/n<0?1:0;for(n=Math.abs(n),isNaN(n)||n===1/0?(E=isNaN(n)?1:0,v=S):(v=Math.floor(Math.log(n)/Math.LN2),n*(O=Math.pow(2,-v))<1&&(v--,O*=2),(n+=v+P>=1?L/O:L*Math.pow(2,1-P))*O>=2&&(v++,O/=2),v+P>=S?(E=0,v=S):v+P>=1?(E=(n*O-1)*Math.pow(2,_),v+=P):(E=n*Math.pow(2,P-1)*Math.pow(2,_),v=0));_>=8;c[s+M]=255&E,M+=R,E/=256,_-=8);for(v=v<<_|E,z+=_;z>0;c[s+M]=255&v,M+=R,v/=256,z-=8);c[s+M-R]|=128*B}),ov}function f(){if(av)return Kp;av=1,Kp=n;var c=X_();function n(K){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(K)?K:new Uint8Array(K||0),this.pos=0,this.type=0,this.length=this.buf.length}n.Varint=0,n.Fixed64=1,n.Bytes=2,n.Fixed32=5;var s=4294967296,u=1/s,_=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function d(K){return K.type===n.Bytes?K.readVarint()+K.pos:K.pos+1}function v(K,ie,ce){return ce?4294967296*ie+(K>>>0):4294967296*(ie>>>0)+(K>>>0)}function E(K,ie,ce){var _e=ie<=16383?1:ie<=2097151?2:ie<=268435455?3:Math.floor(Math.log(ie)/(7*Math.LN2));ce.realloc(_e);for(var Ce=ce.pos-1;Ce>=K;Ce--)ce.buf[Ce+_e]=ce.buf[Ce]}function O(K,ie){for(var ce=0;ce<K.length;ce++)ie.writeVarint(K[ce])}function z(K,ie){for(var ce=0;ce<K.length;ce++)ie.writeSVarint(K[ce])}function S(K,ie){for(var ce=0;ce<K.length;ce++)ie.writeFloat(K[ce])}function P(K,ie){for(var ce=0;ce<K.length;ce++)ie.writeDouble(K[ce])}function L(K,ie){for(var ce=0;ce<K.length;ce++)ie.writeBoolean(K[ce])}function M(K,ie){for(var ce=0;ce<K.length;ce++)ie.writeFixed32(K[ce])}function R(K,ie){for(var ce=0;ce<K.length;ce++)ie.writeSFixed32(K[ce])}function B(K,ie){for(var ce=0;ce<K.length;ce++)ie.writeFixed64(K[ce])}function q(K,ie){for(var ce=0;ce<K.length;ce++)ie.writeSFixed64(K[ce])}function H(K,ie){return(K[ie]|K[ie+1]<<8|K[ie+2]<<16)+16777216*K[ie+3]}function ne(K,ie,ce){K[ce]=ie,K[ce+1]=ie>>>8,K[ce+2]=ie>>>16,K[ce+3]=ie>>>24}function re(K,ie){return(K[ie]|K[ie+1]<<8|K[ie+2]<<16)+(K[ie+3]<<24)}return n.prototype={destroy:function(){this.buf=null},readFields:function(K,ie,ce){for(ce=ce||this.length;this.pos<ce;){var _e=this.readVarint(),Ce=_e>>3,Ae=this.pos;this.type=7&_e,K(Ce,ie,this),this.pos===Ae&&this.skip(_e)}return ie},readMessage:function(K,ie){return this.readFields(K,ie,this.readVarint()+this.pos)},readFixed32:function(){var K=H(this.buf,this.pos);return this.pos+=4,K},readSFixed32:function(){var K=re(this.buf,this.pos);return this.pos+=4,K},readFixed64:function(){var K=H(this.buf,this.pos)+H(this.buf,this.pos+4)*s;return this.pos+=8,K},readSFixed64:function(){var K=H(this.buf,this.pos)+re(this.buf,this.pos+4)*s;return this.pos+=8,K},readFloat:function(){var K=c.read(this.buf,this.pos,!0,23,4);return this.pos+=4,K},readDouble:function(){var K=c.read(this.buf,this.pos,!0,52,8);return this.pos+=8,K},readVarint:function(K){var ie,ce,_e=this.buf;return ie=127&(ce=_e[this.pos++]),ce<128?ie:(ie|=(127&(ce=_e[this.pos++]))<<7,ce<128?ie:(ie|=(127&(ce=_e[this.pos++]))<<14,ce<128?ie:(ie|=(127&(ce=_e[this.pos++]))<<21,ce<128?ie:function(Ce,Ae,Ee){var Ue,Oe,Ve=Ee.buf;if(Ue=(112&(Oe=Ve[Ee.pos++]))>>4,Oe<128||(Ue|=(127&(Oe=Ve[Ee.pos++]))<<3,Oe<128)||(Ue|=(127&(Oe=Ve[Ee.pos++]))<<10,Oe<128)||(Ue|=(127&(Oe=Ve[Ee.pos++]))<<17,Oe<128)||(Ue|=(127&(Oe=Ve[Ee.pos++]))<<24,Oe<128)||(Ue|=(1&(Oe=Ve[Ee.pos++]))<<31,Oe<128))return v(Ce,Ue,Ae);throw new Error("Expected varint not more than 10 bytes")}(ie|=(15&(ce=_e[this.pos]))<<28,K,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var K=this.readVarint();return K%2==1?(K+1)/-2:K/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var K=this.readVarint()+this.pos,ie=this.pos;return this.pos=K,K-ie>=12&&_?function(ce,_e,Ce){return _.decode(ce.subarray(_e,Ce))}(this.buf,ie,K):function(ce,_e,Ce){for(var Ae="",Ee=_e;Ee<Ce;){var Ue,Oe,Ve,Ze=ce[Ee],qe=null,Ke=Ze>239?4:Ze>223?3:Ze>191?2:1;if(Ee+Ke>Ce)break;Ke===1?Ze<128&&(qe=Ze):Ke===2?(192&(Ue=ce[Ee+1]))==128&&(qe=(31&Ze)<<6|63&Ue)<=127&&(qe=null):Ke===3?(Oe=ce[Ee+2],(192&(Ue=ce[Ee+1]))==128&&(192&Oe)==128&&((qe=(15&Ze)<<12|(63&Ue)<<6|63&Oe)<=2047||qe>=55296&&qe<=57343)&&(qe=null)):Ke===4&&(Oe=ce[Ee+2],Ve=ce[Ee+3],(192&(Ue=ce[Ee+1]))==128&&(192&Oe)==128&&(192&Ve)==128&&((qe=(15&Ze)<<18|(63&Ue)<<12|(63&Oe)<<6|63&Ve)<=65535||qe>=1114112)&&(qe=null)),qe===null?(qe=65533,Ke=1):qe>65535&&(qe-=65536,Ae+=String.fromCharCode(qe>>>10&1023|55296),qe=56320|1023&qe),Ae+=String.fromCharCode(qe),Ee+=Ke}return Ae}(this.buf,ie,K)},readBytes:function(){var K=this.readVarint()+this.pos,ie=this.buf.subarray(this.pos,K);return this.pos=K,ie},readPackedVarint:function(K,ie){if(this.type!==n.Bytes)return K.push(this.readVarint(ie));var ce=d(this);for(K=K||[];this.pos<ce;)K.push(this.readVarint(ie));return K},readPackedSVarint:function(K){if(this.type!==n.Bytes)return K.push(this.readSVarint());var ie=d(this);for(K=K||[];this.pos<ie;)K.push(this.readSVarint());return K},readPackedBoolean:function(K){if(this.type!==n.Bytes)return K.push(this.readBoolean());var ie=d(this);for(K=K||[];this.pos<ie;)K.push(this.readBoolean());return K},readPackedFloat:function(K){if(this.type!==n.Bytes)return K.push(this.readFloat());var ie=d(this);for(K=K||[];this.pos<ie;)K.push(this.readFloat());return K},readPackedDouble:function(K){if(this.type!==n.Bytes)return K.push(this.readDouble());var ie=d(this);for(K=K||[];this.pos<ie;)K.push(this.readDouble());return K},readPackedFixed32:function(K){if(this.type!==n.Bytes)return K.push(this.readFixed32());var ie=d(this);for(K=K||[];this.pos<ie;)K.push(this.readFixed32());return K},readPackedSFixed32:function(K){if(this.type!==n.Bytes)return K.push(this.readSFixed32());var ie=d(this);for(K=K||[];this.pos<ie;)K.push(this.readSFixed32());return K},readPackedFixed64:function(K){if(this.type!==n.Bytes)return K.push(this.readFixed64());var ie=d(this);for(K=K||[];this.pos<ie;)K.push(this.readFixed64());return K},readPackedSFixed64:function(K){if(this.type!==n.Bytes)return K.push(this.readSFixed64());var ie=d(this);for(K=K||[];this.pos<ie;)K.push(this.readSFixed64());return K},skip:function(K){var ie=7&K;if(ie===n.Varint)for(;this.buf[this.pos++]>127;);else if(ie===n.Bytes)this.pos=this.readVarint()+this.pos;else if(ie===n.Fixed32)this.pos+=4;else{if(ie!==n.Fixed64)throw new Error("Unimplemented type: "+ie);this.pos+=8}},writeTag:function(K,ie){this.writeVarint(K<<3|ie)},realloc:function(K){for(var ie=this.length||16;ie<this.pos+K;)ie*=2;if(ie!==this.length){var ce=new Uint8Array(ie);ce.set(this.buf),this.buf=ce,this.length=ie}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(K){this.realloc(4),ne(this.buf,K,this.pos),this.pos+=4},writeSFixed32:function(K){this.realloc(4),ne(this.buf,K,this.pos),this.pos+=4},writeFixed64:function(K){this.realloc(8),ne(this.buf,-1&K,this.pos),ne(this.buf,Math.floor(K*u),this.pos+4),this.pos+=8},writeSFixed64:function(K){this.realloc(8),ne(this.buf,-1&K,this.pos),ne(this.buf,Math.floor(K*u),this.pos+4),this.pos+=8},writeVarint:function(K){(K=+K||0)>268435455||K<0?function(ie,ce){var _e,Ce;if(ie>=0?(_e=ie%4294967296|0,Ce=ie/4294967296|0):(Ce=~(-ie/4294967296),4294967295^(_e=~(-ie%4294967296))?_e=_e+1|0:(_e=0,Ce=Ce+1|0)),ie>=18446744073709552e3||ie<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");ce.realloc(10),function(Ae,Ee,Ue){Ue.buf[Ue.pos++]=127&Ae|128,Ae>>>=7,Ue.buf[Ue.pos++]=127&Ae|128,Ae>>>=7,Ue.buf[Ue.pos++]=127&Ae|128,Ae>>>=7,Ue.buf[Ue.pos++]=127&Ae|128,Ue.buf[Ue.pos]=127&(Ae>>>=7)}(_e,0,ce),function(Ae,Ee){var Ue=(7&Ae)<<4;Ee.buf[Ee.pos++]|=Ue|((Ae>>>=3)?128:0),Ae&&(Ee.buf[Ee.pos++]=127&Ae|((Ae>>>=7)?128:0),Ae&&(Ee.buf[Ee.pos++]=127&Ae|((Ae>>>=7)?128:0),Ae&&(Ee.buf[Ee.pos++]=127&Ae|((Ae>>>=7)?128:0),Ae&&(Ee.buf[Ee.pos++]=127&Ae|((Ae>>>=7)?128:0),Ae&&(Ee.buf[Ee.pos++]=127&Ae)))))}(Ce,ce)}(K,this):(this.realloc(4),this.buf[this.pos++]=127&K|(K>127?128:0),K<=127||(this.buf[this.pos++]=127&(K>>>=7)|(K>127?128:0),K<=127||(this.buf[this.pos++]=127&(K>>>=7)|(K>127?128:0),K<=127||(this.buf[this.pos++]=K>>>7&127))))},writeSVarint:function(K){this.writeVarint(K<0?2*-K-1:2*K)},writeBoolean:function(K){this.writeVarint(!!K)},writeString:function(K){K=String(K),this.realloc(4*K.length),this.pos++;var ie=this.pos;this.pos=function(_e,Ce,Ae){for(var Ee,Ue,Oe=0;Oe<Ce.length;Oe++){if((Ee=Ce.charCodeAt(Oe))>55295&&Ee<57344){if(!Ue){Ee>56319||Oe+1===Ce.length?(_e[Ae++]=239,_e[Ae++]=191,_e[Ae++]=189):Ue=Ee;continue}if(Ee<56320){_e[Ae++]=239,_e[Ae++]=191,_e[Ae++]=189,Ue=Ee;continue}Ee=Ue-55296<<10|Ee-56320|65536,Ue=null}else Ue&&(_e[Ae++]=239,_e[Ae++]=191,_e[Ae++]=189,Ue=null);Ee<128?_e[Ae++]=Ee:(Ee<2048?_e[Ae++]=Ee>>6|192:(Ee<65536?_e[Ae++]=Ee>>12|224:(_e[Ae++]=Ee>>18|240,_e[Ae++]=Ee>>12&63|128),_e[Ae++]=Ee>>6&63|128),_e[Ae++]=63&Ee|128)}return Ae}(this.buf,K,this.pos);var ce=this.pos-ie;ce>=128&&E(ie,ce,this),this.pos=ie-1,this.writeVarint(ce),this.pos+=ce},writeFloat:function(K){this.realloc(4),c.write(this.buf,K,this.pos,!0,23,4),this.pos+=4},writeDouble:function(K){this.realloc(8),c.write(this.buf,K,this.pos,!0,52,8),this.pos+=8},writeBytes:function(K){var ie=K.length;this.writeVarint(ie),this.realloc(ie);for(var ce=0;ce<ie;ce++)this.buf[this.pos++]=K[ce]},writeRawMessage:function(K,ie){this.pos++;var ce=this.pos;K(ie,this);var _e=this.pos-ce;_e>=128&&E(ce,_e,this),this.pos=ce-1,this.writeVarint(_e),this.pos+=_e},writeMessage:function(K,ie,ce){this.writeTag(K,n.Bytes),this.writeRawMessage(ie,ce)},writePackedVarint:function(K,ie){ie.length&&this.writeMessage(K,O,ie)},writePackedSVarint:function(K,ie){ie.length&&this.writeMessage(K,z,ie)},writePackedBoolean:function(K,ie){ie.length&&this.writeMessage(K,L,ie)},writePackedFloat:function(K,ie){ie.length&&this.writeMessage(K,S,ie)},writePackedDouble:function(K,ie){ie.length&&this.writeMessage(K,P,ie)},writePackedFixed32:function(K,ie){ie.length&&this.writeMessage(K,M,ie)},writePackedSFixed32:function(K,ie){ie.length&&this.writeMessage(K,R,ie)},writePackedFixed64:function(K,ie){ie.length&&this.writeMessage(K,B,ie)},writePackedSFixed64:function(K,ie){ie.length&&this.writeMessage(K,q,ie)},writeBytesField:function(K,ie){this.writeTag(K,n.Bytes),this.writeBytes(ie)},writeFixed32Field:function(K,ie){this.writeTag(K,n.Fixed32),this.writeFixed32(ie)},writeSFixed32Field:function(K,ie){this.writeTag(K,n.Fixed32),this.writeSFixed32(ie)},writeFixed64Field:function(K,ie){this.writeTag(K,n.Fixed64),this.writeFixed64(ie)},writeSFixed64Field:function(K,ie){this.writeTag(K,n.Fixed64),this.writeSFixed64(ie)},writeVarintField:function(K,ie){this.writeTag(K,n.Varint),this.writeVarint(ie)},writeSVarintField:function(K,ie){this.writeTag(K,n.Varint),this.writeSVarint(ie)},writeStringField:function(K,ie){this.writeTag(K,n.Bytes),this.writeString(ie)},writeFloatField:function(K,ie){this.writeTag(K,n.Fixed32),this.writeFloat(ie)},writeDoubleField:function(K,ie){this.writeTag(K,n.Fixed64),this.writeDouble(ie)},writeBooleanField:function(K,ie){this.writeVarintField(K,!!ie)}},Kp}var g=C(f());const T=3;function k(c,n,s){n.glyphs=[],c===1&&s.readMessage(V,n)}function V(c,n,s){if(c===3){const{id:u,bitmap:_,width:d,height:v,left:E,top:O,advance:z}=s.readMessage(Q,{});n.glyphs.push({id:u,bitmap:new qu({width:d+2*T,height:v+2*T},_),metrics:{width:d,height:v,left:E,top:O,advance:z}})}else c===4?n.ascender=s.readSVarint():c===5&&(n.descender=s.readSVarint())}function Q(c,n,s){c===1?n.id=s.readVarint():c===2?n.bitmap=s.readBytes():c===3?n.width=s.readVarint():c===4?n.height=s.readVarint():c===5?n.left=s.readSVarint():c===6?n.top=s.readSVarint():c===7&&(n.advance=s.readVarint())}const be=T,Be={horizontal:1,vertical:2,horizontalOnly:3};class rt{constructor(){this.scale=1,this.fontStack="",this.image=null}static forText(n,s){const u=new rt;return u.scale=n||1,u.fontStack=s,u}static forImage(n){const s=new rt;return s.image=n,s}}class Tt{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(n,s){const u=new Tt;for(let _=0;_<n.sections.length;_++){const d=n.sections[_];d.image?u.addImageSection(d):u.addTextSection(d,s)}return u}length(){return this.text.length}getSection(n){return this.sections[this.sectionIndex[n]]}getSections(){return this.sections}getSectionIndex(n){return this.sectionIndex[n]}getCodePoint(n){return this.text.codePointAt(n)}verticalizePunctuation(n){this.text=function(s,u){let _="";for(let d=0;d<s.length;d++){const v=s.charCodeAt(d+1)||null,E=s.charCodeAt(d-1)||null;_+=!u&&(v&&$l(v)&&!of[s[d+1]]||E&&$l(E)&&!of[s[d-1]])||!of[s[d]]?s[d]:of[s[d]]}return _}(this.text,n)}trim(){let n=0;for(let u=0;u<this.text.length&&mn[this.text.charCodeAt(u)];u++)n++;let s=this.text.length;for(let u=this.text.length-1;u>=0&&u>=n&&mn[this.text.charCodeAt(u)];u--)s--;this.text=this.text.substring(n,s),this.sectionIndex=this.sectionIndex.slice(n,s)}substring(n,s){const u=new Tt;return u.text=this.text.substring(n,s),u.sectionIndex=this.sectionIndex.slice(n,s),u.sections=this.sections,u}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((n,s)=>Math.max(n,this.sections[s].scale),0)}addTextSection(n,s){this.text+=n.text,this.sections.push(rt.forText(n.scale,n.fontStack||s));const u=this.sections.length-1;for(let _=0;_<n.text.length;++_)this.sectionIndex.push(u)}addImageSection(n){const s=n.image&&n.image.namePrimary?n.image.getPrimary():null;if(!s)return void qn("Can't add FormattedSection with an empty image.");const u=this.getNextImageSectionCharCode();u?(this.text+=String.fromCodePoint(u),this.sections.push(rt.forImage(s)),this.sectionIndex.push(this.sections.length-1)):qn("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function en(c,n,s,u,_,d,v,E,O,z,S,P,L,M,R){const B=Tt.fromFeature(c,_);P===Be.vertical&&B.verticalizePunctuation(L);let q=[];const H=function(ce,_e,Ce,Ae,Ee,Ue){if(!ce)return[];const Oe=[],Ve=function(Qe,at,Je,wt,Rt,bt){let an=0;for(let Jt=0;Jt<Qe.length();Jt++){const Ut=Qe.getSection(Jt);an+=Qt(Qe.getCodePoint(Jt),Ut,wt,Rt,at,bt)}return an/Math.max(1,Math.ceil(an/Je))}(ce,_e,Ce,Ae,Ee,Ue),Ze=ce.text.indexOf("")>=0;let qe=0;for(let Qe=0;Qe<ce.length();Qe++){const at=ce.getSection(Qe),Je=ce.getCodePoint(Qe);if(mn[Je]||(qe+=Qt(Je,at,Ae,Ee,_e,Ue)),Qe<ce.length()-1){const wt=!((Ke=Je)<11904||!(Yt["Bopomofo Extended"](Ke)||Yt.Bopomofo(Ke)||Yt["CJK Compatibility Forms"](Ke)||Yt["CJK Compatibility Ideographs"](Ke)||Yt["CJK Compatibility"](Ke)||Yt["CJK Radicals Supplement"](Ke)||Yt["CJK Strokes"](Ke)||Yt["CJK Symbols and Punctuation"](Ke)||Yt["CJK Unified Ideographs Extension A"](Ke)||Yt["CJK Unified Ideographs"](Ke)||Yt["Enclosed CJK Letters and Months"](Ke)||Yt["Halfwidth and Fullwidth Forms"](Ke)||Yt.Hiragana(Ke)||Yt["Ideographic Description Characters"](Ke)||Yt["Kangxi Radicals"](Ke)||Yt["Katakana Phonetic Extensions"](Ke)||Yt.Katakana(Ke)||Yt["Vertical Forms"](Ke)||Yt["Yi Radicals"](Ke)||Yt["Yi Syllables"](Ke)));(Ft[Je]||wt||at.image)&&Oe.push(Qi(Qe+1,qe,Ve,Oe,Ar(Je,ce.getCodePoint(Qe+1),wt&&Ze),!1))}}var Ke;return Mt(Qi(ce.length(),qe,Ve,Oe,0,!0))}(B,z,d,n,u,M),{processBidirectionalText:ne,processStyledBidirectionalText:re}=Yr;if(ne&&B.sections.length===1){const ce=ne(B.toString(),H);for(const _e of ce){const Ce=new Tt;Ce.text=_e,Ce.sections=B.sections;for(let Ae=0;Ae<_e.length;Ae++)Ce.sectionIndex.push(0);q.push(Ce)}}else if(re){const ce=re(B.text,B.sectionIndex,H);for(const _e of ce){const Ce=new Tt;Ce.text=_e[0],Ce.sectionIndex=_e[1],Ce.sections=B.sections,q.push(Ce)}}else q=function(ce,_e){const Ce=[],Ae=ce.text;let Ee=0;for(const Ue of _e)Ce.push(ce.substring(Ee,Ue)),Ee=Ue;return Ee<Ae.length&&Ce.push(ce.substring(Ee,Ae.length)),Ce}(B,H);const K=[],ie={positionedLines:K,text:B.toString(),top:S[1],bottom:S[1],left:S[0],right:S[0],writingMode:P,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(ce,_e,Ce,Ae,Ee,Ue,Oe,Ve,Ze,qe,Ke,Qe){let at=0,Je=0,wt=0;const Rt=Ve==="right"?1:Ve==="left"?0:.5;let bt=!1;for(const ln of Ee){const pn=ln.getSections();for(const zn of pn){if(zn.image)continue;const Gn=_e[zn.fontStack];if(Gn&&(bt=Gn.ascender!==void 0&&Gn.descender!==void 0,!bt))break}if(!bt)break}let an=0;for(const ln of Ee){ln.trim();const pn=ln.getMaxScale(),zn=(pn-1)*Ua,Gn={positionedGlyphs:[],lineOffset:0};ce.positionedLines[an]=Gn;const Zn=Gn.positionedGlyphs;let Wn=0;if(!ln.length()){Je+=Ue,++an;continue}let lr=0,ur=0;for(let Lr=0;Lr<ln.length();Lr++){const jn=ln.getSection(Lr),Ir=ln.getSectionIndex(Lr),Rr=ln.getCodePoint(Lr);let ri=jn.scale,Bi=null,ta=null,Ni=null,Oi=Ua,Hi=0;const la=!(Ze===Be.horizontal||!Ke&&!Vl(Rr)||Ke&&(mn[Rr]||(Jt=Rr,Yt.Arabic(Jt)||Yt["Arabic Supplement"](Jt)||Yt["Arabic Extended-A"](Jt)||Yt["Arabic Presentation Forms-A"](Jt)||Yt["Arabic Presentation Forms-B"](Jt))));if(jn.image){const vo=Ae[jn.image.serialize()];if(!vo)continue;Ni=jn.image.id,ce.iconsInText=ce.iconsInText||!0,ta=vo.paddedRect;const Qr=vo.displaySize;ri=ri*Ua/Qe,Bi={width:Qr[0],height:Qr[1],left:0,top:-3,advance:la?Qr[1]:Qr[0],localGlyph:!1},Hi=bt?-Bi.height*ri:pn*Ua-17-Qr[1]*ri,Oi=Bi.advance;const Ks=(la?Qr[0]:Qr[1])*ri-Ua*pn;Ks>0&&Ks>Wn&&(Wn=Ks)}else{const vo=Ce[jn.fontStack];if(!vo)continue;vo[Rr]&&(ta=vo[Rr]);const Qr=_e[jn.fontStack];if(!Qr)continue;const Ks=Qr.glyphs[Rr];if(!Ks)continue;if(Bi=Ks.metrics,Oi=Rr!==8203?Ua:0,bt){const Ku=Qr.ascender!==void 0?Math.abs(Qr.ascender):0,Jc=Qr.descender!==void 0?Math.abs(Qr.descender):0,Qc=(Ku+Jc)*ri;lr<Qc&&(lr=Qc,ur=(Ku-Jc)/2*ri),Hi=-Ku*ri}else Hi=(pn-ri)*Ua-17}la?(ce.verticalizable=!0,Zn.push({glyph:Rr,imageName:Ni,x:at,y:Je+Hi,vertical:la,scale:ri,localGlyph:Bi.localGlyph,fontStack:jn.fontStack,sectionIndex:Ir,metrics:Bi,rect:ta}),at+=Oi*ri+qe):(Zn.push({glyph:Rr,imageName:Ni,x:at,y:Je+Hi,vertical:la,scale:ri,localGlyph:Bi.localGlyph,fontStack:jn.fontStack,sectionIndex:Ir,metrics:Bi,rect:ta}),at+=Bi.advance*ri+qe)}Zn.length!==0&&(wt=Math.max(at-qe,wt),bt?Dt(Zn,Rt,Wn,ur,Ue*pn/2):Dt(Zn,Rt,Wn,0,Ue/2)),at=0;const Zr=Ue*pn+Wn;Gn.lineOffset=Math.max(Wn,zn),Je+=Zr,++an}var Jt;const Ut=Je,{horizontalAlign:kt,verticalAlign:vn}=xt(Oe);(function(ln,pn,zn,Gn,Zn,Wn){const lr=(pn-zn)*Zn,ur=-Wn*Gn;for(const Zr of ln)for(const Lr of Zr.positionedGlyphs)Lr.x+=lr,Lr.y+=ur})(ce.positionedLines,Rt,kt,vn,wt,Ut),ce.top+=-vn*Ut,ce.bottom=ce.top+Ut,ce.left+=-kt*wt,ce.right=ce.left+wt,ce.hasBaseline=bt}(ie,n,s,u,q,v,E,O,P,z,L,R),!function(ce){for(const _e of ce)if(_e.positionedGlyphs.length!==0)return!1;return!0}(K)&&ie}const mn={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Ft={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function Qt(c,n,s,u,_,d){if(n.image){const v=u[n.image.serialize()];return v?v.displaySize[0]*n.scale*Ua/d+_:0}{const v=s[n.fontStack],E=v&&v.glyphs[c];return E?E.metrics.advance*n.scale+_:0}}function Hn(c,n,s,u){const _=Math.pow(c-n,2);return u?c<n?_/2:2*_:_+Math.abs(s)*s}function Ar(c,n,s){let u=0;return c===10&&(u-=1e4),s&&(u+=150),c!==40&&c!==65288||(u+=50),n!==41&&n!==65289||(u+=50),u}function Qi(c,n,s,u,_,d){let v=null,E=Hn(n,s,_,d);for(const O of u){const z=Hn(n-O.x,s,_,d)+O.badness;z<=E&&(v=O,E=z)}return{index:c,x:n,priorBreak:v,badness:E}}function Mt(c){return c?Mt(c.priorBreak).concat(c.index):[]}function xt(c){let n=.5,s=.5;switch(c){case"right":case"top-right":case"bottom-right":n=1;break;case"left":case"top-left":case"bottom-left":n=0}switch(c){case"bottom":case"bottom-right":case"bottom-left":s=1;break;case"top":case"top-right":case"top-left":s=0}return{horizontalAlign:n,verticalAlign:s}}function Dt(c,n,s,u,_){if(!(n||s||u||_))return;const d=c.length-1,v=c[d],E=(v.x+v.metrics.advance*v.scale)*n;for(let O=0;O<=d;O++)c[O].x-=E,c[O].y+=s+u+_}function un(c,n,s,u){const{horizontalAlign:_,verticalAlign:d}=xt(u),v=s[0]-c.displaySize[0]*_,E=s[1]-c.displaySize[1]*d;return{imagePrimary:c,imageSecondary:n,top:E,bottom:E+c.displaySize[1],left:v,right:v+c.displaySize[0]}}function Un(c,n,s,u,_,d){const v=c.imagePrimary;let E;if(v.content){const q=v.content,H=v.pixelRatio||1;E=[q[0]/H,q[1]/H,v.displaySize[0]-q[2]/H,v.displaySize[1]-q[3]/H]}const O=n.left*d,z=n.right*d;let S,P,L,M;s==="width"||s==="both"?(M=_[0]+O-u[3],P=_[0]+z+u[1]):(M=_[0]+(O+z-v.displaySize[0])/2,P=M+v.displaySize[0]);const R=n.top*d,B=n.bottom*d;return s==="height"||s==="both"?(S=_[1]+R-u[0],L=_[1]+B+u[2]):(S=_[1]+(R+B-v.displaySize[1])/2,L=S+v.displaySize[1]),{imagePrimary:v,imageSecondary:void 0,top:S,right:P,bottom:L,left:M,collisionPadding:E}}class wr extends Pt{constructor(n,s,u,_,d){super(n,s),this.angle=_,this.z=u,d!==void 0&&(this.segment=d)}clone(){return new wr(this.x,this.y,this.z,this.angle,this.segment)}}function nr(c,n,s,u,_){if(n.segment===void 0)return!0;let d=n,v=n.segment+1,E=0;for(;E>-s/2;){if(v--,v<0)return!1;E-=c[v].dist(d),d=c[v]}E+=c[v].dist(c[v+1]),v++;const O=[];let z=0;for(;E<s/2;){const S=c[v],P=c[v+1];if(!P)return!1;let L=c[v-1].angleTo(S)-S.angleTo(P);for(L=Math.abs((L+3*Math.PI)%(2*Math.PI)-Math.PI),O.push({distance:E,angleDelta:L}),z+=L;E-O[0].distance>u;)z-=O.shift().angleDelta;if(z>_)return!1;v++,E+=S.dist(P)}return!0}function fr(c){let n=0;for(let s=0;s<c.length-1;s++)n+=c[s].dist(c[s+1]);return n}function Ja(c,n,s){return c?.6*n*s:0}function Jr(c,n){return Math.max(c?c.right-c.left:0,n?n.right-n.left:0)}function sf(c,n,s,u,_,d){const v=Ja(s,_,d),E=Jr(s,u)*d;let O=0;const z=fr(c)/2;for(let S=0;S<c.length-1;S++){const P=c[S],L=c[S+1],M=P.dist(L);if(O+M>z){const R=(z-O)/M,B=Mn(P.x,L.x,R),q=Mn(P.y,L.y,R),H=new wr(B,q,0,L.angleTo(P),S);return!v||nr(c,H,E,v,n)?H:void 0}O+=M}}function y3(c,n,s,u,_,d,v,E,O){const z=Ja(u,d,v),S=Jr(u,_),P=S*v,L=c[0].x===0||c[0].x===O||c[0].y===0||c[0].y===O;return n-P<n/4&&(n=P+n/4),uI(c,L?n/2*E%n:(S/2+2*d)*v*E%n,n,z,s,P,L,!1,O)}function uI(c,n,s,u,_,d,v,E,O){const z=d/2,S=fr(c);let P=0,L=n-s,M=[];for(let R=0;R<c.length-1;R++){const B=c[R],q=c[R+1],H=B.dist(q),ne=q.angleTo(B);for(;L+s<P+H;){L+=s;const re=(L-P)/H,K=Mn(B.x,q.x,re),ie=Mn(B.y,q.y,re);if(K>=0&&K<O&&ie>=0&&ie<O&&L-z>=0&&L+z<=S){const ce=new wr(K,ie,0,ne,R);u&&!nr(c,ce,d,u,_)||M.push(ce)}}P+=H}return E||M.length||v||(M=uI(c,P/2,s,u,_,d,v,!0,O)),M}function hI(c,n,s,u,_){const d=[];for(let v=0;v<c.length;v++){const E=c[v];let O;for(let z=0;z<E.length-1;z++){let S=E[z],P=E[z+1];S.x<n&&P.x<n||(S.x<n?S=new Pt(n,S.y+(n-S.x)/(P.x-S.x)*(P.y-S.y))._round():P.x<n&&(P=new Pt(n,S.y+(n-S.x)/(P.x-S.x)*(P.y-S.y))._round()),S.y<s&&P.y<s||(S.y<s?S=new Pt(S.x+(s-S.y)/(P.y-S.y)*(P.x-S.x),s)._round():P.y<s&&(P=new Pt(S.x+(s-S.y)/(P.y-S.y)*(P.x-S.x),s)._round()),S.x>=u&&P.x>=u||(S.x>=u?S=new Pt(u,S.y+(u-S.x)/(P.x-S.x)*(P.y-S.y))._round():P.x>=u&&(P=new Pt(u,S.y+(u-S.x)/(P.x-S.x)*(P.y-S.y))._round()),S.y>=_&&P.y>=_||(S.y>=_?S=new Pt(S.x+(_-S.y)/(P.y-S.y)*(P.x-S.x),_)._round():P.y>=_&&(P=new Pt(S.x+(_-S.y)/(P.y-S.y)*(P.x-S.x),_)._round()),O&&S.equals(O[O.length-1])||(O=[S],d.push(O)),O.push(P)))))}}return d}function fI(c){let n=0,s=0;for(const v of c)n+=v.w*v.h,s=Math.max(s,v.w);c.sort((v,E)=>E.h-v.h);const u=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(n/.95)),s),h:1/0}];let _=0,d=0;for(const v of c)for(let E=u.length-1;E>=0;E--){const O=u[E];if(!(v.w>O.w||v.h>O.h)){if(v.x=O.x,v.y=O.y,d=Math.max(d,v.y+v.h),_=Math.max(_,v.x+v.w),v.w===O.w&&v.h===O.h){const z=u.pop();E<u.length&&(u[E]=z)}else v.h===O.h?(O.x+=v.w,O.w-=v.w):v.w===O.w?(O.y+=v.h,O.h-=v.h):(u.push({x:O.x+v.w,y:O.y,w:O.w-v.w,h:v.h}),O.y+=v.h,O.h-=v.h);break}}return{w:_,h:d,fill:n/(_*d)||0}}hn(wr,"Anchor");const sv=1;class lv{static getImagePositionScale(n,s,u){return s&&n&&n.options&&n.options.transform?{x:n.options.transform.a,y:n.options.transform.d}:{x:u,y:u}}constructor(n,{pixelRatio:s,version:u,stretchX:_,stretchY:d,content:v,sdf:E,usvg:O},z,S){this.paddedRect=n,this.pixelRatio=s,this.stretchX=_,this.stretchY=d,this.content=v,this.version=u,this.padding=z,this.sdf=E,this.scale=lv.getImagePositionScale(S,O,s)}get tl(){return[this.paddedRect.x+this.padding,this.paddedRect.y+this.padding]}get br(){return[this.paddedRect.x+this.paddedRect.w-this.padding,this.paddedRect.y+this.paddedRect.h-this.padding]}get displaySize(){return[(this.paddedRect.w-2*this.padding)/this.scale.x,(this.paddedRect.h-2*this.padding)/this.scale.y]}}class dI{constructor(n,s,u){const _={},d={};this.haveRenderCallbacks=[];const v=[];this.addImages(n,_,sv,v),this.addImages(s,d,2,v);const{w:E,h:O}=fI(v),z=new Aa({width:E||1,height:O||1});for(const S in n){const P=n[S],L=_[S].paddedRect;Aa.copy(P.data,z,{x:0,y:0},{x:L.x+sv,y:L.y+sv},P.data,u,P.sdf)}for(const S in s){const P=s[S],L=d[S].paddedRect;let M=d[S].padding;const R=L.x+M,B=L.y+M,q=P.data.width,H=P.data.height;M=M>1?M-1:M,Aa.copy(P.data,z,{x:0,y:0},{x:R,y:B},P.data,u),Aa.copy(P.data,z,{x:0,y:H-M},{x:R,y:B-M},{width:q,height:M},u),Aa.copy(P.data,z,{x:0,y:0},{x:R,y:B+H},{width:q,height:M},u),Aa.copy(P.data,z,{x:q-M,y:0},{x:R-M,y:B},{width:M,height:H},u),Aa.copy(P.data,z,{x:0,y:0},{x:R+q,y:B},{width:M,height:H},u),Aa.copy(P.data,z,{x:q-M,y:H-M},{x:R-M,y:B-M},{width:M,height:M},u),Aa.copy(P.data,z,{x:0,y:H-M},{x:R+q,y:B-M},{width:M,height:M},u),Aa.copy(P.data,z,{x:0,y:0},{x:R+q,y:B+H},{width:M,height:M},u),Aa.copy(P.data,z,{x:q-M,y:0},{x:R-M,y:B+H},{width:M,height:M},u)}this.lut=u,this.image=z,this.iconPositions=_,this.patternPositions=d}addImages(n,s,u,_){for(const d in n){const v=n[d],E={x:0,y:0,w:v.data.width+2*u,h:v.data.height+2*u};_.push(E);const O=Bs.deserializeFromString(d);s[d]=new lv(E,v,u,O),v.hasRenderCallback&&this.haveRenderCallbacks.push(O.id)}}patchUpdatedImages(n,s,u){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(_=>n.hasImage(_,u)),n.dispatchRenderCallbacks(this.haveRenderCallbacks,u);for(const _ in n.getUpdatedImages(u)){for(const d of Object.keys(this.iconPositions))Bs.deserializeId(d)===_&&this.patchUpdatedImage(this.iconPositions[d],n.getImage(_,u),s);for(const d of Object.keys(this.patternPositions))Bs.deserializeId(d)===_&&this.patchUpdatedImage(this.patternPositions[d],n.getImage(_,u),s)}}patchUpdatedImage(n,s,u){if(!n||!s||n.version===s.version)return;n.version=s.version;const[_,d]=n.tl,v=n.sdf;if(this.lut||v){const E={width:s.data.width,height:s.data.height},O=new Aa(E);Aa.copy(s.data,O,{x:0,y:0},{x:0,y:0},E,this.lut,v),u.update(O,{position:{x:_,y:d}})}else u.update(s.data,{position:{x:_,y:d}})}}hn(lv,"ImagePosition"),hn(dI,"ImageAtlas");const lx=1e20;function pI(c,n,s,u,_,d,v,E,O){for(let z=n;z<n+u;z++)mI(c,s*d+z,d,_,v,E,O);for(let z=s;z<s+_;z++)mI(c,z*d+n,1,u,v,E,O)}function mI(c,n,s,u,_,d,v){d[0]=0,v[0]=-1e20,v[1]=lx,_[0]=c[n];for(let E=1,O=0,z=0;E<u;E++){_[E]=c[n+E*s];const S=E*E;do{const P=d[O];z=(_[E]-_[P]+S-P*P)/(E-P)/2}while(z<=v[O]&&--O>-1);O++,d[O]=E,v[O]=z,v[O+1]=lx}for(let E=0,O=0;E<u;E++){for(;v[O+1]<E;)O++;const z=d[O],S=E-z;c[n+E*s]=_[z]+S*S}}const Zu=2,v3={none:0,ideographs:1,all:2};class Y_{constructor(n,s,u){this.requestManager=n,this.localGlyphMode=s,this.localFontFamily=u,this.urls={},this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(n,s){this.urls[s]=n}getGlyphs(n,s,u){const _=[],d=this.urls[s]||vi.GLYPHS_URL;for(const v in n)for(const E of n[v])_.push({stack:v,id:E});Tl(_,({stack:v,id:E},O)=>{let z=this.entries[v];z||(z=this.entries[v]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let S=z.glyphs[E];if(S!==void 0)return void O(null,{stack:v,id:E,glyph:S});if(S=this._tinySDF(z,v,E),S)return z.glyphs[E]=S,void O(null,{stack:v,id:E,glyph:S});const P=Math.floor(E/256);if(256*P>65535)return qn("glyphs > 65535 not supported"),void O(null,{stack:v,id:E,glyph:S});if(z.ranges[P])return void O(null,{stack:v,id:E,glyph:S});let L=z.requests[P];L||(L=z.requests[P]=[],Y_.loadGlyphRange(v,P,d,this.requestManager,(M,R)=>{if(R){z.ascender=R.ascender,z.descender=R.descender;for(const B in R.glyphs)this._doesCharSupportLocalGlyph(+B)||(z.glyphs[+B]=R.glyphs[+B]);z.ranges[P]=!0}for(const B of L)B(M,R);delete z.requests[P]})),L.push((M,R)=>{M?O(M):R&&O(null,{stack:v,id:E,glyph:R.glyphs[E]||null})})},(v,E)=>{if(v)u(v);else if(E){const O={};for(const{stack:z,id:S,glyph:P}of E)O[z]===void 0&&(O[z]={}),O[z].glyphs===void 0&&(O[z].glyphs={}),O[z].glyphs[S]=P&&{id:P.id,bitmap:P.bitmap.clone(),metrics:P.metrics},O[z].ascender=this.entries[z].ascender,O[z].descender=this.entries[z].descender;u(null,O)}})}_doesCharSupportLocalGlyph(n){return this.localGlyphMode!==v3.none&&(this.localGlyphMode===v3.all?!!this.localFontFamily:!!this.localFontFamily&&(Yt["CJK Unified Ideographs"](n)||Yt["Hangul Syllables"](n)||Yt.Hiragana(n)||Yt.Katakana(n)||Yt["CJK Symbols and Punctuation"](n)||Yt["CJK Unified Ideographs Extension A"](n)||Yt["CJK Unified Ideographs Extension B"](n)||Yt.Osage(n)))}_tinySDF(n,s,u){const _=this.localFontFamily;if(!_||!this._doesCharSupportLocalGlyph(u))return;let d=n.tinySDF;if(!d){let B="400";/bold/i.test(s)?B="900":/medium/i.test(s)?B="500":/light/i.test(s)&&(B="200"),d=n.tinySDF=new Y_.TinySDF({fontFamily:_,fontWeight:B,fontSize:24*Zu,buffer:3*Zu,radius:8*Zu}),d.fontWeight=B}if(this.localGlyphs[d.fontWeight][u])return this.localGlyphs[d.fontWeight][u];const v=String.fromCodePoint(u),{data:E,width:O,height:z,glyphWidth:S,glyphHeight:P,glyphLeft:L,glyphTop:M,glyphAdvance:R}=d.draw(v);return this.localGlyphs[d.fontWeight][u]={id:u,bitmap:new qu({width:O,height:z},E),metrics:{width:S/Zu,height:P/Zu,left:L/Zu,top:M/Zu-27,advance:R/Zu,localGlyph:!0}}}}Y_.loadGlyphRange=function(c,n,s,u,_){const d=256*n,v=d+255,E=u.transformRequest(u.normalizeGlyphsURL(s).replace("{fontstack}",c).replace("{range}",`${d}-${v}`),vr.Glyphs);ii(E,(O,z)=>{if(O)_(O);else if(z){const S={},P=function(L){return new g(L).readFields(k,{})}(z);for(const L of P.glyphs)S[L.id]=L;_(null,{glyphs:S,ascender:P.ascender,descender:P.descender})}})},Y_.TinySDF=class{constructor({fontSize:c=24,buffer:n=3,radius:s=8,cutoff:u=.25,fontFamily:_="sans-serif",fontWeight:d="normal",fontStyle:v="normal"}={}){this.buffer=n,this.cutoff=u,this.radius=s;const E=this.size=c+4*n,O=this._createCanvas(E),z=this.ctx=O.getContext("2d",{willReadFrequently:!0});z.font=`${v} ${d} ${c}px ${_}`,z.textBaseline="alphabetic",z.textAlign="left",z.fillStyle="black",this.gridOuter=new Float64Array(E*E),this.gridInner=new Float64Array(E*E),this.f=new Float64Array(E),this.z=new Float64Array(E+1),this.v=new Uint16Array(E)}_createCanvas(c){const n=document.createElement("canvas");return n.width=n.height=c,n}draw(c){const{width:n,actualBoundingBoxAscent:s,actualBoundingBoxDescent:u,actualBoundingBoxLeft:_,actualBoundingBoxRight:d}=this.ctx.measureText(c),v=Math.ceil(s),E=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(d-_))),O=Math.min(this.size-this.buffer,v+Math.ceil(u)),z=E+2*this.buffer,S=O+2*this.buffer,P=Math.max(z*S,0),L=new Uint8ClampedArray(P),M={data:L,width:z,height:S,glyphWidth:E,glyphHeight:O,glyphTop:v,glyphLeft:0,glyphAdvance:n};if(E===0||O===0)return M;const{ctx:R,buffer:B,gridInner:q,gridOuter:H}=this;R.clearRect(B,B,E,O),R.fillText(c,B,B+v);const ne=R.getImageData(B,B,E,O);H.fill(lx,0,P),q.fill(0,0,P);for(let re=0;re<O;re++)for(let K=0;K<E;K++){const ie=ne.data[4*(re*E+K)+3]/255;if(ie===0)continue;const ce=(re+B)*z+K+B;if(ie===1)H[ce]=0,q[ce]=lx;else{const _e=.5-ie;H[ce]=_e>0?_e*_e:0,q[ce]=_e<0?_e*_e:0}}pI(H,0,0,z,S,z,this.f,this.v,this.z),pI(q,B,B,E,O,z,this.f,this.v,this.z);for(let re=0;re<P;re++){const K=Math.sqrt(H[re])-Math.sqrt(q[re]);L[re]=Math.round(255-255*(K/this.radius+this.cutoff))}return M}};const v0=sv;function _I(c,n){return c+n[1]-n[0]}function gI(c,n,s,u,_=1){const d=[],v=c.imagePrimary,E=v.pixelRatio,O=v.paddedRect.w-2*v0,z=v.paddedRect.h-2*v0,S=(c.right-c.left)*_,P=(c.bottom-c.top)*_,L=v.stretchX||[[0,O]],M=v.stretchY||[[0,z]],R=L.reduce(_I,0),B=M.reduce(_I,0),q=O-R,H=z-B;let ne=0,re=R,K=0,ie=B,ce=0,_e=q,Ce=0,Ae=H;if(v.content&&u){const Ue=v.content;ne=cx(L,0,Ue[0]),K=cx(M,0,Ue[1]),re=cx(L,Ue[0],Ue[2]),ie=cx(M,Ue[1],Ue[3]),ce=Ue[0]-ne,Ce=Ue[1]-K,_e=Ue[2]-Ue[0]-re,Ae=Ue[3]-Ue[1]-ie}const Ee=(Ue,Oe,Ve,Ze)=>{const qe=ux(Ue.stretch-ne,re,S,c.left*_),Ke=hx(Ue.fixed-ce,_e,Ue.stretch,R),Qe=ux(Oe.stretch-K,ie,P,c.top*_),at=hx(Oe.fixed-Ce,Ae,Oe.stretch,B),Je=ux(Ve.stretch-ne,re,S,c.left*_),wt=hx(Ve.fixed-ce,_e,Ve.stretch,R),Rt=ux(Ze.stretch-K,ie,P,c.top*_),bt=hx(Ze.fixed-Ce,Ae,Ze.stretch,B),an=new Pt(qe,Qe),Jt=new Pt(Je,Qe),Ut=new Pt(Je,Rt),kt=new Pt(qe,Rt),vn=new Pt(Ke/E,at/E),ln=new Pt(wt/E,bt/E),pn=n*Math.PI/180;if(pn){const ur=Math.sin(pn),Zr=Math.cos(pn),Lr=[Zr,-ur,ur,Zr];an._matMult(Lr),Jt._matMult(Lr),kt._matMult(Lr),Ut._matMult(Lr)}const zn=Ue.stretch+Ue.fixed,Gn=Ve.stretch+Ve.fixed,Zn=Oe.stretch+Oe.fixed,Wn=Ze.stretch+Ze.fixed,lr=c.imageSecondary;return{tl:an,tr:Jt,bl:kt,br:Ut,texPrimary:{x:v.paddedRect.x+v0+zn,y:v.paddedRect.y+v0+Zn,w:Gn-zn,h:Wn-Zn},texSecondary:lr?{x:lr.paddedRect.x+v0+zn,y:lr.paddedRect.y+v0+Zn,w:Gn-zn,h:Wn-Zn}:void 0,writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:vn,pixelOffsetBR:ln,minFontScaleX:_e/E/S,minFontScaleY:Ae/E/P,isSDF:s}};if(u&&(v.stretchX||v.stretchY)){const Ue=yI(L,q,R),Oe=yI(M,H,B);for(let Ve=0;Ve<Ue.length-1;Ve++){const Ze=Ue[Ve],qe=Ue[Ve+1];for(let Ke=0;Ke<Oe.length-1;Ke++)d.push(Ee(Ze,Oe[Ke],qe,Oe[Ke+1]))}}else d.push(Ee({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:O+1},{fixed:0,stretch:z+1}));return d}function cx(c,n,s){let u=0;for(const _ of c)u+=Math.max(n,Math.min(s,_[1]))-Math.max(n,Math.min(s,_[0]));return u}function yI(c,n,s){const u=[{fixed:-1,stretch:0}];for(const[_,d]of c){const v=u[u.length-1];u.push({fixed:_-v.stretch,stretch:v.stretch}),u.push({fixed:_-v.stretch,stretch:v.stretch+(d-_)})}return u.push({fixed:n+v0,stretch:s}),u}function ux(c,n,s,u){return c/n*s+u}function hx(c,n,s,u){return c-n*s/u}function Dq(c,n,s,u){const _=n+c.positionedLines[u].lineOffset;return u===0?s+_/2:s+(_+(n+c.positionedLines[u-1].lineOffset))/2}function Lq(c,n=1,s=!1){let u=1/0,_=1/0,d=-1/0,v=-1/0;const E=c[0];for(let M=0;M<E.length;M++){const R=E[M];(!M||R.x<u)&&(u=R.x),(!M||R.y<_)&&(_=R.y),(!M||R.x>d)&&(d=R.x),(!M||R.y>v)&&(v=R.y)}const O=Math.min(d-u,v-_);let z=O/2;const S=new aa([],kq);if(O===0)return new Pt(u,_);for(let M=u;M<d;M+=O)for(let R=_;R<v;R+=O)S.push(new K_(M+z,R+z,z,c));let P=function(M){let R=0,B=0,q=0;const H=M[0];for(let ne=0,re=H.length,K=re-1;ne<re;K=ne++){const ie=H[ne],ce=H[K],_e=ie.x*ce.y-ce.x*ie.y;B+=(ie.x+ce.x)*_e,q+=(ie.y+ce.y)*_e,R+=3*_e}return new K_(B/R,q/R,0,M)}(c),L=S.length;for(;S.length;){const M=S.pop();(M.d>P.d||!P.d)&&(P=M,s&&console.log("found best %d after %d probes",Math.round(1e4*M.d)/1e4,L)),M.max-P.d<=n||(z=M.h/2,S.push(new K_(M.p.x-z,M.p.y-z,z,c)),S.push(new K_(M.p.x+z,M.p.y-z,z,c)),S.push(new K_(M.p.x-z,M.p.y+z,z,c)),S.push(new K_(M.p.x+z,M.p.y+z,z,c)),L+=4)}return s&&(console.log(`num probes: ${L}`),console.log(`best distance: ${P.d}`)),P.p}function kq(c,n){return n.max-c.max}class K_{constructor(n,s,u,_){this.p=new Pt(n,s),this.h=u,this.d=function(d,v){let E=!1,O=1/0;for(let z=0;z<v.length;z++){const S=v[z];for(let P=0,L=S.length,M=L-1;P<L;M=P++){const R=S[P],B=S[M];R.y>d.y!=B.y>d.y&&d.x<(B.x-R.x)*(d.y-R.y)/(B.y-R.y)+R.x&&(E=!E),O=Math.min(O,Re(d,R,B))}}return(E?1:-1)*Math.sqrt(O)}(this.p,_),this.max=this.d+this.h*Math.SQRT2}}const x3=Number.POSITIVE_INFINITY,zq=Math.sqrt(2);function vI(c,[n,s]){let u=0,_=0;if(s===x3){n<0&&(n=0);const d=n/zq;switch(c){case"top-right":case"top-left":_=d-7;break;case"bottom-right":case"bottom-left":_=7-d;break;case"bottom":_=7-n;break;case"top":_=n-7}switch(c){case"top-right":case"bottom-right":u=-d;break;case"top-left":case"bottom-left":u=d;break;case"left":u=n;break;case"right":u=-n}}else{switch(n=Math.abs(n),s=Math.abs(s),c){case"top-right":case"top-left":case"top":_=s-7;break;case"bottom-right":case"bottom-left":case"bottom":_=7-s}switch(c){case"top-right":case"bottom-right":case"right":u=-n;break;case"top-left":case"bottom-left":case"left":u=n}}return[u,_]}function b3(c){switch(c){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Bq(c,n,s,u,_,d,v,E,O,z,S,P,L,M,R){let B=d.textMaxSize.evaluate(n,{},P);B===void 0?B=v*d.textScaleFactor:B*=d.textScaleFactor;const q=c.layers[0].layout,H=q.get("icon-offset").evaluate(n,{},P),ne=bI(s.horizontal)||s.vertical,re=L.name==="globe",K=Ua,ie=v*d.textScaleFactor/K,ce=c.tilePixelRatio*B/K,_e=(qe=c.overscaling,c.zoom>18&&qe>2&&(qe>>=1),Math.max(Kt/(512*qe),1)*q.get("symbol-spacing")),Ce=q.get("text-padding")*c.tilePixelRatio,Ae=q.get("icon-padding")*c.tilePixelRatio,Ee=$n(q.get("text-max-angle")),Ue=q.get("text-rotation-alignment")==="map"&&q.get("symbol-placement")!=="point",Oe=q.get("icon-rotation-alignment")==="map"&&q.get("symbol-placement")!=="point",Ve=q.get("symbol-placement"),Ze=_e/2;var qe;const Ke=q.get("icon-text-fit").evaluate(n,{},P),Qe=q.get("icon-text-fit-padding").evaluate(n,{},P),at=Ke!=="none";let Je;c.hasAnyIconTextFit===!1&&at&&(c.hasAnyIconTextFit=!0),u&&at&&(c.allowVerticalPlacement&&s.vertical&&(Je=Un(u,s.vertical,Ke,Qe,H,ie)),ne&&(u=Un(u,ne,Ke,Qe,H,ie)));const wt=(Rt,bt,an)=>{if(bt.x<0||bt.x>=Kt||bt.y<0||bt.y>=Kt)return;let Jt=null;if(re){const{x:Ut,y:kt,z:vn}=L.projectTilePoint(bt.x,bt.y,an);Jt={anchor:new wr(Ut,kt,vn,0,void 0),up:L.upVector(an,bt.x,bt.y)}}(function(Ut,kt,vn,ln,pn,zn,Gn,Zn,Wn,lr,ur,Zr,Lr,jn,Ir,Rr,ri,Bi,ta,Ni,Oi,Hi,la,vo,Qr,Ks,Ku){const Jc=Ut.addToLineVertexArray(kt,ln);let Qc,T0,nm,E0,Cv,t6,n6,r6=0,i6=0,a6=0,o6=0,nT=-1,rT=-1;const lf={};let s6=ls("");const A0=vn?vn.anchor:kt,iT=Wn.layout.get("icon-text-fit").evaluate(Oi,{},Qr)!=="none";let aT=0,oT=0;if(Wn._unevaluatedLayout.getValue("text-radial-offset")===void 0?[aT,oT]=Wn.layout.get("text-offset").evaluate(Oi,{},Qr).map(Ql=>Ql*Ua):(aT=Wn.layout.get("text-radial-offset").evaluate(Oi,{},Qr)*Ua,oT=x3),Ut.allowVerticalPlacement&&pn.vertical){const Ql=pn.vertical;if(Ir)t6=w3(Ql),Zn&&(n6=w3(Zn));else{const Js=Wn.layout.get("text-rotate").evaluate(Oi,{},Qr)+90;nm=fx(lr,A0,kt,ur,Zr,Lr,Ql,jn,Js,Rr),Zn&&(E0=fx(lr,A0,kt,ur,Zr,Lr,Zn,Bi,Js))}}if(zn){const Ql=Ut.iconSizeData,Js=Wn.layout.get("icon-rotate").evaluate(Oi,{},Qr),Mv=gI(zn,Js,la,iT,Hi.iconScaleFactor),lT=Zn?gI(Zn,Js,la,iT,Hi.iconScaleFactor):void 0;T0=fx(lr,A0,kt,ur,Zr,Lr,zn,Bi,Js,null),r6=4*Mv.length;let C0=null;Ql.kind==="source"?(C0=[es*Wn.layout.get("icon-size").evaluate(Oi,{},Qr)*Hi.iconScaleFactor],C0[0]>Jp&&qn(`${Ut.layerIds[0]}: Value for "icon-size" is >= ${cv}. Reduce your "icon-size".`)):Ql.kind==="composite"&&(C0=[es*Hi.compositeIconSizes[0].evaluate(Oi,{},Qr)*Hi.iconScaleFactor,es*Hi.compositeIconSizes[1].evaluate(Oi,{},Qr)*Hi.iconScaleFactor],(C0[0]>Jp||C0[1]>Jp)&&qn(`${Ut.layerIds[0]}: Value for "icon-size" is >= ${cv}. Reduce your "icon-size".`)),Ut.addSymbols(Ut.icon,Mv,C0,Ni,ta,Oi,!1,vn,kt,Jc.lineStartIndex,Jc.lineLength,-1,vo,Qr,Ks,Ku),nT=Ut.icon.placedSymbolArray.length-1,lT&&(i6=4*lT.length,Ut.addSymbols(Ut.icon,lT,C0,Ni,ta,Oi,Be.vertical,vn,kt,Jc.lineStartIndex,Jc.lineLength,-1,vo,Qr,Ks,Ku),rT=Ut.icon.placedSymbolArray.length-1)}for(const Ql in pn.horizontal){const Js=pn.horizontal[Ql];Qc||(s6=ls(Js.text),Ir?Cv=w3(Js):Qc=fx(lr,A0,kt,ur,Zr,Lr,Js,jn,Wn.layout.get("text-rotate").evaluate(Oi,{},Qr),Rr));const Mv=Js.positionedLines.length===1;if(a6+=xI(Ut,vn,kt,Js,Gn,Wn,Ir,Oi,Rr,Jc,pn.vertical?Be.horizontal:Be.horizontalOnly,Mv?Object.keys(pn.horizontal):[Ql],lf,nT,Hi,vo,Qr,Ks),Mv)break}pn.vertical&&(o6+=xI(Ut,vn,kt,pn.vertical,Gn,Wn,Ir,Oi,Rr,Jc,Be.vertical,["vertical"],lf,rT,Hi,vo,Qr,Ks));let rm=-1;const sT=(Ql,Js)=>Ql?Math.max(Ql,Js):Js;rm=sT(Cv,rm),rm=sT(t6,rm),rm=sT(n6,rm);const _H=rm>-1?1:0;Ut.glyphOffsetArray.length>=65535&&qn("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Oi.sortKey!==void 0&&Ut.addToSortKeyRanges(Ut.symbolInstances.length,Oi.sortKey),Ut.symbolInstances.emplaceBack(kt.x,kt.y,A0.x,A0.y,A0.z,lf.right>=0?lf.right:-1,lf.center>=0?lf.center:-1,lf.left>=0?lf.left:-1,lf.vertical>=0?lf.vertical:-1,nT,rT,s6,Qc!==void 0?Qc:Ut.collisionBoxArray.length,Qc!==void 0?Qc+1:Ut.collisionBoxArray.length,nm!==void 0?nm:Ut.collisionBoxArray.length,nm!==void 0?nm+1:Ut.collisionBoxArray.length,T0!==void 0?T0:Ut.collisionBoxArray.length,T0!==void 0?T0+1:Ut.collisionBoxArray.length,E0||Ut.collisionBoxArray.length,E0?E0+1:Ut.collisionBoxArray.length,ur,a6,o6,r6,i6,_H,0,aT,oT,rm,0,iT?1:0)})(c,bt,Jt,Rt,s,u,_,Je,c.layers[0],c.collisionBoxArray,n.index,n.sourceLayerIndex,c.index,Ce,Ue,O,0,Ae,Oe,H,n,d,z,S,P,M,R)};if(Ve==="line")for(const Rt of hI(n.geometry,0,0,Kt,Kt)){const bt=y3(Rt,_e,Ee,s.vertical||ne,u,K,ce,c.overscaling,Kt);for(const an of bt)ne&&Nq(c,ne.text,Ze,an)||wt(Rt,an,P)}else if(Ve==="line-center"){for(const Rt of n.geometry)if(Rt.length>1){const bt=sf(Rt,Ee,s.vertical||ne,u,K,ce);bt&&wt(Rt,bt,P)}}else if(n.type==="Polygon")for(const Rt of Ys(n.geometry,0)){const bt=Lq(Rt,16);wt(Rt[0],new wr(bt.x,bt.y,0,0,void 0),P)}else if(n.type==="LineString")for(const Rt of n.geometry)wt(Rt,new wr(Rt[0].x,Rt[0].y,0,0,void 0),P);else if(n.type==="Point")for(const Rt of n.geometry)for(const bt of Rt)wt([bt],new wr(bt.x,bt.y,0,0,void 0),P)}const cv=255,Jp=cv*es;function xI(c,n,s,u,_,d,v,E,O,z,S,P,L,M,R,B,q,H){const ne=function(ie,ce,_e,Ce,Ae,Ee,Ue,Oe){const Ve=[];if(ce.positionedLines.length===0)return Ve;const Ze=Ce.layout.get("text-rotate").evaluate(Ee,{})*Math.PI/180,qe=function(wt){const Rt=wt[0],bt=wt[1],an=Rt*bt;return an>0?[Rt,-bt]:an<0?[-Rt,bt]:Rt===0?[bt,Rt]:[bt,-Rt]}(_e);let Ke=Math.abs(ce.top-ce.bottom);for(const wt of ce.positionedLines)Ke-=wt.lineOffset;const Qe=ce.positionedLines.length,at=Ke/Qe;let Je=ce.top-_e[1];for(let wt=0;wt<Qe;++wt){const Rt=ce.positionedLines[wt];Je=Dq(ce,at,Je,wt);for(const bt of Rt.positionedGlyphs){if(!bt.rect)continue;const an=bt.rect||{};let Jt=be+1,Ut=!0,kt=1,vn=0;if(bt.imageName){const Ni=Ue[Da.build(bt.imageName).getSerializedPrimary()];if(!Ni)continue;if(Ni.sdf){qn("SDF images are not supported in formatted text and will be ignored.");continue}Ut=!1,kt=Ni.pixelRatio,Jt=sv/kt}const ln=(Ae||Oe)&&bt.vertical,pn=bt.metrics.advance*bt.scale/2,zn=bt.metrics,Gn=bt.rect;if(Gn===null)continue;Oe&&ce.verticalizable&&(vn=bt.imageName?pn-bt.metrics.width*bt.scale/2:0);const Zn=Ae?[bt.x+pn,bt.y]:[0,0];let Wn=[0,0],lr=[0,0],ur=!1;Ae||(ln?(lr=[bt.x+pn+qe[0],bt.y+qe[1]-vn],ur=!0):Wn=[bt.x+pn+_e[0],bt.y+_e[1]-vn]);const Zr=Gn.w*bt.scale/(kt*(bt.localGlyph?Zu:1)),Lr=Gn.h*bt.scale/(kt*(bt.localGlyph?Zu:1));let jn,Ir,Rr,ri;if(ln){const Ni=bt.y-Je,Oi=new Pt(-pn,pn-Ni),Hi=-Math.PI/2,la=new Pt(...lr);jn=new Pt(-pn+Wn[0],Wn[1]),jn._rotateAround(Hi,Oi)._add(la),jn.x+=-Ni+pn,jn.y-=(zn.left-Jt)*bt.scale;const vo=bt.imageName?zn.advance*bt.scale:Ua*bt.scale,Qr=String.fromCodePoint(bt.glyph);sx(Qr)?jn.x+=(1-Jt)*bt.scale:y0(Qr)?jn.x+=vo-zn.height*bt.scale+(-Jt-1)*bt.scale:jn.x+=bt.imageName||zn.width+2*Jt===Gn.w&&zn.height+2*Jt===Gn.h?(vo-Lr)/2:(vo-(zn.height+2*Jt)*bt.scale)/2,Ir=new Pt(jn.x,jn.y-Zr),Rr=new Pt(jn.x+Lr,jn.y),ri=new Pt(jn.x+Lr,jn.y-Zr)}else{const Ni=(zn.left-Jt)*bt.scale-pn+Wn[0],Oi=(-zn.top-Jt)*bt.scale+Wn[1],Hi=Ni+Zr,la=Oi+Lr;jn=new Pt(Ni,Oi),Ir=new Pt(Hi,Oi),Rr=new Pt(Ni,la),ri=new Pt(Hi,la)}if(Ze){let Ni;Ni=Ae?new Pt(0,0):ur?new Pt(qe[0],qe[1]):new Pt(_e[0],_e[1]),jn._rotateAround(Ze,Ni),Ir._rotateAround(Ze,Ni),Rr._rotateAround(Ze,Ni),ri._rotateAround(Ze,Ni)}const Bi=new Pt(0,0),ta=new Pt(0,0);Ve.push({tl:jn,tr:Ir,bl:Rr,br:ri,texPrimary:an,texSecondary:void 0,writingMode:ce.writingMode,glyphOffset:Zn,sectionIndex:bt.sectionIndex,isSDF:Ut,pixelOffsetTL:Bi,pixelOffsetBR:ta,minFontScaleX:0,minFontScaleY:0})}}return Ve}(0,u,O,d,v,E,_,c.allowVerticalPlacement),re=c.textSizeData;let K=null;re.kind==="source"?(K=[es*d.layout.get("text-size").evaluate(E,{},q)*R.textScaleFactor],K[0]>Jp&&qn(`${c.layerIds[0]}: Value for "text-size" is >= ${cv}. Reduce your "text-size".`)):re.kind==="composite"&&(K=[es*R.compositeTextSizes[0].evaluate(E,{},q)*R.textScaleFactor,es*R.compositeTextSizes[1].evaluate(E,{},q)*R.textScaleFactor],(K[0]>Jp||K[1]>Jp)&&qn(`${c.layerIds[0]}: Value for "text-size" is >= ${cv}. Reduce your "text-size".`)),c.addSymbols(c.text,ne,K,O,v,E,S,n,s,z.lineStartIndex,z.lineLength,M,B,q,H,!1);for(const ie of P)L[ie]=c.text.placedSymbolArray.length-1;return 4*ne.length}function bI(c){for(const n in c)return c[n];return null}function fx(c,n,s,u,_,d,v,E,O,z){let S=v.top,P=v.bottom,L=v.left,M=v.right;const R=v.collisionPadding;if(R&&(L-=R[0],S-=R[1],M+=R[2],P+=R[3]),O){const B=new Pt(L,S),q=new Pt(M,S),H=new Pt(L,P),ne=new Pt(M,P),re=$n(O);let K=new Pt(0,0);z&&(K=new Pt(z[0],z[1])),B._rotateAround(re,K),q._rotateAround(re,K),H._rotateAround(re,K),ne._rotateAround(re,K),L=Math.min(B.x,q.x,H.x,ne.x),M=Math.max(B.x,q.x,H.x,ne.x),S=Math.min(B.y,q.y,H.y,ne.y),P=Math.max(B.y,q.y,H.y,ne.y)}return c.emplaceBack(n.x,n.y,n.z,s.x,s.y,L,S,M,P,E,u,_,d),c.length-1}function w3(c){c.collisionPadding&&(c.top-=c.collisionPadding[1],c.bottom+=c.collisionPadding[3]);const n=c.bottom-c.top;return n>0?Math.max(10,n):null}function Nq(c,n,s,u){const _=c.compareText;if(n in _){const d=_[n];for(let v=d.length-1;v>=0;v--)if(u.dist(d[v])<s)return!0}else _[n]=[];return _[n].push(u),!1}function wI(c,n){const s=c.fovAboveCenter,u=c.elevation?c.elevation.getMinElevationBelowMSL()*n:0,_=(c._camera.position[2]*c.worldSize-u)/Math.cos(c._pitch),d=Math.sin(s)*_/Math.sin(Math.max(Math.PI/2-c._pitch-s,.01));let v=Math.sin(c._pitch)*d+_;const E=_*(1/c._horizonShift);if(!c.elevation||c.elevation.exaggeration()===0){let O=Math.max(c.zoom-17,0);c.isOrthographic&&(O/=10),v*=1+O}return Math.min(1.01*v,E)}function uv(c,n){if(!n.isReprojectedInTileSpace)return{scale:1<<c.z,x:c.x,y:c.y,x2:c.x+1,y2:c.y+1,projection:n};const s=Math.pow(2,-c.z),u=c.x*s,_=(c.x+1)*s,d=c.y*s,v=(c.y+1)*s,E=no(u),O=no(_),z=qi(d),S=qi(v),P=n.project(E,z),L=n.project(O,z),M=n.project(O,S),R=n.project(E,S);let B=Math.min(P.x,L.x,M.x,R.x),q=Math.min(P.y,L.y,M.y,R.y),H=Math.max(P.x,L.x,M.x,R.x),ne=Math.max(P.y,L.y,M.y,R.y);const re=s/16;function K(ce,_e,Ce,Ae,Ee,Ue){const Oe=(Ce+Ee)/2,Ve=(Ae+Ue)/2,Ze=n.project(no(Oe),qi(Ve)),qe=Math.max(0,B-Ze.x,q-Ze.y,Ze.x-H,Ze.y-ne);B=Math.min(B,Ze.x),H=Math.max(H,Ze.x),q=Math.min(q,Ze.y),ne=Math.max(ne,Ze.y),qe>re&&(K(ce,Ze,Ce,Ae,Oe,Ve),K(Ze,_e,Oe,Ve,Ee,Ue))}K(P,L,u,d,_,d),K(L,M,_,d,_,v),K(M,R,_,v,u,v),K(R,P,u,v,u,d),B-=re,q-=re,H+=re,ne+=re;const ie=1/Math.max(H-B,ne-q);return{scale:ie,x:B*ie,y:q*ie,x2:H*ie,y2:ne*ie,projection:n}}function SI(c,{x:n,y:s},u=0){return new Pt(((n-u)*c.scale-c.x)*Kt,(s*c.scale-c.y)*Kt)}const Fq=Ne.mat4.identity(new Float32Array(16));class Qp{constructor(n){this.spec=n,this.name=n.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(n,s){return{x:0,y:0,z:0}}unproject(n,s){return new pr(0,0)}projectTilePoint(n,s,u){return{x:n,y:s,z:0}}locationPoint(n,s,u=!0){return n._coordinatePoint(n.locationCoordinate(s),u)}pixelsPerMeter(n,s){return Fa(1,n)*s}pixelSpaceConversion(n,s,u){return 1}farthestPixelDistance(n){return wI(n,n.pixelsPerMeter)}pointCoordinate(n,s,u,_){const d=n.horizonLineFromTop(!1),v=new Pt(s,Math.max(d,u));return n.rayIntersectionCoordinate(n.pointRayIntersection(v,_))}pointCoordinate3D(n,s,u){const _=new Pt(s,u);if(n.elevation)return n.elevation.pointCoordinate(_);{const d=this.pointCoordinate(n,_.x,_.y,0);return[d.x,d.y,d.z]}}isPointAboveHorizon(n,s){if(n.elevation&&n.elevation.visibleDemTiles.length)return!this.pointCoordinate3D(n,s.x,s.y);const u=n.horizonLineFromTop();return s.y<u}createInversionMatrix(n,s){return Fq}createTileMatrix(n,s,u){let _,d,v;const E=u.canonical,O=Ne.mat4.identity(new Float64Array(16));if(this.isReprojectedInTileSpace){const z=uv(E,this);_=1,d=z.x+u.wrap*z.scale,v=z.y,Ne.mat4.scale(O,O,[_/z.scale,_/z.scale,n.pixelsPerMeter/s])}else _=s/n.zoomScale(E.z),d=(E.x+Math.pow(2,E.z)*u.wrap)*_,v=E.y*_;return Ne.mat4.translate(O,O,[d,v,0]),Ne.mat4.scale(O,O,[_/Kt,_/Kt,1]),O}upVector(n,s,u){return[0,0,1]}upVectorScale(n,s,u){return{metersToTile:1}}}class jq extends Qp{constructor(n){super(n),this.range=[4,7],this.center=n.center||[-96,37.5];const[s,u]=this.parallels=n.parallels||[29.5,45.5],_=Math.sin($n(s));this.n=(_+Math.sin($n(u)))/2,this.c=1+_*(2*this.n-_),this.r0=Math.sqrt(this.c)/this.n}project(n,s){const{n:u,c:_,r0:d}=this,v=$n(n-this.center[0]),E=$n(s),O=Math.sqrt(_-2*u*Math.sin(E))/u;return{x:O*Math.sin(v*u),y:O*Math.cos(v*u)-d,z:0}}unproject(n,s){const{n:u,c:_,r0:d}=this,v=d+s;let E=Math.atan2(n,Math.abs(v))*Math.sign(v);v*u<0&&(E-=Math.PI*Math.sign(n)*Math.sign(v));const O=$n(this.center[0])*u;E=is(E,-Math.PI-O,Math.PI-O);const z=Bn(si(E/u)+this.center[0],-180,180),S=Math.asin(Bn((_-(n*n+v*v)*u*u)/(2*u),-1,1)),P=Bn(si(S),-85.051129,Br);return new pr(z,P)}}const hv=1.340264,fv=-.081106,dv=893e-6,pv=.003796,dx=Math.sqrt(3)/2;class Uq extends Qp{project(n,s){s=s/180*Math.PI,n=n/180*Math.PI;const u=Math.asin(dx*Math.sin(s)),_=u*u,d=_*_*_;return{x:.5*(n*Math.cos(u)/(dx*(hv+3*fv*_+d*(7*dv+9*pv*_)))/Math.PI+.5),y:1-.5*(u*(hv+fv*_+d*(dv+pv*_))/Math.PI+1),z:0}}unproject(n,s){n=(2*n-.5)*Math.PI;let u=s=(2*(1-s)-1)*Math.PI,_=u*u,d=_*_*_;for(let S,P,L,M=0;M<12&&(P=u*(hv+fv*_+d*(dv+pv*_))-s,L=hv+3*fv*_+d*(7*dv+9*pv*_),S=P/L,u=Bn(u-S,-Math.PI/3,Math.PI/3),_=u*u,d=_*_*_,!(Math.abs(S)<1e-12));++M);const v=dx*n*(hv+3*fv*_+d*(7*dv+9*pv*_))/Math.cos(u),E=Math.asin(Math.sin(u)/dx),O=Bn(180*v/Math.PI,-180,180),z=Bn(180*E/Math.PI,-85.051129,Br);return new pr(O,z)}}class Vq extends Qp{constructor(n){super(n),this.wrap=!0,this.supportsWorldCopies=!0}project(n,s){return{x:.5+n/360,y:.5-s/360,z:0}}unproject(n,s){const u=360*(n-.5),_=Bn(360*(.5-s),-85.051129,Br);return new pr(u,_)}}const J_=Math.PI/2;function px(c){return Math.tan((J_+c)/2)}class $q extends Qp{constructor(n){super(n),this.center=n.center||[0,30];const[s,u]=this.parallels=n.parallels||[30,30];let _=$n(s),d=$n(u);this.southernCenter=_+d<0,this.southernCenter&&(_=-_,d=-d);const v=Math.cos(_),E=px(_);this.n=_===d?Math.sin(_):Math.log(v/Math.cos(d))/Math.log(px(d)/E),this.f=v*Math.pow(px(_),this.n)/this.n}project(n,s){s=$n(s),this.southernCenter&&(s=-s),n=$n(n-this.center[0]);const u=1e-6,{n:_,f:d}=this;d>0?s<-J_+u&&(s=-J_+u):s>J_-u&&(s=J_-u);const v=d/Math.pow(px(s),_);let E=v*Math.sin(_*n),O=d-v*Math.cos(_*n);return E=.5*(E/Math.PI+.5),O=.5*(O/Math.PI+.5),{x:E,y:this.southernCenter?O:1-O,z:0}}unproject(n,s){n=(2*n-.5)*Math.PI,this.southernCenter&&(s=1-s),s=(2*(1-s)-.5)*Math.PI;const{n:u,f:_}=this,d=_-s,v=Math.sign(d),E=Math.sign(u)*Math.sqrt(n*n+d*d);let O=Math.atan2(n,Math.abs(d))*v;d*u<0&&(O-=Math.PI*Math.sign(n)*v);const z=Bn(si(O/u)+this.center[0],-180,180),S=Bn(si(2*Math.atan(Math.pow(_/E,1/u))-J_),-85.051129,Br);return new pr(z,this.southernCenter?-S:S)}}class TI extends Qp{constructor(n){super(n),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(n,s){return{x:Xs(n),y:Ts(s),z:0}}unproject(n,s){const u=no(n),_=qi(s);return new pr(u,_)}}const EI=$n(Br);class qq extends Qp{project(n,s){const u=(s=$n(s))*s,_=u*u;return{x:.5*((n=$n(n))*(.8707-.131979*u+_*(_*(.003971*u-.001529*_)-.013791))/Math.PI+.5),y:1-.5*(s*(1.007226+u*(.015085+_*(.028874*u-.044475-.005916*_)))/Math.PI+1),z:0}}unproject(n,s){n=(2*n-.5)*Math.PI;let u=s=(2*(1-s)-1)*Math.PI,_=25,d=0,v=u*u;do{v=u*u;const z=v*v;d=(u*(1.007226+v*(.015085+z*(.028874*v-.044475-.005916*z)))-s)/(1.007226+v*(.045255+z*(.259866*v-.311325-.005916*11*z))),u=Bn(u-d,-EI,EI)}while(Math.abs(d)>1e-6&&--_>0);v=u*u;const E=Bn(si(n/(.8707+v*(v*(v*v*v*(.003971-.001529*v)-.013791)-.131979))),-180,180),O=si(u);return new pr(E,O)}}const AI=$n(Br);class Gq extends Qp{project(n,s){s=$n(s),n=$n(n);const u=Math.cos(s),_=2/Math.PI,d=Math.acos(u*Math.cos(n/2)),v=Math.sin(d)/d,E=.5*(n*_+2*u*Math.sin(n/2)/v)||0,O=.5*(s+Math.sin(s)/v)||0;return{x:.5*(E/Math.PI+.5),y:1-.5*(O/Math.PI+1),z:0}}unproject(n,s){let u=n=(2*n-.5)*Math.PI,_=s=(2*(1-s)-1)*Math.PI,d=25;const v=1e-6;let E=0,O=0;do{const z=Math.cos(_),S=Math.sin(_),P=2*S*z,L=S*S,M=z*z,R=Math.cos(u/2),B=Math.sin(u/2),q=2*R*B,H=B*B,ne=1-M*R*R,re=ne?1/ne:0,K=ne?Math.acos(z*R)*Math.sqrt(1/ne):0,ie=.5*(2*K*z*B+2*u/Math.PI)-n,ce=.5*(K*S+_)-s,_e=.5*re*(M*H+K*z*R*L)+1/Math.PI,Ce=re*(q*P/4-K*S*B),Ae=.125*re*(P*B-K*S*M*q),Ee=.5*re*(L*R+K*H*z)+.5,Ue=Ce*Ae-Ee*_e;E=(ce*Ce-ie*Ee)/Ue,O=(ie*Ae-ce*_e)/Ue,u=Bn(u-E,-Math.PI,Math.PI),_=Bn(_-O,-AI,AI)}while((Math.abs(E)>v||Math.abs(O)>v)&&--d>0);return new pr(si(u),si(_))}}class CI extends Qp{constructor(n){super(n),this.center=n.center||[0,0],this.parallels=n.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos($n(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(n,s){const{scale:u,cosPhi:_}=this;return{x:$n(n)*_*u+.5,y:-Math.sin($n(s))/_*u+.5,z:0}}unproject(n,s){const{scale:u,cosPhi:_}=this,d=-(s-.5)/u,v=Bn(si((n-.5)/u)/_,-180,180),E=Math.asin(Bn(d*_,-1,1)),O=Bn(si(E),-85.051129,Br);return new pr(v,O)}}class Hq extends TI{constructor(n){super(n),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(n,s,u){const _=Tr(n,s,u),d=xi(Kr(u));return Ne.vec3.transformMat4(_,_,d),{x:_[0],y:_[1],z:_[2]}}locationPoint(n,s){const u=Gc(s.lat,s.lng),_=Ne.vec3.normalize([],u),d=n.elevation?n.elevation.getAtPointOrZero(n.locationCoordinate(s),n._centerAltitude):n._centerAltitude,v=Fa(1,0)*Kt*d;Ne.vec3.scaleAndAdd(u,u,_,v);const E=Ne.mat4.identity(new Float64Array(16));return Ne.mat4.multiply(E,n.pixelMatrix,n.globeMatrix),Ne.vec3.transformMat4(u,u,E),new Pt(u[0],u[1])}pixelsPerMeter(n,s){return Fa(1,0)*s}pixelSpaceConversion(n,s,u){const _=Fa(1,n)*s,d=Mn(Fa(1,45)*s,_,u);return this.pixelsPerMeter(n,s)/d}createTileMatrix(n,s,u){const _=Or(Kr(u.canonical));return Ne.mat4.multiply(new Float64Array(16),n.globeMatrix,_)}createInversionMatrix(n,s){const{center:u}=n,_=xi(Kr(s));return Ne.mat4.rotateY(_,_,$n(u.lng)),Ne.mat4.rotateX(_,_,$n(u.lat)),Ne.mat4.scale(_,_,[n._pixelsPerMercatorPixel,n._pixelsPerMercatorPixel,1]),Float32Array.from(_)}pointCoordinate(n,s,u,_){return In(n,s,u,!0)||new l(0,0)}pointCoordinate3D(n,s,u){const _=this.pointCoordinate(n,s,u,0);return[_.x,_.y,_.z]}isPointAboveHorizon(n,s){return!In(n,s.x,s.y,!1)}farthestPixelDistance(n){const s=function(_,d){const v=_.cameraToCenterDistance,E=_._centerAltitude*d,O=_._camera,z=_._camera.forward(),S=Ne.vec3.add([],Ne.vec3.scale([],z,-v),[0,0,E]),P=_.worldSize/(2*Math.PI),L=[0,0,-P],M=_.width/_.height,R=Math.tan(_.fovAboveCenter),B=Ne.vec3.scale([],O.up(),R),q=Ne.vec3.scale([],O.right(),R*M),H=Ne.vec3.normalize([],Ne.vec3.add([],Ne.vec3.add([],z,B),q)),ne=[];let re;if(new Ln(S,H).closestPointOnSphere(L,P,ne)){const K=Ne.vec3.add([],ne,L),ie=Ne.vec3.sub([],K,S);re=Math.cos(_.fovAboveCenter)*Ne.vec3.length(ie)}else{const K=Ne.vec3.sub([],S,L),ie=Ne.vec3.sub([],L,S);Ne.vec3.normalize(ie,ie);const ce=Ne.vec3.length(K)-P;re=Math.sqrt(ce*(ce+2*P));const _e=Math.acos(re/(P+ce))-Math.acos(Ne.vec3.dot(z,ie));re*=Math.cos(_e)}return 1.01*re}(n,this.pixelsPerMeter(n.center.lat,n.worldSize)),u=ja(n.zoom);if(u>0){const _=wI(n,Fa(1,n.center.lat)*n.worldSize),d=n.worldSize/(2*Math.PI),v=Math.max(n.width,n.height)/n.worldSize*Math.PI;return Mn(s,_+d*(1-Math.cos(v)),Math.pow(u,10))}return s}upVector(n,s,u){return Tr(s,u,n,1)}upVectorScale(n){return{metersToTile:Pn(cr(Kr(n)))}}}function MI(c){const n=c.parallels,s=!!n&&Math.abs(n[0]+n[1])<.01;switch(c.name){case"mercator":return new TI(c);case"equirectangular":return new Vq(c);case"naturalEarth":return new qq(c);case"equalEarth":return new Uq(c);case"winkelTripel":return new Gq(c);case"albers":return s?new CI(c):new jq(c);case"lambertConformalConic":return s?new CI(c):new $q(c);case"globe":return new Hq(c)}throw new Error(`Invalid projection name: ${c.name}`)}const Zq=Td.VectorTileFeature.types,Wq=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function mx(c,n,s,u,_,d,v,E,O,z,S,P,L){const M=E?Math.min(Jp,Math.round(E[0])):0,R=E?Math.min(Jp,Math.round(E[1])):0;c.emplaceBack(n,s,Math.round(32*u),Math.round(32*_),d,v,(M<<1)+(O?1:0),R,16*z,16*S,256*P,256*L)}function _x(c,n,s){c.emplaceBack(n,s)}function gx(c,n,s,u,_,d,v){c.emplaceBack(n,s,u,_,d,v)}function yx(c,n,s,u,_){c.emplaceBack(n,s,u,_),c.emplaceBack(n,s,u,_),c.emplaceBack(n,s,u,_),c.emplaceBack(n,s,u,_)}function Xq(c){for(const n of c.sections)if(Ic(n.text))return!0;return!1}class S3{constructor(n){this.layoutVertexArray=new ld,this.indexArray=new sa,this.programConfigurations=n,this.segments=new ci,this.dynamicLayoutVertexArray=new Fc,this.opacityVertexArray=new Xm,this.placedSymbolArray=new Ym,this.iconTransitioningVertexArray=new jc,this.globeExtVertexArray=new Pp,this.zOffsetVertexArray=new qs}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0&&this.iconTransitioningVertexArray.length===0}upload(n,s,u,_,d){this.isEmpty()||(u&&(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,ox.members),this.indexBuffer=n.createIndexBuffer(this.indexArray,s),this.dynamicLayoutVertexBuffer=n.createVertexBuffer(this.dynamicLayoutVertexArray,nf.members,!0),this.opacityVertexBuffer=n.createVertexBuffer(this.opacityVertexArray,Wq,!0),this.iconTransitioningVertexArray.length>0&&(this.iconTransitioningVertexBuffer=n.createVertexBuffer(this.iconTransitioningVertexArray,af.members,!0)),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=n.createVertexBuffer(this.globeExtVertexArray,rv.members,!0)),!this.zOffsetVertexBuffer&&(this.zOffsetVertexArray.length>0||d)&&(this.zOffsetVertexBuffer=n.createVertexBuffer(this.zOffsetVertexArray,rf.members,!0)),this.opacityVertexBuffer.itemSize=1),(u||_)&&this.programConfigurations.upload(n))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.iconTransitioningVertexBuffer&&this.iconTransitioningVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy(),this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy())}}hn(S3,"SymbolBuffers");class T3{constructor(n,s,u){this.layoutVertexArray=new n,this.layoutAttributes=s,this.indexArray=new u,this.segments=new ci,this.collisionVertexArray=new Vh,this.collisionVertexArrayExt=new Fc}upload(n){this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=n.createVertexBuffer(this.collisionVertexArray,_0.members,!0),this.collisionVertexBufferExt=n.createVertexBuffer(this.collisionVertexArrayExt,g0.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}hn(T3,"CollisionBuffers");class vx{constructor(n){this.collisionBoxArray=n.collisionBoxArray,this.zoom=n.zoom,this.lut=n.lut,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(v=>v.fqid),this.index=n.index,this.pixelRatio=n.pixelRatio,this.sourceLayerIndex=n.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.hasAnyIconTextFit=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Ne.mat4.identity([]),this.placementViewportMatrix=Ne.mat4.identity([]);const s=this.layers[0]._unevaluatedLayout._values;this.textSizeData=H_(this.zoom,s["text-size"]),this.iconSizeData=H_(this.zoom,s["icon-size"]);const u=this.layers[0].layout,_=u.get("symbol-sort-key"),d=u.get("symbol-z-order");this.canOverlap=u.get("text-allow-overlap")||u.get("icon-allow-overlap")||u.get("text-ignore-placement")||u.get("icon-ignore-placement"),this.sortFeaturesByKey=d!=="viewport-y"&&_.constantOr(1)!==void 0,this.sortFeaturesByY=(d==="viewport-y"||d==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=u.get("text-writing-mode").map(v=>Be[v]),this.stateDependentLayerIds=this.layers.filter(v=>v.isStateDependent()).map(v=>v.id),this.sourceID=n.sourceID,this.projection=n.projection,this.hasAnyZOffset=!1,this.zOffsetSortDirty=!1,this.zOffsetBuffersNeedUpload=u.get("symbol-z-elevate"),this.activeReplacements=[],this.replacementUpdateTime=0}createArrays(){this.text=new S3(new Po(this.layers,{zoom:this.zoom,lut:this.lut},n=>n.startsWith("text")||n.startsWith("symbol"))),this.icon=new S3(new Po(this.layers,{zoom:this.zoom,lut:this.lut},n=>n.startsWith("icon")||n.startsWith("symbol"))),this.glyphOffsetArray=new Jm,this.lineVertexArray=new Ta,this.symbolInstances=new g_}calculateGlyphDependencies(n,s,u,_,d){for(const v of n){const E=v.codePointAt(0);if(E===void 0)break;if(s[E]=!0,_&&d&&E<=65535){const O=of[v];O&&(s[O.charCodeAt(0)]=!0)}}}updateFootprints(n,s){}updateReplacement(n,s){if(s.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=s.updateTime;const u=s.getReplacementRegionsForTile(n.toUnwrapped(),!0);return!l0(this.activeReplacements,u)&&(this.activeReplacements=u,!0)}populate(n,s,u,_){const d=this.layers[0],v=d.layout,E=this.projection.name==="globe",O=v.get("text-font"),z=v.get("text-field"),S=v.get("icon-image"),[P,L]=v.get("icon-size-scale-range"),M=Bn(s.scaleFactor||1,P,L),R=(z.value.kind!=="constant"||z.value.value instanceof ia&&!z.value.value.isEmpty()||z.value.value.toString().length>0)&&(O.value.kind!=="constant"||O.value.value.length>0),B=S.value.kind!=="constant"||!!S.value.value||Object.keys(S.parameters).length>0,q=v.get("symbol-sort-key");if(this.features=[],!R&&!B)return;const H=s.iconDependencies,ne=s.glyphDependencies,re=s.availableImages,K=new zr(this.zoom);for(const{feature:ie,id:ce,index:_e,sourceLayerIndex:Ce}of n){const Ae=d._featureFilter.needGeometry,Ee=Z(ie,Ae);if(!d._featureFilter.filter(K,Ee,u))continue;if(Ae||(Ee.geometry=$(ie,u,_)),E&&ie.type!==1&&u.z<=5){const qe=Ee.geometry,Ke=.98078528056,Qe=(at,Je)=>{const wt=Tr(at.x,at.y,u,1),Rt=Tr(Je.x,Je.y,u,1);return Ne.vec3.dot(wt,Rt)<Ke};for(let at=0;at<qe.length;at++)qe[at]=A(qe[at],Qe)}let Ue,Oe;if(R){const qe=d.getValueAndResolveTokens("text-field",Ee,u,re),Ke=ia.factory(qe);Xq(Ke)&&(this.hasRTLText=!0),(!this.hasRTLText||Bh()==="unavailable"||this.hasRTLText&&Yr.isParsed())&&(Ue=Z_(Ke,d,Ee))}if(B){const qe=d.getValueAndResolveTokens("icon-image",Ee,u,re);Oe=qe instanceof Da?qe:Da.build(qe)}if(!Ue&&!Oe)continue;const Ve=this.sortFeaturesByKey?q.evaluate(Ee,{},u):void 0,Ze={id:ce,text:Ue,icon:Oe,index:_e,sourceLayerIndex:Ce,geometry:Ee.geometry,properties:ie.properties,type:Zq[ie.type],sortKey:Ve};if(this.features.push(Ze),Oe){const qe=iv(this.iconSizeData,this.layers[0]._unevaluatedLayout._values["icon-size"],u,this.zoom,Ze)*M*this.pixelRatio,Ke=Oe.getPrimary().scaleSelf(qe);if(H[Ke.id]=H[Ke.id]||[],H[Ke.id].push(Ke),Oe.nameSecondary){const Qe=Oe.getSecondary().scaleSelf(qe);H[Qe.id]=H[Qe.id]||[],H[Qe.id].push(Qe)}}if(Ue){const qe=O.evaluate(Ee,{},u).join(","),Ke=v.get("text-rotation-alignment")==="map"&&v.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Be.vertical)>=0;for(const Qe of Ue.sections)if(Qe.image){const at=Qe.image.getPrimary().scaleSelf(this.pixelRatio);H[at.id]=H[at.id]||[],H[at.id].push(at)}else{const at=ti(Ue.toString()),Je=Qe.fontStack||qe,wt=ne[Je]=ne[Je]||{};this.calculateGlyphDependencies(Qe.text,wt,Ke,this.allowVerticalPlacement,at)}}}v.get("symbol-placement")==="line"&&(this.features=function(ie){const ce={},_e={},Ce=[];let Ae=0;function Ee(Ze){Ce.push(ie[Ze]),Ae++}function Ue(Ze,qe,Ke){const Qe=_e[Ze];return delete _e[Ze],_e[qe]=Qe,Ce[Qe].geometry[0].pop(),Ce[Qe].geometry[0]=Ce[Qe].geometry[0].concat(Ke[0]),Qe}function Oe(Ze,qe,Ke){const Qe=ce[qe];return delete ce[qe],ce[Ze]=Qe,Ce[Qe].geometry[0].shift(),Ce[Qe].geometry[0]=Ke[0].concat(Ce[Qe].geometry[0]),Qe}function Ve(Ze,qe,Ke){const Qe=Ke?qe[0][qe[0].length-1]:qe[0][0];return`${Ze}:${Qe.x}:${Qe.y}`}for(let Ze=0;Ze<ie.length;Ze++){const qe=ie[Ze],Ke=qe.geometry,Qe=qe.text?qe.text.toString():null;if(!Qe){Ee(Ze);continue}const at=Ve(Qe,Ke),Je=Ve(Qe,Ke,!0);if(at in _e&&Je in ce&&_e[at]!==ce[Je]){const wt=Oe(at,Je,Ke),Rt=Ue(at,Je,Ce[wt].geometry);delete ce[at],delete _e[Je],_e[Ve(Qe,Ce[Rt].geometry,!0)]=Rt,Ce[wt].geometry=null}else at in _e?Ue(at,Je,Ke):Je in ce?Oe(at,Je,Ke):(Ee(Ze),ce[at]=Ae-1,_e[Je]=Ae-1)}return Ce.filter(Ze=>Ze.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((ie,ce)=>ie.sortKey-ce.sortKey)}update(n,s,u,_,d,v,E){this.text.programConfigurations.updatePaintArrays(n,s,d,u,_,v,E),this.icon.programConfigurations.updatePaintArrays(n,s,d,u,_,v,E)}updateZOffset(){const n=(d,v,E)=>{u+=v,u>d.length&&d.resize(u);for(let O=-v;O<0;O++)d.emplace(O+u,E)},s=(d,v,E)=>{_+=v,_>d.length&&d.resize(_);for(let O=-v;O<0;O++)d.emplace(O+_,E)};if(!this.zOffsetBuffersNeedUpload)return;this.zOffsetBuffersNeedUpload=!1;let u=0,_=0;for(let d=0;d<this.symbolInstances.length;d++){const v=this.symbolInstances.get(d),{numHorizontalGlyphVertices:E,numVerticalGlyphVertices:O,numIconVertices:z}=v,S=v.zOffset,P=z>0;if((E>0||O>0)&&(n(this.text.zOffsetVertexArray,E,S),n(this.text.zOffsetVertexArray,O,S)),P){const{placedIconSymbolIndex:L,verticalPlacedIconSymbolIndex:M}=v;L>=0&&s(this.icon.zOffsetVertexArray,z,S),M>=0&&s(this.icon.zOffsetVertexArray,v.numVerticalIconVertices,S)}}this.text.zOffsetVertexBuffer&&this.text.zOffsetVertexBuffer.updateData(this.text.zOffsetVertexArray),this.icon.zOffsetVertexBuffer&&this.icon.zOffsetVertexBuffer.updateData(this.icon.zOffsetVertexArray)}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(n){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(n),this.iconCollisionBox.upload(n)),this.text.upload(n,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.icon.upload(n,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=MI(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(n,s){const u=this.lineVertexArray.length;if(n.segment!==void 0)for(const{x:_,y:d}of s)this.lineVertexArray.emplaceBack(_,d);return{lineStartIndex:u,lineLength:this.lineVertexArray.length-u}}addSymbols(n,s,u,_,d,v,E,O,z,S,P,L,M,R,B,q){const H=n.indexArray,ne=n.layoutVertexArray,re=n.globeExtVertexArray,K=n.segments.prepareSegment(4*s.length,ne,H,this.canOverlap?v.sortKey:void 0),ie=this.glyphOffsetArray.length,ce=K.vertexLength,_e=this.allowVerticalPlacement&&E===Be.vertical?Math.PI/2:0,Ce=v.text&&v.text.sections;for(let Ee=0;Ee<s.length;Ee++){const{tl:Ue,tr:Oe,bl:Ve,br:Ze,texPrimary:qe,texSecondary:Ke,pixelOffsetTL:Qe,pixelOffsetBR:at,minFontScaleX:Je,minFontScaleY:wt,glyphOffset:Rt,isSDF:bt,sectionIndex:an}=s[Ee],Jt=K.vertexLength,Ut=Rt[1];if(mx(ne,z.x,z.y,Ue.x,Ut+Ue.y,qe.x,qe.y,u,bt,Qe.x,Qe.y,Je,wt),mx(ne,z.x,z.y,Oe.x,Ut+Oe.y,qe.x+qe.w,qe.y,u,bt,at.x,Qe.y,Je,wt),mx(ne,z.x,z.y,Ve.x,Ut+Ve.y,qe.x,qe.y+qe.h,u,bt,Qe.x,at.y,Je,wt),mx(ne,z.x,z.y,Ze.x,Ut+Ze.y,qe.x+qe.w,qe.y+qe.h,u,bt,at.x,at.y,Je,wt),O){const{x:kt,y:vn,z:ln}=O.anchor,[pn,zn,Gn]=O.up;gx(re,kt,vn,ln,pn,zn,Gn),gx(re,kt,vn,ln,pn,zn,Gn),gx(re,kt,vn,ln,pn,zn,Gn),gx(re,kt,vn,ln,pn,zn,Gn),yx(n.dynamicLayoutVertexArray,kt,vn,ln,_e)}else yx(n.dynamicLayoutVertexArray,z.x,z.y,z.z,_e);if(q){const kt=Ke||qe;_x(n.iconTransitioningVertexArray,kt.x,kt.y),_x(n.iconTransitioningVertexArray,kt.x+kt.w,kt.y),_x(n.iconTransitioningVertexArray,kt.x,kt.y+kt.h),_x(n.iconTransitioningVertexArray,kt.x+kt.w,kt.y+kt.h)}H.emplaceBack(Jt,Jt+1,Jt+2),H.emplaceBack(Jt+1,Jt+2,Jt+3),K.vertexLength+=4,K.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Rt[0]),Ee!==s.length-1&&an===s[Ee+1].sectionIndex||n.programConfigurations.populatePaintArrays(ne.length,v,v.index,{},M,R,B,Ce&&Ce[an])}const Ae=O?O.anchor:z;n.placedSymbolArray.emplaceBack(Ae.x,Ae.y,Ae.z,z.x,z.y,ie,this.glyphOffsetArray.length-ie,ce,S,P,z.segment,u?u[0]:0,u?u[1]:0,_[0],_[1],E,0,!1,0,L,0)}_commitLayoutVertex(n,s,u,_,d,v,E){n.emplaceBack(s,u,_,d,v,Math.round(E.x),Math.round(E.y))}_addCollisionDebugVertices(n,s,u,_,d,v,E){const O=u.segments.prepareSegment(4,u.layoutVertexArray,u.indexArray),z=O.vertexLength,S=E.tileAnchorX,P=E.tileAnchorY;for(let M=0;M<4;M++)u.collisionVertexArray.emplaceBack(0,0,0,0,0,0);this._commitDebugCollisionVertexUpdate(u.collisionVertexArrayExt,s,n.padding,E.zOffset),this._commitLayoutVertex(u.layoutVertexArray,_,d,v,S,P,new Pt(n.x1,n.y1)),this._commitLayoutVertex(u.layoutVertexArray,_,d,v,S,P,new Pt(n.x2,n.y1)),this._commitLayoutVertex(u.layoutVertexArray,_,d,v,S,P,new Pt(n.x2,n.y2)),this._commitLayoutVertex(u.layoutVertexArray,_,d,v,S,P,new Pt(n.x1,n.y2)),O.vertexLength+=4;const L=u.indexArray;L.emplaceBack(z,z+1),L.emplaceBack(z+1,z+2),L.emplaceBack(z+2,z+3),L.emplaceBack(z+3,z),O.primitiveLength+=4}_addTextDebugCollisionBoxes(n,s,u,_,d,v){for(let E=_;E<d;E++){const O=u.get(E),z=this.getSymbolInstanceTextSize(n,v,s,E);this._addCollisionDebugVertices(O,z,this.textCollisionBox,O.projectedAnchorX,O.projectedAnchorY,O.projectedAnchorZ,v)}}_addIconDebugCollisionBoxes(n,s,u,_,d,v){for(let E=_;E<d;E++){const O=u.get(E),z=this.getSymbolInstanceIconSize(n,s,v.placedIconSymbolIndex);this._addCollisionDebugVertices(O,z,this.iconCollisionBox,O.projectedAnchorX,O.projectedAnchorY,O.projectedAnchorZ,v)}}generateCollisionDebugBuffers(n,s,u){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new T3(Uc,Hu.members,jc),this.iconCollisionBox=new T3(Uc,Hu.members,jc);const _=Id(this.iconSizeData,n),d=Id(this.textSizeData,n,u);for(let v=0;v<this.symbolInstances.length;v++){const E=this.symbolInstances.get(v);this._addTextDebugCollisionBoxes(d,n,s,E.textBoxStartIndex,E.textBoxEndIndex,E),this._addTextDebugCollisionBoxes(d,n,s,E.verticalTextBoxStartIndex,E.verticalTextBoxEndIndex,E),this._addIconDebugCollisionBoxes(_,n,s,E.iconBoxStartIndex,E.iconBoxEndIndex,E),this._addIconDebugCollisionBoxes(_,n,s,E.verticalIconBoxStartIndex,E.verticalIconBoxEndIndex,E)}}getSymbolInstanceTextSize(n,s,u,_){const d=this.text.placedSymbolArray.get(s.rightJustifiedTextSymbolIndex>=0?s.rightJustifiedTextSymbolIndex:s.centerJustifiedTextSymbolIndex>=0?s.centerJustifiedTextSymbolIndex:s.leftJustifiedTextSymbolIndex>=0?s.leftJustifiedTextSymbolIndex:s.verticalPlacedTextSymbolIndex>=0?s.verticalPlacedTextSymbolIndex:_),v=Pd(this.textSizeData,n,d)/Ua;return this.tilePixelRatio*v}getSymbolInstanceIconSize(n,s,u){const _=this.icon.placedSymbolArray.get(u),d=Pd(this.iconSizeData,n,_);return this.tilePixelRatio*d}_commitDebugCollisionVertexUpdate(n,s,u,_){n.emplaceBack(s,-u,-u,_),n.emplaceBack(s,u,-u,_),n.emplaceBack(s,u,u,_),n.emplaceBack(s,-u,u,_)}_updateTextDebugCollisionBoxes(n,s,u,_,d,v,E){for(let O=_;O<d;O++){const z=u.get(O),S=this.getSymbolInstanceTextSize(n,v,s,O);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,S,z.padding,v.zOffset)}}_updateIconDebugCollisionBoxes(n,s,u,_,d,v,E){for(let O=_;O<d;O++){const z=u.get(O),S=this.getSymbolInstanceIconSize(n,s,v.placedIconSymbolIndex);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,S,z.padding,v.zOffset)}}updateCollisionDebugBuffers(n,s,u,_){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const d=Id(this.iconSizeData,n,_),v=Id(this.textSizeData,n,u);for(let E=0;E<this.symbolInstances.length;E++){const O=this.symbolInstances.get(E);this._updateTextDebugCollisionBoxes(v,n,s,O.textBoxStartIndex,O.textBoxEndIndex,O,u),this._updateTextDebugCollisionBoxes(v,n,s,O.verticalTextBoxStartIndex,O.verticalTextBoxEndIndex,O,u),this._updateIconDebugCollisionBoxes(d,n,s,O.iconBoxStartIndex,O.iconBoxEndIndex,O,_),this._updateIconDebugCollisionBoxes(d,n,s,O.verticalIconBoxStartIndex,O.verticalIconBoxEndIndex,O,_)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(n,s,u,_,d,v,E,O,z){const S={};if(s<u){const{x1:P,y1:L,x2:M,y2:R,padding:B,projectedAnchorX:q,projectedAnchorY:H,projectedAnchorZ:ne,tileAnchorX:re,tileAnchorY:K,featureIndex:ie}=n.get(s);S.textBox={x1:P,y1:L,x2:M,y2:R,padding:B,projectedAnchorX:q,projectedAnchorY:H,projectedAnchorZ:ne,tileAnchorX:re,tileAnchorY:K},S.textFeatureIndex=ie}if(_<d){const{x1:P,y1:L,x2:M,y2:R,padding:B,projectedAnchorX:q,projectedAnchorY:H,projectedAnchorZ:ne,tileAnchorX:re,tileAnchorY:K,featureIndex:ie}=n.get(_);S.verticalTextBox={x1:P,y1:L,x2:M,y2:R,padding:B,projectedAnchorX:q,projectedAnchorY:H,projectedAnchorZ:ne,tileAnchorX:re,tileAnchorY:K},S.verticalTextFeatureIndex=ie}if(v<E){const{x1:P,y1:L,x2:M,y2:R,padding:B,projectedAnchorX:q,projectedAnchorY:H,projectedAnchorZ:ne,tileAnchorX:re,tileAnchorY:K,featureIndex:ie}=n.get(v);S.iconBox={x1:P,y1:L,x2:M,y2:R,padding:B,projectedAnchorX:q,projectedAnchorY:H,projectedAnchorZ:ne,tileAnchorX:re,tileAnchorY:K},S.iconFeatureIndex=ie}if(O<z){const{x1:P,y1:L,x2:M,y2:R,padding:B,projectedAnchorX:q,projectedAnchorY:H,projectedAnchorZ:ne,tileAnchorX:re,tileAnchorY:K,featureIndex:ie}=n.get(O);S.verticalIconBox={x1:P,y1:L,x2:M,y2:R,padding:B,projectedAnchorX:q,projectedAnchorY:H,projectedAnchorZ:ne,tileAnchorX:re,tileAnchorY:K},S.verticalIconFeatureIndex=ie}return S}deserializeCollisionBoxes(n){this.collisionArrays=[];for(let s=0;s<this.symbolInstances.length;s++){const u=this.symbolInstances.get(s);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(n,u.textBoxStartIndex,u.textBoxEndIndex,u.verticalTextBoxStartIndex,u.verticalTextBoxEndIndex,u.iconBoxStartIndex,u.iconBoxEndIndex,u.verticalIconBoxStartIndex,u.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}hasIconTextFit(){return this.hasAnyIconTextFit}addIndicesForPlacedSymbol(n,s){const u=n.placedSymbolArray.get(s),_=u.vertexStartIndex+4*u.numGlyphs;for(let d=u.vertexStartIndex;d<_;d+=4)n.indexArray.emplaceBack(d,d+1,d+2),n.indexArray.emplaceBack(d+1,d+2,d+3)}getSortedSymbolIndexes(n){if(this.sortedAngle===n&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const s=Math.sin(n),u=Math.cos(n),_=[],d=[],v=[];for(let E=0;E<this.symbolInstances.length;++E){v.push(E);const O=this.symbolInstances.get(E);_.push(0|Math.round(s*O.tileAnchorX+u*O.tileAnchorY)),d.push(O.featureIndex)}return v.sort((E,O)=>_[E]-_[O]||d[O]-d[E]),v}getSortedIndexesByZOffset(){if(!this.zOffsetSortDirty)return this.symbolInstanceIndexesSortedZOffset;if(!this.symbolInstanceIndexesSortedZOffset){this.symbolInstanceIndexesSortedZOffset=[];for(let n=0;n<this.symbolInstances.length;++n)this.symbolInstanceIndexesSortedZOffset.push(n)}return this.zOffsetSortDirty=!1,this.symbolInstanceIndexesSortedZOffset.sort((n,s)=>this.symbolInstances.get(s).zOffset-this.symbolInstances.get(n).zOffset)}addToSortKeyRanges(n,s){const u=this.sortKeyRanges[this.sortKeyRanges.length-1];u&&u.sortKey===s?u.symbolInstanceEnd=n+1:this.sortKeyRanges.push({sortKey:s,symbolInstanceStart:n,symbolInstanceEnd:n+1})}sortFeatures(n){if(this.sortFeaturesByY&&this.sortedAngle!==n&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(n),this.sortedAngle=n,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const s of this.symbolInstanceIndexes){const u=this.symbolInstances.get(s);this.featureSortOrder.push(u.featureIndex);const{rightJustifiedTextSymbolIndex:_,centerJustifiedTextSymbolIndex:d,leftJustifiedTextSymbolIndex:v,verticalPlacedTextSymbolIndex:E,placedIconSymbolIndex:O,verticalPlacedIconSymbolIndex:z}=u;_>=0&&this.addIndicesForPlacedSymbol(this.text,_),d>=0&&d!==_&&this.addIndicesForPlacedSymbol(this.text,d),v>=0&&v!==d&&v!==_&&this.addIndicesForPlacedSymbol(this.text,v),E>=0&&this.addIndicesForPlacedSymbol(this.text,E),O>=0&&this.addIndicesForPlacedSymbol(this.icon,O),z>=0&&this.addIndicesForPlacedSymbol(this.icon,z)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let OI,PI,E3;hn(vx,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),vx.addDynamicAttributes=yx;class II{constructor(n){this.type=n.property.overrides?n.property.overrides.runtimeType:zs,this.defaultValue=n}evaluate(n){if(n.formattedSection){const s=this.defaultValue.property.overrides;if(s&&s.hasOverride(n.formattedSection))return s.getOverride(n.formattedSection)}return n.feature&&n.featureState?this.defaultValue.evaluate(n.feature,n.featureState):this.defaultValue.property.specification.default}eachChild(n){this.defaultValue.isConstant()||n(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}hn(II,"FormatSectionOverride",{omit:["defaultValue"]});const A3=()=>E3||(E3={layout:OI||(OI=new ni({"symbol-placement":new qt(st.layout_symbol["symbol-placement"]),"symbol-spacing":new qt(st.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new qt(st.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new cn(st.layout_symbol["symbol-sort-key"]),"symbol-z-order":new qt(st.layout_symbol["symbol-z-order"]),"symbol-z-elevate":new qt(st.layout_symbol["symbol-z-elevate"]),"symbol-elevation-reference":new qt(st.layout_symbol["symbol-elevation-reference"]),"icon-allow-overlap":new qt(st.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new qt(st.layout_symbol["icon-ignore-placement"]),"icon-optional":new qt(st.layout_symbol["icon-optional"]),"icon-rotation-alignment":new qt(st.layout_symbol["icon-rotation-alignment"]),"icon-size":new cn(st.layout_symbol["icon-size"]),"icon-size-scale-range":new qt(st.layout_symbol["icon-size-scale-range"]),"icon-text-fit":new cn(st.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new cn(st.layout_symbol["icon-text-fit-padding"]),"icon-image":new cn(st.layout_symbol["icon-image"]),"icon-rotate":new cn(st.layout_symbol["icon-rotate"]),"icon-padding":new qt(st.layout_symbol["icon-padding"]),"icon-keep-upright":new qt(st.layout_symbol["icon-keep-upright"]),"icon-offset":new cn(st.layout_symbol["icon-offset"]),"icon-anchor":new cn(st.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new qt(st.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new qt(st.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new qt(st.layout_symbol["text-rotation-alignment"]),"text-field":new cn(st.layout_symbol["text-field"]),"text-font":new cn(st.layout_symbol["text-font"]),"text-size":new cn(st.layout_symbol["text-size"]),"text-size-scale-range":new qt(st.layout_symbol["text-size-scale-range"]),"text-max-width":new cn(st.layout_symbol["text-max-width"]),"text-line-height":new cn(st.layout_symbol["text-line-height"]),"text-letter-spacing":new cn(st.layout_symbol["text-letter-spacing"]),"text-justify":new cn(st.layout_symbol["text-justify"]),"text-radial-offset":new cn(st.layout_symbol["text-radial-offset"]),"text-variable-anchor":new qt(st.layout_symbol["text-variable-anchor"]),"text-anchor":new cn(st.layout_symbol["text-anchor"]),"text-max-angle":new qt(st.layout_symbol["text-max-angle"]),"text-writing-mode":new qt(st.layout_symbol["text-writing-mode"]),"text-rotate":new cn(st.layout_symbol["text-rotate"]),"text-padding":new qt(st.layout_symbol["text-padding"]),"text-keep-upright":new qt(st.layout_symbol["text-keep-upright"]),"text-transform":new cn(st.layout_symbol["text-transform"]),"text-offset":new cn(st.layout_symbol["text-offset"]),"text-allow-overlap":new qt(st.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new qt(st.layout_symbol["text-ignore-placement"]),"text-optional":new qt(st.layout_symbol["text-optional"]),visibility:new qt(st.layout_symbol.visibility)})),paint:PI||(PI=new ni({"icon-opacity":new cn(st.paint_symbol["icon-opacity"]),"icon-occlusion-opacity":new cn(st.paint_symbol["icon-occlusion-opacity"]),"icon-emissive-strength":new cn(st.paint_symbol["icon-emissive-strength"]),"text-emissive-strength":new cn(st.paint_symbol["text-emissive-strength"]),"icon-color":new cn(st.paint_symbol["icon-color"]),"icon-halo-color":new cn(st.paint_symbol["icon-halo-color"]),"icon-halo-width":new cn(st.paint_symbol["icon-halo-width"]),"icon-halo-blur":new cn(st.paint_symbol["icon-halo-blur"]),"icon-translate":new qt(st.paint_symbol["icon-translate"]),"icon-translate-anchor":new qt(st.paint_symbol["icon-translate-anchor"]),"icon-image-cross-fade":new cn(st.paint_symbol["icon-image-cross-fade"]),"text-opacity":new cn(st.paint_symbol["text-opacity"]),"text-occlusion-opacity":new cn(st.paint_symbol["text-occlusion-opacity"]),"text-color":new cn(st.paint_symbol["text-color"],{runtimeType:_a,getOverride:c=>c.textColor,hasOverride:c=>!!c.textColor}),"text-halo-color":new cn(st.paint_symbol["text-halo-color"]),"text-halo-width":new cn(st.paint_symbol["text-halo-width"]),"text-halo-blur":new cn(st.paint_symbol["text-halo-blur"]),"text-translate":new qt(st.paint_symbol["text-translate"]),"text-translate-anchor":new qt(st.paint_symbol["text-translate-anchor"]),"icon-color-saturation":new qt(st.paint_symbol["icon-color-saturation"]),"icon-color-contrast":new qt(st.paint_symbol["icon-color-contrast"]),"icon-color-brightness-min":new qt(st.paint_symbol["icon-color-brightness-min"]),"icon-color-brightness-max":new qt(st.paint_symbol["icon-color-brightness-max"]),"symbol-z-offset":new cn(st.paint_symbol["symbol-z-offset"]),"icon-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"}),"icon-halo-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"}),"text-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"}),"text-halo-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"})}))},E3);class xx extends $i{constructor(n,s,u,_){super(n,A3(),s,u,_),this._colorAdjustmentMatrix=Ne.mat4.identity([]),this.hasInitialOcclusionOpacityProperties=n.paint!==void 0&&("icon-occlusion-opacity"in n.paint||"text-occlusion-opacity"in n.paint)}recalculate(n,s){super.recalculate(n,s),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const u=this.layout.get("text-writing-mode");if(u){const _=[];for(const d of u)_.indexOf(d)<0&&_.push(d);this.layout._values["text-writing-mode"]=_}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getColorAdjustmentMatrix(n,s,u,_){return this._saturation===n&&this._contrast===s&&this._brightnessMin===u&&this._brightnessMax===_||(this._colorAdjustmentMatrix=function(d,v,E,O){d=dh(d),v=Of(v);const z=Ne.mat4.create(),S=d/3,P=1-2*S,L=[P,S,S,0,S,P,S,0,S,S,P,0,0,0,0,1],M=.5-.5*v,R=O-E;return Ne.mat4.multiply(z,[R,0,0,0,0,R,0,0,0,0,R,0,E,E,E,1],[v,0,0,0,0,v,0,0,0,0,v,0,M,M,M,1]),Ne.mat4.multiply(z,z,L),z}(n,s,u,_),this._saturation=n,this._contrast=s,this._brightnessMin=u,this._brightnessMax=_),this._colorAdjustmentMatrix}getValueAndResolveTokens(n,s,u,_){const d=this.layout.get(n).evaluate(s,{},u,_),v=this._unevaluatedLayout._values[n];return v.isDataDriven()||Ih(v.value)||!d?d:function(E,O){return O.replace(/{([^{}]+)}/g,(z,S)=>S in E?String(E[S]):"")}(s.properties,d)}createBucket(n){return new vx(n)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const n of A3().paint.overridableProperties){if(!xx.hasPaintOverride(this.layout,n))continue;const s=this.paint.get(n),u=new II(s),_=new Ep(u,s.property.specification,this.scope,this.options);let d=null;d=s.value.kind==="constant"||s.value.kind==="source"?new Rh("source",_):new jl("composite",_,s.value.zoomStops,s.value._interpolationType),this.paint._values[n]=new Bc(s.property,d,s.parameters)}}_handleOverridablePaintPropertyUpdate(n,s,u){return!(!this.layout||s.isDataDriven()||u.isDataDriven())&&xx.hasPaintOverride(this.layout,n)}static hasPaintOverride(n,s){const u=n.get("text-field"),_=A3().paint.properties[s];let d=!1;const v=E=>{for(const O of E)if(_.overrides&&_.overrides.hasOverride(O))return void(d=!0)};if(u.value.kind==="constant"&&u.value.value instanceof ia)v(u.value.value.sections);else if(u.value.kind==="source"){const E=z=>{d||(z instanceof ya&&ai(z.value)===Vo?v(z.value.sections):z instanceof pc?v(z.sections):z.eachChild(E))},O=u.value;O._styleExpression&&E(O._styleExpression.expression)}return d}getProgramIds(){return["symbol"]}getDefaultProgramParams(n,s,u){return{config:new dl(this,{zoom:s,lut:u}),overrideFog:!1}}}let RI,DI,LI,kI;var C3=br([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);function M3(c){switch(c){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.RGBA;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.DEPTH_COMPONENT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.DEPTH_STENCIL;case WebGL2RenderingContext.R8:case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.RED}}function O3(c){switch(c){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.UNSIGNED_SHORT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.UNSIGNED_INT_24_8;case WebGL2RenderingContext.R8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.FLOAT}}class P3{constructor(n,s,u,_){this.context=n,this.format=u,this.useMipmap=_&&_.useMipmap,this.texture=n.gl.createTexture(),this.update(s,{premultiply:_&&_.premultiply})}update(n,s){const u=n&&n instanceof HTMLVideoElement&&n.width===0?n.videoWidth:n.width,_=n&&n instanceof HTMLVideoElement&&n.height===0?n.videoHeight:n.height,{context:d}=this,{gl:v}=d,{x:E,y:O}=s&&s.position?s.position:{x:0,y:0},z=E+u,S=O+_;!this.size||this.size[0]===z&&this.size[1]===S||(v.bindTexture(v.TEXTURE_2D,null),v.deleteTexture(this.texture),this.texture=v.createTexture(),this.size=null),v.bindTexture(v.TEXTURE_2D,this.texture),d.pixelStoreUnpackFlipY.set(!1),d.pixelStoreUnpack.set(1),d.pixelStoreUnpackPremultiplyAlpha.set(this.format===v.RGBA8&&(!s||s.premultiply!==!1));const P=n instanceof HTMLImageElement||n instanceof HTMLCanvasElement||n instanceof HTMLVideoElement||n instanceof ImageData||ImageBitmap&&n instanceof ImageBitmap;if(!this.size&&z>0&&S>0){const L=this.useMipmap?Math.floor(Math.log2(Math.max(z,S)))+1:1;v.texStorage2D(v.TEXTURE_2D,L,this.format,z,S),this.size=[z,S]}if(this.size)if(P)v.texSubImage2D(v.TEXTURE_2D,0,E,O,M3(this.format),O3(this.format),n);else{const L=n.data;L&&v.texSubImage2D(v.TEXTURE_2D,0,E,O,u,_,M3(this.format),O3(this.format),L)}this.useMipmap&&v.generateMipmap(v.TEXTURE_2D)}bind(n,s,u=!1){const{context:_}=this,{gl:d}=_;d.bindTexture(d.TEXTURE_2D,this.texture),n!==this.minFilter&&(d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,n),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,this.useMipmap&&!u?n===d.NEAREST?d.NEAREST_MIPMAP_NEAREST:d.LINEAR_MIPMAP_LINEAR:n),this.minFilter=n),s!==this.wrapS&&(d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,s),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,s),this.wrapS=s)}bindExtraParam(n,s,u,_){const{context:d}=this,{gl:v}=d;v.bindTexture(v.TEXTURE_2D,this.texture),s!==this.magFilter&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MAG_FILTER,s),this.magFilter=s),n!==this.minFilter&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MIN_FILTER,this.useMipmap?n===v.NEAREST?v.NEAREST_MIPMAP_NEAREST:v.LINEAR_MIPMAP_LINEAR:n),this.minFilter=n),u!==this.wrapS&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_S,u),this.wrapS=u),_!==this.wrapT&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_T,_),this.wrapT=_)}destroy(){const{gl:n}=this.context;n.deleteTexture(this.texture),this.texture=null}}class bx{constructor(n,s){this.context=n,this.texture=s}bind(n,s){const{context:u}=this,{gl:_}=u;_.bindTexture(_.TEXTURE_2D,this.texture),n!==this.minFilter&&(_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MAG_FILTER,n),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MIN_FILTER,n),this.minFilter=n),s!==this.wrapS&&(_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_S,s),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_T,s),this.wrapS=s)}}function wx(c,n,s,u,_,d,v,E){const O=[c,n,1,s,u,1,_,d,1],z=[v,E,1],S=Ne.mat3.adjoint([],O),[P,L,M]=Ne.vec3.transformMat3(z,z,S);return Ne.mat3.multiply(O,O,[P,0,0,0,L,0,0,0,M])}function zI(c,n,s,u,_,d,v,E){const O=function(z,S,P,L,M,R,B,q){const H=wx(0,0,1,0,1,1,0,1),ne=wx(z,S,P,L,M,R,B,q),re=Ne.mat3.adjoint([],H);return Ne.mat3.multiply(ne,ne,re)}(c,n,s,u,_,d,v,E);return[O[2]/O[8]/Kt,O[5]/O[8]/Kt]}function Sx(c){return[c[0],Math.min(Math.max(c[1],-85.051129),Br)]}class BI extends Pl{constructor(n,s,u,_){super(),this.id=n,this.dispatcher=u,this.coordinates=s.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.onNorthPole=!1,this.onSouthPole=!1,this.setEventedParent(_),this.options=s,this._dirty=!1}load(n,s){if(this._loaded=s||!1,this.fire(new ks("dataloading",{dataType:"source"})),this.url=this.options.url,!this.url)return n&&(this.coordinates=n),this._loaded=!0,void this._finishLoading();this._imageRequest=ap(this.map._requestManager.transformRequest(this.url,vr.Image),(u,_)=>{this._imageRequest=null,this._loaded=!0,u?this.fire(new Ml(u)):_&&(this.image=_ instanceof HTMLImageElement?Le.getImageData(_):_,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,n&&(this.coordinates=n),this._finishLoading())})}loaded(){return this._loaded}updateImage(n){return n.url?(this._imageRequest&&n.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=n.url,this.load(n.coordinates,this._loaded),this):this}setTexture(n){if(!(n.handle instanceof WebGLTexture))throw new Error("The provided handle is not a WebGLTexture instance");return this.texture=new bx(this.map.painter.context,n.handle),this.width=n.dimensions[0],this.height=n.dimensions[1],this._dirty=!1,this._loaded=!0,this._finishLoading(),this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new ks("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(n){this.map=n,this.load()}onRemove(n){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),!this.texture||this.texture instanceof bx||this.texture.destroy(),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy())}setCoordinates(n){if(this.coordinates=n,this._boundsArray=void 0,this._unsupportedCoords=!1,!n.length)return this;this.onNorthPole=!1,this.onSouthPole=!1;let s=n[0][1],u=n[0][1];for(const d of n)d[1]>u&&(u=d[1]),d[1]<s&&(s=d[1]);const _=(u+s)/2;if(_>Br?this.onNorthPole=!0:_<-85.051129&&(this.onSouthPole=!0),!this.onNorthPole&&!this.onSouthPole){const d=n.map(l.fromLngLat);this.tileID=function(v){let E=1/0,O=1/0,z=-1/0,S=-1/0;for(const B of v)E=Math.min(E,B.x),O=Math.min(O,B.y),z=Math.max(z,B.x),S=Math.max(S,B.y);const P=Math.max(z-E,S-O),L=Math.max(0,Math.floor(-Math.log(P)/Math.LN2)),M=Math.pow(2,L);let R=Math.floor((E+z)/2*M);return R>1&&(R-=1),new It(L,R,Math.floor((O+S)/2*M))}(d),this.minzoom=this.maxzoom=this.tileID.z}return this.fire(new ks("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0,this._unsupportedCoords=!1}_prepareData(n){for(const H in this.tiles){const ne=this.tiles[H];ne.state!=="loaded"&&(ne.state="loaded",ne.texture=this.texture)}if(this._boundsArray||this.onNorthPole||this.onSouthPole||this._unsupportedCoords)return;const s=uv(new It(0,0,0),this.map.transform.projection),u=[s.projection.project(this.coordinates[0][0],this.coordinates[0][1]),s.projection.project(this.coordinates[1][0],this.coordinates[1][1]),s.projection.project(this.coordinates[2][0],this.coordinates[2][1]),s.projection.project(this.coordinates[3][0],this.coordinates[3][1])];if(!function(H){const ne=H[1].x-H[0].x,re=H[1].y-H[0].y,K=H[2].x-H[1].x,ie=H[2].y-H[1].y,ce=H[3].x-H[2].x,_e=H[3].y-H[2].y,Ce=H[0].x-H[3].x,Ae=H[0].y-H[3].y,Ee=ne*ie-K*re,Ue=K*_e-ce*ie,Oe=ce*Ae-Ce*_e,Ve=Ce*re-ne*Ae;return Ee>0&&Ue>0&&Oe>0&&Ve>0||Ee<0&&Ue<0&&Oe<0&&Ve<0}(u))return console.warn("Image source coordinates are defining non-convex area in the Mercator projection"),void(this._unsupportedCoords=!0);const _=uv(this.tileID,this.map.transform.projection),[d,v,E,O]=this.coordinates.map(H=>{const ne=_.projection.project(H[0],H[1]);return SI(_,ne)._round()});this.perspectiveTransform=zI(d.x,d.y,v.x,v.y,E.x,E.y,O.x,O.y);const z=this._boundsArray=new $s;z.emplaceBack(d.x,d.y,0,0),z.emplaceBack(v.x,v.y,Kt,0),z.emplaceBack(O.x,O.y,0,Kt),z.emplaceBack(E.x,E.y,Kt,Kt),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy()),this.boundsBuffer=n.createVertexBuffer(z,C3.members),this.boundsSegments=ci.simpleSegment(0,0,4,2);const S=[],P=[Sx((L=this.coordinates)[0]),Sx(L[1]),Sx(L[2]),Sx(L[3])];var L;const[M,R,B,q]=function(H){let ne=H[0][0],re=ne,K=H[0][1],ie=K;for(let ce=1;ce<H.length;ce++)H[ce][0]<ne?ne=H[ce][0]:H[ce][0]>re&&(re=H[ce][0]),H[ce][1]<K?K=H[ce][1]:H[ce][1]>ie&&(ie=H[ce][1]);return[ne,K,re-ne,ie-K]}(P);{const H=new $s,[ne,re,K,ie]=function(Qe){let at=Qe[0].x,Je=at,wt=Qe[0].y,Rt=wt;for(let bt=1;bt<Qe.length;bt++)Qe[bt].x<at?at=Qe[bt].x:Qe[bt].x>Je&&(Je=Qe[bt].x),Qe[bt].y<wt?wt=Qe[bt].y:Qe[bt].y>Rt&&(Rt=Qe[bt].y);return[at,wt,Je-at,Rt-wt]}(u),ce=Qe=>[(Qe.x-ne)/K,(Qe.y-re)/ie],[_e,Ce,Ae,Ee]=u.map(ce),Ue=function(Qe,at,Je,wt,Rt,bt,an,Jt){const Ut=wx(0,0,1,0,1,1,0,1),kt=wx(Qe,at,Je,wt,Rt,bt,an,Jt),vn=Ne.mat3.adjoint([],kt);return Ne.mat3.multiply(Ut,Ut,vn)}(_e[0],_e[1],Ce[0],Ce[1],Ae[0],Ae[1],Ee[0],Ee[1]);this.elevatedGlobePerspectiveTransform=zI(_e[0],_e[1],Ce[0],Ce[1],Ae[0],Ae[1],Ee[0],Ee[1]);const Oe=(Qe,at)=>{S.push(Qe.lng);const Je=Math.round((Qe.lng-M)/B*Kt),wt=Math.round((Qe.lat-R)/q*Kt),Rt=ce(at),bt=Ne.vec3.transformMat3([],[Rt[0],Rt[1],1],Ue),an=Math.round(bt[0]/bt[2]*Kt),Jt=Math.round(bt[1]/bt[2]*Kt);H.emplaceBack(Je,wt,an,Jt)},Ve=u[3].x-u[0].x,Ze=u[3].y-u[0].y,qe=u[2].x-u[1].x,Ke=u[2].y-u[1].y;for(let Qe=0;Qe<65;Qe++){const at=Qe/64,Je=[u[0].x+at*Ve,u[0].y+at*Ze],wt=[u[1].x+at*qe,u[1].y+at*Ke],Rt=wt[0]-Je[0],bt=wt[1]-Je[1];for(let an=0;an<65;an++){const Jt=an/64,Ut={x:Je[0]+Rt*Jt,y:Je[1]+bt*Jt};Oe(s.projection.unproject(Ut.x,Ut.y),Ut)}}this.elevatedGlobeVertexBuffer=n.createVertexBuffer(H,C3.members)}{this.maxLongitudeTriangleSize=0;let H=[],ne=new sa;const re=(K,ie,ce)=>{ne.emplaceBack(K,ie,ce);const _e=S[K],Ce=S[ie],Ae=S[ce],Ee=Math.min(Math.min(_e,Ce),Ae),Ue=Math.max(Math.max(_e,Ce),Ae)-Ee;Ue>this.maxLongitudeTriangleSize&&(this.maxLongitudeTriangleSize=Ue),H.push(Ee+Ue/2)};for(let K=0;K<64;K++)for(let ie=0;ie<64;ie++){const ce=65*K+ie,_e=ce+1,Ce=ce+65,Ae=Ce+1;re(ce,Ce,_e),re(_e,Ce,Ae)}[H,ne]=function(K,ie){const ce=Array.from({length:K.length},(Ae,Ee)=>Ee);ce.sort((Ae,Ee)=>K[Ae]-K[Ee]);const _e=[],Ce=new sa;for(let Ae=0;Ae<ce.length;Ae++){const Ee=ce[Ae];_e.push(K[Ee]);const Ue=3*Ee,Oe=Ue+1;Ce.emplaceBack(ie.uint16[Ue],ie.uint16[Oe],ie.uint16[Oe+1])}return[_e,Ce]}(H,ne),this.elevatedGlobeTrianglesCenterLongitudes=H,this.elevatedGlobeIndexBuffer=n.createIndexBuffer(ne)}this.elevatedGlobeSegments=ci.simpleSegment(0,0,4225,8192),this.elevatedGlobeGridMatrix=new Float32Array([0,B/Kt,0,q/Kt,0,0,R,M,0])}prepare(){const n=Object.keys(this.tiles).length!==0;if(this.tileID&&!n)return;const s=this.map.painter.context,u=s.gl;!this._dirty||this.texture instanceof bx||(this.texture?this.texture.update(this.image):(this.texture=new P3(s,this.image,u.RGBA8),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE)),this._dirty=!1),n&&this._prepareData(s)}loadTile(n,s){this.tileID&&this.tileID.equals(n.tileID.canonical)?(this.tiles[String(n.tileID.wrap)]=n,n.buckets={},s(null)):(n.state="errored",s(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}getSegmentsForLongitude(n){const s=this.elevatedGlobeSegments;if(!this.elevatedGlobeTrianglesCenterLongitudes||!s)return null;const u=this.elevatedGlobeTrianglesCenterLongitudes;let _=(d=n+180)+360*Math.round((u[0]-d)/360);var d;const v=new ci,E=(P,L)=>{v.segments.push({vertexOffset:0,primitiveOffset:P,vertexLength:s.segments[0].vertexLength,primitiveLength:L,sortKey:void 0,vaos:{}})},O=.51*this.maxLongitudeTriangleSize;if(Math.abs(u[0]-_)<=O){const P=_u(u,0,u.length,_+O);return P===u.length||E(P,ip(u,P+1,u.length,_+360-O)-P),v}_<u[0]&&(_+=360);const z=ip(u,0,u.length,_-O);if(z===u.length)return E(0,u.length),v;E(0,z-0);const S=_u(u,z+1,u.length,_+O);return S!==u.length&&E(S,u.length-S),v}}const Yq=(Math.pow(256,2)-1)/16907520;class NI extends $i{constructor(n,s,u,_){super(n,{layout:LI||(LI=new ni({visibility:new qt(st.layout_raster.visibility)})),paint:kI||(kI=new ni({"raster-opacity":new qt(st.paint_raster["raster-opacity"]),"raster-color":new Lu(st.paint_raster["raster-color"]),"raster-color-mix":new qt(st.paint_raster["raster-color-mix"]),"raster-color-range":new qt(st.paint_raster["raster-color-range"]),"raster-hue-rotate":new qt(st.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new qt(st.paint_raster["raster-brightness-min"]),"raster-brightness-max":new qt(st.paint_raster["raster-brightness-max"]),"raster-saturation":new qt(st.paint_raster["raster-saturation"]),"raster-contrast":new qt(st.paint_raster["raster-contrast"]),"raster-resampling":new qt(st.paint_raster["raster-resampling"]),"raster-fade-duration":new qt(st.paint_raster["raster-fade-duration"]),"raster-emissive-strength":new qt(st.paint_raster["raster-emissive-strength"]),"raster-array-band":new qt(st.paint_raster["raster-array-band"]),"raster-elevation":new qt(st.paint_raster["raster-elevation"]),"raster-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"})}))},s,u,_),this.updateColorRamp(),this._curRampRange=[NaN,NaN]}getProgramIds(){return["raster"]}hasColorMap(){return!!this._transitionablePaint._values["raster-color"].value.value}tileCoverLift(){return this.paint.get("raster-elevation")}isDraped(n){return!(n&&n._source instanceof BI&&(n._source.onNorthPole||n._source.onSouthPole))&&this.paint.get("raster-elevation")===0}_handleSpecialPaintPropertyUpdate(n){n!=="raster-color"&&n!=="raster-color-range"||(this._curRampRange=[NaN,NaN],this.updateColorRamp())}updateColorRamp(n){if(!this.hasColorMap()||!this._curRampRange)return;const s=this._transitionablePaint._values["raster-color"].value.expression,[u,_]=n||this._transitionablePaint._values["raster-color-range"].value.expression.evaluate({zoom:0})||[NaN,NaN];isNaN(u)&&isNaN(_)||u===this._curRampRange[0]&&_===this._curRampRange[1]||(this.colorRamp=vd({expression:s,evaluationKey:"rasterValue",image:this.colorRamp,clips:[{start:u,end:_}],resolution:256}),this.colorRampTexture=null,this._curRampRange=[u,_])}}let FI,jI,UI,VI,$I;class qI extends $i{constructor(n,s,u,_){super(n,{layout:FI||(FI=new ni({visibility:new qt(st["layout_raster-particle"].visibility)})),paint:jI||(jI=new ni({"raster-particle-array-band":new qt(st["paint_raster-particle"]["raster-particle-array-band"]),"raster-particle-count":new qt(st["paint_raster-particle"]["raster-particle-count"]),"raster-particle-color":new Lu(st["paint_raster-particle"]["raster-particle-color"]),"raster-particle-max-speed":new qt(st["paint_raster-particle"]["raster-particle-max-speed"]),"raster-particle-speed-factor":new qt(st["paint_raster-particle"]["raster-particle-speed-factor"]),"raster-particle-fade-opacity-factor":new qt(st["paint_raster-particle"]["raster-particle-fade-opacity-factor"]),"raster-particle-reset-rate-factor":new qt(st["paint_raster-particle"]["raster-particle-reset-rate-factor"]),"raster-particle-elevation":new qt(st["paint_raster-particle"]["raster-particle-elevation"]),"raster-particle-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"})}))},s,u,_),this._updateColorRamp(),this.lastInvalidatedAt=Le.now()}onRemove(n){this.colorRampTexture&&this.colorRampTexture.destroy(),this.tileFramebuffer&&this.tileFramebuffer.destroy(),this.particleFramebuffer&&this.particleFramebuffer.destroy()}hasColorMap(){return!!this._transitionablePaint._values["raster-particle-color"].value.value}getProgramIds(){return["rasterParticle"]}hasOffscreenPass(){return this.visibility!=="none"}isDraped(n){return!1}_handleSpecialPaintPropertyUpdate(n){n!=="raster-particle-color"&&n!=="raster-particle-max-speed"||(this._updateColorRamp(),this._invalidateAnimationState()),n==="raster-particle-count"&&this._invalidateAnimationState()}_updateColorRamp(){if(!this.hasColorMap())return;const n=this._transitionablePaint._values["raster-particle-color"].value.expression,s=this._transitionablePaint._values["raster-particle-max-speed"].value.expression.evaluate({zoom:0});this.colorRamp=vd({expression:n,evaluationKey:"rasterParticleSpeed",image:this.colorRamp,clips:[{start:0,end:s}],resolution:256}),this.colorRampTexture=null}_invalidateAnimationState(){this.lastInvalidatedAt=Le.now()}tileCoverLift(){return this.paint.get("raster-particle-elevation")}}class Kq extends $i{constructor(n,s){super(n,{},s,null),this.implementation=n,n.slot&&(this.slot=n.slot)}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isDraped(n){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(n){this.implementation.onAdd&&this.implementation.onAdd(n,n.painter.context.gl)}onRemove(n){this.implementation.onRemove&&this.implementation.onRemove(n,n.painter.context.gl)}}function I3(c,n,s){const u=[0,0,1],_=Ne.quat.identity([]);return Ne.quat.rotateY(_,_,s?-$n(c)+Math.PI:$n(c)),Ne.quat.rotateX(_,_,-$n(n)),Ne.vec3.transformQuat(u,u,_),Ne.vec3.normalize(u,u)}function GI(c,n){const s=Tx(c.projection,c.zoom,c.width,c.height),u=function(d,v,E,O,z){const S=new pr(E.lng-180*em,E.lat),P=new pr(E.lng+180*em,E.lat),L=d.project(S.lng,S.lat),M=d.project(P.lng,P.lat),R=-Math.atan2(M.y-L.y,M.x-L.x),B=l.fromLngLat(E);B.y=Bn(B.y,-1+em,1-em);const q=B.toLngLat(),H=d.project(q.lng,q.lat),ne=l.fromLngLat(q);ne.x+=em;const re=ne.toLngLat(),K=d.project(re.lng,re.lat),ie=ZI(K.x-H.x,K.y-H.y,R),ce=l.fromLngLat(q);ce.y+=em;const _e=ce.toLngLat(),Ce=d.project(_e.lng,_e.lat),Ae=ZI(Ce.x-H.x,Ce.y-H.y,R),Ee=Math.abs(ie.x)/Math.abs(Ae.y),Ue=Ne.mat4.identity([]);Ne.mat4.rotateZ(Ue,Ue,-R*(1-(z?0:O)));const Oe=Ne.mat4.identity([]);return Ne.mat4.scale(Oe,Oe,[1,1-(1-Ee)*O,1]),Oe[4]=-Ae.x/Ae.y*O,Ne.mat4.rotateZ(Oe,Oe,R),Ne.mat4.multiply(Oe,Ue,Oe),Oe}(c.projection,0,c.center,s,n),_=HI(c);return Ne.mat4.scale(u,u,[_,_,1]),u}function HI(c){const n=c.projection,s=Tx(c.projection,c.zoom,c.width,c.height),u=R3(n,c.center),_=R3(n,pr.convert(n.center));return Math.pow(2,u*s+(1-s)*_)}function Tx(c,n,s,u,_=1/0){const d=c.range;if(!d)return 0;const v=Math.min(_,Math.max(s,u)),E=Math.log(v/1024)/Math.LN2;return jo(d[0]+E,d[1]+E,n)}const em=1/4e4;function R3(c,n){const s=Bn(n.lat,-85.051129,Br),u=new pr(n.lng-180*em,s),_=new pr(n.lng+180*em,s),d=c.project(u.lng,s),v=c.project(_.lng,s),E=l.fromLngLat(u),O=l.fromLngLat(_),z=v.x-d.x,S=v.y-d.y,P=O.x-E.x,L=O.y-E.y,M=Math.sqrt((P*P+L*L)/(z*z+S*S));return Math.log(M)/Math.LN2}function ZI(c,n,s){const u=Math.cos(s),_=Math.sin(s);return{x:c*u-n*_,y:c*_+n*u}}function WI(c,n,s){Ne.mat4.identity(c),Ne.mat4.rotateZ(c,c,$n(n[2])),Ne.mat4.rotateX(c,c,$n(n[0])),Ne.mat4.rotateY(c,c,$n(n[1])),Ne.mat4.scale(c,c,s),Ne.mat4.multiply(c,c,[1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1])}function Ex(c,n,s,u,_,d,v,E){const O=[s[0]-n[0],s[1]-n[1],0],z=[u[0]-n[0],u[1]-n[1],0];if(Ne.vec3.length(O)<1e-12||Ne.vec3.length(z)<1e-12)return Ne.quat.identity(c);const S=Ne.vec3.cross([],O,z);Ne.vec3.normalize(S,S),Ne.vec3.subtract(z,u,n),O[2]=(d-_)*E,z[2]=(v-_)*E;const P=O;return Ne.vec3.cross(P,O,z),Ne.vec3.normalize(P,P),Ne.quat.rotationTo(c,S,P)}function D3(c,n,s=!1){const u=ja(n.zoom),_=function(d,v,E){const O=v.worldSize,z=[d[12],d[13],d[14]],S=qi(z[1]/O),P=no(z[0]/O),L=Ne.mat4.identity([]),M=Fa(1,S)*O,R=Fa(1,0)*O*$u(S,v.zoom),B=1/bi(O);let q=R*B;if(E){const K=Tx(v.projection,v.zoom,v.width,v.height,1024);q=B*v.projection.pixelSpaceConversion(v.center.lat,O,K)}const H=Gc(S,P);Ne.vec3.add(H,H,Ne.vec3.scale([],Ne.vec3.normalize([],H),M*q*z[2]));const ne=function(K){const ie=[K[0],K[1],K[2]];let ce=[0,1,0];const _e=Ne.vec3.cross([],ce,ie);return Ne.vec3.cross(ce,ie,_e),Ne.vec3.squaredLength(ce)===0&&(ce=[0,1,0],Ne.vec3.cross(_e,ie,ce)),Ne.vec3.normalize(_e,_e),Ne.vec3.normalize(ce,ce),Ne.vec3.normalize(ie,ie),[_e[0],_e[1],_e[2],0,ce[0],ce[1],ce[2],0,ie[0],ie[1],ie[2],0,K[0],K[1],K[2],1]}(H);Ne.mat4.scale(L,L,[q,q,q*M]),Ne.mat4.translate(L,L,[-z[0],-z[1],-z[2]]);const re=Ne.mat4.multiply([],v.globeMatrix,ne);return Ne.mat4.multiply(re,re,L),Ne.mat4.multiply(re,re,d),re}(c,n,s);if(u>0){const d=function(v,E){const O=E.worldSize,z=Fa(1,0)*O*$u(E.center.lat,E.zoom)/bi(O),S=Fa(1,E.center.lat)*O,P=Ne.mat4.identity([]);return Ne.mat4.rotateY(P,P,$n(E.center.lng)),Ne.mat4.rotateX(P,P,$n(E.center.lat)),Ne.mat4.translate(P,P,[0,0,Na]),Ne.mat4.scale(P,P,[z,z,z*S]),Ne.mat4.translate(P,P,[E.point.x-.5*O,E.point.y-.5*O,0]),Ne.mat4.multiply(P,P,v),Ne.mat4.multiply(P,E.globeMatrix,P)}(c,n);return function(v,E,O){const z=(R,B,q)=>{const H=Ne.vec3.length(R),ne=Ne.vec3.length(B),re=hi(R,B,q);return Ne.vec3.scale(re,re,1/Ne.vec3.length(re)*Mn(H,ne,q))},S=z([v[0],v[1],v[2]],[E[0],E[1],E[2]],O),P=z([v[4],v[5],v[6]],[E[4],E[5],E[6]],O),L=z([v[8],v[9],v[10]],[E[8],E[9],E[10]],O),M=hi([v[12],v[13],v[14]],[E[12],E[13],E[14]],O);return[S[0],S[1],S[2],0,P[0],P[1],P[2],0,L[0],L[1],L[2],0,M[0],M[1],M[2],1]}(_,d,u)}return _}function XI(c,n,s,u){const _=sn.projectAabbCorners(u,s);let d=Number.MAX_VALUE,v=-1;for(let z=0;z<_.length;++z){const S=_[z];S[0]=(.5*S[0]+.5)*n.width,S[1]=(.5-.5*S[1])*n.height,S[2]<d&&(v=z,d=S[2])}const E=z=>new Pt(_[z][0],_[z][1]);let O;switch(v){case 0:case 6:O=[E(1),E(5),E(4),E(7),E(3),E(2),E(1)];break;case 1:case 7:O=[E(0),E(4),E(5),E(6),E(2),E(3),E(0)];break;case 3:case 5:O=[E(1),E(0),E(4),E(7),E(6),E(2),E(1)];break;default:O=[E(1),E(5),E(6),E(7),E(3),E(0),E(1)]}if(se(c,O))return d}const Jq=br([{name:"a_pos_3f",components:3,type:"Float32"}]),Qq=br([{name:"a_color_3f",components:3,type:"Float32"}]),eG=br([{name:"a_color_4f",components:4,type:"Float32"}]),tG=br([{name:"a_uv_2f",components:2,type:"Float32"}]),nG=br([{name:"a_normal_3f",components:3,type:"Float32"}]),rG=br([{name:"a_normal_matrix0",components:4,type:"Float32"},{name:"a_normal_matrix1",components:4,type:"Float32"},{name:"a_normal_matrix2",components:4,type:"Float32"},{name:"a_normal_matrix3",components:4,type:"Float32"}]),iG=br([{name:"a_pbr",components:4,type:"Uint16"},{name:"a_heightBasedEmissiveStrength",components:3,type:"Float32"}]),YI={None:0,Model:1,Symbol:2,FillExtrusion:4,All:7};class Ax{constructor(n,s,u,_){this.message=(n?`${n}: `:"")+u,_&&(this.identifier=_),s!=null&&s.__line__&&(this.line=s.__line__)}}function KI(c,n){const s=c.indexOf("://")===-1;try{return new URL(c,s&&n?"http://example.com":void 0),!0}catch{return!1}}class JI{constructor(n,s){this.feature=n,this.instancedDataOffset=s,this.instancedDataCount=0,this.rotation=[0,0,0],this.scale=[1,1,1],this.translation=[0,0,0]}}class QI{constructor(){this.instancedDataArray=new Vc,this.instancesEvaluatedElevation=[],this.features=[],this.idToFeaturesIndex={}}}class L3{constructor(n){this.zoom=n.zoom,this.canonical=n.canonical,this.layers=n.layers,this.layerIds=this.layers.map(s=>s.fqid),this.projection=n.projection,this.index=n.index,this.hasZoomDependentProperties=this.layers[0].isZoomDependent(),this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id),this.hasPattern=!1,this.instancesPerModel={},this.validForExaggeration=0,this.maxVerticalOffset=0,this.maxScale=0,this.maxHeight=0,this.lookupDim=this.zoom>this.canonical.z?256:this.zoom>15?75:100,this.instanceCount=0,this.terrainElevationMin=0,this.terrainElevationMax=0,this.validForDEMTile={id:null,timestamp:0},this.modelUris=[],this.modelsRequested=!1,this.activeReplacements=[],this.replacementUpdateTime=0}updateFootprints(n,s){}populate(n,s,u,_){this.tileToMeter=r(u);const d=this.layers[0]._featureFilter.needGeometry;this.lookup=new Uint8Array(this.lookupDim*this.lookupDim);for(const{feature:v,id:E,index:O,sourceLayerIndex:z}of n){const S=E??(v.properties&&v.properties.hasOwnProperty("id")?v.properties.id:void 0),P=Z(v,d);if(!this.layers[0]._featureFilter.filter(new zr(this.zoom),P,u))continue;const L={id:S,sourceLayerIndex:z,index:O,geometry:d?P.geometry:$(v,u,_),properties:v.properties,type:v.type,patterns:{}},M=this.addFeature(L,L.geometry,P);M&&s.featureIndex.insert(v,L.geometry,O,z,this.index,this.instancesPerModel[M].instancedDataArray.length,Kt/32)}this.lookup=null}update(n,s,u,_){for(const d in this.instancesPerModel){const v=this.instancesPerModel[d];for(const E in n)v.idToFeaturesIndex.hasOwnProperty(E)&&(this.evaluate(v.features[v.idToFeaturesIndex[E]],n[E],v,!0),this.uploaded=!1)}this.maxHeight=0}updateZoomBasedPaintProperties(){if(!this.hasZoomDependentProperties)return!1;let n=!1;for(const s in this.instancesPerModel){const u=this.instancesPerModel[s];for(const _ of u.features){const d=this.layers[0],v=_.feature,E=this.canonical,O=d.paint.get("model-rotation").evaluate(v,{},E),z=d.paint.get("model-scale").evaluate(v,{},E),S=d.paint.get("model-translation").evaluate(v,{},E);Ne.vec3.exactEquals(_.rotation,O)&&Ne.vec3.exactEquals(_.scale,z)&&Ne.vec3.exactEquals(_.translation,S)||(this.evaluate(_,_.featureStates,u,!0),n=!0)}}return n}updateReplacement(n,s,u,_){if(s.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=s.updateTime;const d=s.getReplacementRegionsForTile(n.toUnwrapped(),!0);if(l0(this.activeReplacements,d))return!1;this.activeReplacements=d;let v=!1;for(const E in this.instancesPerModel){const O=this.instancesPerModel[E],z=O.instancedDataArray;for(const S of O.features){const P=S.instancedDataOffset,L=S.instancedDataCount;for(let M=0;M<L;M++){const R=16*(M+P);let B=z.float32[R+0];const q=B>Kt;B=q?B-Kt:B;const H=Math.floor(B),ne=z.float32[R+1];let re=!1;for(const K of this.activeReplacements)if(!z_(K,u,YI.Model,_)&&!(K.min.x>H||H>K.max.x||K.min.y>ne||ne>K.max.y)&&(re=X2(Uy(H,ne,n.canonical,K.footprintTileId.canonical),K.footprint),re))break;z.float32[R]=re?B+Kt:B,v=v||re!==q}}}return v}isEmpty(){for(const n in this.instancesPerModel)if(this.instancesPerModel[n].instancedDataArray.length!==0)return!1;return!0}uploadPending(){return!this.uploaded}upload(n){if(!this.uploaded)for(const s in this.instancesPerModel){const u=this.instancesPerModel[s];u.instancedDataArray.length<0||u.instancedDataArray.length===0||(u.instancedDataBuffer?u.instancedDataBuffer.updateData(u.instancedDataArray):u.instancedDataBuffer=n.createVertexBuffer(u.instancedDataArray,rG.members,!0,void 0,this.instanceCount))}this.uploaded=!0}destroy(){for(const s in this.instancesPerModel){const u=this.instancesPerModel[s];u.instancedDataArray.length!==0&&u.instancedDataBuffer&&u.instancedDataBuffer.destroy()}const n=this.layers[0].modelManager;if(n&&this.modelUris)for(const s of this.modelUris)n.removeModel(s,"")}addFeature(n,s,u){const _=this.layers[0],d=_.layout.get("model-id").evaluate(u,{},this.canonical);if(!d)return qn(`modelId is not evaluated for layer ${_.id} and it is not going to get rendered.`),d;KI(d,!1)&&(this.modelUris.includes(d)||this.modelUris.push(d)),this.instancesPerModel[d]||(this.instancesPerModel[d]=new QI);const v=this.instancesPerModel[d],E=v.instancedDataArray,O=new JI(u,E.length);for(const z of s)for(const S of z){if(S.x<0||S.x>=Kt||S.y<0||S.y>=Kt)continue;const P=(this.lookupDim-1)/Kt,L=this.lookupDim*(S.y*P|0)+S.x*P|0;if(this.lookup){if(this.lookup[L]!==0)continue;this.lookup[L]=1}this.instanceCount++;const M=E.length;E.resize(M+1),v.instancesEvaluatedElevation.push(0),E.float32[16*M]=S.x,E.float32[16*M+1]=S.y}return O.instancedDataCount=v.instancedDataArray.length-O.instancedDataOffset,O.instancedDataCount>0&&(n.id&&(v.idToFeaturesIndex[n.id]=v.features.length),v.features.push(O),this.evaluate(O,{},v,!1)),d}getModelUris(){return this.modelUris}evaluate(n,s,u,_){const d=this.layers[0],v=n.feature,E=this.canonical,O=n.rotation=d.paint.get("model-rotation").evaluate(v,s,E),z=n.scale=d.paint.get("model-scale").evaluate(v,s,E),S=n.translation=d.paint.get("model-translation").evaluate(v,s,E),P=d.paint.get("model-color").evaluate(v,s,E);P.a=d.paint.get("model-color-mix-intensity").evaluate(v,s,E);const L=[];this.maxVerticalOffset<S[2]&&(this.maxVerticalOffset=S[2]),this.maxScale=Math.max(Math.max(this.maxScale,z[0]),Math.max(z[1],z[2])),WI(L,O,z);const M=Math.round(100*P.a)+P.b/1.05;for(let R=0;R<n.instancedDataCount;++R){const B=n.instancedDataOffset+R,q=16*B,H=u.instancedDataArray.float32;let ne=0;_&&(ne=H[q+6]-u.instancesEvaluatedElevation[B]);const re=0|H[q+1];H[q]=(0|H[q])+P.r/1.05,H[q+1]=re+P.g/1.05,H[q+2]=M,H[q+3]=1/(E.z>10?this.tileToMeter:r(E,re)),H[q+4]=S[0],H[q+5]=S[1],H[q+6]=S[2]+ne,H[q+7]=L[0],H[q+8]=L[1],H[q+9]=L[2],H[q+10]=L[4],H[q+11]=L[5],H[q+12]=L[6],H[q+13]=L[8],H[q+14]=L[9],H[q+15]=L[10],u.instancesEvaluatedElevation[B]=S[2]}}}let eR,tR;hn(L3,"ModelBucket",{omit:["layers"]}),hn(QI,"PerModelAttributes"),hn(JI,"ModelFeature");const x0=64,Q_={CoordinateSpaceTile:1,CoordinateSpaceYUp:2,HasMapboxMeshFeatures:4,HasMeshoptCompression:8};function nR(c,n,s,u,_,d,v,E,O,z=!1){const S=s.zoom,P=s.project(u),L=$u(u.lat,S),M=1/L;Ne.mat4.identity(c),Ne.mat4.translate(c,c,[P.x+v[0]*M,P.y+v[1]*M,v[2]]);let R=1,B=1;const q=s.worldSize;if(z){if(s.projection.name==="mercator"){let K=0;s.elevation&&(K=s.elevation.getAtPointOrZero(new l(P.x/q,P.y/q),0));const ie=Ne.vec4.transformMat4([],[P.x,P.y,K,1],s.projMatrix)[3]/s.cameraToCenterDistance;R=ie,B=ie*$u(s.center.lat,S)}else if(s.projection.name==="globe"){const K=D3(c,s),ie=Ne.mat4.multiply([],s.projMatrix,K),ce=[0,0,0,1];Ne.vec4.transformMat4(ce,ce,ie);const _e=ce[3]/s.cameraToCenterDistance,Ce=ja(S),Ae=s.projection.pixelsPerMeter(u.lat,q)*$u(u.lat,S),Ee=s.projection.pixelsPerMeter(s.center.lat,q)*$u(s.center.lat,S);R=_e/Mn(Ae,gd(s.center.lat),Ce),B=_e*L/Ae,R*=Ee,B*=Ee}}else R=M;Ne.mat4.scale(c,c,[R,R,B]);const H=[...c],ne=n.orientation,re=[];if(WI(re,[ne[0]+_[0],ne[1]+_[1],ne[2]+_[2]],d),Ne.mat4.multiply(c,H,re),E&&s.elevation){let K=0;const ie=[];if(O&&s.elevation){K=function(Ce,Ae,Ee,Ue,Oe){const Ve=Ae.elevation;if(!Ve)return 0;const Ze=sn.projectAabbCorners(Ee,Ue),qe=Fa(1,Oe.lat)*Ae.worldSize,Ke=function(vn,ln){const pn=[0,0,1],zn=[{corners:[0,1,3,2],dotProductWithUp:0},{corners:[1,5,2,6],dotProductWithUp:0},{corners:[0,4,1,5],dotProductWithUp:0},{corners:[2,6,3,7],dotProductWithUp:0},{corners:[4,7,5,6],dotProductWithUp:0},{corners:[0,3,4,7],dotProductWithUp:0}];for(const Gn of zn){const Zn=vn[Gn.corners[0]],Wn=vn[Gn.corners[1]],lr=vn[Gn.corners[2]],ur=[Wn[0]-Zn[0],Wn[1]-Zn[1],ln*(Wn[2]-Zn[2])],Zr=Ne.vec3.cross(ur,ur,[lr[0]-Zn[0],lr[1]-Zn[1],ln*(lr[2]-Zn[2])]);Ne.vec3.normalize(Zr,Zr),Gn.dotProductWithUp=Ne.vec3.dot(Zr,pn)}return zn.sort((Gn,Zn)=>Gn.dotProductWithUp-Zn.dotProductWithUp),zn[0].corners}(Ze,qe),Qe=Ze[Ke[0]],at=Ze[Ke[1]],Je=Ze[Ke[2]],wt=Ze[Ke[3]],Rt=Ve.getAtPointOrZero(new l(Qe[0]/Ae.worldSize,Qe[1]/Ae.worldSize),0),bt=Ve.getAtPointOrZero(new l(at[0]/Ae.worldSize,at[1]/Ae.worldSize),0),an=Ve.getAtPointOrZero(new l(Je[0]/Ae.worldSize,Je[1]/Ae.worldSize),0),Jt=Ve.getAtPointOrZero(new l(wt[0]/Ae.worldSize,wt[1]/Ae.worldSize),0),Ut=(Rt+Jt)/2,kt=(bt+an)/2;return Ut>kt?bt<an?Ex(Ce,at,wt,Qe,bt,Jt,Rt,qe):Ex(Ce,Je,Qe,wt,an,Rt,Jt,qe):Rt<Jt?Ex(Ce,Qe,at,Je,Rt,bt,an,qe):Ex(Ce,wt,Je,at,Jt,an,bt,qe),Math.max(Ut,kt)}(ie,s,n.aabb,c,u);const ce=Ne.mat4.fromQuat([],ie),_e=Ne.mat4.multiply([],ce,re);Ne.mat4.multiply(c,H,_e)}else K=s.elevation.getAtPointOrZero(new l(P.x/q,P.y/q),0);K!==0&&(c[14]+=K)}}function mv(c,n,s=!1){c.uploaded||(c.gfxTexture=new P3(n,c.image,s?n.gl.R8:n.gl.RGBA8,{useMipmap:c.sampler.minFilter>=n.gl.NEAREST_MIPMAP_NEAREST}),c.uploaded=!0,c.image=null)}function aG(c,n,s){c.indexBuffer=n.createIndexBuffer(c.indexArray,!1,!0),c.vertexBuffer=n.createVertexBuffer(c.vertexArray,Jq.members,!1,!0),c.normalArray&&(c.normalBuffer=n.createVertexBuffer(c.normalArray,nG.members,!1,!0)),c.texcoordArray&&(c.texcoordBuffer=n.createVertexBuffer(c.texcoordArray,tG.members,!1,!0)),c.colorArray&&(c.colorBuffer=n.createVertexBuffer(c.colorArray,(c.colorArray.bytesPerElement===12?Qq:eG).members,!1,!0)),c.featureArray&&(c.pbrBuffer=n.createVertexBuffer(c.featureArray,iG.members,!0)),c.segments=ci.simpleSegment(0,0,c.vertexArray.length,c.indexArray.length);const u=c.material;u.pbrMetallicRoughness.baseColorTexture&&mv(u.pbrMetallicRoughness.baseColorTexture,n),u.pbrMetallicRoughness.metallicRoughnessTexture&&mv(u.pbrMetallicRoughness.metallicRoughnessTexture,n),u.normalTexture&&mv(u.normalTexture,n),u.occlusionTexture&&mv(u.occlusionTexture,n,s),u.emissionTexture&&mv(u.emissionTexture,n)}function k3(c,n,s){if(c.meshes)for(const u of c.meshes)aG(u,n,s);if(c.children)for(const u of c.children)k3(u,n,s)}function Cx(c){if(c.meshes)for(const n of c.meshes)n.indexArray.destroy(),n.vertexArray.destroy(),n.colorArray&&n.colorArray.destroy(),n.normalArray&&n.normalArray.destroy(),n.texcoordArray&&n.texcoordArray.destroy(),n.featureArray&&n.featureArray.destroy();if(c.children)for(const n of c.children)Cx(n)}function z3(c){if(c.meshes)for(const s of c.meshes)s.vertexBuffer&&(s.vertexBuffer.destroy(),s.indexBuffer.destroy(),s.normalBuffer&&s.normalBuffer.destroy(),s.texcoordBuffer&&s.texcoordBuffer.destroy(),s.colorBuffer&&s.colorBuffer.destroy(),s.pbrBuffer&&s.pbrBuffer.destroy(),s.segments.destroy(),s.material&&((n=s.material).pbrMetallicRoughness.baseColorTexture&&n.pbrMetallicRoughness.baseColorTexture.gfxTexture&&n.pbrMetallicRoughness.baseColorTexture.gfxTexture.destroy(),n.pbrMetallicRoughness.metallicRoughnessTexture&&n.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture&&n.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture.destroy(),n.normalTexture&&n.normalTexture.gfxTexture&&n.normalTexture.gfxTexture.destroy(),n.emissionTexture&&n.emissionTexture.gfxTexture&&n.emissionTexture.gfxTexture.destroy(),n.occlusionTexture&&n.occlusionTexture.gfxTexture&&n.occlusionTexture.gfxTexture.destroy()));var n;if(c.children)for(const s of c.children)z3(s)}class eg{constructor(n,s,u){this._demTile=n,this._dem=this._demTile.dem,this._scale=s,this._offset=u}static create(n,s,u){const _=u||n.findDEMTileFor(s);if(!_||!_.dem)return;const d=_.dem,v=_.tileID,E=1<<s.canonical.z-v.canonical.z;return new eg(_,d.dim/Kt/E,[(s.canonical.x/E-v.canonical.x)*d.dim,(s.canonical.y/E-v.canonical.y)*d.dim])}tileCoordToPixel(n,s){const u=s*this._scale+this._offset[1],_=Math.floor(n*this._scale+this._offset[0]),d=Math.floor(u);return new Pt(_,d)}getElevationAt(n,s,u,_){const d=n*this._scale+this._offset[0],v=s*this._scale+this._offset[1],E=Math.floor(d),O=Math.floor(v),z=this._dem;return _=!!_,u?Mn(Mn(z.get(E,O,_),z.get(E,O+1,_),v-O),Mn(z.get(E+1,O,_),z.get(E+1,O+1,_),v-O),d-E):z.get(E,O,_)}getElevationAtPixel(n,s,u){return this._dem.get(n,s,!!u)}getMeterToDEM(n){return(1<<this._demTile.tileID.canonical.z)*Fa(1,n)*this._dem.stride}}const B3=new Float32Array(262144),b0=new Uint8Array(262144);function rR(c){let n=0;if(c.meshes)for(const s of c.meshes)n=Math.max(n,s.aabb.max[2]);if(c.children)for(const s of c.children)n=Math.max(n,rR(s));return n}function iR(c,n,s){if(c.meshes)for(const u of c.meshes){if(u.aabb.min[0]===1/0)continue;const _=sn.applyTransform(u.aabb,c.matrix);s.insert(n,_.min[0],_.min[1],_.max[0],_.max[1])}if(c.children)for(const u of c.children)iR(u,n,s)}const aR=["","wall","door","roof","window","lamp","logo"];class oR{constructor(n){this.node=n,this.evaluatedRMEA=[[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[.4,1,0,1],[1,0,0,1],[1,0,0,1]],this.hiddenByReplacement=!1,this.evaluatedScale=[1,1,1],this.evaluatedColor=[],this.emissionHeightBasedParams=[],this.cameraCollisionOpacity=1,this.feature={type:"Point",id:n.id,geometry:[],properties:{height:rR(n)}},this.aabb=this._getLocalBounds(),this.state=null}_getLocalBounds(){if(!this.node.meshes)return new sn([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);if(!this.aabb){let n=0;const s=new sn([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);for(const u of this.node.meshes)this.node.lightMeshIndex!==n&&(u.transformedAabb=sn.applyTransformFast(u.aabb,this.node.matrix),s.encapsulate(u.transformedAabb)),n++;this.aabb=s}return this.aabb}}class Mx{constructor(n,s,u,_,d,v,E){this.id=u,this.layers=n,this.layerIds=this.layers.map(O=>O.fqid),this.stateDependentLayerIds=this.layers.filter(O=>O.isStateDependent()).map(O=>O.id),this.modelTraits|=Q_.CoordinateSpaceTile,this.uploaded=!1,this.hasPattern=!1,_&&(this.modelTraits|=Q_.HasMapboxMeshFeatures),d&&(this.modelTraits|=Q_.HasMeshoptCompression),this.zoom=-1,this.terrainExaggeration=1,this.projection={name:"mercator"},this.replacementUpdateTime=0,this.elevationReadFromZ=255,this.brightness=v,this.dirty=!0,this.needsUpload=!1,this.nodesInfo=[];for(const O of s)this.nodesInfo.push(new oR(O)),iR(O,E.featureIndexArray.length,E.grid),E.featureIndexArray.emplaceBack(this.nodesInfo.length-1,0,E.bucketLayerIDs.length-1,0);this.states={}}updateFootprints(n,s){for(const u of this.getNodesInfo()){const _=u.node;_.footprint&&s.push({footprint:_.footprint,id:n})}}update(n){const s=Object.keys(n).length!==0;if(s&&!this.stateDependentLayers.length)return;const u=s?this.stateDependentLayers:this.layers;if(!Pr(n,this.states))for(const _ of u)this.evaluate(_,n);this.states=structuredClone(n)}populate(){console.log("populate 3D model bucket")}uploadPending(){return!this.uploaded||this.needsUpload}upload(n){if(!this.needsUpload)return;const s=this.getNodesInfo();for(const u of s){const _=u.node;this.uploaded?this.updatePbrBuffer(_):k3(_,n,!0)}for(const u of s)Cx(u.node);this.uploaded=!0,this.needsUpload=!1}updatePbrBuffer(n){let s=!1;if(!n.meshes)return s;for(const u of n.meshes)u.pbrBuffer&&(u.pbrBuffer.updateData(u.featureArray),s=!0);return s}needsReEvaluation(n,s,u){const _=n.transform.projectionOptions,d=n.style.getBrightness(),v=this.brightness!==d;if(!this.uploaded||this.dirty||_.name!==this.projection.name||_v(u.paint.get("model-color").value,v)||_v(u.paint.get("model-color-mix-intensity").value,v)||_v(u.paint.get("model-roughness").value,v)||_v(u.paint.get("model-emissive-strength").value,v)||_v(u.paint.get("model-height-based-emissive-strength-multiplier").value,v)){this.projection=_,this.brightness=d;const E=this.getNodesInfo();for(const O of E)O.state=null;return!0}return!1}evaluateScale(n,s){if(n.transform.zoom===this.zoom)return;this.zoom=n.transform.zoom;const u=this.getNodesInfo(),_=this.id.canonical;for(const d of u){const v=d.feature;d.evaluatedScale=s.paint.get("model-scale").evaluate(v,{},_)}}evaluate(n,s){const u=this.getNodesInfo();for(const _ of u){if(!_.node.meshes)continue;const d=_.feature,v=s&&s[d.id];if(Pr(v,_.state))continue;_.state=structuredClone(v);const E=_.node.meshes&&_.node.meshes[0].featureData,O=_.evaluatedColor[2],z=_.evaluatedRMEA[2],S=this.id.canonical;if(_.hasTranslucentParts=!1,E){for(let P=0;P<aR.length;P++){const L=aR[P];L.length&&(d.properties.part=L);const M=n.paint.get("model-color").evaluate(d,v,S).toRenderColor(null),R=n.paint.get("model-color-mix-intensity").evaluate(d,v,S);_.evaluatedColor[P]=[M.r,M.g,M.b,R],_.evaluatedRMEA[P][0]=n.paint.get("model-roughness").evaluate(d,v,S),_.evaluatedRMEA[P][2]=n.paint.get("model-emissive-strength").evaluate(d,v,S),_.evaluatedRMEA[P][3]=M.a,_.emissionHeightBasedParams[P]=n.paint.get("model-height-based-emissive-strength-multiplier").evaluate(d,v,S),!_.hasTranslucentParts&&M.a<1&&(_.hasTranslucentParts=!0)}delete d.properties.part,sG(_,O!==_.evaluatedColor[2]||z!==_.evaluatedRMEA[2],this.modelTraits)}else _.evaluatedRMEA[0][2]=n.paint.get("model-emissive-strength").evaluate(d,v,S);_.evaluatedScale=n.paint.get("model-scale").evaluate(d,v,S),this.updatePbrBuffer(_.node)||(this.needsUpload=!0)}this.dirty=!1}elevationUpdate(n,s,u,_){const d=n.findDEMTileFor(u);if(d&&(d.tileID.canonical!==this.terrainTile||s!==this.terrainExaggeration)){if(d.dem&&d.tileID.overscaledZ!==this.elevationReadFromZ){this.elevationReadFromZ=d.tileID.overscaledZ;const v=eg.create(n,u,d);if(!v)return;this.modelTraits&Q_.HasMapboxMeshFeatures&&this.updateDEM(n,v,u,_);for(const E of this.getNodesInfo()){const O=E.node;if(!O.footprint||!O.footprint.vertices||!O.footprint.vertices.length)continue;const z=O.footprint.vertices;let S=v.getElevationAt(z[0].x,z[0].y,!0,!0);for(let P=1;P<z.length;P++)S=Math.min(S,v.getElevationAt(z[P].x,z[P].y,!0,!0));O.elevation=S}}this.terrainTile=d.tileID.canonical,this.terrainExaggeration=s}}updateDEM(n,s,u,_){let d=s._dem._modifiedForSources[_];if(d===void 0&&(s._dem._modifiedForSources[_]=[],d=s._dem._modifiedForSources[_]),d.includes(u.canonical))return;const v=s._dem.dim;d.push(u.canonical);let E=!1;for(const O of this.getNodesInfo()){const z=O.node;if(!z.footprint||!z.footprint.grid)continue;const S=z.footprint.grid,P=s.tileCoordToPixel(S.min.x,S.min.y),L=s.tileCoordToPixel(S.max.x,S.max.y),M=Math.min(Math.min(v-L.y,P.x),Math.min(P.y,v-L.x));if(M<0)continue;const R=Bn(M,2,5);let B=Math.max(0,P.x-R),q=Math.max(0,P.y-R),H=Math.min(L.x+R,v-1),ne=Math.min(L.y+R,v-1);for(let ce=q;ce<=ne;++ce)for(let _e=B;_e<=H;++_e)b0[ce*v+_e]=255;let re=0,K=0;for(let ce=0;ce<S.cellsY;++ce)for(let _e=0;_e<S.cellsX;++_e){if(!S.cells[ce*S.cellsX+_e])continue;const Ce=s.tileCoordToPixel(S.min.x+_e/S.xScale,S.min.y+ce/S.yScale),Ae=s.tileCoordToPixel(S.min.x+(_e+1)/S.xScale,S.min.y+(ce+1)/S.yScale);for(let Ee=Ce.y;Ee<=Math.min(Ae.y+1,v-1);++Ee)for(let Ue=Ce.x;Ue<=Math.min(Ae.x+1,v-1);++Ue)b0[Ee*v+Ue]===255&&(b0[Ee*v+Ue]=0,re+=s.getElevationAtPixel(Ue,Ee),K++)}const ie=re/K;B=Math.max(1,P.x-R),q=Math.max(1,P.y-R),H=Math.min(L.x+R,v-2),ne=Math.min(L.y+R,v-2),E=!0;for(let ce=q;ce<=ne;++ce)for(let _e=B;_e<=H;++_e)b0[ce*v+_e]===0&&(B3[ce*v+_e]=s._dem.set(_e,ce,ie));for(let ce=1;ce<R;++ce){B=Math.max(1,P.x-ce),q=Math.max(1,P.y-ce),H=Math.min(L.x+ce,v-2),ne=Math.min(L.y+ce,v-2);for(let _e=q;_e<=ne;++_e)for(let Ce=B;Ce<=H;++Ce){const Ae=_e*v+Ce;if(b0[Ae]===255){let Ee=0,Ue=0,Oe=-1,Ve=-1;for(let Ze=-1;Ze<=1;++Ze)for(let qe=-1;qe<=1;++qe){const Ke=(_e+Ze)*v+Ce+qe;if(b0[Ke]>=ce)continue;const Qe=B3[Ke],at=Math.abs(Qe);at>Ue&&(Ee=Qe,Ue=at,Oe=qe,Ve=Ze)}if(Ue>.1){const Ze=1-(ce+.5*Math.abs(Oe*Ve))/R;let qe=s._dem.get(Ce,_e)+Ee*Ze;const Ke=s._dem.get(Ce+Oe,_e+Ve),Qe=s._dem.get(Ce-Oe,_e-Ve,!0);(qe-Ke)*(qe-Qe)>0&&(qe=(Ke+Qe)/2),B3[Ae]=s._dem.set(Ce,_e,qe),b0[Ae]=ce}}}}}E&&(s._demTile.needsDEMTextureUpload=!0,s._dem._timestamp=Le.now())}getNodesInfo(){return this.nodesInfo}destroy(){const n=this.getNodesInfo();for(const s of n)Cx(s.node),z3(s.node)}isEmpty(){return!this.nodesInfo.length}updateReplacement(n,s){if(s.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=s.updateTime;const u=s.getReplacementRegionsForTile(n.toUnwrapped()),_=this.getNodesInfo();for(let d=0;d<this.nodesInfo.length;d++){const v=_[d].node;_[d].hiddenByReplacement=!!v.footprint&&!u.find(E=>E.footprint===v.footprint)}}getHeightAtTileCoord(n,s){const u=this.getNodesInfo(),_=[],d=[0,0,0],v=Ne.mat4.identity([]);for(let E=0;E<this.nodesInfo.length;E++){const O=u[E],z=O.node.meshes[0],S=z.transformedAabb;if(n<S.min[0]||s<S.min[1]||n>S.max[0]||s>S.max[1])continue;if(O.node.hidden===!0)return{height:1/0,maxHeight:O.feature.properties.height,hidden:!1,verticalScale:O.evaluatedScale[2]};Ne.mat4.invert(v,O.node.matrix),d[0]=n,d[1]=s,Ne.vec3.transformMat4(d,d,v);const P=(d[0]-z.aabb.min[0])/(z.aabb.max[0]-z.aabb.min[0])*x0|0,L=Math.min(63,(d[1]-z.aabb.min[1])/(z.aabb.max[1]-z.aabb.min[1])*x0|0)*x0+Math.min(63,P),M=z.heightmap[L];if(!(M<0&&O.node.footprint))return O.hiddenByReplacement?void 0:{height:M,maxHeight:O.feature.properties.height,hidden:!1,verticalScale:O.evaluatedScale[2]};if(O.node.footprint.grid.query(new Pt(n,s),new Pt(n,s),_),_.length>0)return{height:void 0,maxHeight:O.feature.properties.height,hidden:O.hiddenByReplacement,verticalScale:O.evaluatedScale[2]}}}}function _v(c,n){return!c.isLightConstant&&n}function oG(c,n,s,u,_,d,v,E){let O=(61440&n|(61440&n)>>4)>>8,z=(3840&n|(3840&n)>>4)>>4,S=240&n|(240&n)>>4;s[3]>0&&(O=Mn(O,255*s[0],s[3]),z=Mn(z,255*s[1],s[3]),S=Mn(S,255*s[2],s[3]));const P=O<<8|z,L=S<<8|Math.floor(255*u[3]),M=function(ce){const _e=Bn(ce,0,2);return Math.min(Math.round(.5*_e*255),255)}(u[2])<<8|15*u[0]<<4|15*u[1],R=Bn(_[0],0,1),B=Bn(_[1],0,1),q=Bn(_[2],0,1),H=Bn(_[3],0,1);let ne,re,K,ie;if(R!==B&&v!==d&&B!==R){const ce=v-d;re=1/(ce*(B-R)),K=-(d+ce*R)/(ce*(B-R));const _e=Bn(_[4],-1,1);ie=Math.pow(10,_e),ne=255*q<<8|255*H}else ne=65535,re=0,K=1,ie=1;if(c.emplaceBack(P,L,M,ne,re,K,ie),E){const ce=E.length;E.clear();for(let _e=0;_e<ce;_e++)E.emplaceBack(P,L,M,ne,re,K,ie)}}function sG(c,n,s){const u=c.node;let _=0;const d=s&Q_.HasMeshoptCompression;for(const v of u.meshes){if(u.lights&&u.lightMeshIndex===_||!v.featureData)continue;v.featureArray=new qh,v.featureArray.reserve(v.featureData.length);let E=n;for(const O of v.featureData){const z=d?65535&O:O>>16&65535,S=d?O>>16&65535:65535&O,P=(15&S)<8?15&S:0,L=c.evaluatedRMEA[P],M=c.evaluatedColor[P],R=c.emissionHeightBasedParams[P];let B;if(E&&P===2&&u.lights&&(B=new qh,B.resize(10*u.lights.length)),oG(v.featureArray,z,M,L,R,v.aabb.min[2],v.aabb.max[2],B),B&&E){E=!1;const q=u.meshes[u.lightMeshIndex];q.featureArray=B,q.featureArray._trim()}}v.featureArray._trim(),_++}}function sR(c,n,s,u){const _=1<<c.z;n.lat=qi((u/Kt+c.y)/_),n.lng=no((s/Kt+c.x)/_)}hn(Mx,"Tiled3dModelBucket",{omit:["layers"]}),hn(oR,"Tiled3dModelFeature");const lG={circle:class extends $i{constructor(c,n,s,u){super(c,{layout:Lt||(Lt=new ni({"circle-sort-key":new cn(st.layout_circle["circle-sort-key"]),"circle-elevation-reference":new qt(st.layout_circle["circle-elevation-reference"]),visibility:new qt(st.layout_circle.visibility)})),paint:tt||(tt=new ni({"circle-radius":new cn(st.paint_circle["circle-radius"]),"circle-color":new cn(st.paint_circle["circle-color"]),"circle-blur":new cn(st.paint_circle["circle-blur"]),"circle-opacity":new cn(st.paint_circle["circle-opacity"]),"circle-translate":new qt(st.paint_circle["circle-translate"]),"circle-translate-anchor":new qt(st.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new qt(st.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new qt(st.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new cn(st.paint_circle["circle-stroke-width"]),"circle-stroke-color":new cn(st.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new cn(st.paint_circle["circle-stroke-opacity"]),"circle-emissive-strength":new qt(st.paint_circle["circle-emissive-strength"]),"circle-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"}),"circle-stroke-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"})}))},n,s,u)}createBucket(c){return new ue(c)}queryRadius(c){const n=c;return Et("circle-radius",this,n)+Et("circle-stroke-width",this,n)+yt(this.paint.get("circle-translate"))}queryIntersectsFeature(c,n,s,u,_,d,v,E){const O=pt(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),d.angle,c.pixelToTileUnitsFactor),z=this.paint.get("circle-radius").evaluate(n,s)+this.paint.get("circle-stroke-width").evaluate(n,s);return Zc(c,u,d,v,E,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",O,z)}getProgramIds(){return["circle"]}getDefaultProgramParams(c,n,s){const u=Hc(this);return{config:new dl(this,{zoom:n,lut:s}),defines:u,overrideFog:!1}}},heatmap:class extends $i{createBucket(c){return new Py(c)}constructor(c,n,s,u){super(c,{layout:b_||(b_=new ni({visibility:new qt(st.layout_heatmap.visibility)})),paint:Iy||(Iy=new ni({"heatmap-radius":new cn(st.paint_heatmap["heatmap-radius"]),"heatmap-weight":new cn(st.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new qt(st.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Lu(st.paint_heatmap["heatmap-color"]),"heatmap-opacity":new qt(st.paint_heatmap["heatmap-opacity"]),"heatmap-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"})}))},n,s,u),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(c){c==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=vd({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(c){return Et("heatmap-radius",this,c)}queryIntersectsFeature(c,n,s,u,_,d,v,E){const O=this.paint.get("heatmap-radius").evaluate(n,s);return Zc(c,u,d,v,E,!0,!0,new Pt(0,0),O)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getDefaultProgramParams(c,n,s){return c==="heatmap"?{config:new dl(this,{zoom:n,lut:s}),overrideFog:!1}:{}}},hillshade:class extends $i{constructor(c,n,s,u){super(c,{layout:z2||(z2=new ni({visibility:new qt(st.layout_hillshade.visibility)})),paint:Wc||(Wc=new ni({"hillshade-illumination-direction":new qt(st.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new qt(st.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new qt(st.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new qt(st.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new qt(st.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new qt(st.paint_hillshade["hillshade-accent-color"]),"hillshade-emissive-strength":new qt(st.paint_hillshade["hillshade-emissive-strength"]),"hillshade-shadow-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"}),"hillshade-highlight-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"}),"hillshade-accent-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"})}))},n,s,u)}shouldRedrape(){return this.hasOffscreenPass()&&this.paint.get("hillshade-illumination-anchor")==="viewport"}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}getDefaultProgramParams(c,n,s){return{overrideFog:!1}}},fill:class extends $i{constructor(c,n,s,u){super(c,{layout:$2||($2=new ni({"fill-sort-key":new cn(st.layout_fill["fill-sort-key"]),visibility:new qt(st.layout_fill.visibility),"fill-elevation-reference":new qt(st.layout_fill["fill-elevation-reference"])})),paint:I_||(I_=new ni({"fill-antialias":new qt(st.paint_fill["fill-antialias"]),"fill-opacity":new cn(st.paint_fill["fill-opacity"]),"fill-color":new cn(st.paint_fill["fill-color"]),"fill-outline-color":new cn(st.paint_fill["fill-outline-color"]),"fill-translate":new qt(st.paint_fill["fill-translate"]),"fill-translate-anchor":new qt(st.paint_fill["fill-translate-anchor"]),"fill-pattern":new cn(st.paint_fill["fill-pattern"]),"fill-emissive-strength":new qt(st.paint_fill["fill-emissive-strength"]),"fill-z-offset":new cn(st.paint_fill["fill-z-offset"]),"fill-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"}),"fill-outline-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"})}))},n,s,u)}getProgramIds(){const c=this.paint.get("fill-pattern"),n=c&&c.constantOr(1),s=[n?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&s.push(n&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),s}getDefaultProgramParams(c,n,s){return{config:new dl(this,{zoom:n,lut:s}),overrideFog:!1}}recalculate(c,n){super.recalculate(c,n);const s=this.paint._values["fill-outline-color"];s.value.kind==="constant"&&s.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(c){return new P_(c)}queryRadius(){return yt(this.paint.get("fill-translate"))}queryIntersectsFeature(c,n,s,u,_,d){return!c.queryGeometry.isAboveHorizon&&he(nt(c.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),d.angle,c.pixelToTileUnitsFactor),u)}isTileClipped(){return!0}is3D(){return this.paint.get("fill-z-offset").constantOr(1)!==0}},"fill-extrusion":class extends $i{constructor(c,n,s,u){super(c,{layout:h0||(h0=new ni({visibility:new qt(st["layout_fill-extrusion"].visibility),"fill-extrusion-edge-radius":new qt(st["layout_fill-extrusion"]["fill-extrusion-edge-radius"])})),paint:U_||(U_=new ni({"fill-extrusion-opacity":new qt(st["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new cn(st["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new qt(st["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new qt(st["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new cn(st["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new cn(st["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new cn(st["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-height-alignment":new qt(st["paint_fill-extrusion"]["fill-extrusion-height-alignment"]),"fill-extrusion-base-alignment":new qt(st["paint_fill-extrusion"]["fill-extrusion-base-alignment"]),"fill-extrusion-vertical-gradient":new qt(st["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new qt(st["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new qt(st["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-ambient-occlusion-wall-radius":new qt(st["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-wall-radius"]),"fill-extrusion-ambient-occlusion-ground-radius":new qt(st["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-radius"]),"fill-extrusion-ambient-occlusion-ground-attenuation":new qt(st["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-attenuation"]),"fill-extrusion-flood-light-color":new qt(st["paint_fill-extrusion"]["fill-extrusion-flood-light-color"]),"fill-extrusion-flood-light-intensity":new qt(st["paint_fill-extrusion"]["fill-extrusion-flood-light-intensity"]),"fill-extrusion-flood-light-wall-radius":new cn(st["paint_fill-extrusion"]["fill-extrusion-flood-light-wall-radius"]),"fill-extrusion-flood-light-ground-radius":new cn(st["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-radius"]),"fill-extrusion-flood-light-ground-attenuation":new qt(st["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-attenuation"]),"fill-extrusion-vertical-scale":new qt(st["paint_fill-extrusion"]["fill-extrusion-vertical-scale"]),"fill-extrusion-rounded-roof":new qt(st["paint_fill-extrusion"]["fill-extrusion-rounded-roof"]),"fill-extrusion-cutoff-fade-range":new qt(st["paint_fill-extrusion"]["fill-extrusion-cutoff-fade-range"]),"fill-extrusion-emissive-strength":new cn(st["paint_fill-extrusion"]["fill-extrusion-emissive-strength"]),"fill-extrusion-line-width":new cn(st["paint_fill-extrusion"]["fill-extrusion-line-width"]),"fill-extrusion-cast-shadows":new qt(st["paint_fill-extrusion"]["fill-extrusion-cast-shadows"]),"fill-extrusion-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"}),"fill-extrusion-flood-light-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"})}))},n,s,u),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(c){return new j_(c)}queryRadius(){return yt(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}hasShadowPass(){return this.paint.get("fill-extrusion-cast-shadows")}cutoffRange(){return this.paint.get("fill-extrusion-cutoff-fade-range")}canCastShadows(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}queryIntersectsFeature(c,n,s,u,_,d,v,E,O){const z=pt(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),d.angle,c.pixelToTileUnitsFactor),S=this.paint.get("fill-extrusion-height").evaluate(n,s),P=this.paint.get("fill-extrusion-base").evaluate(n,s),L=[0,0],M=E&&d.elevation,R=d.elevation?d.elevation.exaggeration():1,B=c.tile.getBucket(this);if(M&&B instanceof j_){const K=B.centroidVertexArray,ie=O+1;ie<K.length&&(L[0]=K.geta_centroid_pos0(ie),L[1]=K.geta_centroid_pos1(ie))}if(L[0]===0&&L[1]===1)return!1;d.projection.name==="globe"&&(u=Yp([u],[new Pt(0,0),new Pt(Kt,Kt)],c.tileID.canonical).map(K=>K.polygon).flat());const q=M?E:null,[H,ne]=function(K,ie,ce,_e,Ce,Ae,Ee,Ue,Oe,Ve,Ze){return K.projection.name==="globe"?function(qe,Ke,Qe,at,Je,wt,Rt,bt,an,Jt,Ut){const kt=[],vn=[],ln=qe.projection.upVectorScale(Ut,qe.center.lat,qe.worldSize).metersToTile,pn=[0,0,0,1],zn=[0,0,0,1],Gn=(Wn,lr,ur,Zr)=>{Wn[0]=lr,Wn[1]=ur,Wn[2]=Zr,Wn[3]=1},Zn=Cd();Qe>0&&(Qe+=Zn),at+=Zn;for(const Wn of Ke){const lr=[],ur=[];for(const Zr of Wn){const Lr=Zr.x+Je.x,jn=Zr.y+Je.y,Ir=qe.projection.projectTilePoint(Lr,jn,Ut),Rr=qe.projection.upVector(Ut,Zr.x,Zr.y);let ri=Qe,Bi=at;if(Rt){const ta=Zy(Lr,jn,Qe,at,Rt,bt,an,Jt);ri+=ta.base,Bi+=ta.top}Qe!==0?Gn(pn,Ir.x+Rr[0]*ln*ri,Ir.y+Rr[1]*ln*ri,Ir.z+Rr[2]*ln*ri):Gn(pn,Ir.x,Ir.y,Ir.z),Gn(zn,Ir.x+Rr[0]*ln*Bi,Ir.y+Rr[1]*ln*Bi,Ir.z+Rr[2]*ln*Bi),Ne.vec3.transformMat4(pn,pn,wt),Ne.vec3.transformMat4(zn,zn,wt),lr.push(new Yc(pn[0],pn[1],pn[2])),ur.push(new Yc(zn[0],zn[1],zn[2]))}kt.push(lr),vn.push(ur)}return[kt,vn]}(K,ie,ce,_e,Ce,Ae,Ee,Ue,Oe,Ve,Ze):Ee?function(qe,Ke,Qe,at,Je,wt,Rt,bt,an){const Jt=[],Ut=[],kt=[0,0,0,1];for(const vn of qe){const ln=[],pn=[];for(const zn of vn){const Gn=zn.x+at.x,Zn=zn.y+at.y,Wn=Zy(Gn,Zn,Ke,Qe,wt,Rt,bt,an);kt[0]=Gn,kt[1]=Zn,kt[2]=Wn.base,kt[3]=1,Ne.vec4.transformMat4(kt,kt,Je),kt[3]=Math.max(kt[3],1e-5);const lr=new Yc(kt[0]/kt[3],kt[1]/kt[3],kt[2]/kt[3]);kt[0]=Gn,kt[1]=Zn,kt[2]=Wn.top,kt[3]=1,Ne.vec4.transformMat4(kt,kt,Je),kt[3]=Math.max(kt[3],1e-5);const ur=new Yc(kt[0]/kt[3],kt[1]/kt[3],kt[2]/kt[3]);ln.push(lr),pn.push(ur)}Jt.push(ln),Ut.push(pn)}return[Jt,Ut]}(ie,ce,_e,Ce,Ae,Ee,Ue,Oe,Ve):function(qe,Ke,Qe,at,Je){const wt=[],Rt=[],bt=Je[8]*Ke,an=Je[9]*Ke,Jt=Je[10]*Ke,Ut=Je[11]*Ke,kt=Je[8]*Qe,vn=Je[9]*Qe,ln=Je[10]*Qe,pn=Je[11]*Qe;for(const zn of qe){const Gn=[],Zn=[];for(const Wn of zn){const lr=Wn.x+at.x,ur=Wn.y+at.y,Zr=Je[0]*lr+Je[4]*ur+Je[12],Lr=Je[1]*lr+Je[5]*ur+Je[13],jn=Je[2]*lr+Je[6]*ur+Je[14],Ir=Je[3]*lr+Je[7]*ur+Je[15],Rr=Zr+bt,ri=Lr+an,Bi=jn+Jt,ta=Math.max(Ir+Ut,1e-5),Ni=Zr+kt,Oi=Lr+vn,Hi=jn+ln,la=Math.max(Ir+pn,1e-5);Gn.push(new Yc(Rr/ta,ri/ta,Bi/ta)),Zn.push(new Yc(Ni/la,Oi/la,Hi/la))}wt.push(Gn),Rt.push(Zn)}return[wt,Rt]}(ie,ce,_e,Ce,Ae)}(d,u,P,S,z,v,q,L,R,d.center.lat,c.tileID.canonical),re=c.queryGeometry;return function(K,ie,ce){let _e=1/0;he(ce,ie)&&(_e=f0(ce,ie[0]));for(let Ce=0;Ce<ie.length;Ce++){const Ae=ie[Ce],Ee=K[Ce];for(let Ue=0;Ue<Ae.length-1;Ue++){const Oe=Ae[Ue],Ve=[Oe,Ae[Ue+1],Ee[Ue+1],Ee[Ue],Oe];se(ce,Ve)&&(_e=Math.min(_e,f0(ce,Ve)))}}return _e!==1/0&&_e}(H,ne,re.isPointQuery()?re.screenBounds:re.screenGeometry)}},line:class extends $i{constructor(c,n,s,u){const _=q_();super(c,_,n,s,u),_.layout&&(this.layout=new Du(_.layout)),this.gradientVersion=0,this.hasElevatedBuckets=!1,this.hasNonElevatedBuckets=!1}_handleSpecialPaintPropertyUpdate(c){if(c==="line-gradient"){const n=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=n._styleExpression&&n._styleExpression.expression instanceof $o,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(c,n){super.recalculate(c,n),this.paint._values["line-floorwidth"]=(()=>{if(tf)return tf;const s=q_();return tf=new nv(s.paint.properties["line-width"].specification),tf.useIntegerZoom=!0,tf})().possiblyEvaluate(this._transitioningPaint._values["line-width"].value,c)}createBucket(c){return new Od(c)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getDefaultProgramParams(c,n,s){const u=m0(this);return{config:new dl(this,{zoom:n,lut:s}),defines:u,overrideFog:!1}}queryRadius(c){const n=c,s=G_(Et("line-width",this,n),Et("line-gap-width",this,n)),u=Et("line-offset",this,n);return s/2+Math.abs(u)+yt(this.paint.get("line-translate"))}queryIntersectsFeature(c,n,s,u,_,d){if(c.queryGeometry.isAboveHorizon)return!1;const v=nt(c.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),d.angle,c.pixelToTileUnitsFactor),E=c.pixelToTileUnitsFactor/2*G_(this.paint.get("line-width").evaluate(n,s),this.paint.get("line-gap-width").evaluate(n,s)),O=this.paint.get("line-offset").evaluate(n,s);return O&&(u=function(z,S){const P=[],L=new Pt(0,0);for(let M=0;M<z.length;M++){const R=z[M],B=[];for(let q=0;q<R.length;q++){const H=R[q],ne=R[q+1],re=q===0?L:H.sub(R[q-1])._unit()._perp(),K=q===R.length-1?L:ne.sub(H)._unit()._perp(),ie=re._add(K)._unit();ie._mult(1/(ie.x*K.x+ie.y*K.y)),B.push(ie._mult(S)._add(H))}P.push(B)}return P}(u,O*c.pixelToTileUnitsFactor)),function(z,S,P){for(let L=0;L<S.length;L++){const M=S[L];if(z.length>=3){for(let R=0;R<M.length;R++)if(De(z,M[R]))return!0}if(Te(z,M,P))return!0}return!1}(v,u,E)}isTileClipped(){return!0}isDraped(c){return!this.hasElevatedBuckets}},symbol:xx,background:class extends $i{constructor(c,n,s,u){super(c,{layout:RI||(RI=new ni({visibility:new qt(st.layout_background.visibility)})),paint:DI||(DI=new ni({"background-pitch-alignment":new qt(st.paint_background["background-pitch-alignment"]),"background-color":new qt(st.paint_background["background-color"]),"background-pattern":new qt(st.paint_background["background-pattern"]),"background-opacity":new qt(st.paint_background["background-opacity"]),"background-emissive-strength":new qt(st.paint_background["background-emissive-strength"]),"background-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"})}))},n,s,u)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}getDefaultProgramParams(c,n,s){return{overrideFog:!1}}is3D(){return this.paint.get("background-pitch-alignment")==="viewport"}},raster:NI,"raster-particle":qI,sky:class extends $i{constructor(c,n,s,u){super(c,{layout:UI||(UI=new ni({visibility:new qt(st.layout_sky.visibility)})),paint:VI||(VI=new ni({"sky-type":new qt(st.paint_sky["sky-type"]),"sky-atmosphere-sun":new qt(st.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new qt(st.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new qt(st.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new qt(st.paint_sky["sky-gradient-radius"]),"sky-gradient":new Lu(st.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new qt(st.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new qt(st.paint_sky["sky-atmosphere-color"]),"sky-opacity":new qt(st.paint_sky["sky-opacity"]),"sky-gradient-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"}),"sky-atmosphere-halo-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"}),"sky-atmosphere-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"})}))},n,s,u),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(c){c==="sky-gradient"?this._updateColorRamp():c!=="sky-atmosphere-sun"&&c!=="sky-atmosphere-halo-color"&&c!=="sky-atmosphere-color"&&c!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=vd({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(c){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const n=c.style.light.properties.get("position");return this._lightPosition.azimuthal!==n.azimuthal||this._lightPosition.polar!==n.polar}return!1}getCenter(c,n){if(this.paint.get("sky-type")==="atmosphere"){const u=this.paint.get("sky-atmosphere-sun"),_=!u,d=c.style.light,v=d.properties.get("position");return _&&d.properties.get("anchor")==="viewport"&&qn("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),_?I3(v.azimuthal,90-v.polar,n):I3(u[0],90-u[1],n)}const s=this.paint.get("sky-gradient-center");return I3(s[0],90-s[1],n)}isSky(){return!0}markSkyboxValid(c){this._skyboxInvalidated=!1,this._lightPosition=c.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const c=this.paint.get("sky-type");return c==="atmosphere"?["skyboxCapture","skybox"]:c==="gradient"?["skyboxGradient"]:null}},slot:class extends $i{constructor(c,n,s,u){super(c,{paint:$I||($I=new ni({}))},n,null)}},model:class extends $i{constructor(c,n,s,u){super(c,{layout:eR||(eR=new ni({visibility:new qt(st.layout_model.visibility),"model-id":new cn(st.layout_model["model-id"])})),paint:tR||(tR=new ni({"model-opacity":new cn(st.paint_model["model-opacity"]),"model-rotation":new cn(st.paint_model["model-rotation"]),"model-scale":new cn(st.paint_model["model-scale"]),"model-translation":new cn(st.paint_model["model-translation"]),"model-color":new cn(st.paint_model["model-color"]),"model-color-mix-intensity":new cn(st.paint_model["model-color-mix-intensity"]),"model-type":new qt(st.paint_model["model-type"]),"model-cast-shadows":new qt(st.paint_model["model-cast-shadows"]),"model-receive-shadows":new qt(st.paint_model["model-receive-shadows"]),"model-ambient-occlusion-intensity":new qt(st.paint_model["model-ambient-occlusion-intensity"]),"model-emissive-strength":new cn(st.paint_model["model-emissive-strength"]),"model-roughness":new cn(st.paint_model["model-roughness"]),"model-height-based-emissive-strength-multiplier":new cn(st.paint_model["model-height-based-emissive-strength-multiplier"]),"model-cutoff-fade-range":new qt(st.paint_model["model-cutoff-fade-range"]),"model-front-cutoff":new qt(st.paint_model["model-front-cutoff"]),"model-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"})}))},n,s,u),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(c){return new L3(c)}getProgramIds(){return["model"]}is3D(){return!0}hasShadowPass(){return!0}canCastShadows(){return!0}hasLightBeamPass(){return!0}cutoffRange(){return this.paint.get("model-cutoff-fade-range")}queryRadius(c){return c instanceof Mx?Kt-1:0}queryIntersectsFeature(c,n,s,u,_,d){if(!this.modelManager)return!1;const v=this.modelManager,E=c.tile.getBucket(this);if(!(E&&E instanceof L3))return!1;for(const O in E.instancesPerModel){const z=E.instancesPerModel[O],S=n.id!==void 0?n.id:n.properties&&n.properties.hasOwnProperty("id")?n.properties.id:void 0;if(z.idToFeaturesIndex.hasOwnProperty(S)){const P=z.features[z.idToFeaturesIndex[S]],L=v.getModel(O,this.scope);if(!L)return!1;let M=Ne.mat4.create();const R=new pr(0,0),B=E.canonical;let q=Number.MAX_VALUE;for(let H=0;H<P.instancedDataCount;++H){const ne=16*(P.instancedDataOffset+H),re=z.instancedDataArray.float32,K=[re[ne+4],re[ne+5],re[ne+6]];sR(B,R,re[ne],0|re[ne+1]),nR(M,L,d,R,P.rotation,P.scale,K,!1,!1,!1),d.projection.name==="globe"&&(M=D3(M,d));const ie=Ne.mat4.multiply([],d.projMatrix,M),ce=c.queryGeometry,_e=XI(ce.isPointQuery()?ce.screenBounds:ce.screenGeometry,d,ie,L.aabb);_e!=null&&(q=Math.min(_e,q))}return q!==Number.MAX_VALUE&&q}}return!1}_handleOverridablePaintPropertyUpdate(c,n,s){return!(!this.layout||n.isDataDriven()||s.isDataDriven()||c!=="model-color"&&c!=="model-color-mix-intensity"&&c!=="model-rotation"&&c!=="model-scale"&&c!=="model-translation"&&c!=="model-emissive-strength")}_isPropertyZoomDependent(c){const n=this._transitionablePaint._values[c];return n!=null&&n.value!=null&&n.value.expression!=null&&n.value.expression instanceof jl}isZoomDependent(){return this._isPropertyZoomDependent("model-scale")||this._isPropertyZoomDependent("model-rotation")||this._isPropertyZoomDependent("model-translation")}},clip:class extends $i{constructor(c,n,s,u){super(c,{layout:Ly||(Ly=new ni({"clip-layer-types":new qt(st.layout_clip["clip-layer-types"]),"clip-layer-scope":new qt(st.layout_clip["clip-layer-scope"])})),paint:ky||(ky=new ni({}))},n,s,u)}recalculate(c,n){super.recalculate(c,n)}createBucket(c){return new R_(c)}isTileClipped(){return!0}is3D(){return!0}}};class cG{constructor(n){this._callback=n,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class uG{constructor(){this.tasks={},this.taskQueue=[],hh(["process"],this),this.invoker=new cG(this.process),this.nextId=0}add(n,s){const u=this.nextId++,_=function({type:d,isSymbolTile:v,zoom:E}){return E=E||0,d==="message"?0:d!=="maybePrepare"||v?d!=="parseTile"||v?d==="parseTile"&&v?300-E:d==="maybePrepare"&&v?400-E:500:200-E:100-E}(s);if(_===0){try{n()}finally{}return null}return this.tasks[u]={fn:n,metadata:s,priority:_,id:u},this.taskQueue.push(u),this.invoker.trigger(),{cancel:()=>{delete this.tasks[u]}}}process(){try{if(this.taskQueue=this.taskQueue.filter(u=>!!this.tasks[u]),!this.taskQueue.length)return;const n=this.pick();if(n===null)return;const s=this.tasks[n];if(delete this.tasks[n],this.taskQueue.length&&this.invoker.trigger(),!s)return;s.fn()}finally{}}pick(){let n=null,s=1/0;for(let _=0;_<this.taskQueue.length;_++){const d=this.tasks[this.taskQueue[_]];d.priority<s&&(s=d.priority,n=_)}if(n===null)return null;const u=this.taskQueue[n];return this.taskQueue.splice(n,1),u}remove(){this.invoker.remove()}}class lR{constructor(n,s,u){this.target=n,this.parent=s,this.mapId=u,this.callbacks={},this.cancelCallbacks={},hh(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.scheduler=new uG}send(n,s,u,_,d=!1,v){const E=Math.round(1e18*Math.random()).toString(36).substring(0,10);u&&(u.metadata=v,this.callbacks[E]=u);const O=new Set;return this.target.postMessage({id:E,type:n,hasCallback:!!u,targetMapId:_,mustQueue:d,sourceMapId:this.mapId,data:Ul(s,O)},O),{cancel:()=>{u&&delete this.callbacks[E],this.target.postMessage({id:E,type:"<cancel>",targetMapId:_,sourceMapId:this.mapId})}}}receive(n){const s=n.data,u=s.id;if(u&&(!s.targetMapId||this.mapId===s.targetMapId))if(s.type==="<cancel>"){const _=this.cancelCallbacks[u];delete this.cancelCallbacks[u],_&&_.cancel()}else if(s.mustQueue||as()){const _=this.callbacks[u],d=this.scheduler.add(()=>this.processTask(u,s),_&&_.metadata||{type:"message"});d&&(this.cancelCallbacks[u]=d)}else this.processTask(u,s)}processTask(n,s){if(delete this.cancelCallbacks[n],s.type==="<response>"){const u=this.callbacks[n];delete this.callbacks[n],u&&(s.error?u(Mo(s.error)):u(null,Mo(s.data)))}else{const u=new Set,_=s.hasCallback?(v,E)=>{this.target.postMessage({id:n,type:"<response>",sourceMapId:this.mapId,error:v?Ul(v):null,data:Ul(E,u)},u)}:()=>{},d=Mo(s.data);if(this.parent[s.type])this.parent[s.type](s.sourceMapId,d,_);else if(this.parent.getWorkerSource){const v=s.type.split(".");this.parent.getWorkerSource(s.sourceMapId,v[0],d.source,d.scope)[v[1]](d,_)}else _(new Error(`Could not find function ${s.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}}var gv={workerUrl:"",workerClass:null,workerParams:void 0};const N3="mapboxgl_preloaded_worker_pool";class w0{constructor(){this.active={}}acquire(n,s=w0.workerCount){if(!this.workers)for(this.workers=[];this.workers.length<s;)this.workers.push(gv.workerClass!=null?new gv.workerClass:new self.Worker(gv.workerUrl,gv.workerParams));return this.active[n]=!0,this.workers.slice()}release(n){delete this.active[n],this.workers&&this.numActive()===0&&(this.workers.forEach(s=>{s.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[N3]}numActive(){return Object.keys(this.active).length}}w0.workerCount=2;class tg{constructor(n,s,u="Worker",_=w0.workerCount){this.workerPool=n,this.actors=[],this.currentActor=0,this.id=hc();const d=this.workerPool.acquire(this.id,_);for(let v=0;v<d.length;v++){const E=new tg.Actor(d[v],s,this.id);E.name=`${u} ${v}`,this.actors.push(E)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(n,s,u){Tl(this.actors,(_,d)=>{_.send(n,s,d)},u=u||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(n=>{n.remove()}),this.actors=[],this.workerPool.release(this.id)}}let yv,F3;function Ox(){return yv||(yv=new w0),yv}tg.Actor=lR;const j3=new _r(0,0,0);var U3=(c=>(c[c.PATH_RULE_UNSPECIFIED=0]="PATH_RULE_UNSPECIFIED",c[c.PATH_RULE_NON_ZERO=1]="PATH_RULE_NON_ZERO",c[c.PATH_RULE_EVEN_ODD=2]="PATH_RULE_EVEN_ODD",c))(U3||{}),Px=(c=>(c[c.LINE_CAP_UNSPECIFIED=0]="LINE_CAP_UNSPECIFIED",c[c.LINE_CAP_BUTT=1]="LINE_CAP_BUTT",c[c.LINE_CAP_ROUND=2]="LINE_CAP_ROUND",c[c.LINE_CAP_SQUARE=3]="LINE_CAP_SQUARE",c))(Px||{}),vv=(c=>(c[c.LINE_JOIN_UNSPECIFIED=0]="LINE_JOIN_UNSPECIFIED",c[c.LINE_JOIN_MITER=1]="LINE_JOIN_MITER",c[c.LINE_JOIN_MITER_CLIP=2]="LINE_JOIN_MITER_CLIP",c[c.LINE_JOIN_ROUND=3]="LINE_JOIN_ROUND",c[c.LINE_JOIN_BEVEL=4]="LINE_JOIN_BEVEL",c))(vv||{}),cR=(c=>(c[c.PAINT_ORDER_UNSPECIFIED=0]="PAINT_ORDER_UNSPECIFIED",c[c.PAINT_ORDER_FILL_AND_STROKE=1]="PAINT_ORDER_FILL_AND_STROKE",c[c.PAINT_ORDER_STROKE_AND_FILL=2]="PAINT_ORDER_STROKE_AND_FILL",c))(cR||{}),ng=(c=>(c[c.PATH_COMMAND_UNSPECIFIED=0]="PATH_COMMAND_UNSPECIFIED",c[c.PATH_COMMAND_MOVE=1]="PATH_COMMAND_MOVE",c[c.PATH_COMMAND_LINE=2]="PATH_COMMAND_LINE",c[c.PATH_COMMAND_QUAD=3]="PATH_COMMAND_QUAD",c[c.PATH_COMMAND_CUBIC=4]="PATH_COMMAND_CUBIC",c[c.PATH_COMMAND_CLOSE=5]="PATH_COMMAND_CLOSE",c))(ng||{}),uR=(c=>(c[c.MASK_TYPE_UNSPECIFIED=0]="MASK_TYPE_UNSPECIFIED",c[c.MASK_TYPE_LUMINANCE=1]="MASK_TYPE_LUMINANCE",c[c.MASK_TYPE_ALPHA=2]="MASK_TYPE_ALPHA",c))(uR||{});function hG(c,n,s){c===1&&n.icons.push(function(u,_){return function(d){if(d.usvg_tree.height||(d.usvg_tree.height=d.usvg_tree.width),!d.metadata)return d;const{metadata:v}=d;if(v.content_area){const{content_area:E}=v;E.top==null&&(E.top=E.left),E.width==null&&(E.width=d.usvg_tree.width),E.height==null&&(E.height=E.width)}return v.stretch_x&&v.stretch_x.length&&hR(v,"x"),v.stretch_y&&v.stretch_y.length&&hR(v,"y"),d}(u.readFields(fG,{name:void 0},_))}(s,s.readVarint()+s.pos))}function hR(c,n){const s=[],u=c[`stretch_${n}`];let _=null;for(let d=0;d<u.length;d++)_===null?_=s.length===0?u[0]:s[s.length-1][1]+u[d]:(s.push([_,_+u[d]]),_=null);c[`stretch_${n}_areas`]=s}function fG(c,n,s){c===1?n.name=s.readString():c===2?n.metadata=function(u,_){return u.readFields(dG,{stretch_x:null,stretch_y:null,stretch_x_areas:null,stretch_y_areas:null,variables:[]},_)}(s,s.readVarint()+s.pos):c===3&&(n.usvg_tree=function(u,_){return u.readFields(_G,{width:20,children:[],linear_gradients:[],radial_gradients:[],clip_paths:[],masks:[]},_)}(s,s.readVarint()+s.pos),n.data="usvg_tree")}function dG(c,n,s){c===1?n.stretch_x=s.readPackedVarint():c===2?n.stretch_y=s.readPackedVarint():c===3?n.content_area=function(u,_){return u.readFields(pG,{left:0},_)}(s,s.readVarint()+s.pos):c===4&&n.variables.push(function(u,_){return u.readFields(mG,{name:void 0},_)}(s,s.readVarint()+s.pos))}function pG(c,n,s){c===1?n.left=s.readVarint():c===2?n.width=s.readVarint():c===3?n.top=s.readVarint():c===4&&(n.height=s.readVarint())}function mG(c,n,s){c===1?n.name=s.readString():c===2&&(n.rgb_color=Dx(s.readVarint()),n.value="rgb_color")}function _G(c,n,s){c===1?n.width=n.height=s.readVarint():c===2?n.height=s.readVarint():c===3?n.children.push(Ix(s,s.readVarint()+s.pos)):c===4?n.linear_gradients.push(function(u,_){return u.readFields(SG,{spread_method:1,stops:[],x1:0,y1:0,x2:1,y2:0},_)}(s,s.readVarint()+s.pos)):c===5?n.radial_gradients.push(function(u,_){return u.readFields(EG,{spread_method:1,stops:[],cx:.5,cy:.5,r:.5,fx:.5,fy:.5,fr:0},_)}(s,s.readVarint()+s.pos)):c===7?n.clip_paths.push(function(u,_){return u.readFields(AG,{children:[]},_)}(s,s.readVarint()+s.pos)):c===8&&n.masks.push(function(u,_){const d=u.readFields(CG,{left:0,width:20,mask_type:1,children:[]},_);return d.height==null&&(d.height=d.width),d.top==null&&(d.top=d.left),d}(s,s.readVarint()+s.pos))}function Ix(c,n){return c.readFields(gG,{},n)}function gG(c,n,s){c===1?(n.group=function(u,_){return u.readFields(yG,{opacity:255,children:[]},_)}(s,s.readVarint()+s.pos),n.node="group"):c===2&&(n.path=function(u,_){return u.readFields(xG,{paint_order:1,commands:[],step:1,diffs:[],rule:1},_)}(s,s.readVarint()+s.pos),n.node="path")}function yG(c,n,s){c===1?n.transform=Rx(s,s.readVarint()+s.pos):c===2?n.opacity=s.readVarint():c===5?n.clip_path_idx=s.readVarint():c===6?n.mask_idx=s.readVarint():c===7&&n.children.push(Ix(s,s.readVarint()+s.pos))}function Rx(c,n){return c.readFields(vG,{sx:1,ky:0,kx:0,sy:1,tx:0,ty:0},n)}function vG(c,n,s){c===1?n.sx=s.readFloat():c===2?n.ky=s.readFloat():c===3?n.kx=s.readFloat():c===4?n.sy=s.readFloat():c===5?n.tx=s.readFloat():c===6&&(n.ty=s.readFloat())}function xG(c,n,s){c===1?n.fill=function(u,_){return u.readFields(bG,{rgb_color:j3,paint:"rgb_color",opacity:255},_)}(s,s.readVarint()+s.pos):c===2?n.stroke=function(u,_){return u.readFields(wG,{rgb_color:j3,paint:"rgb_color",dasharray:[],dashoffset:0,miterlimit:4,opacity:255,width:1,linecap:1,linejoin:1},_)}(s,s.readVarint()+s.pos):c===3?n.paint_order=s.readVarint():c===5?s.readPackedVarint(n.commands):c===6?n.step=s.readFloat():c===7?s.readPackedSVarint(n.diffs):c===8&&(n.rule=s.readVarint())}function bG(c,n,s){c===1?(n.rgb_color=Dx(s.readVarint()),n.paint="rgb_color"):c===2?(n.linear_gradient_idx=s.readVarint(),n.paint="linear_gradient_idx"):c===3?(n.radial_gradient_idx=s.readVarint(),n.paint="radial_gradient_idx"):c===5&&(n.opacity=s.readVarint())}function Dx(c){return new _r((c>>16&255)/255,(c>>8&255)/255,(255&c)/255,1)}function wG(c,n,s){c===1?(n.rgb_color=Dx(s.readVarint()),n.paint="rgb_color"):c===2?(n.linear_gradient_idx=s.readVarint(),n.paint="linear_gradient_idx"):c===3?(n.radial_gradient_idx=s.readVarint(),n.paint="radial_gradient_idx"):c===5?s.readPackedFloat(n.dasharray):c===6?n.dashoffset=s.readFloat():c===7?n.miterlimit=s.readFloat():c===8?n.opacity=s.readVarint():c===9?n.width=s.readFloat():c===10?n.linecap=s.readVarint():c===11&&(n.linejoin=s.readVarint())}function SG(c,n,s){c===1?n.transform=Rx(s,s.readVarint()+s.pos):c===2?n.spread_method=s.readVarint():c===3?n.stops.push(fR(s,s.readVarint()+s.pos)):c===4?n.x1=s.readFloat():c===5?n.y1=s.readFloat():c===6?n.x2=s.readFloat():c===7&&(n.y2=s.readFloat())}function fR(c,n){return c.readFields(TG,{offset:0,opacity:255,rgb_color:j3},n)}function TG(c,n,s){c===1?n.offset=s.readFloat():c===2?n.opacity=s.readVarint():c===3&&(n.rgb_color=Dx(s.readVarint()))}function EG(c,n,s){c===1?n.transform=Rx(s,s.readVarint()+s.pos):c===2?n.spread_method=s.readVarint():c===3?n.stops.push(fR(s,s.readVarint()+s.pos)):c===4?n.cx=s.readFloat():c===5?n.cy=s.readFloat():c===6?n.r=s.readFloat():c===7?n.fx=s.readFloat():c===8?n.fy=s.readFloat():c===9&&(n.fr=s.readFloat())}function AG(c,n,s){c===1?n.transform=Rx(s,s.readVarint()+s.pos):c===2?n.clip_path_idx=s.readVarint():c===3&&n.children.push(Ix(s,s.readVarint()+s.pos))}function CG(c,n,s){c===1?n.left=n.top=s.readFloat():c===2?n.width=n.height=s.readFloat():c===3?n.top=s.readFloat():c===4?n.height=s.readFloat():c===5?n.mask_type=s.readVarint():c===6?n.mask_idx=s.readVarint():c===7&&n.children.push(Ix(s,s.readVarint()+s.pos))}class MG{static calculate(n,s){const u=new Map,_=new Map;if(Object.keys(n).length===0)return u;s.forEach(d=>{_.set(d.name,d.rgb_color||new _r(0,0,0))});for(const[d,v]of Object.entries(n))_.has(d)?u.set(_.get(d).toStringPremultipliedAlpha(),v):console.warn(`Ignoring unknown image variable "${d}"`);return u}}function rg(c,n=255,s){const u=n/255,_=c.toStringPremultipliedAlpha(),d=s.has(_)?s.get(_).clone():c.clone();return d.a=u,d.toString()}function xv(c,n){if(!Se()){const s=document.createElement("canvas");return s.width=c,s.height=n,s}return new OffscreenCanvas(c,n)}function OG(c,n){const s=MG.calculate(n.params,c.metadata?c.metadata.variables:[]),u=c.usvg_tree,_=u.width,d=u.height,v=n.transform?n.transform:new DOMMatrix,E=Math.max(1,Math.round(_*v.a)),O=Math.max(1,Math.round(d*v.d)),z=new DOMMatrix([E/_,0,0,O/d,0,0]),S=xv(E,O).getContext("2d");return V3(S,z,u,u,s),S.getImageData(0,0,E,O)}function V3(c,n,s,u,_){for(const d of u.children)dR(c,n,s,d,_)}function dR(c,n,s,u,_){u.group?(c.save(),function(d,v,E,O,z){const S=O.mask_idx!=null?E.masks[O.mask_idx]:null,P=O.clip_path_idx!=null?E.clip_paths[O.clip_path_idx]:null;if(O.transform&&(v=Lx(O.transform).preMultiplySelf(v)),!function(R,B,q){return R.opacity!==255||B||q}(O,P!=null,S!=null))return void V3(d,v,E,O,z);const L=xv(d.canvas.width,d.canvas.height),M=L.getContext("2d");V3(M,v,E,O,z),P&&xR(M,v,E,P),S&&bR(M,v,E,S,z),d.globalAlpha=O.opacity/255,d.drawImage(L,0,0)}(c,n,s,u.group,_),c.restore()):u.path&&(c.save(),function(d,v,E,O,z){const S=wR(O);d.setTransform(v),O.paint_order===cR.PAINT_ORDER_FILL_AND_STROKE?(pR(d,E,O,S,z),_R(d,E,O,S,z)):(_R(d,E,O,S,z),pR(d,E,O,S,z))}(c,n,s,u.path,_),c.restore())}function pR(c,n,s,u,_){const d=s.fill;if(!d)return;const v=d.opacity/255;switch(d.paint){case"rgb_color":c.fillStyle=rg(d.rgb_color,d.opacity,_);break;case"linear_gradient_idx":c.fillStyle=gR(c,n.linear_gradients[d.linear_gradient_idx],v,_);break;case"radial_gradient_idx":c.fillStyle=yR(c,n.radial_gradients[d.radial_gradient_idx],v,_)}c.fill(u,mR(s))}function mR(c){return c.rule===U3.PATH_RULE_NON_ZERO?"nonzero":c.rule===U3.PATH_RULE_EVEN_ODD?"evenodd":void 0}function _R(c,n,s,u,_){const d=s.stroke;if(!d)return;c.lineWidth=d.width,c.miterLimit=d.miterlimit,c.setLineDash(d.dasharray),c.lineDashOffset=d.dashoffset;const v=d.opacity/255;switch(d.paint){case"rgb_color":c.strokeStyle=rg(d.rgb_color,d.opacity,_);break;case"linear_gradient_idx":c.strokeStyle=gR(c,n.linear_gradients[d.linear_gradient_idx],v,_);break;case"radial_gradient_idx":c.strokeStyle=yR(c,n.radial_gradients[d.radial_gradient_idx],v,_)}switch(d.linejoin){case vv.LINE_JOIN_MITER_CLIP:case vv.LINE_JOIN_MITER:c.lineJoin="miter";break;case vv.LINE_JOIN_ROUND:c.lineJoin="round";break;case vv.LINE_JOIN_BEVEL:c.lineJoin="bevel"}switch(d.linecap){case Px.LINE_CAP_BUTT:c.lineCap="butt";break;case Px.LINE_CAP_ROUND:c.lineCap="round";break;case Px.LINE_CAP_SQUARE:c.lineCap="square"}c.stroke(u)}function gR(c,n,s,u){if(n.stops.length===1){const L=n.stops[0];return rg(L.rgb_color,L.opacity*s,u)}const _=Lx(n.transform),{x1:d,y1:v,x2:E,y2:O}=n,z=_.transformPoint(new DOMPoint(d,v)),S=_.transformPoint(new DOMPoint(E,O)),P=c.createLinearGradient(z.x,z.y,S.x,S.y);for(const L of n.stops)P.addColorStop(L.offset,rg(L.rgb_color,L.opacity*s,u));return P}function yR(c,n,s,u){if(n.stops.length===1){const L=n.stops[0];return rg(L.rgb_color,L.opacity*s,u)}const _=Lx(n.transform),{fx:d,fy:v,cx:E,cy:O}=n,z=_.transformPoint(new DOMPoint(d,v)),S=_.transformPoint(new DOMPoint(E,O)),P=c.createRadialGradient(z.x,z.y,0,S.x,S.y,n.r*((_.a+_.d)/2));for(const L of n.stops)P.addColorStop(L.offset,rg(L.rgb_color,L.opacity*s,u));return P}function vR(c,n,s,u){const _=u.transform?Lx(u.transform).preMultiplySelf(n):n,d=xv(c.canvas.width,c.canvas.height),v=d.getContext("2d");for(const O of u.children)if(O.group)vR(v,_,s,O.group);else if(O.path){const z=O.path,S=new Path2D;S.addPath(wR(z),_),v.fill(S,mR(z))}const E=u.clip_path_idx!=null?s.clip_paths[u.clip_path_idx]:null;E&&xR(v,_,s,E),c.globalCompositeOperation="source-over",c.drawImage(d,0,0)}function xR(c,n,s,u){const _=xv(c.canvas.width,c.canvas.height);vR(_.getContext("2d"),n,s,u),c.globalCompositeOperation="destination-in",c.drawImage(_,0,0)}function bR(c,n,s,u,_){if(u.children.length===0)return;const d=u.mask_idx!=null?s.masks[u.mask_idx]:null;d&&bR(c,n,s,d,_);const v=c.canvas.width,E=c.canvas.height,O=xv(v,E),z=O.getContext("2d"),S=u.width,P=u.height,L=u.left,M=u.top,R=new Path2D,B=new Path2D;B.rect(L,M,S,P),R.addPath(B,n),z.clip(R);for(const ne of u.children)dR(z,n,s,ne,_);const q=z.getImageData(0,0,v,E),H=q.data;if(u.mask_type===uR.MASK_TYPE_LUMINANCE)for(let ne=0;ne<H.length;ne+=4)H[ne+3]=H[ne+3]/255*(.2126*H[ne]+.7152*H[ne+1]+.0722*H[ne+2]);z.putImageData(q,0,0),c.globalCompositeOperation="destination-in",c.drawImage(O,0,0)}function Lx(c){return c?new DOMMatrix([c.sx,c.ky,c.kx,c.sy,c.tx,c.ty]):new DOMMatrix}function wR(c){const n=new Path2D,s=c.step;let u=c.diffs[0]*s,_=c.diffs[1]*s;n.moveTo(u,_);for(let d=0,v=2;d<c.commands.length;d++)switch(c.commands[d]){case ng.PATH_COMMAND_MOVE:u+=c.diffs[v++]*s,_+=c.diffs[v++]*s,n.moveTo(u,_);break;case ng.PATH_COMMAND_LINE:u+=c.diffs[v++]*s,_+=c.diffs[v++]*s,n.lineTo(u,_);break;case ng.PATH_COMMAND_QUAD:{const E=u+c.diffs[v++]*s,O=_+c.diffs[v++]*s;u=E+c.diffs[v++]*s,_=O+c.diffs[v++]*s,n.quadraticCurveTo(E,O,u,_);break}case ng.PATH_COMMAND_CUBIC:{const E=u+c.diffs[v++]*s,O=_+c.diffs[v++]*s,z=E+c.diffs[v++]*s,S=O+c.diffs[v++]*s;u=z+c.diffs[v++]*s,_=S+c.diffs[v++]*s,n.bezierCurveTo(E,O,z,S,u,_);break}case ng.PATH_COMMAND_CLOSE:n.closePath()}return n}class $3{constructor(n){this.capacity=n,this.cache=new Map}get(n){if(!this.cache.has(n))return;const s=this.cache.get(n);return this.cache.delete(n),this.cache.set(n,s),s}put(n,s){this.cache.has(n)?this.cache.delete(n):this.cache.size===this.capacity&&this.cache.delete(this.cache.keys().next().value),this.cache.set(n,s)}delete(n){this.cache.delete(n)}}class q3{constructor(){this.cacheMap=new Map,this.cacheDependenciesMap=new Map}static _getImage(n){return new Aa(n,n.data)}getFromCache(n,s,u){return this.cacheMap.has(u)||this.cacheMap.set(u,new $3(150)),this.cacheMap.get(u).get(Ho(n.serialize(),s))}setInCache(n,s,u,_){this.cacheDependenciesMap.has(_)||this.cacheDependenciesMap.set(_,new Map),this.cacheMap.has(_)||this.cacheMap.set(_,new $3(150));const d=this.cacheDependenciesMap.get(_);d.get(Ho(n.id,u))||d.set(Ho(n.id,u),new Set);const v=this.cacheMap.get(_),E=n.serialize();d.get(Ho(n.id,u)).add(E),v.put(Ho(n.serialize(),u),s)}removeImagesFromCacheByIds(n,s,u=""){if(!this.cacheMap.has(u)||!this.cacheDependenciesMap.has(u))return;const _=this.cacheMap.get(u),d=this.cacheDependenciesMap.get(u);for(const v of n)if(d.has(Ho(v,s))){for(const E of d.get(Ho(v,s)))_.delete(E);d.delete(Ho(v,s))}}rasterize(n,s,u,_,d=OG){const v=this.getFromCache(n,u,_);if(v)return v.clone();const E=d(s.icon,n.options),O=q3._getImage(E);return this.setInCache(n,O,u,_),O.clone()}}class SR{constructor(n){this.size=n,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(n,s){const u=this.toIdx(n,s);return{min:this.minimums[u],max:this.maximums[u]}}isLeaf(n,s){return this.leaves[this.toIdx(n,s)]}toIdx(n,s){return s*this.size+n}}function TR(c,n,s,u){let _=0,d=Number.MAX_VALUE;for(let v=0;v<3;v++)if(Math.abs(u[v])<1e-15){if(s[v]<c[v]||s[v]>n[v])return null}else{const E=1/u[v];let O=(c[v]-s[v])*E,z=(n[v]-s[v])*E;if(O>z){const S=O;O=z,z=S}if(O>_&&(_=O),z<d&&(d=z),_>d)return null}return _}function ER(c,n,s,u,_,d,v,E,O,z,S){const P=u-c,L=_-n,M=d-s,R=v-c,B=E-n,q=O-s,H=S[1]*q-S[2]*B,ne=S[2]*R-S[0]*q,re=S[0]*B-S[1]*R,K=P*H+L*ne+M*re;if(Math.abs(K)<1e-15)return null;const ie=1/K,ce=z[0]-c,_e=z[1]-n,Ce=z[2]-s,Ae=(ce*H+_e*ne+Ce*re)*ie;if(Ae<0||Ae>1)return null;const Ee=_e*M-Ce*L,Ue=Ce*P-ce*M,Oe=ce*L-_e*P,Ve=(S[0]*Ee+S[1]*Ue+S[2]*Oe)*ie;return Ve<0||Ae+Ve>1?null:(R*Ee+B*Ue+q*Oe)*ie}function AR(c,n,s){return(c-n)/(s-n)}function CR(c,n,s,u,_,d,v,E,O){const z=1<<s,S=d-u,P=v-_,L=(c+1)/z*S+u,M=(n+0)/z*P+_,R=(n+1)/z*P+_;E[0]=(c+0)/z*S+u,E[1]=M,O[0]=L,O[1]=R}class MR{constructor(n){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=n,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const s=function(d){const v=Math.ceil(Math.log2(d.dim/8)),E=[];let O=Math.ceil(Math.pow(2,v));const z=1/O,S=(M,R,B,q,H)=>{const ne=q?1:0,re=(M+1)*B-ne,K=R*B,ie=(R+1)*B-ne;H[0]=M*B,H[1]=K,H[2]=re,H[3]=ie};let P=new SR(O);const L=[];for(let M=0;M<O*O;M++){S(M%O,Math.floor(M/O),z,!1,L);const R=tm(L[0],L[1],d),B=tm(L[2],L[1],d),q=tm(L[2],L[3],d),H=tm(L[0],L[3],d);P.minimums.push(Math.min(R,B,q,H)),P.maximums.push(Math.max(R,B,q,H)),P.leaves.push(1)}for(E.push(P),O/=2;O>=1;O/=2){const M=E[E.length-1];P=new SR(O);for(let R=0;R<O*O;R++){S(R%O,Math.floor(R/O),2,!0,L);const B=M.getElevation(L[0],L[1]),q=M.getElevation(L[2],L[1]),H=M.getElevation(L[2],L[3]),ne=M.getElevation(L[0],L[3]),re=M.isLeaf(L[0],L[1]),K=M.isLeaf(L[2],L[1]),ie=M.isLeaf(L[2],L[3]),ce=M.isLeaf(L[0],L[3]),_e=Math.min(B.min,q.min,H.min,ne.min),Ce=Math.max(B.max,q.max,H.max,ne.max),Ae=re&&K&&ie&&ce;P.maximums.push(Ce),P.minimums.push(_e),P.leaves.push(Ce-_e<=5&&Ae?1:0)}E.push(P)}return E}(this.dem),u=s.length-1,_=s[u];this._addNode(_.minimums[0],_.maximums[0],_.leaves[0]),this._construct(s,0,0,u,0)}raycastRoot(n,s,u,_,d,v,E=1){return TR([n,s,-100],[u,_,this.maximums[0]*E],d,v)}raycast(n,s,u,_,d,v,E=1){if(!this.nodeCount)return null;const O=this.raycastRoot(n,s,u,_,d,v,E);if(O==null)return null;const z=[],S=[],P=[],L=[],M=[{idx:0,t:O,nodex:0,nodey:0,depth:0}];for(;M.length>0;){const{idx:R,t:B,nodex:q,nodey:H,depth:ne}=M.pop();if(this.leaves[R]){CR(q,H,ne,n,s,u,_,P,L);const K=1<<ne,ie=(q+0)/K,ce=(q+1)/K,_e=(H+0)/K,Ce=(H+1)/K,Ae=tm(ie,_e,this.dem)*E,Ee=tm(ce,_e,this.dem)*E,Ue=tm(ce,Ce,this.dem)*E,Oe=tm(ie,Ce,this.dem)*E,Ve=ER(P[0],P[1],Ae,L[0],P[1],Ee,L[0],L[1],Ue,d,v),Ze=ER(L[0],L[1],Ue,P[0],L[1],Oe,P[0],P[1],Ae,d,v),qe=Math.min(Ve!==null?Ve:Number.MAX_VALUE,Ze!==null?Ze:Number.MAX_VALUE);if(qe!==Number.MAX_VALUE)return qe;{const Ke=Ne.vec3.scaleAndAdd([],d,v,B);if(OR(Ae,Ee,Oe,Ue,AR(Ke[0],P[0],L[0]),AR(Ke[1],P[1],L[1]))>=Ke[2])return B}continue}let re=0;for(let K=0;K<this._siblingOffset.length;K++){CR((q<<1)+this._siblingOffset[K][0],(H<<1)+this._siblingOffset[K][1],ne+1,n,s,u,_,P,L),P[2]=-100,L[2]=this.maximums[this.childOffsets[R]+K]*E;const ie=TR(P,L,d,v);if(ie!=null){const ce=ie;z[K]=ce;let _e=!1;for(let Ce=0;Ce<re&&!_e;Ce++)ce>=z[S[Ce]]&&(S.splice(Ce,0,K),_e=!0);_e||(S[re]=K),re++}}for(let K=0;K<re;K++){const ie=S[K];M.push({idx:this.childOffsets[R]+ie,t:z[ie],nodex:(q<<1)+this._siblingOffset[ie][0],nodey:(H<<1)+this._siblingOffset[ie][1],depth:ne+1})}}return null}_addNode(n,s,u){return this.minimums.push(n),this.maximums.push(s),this.leaves.push(u),this.childOffsets.push(0),this.nodeCount++}_construct(n,s,u,_,d){if(n[_].isLeaf(s,u)===1)return;this.childOffsets[d]||(this.childOffsets[d]=this.nodeCount);const v=_-1,E=n[v];let O=0,z=0;for(let S=0;S<this._siblingOffset.length;S++){const P=2*s+this._siblingOffset[S][0],L=2*u+this._siblingOffset[S][1],M=E.getElevation(P,L),R=E.isLeaf(P,L),B=this._addNode(M.min,M.max,R);R&&(O|=1<<S),z||(z=B)}for(let S=0;S<this._siblingOffset.length;S++)O&1<<S||this._construct(n,2*s+this._siblingOffset[S][0],2*u+this._siblingOffset[S][1],v,z+S)}}function OR(c,n,s,u,_,d){return Mn(Mn(c,s,d),Mn(n,u,d),_)}function tm(c,n,s){const u=s.dim,_=Bn(c*u-.5,0,u-1),d=Bn(n*u-.5,0,u-1),v=Math.floor(_),E=Math.floor(d),O=Math.min(v+1,u-1),z=Math.min(E+1,u-1);return OR(s.get(v,E),s.get(O,E),s.get(v,z),s.get(O,z),_-v,d-E)}const PG={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function IG(c,n,s){return(256*c*256+256*n+s)/10-1e4}function RG(c,n,s){return 256*c+n+s/256-32768}class kx{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(n,s,u,_=!1){if(this.uid=n,s.height!==s.width)throw new RangeError("DEM tiles must be square");if(u&&u!=="mapbox"&&u!=="terrarium")return void qn(`"${u}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=s.height;const d=this.dim=s.height-2,v=new Uint32Array(s.data.buffer);if(this.pixels=new Uint8Array(s.data.buffer),this.floatView=new Float32Array(s.data.buffer),this.borderReady=_,this._modifiedForSources={},!_){for(let O=0;O<d;O++)v[this._idx(-1,O)]=v[this._idx(0,O)],v[this._idx(d,O)]=v[this._idx(d-1,O)],v[this._idx(O,-1)]=v[this._idx(O,0)],v[this._idx(O,d)]=v[this._idx(O,d-1)];v[this._idx(-1,-1)]=v[this._idx(0,0)],v[this._idx(d,-1)]=v[this._idx(d-1,0)],v[this._idx(-1,d)]=v[this._idx(0,d-1)],v[this._idx(d,d)]=v[this._idx(d-1,d-1)]}const E=u==="terrarium"?RG:IG;for(let O=0;O<v.length;++O){const z=4*O;this.floatView[O]=E(this.pixels[z],this.pixels[z+1],this.pixels[z+2])}this._timestamp=Le.now()}_buildQuadTree(){this._tree=new MR(this)}get(n,s,u=!1){u&&(n=Bn(n,-1,this.dim),s=Bn(s,-1,this.dim));const _=this._idx(n,s);return this.floatView[_]}set(n,s,u){const _=this._idx(n,s),d=this.floatView[_];return this.floatView[_]=u,u-d}static getUnpackVector(n){return PG[n]}_idx(n,s){if(n<-1||n>=this.dim+1||s<-1||s>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(s+1)*this.stride+(n+1)}static pack(n,s){const u=[0,0,0,0],_=kx.getUnpackVector(s);let d=Math.floor((n+_[3])/_[2]);return u[2]=d%256,d=Math.floor(d/256),u[1]=d%256,d=Math.floor(d/256),u[0]=d,u}getPixels(){return new Ry({width:this.stride,height:this.stride},this.pixels)}backfillBorder(n,s,u){if(this.dim!==n.dim)throw new Error("dem dimension mismatch");let _=s*this.dim,d=s*this.dim+this.dim,v=u*this.dim,E=u*this.dim+this.dim;switch(s){case-1:_=d-1;break;case 1:d=_+1}switch(u){case-1:v=E-1;break;case 1:E=v+1}const O=-s*this.dim,z=-u*this.dim;for(let S=v;S<E;S++)for(let P=_;P<d;P++){const L=4*this._idx(P,S),M=4*this._idx(P+O,S+z);this.pixels[L+0]=n.pixels[M+0],this.pixels[L+1]=n.pixels[M+1],this.pixels[L+2]=n.pixels[M+2],this.pixels[L+3]=n.pixels[M+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}function DG(c,n,s){c===1?n.headerLength=s.readFixed32():c===2?n.x=s.readVarint():c===3?n.y=s.readVarint():c===4?n.z=s.readVarint():c===5&&n.layers.push(function(u,_){return u.readFields(NG,{version:0,name:"",units:"",tileSize:0,buffer:0,pixelFormat:0,dataIndex:[]},_)}(s,s.readVarint()+s.pos))}function LG(c,n,s){c===1?(n.delta_filter=function(u,_){return u.readFields(kG,{blockSize:0},_)}(s,s.readVarint()+s.pos),n.filter="delta_filter"):c===2?(s.readVarint(),n.filter="zigzag_filter"):c===3?(s.readVarint(),n.filter="bitshuffle_filter"):c===4&&(s.readVarint(),n.filter="byteshuffle_filter")}function kG(c,n,s){c===1&&(n.blockSize=s.readVarint())}function zG(c,n,s){c===1?(s.readVarint(),n.codec="gzip_data"):c===2?(s.readVarint(),n.codec="jpeg_image"):c===3?(s.readVarint(),n.codec="webp_image"):c===4&&(s.readVarint(),n.codec="png_image")}function BG(c,n,s){let u=0,_=0;c===1?n.firstByte=s.readFixed64():c===2?n.lastByte=s.readFixed64():c===3?n.filters.push(function(d,v){return d.readFields(LG,{},v)}(s,s.readVarint()+s.pos)):c===4?n.codec=function(d,v){return d.readFields(zG,{},v)}(s,s.readVarint()+s.pos):c===5?_=s.readFloat():c===6?u=s.readFloat():c===7?n.bands.push(s.readString()):c===8?n.offset=s.readDouble():c===9&&(n.scale=s.readDouble()),n.offset===0&&(n.offset=_),n.scale===0&&(n.scale=u)}function NG(c,n,s){c===1?n.version=s.readVarint():c===2?n.name=s.readString():c===3?n.units=s.readString():c===4?n.tileSize=s.readVarint():c===5?n.buffer=s.readVarint():c===6?n.pixelFormat=s.readVarint():c===7&&n.dataIndex.push(function(u,_){return u.readFields(BG,{firstByte:0,lastByte:0,filters:[],codec:null,offset:0,scale:0,bands:[]},_)}(s,s.readVarint()+s.pos))}function FG(c,n,s){if(c===2)(function(u,_,d){u.readFields(jG,d,_)})(s,s.readVarint()+s.pos,n);else if(c===3)throw new Error("Not implemented")}function jG(c,n,s){if(c===1){let u=0;const _=s.readVarint()+s.pos;for(;s.pos<_;)n[u++]=s.readVarint()}}function UG(c,n){if(n.length!==4)throw new Error(`Expected data of dimension 4 but got ${n.length}.`);let s=n[3];for(let u=2;u>=1;u--){const _=u===1?1:0,d=u===2?1:0;for(let v=0;v<n[0];v++){const E=n[1]*v;for(let O=_;O<n[1];O++){const z=n[2]*(O+E);for(let S=d;S<n[2];S++){const P=n[3]*(S+z);for(let L=0;L<n[3];L++){const M=P+L;c[M]+=c[M-s]}}}}s*=n[u]}return c}function VG(c){for(let n=0,s=c.length;n<s;n++)c[n]=c[n]>>>1^-(1&c[n]);return c}function $G(c,n){switch(n){case"uint32":return c;case"uint16":for(let s=0;s<c.length;s+=2){const u=c[s],_=c[s+1];c[s]=(240&u)>>4|(61440&u)>>8|(240&_)<<4|61440&_,c[s+1]=15&u|(3840&u)>>4|(15&_)<<8|(3840&_)<<4}return c;case"uint8":for(let s=0;s<c.length;s+=4){const u=c[s],_=c[s+1],d=c[s+2],v=c[s+3];c[s+0]=(192&u)>>6|(192&_)>>4|(192&d)>>2|192&v,c[s+1]=(48&u)>>4|(48&_)>>2|48&d|(48&v)<<2,c[s+2]=(12&u)>>2|12&_|(12&d)<<2|(12&v)<<4,c[s+3]=3&u|(3&_)<<2|(3&d)<<4|(3&v)<<6}return c;default:throw new Error(`Invalid pixel format, "${n}"`)}}hn(kx,"DEMData"),hn(MR,"DemMinMaxQuadTree",{omit:["dem"]});var Jl=Uint8Array,bv=Uint16Array,qG=Int32Array,PR=new Jl([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),IR=new Jl([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),GG=new Jl([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),RR=function(c,n){for(var s=new bv(31),u=0;u<31;++u)s[u]=n+=1<<c[u-1];var _=new qG(s[30]);for(u=1;u<30;++u)for(var d=s[u];d<s[u+1];++d)_[d]=d-s[u]<<5|u;return{b:s,r:_}},DR=RR(PR,2),LR=DR.b,HG=DR.r;LR[28]=258,HG[258]=28;for(var ZG=RR(IR,0).b,kR=new bv(32768),ea=0;ea<32768;++ea){var ig=(43690&ea)>>1|(21845&ea)<<1;kR[ea]=((65280&(ig=(61680&(ig=(52428&ig)>>2|(13107&ig)<<2))>>4|(3855&ig)<<4))>>8|(255&ig)<<8)>>1}var wv=function(c,n,s){for(var u=c.length,_=0,d=new bv(n);_<u;++_)c[_]&&++d[c[_]-1];var v,E=new bv(n);for(_=1;_<n;++_)E[_]=E[_-1]+d[_-1]<<1;v=new bv(1<<n);var O=15-n;for(_=0;_<u;++_)if(c[_])for(var z=_<<4|c[_],S=n-c[_],P=E[c[_]-1]++<<S,L=P|(1<<S)-1;P<=L;++P)v[kR[P]>>O]=z;return v},Sv=new Jl(288);for(ea=0;ea<144;++ea)Sv[ea]=8;for(ea=144;ea<256;++ea)Sv[ea]=9;for(ea=256;ea<280;++ea)Sv[ea]=7;for(ea=280;ea<288;++ea)Sv[ea]=8;var zR=new Jl(32);for(ea=0;ea<32;++ea)zR[ea]=5;var WG=wv(Sv,9),XG=wv(zR,5),G3=function(c){for(var n=c[0],s=1;s<c.length;++s)c[s]>n&&(n=c[s]);return n},Wu=function(c,n,s){var u=n/8|0;return(c[u]|c[u+1]<<8)>>(7&n)&s},H3=function(c,n){var s=n/8|0;return(c[s]|c[s+1]<<8|c[s+2]<<16)>>(7&n)},YG=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Xu=function(c,n,s){var u=new Error(n||YG[c]);if(u.code=c,Error.captureStackTrace&&Error.captureStackTrace(u,Xu),!s)throw u;return u},KG=new Jl(0),JG=typeof TextDecoder<"u"&&new TextDecoder;try{JG.decode(KG,{stream:!0})}catch{}const QG={gzip_data:"gzip"};class Kc extends Error{constructor(n){super(n),this.name="MRTError"}}const eH={0:"uint32",1:"uint32",2:"uint16",3:"uint8"},BR={uint32:1,uint16:2,uint8:4},tH={uint32:Uint32Array,uint16:Uint16Array,uint8:Uint8Array};let Z3;class W3{constructor(n=5){this.x=NaN,this.y=NaN,this.z=NaN,this.layers={},this._cacheSize=n}getLayer(n){const s=this.layers[n];if(!s)throw new Kc(`Layer '${n}' not found`);return s}getHeaderLength(n){const s=new Uint8Array(n),u=new DataView(n);if(s[0]!==13)throw new Kc("File is not a valid MRT.");return u.getUint32(1,!0)}parseHeader(n){const s=new Uint8Array(n),u=this.getHeaderLength(n);if(s.length<u)throw new Kc(`Expected header with length >= ${u} but got buffer of length ${s.length}`);const _=function(d,v){return d.readFields(DG,{headerLength:0,x:0,y:0,z:0,layers:[]},void 0)}(new Z3(s.subarray(0,u)));if(!isNaN(this.x)&&(this.x!==_.x||this.y!==_.y||this.z!==_.z))throw new Kc(`Invalid attempt to parse header ${_.z}/${_.x}/${_.y} for tile ${this.z}/${this.x}/${this.y}`);this.x=_.x,this.y=_.y,this.z=_.z;for(const d of _.layers)this.layers[d.name]=new nH(d,{cacheSize:this._cacheSize});return this}createDecodingTask(n){const s=[],u=this.getLayer(n.layerName);for(let _ of n.blockIndices){const d=u.dataIndex[_],v=d.firstByte-n.firstByte,E=d.lastByte-n.firstByte;if(u._blocksInProgress.has(_))continue;const O={layerName:u.name,firstByte:v,lastByte:E,pixelFormat:u.pixelFormat,blockIndex:_,blockShape:[d.bands.length].concat(u.bandShape),buffer:u.buffer,codec:d.codec.codec,filters:d.filters.map(z=>z.filter)};u._blocksInProgress.add(_),s.push(O)}return new NR(s,()=>{s.forEach(_=>u._blocksInProgress.delete(_.blockIndex))},(_,d)=>{if(s.forEach(v=>u._blocksInProgress.delete(v.blockIndex)),_)throw _;d.forEach(v=>{this.getLayer(v.layerName).processDecodedData(v)})})}}class nH{constructor({version:n,name:s,units:u,tileSize:_,pixelFormat:d,buffer:v,dataIndex:E},O){if(this.version=n,this.version!==1)throw new Kc(`Cannot parse raster layer encoded with MRT version ${n}`);this.name=s,this.units=u,this.tileSize=_,this.buffer=v,this.pixelFormat=eH[d],this.dataIndex=E,this.bandShape=[_+2*v,_+2*v,BR[this.pixelFormat]],this._decodedBlocks=new $3(O?O.cacheSize:5),this._blocksInProgress=new Set}get dimension(){return BR[this.pixelFormat]}get cacheSize(){return this._decodedBlocks.capacity}getBandList(){return this.dataIndex.map(({bands:n})=>n).flat()}processDecodedData(n){const s=n.blockIndex.toString();this._decodedBlocks.get(s)||this._decodedBlocks.put(s,n.data)}getBlockForBand(n){let s=0;switch(typeof n){case"string":for(const[u,_]of this.dataIndex.entries()){for(const[d,v]of _.bands.entries())if(v===n)return{bandIndex:s+d,blockIndex:u,blockBandIndex:d};s+=_.bands.length}break;case"number":for(const[u,_]of this.dataIndex.entries()){if(n>=s&&n<s+_.bands.length)return{bandIndex:n,blockIndex:u,blockBandIndex:n-s};s+=_.bands.length}break;default:throw new Kc(`Invalid band \`${JSON.stringify(n)}\`. Expected string or integer.`)}throw new Kc(`Band not found: ${JSON.stringify(n)}`)}getDataRange(n){let s=1/0,u=-1/0;const _=[],d=new Set;for(const v of n){const{blockIndex:E}=this.getBlockForBand(v);if(E<0)throw new Kc(`Invalid band: ${JSON.stringify(v)}`);const O=this.dataIndex[E];_.includes(E)||_.push(E),d.add(E),s=Math.min(s,O.firstByte),u=Math.max(u,O.lastByte)}if(d.size>this.cacheSize)throw new Kc(`Number of blocks to decode (${d.size}) exceeds cache size (${this.cacheSize}).`);return{layerName:this.name,firstByte:s,lastByte:u,blockIndices:_}}hasBand(n){const{blockIndex:s}=this.getBlockForBand(n);return s>=0}hasDataForBand(n){const{blockIndex:s}=this.getBlockForBand(n);return s>=0&&!!this._decodedBlocks.get(s.toString())}getBandView(n){const{blockIndex:s,blockBandIndex:u}=this.getBlockForBand(n),_=this._decodedBlocks.get(s.toString());if(!_)throw new Kc(`Data for band ${JSON.stringify(n)} of layer "${this.name}" not decoded.`);const d=this.dataIndex[s],v=this.bandShape.reduce((z,S)=>z*S,1),E=u*v,O=_.subarray(E,E+v);return{data:O,bytes:new Uint8Array(O.buffer).subarray(O.byteOffset,O.byteOffset+O.byteLength),tileSize:this.tileSize,buffer:this.buffer,pixelFormat:this.pixelFormat,dimension:this.dimension,offset:d.offset,scale:d.scale}}}W3.setPbf=function(c){Z3=c};class NR{constructor(n,s,u){this.tasks=n,this._onCancel=s,this._onComplete=u,this._finalized=!1}cancel(){this._finalized||(this._onCancel(),this._finalized=!0)}complete(n,s){this._finalized||(this._onComplete(n,s),this._finalized=!0)}}W3.performDecoding=function(c,n){const s=new Uint8Array(c);return Promise.all(n.tasks.map(u=>{const{layerName:_,firstByte:d,lastByte:v,pixelFormat:E,blockShape:O,blockIndex:z,filters:S,codec:P}=u,L=s.subarray(d,v+1),M=new Uint32Array(O[0]*O[1]*O[2]);let R;if(P!=="gzip_data")throw new Kc(`Unhandled codec: ${P}`);return R=function(B,q){if(!globalThis.DecompressionStream&&q==="gzip_data")return Promise.resolve(((K=function(_e){_e[0]==31&&_e[1]==139&&_e[2]==8||Xu(6,"invalid gzip data");var Ce=_e[3],Ae=10;4&Ce&&(Ae+=2+(_e[10]|_e[11]<<8));for(var Ee=(Ce>>3&1)+(Ce>>4&1);Ee>0;Ee-=!_e[Ae++]);return Ae+(2&Ce)}(re=B))+8>re.length&&Xu(6,"invalid gzip data"),function(_e,Ce,Ae,Ee){var Ue=_e.length;if(!Ue||Ce.f&&!Ce.l)return Ae||new Jl(0);var Oe=!Ae,Ve=Oe||Ce.i!=2,Ze=Ce.i;Oe&&(Ae=new Jl(3*Ue));var qe,Ke,Qe=function(nm){var E0=Ae.length;if(nm>E0){var Cv=new Jl(Math.max(2*E0,nm));Cv.set(Ae),Ae=Cv}},at=Ce.f||0,Je=Ce.p||0,wt=Ce.b||0,Rt=Ce.l,bt=Ce.d,an=Ce.m,Jt=Ce.n,Ut=8*Ue;do{if(!Rt){at=Wu(_e,Je,1);var kt=Wu(_e,Je+1,3);if(Je+=3,!kt){var vn=_e[(jn=4+((Je+7)/8|0))-4]|_e[jn-3]<<8,ln=jn+vn;if(ln>Ue){Ze&&Xu(0);break}Ve&&Qe(wt+vn),Ae.set(_e.subarray(jn,ln),wt),Ce.b=wt+=vn,Ce.p=Je=8*ln,Ce.f=at;continue}if(kt==1)Rt=WG,bt=XG,an=9,Jt=5;else if(kt==2){var pn=Wu(_e,Je,31)+257,zn=Wu(_e,Je+10,15)+4,Gn=pn+Wu(_e,Je+5,31)+1;Je+=14;for(var Zn=new Jl(Gn),Wn=new Jl(19),lr=0;lr<zn;++lr)Wn[GG[lr]]=Wu(_e,Je+3*lr,7);Je+=3*zn;var ur=G3(Wn),Zr=(1<<ur)-1,Lr=wv(Wn,ur);for(lr=0;lr<Gn;){var jn,Ir=Lr[Wu(_e,Je,Zr)];if(Je+=15&Ir,(jn=Ir>>4)<16)Zn[lr++]=jn;else{var Rr=0,ri=0;for(jn==16?(ri=3+Wu(_e,Je,3),Je+=2,Rr=Zn[lr-1]):jn==17?(ri=3+Wu(_e,Je,7),Je+=3):jn==18&&(ri=11+Wu(_e,Je,127),Je+=7);ri--;)Zn[lr++]=Rr}}var Bi=Zn.subarray(0,pn),ta=Zn.subarray(pn);an=G3(Bi),Jt=G3(ta),Rt=wv(Bi,an),bt=wv(ta,Jt)}else Xu(1);if(Je>Ut){Ze&&Xu(0);break}}Ve&&Qe(wt+131072);for(var Ni=(1<<an)-1,Oi=(1<<Jt)-1,Hi=Je;;Hi=Je){var la=(Rr=Rt[H3(_e,Je)&Ni])>>4;if((Je+=15&Rr)>Ut){Ze&&Xu(0);break}if(Rr||Xu(2),la<256)Ae[wt++]=la;else{if(la==256){Hi=Je,Rt=null;break}var vo=la-254;la>264&&(vo=Wu(_e,Je,(1<<(Ku=PR[lr=la-257]))-1)+LR[lr],Je+=Ku);var Qr=bt[H3(_e,Je)&Oi],Ks=Qr>>4;if(Qr||Xu(3),Je+=15&Qr,ta=ZG[Ks],Ks>3){var Ku=IR[Ks];ta+=H3(_e,Je)&(1<<Ku)-1,Je+=Ku}if(Je>Ut){Ze&&Xu(0);break}Ve&&Qe(wt+131072);var Jc=wt+vo;if(wt<ta){var Qc=0-ta,T0=Math.min(ta,Jc);for(Qc+wt<0&&Xu(3);wt<T0;++wt)Ae[wt]=(void 0)[Qc+wt]}for(;wt<Jc;++wt)Ae[wt]=Ae[wt-ta]}}Ce.l=Rt,Ce.p=Hi,Ce.b=wt,Ce.f=at,Rt&&(at=1,Ce.m=an,Ce.d=bt,Ce.n=Jt)}while(!at);return wt!=Ae.length&&Oe?(qe=Ae,((Ke=wt)==null||Ke>qe.length)&&(Ke=qe.length),new Jl(qe.subarray(0,Ke))):Ae.subarray(0,wt)}(re.subarray(K,-8),{i:2},new Jl(((H=re)[(ne=H.length)-4]|H[ne-3]<<8|H[ne-2]<<16|H[ne-1]<<24)>>>0))));var H,ne,re,K;const ie=QG[q];if(!ie)throw new Error(`Unhandled codec: ${q}`);const ce=new globalThis.DecompressionStream(ie);return new Response(new Blob([B]).stream().pipeThrough(ce)).arrayBuffer().then(_e=>new Uint8Array(_e))}(L,P).then(B=>(function(q,H){q.readFields(FG,H)}(new Z3(B),M),new tH[E](M.buffer))),R.then(B=>{for(let q=S.length-1;q>=0;q--)switch(S[q]){case"delta_filter":UG(B,O);break;case"zigzag_filter":VG(B);break;case"bitshuffle_filter":$G(B,E);break;default:throw new Kc(`Unhandled filter "${S[q]}"`)}return{layerName:_,blockIndex:z,data:B}}).catch(B=>{throw B})}))},hn(NR,"MRTDecodingBatch",{omit:["_onCancel","_onComplete"]});let Tv,X3,Yu,ag,Y3,og=null;function FR(){return as()&&self.worker&&self.worker.dracoUrl?self.worker.dracoUrl:X3||vi.DRACO_URL}function jR(){if(as()&&self.worker&&self.worker.meshoptUrl)return self.worker.meshoptUrl;if(ag)return ag;const c=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]);if(typeof WebAssembly!="object")throw new Error("WebAssembly not supported, cannot instantiate meshoptimizer");return ag=WebAssembly.validate(c)?vi.MESHOPT_SIMD_URL:vi.MESHOPT_URL,ag}const zx={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},rH={5120:"DT_INT8",5121:"DT_UINT8",5122:"DT_INT16",5123:"DT_UINT16",5125:"DT_UINT32",5126:"DT_FLOAT32"},Ev={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16};function UR(c,n,s){const u=s.json.bufferViews.length,_=s.buffers.length;n.bufferView=u,s.json.bufferViews[u]={buffer:_,byteLength:c.byteLength},s.buffers[_]=c}const K3="KHR_draco_mesh_compression";function iH(c,n){const s=c.extensions&&c.extensions[K3];if(!s)return;const u=new Yu.Decoder,_=GR(n,s.bufferView),d=new Yu.Mesh;if(!u.DecodeArrayToMesh(_,_.byteLength,d))throw new Error("Failed to decode Draco mesh");const v=n.json.accessors[c.indices],E=zx[v.componentType],O=v.count*E.BYTES_PER_ELEMENT,z=Yu._malloc(O);E===Uint16Array?u.GetTrianglesUInt16Array(d,O,z):u.GetTrianglesUInt32Array(d,O,z),UR(Yu.memory.buffer.slice(z,z+O),v,n),Yu._free(z);for(const S of Object.keys(s.attributes)){const P=u.GetAttributeByUniqueId(d,s.attributes[S]),L=n.json.accessors[c.attributes[S]],M=rH[L.componentType],R=L.count*Ev[L.type]*zx[L.componentType].BYTES_PER_ELEMENT,B=Yu._malloc(R);u.GetAttributeDataArrayForAllPoints(d,P,Yu[M],R,B),UR(Yu.memory.buffer.slice(B,B+R),L,n),Yu._free(B)}u.destroy(),d.destroy(),delete c.extensions[K3]}const Bx="EXT_meshopt_compression";function aH(c,n){if(!c.extensions||!c.extensions[Bx])return;const s=c.extensions[Bx],u=new Uint8Array(n.buffers[s.buffer],s.byteOffset||0,s.byteLength||0),_=new Uint8Array(s.count*s.byteStride);Y3.decodeGltfBuffer(_,s.count,s.byteStride,u,s.mode,s.filter),c.buffer=n.buffers.length,c.byteOffset=0,n.buffers[c.buffer]=_.buffer,delete c.extensions[Bx]}const VR=1179937895,$R=new TextDecoder("utf8");function qR(c,n){return new URL(c,n).href}function oH(c,n,s,u){return fetch(qR(c.uri,u)).then(_=>_.arrayBuffer()).then(_=>{n.buffers[s]=_})}function GR(c,n){const s=c.json.bufferViews[n];return new Uint8Array(c.buffers[s.buffer],s.byteOffset||0,s.byteLength)}function sH(c,n,s,u){if(c.uri){const _=qR(c.uri,u);return fetch(_).then(d=>d.blob()).then(d=>createImageBitmap(d)).then(d=>{n.images[s]=d})}if(c.bufferView!==void 0){const _=GR(n,c.bufferView),d=new Blob([_],{type:c.mimeType});return createImageBitmap(d).then(v=>{n.images[s]=v})}}function HR(c,n=0,s){const u={json:null,images:[],buffers:[]};if(new Uint32Array(c,n,1)[0]===VR){const S=new Uint32Array(c,n);let P=2;const L=(S[P++]>>2)-3,M=S[P++]>>2;if(P++,u.json=JSON.parse($R.decode(S.subarray(P,P+M))),P+=M,P<L){const R=S[P++];P++;const B=n+(P<<2);u.buffers[0]=c.slice(B,B+R)}}else u.json=JSON.parse($R.decode(new Uint8Array(c,n)));const{buffers:_,images:d,meshes:v,extensionsUsed:E,bufferViews:O}=u.json;let z=Promise.resolve();if(_){const S=[];for(let P=0;P<_.length;P++){const L=_[P];L.uri?S.push(oH(L,u,P,s)):u.buffers[P]||(u.buffers[P]=null)}z=Promise.all(S)}return z.then(()=>{const S=[],P=E&&E.includes(K3),L=E&&E.includes(Bx);if(P&&S.push(function(){if(!Yu)return Tv??(Tv=function(M){let R,B=null;function q(){R=new Uint8Array(B.buffer)}function H(){throw new Error("Unexpected Draco error.")}const ne={a:{a:H,d:function(re,K,ie){return R.copyWithin(re,K,K+ie)},c:function(re){const K=R.length,ie=Math.max(re>>>0,Math.ceil(1.2*K)),ce=Math.ceil((ie-K)/65536);try{return B.grow(ce),q(),!0}catch{return!1}},b:H}};return(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(M,ne):M.then(re=>re.arrayBuffer()).then(re=>WebAssembly.instantiate(re,ne))).then(re=>{const{Rb:K,Qb:ie,P:ce,T:_e,X:Ce,Ja:Ae,La:Ee,Qa:Ue,Va:Oe,Wa:Ve,eb:Ze,jb:qe,f:Ke,e:Qe,yb:at,zb:Je,Ab:wt,Bb:Rt,Db:bt,Gb:an}=re.instance.exports;B=Qe;const Jt=(()=>{let Ut=0,kt=0,vn=0,ln=0;return pn=>{vn&&(K(ln),K(Ut),kt+=vn,vn=Ut=0),Ut||(kt+=128,Ut=ie(kt));const zn=pn.length+7&-8;let Gn=Ut;zn>=kt&&(vn=zn,Gn=ln=ie(zn));for(let Zn=0;Zn<pn.length;Zn++)R[Gn+Zn]=pn[Zn];return Gn}})();return q(),Ke(),{memory:Qe,_free:K,_malloc:ie,Mesh:class{constructor(){this.ptr=ce()}destroy(){_e(this.ptr)}},Decoder:class{constructor(){this.ptr=Ae()}destroy(){qe(this.ptr)}DecodeArrayToMesh(Ut,kt,vn){const ln=Jt(Ut),pn=Ee(this.ptr,ln,kt,vn.ptr);return!!Ce(pn)}GetAttributeByUniqueId(Ut,kt){return{ptr:Ue(this.ptr,Ut.ptr,kt)}}GetTrianglesUInt16Array(Ut,kt,vn){Oe(this.ptr,Ut.ptr,kt,vn)}GetTrianglesUInt32Array(Ut,kt,vn){Ve(this.ptr,Ut.ptr,kt,vn)}GetAttributeDataArrayForAllPoints(Ut,kt,vn,ln,pn){Ze(this.ptr,Ut.ptr,kt.ptr,vn,ln,pn)}},DT_INT8:at(),DT_UINT8:Je(),DT_INT16:wt(),DT_UINT16:Rt(),DT_UINT32:bt(),DT_FLOAT32:an()}})}(fetch(FR())),Tv.then(M=>{Yu=M,Tv=void 0}))}()),L&&S.push(function(){if(Y3)return;const M=function(R){let B;const q=WebAssembly.instantiateStreaming(R,{}).then(re=>{B=re.instance,B.exports.__wasm_call_ctors()}),H={NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},ne={ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return{ready:q,supported:!0,decodeGltfBuffer(re,K,ie,ce,_e,Ce){(function(Ae,Ee,Ue,Oe,Ve,Ze,qe){const Ke=Ae.exports.sbrk,Qe=Oe+3&-4,at=Ke(Qe*Ve),Je=Ke(Ze.length),wt=new Uint8Array(Ae.exports.memory.buffer);wt.set(Ze,Je);const Rt=Ee(at,Oe,Ve,Je,Ze.length);if(Rt===0&&qe&&qe(at,Qe,Ve),Ue.set(wt.subarray(at,at+Oe*Ve)),Ke(at-Ke(0)),Rt!==0)throw new Error(`Malformed buffer data: ${Rt}`)})(B,B.exports[ne[_e]],re,K,ie,ce,B.exports[H[Ce]])}}}(fetch(jR()));return M.ready.then(()=>{Y3=M})}()),d)for(let M=0;M<d.length;M++)S.push(sH(d[M],u,M,s));return(S.length?Promise.all(S):Promise.resolve()).then(()=>{if(P&&v)for(const{primitives:M}of v)for(const R of M)iH(R,u);if(L&&v&&O)for(const M of O)aH(M,u);return u})})}function S0(c,n){const s=c.json.bufferViews[n.bufferView],u=zx[n.componentType];return new u(c.buffers[s.buffer],(n.byteOffset||0)+(s.byteOffset||0),n.count*(s.byteStride&&s.byteStride!==Ev[n.type]*u.BYTES_PER_ELEMENT?s.byteStride/u.BYTES_PER_ELEMENT:Ev[n.type]))}function J3(c,n,s,u){const _=zx[n.componentType],d=function(S){switch(S){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:return 1}}(_),v=c.json.bufferViews[n.bufferView],E=v.byteStride?v.byteStride/_.BYTES_PER_ELEMENT:Ev[n.type],O=s.float32,z=O.length/s.capacity;for(let S=0,P=0;S<n.count*E;S+=E,P+=z)for(let L=0;L<z;L++)O[P+L]=u[S+L]*d;s._trim()}function lH(c,n,s){const u=c.indices,_=c.attributes,d={};d.indexArray=new sa;const v=n.json.accessors[u],E=v.count/3;d.indexArray.reserve(E);const O=S0(n,v);for(let L=0;L<E;L++)d.indexArray.emplaceBack(O[3*L],O[3*L+1],O[3*L+2]);d.indexArray._trim(),d.vertexArray=new ul;const z=n.json.accessors[_.POSITION];d.vertexArray.reserve(z.count);const S=S0(n,z);for(let L=0;L<z.count;L++)d.vertexArray.emplaceBack(S[3*L],S[3*L+1],S[3*L+2]);if(d.vertexArray._trim(),d.aabb=new sn(z.min,z.max),d.centroid=function(L,M){const R=[0,0,0],B=L.length;if(B>0){for(let q=0;q<B;q++){const H=3*L[q];R[0]+=M[H],R[1]+=M[H+1],R[2]+=M[H+2]}R[0]/=B,R[1]/=B,R[2]/=B}return R}(O,S),_.COLOR_0!==void 0){const L=n.json.accessors[_.COLOR_0],M=Ev[L.type],R=S0(n,L);d.colorArray=M===3?new ul:new Fc,d.colorArray.resize(L.count),J3(n,L,d.colorArray,R)}if(_.NORMAL!==void 0){d.normalArray=new ul;const L=n.json.accessors[_.NORMAL];d.normalArray.resize(L.count);const M=S0(n,L);J3(n,L,d.normalArray,M)}if(_.TEXCOORD_0!==void 0&&s.length>0){d.texcoordArray=new zu;const L=n.json.accessors[_.TEXCOORD_0];d.texcoordArray.resize(L.count);const M=S0(n,L);J3(n,L,d.texcoordArray,M)}if(_._FEATURE_ID_RGBA4444!==void 0){const L=n.json.accessors[_._FEATURE_ID_RGBA4444];n.json.extensionsUsed&&n.json.extensionsUsed.includes("EXT_meshopt_compression")&&(d.featureData=S0(n,L))}_._FEATURE_RGBA4444!==void 0&&(d.featureData=new Uint32Array(S0(n,n.json.accessors[_._FEATURE_RGBA4444]).buffer));const P=c.material;return d.material=function(L,M){const{emissiveFactor:R=[0,0,0],alphaMode:B="OPAQUE",alphaCutoff:q=.5,normalTexture:H,occlusionTexture:ne,emissiveTexture:re,doubleSided:K}=L,{baseColorFactor:ie=[1,1,1,1],metallicFactor:ce=1,roughnessFactor:_e=1,baseColorTexture:Ce,metallicRoughnessTexture:Ae}=L.pbrMetallicRoughness||{},Ee=ne?M[ne.index]:void 0;if(ne&&ne.extensions&&ne.extensions.KHR_texture_transform&&Ee){const Ue=ne.extensions.KHR_texture_transform;Ee.offsetScale=[Ue.offset[0],Ue.offset[1],Ue.scale[0],Ue.scale[1]]}return{pbrMetallicRoughness:{baseColorFactor:new _r(...ie),metallicFactor:ce,roughnessFactor:_e,baseColorTexture:Ce?M[Ce.index]:void 0,metallicRoughnessTexture:Ae?M[Ae.index]:void 0},doubleSided:K,emissiveFactor:R,alphaMode:B,alphaCutoff:q,normalTexture:H?M[H.index]:void 0,occlusionTexture:Ee,emissionTexture:re?M[re.index]:void 0,defined:L.defined===void 0}}(P!==void 0?n.json.materials[P]:{defined:!1},s),d}function ZR(c,n,s){const{matrix:u,rotation:_,translation:d,scale:v,mesh:E,extras:O,children:z}=c,S={};if(S.matrix=u||Ne.mat4.fromRotationTranslationScale([],_||[0,0,0,1],d||[0,0,0],v||[1,1,1]),E!==void 0){S.meshes=s[E];const P=S.anchor=[0,0];for(const L of S.meshes){const{min:M,max:R}=L.aabb;P[0]+=M[0]+R[0],P[1]+=M[1]+R[1]}P[0]=Math.floor(P[0]/S.meshes.length/2),P[1]=Math.floor(P[1]/S.meshes.length/2)}if(O&&(O.id&&(S.id=O.id),O.lights&&(S.lights=function(P){if(!P.length)return[];const L=function(H){const ne=atob(H),re=new Uint8Array(ne.length);for(let K=0;K<ne.length;K++)re[K]=ne.codePointAt(K);return re}(P),M=[],R=L.length/24,B=new Uint16Array(L.buffer),q=new Float32Array(L.buffer);for(let H=0;H<R;H++){const ne=B[2*H*6]/30,re=B[2*H*6+1]/30,K=B[2*H*6+10]/100,ie=q[6*H+1],ce=q[6*H+2],_e=q[6*H+3],Ce=q[6*H+4],Ae=_e-ie,Ee=Ce-ce,Ue=Math.hypot(Ae,Ee);M.push({pos:[ie+.5*Ae,ce+.5*Ee,re],normal:[Ee/Ue,-Ae/Ue,0],width:Ue,height:ne,depth:K,points:[ie,ce,_e,Ce]})}return M}(O.lights))),z){const P=[];for(const L of z)P.push(ZR(n.json.nodes[L],n,s));S.children=P}return S}function cH(c){if(c.vertices.length===0||c.indices.length===0)return null;const n=new zy(c.vertices,c.indices,8,256),[s,u]=[n.min.clone(),n.max.clone()];return{vertices:c.vertices,indices:c.indices,grid:n,min:s,max:u}}function uH(c){if(!c.extras||!c.extras.ground)return null;const n=c.extras.ground;if(!n||!Array.isArray(n)||n.length===0)return null;const s=n[0];if(!s||!Array.isArray(s)||s.length===0)return null;const u=[];for(const v of s){if(!Array.isArray(v)||v.length!==2)continue;const E=v[0],O=v[1];typeof E=="number"&&typeof O=="number"&&u.push(new Pt(E,O))}if(u.length<3)return null;u.length>1&&u[u.length-1].equals(u[0])&&u.pop();let _=0;for(let v=0;v<u.length;v++){const E=u[v],O=u[(v+1)%u.length],z=u[(v+2)%u.length];_+=(E.x-O.x)*(z.y-O.y)-(z.x-O.x)*(E.y-O.y)}_>0&&u.reverse();const d=n0(u.flatMap(v=>[v.x,v.y]),[]);return d.length===0?null:{vertices:u,indices:d}}function hH(c,n){const s=[],u=[];let _=0;const d=[];for(const v of c){_=s.length;const E=v.vertexArray.float32,O=v.indexArray.uint16;for(let z=0;z<v.vertexArray.length;z++)d[0]=E[3*z+0],d[1]=E[3*z+1],d[2]=E[3*z+2],Ne.vec3.transformMat4(d,d,n),s.push(new Pt(d[0],d[1]));for(let z=0;z<3*v.indexArray.length;z++)u.push(O[z]+_)}if(u.length%3!=0)return null;for(let v=0;v<u.length;v+=3){const E=s[u[v+0]],O=s[u[v+1]],z=s[u[v+2]];(E.x-O.x)*(z.y-O.y)-(z.x-O.x)*(E.y-O.y)>0&&([u[v+1],u[v+2]]=[u[v+2],u[v+1]])}return{vertices:s,indices:u}}function WR(c){const n=function(O,z){const S=[],P=WebGL2RenderingContext;if(O.json.textures)for(const L of O.json.textures){const M={magFilter:P.LINEAR,minFilter:P.NEAREST,wrapS:P.REPEAT,wrapT:P.REPEAT};L.sampler!==void 0&&Object.assign(M,O.json.samplers[L.sampler]),S.push({image:z[L.source],sampler:M,uploaded:!1})}return S}(c,c.images),s=function(O,z){const S=[];for(const P of O.json.meshes){const L=[];for(const M of P.primitives)L.push(lH(M,O,z));S.push(L)}return S}(c,n),{scenes:u,scene:_,nodes:d}=c.json,v=u?u[_||0].nodes:d,E=[];for(const O of v)E.push(ZR(d[O],c,s));return function(O,z,S){const P={},L=new Set;for(let M=0;M<O.length;M++){const R=S[z[M]];if(!R.extras)continue;const B=R.extras["mapbox:footprint:version"],q=R.extras["mapbox:footprint:id"];(B||q)&&L.add(M),B==="1.0.0"&&q&&(P[q]=M)}for(let M=0;M<O.length;M++){if(L.has(M))continue;const R=O[M],B=S[z[M]];if(!B.extras)continue;let q=null;R.id in P&&(q=hH(O[P[R.id]].meshes,R.matrix)),q||(q=uH(B)),q&&(R.footprint=cH(q))}if(L.size>0){const M=Array.from(L.values()).sort((R,B)=>R-B);for(let R=M.length-1;R>=0;R--)O.splice(M[R],1)}}(E,v,c.json.nodes),E}function fH(c){c.heightmap=new Float32Array(4096),c.heightmap.fill(-1);const n=c.vertexArray.float32,s=c.aabb.min[0]-1,u=c.aabb.min[1]-1,_=x0/(c.aabb.max[0]-s+2),d=x0/(c.aabb.max[1]-u+2);for(let v=0;v<n.length;v+=3){const E=n[v+2],O=(n[v+0]-s)*_|0,z=(n[v+1]-u)*d|0;E>c.heightmap[z*x0+O]&&(c.heightmap[z*x0+O]=E)}}function dH(c,n){const s={};s.indexArray=new sa,s.indexArray.reserve(4*c.length),s.vertexArray=new ul,s.vertexArray.reserve(10*c.length),s.colorArray=new Fc,s.vertexArray.reserve(10*c.length);let u=0;for(const v of c){const E=Math.min(10,Math.max(4,1.3*v.height))*n,O=[-v.normal[1],v.normal[0],0],z=Math.min(.29,.1*v.width/v.depth),S=v.width-2*v.depth*n*(z+.01),P=Ne.vec3.scaleAndAdd([],v.pos,O,S/2),L=Ne.vec3.scaleAndAdd([],v.pos,O,-S/2),M=[P[0],P[1],P[2]+v.height],R=[L[0],L[1],L[2]+v.height],B=Ne.vec3.scaleAndAdd([],v.normal,O,z);Ne.vec3.scale(B,B,E);const q=Ne.vec3.scaleAndAdd([],v.normal,O,-z);Ne.vec3.scale(q,q,E),Ne.vec3.add(B,P,B),Ne.vec3.add(q,L,q),P[2]+=.1,L[2]+=.1,s.vertexArray.emplaceBack(B[0],B[1],B[2]),s.vertexArray.emplaceBack(q[0],q[1],q[2]),s.vertexArray.emplaceBack(P[0],P[1],P[2]),s.vertexArray.emplaceBack(L[0],L[1],L[2]),s.vertexArray.emplaceBack(M[0],M[1],M[2]),s.vertexArray.emplaceBack(R[0],R[1],R[2]),s.vertexArray.emplaceBack(P[0],P[1],P[2]),s.vertexArray.emplaceBack(L[0],L[1],L[2]),s.vertexArray.emplaceBack(B[0],B[1],B[2]),s.vertexArray.emplaceBack(q[0],q[1],q[2]);const H=S/E/2;s.colorArray.emplaceBack(-H-z,-1,H,.8),s.colorArray.emplaceBack(H+z,-1,H,.8),s.colorArray.emplaceBack(-H,0,H,1.3),s.colorArray.emplaceBack(H,0,H,1.3),s.colorArray.emplaceBack(H+z,-.8,H,.7),s.colorArray.emplaceBack(H+z,-.8,H,.7),s.colorArray.emplaceBack(0,0,H,1.3),s.colorArray.emplaceBack(0,0,H,1.3),s.colorArray.emplaceBack(H+z,-1.2,H,.8),s.colorArray.emplaceBack(H+z,-1.2,H,.8),s.indexArray.emplaceBack(6+u,4+u,8+u),s.indexArray.emplaceBack(7+u,9+u,5+u),s.indexArray.emplaceBack(0+u,1+u,2+u),s.indexArray.emplaceBack(1+u,3+u,2+u),u+=10}const _={defined:!0,emissiveFactor:[0,0,0]},d={};return d.baseColorFactor=_r.white,_.pbrMetallicRoughness=d,s.material=_,s.aabb=new sn([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),s}class XR{constructor(n){this._stringToNumber={},this._numberToString=[];for(let s=0;s<n.length;s++){const u=n[s];this._stringToNumber[u]=s,this._numberToString[s]=u}}encode(n){return this._stringToNumber[n]}decode(n){return this._numberToString[n]}}const pH=["id","tile","layer","source","sourceLayer","state"];class sg{constructor(n,s,u,_,d){this.type="Feature",this._vectorTileFeature=n,this._z=s,this._x=u,this._y=_,this.properties=n.properties,this.id=d}clone(){const n=new sg(this._vectorTileFeature,this._z,this._x,this._y,this.id);return this.state&&(n.state=Object.assign({},this.state)),this.layer&&(n.layer=Object.assign({},this.layer)),this.source&&(n.source=this.source),this.sourceLayer&&(n.sourceLayer=this.sourceLayer),n}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(n){this._geometry=n}toJSON(){const n={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};for(const s of pH)this[s]!==void 0&&(n[s]=this[s]);return n}}class YR{constructor(n,s){this.tileID=n,this.x=n.canonical.x,this.y=n.canonical.y,this.z=n.canonical.z,this.grid=new Ru(Kt,16,0),this.featureIndexArray=new Gh,this.promoteId=s,this.is3DTile=!1,this.serializedLayersCache=new Map}insert(n,s,u,_,d,v=0,E=0){const O=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(u,_,d,v);const z=this.grid;for(let S=0;S<s.length;S++){const P=s[S],L=[1/0,1/0,-1/0,-1/0];for(let M=0;M<P.length;M++){const R=P[M];L[0]=Math.min(L[0],R.x),L[1]=Math.min(L[1],R.y),L[2]=Math.max(L[2],R.x),L[3]=Math.max(L[3],R.y)}E!==0&&(L[0]-=E,L[1]-=E,L[2]+=E,L[3]+=E),L[0]<Kt&&L[1]<Kt&&L[2]>=0&&L[3]>=0&&z.insert(O,L[0],L[1],L[2],L[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new Td.VectorTile(new g(this.rawTileData)).layers,this.sourceLayerCoder=new XR(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const n in this.vtLayers)this.vtFeatures[n]=[]}return this.vtLayers}query(n,s){const{tilespaceGeometry:u,transform:_,tileTransform:d,pixelPosMatrix:v,availableImages:E}=s;this.loadVTLayers(),this.serializedLayersCache.clear();const O=u.bufferedTilespaceBounds,z=this.grid.query(O.min.x,O.min.y,O.max.x,O.max.y,(M,R,B,q)=>$e(u.bufferedTilespaceGeometry,M,R,B,q));z.sort(mH);let S=null;_.elevation&&z.length>0&&(S=eg.create(_.elevation,this.tileID));const P={};let L;for(let M=0;M<z.length;M++){const R=z[M];if(R===L)continue;L=R;const B=this.featureIndexArray.get(R);let q=null;this.is3DTile?this.loadMatchingModelFeature(P,B,n,u,_):this.loadMatchingFeature(P,B,n,E,(H,ne,re,K=0)=>(q||(q=$(H,this.tileID.canonical,d)),ne.queryIntersectsFeature(u,H,re,q,this.z,_,v,S,K)))}return P}loadMatchingFeature(n,s,u,_,d){const{featureIndex:v,bucketIndex:E,sourceLayerIndex:O,layoutVertexArrayOffset:z}=s,S=this.bucketLayerIDs[E],P=u.layers,L=Object.keys(P);if(L.length&&!function(H,ne){for(let re=0;re<H.length;re++)if(ne.indexOf(H[re])>=0)return!0;return!1}(L,S))return;const M=u.sourceCache,R=this.sourceLayerCoder.decode(O),B=this.vtLayers[R].feature(v),q=this.getId(B,R);for(let H=0;H<S.length;H++){const ne=S[H];if(!P[ne])continue;const{styleLayer:re,targets:K}=P[ne];let ie={};q!==void 0&&(ie=M.getFeatureState(re.sourceLayer,q));const ce=!d||d(B,re,ie,z);if(!ce)continue;const _e=new sg(B,this.z,this.x,this.y,q);_e.tile=this.tileID.canonical,_e.state=ie;let Ce=this.serializedLayersCache.get(ne);Ce||(Ce=re.serialize(),Ce.id=ne,this.serializedLayersCache.set(ne,Ce)),_e.source=Ce.source,_e.sourceLayer=Ce["source-layer"],_e.layer=fa({},Ce),_e.layer.paint=KR(Ce.paint,re.paint,B,ie,_),_e.layer.layout=KR(Ce.layout,re.layout,B,ie,_);let Ae=!1;for(const Ee of K){this.updateFeatureProperties(_e,Ee);const{filter:Ue}=Ee;if(Ue){if(B.properties=_e.properties,Ue.needGeometry){const Oe=Z(B,!0);if(!Ue.filter(new zr(this.tileID.overscaledZ),Oe,this.tileID.canonical))continue}else if(!Ue.filter(new zr(this.tileID.overscaledZ),B))continue}Ae=!0,Ee.targetId&&this.addFeatureVariant(_e,Ee)}Ae&&this.appendToResult(n,ne,v,_e,ce)}}loadMatchingModelFeature(n,s,u,_,d){const v=this.bucketLayerIDs[0][0],E=u.layers;if(!E[v])return;const{styleLayer:O,targets:z}=E[v];if(O.type!=="model")return;const S=_.tile,P=s.featureIndex,L=S.getBucket(O);if(!(L&&L instanceof Mx))return;const M=function(Ce,Ae,Ee,Ue){const Oe=Ce.getNodesInfo()[Ae];if(Oe.hiddenByReplacement||!Oe.node.meshes)return;let Ve=Number.MAX_VALUE;const Ze=Oe.node,qe=Ee.tile,Ke=Ue.calculatePosMatrix(qe.tileID.toUnwrapped(),Ue.worldSize),Qe=Oe.evaluatedScale;let at=0;Ue.elevation&&Ze.elevation&&(at=Ze.elevation*Ue.elevation.exaggeration()),Ne.mat4.translate(Ke,Ke,[(Ze.anchor?Ze.anchor[0]:0)*(Qe[0]-1),(Ze.anchor?Ze.anchor[1]:0)*(Qe[1]-1),at]),Ne.mat4.scale(Ke,Ke,Qe);const Je=Ee.queryGeometry,wt=Je.isPointQuery()?Je.screenBounds:Je.screenGeometry,Rt=function(an){const Jt=Ne.mat4.multiply([],Ke,an.matrix);Ne.mat4.multiply(Jt,Ue.expandedFarZProjMatrix,Jt);for(let Ut=0;Ut<an.meshes.length;++Ut){const kt=an.meshes[Ut];if(Ut===an.lightMeshIndex)continue;const vn=XI(wt,Ue,Jt,kt.aabb);vn!=null&&(Ve=Math.min(vn,Ve))}if(an.children)for(const Ut of an.children)Rt(Ut)};if(Rt(Ze),Ve===Number.MAX_VALUE)return;const bt=new pr(0,0);return sR(qe.tileID.canonical,bt,Oe.node.anchor[0],Oe.node.anchor[1]),{intersectionZ:Ve,position:bt,feature:Oe.feature}}(L,P,_,d);if(!M)return;const{z:R,x:B,y:q}=S.tileID.canonical,{feature:H,intersectionZ:ne,position:re}=M;let K={};H.id!==void 0&&(K=u.sourceCache.getFeatureState(O.sourceLayer,H.id));const ie=new sg({},R,B,q,H.id);ie.tile=this.tileID.canonical,ie.state=K,ie.properties=H.properties,ie.geometry={type:"Point",coordinates:[re.lng,re.lat]};let ce=this.serializedLayersCache.get(v);ce||(ce=O.serialize(),ce.id=v,this.serializedLayersCache.set(v,ce)),ie.source=ce.source,ie.sourceLayer=ce["source-layer"],ie.layer=fa({},ce);let _e=!1;for(const Ce of z){this.updateFeatureProperties(ie,Ce);const{filter:Ae}=Ce;if(Ae){if(H.properties=ie.properties,Ae.needGeometry){if(!Ae.filter(new zr(this.tileID.overscaledZ),H,this.tileID.canonical))continue}else if(!Ae.filter(new zr(this.tileID.overscaledZ),H))continue}_e=!0,Ce.targetId&&this.addFeatureVariant(ie,Ce)}_e&&this.appendToResult(n,v,P,ie,ne)}updateFeatureProperties(n,s,u){if(s.properties){const _={};for(const d in s.properties){const v=s.properties[d].evaluate({zoom:this.z},n._vectorTileFeature,n.state,n.tile,u);v!=null&&(_[d]=v)}n.properties=_}}addFeatureVariant(n,s,u){const _={target:s.target,namespace:s.namespace,uniqueFeatureID:s.uniqueFeatureID};s.properties&&(_.properties=n.properties),n.variants=n.variants||{},n.variants[s.targetId]=n.variants[s.targetId]||[],n.variants[s.targetId].push(_)}appendToResult(n,s,u,_,d){let v=n[s];v===void 0&&(v=n[s]=[]),v.push({featureIndex:u,feature:_,intersectionZ:d})}lookupSymbolFeatures(n,s,u,_,d){const v={};this.loadVTLayers();for(const E of n)this.loadMatchingFeature(v,{bucketIndex:s,sourceLayerIndex:u,featureIndex:E,layoutVertexArrayOffset:0},_,d);return v}loadFeature(n){const{featureIndex:s,sourceLayerIndex:u}=n;this.loadVTLayers();const _=this.sourceLayerCoder.decode(u),d=this.vtFeatures[_];if(d[s])return d[s];const v=this.vtLayers[_].feature(s);return d[s]=v,v}hasLayer(n){for(const s of this.bucketLayerIDs)for(const u of s)if(n===u)return!0;return!1}getId(n,s){let u=n.id;if(this.promoteId){const _=Array.isArray(this.promoteId)||typeof this.promoteId!="object"?this.promoteId:this.promoteId[s];if(_!=null)if(Array.isArray(_)){if(!this.promoteIdExpression){const d=Ri(_);if(d.result!=="success"){const v=d.value.map(E=>`${E.key}: ${E.message}`).join(", ");return void qn(`Failed to create expression for promoteId: ${v}`)}this.promoteIdExpression=d.value}this.promoteIdExpression._evaluator||(this.promoteIdExpression._evaluator=new Om),u=this.promoteIdExpression.evaluate({zoom:0},n)}else u=n.properties[_];typeof u=="boolean"&&(u=Number(u))}return u}}function KR(c,n,s,u,_){return Ia(c,(d,v)=>{const E=n instanceof Du?n.get(v):null;return E&&E.evaluate?E.evaluate(s,u,_):E})}function mH(c,n){return n-c}hn(YR,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});const JR=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Q3{static from(n){if(!(n instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[s,u]=new Uint8Array(n,0,2);if(s!==219)throw new Error("Data does not appear to be in a KDBush format.");const _=u>>4;if(_!==1)throw new Error(`Got v${_} data when expected v1.`);const d=JR[15&u];if(!d)throw new Error("Unrecognized array type.");const[v]=new Uint16Array(n,2,1),[E]=new Uint32Array(n,4,1);return new Q3(E,v,d,n)}constructor(n,s=64,u=Float64Array,_){if(isNaN(n)||n<0)throw new Error(`Unpexpected numItems value: ${n}.`);this.numItems=+n,this.nodeSize=Math.min(Math.max(+s,2),65535),this.ArrayType=u,this.IndexArrayType=n<65536?Uint16Array:Uint32Array;const d=JR.indexOf(this.ArrayType),v=2*n*this.ArrayType.BYTES_PER_ELEMENT,E=n*this.IndexArrayType.BYTES_PER_ELEMENT,O=(8-E%8)%8;if(d<0)throw new Error(`Unexpected typed array class: ${u}.`);_&&_ instanceof ArrayBuffer?(this.data=_,this.ids=new this.IndexArrayType(this.data,8,n),this.coords=new this.ArrayType(this.data,8+E+O,2*n),this._pos=2*n,this._finished=!0):(this.data=new ArrayBuffer(8+v+E+O),this.ids=new this.IndexArrayType(this.data,8,n),this.coords=new this.ArrayType(this.data,8+E+O,2*n),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+d]),new Uint16Array(this.data,2,1)[0]=s,new Uint32Array(this.data,4,1)[0]=n)}add(n,s){const u=this._pos>>1;return this.ids[u]=u,this.coords[this._pos++]=n,this.coords[this._pos++]=s,u}finish(){const n=this._pos>>1;if(n!==this.numItems)throw new Error(`Added ${n} items when expected ${this.numItems}.`);return eT(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(n,s,u,_){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:d,coords:v,nodeSize:E}=this,O=[0,d.length-1,0],z=[];for(;O.length;){const S=O.pop()||0,P=O.pop()||0,L=O.pop()||0;if(P-L<=E){for(let q=L;q<=P;q++){const H=v[2*q],ne=v[2*q+1];H>=n&&H<=u&&ne>=s&&ne<=_&&z.push(d[q])}continue}const M=L+P>>1,R=v[2*M],B=v[2*M+1];R>=n&&R<=u&&B>=s&&B<=_&&z.push(d[M]),(S===0?n<=R:s<=B)&&(O.push(L),O.push(M-1),O.push(1-S)),(S===0?u>=R:_>=B)&&(O.push(M+1),O.push(P),O.push(1-S))}return z}within(n,s,u){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:_,coords:d,nodeSize:v}=this,E=[0,_.length-1,0],O=[],z=u*u;for(;E.length;){const S=E.pop()||0,P=E.pop()||0,L=E.pop()||0;if(P-L<=v){for(let q=L;q<=P;q++)e6(d[2*q],d[2*q+1],n,s)<=z&&O.push(_[q]);continue}const M=L+P>>1,R=d[2*M],B=d[2*M+1];e6(R,B,n,s)<=z&&O.push(_[M]),(S===0?n-u<=R:s-u<=B)&&(E.push(L),E.push(M-1),E.push(1-S)),(S===0?n+u>=R:s+u>=B)&&(E.push(M+1),E.push(P),E.push(1-S))}return O}}function eT(c,n,s,u,_,d){if(_-u<=s)return;const v=u+_>>1;QR(c,n,v,u,_,d),eT(c,n,s,u,v-1,1-d),eT(c,n,s,v+1,_,1-d)}function QR(c,n,s,u,_,d){for(;_>u;){if(_-u>600){const z=_-u+1,S=s-u+1,P=Math.log(z),L=.5*Math.exp(2*P/3),M=.5*Math.sqrt(P*L*(z-L)/z)*(S-z/2<0?-1:1);QR(c,n,s,Math.max(u,Math.floor(s-S*L/z+M)),Math.min(_,Math.floor(s+(z-S)*L/z+M)),d)}const v=n[2*s+d];let E=u,O=_;for(Av(c,n,u,s),n[2*_+d]>v&&Av(c,n,u,_);E<O;){for(Av(c,n,E,O),E++,O--;n[2*E+d]<v;)E++;for(;n[2*O+d]>v;)O--}n[2*u+d]===v?Av(c,n,u,O):(O++,Av(c,n,O,_)),O<=s&&(u=O+1),s<=O&&(_=O-1)}}function Av(c,n,s,u){tT(c,s,u),tT(n,2*s,2*u),tT(n,2*s+1,2*u+1)}function tT(c,n,s){const u=c[n];c[n]=c[s],c[s]=u}function e6(c,n,s,u){const _=c-s,d=n-u;return _*_+d*d}i.$=Vm,i.A=Da,i.B=2,i.C=lv,i.D=tg,i.E=Pl,i.F=fI,i.G=class extends Ax{},i.H=Fs,i.I=q3,i.J=Lf,i.K=Cp,i.L=eo,i.M=Oh,i.N=Ph,i.O=Ih,i.P=Pt,i.Q=rd,i.R=vr,i.S=Dh,i.T=P3,i.U=Ri,i.V=Ax,i.W=Sh,i.X=ka,i.Y=bu,i.Z=ho,i._=cs,i.a=function(c){return vi.API_CDN_URL_REGEX.test(c)},i.a$=sg,i.a0=_s,i.a1=Sp,i.a2=function(c){const n=c.value;let s=[];if(!n)return s;const u=Fs(n);return u!=="string"?(s=s.concat([new Ax(c.key,n,`string expected, "${u}" found`)]),s):(KI(n,!0)||(s=s.concat([new Ax(c.key,n,`invalid url "${n}"`)])),s)},i.a3=st,i.a4=Nh,i.a5=ni,i.a6=qt,i.a7=class{constructor(c){this.specification=c}possiblyEvaluate(c,n){return Za(c.expression.evaluate(n))}interpolate(c,n,s){return{x:Mn(c.x,n.x,s),y:Mn(c.y,n.y,s),z:Mn(c.z,n.z,s),azimuthal:Mn(c.azimuthal,n.azimuthal,s),polar:Mn(c.polar,n.polar,s)}}},i.a8=zr,i.a9=jl,i.aA=Ts,i.aB=class{constructor(c){this.entries={},this.scheduler=c}request(c,n,s,u){const _=this.entries[c]=this.entries[c]||{callbacks:[]};if(_.result){const[d,v]=_.result;return this.scheduler?this.scheduler.add(()=>{u(d,v)},n):u(d,v),()=>{}}return _.callbacks.push(u),_.cancel||(_.cancel=s((d,v)=>{_.result=[d,v];for(const E of _.callbacks)this.scheduler?this.scheduler.add(()=>{E(d,v)},n):E(d,v);setTimeout(()=>delete this.entries[c],3e3)})),()=>{_.result||(_.callbacks=_.callbacks.filter(d=>d!==u),_.callbacks.length||(_.cancel(),delete this.entries[c]))}}},i.aC=Ho,i.aD=function(c,n,s){const u=JSON.stringify(c.request);return c.data&&(this.deduped.entries[u]={result:[null,c.data]}),this.deduped.request(u,{type:"parseTile",isSymbolTile:c.isSymbolTile,zoom:c.tileZoom},_=>{const d=ii(c.request,(v,E,O,z)=>{v?_(v):E&&_(null,{vectorTile:s?void 0:new Td.VectorTile(new g(E)),rawData:E,cacheControl:O,expires:z})});return()=>{d.cancel(),_()}},n)},i.aE=function(c){gn++,gn>ct&&(c.getActor().send("enforceCacheSizeLimit",Ye),gn=0)},i.aF=function(c){return c<=1?1:Math.pow(2,Math.floor(Math.log(c)/Math.LN2))},i.aG=zt,i.aH=NI,i.aI=qI,i.aJ=BI,i.aK=function(c,n){const s=document.createElement("video");s.muted=!0,s.onloadstart=function(){n(null,s)};for(let u=0;u<c.length;u++){const _=document.createElement("source");di(c[u])||(s.crossOrigin="Anonymous"),_.src=c[u],s.appendChild(_)}return{cancel:()=>{}}},i.aL=bx,i.aM=function(c){return fetch(c).then(n=>n.arrayBuffer()).then(n=>HR(n,0,c))},i.aN=WR,i.aO=class{constructor(c,n,s,u){this.id=c,this.position=n!=null?new pr(n[0],n[1]):new pr(0,0),this.orientation=s??[0,0,0],this.nodes=u,this.uploaded=!1,this.aabb=new sn([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),this.matrix=[]}_applyTransformations(c,n){if(Ne.mat4.multiply(c.matrix,n,c.matrix),c.meshes)for(const s of c.meshes){const u=sn.applyTransformFast(s.aabb,c.matrix);this.aabb.encapsulate(u)}if(c.children)for(const s of c.children)this._applyTransformations(s,c.matrix)}computeBoundsAndApplyParent(){const c=Ne.mat4.identity([]);for(const n of this.nodes)this._applyTransformations(n,c)}computeModelMatrix(c,n,s,u,_,d,v=!1){nR(this.matrix,this,c.transform,this.position,n,s,u,_,d,v)}upload(c){if(!this.uploaded){for(const n of this.nodes)k3(n,c);for(const n of this.nodes)Cx(n);this.uploaded=!0}}destroy(){for(const c of this.nodes)z3(c)}},i.aP=hh,i.aQ=uv,i.aR=no,i.aS=qi,i.aT=$s,i.aU=sa,i.aV=hc,i.aW=kp,i.aX=vx,i.aY=function(){Yr.isLoading()||Yr.isLoaded()||Bh()!=="deferred"||Ba()},i.aZ=$m,i.a_=Z,i.aa=l,i.ab=Ne,i.ac=jo,i.ad=Du,i.ae=ja,i.af=Mn,i.ag=Kt,i.ah=gu,i.ai=$n,i.aj=_r,i.ak=class{constructor(c){this.specification=c}possiblyEvaluate(c,n){return function([s,u]){const _=Za([1,s,u]);return{x:_.x,y:_.y,z:_.z}}(c.expression.evaluate(n))}interpolate(c,n,s){return{x:Mn(c.x,n.x,s),y:Mn(c.y,n.y,s),z:Mn(c.z,n.z,s)}}},i.al=function(c,n,s=0,u=!0){const _=new Pt(s,s),d=c.sub(_),v=n.add(_),E=[d,new Pt(v.x,d.y),v,new Pt(d.x,v.y)];return u&&E.push(d.clone()),E},i.am=function(c,n){const s=[];for(let u=0;u<c.length;u++){const _=is(u-1,-1,c.length-1),d=is(u+1,-1,c.length-1),v=c[u],E=c[d],O=c[_].sub(v).unit(),z=E.sub(v).unit(),S=z.angleWithSep(O.x,O.y),P=O.add(z).unit().mult(-1*n/Math.sin(S/2));s.push(v.add(P))}return s},i.an=SI,i.ao=$e,i.ap=function(c,n,s=0){return Ne.vec3.fromValues(((n.x-s)*c.scale-c.x)*Kt,(n.y*c.scale-c.y)*Kt,ml(n.z,n.y))},i.aq=Ln,i.ar=Jy,i.as=function(c){let n=1/0,s=1/0,u=-1/0,_=-1/0;for(const d of c)n=Math.min(n,d.x),s=Math.min(s,d.y),u=Math.max(u,d.x),_=Math.max(_,d.y);return{min:new Pt(n,s),max:new Pt(u,_)}},i.at=Xs,i.au=De,i.av=x,i.aw=Bn,i.ax=Na,i.ay=function(c,n){const s={};for(let u=0;u<n.length;u++){const _=n[u];_ in c&&(s[_]=c[_])}return s},i.az=Xl,i.b=function(c){return vi.API_FONTS_REGEX.test(c)},i.b$=Tx,i.b0=os,i.b1=Od,i.b2=P_,i.b3=$,i.b4=cl,i.b5=Hl,i.b6=bn,i.b7=ci,i.b8=n0,i.b9=C3,i.bA=X2,i.bB=b3,i.bC=vI,i.bD=xt,i.bE=Q3,i.bF=is,i.bG=nl,i.bH=Fa,i.bI=function(c,n,s){c[4*n+0]=s[0],c[4*n+1]=s[1],c[4*n+2]=s[2],c[4*n+3]=s[3]},i.bJ=md,i.bK=Zo,i.bL=$c,i.bM=pi,i.bN=ju,i.bO=pr,i.bP=MI,i.bQ=At,i.bR=mr,i.bS=HI,i.bT=It,i.bU=Ci,i.bV=function(c,n,s,u,_,d,v,E,O){if(O.name==="globe")return Ci(c,n,new It(s,u,_),!1);const z=uv({z:s,x:u,y:_},O);return new sn([(d+z.x/z.scale)*n,n*(z.y/z.scale),v],[(d+z.x2/z.scale)*n,n*(z.y2/z.scale),E])},i.bW=function(c,n,s){let u=0;for(let _=0;_<2;++_)c[_]>0&&(u+=(c[_]-0)*(c[_]-0)),n[_]<0&&(u+=(0-n[_])*(0-n[_]));return u},i.bX=Br,i.bY=Wl,i.bZ=function(c){const n=Ne.mat4.identity(new Float64Array(16));Ne.mat4.multiply(n,c.pixelMatrix,c.globeMatrix);const s=[0,Xa,0],u=[0,Ya,0];return Ne.vec3.transformMat4(s,s,n),Ne.vec3.transformMat4(u,u,n),[s[0]>0&&s[0]<=c.width&&s[1]>0&&s[1]<=c.height&&!Ea(c,new pr(c.center.lat,90)),u[0]>0&&u[0]<=c.width&&u[1]>0&&u[1]<=c.height&&!Ea(c,new pr(c.center.lat,-90))]},i.b_=function(c,n){const{scale:s}=c.tileTransform,u=s*Kt/(c.tileSize*Math.pow(2,n.zoom-c.tileID.overscaledZ+c.tileID.canonical.z));return Ne.mat2.scale(new Float32Array(4),n.inverseAdjustmentMatrix,[u,u])},i.ba=function(c,n){const s=ja(n.zoom);if(s===0)return Kr(c);const u=hr(c),_=Er(u),d=Xs(u.getWest())*n.worldSize,v=Xs(u.getEast())*n.worldSize,E=Ts(u.getNorth())*n.worldSize,O=Ts(u.getSouth())*n.worldSize,z=[d,E,0],S=[v,E,0],P=[d,O,0],L=[v,O,0],M=Ne.mat4.invert([],n.globeMatrix);return Ne.vec3.transformMat4(z,z,M),Ne.vec3.transformMat4(S,S,M),Ne.vec3.transformMat4(P,P,M),Ne.vec3.transformMat4(L,L,M),_[0]=hi(_[0],P,s),_[1]=hi(_[1],L,s),_[2]=hi(_[2],S,s),_[3]=hi(_[3],z,s),sn.fromPoints(_)},i.bb=xi,i.bc=Tr,i.bd=hi,i.be=ku,i.bf=Sn,i.bg=W3,i.bh=g,i.bi=ii,i.bj=function(c){const n=[];for(const s in c)n.push(c[s]);return n},i.bk=function(c,n){const s=[];for(const u in c)u in n||s.push(u);return s},i.bl=Tl,i.bm=["type","source","source-layer","minzoom","maxzoom","filter","layout"],i.bn=Pr,i.bo=function(c,n){const{x:s,y:u}=c.point,_=ro(s,u,c.worldSize/c._pixelsPerMercatorPixel,0,0);return Ne.mat4.multiply(_,_,Or(Kr(n)))},i.bp=Id,i.bq=Be,i.br=Pd,i.bs=function(c,n,s,u,_){const d=5*n+2;c.float32[d+0]=s,c.float32[d+1]=u,c.float32[d+2]=_},i.bt=yx,i.bu=hI,i.bv=se,i.bw=Ua,i.bx=z_,i.by=YI,i.bz=Uy,i.c=If,i.c$=(c,n,s,u,_,d,v,E)=>{const O=c.transform,z=O.pitch<15?Qy(.07,.7,Bn((14-O.zoom)/5,0,1)):.07,S=s.paint.get("line-trim-color-use-theme").constantOr("default")==="none";return{u_matrix:ev(c,n,s,u),u_texsize:n.imageAtlasTexture?n.imageAtlasTexture.size:[0,0],u_pixels_to_tile_units:O.calculatePixelsToTileUnitsMatrix(n),u_device_pixel_ratio:_,u_width_scale:d,u_floor_width_scale:v,u_image:0,u_tile_units_to_pixels:$_(n,O),u_units_to_pixels:[1/O.pixelsToGLUnits[0],1/O.pixelsToGLUnits[1]],u_alpha_discard_threshold:0,u_trim_offset:E,u_trim_fade_range:s.paint.get("line-trim-fade-range"),u_trim_color:s.paint.get("line-trim-color").toRenderColor(S?null:s.lut).toArray01(),u_emissive_strength:s.paint.get("line-emissive-strength"),u_zbias_factor:z,u_tile_to_meter:r(n.tileID.canonical,0)}},i.c0=GI,i.c1=function(c){const n=GI(c,!0);return Ne.mat2.invert([],[n[0],n[1],n[4],n[5]])},i.c2=kn,i.c3=function(c){const{x:n,y:s}=c.point,{lng:u,lat:_}=c._center;return ro(n,s,c.worldSize,u,_)},i.c4=si,i.c5=Wt,i.c6=Xo,i.c7=function(c){const n=Math.round((c+45+360)%360/90)%4;return ha[n]},i.c8=45,i.c9=_d,i.cA=class extends ws{constructor(c){super(c),this.current=Fp}set(c,n,s){if(this.fetchUniformLocation(c,n)){for(let u=0;u<9;u++)if(s[u]!==this.current[u]){this.current=s,this.gl.uniformMatrix3fv(this.location,!1,s);break}}}},i.cB=Pa,i.cC=function(c,n,s){const u=ja(s.zoom),_=c.style.map._antialias,d=c.terrain&&c.terrain.exaggeration()>0;return u===0&&!_&&!d},i.cD=function(c){const n=c.pixelsPerMeter,s=n/Fa(1,c.center.lat),u=Ne.mat4.identity(new Float64Array(16));return Ne.mat4.translate(u,u,[c.point.x,c.point.y,0]),Ne.mat4.scale(u,u,[s,s,n]),Float32Array.from(u)},i.cE=hr,i.cF=function(c){const n=Br-5;c=Bn(c,-80.051129,n)/n*90;const s=Math.pow(Math.abs(Math.sin($n(c))),3);return Math.round(s*(Xh.length-1))},i.cG=function(c,n,s,u){const _=n.getNorth(),d=n.getSouth(),v=n.getWest(),E=n.getEast(),O=1<<c.z,z=E-v,S=_-d,P=z/qc,L=-S/Xh[s],M=[0,P,0,L,0,0,_,v,0];if(c.z>0){const R=180/u;Ne.mat3.multiply(M,M,[R/z+1,0,0,0,R/S+1,0,-.5*R/P,.5*R/L,1])}return M[2]=O,M[5]=c.x,M[8]=c.y,M},i.cH=Kr,i.cI=function(c,n,s){const u=Ne.mat4.identity(new Float64Array(16)),_=(n/(1<<c)-.5)*Math.PI*2;return Ne.mat4.rotateY(u,s.globeMatrix,_),Float32Array.from(u)},i.cJ=class{isDataAvailableAtPoint(c){const n=this._source();if(this.isUsingMockSource()||!n||c.y<0||c.y>1)return!1;const s=n.getSource().maxzoom,u=1<<s,_=Math.floor(c.x),d=Math.floor((c.x-_)*u),v=Math.floor(c.y*u),E=this.findDEMTileFor(new zt(s,_,s,d,v));return!(!E||!E.dem)}getAtPointOrZero(c,n=0){return this.getAtPoint(c,n)||0}getAtPoint(c,n,s=!0){if(this.isUsingMockSource())return null;n==null&&(n=null);const u=this._source();if(!u||c.y<0||c.y>1)return n;const _=u.getSource().maxzoom,d=1<<_,v=Math.floor(c.x),E=c.x-v,O=new zt(_,v,_,Math.floor(E*d),Math.floor(c.y*d)),z=this.findDEMTileFor(O);if(!z||!z.dem)return n;const S=z.dem,P=1<<z.tileID.canonical.z,L=(E*P-z.tileID.canonical.x)*S.dim,M=(c.y*P-z.tileID.canonical.y)*S.dim,R=Math.floor(L),B=Math.floor(M);return(s?this.exaggeration():1)*Mn(Mn(S.get(R,B),S.get(R,B+1),M-B),Mn(S.get(R+1,B),S.get(R+1,B+1),M-B),L-R)}getAtTileOffset(c,n,s){const u=1<<c.canonical.z;return this.getAtPointOrZero(new l(c.wrap+(c.canonical.x+n/Kt)/u,(c.canonical.y+s/Kt)/u))}getAtTileOffsetFunc(c,n,s,u){return _=>{const d=this.getAtTileOffset(c,_.x,_.y),v=u.upVector(c.canonical,_.x,_.y),E=u.upVectorScale(c.canonical,n,s).metersToTile;return Ne.vec3.scale(v,v,d*E),v}}getForTilePoints(c,n,s,u){if(this.isUsingMockSource())return!1;const _=eg.create(this,c,u);return!!_&&(n.forEach(d=>{d[2]=this.exaggeration()*_.getElevationAt(d[0],d[1],s)}),!0)}getMinMaxForTile(c){if(this.isUsingMockSource())return null;const n=this.findDEMTileFor(c);if(!n||!n.dem)return null;const s=n.dem.tree,u=n.tileID,_=1<<c.canonical.z-u.canonical.z;let d=c.canonical.x/_-u.canonical.x,v=c.canonical.y/_-u.canonical.y,E=0;for(let O=0;O<c.canonical.z-u.canonical.z&&!s.leaves[E];O++){d*=2,v*=2;const z=2*Math.floor(v)+Math.floor(d);E=s.childOffsets[E]+z,d%=1,v%=1}return{min:this.exaggeration()*s.minimums[E],max:this.exaggeration()*s.maximums[E]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(c,n,s){throw new Error("Pure virtual method called.")}pointCoordinate(c){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(c){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}getMinMaxForVisibleTiles(){const c=this.visibleDemTiles;if(c.length===0)return null;let n=!1,s=Number.MAX_VALUE,u=Number.MIN_VALUE;for(const _ of c){const d=this.getMinMaxForTile(_.tileID);d&&(s=Math.min(s,d.min),u=Math.max(u,d.max),n=!0)}return n?{min:s,max:u}:null}},i.cK=Ry,i.cL=Pn,i.cM=function(c,n){return[Math.pow(c[0],2.2)*n,Math.pow(c[1],2.2)*n,Math.pow(c[2],2.2)*n]},i.cN=Io,i.cO=dh,i.cP=Of,i.cQ=256,i.cR=function(c,n){const s=[0,0,0],u=xi(Kr(n.canonical));return Ne.vec3.transformMat4(s,s,u),Ne.vec3.transformMat4(s,s,c),s},i.cS=c=>({u_camera_to_center_distance:new pi(c),u_extrude_scale:new Zl(c),u_device_pixel_ratio:new pi(c),u_matrix:new md(c),u_inv_rot_matrix:new md(c),u_merc_center:new Zo(c),u_tile_id:new $c(c),u_zoom_transition:new pi(c),u_up_dir:new $c(c),u_emissive_strength:new pi(c)}),i.cT=c=>({u_matrix:new md(c),u_pixels_to_tile_units:new Zl(c),u_device_pixel_ratio:new pi(c),u_width_scale:new pi(c),u_floor_width_scale:new pi(c),u_units_to_pixels:new Zo(c),u_dash_image:new ju(c),u_gradient_image:new ju(c),u_image_height:new pi(c),u_texsize:new Zo(c),u_tile_units_to_pixels:new pi(c),u_alpha_discard_threshold:new pi(c),u_trim_offset:new Zo(c),u_trim_fade_range:new Zo(c),u_trim_color:new Zh(c),u_emissive_strength:new pi(c),u_zbias_factor:new pi(c),u_tile_to_meter:new pi(c)}),i.cU=c=>({u_matrix:new md(c),u_texsize:new Zo(c),u_pixels_to_tile_units:new Zl(c),u_device_pixel_ratio:new pi(c),u_width_scale:new pi(c),u_floor_width_scale:new pi(c),u_image:new ju(c),u_units_to_pixels:new Zo(c),u_tile_units_to_pixels:new pi(c),u_alpha_discard_threshold:new pi(c),u_trim_offset:new Zo(c),u_trim_fade_range:new Zo(c),u_trim_color:new Zh(c),u_emissive_strength:new pi(c),u_zbias_factor:new pi(c),u_tile_to_meter:new pi(c)}),i.cV=cd,i.cW=_3,i.cX=g3,i.cY=Hc,i.cZ=(c,n,s,u,_,d)=>{const v=c.transform,E=v.projection.name==="globe";let O;if(d.paint.get("circle-pitch-alignment")==="map")if(E){const S=Io(v.zoom,n.canonical)*v._pixelsPerMercatorPixel;O=Float32Array.from([S,0,0,S])}else O=v.calculatePixelsToTileUnitsMatrix(s);else O=new Float32Array([v.pixelsToGLUnits[0],0,0,v.pixelsToGLUnits[1]]);const z={u_camera_to_center_distance:c.transform.getCameraToCenterDistance(v.projection),u_matrix:c.translatePosMatrix(n.projMatrix,s,d.paint.get("circle-translate"),d.paint.get("circle-translate-anchor")),u_device_pixel_ratio:Le.devicePixelRatio,u_extrude_scale:O,u_inv_rot_matrix:Yl,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0],u_emissive_strength:d.paint.get("circle-emissive-strength")};if(E){z.u_inv_rot_matrix=u,z.u_merc_center=_,z.u_tile_id=[n.canonical.x,n.canonical.y,1<<n.canonical.z],z.u_zoom_transition=ja(v.zoom);const S=_[0]*Kt,P=_[1]*Kt;z.u_up_dir=v.projection.upVector(new It(0,0,0),S,P)}return z},i.c_=m0,i.ca=Zh,i.cb=function(c,n,s){const u=Math.sqrt(c*c+n*n+s*s),_=u>0?Math.acos(s/u)*zi:0;let d=c!==0||n!==0?Math.atan2(-n,-c)*zi+90:0;return d<0&&(d+=360),[u,d,_]},i.cc=r,i.cd=sn,i.ce=Za,i.cf=function(c){return[Math.pow(c[0],1/2.2),Math.pow(c[1],1/2.2),Math.pow(c[2],1/2.2)]},i.cg=function(c,n){return c.readFields(hG,{icons:[]},n)},i.ch=function(c){return c({pluginStatus:po,pluginURL:ql}),Rc.on("pluginStateChange",c),c},i.ci=Ox,i.cj=Y_,i.ck=v3,i.cl=Uo,i.cm=Um,i.cn=We,i.co=ls,i.cp=ra,i.cq=function(c){const n=c.indexOf(ad);return n>=0?c.slice(0,n):c},i.cr=function(c){return c.indexOf(ad)>=0},i.cs=function(c){const n=c.indexOf(ad);return n>=0?c.slice(n+1):""},i.ct=function(c){const n=[],s=c.id;return s===void 0&&n.push({message:`layers.${s}: missing required property "id"`}),c.render===void 0&&n.push({message:`layers.${s}: missing required method "render"`}),c.renderingMode&&c.renderingMode!=="2d"&&c.renderingMode!=="3d"&&n.push({message:`layers.${s}: property "renderingMode" must be either "2d" or "3d"`}),n},i.cu=function(c,n,s,u){return c.type==="custom"?new Kq(c,n):new lG[c.type](c,n,s,u)},i.cv=fh,i.cw=class extends sg{constructor(c,n){super(c._vectorTileFeature,c._z,c._x,c._y,c.id),c.state&&(this.state=Object.assign({},c.state)),this.target=n.target,this.namespace=n.namespace,n.properties&&(this.properties=n.properties),this.target&&("featuresetId"in this.target&&!this.target.importId||"layerId"in this.target)&&(this.source=c.source,this.sourceLayer=c.sourceLayer,this.layer=c.layer)}toJSON(){const c=super.toJSON();return c.target=this.target,c.namespace=this.namespace,c}},i.cx=Rc,i.cy=Ai,i.cz=fl,i.d=function(c){return vi.API_TILEJSON_REGEX.test(c)},i.d$=YR,i.d0=(c,n,s,u,_,d,v,E,O)=>{const z=c.transform,S=z.calculatePixelsToTileUnitsMatrix(n),P=s.paint.get("line-trim-color-use-theme").constantOr("default")==="none",L=z.pitch<15?Qy(.07,.7,Bn((14-z.zoom)/5,0,1)):.07;return{u_matrix:ev(c,n,s,u),u_pixels_to_tile_units:S,u_device_pixel_ratio:d,u_width_scale:v,u_floor_width_scale:E,u_units_to_pixels:[1/z.pixelsToGLUnits[0],1/z.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:_,u_texsize:ax(s)&&n.lineAtlasTexture?n.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:$_(n,c.transform),u_alpha_discard_threshold:0,u_trim_offset:O,u_trim_fade_range:s.paint.get("line-trim-fade-range"),u_trim_color:s.paint.get("line-trim-color").toRenderColor(P?null:s.lut).toArray01(),u_emissive_strength:s.paint.get("line-emissive-strength"),u_zbias_factor:L,u_tile_to_meter:r(n.tileID.canonical,0)}},i.d1=uh,i.d2=vd,i.d3=Cd,i.d4=on,i.d5=j_,i.d6=Ka,i.d7=450,i.d8=7,i.d9=Yq,i.dA=Rs,i.dB=p,i.dC=Gc,i.dD=function([c,n,s]){const u=Math.hypot(c,n,s),_=Math.atan2(c,s),d=.5*Math.PI-Math.acos(-n/u);return new pr(si(_),si(d))},i.dE=R3,i.dF=function(c){const n=c.navigator?c.navigator.userAgent:null;return!!function(s){if(Al==null){const u=s.navigator?s.navigator.userAgent:null;Al=!!s.safari||!(!u||!(/\b(iPad|iPhone|iPod)\b/.test(u)||u.match("Safari")&&!u.match("Chrome")))}return Al}(c)&&n&&(n.match("Version/15.4")||n.match("Version/15.5")||n.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},i.dG=function(c,n){Ye=c,ct=n},i.dH=Ea,i.dI=Ko,i.dJ=function(c){const n=[0,0,0],s=Ne.mat4.identity(new Float64Array(16));return Ne.mat4.multiply(s,c.pixelMatrix,c.globeMatrix),Ne.vec3.transformMat4(n,n,s),new Pt(n[0],n[1])},i.dK=function(c,n,s=!1){if(po===ed||po===Di||po===td)throw new Error("setRTLTextPlugin cannot be called multiple times.");ql=Le.resolveURL(c),po=ed,gs=n,nd(),s||Ba()},i.dL=Bh,i.dM=function(){Ox().acquire(N3)},i.dN=function(){const c=yv;c&&(c.isPreloaded()&&c.numActive()===1?(c.release(N3),yv=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},i.dO=w0,i.dP=function(c){const n=Zt();if(!n)return;const s=n.delete(it);c&&s.catch(c).then(()=>c())},i.dQ=gv,i.dR=FR,i.dS=function(c){X3=Le.resolveURL(c),og||(og=new tg(Ox(),new Pl)),og.broadcast("setDracoUrl",X3)},i.dT=jR,i.dU=function(c){ag=Le.resolveURL(c),og||(og=new tg(Ox(),new Pl)),og.broadcast("setMeshoptUrl",ag)},i.dV=hn,i.dW=qu,i.dX=Zu,i.dY=Td,i.dZ=class{constructor(c,n){this.pos=c,this.dir=n}intersectsPlane(c,n,s){const u=Ne.vec2.dot(n,this.dir);if(Math.abs(u)<1e-6)return!1;const _=((c[0]-this.pos[0])*n[0]+(c[1]-this.pos[1])*n[1])/u;return s[0]=this.pos[0]+this.dir[0]*_,s[1]=this.pos[1]+this.dir[1]*_,!0}},i.d_=XR,i.da=br,i.db=Lp,i.dc=256,i.dd=Or,i.de=ul,i.df=mo,i.dg=hl,i.dh=function(c,n,s,u,_){return Bn((c-n)/(s-n)*(_-u)+u,u,_)},i.di=Mc,i.dj=$u,i.dk=class{constructor(c,n,s,u){this.context=c,this.format=u,this.size=s,this.texture=c.gl.createTexture();const[_,d,v]=this.size,{gl:E}=c;E.bindTexture(E.TEXTURE_3D,this.texture),c.pixelStoreUnpackFlipY.set(!1),c.pixelStoreUnpack.set(1),c.pixelStoreUnpackPremultiplyAlpha.set(!1),E.texImage3D(E.TEXTURE_3D,0,this.format,_,d,v,0,M3(this.format),O3(this.format),n.data)}bind(c,n){const{context:s}=this,{gl:u}=s;u.bindTexture(u.TEXTURE_3D,this.texture),c!==this.minFilter&&(u.texParameteri(u.TEXTURE_3D,u.TEXTURE_MAG_FILTER,c),u.texParameteri(u.TEXTURE_3D,u.TEXTURE_MIN_FILTER,c),this.minFilter=c),n!==this.wrapS&&(u.texParameteri(u.TEXTURE_3D,u.TEXTURE_WRAP_S,n),u.texParameteri(u.TEXTURE_3D,u.TEXTURE_WRAP_T,n),this.wrapS=n)}destroy(){const{gl:c}=this.context;c.deleteTexture(this.texture),this.texture=null}},i.dl=D3,i.dm=[1,1,1],i.dn=eg,i.dp=Q_,i.dq=jc,i.dr=zu,i.ds=Ws,i.dt=$h,i.du=bs,i.dv=class{constructor(){this._updateTime=0,this._sourceIds=[],this._activeRegions=[],this._prevRegions=[],this._globalClipBounds={min:new Pt(1/0,1/0),max:new Pt(-1/0,-1/0)}}clear(){this._activeRegions.length>0&&++this._updateTime,this._activeRegions=[],this._prevRegions=[]}get updateTime(){return this._updateTime}getReplacementRegionsForTile(c,n=!1){const s=N_(new Pt(0,0),new Pt(Kt,Kt),c),u=[];if(n&&!B_(s,this._globalClipBounds))return u;for(const _ of this._activeRegions){if(_.hiddenByOverlap||!B_(s,_))continue;const d=a3(_.min,_.max,c);u.push({min:d.min,max:d.max,sourceId:this._sourceIds[_.priority],footprint:_.footprint,footprintTileId:_.tileId,order:_.order,clipMask:_.clipMask,clipScope:_.clipScope})}return u}setSources(c){this._setSources(c.map(n=>({getSourceId:()=>n.cache.id,getFootprints:()=>{const s=[];for(const u of n.cache.getVisibleCoordinates()){const _=n.cache.getTile(u).buckets[n.layer];_&&_.updateFootprints(u.toUnwrapped(),s)}return s},getOrder:()=>n.order,getClipMask:()=>n.clipMask,getClipScope:()=>n.clipScope})))}_addSource(c){const n=c.getFootprints();if(n.length===0)return;const s=c.getOrder(),u=c.getClipMask(),_=c.getClipScope();for(const d of n){if(!d.footprint)continue;const v=N_(d.footprint.min,d.footprint.max,d.id);this._activeRegions.push({min:v.min,max:v.max,hiddenByOverlap:!1,priority:this._sourceIds.length,tileId:d.id,footprint:d.footprint,order:s,clipMask:u,clipScope:_})}this._sourceIds.push(c.getSourceId())}_computeReplacement(){this._activeRegions.sort((n,s)=>n.priority-s.priority||Ed(n.min,s.min)||Ed(n.max,s.max)||n.order-s.order||n.clipMask-s.clipMask||function(u,_){const d=(v,E)=>v+E;return u.length-_.length||u.reduce(d,"").localeCompare(_.reduce(d,""))}(n.clipScope,s.clipScope));let c=this._activeRegions.length!==this._prevRegions.length;if(!c){let n=0;for(;!c&&n!==this._activeRegions.length;){const s=this._activeRegions[n],u=this._prevRegions[n];c=s.priority!==u.priority||!Fy(s,u)||s.order!==u.order||s.clipMask!==u.clipMask||!Pr(s.clipScope,u.clipScope),++n}}if(c){++this._updateTime;for(const s of this._activeRegions)s.order!==Zp&&(this._globalClipBounds.min.x=Math.min(this._globalClipBounds.min.x,s.min.x),this._globalClipBounds.min.y=Math.min(this._globalClipBounds.min.y,s.min.y),this._globalClipBounds.max.x=Math.max(this._globalClipBounds.max.x,s.max.x),this._globalClipBounds.max.y=Math.max(this._globalClipBounds.max.y,s.max.y));const n=s=>{const u=this._activeRegions;if(s>=u.length)return s;const _=u[s].priority;for(;s<u.length&&u[s].priority===_;)++s;return s};if(this._sourceIds.length>1){let s=0,u=n(s);for(;s!==u;){let _=s;const d=s;for(;_!==u;){const v=this._activeRegions[_];v.hiddenByOverlap=!1;for(let E=0;E<d;E++){const O=this._activeRegions[E];if(!O.hiddenByOverlap&&v.order===Zp&&B_(v,O)&&(v.hiddenByOverlap=W2(v.footprint,v.tileId,O.footprint,O.tileId),v.hiddenByOverlap))break}++_}s=u,u=n(s)}}}}_setSources(c){[this._prevRegions,this._activeRegions]=[this._activeRegions,[]],this._sourceIds=[];for(let n=c.length-1;n>=0;n--)this._addSource(c[n]);this._computeReplacement()}},i.dw=class{constructor(c){this._createGrid(c),this._createPoles(c)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const c of this._poleSegments)c.destroy();for(const c of this._gridSegments)c.withSkirts.destroy(),c.withoutSkirts.destroy()}_fillGridMeshWithLods(c,n){const s=new cl,u=new sa,_=[],d=c+1+2,v=n[0]+1,E=n[0]+1+(1+n.length),O=(z,S,P)=>{let L=z===d-1?z-2:z===0?z:z-1;return L+=P?24575:0,[L,S]};for(let z=0;z<d;++z)s.emplaceBack(...O(z,0,!0));for(let z=0;z<v;++z)for(let S=0;S<d;++S)s.emplaceBack(...O(S,z,(S===0||S===d-1)&&!0));for(let z=0;z<n.length;++z){const S=n[z];for(let P=0;P<d;++P)s.emplaceBack(...O(P,S,!0))}for(let z=0;z<n.length;++z){const S=u.length,P=n[z]+1+2,L=new sa;for(let B=0;B<P-1;B++){const q=B===P-2,H=q?d*(E-n.length+z-B):d;for(let ne=0;ne<d-1;ne++){const re=B*d+ne;B===0||q||ne===0||ne===d-2?(L.emplaceBack(re+1,re,re+H),L.emplaceBack(re+H,re+H+1,re+1)):(u.emplaceBack(re+1,re,re+H),u.emplaceBack(re+H,re+H+1,re+1))}}const M=ci.simpleSegment(0,S,s.length,u.length-S);for(let B=0;B<L.uint16.length;B+=3)u.emplaceBack(L.uint16[B],L.uint16[B+1],L.uint16[B+2]);const R=ci.simpleSegment(0,S,s.length,u.length-S);_.push({withoutSkirts:M,withSkirts:R})}return{vertices:s,indices:u,segments:_}}_createGrid(c){const n=this._fillGridMeshWithLods(qc,Xh);this._gridSegments=n.segments,this._gridBuffer=c.createVertexBuffer(n.vertices,bn.members),this._gridIndexBuffer=c.createIndexBuffer(n.indices,!0)}_createPoles(c){const n=new sa;for(let v=0;v<=qc;v++)n.emplaceBack(0,v+1,v+2);this._poleIndexBuffer=c.createIndexBuffer(n,!0);const s=new mo,u=new mo,_=new mo,d=new mo;this._poleSegments=[];for(let v=0,E=0;v<Xo;v++){const O=360/(1<<v);s.emplaceBack(0,-Na,0,.5,0),u.emplaceBack(0,-Na,0,.5,1),_.emplaceBack(0,-Na,0,.5,.5),d.emplaceBack(0,-Na,0,.5,.5);for(let z=0;z<=qc;z++){let S=z/qc,P=0;const L=Mn(0,O,S),[M,R,B]=Uu(Jo,Ro,L,Na);s.emplaceBack(M,R,B,S,P),u.emplaceBack(M,R,B,S,1-P);const q=$n(L);S=.5+.5*Math.sin(q),P=.5+.5*Math.cos(q),_.emplaceBack(M,R,B,S,P),d.emplaceBack(M,R,B,S,1-P)}this._poleSegments.push(ci.simpleSegment(E,0,66,64)),E+=66}this._poleNorthVertexBuffer=c.createVertexBuffer(s,En,!1),this._poleSouthVertexBuffer=c.createVertexBuffer(u,En,!1),this._texturedPoleNorthVertexBuffer=c.createVertexBuffer(_,En,!1),this._texturedPoleSouthVertexBuffer=c.createVertexBuffer(d,En,!1)}getGridBuffers(c,n){return[this._gridBuffer,this._gridIndexBuffer,n?this._gridSegments[c].withSkirts:this._gridSegments[c].withoutSkirts]}getPoleBuffers(c,n){return[n?this._texturedPoleNorthVertexBuffer:this._poleNorthVertexBuffer,n?this._texturedPoleSouthVertexBuffer:this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[c]]}},i.dx=Zp,i.dy=co,i.dz=function(){return!!document.fullscreenElement||!!document.webkitFullscreenElement},i.e=vi,i.e0=p0,i.e1=Ia,i.e2=Bs,i.e3=dI,i.e4=function(c,n,s,u,_,d,v,E,O,z,S=1,P,L){c.createArrays(),c.tilePixelRatio=Kt/(512*c.overscaling),c.compareText={},c.iconsNeedLinear=!1;const M=c.layers[0].layout,R=c.layers[0]._unevaluatedLayout._values,B={};B.scaleFactor=S,B.textSizeScaleRange=M.get("text-size-scale-range"),B.iconSizeScaleRange=M.get("icon-size-scale-range");const[q,H]=B.textSizeScaleRange,[ne,re]=B.iconSizeScaleRange;if(B.textScaleFactor=Bn(B.scaleFactor,q,H),B.iconScaleFactor=Bn(B.scaleFactor,ne,re),c.textSizeData.kind==="composite"){const{minZoom:_e,maxZoom:Ce}=c.textSizeData;B.compositeTextSizes=[R["text-size"].possiblyEvaluate(new zr(_e),E),R["text-size"].possiblyEvaluate(new zr(Ce),E)]}if(c.iconSizeData.kind==="composite"){const{minZoom:_e,maxZoom:Ce}=c.iconSizeData;B.compositeIconSizes=[R["icon-size"].possiblyEvaluate(new zr(_e),E),R["icon-size"].possiblyEvaluate(new zr(Ce),E)]}B.layoutTextSize=R["text-size"].possiblyEvaluate(new zr(O+1),E),B.layoutIconSize=R["icon-size"].possiblyEvaluate(new zr(O+1),E),B.textMaxSize=R["text-size"].possiblyEvaluate(new zr(18),E);const K=M.get("text-rotation-alignment")==="map"&&M.get("symbol-placement")!=="point",ie=M.get("text-size");let ce=!1;for(const _e of c.features)if(_e.icon&&_e.icon.nameSecondary){ce=!0;break}for(const _e of c.features){const Ce=M.get("text-font").evaluate(_e,{},E).join(","),Ae=ie.evaluate(_e,{},E)*B.textScaleFactor,Ee=B.layoutTextSize.evaluate(_e,{},E)*B.textScaleFactor,Ue=(B.layoutIconSize.evaluate(_e,{},E),{horizontal:{},vertical:void 0}),Oe=_e.text;let Ve,Ze=[0,0];if(Oe){const Qe=Oe.toString(),at=M.get("text-letter-spacing").evaluate(_e,{},E)*Ua,Je=M.get("text-line-height").evaluate(_e,{},E)*Ua,wt=oa(Qe)?at:0,Rt=M.get("text-anchor").evaluate(_e,{},E),bt=M.get("text-variable-anchor");if(!bt){const vn=M.get("text-radial-offset").evaluate(_e,{},E);Ze=vn?vI(Rt,[vn*Ua,x3]):M.get("text-offset").evaluate(_e,{},E).map(ln=>ln*Ua)}let an=K?"center":M.get("text-justify").evaluate(_e,{},E);const Jt=M.get("symbol-placement")==="point",Ut=Jt?M.get("text-max-width").evaluate(_e,{},E)*Ua:1/0,kt=vn=>{c.allowVerticalPlacement&&ti(Qe)&&(Ue.vertical=en(Oe,n,s,_,Ce,Ut,Je,Rt,vn,wt,Ze,Be.vertical,!0,Ee,Ae))};if(!K&&bt){const vn=an==="auto"?bt.map(pn=>b3(pn)):[an];let ln=!1;for(let pn=0;pn<vn.length;pn++){const zn=vn[pn];if(!Ue.horizontal[zn])if(ln)Ue.horizontal[zn]=Ue.horizontal[0];else{const Gn=en(Oe,n,s,_,Ce,Ut,Je,"center",zn,wt,Ze,Be.horizontal,!1,Ee,Ae);Gn&&(Ue.horizontal[zn]=Gn,ln=Gn.positionedLines.length===1)}}kt("left")}else{if(an==="auto"&&(an=b3(Rt)),Jt||M.get("text-writing-mode").indexOf("horizontal")>=0||!ti(Qe)){const vn=en(Oe,n,s,_,Ce,Ut,Je,Rt,an,wt,Ze,Be.horizontal,!1,Ee,Ae);vn&&(Ue.horizontal[an]=vn)}kt(Jt?"left":an)}}let qe=!1;if(_e.icon&&_e.icon.namePrimary){const Qe=iv(c.iconSizeData,R["icon-size"],E,c.zoom,_e)*B.iconScaleFactor*P,at=_e.icon.getPrimary().scaleSelf(Qe).serialize(),Je=u[at];Je&&(Ve=un(_[at],_e.icon.nameSecondary?_[_e.icon.getSecondary().scaleSelf(Qe).serialize()]:void 0,M.get("icon-offset").evaluate(_e,{},E),M.get("icon-anchor").evaluate(_e,{},E)),qe=Je.sdf,c.sdfIcons===void 0?c.sdfIcons=Je.sdf:c.sdfIcons!==Je.sdf&&qn("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Je.pixelRatio!==c.pixelRatio||M.get("icon-rotate").constantOr(1)!==0)&&(c.iconsNeedLinear=!0))}const Ke=bI(Ue.horizontal)||Ue.vertical;c.iconsInText||(c.iconsInText=!!Ke&&Ke.iconsInText),(Ke||Ve)&&Bq(c,_e,Ue,Ve,u,B,Ee,0,Ze,qe,v,E,z,L,ce)}d&&c.generateCollisionDebugBuffers(O,c.collisionBoxArray,B.textScaleFactor)},i.e5=kx,i.e6=Dr,i.e7=Ny,i.e8=f,i.e9=C,i.ea=function(c){let n=0;if(new Uint32Array(c,0,1)[0]!==VR){const s=new Uint32Array(c,0,7),[,,u,_,d,v]=s;n=s.byteLength+_+d+v+d,(u!==c.byteLength||n>=c.byteLength)&&qn("Invalid b3dm header information.")}return HR(c,n)},i.eb=function(c,n){const s=WR(c);for(const u of s){for(const _ of u.meshes)fH(_);u.lights&&(u.lightMeshIndex=u.meshes.length,u.meshes.push(dH(u.lights,n)))}return s},i.ec=Mx,i.ed=lR,i.ee=Yr,i.ef=function(c){Xt(),ut!=null&&ut.then(n=>{n.keys().then(s=>{for(let u=0;u<s.length-c;u++)n.delete(s[u])})})},i.f=function(c){return c.indexOf("mapbox:")===0},i.g=function(c,n){return Ai(fa(c,{method:"GET"}),n)},i.h=Pf,i.i=function(c){return vi.API_STYLE_REGEX.test(c)&&!If(c)},i.j=function(c){return decodeURIComponent(atob(c).split("").map(n=>"%"+("00"+n.charCodeAt(0).toString(16)).slice(-2)).join(""))},i.k=function(c){return btoa(encodeURIComponent(c).replace(/%([0-9A-F]{2})/g,(n,s)=>String.fromCharCode(+("0x"+s))))},i.l=fa,i.m=Cn,i.n=function(c,n){return Ai(fa(c,{type:"json"}),n)},i.o=ap,i.p=function(c,n){return Ai(fa(c,{method:"POST"}),n)},i.q=Le,i.r=Aa,i.s=function(c){try{const n=self[c];return n.setItem("_mapbox_test_",1),n.removeItem("_mapbox_test_"),!0}catch{return!1}},i.t=Se,i.u=function(){return function c(n){return n?(n^Math.random()*(16>>n/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,c)}()},i.v=function(c){return!!c&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(c)},i.w=qn,i.x=function(){return F3||(F3=new w0),F3},i.y=Ml,i.z=ks}),y(["./shared"],function(i){function C(ft){const le=ft?ft.url.toString():void 0;return le?performance.getEntriesByName(le):[]}function I(ft){if(typeof ft=="number"||typeof ft=="boolean"||typeof ft=="string"||ft==null)return JSON.stringify(ft);if(Array.isArray(ft)){let pe="[";for(const Se of ft)pe+=`${I(Se)},`;return`${pe}]`}let le="{";for(const pe of Object.keys(ft).sort())le+=`${pe}:${I(ft[pe])},`;return`${le}}`}function j(ft){let le="";for(const pe of i.bm)(ft.type!=="model"||pe!=="minzoom"&&pe!=="maxzoom")&&(le+=`/${I(ft[pe])}`);return le}class F{constructor(le){this.keyCache={},this._layers={},this._layerConfigs={},le&&this.replace(le)}replace(le,pe){this._layerConfigs={},this._layers={},this.update(le,[],pe)}update(le,pe,Se){this._options=Se;for(const je of le)this._layerConfigs[je.id]=je,(this._layers[je.id]=i.cu(je,this.scope,null,this._options)).compileFilter(Se),this.keyCache[je.id]&&delete this.keyCache[je.id];for(const je of pe)delete this.keyCache[je],delete this._layerConfigs[je],delete this._layers[je];this.familiesBySource={};const Le=function(je,We){const it={};for(let ct=0;ct<je.length;ct++){const lt=je[ct];let ut=We&&We[lt.id];!ut&&(ut=j(lt),lt.type==="line"&&lt.paint)&&function Zt(Xt){return typeof Xt=="string"&&Xt==="line-progress"||(Array.isArray(Xt)?Xt.some(Zt):!(!Xt||typeof Xt!="object")&&Object.values(Xt).some(Zt))}(lt.paint["line-width"])&&(ut+=`/${I(lt.paint["line-width"])}`),We&&(We[lt.id]=ut);let Ct=it[ut];Ct||(Ct=it[ut]=[]),Ct.push(lt)}const Ye=[];for(const ct in it)Ye.push(it[ct]);return Ye}(i.bj(this._layerConfigs),this.keyCache);for(const je of Le){const We=je.map(Ct=>this._layers[Ct.id]),it=We[0];if(it.visibility==="none")continue;const Ye=it.source||"";let ct=this.familiesBySource[Ye];ct||(ct=this.familiesBySource[Ye]={});const lt=it.sourceLayer||"_geojsonTileLayer";let ut=ct[lt];ut||(ut=ct[lt]=[]),ut.push(We)}}}const G=1*i.dX;class X{constructor(le){const pe={},Se=[];for(const it in le){const Ye=le[it],ct=pe[it]={};for(const lt in Ye.glyphs){const ut=Ye.glyphs[+lt];if(!ut||ut.bitmap.width===0||ut.bitmap.height===0)continue;const Ct=ut.metrics.localGlyph?G:1,Zt={x:0,y:0,w:ut.bitmap.width+2*Ct,h:ut.bitmap.height+2*Ct};Se.push(Zt),ct[lt]=Zt}}const{w:Le,h:je}=i.F(Se),We=new i.dW({width:Le||1,height:je||1});for(const it in le){const Ye=le[it];for(const ct in Ye.glyphs){const lt=Ye.glyphs[+ct];if(!lt||lt.bitmap.width===0||lt.bitmap.height===0)continue;const ut=pe[it][ct],Ct=lt.metrics.localGlyph?G:1;i.dW.copy(lt.bitmap,We,{x:0,y:0},{x:ut.x+Ct,y:ut.y+Ct},lt.bitmap)}}this.image=We,this.positions=pe}}i.dV(X,"GlyphAtlas");const Y="3d_elevation_id",J="hd_road_elevation";class ee{constructor(){this._valid=!1}reset(le){return this.feature=le,this._valid=!0,this._geometry=le.loadGeometry(),this._geometry.length!==0&&this._geometry[0].length!==0||(this._valid=!1),this}geometry(le,pe){return this._valid&&le(pe(this._geometry)),this}require(le,pe,Se){return this.get(le,!0,pe,Se)}optional(le,pe,Se){return this.get(le,!1,pe,Se)}success(){return this._valid}get(le,pe,Se,Le){const je=this.feature.properties.hasOwnProperty(le)?+this.feature.properties[le]:void 0;return this._valid&&je!==void 0?Se(Le?Le(je):je):pe&&(this._valid=!1),this}}class oe{constructor(le,pe){this.featureFunc=le,this.vertexFunc=pe}parseFeature(le,pe,Se){return this.featureFunc(le,pe,Se)}parseVertex(le,pe,Se){return this.vertexFunc(le,pe,Se)}}const ge=new oe((ft,le,pe)=>ft.reset(le).require(Y,Se=>{pe.id=Se}).optional("fixed_height_relative",Se=>{pe.constantHeight=Se},xe.decodeRelativeHeight).geometry(Se=>{pe.bounds=Se},xe.computeBounds).success(),(ft,le,pe)=>ft.reset(le).require(Y,Se=>{pe.id=Se}).require("elevation_idx",Se=>{pe.idx=Se}).require("extent",Se=>{pe.extent=Se}).require("height_relative",Se=>{pe.height=Se},xe.decodeRelativeHeight).geometry(Se=>{pe.position=Se},xe.getPoint).success()),fe=new oe((ft,le,pe)=>ft.reset(le).require(Y,Se=>{pe.id=Se}).optional("fixed_height",Se=>{pe.constantHeight=Se},xe.decodeMetricHeight).geometry(Se=>{pe.bounds=Se},xe.computeBounds).success(),(ft,le,pe)=>ft.reset(le).require(Y,Se=>{pe.id=Se}).require("elevation_idx",Se=>{pe.idx=Se}).require("extent",Se=>{pe.extent=Se}).require("height",Se=>{pe.height=Se},xe.decodeMetricHeight).geometry(Se=>{pe.position=Se},xe.getPoint).success());class xe{static computeBounds(le){const pe=new i.P(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),Se=new i.P(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY);for(const Le of le[0])pe.x>Le.x&&(pe.x=Le.x),pe.y>Le.y&&(pe.y=Le.y),Se.x<Le.x&&(Se.x=Le.x),Se.y<Le.y&&(Se.y=Le.y);return{min:pe,max:Se}}static getPoint(le){return i.ab.vec2.fromValues(le[0][0].x,le[0][0].y)}static decodeRelativeHeight(le){return 1e-4*le*5}static decodeMetricHeight(le){return 1e-4*le}static parse(le){const pe=[],Se=[],Le=le.length,je=new ee;for(let it=0;it<Le;it++){const Ye=le.feature(it),ct=Ye.properties.hasOwnProperty("version")?String(Ye.properties.version):void 0,lt=(We=ct)?We==="1.0.1"?fe:void 0:ge;if(lt===void 0){i.w(`Unknown elevation feature version number ${ct||"(unknown)"}`);continue}const ut=Ye.properties.hasOwnProperty("type")?Ye.properties.type:void 0;if(ut){if(i.dY.VectorTileFeature.types[Ye.type]==="Point"&&ut==="curve_point"){const Ct={};lt.parseVertex(je,Ye,Ct)&&pe.push(Ct)}else if(i.dY.VectorTileFeature.types[Ye.type]==="Polygon"&&ut==="curve_meta"){const Ct={};lt.parseFeature(je,Ye,Ct)&&Se.push(Ct)}}}var We;return{vertices:pe,features:Se}}}class ae{constructor(le,pe,Se,Le,je,We){if(this.vertices=new Array,this.vertexProps=new Array,this.edges=new Array,this.edgeProps=new Array,this.id=le,this.heightRange={min:Se,max:Se},this.safeArea=pe,this.constantHeight=Se,this.constantHeight==null&&(this.constantHeight!=null||Le.length!==0)){this.vertices=Le,this.edges=je,this.edges=this.edges.filter(it=>it.a<this.vertices.length&&it.b<this.vertices.length&&!i.ab.vec2.exactEquals(this.vertices[it.a].position,this.vertices[it.b].position)),this.heightRange={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};for(const it of this.vertices)this.vertexProps.push({dir:i.ab.vec2.fromValues(0,0)}),this.heightRange.min=Math.min(this.heightRange.min,it.height),this.heightRange.max=Math.max(this.heightRange.max,it.height);for(const it of this.edges){const Ye=this.vertices[it.a].position,ct=this.vertices[it.b].position,lt=i.ab.vec2.subtract(i.ab.vec2.create(),ct,Ye),ut=i.ab.vec2.length(lt),Ct=i.ab.vec2.scale(i.ab.vec2.create(),lt,1/ut);this.edgeProps.push({vec:lt,dir:Ct,len:ut});const Zt=this.vertexProps[it.a].dir,Xt=this.vertexProps[it.b].dir;i.ab.vec2.add(Zt,Zt,Ct),i.ab.vec2.add(Xt,Xt,Ct)}for(const it of this.vertexProps)it.dir[0]===0&&it.dir[1]===0||i.ab.vec2.normalize(it.dir,it.dir);this.tessellate(We)}}pointElevation(le){if(this.constantHeight!=null)return this.constantHeight;const pe=this.getClosestEdge(le);if(pe==null)return 0;const[Se,Le]=pe;return(1-(je=Le))*this.vertices[this.edges[Se].a].height+je*this.vertices[this.edges[Se].b].height;var je}getClosestEdge(le){if(this.edges.length===0)return;let pe=0,Se=Number.POSITIVE_INFINITY,Le=0;const je=i.ab.vec2.fromValues(le.x,le.y);for(let We=0;We<this.edges.length;We++){const it=this.edges[We],Ye=this.edgeProps[We].dir,ct=new i.dZ(je,this.edgeProps[We].dir),lt=this.vertices[it.a].position,ut=this.vertices[it.b].position,Ct=i.ab.vec2.create(),Zt=i.ab.vec2.create(),Xt=ct.intersectsPlane(lt,this.vertexProps[it.a].dir,Ct),gn=ct.intersectsPlane(ut,this.vertexProps[it.b].dir,Zt);if(!Xt||!gn)continue;const Cn=i.ab.vec2.subtract(i.ab.vec2.create(),Zt,Ct),On=i.ab.vec2.subtract(i.ab.vec2.create(),je,Ct),wn=i.ab.vec2.dot(Cn,Cn),er=wn>0?i.ab.vec2.dot(On,Cn)/wn:0,tr=i.aw(er,0,1),Yn=Math.abs((er-tr)*this.edgeProps[We].len),dr=i.ab.vec2.subtract(i.ab.vec2.create(),je,lt),vr=Yn+Math.abs(i.ab.vec2.dot(dr,i.ab.vec2.fromValues(Ye[1],-Ye[0])));vr<Se&&(pe=We,Se=vr,Le=tr)}return[pe,Le]}tessellate(le){for(let pe=this.edges.length-1;pe>=0;--pe){const Se=this.edges[pe].a,Le=this.edges[pe].b,{position:je,height:We,extent:it}=this.vertices[Se],{position:Ye,height:ct,extent:lt}=this.vertices[Le],ut=this.vertexProps[Se].dir,Ct=this.vertexProps[Le].dir,Zt=i.ab.vec3.fromValues(je[0]/le,je[1]/le,We),Xt=i.ab.vec3.fromValues(Ye[0]/le,Ye[1]/le,ct),gn=i.ab.vec3.fromValues(ut[1],-ut[0],0);i.ab.vec3.scale(gn,gn,it);const Cn=i.ab.vec3.fromValues(Ct[1],-Ct[0],0);if(i.ab.vec3.scale(Cn,Cn,lt),this.distSqLines(i.ab.vec3.fromValues(Zt[0]+.5*gn[0],Zt[1]+.5*gn[1],Zt[2]+.5*gn[2]),i.ab.vec3.fromValues(Xt[0]-.5*Cn[0],Xt[1]-.5*Cn[1],Xt[2]-.5*Cn[2]),i.ab.vec3.fromValues(Zt[0]-.5*gn[0],Zt[1]-.5*gn[1],Zt[2]-.5*gn[2]),i.ab.vec3.fromValues(Xt[0]+.5*Cn[0],Xt[1]+.5*Cn[1],Xt[2]+.5*Cn[2]))<=.05*.05)continue;const On=this.vertices.length,wn=i.ab.vec2.add(i.ab.vec2.create(),je,Ye);this.vertices.push({position:i.ab.vec2.scale(wn,wn,.5),height:.5*(We+ct),extent:.5*(it+lt)});const er=i.ab.vec2.add(i.ab.vec2.create(),ut,Ct);this.vertexProps.push({dir:i.ab.vec2.normalize(er,er)}),this.edges.splice(pe,1),this.edgeProps.splice(pe,1),this.edges.push({a:Se,b:On}),this.edges.push({a:On,b:Le});const tr=i.ab.vec2.subtract(i.ab.vec2.create(),this.vertices[On].position,je),Yn=i.ab.vec2.length(tr),dr={vec:tr,dir:i.ab.vec2.scale(i.ab.vec2.create(),tr,1/Yn),len:Yn};this.edgeProps.push(dr),this.edgeProps.push(dr)}}distSqLines(le,pe,Se,Le){const je=i.ab.vec3.subtract(i.ab.vec3.create(),pe,le),We=i.ab.vec3.subtract(i.ab.vec3.create(),Le,Se),it=i.ab.vec3.subtract(i.ab.vec3.create(),le,Se),Ye=i.ab.vec3.dot(je,je),ct=i.ab.vec3.dot(je,We),lt=i.ab.vec3.dot(je,it),ut=i.ab.vec3.dot(We,We),Ct=i.ab.vec3.dot(We,it),Zt=Ye*ut-ct*ct;if(Zt===0){const wn=i.ab.vec3.dot(it,We)/i.ab.vec3.dot(We,We),er=i.ab.vec3.lerp(i.ab.vec3.create(),Se,Le,wn);return i.ab.vec3.squaredDistance(er,le)}const Xt=(ct*Ct-lt*ut)/Zt,gn=(Ye*Ct-ct*lt)/Zt,Cn=i.ab.vec3.lerp(i.ab.vec3.create(),le,pe,Xt),On=i.ab.vec3.lerp(i.ab.vec3.create(),Se,Le,gn);return i.ab.vec3.squaredDistance(Cn,On)}}class me{static parseFrom(le,pe){const Se=xe.parse(le);if(!Se)return[];let{vertices:Le,features:je}=Se;const We=1/i.cc(pe);je.sort((lt,ut)=>lt.id-ut.id),Le.sort((lt,ut)=>lt.id-ut.id||lt.idx-ut.idx),Le=Le.filter((lt,ut,Ct)=>ut===Ct.findIndex(Zt=>Zt.id===lt.id&&Zt.idx===lt.idx));const it=new Array;let Ye=0;const ct=Le.length;for(const lt of je){if(lt.constantHeight){it.push(new ae(lt.id,lt.bounds,lt.constantHeight));continue}for(;Ye!==ct&&Le[Ye].id<lt.id;)Ye++;if(Ye===ct||Le[Ye].id!==lt.id)continue;const ut=new Array,Ct=new Array,Zt=Ye;for(;Ye!==ct&&Le[Ye].id===lt.id;){const Xt=Le[Ye];if(ut.push({position:Xt.position,height:Xt.height,extent:Xt.extent}),Ye!==Zt&&Le[Ye-1].idx===Xt.idx-1){const gn=Ye-Zt;Ct.push({a:gn-1,b:gn})}Ye++}it.push(new ae(lt.id,lt.bounds,void 0,ut,Ct,We))}return it}}i.dV(ae,"ElevationFeature");class we{constructor(le){this.tileID=new i.aG(le.tileID.overscaledZ,le.tileID.wrap,le.tileID.canonical.z,le.tileID.canonical.x,le.tileID.canonical.y),this.tileZoom=le.tileZoom,this.uid=le.uid,this.zoom=le.zoom,this.lut=le.lut,this.canonical=le.tileID.canonical,this.pixelRatio=le.pixelRatio,this.tileSize=le.tileSize,this.source=le.source,this.scope=le.scope,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=le.showCollisionBoxes,this.collectResourceTiming=!!le.request&&le.request.collectResourceTiming,this.promoteId=le.promoteId,this.isSymbolTile=le.isSymbolTile,this.tileTransform=i.aQ(le.tileID.canonical,le.projection),this.projection=le.projection,this.worldview=le.worldview,this.localizableLayerIds=le.localizableLayerIds,this.brightness=le.brightness,this.extraShadowCaster=!!le.extraShadowCaster,this.tessellationStep=le.tessellationStep,this.scaleFactor=le.scaleFactor}parse(le,pe,Se,Le,je){this.status="parsing",this.data=le,this.collisionBoxArray=new i.aW;const We=new i.d_(Object.keys(le.layers).sort()),it=new i.d$(this.tileID,this.promoteId);it.bucketLayerIDs=[];const Ye={},ct=new i.e0(256,256),lt={featureIndex:it,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:ct,availableImages:Se,brightness:this.brightness,scaleFactor:this.scaleFactor,elevationFeatures:void 0},ut=pe.familiesBySource[this.source];for(const wn in ut){const er=le.layers[wn];if(!er)continue;let tr=!1,Yn=!1,dr=!1;for(const Ai of ut[wn])Ai[0].type==="symbol"?tr=!0:Yn=!0,Ai[0].is3D()&&Ai[0].type!=="model"&&(dr=!0);if(this.extraShadowCaster&&!dr||this.isSymbolTile===!0&&!tr||this.isSymbolTile===!1&&!Yn)continue;er.version===1&&i.w(`Vector tile source "${this.source}" layer "${wn}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const vr=We.encode(wn),Pi=[];let Uo=!1;for(let Ai=0,ii=0;Ai<er.length;Ai++){const di=er.feature(Ai),mh=it.getId(di,wn);if(this.localizableLayerIds&&this.localizableLayerIds.has(wn)){const Cl=di.properties?di.properties.worldview:null;if(this.worldview&&typeof Cl=="string")if(Cl==="all")di.properties.$localized=!0;else{if(!Cl.split(",").includes(this.worldview))continue;di.properties.$localized=!0,di.properties.worldview=this.worldview}}!Uo&&di.properties&&di.properties.hasOwnProperty(Y)&&(Uo=!0),Pi.push({feature:di,id:mh,index:ii,sourceLayerIndex:vr}),ii++}Uo&&le.layers.hasOwnProperty(J)&&(lt.elevationFeatures=me.parseFrom(le.layers[J],this.canonical));for(const Ai of ut[wn]){const ii=Ai[0];(!this.extraShadowCaster||ii.is3D()&&ii.type!=="model")&&(this.isSymbolTile!==void 0&&ii.type==="symbol"!==this.isSymbolTile||ii.minzoom&&this.zoom<Math.floor(ii.minzoom)||ii.maxzoom&&this.zoom>=ii.maxzoom||ii.visibility!=="none"&&(Ge(Ai,this.zoom,lt.brightness,Se),(Ye[ii.id]=ii.createBucket({index:it.bucketLayerIDs.length,layers:Ai,zoom:this.zoom,lut:this.lut,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:vr,sourceID:this.source,projection:this.projection.spec,tessellationStep:this.tessellationStep})).populate(Pi,lt,this.tileID.canonical,this.tileTransform),it.bucketLayerIDs.push(Ai.map(di=>i.aC(di.id,di.scope)))))}}let Ct,Zt,Xt,gn;ct.trim();const Cn={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},On=()=>{if(Ct)return this.status="done",je(Ct);if(this.extraShadowCaster)this.status="done",je(null,{buckets:i.bj(Ye).filter(wn=>!wn.isEmpty()),featureIndex:it,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:lt.brightness,glyphMap:null,iconMap:null,glyphPositions:null});else if(Zt&&Xt&&gn){const wn=new X(Zt),er=new i.e3(Xt,gn,this.lut);for(const tr in Ye){const Yn=Ye[tr];Yn instanceof i.aX?(Ge(Yn.layers,this.zoom,lt.brightness,Se),i.e4(Yn,Zt,wn.positions,Xt,er.iconPositions,this.showCollisionBoxes,Se,this.tileID.canonical,this.tileZoom,this.projection,this.scaleFactor,this.pixelRatio,this.brightness)):Yn.hasPattern&&(Yn instanceof i.b1||Yn instanceof i.b2||Yn instanceof i.d5)&&(Ge(Yn.layers,this.zoom,lt.brightness,Se),Yn.addFeatures(lt,this.tileID.canonical,er.patternPositions,Se,this.tileTransform,this.brightness))}this.status="done",je(null,{buckets:i.bj(Ye).filter(tr=>!tr.isEmpty()),featureIndex:it,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:wn.image,lineAtlas:ct,imageAtlas:er,brightness:lt.brightness})}};if(!this.extraShadowCaster){const wn=i.e1(lt.glyphDependencies,Yn=>Object.keys(Yn).map(Number));Object.keys(wn).length?Le.send("getGlyphs",{uid:this.uid,stacks:wn,scope:this.scope},(Yn,dr)=>{Ct||(Ct=Yn,Zt=dr,On())},void 0,!1,Cn):Zt={};const er=Object.keys(lt.iconDependencies);er.length?Le.send("getImages",{icons:er,source:this.source,scope:this.scope,tileID:this.tileID,type:"icons"},(Yn,dr)=>{if(Ct)return;Ct=Yn;const vr={};Object.values(dr).some(Pi=>Pi.usvg)?this.rasterize(Le,vr,dr,lt.iconDependencies,()=>{Xt=vr,On()}):(this.fillImageMap(vr,lt.iconDependencies,dr),Xt=vr,On())},void 0,!1,Cn):Xt={};const tr=Object.keys(lt.patternDependencies);tr.length?Le.send("getImages",{icons:tr,source:this.source,scope:this.scope,tileID:this.tileID,type:"patterns"},(Yn,dr)=>{if(!Ct){Ct=Yn;const vr={};Object.values(dr).some(Pi=>Pi.usvg)?this.rasterize(Le,vr,dr,lt.patternDependencies,()=>{gn=vr,On()}):(this.fillImageMap(vr,lt.patternDependencies,dr),gn=vr,On())}},void 0,!1,Cn):gn={}}On()}fillImageMap(le,pe,Se){for(const Le in Se){const je=pe[Le]||[];for(const We of je)Se[We.id].usvg||(le[We.serialize()]=Se[We.id])}}getImageTaskQueue(le,pe,Se){const Le={};for(const je in pe){const We=Se[je]||[];for(const it of We){const Ye=it.serialize();pe[it.id].usvg?Le[Ye]||(Le[Ye]=it):le[Ye]=pe[it.id]}}return Le}rasterize(le,pe,Se,Le,je){const We=this.getImageTaskQueue(pe,Se,Le);this.rasterizeTask=le.send("rasterizeImages",{scope:this.scope,imageTasks:We},(it,Ye)=>{if(!it)for(const ct in Ye){const{id:lt}=i.e2.deserializeFromString(ct);pe[ct]=Object.assign({},Se[lt],{data:Ye[ct]})}je()})}cancelRasterize(){this.rasterizeTask&&this.rasterizeTask.cancel()}}function Ge(ft,le,pe,Se){const Le=new i.a8(le,{brightness:pe});for(const je of ft)je.recalculate(Le,Se)}class He extends i.E{constructor(le,pe,Se,Le,je,We){super(),this.actor=le,this.layerIndex=pe,this.availableImages=Se,this.loadVectorData=je||i.aD,this.loading={},this.loaded={},this.deduped=new i.aB(le.scheduler),this.isSpriteLoaded=Le,this.scheduler=le.scheduler,this.brightness=We}loadTile(le,pe){const Se=le.uid,Le=le&&le.request,je=Le&&Le.collectResourceTiming,We=this.loading[Se]=new we(le);We.abort=this.loadVectorData(le,(it,Ye)=>{const ct=!this.loading[Se];if(delete this.loading[Se],We.cancelRasterize(),ct||it||!Ye)return We.status="done",ct||(this.loaded[Se]=We),pe(it);const lt=Ye.rawData,ut={};Ye.expires&&(ut.expires=Ye.expires),Ye.cacheControl&&(ut.cacheControl=Ye.cacheControl),We.vectorTile=Ye.vectorTile||new i.dY.VectorTile(new i.bh(lt));const Ct=()=>{We.parse(We.vectorTile,this.layerIndex,this.availableImages,this.actor,(Zt,Xt)=>{if(Zt||!Xt)return pe(Zt);const gn={};if(je){const Cn=C(Le);Cn.length>0&&(gn.resourceTiming=JSON.parse(JSON.stringify(Cn)))}pe(null,i.l({rawTileData:lt.slice(0)},Xt,ut,gn))})};this.isSpriteLoaded?Ct():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(Ct,{type:"parseTile",isSymbolTile:le.isSymbolTile,zoom:le.tileZoom}):Ct()}),this.loaded=this.loaded||{},this.loaded[Se]=We})}reloadTile(le,pe){const Se=this.loaded,Le=le.uid;if(Se&&Se[Le]){const je=Se[Le];je.scaleFactor=le.scaleFactor,je.showCollisionBoxes=le.showCollisionBoxes,je.projection=le.projection,je.brightness=le.brightness,je.tileTransform=i.aQ(le.tileID.canonical,le.projection),je.extraShadowCaster=le.extraShadowCaster,je.lut=le.lut;const We=(it,Ye)=>{const ct=je.reloadCallback;ct&&(delete je.reloadCallback,je.parse(je.vectorTile,this.layerIndex,this.availableImages,this.actor,ct)),pe(it,Ye)};je.status==="parsing"?je.reloadCallback=We:je.status==="done"&&(je.vectorTile?je.parse(je.vectorTile,this.layerIndex,this.availableImages,this.actor,We):We())}else pe(null,void 0)}abortTile(le,pe){const Se=le.uid,Le=this.loading[Se];Le&&(Le.abort&&Le.abort(),delete this.loading[Se]),pe()}removeTile(le,pe){const Se=this.loaded,Le=le.uid;Se&&Se[Le]&&delete Se[Le],pe()}}class ye{loadTile(le,pe){const{uid:Se,encoding:Le,rawImageData:je,padding:We}=le,it=ImageBitmap&&je instanceof ImageBitmap?this.getImageData(je,We):je;pe(null,new i.e5(Se,it,Le,We<1))}getImageData(le,pe){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(le.width,le.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=le.width,this.offscreenCanvas.height=le.height,this.offscreenCanvasContext.drawImage(le,0,0,le.width,le.height);const Se=this.offscreenCanvasContext.getImageData(-pe,-pe,le.width+2*pe,le.height+2*pe);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),Se}}i.bg.setPbf(i.bh);class ke{decodeRasterArray({task:le,buffer:pe},Se){i.bg.performDecoding(pe,le).then(Le=>{Se(null,Le)},Le=>{Se(Le)})}}const dt=i.dY.VectorTileFeature.prototype.toGeoJSON;class vt{constructor(le){this._feature=le,this.extent=i.ag,this.type=le.type,this.properties=le.tags,"id"in le&&!isNaN(le.id)&&(this.id=parseInt(le.id,10))}loadGeometry(){if(this._feature.type===1){const le=[];for(const pe of this._feature.geometry)le.push([new i.P(pe[0],pe[1])]);return le}{const le=[];for(const pe of this._feature.geometry){const Se=[];for(const Le of pe)Se.push(new i.P(Le[0],Le[1]));le.push(Se)}return le}}toGeoJSON(le,pe,Se){return dt.call(this,le,pe,Se)}}class jt{constructor(le){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=i.ag,this.length=le.length,this._features=le}feature(le){return new vt(this._features[le])}}const _t=64/4096,gt=128;class Vt{constructor(){this.features=new Map}clear(){this.features.clear()}load(le=[],pe){for(const Se of le){const Le=Se.id;if(Le==null)continue;let je=this.features.get(Le);je&&this.updateCache(je,pe),Se.geometry?(je=Bt(Se),this.updateCache(je,pe),this.features.set(Le,je)):this.features.delete(Le),this.updateCache(je,pe)}}updateCache(le,pe){for(const{canonical:Se,uid:Le}of Object.values(pe)){const{z:je,x:We,y:it}=Se;Ht(le,Math.pow(2,je),We,it)&&delete pe[Le]}}getTile(le,pe,Se){const Le=Math.pow(2,le),je=[];for(const We of this.features.values())Ht(We,Le,pe,Se)&&je.push(Nt(We,Le,pe,Se));return{features:je}}getFeatures(){return[...this.features.values()]}}function Ht({minX:ft,minY:le,maxX:pe,maxY:Se},Le,je,We){return ft<(je+1+_t)/Le&&le<(We+1+_t)/Le&&pe>(je-_t)/Le&&Se>(We-_t)/Le}function Bt(ft){const{id:le,geometry:pe,properties:Se}=ft;if(!pe)return;if(pe.type==="GeometryCollection")throw new Error("GeometryCollection not supported in dynamic mode.");const{type:Le,coordinates:je}=pe,We={id:le,type:1,geometry:[],tags:Se,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0},it=We.geometry;if(Le==="Point")et(je,it,We);else if(Le==="MultiPoint")for(const Ye of je)et(Ye,it,We);else if(Le==="LineString")We.type=2,$t(je,it,We);else if(Le==="MultiLineString")We.type=2,rn(je,it,We);else if(Le==="Polygon")We.type=3,rn(je,it,We,!0);else{if(Le!=="MultiPolygon")throw new Error("Input data is not a valid GeoJSON object.");We.type=3;for(const Ye of je)rn(Ye,it,We,!0)}return We}function et([ft,le],pe,Se){const Le=i.at(ft);let je=i.aA(le);je=je<0?0:je>1?1:je,pe.push(Le,je),Se.minX=Math.min(Se.minX,Le),Se.minY=Math.min(Se.minY,je),Se.maxX=Math.max(Se.maxX,Le),Se.maxY=Math.max(Se.maxY,je)}function $t(ft,le,pe,Se=!1,Le=!1){const je=[];for(const We of ft)et(We,je,pe);le.push(je),Se&&function(We,it){let Ye=0;for(let ct=0,lt=We.length,ut=lt-2;ct<lt;ut=ct,ct+=2)Ye+=(We[ct]-We[ut])*(We[ct+1]+We[ut+1]);if(Ye>0===it)for(let ct=0,lt=We.length;ct<lt/2;ct+=2){const ut=We[ct],Ct=We[ct+1];We[ct]=We[lt-2-ct],We[ct+1]=We[lt-1-ct],We[lt-2-ct]=ut,We[lt-1-ct]=Ct}}(je,Le)}function rn(ft,le,pe,Se=!1){for(let Le=0;Le<ft.length;Le++)$t(ft[Le],le,pe,Se,Le===0)}function Nt(ft,le,pe,Se){const{id:Le,type:je,geometry:We,tags:it}=ft,Ye=[];if(je===1)(function(ct,lt,ut,Ct,Zt){for(let Xt=0;Xt<ct.length;Xt+=2){const gn=Math.round(i.ag*(ct[Xt+0]*lt-ut)),Cn=Math.round(i.ag*(ct[Xt+1]*lt-Ct));Zt.push([gn,Cn])}})(We,le,pe,Se,Ye);else for(const ct of We)xn(ct,le,pe,Se,Ye);return{id:Le,type:je,geometry:Ye,tags:it}}function xn(ft,le,pe,Se,Le){const We=i.ag+gt;let it;for(let Ye=0;Ye<ft.length-2;Ye+=2){let ct=Math.round(i.ag*(ft[Ye+0]*le-pe)),lt=Math.round(i.ag*(ft[Ye+1]*le-Se)),ut=Math.round(i.ag*(ft[Ye+2]*le-pe)),Ct=Math.round(i.ag*(ft[Ye+3]*le-Se));const Zt=ut-ct,Xt=Ct-lt;ct<-128&&ut<-128||(ct<-128?(lt+=Math.round(Xt*((-128-ct)/Zt)),ct=-128):ut<-128&&(Ct=lt+Math.round(Xt*((-128-ct)/Zt)),ut=-128),lt<-128&&Ct<-128||(lt<-128?(ct+=Math.round(Zt*((-128-lt)/Xt)),lt=-128):Ct<-128&&(ut=ct+Math.round(Zt*((-128-lt)/Xt)),Ct=-128),ct>=We&&ut>=We||(ct>=We?(lt+=Math.round(Xt*((We-ct)/Zt)),ct=We):ut>=We&&(Ct=lt+Math.round(Xt*((We-ct)/Zt)),ut=We),lt>=We&&Ct>=We||(lt>=We?(ct+=Math.round(Zt*((We-lt)/Xt)),lt=We):Ct>=We&&(ut=ct+Math.round(Zt*((We-lt)/Xt)),Ct=We),it&&ct===it[it.length-1][0]&&lt===it[it.length-1][1]||(it=[[ct,lt]],Le.push(it)),it.push([ut,Ct])))))}}var rr,Xn,yi,ir={exports:{}},yn=function(){if(yi)return ir.exports;yi=1;var ft=i.e8(),le=function(){if(Xn)return rr;Xn=1;var lt=i.e6(),ut=i.e7().VectorTileFeature;function Ct(Xt,gn){this.options=gn||{},this.features=Xt,this.length=Xt.length}function Zt(Xt,gn){this.id=typeof Xt.id=="number"?Xt.id:void 0,this.type=Xt.type,this.rawGeometry=Xt.type===1?[Xt.geometry]:Xt.geometry,this.properties=Xt.tags,this.extent=gn||4096}return rr=Ct,Ct.prototype.feature=function(Xt){return new Zt(this.features[Xt],this.options.extent)},Zt.prototype.loadGeometry=function(){var Xt=this.rawGeometry;this.geometry=[];for(var gn=0;gn<Xt.length;gn++){for(var Cn=Xt[gn],On=[],wn=0;wn<Cn.length;wn++)On.push(new lt(Cn[wn][0],Cn[wn][1]));this.geometry.push(On)}return this.geometry},Zt.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Xt=this.geometry,gn=1/0,Cn=-1/0,On=1/0,wn=-1/0,er=0;er<Xt.length;er++)for(var tr=Xt[er],Yn=0;Yn<tr.length;Yn++){var dr=tr[Yn];gn=Math.min(gn,dr.x),Cn=Math.max(Cn,dr.x),On=Math.min(On,dr.y),wn=Math.max(wn,dr.y)}return[gn,On,Cn,wn]},Zt.prototype.toGeoJSON=ut.prototype.toGeoJSON,rr}();function pe(lt){var ut=new ft;return function(Ct,Zt){for(var Xt in Ct.layers)Zt.writeMessage(3,Se,Ct.layers[Xt])}(lt,ut),ut.finish()}function Se(lt,ut){var Ct;ut.writeVarintField(15,lt.version||1),ut.writeStringField(1,lt.name||""),ut.writeVarintField(5,lt.extent||4096);var Zt={keys:[],values:[],keycache:{},valuecache:{}};for(Ct=0;Ct<lt.length;Ct++)Zt.feature=lt.feature(Ct),ut.writeMessage(2,Le,Zt);var Xt=Zt.keys;for(Ct=0;Ct<Xt.length;Ct++)ut.writeStringField(3,Xt[Ct]);var gn=Zt.values;for(Ct=0;Ct<gn.length;Ct++)ut.writeMessage(4,ct,gn[Ct])}function Le(lt,ut){var Ct=lt.feature;Ct.id!==void 0&&ut.writeVarintField(1,Ct.id),ut.writeMessage(2,je,lt),ut.writeVarintField(3,Ct.type),ut.writeMessage(4,Ye,Ct)}function je(lt,ut){var Ct=lt.feature,Zt=lt.keys,Xt=lt.values,gn=lt.keycache,Cn=lt.valuecache;for(var On in Ct.properties){var wn=Ct.properties[On],er=gn[On];if(wn!==null){er===void 0&&(Zt.push(On),gn[On]=er=Zt.length-1),ut.writeVarint(er);var tr=typeof wn;tr!=="string"&&tr!=="boolean"&&tr!=="number"&&(wn=JSON.stringify(wn));var Yn=tr+":"+wn,dr=Cn[Yn];dr===void 0&&(Xt.push(wn),Cn[Yn]=dr=Xt.length-1),ut.writeVarint(dr)}}}function We(lt,ut){return(ut<<3)+(7&lt)}function it(lt){return lt<<1^lt>>31}function Ye(lt,ut){for(var Ct=lt.loadGeometry(),Zt=lt.type,Xt=0,gn=0,Cn=Ct.length,On=0;On<Cn;On++){var wn=Ct[On],er=1;Zt===1&&(er=wn.length),ut.writeVarint(We(1,er));for(var tr=Zt===3?wn.length-1:wn.length,Yn=0;Yn<tr;Yn++){Yn===1&&Zt!==1&&ut.writeVarint(We(2,tr-1));var dr=wn[Yn].x-Xt,vr=wn[Yn].y-gn;ut.writeVarint(it(dr)),ut.writeVarint(it(vr)),Xt+=dr,gn+=vr}Zt===3&&ut.writeVarint(We(7,1))}}function ct(lt,ut){var Ct=typeof lt;Ct==="string"?ut.writeStringField(1,lt):Ct==="boolean"?ut.writeBooleanField(7,lt):Ct==="number"&&(lt%1!=0?ut.writeDoubleField(3,lt):lt<0?ut.writeSVarintField(6,lt):ut.writeVarintField(5,lt))}return ir.exports=pe,ir.exports.fromVectorTileJs=pe,ir.exports.fromGeojsonVt=function(lt,ut){ut=ut||{};var Ct={};for(var Zt in lt)Ct[Zt]=new le(lt[Zt].features,ut),Ct[Zt].name=Zt,Ct[Zt].version=ut.version,Ct[Zt].extent=ut.extent;return pe({layers:Ct})},ir.exports.GeoJSONWrapper=le,ir.exports}(),Ne=i.e9(yn);const Qn={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:ft=>ft},fn=Math.fround||(Dr=new Float32Array(1),ft=>(Dr[0]=+ft,Dr[0]));var Dr;const Pt=3,Pr=5,Cr=6;class zi{constructor(le){this.options=Object.assign(Object.create(Qn),le),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(le){const{log:pe,minZoom:Se,maxZoom:Le}=this.options;pe&&console.time("total time");const je=`prepare ${le.length} points`;pe&&console.time(je),this.points=le;const We=[];for(let Ye=0;Ye<le.length;Ye++){const ct=le[Ye];if(!ct.geometry)continue;const[lt,ut]=ct.geometry.coordinates,Ct=fn(ha(lt)),Zt=fn(Pa(ut));We.push(Ct,Zt,1/0,Ye,-1,1),this.options.reduce&&We.push(0)}let it=this.trees[Le+1]=this._createTree(We);pe&&console.timeEnd(je);for(let Ye=Le;Ye>=Se;Ye--){const ct=+Date.now();it=this.trees[Ye]=this._createTree(this._cluster(it,Ye)),pe&&console.log("z%d: %d clusters in %dms",Ye,it.numItems,+Date.now()-ct)}return pe&&console.timeEnd("total time"),this}getClusters(le,pe){let Se=((le[0]+180)%360+360)%360-180;const Le=Math.max(-90,Math.min(90,le[1]));let je=le[2]===180?180:((le[2]+180)%360+360)%360-180;const We=Math.max(-90,Math.min(90,le[3]));if(le[2]-le[0]>=360)Se=-180,je=180;else if(Se>je){const ut=this.getClusters([Se,Le,180,We],pe),Ct=this.getClusters([-180,Le,je,We],pe);return ut.concat(Ct)}const it=this.trees[this._limitZoom(pe)],Ye=it.range(ha(Se),Pa(We),ha(je),Pa(Le)),ct=it.data,lt=[];for(const ut of Ye){const Ct=this.stride*ut;lt.push(ct[Ct+Pr]>1?$n(ct,Ct,this.clusterProps):this.points[ct[Ct+Pt]])}return lt}getChildren(le){const pe=this._getOriginId(le),Se=this._getOriginZoom(le),Le="No cluster with the specified id.",je=this.trees[Se];if(!je)throw new Error(Le);const We=je.data;if(pe*this.stride>=We.length)throw new Error(Le);const it=this.options.radius/(this.options.extent*Math.pow(2,Se-1)),Ye=je.within(We[pe*this.stride],We[pe*this.stride+1],it),ct=[];for(const lt of Ye){const ut=lt*this.stride;We[ut+4]===le&&ct.push(We[ut+Pr]>1?$n(We,ut,this.clusterProps):this.points[We[ut+Pt]])}if(ct.length===0)throw new Error(Le);return ct}getLeaves(le,pe,Se){const Le=[];return this._appendLeaves(Le,le,pe=pe||10,Se=Se||0,0),Le}getTile(le,pe,Se){const Le=this.trees[this._limitZoom(le)],je=Math.pow(2,le),{extent:We,radius:it}=this.options,Ye=it/We,ct=(Se-Ye)/je,lt=(Se+1+Ye)/je,ut={features:[]};return this._addTileFeatures(Le.range((pe-Ye)/je,ct,(pe+1+Ye)/je,lt),Le.data,pe,Se,je,ut),pe===0&&this._addTileFeatures(Le.range(1-Ye/je,ct,1,lt),Le.data,je,Se,je,ut),pe===je-1&&this._addTileFeatures(Le.range(0,ct,Ye/je,lt),Le.data,-1,Se,je,ut),ut.features.length?ut:null}getClusterExpansionZoom(le){let pe=this._getOriginZoom(le)-1;for(;pe<=this.options.maxZoom;){const Se=this.getChildren(le);if(pe++,Se.length!==1)break;le=Se[0].properties.cluster_id}return pe}_appendLeaves(le,pe,Se,Le,je){const We=this.getChildren(pe);for(const it of We){const Ye=it.properties;if(Ye&&Ye.cluster?je+Ye.point_count<=Le?je+=Ye.point_count:je=this._appendLeaves(le,Ye.cluster_id,Se,Le,je):je<Le?je++:le.push(it),le.length===Se)break}return je}_createTree(le){const pe=new i.bE(le.length/this.stride|0,this.options.nodeSize,Float32Array);for(let Se=0;Se<le.length;Se+=this.stride)pe.add(le[Se],le[Se+1]);return pe.finish(),pe.data=le,pe}_addTileFeatures(le,pe,Se,Le,je,We){for(const it of le){const Ye=it*this.stride,ct=pe[Ye+Pr]>1;let lt,ut,Ct;if(ct)lt=si(pe,Ye,this.clusterProps),ut=pe[Ye],Ct=pe[Ye+1];else{const gn=this.points[pe[Ye+Pt]];lt=gn.properties;const[Cn,On]=gn.geometry.coordinates;ut=ha(Cn),Ct=Pa(On)}const Zt={type:1,geometry:[[Math.round(this.options.extent*(ut*je-Se)),Math.round(this.options.extent*(Ct*je-Le))]],tags:lt};let Xt;Xt=ct||this.options.generateId?pe[Ye+Pt]:this.points[pe[Ye+Pt]].id,Xt!==void 0&&(Zt.id=Xt),We.features.push(Zt)}}_limitZoom(le){return Math.max(this.options.minZoom,Math.min(Math.floor(+le),this.options.maxZoom+1))}_cluster(le,pe){const{radius:Se,extent:Le,reduce:je,minPoints:We}=this.options,it=Se/(Le*Math.pow(2,pe)),Ye=le.data,ct=[],lt=this.stride;for(let ut=0;ut<Ye.length;ut+=lt){if(Ye[ut+2]<=pe)continue;Ye[ut+2]=pe;const Ct=Ye[ut],Zt=Ye[ut+1],Xt=le.within(Ye[ut],Ye[ut+1],it),gn=Ye[ut+Pr];let Cn=gn;for(const On of Xt){const wn=On*lt;Ye[wn+2]>pe&&(Cn+=Ye[wn+Pr])}if(Cn>gn&&Cn>=We){let On,wn=Ct*gn,er=Zt*gn,tr=-1;const Yn=(ut/lt<<5)+(pe+1)+this.points.length;for(const dr of Xt){const vr=dr*lt;if(Ye[vr+2]<=pe)continue;Ye[vr+2]=pe;const Pi=Ye[vr+Pr];wn+=Ye[vr]*Pi,er+=Ye[vr+1]*Pi,Ye[vr+4]=Yn,je&&(On||(On=this._map(Ye,ut,!0),tr=this.clusterProps.length,this.clusterProps.push(On)),je(On,this._map(Ye,vr)))}Ye[ut+4]=Yn,ct.push(wn/Cn,er/Cn,1/0,Yn,-1,Cn),je&&ct.push(tr)}else{for(let On=0;On<lt;On++)ct.push(Ye[ut+On]);if(Cn>1)for(const On of Xt){const wn=On*lt;if(!(Ye[wn+2]<=pe)){Ye[wn+2]=pe;for(let er=0;er<lt;er++)ct.push(Ye[wn+er])}}}}return ct}_getOriginId(le){return le-this.points.length>>5}_getOriginZoom(le){return(le-this.points.length)%32}_map(le,pe,Se){if(le[pe+Pr]>1){const We=this.clusterProps[le[pe+Cr]];return Se?Object.assign({},We):We}const Le=this.points[le[pe+Pt]].properties,je=this.options.map(Le);return Se&&je===Le?Object.assign({},je):je}}function $n(ft,le,pe){return{type:"Feature",id:ft[le+Pt],properties:si(ft,le,pe),geometry:{type:"Point",coordinates:[(Se=ft[le],360*(Se-.5)),co(ft[le+1])]}};var Se}function si(ft,le,pe){const Se=ft[le+Pr],Le=Se>=1e4?`${Math.round(Se/1e3)}k`:Se>=1e3?Math.round(Se/100)/10+"k":Se,je=ft[le+Cr],We=je===-1?{}:Object.assign({},pe[je]);return Object.assign(We,{cluster:!0,cluster_id:ft[le+Pt],point_count:Se,point_count_abbreviated:Le})}function ha(ft){return ft/360+.5}function Pa(ft){const le=Math.sin(ft*Math.PI/180),pe=.5-.25*Math.log((1+le)/(1-le))/Math.PI;return pe<0?0:pe>1?1:pe}function co(ft){const le=(180-360*ft)*Math.PI/180;return 360*Math.atan(Math.exp(le))/Math.PI-90}function Rs(ft,le,pe,Se){let Le=Se;const je=le+(pe-le>>1);let We,it=pe-le;const Ye=ft[le],ct=ft[le+1],lt=ft[pe],ut=ft[pe+1];for(let Ct=le+3;Ct<pe;Ct+=3){const Zt=Bn(ft[Ct],ft[Ct+1],Ye,ct,lt,ut);if(Zt>Le)We=Ct,Le=Zt;else if(Zt===Le){const Xt=Math.abs(Ct-je);Xt<it&&(We=Ct,it=Xt)}}Le>Se&&(We-le>3&&Rs(ft,le,We,Se),ft[We+2]=Le,pe-We>3&&Rs(ft,We,pe,Se))}function Bn(ft,le,pe,Se,Le,je){let We=Le-pe,it=je-Se;if(We!==0||it!==0){const Ye=((ft-pe)*We+(le-Se)*it)/(We*We+it*it);Ye>1?(pe=Le,Se=je):Ye>0&&(pe+=We*Ye,Se+=it*Ye)}return We=ft-pe,it=le-Se,We*We+it*it}function jo(ft,le,pe,Se){const Le={id:ft??null,type:le,geometry:pe,tags:Se,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(le==="Point"||le==="MultiPoint"||le==="LineString")is(Le,pe);else if(le==="Polygon")is(Le,pe[0]);else if(le==="MultiLineString")for(const je of pe)is(Le,je);else if(le==="MultiPolygon")for(const je of pe)is(Le,je[0]);return Le}function is(ft,le){for(let pe=0;pe<le.length;pe+=3)ft.minX=Math.min(ft.minX,le[pe]),ft.minY=Math.min(ft.minY,le[pe+1]),ft.maxX=Math.max(ft.maxX,le[pe]),ft.maxY=Math.max(ft.maxY,le[pe+1])}function Tl(ft,le,pe,Se){if(!le.geometry)return;const Le=le.geometry.coordinates;if(Le&&Le.length===0)return;const je=le.geometry.type,We=Math.pow(pe.tolerance/((1<<pe.maxZoom)*pe.extent),2);let it=[],Ye=le.id;if(pe.promoteId?Ye=le.properties[pe.promoteId]:pe.generateId&&(Ye=Se||0),je==="Point")fa(Le,it);else if(je==="MultiPoint")for(const ct of Le)fa(ct,it);else if(je==="LineString")El(Le,it,We,!1);else if(je==="MultiLineString"){if(pe.lineMetrics){for(const ct of Le)it=[],El(ct,it,We,!1),ft.push(jo(Ye,"LineString",it,le.properties));return}hc(Le,it,We,!1)}else if(je==="Polygon")hc(Le,it,We,!0);else{if(je!=="MultiPolygon"){if(je==="GeometryCollection"){for(const ct of le.geometry.geometries)Tl(ft,{id:Ye,geometry:ct,properties:le.properties},pe,Se);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const ct of Le){const lt=[];hc(ct,lt,We,!0),it.push(lt)}}ft.push(jo(Ye,je,it,le.properties))}function fa(ft,le){le.push(uh(ft[0]),hh(ft[1]),0)}function El(ft,le,pe,Se){let Le,je,We=0;for(let Ye=0;Ye<ft.length;Ye++){const ct=uh(ft[Ye][0]),lt=hh(ft[Ye][1]);le.push(ct,lt,0),Ye>0&&(We+=Se?(Le*lt-ct*je)/2:Math.sqrt(Math.pow(ct-Le,2)+Math.pow(lt-je,2))),Le=ct,je=lt}const it=le.length-3;le[2]=1,Rs(le,0,it,pe),le[it+2]=1,le.size=Math.abs(We),le.start=0,le.end=le.size}function hc(ft,le,pe,Se){for(let Le=0;Le<ft.length;Le++){const je=[];El(ft[Le],je,pe,Se),le.push(je)}}function uh(ft){return ft/360+.5}function hh(ft){const le=Math.sin(ft*Math.PI/180),pe=.5-.25*Math.log((1+le)/(1-le))/Math.PI;return pe<0?0:pe>1?1:pe}function da(ft,le,pe,Se,Le,je,We,it){if(Se/=le,je>=(pe/=le)&&We<Se)return ft;if(We<pe||je>=Se)return null;const Ye=[];for(const ct of ft){const lt=ct.geometry;let ut=ct.type;const Ct=Le===0?ct.minX:ct.minY,Zt=Le===0?ct.maxX:ct.maxY;if(Ct>=pe&&Zt<Se){Ye.push(ct);continue}if(Zt<pe||Ct>=Se)continue;let Xt=[];if(ut==="Point"||ut==="MultiPoint")Ia(lt,Xt,pe,Se,Le);else if(ut==="LineString")fh(lt,Xt,pe,Se,Le,!1,it.lineMetrics);else if(ut==="MultiLineString")pa(lt,Xt,pe,Se,Le,!1);else if(ut==="Polygon")pa(lt,Xt,pe,Se,Le,!0);else if(ut==="MultiPolygon")for(const gn of lt){const Cn=[];pa(gn,Cn,pe,Se,Le,!0),Cn.length&&Xt.push(Cn)}if(Xt.length){if(it.lineMetrics&&ut==="LineString"){for(const gn of Xt)Ye.push(jo(ct.id,ut,gn,ct.tags));continue}ut!=="LineString"&&ut!=="MultiLineString"||(Xt.length===1?(ut="LineString",Xt=Xt[0]):ut="MultiLineString"),ut!=="Point"&&ut!=="MultiPoint"||(ut=Xt.length===3?"Point":"MultiPoint"),Ye.push(jo(ct.id,ut,Xt,ct.tags))}}return Ye.length?Ye:null}function Ia(ft,le,pe,Se,Le){for(let je=0;je<ft.length;je+=3){const We=ft[je+Le];We>=pe&&We<=Se&&qn(le,ft[je],ft[je+1],ft[je+2])}}function fh(ft,le,pe,Se,Le,je,We){let it=ra(ft);const Ye=Le===0?tl:rp;let ct,lt,ut=ft.start;for(let Cn=0;Cn<ft.length-3;Cn+=3){const On=ft[Cn],wn=ft[Cn+1],er=ft[Cn+2],tr=ft[Cn+3],Yn=ft[Cn+4],dr=Le===0?On:wn,vr=Le===0?tr:Yn;let Pi=!1;We&&(ct=Math.sqrt(Math.pow(On-tr,2)+Math.pow(wn-Yn,2))),dr<pe?vr>pe&&(lt=Ye(it,On,wn,tr,Yn,pe),We&&(it.start=ut+ct*lt)):dr>Se?vr<Se&&(lt=Ye(it,On,wn,tr,Yn,Se),We&&(it.start=ut+ct*lt)):qn(it,On,wn,er),vr<pe&&dr>=pe&&(lt=Ye(it,On,wn,tr,Yn,pe),Pi=!0),vr>Se&&dr<=Se&&(lt=Ye(it,On,wn,tr,Yn,Se),Pi=!0),!je&&Pi&&(We&&(it.end=ut+ct*lt),le.push(it),it=ra(ft)),We&&(ut+=ct)}let Ct=ft.length-3;const Zt=ft[Ct],Xt=ft[Ct+1],gn=Le===0?Zt:Xt;gn>=pe&&gn<=Se&&qn(it,Zt,Xt,ft[Ct+2]),Ct=it.length-3,je&&Ct>=3&&(it[Ct]!==it[0]||it[Ct+1]!==it[1])&&qn(it,it[0],it[1],it[2]),it.length&&le.push(it)}function ra(ft){const le=[];return le.size=ft.size,le.start=ft.start,le.end=ft.end,le}function pa(ft,le,pe,Se,Le,je){for(const We of ft)fh(We,le,pe,Se,Le,je,!1)}function qn(ft,le,pe,Se){ft.push(le,pe,Se)}function tl(ft,le,pe,Se,Le,je){const We=(je-le)/(Se-le);return qn(ft,je,pe+(Le-pe)*We,1),We}function rp(ft,le,pe,Se,Le,je){const We=(je-pe)/(Le-pe);return qn(ft,le+(Se-le)*We,je,1),We}function Za(ft,le){const pe=[];for(let Se=0;Se<ft.length;Se++){const Le=ft[Se],je=Le.type;let We;if(je==="Point"||je==="MultiPoint"||je==="LineString")We=as(Le.geometry,le);else if(je==="MultiLineString"||je==="Polygon"){We=[];for(const it of Le.geometry)We.push(as(it,le))}else if(je==="MultiPolygon"){We=[];for(const it of Le.geometry){const Ye=[];for(const ct of it)Ye.push(as(ct,le));We.push(Ye)}}pe.push(jo(Le.id,je,We,Le.tags))}return pe}function as(ft,le){const pe=[];pe.size=ft.size,ft.start!==void 0&&(pe.start=ft.start,pe.end=ft.end);for(let Se=0;Se<ft.length;Se+=3)pe.push(ft[Se]+le,ft[Se+1],ft[Se+2]);return pe}function os(ft,le){if(ft.transformed)return ft;const pe=1<<ft.z,Se=ft.x,Le=ft.y;for(const je of ft.features){const We=je.geometry,it=je.type;if(je.geometry=[],it===1)for(let Ye=0;Ye<We.length;Ye+=2)je.geometry.push(Al(We[Ye],We[Ye+1],le,pe,Se,Le));else for(let Ye=0;Ye<We.length;Ye++){const ct=[];for(let lt=0;lt<We[Ye].length;lt+=2)ct.push(Al(We[Ye][lt],We[Ye][lt+1],le,pe,Se,Le));je.geometry.push(ct)}}return ft.transformed=!0,ft}function Al(ft,le,pe,Se,Le,je){return[Math.round(pe*(ft*Se-Le)),Math.round(pe*(le*Se-je))]}function nl(ft,le,pe,Se,Le){const je=le===Le.maxZoom?0:Le.tolerance/((1<<le)*Le.extent),We={features:[],numPoints:0,numSimplified:0,numFeatures:ft.length,source:null,x:pe,y:Se,z:le,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const it of ft)ip(We,it,je,Le);return We}function ip(ft,le,pe,Se){const Le=le.geometry,je=le.type,We=[];if(ft.minX=Math.min(ft.minX,le.minX),ft.minY=Math.min(ft.minY,le.minY),ft.maxX=Math.max(ft.maxX,le.maxX),ft.maxY=Math.max(ft.maxY,le.maxY),je==="Point"||je==="MultiPoint")for(let it=0;it<Le.length;it+=3)We.push(Le[it],Le[it+1]),ft.numPoints++,ft.numSimplified++;else if(je==="LineString")_u(We,Le,ft,pe,!1,!1);else if(je==="MultiLineString"||je==="Polygon")for(let it=0;it<Le.length;it++)_u(We,Le[it],ft,pe,je==="Polygon",it===0);else if(je==="MultiPolygon")for(let it=0;it<Le.length;it++){const Ye=Le[it];for(let ct=0;ct<Ye.length;ct++)_u(We,Ye[ct],ft,pe,!0,ct===0)}if(We.length){let it=le.tags||null;if(je==="LineString"&&Se.lineMetrics){it={};for(const ct in le.tags)it[ct]=le.tags[ct];it.mapbox_clip_start=Le.start/Le.size,it.mapbox_clip_end=Le.end/Le.size}const Ye={geometry:We,type:je==="Polygon"||je==="MultiPolygon"?3:je==="LineString"||je==="MultiLineString"?2:1,tags:it};le.id!==null&&(Ye.id=le.id),ft.features.push(Ye)}}function _u(ft,le,pe,Se,Le,je){const We=Se*Se;if(Se>0&&le.size<(Le?We:Se))return void(pe.numPoints+=le.length/3);const it=[];for(let Ye=0;Ye<le.length;Ye+=3)(Se===0||le[Ye+2]>We)&&(pe.numSimplified++,it.push(le[Ye],le[Ye+1])),pe.numPoints++;Le&&function(Ye,ct){let lt=0;for(let ut=0,Ct=Ye.length,Zt=Ct-2;ut<Ct;Zt=ut,ut+=2)lt+=(Ye[ut]-Ye[Zt])*(Ye[ut+1]+Ye[Zt+1]);if(lt>0===ct)for(let ut=0,Ct=Ye.length;ut<Ct/2;ut+=2){const Zt=Ye[ut],Xt=Ye[ut+1];Ye[ut]=Ye[Ct-2-ut],Ye[ut+1]=Ye[Ct-1-ut],Ye[Ct-2-ut]=Zt,Ye[Ct-1-ut]=Xt}}(it,je),ft.push(it)}const Of={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class dh{constructor(le,pe){const Se=(pe=this.options=function(je,We){for(const it in We)je[it]=We[it];return je}(Object.create(Of),pe)).debug;if(Se&&console.time("preprocess data"),pe.maxZoom<0||pe.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(pe.promoteId&&pe.generateId)throw new Error("promoteId and generateId cannot be used together.");let Le=function(je,We){const it=[];if(je.type==="FeatureCollection")for(let Ye=0;Ye<je.features.length;Ye++)Tl(it,je.features[Ye],We,Ye);else Tl(it,je.type==="Feature"?je:{geometry:je},We);return it}(le,pe);this.tiles={},this.tileCoords=[],Se&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",pe.indexMaxZoom,pe.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),Le=function(je,We){const it=We.buffer/We.extent;let Ye=je;const ct=da(je,1,-1-it,it,0,-1,2,We),lt=da(je,1,1-it,2+it,0,-1,2,We);return(ct||lt)&&(Ye=da(je,1,-it,1+it,0,-1,2,We)||[],ct&&(Ye=Za(ct,1).concat(Ye)),lt&&(Ye=Ye.concat(Za(lt,-1)))),Ye}(Le,pe),Le.length&&this.splitTile(Le,0,0,0),Se&&(Le.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(le,pe,Se,Le,je,We,it){const Ye=[le,pe,Se,Le],ct=this.options,lt=ct.debug;for(;Ye.length;){Le=Ye.pop(),Se=Ye.pop(),pe=Ye.pop(),le=Ye.pop();const ut=1<<pe,Ct=vi(pe,Se,Le);let Zt=this.tiles[Ct];if(!Zt&&(lt>1&&console.time("creation"),Zt=this.tiles[Ct]=nl(le,pe,Se,Le,ct),this.tileCoords.push({z:pe,x:Se,y:Le}),lt)){lt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",pe,Se,Le,Zt.numFeatures,Zt.numPoints,Zt.numSimplified),console.timeEnd("creation"));const Pi=`z${pe}`;this.stats[Pi]=(this.stats[Pi]||0)+1,this.total++}if(Zt.source=le,je==null){if(pe===ct.indexMaxZoom||Zt.numPoints<=ct.indexMaxPoints)continue}else{if(pe===ct.maxZoom||pe===je)continue;if(je!=null){const Pi=je-pe;if(Se!==We>>Pi||Le!==it>>Pi)continue}}if(Zt.source=null,le.length===0)continue;lt>1&&console.time("clipping");const Xt=.5*ct.buffer/ct.extent,gn=.5-Xt,Cn=.5+Xt,On=1+Xt;let wn=null,er=null,tr=null,Yn=null,dr=da(le,ut,Se-Xt,Se+Cn,0,Zt.minX,Zt.maxX,ct),vr=da(le,ut,Se+gn,Se+On,0,Zt.minX,Zt.maxX,ct);le=null,dr&&(wn=da(dr,ut,Le-Xt,Le+Cn,1,Zt.minY,Zt.maxY,ct),er=da(dr,ut,Le+gn,Le+On,1,Zt.minY,Zt.maxY,ct),dr=null),vr&&(tr=da(vr,ut,Le-Xt,Le+Cn,1,Zt.minY,Zt.maxY,ct),Yn=da(vr,ut,Le+gn,Le+On,1,Zt.minY,Zt.maxY,ct),vr=null),lt>1&&console.timeEnd("clipping"),Ye.push(wn||[],pe+1,2*Se,2*Le),Ye.push(er||[],pe+1,2*Se,2*Le+1),Ye.push(tr||[],pe+1,2*Se+1,2*Le),Ye.push(Yn||[],pe+1,2*Se+1,2*Le+1)}}getTile(le,pe,Se){le=+le,pe=+pe,Se=+Se;const Le=this.options,{extent:je,debug:We}=Le;if(le<0||le>24)return null;const it=1<<le,Ye=vi(le,pe=pe+it&it-1,Se);if(this.tiles[Ye])return os(this.tiles[Ye],je);We>1&&console.log("drilling down to z%d-%d-%d",le,pe,Se);let ct,lt=le,ut=pe,Ct=Se;for(;!ct&&lt>0;)lt--,ut>>=1,Ct>>=1,ct=this.tiles[vi(lt,ut,Ct)];return ct&&ct.source?(We>1&&(console.log("found parent tile z%d-%d-%d",lt,ut,Ct),console.time("drilling down")),this.splitTile(ct.source,lt,ut,Ct,le,pe,Se),We>1&&console.timeEnd("drilling down"),this.tiles[Ye]?os(this.tiles[Ye],je):null):null}}function vi(ft,le,pe){return 32*((1<<ft)*pe+le)+ft}function Pf(ft,le){const pe=ft.tileID.canonical;if(!this._geoJSONIndex)return void le(null,null);const Se=this._geoJSONIndex.getTile(pe.z,pe.x,pe.y);if(!Se)return void le(null,null);const Le=new jt(Se.features);let je=Ne(Le);je.byteOffset===0&&je.byteLength===je.buffer.byteLength||(je=new Uint8Array(je)),le(null,{vectorTile:Le,rawData:je.buffer})}class If extends He{constructor(le,pe,Se,Le,je,We){super(le,pe,Se,Le,Pf,We),je&&(this.loadGeoJSON=je),this._dynamicIndex=new Vt}loadData(le,pe){const Se=le&&le.request,Le=Se&&Se.collectResourceTiming;this.loadGeoJSON(le,(je,We)=>{if(je||!We)return pe(je);if(typeof We!="object")return pe(new Error(`Input data given to '${le.source}' is not a valid GeoJSON object.`));{try{if(le.filter){const Ye=i.U(le.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Ye.result==="error")throw new Error(Ye.value.map(ct=>`${ct.key}: ${ct.message}`).join(", "));We.features=We.features.filter(ct=>Ye.value.evaluate({zoom:0},ct))}le.dynamic?(We.type==="Feature"&&(We={type:"FeatureCollection",features:[We]}),le.append||(this._dynamicIndex.clear(),this.loaded={}),this._dynamicIndex.load(We.features,this.loaded),le.cluster&&(We.features=this._dynamicIndex.getFeatures())):this.loaded={},this._geoJSONIndex=le.cluster?new zi(function({superclusterOptions:Ye,clusterProperties:ct}){if(!ct||!Ye)return Ye;const lt={},ut={},Ct={accumulated:null,zoom:0},Zt={properties:null},Xt=Object.keys(ct);for(const gn of Xt){const[Cn,On]=ct[gn],wn=i.U(On),er=i.U(typeof Cn=="string"?[Cn,["accumulated"],["get",gn]]:Cn);lt[gn]=wn.value,ut[gn]=er.value}return Ye.map=gn=>{Zt.properties=gn;const Cn={};for(const On of Xt)Cn[On]=lt[On].evaluate(Ct,Zt);return Cn},Ye.reduce=(gn,Cn)=>{Zt.properties=Cn;for(const On of Xt)Ct.accumulated=gn[On],gn[On]=ut[On].evaluate(Ct,Zt)},Ye}(le)).load(We.features):le.dynamic?this._dynamicIndex:function(Ye,ct){return new dh(Ye,ct)}(We,le.geojsonVtOptions)}catch(Ye){return pe(Ye)}const it={};if(Le){const Ye=C(Se);Ye&&(it.resourceTiming={},it.resourceTiming[le.source]=JSON.parse(JSON.stringify(Ye)))}pe(null,it)}})}reloadTile(le,pe){const Se=this.loaded;return Se&&Se[le.uid]?le.partial?pe(null,void 0):super.reloadTile(le,pe):this.loadTile(le,pe)}loadGeoJSON(le,pe){if(le.request)i.n(le.request,pe);else{if(typeof le.data!="string")return pe(new Error(`Input data given to '${le.source}' is not a valid GeoJSON object.`));try{return pe(null,JSON.parse(le.data))}catch{return pe(new Error(`Input data given to '${le.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(le,pe){try{pe(null,this._geoJSONIndex.getClusterExpansionZoom(le.clusterId))}catch(Se){pe(Se)}}getClusterChildren(le,pe){try{pe(null,this._geoJSONIndex.getChildren(le.clusterId))}catch(Se){pe(Se)}}getClusterLeaves(le,pe){try{pe(null,this._geoJSONIndex.getLeaves(le.clusterId,le.limit,le.offset))}catch(Se){pe(Se)}}}class ph{constructor(le,pe){this.tileID=new i.aG(le.tileID.overscaledZ,le.tileID.wrap,le.tileID.canonical.z,le.tileID.canonical.x,le.tileID.canonical.y),this.tileZoom=le.tileZoom,this.uid=le.uid,this.zoom=le.zoom,this.canonical=le.tileID.canonical,this.pixelRatio=le.pixelRatio,this.tileSize=le.tileSize,this.source=le.source,this.overscaling=this.tileID.overscaleFactor(),this.projection=le.projection,this.brightness=pe}parse(le,pe,Se,Le){this.status="parsing";const je=new i.aG(Se.tileID.overscaledZ,Se.tileID.wrap,Se.tileID.canonical.z,Se.tileID.canonical.x,Se.tileID.canonical.y),We=[],it=pe.familiesBySource[Se.source],Ye=new i.d$(je,Se.promoteId);return Ye.bucketLayerIDs=[],Ye.is3DTile=!0,i.ea(le).then(ct=>{if(!ct)return Le(new Error("Could not parse tile"));const lt=i.eb(ct,1/i.cc(Se.tileID.canonical)),ut=ct.json.extensionsUsed&&ct.json.extensionsUsed.includes("MAPBOX_mesh_features")||ct.json.asset.extras&&ct.json.asset.extras.MAPBOX_mesh_features,Ct=ct.json.extensionsUsed&&ct.json.extensionsUsed.includes("EXT_meshopt_compression"),Zt=new i.a8(this.zoom,{brightness:this.brightness});for(const Xt in it)for(const gn of it[Xt]){const Cn=gn[0];Ye.bucketLayerIDs.push(gn.map(wn=>i.aC(wn.id,wn.scope))),Cn.recalculate(Zt,[]);const On=new i.ec(gn,lt,je,ut,Ct,this.brightness,Ye);ut||(On.needsUpload=!0),We.push(On),On.evaluate(Cn)}this.status="done",Le(null,{buckets:We,featureIndex:Ye,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:null})}).catch(ct=>Le(new Error(ct.message)))}}class ma{constructor(le,pe,Se,Le,je,We){this.actor=le,this.layerIndex=pe,this.availableImages=Se,this.brightness=We,this.loading={},this.loaded={}}loadTile(le,pe){const Se=le.uid,Le=this.loading[Se]=new ph(le,this.brightness);i.bi(le.request,(je,We)=>{const it=!this.loading[Se];return delete this.loading[Se],it||je?(Le.status="done",it||(this.loaded[Se]=Le),pe(je)):We&&We.byteLength!==0?void Le.parse(We,this.layerIndex,le,(Ye,ct)=>{Le.status="done",this.loaded=this.loaded||{},this.loaded[Se]=Le,Ye||!ct?pe(Ye):pe(null,ct)}):(Le.status="done",this.loaded[Se]=Le,pe())})}reloadTile(le,pe){const Se=this.loaded,Le=le.uid;if(Se&&Se[Le]){const je=Se[Le];je.projection=le.projection,je.brightness=le.brightness;const We=(it,Ye)=>{je.reloadCallback&&(delete je.reloadCallback,this.loadTile(le,pe)),pe(it,Ye)};je.status==="parsing"?je.reloadCallback=We:je.status==="done"&&this.loadTile(le,pe)}}abortTile(le,pe){const Se=le.uid;this.loading[Se]&&delete this.loading[Se],pe()}removeTile(le,pe){const Se=this.loaded,Le=le.uid;Se&&Se[Le]&&delete Se[Le],pe()}}class Ds{constructor(le){this.self=le,this.actor=new i.ed(le,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.imageRasterizer=new i.I,this.projections={},this.defaultProjection=i.bP({name:"mercator"}),this.workerSourceTypes={vector:He,geojson:If,"batched-model":ma},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(pe,Se)=>{if(this.workerSourceTypes[pe])throw new Error(`Worker source with name "${pe}" already registered.`);this.workerSourceTypes[pe]=Se},this.self.registerRTLTextPlugin=pe=>{if(i.ee.isParsed())throw new Error("RTL text plugin already registered.");i.ee.applyArabicShaping=pe.applyArabicShaping,i.ee.processBidirectionalText=pe.processBidirectionalText,i.ee.processStyledBidirectionalText=pe.processStyledBidirectionalText}}clearCaches(le,pe,Se){delete this.layerIndexes[le],delete this.availableImages[le],delete this.workerSources[le],delete this.demWorkerSources[le],delete this.rasterArrayWorkerSource,Se()}checkIfReady(le,pe,Se){Se()}setReferrer(le,pe){this.referrer=pe}spriteLoaded(le,{scope:pe,isLoaded:Se}){if(this.isSpriteLoaded[le]||(this.isSpriteLoaded[le]={}),this.isSpriteLoaded[le][pe]=Se,this.workerSources[le]&&this.workerSources[le][pe])for(const Le in this.workerSources[le][pe]){const je=this.workerSources[le][pe][Le];for(const We in je){const it=je[We];it instanceof He&&(it.isSpriteLoaded=Se,it.fire(new i.z("isSpriteLoaded")))}}}setImages(le,{scope:pe,images:Se},Le){if(this.availableImages[le]||(this.availableImages[le]={}),this.availableImages[le][pe]=Se,this.workerSources[le]&&this.workerSources[le][pe]){for(const je in this.workerSources[le][pe]){const We=this.workerSources[le][pe][je];for(const it in We)We[it].availableImages=Se}Le()}else Le()}setProjection(le,pe){this.projections[le]=i.bP(pe)}setBrightness(le,pe,Se){this.brightness=pe,Se()}setLayers(le,pe,Se){this.getLayerIndex(le,pe.scope).replace(pe.layers,pe.options),Se()}updateLayers(le,pe,Se){this.getLayerIndex(le,pe.scope).update(pe.layers,pe.removedIds,pe.options),Se()}loadTile(le,pe,Se){pe.projection=this.projections[le]||this.defaultProjection,this.getWorkerSource(le,pe.type,pe.source,pe.scope).loadTile(pe,Se)}loadDEMTile(le,pe,Se){this.getDEMWorkerSource(le,pe.source,pe.scope).loadTile(pe,Se)}decodeRasterArray(le,pe,Se){this.getRasterArrayWorkerSource().decodeRasterArray(pe,Se)}reloadTile(le,pe,Se){pe.projection=this.projections[le]||this.defaultProjection,this.getWorkerSource(le,pe.type,pe.source,pe.scope).reloadTile(pe,Se)}abortTile(le,pe,Se){this.getWorkerSource(le,pe.type,pe.source,pe.scope).abortTile(pe,Se)}removeTile(le,pe,Se){this.getWorkerSource(le,pe.type,pe.source,pe.scope).removeTile(pe,Se)}removeSource(le,pe,Se){if(!(this.workerSources[le]&&this.workerSources[le][pe.scope]&&this.workerSources[le][pe.scope][pe.type]&&this.workerSources[le][pe.scope][pe.type][pe.source]))return;const Le=this.workerSources[le][pe.scope][pe.type][pe.source];delete this.workerSources[le][pe.scope][pe.type][pe.source],Le.removeSource!==void 0?Le.removeSource(pe,Se):Se()}loadWorkerSource(le,pe,Se){try{this.self.importScripts(pe.url),Se()}catch(Le){Se(Le.toString())}}syncRTLPluginState(le,pe,Se){try{i.ee.setState(pe);const Le=i.ee.getPluginURL();if(i.ee.isLoaded()&&!i.ee.isParsed()&&Le!=null){this.self.importScripts(Le);const je=i.ee.isParsed();Se(je?void 0:new Error(`RTL Text Plugin failed to import scripts from ${Le}`),je)}}catch(Le){Se(Le.toString())}}setDracoUrl(le,pe){this.dracoUrl=pe}getAvailableImages(le,pe){this.availableImages[le]||(this.availableImages[le]={});let Se=this.availableImages[le][pe];return Se||(Se=[]),Se}getLayerIndex(le,pe){this.layerIndexes[le]||(this.layerIndexes[le]={});let Se=this.layerIndexes[le][pe];return Se||(Se=this.layerIndexes[le][pe]=new F,Se.scope=pe),Se}getWorkerSource(le,pe,Se,Le){return this.workerSources[le]||(this.workerSources[le]={}),this.workerSources[le][Le]||(this.workerSources[le][Le]={}),this.workerSources[le][Le][pe]||(this.workerSources[le][Le][pe]={}),this.isSpriteLoaded[le]||(this.isSpriteLoaded[le]={}),this.workerSources[le][Le][pe][Se]||(this.workerSources[le][Le][pe][Se]=new this.workerSourceTypes[pe]({send:(je,We,it,Ye,ct,lt)=>{this.actor.send(je,We,it,le,ct,lt)},scheduler:this.actor.scheduler},this.getLayerIndex(le,Le),this.getAvailableImages(le,Le),this.isSpriteLoaded[le][Le],void 0,this.brightness)),this.workerSources[le][Le][pe][Se]}rasterizeImages(le,pe,Se){const{imageTasks:Le,scope:je}=pe,We={};for(const it in Le){const{image:Ye,imageIdWithOptions:ct}=Le[it];We[it]=this.imageRasterizer.rasterize(ct,Ye,je,le)}Se(void 0,We)}removeRasterizedImages(le,pe,Se){const{imageIds:Le,scope:je}=pe;this.imageRasterizer.removeImagesFromCacheByIds(Le,je,le),Se()}getDEMWorkerSource(le,pe,Se){return this.demWorkerSources[le]||(this.demWorkerSources[le]={}),this.demWorkerSources[le][Se]||(this.demWorkerSources[le][Se]={}),this.demWorkerSources[le][Se][pe]||(this.demWorkerSources[le][Se][pe]=new ye),this.demWorkerSources[le][Se][pe]}getRasterArrayWorkerSource(){return this.rasterArrayWorkerSource||(this.rasterArrayWorkerSource=new ke),this.rasterArrayWorkerSource}enforceCacheSizeLimit(le,pe){i.ef(pe)}getWorkerPerformanceMetrics(le,pe,Se){Se(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new Ds(self)),Ds}),y(["./shared"],function(i){var C="3.10.0";const I={create:"create",load:"load",fullLoad:"fullLoad"},j={mark(p){performance.mark(p)},measure(p,r,l){performance.measure(p,r,l)}};function F(p){const r=p.name.split("?")[0];return i.a(r)&&r.includes("mapbox-gl.js")?"javascript":i.a(r)&&r.includes("mapbox-gl.css")?"css":i.b(r)?"fontRange":i.c(r)?"sprite":i.i(r)?"style":i.d(r)?"tilejson":"other"}var G,X={},Y=function(){if(G)return X;function p(m){return!r(m)}function r(m){return typeof window>"u"||typeof document>"u"?"not a browser":function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var w,A,D=new Blob([""],{type:"text/javascript"}),N=URL.createObjectURL(D);try{A=new Worker(N),w=!0}catch{w=!1}return A&&A.terminate(),URL.revokeObjectURL(N),w}()?function(){var w=document.createElement("canvas");w.width=w.height=1;var A=w.getContext("2d");if(!A)return!1;var D=A.getImageData(0,0,1,1);return D&&D.width===w.width}()?(l[x=m&&m.failIfMajorPerformanceCaveat]===void 0&&(l[x]=function(w){var A,D=function(N){var U=document.createElement("canvas"),$=Object.create(p.webGLContextAttributes);return $.failIfMajorPerformanceCaveat=N,U.getContext("webgl2",$)}(w);if(!D)return!1;try{A=D.createShader(D.VERTEX_SHADER)}catch{return!1}return!(!A||D.isContextLost())&&(D.shaderSource(A,"void main() {}"),D.compileShader(A),D.getShaderParameter(A,D.COMPILE_STATUS)===!0)}(x)),l[x]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL2 support"):"insufficient Canvas/getImageData support":"insufficient worker support";var x}G=1,X.supported=p,X.notSupportedReason=r;var l={};return p.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0},X}();function J(p,r,l){const m=document.createElement(p);return r!=null&&(m.className=r),l&&l.appendChild(m),m}function ee(p,r,l){const m=document.createElementNS("http://www.w3.org/2000/svg",p);for(const x of Object.keys(r))m.setAttributeNS(null,x,String(r[x]));return l&&l.appendChild(m),m}const oe=typeof document<"u"?document.documentElement&&document.documentElement.style:null,ge=oe&&oe.userSelect!==void 0?"userSelect":"WebkitUserSelect";let fe;function xe(){oe&&ge&&(fe=oe[ge],oe[ge]="none")}function ae(){oe&&ge&&(oe[ge]=fe)}function me(p){p.preventDefault(),p.stopPropagation(),window.removeEventListener("click",me,!0)}function we(){window.addEventListener("click",me,!0),window.setTimeout(()=>{window.removeEventListener("click",me,!0)},0)}function Ge(p,r){const l=p.getBoundingClientRect();return ke(p,l,r)}function He(p,r){const l=p.getBoundingClientRect(),m=[];for(let x=0;x<r.length;x++)m.push(ke(p,l,r[x]));return m}function ye(p){return/firefox/i.test(navigator.userAgent)&&/macintosh/i.test(navigator.userAgent)&&p.button===2&&p.ctrlKey?0:p.button}function ke(p,r,l){const m=p.offsetWidth===r.width?1:p.offsetWidth/r.width;return new i.P((l.clientX-r.left)*m,(l.clientY-r.top)*m)}const dt="01",vt="NO_ACCESS_TOKEN";class jt{constructor(r,l,m){this._transformRequestFn=r,this._customAccessToken=l,this._silenceAuthErrors=!!m,this._createSkuToken()}_createSkuToken(){const r=function(){let l="";for(let m=0;m<10;m++)l+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",dt,l].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=r.token,this._skuTokenExpiresAt=r.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(r,l){return this._transformRequestFn&&this._transformRequestFn(r,l)||{url:r}}normalizeStyleURL(r,l){if(!i.f(r))return r;const m=gt(r);return m.params.push(`sdk=js-${C}`),m.path=`/styles/v1${m.path}`,this._makeAPIURL(m,this._customAccessToken||l)}normalizeGlyphsURL(r,l){if(!i.f(r))return r;const m=gt(r);return m.path=`/fonts/v1${m.path}`,this._makeAPIURL(m,this._customAccessToken||l)}normalizeModelURL(r,l){if(!i.f(r))return r;const m=gt(r);return m.path=`/models/v1${m.path}`,this._makeAPIURL(m,this._customAccessToken||l)}normalizeSourceURL(r,l,m,x){if(!i.f(r))return r;const w=gt(r);return w.path=`/v4/${w.authority}.json`,w.params.push("secure"),m&&w.params.push(`language=${m}`),x&&w.params.push(`worldview=${x}`),this._makeAPIURL(w,this._customAccessToken||l)}normalizeIconsetURL(r,l){const m=gt(r);return i.f(r)?(m.path=`/styles/v1${m.path}/iconset.pbf`,this._makeAPIURL(m,this._customAccessToken||l)):Vt(m)}normalizeSpriteURL(r,l,m,x){const w=gt(r);return i.f(r)?(w.path=`/styles/v1${w.path}/sprite${l}${m}`,this._makeAPIURL(w,this._customAccessToken||x)):(w.path+=`${l}${m}`,Vt(w))}normalizeTileURL(r,l,m){if(this._isSkuTokenExpired()&&this._createSkuToken(),r&&!i.f(r))return r;const x=gt(r);x.path=x.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${l||m&&x.authority!=="raster"&&m===512?"@2x":""}${i.m.supported?".webp":"$1"}`),x.authority==="raster"?x.path=`/${i.e.RASTER_URL_PREFIX}${x.path}`:x.authority==="rasterarrays"?x.path=`/${i.e.RASTERARRAYS_URL_PREFIX}${x.path}`:x.authority==="3dtiles"?x.path=`/${i.e.TILES3D_URL_PREFIX}${x.path}`:(x.path=x.path.replace(/^.+\/v4\//,"/"),x.path=`/${i.e.TILE_URL_VERSION}${x.path}`);const w=this._customAccessToken||function(A){for(const D of A){const N=D.match(/^access_token=(.*)$/);if(N)return N[1]}return null}(x.params)||i.e.ACCESS_TOKEN;return i.e.REQUIRE_ACCESS_TOKEN&&w&&this._skuToken&&x.params.push(`sku=${this._skuToken}`),this._makeAPIURL(x,w)}canonicalizeTileURL(r,l){const m=gt(r);if(!m.path.match(/^(\/v4\/|\/(raster|rasterarrays)\/v1\/)/)||!m.path.match(/\.[\w]+$/))return r;let x="mapbox://";m.path.match(/^\/raster\/v1\//)?x+=`raster/${m.path.replace(`/${i.e.RASTER_URL_PREFIX}/`,"")}`:m.path.match(/^\/rasterarrays\/v1\//)?x+=`rasterarrays/${m.path.replace(`/${i.e.RASTERARRAYS_URL_PREFIX}/`,"")}`:x+=`tiles/${m.path.replace(`/${i.e.TILE_URL_VERSION}/`,"")}`;let w=m.params;return l&&(w=w.filter(A=>!A.match(/^access_token=/))),w.length&&(x+=`?${w.join("&")}`),x}canonicalizeTileset(r,l){const m=!!l&&i.f(l),x=[];for(const w of r.tiles||[])i.h(w)?x.push(this.canonicalizeTileURL(w,m)):x.push(w);return x}_makeAPIURL(r,l){const m="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",x=gt(i.e.API_URL);if(r.protocol=x.protocol,r.authority=x.authority,r.protocol==="http"){const w=r.params.indexOf("secure");w>=0&&r.params.splice(w,1)}if(x.path!=="/"&&(r.path=`${x.path}${r.path}`),!i.e.REQUIRE_ACCESS_TOKEN)return Vt(r);if(l=l||i.e.ACCESS_TOKEN,!this._silenceAuthErrors){if(!l)throw new Error(`An API access token is required to use Mapbox GL. ${m}`);if(l[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${m}`)}return r.params=r.params.filter(w=>w.indexOf("access_token")===-1),r.params.push(`access_token=${l||""}`),Vt(r)}}const _t=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function gt(p){const r=p.match(_t);if(!r)throw new Error("Unable to parse URL object");return{protocol:r[1],authority:r[2],path:r[3]||"/",params:r[4]?r[4].split("&"):[]}}function Vt(p){const r=p.params.length?`?${p.params.join("&")}`:"";return`${p.protocol}://${p.authority}${p.path}${r}`}const Ht="mapbox.eventData";function Bt(p){if(!p)return null;const r=p.split(".");if(!r||r.length!==3)return null;try{return JSON.parse(i.j(r[1]))}catch{return null}}class et{constructor(r){this.type=r,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(r){const l=Bt(i.e.ACCESS_TOKEN);let m="";return m=l&&l.u?i.k(l.u):i.e.ACCESS_TOKEN||"",r?`${Ht}.${r}:${m}`:`${Ht}:${m}`}fetchEventData(){const r=i.s("localStorage"),l=this.getStorageKey(),m=this.getStorageKey("uuid");if(r)try{const x=localStorage.getItem(l);x&&(this.eventData=JSON.parse(x));const w=localStorage.getItem(m);w&&(this.anonId=w)}catch{i.w("Unable to read from LocalStorage")}}saveEventData(){const r=i.s("localStorage"),l=this.getStorageKey(),m=this.getStorageKey("uuid"),x=this.anonId;if(r&&x)try{localStorage.setItem(m,x),Object.keys(this.eventData).length>=1&&localStorage.setItem(l,JSON.stringify(this.eventData))}catch{i.w("Unable to write to LocalStorage")}}processRequests(r){}postEvent(r,l,m,x){if(!i.e.EVENTS_URL)return;const w=gt(i.e.EVENTS_URL);w.params.push(`access_token=${x||i.e.ACCESS_TOKEN||""}`);const A={event:this.type,created:new Date(r).toISOString()},D=l?i.l(A,l):A,N={url:Vt(w),headers:{"Content-Type":"text/plain"},body:JSON.stringify([D])};this.pendingRequest=i.p(N,U=>{this.pendingRequest=null,m(U),this.saveEventData(),this.processRequests(x)})}queueRequest(r,l){this.queue.push(r),this.processRequests(l)}}const $t=new class extends et{constructor(p){super("appUserTurnstile"),this._customAccessToken=p}postTurnstileEvent(p,r){i.e.EVENTS_URL&&i.e.ACCESS_TOKEN&&Array.isArray(p)&&p.some(l=>i.f(l)||i.h(l))&&this.queueRequest(Date.now(),r)}processRequests(p){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const r=Bt(i.e.ACCESS_TOKEN),l=r?r.u:i.e.ACCESS_TOKEN;let m=l!==this.eventData.tokenU;i.v(this.anonId)||(this.anonId=i.u(),m=!0);const x=this.queue.shift();if(this.eventData.lastSuccess){const w=new Date(this.eventData.lastSuccess),A=new Date(x),D=(x-this.eventData.lastSuccess)/864e5;m=m||D>=1||D<-1||w.getDate()!==A.getDate()}else m=!0;m?this.postEvent(x,{sdkIdentifier:"mapbox-gl-js",sdkVersion:C,skuId:dt,"enabled.telemetry":!1,userId:this.anonId},w=>{w||(this.eventData.lastSuccess=x,this.eventData.tokenU=l)},p):this.processRequests()}},rn=$t.postTurnstileEvent.bind($t),Nt=new class extends et{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(p,r,l,m){this.skuToken=r,this.errorCb=m,i.e.EVENTS_URL&&(l||i.e.ACCESS_TOKEN?this.queueRequest({id:p,timestamp:Date.now()},l):this.errorCb(new Error(vt)))}processRequests(p){if(this.pendingRequest||this.queue.length===0)return;const{id:r,timestamp:l}=this.queue.shift();r&&this.success[r]||(this.anonId||this.fetchEventData(),i.v(this.anonId)||(this.anonId=i.u()),this.postEvent(l,{sdkIdentifier:"mapbox-gl-js",sdkVersion:C,skuId:dt,skuToken:this.skuToken,userId:this.anonId},m=>{m?this.errorCb(m):r&&(this.success[r]=!0)},p))}remove(){this.errorCb=null}},xn=Nt.postMapLoadEvent.bind(Nt),rr=new class extends et{constructor(){super("style.load"),this.eventIdPerMapInstanceMap=new Map,this.mapInstanceIdMap=new WeakMap}getMapInstanceId(p){let r=this.mapInstanceIdMap.get(p);return r||(r=i.u(),this.mapInstanceIdMap.set(p,r)),r}getEventId(p){const r=this.eventIdPerMapInstanceMap.get(p)||0;return this.eventIdPerMapInstanceMap.set(p,r+1),r}postStyleLoadEvent(p,r){const{map:l,style:m,importedStyles:x}=r;if(!i.e.EVENTS_URL||!p&&!i.e.ACCESS_TOKEN)return;const w=this.getMapInstanceId(l),A={mapInstanceId:w,eventId:this.getEventId(w),style:m};x.length&&(A.importedStyles=x),this.queueRequest({timestamp:Date.now(),payload:A},p)}processRequests(p){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:r,payload:l}=this.queue.shift();this.postEvent(r,l,()=>{},p)}},Xn=rr.postStyleLoadEvent.bind(rr),yi=new class extends et{constructor(){super("gljs.performance")}postPerformanceEvent(p,r){i.e.EVENTS_URL&&(p||i.e.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:r},p)}processRequests(p){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:r,performanceData:l}=this.queue.shift(),m=function(x){const w=performance.getEntriesByType("resource"),A=performance.getEntriesByType("mark"),D=function(te){const ue={};if(te){for(const se in te)if(se!=="other")for(const de of te[se]){const he=`${se}ResolveRangeMin`,Te=`${se}ResolveRangeMax`,Pe=`${se}RequestCount`,Me=`${se}RequestCachedCount`;ue[he]=Math.min(ue[he]||1/0,de.startTime),ue[Te]=Math.max(ue[Te]||-1/0,de.responseEnd);const Fe=Re=>{ue[Re]===void 0&&(ue[Re]=0),++ue[Re]};de.transferSize!==void 0&&de.transferSize===0&&Fe(Me),Fe(Pe)}}return ue}(function(te,ue){const se={};if(te)for(const de of te){const he=ue(de);se[he]===void 0&&(se[he]=[]),se[he].push(de)}return se}(w,F)),N=window.devicePixelRatio,U=navigator.connection||navigator.mozConnection||navigator.webkitConnection,$=U?U.effectiveType:void 0,Z={counters:[],metadata:[],attributes:[]},W=(te,ue,se)=>{se!=null&&te.push({name:ue,value:se.toString()})};for(const te in D)W(Z.counters,te,D[te]);if(x.interactionRange[0]!==1/0&&x.interactionRange[1]!==-1/0&&(W(Z.counters,"interactionRangeMin",x.interactionRange[0]),W(Z.counters,"interactionRangeMax",x.interactionRange[1])),A)for(const te of Object.keys(I)){const ue=I[te],se=A.find(de=>de.name===ue);se&&W(Z.counters,ue,se.startTime)}return W(Z.counters,"visibilityHidden",x.visibilityHidden),W(Z.attributes,"style",function(te){if(te)for(const ue of te){const se=ue.name.split("?")[0];if(i.i(se)){const de=se.split("/").slice(-2);if(de.length===2)return`mapbox://styles/${de[0]}/${de[1]}`}}}(w)),W(Z.attributes,"terrainEnabled",x.terrainEnabled?"true":"false"),W(Z.attributes,"fogEnabled",x.fogEnabled?"true":"false"),W(Z.attributes,"projection",x.projection),W(Z.attributes,"zoom",x.zoom),W(Z.metadata,"devicePixelRatio",N),W(Z.metadata,"connectionEffectiveType",$),W(Z.metadata,"navigatorUserAgent",navigator.userAgent),W(Z.metadata,"screenWidth",window.screen.width),W(Z.metadata,"screenHeight",window.screen.height),W(Z.metadata,"windowWidth",window.innerWidth),W(Z.metadata,"windowHeight",window.innerHeight),W(Z.metadata,"mapWidth",x.width/N),W(Z.metadata,"mapHeight",x.height/N),W(Z.metadata,"webglRenderer",x.renderer),W(Z.metadata,"webglVendor",x.vendor),W(Z.metadata,"sdkVersion",C),W(Z.metadata,"sdkIdentifier","mapbox-gl-js"),Z}(l);for(const x of m.metadata);for(const x of m.counters);for(const x of m.attributes);this.postEvent(r,m,()=>{},p)}},ir=yi.postPerformanceEvent.bind(yi),yn=new class extends et{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(p,r,l,m){if(!i.e.API_URL||!i.e.SESSION_PATH)return;const x=gt(i.e.API_URL+i.e.SESSION_PATH);x.params.push(`sku=${r||""}`),x.params.push(`access_token=${m||i.e.ACCESS_TOKEN||""}`);const w={url:Vt(x),headers:{"Content-Type":"text/plain"}};this.pendingRequest=i.g(w,A=>{this.pendingRequest=null,l(A),this.saveEventData(),this.processRequests(m)})}getSessionAPI(p,r,l,m){this.skuToken=r,this.errorCb=m,i.e.SESSION_PATH&&i.e.API_URL&&(l||i.e.ACCESS_TOKEN?this.queueRequest({id:p,timestamp:Date.now()},l):this.errorCb(new Error(vt)))}processRequests(p){if(this.pendingRequest||this.queue.length===0)return;const{id:r,timestamp:l}=this.queue.shift();r&&this.success[r]||this.getSession(l,this.skuToken,m=>{m?this.errorCb(m):r&&(this.success[r]=!0)},p)}remove(){this.errorCb=null}},Ne=yn.getSessionAPI.bind(yn),Qn=new Set;function fn(p,r){r?Qn.add(p):Qn.delete(p)}class Dr{constructor(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps=new Set,this._updatedImages=new Set}isDirty(){return this._changed}setDirty(){this._changed=!0}getUpdatedSourceCaches(){return this._updatedSourceCaches}updateSourceCache(r,l){this._updatedSourceCaches[r]=l,this.setDirty()}discardSourceCacheUpdate(r){delete this._updatedSourceCaches[r]}updateLayer(r){const l=r.scope;this._updatedLayers[l]=this._updatedLayers[l]||new Set,this._updatedLayers[l].add(r.id),this.setDirty()}removeLayer(r){const l=r.scope;this._removedLayers[l]=this._removedLayers[l]||{},this._updatedLayers[l]=this._updatedLayers[l]||new Set,this._removedLayers[l][r.id]=r,this._updatedLayers[l].delete(r.id),this._updatedPaintProps.delete(r.fqid),this.setDirty()}getRemovedLayer(r){return this._removedLayers[r.scope]?this._removedLayers[r.scope][r.id]:null}discardLayerRemoval(r){this._removedLayers[r.scope]&&delete this._removedLayers[r.scope][r.id]}getLayerUpdatesByScope(){const r={};for(const l in this._updatedLayers)r[l]=r[l]||{},r[l].updatedIds=Array.from(this._updatedLayers[l].values());for(const l in this._removedLayers)r[l]=r[l]||{},r[l].removedIds=Object.keys(this._removedLayers[l]);return r}getUpdatedPaintProperties(){return this._updatedPaintProps}updatePaintProperties(r){this._updatedPaintProps.add(r.fqid),this.setDirty()}getUpdatedImages(){return Array.from(this._updatedImages.values())}updateImage(r){this._updatedImages.add(r),this.setDirty()}resetUpdatedImages(){this._updatedImages.clear()}reset(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps.clear(),this._updatedImages.clear()}}function Pt(p){const{userImage:r}=p;return!!(r&&r.render&&r.render())&&(p.data.replace(new Uint8Array(r.data.buffer)),!0)}class Pr extends i.E{constructor(r){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded={},this.requestors=[],this.patterns={},this.atlasImage={},this.atlasTexture={},this.dirty=!0,this.spriteFormat=r,r!=="raster"&&i.t()&&(this.imageRasterizerDispatcher=new i.D(i.x(),this,"Image Rasterizer Worker",1))}get imageRasterizer(){return this._imageRasterizer||(this._imageRasterizer=new i.I),this._imageRasterizer}createScope(r){this.images[r]={},this.loaded[r]=!1,this.updatedImages[r]={},this.patterns[r]={},this.callbackDispatchedThisFrame[r]={},this.atlasImage[r]=new i.r({width:1,height:1})}isLoaded(){for(const r in this.loaded)if(!this.loaded[r])return!1;return!0}setLoaded(r,l){if(this.loaded[l]!==r&&(this.loaded[l]=r,r)){for(const{ids:m,callback:x}of this.requestors)this._notify(m,l,x);this.requestors=[]}}hasImage(r,l){return!!this.getImage(r,l)}getImage(r,l){return this.images[l][r]}addImage(r,l,m){this._validate(r,m)&&(this.images[l][r]=m)}_validate(r,l){let m=!0;return this._validateStretch(l.stretchX,l.data&&l.data.width)||(this.fire(new i.y(new Error(`Image "${r}" has invalid "stretchX" value`))),m=!1),this._validateStretch(l.stretchY,l.data&&l.data.height)||(this.fire(new i.y(new Error(`Image "${r}" has invalid "stretchY" value`))),m=!1),this._validateContent(l.content,l)||(this.fire(new i.y(new Error(`Image "${r}" has invalid "content" value`))),m=!1),m}_validateStretch(r,l){if(!r)return!0;let m=0;for(const x of r){if(x[0]<m||x[1]<x[0]||l<x[1])return!1;m=x[1]}return!0}_validateContent(r,l){return r?r.length!==4||!l.usvg&&(r[0]<0||l.data.width<r[0]||r[1]<0||l.data.height<r[1]||r[2]<0||l.data.width<r[2]||r[3]<0||l.data.height<r[3])?!1:!(r[2]<r[0]||r[3]<r[1]):!0}updateImage(r,l,m){m.version=this.images[l][r].version+1,this.images[l][r]=m,this.updatedImages[l][r]=!0,this.removeFromImageRasterizerCache(r,l)}removeFromImageRasterizerCache(r,l){this.spriteFormat!=="raster"&&(i.t()?this.imageRasterizerDispatcher.getActor().send("removeRasterizedImages",{imageIds:[r],scope:l}):this.imageRasterizer.removeImagesFromCacheByIds([r],l))}removeImage(r,l){const m=this.images[l][r];delete this.images[l][r],delete this.patterns[l][r],this.removeFromImageRasterizerCache(r,l),m.userImage&&m.userImage.onRemove&&m.userImage.onRemove()}listImages(r){return Object.keys(this.images[r])}getImages(r,l,m){let x=!0;const w=!!this.loaded[l];if(!w)for(const A of r)this.images[l][A]||(x=!1);w||x?this._notify(r,l,m):this.requestors.push({ids:r,scope:l,callback:m})}rasterizeImages({scope:r,imageTasks:l},m){const x={};for(const w in l){const A=l[w],D=this.getImage(A.id,r);D&&(x[w]={image:D,imageIdWithOptions:A})}i.t()?this.imageRasterizerDispatcher.getActor().send("rasterizeImages",{imageTasks:x,scope:r},m):this.rasterizeImagesInMainThread({imageTasks:x,scope:r},m)}rasterizeImagesInMainThread(r,l){const{imageTasks:m,scope:x}=r,w={};for(const A in m){const{image:D,imageIdWithOptions:N}=m[A];w[A]=this.imageRasterizer.rasterize(N,D,x,"")}l(void 0,w)}getUpdatedImages(r){return this.updatedImages[r]}_notify(r,l,m){const x={};for(const w of r){this.images[l][w]||this.fire(new i.z("styleimagemissing",{id:w}));const A=this.images[l][w];A?x[w]={data:A.usvg?null:A.data.clone(),pixelRatio:A.pixelRatio,sdf:A.sdf,usvg:A.usvg,version:A.version,stretchX:A.stretchX,stretchY:A.stretchY,content:A.content,hasRenderCallback:!!(A.userImage&&A.userImage.render)}:i.w(`Image "${w}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}m(null,x)}getPixelSize(r){const{width:l,height:m}=this.atlasImage[r];return{width:l,height:m}}getPattern(r,l,m){const x=this.patterns[l][r],w=this.getImage(r,l);if(!w)return null;if(x&&x.position.version===w.version)return x.position;if(x)x.position.version=w.version;else{w.usvg&&!w.data&&(w.data=this.imageRasterizer.rasterize(i.A.from(r).getPrimary(),w,l,""));const A={w:w.data.width+2*i.B,h:w.data.height+2*i.B,x:0,y:0},D=new i.C(A,w,i.B);this.patterns[l][r]={bin:A,position:D}}return this._updatePatternAtlas(l,m),this.patterns[l][r].position}bind(r,l){const m=r.gl;let x=this.atlasTexture[l];x?this.dirty&&(x.update(this.atlasImage[l]),this.dirty=!1):(x=new i.T(r,this.atlasImage[l],m.RGBA8),this.atlasTexture[l]=x),x.bind(m.LINEAR,m.CLAMP_TO_EDGE)}_updatePatternAtlas(r,l){const m=[];for(const D in this.patterns[r])m.push(this.patterns[r][D].bin);const{w:x,h:w}=i.F(m),A=this.atlasImage[r];A.resize({width:x||1,height:w||1});for(const D in this.patterns[r]){const{bin:N,position:U}=this.patterns[r][D];let $=U.padding;const Z=N.x+$,W=N.y+$,te=this.images[r][D].data,ue=te.width,se=te.height;$=$>1?$-1:$,i.r.copy(te,A,{x:0,y:0},{x:Z,y:W},{width:ue,height:se},l),i.r.copy(te,A,{x:0,y:se-$},{x:Z,y:W-$},{width:ue,height:$},l),i.r.copy(te,A,{x:0,y:0},{x:Z,y:W+se},{width:ue,height:$},l),i.r.copy(te,A,{x:ue-$,y:0},{x:Z-$,y:W},{width:$,height:se},l),i.r.copy(te,A,{x:0,y:0},{x:Z+ue,y:W},{width:$,height:se},l),i.r.copy(te,A,{x:ue-$,y:se-$},{x:Z-$,y:W-$},{width:$,height:$},l),i.r.copy(te,A,{x:0,y:se-$},{x:Z+ue,y:W-$},{width:$,height:$},l),i.r.copy(te,A,{x:0,y:0},{x:Z+ue,y:W+se},{width:$,height:$},l),i.r.copy(te,A,{x:ue-$,y:0},{x:Z-$,y:W+se},{width:$,height:$},l)}this.dirty=!0}beginFrame(){for(const r in this.images)this.callbackDispatchedThisFrame[r]={}}dispatchRenderCallbacks(r,l){for(const m of r){if(this.callbackDispatchedThisFrame[l][m])continue;this.callbackDispatchedThisFrame[l][m]=!0;const x=this.images[l][m];Pt(x)&&this.updateImage(m,l,x)}}}function Cr(p){const r=p.key,l=p.value,m=p.valueSpec||{},x=p.objectElementValidators||{},w=p.style,A=p.styleSpec;let D=[];const N=i.H(l);if(N!=="object")return[new i.V(r,l,`object expected, ${N} found`)];for(const U in l){const $=U.split(".")[0];let Z;x[$]?Z=x[$]:m[$]?Z=qn:x["*"]?Z=x["*"]:m["*"]&&(Z=qn),Z?D=D.concat(Z({key:(r&&`${r}.`)+U,value:l[U],valueSpec:m[$]||m["*"],style:w,styleSpec:A,object:l,objectKey:U},l)):D.push(new i.G(r,l[U],`unknown property "${U}"`))}for(const U in m)x[U]||m[U].required&&m[U].default===void 0&&l[U]===void 0&&D.push(new i.V(r,l,`missing required property "${U}"`));return D}function zi(p){const r=p.value,l=p.valueSpec,m=p.style,x=p.styleSpec,w=p.key,A=p.arrayElementValidator||qn;if(i.H(r)!=="array")return[new i.V(w,r,`array expected, ${i.H(r)} found`)];if(l.length&&r.length!==l.length)return[new i.V(w,r,`array length ${l.length} expected, length ${r.length} found`)];if(l["min-length"]&&r.length<l["min-length"])return[new i.V(w,r,`array length at least ${l["min-length"]} expected, length ${r.length} found`)];let D={type:l.value,values:l.values,minimum:l.minimum,maximum:l.maximum,function:void 0};x.$version<7&&(D.function=l.function),i.H(l.value)==="object"&&(D=l.value);let N=[];for(let U=0;U<r.length;U++)N=N.concat(A({array:r,arrayIndex:U,value:r[U],valueSpec:D,style:m,styleSpec:x,key:`${w}[${U}]`},!0));return N}function $n(p){const r=p.key,l=p.value,m=p.valueSpec;let x=i.H(l);if(x==="number"&&l!=l&&(x="NaN"),x!=="number")return[new i.V(r,l,`number expected, ${x} found`)];if("minimum"in m){let w=m.minimum;if(i.H(m.minimum)==="array"&&(w=m.minimum[p.arrayIndex]),l<w)return[new i.V(r,l,`${l} is less than the minimum value ${w}`)]}if("maximum"in m){let w=m.maximum;if(i.H(m.maximum)==="array"&&(w=m.maximum[p.arrayIndex]),l>w)return[new i.V(r,l,`${l} is greater than the maximum value ${w}`)]}return[]}function si(p){const r=p.valueSpec,l=i.K(p.value.type);let m,x,w,A={};const D=l!=="categorical"&&p.value.property===void 0,N=!D,U=i.H(p.value.stops)==="array"&&i.H(p.value.stops[0])==="array"&&i.H(p.value.stops[0][0])==="object",$=Cr({key:p.key,value:p.value,valueSpec:p.styleSpec.function,style:p.style,styleSpec:p.styleSpec,objectElementValidators:{stops:function(te){if(l==="identity")return[new i.V(te.key,te.value,'identity function may not have a "stops" property')];let ue=[];const se=te.value;return ue=ue.concat(zi({key:te.key,value:se,valueSpec:te.valueSpec,style:te.style,styleSpec:te.styleSpec,arrayElementValidator:Z})),i.H(se)==="array"&&se.length===0&&ue.push(new i.V(te.key,se,"array must have at least one stop")),ue},default:function(te){return qn({key:te.key,value:te.value,valueSpec:r,style:te.style,styleSpec:te.styleSpec})}}});return l==="identity"&&D&&$.push(new i.V(p.key,p.value,'missing required property "property"')),l==="identity"||p.value.stops||$.push(new i.V(p.key,p.value,'missing required property "stops"')),l==="exponential"&&p.valueSpec.expression&&!i.L(p.valueSpec)&&$.push(new i.V(p.key,p.value,"exponential functions not supported")),p.styleSpec.$version>=8&&(N&&!i.M(p.valueSpec)?$.push(new i.V(p.key,p.value,"property functions not supported")):D&&!i.N(p.valueSpec)&&$.push(new i.V(p.key,p.value,"zoom functions not supported"))),l!=="categorical"&&!U||p.value.property!==void 0||$.push(new i.V(p.key,p.value,'"property" property is required')),$;function Z(te){let ue=[];const se=te.value,de=te.key;if(i.H(se)!=="array")return[new i.V(de,se,`array expected, ${i.H(se)} found`)];if(se.length!==2)return[new i.V(de,se,`array length 2 expected, length ${se.length} found`)];if(U){if(i.H(se[0])!=="object")return[new i.V(de,se,`object expected, ${i.H(se[0])} found`)];if(se[0].zoom===void 0)return[new i.V(de,se,"object stop key must have zoom")];if(se[0].value===void 0)return[new i.V(de,se,"object stop key must have value")];const he=i.K(se[0].zoom);if(typeof he!="number")return[new i.V(de,se[0].zoom,"stop zoom values must be numbers")];if(w&&w>he)return[new i.V(de,se[0].zoom,"stop zoom values must appear in ascending order")];he!==w&&(w=he,x=void 0,A={}),ue=ue.concat(Cr({key:`${de}[0]`,value:se[0],valueSpec:{zoom:{}},style:te.style,styleSpec:te.styleSpec,objectElementValidators:{zoom:$n,value:W}}))}else ue=ue.concat(W({key:`${de}[0]`,value:se[0],style:te.style,styleSpec:te.styleSpec},se));return i.O(i.Q(se[1]))?ue.concat([new i.V(`${de}[1]`,se[1],"expressions are not allowed in function stops.")]):ue.concat(qn({key:`${de}[1]`,value:se[1],valueSpec:r,style:te.style,styleSpec:te.styleSpec}))}function W(te,ue){const se=i.H(te.value),de=i.K(te.value),he=te.value!==null?te.value:ue;if(m){if(se!==m)return[new i.V(te.key,he,`${se} stop domain type must match previous stop domain type ${m}`)]}else m=se;if(se!=="number"&&se!=="string"&&se!=="boolean"&&typeof de!="number"&&typeof de!="string"&&typeof de!="boolean")return[new i.V(te.key,he,"stop domain value must be a number, string, or boolean")];if(se!=="number"&&l!=="categorical"){let Te=`number expected, ${se} found`;return i.M(r)&&l===void 0&&(Te+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new i.V(te.key,he,Te)]}return l!=="categorical"||se!=="number"||typeof de=="number"&&isFinite(de)&&Math.floor(de)===de?l!=="categorical"&&se==="number"&&typeof de=="number"&&typeof x=="number"&&x!==void 0&&de<x?[new i.V(te.key,he,"stop domain values must appear in ascending order")]:(x=de,l==="categorical"&&de in A?[new i.V(te.key,he,"stop domain values must be unique")]:(A[de]=!0,[])):[new i.V(te.key,he,`integer expected, found ${String(de)}`)]}}function ha(p){const r=(p.expressionContext==="property"?i.S:i.U)(i.Q(p.value),p.valueSpec);if(r.result==="error")return r.value.map(m=>new i.V(`${p.key}${m.key}`,p.value,m.message));const l=r.value.expression||r.value._styleExpression.expression;if(p.expressionContext==="property"&&p.propertyKey==="text-font"&&!l.outputDefined())return[new i.V(p.key,p.value,`Invalid data expression for "${p.propertyKey}". Output values must be contained as literals within the expression.`)];if(p.expressionContext==="property"&&p.propertyType==="layout"&&!i.W(l))return[new i.V(p.key,p.value,'"feature-state" data expressions are not supported with layout properties.')];if(p.expressionContext==="filter")return Pa(l,p);if(p.expressionContext&&p.expressionContext.indexOf("cluster")===0){if(!i.X(l,["zoom","feature-state"]))return[new i.V(p.key,p.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(p.expressionContext==="cluster-initial"&&!i.Y(l))return[new i.V(p.key,p.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Pa(p,r){const l=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(r.valueSpec&&r.valueSpec.expression)for(const x of r.valueSpec.expression.parameters)l.delete(x);if(l.size===0)return[];const m=[];return p instanceof i.Z&&l.has(p.name)?[new i.V(r.key,r.value,`["${p.name}"] expression is not supported in a filter for a ${r.object.type} layer with id: ${r.object.id}`)]:(p.eachChild(x=>{m.push(...Pa(x,r))}),m)}function co(p){const r=p.key,l=p.value,m=p.valueSpec,x=[];return Array.isArray(m.values)?m.values.indexOf(i.K(l))===-1&&x.push(new i.V(r,l,`expected one of [${m.values.join(", ")}], ${JSON.stringify(l)} found`)):Object.keys(m.values).indexOf(i.K(l))===-1&&x.push(new i.V(r,l,`expected one of [${Object.keys(m.values).join(", ")}], ${JSON.stringify(l)} found`)),x}function Rs(p){return i.$(i.Q(p.value))?ha(i.J({},p,{expressionContext:"filter",valueSpec:p.styleSpec[`filter_${p.layerType||"fill"}`]})):Bn(p)}function Bn(p){const r=p.value,l=p.key;if(i.H(r)!=="array")return[new i.V(l,r,`array expected, ${i.H(r)} found`)];const m=p.styleSpec;let x,w=[];if(r.length<1)return[new i.V(l,r,"filter array must have at least 1 element")];switch(w=w.concat(co({key:`${l}[0]`,value:r[0],valueSpec:m.filter_operator,style:p.style,styleSpec:p.styleSpec})),i.K(r[0])){case"<":case"<=":case">":case">=":r.length>=2&&i.K(r[1])==="$type"&&w.push(new i.V(l,r,`"$type" cannot be use with operator "${r[0]}"`));case"==":case"!=":r.length!==3&&w.push(new i.V(l,r,`filter array for operator "${r[0]}" must have 3 elements`));case"in":case"!in":r.length>=2&&(x=i.H(r[1]),x!=="string"&&w.push(new i.V(`${l}[1]`,r[1],`string expected, ${x} found`)));for(let A=2;A<r.length;A++)x=i.H(r[A]),i.K(r[1])==="$type"?w=w.concat(co({key:`${l}[${A}]`,value:r[A],valueSpec:m.geometry_type,style:p.style,styleSpec:p.styleSpec})):x!=="string"&&x!=="number"&&x!=="boolean"&&w.push(new i.V(`${l}[${A}]`,r[A],`string, number, or boolean expected, ${x} found`));break;case"any":case"all":case"none":for(let A=1;A<r.length;A++)w=w.concat(Bn({key:`${l}[${A}]`,value:r[A],style:p.style,styleSpec:p.styleSpec}));break;case"has":case"!has":x=i.H(r[1]),r.length!==2?w.push(new i.V(l,r,`filter array for "${r[0]}" operator must have 2 elements`)):x!=="string"&&w.push(new i.V(`${l}[1]`,r[1],`string expected, ${x} found`))}return w}function jo(p,r){const l=p.key,m=p.style,x=p.layer,w=p.styleSpec,A=p.value,D=p.objectKey,N=w[`${r}_${p.layerType}`];if(!N)return[];const U=D.match(/^(.*)-use-theme$/);if(r==="paint"&&U&&N[U[1]])return i.O(A)?[].concat(qn({key:p.key,value:A,valueSpec:{type:"string",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},style:m,styleSpec:w,expressionContext:"property",propertyType:r,propertyKey:D})):qn({key:l,value:A,valueSpec:{type:"string"},style:m,styleSpec:w});const $=D.match(/^(.*)-transition$/);if(r==="paint"&&$&&N[$[1]]&&N[$[1]].transition)return qn({key:l,value:A,valueSpec:w.transition,style:m,styleSpec:w});const Z=p.valueSpec||N[D];if(!Z)return[new i.G(l,A,`unknown property "${D}"`)];let W;if(i.H(A)==="string"&&i.M(Z)&&!Z.tokens&&(W=/^{([^}]+)}$/.exec(A))){const ue=`\`{ "type": "identity", "property": ${W?JSON.stringify(W[1]):'"_"'} }\``;return[new i.V(l,A,`"${D}" does not support interpolation syntax
Use an identity property function instead: ${ue}.`)]}const te=[];if(p.layerType==="symbol")D!=="text-field"||!m||m.glyphs||m.imports||te.push(new i.V(l,A,'use of "text-field" requires a style "glyphs" property')),D==="text-font"&&i.a0(i.Q(A))&&i.K(A.type)==="identity"&&te.push(new i.V(l,A,'"text-font" does not support identity functions'));else if(p.layerType==="model"&&r==="paint"&&x&&x.layout&&x.layout.hasOwnProperty("model-id")&&i.M(Z)&&(i.a1(Z)||i.N(Z))){const ue=i.S(i.Q(A),Z),se=ue.value.expression||ue.value._styleExpression.expression;se&&!i.X(se,["measure-light"])&&(D==="model-emissive-strength"&&i.Y(se)&&i.W(se)||te.push(new i.V(l,A,`${D} does not support measure-light expressions when the model layer source is vector tile or GeoJSON.`)))}return te.concat(qn({key:p.key,value:A,valueSpec:Z,style:m,styleSpec:w,expressionContext:"property",propertyType:r,propertyKey:D}))}function is(p){return jo(p,"paint")}function Tl(p){return jo(p,"layout")}function fa(p){let r=[];const l=p.value,m=p.key,x=p.style,w=p.styleSpec;l.type||l.ref||r.push(new i.V(m,l,'either "type" or "ref" is required'));let A=i.K(l.type);const D=i.K(l.ref);if(l.id){const N=i.K(l.id);for(let U=0;U<p.arrayIndex;U++){const $=x.layers[U];i.K($.id)===N&&r.push(new i.V(m,l.id,`duplicate layer id "${l.id}", previously used at line ${$.id.__line__}`))}}if("ref"in l){let N;["type","source","source-layer","filter","layout"].forEach(U=>{U in l&&r.push(new i.V(m,l[U],`"${U}" is prohibited for ref layers`))}),x.layers.forEach(U=>{i.K(U.id)===D&&(N=U)}),N?N.ref?r.push(new i.V(m,l.ref,"ref cannot reference another ref layer")):A=i.K(N.type):typeof D=="string"&&r.push(new i.V(m,l.ref,`ref layer "${D}" not found`))}else if(A!=="background"&&A!=="sky"&&A!=="slot")if(l.source){const N=x.sources&&x.sources[l.source],U=N&&i.K(N.type);N?U==="vector"&&A==="raster"?r.push(new i.V(m,l.source,`layer "${l.id}" requires a raster source`)):U==="raster"&&A!=="raster"?r.push(new i.V(m,l.source,`layer "${l.id}" requires a vector source`)):U!=="vector"||l["source-layer"]?U==="raster-dem"&&A!=="hillshade"?r.push(new i.V(m,l.source,"raster-dem source can only be used with layer type 'hillshade'.")):U!=="raster-array"||["raster","raster-particle"].includes(A)?A!=="line"||!l.paint||!l.paint["line-gradient"]&&!l.paint["line-trim-offset"]||U==="geojson"&&N.lineMetrics?A==="raster-particle"&&U!=="raster-array"&&r.push(new i.V(m,l.source,`layer "${l.id}" requires a 'raster-array' source.`)):r.push(new i.V(m,l,`layer "${l.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):r.push(new i.V(m,l.source,"raster-array source can only be used with layer type 'raster'.")):r.push(new i.V(m,l,`layer "${l.id}" must specify a "source-layer"`)):r.push(new i.V(m,l.source,`source "${l.source}" not found`))}else r.push(new i.V(m,l,'missing required property "source"'));return r=r.concat(Cr({key:m,value:l,valueSpec:w.layer,style:p.style,styleSpec:p.styleSpec,objectElementValidators:{"*":()=>[],type:()=>qn({key:`${m}.type`,value:l.type,valueSpec:w.layer.type,style:p.style,styleSpec:p.styleSpec,object:l,objectKey:"type"}),filter:N=>Rs(i.J({layerType:A},N)),layout:N=>Cr({layer:l,key:N.key,value:N.value,valueSpec:{},style:N.style,styleSpec:N.styleSpec,objectElementValidators:{"*":U=>Tl(i.J({layerType:A},U))}}),paint:N=>Cr({layer:l,key:N.key,value:N.value,valueSpec:{},style:N.style,styleSpec:N.styleSpec,objectElementValidators:{"*":U=>is(i.J({layerType:A,layer:l},U))}})}})),r}function El(p){const r=p.value,l=p.key,m=i.H(r);return m!=="string"?[new i.V(l,r,`string expected, ${m} found`)]:[]}const hc={promoteId:function p({key:r,value:l}){if(i.H(l)==="string")return El({key:r,value:l});if(Array.isArray(l)){const m=[],x=i.Q(l),w=i.U(x);return w.result==="error"&&w.value.forEach(A=>{m.push(new i.V(`${r}${A.key}`,null,`${A.message}`))}),i.X(w.value.expression,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])||m.push(new i.V(`${r}`,null,"promoteId expression should be only feature dependent")),m}{const m=[];for(const x in l)m.push(...p({key:`${r}.${x}`,value:l[x]}));return m}}};function uh(p){const r=p.value,l=p.key,m=p.styleSpec,x=p.style;if(!r.type)return[new i.V(l,r,'"type" is required')];const w=i.K(r.type);let A=[];switch(["vector","raster","raster-dem","raster-array"].includes(w)&&(r.url||r.tiles||A.push(new i.G(l,r,'Either "url" or "tiles" is required.'))),w){case"vector":case"raster":case"raster-dem":case"raster-array":return A=A.concat(Cr({key:l,value:r,valueSpec:m[`source_${w.replace("-","_")}`],style:p.style,styleSpec:m,objectElementValidators:hc})),A;case"geojson":if(A=Cr({key:l,value:r,valueSpec:m.source_geojson,style:x,styleSpec:m,objectElementValidators:hc}),r.cluster)for(const D in r.clusterProperties){const[N,U]=r.clusterProperties[D],$=typeof N=="string"?[N,["accumulated"],["get",D]]:N;A.push(...ha({key:`${l}.${D}.map`,value:U,expressionContext:"cluster-map"})),A.push(...ha({key:`${l}.${D}.reduce`,value:$,expressionContext:"cluster-reduce"}))}return A;case"video":return Cr({key:l,value:r,valueSpec:m.source_video,style:x,styleSpec:m});case"image":return Cr({key:l,value:r,valueSpec:m.source_image,style:x,styleSpec:m});case"canvas":return[new i.V(l,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return co({key:`${l}.type`,value:r.type,valueSpec:{values:hh(m)}})}}function hh(p){return p.source.reduce((r,l)=>{const m=p[l];return m.type.type==="enum"&&(r=r.concat(Object.keys(m.type.values))),r},[])}function da(p){const r=p.value,l=p.styleSpec,m=l.light,x=p.style;let w=[];const A=i.H(r);if(r===void 0)return w;if(A!=="object")return w=w.concat([new i.V("light",r,`object expected, ${A} found`)]),w;for(const D in r){const N=D.match(/^(.*)-transition$/),U=D.match(/^(.*)-use-theme$/);w=w.concat(U&&m[U[1]]?qn({key:D,value:r[D],valueSpec:{type:"string"},style:x,styleSpec:l}):N&&m[N[1]]&&m[N[1]].transition?qn({key:D,value:r[D],valueSpec:l.transition,style:x,styleSpec:l}):m[D]?qn({key:D,value:r[D],valueSpec:m[D],style:x,styleSpec:l}):[new i.V(D,r[D],`unknown property "${D}"`)])}return w}function Ia(p){const r=p.value;let l=[];if(!r)return l;const m=i.H(r);if(m!=="object")return l=l.concat([new i.V("light-3d",r,`object expected, ${m} found`)]),l;const x=p.styleSpec,w=x["light-3d"],A=p.key,D=p.style,N=p.style.lights;for(const Z of["type","id"])if(!(Z in r))return l=l.concat([new i.V("light-3d",r,`missing property ${Z} on light`)]),l;if(r.type&&N)for(let Z=0;Z<p.arrayIndex;Z++){const W=i.K(r.type),te=N[Z];i.K(te.type)===W&&l.push(new i.V(A,r.id,`duplicate light type "${r.type}", previously defined at line ${te.id.__line__}`))}const U=`properties_light_${r.type}`;if(!(U in x))return l=l.concat([new i.V("light-3d",r,`Invalid light type ${r.type}`)]),l;const $=x[U];for(const Z in r)if(Z==="properties"){const W=r[Z],te=i.H(W);if(te!=="object")return l=l.concat([new i.V("properties",W,`object expected, ${te} found`)]),l;for(const ue in W)l=l.concat($[ue]?qn({key:ue,value:W[ue],valueSpec:$[ue],style:D,styleSpec:x}):[new i.G(p.key,W[ue],`unknown property "${ue}"`)])}else{const W=Z.match(/^(.*)-transition$/),te=Z.match(/^(.*)-use-theme$/);l=l.concat(te&&w[te[1]]?qn({key:Z,value:r[Z],valueSpec:{type:"string"},style:D,styleSpec:x}):W&&w[W[1]]&&w[W[1]].transition?qn({key:Z,value:r[Z],valueSpec:x.transition,style:D,styleSpec:x}):w[Z]?qn({key:Z,value:r[Z],valueSpec:w[Z],style:D,styleSpec:x}):[new i.G(Z,r[Z],`unknown property "${Z}"`)])}return l}function fh(p){const r=p.value,l=p.key,m=p.style,x=p.styleSpec,w=x.terrain;let A=[];const D=i.H(r);if(r===void 0||D==="null")return A;if(D!=="object")return A=A.concat([new i.V("terrain",r,`object expected, ${D} found`)]),A;for(const N in r){const U=N.match(/^(.*)-transition$/),$=N.match(/^(.*)-use-theme$/);A=A.concat($&&w[$[1]]?qn({key:N,value:r[N],valueSpec:{type:"string"},style:m,styleSpec:x}):U&&w[U[1]]&&w[U[1]].transition?qn({key:N,value:r[N],valueSpec:x.transition,style:m,styleSpec:x}):w[N]?qn({key:N,value:r[N],valueSpec:w[N],style:m,styleSpec:x}):[new i.G(N,r[N],`unknown property "${N}"`)])}if(r.source){const N=m.sources&&m.sources[r.source],U=N&&i.K(N.type);N?U!=="raster-dem"&&A.push(new i.V(l,r.source,`terrain cannot be used with a source of type ${String(U)}, it only be used with a "raster-dem" source type`)):A.push(new i.V(l,r.source,`source "${r.source}" not found`))}else A.push(new i.V(l,r,'terrain is missing required property "source"'));return A}function ra(p){const r=p.value,l=p.style,m=p.styleSpec,x=m.fog;let w=[];const A=i.H(r);if(r===void 0)return w;if(A!=="object")return w=w.concat([new i.V("fog",r,`object expected, ${A} found`)]),w;for(const D in r){const N=D.match(/^(.*)-transition$/),U=D.match(/^(.*)-use-theme$/);w=w.concat(U&&x[U[1]]?qn({key:D,value:r[D],valueSpec:{type:"string"},style:l,styleSpec:m}):N&&x[N[1]]&&x[N[1]].transition?qn({key:D,value:r[D],valueSpec:m.transition,style:l,styleSpec:m}):x[D]?qn({key:D,value:r[D],valueSpec:x[D],style:l,styleSpec:m}):[new i.G(D,r[D],`unknown property "${D}"`)])}return w}const pa={"*":()=>[],array:zi,boolean:function(p){const r=p.value,l=p.key,m=i.H(r);return m!=="boolean"?[new i.V(l,r,`boolean expected, ${m} found`)]:[]},number:$n,color:function(p){const r=p.key,l=p.value,m=i.H(l);return m!=="string"?[new i.V(r,l,`color expected, ${m} found`)]:i._.parseCSSColor(l)===null?[new i.V(r,l,`color expected, "${l}" found`)]:[]},enum:co,filter:Rs,function:si,layer:fa,object:Cr,source:uh,model:i.a2,light:da,"light-3d":Ia,terrain:fh,fog:ra,string:El,formatted:function(p){return El(p).length===0?[]:ha(p)},resolvedImage:function(p){return El(p).length===0?[]:ha(p)},projection:function(p){const r=p.value,l=p.styleSpec,m=l.projection,x=p.style;let w=[];const A=i.H(r);if(A==="object")for(const D in r)w=w.concat(qn({key:D,value:r[D],valueSpec:m[D],style:x,styleSpec:l}));else A!=="string"&&(w=w.concat([new i.V("projection",r,`object or string expected, ${A} found`)]));return w},import:function(p){const{value:r,styleSpec:l}=p,{data:m,...x}=r;Object.defineProperty(x,"__line__",{value:r.__line__,enumerable:!1});let w=Cr(i.J({},p,{value:x,valueSpec:l.import}));return i.K(x.id)===""&&w.push(new i.V(`${p.key}.id`,x,"import id can't be an empty string")),m&&(w=w.concat(rp(m,l,{key:`${p.key}.data`}))),w}};function qn(p,r=!1){const l=p.value,m=p.valueSpec,x=p.styleSpec;if(m.expression&&i.a0(i.K(l)))return si(p);if(m.expression&&i.O(i.Q(l)))return ha(p);if(m.type&&pa[m.type]){const w=pa[m.type](p);return r===!0&&w.length>0&&i.H(p.value)==="array"?ha(p):w}return Cr(i.J({},p,{valueSpec:m.type?x[m.type]:m}))}function tl(p){const r=p.value,l=p.key,m=El(p);return m.length||(r.indexOf("{fontstack}")===-1&&m.push(new i.V(l,r,'"glyphs" url must include a "{fontstack}" token')),r.indexOf("{range}")===-1&&m.push(new i.V(l,r,'"glyphs" url must include a "{range}" token'))),m}function rp(p,r=i.a3,l={}){return qn({key:l.key||"",value:p,valueSpec:r.$root,styleSpec:r,style:p,objectElementValidators:{glyphs:tl,"*":()=>[]}})}function Za(p,r=i.a3){return ma(rp(p,r))}const as=p=>ma(uh(p)),os=p=>ma(da(p)),Al=p=>ma(Ia(p)),nl=p=>ma(fh(p)),ip=p=>ma(ra(p)),_u=p=>ma(function(r){const l=r.value,m=r.style,x=r.styleSpec,w=x.snow;let A=[];const D=i.H(l);if(l===void 0)return A;if(D!=="object")return A=A.concat([new i.V("snow",l,`object expected, ${D} found`)]),A;for(const N in l){const U=N.match(/^(.*)-transition$/);A=A.concat(U&&w[U[1]]&&w[U[1]].transition?qn({key:N,value:l[N],valueSpec:x.transition,style:m,styleSpec:x}):w[N]?qn({key:N,value:l[N],valueSpec:w[N],style:m,styleSpec:x}):[new i.G(N,l[N],`unknown property "${N}"`)])}return A}(p)),Of=p=>ma(function(r){const l=r.value,m=r.style,x=r.styleSpec,w=x.rain;let A=[];const D=i.H(l);if(l===void 0)return A;if(D!=="object")return A=A.concat([new i.V("rain",l,`object expected, ${D} found`)]),A;for(const N in l){const U=N.match(/^(.*)-transition$/);A=A.concat(U&&w[U[1]]&&w[U[1]].transition?qn({key:N,value:l[N],valueSpec:x.transition,style:m,styleSpec:x}):w[N]?qn({key:N,value:l[N],valueSpec:w[N],style:m,styleSpec:x}):[new i.G(N,l[N],`unknown property "${N}"`)])}return A}(p)),dh=p=>ma(fa(p)),vi=p=>ma(Rs(p)),Pf=p=>ma(is(p)),If=p=>ma(Tl(p)),ph=p=>ma(i.a2(p));function ma(p){return p.slice().sort((r,l)=>r.line&&l.line?r.line-l.line:0)}function Ds(p,r){let l=!1;if(r&&r.length)for(const m of r)m instanceof i.G?i.w(m.message):(p.fire(new i.y(new Error(m.message))),l=!0);return l}let ft;class le extends i.E{constructor(r,l="flat"){super(),this._transitionable=new i.a4(ft||(ft=new i.a5({anchor:new i.a6(i.a3.light.anchor),position:new i.a7(i.a3.light.position),color:new i.a6(i.a3.light.color),intensity:new i.a6(i.a3.light.intensity)}))),this.setLight(r,l),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(r,l,m={}){this._validate(os,r,m)||(this._transitionable.setTransitionOrValue(r),this.id=l)}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}_validate(r,l,m){return(!m||m.validate!==!1)&&Ds(this,r.call(Za,i.l({value:l,style:{glyphs:!0,sprite:!0},styleSpec:i.a3})))}}let pe=class extends i.E{constructor(p,r,l,m){super(),this.scope=l,this._transitionable=new i.a4(new i.a5({source:new i.a6(i.a3.terrain.source),exaggeration:new i.a6(i.a3.terrain.exaggeration)}),l,m),this._transitionable.setTransitionOrValue(p,m),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=r}get(){return this._transitionable.serialize()}set(p,r){this._transitionable.setTransitionOrValue(p,r)}updateTransitions(p){this._transitioning=this._transitionable.transitioned(p,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(p){this.properties=this._transitioning.possiblyEvaluate(p)}getExaggeration(p){return this._transitioning.possiblyEvaluate(new i.a8(p)).get("exaggeration")}getAttenuationRange(){if(!this.isZoomDependent())return null;const p=this._transitionable._values.exaggeration;if(!p)return null;const r=p.value.expression;if(!r)return null;let l=-1,m=-1,x=1;for(const w of r.zoomStops)x=r.evaluate(new i.a8(w)),x>.01?(l=w,m=-1):m=w;return x<.01&&l>0&&m>l?[l,m]:null}isZoomDependent(){const p=this._transitionable._values.exaggeration;return p!=null&&p.value!=null&&p.value.expression!=null&&p.value.expression instanceof i.a9}};const Se=45,Le=65,je=.05;function We(p,r,l,m){const x=i.ac(Se,Le,l),[w,A]=it(p,m);let D=1-Math.min(1,Math.exp((r-w)/(A-w)*-6));return D*=D*D,D=Math.min(1,1.00747*D),D*x*p.alpha}function it(p,r){const l=.5/Math.tan(.5*r);return[p.range[0]+l,p.range[1]+l]}function Ye(p,r,l,m,x){const w=i.ab.vec3.transformMat4([],[r,l,m],x.mercatorFogMatrix);return We(p,i.ab.vec3.length(w),x.pitch,x._fov)}function ct(p,r,l,m,x,w,A){const D=[[l,m,0],[x,m,0],[x,w,0],[l,w,0]];let N=Number.MAX_VALUE,U=-Number.MAX_VALUE;for(const $ of D){const Z=i.ab.vec3.transformMat4([],$,r),W=i.ab.vec3.length(Z);N=Math.min(N,W),U=Math.max(U,W)}return[We(p,N,A.pitch,A._fov),We(p,U,A.pitch,A._fov)]}class lt extends i.E{constructor(r,l,m,x){super();const w=new i.a5({range:new i.a6(i.a3.fog.range),color:new i.a6(i.a3.fog.color),"color-use-theme":new i.a6({type:"string","property-type":"data-constant",default:"default"}),"high-color":new i.a6(i.a3.fog["high-color"]),"high-color-use-theme":new i.a6({type:"string","property-type":"data-constant",default:"default"}),"space-color":new i.a6(i.a3.fog["space-color"]),"space-color-use-theme":new i.a6({type:"string","property-type":"data-constant",default:"default"}),"horizon-blend":new i.a6(i.a3.fog["horizon-blend"]),"star-intensity":new i.a6(i.a3.fog["star-intensity"]),"vertical-range":new i.a6(i.a3.fog["vertical-range"])});this._transitionable=new i.a4(w,m,new Map(x)),this.set(r,x),this._transitioning=this._transitionable.untransitioned(),this._transform=l,this.properties=new i.ad(w),this.scope=m}get state(){const r=this._transform,l=r.projection.name==="globe",m=i.ae(r.zoom),x=this.properties.get("range"),w=[.5,3];return{range:l?[i.af(w[0],x[0],m),i.af(w[1],x[1],m)]:x,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(r,l,m={}){if(this._validate(ip,r,m))return;const x=i.l({},r);for(const w of Object.keys(i.a3.fog))x[w]===void 0&&(x[w]=i.a3.fog[w].default);this._options=x,this._transitionable.setTransitionOrValue(this._options,l)}getOpacity(r){if(!this._transform.projection.supportsFog)return 0;const l=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:i.ac(Se,Le,r))*l.a}getOpacityAtLatLng(r,l){return this._transform.projection.supportsFog?function(m,x,w){const A=i.aa.fromLngLat(x),D=w.elevation?w.elevation.getAtPointOrZero(A):0;return Ye(m,A.x,A.y,D,w)}(this.state,r,l):0}getOpacityForTile(r){if(!this._transform.projection.supportsFog)return[1,1];const l=this._transform.calculateFogTileMatrix(r.toUnwrapped());return ct(this.state,l,0,0,i.ag,i.ag,this._transform)}getOpacityForBounds(r,l,m,x,w){return this._transform.projection.supportsFog?ct(this.state,r,l,m,x,w,this._transform):[1,1]}getFovAdjustedRange(r){return this._transform.projection.supportsFog?it(this.state,r):[0,1]}isVisibleOnFrustum(r){if(!this._transform.projection.supportsFog)return!1;const l=[4,5,6,7];for(const m of l){const x=r.points[m];let w;if(x[2]>=0)w=x;else{const A=r.points[m-4];w=i.ah(A,x,A[2]/(A[2]-x[2]))}if(Ye(this.state,w[0],w[1],0,this._transform)>=je)return!0}return!1}updateConfig(r){this._transitionable.setTransitionOrValue(this._options,new Map(r))}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}_validate(r,l,m){return(!m||m.validate!==!1)&&Ds(this,r.call(Za,i.l({value:l,style:{glyphs:!0,sprite:!0},styleSpec:i.a3})))}}let ut,Ct,Zt,Xt,gn=class extends i.E{constructor(p,r,l,m){super();const x=ut||(ut=new i.a5({density:new i.a6(i.a3.snow.density),intensity:new i.a6(i.a3.snow.intensity),color:new i.a6(i.a3.snow.color),opacity:new i.a6(i.a3.snow.opacity),vignette:new i.a6(i.a3.snow.vignette),"vignette-color":new i.a6(i.a3.snow["vignette-color"]),"center-thinning":new i.a6(i.a3.snow["center-thinning"]),direction:new i.a6(i.a3.snow.direction),"flake-size":new i.a6(i.a3.snow["flake-size"])}));this._transitionable=new i.a4(x,l,new Map(m)),this.set(p,m),this._transitioning=this._transitionable.untransitioned(),this.properties=new i.ad(x),this.scope=l}get state(){const p=this.properties.get("opacity"),r=this.properties.get("color"),l=this.properties.get("direction"),m=i.ai(l[0]),x=-Math.max(i.ai(l[1]),.01),w=[Math.cos(m)*Math.cos(x),Math.sin(m)*Math.cos(x),Math.sin(x)],A=this.properties.get("vignette"),D=this.properties.get("vignette-color");return D.a=A,{density:this.properties.get("density"),intensity:this.properties.get("intensity"),color:new i.aj(r.r,r.g,r.b,r.a*p),direction:w,centerThinning:this.properties.get("center-thinning"),flakeSize:this.properties.get("flake-size"),vignetteColor:D}}get(){return this._transitionable.serialize()}set(p,r,l={}){if(this._validate(_u,p,l))return;const m=i.l({},p);for(const x of Object.keys(i.a3.snow))m[x]===void 0&&(m[x]=i.a3.snow[x].default);this._options=m,this._transitionable.setTransitionOrValue(this._options,r)}updateConfig(p){this._transitionable.setTransitionOrValue(this._options,new Map(p))}updateTransitions(p){this._transitioning=this._transitionable.transitioned(p,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(p){this.properties=this._transitioning.possiblyEvaluate(p)}_validate(p,r,l){return(!l||l.validate!==!1)&&Ds(this,p.call(Za,i.l({value:r,style:{glyphs:!0,sprite:!0},styleSpec:i.a3})))}},Cn=class extends i.E{constructor(p,r,l,m){super();const x=Ct||(Ct=new i.a5({density:new i.a6(i.a3.rain.density),intensity:new i.a6(i.a3.rain.intensity),color:new i.a6(i.a3.rain.color),opacity:new i.a6(i.a3.rain.opacity),vignette:new i.a6(i.a3.rain.vignette),"vignette-color":new i.a6(i.a3.rain["vignette-color"]),"center-thinning":new i.a6(i.a3.rain["center-thinning"]),direction:new i.a6(i.a3.rain.direction),"droplet-size":new i.a6(i.a3.rain["droplet-size"]),"distortion-strength":new i.a6(i.a3.rain["distortion-strength"])}));this._transitionable=new i.a4(x,l,new Map(m)),this.set(p,m),this._transitioning=this._transitionable.untransitioned(),this.properties=new i.ad(x),this.scope=l}get state(){const p=this.properties.get("opacity"),r=this.properties.get("color"),l=this.properties.get("direction"),m=i.ai(l[0]),x=-Math.max(i.ai(l[1]),.01),w=[Math.cos(m)*Math.cos(x),Math.sin(m)*Math.cos(x),Math.sin(x)],A=this.properties.get("vignette-color");return A.a=this.properties.get("vignette"),{density:this.properties.get("density"),intensity:this.properties.get("intensity"),color:new i.aj(r.r,r.g,r.b,r.a*p),direction:w,centerThinning:this.properties.get("center-thinning"),dropletSize:this.properties.get("droplet-size"),distortionStrength:this.properties.get("distortion-strength"),vignetteColor:A}}get(){return this._transitionable.serialize()}set(p,r,l={}){if(this._validate(Of,p,l))return;const m=i.l({},p);for(const x of Object.keys(i.a3.rain))m[x]===void 0&&(m[x]=i.a3.rain[x].default);this._options=m,this._transitionable.setTransitionOrValue(this._options,r)}updateConfig(p){this._transitionable.setTransitionOrValue(this._options,new Map(p))}updateTransitions(p){this._transitioning=this._transitionable.transitioned(p,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(p){this.properties=this._transitioning.possiblyEvaluate(p)}_validate(p,r,l){return(!l||l.validate!==!1)&&Ds(this,p.call(Za,i.l({value:r,style:{glyphs:!0,sprite:!0},styleSpec:i.a3})))}};class On extends i.E{constructor(r,l,m,x){super(),this.scope=m,this._options=r,this.properties=new i.ad(l),this._transitionable=new i.a4(l,m,new Map(x)),this._transitionable.setTransitionOrValue(r.properties),this._transitioning=this._transitionable.untransitioned()}updateConfig(r){this._transitionable.setTransitionOrValue(this._options.properties,new Map(r))}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}get(){return this._options.properties=this._transitionable.serialize(),this._options}set(r,l){this._options=r,this._transitionable.setTransitionOrValue(r.properties,l)}shadowsEnabled(){return!!this.properties&&this.properties.get("cast-shadows")===!0}}class wn{constructor(r,l,m,x){this.screenBounds=r,this.cameraPoint=l,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=m,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,x)}static createFromScreenPoints(r,l){let m,x;if(r instanceof i.P||typeof r[0]=="number"){const w=i.P.convert(r);m=[w],x=l.isPointAboveHorizon(w)}else{const w=i.P.convert(r[0]),A=i.P.convert(r[1]);m=[w,A],x=i.al(w,A).every(D=>l.isPointAboveHorizon(D))}return new wn(m,l.getCameraPoint(),x,l)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(r){return i.al(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],r)}bufferedCameraGeometry(r){const l=this.screenBounds[0],m=this.screenBounds.length===1?this.screenBounds[0].add(new i.P(1,1)):this.screenBounds[1],x=i.al(l,m,0,!1);return this.cameraPoint.y>m.y&&(this.cameraPoint.x>l.x&&this.cameraPoint.x<m.x?x.splice(3,0,this.cameraPoint):this.cameraPoint.x>=m.x?x[2]=this.cameraPoint:this.cameraPoint.x<=l.x&&(x[3]=this.cameraPoint)),i.am(x,r)}bufferedCameraGeometryGlobe(r){const l=this.screenBounds[0],m=this.screenBounds.length===1?this.screenBounds[0].add(new i.P(1,1)):this.screenBounds[1],x=i.al(l,m,r),w=this.cameraPoint.clone();switch(3*((w.y>l.y)+(w.y>m.y))+((w.x>l.x)+(w.x>m.x))){case 0:x[0]=w,x[4]=w.clone();break;case 1:x.splice(1,0,w);break;case 2:x[1]=w;break;case 3:x.splice(4,0,w);break;case 5:x.splice(2,0,w);break;case 6:x[3]=w;break;case 7:x.splice(3,0,w);break;case 8:x[2]=w}return x}containsTile(r,l,m,x=0){const w=r.queryPadding/l._pixelsPerMercatorPixel+1,A=m?this._bufferedCameraMercator(w,l):this._bufferedScreenMercator(w,l);let D=r.tileID.wrap+(A.unwrapped?x:0);const N=A.polygon.map(de=>i.an(r.tileTransform,de,D));if(!i.ao(N,0,0,i.ag,i.ag))return;D=r.tileID.wrap+(this.screenGeometryMercator.unwrapped?x:0);const U=this.screenGeometryMercator.polygon.map(de=>i.ap(r.tileTransform,de,D)),$=U.map(de=>new i.P(de[0],de[1])),Z=l.getFreeCameraOptions().position||new i.aa(0,0,0),W=i.ap(r.tileTransform,Z,D),te=U.map(de=>{const he=i.ab.vec3.sub(de,de,W);return i.ab.vec3.normalize(he,he),new i.aq(W,he)}),ue=i.ar(r,1,l.zoom)*l._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:$,tilespaceRays:te,bufferedTilespaceGeometry:N,bufferedTilespaceBounds:(se=i.as(N),se.min.x=i.aw(se.min.x,0,i.ag),se.min.y=i.aw(se.min.y,0,i.ag),se.max.x=i.aw(se.max.x,0,i.ag),se.max.y=i.aw(se.max.y,0,i.ag),se),tile:r,tileID:r.tileID,pixelToTileUnitsFactor:ue};var se}_bufferedScreenMercator(r,l){const m=Yn(r);if(this._screenRaycastCache[m])return this._screenRaycastCache[m];{let x;return x=l.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(r),l):{polygon:this.bufferedScreenGeometry(r).map(w=>l.pointCoordinate3D(w)),unwrapped:!0},this._screenRaycastCache[m]=x,x}}_bufferedCameraMercator(r,l){const m=Yn(r);if(this._cameraRaycastCache[m])return this._cameraRaycastCache[m];{let x;return x=l.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(r),l):{polygon:this.bufferedCameraGeometry(r).map(w=>l.pointCoordinate3D(w)),unwrapped:!0},this._cameraRaycastCache[m]=x,x}}_projectAndResample(r,l){const m=function(w,A){const D=i.ab.mat4.multiply([],A.pixelMatrix,A.globeMatrix),N=[0,-i.ax,0,1],U=[0,i.ax,0,1],$=[0,0,0,1];i.ab.vec4.transformMat4(N,N,D),i.ab.vec4.transformMat4(U,U,D),i.ab.vec4.transformMat4($,$,D);const Z=new i.P(N[0]/N[3],N[1]/N[3]),W=new i.P(U[0]/U[3],U[1]/U[3]),te=i.au(w,Z)&&N[3]<$[3],ue=i.au(w,W)&&U[3]<$[3];if(!te&&!ue)return null;const se=function(ze,De,$e){for(let Xe=1;Xe<ze.length;Xe++){const ht=tr(De.pointCoordinate3D(ze[Xe-1]).x),ot=tr(De.pointCoordinate3D(ze[Xe]).x);if($e<0){if(ht<ot)return{idx:Xe,t:-ht/(ot-1-ht)}}else if(ot<ht)return{idx:Xe,t:(1-ht)/(ot+1-ht)}}return null}(w,A,te?-1:1);if(!se)return null;const{idx:de,t:he}=se;let Te=de>1?er(w.slice(0,de),A):[],Pe=de<w.length?er(w.slice(de),A):[];Te=Te.map(ze=>new i.P(tr(ze.x),ze.y)),Pe=Pe.map(ze=>new i.P(tr(ze.x),ze.y));const Me=[...Te];Me.length===0&&Me.push(Pe[Pe.length-1]);const Fe=i.af(Me[Me.length-1].y,(Pe.length===0?Te[0]:Pe[0]).y,he);let Re;return Re=te?[new i.P(0,Fe),new i.P(0,0),new i.P(1,0),new i.P(1,Fe)]:[new i.P(1,Fe),new i.P(1,1),new i.P(0,1),new i.P(0,Fe)],Me.push(...Re),Pe.length===0?Me.push(Te[0]):Me.push(...Pe),{polygon:Me.map(ze=>new i.aa(ze.x,ze.y)),unwrapped:!1}}(r,l);if(m)return m;const x=function(w,A){let D=!1,N=-1/0,U=0;for(let Z=0;Z<w.length-1;Z++)w[Z].x>N&&(N=w[Z].x,U=Z);for(let Z=0;Z<w.length-1;Z++){const W=(U+Z)%(w.length-1),te=w[W],ue=w[W+1];Math.abs(te.x-ue.x)>.5&&(te.x<ue.x?(te.x+=1,W===0&&(w[w.length-1].x+=1)):(ue.x+=1,W+1===w.length-1&&(w[0].x+=1)),D=!0)}const $=i.at(A.center.lng);return D&&$<Math.abs($-1)&&w.forEach(Z=>{Z.x-=1}),{polygon:w,unwrapped:D}}(er(r,l).map(w=>new i.P(tr(w.x),w.y)),l);return{polygon:x.polygon.map(w=>new i.aa(w.x,w.y)),unwrapped:x.unwrapped}}}function er(p,r){return i.av(p,l=>{const m=r.pointCoordinate3D(l);l.x=m.x,l.y=m.y},1/256)}function tr(p){return p<0?1+p%1:p%1}function Yn(p){return 100*p|0}function dr(p,r,l,m,x){const w=function(D,N){if(D)return x(D);if(N){if(p.url&&N.tiles&&p.tiles&&delete p.tiles,N.variants){if(!Array.isArray(N.variants))return x(new Error("variants must be an array"));for(const $ of N.variants){if($==null||typeof $!="object"||$.constructor!==Object)return x(new Error("variant must be an object"));if(!Array.isArray($.capabilities))return x(new Error("capabilities must be an array"));if($.capabilities.length===1&&$.capabilities[0]==="meshopt"){N=i.l(N,$);break}}}const U=i.ay(i.l({},N,p),["tilejson","tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding","vector_layers","raster_layers","worldview_options","worldview_default","worldview"]);U.tiles=r.canonicalizeTileset(U,p.url),x(null,U)}},A=function(D,N,U){if(!D)return null;if(!N&&!U)return D;U=U||D.worldview_default;const $=Object.values(D.language||{});if($.length===0)return null;const Z=Object.values(D.worldview||{});if(Z.length===0)return null;const W=$.every(ue=>ue===N),te=Z.every(ue=>ue===U);return W&&te?D:N in(D.language_options||{})||U in(D.worldview_options||{})?null:D.language_options&&D.worldview_options?D:null}(p.data,l,m);return A?i.q.frame(()=>w(null,A)):p.url?i.n(r.transformRequest(r.normalizeSourceURL(p.url,null,l,m),i.R.Source),w):i.q.frame(()=>{const{data:D,...N}=p;w(null,N)})}class vr{constructor(r,l,m){this.bounds=i.az.convert(this.validateBounds(r)),this.minzoom=l||0,this.maxzoom=m||24}validateBounds(r){return Array.isArray(r)&&r.length===4?[Math.max(-180,r[0]),Math.max(-90,r[1]),Math.min(180,r[2]),Math.min(90,r[3])]:[-180,-90,180,90]}contains(r){const l=Math.pow(2,r.z),m=Math.floor(i.at(this.bounds.getWest())*l),x=Math.floor(i.aA(this.bounds.getNorth())*l),w=Math.ceil(i.at(this.bounds.getEast())*l),A=Math.ceil(i.aA(this.bounds.getSouth())*l);return r.x>=m&&r.x<w&&r.y>=x&&r.y<A}}class Pi extends i.E{constructor(r,l,m,x){if(super(),this.id=r,this.dispatcher=m,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,i.l(this,i.ay(l,["url","scheme","tileSize","promoteId"])),this._options=i.l({type:"vector"},l),this._collectResourceTiming=!!l.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(x),this._tileWorkers={},this._deduped=new i.aB}load(r){this._loaded=!1,this.fire(new i.z("dataloading",{dataType:"source"}));const l=Array.isArray(this.map._language)?this.map._language.join():this.map._language,m=this.map.getWorldview();this._tileJSONRequest=dr(this._options,this.map._requestManager,l,m,(x,w)=>{if(this._tileJSONRequest=null,this._loaded=!0,x)l&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${l}`),m&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${m}`),this.fire(new i.y(x));else if(w){if(i.l(this,w),this.hasWorldviews=!!w.worldview_options,w.worldview_default&&(this.worldviewDefault=w.worldview_default),w.vector_layers){this.vectorLayers=w.vector_layers,this.vectorLayerIds=[],this.localizableLayerIds=new Set;for(const A of w.vector_layers)this.vectorLayerIds.push(A.id),w.worldview&&w.worldview[A.source]&&this.localizableLayerIds.add(A.id)}w.bounds&&(this.tileBounds=new vr(w.bounds,this.minzoom,this.maxzoom)),rn(w.tiles,this.map._requestManager._customAccessToken),this.fire(new i.z("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.z("data",{dataType:"source",sourceDataType:"content"}))}r&&r(x)})}loaded(){return this._loaded}hasTile(r){return!this.tileBounds||this.tileBounds.contains(r.canonical)}onAdd(r){this.map=r,this.load()}reload(){this.cancelTileJSONRequest();const r=i.aC(this.id,this.scope);this.load(()=>this.map.style.clearSource(r))}setTiles(r){return this._options.tiles=r,this.reload(),this}setUrl(r){return this.url=r,this._options.url=r,this.reload(),this}onRemove(r){this.cancelTileJSONRequest()}serialize(){return i.l({},this._options)}loadTile(r,l){const m=r.tileID.canonical.url(this.tiles,this.scheme),x=this.map._requestManager.normalizeTileURL(m),w=this.map._requestManager.transformRequest(x,i.R.Tile),A=this.map.style?this.map.style.getLut(this.scope):null,D=A?{image:A.image.clone()}:null,N={request:w,data:void 0,uid:r.uid,tileID:r.tileID,tileZoom:r.tileZoom,zoom:r.tileID.overscaledZ,maxZoom:this.maxzoom,lut:D,tileSize:this.tileSize*r.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,pixelRatio:i.q.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:r.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:r.isExtraShadowCaster,tessellationStep:this.map._tessellationStep,scaleFactor:this.map.getScaleFactor()};if(this.hasWorldviews&&i.f(m)&&(N.worldview=this.map.getWorldview()||this.worldviewDefault,N.localizableLayerIds=this.localizableLayerIds),N.request.collectResourceTiming=this._collectResourceTiming,r.actor&&r.state!=="expired")r.state==="loading"?r.reloadCallback=l:r.request=r.actor.send("reloadTile",N,U.bind(this));else if(r.actor=this._tileWorkers[x]=this._tileWorkers[x]||this.dispatcher.getActor(),this.dispatcher.ready)r.request=r.actor.send("loadTile",N,U.bind(this),void 0,!0);else{const $=i.aD.call({deduped:this._deduped},N,(Z,W)=>{Z||!W?U.call(this,Z):(N.data={cacheControl:W.cacheControl,expires:W.expires,rawData:W.rawData.slice(0)},r.actor&&r.actor.send("loadTile",N,U.bind(this),void 0,!0))},!0);r.request={cancel:$}}function U($,Z){return delete r.request,r.aborted?l(null):$&&$.status!==404?l($):(Z&&Z.resourceTiming&&(r.resourceTiming=Z.resourceTiming),this.map._refreshExpiredTiles&&Z&&r.setExpiryData(Z),r.loadVectorData(Z,this.map.painter),i.aE(this.dispatcher),l(null),void(r.reloadCallback&&(this.loadTile(r,r.reloadCallback),r.reloadCallback=null)))}}abortTile(r){r.request&&(r.request.cancel(),delete r.request),r.actor&&r.actor.send("abortTile",{uid:r.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(r,l){r.actor&&r.actor.send("removeTile",{uid:r.uid,type:this.type,source:this.id,scope:this.scope}),r.destroy()}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class Uo extends i.E{constructor(r,l,m,x){super(),this.id=r,this.dispatcher=m,this.setEventedParent(x),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=i.l({type:"raster"},l),i.l(this,i.ay(l,["url","scheme","tileSize"]))}load(r){this._loaded=!1,this.fire(new i.z("dataloading",{dataType:"source"})),this._tileJSONRequest=dr(this._options,this.map._requestManager,null,null,(l,m)=>{this._tileJSONRequest=null,this._loaded=!0,l?this.fire(new i.y(l)):m&&(i.l(this,m),m.raster_layers&&(this.rasterLayers=m.raster_layers,this.rasterLayerIds=this.rasterLayers.map(x=>x.id)),m.bounds&&(this.tileBounds=new vr(m.bounds,this.minzoom,this.maxzoom)),rn(m.tiles),this.fire(new i.z("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.z("data",{dataType:"source",sourceDataType:"content"}))),r&&r(l)})}loaded(){return this._loaded}onAdd(r){this.map=r,this.load()}reload(){this.cancelTileJSONRequest();const r=i.aC(this.id,this.scope);this.load(()=>this.map.style.clearSource(r))}setTiles(r){return this._options.tiles=r,this.reload(),this}setUrl(r){return this.url=r,this._options.url=r,this.reload(),this}onRemove(r){this.cancelTileJSONRequest()}serialize(){return i.l({},this._options)}hasTile(r){return!this.tileBounds||this.tileBounds.contains(r.canonical)}loadTile(r,l){const m=i.q.devicePixelRatio>=2,x=this.map._requestManager.normalizeTileURL(r.tileID.canonical.url(this.tiles,this.scheme),m,this.tileSize);r.request=i.o(this.map._requestManager.transformRequest(x,i.R.Tile),(w,A,D,N)=>(delete r.request,r.aborted?(r.state="unloaded",l(null)):w?(r.state="errored",l(w)):A?(this.map._refreshExpiredTiles&&r.setExpiryData({cacheControl:D,expires:N}),r.setTexture(A,this.map.painter),r.state="loaded",i.aE(this.dispatcher),void l(null)):l(null)))}abortTile(r,l){r.request&&(r.request.cancel(),delete r.request),l&&l()}unloadTile(r,l){r.texture&&r.texture instanceof i.T?(r.destroy(!0),r.texture&&r.texture instanceof i.T&&this.map.painter.saveTileTexture(r.texture)):r.destroy(),l&&l()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class Ai extends Uo{constructor(r,l,m,x){super(r,l,m,x),this.type="raster-array",this.maxzoom=22,this._options=i.l({type:"raster-array"},l)}triggerRepaint(r){const l=this.map.painter._terrain,m=this.map.style.getSourceCache(this.id);l&&l.enabled&&m&&l._clearRenderCacheForTile(m.id,r.tileID),this.map.triggerRepaint()}loadTile(r,l){const m=this.map._requestManager.normalizeTileURL(r.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize),x=this.map._requestManager.transformRequest(m,i.R.Tile);r.requestParams=x,r.actor||(r.actor=this.dispatcher.getActor()),r.request=r.fetchHeader(void 0,(w,A,D,N)=>{if(delete r.request,r.aborted)return r.state="unloaded",l(null);if(w)return w.code===20?void 0:(r.state="errored",l(w));this.map._refreshExpiredTiles&&r.setExpiryData({cacheControl:D,expires:N}),r.state="empty",l(null)})}unloadTile(r,l){const m=r.texture;m&&m instanceof i.T?(r.destroy(!0),this.map.painter.saveTileTexture(m)):(r.destroy(),r.flushQueues(),r._isHeaderLoaded=!1,delete r._mrt,delete r.textureDescriptor),r.fbo&&(r.fbo.destroy(),delete r.fbo),delete r.request,delete r.requestParams,delete r.neighboringTiles,r.state="unloaded"}prepareTile(r,l,m){r._isHeaderLoaded&&(r.state!=="empty"&&(r.state="reloading"),r.fetchBand(l,m,(x,w)=>{if(x)return r.state="errored",this.fire(new i.y(x)),void this.triggerRepaint(r);w&&(r.setTexture(w,this.map.painter),r.state="loaded",this.triggerRepaint(r))}))}getInitialBand(r){if(!this.rasterLayers)return 0;const l=this.rasterLayers.find(({id:w})=>w===r),m=l&&l.fields,x=m&&m.bands&&m.bands;return x?x[0]:0}getTextureDescriptor(r,l,m){if(!r)return;const x=l.sourceLayer||this.rasterLayerIds&&this.rasterLayerIds[0];if(!x)return;let w=null;l instanceof i.aH?w=l.paint.get("raster-array-band"):l instanceof i.aI&&(w=l.paint.get("raster-particle-array-band"));const A=w||this.getInitialBand(x);if(A!=null)if(r.textureDescriptor){if(!r.updateNeeded(x,A)||m)return Object.assign({},r.textureDescriptor,{texture:r.texture})}else this.prepareTile(r,x,A)}}const ii={vector:Pi,raster:Uo,"raster-dem":class extends Uo{constructor(p,r,l,m){super(p,r,l,m),this.type="raster-dem",this.maxzoom=22,this._options=i.l({type:"raster-dem"},r),this.encoding=r.encoding||"mapbox"}loadTile(p,r){const l=this.map._requestManager.normalizeTileURL(p.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function m(x,w){x&&(p.state="errored",r(x)),w&&(p.dem=w,p.dem.onDeserialize(),p.needsHillshadePrepare=!0,p.needsDEMTextureUpload=!0,p.state="loaded",r(null))}p.request=i.o(this.map._requestManager.transformRequest(l,i.R.Tile),(function(x,w,A,D){if(delete p.request,p.aborted)p.state="unloaded",r(null);else if(x)p.state="errored",r(x);else if(w){this.map._refreshExpiredTiles&&p.setExpiryData({cacheControl:A,expires:D});const N=ImageBitmap&&w instanceof ImageBitmap&&i.t(),U=1-(w.width-i.aF(w.width))/2;U<1||p.neighboringTiles||(p.neighboringTiles=this._getNeighboringTiles(p.tileID));const $=N?w:i.q.getImageData(w,U),Z={uid:p.uid,coord:p.tileID,source:this.id,scope:this.scope,rawImageData:$,encoding:this.encoding,padding:U};p.actor&&p.state!=="expired"||(p.actor=this.dispatcher.getActor(),p.actor.send("loadDEMTile",Z,m.bind(this),void 0,!0))}}).bind(this))}_getNeighboringTiles(p){const r=p.canonical,l=Math.pow(2,r.z),m=(r.x-1+l)%l,x=r.x===0?p.wrap-1:p.wrap,w=(r.x+1+l)%l,A=r.x+1===l?p.wrap+1:p.wrap,D={};return D[new i.aG(p.overscaledZ,x,r.z,m,r.y).key]={backfilled:!1},D[new i.aG(p.overscaledZ,A,r.z,w,r.y).key]={backfilled:!1},r.y>0&&(D[new i.aG(p.overscaledZ,x,r.z,m,r.y-1).key]={backfilled:!1},D[new i.aG(p.overscaledZ,p.wrap,r.z,r.x,r.y-1).key]={backfilled:!1},D[new i.aG(p.overscaledZ,A,r.z,w,r.y-1).key]={backfilled:!1}),r.y+1<l&&(D[new i.aG(p.overscaledZ,x,r.z,m,r.y+1).key]={backfilled:!1},D[new i.aG(p.overscaledZ,p.wrap,r.z,r.x,r.y+1).key]={backfilled:!1},D[new i.aG(p.overscaledZ,A,r.z,w,r.y+1).key]={backfilled:!1}),D}},"raster-array":Ai,geojson:class extends i.E{constructor(p,r,l,m){super(),this.id=p,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=l.getActor(),this.setEventedParent(m),this._data=r.data,this._options=i.l({},r),this._collectResourceTiming=r.collectResourceTiming,r.maxzoom!==void 0&&(this.maxzoom=r.maxzoom),r.minzoom!==void 0&&(this.minzoom=r.minzoom),r.type&&(this.type=r.type),r.attribution&&(this.attribution=r.attribution),this.promoteId=r.promoteId;const x=i.ag/this.tileSize;this.workerOptions=i.l({source:this.id,scope:this.scope,cluster:r.cluster||!1,geojsonVtOptions:{buffer:(r.buffer!==void 0?r.buffer:128)*x,tolerance:(r.tolerance!==void 0?r.tolerance:.375)*x,extent:i.ag,maxZoom:this.maxzoom,lineMetrics:r.lineMetrics||!1,generateId:r.generateId||!1},superclusterOptions:{maxZoom:r.clusterMaxZoom!==void 0?r.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,r.clusterMinPoints||2),extent:i.ag,radius:(r.clusterRadius!==void 0?r.clusterRadius:50)*x,log:!1,generateId:r.generateId||!1},clusterProperties:r.clusterProperties,filter:r.filter,dynamic:r.dynamic},r.workerOptions)}onAdd(p){this.map=p,this.setData(this._data)}setData(p){return this._data=p,this._updateWorkerData(),this}updateData(p){if(!this._options.dynamic)return this.fire(new i.y(new Error("Can't call updateData on a GeoJSON source with dynamic set to false.")));if(typeof p!="string"&&(p.type==="Feature"&&(p={type:"FeatureCollection",features:[p]}),p.type!=="FeatureCollection"))return this.fire(new i.y(new Error("Data to update should be a feature or a feature collection.")));if(this._coalesce&&typeof p!="string"&&typeof this._data!="string"&&this._data.type==="FeatureCollection"){const r=new Map;for(const l of this._data.features)r.set(l.id,l);for(const l of p.features)r.set(l.id,l);this._data.features=[...r.values()]}else this._data=p;return this._updateWorkerData(!0),this}getClusterExpansionZoom(p,r){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:p,source:this.id,scope:this.scope},r),this}getClusterChildren(p,r){return this.actor.send("geojson.getClusterChildren",{clusterId:p,source:this.id,scope:this.scope},r),this}getClusterLeaves(p,r,l,m){return this.actor.send("geojson.getClusterLeaves",{source:this.id,scope:this.scope,clusterId:p,limit:r,offset:l},m),this}_updateWorkerData(p=!1){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new i.z("dataloading",{dataType:"source"})),this._loaded=!1;const r=i.l({append:p},this.workerOptions);r.scope=this.scope;const l=this._data;typeof l=="string"?(r.request=this.map._requestManager.transformRequest(i.q.resolveURL(l),i.R.Source),r.request.collectResourceTiming=this._collectResourceTiming):r.data=JSON.stringify(l),this._pendingLoad=this.actor.send(`${this.type}.loadData`,r,(m,x)=>{if(this._loaded=!0,this._pendingLoad=null,m)this.fire(new i.y(m));else{const w={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&x&&x.resourceTiming&&x.resourceTiming[this.id]&&(w.resourceTiming=x.resourceTiming[this.id]),p&&(this._partialReload=!0),this.fire(new i.z("data",w)),this._partialReload=!1,this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(p),this._coalesce=!1)})}loaded(){return this._loaded}reload(){const p=i.aC(this.id,this.scope);this.map.style.clearSource(p),this._updateWorkerData()}loadTile(p,r){const l=p.actor?"reloadTile":"loadTile";p.actor=this.actor;const m=this.map.style?this.map.style.getLut(this.scope):null,x=m?{image:m.image.clone()}:null,w=this._partialReload,A={type:this.type,uid:p.uid,tileID:p.tileID,tileZoom:p.tileZoom,zoom:p.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,lut:x,scope:this.scope,pixelRatio:i.q.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,brightness:this.map.style&&this.map.style.getBrightness()||0,scaleFactor:this.map.getScaleFactor(),partial:w};p.request=this.actor.send(l,A,(D,N)=>w&&!N?(p.state="loaded",r(null)):(delete p.request,p.destroy(),p.aborted?r(null):D?r(D):(p.loadVectorData(N,this.map.painter,l==="reloadTile"),r(null))),void 0,l==="loadTile")}abortTile(p){p.request&&(p.request.cancel(),delete p.request),p.aborted=!0}unloadTile(p,r){this.actor.send("removeTile",{uid:p.uid,type:this.type,source:this.id,scope:this.scope}),p.destroy()}onRemove(p){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return i.l({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends i.aJ{constructor(p,r,l,m){super(p,r,l,m),this.roundZoom=!0,this.type="video",this.options=r}load(){this._loaded=!1;const p=this.options;this.urls=[];for(const r of p.urls)this.urls.push(this.map._requestManager.transformRequest(r,i.R.Source).url);i.aK(this.urls,(r,l)=>{this._loaded=!0,r?this.fire(new i.y(r)):l&&(this.video=l,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(p){if(this.video){const r=this.video.seekable;p<r.start(0)||p>r.end(0)?this.fire(new i.y(new i.V(`sources.${this.id}`,null,`Playback for this video can be set only between the ${r.start(0)} and ${r.end(0)}-second mark.`))):this.video.currentTime=p}}getVideo(){return this.video}onAdd(p){this.map||(this.map=p,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const p=this.map.painter.context,r=p.gl;this.texture?this.video.paused||(this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE),r.texSubImage2D(r.TEXTURE_2D,0,0,0,r.RGBA,r.UNSIGNED_BYTE,this.video)):(this.texture=new i.T(p,this.video,r.RGBA8),this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(p)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:i.aJ,model:class extends i.E{constructor(p,r,l,m){super(),this.id=p,this.type="model",this.models=[],this._loaded=!1,this._options=r}load(){const p=[];for(const r in this._options.models){const l=this._options.models[r],m=i.aM(this.map._requestManager.transformRequest(l.uri,i.R.Model).url).then(x=>{if(!x)return;const w=i.aN(x),A=new i.aO(r,l.position,l.orientation,w);A.computeBoundsAndApplyParent(),this.models.push(A)}).catch(x=>{this.fire(new i.y(new Error(`Could not load model ${r} from ${l.uri}: ${x.message}`)))});p.push(m)}return Promise.allSettled(p).then(()=>{this._loaded=!0,this.fire(new i.z("data",{dataType:"source",sourceDataType:"metadata"}))}).catch(r=>{this.fire(new i.y(new Error(`Could not load models: ${r.message}`)))})}onAdd(p){this.map=p,this.load()}hasTransition(){return!1}loaded(){return this._loaded}getModels(){return this.models}loadTile(p,r){}serialize(){return{type:"model"}}},"batched-model":class extends i.E{constructor(p,r,l,m){super(),this.type="batched-model",this.id=p,this.tileSize=512,this._options=r,this.tiles=this._options.tiles,this.maxzoom=r.maxzoom||19,this.minzoom=r.minzoom||0,this.roundZoom=!0,this.usedInConflation=!0,this.dispatcher=l,this.reparseOverscaled=!1,this.scheme="xyz",this._loaded=!1,this.setEventedParent(m)}onAdd(p){this.map=p,this.load()}reload(){this.cancelTileJSONRequest();const p=i.aC(this.id,this.scope);this.load(()=>this.map.style.clearSource(p))}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}load(p){this._loaded=!1,this.fire(new i.z("dataloading",{dataType:"source"}));const r=Array.isArray(this.map._language)?this.map._language.join():this.map._language,l=this.map.getWorldview();this._tileJSONRequest=dr(this._options,this.map._requestManager,r,l,(m,x)=>{this._tileJSONRequest=null,this._loaded=!0,m?(r&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${r}`),l&&l.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${l}`),this.fire(new i.y(m))):x&&(i.l(this,x),x.bounds&&(this.tileBounds=new vr(x.bounds,this.minzoom,this.maxzoom)),rn(x.tiles,this.map._requestManager._customAccessToken),this.fire(new i.z("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.z("data",{dataType:"source",sourceDataType:"content"}))),p&&p(m)})}hasTransition(){return!1}hasTile(p){return!this.tileBounds||this.tileBounds.contains(p.canonical)}loaded(){return this._loaded}loadTile(p,r){const l=this.map._requestManager.normalizeTileURL(p.tileID.canonical.url(this.tiles,this.scheme)),m={request:this.map._requestManager.transformRequest(l,i.R.Tile),data:void 0,uid:p.uid,tileID:p.tileID,tileZoom:p.tileZoom,zoom:p.tileID.overscaledZ,tileSize:this.tileSize*p.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,showCollisionBoxes:this.map.showCollisionBoxes,isSymbolTile:p.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,lut:null,maxZoom:null,promoteId:null,pixelRatio:null,scaleFactor:null};if(p.actor&&p.state!=="expired")if(p.state==="loading")p.reloadCallback=r;else{if(p.buckets){const w=Object.values(p.buckets);for(const A of w)A.dirty=!0;return void(p.state="loaded")}p.request=p.actor.send("reloadTile",m,x.bind(this))}else p.actor=this.dispatcher.getActor(),p.request=p.actor.send("loadTile",m,x.bind(this),void 0,!0);function x(w,A){return p.aborted?r(null):w&&w.status!==404?r(w):(this.map._refreshExpiredTiles&&A&&p.setExpiryData(A),p.loadModelData(A,this.map.painter),p.state="loaded",void r(null))}}serialize(){return i.l({},this._options)}},canvas:class extends i.aJ{constructor(p,r,l,m){super(p,r,l,m),r.coordinates?Array.isArray(r.coordinates)&&r.coordinates.length===4&&!r.coordinates.some(x=>!Array.isArray(x)||x.length!==2||x.some(w=>typeof w!="number"))||this.fire(new i.y(new i.V(`sources.${p}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new i.y(new i.V(`sources.${p}`,null,'missing required property "coordinates"'))),r.animate&&typeof r.animate!="boolean"&&this.fire(new i.y(new i.V(`sources.${p}`,null,'optional "animate" property must be a boolean value'))),r.canvas?typeof r.canvas=="string"||r.canvas instanceof HTMLCanvasElement||this.fire(new i.y(new i.V(`sources.${p}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new i.y(new i.V(`sources.${p}`,null,'missing required property "canvas"'))),this.options=r,this.animate=r.animate===void 0||r.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new i.y(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(p){this.map=p,this.load(),this.canvas&&this.animate&&this.play()}onRemove(p){this.pause()}prepare(){let p=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,p=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,p=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const r=this.map.painter.context;this.texture?!p&&!this._playing||this.texture instanceof i.aL||this.texture.update(this.canvas,{premultiply:!0}):this.texture=new i.T(r,this.canvas,r.gl.RGBA8,{premultiply:!0}),this._prepareData(r)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const p of[this.canvas.width,this.canvas.height])if(isNaN(p)||p<=0)return!0;return!1}},custom:class extends i.E{constructor(p,r,l,m){super(),this.id=p,this.type="custom",this._dataType="raster",this._dispatcher=l,this._implementation=r,this.setEventedParent(m),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new i.y(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new i.y(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new vr(this._implementation.bounds,this.minzoom,this.maxzoom)),r.update=this._update.bind(this),r.clearTiles=this._clearTiles.bind(this),r.coveringTiles=this._coveringTiles.bind(this),i.l(this,i.ay(r,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return i.ay(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new i.z("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.z("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(p){this.map=p,this._loaded=!1,this.fire(new i.z("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(p),this.load()}onRemove(p){this._implementation.onRemove&&this._implementation.onRemove(p)}hasTile(p){if(this._implementation.hasTile){const{x:r,y:l,z:m}=p.canonical;return this._implementation.hasTile({x:r,y:l,z:m})}return!this.tileBounds||this.tileBounds.contains(p.canonical)}loadTile(p,r){const{x:l,y:m,z:x}=p.tileID.canonical,w=new AbortController;p.request=Promise.resolve(this._implementation.loadTile({x:l,y:m,z:x},{signal:w.signal})).then((function(A){return delete p.request,p.aborted?(p.state="unloaded",r(null)):A===void 0?(p.state="errored",r(null)):A===null?(this.loadTileData(p,{width:this.tileSize,height:this.tileSize,data:null}),p.state="loaded",r(null)):function(D){return D instanceof ImageData||D instanceof HTMLCanvasElement||D instanceof ImageBitmap||D instanceof HTMLImageElement}(A)?(this.loadTileData(p,A),p.state="loaded",void r(null)):(p.state="errored",r(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}).bind(this)).catch(A=>{A.code!==20&&(p.state="errored",r(A))}),p.request.cancel=()=>w.abort()}loadTileData(p,r){p.setTexture(r,this.map.painter)}unloadTile(p,r){if(p.texture&&p.texture instanceof i.T?(p.destroy(!0),p.texture&&p.texture instanceof i.T&&this.map.painter.saveTileTexture(p.texture)):p.destroy(),this._implementation.unloadTile){const{x:l,y:m,z:x}=p.tileID.canonical;this._implementation.unloadTile({x:l,y:m,z:x})}r&&r()}abortTile(p,r){p.request&&p.request.cancel&&(p.request.cancel(),delete p.request),r&&r()}hasTransition(){return!1}_coveringTiles(){return this.map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(p=>({x:p.canonical.x,y:p.canonical.y,z:p.canonical.z}))}_clearTiles(){const p=i.aC(this.id,this.scope);this.map.style.clearSource(p)}_update(){this.fire(new i.z("data",{dataType:"source",sourceDataType:"content"}))}}},di=function(p,r,l,m){const x=new ii[r.type](p,r,l,m);if(x.id!==p)throw new Error(`Expected Source id to be ${p} instead of ${x.id}`);return i.aP(["load","abort","unload","serialize","prepare"],x),x};function mh(p,r,l=""){return`${l}:${r.id||""}:${r.layer.id}:${function(m){if("layerId"in m)return`layer:${m.layerId}`;{const{featuresetId:x,importId:w}=m;return`featureset:${x}${w?`:import:${w}`:""}`}}(p.target)}`}function Cl(p,r,l,m=""){if(p.uniqueFeatureID){const x=mh(p,r,m);if(l.has(x))return!0;l.add(x)}return!1}function fc(p,r,l,m,x=!1){const w=r.sourceCache.transform,A=r.sourceCache.tilesIn(p,r.has3DLayers,x);A.sort(Sm);const D=[];for(const N of A){const U=N.tile.queryRenderedFeatures(r,N,l,m,w,x);Object.keys(U).length&&D.push({wrappedTileID:N.tile.tileID.wrapped().key,queryResults:U})}return D.length===0?{}:function(N){const U={},$={};for(const Z of N){const W=Z.queryResults,te=Z.wrappedTileID,ue=$[te]=$[te]||{};for(const se in W){const de=W[se],he=ue[se]=ue[se]||{},Te=U[se]=U[se]||[];for(const Pe of de)he[Pe.featureIndex]||(he[Pe.featureIndex]=!0,Te.push(Pe))}}return U}(D)}function ap(p,r,l,m,x){const w={},A=m.queryRenderedSymbols(p),D=[];for(const N of Object.keys(A).map(Number))D.push(x[N]);D.sort(Sm);for(const N of D){const U=N.featureIndex.lookupSymbolFeatures(A[N.bucketInstanceId],N.bucketIndex,N.sourceLayerIndex,r,l);for(const $ in U){const Z=w[$]=w[$]||[],W=U[$];W.sort((te,ue)=>{const se=N.featureSortOrder;if(se){const de=se.indexOf(te.featureIndex);return se.indexOf(ue.featureIndex)-de}return ue.featureIndex-te.featureIndex});for(const te of W)Z.push(te)}}return w}function Rf(p,r){const l=p.getRenderableIds().map(w=>p.getTileByID(w)),m=[],x={};for(let w=0;w<l.length;w++){const A=l[w],D=A.tileID.canonical.key;x[D]||(x[D]=!0,A.querySourceFeatures(m,r))}return m}function Sm(p,r){const l=p.tileID,m=r.tileID;return l.overscaledZ-m.overscaledZ||l.canonical.y-m.canonical.y||l.wrap-m.wrap||l.canonical.x-m.canonical.x}function So(p,r){const l={};if(!r)return l;for(const m of p){const x=m.layerIds.map(w=>r.getLayer(w)).filter(Boolean);if(x.length!==0){m.layers=x,m.stateDependentLayerIds&&(m.stateDependentLayers=m.stateDependentLayerIds.map(w=>x.filter(A=>A.id===w)[0]));for(const w of x)l[w.fqid]=m}}return l}const Ra=32,ss=33,Ls=new Uint16Array(8184);for(let p=0;p<2046;p++){let r=p+2,l=0,m=0,x=0,w=0,A=0,D=0;for(1&r?x=w=A=Ra:l=m=D=Ra;(r>>=1)>1;){const U=l+x>>1,$=m+w>>1;1&r?(x=l,w=m,l=A,m=D):(l=x,m=w,x=A,w=D),A=U,D=$}const N=4*p;Ls[N+0]=l,Ls[N+1]=m,Ls[N+2]=x,Ls[N+3]=w}const uo=new Uint16Array(2178),ls=new Uint8Array(1089),ks=new Uint16Array(1089);function Ml(p){return p===0?-.03125:p===32?.03125:0}const Tm={type:2,extent:i.ag,loadGeometry:()=>[[new i.P(0,0),new i.P(i.ag+1,0),new i.P(i.ag+1,i.ag+1),new i.P(0,i.ag+1),new i.P(0,0)]]};class Ol{constructor(r,l,m,x,w){this.tileID=r,this.uid=i.aV(),this.uses=0,this.tileSize=l,this.tileZoom=m,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=w,x&&x.style&&(this._lastUpdatedBrightness=x.style.getBrightness()),this.expiredRequestCount=0,this.state="loading",x&&x.transform&&(this.projection=x.transform.projection)}registerFadeDuration(r){const l=r+this.timeAdded;l<i.q.now()||this.fadeEndTime&&l<this.fadeEndTime||(this.fadeEndTime=l)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=i.aQ(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(r,l,m){if(this.unloadVectorData(),this.state="loaded",r){r.featureIndex&&(this.latestFeatureIndex=r.featureIndex,r.rawTileData?(this.latestRawTileData=r.rawTileData,this.latestFeatureIndex.rawTileData=r.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=r.collisionBoxArray,this.buckets=So(r.buckets,l.style),this.hasSymbolBuckets=!1;for(const x in this.buckets){const w=this.buckets[x];if(w instanceof i.aX){if(this.hasSymbolBuckets=!0,!m)break;w.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const x in this.buckets){const w=this.buckets[x];if(w instanceof i.aX&&w.hasRTLText){this.hasRTLText=!0,i.aY();break}}this.queryPadding=0;for(const x in this.buckets){const w=this.buckets[x],A=l.style.getOwnLayer(x);if(!A)continue;const D=A.queryRadius(w);this.queryPadding=Math.max(this.queryPadding,D)}r.imageAtlas&&(this.imageAtlas=r.imageAtlas),r.glyphAtlasImage&&(this.glyphAtlasImage=r.glyphAtlasImage),r.lineAtlas&&(this.lineAtlas=r.lineAtlas),this._lastUpdatedBrightness=r.brightness}else this.collisionBoxArray=new i.aW}unloadVectorData(){if(this.hasData()){for(const r in this.buckets)this.buckets[r].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}loadModelData(r,l,m){r&&(r.resourceTiming&&(this.resourceTiming=r.resourceTiming),this.buckets=Object.assign({},this.buckets,So(r.buckets,l.style)),r.featureIndex&&(this.latestFeatureIndex=r.featureIndex))}getBucket(r){return this.buckets[r.fqid]}upload(r){for(const x in this.buckets){const w=this.buckets[x];w.uploadPending()&&w.upload(r)}const l=r.gl,m=this.imageAtlas;if(m&&!m.uploaded){const x=!!Object.keys(m.patternPositions).length;this.imageAtlasTexture=new i.T(r,m.image,l.RGBA8,{useMipmap:x}),this.imageAtlas.uploaded=!0}this.glyphAtlasImage&&(this.glyphAtlasTexture=new i.T(r,this.glyphAtlasImage,l.R8),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new i.T(r,this.lineAtlas.image,l.R8),this.lineAtlas.uploaded=!0)}prepare(r,l,m){if(this.imageAtlas&&this.imageAtlasTexture&&this.imageAtlas.patchUpdatedImages(r,this.imageAtlasTexture,m),!l||!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData)return;const x=l.style.getBrightness();(this._lastUpdatedBrightness||x)&&(this._lastUpdatedBrightness&&x&&Math.abs(this._lastUpdatedBrightness-x)<.001||(this.updateBuckets(l,this._lastUpdatedBrightness!==x),this._lastUpdatedBrightness=x))}queryRenderedFeatures(r,l,m,x,w,A){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData&&!this.latestFeatureIndex.is3DTile)return{};const D=function(N,U){const $=i.ab.mat4.fromScaling([],[.5*N.width,.5*-N.height,1]);return i.ab.mat4.translate($,$,[1,-1,0]),i.ab.mat4.multiply($,$,N.calculateProjMatrix(U.toUnwrapped())),Float32Array.from($)}(w,this.tileID);return this.latestFeatureIndex.query(r,{tilespaceGeometry:l,pixelPosMatrix:D,transform:x,availableImages:m,tileTransform:this.tileTransform})}querySourceFeatures(r,l){const m=this.latestFeatureIndex;if(!m||!m.rawTileData)return;const x=m.loadVTLayers(),w=l?l.sourceLayer:"",A=x._geojsonTileLayer||x[w];if(!A)return;const D=i.aZ(l&&l.filter),{z:N,x:U,y:$}=this.tileID.canonical,Z={z:N,x:U,y:$};for(let W=0;W<A.length;W++){const te=A.feature(W);if(D.needGeometry){const de=i.a_(te,!0);if(!D.filter(new i.a8(this.tileID.overscaledZ),de,this.tileID.canonical))continue}else if(!D.filter(new i.a8(this.tileID.overscaledZ),te))continue;const ue=m.getId(te,w),se=new i.a$(te,N,U,$,ue);se.tile=Z,r.push(se)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(r){const l=this.expirationTime;if(r.cacheControl){const m=i.b0(r.cacheControl);m["max-age"]&&(this.expirationTime=Date.now()+1e3*m["max-age"])}else r.expires&&(this.expirationTime=new Date(r.expires).getTime());if(this.expirationTime){const m=Date.now();let x=!1;if(this.expirationTime>m)x=!1;else if(l)if(this.expirationTime<l)x=!0;else{const w=this.expirationTime-l;w?this.expirationTime=m+Math.max(w,3e4):x=!0}else x=!0;x?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}refreshFeatureState(r){this.latestFeatureIndex&&(this.latestFeatureIndex.rawTileData||this.latestFeatureIndex.is3DTile)&&r&&this.updateBuckets(r)}updateBuckets(r,l){if(!this.latestFeatureIndex||!r.style)return;const m=this.latestFeatureIndex.loadVTLayers(),x=r.style.listImages(),w=r.style.getBrightness();for(const A in this.buckets){if(!r.style.hasLayer(A))continue;const D=this.buckets[A],N=D.layers[0],U=N.sourceLayer||"_geojsonTileLayer",$=m[U],Z=r.style.getLayerSourceCache(N);let W={};Z&&(W=Z._state.getState(U,void 0));const te=this.imageAtlas&&this.imageAtlas.patternPositions||{},ue=Object.keys(W).length>0&&!l;ue&&!D.stateDependentLayers.length&&!l||D.update(W,$,x,te,ue?D.stateDependentLayers:D.layers,l,w),(D instanceof i.b1||D instanceof i.b2)&&r._terrain&&r._terrain.enabled&&Z&&D.programConfigurations.needsUpload&&r._terrain._clearRenderCacheForTile(Z.id,this.tileID);const se=r&&r.style&&r.style.getOwnLayer(A);se&&(this.queryPadding=Math.max(this.queryPadding,se.queryRadius(D)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<i.q.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(r){this.symbolFadeHoldUntil=i.q.now()+r}setTexture(r,l){const m=l.context,x=m.gl;this.texture=this.texture||l.getTileTexture(r.width),this.texture&&this.texture instanceof i.T?this.texture.update(r):(this.texture=new i.T(m,r,x.RGBA8,{useMipmap:!0}),this.texture.bind(x.LINEAR,x.CLAMP_TO_EDGE))}setDependencies(r,l){const m={};for(const x of l)m[x]=!0;this.dependencies[r]=m}hasDependency(r,l){for(const m of r){const x=this.dependencies[m];if(x){for(const w of l)if(x[w])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(r,l){if(!l||l.name==="mercator"||this._tileDebugBuffer)return;const m=i.b3(Tm,this.tileID.canonical,this.tileTransform)[0],x=new i.b4,w=new i.b5;for(let A=0;A<m.length;A++){const{x:D,y:N}=m[A];x.emplaceBack(D,N),w.emplaceBack(A)}w.emplaceBack(0),this._tileDebugIndexBuffer=r.createIndexBuffer(w),this._tileDebugBuffer=r.createVertexBuffer(x,i.b6.members),this._tileDebugSegments=i.b7.simpleSegment(0,0,x.length,w.length)}_makeTileBoundsBuffers(r,l){if(this._tileBoundsBuffer||!l||l.name==="mercator")return;const m=i.b3(Tm,this.tileID.canonical,this.tileTransform)[0];let x,w;if(this.isRaster){const A=function(D,N){const U=i.aQ(D,N),$=Math.pow(2,D.z);for(let de=0;de<ss;de++)for(let he=0;he<ss;he++){const Te=i.aR((D.x+(he+Ml(he))/Ra)/$),Pe=i.aS((D.y+(de+Ml(de))/Ra)/$),Me=N.project(Te,Pe),Fe=de*ss+he;uo[2*Fe+0]=Math.round((Me.x*U.scale-U.x)*i.ag),uo[2*Fe+1]=Math.round((Me.y*U.scale-U.y)*i.ag)}ls.fill(0),ks.fill(0);for(let de=2045;de>=0;de--){const he=4*de,Te=Ls[he+0],Pe=Ls[he+1],Me=Ls[he+2],Fe=Ls[he+3],Re=Te+Me>>1,ze=Pe+Fe>>1,De=Re+ze-Pe,$e=ze+Te-Re,Xe=Pe*ss+Te,ht=Fe*ss+Me,ot=ze*ss+Re,Et=Math.hypot((uo[2*Xe+0]+uo[2*ht+0])/2-uo[2*ot+0],(uo[2*Xe+1]+uo[2*ht+1])/2-uo[2*ot+1])>=16;ls[ot]=ls[ot]||(Et?1:0),de<1022&&(ls[ot]=ls[ot]||ls[(Pe+$e>>1)*ss+(Te+De>>1)]||ls[(Fe+$e>>1)*ss+(Me+De>>1)])}const Z=new i.aT,W=new i.aU;let te=0;function ue(de,he){const Te=he*ss+de;return ks[Te]===0&&(Z.emplaceBack(uo[2*Te+0],uo[2*Te+1],de*i.ag/Ra,he*i.ag/Ra),ks[Te]=++te),ks[Te]-1}function se(de,he,Te,Pe,Me,Fe){const Re=de+Te>>1,ze=he+Pe>>1;if(Math.abs(de-Me)+Math.abs(he-Fe)>1&&ls[ze*ss+Re])se(Me,Fe,de,he,Re,ze),se(Te,Pe,Me,Fe,Re,ze);else{const De=ue(de,he),$e=ue(Te,Pe),Xe=ue(Me,Fe);W.emplaceBack(De,$e,Xe)}}return se(0,0,Ra,Ra,Ra,0),se(Ra,Ra,0,0,0,Ra),{vertices:Z,indices:W}}(this.tileID.canonical,l);x=A.vertices,w=A.indices}else{x=new i.aT,w=new i.aU;for(const{x:D,y:N}of m)x.emplaceBack(D,N,0,0);const A=i.b8(x.int16,void 0,4);for(let D=0;D<A.length;D+=3)w.emplaceBack(A[D],A[D+1],A[D+2])}this._tileBoundsBuffer=r.createVertexBuffer(x,i.b9.members),this._tileBoundsIndexBuffer=r.createIndexBuffer(w),this._tileBoundsSegments=i.b7.simpleSegment(0,0,x.length,w.length)}_makeGlobeTileDebugBuffers(r,l){const m=l.projection;if(!m||m.name!=="globe"||l.freezeTileCoverage)return;const x=this.tileID.canonical,w=i.ba(x,l),A=i.bb(w),D=i.ae(l.zoom);let N;D>0&&(N=i.ab.mat4.invert(new Float64Array(16),l.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(r,x,l,A,N,D),this._makeGlobeTileDebugTextBuffer(r,x,l,A,N,D)}_globePoint(r,l,m,x,w,A,D){let N=i.bc(r,l,m);if(A){const U=1<<m.z,$=i.at(x.center.lng),Z=i.aA(x.center.lat),W=(m.x+.5)/U-$;let te=0;W>.5?te=-1:W<-.5&&(te=1);let ue=(r/i.ag+m.x)/U+te,se=(l/i.ag+m.y)/U;ue=(ue-$)*x._pixelsPerMercatorPixel+$,se=(se-Z)*x._pixelsPerMercatorPixel+Z;const de=[ue*x.worldSize,se*x.worldSize,0];i.ab.vec3.transformMat4(de,de,A),N=i.bd(N,de,D)}return i.ab.vec3.transformMat4(N,N,w)}_makeGlobeTileDebugBorderBuffer(r,l,m,x,w,A){const D=new i.b4,N=new i.b5,U=new i.be,$=(W,te,ue,se,de)=>{const he=(ue-W)/(de-1),Te=(se-te)/(de-1),Pe=D.length;for(let Me=0;Me<de;Me++){const Fe=W+Me*he,Re=te+Me*Te;D.emplaceBack(Fe,Re);const ze=this._globePoint(Fe,Re,l,m,x,w,A);U.emplaceBack(ze[0],ze[1],ze[2]),N.emplaceBack(Pe+Me)}},Z=i.ag;$(0,0,Z,0,16),$(Z,0,Z,Z,16),$(Z,Z,0,Z,16),$(0,Z,0,0,16),this._tileDebugIndexBuffer=r.createIndexBuffer(N),this._tileDebugBuffer=r.createVertexBuffer(D,i.b6.members),this._globeTileDebugBorderBuffer=r.createVertexBuffer(U,i.bf.members),this._tileDebugSegments=i.b7.simpleSegment(0,0,D.length,N.length)}_makeGlobeTileDebugTextBuffer(r,l,m,x,w,A){const D=i.ag/4,N=new i.b4,U=new i.aU,$=new i.be,Z=25;U.reserve(32),N.reserve(Z),$.reserve(Z);const W=(te,ue)=>Z*te+ue;for(let te=0;te<Z;te++){const ue=te*D;for(let se=0;se<Z;se++){const de=se*D;N.emplaceBack(de,ue);const he=this._globePoint(de,ue,l,m,x,w,A);$.emplaceBack(he[0],he[1],he[2])}}for(let te=0;te<4;te++)for(let ue=0;ue<4;ue++){const se=W(te,ue),de=W(te,ue+1),he=W(te+1,ue),Te=W(te+1,ue+1);U.emplaceBack(se,de,he),U.emplaceBack(he,de,Te)}this._tileDebugTextIndexBuffer=r.createIndexBuffer(U),this._tileDebugTextBuffer=r.createVertexBuffer(N,i.b6.members),this._globeTileDebugTextBuffer=r.createVertexBuffer($,i.bf.members),this._tileDebugTextSegments=i.b7.simpleSegment(0,0,Z,32)}destroy(r=!1){for(const l in this.buckets)this.buckets[l].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&(this.imageAtlasTexture.destroy(),delete this.imageAtlasTexture),this.glyphAtlasTexture&&(this.glyphAtlasTexture.destroy(),delete this.glyphAtlasTexture),this.lineAtlasTexture&&(this.lineAtlasTexture.destroy(),delete this.lineAtlasTexture),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),!r&&this.texture&&this.texture instanceof i.T&&(this.texture.destroy(),delete this.texture),this.hillshadeFBO&&(this.hillshadeFBO.destroy(),delete this.hillshadeFBO),this.dem&&delete this.dem,this.neighboringTiles&&delete this.neighboringTiles,this.demTexture&&(this.demTexture.destroy(),delete this.demTexture),this.rasterParticleState&&(this.rasterParticleState.destroy(),delete this.rasterParticleState),this.latestFeatureIndex=null,this.state="unloaded"}}i.bg.setPbf(i.bh);class Pl extends Ol{constructor(r,l,m,x,w){super(r,l,m,x,w),this._workQueue=[],this._fetchQueue=[],this._isHeaderLoaded=!1}setTexture(r,l){const m=l.context,x=m.gl;this.texture=this.texture||l.getTileTexture(r.width),this.texture&&this.texture instanceof i.T?this.texture.update(r,{premultiply:!1}):this.texture=new i.T(m,r,x.RGBA8,{premultiply:!1})}flushQueues(){for(;this._workQueue.length;)this._workQueue.pop()();for(;this._fetchQueue.length;)this._fetchQueue.pop()()}fetchHeader(r=16384,l){const m=this._mrt=new i.bg(30),x=Object.assign({},this.requestParams,{headers:{Range:"bytes=0-"+(r-1)}});return this.entireBuffer=null,this.request=i.bi(x,(w,A,D,N)=>{if(w)l(w);else try{const U=m.getHeaderLength(A);if(U>r)return void(this.request=this.fetchHeader(U,l));m.parseHeader(A),this._isHeaderLoaded=!0;let $=0;for(const Z of Object.values(m.layers))$=Math.max($,Z.dataIndex[Z.dataIndex.length-1].last_byte);A.byteLength>=$&&(this.entireBuffer=A),l(null,this.entireBuffer||A,D,N)}catch(U){l(U)}}),this.request}fetchBand(r,l,m){const x=this._mrt;if(!this._isHeaderLoaded||!x)return void m(new Error("Tile header is not ready"));const w=this.actor;if(!w)return void m(new Error("Can't fetch tile band without an actor"));let A;const D=(Z,W)=>{A.complete(Z,W),Z?m(Z):(this.updateTextureDescriptor(r,l),m(null,this.textureDescriptor&&this.textureDescriptor.img))},N=(Z,W)=>{if(Z)return m(Z);const te=w.send("decodeRasterArray",{buffer:W,task:A},D,void 0,!0);this._workQueue.push(()=>{te&&te.cancel(),A.cancel()})},U=x.getLayer(r);if(!U)return void m(new Error(`Unknown sourceLayer "${r}"`));if(U.hasDataForBand(l))return this.updateTextureDescriptor(r,l),void m(null,this.textureDescriptor?this.textureDescriptor.img:null);const $=U.getDataRange([l]);if(A=x.createDecodingTask($),!A||A.tasks.length)if(this.flushQueues(),this.entireBuffer)N(null,this.entireBuffer.slice($.firstByte,$.lastByte+1));else{const Z=Object.assign({},this.requestParams,{headers:{Range:`bytes=${$.firstByte}-${$.lastByte}`}}),W=i.bi(Z,N);this._fetchQueue.push(()=>{W.cancel(),A.cancel()})}else m(null)}updateNeeded(r,l){return(!this.textureDescriptor||this.textureDescriptor.band!==l||this.textureDescriptor.layer!==r)&&this.state!=="errored"}updateTextureDescriptor(r,l){if(!this._mrt)return;const m=this._mrt.getLayer(r);if(!m||!m.hasBand(l)||!m.hasDataForBand(l))return;const{bytes:x,tileSize:w,buffer:A,offset:D,scale:N}=m.getBandView(l),U=w+2*A,$={data:x,width:U,height:U},Z=this.texture;Z&&Z instanceof i.T&&Z.update($,{premultiply:!1}),this.textureDescriptor={layer:r,band:l,img:$,buffer:A,offset:D,tileSize:w,format:m.pixelFormat,mix:[N,256*N,65536*N,16777216*N]}}}class op{constructor(r,l){this.max=r,this.onRemove=l,this.reset()}reset(){for(const r in this.data)for(const l of this.data[r])l.timeout&&clearTimeout(l.timeout),this.onRemove(l.value);return this.data={},this.order=[],this}add(r,l,m){const x=r.wrapped().key;this.data[x]===void 0&&(this.data[x]=[]);const w={value:l,timeout:void 0};if(m!==void 0&&(w.timeout=setTimeout(()=>{this.remove(r,w)},m)),this.data[x].push(w),this.order.push(x),this.order.length>this.max){const A=this._getAndRemoveByKey(this.order[0]);A&&this.onRemove(A)}return this}has(r){return r.wrapped().key in this.data}getAndRemove(r){return this.has(r)?this._getAndRemoveByKey(r.wrapped().key):null}_getAndRemoveByKey(r){const l=this.data[r].shift();return l.timeout&&clearTimeout(l.timeout),this.data[r].length===0&&delete this.data[r],this.order.splice(this.order.indexOf(r),1),l.value}getByKey(r){const l=this.data[r];return l?l[0].value:null}get(r){return this.has(r)?this.data[r.wrapped().key][0].value:null}remove(r,l){if(!this.has(r))return this;const m=r.wrapped().key,x=l===void 0?0:this.data[m].indexOf(l),w=this.data[m][x];return this.data[m].splice(x,1),w.timeout&&clearTimeout(w.timeout),this.data[m].length===0&&delete this.data[m],this.onRemove(w.value),this.order.splice(this.order.indexOf(m),1),this}setMaxSize(r){for(this.max=r;this.order.length>this.max;){const l=this._getAndRemoveByKey(this.order[0]);l&&this.onRemove(l)}return this}filter(r){const l=[];for(const m in this.data)for(const x of this.data[m])r(x.value)||l.push(x);for(const m of l)this.remove(m.value.tileID,m)}}class Em{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(r,l,m){const x=String(l);if(this.stateChanges[r]=this.stateChanges[r]||{},this.stateChanges[r][x]=this.stateChanges[r][x]||{},i.l(this.stateChanges[r][x],m),this.deletedStates[r]===null){this.deletedStates[r]={};for(const w in this.state[r])w!==x&&(this.deletedStates[r][w]=null)}else if(this.deletedStates[r]&&this.deletedStates[r][x]===null){this.deletedStates[r][x]={};for(const w in this.state[r][x])m[w]||(this.deletedStates[r][x][w]=null)}else for(const w in m)this.deletedStates[r]&&this.deletedStates[r][x]&&this.deletedStates[r][x][w]===null&&delete this.deletedStates[r][x][w]}removeFeatureState(r,l,m){if(this.deletedStates[r]===null)return;const x=String(l);if(this.deletedStates[r]=this.deletedStates[r]||{},m&&l!==void 0)this.deletedStates[r][x]!==null&&(this.deletedStates[r][x]=this.deletedStates[r][x]||{},this.deletedStates[r][x][m]=null);else if(l!==void 0)if(this.stateChanges[r]&&this.stateChanges[r][x])for(m in this.deletedStates[r][x]={},this.stateChanges[r][x])this.deletedStates[r][x][m]=null;else this.deletedStates[r][x]=null;else this.deletedStates[r]=null}getState(r,l){const m=this.state[r]||{},x=this.stateChanges[r]||{},w=this.deletedStates[r];if(w===null)return{};if(l!==void 0){const D=String(l),N=i.l({},m[D],x[D]);if(w){const U=w[l];if(U===null)return{};for(const $ in U)delete N[$]}return N}const A=i.l({},m,x);if(w)for(const D in w)delete A[D];return A}initializeTileState(r,l){r.refreshFeatureState(l)}coalesceChanges(r,l){const m={};for(const x in this.stateChanges){this.state[x]=this.state[x]||{};const w={};for(const A in this.stateChanges[x])this.state[x][A]||(this.state[x][A]={}),i.l(this.state[x][A],this.stateChanges[x][A]),w[A]=this.state[x][A];m[x]=w}for(const x in this.deletedStates){this.state[x]=this.state[x]||{};const w={};if(this.deletedStates[x]===null)for(const A in this.state[x])w[A]={},this.state[x][A]={};else for(const A in this.deletedStates[x]){if(this.deletedStates[x][A]===null)this.state[x][A]={};else if(this.state[x][A])for(const D of Object.keys(this.deletedStates[x][A]))delete this.state[x][A][D];w[A]=this.state[x][A]}m[x]=m[x]||{},i.l(m[x],w)}if(this.stateChanges={},this.deletedStates={},Object.keys(m).length!==0)for(const x in r)r[x].refreshFeatureState(l)}}class cs extends i.E{constructor(r,l,m){super(),this.id=r,this._onlySymbols=m,l.on("data",x=>{x.dataType==="source"&&x.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&x.dataType==="source"&&x.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),l.on("error",()=>{this._sourceErrored=!0}),this._source=l,this._tiles={},this._cache=new op(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=l.minTileCacheSize,this._maxTileCacheSize=l.maxTileCacheSize,this._loadedParentTiles={},this.castsShadows=!1,this.tileCoverLift=0,this._coveredTiles={},this._shadowCasterTiles={},this._state=new Em,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="raster-array"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(r){this.map=r,this._minTileCacheSize=this._minTileCacheSize===void 0&&r?r._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&r?r._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const r in this._tiles){const l=this._tiles[r];if(l.state!=="loaded"&&l.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const r=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,r&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(r,l){return r.isSymbolTile=this._onlySymbols,r.isExtraShadowCaster=this._shadowCasterTiles[r.tileID.key],this._source.loadTile(r,l)}_unloadTile(r){if(this._source.unloadTile)return this._source.unloadTile(r)}_abortTile(r){if(this._source.abortTile)return this._source.abortTile(r)}serialize(){return this._source.serialize()}prepare(r){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const l in this._tiles){const m=this._tiles[l];m.upload(r),m.prepare(this.map.style.imageManager,this.map?this.map.painter:null,this._source.scope)}}getIds(){return i.bj(this._tiles).map(r=>r.tileID).sort(_r).map(r=>r.key)}getRenderableIds(r,l){const m=[];for(const x in this._tiles)this._isIdRenderable(+x,r,l)&&m.push(this._tiles[x]);return r?m.sort((x,w)=>{const A=x.tileID,D=w.tileID,N=new i.P(A.canonical.x,A.canonical.y)._rotate(this.transform.angle),U=new i.P(D.canonical.x,D.canonical.y)._rotate(this.transform.angle);return A.overscaledZ-D.overscaledZ||U.y-N.y||U.x-N.x}).map(x=>x.tileID.key):m.map(x=>x.tileID).sort(_r).map(x=>x.key)}hasRenderableParent(r){const l=this.findLoadedParent(r,0);return!!l&&this._isIdRenderable(l.tileID.key)}_isIdRenderable(r,l,m){return this._tiles[r]&&this._tiles[r].hasData()&&!this._coveredTiles[r]&&(l||!this._tiles[r].holdingForFade())&&(m||!this._shadowCasterTiles[r])}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const r in this._tiles)this._tiles[r].state!=="errored"&&this._reloadTile(+r,"reloading")}}_reloadTile(r,l){const m=this._tiles[r];m&&(m.state!=="loading"&&(m.state=l),this._loadTile(m,this._tileLoaded.bind(this,m,r,l)))}_tileLoaded(r,l,m,x){if(x)if(r.state="errored",x.status!==404)this._source.fire(new i.y(x,{tile:r}));else{if(this._source.fire(new i.z("data",{dataType:"source",sourceDataType:"error",sourceId:this._source.id,tile:r})),!(r.tileID.key in this._loadedParentTiles))return;if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const w=this.map.painter.terrain;this.update(this.transform,w.getScaledDemTileSize(),!0),w.resetTileLookupCache(this.id)}else this.update(this.transform)}else r.timeAdded=i.q.now(),m==="expired"&&(r.refreshedUponExpiration=!0),this._setTileReloadTimer(l,r),this._source.type==="raster-dem"&&r.dem&&this._backfillDEM(r),this._state.initializeTileState(r,this.map?this.map.painter:null),this._source.fire(new i.z("data",{dataType:"source",tile:r,coord:r.tileID,sourceCacheId:this.id}))}_backfillDEM(r){const l=this.getRenderableIds();for(let x=0;x<l.length;x++){const w=l[x];if(r.neighboringTiles&&r.neighboringTiles[w]){const A=this.getTileByID(w);m(r,A),m(A,r)}}function m(x,w){if(!x.dem||x.dem.borderReady)return;x.needsHillshadePrepare=!0,x.needsDEMTextureUpload=!0;let A=w.tileID.canonical.x-x.tileID.canonical.x;const D=w.tileID.canonical.y-x.tileID.canonical.y,N=Math.pow(2,x.tileID.canonical.z),U=w.tileID.key;A===0&&D===0||Math.abs(D)>1||(Math.abs(A)>1&&(Math.abs(A+N)===1?A+=N:Math.abs(A-N)===1&&(A-=N)),w.dem&&x.dem&&(x.dem.backfillBorder(w.dem,A,D),x.neighboringTiles&&x.neighboringTiles[U]&&(x.neighboringTiles[U].backfilled=!0)))}}getTile(r){return this.getTileByID(r.key)}getTileByID(r){return this._tiles[r]}_retainLoadedChildren(r,l,m,x){for(const w in this._tiles){let A=this._tiles[w];if(x[w]||!A.hasData()||A.tileID.overscaledZ<=l||A.tileID.overscaledZ>m)continue;let D=A.tileID;for(;A&&A.tileID.overscaledZ>l+1;){const U=A.tileID.scaledTo(A.tileID.overscaledZ-1);A=this._tiles[U.key],A&&A.hasData()&&(D=U)}let N=D;for(;N.overscaledZ>l;)if(N=N.scaledTo(N.overscaledZ-1),r[N.key]){x[D.key]=D;break}}}findLoadedParent(r,l){if(r.key in this._loadedParentTiles){const m=this._loadedParentTiles[r.key];return m&&m.tileID.overscaledZ>=l?m:null}for(let m=r.overscaledZ-1;m>=l;m--){const x=r.scaledTo(m),w=this._getLoadedTile(x);if(w)return w}}_getLoadedTile(r){const l=this._tiles[r.key];return l&&l.hasData()?l:this._cache.getByKey(this._source.reparseOverscaled?r.wrapped().key:r.canonical.key)}updateCacheSize(r,l){l=l||this._source.tileSize;const m=Math.ceil(r.width/l)+1,x=Math.ceil(r.height/l)+1,w=Math.floor(m*x*5),A=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,w):w,D=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,A):A;this._cache.setMaxSize(D)}handleWrapJump(r){const l=Math.round((r-(this._prevLng===void 0?r:this._prevLng))/360);if(this._prevLng=r,l){const m={};for(const x in this._tiles){const w=this._tiles[x];w.tileID=w.tileID.unwrapTo(w.tileID.wrap+l),m[w.tileID.key]=w}this._tiles=m;for(const x in this._timers)clearTimeout(this._timers[x]),delete this._timers[x];for(const x in this._tiles)this._setTileReloadTimer(+x,this._tiles[x])}}update(r,l,m,x){if(this.transform=r,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!m)return;this.updateCacheSize(r,l),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._shadowCasterTiles={},this._coveredTiles={};const w=this._source.type==="batched-model";let A,D=this._source.maxzoom;const N=this.map&&this.map.painter?this.map.painter._terrain:null;if(N&&N.sourceCache===this&&N.attenuationRange()){const Z=N.attenuationRange()[0],W=Math.floor(Z)-Math.log2(N.getDemUpscale());D>W&&(D=W)}if(this.used||this.usedForTerrain){if(this._source.tileID)A=r.getVisibleUnwrappedCoordinates(this._source.tileID).map(Z=>new i.aG(Z.canonical.z,Z.wrap,Z.canonical.z,Z.canonical.x,Z.canonical.y));else if(this.tileCoverLift!==0){const Z=r.clone();Z.tileCoverLift=this.tileCoverLift,A=Z.coveringTiles({tileSize:l||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:D,roundZoom:this._source.roundZoom&&!m,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:w}),this._source.minzoom<=1&&r.projection.name==="globe"&&(A.push(new i.aG(1,0,1,0,0)),A.push(new i.aG(1,0,1,1,0)),A.push(new i.aG(1,0,1,0,1)),A.push(new i.aG(1,0,1,1,1)))}else if(A=r.coveringTiles({tileSize:l||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:D,roundZoom:this._source.roundZoom&&!m,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:w}),this._source.hasTile){const Z=this._source.hasTile.bind(this._source);A=A.filter(W=>Z(W))}}else A=[];if(A.length>0&&this.castsShadows&&x&&this.transform.projection.name!=="globe"&&!this.usedForTerrain&&!Df(this._source.type)){const Z=r.coveringZoomLevel({tileSize:l||this._source.tileSize,roundZoom:this._source.roundZoom&&!m}),W=Math.min(Z,this._source.maxzoom);if(w){const te=r.extendTileCover(A,W);for(const ue of te)A.push(ue)}else{const te=r.extendTileCover(A,W,x);for(const ue of te)this._shadowCasterTiles[ue.key]=!0,A.push(ue)}}const U=this._updateRetainedTiles(A);if(Df(this._source.type)&&A.length!==0){const Z={},W={},te=Object.keys(U);for(const se of te){const de=U[se],he=this._tiles[se];if(!he||he.fadeEndTime&&he.fadeEndTime<=i.q.now())continue;const Te=this.findLoadedParent(de,Math.max(de.overscaledZ-cs.maxOverzooming,this._source.minzoom));Te&&(this._addTile(Te.tileID),Z[Te.tileID.key]=Te.tileID),W[se]=de}const ue=A[A.length-1].overscaledZ;for(const se in this._tiles){const de=this._tiles[se];if(U[se]||!de.hasData())continue;let he=de.tileID;for(;he.overscaledZ>ue;){he=he.scaledTo(he.overscaledZ-1);const Te=this._tiles[he.key];if(Te&&Te.hasData()&&W[he.key]){U[se]=de.tileID;break}}}for(const se in Z)U[se]||(this._coveredTiles[se]=!0,U[se]=Z[se])}for(const Z in U)this._tiles[Z].clearFadeHold();const $=i.bk(this._tiles,U);for(const Z of $){const W=this._tiles[Z];W.hasSymbolBuckets&&!W.holdingForFade()?W.setHoldDuration(this.map._fadeDuration):W.hasSymbolBuckets&&!W.symbolFadeFinished()||this._removeTile(+Z)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const r in this._tiles)this._tiles[r].holdingForFade()&&this._removeTile(+r)}_updateRetainedTiles(r){const l={};if(r.length===0)return l;const m={},x=r.reduce((U,$)=>Math.min(U,$.overscaledZ),1/0),w=r[0].overscaledZ,A=Math.max(w-cs.maxOverzooming,this._source.minzoom),D=Math.max(w+cs.maxUnderzooming,this._source.minzoom),N={};for(const U of r){const $=this._addTile(U);l[U.key]=U,$.hasData()||x<this._source.maxzoom&&(N[U.key]=U)}this._retainLoadedChildren(N,x,D,l);for(const U of r){let $=this._tiles[U.key];if($.hasData())continue;if(U.canonical.z>=this._source.maxzoom){const W=U.children(this._source.maxzoom)[0],te=this.getTile(W);if(te&&te.hasData()){l[W.key]=W;continue}}else{const W=U.children(this._source.maxzoom);if(l[W[0].key]&&l[W[1].key]&&l[W[2].key]&&l[W[3].key])continue}let Z=$.wasRequested();for(let W=U.overscaledZ-1;W>=A;--W){const te=U.scaledTo(W);if(m[te.key]||(m[te.key]=!0,$=this.getTile(te),!$&&Z&&($=this._addTile(te)),$&&(l[te.key]=te,Z=$.wasRequested(),$.hasData())))break}}return l}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const r in this._tiles){const l=[];let m,x=this._tiles[r].tileID;for(;x.overscaledZ>0;){if(x.key in this._loadedParentTiles){m=this._loadedParentTiles[x.key];break}l.push(x.key);const w=x.scaledTo(x.overscaledZ-1);if(m=this._getLoadedTile(w),m)break;x=w}for(const w of l)this._loadedParentTiles[w]=m}}_addTile(r){let l=this._tiles[r.key];if(l)return l.isExtraShadowCaster!==!0||this._shadowCasterTiles[r.key]||this._reloadTile(r.key,"reloading"),l;l=this._cache.getAndRemove(r),l&&(this._setTileReloadTimer(r.key,l),l.tileID=r,this._state.initializeTileState(l,this.map?this.map.painter:null),this._cacheTimers[r.key]&&(clearTimeout(this._cacheTimers[r.key]),delete this._cacheTimers[r.key],this._setTileReloadTimer(r.key,l)));const m=!!l;if(!m){const x=this.map?this.map.painter:null,w=this._source.tileSize*r.overscaleFactor();l=this._source.type==="raster-array"?new Pl(r,w,this.transform.tileZoom,x,this._isRaster):new Ol(r,w,this.transform.tileZoom,x,this._isRaster),this._loadTile(l,this._tileLoaded.bind(this,l,r.key,l.state))}return l?(l.uses++,this._tiles[r.key]=l,m||this._source.fire(new i.z("dataloading",{tile:l,coord:l.tileID,dataType:"source"})),l):null}_setTileReloadTimer(r,l){r in this._timers&&(clearTimeout(this._timers[r]),delete this._timers[r]);const m=l.getExpiryTimeout();m&&(this._timers[r]=setTimeout(()=>{this._reloadTile(r,"expired"),delete this._timers[r]},m))}_removeTile(r){const l=this._tiles[r];l&&(l.uses--,delete this._tiles[r],this._timers[r]&&(clearTimeout(this._timers[r]),delete this._timers[r]),l.uses>0||(l.hasData()&&l.state!=="reloading"||l.state==="empty"?this._cache.add(l.tileID,l,l.getExpiryTimeout()):(l.aborted=!0,this._abortTile(l),this._unloadTile(l))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const r in this._tiles)this._removeTile(+r);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(r,l,m){const x=[],w=this.transform;if(!w)return x;const A=w.projection.name==="globe",D=i.at(w.center.lng);for(const N in this._tiles){const U=this._tiles[N];if(m&&U.clearQueryDebugViz(),U.holdingForFade())continue;let $;if(A){const Z=U.tileID.canonical;if(Z.z===0){const W=[Math.abs(i.aw(D,...Mn(Z,-1))-D),Math.abs(i.aw(D,...Mn(Z,1))-D)];$=[0,2*W.indexOf(Math.min(...W))-1]}else{const W=[Math.abs(i.aw(D,...Mn(Z,-1))-D),Math.abs(i.aw(D,...Mn(Z,0))-D),Math.abs(i.aw(D,...Mn(Z,1))-D)];$=[W.indexOf(Math.min(...W))-1]}}else $=[0];for(const Z of $){const W=r.containsTile(U,w,l,Z);W&&x.push(W)}}return x}getShadowCasterCoordinates(){return this._getRenderableCoordinates(!1,!0)}getVisibleCoordinates(r){return this._getRenderableCoordinates(r)}_getRenderableCoordinates(r,l){const m=this.getRenderableIds(r,l).map(w=>this._tiles[w].tileID),x=this.transform.projection.name==="globe";for(const w of m)w.projMatrix=this.transform.calculateProjMatrix(w.toUnwrapped()),w.expandedProjMatrix=x?this.transform.calculateProjMatrix(w.toUnwrapped(),!1,!0):w.projMatrix;return m}sortCoordinatesByDistance(r){const l=r.slice(),m=this.transform._camera.position,x=this.transform._camera.forward(),w={};for(const A of l){const D=1/(1<<A.canonical.z);w[A.key]=((A.canonical.x+.5)*D+A.wrap-m[0])*x[0]+((A.canonical.y+.5)*D-m[1])*x[1]-m[2]*x[2]}return l.sort((A,D)=>w[A.key]-w[D.key]),l}hasTransition(){if(this._source.hasTransition())return!0;if(Df(this._source.type))for(const r in this._tiles){const l=this._tiles[r];if(l.fadeEndTime!==void 0&&l.fadeEndTime>=i.q.now())return!0}return!1}setFeatureState(r,l,m){this._state.updateState(r=r||"_geojsonTileLayer",l,m)}removeFeatureState(r,l,m){this._state.removeFeatureState(r=r||"_geojsonTileLayer",l,m)}getFeatureState(r,l){return this._state.getState(r=r||"_geojsonTileLayer",l)}setDependencies(r,l,m){const x=this._tiles[r];x&&x.setDependencies(l,m)}reloadTilesForDependencies(r,l){for(const m in this._tiles)this._tiles[m].hasDependency(r,l)&&this._reloadTile(+m,"reloading");this._cache.filter(m=>!m.hasDependency(r,l))}_preloadTiles(r,l){if(!this._sourceLoaded){const N=()=>{this._sourceLoaded&&(this._source.off("data",N),this._preloadTiles(r,l))};return void this._source.on("data",N)}const m=new Map,x=Array.isArray(r)?r:[r],w=this.map.painter.terrain,A=this.usedForTerrain&&w?w.getScaledDemTileSize():this._source.tileSize;for(const N of x){const U=N.coveringTiles({tileSize:A,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const $ of U)m.set($.key,$);this.usedForTerrain&&N.updateElevation(!1)}const D=Array.from(m.values());i.bl(D,(N,U)=>{const $=new Ol(N,this._source.tileSize*N.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile($,Z=>{this._source.type==="raster-dem"&&$.dem&&this._backfillDEM($),U(Z,$)})},l)}}function _r(p,r){const l=Math.abs(2*p.wrap)-+(p.wrap<0),m=Math.abs(2*r.wrap)-+(r.wrap<0);return p.overscaledZ-r.overscaledZ||m-l||r.canonical.y-p.canonical.y||r.canonical.x-p.canonical.x}function Df(p){return p==="raster"||p==="image"||p==="video"||p==="custom"}function Mn(p,r){const l=1<<p.z;return[p.x/l+r,(p.x+1)/l+r]}cs.maxOverzooming=10,cs.maxUnderzooming=3;class gu{constructor(r){this.style=r,this.layersGotHidden=!1,this.layers=[]}processLayersChanged(){this.layers=[];const r=!1,l=!1;for(const m in this.style._mergedLayers){const x=this.style._mergedLayers[m];if(x.type==="fill-extrusion")this.layers.push({layer:x,visible:r,visibilityChanged:l});else if(x.type==="model"){const w=this.style.getLayerSource(x);w&&w.type==="batched-model"&&this.layers.push({layer:x,visible:r,visibilityChanged:l})}}}onNewFrame(r){this.layersGotHidden=!1;for(const l of this.layers){const m=l.layer;let x=!1;m.type==="fill-extrusion"?x=!m.isHidden(r)&&m.paint.get("fill-extrusion-opacity")>0:m.type==="model"&&(x=!m.isHidden(r)&&m.paint.get("model-opacity").constantOr(1)>0),this.layersGotHidden=this.layersGotHidden||!x&&l.visible,l.visible=x}}updateZOffset(r,l){this.currentBuildingBuckets=[];for(const x of this.layers){const w=x.layer,A=this.style.getLayerSourceCache(w);let D=1;w.type==="fill-extrusion"&&(D=x.visible?w.paint.get("fill-extrusion-vertical-scale"):0);let N=A?A.getTile(l):null;if(!N&&A&&l.canonical.z>A.getSource().minzoom){let U=l.scaledTo(Math.min(A.getSource().maxzoom,l.overscaledZ-1));for(;U.overscaledZ>=A.getSource().minzoom&&(N=A.getTile(U),!N&&U.overscaledZ!==0);)U=U.scaledTo(U.overscaledZ-1)}this.currentBuildingBuckets.push({bucket:N?N.getBucket(w):null,tileID:N?N.tileID:l,verticalScale:D})}r.hasAnyZOffset=!1;let m=!1;for(let x=0;x<r.symbolInstances.length;x++){const w=r.symbolInstances.get(x),A=w.zOffset,D=this._getHeightAtTileOffset(l,w.tileAnchorX,w.tileAnchorY);w.zOffset=D!==Number.NEGATIVE_INFINITY?D:A,m||A===w.zOffset||(m=!0),r.hasAnyZOffset||w.zOffset===0||(r.hasAnyZOffset=!0)}m&&(r.zOffsetBuffersNeedUpload=!0,r.zOffsetSortDirty=!0)}_mapCoordToOverlappingTile(r,l,m,x){let w=l,A=m;if(r.canonical.z!==x.canonical.z){const D=x.canonical,N=1/(1<<r.canonical.z-D.z);w=(l+r.canonical.x*i.ag)*N-D.x*i.ag|0,A=(m+r.canonical.y*i.ag)*N-D.y*i.ag|0}return{tileX:w,tileY:A}}_getHeightAtTileOffset(r,l,m){let x,w;for(let A=0;A<this.layers.length;++A){if(this.layers[A].layer.type!=="fill-extrusion")continue;const{bucket:D,tileID:N,verticalScale:U}=this.currentBuildingBuckets[A];if(!D)continue;const{tileX:$,tileY:Z}=this._mapCoordToOverlappingTile(r,l,m,N),W=D.getHeightAtTileCoord($,Z);W&&W.height!==void 0&&(W.hidden?x=W.height:w=Math.max(W.height*U,w||0))}if(w!==void 0)return w;for(let A=0;A<this.layers.length;++A){const D=this.layers[A];if(D.layer.type!=="model"||!D.visible)continue;const{bucket:N,tileID:U}=this.currentBuildingBuckets[A];if(!N)continue;const{tileX:$,tileY:Z}=this._mapCoordToOverlappingTile(r,l,m,U),W=N.getHeightAtTileCoord($,Z);if(W&&!W.hidden)return W.height===void 0&&x!==void 0?Math.min(W.maxHeight,x)*W.verticalScale:W.height?W.height*W.verticalScale:Number.NEGATIVE_INFINITY}return this.layersGotHidden?0:Number.NEGATIVE_INFINITY}}function Il(p,r){const l={};for(const m in p)m!=="ref"&&(l[m]=p[m]);return i.bm.forEach(m=>{m in r&&(l[m]=r[m])}),l}function Lf(p){p=p.slice();const r=Object.create(null);for(let l=0;l<p.length;l++)r[p[l].id]=p[l];for(let l=0;l<p.length;l++)"ref"in p[l]&&(p[l]=Il(p[l],r[p[l].ref]));return p}const Kn={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setSlot:"setSlot",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setSnow:"setSnow",setRain:"setRain",setCamera:"setCamera",setLights:"setLights",setProjection:"setProjection",addImport:"addImport",removeImport:"removeImport",updateImport:"updateImport"};function kf(p,r,l){l.push({command:Kn.addSource,args:[p,r[p]]})}function zs(p,r,l){r.push({command:Kn.removeSource,args:[p]}),l[p]=!0}function _n(p,r,l,m){zs(p,l,m),kf(p,r,l)}function xr(p,r,l){let m;for(m in p[l])if(p[l].hasOwnProperty(m)&&m!=="data"&&!i.bn(p[l][m],r[l][m]))return!1;for(m in r[l])if(r[l].hasOwnProperty(m)&&m!=="data"&&!i.bn(p[l][m],r[l][m]))return!1;return!0}function ar(p,r,l,m,x,w){let A;for(A in r=r||{},p=p||{})p.hasOwnProperty(A)&&(i.bn(p[A],r[A])||l.push({command:w,args:[m,A,r[A],x]}));for(A in r)r.hasOwnProperty(A)&&!p.hasOwnProperty(A)&&(i.bn(p[A],r[A])||l.push({command:w,args:[m,A,r[A],x]}))}function _a(p){return p.id}function us(p,r){return p[r.id]=r,p}class gr{constructor(r,l){this.reset(r,l)}reset(r,l){this.points=r||[],this._distances=[0];for(let m=1;m<this.points.length;m++)this._distances[m]=this._distances[m-1]+this.points[m].dist(this.points[m-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(l||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(r){if(this.points.length===1)return this.points[0];r=i.aw(r,0,1);let l=1,m=this._distances[l];const x=r*this.paddedLength+this.padding;for(;m<x&&l<this._distances.length;)m=this._distances[++l];const w=l-1,A=this._distances[w],D=m-A,N=D>0?(x-A)/D:0;return this.points[w].mult(1-N).add(this.points[l].mult(N))}}class dc{constructor(r,l,m){const x=this.boxCells=[],w=this.circleCells=[];this.xCellCount=Math.ceil(r/m),this.yCellCount=Math.ceil(l/m);for(let A=0;A<this.xCellCount*this.yCellCount;A++)x.push([]),w.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=r,this.height=l,this.xScale=this.xCellCount/r,this.yScale=this.yCellCount/l,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(r,l,m,x,w){this._forEachCell(l,m,x,w,this._insertBoxCell,this.boxUid++),this.boxKeys.push(r),this.bboxes.push(l),this.bboxes.push(m),this.bboxes.push(x),this.bboxes.push(w)}insertCircle(r,l,m,x){this._forEachCell(l-x,m-x,l+x,m+x,this._insertCircleCell,this.circleUid++),this.circleKeys.push(r),this.circles.push(l),this.circles.push(m),this.circles.push(x)}_insertBoxCell(r,l,m,x,w,A){this.boxCells[w].push(A)}_insertCircleCell(r,l,m,x,w,A){this.circleCells[w].push(A)}_query(r,l,m,x,w,A){if(m<0||r>this.width||x<0||l>this.height)return!w&&[];const D=[];if(r<=0&&l<=0&&this.width<=m&&this.height<=x){if(w)return!0;for(let N=0;N<this.boxKeys.length;N++)D.push({key:this.boxKeys[N],x1:this.bboxes[4*N],y1:this.bboxes[4*N+1],x2:this.bboxes[4*N+2],y2:this.bboxes[4*N+3]});for(let N=0;N<this.circleKeys.length;N++){const U=this.circles[3*N],$=this.circles[3*N+1],Z=this.circles[3*N+2];D.push({key:this.circleKeys[N],x1:U-Z,y1:$-Z,x2:U+Z,y2:$+Z})}return A?D.filter(A):D}return this._forEachCell(r,l,m,x,this._queryCell,D,{hitTest:w,seenUids:{box:{},circle:{}}},A),w?D.length>0:D}_queryCircle(r,l,m,x,w){const A=r-m,D=r+m,N=l-m,U=l+m;if(D<0||A>this.width||U<0||N>this.height)return!x&&[];const $=[];return this._forEachCell(A,N,D,U,this._queryCellCircle,$,{hitTest:x,circle:{x:r,y:l,radius:m},seenUids:{box:{},circle:{}}},w),x?$.length>0:$}query(r,l,m,x,w){return this._query(r,l,m,x,!1,w)}hitTest(r,l,m,x,w){return this._query(r,l,m,x,!0,w)}hitTestCircle(r,l,m,x){return this._queryCircle(r,l,m,!0,x)}_queryCell(r,l,m,x,w,A,D,N){const U=D.seenUids,$=this.boxCells[w];if($!==null){const W=this.bboxes;for(const te of $)if(!U.box[te]){U.box[te]=!0;const ue=4*te;if(r<=W[ue+2]&&l<=W[ue+3]&&m>=W[ue+0]&&x>=W[ue+1]&&(!N||N(this.boxKeys[te]))){if(D.hitTest)return A.push(!0),!0;A.push({key:this.boxKeys[te],x1:W[ue],y1:W[ue+1],x2:W[ue+2],y2:W[ue+3]})}}}const Z=this.circleCells[w];if(Z!==null){const W=this.circles;for(const te of Z)if(!U.circle[te]){U.circle[te]=!0;const ue=3*te;if(this._circleAndRectCollide(W[ue],W[ue+1],W[ue+2],r,l,m,x)&&(!N||N(this.circleKeys[te]))){if(D.hitTest)return A.push(!0),!0;{const se=W[ue],de=W[ue+1],he=W[ue+2];A.push({key:this.circleKeys[te],x1:se-he,y1:de-he,x2:se+he,y2:de+he})}}}}}_queryCellCircle(r,l,m,x,w,A,D,N){const U=D.circle,$=D.seenUids,Z=this.boxCells[w];if(Z!==null){const te=this.bboxes;for(const ue of Z)if(!$.box[ue]){$.box[ue]=!0;const se=4*ue;if(this._circleAndRectCollide(U.x,U.y,U.radius,te[se+0],te[se+1],te[se+2],te[se+3])&&(!N||N(this.boxKeys[ue])))return A.push(!0),!0}}const W=this.circleCells[w];if(W!==null){const te=this.circles;for(const ue of W)if(!$.circle[ue]){$.circle[ue]=!0;const se=3*ue;if(this._circlesCollide(te[se],te[se+1],te[se+2],U.x,U.y,U.radius)&&(!N||N(this.circleKeys[ue])))return A.push(!0),!0}}}_forEachCell(r,l,m,x,w,A,D,N){const U=this._convertToXCellCoord(r),$=this._convertToYCellCoord(l),Z=this._convertToXCellCoord(m),W=this._convertToYCellCoord(x);for(let te=U;te<=Z;te++)for(let ue=$;ue<=W;ue++)if(w.call(this,r,l,m,x,this.xCellCount*ue+te,A,D,N))return}_convertToXCellCoord(r){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(r*this.xScale)))}_convertToYCellCoord(r){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(r*this.yScale)))}_circlesCollide(r,l,m,x,w,A){const D=x-r,N=w-l,U=m+A;return U*U>D*D+N*N}_circleAndRectCollide(r,l,m,x,w,A,D){const N=(A-x)/2,U=Math.abs(r-(x+N));if(U>N+m)return!1;const $=(D-w)/2,Z=Math.abs(l-(w+$));if(Z>$+m)return!1;if(U<=N||Z<=$)return!0;const W=U-N,te=Z-$;return W*W+te*te<=m*m}}const Vo={unknown:0,flipRequired:1,flipNotRequired:2},_h=Math.tan(85*Math.PI/180);function Wr(p,r,l,m,x,w,A){const D=i.ab.mat4.create();if(l)if(w.name==="globe"){const N=i.bo(x,r);i.ab.mat4.multiply(D,D,N)}else{const N=i.ab.mat2.invert([],A);D[0]=N[0],D[1]=N[1],D[4]=N[2],D[5]=N[3],m||i.ab.mat4.rotateZ(D,D,x.angle)}else i.ab.mat4.multiply(D,x.labelPlaneMatrix,p);return D}function Xr(p,r,l,m,x,w,A){const D=Wr(p,r,l,m,x,w,A);return w.name==="globe"&&l||(D[2]=D[6]=D[10]=D[14]=0),D}function gh(p,r,l,m,x,w,A){if(l){if(w.name==="globe"){const D=Wr(p,r,l,m,x,w,A);return i.ab.mat4.invert(D,D),i.ab.mat4.multiply(D,p,D),D}{const D=i.ab.mat4.clone(p),N=i.ab.mat4.identity([]);return N[0]=A[0],N[1]=A[1],N[4]=A[2],N[5]=A[3],i.ab.mat4.multiply(D,D,N),m||i.ab.mat4.rotateZ(D,D,-x.angle),D}}return x.glCoordMatrix}function ga(p,r,l,m){const x=[p,r,l,1];l?i.ab.vec4.transformMat4(x,x,m):hs(x,x,m);const w=x[3];return x[0]/=w,x[1]/=w,x[2]/=w,x}function sp(p,r){return Math.min(.5+p/r*.5,1.5)}function yu(p,r){const l=p[0]/p[3],m=p[1]/p[3];return l>=-r[0]&&l<=r[0]&&m>=-r[1]&&m<=r[1]}function yh(p,r,l,m,x,w,A,D,N,U){const $=l.transform,Z=m?p.textSizeData:p.iconSizeData,W=i.bp(Z,l.transform.zoom),te=$.projection.name==="globe",ue=[256/l.width*2+1,256/l.height*2+1],se=m?p.text.dynamicLayoutVertexArray:p.icon.dynamicLayoutVertexArray;se.clear();let de=null;te&&(de=m?p.text.globeExtVertexArray:p.icon.globeExtVertexArray);const he=p.lineVertexArray,Te=m?p.text.placedSymbolArray:p.icon.placedSymbolArray,Pe=l.transform.width/l.transform.height;let Me,Fe=!1;for(let Re=0;Re<Te.length;Re++){const ze=Te.get(Re),{numGlyphs:De,writingMode:$e}=ze;if($e!==i.bq.vertical||Fe||Me===i.bq.horizontal||(Fe=!0),Me=$e,(ze.hidden||$e===i.bq.vertical)&&!Fe){ai(De,se);continue}Fe=!1;const Xe=new i.P(ze.tileAnchorX,ze.tileAnchorY);let{x:ht,y:ot,z:Et}=$.projection.projectTilePoint(Xe.x,Xe.y,U.canonical);if(N){const[At,zt,Wt]=N(Xe);ht+=At,ot+=zt,Et+=Wt}const yt=[ht,ot,Et,1];if(i.ab.vec4.transformMat4(yt,yt,r),!yu(yt,ue)){ai(De,se);continue}const nt=yt[3],pt=sp(l.transform.getCameraToCenterDistance($.projection),nt),Lt=i.br(Z,W,ze),tt=A?Lt/pt:Lt*pt,St=ga(ht,ot,Et,x);if(St[3]<=0){ai(De,se);continue}let mt={};const Gt=A?null:N,It=Bs(ze,tt,!1,D,r,x,w,p.glyphOffsetArray,he,se,de,St,Xe,mt,Pe,Gt,$.projection,U,A);Fe=It.useVertical,Gt&&It.needsFlipping&&(mt={}),(It.notEnoughRoom||Fe||It.needsFlipping&&Bs(ze,tt,!0,D,r,x,w,p.glyphOffsetArray,he,se,de,St,Xe,mt,Pe,Gt,$.projection,U,A).notEnoughRoom)&&ai(De,se)}m?(p.text.dynamicLayoutVertexBuffer.updateData(se),de&&p.text.globeExtVertexBuffer&&p.text.globeExtVertexBuffer.updateData(de)):(p.icon.dynamicLayoutVertexBuffer.updateData(se),de&&p.icon.globeExtVertexBuffer&&p.icon.globeExtVertexBuffer.updateData(de))}function Rl(p,r,l,m,x,w,A,D,N,U,$,Z,W,te,ue,se){const{lineStartIndex:de,glyphStartIndex:he,segment:Te}=D,Pe=he+D.numGlyphs,Me=de+D.lineLength,Fe=r.getoffsetX(he),Re=r.getoffsetX(Pe-1),ze=Dl(p*Fe,l,m,x,w,A,Te,de,Me,N,U,$,Z,W,!0,te,ue,se);if(!ze)return null;const De=Dl(p*Re,l,m,x,w,A,Te,de,Me,N,U,$,Z,W,!0,te,ue,se);return De?{first:ze,last:De}:null}function ia(p,r,l,m){return p===i.bq.horizontal&&Math.abs(m)>Math.abs(l)?{useVertical:!0}:p===i.bq.vertical?m>0?{needsFlipping:!0}:null:r!==Vo.unknown&&function(x,w){return x===0||Math.abs(w/x)>_h}(l,m)?r===Vo.flipRequired?{needsFlipping:!0}:null:l<0?{needsFlipping:!0}:null}function Bs(p,r,l,m,x,w,A,D,N,U,$,Z,W,te,ue,se,de,he,Te){const Pe=r/24,Me=p.lineOffsetX*Pe,Fe=p.lineOffsetY*Pe,{lineStartIndex:Re,glyphStartIndex:ze,numGlyphs:De,segment:$e,writingMode:Xe,flipState:ht}=p,ot=Re+p.lineLength,Et=yt=>{if($){const[tt,St,mt]=yt.up,Gt=U.length;i.bs($,Gt+0,tt,St,mt),i.bs($,Gt+1,tt,St,mt),i.bs($,Gt+2,tt,St,mt),i.bs($,Gt+3,tt,St,mt)}const[nt,pt,Lt]=yt.point;i.bt(U,nt,pt,Lt,yt.angle)};if(De>1){const yt=Rl(Pe,D,Me,Fe,l,Z,W,p,N,w,te,se,!1,de,he,Te);if(!yt)return{notEnoughRoom:!0};if(m&&!l){let[nt,pt,Lt]=yt.first.point,[tt,St,mt]=yt.last.point;[nt,pt]=ga(nt,pt,Lt,A),[tt,St]=ga(tt,St,mt,A);const Gt=ia(Xe,ht,(tt-nt)*ue,St-pt);if(p.flipState=Gt&&Gt.needsFlipping?Vo.flipRequired:Vo.flipNotRequired,Gt)return Gt}Et(yt.first);for(let nt=ze+1;nt<ze+De-1;nt++){const pt=Dl(Pe*D.getoffsetX(nt),Me,Fe,l,Z,W,$e,Re,ot,N,w,te,se,!1,!1,de,he,Te);if(!pt)return U.length-=4*(nt-ze),{notEnoughRoom:!0};Et(pt)}Et(yt.last)}else{if(m&&!l){const nt=ga(W.x,W.y,0,x),pt=Re+$e+1,Lt=new i.P(N.getx(pt),N.gety(pt)),tt=ga(Lt.x,Lt.y,0,x),St=tt[3]>0?tt:Am(W,Lt,nt,1,x,void 0,de,he.canonical),mt=ia(Xe,ht,(St[0]-nt[0])*ue,St[1]-nt[1]);if(p.flipState=mt&&mt.needsFlipping?Vo.flipRequired:Vo.flipNotRequired,mt)return mt}const yt=Dl(Pe*D.getoffsetX(ze),Me,Fe,l,Z,W,$e,Re,ot,N,w,te,se,!1,!1,de,he,Te);if(!yt)return{notEnoughRoom:!0};Et(yt)}return{}}function Da(p,r,l,m,x){const{x:w,y:A,z:D}=m.projectTilePoint(p.x,p.y,r);if(!x)return ga(w,A,D,l);const[N,U,$]=x(p);return ga(w+N,A+U,D+$,l)}function Am(p,r,l,m,x,w,A,D){const N=Da(p.sub(r)._unit()._add(p),D,x,A,w);return i.ab.vec3.sub(N,l,N),i.ab.vec3.normalize(N,N),i.ab.vec3.scaleAndAdd(N,l,N,m)}function Dl(p,r,l,m,x,w,A,D,N,U,$,Z,W,te,ue,se,de,he){const Te=m?p-r:p+r;let Pe=Te>0?1:-1,Me=0;m&&(Pe*=-1,Me=Math.PI),Pe<0&&(Me+=Math.PI);let Fe=D+A+(Pe>0?0:1)|0,Re=x,ze=x,De=0,$e=0;const Xe=Math.abs(Te),ht=[],ot=[];let Et=w,yt=Et;const nt=()=>Am(yt,Et,ze,Xe-De+1,$,W,se,de.canonical);for(;De+$e<=Xe;){if(Fe+=Pe,Fe<D||Fe>=N)return null;if(ze=Re,yt=Et,ht.push(ze),te&&ot.push(yt),Et=new i.P(U.getx(Fe),U.gety(Fe)),Re=Z[Fe],!Re){const zt=Da(Et,de.canonical,$,se,W);Re=zt[3]>0?Z[Fe]=zt:nt()}De+=$e,$e=i.ab.vec3.distance(ze,Re)}ue&&W&&(Z[Fe]&&(Re=nt(),$e=i.ab.vec3.distance(ze,Re)),Z[Fe]=Re);const pt=(Xe-De)/$e,Lt=Et.sub(yt)._mult(pt)._add(yt),tt=i.ab.vec3.sub([],Re,ze),St=i.ab.vec3.scaleAndAdd([],ze,tt,pt);let mt=[0,0,1],Gt=tt[0],It=tt[1];if(he&&(mt=se.upVector(de.canonical,Lt.x,Lt.y),mt[0]!==0||mt[1]!==0||mt[2]!==1)){const zt=[mt[2],0,-mt[0]],Wt=i.ab.vec3.cross([],mt,zt);i.ab.vec3.normalize(zt,zt),i.ab.vec3.normalize(Wt,Wt),Gt=i.ab.vec3.dot(tt,zt),It=i.ab.vec3.dot(tt,Wt)}if(l){const zt=i.ab.vec3.cross([],mt,tt);i.ab.vec3.normalize(zt,zt),i.ab.vec3.scaleAndAdd(St,St,zt,l*Pe)}const At=Me+Math.atan2(It,Gt);return ht.push(St),te&&ot.push(Lt),{point:St,angle:At,path:ht,tilePath:ot,up:mt}}function ai(p,r){const l=r.length,m=l+4*p;r.resize(m),r.float32.fill(-1/0,4*l,4*m)}function hs(p,r,l){const m=r[0],x=r[1];return p[0]=l[0]*m+l[4]*x+l[12],p[1]=l[1]*m+l[5]*x+l[13],p[3]=l[3]*m+l[7]*x+l[15],p}const ya=100;class Ii{constructor(r,l,m=new dc(r.width+200,r.height+200,25),x=new dc(r.width+200,r.height+200,25)){this.transform=r,this.grid=m,this.ignoredGrid=x,this.pitchfactor=Math.cos(r._pitch)*r.cameraToCenterDistance,this.screenRightBoundary=r.width+ya,this.screenBottomBoundary=r.height+ya,this.gridRightBoundary=r.width+200,this.gridBottomBoundary=r.height+200,this.fogState=l}placeCollisionBox(r,l,m,x,w,A,D,N){let U=m.projectedAnchorX,$=m.projectedAnchorY,Z=m.projectedAnchorZ;const W=m.elevation,te=m.tileID,ue=r.getProjection();if(W&&te){const[Re,ze,De]=ue.upVector(te.canonical,m.tileAnchorX,m.tileAnchorY),$e=ue.upVectorScale(te.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;U+=Re*W*$e,$+=ze*W*$e,Z+=De*W*$e}const se=this.projectAndGetPerspectiveRatio(D,U,$,Z,m.tileID,ue.name==="globe"||!!W||this.transform.pitch>0,ue),de=A*se.perspectiveRatio,he=(m.x1*l+x.x-m.padding)*de+se.point.x,Te=(m.y1*l+x.y-m.padding)*de+se.point.y,Pe=(m.x2*l+x.x+m.padding)*de+se.point.x,Me=(m.y2*l+x.y+m.padding)*de+se.point.y,Fe=se.perspectiveRatio<=.55||se.occluded;return!this.isInsideGrid(he,Te,Pe,Me)||!w&&this.grid.hitTest(he,Te,Pe,Me,N)||Fe?{box:[],offscreen:!1,occluded:se.occluded}:{box:[he,Te,Pe,Me],offscreen:this.isOffscreen(he,Te,Pe,Me),occluded:!1}}placeCollisionCircles(r,l,m,x,w,A,D,N,U,$,Z,W,te,ue,se){const de=[],he=this.transform.elevation,Te=r.getProjection(),Pe=he?he.getAtTileOffsetFunc(se,this.transform.center.lat,this.transform.worldSize,Te):null,Me=new i.P(m.tileAnchorX,m.tileAnchorY);let{x:Fe,y:Re,z:ze}=Te.projectTilePoint(Me.x,Me.y,se.canonical);if(Pe){const[Lt,tt,St]=Pe(Me);Fe+=Lt,Re+=tt,ze+=St}const De=Te.name==="globe",$e=this.projectAndGetPerspectiveRatio(D,Fe,Re,ze,se,De||!!he||this.transform.pitch>0,Te),{perspectiveRatio:Xe}=$e,ht=(Z?A/Xe:A*Xe)/i.bw,ot=ga(Fe,Re,ze,N),Et=$e.signedDistanceFromCamera>0?Rl(ht,w,m.lineOffsetX*ht,m.lineOffsetY*ht,!1,ot,Me,m,x,N,{},he&&!Z?Pe:null,Z&&!!he,Te,se,Z):null;let yt=!1,nt=!1,pt=!0;if(Et&&!$e.occluded){const Lt=.5*te*Xe+ue,tt=new i.P(-100,-100),St=new i.P(this.screenRightBoundary,this.screenBottomBoundary),mt=new gr,{first:Gt,last:It}=Et,At=Gt.path.length;let zt=[];for(let dn=At-1;dn>=1;dn--)zt.push(Gt.path[dn]);for(let dn=1;dn<It.path.length;dn++)zt.push(It.path[dn]);const Wt=2.5*Lt;U&&(zt=zt.map(([dn,En,Sn],bn)=>(Pe&&!De&&(Sn=Pe(bn<At-1?Gt.tilePath[At-1-bn]:It.tilePath[bn-At+2])[2]),ga(dn,En,Sn,U))),zt.some(dn=>dn[3]<=0)&&(zt=[]));let on=[];if(zt.length>0){let dn=1/0,En=-1/0,Sn=1/0,bn=-1/0;for(const Ln of zt)dn=Math.min(dn,Ln[0]),Sn=Math.min(Sn,Ln[1]),En=Math.max(En,Ln[0]),bn=Math.max(bn,Ln[1]);En>=tt.x&&dn<=St.x&&bn>=tt.y&&Sn<=St.y&&(on=[zt.map(Ln=>new i.P(Ln[0],Ln[1]))],(dn<tt.x||En>St.x||Sn<tt.y||bn>St.y)&&(on=i.bu(on,tt.x,tt.y,St.x,St.y)))}for(const dn of on){mt.reset(dn,.25*Lt);let En=0;En=mt.length<=.5*Lt?1:Math.ceil(mt.paddedLength/Wt)+1;for(let Sn=0;Sn<En;Sn++){const bn=Sn/Math.max(En-1,1),Ln=mt.lerp(bn),kn=Ln.x+ya,Mr=Ln.y+ya;de.push(kn,Mr,Lt,0);const ui=kn-Lt,qr=Mr-Lt,Fn=kn+Lt,mr=Mr+Lt;if(pt=pt&&this.isOffscreen(ui,qr,Fn,mr),nt=nt||this.isInsideGrid(ui,qr,Fn,mr),!l&&this.grid.hitTestCircle(kn,Mr,Lt,W)&&(yt=!0,!$))return{circles:[],offscreen:!1,collisionDetected:yt,occluded:!1}}}}return{circles:!$&&yt||!nt?[]:de,offscreen:pt,collisionDetected:yt,occluded:$e.occluded}}queryRenderedSymbols(r){if(r.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const l=[];let m=1/0,x=1/0,w=-1/0,A=-1/0;for(const $ of r){const Z=new i.P($.x+ya,$.y+ya);m=Math.min(m,Z.x),x=Math.min(x,Z.y),w=Math.max(w,Z.x),A=Math.max(A,Z.y),l.push(Z)}const D=this.grid.query(m,x,w,A).concat(this.ignoredGrid.query(m,x,w,A)),N={},U={};for(const $ of D){const Z=$.key;if(N[Z.bucketInstanceId]===void 0&&(N[Z.bucketInstanceId]={}),N[Z.bucketInstanceId][Z.featureIndex])continue;const W=[new i.P($.x1,$.y1),new i.P($.x2,$.y1),new i.P($.x2,$.y2),new i.P($.x1,$.y2)];i.bv(l,W)&&(N[Z.bucketInstanceId][Z.featureIndex]=!0,U[Z.bucketInstanceId]===void 0&&(U[Z.bucketInstanceId]=[]),U[Z.bucketInstanceId].push(Z.featureIndex))}return U}insertCollisionBox(r,l,m,x,w){(l?this.ignoredGrid:this.grid).insert({bucketInstanceId:m,featureIndex:x,collisionGroupID:w},r[0],r[1],r[2],r[3])}insertCollisionCircles(r,l,m,x,w){const A=l?this.ignoredGrid:this.grid,D={bucketInstanceId:m,featureIndex:x,collisionGroupID:w};for(let N=0;N<r.length;N+=4)A.insertCircle(D,r[N],r[N+1],r[N+2])}projectAndGetPerspectiveRatio(r,l,m,x,w,A,D){const N=[l,m,x,1];let U=!1;x||this.transform.pitch>0?(i.ab.vec4.transformMat4(N,N,r),this.fogState&&w&&D.name!=="globe"&&(U=function(W,te,ue,se,de,he){const Te=he.calculateFogTileMatrix(de),Pe=[te,ue,se];return i.ab.vec3.transformMat4(Pe,Pe,Te),We(W,i.ab.vec3.length(Pe),he.pitch,he._fov)}(this.fogState,l,m,x,w.toUnwrapped(),this.transform)>.9)):hs(N,N,r);const $=N[3];return{point:new i.P((N[0]/$+1)/2*this.transform.width+ya,(-N[1]/$+1)/2*this.transform.height+ya),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(D)/$*.5,1.5),signedDistanceFromCamera:$,occluded:A&&N[2]>$||U}}isOffscreen(r,l,m,x){return m<ya||r>=this.screenRightBoundary||x<ya||l>this.screenBottomBoundary}isInsideGrid(r,l,m,x){return m>=0&&r<this.gridRightBoundary&&x>=0&&l<this.gridBottomBoundary}getViewportMatrix(){const r=i.ab.mat4.identity([]);return i.ab.mat4.translate(r,r,[-100,-100,0]),r}}function zf(p,r,l){const m=r.createTileMatrix(p,p.worldSize,l.toUnwrapped());return i.ab.mat4.multiply(new Float32Array(16),p.projMatrix,m)}function Ns(p,r,l){if(r.projection.name===l.projection.name)return p.projMatrix;const m=l.clone();return m.setProjection(r.projection),zf(m,r.getProjection(),p)}function pc(p,r,l){return r.name===l.projection.name?p.projMatrix:zf(l,r,p)}class Bf{constructor(r,l,m,x){this.opacity=r?Math.max(0,Math.min(1,r.opacity+(r.placed?l:-l))):x&&m?1:0,this.placed=m}isHidden(){return this.opacity===0&&!this.placed}}class Fs{constructor(r,l,m,x,w,A=!1){this.text=new Bf(r?r.text:null,l,m,w),this.icon=new Bf(r?r.icon:null,l,x,w),this.clipped=A}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Cm{constructor(r,l,m,x=!1){this.text=r,this.icon=l,this.skipFade=m,this.clipped=x}}class Ll{constructor(){this.invProjMatrix=i.ab.mat4.create(),this.viewportMatrix=i.ab.mat4.create(),this.circles=[]}}class Mm{constructor(r,l,m,x,w){this.bucketInstanceId=r,this.featureIndex=l,this.sourceLayerIndex=m,this.bucketIndex=x,this.tileID=w}}class Om{constructor(r){this.crossSourceCollisions=r,this.maxGroupID=0,this.collisionGroups={}}get(r){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[r]){const l=++this.maxGroupID;this.collisionGroups[r]={ID:l,predicate:m=>m.collisionGroupID===l}}return this.collisionGroups[r]}}function ho(p,r,l,m,x){const{horizontalAlign:w,verticalAlign:A}=i.bD(p),D=-(w-.5)*r,N=-(A-.5)*l,U=i.bC(p,m);return new i.P(D+U[0]*x,N+U[1]*x)}function Pm(p,r,l,m,x){const w=new i.P(p,r);return l&&w._rotate(m?x:-x),w}class Nf{constructor(r,l,m,x,w,A){this.transform=r.clone(),this.projection=r.projection.name,this.collisionIndex=new Ii(this.transform,w),this.buildingIndex=A,this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=l,this.retainedQueryData={},this.collisionGroups=new Om(m),this.collisionCircleArrays={},this.prevPlacement=x,x&&(x.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(r,l,m,x,w=1){const A=m.getBucket(l),D=m.latestFeatureIndex;if(!A||!D||l.fqid!==A.layerIds[0])return;const N=A.layers[0].layout,U=A.layers[0].paint,$=m.collisionBoxArray,Z=Math.pow(2,this.transform.zoom-m.tileID.overscaledZ),W=m.tileSize/i.ag,te=m.tileID.toUnwrapped();this.transform.setProjection(A.projection);const ue=(se=m.tileID,de=A.getProjection(),he=this.transform,de.name===this.projection?he.calculateProjMatrix(se.toUnwrapped()):zf(he,de,se));var se,de,he;const Te=N.get("text-pitch-alignment")==="map",Pe=N.get("text-rotation-alignment")==="map";l.compileFilter(l.options);const Me=l.dynamicFilter(),Fe=l.dynamicFilterNeedsFeature(),Re=this.transform.calculatePixelsToTileUnitsMatrix(m),ze=Xr(ue,m.tileID.canonical,Te,Pe,this.transform,A.getProjection(),Re);let De=null;if(Te){const Lt=gh(ue,m.tileID.canonical,Te,Pe,this.transform,A.getProjection(),Re);De=i.ab.mat4.multiply([],this.transform.labelPlaneMatrix,Lt)}let $e=null;Me&&m.latestFeatureIndex&&($e={unwrappedTileID:te,dynamicFilter:Me,dynamicFilterNeedsFeature:Fe}),this.retainedQueryData[A.bucketInstanceId]=new Mm(A.bucketInstanceId,D,A.sourceLayerIndex,A.index,m.tileID);const[Xe,ht]=A.layers[0].layout.get("text-size-scale-range"),ot=i.aw(w,Xe,ht),[Et,yt]=N.get("icon-size-scale-range"),nt=i.aw(w,Et,yt),pt={bucket:A,layout:N,paint:U,posMatrix:ue,textLabelPlaneMatrix:ze,labelToScreenMatrix:De,clippingData:$e,scale:Z,textPixelRatio:W,holdingForFade:m.holdingForFade(),collisionBoxArray:$,partiallyEvaluatedTextSize:i.bp(A.textSizeData,this.transform.zoom,ot),partiallyEvaluatedIconSize:i.bp(A.iconSizeData,this.transform.zoom,nt),collisionGroup:this.collisionGroups.get(A.sourceID),latestFeatureIndex:m.latestFeatureIndex};if(x)for(const Lt of A.sortKeyRanges){const{sortKey:tt,symbolInstanceStart:St,symbolInstanceEnd:mt}=Lt;r.push({sortKey:tt,symbolInstanceStart:St,symbolInstanceEnd:mt,parameters:pt})}else r.push({symbolInstanceStart:0,symbolInstanceEnd:A.symbolInstances.length,parameters:pt})}attemptAnchorPlacement(r,l,m,x,w,A,D,N,U,$,Z,W,te,ue,se,de,he,Te){const{textOffset0:Pe,textOffset1:Me,crossTileID:Fe}=W,Re=[Pe,Me],ze=ho(r,m,x,Re,w),De=this.collisionIndex.placeCollisionBox(ue,w,l,Pm(ze.x,ze.y,A,D,this.transform.angle),Z,N,U,$.predicate);if(de){const $e=ue.getSymbolInstanceIconSize(Te,this.transform.zoom,W.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(ue,$e,de,Pm(ze.x,ze.y,A,D,this.transform.angle),Z,N,U,$.predicate).box.length===0)return}if(De.box.length>0){let $e;return this.prevPlacement&&this.prevPlacement.variableOffsets[Fe]&&this.prevPlacement.placements[Fe]&&this.prevPlacement.placements[Fe].text&&($e=this.prevPlacement.variableOffsets[Fe].anchor),this.variableOffsets[Fe]={textOffset:Re,width:m,height:x,anchor:r,textScale:w,prevAnchor:$e},this.markUsedJustification(ue,r,W,se),ue.allowVerticalPlacement&&(this.markUsedOrientation(ue,se,W),this.placedOrientations[Fe]=se),{shift:ze,placedGlyphBoxes:De}}}placeLayerBucketPart(r,l,m,x,w=1){const{bucket:A,layout:D,paint:N,posMatrix:U,textLabelPlaneMatrix:$,labelToScreenMatrix:Z,clippingData:W,textPixelRatio:te,holdingForFade:ue,collisionBoxArray:se,partiallyEvaluatedTextSize:de,partiallyEvaluatedIconSize:he,collisionGroup:Te,latestFeatureIndex:Pe}=r.parameters,Me=D.get("text-optional"),Fe=D.get("icon-optional"),Re=D.get("text-allow-overlap"),ze=D.get("icon-allow-overlap"),De=D.get("text-rotation-alignment")==="map",$e=D.get("text-pitch-alignment")==="map",Xe=D.get("symbol-z-elevate"),ht=N.get("symbol-z-offset"),ot=D.get("symbol-elevation-reference")==="sea",[Et,yt]=D.get("text-size-scale-range"),[nt,pt]=D.get("icon-size-scale-range"),Lt=i.aw(w,Et,yt),tt=i.aw(w,nt,pt);this.transform.setProjection(A.projection);let St=Re&&(ze||!A.hasIconData()||Fe),mt=ze&&(Re||!A.hasTextData()||Me);const Gt=!ht.isConstant();!A.collisionArrays&&se&&A.deserializeCollisionBoxes(se),m&&x&&A.updateCollisionDebugBuffers(this.transform.zoom,se,Lt,tt);const It=(At,zt,Wt)=>{const{crossTileID:on,numVerticalGlyphVertices:dn}=At;let En=null;if(W&&W.dynamicFilterNeedsFeature||Gt){const Er=this.retainedQueryData[A.bucketInstanceId];En=Pe.loadFeature({featureIndex:At.featureIndex,bucketIndex:Er.bucketIndex,sourceLayerIndex:Er.sourceLayerIndex,layoutVertexArrayOffset:0})}if(W&&!(0,W.dynamicFilter)({zoom:this.transform.zoom,pitch:this.transform.pitch},En,this.retainedQueryData[A.bucketInstanceId].tileID.canonical,new i.P(At.tileAnchorX,At.tileAnchorY),this.transform.calculateDistanceTileData(W.unwrappedTileID)))return this.placements[on]=new Cm(!1,!1,!1,!0),void l.add(on);const Sn=ht.evaluate(En,{});if(l.has(on))return;if(ue)return void(this.placements[on]=new Cm(!1,!1,!1));let bn=!1,Ln=!1,kn=!0,Mr=!1,ui=!1,qr=null,Fn={box:null,offscreen:null,occluded:null},mr={box:null},sn=null,Pn=null,An=null,In=0,or=0,Gr=0;Wt.textFeatureIndex?In=Wt.textFeatureIndex:At.useRuntimeCollisionCircles&&(In=At.featureIndex),Wt.verticalTextFeatureIndex&&(or=Wt.verticalTextFeatureIndex);const Kr=Er=>{Er.tileID=this.retainedQueryData[A.bucketInstanceId].tileID;const Tr=this.transform.elevation;Er.elevation=ot?Sn:Sn+(Tr?Tr.getAtTileOffset(Er.tileID,Er.tileAnchorX,Er.tileAnchorY):0),Er.elevation+=At.zOffset},hi=Wt.textBox;if(hi){Kr(hi);const Er=cr=>{let Nr=i.bq.horizontal;if(A.allowVerticalPlacement&&!cr&&this.prevPlacement){const xi=this.prevPlacement.placedOrientations[on];xi&&(this.placedOrientations[on]=xi,Nr=xi,this.markUsedOrientation(A,Nr,At))}return Nr},Tr=(cr,Nr)=>{if(A.allowVerticalPlacement&&dn>0&&Wt.verticalTextBox){for(const xi of A.writingModes)if(xi===i.bq.vertical?(Fn=Nr(),mr=Fn):Fn=cr(),Fn&&Fn.box&&Fn.box.length)break}else Fn=cr()};if(D.get("text-variable-anchor")){let cr=D.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[on]){const Or=this.prevPlacement.variableOffsets[on];cr.indexOf(Or.anchor)>0&&(cr=cr.filter(bi=>bi!==Or.anchor),cr.unshift(Or.anchor))}const Nr=(Or,bi,Io)=>{const ro=A.getSymbolInstanceTextSize(de,At,this.transform.zoom,zt),ja=(Or.x2-Or.x1)*ro+2*Or.padding,Ko=(Or.y2-Or.y1)*ro+2*Or.padding,Ea=At.hasIconTextFit&&!ze?bi:null;Ea&&Kr(Ea);let io={box:[],offscreen:!1,occluded:!1};const Jo=Re?2*cr.length:cr.length;for(let Ro=0;Ro<Jo;++Ro){const Yl=this.attemptAnchorPlacement(cr[Ro%cr.length],Or,ja,Ko,ro,De,$e,te,U,Te,Ro>=cr.length,At,zt,A,Io,Ea,de,he);if(Yl&&(io=Yl.placedGlyphBoxes,io&&io.box&&io.box.length)){bn=!0,qr=Yl.shift;break}}return io};Tr(()=>Nr(hi,Wt.iconBox,i.bq.horizontal),()=>{const Or=Wt.verticalTextBox;return Or&&Kr(Or),A.allowVerticalPlacement&&!(Fn&&Fn.box&&Fn.box.length)&&dn>0&&Or?Nr(Or,Wt.verticalIconBox,i.bq.vertical):{box:null,offscreen:null,occluded:null}}),Fn&&(bn=Fn.box,kn=Fn.offscreen,Mr=Fn.occluded);const xi=Er(!(!Fn||!Fn.box));if(!bn&&this.prevPlacement){const Or=this.prevPlacement.variableOffsets[on];Or&&(this.variableOffsets[on]=Or,this.markUsedJustification(A,Or.anchor,At,xi))}}else{const cr=(Nr,xi)=>{const Or=A.getSymbolInstanceTextSize(de,At,this.transform.zoom,zt,w),bi=this.collisionIndex.placeCollisionBox(A,Or,Nr,new i.P(0,0),Re,te,U,Te.predicate);return bi&&bi.box&&bi.box.length&&(this.markUsedOrientation(A,xi,At),this.placedOrientations[on]=xi),bi};Tr(()=>cr(hi,i.bq.horizontal),()=>{const Nr=Wt.verticalTextBox;return A.allowVerticalPlacement&&dn>0&&Nr?(Kr(Nr),cr(Nr,i.bq.vertical)):{box:null,offscreen:null,occluded:null}}),Er(!!(Fn&&Fn.box&&Fn.box.length))}}if(sn=Fn,bn=sn&&sn.box&&sn.box.length>0,kn=sn&&sn.offscreen,Mr=sn&&sn.occluded,At.useRuntimeCollisionCircles){const Er=A.text.placedSymbolArray.get(At.centerJustifiedTextSymbolIndex>=0?At.centerJustifiedTextSymbolIndex:At.verticalPlacedTextSymbolIndex),Tr=i.br(A.textSizeData,de,Er),cr=D.get("text-padding");Pn=this.collisionIndex.placeCollisionCircles(A,Re,Er,A.lineVertexArray,A.glyphOffsetArray,Tr,U,$,Z,m,$e,Te.predicate,At.collisionCircleDiameter*Tr/i.bw,cr,this.retainedQueryData[A.bucketInstanceId].tileID),bn=Re||Pn.circles.length>0&&!Pn.collisionDetected,kn=kn&&Pn.offscreen,Mr=Pn.occluded}if(Wt.iconFeatureIndex&&(Gr=Wt.iconFeatureIndex),Wt.iconBox){const Er=Tr=>{Kr(Tr);const cr=At.hasIconTextFit&&qr?Pm(qr.x,qr.y,De,$e,this.transform.angle):new i.P(0,0),Nr=A.getSymbolInstanceIconSize(he,this.transform.zoom,At.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(A,Nr,Tr,cr,ze,te,U,Te.predicate)};mr&&mr.box&&mr.box.length&&Wt.verticalIconBox?(An=Er(Wt.verticalIconBox),Ln=An.box.length>0):(An=Er(Wt.iconBox),Ln=An.box.length>0),kn=kn&&An.offscreen,ui=An.occluded}const yo=Me||At.numHorizontalGlyphVertices===0&&dn===0,Ci=Fe||At.numIconVertices===0;if(yo||Ci?Ci?yo||(Ln=Ln&&bn):bn=Ln&&bn:Ln=bn=Ln&&bn,bn&&sn&&sn.box&&this.collisionIndex.insertCollisionBox(sn.box,D.get("text-ignore-placement"),A.bucketInstanceId,mr&&mr.box&&or?or:In,Te.ID),Ln&&An&&this.collisionIndex.insertCollisionBox(An.box,D.get("icon-ignore-placement"),A.bucketInstanceId,Gr,Te.ID),Pn&&(bn&&this.collisionIndex.insertCollisionCircles(Pn.circles,D.get("text-ignore-placement"),A.bucketInstanceId,In,Te.ID),m)){const Er=A.bucketInstanceId;let Tr=this.collisionCircleArrays[Er];Tr===void 0&&(Tr=this.collisionCircleArrays[Er]=new Ll);for(let cr=0;cr<Pn.circles.length;cr+=4)Tr.circles.push(Pn.circles[cr+0]),Tr.circles.push(Pn.circles[cr+1]),Tr.circles.push(Pn.circles[cr+2]),Tr.circles.push(Pn.collisionDetected?1:0)}const hr=A.projection.name!=="globe";St=St&&(hr||!Mr),mt=mt&&(hr||!ui),this.placements[on]=new Cm(bn||St,Ln||mt,kn||A.justReloaded),l.add(on)};if(Xe&&this.buildingIndex&&(this.buildingIndex.updateZOffset(A,this.retainedQueryData[A.bucketInstanceId].tileID),A.updateZOffset()),A.sortFeaturesByY){const At=A.getSortedSymbolIndexes(this.transform.angle);for(let zt=At.length-1;zt>=0;--zt){const Wt=At[zt];It(A.symbolInstances.get(Wt),Wt,A.collisionArrays[Wt])}A.hasAnyZOffset&&i.w(`${A.layerIds[0]} layer symbol-z-elevate: symbols are not sorted by elevation if symbol-z-order is evaluated to viewport-y`)}else if(A.hasAnyZOffset){const At=A.getSortedIndexesByZOffset();for(let zt=0;zt<At.length;++zt){const Wt=At[zt];It(A.symbolInstances.get(Wt),Wt,A.collisionArrays[Wt])}}else for(let At=r.symbolInstanceStart;At<r.symbolInstanceEnd;At++)It(A.symbolInstances.get(At),At,A.collisionArrays[At]);if(m&&A.bucketInstanceId in this.collisionCircleArrays){const At=this.collisionCircleArrays[A.bucketInstanceId];i.ab.mat4.invert(At.invProjMatrix,U),At.viewportMatrix=this.collisionIndex.getViewportMatrix()}A.justReloaded=!1}markUsedJustification(r,l,m,x){const{leftJustifiedTextSymbolIndex:w,centerJustifiedTextSymbolIndex:A,rightJustifiedTextSymbolIndex:D,verticalPlacedTextSymbolIndex:N,crossTileID:U}=m,$=i.bB(l),Z=x===i.bq.vertical?N:$==="left"?w:$==="center"?A:$==="right"?D:-1;w>=0&&(r.text.placedSymbolArray.get(w).crossTileID=Z>=0&&w!==Z?0:U),A>=0&&(r.text.placedSymbolArray.get(A).crossTileID=Z>=0&&A!==Z?0:U),D>=0&&(r.text.placedSymbolArray.get(D).crossTileID=Z>=0&&D!==Z?0:U),N>=0&&(r.text.placedSymbolArray.get(N).crossTileID=Z>=0&&N!==Z?0:U)}markUsedOrientation(r,l,m){const x=l===i.bq.horizontal||l===i.bq.horizontalOnly?l:0,w=l===i.bq.vertical?l:0,{leftJustifiedTextSymbolIndex:A,centerJustifiedTextSymbolIndex:D,rightJustifiedTextSymbolIndex:N,verticalPlacedTextSymbolIndex:U}=m,$=r.text.placedSymbolArray;A>=0&&($.get(A).placedOrientation=x),D>=0&&($.get(D).placedOrientation=x),N>=0&&($.get(N).placedOrientation=x),U>=0&&($.get(U).placedOrientation=w)}commit(r){this.commitTime=r,this.zoomAtLastRecencyCheck=this.transform.zoom;const l=this.prevPlacement;let m=!1;this.prevZoomAdjustment=l?l.zoomAdjustment(this.transform.zoom):0;const x=l?l.symbolFadeChange(r):1,w=l?l.opacities:{},A=l?l.variableOffsets:{},D=l?l.placedOrientations:{};for(const N in this.placements){const U=this.placements[N],$=w[N];$?(this.opacities[N]=new Fs($,x,U.text,U.icon,null,U.clipped),m=m||U.text!==$.text.placed||U.icon!==$.icon.placed):(this.opacities[N]=new Fs(null,x,U.text,U.icon,U.skipFade,U.clipped),m=m||U.text||U.icon)}for(const N in w){const U=w[N];if(!this.opacities[N]){const $=new Fs(U,x,!1,!1);$.isHidden()||(this.opacities[N]=$,m=m||U.text.placed||U.icon.placed)}}for(const N in A)this.variableOffsets[N]||!this.opacities[N]||this.opacities[N].isHidden()||(this.variableOffsets[N]=A[N]);for(const N in D)this.placedOrientations[N]||!this.opacities[N]||this.opacities[N].isHidden()||(this.placedOrientations[N]=D[N]);m?this.lastPlacementChangeTime=r:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=l?l.lastPlacementChangeTime:r)}updateLayerOpacities(r,l,m,x){const w=new Set;for(const A of l){const D=A.getBucket(r);D&&A.latestFeatureIndex&&r.fqid===D.layerIds[0]&&(this.updateBucketOpacities(D,w,A,A.collisionBoxArray,m,x,A.tileID,r.scope),D.layers[0].layout.get("symbol-z-elevate")&&this.buildingIndex&&(this.buildingIndex.updateZOffset(D,A.tileID),D.updateZOffset()))}}updateBucketOpacities(r,l,m,x,w,A,D,N){r.hasTextData()&&r.text.opacityVertexArray.clear(),r.hasIconData()&&r.icon.opacityVertexArray.clear(),r.hasIconCollisionBoxData()&&r.iconCollisionBox.collisionVertexArray.clear(),r.hasTextCollisionBoxData()&&r.textCollisionBox.collisionVertexArray.clear();const U=r.layers[0].layout,$=r.layers[0].paint,Z=!!r.layers[0].dynamicFilter(),W=new Fs(null,0,!1,!1,!0),te=U.get("text-allow-overlap"),ue=U.get("icon-allow-overlap"),se=U.get("text-variable-anchor"),de=U.get("text-rotation-alignment")==="map",he=U.get("text-pitch-alignment")==="map",Te=$.get("symbol-z-offset"),Pe=U.get("symbol-elevation-reference")==="sea",Me=!Te.isConstant(),Fe=new Fs(null,0,te&&(ue||!r.hasIconData()||U.get("icon-optional")),ue&&(te||!r.hasTextData()||U.get("text-optional")),!0);!r.collisionArrays&&x&&(r.hasIconCollisionBoxData()||r.hasTextCollisionBoxData())&&r.deserializeCollisionBoxes(x);const Re=(De,$e,Xe)=>{for(let ht=0;ht<$e/4;ht++)De.opacityVertexArray.emplaceBack(Xe)};let ze=0;A&&r.updateReplacement(D,A);for(let De=0;De<r.symbolInstances.length;De++){const $e=r.symbolInstances.get(De),{numHorizontalGlyphVertices:Xe,numVerticalGlyphVertices:ht,crossTileID:ot,numIconVertices:Et,tileAnchorX:yt,tileAnchorY:nt}=$e;let pt=null;const Lt=this.retainedQueryData[r.bucketInstanceId];Me&&$e&&Lt&&(pt=m.latestFeatureIndex.loadFeature({featureIndex:$e.featureIndex,bucketIndex:Lt.bucketIndex,sourceLayerIndex:Lt.sourceLayerIndex,layoutVertexArrayOffset:0}));const tt=Te.evaluate(pt,{}),St=l.has(ot);let mt=this.opacities[ot];St?mt=W:mt||(mt=Fe,this.opacities[ot]=mt),l.add(ot);const Gt=Xe>0||ht>0,It=Et>0,At=this.placedOrientations[ot],zt=At===i.bq.vertical,Wt=At===i.bq.horizontal||At===i.bq.horizontalOnly;!Gt&&!It||mt.isHidden()||ze++;let on=!1;if((Gt||It)&&A)for(const dn of r.activeReplacements){if(i.bx(dn,w,i.by.Symbol,N)||dn.min.x>yt||yt>dn.max.x||dn.min.y>nt||nt>dn.max.y)continue;const En=i.bz(yt,nt,D.canonical,dn.footprintTileId.canonical);if(on=i.bA(En,dn.footprint),on)break}if(Gt){const dn=on?js:Im(mt.text);Re(r.text,Xe,zt?js:dn),Re(r.text,ht,Wt?js:dn);const En=mt.text.isHidden(),{leftJustifiedTextSymbolIndex:Sn,centerJustifiedTextSymbolIndex:bn,rightJustifiedTextSymbolIndex:Ln,verticalPlacedTextSymbolIndex:kn}=$e,Mr=r.text.placedSymbolArray,ui=En||zt?1:0;Sn>=0&&(Mr.get(Sn).hidden=ui),bn>=0&&(Mr.get(bn).hidden=ui),Ln>=0&&(Mr.get(Ln).hidden=ui),kn>=0&&(Mr.get(kn).hidden=En||Wt?1:0);const qr=this.variableOffsets[ot];qr&&this.markUsedJustification(r,qr.anchor,$e,At);const Fn=this.placedOrientations[ot];Fn&&(this.markUsedJustification(r,"left",$e,Fn),this.markUsedOrientation(r,Fn,$e))}if(It){const dn=on?js:Im(mt.icon),{placedIconSymbolIndex:En,verticalPlacedIconSymbolIndex:Sn}=$e,bn=r.icon.placedSymbolArray,Ln=mt.icon.isHidden()?1:0;En>=0&&(Re(r.icon,Et,zt?js:dn),bn.get(En).hidden=Ln),Sn>=0&&(Re(r.icon,$e.numVerticalIconVertices,Wt?js:dn),bn.get(Sn).hidden=Ln)}if(r.hasIconCollisionBoxData()||r.hasTextCollisionBoxData()){const dn=r.collisionArrays[De];if(dn){let En=new i.P(0,0),Sn=!0;if(dn.textBox||dn.verticalTextBox){if(se){const Ln=this.variableOffsets[ot];Ln?(En=ho(Ln.anchor,Ln.width,Ln.height,Ln.textOffset,Ln.textScale),de&&En._rotate(he?this.transform.angle:-this.transform.angle)):Sn=!1}Z&&(Sn=!mt.clipped),dn.textBox&&Ff(r.textCollisionBox.collisionVertexArray,mt.text.placed,!Sn||zt,tt,Pe,En.x,En.y),dn.verticalTextBox&&Ff(r.textCollisionBox.collisionVertexArray,mt.text.placed,!Sn||Wt,tt,Pe,En.x,En.y)}const bn=Sn&&!!(!Wt&&dn.verticalIconBox);dn.iconBox&&Ff(r.iconCollisionBox.collisionVertexArray,mt.icon.placed,bn,tt,Pe,$e.hasIconTextFit?En.x:0,$e.hasIconTextFit?En.y:0),dn.verticalIconBox&&Ff(r.iconCollisionBox.collisionVertexArray,mt.icon.placed,!bn,tt,Pe,$e.hasIconTextFit?En.x:0,$e.hasIconTextFit?En.y:0)}}}if(r.fullyClipped=ze===0,r.sortFeatures(this.transform.angle),this.retainedQueryData[r.bucketInstanceId]&&(this.retainedQueryData[r.bucketInstanceId].featureSortOrder=r.featureSortOrder),r.hasTextData()&&r.text.opacityVertexBuffer&&r.text.opacityVertexBuffer.updateData(r.text.opacityVertexArray),r.hasIconData()&&r.icon.opacityVertexBuffer&&r.icon.opacityVertexBuffer.updateData(r.icon.opacityVertexArray),r.hasIconCollisionBoxData()&&r.iconCollisionBox.collisionVertexBuffer&&r.iconCollisionBox.collisionVertexBuffer.updateData(r.iconCollisionBox.collisionVertexArray),r.hasTextCollisionBoxData()&&r.textCollisionBox.collisionVertexBuffer&&r.textCollisionBox.collisionVertexBuffer.updateData(r.textCollisionBox.collisionVertexArray),r.bucketInstanceId in this.collisionCircleArrays){const De=this.collisionCircleArrays[r.bucketInstanceId];r.placementInvProjMatrix=De.invProjMatrix,r.placementViewportMatrix=De.viewportMatrix,r.collisionCircleArray=De.circles,delete this.collisionCircleArrays[r.bucketInstanceId]}}symbolFadeChange(r){return this.fadeDuration===0?1:(r-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(r){return Math.max(0,(this.transform.zoom-r)/1.5)}hasTransitions(r){return this.stale||r-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(r,l){const m=this.zoomAtLastRecencyCheck===l?1-this.zoomAdjustment(l):1;return this.zoomAtLastRecencyCheck=l,this.commitTime+this.fadeDuration*m>r}setStale(){this.stale=!0}}function Ff(p,r,l,m,x,w,A){p.emplaceBack(r?1:0,l?1:0,w||0,A||0,m,x?1:0),p.emplaceBack(r?1:0,l?1:0,w||0,A||0,m,x?1:0),p.emplaceBack(r?1:0,l?1:0,w||0,A||0,m,x?1:0),p.emplaceBack(r?1:0,l?1:0,w||0,A||0,m,x?1:0)}const jf=Math.pow(2,25),Ay=Math.pow(2,24),Cy=Math.pow(2,17),Uf=Math.pow(2,16),Vf=Math.pow(2,9),My=Math.pow(2,8),vh=Math.pow(2,1);function Im(p){if(p.opacity===0&&!p.placed)return 0;if(p.opacity===1&&p.placed)return 4294967295;const r=p.placed?1:0,l=Math.floor(127*p.opacity);return l*jf+r*Ay+l*Cy+r*Uf+l*Vf+r*My+l*vh+r}const js=0;class fs{constructor(r){this._sortAcrossTiles=r.layout.get("symbol-z-order")!=="viewport-y"&&r.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(r,l,m,x,w,A){const D=this._bucketParts;for(;this._currentTileIndex<r.length;)if(l.getBucketParts(D,x,r[this._currentTileIndex],this._sortAcrossTiles,A),this._currentTileIndex++,w())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,D.sort((N,U)=>N.sortKey-U.sortKey));this._currentPartIndex<D.length;){const N=D[this._currentPartIndex];if(l.placeLayerBucketPart(N,this._seenCrossTileIDs,m,N.symbolInstanceStart===0,A),this._currentPartIndex++,w())return!0}return!1}}class Oy{constructor(r,l,m,x,w,A,D,N,U){this.placement=new Nf(r,w,A,D,N,U),this._currentPlacementIndex=l.length-1,this._forceFullPlacement=m,this._showCollisionBoxes=x,this._done=!1}isDone(){return this._done}continuePlacement(r,l,m,x,w){const A=i.q.now(),D=()=>{const N=i.q.now()-A;return!this._forceFullPlacement&&N>2};for(;this._currentPlacementIndex>=0;){const N=l[r[this._currentPlacementIndex]],U=this.placement.collisionIndex.transform.zoom;if(N.type==="symbol"&&(!N.minzoom||N.minzoom<=U)&&(!N.maxzoom||N.maxzoom>U)){const $=N,Z=$.layout.get("symbol-z-elevate"),W=$.layout.get("symbol-sort-key").constantOr(1)!==void 0,te=$.layout.get("symbol-z-order"),ue=te==="viewport-y"||te==="auto"&&!(te!=="viewport-y"&&W),se=$.layout.get("text-allow-overlap")||$.layout.get("icon-allow-overlap")||$.layout.get("text-ignore-placement")||$.layout.get("icon-ignore-placement"),de=ue&&se,he=this._inProgressLayer=this._inProgressLayer||new fs($),Te=i.aC(N.source,N.scope);if(he.continuePlacement(Z||de?x[Te]:m[Te],this.placement,this._showCollisionBoxes,N,D,w))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(r){return this.placement.commit(r),this.placement}}const lp=512/i.ag/2;class r_{constructor(r,l,m){this.tileID=r,this.bucketInstanceId=m,this.index=new i.bE(l.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const x=r.canonical.x*i.ag,w=r.canonical.y*i.ag;for(let A=0;A<l.length;A++){const{key:D,crossTileID:N,tileAnchorX:U,tileAnchorY:$}=l.get(A),Z=Math.floor((x+U)*lp),W=Math.floor((w+$)*lp);this.index.add(Z,W),this.keys.push(D),this.crossTileIDs.push(N)}this.index.finish()}findMatches(r,l,m){const x=this.tileID.canonical.z<l.canonical.z?1:Math.pow(2,this.tileID.canonical.z-l.canonical.z),w=lp/Math.pow(2,l.canonical.z-this.tileID.canonical.z),A=l.canonical.x*i.ag,D=l.canonical.y*i.ag;for(let N=0;N<r.length;N++){const U=r.get(N);if(U.crossTileID)continue;const{key:$,tileAnchorX:Z,tileAnchorY:W}=U,te=Math.floor((A+Z)*w),ue=Math.floor((D+W)*w),se=this.index.range(te-x,ue-x,te+x,ue+x);for(const de of se){const he=this.crossTileIDs[de];if(this.keys[de]===$&&!m.has(he)){m.add(he),U.crossTileID=he;break}}}}}class Rm{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class i_{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(r){const l=Math.round((r-this.lng)/360);if(l!==0)for(const m in this.indexes){const x=this.indexes[m],w={};for(const A in x){const D=x[A];D.tileID=D.tileID.unwrapTo(D.tileID.wrap+l),w[D.tileID.key]=D}this.indexes[m]=w}this.lng=r}addBucket(r,l,m){if(this.indexes[r.overscaledZ]&&this.indexes[r.overscaledZ][r.key]){if(this.indexes[r.overscaledZ][r.key].bucketInstanceId===l.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(r.overscaledZ,this.indexes[r.overscaledZ][r.key])}for(let w=0;w<l.symbolInstances.length;w++)l.symbolInstances.get(w).crossTileID=0;this.usedCrossTileIDs[r.overscaledZ]||(this.usedCrossTileIDs[r.overscaledZ]=new Set);const x=this.usedCrossTileIDs[r.overscaledZ];for(const w in this.indexes){const A=this.indexes[w];if(Number(w)>r.overscaledZ)for(const D in A){const N=A[D];N.tileID.isChildOf(r)&&N.findMatches(l.symbolInstances,r,x)}else{const D=A[r.scaledTo(Number(w)).key];D&&D.findMatches(l.symbolInstances,r,x)}}for(let w=0;w<l.symbolInstances.length;w++){const A=l.symbolInstances.get(w);A.crossTileID||(A.crossTileID=m.generate(),x.add(A.crossTileID))}return this.indexes[r.overscaledZ]===void 0&&(this.indexes[r.overscaledZ]={}),this.indexes[r.overscaledZ][r.key]=new r_(r,l.symbolInstances,l.bucketInstanceId),!0}removeBucketCrossTileIDs(r,l){for(const m of l.crossTileIDs)this.usedCrossTileIDs[r].delete(m)}removeStaleBuckets(r){let l=!1;for(const m in this.indexes){const x=this.indexes[m];for(const w in x)r[x[w].bucketInstanceId]||(this.removeBucketCrossTileIDs(m,x[w]),delete x[w],l=!0)}return l}}class cp{constructor(){this.layerIndexes={},this.crossTileIDs=new Rm,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(r,l,m,x){let w=this.layerIndexes[r.fqid];w===void 0&&(w=this.layerIndexes[r.fqid]=new i_);let A=!1;const D={};x.name!=="globe"&&w.handleWrapJump(m);for(const N of l){const U=N.getBucket(r);U&&r.fqid===U.layerIds[0]&&(U.bucketInstanceId||(U.bucketInstanceId=++this.maxBucketInstanceId),w.addBucket(N.tileID,U,this.crossTileIDs)&&(A=!0),D[U.bucketInstanceId]=!0)}return w.removeStaleBuckets(D)&&(A=!0),A}pruneUnusedLayers(r){const l={};r.forEach(m=>{l[m]=!0});for(const m in this.layerIndexes)l[m]||delete this.layerIndexes[m]}}const ds=771;class Jn{constructor(r,l,m,x){this.blendFunction=r,this.blendColor=l,this.mask=m,this.blendEquation=x}}Jn.Replace=[1,0,1,0],Jn.disabled=new Jn(Jn.Replace,i.aj.transparent,[!1,!1,!1,!1]),Jn.unblended=new Jn(Jn.Replace,i.aj.transparent,[!0,!0,!0,!0]),Jn.alphaBlended=new Jn([1,ds,1,ds],i.aj.transparent,[!0,!0,!0,!0]),Jn.alphaBlendedNonPremultiplied=new Jn([770,ds,770,ds],i.aj.transparent,[!0,!0,!0,!0]),Jn.multiply=new Jn([774,0,774,0],i.aj.transparent,[!0,!0,!0,!0]);class Tn{constructor(r,l,m){this.func=r,this.mask=l,this.range=m}}Tn.ReadOnly=!1,Tn.ReadWrite=!0,Tn.disabled=new Tn(519,Tn.ReadOnly,[0,1]);const up=7680;class Dn{constructor(r,l,m,x,w,A){this.test=r,this.ref=l,this.mask=m,this.fail=x,this.depthFail=w,this.pass=A}}Dn.disabled=new Dn({func:519,mask:0},0,0,up,up,up);const vu=1029,mc=2305;class Rn{constructor(r,l,m){this.enable=r,this.mode=l,this.frontFace=m}}function xh(p,r){const l=i.bG(p,3);i.ab.mat4.fromQuat(p,r),i.bI(p,3,l)}function rl(p,r){const l=i.ab.quat.identity([]);return i.ab.quat.rotateZ(l,l,-r),i.ab.quat.rotateX(l,l,-p),l}function hp(p,r){const l=[p[0],p[1],0],m=[r[0],r[1],0];if(i.ab.vec3.length(l)>=1e-15){const A=i.ab.vec3.normalize([],l);i.ab.vec3.scale(m,A,i.ab.vec3.dot(m,A)),r[0]=m[0],r[1]=m[1]}const x=i.ab.vec3.cross([],r,p);if(i.ab.vec3.len(x)<1e-15)return null;const w=Math.atan2(-x[1],x[0]);return rl(Math.atan2(Math.sqrt(p[0]*p[0]+p[1]*p[1]),-p[2]),w)}Rn.disabled=new Rn(!1,vu,mc),Rn.backCCW=new Rn(!0,vu,mc),Rn.backCW=new Rn(!0,vu,2304),Rn.frontCW=new Rn(!0,1028,2304),Rn.frontCCW=new Rn(!0,1028,mc);class $f{constructor(r,l){this.position=r,this.orientation=l}get position(){return this._position}set position(r){if(r){const l=r instanceof i.aa?r:new i.aa(r[0],r[1],r[2]);this._renderWorldCopies&&(l.x=i.bF(l.x,0,1)),this._position=l}else this._position=null}lookAtPoint(r,l){if(this.orientation=null,!this.position)return;const m=this.position,x=this._elevation?this._elevation.getAtPointOrZero(i.aa.fromLngLat(r)):0,w=i.aa.fromLngLat(r,x),A=[w.x-m.x,w.y-m.y,w.z-m.z];l||(l=[0,0,1]),l[2]=Math.abs(l[2]),this.orientation=hp(A,l)}setPitchBearing(r,l){this.orientation=rl(i.ai(r),i.ai(-l))}}class Wa{constructor(r,l){this._transform=i.ab.mat4.identity([]),this.orientation=l,this.position=r}get mercatorPosition(){const r=this.position;return new i.aa(r[0],r[1],r[2])}get position(){const r=i.bG(this._transform,3);return[r[0],r[1],r[2]]}set position(r){var l;r&&i.bI(this._transform,3,[(l=r)[0],l[1],l[2],1])}get orientation(){return this._orientation}set orientation(r){this._orientation=r||i.ab.quat.identity([]),r&&xh(this._transform,this._orientation)}getPitchBearing(){const r=this.forward(),l=this.right();return{bearing:Math.atan2(-l[1],l[0]),pitch:Math.atan2(Math.sqrt(r[0]*r[0]+r[1]*r[1]),-r[2])}}setPitchBearing(r,l){this._orientation=rl(r,l),xh(this._transform,this._orientation)}forward(){const r=i.bG(this._transform,2);return[-r[0],-r[1],-r[2]]}up(){const r=i.bG(this._transform,1);return[-r[0],-r[1],-r[2]]}right(){const r=i.bG(this._transform,0);return[r[0],r[1],r[2]]}getCameraToWorld(r,l){const m=new Float64Array(16);return i.ab.mat4.invert(m,this.getWorldToCamera(r,l)),m}getCameraToWorldMercator(){return this._transform}getWorldToCameraPosition(r,l,m){const x=this.position;i.ab.vec3.scale(x,x,-r);const w=new Float64Array(16);return i.ab.mat4.fromScaling(w,[m,m,m]),i.ab.mat4.translate(w,w,x),w[10]*=l,w}getWorldToCamera(r,l){const m=new Float64Array(16),x=new Float64Array(4),w=this.position;return i.ab.quat.conjugate(x,this._orientation),i.ab.vec3.scale(w,w,-r),i.ab.mat4.fromQuat(m,x),i.ab.mat4.translate(m,m,w),m[1]*=-1,m[5]*=-1,m[9]*=-1,m[13]*=-1,m[8]*=l,m[9]*=l,m[10]*=l,m[11]*=l,m}getCameraToClipPerspective(r,l,m,x){const w=new Float64Array(16);return i.ab.mat4.perspective(w,r,l,m,x),w}getCameraToClipOrthographic(r,l,m,x,w,A){const D=new Float64Array(16);return i.ab.mat4.ortho(D,r,l,m,x,w,A),D}getDistanceToElevation(r,l=!1){const m=r===0?0:i.bH(r,l?i.aS(this.position[1]):this.position[1]),x=this.forward();return(m-this.position[2])/x[2]}clone(){return new Wa([...this.position],[...this.orientation])}}const aa={BaseColor:5,MetallicRoughness:6,Normal:7,Occlusion:8,Emission:9,LUT:10,ShadowMap0:11};class Kt{constructor(r=0,l=0,m=0,x=0){if(isNaN(r)||r<0||isNaN(l)||l<0||isNaN(m)||m<0||isNaN(x)||x<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=r,this.bottom=l,this.left=m,this.right=x}interpolate(r,l,m){return l.top!=null&&r.top!=null&&(this.top=i.af(r.top,l.top,m)),l.bottom!=null&&r.bottom!=null&&(this.bottom=i.af(r.bottom,l.bottom,m)),l.left!=null&&r.left!=null&&(this.left=i.af(r.left,l.left,m)),l.right!=null&&r.right!=null&&(this.right=i.af(r.right,l.right,m)),this}getCenter(r,l){const m=i.aw((this.left+r-this.right)/2,0,r),x=i.aw((this.top+l-this.bottom)/2,0,l);return new i.P(m,x)}equals(r){return this.top===r.top&&this.bottom===r.bottom&&this.left===r.left&&this.right===r.right}clone(){return new Kt(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const fp=(p,r,l)=>(1-l)*p+l*r,qf=p=>p*p*p*p*p;class Gf{constructor(r,l,m,x,w,A,D){this.tileSize=512,this._renderWorldCopies=w===void 0||w,this._minZoom=r||0,this._maxZoom=l||22,this._minPitch=m??0,this._maxPitch=x??60,this.setProjection(A),this.setMaxBounds(D),this.width=0,this.height=0,this._center=new i.bO(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new Kt,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._expandedProjMatrixCache={},this._distanceTileDataCache={},this._camera=new Wa,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._tileCoverLift=0,this.freezeTileCoverage=!1,this._horizonShift=.1,this._orthographicProjectionAtLowPitch=!1}clone(){const r=new Gf(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return r._elevation=this._elevation,r._centerAltitude=this._centerAltitude,r._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,r.tileSize=this.tileSize,r.mercatorFromTransition=this.mercatorFromTransition,r.width=this.width,r.height=this.height,r.cameraElevationReference=this.cameraElevationReference,r._center=this._center,r._setZoom(this.zoom),r._seaLevelZoom=this._seaLevelZoom,r.angle=this.angle,r._fov=this._fov,r._pitch=this._pitch,r._nearZ=this._nearZ,r._farZ=this._farZ,r._averageElevation=this._averageElevation,r._orthographicProjectionAtLowPitch=this._orthographicProjectionAtLowPitch,r._unmodified=this._unmodified,r._edgeInsets=this._edgeInsets.clone(),r._camera=this._camera.clone(),r._calcMatrices(),r.freezeTileCoverage=this.freezeTileCoverage,r.frustumCorners=this.frustumCorners,r}get isOrthographic(){return this.projection.name!=="globe"&&this._orthographicProjectionAtLowPitch&&this.pitch<15}get elevation(){return this._elevation}set elevation(r){this._elevation!==r&&(this._elevation=r,this._updateCameraOnTerrain(),this._calcMatrices())}get depthOcclusionForSymbolsAndCircles(){return this.projection.name!=="globe"&&!this.isOrthographic}updateElevation(r,l=!1){const m=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||m)&&this._updateCameraOnTerrain(),(r||m)&&this._constrainCamera(l),this._calcMatrices()}getProjection(){return i.ay(this.projection,["name","center","parallels"])}setProjection(r){this.projectionOptions=r||{name:"mercator"};const l=this.projection?this.getProjection():void 0;this.projection=i.bP(this.projectionOptions);const m=this.getProjection(),x=!i.bn(l,m);return x&&this._calcMatrices(),this.mercatorFromTransition=!1,x}setOrthographicProjectionAtLowPitch(r){return this._orthographicProjectionAtLowPitch!==r&&(this._orthographicProjectionAtLowPitch=r,this._calcMatrices(),!0)}setMercatorFromTransition(){const r=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=i.bP({name:"mercator"});const l=r!==this.projection.name;return l&&this._calcMatrices(),l}get minZoom(){return this._minZoom}set minZoom(r){this._minZoom!==r&&(this._minZoom=r,this.zoom=Math.max(this.zoom,r))}get maxZoom(){return this._maxZoom}set maxZoom(r){this._maxZoom!==r&&(this._maxZoom=r,this.zoom=Math.min(this.zoom,r))}get minPitch(){return this._minPitch}set minPitch(r){this._minPitch!==r&&(this._minPitch=r,this.pitch=Math.max(this.pitch,r))}get maxPitch(){return this._maxPitch}set maxPitch(r){this._maxPitch!==r&&(this._maxPitch=r,this.pitch=Math.min(this.pitch,r))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(r){r===void 0?r=!0:r===null&&(r=!1),this._renderWorldCopies=r}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const r=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(r))}get cameraWorldSize(){const r=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(r))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return i.bH(1,this.center.lat)*this.cameraWorldSizeForFog}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new i.P(this.width,this.height)}get bearing(){return i.bF(this.rotation,-180,180)}set bearing(r){this.rotation=r}get rotation(){return-this.angle/Math.PI*180}set rotation(r){const l=-r*Math.PI/180;this.angle!==l&&(this._unmodified=!1,this.angle=l,this._calcMatrices(),this.rotationMatrix=i.ab.mat2.create(),i.ab.mat2.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(r){const l=i.aw(r,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==l&&(this._unmodified=!1,this._pitch=l,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const r=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/r)}set fov(r){r=Math.max(.01,Math.min(60,r)),this._fov!==r&&(this._unmodified=!1,this._fov=i.ai(r),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(r){this._averageElevation=r,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(r){const l=Math.min(Math.max(r,this.minZoom),this.maxZoom);this._zoom!==l&&(this._unmodified=!1,this._setZoom(l),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(r){this._zoom=r,this.scale=this.zoomScale(r),this.tileZoom=Math.floor(r),this.zoomFraction=r-this.tileZoom}get tileCoverLift(){return this._tileCoverLift}set tileCoverLift(r){this._tileCoverLift!==r&&(this._tileCoverLift=r)}_updateCameraOnTerrain(){const r=this.elevation?this.elevation.getAtPoint(this.locationCoordinate(this.center),Number.NEGATIVE_INFINITY):Number.NEGATIVE_INFINITY,l=this.elevation&&r===Number.NEGATIVE_INFINITY&&this.elevation.visibleDemTiles.length>0&&this.elevation.exaggeration()>0&&this._centerAltitudeValidForExaggeration;if(!this._elevation||r===Number.NEGATIVE_INFINITY&&(!l||!this._centerAltitude))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const m=this._elevation;l||this._centerAltitude&&this._centerAltitudeValidForExaggeration&&m.exaggeration()&&this._centerAltitudeValidForExaggeration!==m.exaggeration()?(this._centerAltitude=this._centerAltitude/this._centerAltitudeValidForExaggeration*m.exaggeration(),this._centerAltitudeValidForExaggeration=m.exaggeration()):(this._centerAltitude=r||0,this._centerAltitudeValidForExaggeration=m.exaggeration()),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const r=this._elevation,l=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],m=this.horizonLineFromTop();let x=0,w=0;for(let A=0;A<l.length;A++){const D=new i.P(l[A][0]*this.width,m+l[A][1]*(this.height-m)),N=r.pointCoordinate(D);if(!N)continue;const U=1/Math.hypot(N[0]-this._camera.position[0],N[1]-this._camera.position[1]);x+=N[3]*U,w+=U}return w===0?NaN:x/w}get center(){return this._center}set center(r){r.lat===this._center.lat&&r.lng===this._center.lng||(this._unmodified=!1,this._center=r,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const r=this._seaLevelZoom,l=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),m=this.pixelsPerMeter/this.worldSize*l,x=this._mercatorZfromZoom(r),w=this._mercatorZfromZoom(this._maxZoom),A=Math.max(x-m,w);this._setZoom(this._zoomFromMercatorZ(A))}get padding(){return this._edgeInsets.toJSON()}set padding(r){this._edgeInsets.equals(r)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,r,1),this._calcMatrices())}computeZoomRelativeTo(r){const l=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,r.toAltitude()));let m;m=r.z<this._camera.position[2]?[l.x,l.y,l.z]:[r.x,r.y,r.z];const x=i.ab.vec3.length(i.ab.vec3.sub([],this._camera.position,m));return i.aw(this._zoomFromMercatorZ(x),this._minZoom,this._maxZoom)}setFreeCameraOptions(r){if(!this.height||!r.position&&!r.orientation)return;this._updateCameraState();let l=!1;if(r.orientation&&!i.ab.quat.exactEquals(r.orientation,this._camera.orientation)&&(l=this._setCameraOrientation(r.orientation)),r.position){const m=[r.position.x,r.position.y,r.position.z];i.ab.vec3.exactEquals(m,this._camera.position)||(this._setCameraPosition(m),l=!0)}l&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const r=this._camera.position,l=new $f;return l.position=new i.aa(r[0],r[1],r[2]),l.orientation=this._camera.orientation,l._elevation=this.elevation,l._renderWorldCopies=this.renderWorldCopies,l}_setCameraOrientation(r){if(!i.ab.quat.length(r))return!1;i.ab.quat.normalize(r,r);const l=i.ab.vec3.transformQuat([],[0,0,-1],r),m=i.ab.vec3.transformQuat([],[0,-1,0],r);if(m[2]<0)return!1;const x=hp(l,m);return!!x&&(this._camera.orientation=x,!0)}_setCameraPosition(r){const l=this.zoomScale(this.minZoom)*this.tileSize,m=this.zoomScale(this.maxZoom)*this.tileSize,x=this.cameraToCenterDistance;r[2]=i.aw(r[2],x/m,x/l),this._camera.position=r}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(r){return this._edgeInsets.equals(r)}interpolatePadding(r,l,m){this._unmodified=!1,this._edgeInsets.interpolate(r,l,m),this._constrain(),this._calcMatrices()}coveringZoomLevel(r){const l=(r.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/r.tileSize));return Math.max(0,l)}getVisibleUnwrappedCoordinates(r){const l=[new i.bQ(0,r)];if(this.renderWorldCopies){const m=this.pointCoordinate(new i.P(0,0)),x=this.pointCoordinate(new i.P(this.width,0)),w=this.pointCoordinate(new i.P(this.width,this.height)),A=this.pointCoordinate(new i.P(0,this.height)),D=Math.floor(Math.min(m.x,x.x,w.x,A.x)),N=Math.floor(Math.max(m.x,x.x,w.x,A.x)),U=1;for(let $=D-U;$<=N+U;$++)$!==0&&l.push(new i.bQ($,r))}return l}isLODDisabled(r){return(!r||this.pitch<=60)&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace}extendTileCover(r,l,m){let x=[];const w=m!==void 0,A=!w;if(A&&this.zoom<l||w&&m[0]===0&&m[1]===0)return x;const D=new Set,N=($,Z,W,te,ue)=>{const se=i.c5(Z,$,W,te,ue);D.has(se)||(x.push(new i.aG($,Z,W,te,ue)),D.add(se))};for(let $=0;$<r.length;$++){const Z=r[$];if(A&&Z.canonical.z!==l)continue;const W=Z.canonical,te=Z.overscaledZ,ue=Z.wrap,se=1<<W.z,de=W.x+1<se,he=W.x>0,Te=W.y+1<se,Pe=W.y>0,Me=Z.wrap-(he?0:1),Fe=Z.wrap+(de?0:1),Re=he?W.x-1:se-1,ze=de?W.x+1:0;if(w)m[0]<0?(N(te,Fe,W.z,ze,W.y),m[1]<0&&Te&&(N(te,ue,W.z,W.x,W.y+1),N(te,Fe,W.z,ze,W.y+1)),m[1]>0&&Pe&&(N(te,ue,W.z,W.x,W.y-1),N(te,Fe,W.z,ze,W.y-1))):m[0]>0?(N(te,Me,W.z,Re,W.y),m[1]<0&&Te&&(N(te,ue,W.z,W.x,W.y+1),N(te,Me,W.z,Re,W.y+1)),m[1]>0&&Pe&&(N(te,ue,W.z,W.x,W.y-1),N(te,Me,W.z,Re,W.y-1))):m[1]<0&&Te?N(te,ue,W.z,W.x,W.y+1):Pe&&N(te,ue,W.z,W.x,W.y-1);else{const De=Z.visibleQuadrants;1&De&&(N(te,Me,W.z,Re,W.y),Pe&&(N(te,ue,W.z,W.x,W.y-1),N(te,Me,W.z,Re,W.y-1))),2&De&&(N(te,Fe,W.z,ze,W.y),Pe&&(N(te,ue,W.z,W.x,W.y-1),N(te,Fe,W.z,ze,W.y-1))),4&De&&(N(te,Me,W.z,Re,W.y),Te&&(N(te,ue,W.z,W.x,W.y+1),N(te,Me,W.z,Re,W.y+1))),8&De&&(N(te,Fe,W.z,ze,W.y),Te&&(N(te,ue,W.z,W.x,W.y+1),N(te,Fe,W.z,ze,W.y+1)))}}const U=[];for(const $ of x)x.some(Z=>$.isChildOf(Z))||U.push($);if(x=U.filter($=>!r.some(Z=>!!($.overscaledZ<l&&Z.isChildOf($))||$.equals(Z)||$.isChildOf(Z))),A){const $=1<<l,Z=this.projection.name==="globe"?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),W=[$*Z.x,$*Z.y],te=4,ue=te*te;x=x.filter(se=>{const de=se.canonical.x+.5-W[0],he=se.canonical.y+.5-W[1];return de*de+he*he<ue})}return x}coveringTiles(r){let l=this.coveringZoomLevel(r);const m=l,x=this.elevation&&this.elevation.exaggeration(),w=x&&!r.isTerrainDEM,A=this.projection.name==="mercator";if(r.minzoom!==void 0&&l<r.minzoom)return[];r.maxzoom!==void 0&&l>r.maxzoom&&(l=r.maxzoom);const D=this.locationCoordinate(this.center),N=this.center.lat,U=1<<l,$=[U*D.x,U*D.y,0],Z=this.projection.name==="globe",W=!Z,te=i.bR.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,l,W),ue=Z?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),se=U*i.bH(1,this.center.lat),de=this._camera.position[2]/i.bH(1,this.center.lat),he=[U*ue.x,U*ue.y,de*(W?1:se)],Te=Z||x,Pe=this.cameraToCenterDistance/r.tileSize*(r.roundZoom?1:.502),Me=this.isLODDisabled(!0)?l:0;let Fe;if(this._elevation&&r.isTerrainDEM)Fe=1e4*this._elevation.exaggeration();else if(this._elevation){const tt=this._elevation.getMinMaxForVisibleTiles();Fe=tt?tt.max:this._centerAltitude}else Fe=this._centerAltitude;const Re=r.isTerrainDEM?-Fe:this._elevation?this._elevation.getMinElevationBelowMSL():0,ze=this.projection.isReprojectedInTileSpace?i.bS(this):1,De=tt=>{const mt=new i.aa(tt.x+25e-6,tt.y,tt.z),Gt=new i.aa(tt.x,tt.y+25e-6,tt.z),It=tt.toLngLat(),At=mt.toLngLat(),zt=Gt.toLngLat(),Wt=this.locationCoordinate(It),on=this.locationCoordinate(At),dn=this.locationCoordinate(zt),En=Math.hypot(on.x-Wt.x,on.y-Wt.y),Sn=Math.hypot(dn.x-Wt.x,dn.y-Wt.y);return Math.sqrt(En*Sn)*ze/25e-6},$e=tt=>{const St=Fe,mt=Re;return{aabb:i.bV(this,U,0,0,0,tt,mt,St,this.projection),zoom:0,x:0,y:0,minZ:mt,maxZ:St,wrap:tt,fullyVisible:!1}},Xe=[];let ht=[];const ot=l,Et=r.reparseOverscaled?m:l,yt=(de-this._centerAltitude)*se,nt=tt=>{if(!this._elevation||!tt.tileID||!A)return;const St=this._elevation.getMinMaxForTile(tt.tileID),mt=tt.aabb;St?(mt.min[2]=St.min,mt.max[2]=St.max,mt.center[2]=(mt.min[2]+mt.max[2])/2):(tt.shouldSplit=Lt(tt),tt.shouldSplit||(mt.min[2]=mt.max[2]=mt.center[2]=this._centerAltitude))},pt=(tt,St)=>{if(.707*St<tt)return 1;const mt=St/tt;return mt/(1.4144271570014144+(Math.pow(1.1,mt-1.4144271570014144+1)-1)/(1.1-1)-1)},Lt=tt=>{if(tt.zoom<Me)return!0;if(tt.zoom===ot)return!1;if(tt.shouldSplit!=null)return tt.shouldSplit;const St=tt.aabb.distanceX(he),mt=tt.aabb.distanceY(he);let Gt=yt,It=1;if(Z){Gt=tt.aabb.distanceZ(he);const Sn=Math.pow(2,tt.zoom),bn=i.aS((tt.y+1)/Sn),Ln=i.aS(tt.y/Sn),kn=Math.min(Math.max(N,bn),Ln),Mr=i.c9(kn)/i.c9(N);if(It=kn===N?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,Mr/this._mercatorScaleRatio),this.zoom<=i.c6&&tt.zoom===ot-1&&Mr>=.9)return!0}else if(w&&(Gt=tt.aabb.distanceZ(he)*se),this.projection.isReprojectedInTileSpace&&m<=5){const Sn=Math.pow(2,tt.zoom),bn=De(new i.aa((tt.x+.5)/Sn,(tt.y+.5)/Sn));It=bn>.85?1:bn}if(!A){const Sn=Math.sqrt(St*St+mt*mt+Gt*Gt);let bn=(1<<ot-tt.zoom)*Pe*It;return bn*=pt(Math.max(Gt,yt),Sn),Sn<bn}let At=Number.MAX_VALUE,zt=0;const Wt=tt.aabb.getCorners(),on=[];for(const Sn of Wt){i.ab.vec3.sub(on,Sn,he),Z||(w?on[2]*=se:on[2]=yt);const bn=i.ab.vec3.dot(on,this._camera.forward());bn<At&&(At=bn,zt=Math.abs(on[2]))}let dn=(1<<ot-tt.zoom)*Pe*It;if(dn*=pt(Math.max(zt,yt),At),At<dn)return!0;const En=tt.aabb.closestPoint($);return En[0]===$[0]&&En[1]===$[1]};if(this.renderWorldCopies)for(let tt=1;tt<=3;tt++)Xe.push($e(-tt)),Xe.push($e(tt));for(Xe.push($e(0));Xe.length>0;){const tt=Xe.pop(),St=tt.x,mt=tt.y;let Gt=tt.fullyVisible;const It=()=>this.projection.name==="globe"&&(tt.y===0||tt.y===(1<<tt.zoom)-1);if(!Gt){let At=Te?tt.aabb.intersects(te):tt.aabb.intersectsFlat(te);if(At===0&&It()){const zt=new i.bT(tt.zoom,St,mt);At=i.bU(this,U,zt,!0).intersects(te)}if(At===0)continue;Gt=At===2}if(tt.zoom!==ot&&Lt(tt))for(let At=0;At<4;At++){const zt=(St<<1)+At%2,Wt=(mt<<1)+(At>>1),on={aabb:A?tt.aabb.quadrant(At):i.bV(this,U,tt.zoom+1,zt,Wt,tt.wrap,tt.minZ,tt.maxZ,this.projection),zoom:tt.zoom+1,x:zt,y:Wt,wrap:tt.wrap,fullyVisible:Gt,tileID:void 0,shouldSplit:void 0,minZ:tt.minZ,maxZ:tt.maxZ};w&&!Z&&(on.tileID=new i.aG(tt.zoom+1===ot?Et:tt.zoom+1,tt.wrap,tt.zoom+1,zt,Wt),nt(on)),Xe.push(on)}else{const At=tt.zoom===ot?Et:tt.zoom;if(r.minzoom&&r.minzoom>At)continue;let zt=0;if(!Gt){let En=Te?tt.aabb.intersectsPrecise(te):tt.aabb.intersectsPreciseFlat(te);if(En===0&&It()){const Sn=new i.bT(tt.zoom,St,mt);En=i.bU(this,U,Sn,!0).intersectsPrecise(te)}if(En===0)continue;if(r.calculateQuadrantVisibility)if(te.containsPoint(tt.aabb.center))zt=15;else for(let Sn=0;Sn<4;Sn++)tt.aabb.quadrant(Sn).intersects(te)!==0&&(zt|=1<<Sn)}const Wt=$[0]-(.5+St+(tt.wrap<<tt.zoom))*(1<<l-tt.zoom),on=$[1]-.5-mt,dn=tt.tileID?tt.tileID:new i.aG(At,tt.wrap,tt.zoom,St,mt);r.calculateQuadrantVisibility&&(dn.visibleQuadrants=zt),ht.push({tileID:dn,distanceSq:Wt*Wt+on*on})}}if(this.fogCullDistSq){const tt=this.fogCullDistSq,St=this.horizonLineFromTop();ht=ht.filter(mt=>{const Gt=[0,0,0,1],It=[i.ag,i.ag,0,1],At=this.calculateFogTileMatrix(mt.tileID.toUnwrapped());i.ab.vec4.transformMat4(Gt,Gt,At),i.ab.vec4.transformMat4(It,It,At);const zt=i.ab.vec4.min([],Gt,It),Wt=i.ab.vec4.max([],Gt,It),on=i.bW(zt,Wt);if(on===0)return!0;let dn=!1;const En=this._elevation;if(En&&on>tt&&St!==0){const Sn=this.calculateProjMatrix(mt.tileID.toUnwrapped());let bn;r.isTerrainDEM||(bn=En.getMinMaxForTile(mt.tileID)),bn||(bn={min:Re,max:Fe});const Ln=i.c7(this.rotation),kn=[Ln[0]*i.ag,Ln[1]*i.ag,bn.max];i.ab.vec3.transformMat4(kn,kn,Sn),dn=(1-kn[1])*this.height*.5<St}return on<tt||dn})}return ht.sort((tt,St)=>tt.distanceSq-St.distanceSq).map(tt=>tt.tileID)}resize(r,l){this.width=r,this.height=l,this.pixelsToGLUnits=[2/r,-2/l],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(r){return Math.pow(2,r)}scaleZoom(r){return Math.log(r)/Math.LN2}project(r){const l=i.aw(r.lat,-i.bX,i.bX),m=this.projection.project(r.lng,l);return new i.P(m.x*this.worldSize,m.y*this.worldSize)}unproject(r){return this.projection.unproject(r.x/this.worldSize,r.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/i.bH(1,this.center.lat)/this.worldSize}setLocationAtPoint(r,l){let m,x;const w=this.centerPoint;if(this.projection.name==="globe"){const D=this.worldSize;m=(l.x-w.x)/D,x=(l.y-w.y)/D}else{const D=this.pointCoordinate(l),N=this.pointCoordinate(w);m=D.x-N.x,x=D.y-N.y}const A=this.locationCoordinate(r);this.setLocation(new i.aa(A.x-m,A.y-x))}setLocation(r){this.center=this.coordinateLocation(r),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(r){return this.projection.locationPoint(this,r)}locationPoint3D(r){return this.projection.locationPoint(this,r,!0)}pointLocation(r){return this.coordinateLocation(this.pointCoordinate(r))}pointLocation3D(r){return this.coordinateLocation(this.pointCoordinate3D(r))}locationCoordinate(r,l){const m=l?i.bH(l,r.lat):void 0,x=this.projection.project(r.lng,r.lat);return new i.aa(x.x,x.y,m)}coordinateLocation(r){return this.projection.unproject(r.x,r.y)}pointRayIntersection(r,l){const m=l??this._centerAltitude,x=[r.x,r.y,0,1],w=[r.x,r.y,1,1];i.ab.vec4.transformMat4(x,x,this.pixelMatrixInverse),i.ab.vec4.transformMat4(w,w,this.pixelMatrixInverse);const A=w[3];i.ab.vec4.scale(x,x,1/x[3]),i.ab.vec4.scale(w,w,1/A);const D=x[2],N=w[2];return{p0:x,p1:w,t:D===N?0:(m-D)/(N-D)}}screenPointToMercatorRay(r){const l=[r.x,r.y,0,1],m=[r.x,r.y,1,1];return i.ab.vec4.transformMat4(l,l,this.pixelMatrixInverse),i.ab.vec4.transformMat4(m,m,this.pixelMatrixInverse),i.ab.vec4.scale(l,l,1/l[3]),i.ab.vec4.scale(m,m,1/m[3]),l[2]=i.bH(l[2],this._center.lat)*this.worldSize,m[2]=i.bH(m[2],this._center.lat)*this.worldSize,i.ab.vec4.scale(l,l,1/this.worldSize),i.ab.vec4.scale(m,m,1/this.worldSize),new i.aq([l[0],l[1],l[2]],i.ab.vec3.normalize([],i.ab.vec3.sub([],m,l)))}rayIntersectionCoordinate(r){const{p0:l,p1:m,t:x}=r,w=i.bH(l[2],this._center.lat),A=i.bH(m[2],this._center.lat);return new i.aa(i.af(l[0],m[0],x)/this.worldSize,i.af(l[1],m[1],x)/this.worldSize,i.af(w,A,x))}pointCoordinate(r,l=this._centerAltitude){return this.projection.pointCoordinate(this,r.x,r.y,l)}pointCoordinate3D(r){if(!this.elevation)return this.pointCoordinate(r);let l=this.projection.pointCoordinate3D(this,r.x,r.y);if(l)return new i.aa(l[0],l[1],l[2]);let m=0,x=this.horizonLineFromTop();if(r.y>x)return this.pointCoordinate(r);const w=.02*x,A=r.clone();for(let D=0;D<10&&x-m>w;D++){A.y=i.af(m,x,.66);const N=this.projection.pointCoordinate3D(this,A.x,A.y);N?(x=A.y,l=N):m=A.y}return l?new i.aa(l[0],l[1],l[2]):this.pointCoordinate(r)}isPointAboveHorizon(r){return this.projection.isPointAboveHorizon(this,r)}isPointOnSurface(r){if(r.y<0||r.y>this.height||r.x<0||r.x>this.width)return!1;if(this.elevation||this.zoom>=i.bY)return!this.isPointAboveHorizon(r);const l=this.pointCoordinate(r);return l.y>=0&&l.y<=1}_coordinatePoint(r,l){const m=l&&this.elevation?this.elevation.getAtPointOrZero(r,this._centerAltitude):this._centerAltitude,x=[r.x*this.worldSize,r.y*this.worldSize,m+r.toAltitude(),1];return i.ab.vec4.transformMat4(x,x,this.pixelMatrix),x[3]>0?new i.P(x[0]/x[3],x[1]/x[3]):new i.P(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:r,left:l}=this._edgeInsets,m=this.height-this._edgeInsets.bottom,x=this.width-this._edgeInsets.right,w=this.pointLocation3D(new i.P(l,r)),A=this.pointLocation3D(new i.P(x,r)),D=this.pointLocation3D(new i.P(x,m)),N=this.pointLocation3D(new i.P(l,m));let U=Math.min(w.lng,A.lng,D.lng,N.lng),$=Math.max(w.lng,A.lng,D.lng,N.lng),Z=Math.min(w.lat,A.lat,D.lat,N.lat),W=Math.max(w.lat,A.lat,D.lat,N.lat);const te=Math.pow(2,-this.zoom)/16*270,ue=this.projection.name==="globe"?1:4,se=(de,he,Te,Pe,Me)=>{const Fe=(de+Te)/2,Re=(he+Pe)/2,ze=new i.P(Fe,Re),{lng:De,lat:$e}=this.pointLocation3D(ze),Xe=Math.max(0,U-De,Z-$e,De-$,$e-W);U=Math.min(U,De),$=Math.max($,De),Z=Math.min(Z,$e),W=Math.max(W,$e),(Me<ue||Xe>te)&&(se(de,he,Fe,Re,Me+1),se(Fe,Re,Te,Pe,Me+1))};if(se(l,r,x,r,1),se(x,r,x,m,1),se(x,m,l,m,1),se(l,m,l,r,1),this.projection.name==="globe"){const[de,he]=i.bZ(this);de?(W=90,$=180,U=-180):he&&(Z=-90,$=180,U=-180)}return new i.az(new i.bO(U,Z),new i.bO($,W))}_getBoundsRectangular(r,l){const{top:m,left:x}=this._edgeInsets,w=this.height-this._edgeInsets.bottom,A=this.width-this._edgeInsets.right,D=new i.P(x,m),N=new i.P(A,m),U=new i.P(A,w),$=new i.P(x,w);let Z=this.pointCoordinate(D,r),W=this.pointCoordinate(N,r);const te=this.pointCoordinate(U,l),ue=this.pointCoordinate($,l),se=(de,he)=>(he.y-de.y)/(he.x-de.x);return Z.y>1&&W.y>=0?Z=new i.aa((1-ue.y)/se(ue,Z)+ue.x,1):Z.y<0&&W.y<=1&&(Z=new i.aa(-ue.y/se(ue,Z)+ue.x,0)),W.y>1&&Z.y>=0?W=new i.aa((1-te.y)/se(te,W)+te.x,1):W.y<0&&Z.y<=1&&(W=new i.aa(-te.y/se(te,W)+te.x,0)),new i.az().extend(this.coordinateLocation(Z)).extend(this.coordinateLocation(W)).extend(this.coordinateLocation(ue)).extend(this.coordinateLocation(te))}_getBoundsRectangularTerrain(){const r=this.elevation;if(!r.visibleDemTiles.length||r.isUsingMockSource())return this._getBoundsRectangular(0,0);const l=r.visibleDemTiles.reduce((m,x)=>{if(x.dem){const w=x.dem.tree;m.min=Math.min(m.min,w.minimums[0]),m.max=Math.max(m.max,w.maximums[0])}return m},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(l.min*r.exaggeration(),l.max*r.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(r=!0){const l=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))-this.centerOffset.y,m=this.height/2-l*(1-this._horizonShift);return r?Math.max(0,m):m}getMaxBounds(){return this.maxBounds}setMaxBounds(r){this.maxBounds=r,this.minLat=-i.bX,this.maxLat=i.bX,this.minLng=-180,this.maxLng=180,r&&(this.minLat=r.getSouth(),this.maxLat=r.getNorth(),this.minLng=r.getWest(),this.maxLng=r.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=i.at(this.minLng)*this.tileSize,this.worldMaxX=i.at(this.maxLng)*this.tileSize,this.worldMinY=i.aA(this.maxLat)*this.tileSize,this.worldMaxY=i.aA(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(r,l){return this.projection.createTileMatrix(this,l,r)}calculateDistanceTileData(r){const l=r.key,m=this._distanceTileDataCache;if(m[l])return m[l];const x=r.canonical,w=1/this.height,A=this.cameraWorldSize,D=A/this.zoomScale(x.z),N=(x.x+Math.pow(2,x.z)*r.wrap)*D,U=x.y*D,$=this.point;$.x*=A/this.worldSize,$.y*=A/this.worldSize;const Z=this.angle,W=Math.sin(-Z),te=-Math.cos(-Z);return m[l]={bearing:[W,te],center:[($.x-N)*w,($.y-U)*w],scale:D/i.ag*w},m[l]}calculateFogTileMatrix(r){const l=r.key,m=this._fogTileMatrixCache;if(m[l])return m[l];const x=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,r);return i.ab.mat4.multiply(x,this.worldToFogMatrix,x),m[l]=new Float32Array(x),m[l]}calculateProjMatrix(r,l=!1,m=!1){const x=r.key;let w;if(w=m?this._expandedProjMatrixCache:l?this._alignedProjMatrixCache:this._projMatrixCache,w[x])return w[x];const A=this.calculatePosMatrix(r,this.worldSize);let D;return D=this.projection.isReprojectedInTileSpace?this.mercatorMatrix:m?this.expandedFarZProjMatrix:l?this.alignedProjMatrix:this.projMatrix,i.ab.mat4.multiply(A,D,A),w[x]=new Float32Array(A),w[x]}calculatePixelsToTileUnitsMatrix(r){const l=r.tileID.key,m=this._pixelsToTileUnitsCache;if(m[l])return m[l];const x=i.b_(r,this);return m[l]=x,m[l]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const r=1/this.worldSize,l=i.ab.mat4.fromScaling([],[r,r,r]);return i.ab.mat4.multiply(l,l,this.globeMatrix),l}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const r=this._elevation;this._updateCameraState();const l=i.bH(1,this._center.lat)*this.worldSize,m=this._computeCameraPosition(l),x=this._camera.forward(),w=i.bH(1,this._center.lat);m[2]/=w,x[2]/=w,i.ab.vec3.normalize(x,x);const A=r.raycast(m,x,r.exaggeration());if(A){const D=i.ab.vec3.scaleAndAdd([],m,x,A),N=new i.aa(D[0],D[1],i.bH(D[2],i.aS(D[1]))),U=(N.z+i.ab.vec3.length([N.x-m[0],N.y-m[1],N.z-m[2]*w]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(U),this._centerAltitude=N.toAltitude(),this._center=this.coordinateLocation(N),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(r=!1){if(!this._elevation)return;const l=this._elevation,m=i.bH(1,this._center.lat)*this.worldSize,x=this._computeCameraPosition(m),w=l.getAtPointOrZero(new i.aa(...x)),A=this.pixelsPerMeter/this.worldSize*w,D=this._minimumHeightOverTerrain(),N=x[2]-A;if(N<=D)if(N<0||r){const U=this.locationCoordinate(this._center,this._centerAltitude),$=[x[0],x[1],U.z-x[2]],Z=i.ab.vec3.length($);$[2]-=(D-N)/this._pixelsPerMercatorPixel;const W=i.ab.vec3.length($);if(W===0)return;i.ab.vec3.scale($,$,Z/W*this._pixelsPerMercatorPixel),this._camera.position=[x[0],x[1],U.z*this._pixelsPerMercatorPixel-$[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const r=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||r){const W=this.center;return W.lat=i.aw(W.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!r)&&(W.lng=i.aw(W.lng,this.minLng,this.maxLng)),this.center=W,void(this._constraining=!1)}const l=this._unmodified,{x:m,y:x}=this.point;let w=0,A=m,D=x;const N=this.width/2,U=this.height/2,$=this.worldMinY*this.scale,Z=this.worldMaxY*this.scale;if(x-U<$&&(D=$+U),x+U>Z&&(D=Z-U),Z-$<this.height&&(w=Math.max(w,this.height/(Z-$)),D=(Z+$)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const W=this.worldMinX*this.scale,te=this.worldMaxX*this.scale,ue=this.worldSize/2-(W+te)/2;A=(m+ue+this.worldSize)%this.worldSize-ue,A-N<W&&(A=W+N),A+N>te&&(A=te-N),te-W<this.width&&(w=Math.max(w,this.width/(te-W)),A=(te+W)/2)}A===m&&D===x||(this.center=this.unproject(new i.P(A,D))),w&&(this.zoom+=this.scaleZoom(w)),this._constrainCamera(),this._unmodified=l,this._constraining=!1}_minZoomForBounds(){let r=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(r=Math.max(r,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),r}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const r=this.centerOffset,l=this.projection.name==="globe",m=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=i.bH(1,this.center.lat)/i.bH(1,i.c8));const x=i.b$(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,x),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const w=this.projection.zAxisUnit==="meters"?m:1,A=this._camera.getWorldToCamera(this.worldSize,w);let D;const N=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);if(N[8]=2*-r.x/this.width,N[9]=2*r.y/this.height,this.isOrthographic){let $e=.5*this.height/Math.tan(this._fov/2)*1*Math.tan(.5*this._fov),Xe=$e*this.aspect,ht=-Xe,ot=-$e;Xe-=r.x,ht-=r.x,$e+=r.y,ot+=r.y,D=this._camera.getCameraToClipOrthographic(ht,Xe,ot,$e,this._nearZ,this._farZ),((Et,yt,nt,pt)=>{for(let Lt=0;Lt<16;Lt++)Et[Lt]=fp(yt[Lt],nt[Lt],pt)})(D,D,N,qf(this.pitch>=15?1:this.pitch/15))}else D=N;const U=i.ab.mat4.mul([],N,A);let $=i.ab.mat4.mul([],D,A);if(this.projection.isReprojectedInTileSpace){const $e=this.locationCoordinate(this.center),Xe=i.ab.mat4.identity([]);i.ab.mat4.translate(Xe,Xe,[$e.x*this.worldSize,$e.y*this.worldSize,0]),i.ab.mat4.multiply(Xe,Xe,i.c0(this)),i.ab.mat4.translate(Xe,Xe,[-$e.x*this.worldSize,-$e.y*this.worldSize,0]),i.ab.mat4.multiply($,$,Xe),i.ab.mat4.multiply(U,U,Xe),this.inverseAdjustmentMatrix=i.c1(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];if(this.mercatorMatrix=i.ab.mat4.scale([],$,[this.worldSize,this.worldSize,this.worldSize/w,1]),this.projMatrix=$,this.invProjMatrix=i.ab.mat4.invert(new Float64Array(16),this.projMatrix),l){const $e=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,1/0);$e[8]=2*-r.x/this.width,$e[9]=2*r.y/this.height,this.expandedFarZProjMatrix=i.ab.mat4.mul([],$e,A)}else this.expandedFarZProjMatrix=this.projMatrix;const Z=i.ab.mat4.invert([],D);this.frustumCorners=i.c2.fromInvProjectionMatrix(Z,this.horizonLineFromTop(),this.height),this.cameraFrustum=i.bR.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,0,!l);const W=new Float32Array(16);i.ab.mat4.identity(W),i.ab.mat4.scale(W,W,[1,-1,1]),i.ab.mat4.rotateX(W,W,this._pitch),i.ab.mat4.rotateZ(W,W,this.angle);const te=i.ab.mat4.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ);this.starsProjMatrix=i.ab.mat4.clone(te);const ue=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;te[8]=2*-r.x/this.width,te[9]=2*(r.y+ue)/this.height,this.skyboxMatrix=i.ab.mat4.multiply(W,te,W);const se=this.point,de=se.x,he=se.y,Te=this.width%2/2,Pe=this.height%2/2,Me=Math.cos(this.angle),Fe=Math.sin(this.angle),Re=de-Math.round(de)+Me*Te+Fe*Pe,ze=he-Math.round(he)+Me*Pe+Fe*Te,De=new Float64Array($);if(i.ab.mat4.translate(De,De,[Re>.5?Re-1:Re,ze>.5?ze-1:ze,0]),this.alignedProjMatrix=De,$=i.ab.mat4.create(),i.ab.mat4.scale($,$,[this.width/2,-this.height/2,1]),i.ab.mat4.translate($,$,[1,-1,0]),this.labelPlaneMatrix=$,$=i.ab.mat4.create(),i.ab.mat4.scale($,$,[1,-1,1]),i.ab.mat4.translate($,$,[-1,-1,0]),i.ab.mat4.scale($,$,[2/this.width,2/this.height,1]),this.glCoordMatrix=$,this.pixelMatrix=i.ab.mat4.multiply(new Float64Array(16),this.labelPlaneMatrix,U),this._calcFogMatrices(),this._distanceTileDataCache={},$=i.ab.mat4.invert(new Float64Array(16),this.pixelMatrix),!$)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=$,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=i.c3(this);const $e=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=i.ab.vec3.transformMat4($e,$e,A),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=$;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={},this._expandedProjMatrixCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const r=this.cameraWorldSizeForFog,l=this.cameraPixelsPerMeter,m=this._camera.position,x=1/this.height/this._pixelsPerMercatorPixel,w=[r,r,l];i.ab.vec3.scale(w,w,x),i.ab.vec3.scale(m,m,-1),i.ab.vec3.multiply(m,m,w);const A=i.ab.mat4.create();i.ab.mat4.translate(A,A,m),i.ab.mat4.scale(A,A,w),this.mercatorFogMatrix=A,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(r,l,x)}_computeCameraPosition(r){const l=(r=r||this.pixelsPerMeter)/this.pixelsPerMeter,m=this._camera.forward(),x=this.point,w=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*l-r/this.worldSize*this._centerAltitude;return[x.x/this.worldSize-m[0]*w,x.y/this.worldSize-m[1]*w,r/this.worldSize*this._centerAltitude-m[2]*w]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(r){const l=this._maxCameraBoundsDistance()*Math.cos(this._pitch),m=this._camera.position[2],x=r[2];let w=1;this.projection.wrap&&(this.center=this.center.wrap()),x>0&&(w=Math.min((l-m)/x,1)),this._camera.position=i.ab.vec3.scaleAndAdd([],this._camera.position,r,w),this._updateStateFromCamera()}_updateStateFromCamera(){const r=this._camera.position,l=this._camera.forward(),{pitch:m,bearing:x}=this._camera.getPitchBearing(),w=i.bH(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,A=this._mercatorZfromZoom(this._maxZoom)*Math.cos(i.ai(this._maxPitch)),D=Math.max((r[2]-w)/Math.cos(m),A),N=this._zoomFromMercatorZ(D);i.ab.vec3.scaleAndAdd(r,r,l,D),this._pitch=i.aw(m,i.ai(this.minPitch),i.ai(this.maxPitch)),this.angle=i.bF(x,-Math.PI,Math.PI),this._setZoom(i.aw(N,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new i.aa(r[0],r[1],r[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(r){return Math.pow(2,r)*this.tileSize}_mercatorZfromZoom(r){return this.cameraToCenterDistance/this._worldSizeFromZoom(r)}_minimumHeightOverTerrain(){const r=Math.min(this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom,this._maxZoom)+4;return this._mercatorZfromZoom(r)}_zoomFromMercatorZ(r){return this.scaleZoom(this.cameraToCenterDistance/(r*this.tileSize))}zoomFromMercatorZAdjusted(r){let l=0,m=i.bY,x=0,w=1/0;for(;m-l>1e-6&&m>l;){const A=l+.5*(m-l),D=this.tileSize*Math.pow(2,A),N=this.getCameraToCenterDistance(this.projection,A,D),U=this.scaleZoom(N/(r*this.tileSize)),$=Math.abs(A-U);$<w&&(w=$,x=A),A<U?l=A:m=A}return x}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(i.w("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(r,l){const m=Math.min(r.x,l.x),x=Math.max(r.x,l.x),w=Math.min(r.y,l.y),A=Math.max(r.y,l.y);if(w<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const D=[new i.P(m,w),new i.P(x,A),new i.P(m,A),new i.P(x,w)],N=this.renderWorldCopies?-3:0,U=this.renderWorldCopies?4:1;for(const $ of D){const Z=this.pointRayIntersection($);if(Z.t<0)return!0;const W=this.rayIntersectionCoordinate(Z);if(W.x<N||W.y<0||W.x>U||W.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+i.c4(this.fovAboveCenter)>88||this.anyCornerOffEdge(new i.P(0,0),new i.P(this.width,this.height))}zoomDeltaToMovement(r,l){const m=i.ab.vec3.length(i.ab.vec3.sub([],this._camera.position,r)),x=this._zoomFromMercatorZ(m)+l;return m-this._mercatorZfromZoom(x)}getCameraPoint(){if(this.projection.name==="globe"){const r=function([l,m,x],w){const A=[l,m,x,1];i.ab.vec4.transformMat4(A,A,w);const D=A[3]=Math.max(A[3],1e-6);return A[0]/=D,A[1]/=D,A[2]/=D,A}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new i.P(r[0],r[1])}{const r=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new i.P(0,r))}}getCameraToCenterDistance(r,l=this.zoom,m=this.worldSize){const x=i.b$(r,l,this.width,this.height,1024),w=r.pixelSpaceConversion(this.center.lat,m,x);let A=.5/Math.tan(.5*this._fov)*this.height*w;return this.isOrthographic&&(A=fp(1,A,qf(this.pitch>=15?1:this.pitch/15))),A}getWorldToCameraMatrix(){const r=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&i.ab.mat4.multiply(r,r,this.globeMatrix),r}getFrustum(r){return i.bR.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,r,this.projection.zAxisUnit==="meters")}}const _c=(p,r)=>{if(r>0&&p.terrain&&i.w("Cutoff is currently disabled on terrain"),r<=0||p.terrain)return{shouldRenderCutoff:!1,uniformValues:{u_cutoff_params:[0,0,0,1]}};const l=p.transform,m=Math.max(Math.abs(l._zoom-(p.minCutoffZoom-1)),1),x=l.isLODDisabled(!1)?i.ac(60,45,l.pitch):i.ac(30,15,l.pitch),w=l._farZ-l._nearZ,A=r*l.height,D=((1-(N=x))*l.cameraToCenterDistance+N*(l._farZ+A))*m;var N;return{shouldRenderCutoff:x<1,uniformValues:{u_cutoff_params:[l._nearZ,l._farZ,(D-l._nearZ)/w,(D-A-l._nearZ)/w]}}},va={cascadeCount:2,normalOffset:3,shadowMapResolution:2048};class kl{constructor(r,l){this.aabb=r,this.lastCascade=l}}class Dm{add(r,l){const m=this.receivers[r.key];m!==void 0?(m.aabb.min[0]=Math.min(m.aabb.min[0],l.min[0]),m.aabb.min[1]=Math.min(m.aabb.min[1],l.min[1]),m.aabb.min[2]=Math.min(m.aabb.min[2],l.min[2]),m.aabb.max[0]=Math.max(m.aabb.max[0],l.max[0]),m.aabb.max[1]=Math.max(m.aabb.max[1],l.max[1]),m.aabb.max[2]=Math.max(m.aabb.max[2],l.max[2])):this.receivers[r.key]=new kl(l,null)}clear(){this.receivers={}}get(r){return this.receivers[r.key]}computeRequiredCascades(r,l,m){const x=i.cd.fromPoints(r.points);let w=0;for(const A in this.receivers){const D=this.receivers[A];if(!D||!x.intersectsAabb(D.aabb))continue;D.aabb.min=x.closestPoint(D.aabb.min),D.aabb.max=x.closestPoint(D.aabb.max);const N=D.aabb.getCorners();for(let U=0;U<m.length;U++){let $=!0;for(const Z of N){const W=[Z[0]*l,Z[1]*l,Z[2]];if(i.ab.vec3.transformMat4(W,W,m[U].matrix),W[0]<-1||W[0]>1||W[1]<-1||W[1]>1){$=!1;break}}if(D.lastCascade=U,w=Math.max(w,U),$)break}}return w+1}}class xa{constructor(r){this.painter=r,this._enabled=!1,this._shadowLayerCount=0,this._numCascadesToRender=0,this._cascades=[],this._groundShadowTiles=[],this._receivers=new Dm,this._depthMode=new Tn(r.context.gl.LEQUAL,Tn.ReadWrite,[0,1]),this._uniformValues={u_light_matrix_0:new Float32Array(16),u_light_matrix_1:new Float32Array(16),u_shadow_intensity:0,u_fade_range:[0,0],u_shadow_normal_offset:[1,1,1],u_shadow_texel_size:1,u_shadow_map_resolution:1,u_shadow_direction:[0,0,1],u_shadow_bias:[36e-5,.0012,.012],u_shadowmap_0:0,u_shadowmap_1:0},this._forceDisable=!1,this.useNormalOffset=!1,r.tp.registerParameter(this,["Shadows"],"_forceDisable",{label:"forceDisable"},()=>{this.painter.style.map.triggerRepaint()}),r.tp.registerParameter(va,["Shadows"],"cascadeCount",{min:1,max:2,step:1}),r.tp.registerParameter(va,["Shadows"],"normalOffset",{min:0,max:10,step:.05}),r.tp.registerParameter(va,["Shadows"],"shadowMapResolution",{min:32,max:2048,step:32}),r.tp.registerBinding(this,["Shadows"],"_numCascadesToRender",{readonly:!0,label:"numCascadesToRender"})}destroy(){for(const r of this._cascades)r.texture.destroy(),r.framebuffer.destroy();this._cascades=[]}updateShadowParameters(r,l){const m=this.painter;if(this._enabled=!1,this._shadowLayerCount=0,this._receivers.clear(),!l||!l.properties)return;const x=l.properties.get("shadow-intensity");if(!l.shadowsEnabled()||x<=0||(this._shadowLayerCount=m.style.order.reduce((ue,se)=>{const de=m.style._mergedLayers[se];return ue+(de.hasShadowPass()&&!de.isHidden(r.zoom)?1:0)},0),this._enabled=this._shadowLayerCount>0,!this.enabled))return;const w=m.context,A=va.shadowMapResolution,D=va.shadowMapResolution;if(this._cascades.length===0||va.shadowMapResolution!==this._cascades[0].texture.size[0]){this._cascades=[];for(let ue=0;ue<va.cascadeCount;++ue){const se=m._shadowMapDebug,de=w.gl,he=w.createFramebuffer(A,D,se,"texture"),Te=new i.T(w,{width:A,height:D,data:null},de.DEPTH_COMPONENT16);if(he.depthAttachment.set(Te.texture),se){const Pe=new i.T(w,{width:A,height:D,data:null},de.RGBA8);he.colorAttachment.set(Pe.texture)}this._cascades.push({framebuffer:he,texture:Te,matrix:[],far:0,boundingSphereRadius:0,frustum:new i.bR,scale:0})}}this.shadowDirection=gc(l);let N=0;if(r.elevation){const ue=r.elevation,se=[1e4,-1e4];ue.visibleDemTiles.filter(de=>de.dem).forEach(de=>{const he=de.dem.tree;se[0]=Math.min(se[0],he.minimums[0]),se[1]=Math.max(se[1],he.maximums[0])}),se[0]!==1e4&&(N=(se[1]-se[0])*ue.exaggeration())}const U=1.5*r.cameraToCenterDistance,$=3*U,Z=new Float64Array(16);for(let ue=0;ue<this._cascades.length;++ue){const se=this._cascades[ue];let de=r.height/50,he=1;va.cascadeCount===1?he=$:ue===0?he=U:(de=U,he=$);const[Te,Pe]=a_(r,this.shadowDirection,de,he,va.shadowMapResolution,N);se.scale=r.scale,se.matrix=Te,se.boundingSphereRadius=Pe,i.ab.mat4.invert(Z,se.matrix),se.frustum=i.bR.fromInvProjectionMatrix(Z,1,0,!0),se.far=he}const W=this._cascades.length-1;this._uniformValues.u_fade_range=[.75*this._cascades[W].far,this._cascades[W].far],this._uniformValues.u_shadow_intensity=x,this._uniformValues.u_shadow_direction=[this.shadowDirection[0],this.shadowDirection[1],this.shadowDirection[2]],this._uniformValues.u_shadow_texel_size=1/va.shadowMapResolution,this._uniformValues.u_shadow_map_resolution=va.shadowMapResolution,this._uniformValues.u_shadowmap_0=aa.ShadowMap0,this._uniformValues.u_shadowmap_1=aa.ShadowMap0+1,this._groundShadowTiles=m.transform.coveringTiles({tileSize:512,renderWorldCopies:!0});const te=m.transform.elevation;for(const ue of this._groundShadowTiles){let se={min:0,max:0};if(te){const de=te.getMinMaxForTile(ue);de&&(se=de)}this.addShadowReceiver(ue.toUnwrapped(),se.min,se.max)}}get enabled(){return this._enabled&&!this._forceDisable}set enabled(r){this._enabled=r}drawShadowPass(r,l){if(!this.enabled)return;const m=this.painter,x=m.context;this._numCascadesToRender=this._receivers.computeRequiredCascades(m.transform.getFrustum(0),m.transform.worldSize,this._cascades),x.viewport.set([0,0,va.shadowMapResolution,va.shadowMapResolution]);for(let w=0;w<this._numCascadesToRender;++w){m.currentShadowCascade=w,x.bindFramebuffer.set(this._cascades[w].framebuffer.framebuffer),x.clear({color:i.aj.white,depth:1});for(const A of r.order){const D=r._mergedLayers[A];if(!D.hasShadowPass()||D.isHidden(m.transform.zoom))continue;const N=r.getLayerSourceCache(D),U=N?l[N.id]:void 0;(D.type==="model"||U&&U.length)&&m.renderLayer(m,N,D,U)}}m.currentShadowCascade=0}drawGroundShadows(){if(!this.enabled)return;const r=this.painter,l=r.style,m=r.context,x=l.directionalLight,w=l.ambientLight;if(!x||!w)return;const A=[],D=_c(r,r.longestCutoffRange);D.shouldRenderCutoff&&A.push("RENDER_CUTOFF"),A.push("RENDER_SHADOWS","DEPTH_TEXTURE"),this.useNormalOffset&&A.push("NORMAL_OFFSET");const N=dp(l,x,w),U=new Tn(m.gl.LEQUAL,Tn.ReadOnly,r.depthRangeFor3D);for(const $ of this._groundShadowTiles){const Z=$.toUnwrapped(),W=r.isTileAffectedByFog($),te=r.getOrCreateProgram("groundShadow",{defines:A,overrideFog:W});this.setupShadows(Z,te),r.uploadCommonUniforms(m,te,Z,null,D);const ue={u_matrix:r.transform.calculateProjMatrix(Z),u_ground_shadow_factor:N};te.draw(r,m.gl.TRIANGLES,U,Dn.disabled,Jn.multiply,Rn.disabled,ue,"ground_shadow",r.tileExtentBuffer,r.quadTriangleIndexBuffer,r.tileExtentSegments,{},r.transform.zoom,null,null)}}getShadowPassColorMode(){return this.painter._shadowMapDebug?Jn.unblended:Jn.disabled}getShadowPassDepthMode(){return this._depthMode}getShadowCastingLayerCount(){return this._shadowLayerCount}calculateShadowPassMatrixFromTile(r){const l=this.painter.transform,m=l.calculatePosMatrix(r,l.worldSize);return i.ab.mat4.multiply(m,this._cascades[this.painter.currentShadowCascade].matrix,m),Float32Array.from(m)}calculateShadowPassMatrixFromMatrix(r){return i.ab.mat4.multiply(r,this._cascades[this.painter.currentShadowCascade].matrix,r),Float32Array.from(r)}setupShadows(r,l,m,x=0){if(!this.enabled)return;const w=this.painter.transform,A=this.painter.context,D=A.gl,N=this._uniformValues,U=new Float64Array(16),$=w.calculatePosMatrix(r,w.worldSize);for(let Z=0;Z<this._cascades.length;Z++)i.ab.mat4.multiply(U,this._cascades[Z].matrix,$),N[Z===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(U),A.activeTexture.set(D.TEXTURE0+aa.ShadowMap0+Z),this._cascades[Z].texture.bind(D.NEAREST,D.CLAMP_TO_EDGE);if(this.useNormalOffset=!!m,this.useNormalOffset){const Z=i.cc(r.canonical),W=2/w.tileSize*i.ag/va.shadowMapResolution,te=W*this._cascades[0].boundingSphereRadius,ue=W*this._cascades[this._cascades.length-1].boundingSphereRadius,se=(m==="vector-tile"?1:3)/Math.pow(2,x-r.canonical.z-(1-w.zoom+Math.floor(w.zoom)));N.u_shadow_normal_offset=[Z,te*se,ue*se],N.u_shadow_bias=[6e-5,.0012,.012]}else N.u_shadow_bias=[36e-5,.0012,.012];l.setShadowUniformValues(A,N)}setupShadowsFromMatrix(r,l,m=!1){if(!this.enabled)return;const x=this.painter.context,w=x.gl,A=this._uniformValues,D=new Float64Array(16);for(let N=0;N<va.cascadeCount;N++)i.ab.mat4.multiply(D,this._cascades[N].matrix,r),A[N===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(D),x.activeTexture.set(w.TEXTURE0+aa.ShadowMap0+N),this._cascades[N].texture.bind(w.NEAREST,w.CLAMP_TO_EDGE);if(this.useNormalOffset=m,m){const N=va.normalOffset;A.u_shadow_normal_offset=[1,N,N],A.u_shadow_bias=[6e-5,.0012,.012]}else A.u_shadow_bias=[36e-5,.0012,.012];l.setShadowUniformValues(x,A)}getShadowUniformValues(){return this._uniformValues}getCurrentCascadeFrustum(){return this._cascades[this.painter.currentShadowCascade].frustum}computeSimplifiedTileShadowVolume(r,l,m,x){if(x[2]>=0)return{};const w=function(N,U,$){const Z=$/(1<<N.canonical.z);return new i.cd([N.canonical.x*Z+N.wrap*$,N.canonical.y*Z+N.wrap*$,0],[(N.canonical.x+1)*Z+N.wrap*$,(N.canonical.y+1)*Z+N.wrap*$,U])}(r,l,m).getCorners(),A=l/-x[2];x[0]<0?(i.ab.vec3.add(w[0],w[0],[x[0]*A,0,0]),i.ab.vec3.add(w[3],w[3],[x[0]*A,0,0])):x[0]>0&&(i.ab.vec3.add(w[1],w[1],[x[0]*A,0,0]),i.ab.vec3.add(w[2],w[2],[x[0]*A,0,0])),x[1]<0?(i.ab.vec3.add(w[0],w[0],[0,x[1]*A,0]),i.ab.vec3.add(w[1],w[1],[0,x[1]*A,0])):x[1]>0&&(i.ab.vec3.add(w[2],w[2],[0,x[1]*A,0]),i.ab.vec3.add(w[3],w[3],[0,x[1]*A,0]));const D={};return D.vertices=w,D.planes=[Us(w[1],w[0],w[4]),Us(w[2],w[1],w[5]),Us(w[3],w[2],w[6]),Us(w[0],w[3],w[7])],D}addShadowReceiver(r,l,m){this._receivers.add(r,i.cd.fromTileIdAndHeight(r,l,m))}getMaxCascadeForTile(r){const l=this._receivers.get(r);return l&&l.lastCascade?l.lastCascade:0}}function Us(p,r,l){const m=i.ab.vec3.sub([],l,r),x=i.ab.vec3.sub([],p,r),w=i.ab.vec3.cross([],m,x),A=i.ab.vec3.length(w);return A===0?[0,0,1,0]:(i.ab.vec3.scale(w,w,1/A),[w[0],w[1],w[2],-i.ab.vec3.dot(w,r)])}function gc(p){const r=p.properties.get("direction"),l=i.cb(r.x,r.y,r.z);l[2]=i.aw(l[2],0,75);const m=i.ce([l[0],l[1],l[2]]);return i.ab.vec3.fromValues(m.x,m.y,m.z)}function dp(p,r,l){const m=r.properties.get("color-use-theme")==="none",x=r.properties.get("color"),w=r.properties.get("intensity"),A=r.properties.get("direction"),D=[A.x,A.y,A.z],N=l.properties.get("color-use-theme")==="none",U=l.properties.get("color"),$=l.properties.get("intensity"),Z=Math.max(i.ab.vec3.dot([0,0,1],D),0),W=[0,0,0];i.ab.vec3.scale(W,U.toRenderColor(N?null:p.getLut(r.scope)).toArray01Linear().slice(0,3),$);const te=[0,0,0];return i.ab.vec3.scale(te,x.toRenderColor(m?null:p.getLut(l.scope)).toArray01Linear().slice(0,3),Z*w),i.cf([W[0]>0?W[0]/(W[0]+te[0]):0,W[1]>0?W[1]/(W[1]+te[1]):0,W[2]>0?W[2]/(W[2]+te[2]):0])}function a_(p,r,l,m,x,w){const A=p.zoom,D=p.scale,N=p.worldSize,U=1/N,$=p.aspect,Z=Math.sqrt(1+$*$)*Math.tan(.5*p.fovX),W=Z*Z,te=m-l,ue=m+l;let se,de;W>te/ue?(se=m,de=m*Z):(se=.5*ue*(1+W),de=.5*Math.sqrt(te*te+2*(m*m+l*l)*W+ue*ue*W*W));const he=p.projection.pixelsPerMeter(p.center.lat,N),Te=p._camera.getCameraToWorldMercator(),Pe=[0,0,-se*U];i.ab.vec3.transformMat4(Pe,Pe,Te);let Me=de*U;const Fe=p._edgeInsets;if(!(Fe.left===0&&Fe.top===0&&Fe.right===0&&Fe.bottom===0||Fe.left===Fe.right&&Fe.top===Fe.bottom)){const Gt=p._camera.getWorldToCamera(p.worldSize,p.projection.zAxisUnit==="meters"?he:1),It=p._camera.getCameraToClipPerspective(p._fov,p.width/p.height,l,m);It[8]=2*-p.centerOffset.x/p.width,It[9]=2*p.centerOffset.y/p.height;const At=new Float64Array(16);i.ab.mat4.mul(At,It,Gt);const zt=new Float64Array(16);i.ab.mat4.invert(zt,At);const Wt=i.bR.fromInvProjectionMatrix(zt,N,A,!0);for(const on of Wt.points){const dn=((Re=on)[0]/=D,Re[1]/=D,Re[2]=i.bH(Re[2],p._center.lat),Re);Me=Math.max(Me,i.ab.vec3.len(i.ab.vec3.subtract([],Pe,dn)))}}var Re;Me*=x/(x-1);const ze=Math.acos(r[2]),De=Math.atan2(-r[0],-r[1]),$e=new Wa;$e.position=Pe,$e.setPitchBearing(ze,De);const Xe=$e.getWorldToCamera(N,he),ht=Me*N,ot=Math.min(p._mercatorZfromZoom(17)*N*-2,-2*ht),Et=$e.getCameraToClipOrthographic(-ht,ht,-ht,ht,ot,(ht+w*he)/r[2]),yt=new Float64Array(16);i.ab.mat4.multiply(yt,Et,Xe);const nt=i.ab.vec3.fromValues(Math.floor(1e6*Pe[0])/1e6*N,Math.floor(1e6*Pe[1])/1e6*N,0),pt=.5*x,Lt=[0,0,0];i.ab.vec3.transformMat4(Lt,nt,yt),i.ab.vec3.scale(Lt,Lt,pt);const tt=[Math.floor(Lt[0]),Math.floor(Lt[1]),Math.floor(Lt[2])],St=[0,0,0];i.ab.vec3.sub(St,Lt,tt),i.ab.vec3.scale(St,St,-1/pt);const mt=new Float64Array(16);return i.ab.mat4.identity(mt),i.ab.mat4.translate(mt,mt,St),i.ab.mat4.multiply(yt,mt,yt),[yt,ht]}class pp extends i.E{constructor(r){super(),this.requestManager=r,this.models={"":{}},this.modelUris={"":{}},this.numModelsLoading={}}loadModel(r,l){return i.aM(this.requestManager.transformRequest(l,i.R.Model).url).then(m=>{if(!m)return;const x=i.aN(m),w=new i.aO(r,void 0,void 0,x);return w.computeBoundsAndApplyParent(),w}).catch(m=>{if(m&&m.status===404)return null;this.fire(new i.y(new Error(`Could not load model ${r} from ${l}: ${m.message}`)))})}load(r,l,m={keepNumReferences:!1}){this.models[l]||(this.models[l]={});const x=Object.keys(r);this.numModelsLoading[l]=(this.numModelsLoading[l]||0)+x.length;const w=[];for(const A of x)w.push(this.loadModel(A,r[A]));Promise.allSettled(w).then(A=>{for(let D=0;D<A.length;D++){const{status:N,value:U}=A[D];if(N==="fulfilled"&&U){const $=this.models[l][x[D]];this.models[l][x[D]]={model:U,numReferences:m.keepNumReferences&&$?$.numReferences:1}}}this.numModelsLoading[l]-=x.length,this.fire(new i.z("data",{dataType:"style"}))}).catch(A=>{this.fire(new i.y(new Error(`Could not load models: ${A.message}`)))})}isLoaded(){for(const r in this.numModelsLoading)if(this.numModelsLoading[r]>0)return!1;return!0}hasModel(r,l){return!!this.getModel(r,l)}getModel(r,l){return this.models[l]||(this.models[l]={}),this.models[l][r]?this.models[l][r].model:void 0}addModel(r,l,m){this.models[m]||(this.models[m]={}),this.modelUris[m]||(this.modelUris[m]={}),this.hasModel(r,m)&&this.models[m][r].numReferences++,this.modelUris[m][r]=this.requestManager.normalizeModelURL(l),this.load({[r]:this.modelUris[m][r]},m)}addModels(r,l){this.models[l]||(this.models[l]={}),this.modelUris[l]||(this.modelUris[l]={});const m=this.modelUris[l];for(const x in r)this.models[l][x]={},m[x]=this.requestManager.normalizeModelURL(r[x]);this.load(m,l,{keepNumReferences:!0})}reloadModels(r){this.load(this.modelUris[r],r)}addModelsFromBucket(r,l){this.models[l]||(this.models[l]={}),this.modelUris[l]||(this.modelUris[l]={});const m={};for(const x of r)this.hasModel(x,l)?this.models[l][x].numReferences++:(this.modelUris[l][x]=this.requestManager.normalizeModelURL(x),m[x]=this.modelUris[l][x]);this.load(m,l)}removeModel(r,l){if(this.models[l]&&this.models[l][r]&&(this.models[l][r].numReferences--,this.models[l][r].numReferences===0)){const m=this.models[l][r].model;delete this.models[l][r],delete this.modelUris[l][r],m.destroy()}}listModels(r){return this.models[r]||(this.models[r]={}),Object.keys(this.models[r])}upload(r,l){this.models[l]||(this.models[l]={});for(const m in this.models[l])this.models[l][m].model&&this.models[l][m].model.upload(r.context)}}const Lm=new i.a5({data:new i.a6(i.a3.colorTheme.data)}),o_={"mbx-indoor-active-floorplans":{default:["literal",[]]},"mbx-indoor-underground":{default:["literal",!1]},"mbx-indoor-loaded-levels":{default:["literal",[]]},"mbx-indoor-level-height":{default:["literal",{}]},"mbx-indoor-level-base":{default:["literal",{}]},"mbx-indoor-level-selected":{default:["literal",{}]},"mbx-indoor-level-overlapped":{default:["literal",{}]}};function km(p){return p=p||{},Object.assign(p,o_)}class yc extends i.E{constructor(r){super(),this.mergeFloors=!0,this._scope=void 0,this._queryFeatureSetId=void 0,this._buildingEntryFeatureSetId=void 0,this._selectedFloorplan=void 0,this._indoorData=void 0,this._selectedLevel=void 0,this._floorplanStates={},i.aP(["_onLoad","_onMove","_checkFloorplanVisible"],this),this._map=r,this._checkFloorplanVisible(!0),this._map.on("load",this._onLoad),this._map.on("move",this._onMove)}destroy(){this._map.indoor.off("load",this._onLoad),this._map.indoor.off("move",this._onMove),this._map=void 0}_onLoad(){this._map.style.forEachFragmentStyle(r=>{r.stylesheet.indoor&&(this._queryFeatureSetId?this.fire(new i.y(new Error("Multiple indoor map styles detected, simultaneous usage is not allowed currently."))):(this._queryFeatureSetId=r.stylesheet.indoor.floorplanFeaturesetId,this._buildingEntryFeatureSetId=r.stylesheet.indoor.buildingFeaturesetId,this._scope=r.scope))}),this._queryFeatureSetId&&this._buildingEntryFeatureSetId&&this._map.addInteraction("mbx-indoor-buildingclick",{type:"click",target:{featuresetId:this._buildingEntryFeatureSetId,importId:this._scope},handler:r=>(r.feature&&r.feature.properties.floorplan&&this.selectFloorplan(r.feature.properties.floorplan),!0)}),this._checkFloorplanVisible(!0)}_onMove(){this._checkFloorplanVisible(!1)}_checkFloorplanVisible(r){if(!this._queryFeatureSetId||!this._map.isStyleLoaded()||this._map.transform.zoom<13)return;this._indoorData&&!function(A,D){const[N,U]=A,{center:$,radius:Z}=D,[W,te]=$,ue=Math.abs(N-W);return Math.sqrt((ue>180?360-ue:ue)**2+(U-te)**2)<=Z}([this._map.getCenter().lng,this._map.getCenter().lat],this._indoorData.circumCircle)&&(this._indoorData=void 0,this._selectedFloorplan=void 0,this._map.setConfigProperty(this._scope,"mbx-indoor-underground",!1),this._map.setConfigProperty(this._scope,"mbx-indoor-active-floorplans",["literal",[]]),this.fire(new i.z("floorplangone")));const l={target:{featuresetId:this._queryFeatureSetId,importId:this._scope}},m=new i.P(this._map.transform.width/2,this._map.transform.height/2),x=[new i.P(0,0),new i.P(this._map.transform.width,this._map.transform.height)],w=this._map.queryRenderedFeatures(r?x:m,l);w.length>0&&(this._selectedFloorplan&&w[0].properties.id===this._selectedFloorplan.properties.id||(this._selectedFloorplan=w[0],this._floorplanSelected(!1)))}_floorplanSelected(r){this._indoorData=JSON.parse(this._selectedFloorplan.properties["indoor-data"]),this._indoorData.id=this._selectedFloorplan.properties.id,this._indoorData.circumCircle=function(w){const[[A,D],[N,U]]=w,$=(N-A+360)%360,Z=$>180?360-$:$;return{center:[(A+Z/2+360)%360,(D+U)/2],radius:Math.sqrt(Z**2+(U-D)**2)/2}}(this._indoorData.extent),this._floorplanStates[this._indoorData.id]||(this._floorplanStates[this._indoorData.id]={});const l=this._floorplanStates[this._indoorData.id].selectedBuilding,m=this._floorplanStates[this._indoorData.id].selectedLevel;let x;if(this._map.setConfigProperty(this._scope,"mbx-indoor-active-floorplans",this._indoorData.floorplanIDs),this._selectedLevel)for(const w of this._indoorData.levels)w.id===this._selectedLevel.id&&(x=w.id);if(this.fire(new i.z("floorplanselected",{buildings:this._indoorData.buildings,levels:this._indoorData.levels,selectedLevelId:x})),l){const w=this._indoorData.buildings.find(A=>A.id===l);this._buildingSelected(w,!1)}else this._indoorData.buildings.length>0&&this._buildingSelected(this._indoorData.buildings[0],!1);if(m){const w=this._indoorData.levels.find(A=>A.id===m);this._updateLevels(w,r)}else r&&this._indoorData["default-levels"].length>0&&this.selectLevel(this._indoorData["default-levels"][0])}_buildingSelected(r,l){l&&r&&r.extent&&this._map.fitBounds(r.extent,{pitch:this._map.getPitch(),bearing:this._map.getBearing()}),this._floorplanStates[this._indoorData.id].selectedBuilding=r?r.id:void 0;const m=this._indoorData.levels.filter(x=>r.levels.includes(x.id));this.fire(new i.z("buildingselected",{buildingId:r.id,levels:m}))}_levelSelected(r){if(r==="overview")this._updateLevels(void 0,!0);else{const l=this._indoorData.levels.find(m=>m.id===r);this._updateLevels(l,!0)}this.fire(new i.z("levelselected",{levelId:r==="overview"?void 0:r}))}_updateLevels(r,l){if(!r)return this._map.setConfigProperty(this._scope,"mbx-indoor-loaded-levels",["literal",[]]),this._map.setConfigProperty(this._scope,"mbx-indoor-underground",!1),this._floorplanStates[this._indoorData.id].selectedLevel=void 0,void(l&&this._indoorData.extent&&this._map.fitBounds(this._indoorData.extent,{pitch:this._map.getPitch(),bearing:this._map.getBearing()}));function m(U){const $=U.indexOf("/floor/");if($===-1)return U;const Z=$+7,W=U.indexOf("/",Z);return W===-1?U.slice(Z):U.slice(Z,W)}this._selectedLevel=r,this._floorplanStates[this._indoorData.id].selectedLevel=r?r.id:void 0;const x=[],w={},A={},D={},N={};for(const U of this._indoorData.levels)if(x.push(U.id),w[U.id]=U.height,A[U.id]=U.base,r){if(this.mergeFloors){const $=m(r.id),Z=m(U.id);D[U.id]=Z===$?"true":"false"}else D[U.id]=U.id===r.id?"true":"false";N[U.id]=U.base<r.base?"true":"false"}else N[U.id]=!0;if(this._map.setConfigProperty(this._scope,"mbx-indoor-loaded-levels",["literal",x]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-height",["literal",w]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-base",["literal",A]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-selected",["literal",D]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-overlapped",["literal",N]),r&&(this._map.setConfigProperty(this._scope,"mbx-indoor-underground",!!r.isUnderground),l&&r.extent)){const U=this._map.cameraForBounds(r.extent,{pitch:this._map.getPitch(),bearing:this._map.getBearing()}),$=this._map.getZoom(),Z=U.zoom?Math.abs($-U.zoom):0;this._map.fitBounds(r.extent,Z>=1?{pitch:this._map.getPitch(),bearing:this._map.getBearing()}:{pitch:this._map.getPitch(),bearing:this._map.getBearing(),zoom:$})}}selectFloorplan(r){const l={target:{featuresetId:this._queryFeatureSetId,importId:this._scope}},m=[new i.P(0,0),new i.P(this._map.transform.width,this._map.transform.height)],x=this._map.queryRenderedFeatures(m,l);if(x.length>0){for(const w of x)if(JSON.parse(w.properties["indoor-data"]).floorplanIDs.includes(r)){this._selectedFloorplan=w,this._floorplanSelected(!0);break}}}selectBuilding(r){const l=this._indoorData.buildings.find(m=>m.id===r);this._buildingSelected(l,!0)}selectLevel(r){this._levelSelected(r)}}function zm(p){if(!p.metadata||!p.metadata.content_area)return;const r=i.q.devicePixelRatio,{left:l,top:m,width:x,height:w}=p.metadata.content_area,A=l*r,D=m*r;return[A,D,A+x*r,D+w*r]}function bh(p){if(p)return p.map(([r,l])=>[r*i.q.devicePixelRatio,l*i.q.devicePixelRatio])}const zl=(p,r)=>Ds(p,r&&r.filter(l=>l.identifier!=="source.canvas")),s_=i.ay(Kn,["addLayer","removeLayer","setLights","setPaintProperty","setLayoutProperty","setSlot","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setSnow","setRain","setProjection","setCamera","addImport","removeImport","updateImport"]),vc=i.ay(Kn,["setCenter","setZoom","setBearing","setPitch"]),xc=new Set(["background","sky","slot","custom"]),xu={version:8,layers:[],sources:{}},Bm={duration:300,delay:0};class La extends i.E{constructor(r,l={}){super(),this.map=r,this.scope=l.scope||"",this.globalId=null,this.fragments=[],this.importDepth=l.importDepth||0,this.importsCache=l.importsCache||new Map,this.resolvedImports=l.resolvedImports||new Set,this.transition=i.l({},Bm),this._buildingIndex=new gu(this),this.crossTileSymbolIndex=new cp,this._mergedOrder=[],this._drapedFirstOrder=[],this._mergedLayers={},this._mergedSourceCaches={},this._mergedOtherSourceCaches={},this._mergedSymbolSourceCaches={},this._clipLayerPresent=!1,this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this._changes=l.styleChanges||new Dr,this.dispatcher=l.dispatcher?l.dispatcher:new i.D(i.ci(),this),l.imageManager?this.imageManager=l.imageManager:(this.imageManager=new Pr(this.map._spriteFormat),this.imageManager.setEventedParent(this)),this.imageManager.createScope(this.scope),this.glyphManager=l.glyphManager?l.glyphManager:new i.cj(r._requestManager,l.localFontFamily?i.ck.all:l.localIdeographFontFamily?i.ck.ideographs:i.ck.none,l.localFontFamily||l.localIdeographFontFamily),l.modelManager?this.modelManager=l.modelManager:(this.modelManager=new pp(r._requestManager),this.modelManager.setEventedParent(this)),this._layers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._precompileDone=!1,this._shouldPrecompile=!1,this._availableImages=[],this._order=[],this._markersNeedUpdate=!1,this.options=l.configOptions?l.configOptions:new Map,this._configDependentLayers=l.configDependentLayers?l.configDependentLayers:new Set,this._config=l.config,this._styleColorTheme={lut:null,lutLoading:!1,lutLoadingCorrelationID:0,colorTheme:null,colorThemeOverride:l.colorThemeOverride},this._styleColorThemeForScope={},this._initialConfig=l.initialConfig,this.dispatcher.broadcast("setReferrer",i.cl());const m=this;this._rtlTextPluginCallback=La.registerForPluginStateChange(x=>{m.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:x.pluginStatus,pluginURL:x.pluginURL},(w,A)=>{if(i.cm(w),A&&A.every(D=>D))for(const D in m._sourceCaches){const N=m._sourceCaches[D],U=N.getSource().type;U!=="vector"&&U!=="geojson"||N.reload()}})}),this.on("data",x=>{if(x.dataType!=="source"||x.sourceDataType!=="metadata")return;const w=this.getOwnSource(x.sourceId);if(w&&w.vectorLayerIds)for(const A in this._layers){const D=this._layers[A];D.source===w.id&&this._validateLayer(D)}})}load(r){return r?(typeof r=="string"?this.loadURL(r):this.loadJSON(r),this):this}_getGlobalId(r){if(!r)return null;if(typeof r=="string"){if(i.f(r))return r;const l=i.cn(r);if(!l.startsWith("http"))try{return new URL(l,location.href).toString()}catch{return l}return l}return`json://${i.co(JSON.stringify(r))}`}_diffStyle(r,l,m){this.globalId=this._getGlobalId(r);const x=(w,A)=>{try{A(null,this.setState(w,m))}catch(D){A(D,!1)}};if(typeof r=="string"){const w=this.map._requestManager.normalizeStyleURL(r),A=this.map._requestManager.transformRequest(w,i.R.Style);i.n(A,(D,N)=>{D?this.fire(new i.y(D)):N&&x(N,l)})}else typeof r=="object"&&x(r,l)}loadURL(r,l={}){this.fire(new i.z("dataloading",{dataType:"style"}));const m=typeof l.validate=="boolean"?l.validate:!i.f(r);this.globalId=this._getGlobalId(r),r=this.map._requestManager.normalizeStyleURL(r,l.accessToken),this.resolvedImports.add(r);const x=this.importsCache.get(r);if(x)return this._load(x,m);const w=this.map._requestManager.transformRequest(r,i.R.Style);this._request=i.n(w,(A,D)=>{if(this._request=null,A)this.fire(new i.y(A));else if(D)return this.importsCache.set(r,D),this._load(D,m)})}loadJSON(r,l={}){this.fire(new i.z("dataloading",{dataType:"style"})),this.globalId=this._getGlobalId(r),this._request=i.q.frame(()=>{this._request=null,this._load(r,l.validate!==!1)})}loadEmpty(){this.fire(new i.z("dataloading",{dataType:"style"})),this._load(xu,!1)}_loadImports(r,l,m){if(this.importDepth>=4)return i.w("Style doesn't support nesting deeper than 5"),Promise.resolve();const x=[];for(const w of r){const A=this._createFragmentStyle(w),D=new Promise($=>{A.once("style.import.load",$),A.once("error",$)}).then(()=>this.mergeAll());if(x.push(D),this.resolvedImports.has(w.url)){A.loadEmpty();continue}const N=w.data||this.importsCache.get(w.url);N?(A.loadJSON(N,{validate:l}),this._isInternalStyle(N)&&(A.globalId=null)):w.url?A.loadURL(w.url,{validate:l}):A.loadEmpty();const U={style:A,id:w.id,config:w.config};if(m){const $=this.fragments.findIndex(({id:Z})=>Z===m);this.fragments=this.fragments.slice(0,$).concat(U).concat(this.fragments.slice($))}else this.fragments.push(U)}return Promise.allSettled(x)}getImportGlobalIds(r=this,l=new Set){for(const m of r.fragments)m.style.globalId&&l.add(m.style.globalId),this.getImportGlobalIds(m.style,l);return[...l.values()]}_createFragmentStyle(r){const l=this.scope?i.aC(r.id,this.scope):r.id;let m;const x=this._initialConfig&&this._initialConfig[l];(r.config||x)&&(m=i.l({},r.config,x));const w=new La(this.map,{scope:l,styleChanges:this._changes,importDepth:this.importDepth+1,importsCache:this.importsCache,resolvedImports:new Set(this.resolvedImports),dispatcher:this.dispatcher,imageManager:this.imageManager,glyphManager:this.glyphManager,modelManager:this.modelManager,config:m,configOptions:this.options,colorThemeOverride:r["color-theme"],configDependentLayers:this._configDependentLayers});return w.setEventedParent(this.map,{style:w}),w}_reloadImports(){this.mergeAll(),this._updateMapProjection(),this.updateConfigDependencies(),this.map._triggerCameraUpdate(this.camera),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),this._shouldPrecompile=this.map._precompilePrograms&&this.isRootStyle()}_isInternalStyle(r){return this.isRootStyle()&&(r.fragment||!!r.schema&&r.fragment!==!1)}_load(r,l){const m=r.indoor?km(r.schema):r.schema;if(this._isInternalStyle(r)){const A=i.l({},xu,{imports:[{id:"basemap",data:r,url:""}]});return void this._load(A,l)}if(this.updateConfig(this._config,m),l&&zl(this,Za(r)))return;this._loaded=!0,this.stylesheet=i.cp(r);const x=()=>{for(const U in r.sources)this.addSource(U,r.sources[U],{validate:!1,isInitialLoad:!0});r.sprite?this._loadIconset(r.sprite):(this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0})),this.glyphManager.setURL(r.glyphs,this.scope);const A=Lf(this.stylesheet.layers);if(this._order=A.map(U=>U.id),this.stylesheet.light&&i.w("The `light` root property is deprecated, prefer using `lights` with `flat` light type instead."),this.stylesheet.lights)if(this.stylesheet.lights.length===1&&this.stylesheet.lights[0].type==="flat"){const U=this.stylesheet.lights[0];this.light=new le(U.properties,U.id)}else this.setLights(this.stylesheet.lights);this.light||(this.light=new le(this.stylesheet.light)),this._layers={};for(const U of A){const $=i.cu(U,this.scope,this._styleColorTheme.lut,this.options);$.configDependencies.size!==0&&this._configDependentLayers.add($.fqid),$.setEventedParent(this,{layer:{id:$.id}}),this._layers[$.id]=$;const Z=this.getOwnLayerSourceCache($),W=!!this.directionalLight&&this.directionalLight.shadowsEnabled();Z&&$.canCastShadows()&&W&&(Z.castsShadows=!0)}this.stylesheet.featuresets&&this.setFeaturesetSelectors(this.stylesheet.featuresets),this.stylesheet.models&&this.modelManager.addModels(this.stylesheet.models,this.scope);const D=this.stylesheet.terrain;D&&(this.checkCanvasFingerprintNoise(),this.disableElevatedTerrain||this.terrainSetForDrapingOnly()||this._createTerrain(D,1)),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this.stylesheet.snow&&this._createSnow(this.stylesheet.snow),this.stylesheet.rain&&this._createRain(this.stylesheet.rain),this.stylesheet.transition&&this.setTransition(this.stylesheet.transition),this.fire(new i.z("data",{dataType:"style"}));const N=this.isRootStyle();r.imports?this._loadImports(r.imports,l).then(()=>{this._reloadImports(),this.fire(new i.z(N?"style.load":"style.import.load"))}):(this._reloadImports(),this.fire(new i.z(N?"style.load":"style.import.load")))};this._styleColorTheme.colorTheme=this.stylesheet["color-theme"];const w=this._styleColorTheme.colorThemeOverride?this._styleColorTheme.colorThemeOverride:this._styleColorTheme.colorTheme;if(w){const A=this._evaluateColorThemeData(w);this._loadColorTheme(A).then(()=>{x()}).catch(D=>{i.w(`Couldn't load color theme from the stylesheet: ${D}`),x()})}else this._styleColorTheme.lut=null,x()}isRootStyle(){return this.importDepth===0}mergeAll(){let r,l,m,x,w,A,D,N,U,$;const Z={};this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(W=>{if(W.stylesheet){if(W.light!=null&&(r=W.light),W.stylesheet.lights)for(const te of W.stylesheet.lights)te.type==="ambient"&&W.ambientLight!=null&&(l=W.ambientLight),te.type==="directional"&&W.directionalLight!=null&&(m=W.directionalLight);x=this._prioritizeTerrain(x,W.terrain,W.stylesheet.terrain),W.stylesheet.fog&&W.fog!=null&&(w=W.fog),W.stylesheet.snow&&W.snow!=null&&(A=W.snow),W.stylesheet.rain&&W.rain!=null&&(D=W.rain),W.stylesheet.camera!=null&&($=W.stylesheet.camera),W.stylesheet.projection!=null&&(N=W.stylesheet.projection),W.stylesheet.transition!=null&&(U=W.stylesheet.transition),Z[W.scope]=W._styleColorTheme}}),this.light=r,this.ambientLight=l,this.directionalLight=m,this.fog=w,this.snow=A,this.rain=D,this._styleColorThemeForScope=Z,x===null?delete this.terrain:this.terrain=x,this.camera=$||{"camera-projection":"perspective"},this.projection=N||{name:"mercator"},this.transition=i.l({},Bm,U),this.mergeSources(),this.mergeLayers()}forEachFragmentStyle(r){const l=m=>{for(const x of m.fragments)l(x.style);r(m)};l(this)}_prioritizeTerrain(r,l,m){const x=r&&r.drapeRenderMode===0;return m===null?l&&l.drapeRenderMode===0?l:x?r:null:l!=null&&(!r||x||l&&l.drapeRenderMode===1)?l:r}mergeTerrain(){let r;this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(l=>{r=this._prioritizeTerrain(r,l.terrain,l.stylesheet.terrain)}),r===null?delete this.terrain:this.terrain=r}mergeProjection(){let r;this.forEachFragmentStyle(l=>{l.stylesheet.projection!=null&&(r=l.stylesheet.projection)}),this.projection=r||{name:"mercator"}}mergeSources(){const r={},l={},m={};this.forEachFragmentStyle(x=>{for(const w in x._sourceCaches){const A=i.aC(w,x.scope);r[A]=x._sourceCaches[w]}for(const w in x._otherSourceCaches){const A=i.aC(w,x.scope);l[A]=x._otherSourceCaches[w]}for(const w in x._symbolSourceCaches){const A=i.aC(w,x.scope);m[A]=x._symbolSourceCaches[w]}}),this._mergedSourceCaches=r,this._mergedOtherSourceCaches=l,this._mergedSymbolSourceCaches=m}mergeLayers(){const r={},l=[],m={};this._mergedSlots=[],this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this.forEachFragmentStyle(w=>{for(const A of w._order){const D=w._layers[A];if(D.type==="slot"){const N=i.cq(A);if(r[N])continue;r[N]=[]}D.slot&&r[D.slot]?r[D.slot].push(D):l.push(D)}}),this._mergedOrder=[];const x=(w=[])=>{for(const A of w)if(A.type==="slot"){const D=i.cq(A.id);r[D]&&x(r[D]),this._mergedSlots.push(D)}else{const D=i.aC(A.id,A.scope);this._mergedOrder.push(D),m[D]=A,A.is3D()&&(this._has3DLayers=!0),A.type==="circle"&&(this._hasCircleLayers=!0),A.type==="symbol"&&(this._hasSymbolLayers=!0),A.type==="clip"&&(this._clipLayerPresent=!0)}};x(l),this._mergedOrder.sort((w,A)=>{const D=m[w],N=m[A];return D.hasInitialOcclusionOpacityProperties?N.is3D()?1:0:D.is3D()&&N.hasInitialOcclusionOpacityProperties?-1:0}),this._mergedLayers=m,this.updateDrapeFirstLayers(),this._buildingIndex.processLayersChanged()}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}getCamera(){return this.stylesheet.camera}setCamera(r){return this.stylesheet.camera=i.l({},this.stylesheet.camera,r),this.camera=this.stylesheet.camera,this}_evaluateColorThemeData(r){return r.data?function(l,m,x){const w=i.l({},m);for(const D of Object.keys(i.a3.colorTheme))w[D]===void 0&&(w[D]=i.a3.colorTheme[D].default);const A=new i.a4(Lm,l,new Map(x));return A.setTransitionOrValue(w,x),A.untransitioned().possiblyEvaluate(new i.a8(0))}(this.scope,r,this.options).get("data"):null}_loadColorTheme(r){this._styleColorTheme.lutLoading=!0,this._styleColorTheme.lutLoadingCorrelationID+=1;const l=this._styleColorTheme.lutLoadingCorrelationID;return new Promise((m,x)=>{const w="data:image/png;base64,";if(!r||r.length===0)return this._styleColorTheme.lut=null,this._styleColorTheme.lutLoading=!1,void m();let A=r;A.startsWith(w)||(A=w+A);const D="mapbox-reserved-lut",N=new Image;N.src=A,N.onerror=()=>{this._styleColorTheme.lutLoading=!1,x(new Error("Failed to load image data"))},N.onload=()=>{if(this._styleColorTheme.lutLoadingCorrelationID!==l)return void m();this._styleColorTheme.lutLoading=!1;const{width:U,height:$,data:Z}=i.q.getImageData(N);if($>32)return void x(new Error("The height of the image must be less than or equal to 32 pixels."));if(U!==$*$)return void x(new Error("The width of the image must be equal to the height squared."));this.getImage(D)&&this.removeImage(D),this.addImage(D,{data:new i.r({width:U,height:$},Z),pixelRatio:1,sdf:!1,usvg:!1,version:0});const W=this.imageManager.getImage(D,this.scope);W?(this._styleColorTheme.lut={image:W.data,data:r},m()):x(new Error("Missing LUT image."))}})}getLut(r){const l=this._styleColorThemeForScope[r];return l?l.lut:null}setProjection(r){r?this.stylesheet.projection=r:delete this.stylesheet.projection,this.mergeProjection(),this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?(this.getTerrain()||this.stylesheet.terrain)&&!this.disableElevatedTerrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null,0))}_updateMapProjection(){this.isRootStyle()&&(this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.projection))}_loadSprite(r){this._spriteRequest=function(l,m,x){let w,A,D;const N=i.q.devicePixelRatio>1?"@2x":"";let U=i.n(m.transformRequest(m.normalizeSpriteURL(l,N,".json"),i.R.SpriteJSON),(W,te)=>{U=null,D||(D=W,w=te,Z())}),$=i.o(m.transformRequest(m.normalizeSpriteURL(l,N,".png"),i.R.SpriteImage),(W,te)=>{$=null,D||(D=W,A=te,Z())});function Z(){if(D)x(D);else if(w&&A){const W=i.q.getImageData(A),te={};for(const ue in w){const{width:se,height:de,x:he,y:Te,sdf:Pe,pixelRatio:Me,stretchX:Fe,stretchY:Re,content:ze}=w[ue],De=new i.r({width:se,height:de});i.r.copy(W,De,{x:he,y:Te},{x:0,y:0},{width:se,height:de},null),te[ue]={data:De,pixelRatio:Me,sdf:Pe,stretchX:Fe,stretchY:Re,content:ze,usvg:!1}}x(null,te)}}return{cancel(){U&&(U.cancel(),U=null),$&&($.cancel(),$=null)}}}(r,this.map._requestManager,(l,m)=>{if(this._spriteRequest=null,l)this.fire(new i.y(l));else if(m)for(const x in m)this.imageManager.addImage(x,this.scope,m[x]);this.imageManager.setLoaded(!0,this.scope),this._availableImages=this.imageManager.listImages(this.scope),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new i.z("data",{dataType:"style"}))})}_loadIconset(r){if(!i.f(r)&&this.map._spriteFormat!=="icon_set"||this.map._spriteFormat==="raster")return void this._loadSprite(r);const l=this.map._spriteFormat==="auto";var m,x;this._spriteRequest=(x=(w,A)=>{if(this._spriteRequest=null,w)l?this._loadSprite(r):this.fire(new i.y(w));else if(A)for(const D in A)this.imageManager.addImage(D,this.scope,A[D]);this.imageManager.setLoaded(!0,this.scope),this._availableImages=this.imageManager.listImages(this.scope),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new i.z("data",{dataType:"style"}))},i.bi((m=this.map._requestManager).transformRequest(m.normalizeIconsetURL(r),i.R.Iconset),(w,A)=>{if(w)return void x(w);const D={},N=i.cg(new i.bh(A));for(const U of N.icons){const $={version:1,pixelRatio:i.q.devicePixelRatio,content:zm(U),stretchX:U.metadata?bh(U.metadata.stretch_x_areas):void 0,stretchY:U.metadata?bh(U.metadata.stretch_y_areas):void 0,sdf:!1,usvg:!0,icon:U};D[U.name]=$}x(null,D)}))}_validateLayer(r){const l=this.getOwnSource(r.source);if(!l)return;const m=r.sourceLayer;m&&(l.type==="geojson"||l.vectorLayerIds&&l.vectorLayerIds.indexOf(m)===-1)&&this.fire(new i.y(new Error(`Source layer "${m}" does not exist on source "${l.id}" as specified by style layer "${r.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._changes.getUpdatedSourceCaches()).length)return!1;for(const r in this._sourceCaches)if(!this._sourceCaches[r].loaded())return!1;if(!this.imageManager.isLoaded()||!this.modelManager.isLoaded()||this._styleColorTheme.lutLoading)return!1;for(const{style:r}of this.fragments)if(!r.loaded())return!1;return!0}_serializeImports(){if(this.stylesheet.imports)return this.stylesheet.imports.map((r,l)=>{const m=this.fragments[l];return m&&m.style&&(r.data=m.style.serialize()),r})}_serializeSources(){const r={};for(const l in this._sourceCaches){const m=this._sourceCaches[l].getSource();r[m.id]||(r[m.id]=m.serialize())}return r}_serializeLayers(r){const l=[];for(const m of r){const x=this._layers[m];x&&x.type!=="custom"&&l.push(x.serialize())}return l}hasLightTransitions(){return!(!this.light||!this.light.hasTransition())||!(!this.ambientLight||!this.ambientLight.hasTransition())||!(!this.directionalLight||!this.directionalLight.hasTransition())}hasFogTransition(){return!!this.fog&&this.fog.hasTransition()}hasSnowTransition(){return!!this.snow&&this.snow.hasTransition()}hasRainTransition(){return!!this.rain&&this.rain.hasTransition()}hasTransitions(){if(this.hasLightTransitions()||this.hasFogTransition()||this.hasSnowTransition()||this.hasRainTransition())return!0;for(const r in this._sourceCaches)if(this._sourceCaches[r].hasTransition())return!0;for(const r in this._layers)if(this._layers[r].hasTransition())return!0;return!1}get order(){return this.terrain?this._drapedFirstOrder:this._mergedOrder}_getOrder(r){return r?this.order:this._mergedOrder}isLayerDraped(r){return!!this.terrain&&r.isDraped(this.getLayerSourceCache(r))}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}_checkLayer(r){const l=this.getOwnLayer(r);if(l)return l;this.fire(new i.y(new Error(`The layer '${r}' does not exist in the map's style.`)))}_checkSource(r){const l=this.getOwnSource(r);if(l)return l;this.fire(new i.y(new Error(`The source '${r}' does not exist in the map's style.`)))}precompilePrograms(r,l){const m=this.map.painter;if(m)for(let x=r.minzoom||0;x<(r.maxzoom||25.5);x++){const w=r.getProgramIds();if(w)for(const A of w){const D=r.getDefaultProgramParams(A,l.zoom,this._styleColorTheme.lut);D&&(m.style=this,this.fog&&(m._fogVisible=!0,D.overrideFog=!0,m.getOrCreateProgram(A,D)),m._fogVisible=!1,D.overrideFog=!1,m.getOrCreateProgram(A,D),(this.stylesheet.terrain||this.stylesheet.projection&&this.stylesheet.projection.name==="globe")&&(D.overrideRtt=!0,m.getOrCreateProgram(A,D)))}}}update(r){if(!this._loaded)return;this.ambientLight&&this.ambientLight.recalculate(r),this.directionalLight&&this.directionalLight.recalculate(r);const l=this.calculateLightsBrightness();r.brightness=l||0,l!==this._brightness&&(this._brightness=l,this.dispatcher.broadcast("setBrightness",l));const m=this._changes.isDirty();let x=!1;if(this._changes.isDirty()){const A=this._changes.getLayerUpdatesByScope();for(const D in A){const{updatedIds:N,removedIds:U}=A[D];(N||U)&&(this._updateWorkerLayers(D,N,U),x=!0)}this.updateSourceCaches(),this._updateTilesForChangedImages(),this.updateLayers(r),this.light&&this.light.updateTransitions(r),this.ambientLight&&this.ambientLight.updateTransitions(r),this.directionalLight&&this.directionalLight.updateTransitions(r),this.fog&&this.fog.updateTransitions(r),this.snow&&this.snow.updateTransitions(r),this.rain&&this.rain.updateTransitions(r),this._changes.reset()}const w={};for(const A in this._mergedSourceCaches){const D=this._mergedSourceCaches[A];w[A]=D.used,D.used=!1,D.tileCoverLift=0}for(const A of this._mergedOrder){const D=this._mergedLayers[A];if(D.recalculate(r,this._availableImages),!D.isHidden(r.zoom)){const N=this.getLayerSourceCache(D);N&&(N.used=!0,N.tileCoverLift=Math.max(N.tileCoverLift,D.tileCoverLift()))}!this._precompileDone&&this._shouldPrecompile&&("requestIdleCallback"in window?requestIdleCallback(()=>{this.precompilePrograms(D,r)}):this.precompilePrograms(D,r))}this._shouldPrecompile&&(this._precompileDone=!0),this.terrain&&x&&this.mergeLayers();for(const A in w){const D=this._mergedSourceCaches[A];w[A]!==D.used&&D.getSource().fire(new i.z("data",{sourceDataType:"visibility",dataType:"source",sourceId:D.getSource().id}))}this.light&&this.light.recalculate(r),this.terrain&&this.terrain.recalculate(r),this.fog&&this.fog.recalculate(r),this.snow&&this.snow.recalculate(r),this.rain&&this.rain.recalculate(r),this.z=r.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),m&&this.fire(new i.z("data",{dataType:"style"}))}_updateTilesForChangedImages(){const r=this._changes.getUpdatedImages();if(r.length){for(const l in this._sourceCaches)this._sourceCaches[l].reloadTilesForDependencies(["icons","patterns"],r);this._changes.resetUpdatedImages()}}_updateWorkerLayers(r,l,m){const x=this.getFragmentStyle(r);x&&this.dispatcher.broadcast("updateLayers",{layers:l?x._serializeLayers(l):[],scope:r,removedIds:m||[],options:x.options})}setState(r,l){if(this._checkLoaded(),zl(this,Za(r)))return!1;(r=i.cp(r)).layers=Lf(r.layers);const m=function(A,D){if(!A)return[{command:Kn.setStyle,args:[D]}];let N=[];try{if(!i.bn(A.version,D.version))return[{command:Kn.setStyle,args:[D]}];if(i.bn(A.center,D.center)||N.push({command:Kn.setCenter,args:[D.center]}),i.bn(A.zoom,D.zoom)||N.push({command:Kn.setZoom,args:[D.zoom]}),i.bn(A.bearing,D.bearing)||N.push({command:Kn.setBearing,args:[D.bearing]}),i.bn(A.pitch,D.pitch)||N.push({command:Kn.setPitch,args:[D.pitch]}),i.bn(A.sprite,D.sprite)||N.push({command:Kn.setSprite,args:[D.sprite]}),i.bn(A.glyphs,D.glyphs)||N.push({command:Kn.setGlyphs,args:[D.glyphs]}),i.bn(A.imports,D.imports)||function(te=[],ue=[],se){ue=ue||[];const de=(te=te||[]).map(_a),he=ue.map(_a),Te=te.reduce(us,{}),Pe=ue.reduce(us,{}),Me=de.slice();let Fe,Re,ze,De;for(Fe=0,Re=0;Fe<de.length;Fe++)ze=de[Fe],Pe.hasOwnProperty(ze)?Re++:(se.push({command:Kn.removeImport,args:[ze]}),Me.splice(Me.indexOf(ze,Re),1));for(Fe=0,Re=0;Fe<he.length;Fe++)ze=he[he.length-1-Fe],Me[Me.length-1-Fe]!==ze&&(Te.hasOwnProperty(ze)?(se.push({command:Kn.removeImport,args:[ze]}),Me.splice(Me.lastIndexOf(ze,Me.length-Re),1)):Re++,De=Me[Me.length-Fe],se.push({command:Kn.addImport,args:[Pe[ze],De]}),Me.splice(Me.length-Fe,0,ze));for(const $e of ue){const Xe=Te[$e.id];Xe&&!i.bn(Xe,$e)&&se.push({command:Kn.updateImport,args:[$e.id,$e]})}}(A.imports,D.imports,N),i.bn(A.transition,D.transition)||N.push({command:Kn.setTransition,args:[D.transition]}),i.bn(A.light,D.light)||N.push({command:Kn.setLight,args:[D.light]}),i.bn(A.fog,D.fog)||N.push({command:Kn.setFog,args:[D.fog]}),i.bn(A.snow,D.snow)||N.push({command:Kn.setSnow,args:[D.snow]}),i.bn(A.rain,D.rain)||N.push({command:Kn.setRain,args:[D.rain]}),i.bn(A.projection,D.projection)||N.push({command:Kn.setProjection,args:[D.projection]}),i.bn(A.lights,D.lights)||N.push({command:Kn.setLights,args:[D.lights]}),i.bn(A.camera,D.camera)||N.push({command:Kn.setCamera,args:[D.camera]}),!i.bn(A["color-theme"],D["color-theme"]))return[{command:Kn.setStyle,args:[D]}];const U={},$=[];(function(te,ue,se,de){let he;for(he in ue=ue||{},te=te||{})te.hasOwnProperty(he)&&(ue.hasOwnProperty(he)||zs(he,se,de));for(he in ue){if(!ue.hasOwnProperty(he))continue;const Te=ue[he];te.hasOwnProperty(he)?i.bn(te[he],Te)||(te[he].type==="geojson"&&Te.type==="geojson"&&xr(te,ue,he)?se.push({command:Kn.setGeoJSONSourceData,args:[he,Te.data]}):_n(he,ue,se,de)):kf(he,ue,se)}})(A.sources,D.sources,$,U);const Z=[];A.layers&&A.layers.forEach(te=>{te.source&&U[te.source]?N.push({command:Kn.removeLayer,args:[te.id]}):Z.push(te)});let W=A.terrain;W&&U[W.source]&&(N.push({command:Kn.setTerrain,args:[void 0]}),W=void 0),N=N.concat($),i.bn(W,D.terrain)||N.push({command:Kn.setTerrain,args:[D.terrain]}),function(te,ue,se){ue=ue||[];const de=(te=te||[]).map(_a),he=ue.map(_a),Te=te.reduce(us,{}),Pe=ue.reduce(us,{}),Me=de.slice(),Fe=Object.create(null);let Re,ze,De,$e,Xe,ht,ot;for(Re=0,ze=0;Re<de.length;Re++)De=de[Re],Pe.hasOwnProperty(De)?ze++:(se.push({command:Kn.removeLayer,args:[De]}),Me.splice(Me.indexOf(De,ze),1));for(Re=0,ze=0;Re<he.length;Re++)De=he[he.length-1-Re],Me[Me.length-1-Re]!==De&&(Te.hasOwnProperty(De)?(se.push({command:Kn.removeLayer,args:[De]}),Me.splice(Me.lastIndexOf(De,Me.length-ze),1)):ze++,ht=Me[Me.length-Re],se.push({command:Kn.addLayer,args:[Pe[De],ht]}),Me.splice(Me.length-Re,0,De),Fe[De]=!0);for(Re=0;Re<he.length;Re++)if(De=he[Re],$e=Te[De],Xe=Pe[De],!Fe[De]&&!i.bn($e,Xe))if(i.bn($e.source,Xe.source)&&i.bn($e["source-layer"],Xe["source-layer"])&&i.bn($e.type,Xe.type)){for(ot in ar($e.layout,Xe.layout,se,De,null,Kn.setLayoutProperty),ar($e.paint,Xe.paint,se,De,null,Kn.setPaintProperty),i.bn($e.slot,Xe.slot)||se.push({command:Kn.setSlot,args:[De,Xe.slot]}),i.bn($e.filter,Xe.filter)||se.push({command:Kn.setFilter,args:[De,Xe.filter]}),i.bn($e.minzoom,Xe.minzoom)&&i.bn($e.maxzoom,Xe.maxzoom)||se.push({command:Kn.setLayerZoomRange,args:[De,Xe.minzoom,Xe.maxzoom]}),$e)$e.hasOwnProperty(ot)&&ot!=="layout"&&ot!=="paint"&&ot!=="filter"&&ot!=="metadata"&&ot!=="minzoom"&&ot!=="maxzoom"&&ot!=="slot"&&(ot.indexOf("paint.")===0?ar($e[ot],Xe[ot],se,De,ot.slice(6),Kn.setPaintProperty):i.bn($e[ot],Xe[ot])||se.push({command:Kn.setLayerProperty,args:[De,ot,Xe[ot]]}));for(ot in Xe)Xe.hasOwnProperty(ot)&&!$e.hasOwnProperty(ot)&&ot!=="layout"&&ot!=="paint"&&ot!=="filter"&&ot!=="metadata"&&ot!=="minzoom"&&ot!=="maxzoom"&&ot!=="slot"&&(ot.indexOf("paint.")===0?ar($e[ot],Xe[ot],se,De,ot.slice(6),Kn.setPaintProperty):i.bn($e[ot],Xe[ot])||se.push({command:Kn.setLayerProperty,args:[De,ot,Xe[ot]]}))}else se.push({command:Kn.removeLayer,args:[De]}),ht=Me[Me.lastIndexOf(De)+1],se.push({command:Kn.addLayer,args:[Xe,ht]})}(Z,D.layers,N)}catch(U){console.warn("Unable to compute style diff:",U),N=[{command:Kn.setStyle,args:[D]}]}return N}(this.serialize(),r).filter(A=>!(A.command in vc));if(m.length===0)return!1;const x=m.filter(A=>!(A.command in s_));if(x.length>0)throw new Error(`Unimplemented: ${x.map(A=>A.command).join(", ")}.`);const w=[];return m.forEach(A=>{w.push(this[A.command].apply(this,A.args))}),l&&Promise.all(w).then(l),this.stylesheet=r,this.mergeAll(),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),!0}addImage(r,l){return this.getImage(r)?this.fire(new i.y(new Error("An image with this name already exists."))):(this.imageManager.addImage(r,this.scope,l),this._afterImageUpdated(r),this)}updateImage(r,l,m=!1){this.imageManager.updateImage(r,this.scope,l),m&&this._afterImageUpdated(r)}getImage(r){return this.imageManager.getImage(r,this.scope)}removeImage(r){return this.getImage(r)?(this.imageManager.removeImage(r,this.scope),this._afterImageUpdated(r),this):this.fire(new i.y(new Error("No image with this name exists.")))}_afterImageUpdated(r){this._availableImages=this.imageManager.listImages(this.scope),this._changes.updateImage(r),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.fire(new i.z("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addModel(r,l,m={}){return this._checkLoaded(),this._validate(ph,`models.${r}`,l,null,m)||(this.modelManager.addModel(r,l,this.scope),this._changes.setDirty()),this}hasModel(r){return this.modelManager.hasModel(r,this.scope)}removeModel(r){return this.hasModel(r)?(this.modelManager.removeModel(r,this.scope),this):this.fire(new i.y(new Error("No model with this ID exists.")))}listModels(){return this._checkLoaded(),this.modelManager.listModels(this.scope)}addSource(r,l,m={}){if(this._checkLoaded(),this.getOwnSource(r)!==void 0)throw new Error(`There is already a source with ID "${r}".`);if(!l.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(l).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(l.type)>=0&&this._validate(as,`sources.${r}`,l,null,m))return;this.map&&this.map._collectResourceTiming&&(l.collectResourceTiming=!0);const x=di(r,l,this.dispatcher,this);x.scope=this.scope,x.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(x.id),source:x.serialize(),sourceId:x.id}));const w=A=>{const D=(A?"symbol:":"other:")+x.id,N=i.aC(D,this.scope),U=this._sourceCaches[D]=new cs(N,x,A);(A?this._symbolSourceCaches:this._otherSourceCaches)[x.id]=U,U.onAdd(this.map)};w(!1),l.type!=="vector"&&l.type!=="geojson"||w(!0),x.onAdd&&x.onAdd(this.map),m.isInitialLoad||(this.mergeSources(),this._changes.setDirty())}removeSource(r){this._checkLoaded();const l=this.getOwnSource(r);if(!l)throw new Error("There is no source with this ID");for(const x in this._layers)if(this._layers[x].source===r)return this.fire(new i.y(new Error(`Source "${r}" cannot be removed while layer "${x}" is using it.`)));if(this.terrain&&this.terrain.scope===this.scope&&this.terrain.get().source===r)return this.fire(new i.y(new Error(`Source "${r}" cannot be removed while terrain is using it.`)));const m=this.getOwnSourceCaches(r);for(const x of m){const w=i.cq(x.id);delete this._sourceCaches[w],this._changes.discardSourceCacheUpdate(x.id),x.fire(new i.z("data",{sourceDataType:"metadata",dataType:"source",sourceId:x.getSource().id})),x.setEventedParent(null),x.clearTiles()}return delete this._otherSourceCaches[r],delete this._symbolSourceCaches[r],this.mergeSources(),l.setEventedParent(null),l.onRemove&&l.onRemove(this.map),this._changes.setDirty(),this}setGeoJSONSourceData(r,l){this._checkLoaded(),this.getOwnSource(r).setData(l),this._changes.setDirty()}getOwnSource(r){const l=this.getOwnSourceCache(r);return l&&l.getSource()}getOwnSources(){const r=[];for(const l in this._otherSourceCaches){const m=this.getOwnSourceCache(l);m&&r.push(m.getSource())}return r}areTilesLoaded(){const r=this._mergedSourceCaches;for(const l in r){const m=r[l]._tiles;for(const x in m){const w=m[x];if(w.state!=="loaded"&&w.state!=="errored")return!1}}return!0}setLights(r){if(this._checkLoaded(),!r)return delete this.ambientLight,void delete this.directionalLight;const l=this._getTransitionParameters();for(const x of r){if(this._validate(Al,"lights",x))return;switch(x.type){case"ambient":if(this.ambientLight){const w=this.ambientLight;w.set(x),w.updateTransitions(l)}else this.ambientLight=new On(x,Zt||(Zt=new i.a5({color:new i.a6(i.a3.properties_light_ambient.color),"color-use-theme":new i.a6({type:"string",default:"default","property-type":"data-constant"}),intensity:new i.a6(i.a3.properties_light_ambient.intensity)})),this.scope,this.options);break;case"directional":if(this.directionalLight){const w=this.directionalLight;w.set(x),w.updateTransitions(l)}else this.directionalLight=new On(x,Xt||(Xt=new i.a5({direction:new i.ak(i.a3.properties_light_directional.direction),color:new i.a6(i.a3.properties_light_directional.color),"color-use-theme":new i.a6({type:"string",default:"default","property-type":"data-constant"}),intensity:new i.a6(i.a3.properties_light_directional.intensity),"cast-shadows":new i.a6(i.a3.properties_light_directional["cast-shadows"]),"shadow-quality":new i.a6(i.a3.properties_light_directional["shadow-quality"]),"shadow-intensity":new i.a6(i.a3.properties_light_directional["shadow-intensity"])})),this.scope,this.options)}}const m=new i.a8(this.z||0,l);this.ambientLight&&this.ambientLight.recalculate(m),this.directionalLight&&this.directionalLight.recalculate(m),this._brightness=this.calculateLightsBrightness(),this.dispatcher.broadcast("setBrightness",this._brightness)}calculateLightsBrightness(){const r=this.directionalLight,l=this.ambientLight;if(!r||!l)return;const m=W=>.2126*(W[0]<=.03928?W[0]/12.92:Math.pow((W[0]+.055)/1.055,2.4))+.7152*(W[1]<=.03928?W[1]/12.92:Math.pow((W[1]+.055)/1.055,2.4))+.0722*(W[2]<=.03928?W[2]/12.92:Math.pow((W[2]+.055)/1.055,2.4)),x=r.properties.get("color").toRenderColor(null).toArray01(),w=r.properties.get("intensity"),A=r.properties.get("direction"),D=1-i.cb(A.x,A.y,A.z)[2]/90,N=m(x)*w*D,U=l.properties.get("color").toRenderColor(null).toArray01(),$=l.properties.get("intensity"),Z=m(U)*$;return Number(((N+Z)/2).toFixed(6))}getBrightness(){return this._brightness}getLights(){if(!this.enable3dLights())return null;const r=[];return this.directionalLight&&r.push(this.directionalLight.get()),this.ambientLight&&r.push(this.ambientLight.get()),r}enable3dLights(){return!!this.ambientLight&&!!this.directionalLight}getFragmentStyle(r){if(!r)return this;if(i.cr(r)){const l=i.cs(r),m=this.fragments.find(({id:w})=>w===l);if(!m)throw new Error(`Style import '${r}' not found`);const x=i.cq(r);return m.style.getFragmentStyle(x)}{const l=this.fragments.find(({id:m})=>m===r);return l?l.style:void 0}}setFeaturesetSelectors(r){if(!r)return;const l={},m=(x,w="")=>`${x}::${w}`;this._featuresetSelectors={};for(const x in r){const w=this._featuresetSelectors[x]=[];for(const A of r[x].selectors){if(A.featureNamespace){const N=this.getOwnLayer(A.layer);if(!N){i.w(`Layer is undefined for selector: ${A.layer}`);continue}const U=m(N.source,N.sourceLayer);if(U in l&&l[U]!==A.featureNamespace){i.w(`"featureNamespace ${A.featureNamespace} of featureset ${x}'s selector is not associated to the same source, skip this selector`);continue}l[U]=A.featureNamespace}let D;if(A.properties)for(const N in A.properties){const U=i.U(A.properties[N]);U.result==="success"&&(D=D||{},D[N]=U.value)}w.push({layerId:A.layer,namespace:A.featureNamespace,properties:D,uniqueFeatureID:A._uniqueFeatureID})}}}getFeaturesetDescriptors(r){const l=this.getFragmentStyle(r);if(!l||!l.stylesheet.featuresets)return[];const m=[];for(const x in l.stylesheet.featuresets)m.push({featuresetId:x,importId:l.scope?l.scope:void 0});return m}getFeaturesetLayers(r,l){const m=this.getFragmentStyle(l),x=m.stylesheet.featuresets;if(!x||!x[r])return this.fire(new i.y(new Error(`The featureset '${r}' does not exist in the map's style and cannot be queried.`))),[];const w=[];for(const A of x[r].selectors){const D=m.getOwnLayer(A.layer);D&&w.push(D)}return w}getConfigProperty(r,l){const m=this.getFragmentStyle(r);if(!m)return null;const x=i.aC(l,m.scope),w=m.options.get(x),A=w?w.value||w.default:null;return A?A.serialize():null}setConfigProperty(r,l,m){const x=this.getFragmentStyle(r);if(!x)return;const w=x.stylesheet.indoor?km(x.stylesheet.schema):x.stylesheet.schema;if(!w||!w[l])return;const A=i.U(m);if(A.result!=="success")return void zl(this,A.value);const D=A.value.expression,N=i.aC(l,x.scope),U=x.options.get(N);if(!U)return;let $;const{minValue:Z,maxValue:W,stepValue:te,type:ue,values:se}=w[l],de=i.U(w[l].default);de.result==="success"&&($=de.value.expression),$?(this.options.set(N,Object.assign({},U,{value:D,default:$,minValue:Z,maxValue:W,stepValue:te,type:ue,values:se})),this.updateConfigDependencies(l)):this.fire(new i.y(new Error(`No schema defined for the config option "${l}" in the "${r}" fragment.`)))}getConfig(r){const l=this.getFragmentStyle(r);if(!l)return null;const m=l.stylesheet.schema;if(!m)return null;const x={};for(const w in m){const A=i.aC(w,l.scope),D=l.options.get(A),N=D?D.value||D.default:null;x[w]=N?N.serialize():null}return x}setConfig(r,l){const m=this.getFragmentStyle(r);m&&(m.updateConfig(l,m.stylesheet.schema),this.updateConfigDependencies())}getSchema(r){const l=this.getFragmentStyle(r);return l?l.stylesheet.schema:null}setSchema(r,l){const m=this.getFragmentStyle(r);m&&(m.stylesheet.schema=l,m.updateConfig(m._config,l),this.updateConfigDependencies())}updateConfig(r,l){if(this._config=r,r||l)if(l)for(const m in l){let x,w;const A=i.U(l[m].default);if(A.result==="success"&&(x=A.value.expression),r&&r[m]!==void 0){const W=i.U(r[m]);W.result==="success"&&(w=W.value.expression)}const{minValue:D,maxValue:N,stepValue:U,type:$,values:Z}=l[m];if(x){const W=i.aC(m,this.scope);this.options.set(W,{default:x,value:w,minValue:D,maxValue:N,stepValue:U,type:$,values:Z})}else this.fire(new i.y(new Error(`No schema defined for config option "${m}".`)))}else this.fire(new i.y(new Error("Attempting to set config for a style without schema.")))}updateConfigDependencies(r){for(const l of this._configDependentLayers){const m=this.getLayer(l);if(m){if(r&&!m.configDependencies.has(r))continue;m.possiblyEvaluateVisibility(),this._updateLayer(m)}}this.ambientLight&&this.ambientLight.updateConfig(this.options),this.directionalLight&&this.directionalLight.updateConfig(this.options),this.fog&&this.fog.updateConfig(this.options),this.snow&&this.snow.updateConfig(this.options),this.rain&&this.rain.updateConfig(this.options),this.forEachFragmentStyle(l=>{const m=l._styleColorTheme.colorThemeOverride?l._styleColorTheme.colorThemeOverride:l._styleColorTheme.colorTheme;if(m){const x=l._evaluateColorThemeData(m);(!l._styleColorTheme.lut&&x!==""||l._styleColorTheme.lut&&x!==l._styleColorTheme.lut.data)&&l.setColorTheme(m)}}),this._changes.setDirty()}addLayer(r,l,m={}){this._checkLoaded();const x=r.id;if(this._layers[x])return void this.fire(new i.y(new Error(`Layer with id "${x}" already exists on this map`)));let w;if(r.type==="custom"){if(zl(this,i.ct(r)))return;w=i.cu(r,this.scope,this._styleColorTheme.lut,this.options)}else{if(typeof r.source=="object"&&(this.addSource(x,r.source),r=i.cp(r),r=i.l(r,{source:x})),this._validate(dh,`layers.${x}`,r,{arrayIndex:-1},m))return;w=i.cu(r,this.scope,this._styleColorTheme.lut,this.options),this._validateLayer(w),w.setEventedParent(this,{layer:{id:x}})}w.configDependencies.size!==0&&this._configDependentLayers.add(w.fqid);let A=this._order.length;if(l){const $=this._order.indexOf(l);if($===-1)return void this.fire(new i.y(new Error(`Layer with id "${l}" does not exist on this map.`)));w.slot===this._layers[l].slot?A=$:i.w(`Layer with id "${l}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(A,0,x),this._layerOrderChanged=!0,this._layers[x]=w;const D=this.getOwnLayerSourceCache(w),N=!!this.directionalLight&&this.directionalLight.shadowsEnabled();D&&w.canCastShadows()&&N&&(D.castsShadows=!0);const U=this._changes.getRemovedLayer(w);if(U&&w.source&&D&&w.type!=="custom"){this._changes.discardLayerRemoval(w);const $=i.aC(w.source,w.scope);U.type!==w.type?this._changes.updateSourceCache($,"clear"):(this._changes.updateSourceCache($,"reload"),D.pause())}this._updateLayer(w),w.onAdd&&w.onAdd(this.map),w.scope=this.scope,this.mergeLayers()}moveLayer(r,l){this._checkLoaded();const m=this._checkLayer(r);if(!m||r===l)return;const x=this._order.indexOf(r);this._order.splice(x,1);let w=this._order.length;if(l){const A=this._order.indexOf(l);if(A===-1)return void this.fire(new i.y(new Error(`Layer with id "${l}" does not exist on this map.`)));m.slot===this._layers[l].slot?w=A:i.w(`Layer with id "${l}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(w,0,r),this._changes.setDirty(),this._layerOrderChanged=!0,this.mergeLayers()}removeLayer(r){this._checkLoaded();const l=this._checkLayer(r);if(!l)return;l.setEventedParent(null);const m=this._order.indexOf(r);this._order.splice(m,1),delete this._layers[r],this._changes.setDirty(),this._layerOrderChanged=!0,this._configDependentLayers.delete(l.fqid),this._changes.removeLayer(l);const x=this.getOwnLayerSourceCache(l);if(x&&x.castsShadows){let w=!1;for(const A in this._layers)if(this._layers[A].source===l.source&&this._layers[A].canCastShadows()){w=!0;break}x.castsShadows=w}l.onRemove&&l.onRemove(this.map),this.mergeLayers()}getOwnLayer(r){return this._layers[r]}hasLayer(r){return r in this._mergedLayers}hasLayerType(r){for(const l in this._layers)if(this._layers[l].type===r)return!0;return!1}setLayerZoomRange(r,l,m){this._checkLoaded();const x=this._checkLayer(r);x&&(x.minzoom===l&&x.maxzoom===m||(l!=null&&(x.minzoom=l),m!=null&&(x.maxzoom=m),this._updateLayer(x)))}getSlots(){return this._checkLoaded(),this._mergedSlots}setSlot(r,l){this._checkLoaded();const m=this._checkLayer(r);m&&m.slot!==l&&(m.slot=l,this._updateLayer(m))}setFilter(r,l,m={}){this._checkLoaded();const x=this._checkLayer(r);if(x&&!i.bn(x.filter,l))return l==null?(x.filter=void 0,void this._updateLayer(x)):void(this._validate(vi,`layers.${x.id}.filter`,l,{layerType:x.type},m)||(x.filter=i.cp(l),this._updateLayer(x)))}getFilter(r){const l=this._checkLayer(r);if(l)return i.cp(l.filter)}setLayoutProperty(r,l,m,x={}){this._checkLoaded();const w=this._checkLayer(r);if(w&&!i.bn(w.getLayoutProperty(l),m)){if(m!=null&&(!x||x.validate!==!1)&&zl(w,If.call(Za,{key:`layers.${r}.layout.${l}`,layerType:w.type,objectKey:l,value:m,styleSpec:i.a3,style:{glyphs:!0,sprite:!0}})))return;w.setLayoutProperty(l,m),w.configDependencies.size!==0&&this._configDependentLayers.add(w.fqid),this._updateLayer(w)}}getLayoutProperty(r,l){const m=this._checkLayer(r);if(m)return m.getLayoutProperty(l)}setPaintProperty(r,l,m,x={}){this._checkLoaded();const w=this._checkLayer(r);if(!w||i.bn(w.getPaintProperty(l),m)||m!=null&&(!x||x.validate!==!1)&&zl(w,Pf.call(Za,{key:`layers.${r}.paint.${l}`,layerType:w.type,objectKey:l,value:m,styleSpec:i.a3})))return;const A=w.setPaintProperty(l,m);w.configDependencies.size!==0&&this._configDependentLayers.add(w.fqid),A&&this._updateLayer(w),this._changes.updatePaintProperties(w)}getPaintProperty(r,l){const m=this._checkLayer(r);if(m)return m.getPaintProperty(l)}setFeatureState(r,l){if(this._checkLoaded(),"target"in r){if("featuresetId"in r.target){const{featuresetId:N,importId:U}=r.target,$=this.getFragmentStyle(U),Z=$.getFeaturesetLayers(N);for(const{source:W,sourceLayer:te}of Z)$.setFeatureState({id:r.id,source:W,sourceLayer:te},l)}else if("layerId"in r.target){const{layerId:N}=r.target,U=this.getLayer(N);this.setFeatureState({id:r.id,source:U.source,sourceLayer:U.sourceLayer},l)}return}const m=r.source,x=r.sourceLayer,w=this._checkSource(m);if(!w)return;const A=w.type;if(A==="geojson"&&x)return void this.fire(new i.y(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(A==="vector"&&!x)return void this.fire(new i.y(new Error("The sourceLayer parameter must be provided for vector source types.")));r.id===void 0&&this.fire(new i.y(new Error("The feature id parameter must be provided.")));const D=this.getOwnSourceCaches(m);for(const N of D)N.setFeatureState(x,r.id,l)}removeFeatureState(r,l){if(this._checkLoaded(),"target"in r){if("featuresetId"in r.target){const{featuresetId:N,importId:U}=r.target,$=this.getFragmentStyle(U),Z=$.getFeaturesetLayers(N);for(const{source:W,sourceLayer:te}of Z)$.removeFeatureState({id:r.id,source:W,sourceLayer:te},l)}else if("layerId"in r.target){const{layerId:N}=r.target,U=this.getLayer(N);this.removeFeatureState({id:r.id,source:U.source,sourceLayer:U.sourceLayer},l)}return}const m=r.source,x=this._checkSource(m);if(!x)return;const w=x.type,A=w==="vector"?r.sourceLayer:void 0;if(w==="vector"&&!A)return void this.fire(new i.y(new Error("The sourceLayer parameter must be provided for vector source types.")));if(l&&typeof r.id!="string"&&typeof r.id!="number")return void this.fire(new i.y(new Error("A feature id is required to remove its specific state property.")));const D=this.getOwnSourceCaches(m);for(const N of D)N.removeFeatureState(A,r.id,l)}getFeatureState(r){if(this._checkLoaded(),"target"in r){let w;if("featuresetId"in r.target){const{featuresetId:A,importId:D}=r.target,N=this.getFragmentStyle(D),U=N.getFeaturesetLayers(A);for(const{source:$,sourceLayer:Z}of U){const W=N.getFeatureState({id:r.id,source:$,sourceLayer:Z});if(W&&!w)w=W;else if(!i.bn(w,W))return void this.fire(new i.y(new Error("The same feature id exists in multiple sources in the featureset, but their feature states are not consistent through the sources.")))}}else if("layerId"in r.target){const{layerId:A}=r.target,D=this.getLayer(A);w=this.getFeatureState({id:r.id,source:D.source,sourceLayer:D.sourceLayer})}return w}const l=r.source,m=r.sourceLayer,x=this._checkSource(l);if(x){if(x.type!=="vector"||m)return r.id===void 0&&this.fire(new i.y(new Error("The feature id parameter must be provided."))),this.getOwnSourceCaches(l)[0].getFeatureState(m,r.id);this.fire(new i.y(new Error("The sourceLayer parameter must be provided for vector source types.")))}}setTransition(r){return this.stylesheet.transition=i.l({},this.stylesheet.transition,r),this.transition=this.stylesheet.transition,this}getTransition(){return i.l({},this.stylesheet.transition)}serialize(){this._checkLoaded();const r=this.getTerrain(),l=r&&this.terrain&&this.terrain.scope===this.scope?r:this.stylesheet.terrain;return i.cv({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,fragment:this.stylesheet.fragment,imports:this._serializeImports(),schema:this.stylesheet.schema,camera:this.stylesheet.camera,light:this.stylesheet.light,lights:this.stylesheet.lights,terrain:l,fog:this.stylesheet.fog,snow:this.stylesheet.snow,rain:this.stylesheet.rain,center:this.stylesheet.center,"color-theme":this.stylesheet["color-theme"],zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:this._serializeSources(),layers:this._serializeLayers(this._order)},m=>m!==void 0)}_updateFilteredLayers(r){for(const l of Object.values(this._mergedLayers))r(l)&&this._updateLayer(l)}_updateLayer(r){this._changes.updateLayer(r);const l=this.getLayerSourceCache(r),m=i.aC(r.source,r.scope),x=this._changes.getUpdatedSourceCaches();r.source&&!x[m]&&l&&l.getSource().type!=="raster"&&(this._changes.updateSourceCache(m,"reload"),l.pause()),r.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(r){const l=D=>this._mergedLayers[D].is3D(),m=this.order,x={},w=[];for(let D=m.length-1;D>=0;D--){const N=m[D];if(l(N)){x[N]=D;for(const U of r){const $=U[N];if($)for(const Z of $)w.push(Z)}}}w.sort((D,N)=>N.intersectionZ-D.intersectionZ);const A=[];for(let D=m.length-1;D>=0;D--){const N=m[D];if(l(N))for(let U=w.length-1;U>=0;U--){const $=w[U].feature;if($.layer&&x[$.layer.id]<D)break;A.push($),w.pop()}else for(const U of r){const $=U[N];if($)for(const Z of $)A.push(Z.feature)}}return A}queryRenderedFeatures(r,l,m){let x;l&&!Array.isArray(l)&&l.filter&&(this._validate(vi,"queryRenderedFeatures.filter",l.filter,null,l),x=i.aZ(l.filter));const w={},A=$=>{if(xc.has($.type))return;const Z=this.getOwnLayerSourceCache($),W=w[Z.id]=w[Z.id]||{sourceCache:Z,layers:{},has3DLayers:!1};$.is3D()&&(W.has3DLayers=!0),W.layers[$.fqid]=W.layers[$.fqid]||{styleLayer:$,targets:[]},W.layers[$.fqid].targets.push({filter:x})};if(l&&l.layers){if(!Array.isArray(l.layers))return this.fire(new i.y(new Error("parameters.layers must be an Array."))),[];for(const $ of l.layers){const Z=this._layers[$];if(!Z)return this.fire(new i.y(new Error(`The layer '${$}' does not exist in the map's style and cannot be queried for features.`))),[];A(Z)}}else for(const $ in this._layers)A(this._layers[$]);const D=this._queryRenderedFeatures(r,w,m),N=this._flattenAndSortRenderedFeatures(D),U=[];for(const $ of N)i.cs($.layer.id)===this.scope&&U.push($);return U}queryRenderedFeatureset(r,l,m){let x;l&&!Array.isArray(l)&&l.filter&&(this._validate(vi,"queryRenderedFeatures.filter",l.filter,null,l),x=i.aZ(l.filter));const w="mock",A=[];if(l&&l.target)A.push(Object.assign({},l,{targetId:w,filter:x}));else{const $=this.getFeaturesetDescriptors();for(const Z of $)A.push({targetId:w,filter:x,target:Z});for(const{style:Z}of this.fragments){const W=Z.getFeaturesetDescriptors();for(const te of W)A.push({targetId:w,filter:x,target:te})}}const D=this.queryRenderedTargets(r,A,m),N=[],U=new Set;for(const $ of D)for(const Z of $.variants[w])Cl(Z,$,U)||N.push(new i.cw($,Z));return N}queryRenderedTargets(r,l,m){const x={},w=(D,N,U,$)=>{const Z=x[N.id]=x[N.id]||{sourceCache:N,layers:{},has3DLayers:!1};if(Z.layers[D.fqid]=Z.layers[D.fqid]||{styleLayer:D,targets:[]},D.is3D()&&(Z.has3DLayers=!0),!$)return U.uniqueFeatureID=!1,void Z.layers[D.fqid].targets.push(U);Z.layers[D.fqid].targets.push(Object.assign({},U,{namespace:$.namespace,properties:$.properties,uniqueFeatureID:$.uniqueFeatureID}))};for(const D of l)if("featuresetId"in D.target){const{featuresetId:N,importId:U}=D.target,$=this.getFragmentStyle(U);if(!$||!$._featuresetSelectors)continue;const Z=$._featuresetSelectors[N];if(!Z){this.fire(new i.y(new Error(`The featureset '${N}' does not exist in the map's style and cannot be queried for features.`)));continue}for(const W of Z){const te=$.getOwnLayer(W.layerId);te&&!xc.has(te.type)&&w(te,$.getOwnLayerSourceCache(te),D,W)}}else if("layerId"in D.target){const{layerId:N}=D.target,U=this.getLayer(N);if(!U||xc.has(U.type))continue;w(U,this.getLayerSourceCache(U),D)}const A=this._queryRenderedFeatures(r,x,m);return this._flattenAndSortRenderedFeatures(A)}_queryRenderedFeatures(r,l,m){const x=[],w=!!this.map._showQueryGeometry,A=wn.createFromScreenPoints(r,m);for(const D in l){const N=fc(A,l[D],this._availableImages,m,w);Object.keys(N).length&&x.push(N)}if(this.placement)for(const D in l){if(!l[D].sourceCache._onlySymbols)continue;const N=ap(A.screenGeometry,l[D],this._availableImages,this.placement.collisionIndex,this.placement.retainedQueryData);Object.keys(N).length&&x.push(N)}return x}querySourceFeatures(r,l){const m=l&&l.filter;m&&this._validate(vi,"querySourceFeatures.filter",m,null,l);let x=[];const w=this.getOwnSourceCaches(r);for(const A of w)x=x.concat(Rf(A,l));return x}addSourceType(r,l,m){return La.getSourceType(r)?m(new Error(`A source type called "${r}" already exists.`)):(La.setSourceType(r,l),l.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:r,url:l.workerSourceURL},m):m(null,null))}getFlatLight(){return this.light.getLight()}setFlatLight(r,l,m={}){this._checkLoaded();const x=this.light.getLight();let w=!1;for(const D in r)if(!i.bn(r[D],x[D])){w=!0;break}if(!w)return;const A=this._getTransitionParameters();this.light.setLight(r,l,m),this.light.updateTransitions(A)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}checkCanvasFingerprintNoise(){this.disableElevatedTerrain===void 0&&(this.disableElevatedTerrain=i.q.hasCanvasFingerprintNoise(),this.disableElevatedTerrain&&i.w("Terrain and hillshade are disabled because of Canvas2D limitations when fingerprinting protection is enabled (e.g. in private browsing mode)."))}setTerrain(r,l=1){if(this._checkLoaded(),!r)return this.terrainSetForDrapingOnly()||(delete this.terrain,this.map.transform.projection.requiresDraping&&this.setTerrainForDraping()),l===0&&delete this.terrain,r===null?this.stylesheet.terrain=null:delete this.stylesheet.terrain,this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);this.checkCanvasFingerprintNoise();let m=r;const x=r.source==null;if(l===1){if(this.disableElevatedTerrain)return;if(typeof m.source=="object"){const D="terrain-dem-src";this.addSource(D,m.source),m=i.cp(m),m=i.l(m,{source:D})}const w=i.l({},m),A={};if(this.terrain&&x){w.source=this.terrain.get().source;const D=this.terrain?this.getFragmentStyle(this.terrain.scope):null;D&&(A.style=D.serialize())}if(this._validate(nl,"terrain",w,A))return}if(!this.terrain||this.terrain.scope!==this.scope&&!x||this.terrain&&l!==this.terrain.drapeRenderMode){if(!m)return;this._createTerrain(m,l),this.fire(new i.z("data",{dataType:"style"}))}else{const w=this.terrain,A=w.get();for(const D of Object.keys(i.a3.terrain))!m.hasOwnProperty(D)&&i.a3.terrain[D].default&&(m[D]=i.a3.terrain[D].default);for(const D in r)if(!i.bn(r[D],A[D])){w.set(r,this.options),this.stylesheet.terrain=r;const N=this._getTransitionParameters({duration:0});w.updateTransitions(N),this.fire(new i.z("data",{dataType:"style"}));break}}this.mergeTerrain(),this.updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(r){const l=this.fog=new lt(r,this.map.transform,this.scope,this.options);this.stylesheet.fog=l.get();const m=this._getTransitionParameters({duration:0});l.updateTransitions(m)}_createSnow(r){const l=this.snow=new gn(r,this.map.transform,this.scope,this.options);this.stylesheet.snow=l.get();const m=this._getTransitionParameters({duration:0});l.updateTransitions(m)}_createRain(r){const l=this.rain=new Cn(r,this.map.transform,this.scope,this.options);this.stylesheet.rain=l.get();const m=this._getTransitionParameters({duration:0});l.updateTransitions(m)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const r of this.map._markers)r._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(r){if(this._checkLoaded(),!r)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const l=this.fog;if(!i.bn(l.get(),r)){l.set(r,this.options),this.stylesheet.fog=l.get();const m=this._getTransitionParameters({duration:0});l.updateTransitions(m)}}else this._createFog(r);this._markersNeedUpdate=!0}getSnow(){return this.snow?this.snow.get():null}setSnow(r){if(this._checkLoaded(),!r)return delete this.snow,void delete this.stylesheet.snow;if(this.snow){const l=this.snow;if(!i.bn(l.get(),r)){l.set(r,this.options),this.stylesheet.snow=l.get();const m=this._getTransitionParameters({duration:0});l.updateTransitions(m)}}else this._createSnow(r);this._markersNeedUpdate=!0}getRain(){return this.rain?this.rain.get():null}setRain(r){if(this._checkLoaded(),!r)return delete this.rain,void delete this.stylesheet.rain;if(this.rain){const l=this.rain;if(!i.bn(l.get(),r)){l.set(r,this.options),this.stylesheet.rain=l.get();const m=this._getTransitionParameters({duration:0});l.updateTransitions(m)}}else this._createRain(r);this._markersNeedUpdate=!0}_reloadColorTheme(){const r=()=>{for(const x in this._layers)this._layers[x].lut=this._styleColorTheme.lut;for(const x in this._sourceCaches)this._sourceCaches[x].clearTiles()},l=this._styleColorTheme.colorThemeOverride?this._styleColorTheme.colorThemeOverride:this._styleColorTheme.colorTheme;if(!l)return this._styleColorTheme.lut=null,void r();const m=this._evaluateColorThemeData(l);this._loadColorTheme(m).then(()=>{this.fire(new i.z("colorthemeset")),r()}).catch(x=>{i.w(`Couldn't set color theme: ${x}`)})}setColorTheme(r){this._checkLoaded(),this._styleColorTheme.colorThemeOverride&&i.w("Note: setColorTheme is called on a style with a color-theme override, the passed color-theme won't be visible."),this._styleColorTheme.colorTheme=r,this._reloadColorTheme()}setImportColorTheme(r,l){const m=this.getFragmentStyle(r);m&&(m._styleColorTheme.colorThemeOverride=l,m._reloadColorTheme())}_getTransitionParameters(r){return{now:i.q.now(),transition:i.l(this.transition,r)}}updateDrapeFirstLayers(){if(!this.terrain)return;const r=[],l=[];for(const m of this._mergedOrder)this.isLayerDraped(this._mergedLayers[m])?r.push(m):l.push(m);this._drapedFirstOrder=[],this._drapedFirstOrder.push(...r),this._drapedFirstOrder.push(...l)}_createTerrain(r,l){const m=this.terrain=new pe(r,l,this.scope,this.options);l===1&&(this.stylesheet.terrain=r),this.mergeTerrain(),this.updateDrapeFirstLayers(),this._force3DLayerUpdate();const x=this._getTransitionParameters({duration:0});m.updateTransitions(x)}_force3DLayerUpdate(){for(const r in this._layers){const l=this._layers[r];l.type==="fill-extrusion"&&this._updateLayer(l)}}_forceSymbolLayerUpdate(){for(const r in this._layers){const l=this._layers[r];l.type==="symbol"&&this._updateLayer(l)}}_validate(r,l,m,x,w={}){if(w&&w.validate===!1)return!1;const A=i.l({},this.serialize());return zl(this,r.call(Za,i.l({key:l,style:A,value:m,styleSpec:i.a3},x)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),i.cx.off("pluginStateChange",this._rtlTextPluginCallback);for(const r in this._mergedLayers)this._mergedLayers[r].setEventedParent(null);for(const r in this._mergedSourceCaches)this._mergedSourceCaches[r].clearTiles(),this._mergedSourceCaches[r].setEventedParent(null);this.setEventedParent(null),delete this.fog,delete this.snow,delete this.rain,delete this.terrain,delete this.ambientLight,delete this.directionalLight,this.isRootStyle()&&(this.imageManager.setEventedParent(null),this.modelManager.setEventedParent(null),this.dispatcher.remove())}clearSource(r){const l=this.getSourceCaches(r);for(const m of l)m.clearTiles()}clearSources(){for(const r in this._mergedSourceCaches)this._mergedSourceCaches[r].clearTiles()}reloadSource(r){const l=this.getSourceCaches(r);for(const m of l)m.resume(),m.reload()}reloadSources(){for(const r of this.getSources())r.reload&&r.reload()}reloadModels(){this.modelManager.reloadModels(""),this.forEachFragmentStyle(r=>{r.modelManager.reloadModels(r.scope)})}updateSources(r){let l;this.directionalLight&&(l=gc(this.directionalLight));for(const m in this._mergedSourceCaches)this._mergedSourceCaches[m].update(r,void 0,void 0,l)}_generateCollisionBoxes(){for(const r in this._sourceCaches){const l=this._sourceCaches[r];l.resume(),l.reload()}}_updatePlacement(r,l,m,x,w,A,D=!1){let N=!1,U=!1;const $={},Z={};for(const W of this._mergedOrder){const te=this._mergedLayers[W];if(te.type!=="symbol")continue;const ue=i.aC(te.source,te.scope);let se=$[ue];if(!se){const he=this.getLayerSourceCache(te);if(!he)continue;const Te=he.getRenderableIds(!0).map(Pe=>he.getTileByID(Pe));Z[ue]=Te.slice(),se=$[ue]=Te.sort((Pe,Me)=>Me.tileID.overscaledZ-Pe.tileID.overscaledZ||(Pe.tileID.isLessThan(Me.tileID)?-1:1))}const de=this.crossTileSymbolIndex.addLayer(te,se,l.center.lng,l.projection);N=N||de}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._mergedOrder),D=D||this._layerOrderChanged||x===0,this._layerOrderChanged&&this.fire(new i.z("neworder")),(D||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(i.q.now(),l.zoom))&&(this.pauseablePlacement=new Oy(l,this._mergedOrder,D,m,x,w,this.placement,this.fog&&l.projection.supportsFog?this.fog.state:null,this._buildingIndex),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._mergedOrder,this._mergedLayers,$,Z,this.map.painter.scaleFactor),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(i.q.now()),U=!0),N&&this.pauseablePlacement.placement.setStale()),U||N){this._buildingIndex.onNewFrame(l.zoom);for(let W=0;W<this._mergedOrder.length;W++){const te=this._mergedLayers[this._mergedOrder[W]];if(te.type!=="symbol")continue;const ue=this.isLayerClipped(te);this.placement.updateLayerOpacities(te,$[i.aC(te.source,te.scope)],W,ue?A:null)}}return{needsRerender:!this.pauseablePlacement.isDone()||this.placement.hasTransitions(i.q.now())}}_releaseSymbolFadeTiles(){for(const r in this._sourceCaches)this._sourceCaches[r].releaseSymbolFadeTiles()}addImport(r,l){this._checkLoaded();const m=this.stylesheet.imports=this.stylesheet.imports||[];if(m.findIndex(({id:w})=>w===r.id)!==-1)return void this.fire(new i.y(new Error(`Import with id '${r.id}' already exists in the map's style.`)));if(!l)return m.push(r),this._loadImports([r],!0);const x=m.findIndex(({id:w})=>w===l);return x===-1&&this.fire(new i.y(new Error(`Import with id "${l}" does not exist on this map.`))),this.stylesheet.imports=m.slice(0,x).concat(r).concat(m.slice(x)),this._loadImports([r],!0,l)}updateImport(r,l){this._checkLoaded();const m=this.stylesheet.imports||[],x=this.getImportIndex(r);return x===-1?this:typeof l=="string"?(this.setImportUrl(r,l),this):(l.url&&l.url!==m[x].url&&this.setImportUrl(r,l.url),i.bn(l.config,m[x].config)||this.setImportConfig(r,l.config,l.data.schema),i.bn(l.data,m[x].data)||this.setImportData(r,l.data),this)}moveImport(r,l){this._checkLoaded();let m=this.stylesheet.imports||[];const x=this.getImportIndex(r);if(x===-1)return this;const w=this.getImportIndex(l);if(w===-1)return this;const A=m[x],D=this.fragments[x];return m=m.filter(({id:N})=>N!==r),this.fragments=this.fragments.filter(({id:N})=>N!==r),this.stylesheet.imports=m.slice(0,w).concat(A).concat(m.slice(w)),this.fragments=this.fragments.slice(0,w).concat(D).concat(this.fragments.slice(w)),this.mergeLayers(),this}setImportUrl(r,l){this._checkLoaded();const m=this.stylesheet.imports||[],x=this.getImportIndex(r);if(x===-1)return this;m[x].url=l;const w=this.fragments[x];return w.style=this._createFragmentStyle(m[x]),w.style.on("style.import.load",()=>this.mergeAll()),w.style.loadURL(l),this}setImportData(r,l){this._checkLoaded();const m=this.getImportIndex(r),x=this.stylesheet.imports||[];return m===-1?this:l?(this.fragments[m].style.setState(l),this._reloadImports(),this):(delete x[m].data,this.setImportUrl(r,x[m].url))}setImportConfig(r,l,m){this._checkLoaded();const x=this.getImportIndex(r),w=this.stylesheet.imports||[];if(x===-1)return this;l?w[x].config=l:delete w[x].config;const A=this.fragments[x];m&&A.style.stylesheet&&(A.style.stylesheet.schema=m);const D=A.style.stylesheet&&A.style.stylesheet.schema;return A.config=l,A.style.updateConfig(l,D),this.updateConfigDependencies(),this}removeImport(r){this._checkLoaded();const l=this.stylesheet.imports||[],m=this.getImportIndex(r);m!==-1&&(l.splice(m,1),this.fragments[m].style._remove(),this.fragments.splice(m,1),this._reloadImports())}getImportIndex(r){const l=(this.stylesheet.imports||[]).findIndex(m=>m.id===r);return l===-1&&this.fire(new i.y(new Error(`Import '${r}' does not exist in the map's style and cannot be updated.`))),l}getLayer(r){return this._mergedLayers[r]}getSources(){const r=[];for(const l in this._mergedOtherSourceCaches){const m=this._mergedOtherSourceCaches[l];m&&r.push(m.getSource())}return r}getSource(r,l){const m=this.getSourceCache(r,l);return m&&m.getSource()}getLayerSource(r){const l=this.getLayerSourceCache(r);return l&&l.getSource()}getSourceCache(r,l){const m=i.aC(r,l);return this._mergedOtherSourceCaches[m]}getLayerSourceCache(r){const l=i.aC(r.source,r.scope);return r.type==="symbol"?this._mergedSymbolSourceCaches[l]:this._mergedOtherSourceCaches[l]}getSourceCaches(r){if(r==null)return Object.values(this._mergedSourceCaches);const l=[];return this._mergedOtherSourceCaches[r]&&l.push(this._mergedOtherSourceCaches[r]),this._mergedSymbolSourceCaches[r]&&l.push(this._mergedSymbolSourceCaches[r]),l}updateSourceCaches(){const r=this._changes.getUpdatedSourceCaches();for(const l in r){const m=r[l];m==="reload"?this.reloadSource(l):m==="clear"&&this.clearSource(l)}}updateLayers(r){const l=this._changes.getUpdatedPaintProperties();for(const m of l){const x=this.getLayer(m);x&&x.updateTransitions(r)}}getImages(r,l,m){this.imageManager.getImages(l.icons,l.scope,m),this._updateTilesForChangedImages();const x=w=>{w&&w.setDependencies(l.tileID.key,l.type,l.icons)};x(this._otherSourceCaches[l.source]),x(this._symbolSourceCaches[l.source])}rasterizeImages(r,l,m){this.imageManager.rasterizeImages(l,m)}getGlyphs(r,l,m){this.glyphManager.getGlyphs(l.stacks,l.scope,m)}getResource(r,l,m){return i.cy(l,m)}getOwnSourceCache(r){return this._otherSourceCaches[r]}getOwnLayerSourceCache(r){return r.type==="symbol"?this._symbolSourceCaches[r.source]:this._otherSourceCaches[r.source]}getOwnSourceCaches(r){const l=[];return this._otherSourceCaches[r]&&l.push(this._otherSourceCaches[r]),this._symbolSourceCaches[r]&&l.push(this._symbolSourceCaches[r]),l}_isSourceCacheLoaded(r){const l=this.getOwnSourceCaches(r);return l.length===0?(this.fire(new i.y(new Error(`There is no source with ID '${r}'`))),!1):l.every(m=>m.loaded())}has3DLayers(){return this._has3DLayers}hasSymbolLayers(){return this._hasSymbolLayers}hasCircleLayers(){return this._hasCircleLayers}isLayerClipped(r,l){if(!this._clipLayerPresent&&r.type!=="fill-extrusion")return!1;const m=r.type==="fill-extrusion"&&r.sourceLayer==="building";if(r.is3D()){if(m||l&&l.type==="batched-model"||r.type==="model")return!0}else if(r.type==="symbol")return!0;return!1}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.fragments.forEach(r=>{r.style._remove()}),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}La.getSourceType=function(p){return ii[p]},La.setSourceType=function(p,r){ii[p]=r},La.registerForPluginStateChange=i.ch;var Hf=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#ifdef RENDER_CUTOFF
float cutoff_opacity(vec4 cutoff_params,float depth) {float near=cutoff_params.x;float far=cutoff_params.y;float cutoffStart=cutoff_params.z;float cutoffEnd=cutoff_params.w;float linearDepth=(depth-near)/(far-near);return clamp((linearDepth-cutoffStart)/(cutoffEnd-cutoffStart),0.0,1.0);}
#endif`,wh=`
out vec4 glFragColor;highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}
#ifdef INDICATOR_CUTOUT
uniform vec3 u_indicator_cutout_centers;uniform vec4 u_indicator_cutout_params;
#endif
vec4 applyCutout(vec4 color,float height) {
#ifdef INDICATOR_CUTOUT
float verticalFadeRange=u_indicator_cutout_centers.z*0.25;float holeMinOpacity=mix(1.0,u_indicator_cutout_params.x,smoothstep(u_indicator_cutout_centers.z,u_indicator_cutout_centers.z+verticalFadeRange,height));float holeRadius=max(u_indicator_cutout_params.y,0.0);float holeAspectRatio=u_indicator_cutout_params.z;float fadeStart=u_indicator_cutout_params.w;float distA=distance(vec2(gl_FragCoord.x,gl_FragCoord.y*holeAspectRatio),vec2(u_indicator_cutout_centers[0],u_indicator_cutout_centers[1]*holeAspectRatio));return color*min(smoothstep(fadeStart,holeRadius,distA)+holeMinOpacity,1.0);
#else
return color;
#endif
}
#ifdef DEBUG_WIREFRAME
#define HANDLE_WIREFRAME_DEBUG \\
glFragColor=vec4(0.7,0.0,0.0,0.7); \\
gl_FragDepth=gl_FragCoord.z-0.0001;
#else
#define HANDLE_WIREFRAME_DEBUG
#endif
#ifdef RENDER_CUTOFF
uniform highp vec4 u_cutoff_params;in float v_cutoff_opacity;
#endif
vec4 textureLodCustom(sampler2D image,highp vec2 pos,highp vec2 lod_coord) {highp vec2 size=vec2(textureSize(image,0));highp vec2 dx=dFdx(lod_coord.xy*size);highp vec2 dy=dFdy(lod_coord.xy*size);highp float delta_max_sqr=max(dot(dx,dx),dot(dy,dy));highp float lod=0.5*log2(delta_max_sqr);return textureLod(image,pos,lod);}vec4 applyLUT(highp sampler3D lut,vec4 col) {vec3 size=vec3(textureSize(lut,0));vec3 uvw=(col.rbg*float(size-1.0)+0.5)/size;return vec4(texture(lut,uvw).rgb,col.a);}vec3 applyLUT(highp sampler3D lut,vec3 col) {return applyLUT(lut,vec4(col,1.0)).rgb;}`,Zf=`
#define EXTENT 8192.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const vec2 units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (units_to_pixels*pos+offset)/pattern_size;}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {return get_pattern_pos(pixel_coord_upper,pixel_coord_lower,pattern_size,vec2(tile_units_to_pixels),pos);}float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(PI/4.0+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}
#ifdef RENDER_CUTOFF
uniform vec4 u_cutoff_params;out float v_cutoff_opacity;
#endif
const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}`,bc="in highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;out highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",mp=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
#ifdef TERRAIN
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(dd,0)).r;float bl=texture(u_dem,pos+vec2(0,dd)).r;float br=texture(u_dem,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem_prev,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem_prev,pos).r;float tr=texture(u_dem_prev,pos+vec2(dd,0)).r;float bl=texture(u_dem_prev,pos+vec2(0,dd)).r;float br=texture(u_dem_prev,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
vec4 fourSample(vec2 pos,vec2 off) {float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(off.x,0.0)).r;float bl=texture(u_dem,pos+vec2(0.0,off.y)).r;float br=texture(u_dem,pos+off).r;return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }
#endif
#ifdef DEPTH_OCCLUSION
uniform highp sampler2D u_depth;uniform highp vec2 u_depth_size_inv;uniform highp vec2 u_depth_range_unpack;uniform highp float u_occluder_half_size;uniform highp float u_occlusion_depth_offset;
#ifdef DEPTH_D24
float unpack_depth(float depth) {return depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}vec4 unpack_depth4(vec4 depth) {return depth*u_depth_range_unpack.x+vec4(u_depth_range_unpack.y);}
#else
highp float unpack_depth_rgba(vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;
#ifdef DEPTH_D24
float depth=unpack_depth(texture(u_depth,(coord.xy+1.0)*0.5).r);
#else
float depth=unpack_depth_rgba(texture(u_depth,(coord.xy+1.0)*0.5));
#endif
return coord.z+u_occlusion_depth_offset > depth;}highp vec4 getCornerDepths(vec2 coord) {highp vec3 df=vec3(u_occluder_half_size*u_depth_size_inv,0.0);highp vec2 uv=0.5*coord.xy+0.5;
#ifdef DEPTH_D24
highp vec4 depth=vec4(
texture(u_depth,uv-df.xz).r,texture(u_depth,uv+df.xz).r,texture(u_depth,uv-df.zy).r,texture(u_depth,uv+df.zy).r
);depth=unpack_depth4(depth);
#else
highp vec4 depth=vec4(
unpack_depth_rgba(texture(u_depth,uv-df.xz)),unpack_depth_rgba(texture(u_depth,uv+df.xz)),unpack_depth_rgba(texture(u_depth,uv-df.zy)),unpack_depth_rgba(texture(u_depth,uv+df.zy))
);
#endif
return depth;}highp float occlusionFadeMultiSample(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec2 uv=0.5*coord.xy+0.5;int NX=3;int NY=4;highp vec2 df=u_occluder_half_size*u_depth_size_inv;highp vec2 oneStep=2.0*u_occluder_half_size*u_depth_size_inv/vec2(NX-1,NY-1);highp float res=0.0;for (int y=0; y < NY;++y) {for (int x=0; x < NX;++x) {
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)));
#endif
res+=1.0-clamp(300.0*(coord.z+u_occlusion_depth_offset-depth),0.0,1.0);}}res=clamp(2.0*res/float(NX*NY)-0.5,0.0,1.0);return res;}highp float occlusionFade(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec4 depth=getCornerDepths(coord.xy);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z+u_occlusion_depth_offset)-depth),0.0,1.0));}
#else
bool isOccluded(vec4 frag) { return false; }highp float occlusionFade(vec4 frag) { return 1.0; }highp float occlusionFadeMultiSample(vec4 frag) { return 1.0; }
#endif//DEPTH_OCCLUSION`,Nm=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;out vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,wc=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump vec2 u_fog_vertical_limit;uniform mediump float u_fog_temporal_offset;in vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos,float opacity_limit) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,min(opacity,opacity_limit));}vec3 fog_apply(vec3 color,vec3 pos) {return fog_apply(color,pos,1.0);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec4 fog_apply_premultiplied(vec4 color,vec3 pos,float heightMeters) {float verticalProgress=(u_fog_vertical_limit.x > 0.0 || u_fog_vertical_limit.y > 0.0) ? smoothstep(u_fog_vertical_limit.x,u_fog_vertical_limit.y,heightMeters) : 0.0;float opacityLimit=1.0-smoothstep(0.9,1.0,fog_opacity(pos));return mix(fog_apply_premultiplied(color,pos),color,min(verticalProgress,opacityLimit));}vec3 fog_dither(vec3 color) {return color;}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`,bu=`#ifdef RASTER_ARRAY
uniform highp sampler2D u_image0;uniform sampler2D u_image1;const vec4 NODATA=vec4(1);ivec4 _raTexLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}vec2 _raTexLinearMix(highp vec2 fxy,highp vec4 colorMix,highp float colorOffset,highp vec4 t00,highp vec4 t10,highp vec4 t01,highp vec4 t11) {vec2 c00=t00==NODATA ? vec2(0) : vec2(colorOffset+dot(t00,colorMix),1);vec2 c10=t10==NODATA ? vec2(0) : vec2(colorOffset+dot(t10,colorMix),1);vec2 c01=t01==NODATA ? vec2(0) : vec2(colorOffset+dot(t01,colorMix),1);vec2 c11=t11==NODATA ? vec2(0) : vec2(colorOffset+dot(t11,colorMix),1);return mix(mix(c01,c11,fxy.x),mix(c00,c10,fxy.x),fxy.y);}vec2 raTexture2D_image0_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image0,c.yz,0),texelFetch(u_image0,c.xz,0),texelFetch(u_image0,c.yw,0),texelFetch(u_image0,c.xw,0)
);}vec2 raTexture2D_image1_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image1,c.yz,0),texelFetch(u_image1,c.xz,0),texelFetch(u_image1,c.yw,0),texelFetch(u_image1,c.xw,0)
);}vec2 raTexture2D_image0_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image0,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}vec2 raTexture2D_image1_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image1,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}
#endif`,Sh=`#ifdef RASTER_ARRAY
uniform sampler2D u_velocity;uniform mediump vec2 u_velocity_res;uniform mediump float u_max_speed;const vec4 NO_DATA=vec4(1);const vec2 INVALID_VELOCITY=vec2(-1);uniform highp vec2 u_uv_offset;uniform highp float u_data_offset;uniform highp vec2 u_data_scale;ivec4 rasterArrayLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}highp vec2 lookup_velocity(highp vec2 uv) {uv=u_uv_offset.x+u_uv_offset.y*uv;highp vec2 fxy;ivec4 c=rasterArrayLinearCoord(uv,u_velocity_res,fxy);highp vec4 tl=texelFetch(u_velocity,c.yz,0);highp vec4 tr=texelFetch(u_velocity,c.xz,0);highp vec4 bl=texelFetch(u_velocity,c.yw,0);highp vec4 br=texelFetch(u_velocity,c.xw,0);if (tl==NO_DATA) {return INVALID_VELOCITY;}if (tr==NO_DATA) {return INVALID_VELOCITY;}if (bl==NO_DATA) {return INVALID_VELOCITY;}if (br==NO_DATA) {return INVALID_VELOCITY;}highp vec4 t=mix(mix(bl,br,fxy.x),mix(tl,tr,fxy.x),fxy.y);highp vec2 velocity=u_data_offset+vec2(dot(t.rg,u_data_scale),dot(t.ba,u_data_scale));velocity.y=-velocity.y;velocity/=max(u_max_speed,length(velocity));return velocity;}
#endif
uniform highp float u_particle_pos_scale;uniform highp vec2 u_particle_pos_offset;highp vec4 pack_pos_to_rgba(highp vec2 p) {highp vec2 v=(p+u_particle_pos_offset)/u_particle_pos_scale;highp vec4 r=vec4(v.x,fract(v.x*255.0),v.y,fract(v.y*255.0));return vec4(r.x-r.y/255.0,r.y,r.z-r.w/255.0,r.w);}highp vec2 unpack_pos_from_rgba(highp vec4 v) {v=floor(v*255.0+0.5)/255.0;highp vec2 p=vec2(v.x+(v.y/255.0),v.z+(v.w/255.0));return u_particle_pos_scale*p-u_particle_pos_offset;}`,fo=`#ifdef RENDER_SHADOWS
uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_normal_offset;vec3 shadow_normal_offset(vec3 normal) {float tileInMeters=u_shadow_normal_offset[0];vec3 n=vec3(-normal.xy,tileInMeters*normal.z);float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return n*dotScale;}vec3 shadow_normal_offset_model(vec3 normal) {vec3 transformed_normal=vec3(-normal.xy,normal.z);float NDotL=dot(normalize(transformed_normal),u_shadow_direction);float dotScale=min(1.0-NDotL,1.0)*0.5+0.5;return normal*dotScale;}float shadow_normal_offset_multiplier0() {return u_shadow_normal_offset[1];}float shadow_normal_offset_multiplier1() {return u_shadow_normal_offset[2];}
#endif//RENDER_SHADOWS`,ka=`#ifdef RENDER_SHADOWS
#ifdef DEPTH_TEXTURE
uniform highp sampler2D u_shadowmap_0;uniform highp sampler2D u_shadowmap_1;
#else
uniform sampler2D u_shadowmap_0;uniform sampler2D u_shadowmap_1;
#endif
uniform float u_shadow_intensity;uniform float u_shadow_map_resolution;uniform float u_shadow_texel_size;uniform highp vec3 u_shadow_normal_offset;uniform vec2 u_fade_range;uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_bias;highp float shadow_sample_1(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture(u_shadowmap_1,uv).r;
#else
shadow_depth=unpack_depth(texture(u_shadowmap_1,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}highp float shadow_sample_0(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture(u_shadowmap_0,uv).r;
#else
shadow_depth=unpack_depth(texture(u_shadowmap_0,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}float shadow_occlusion_1(highp vec4 pos,highp float bias) {highp vec2 uv=pos.xy;return shadow_sample_1(uv,pos.z-bias);}float shadow_occlusion_0(highp vec4 pos,highp float bias) {highp float compare0=pos.z-bias;
#ifdef TEXTURE_GATHER
highp vec2 uv=pos.xy;highp vec4 samples=textureGather(u_shadowmap_0,uv,0);lowp vec4 stepSamples=step(samples,vec4(compare0));
#else
highp vec2 uv00=pos.xy-vec2(0.5*u_shadow_texel_size);highp vec2 uv10=uv00+vec2(u_shadow_texel_size,0.0);highp vec2 uv01=uv00+vec2(0.0,u_shadow_texel_size);highp vec2 uv11=uv01+vec2(u_shadow_texel_size,0.0);lowp vec4 stepSamples=vec4(
shadow_sample_0(uv01,compare0),shadow_sample_0(uv11,compare0),shadow_sample_0(uv10,compare0),shadow_sample_0(uv00,compare0)
);
#endif
vec2 f=fract(pos.xy*u_shadow_map_resolution-vec2(0.5));lowp vec2 lerpx=mix(stepSamples.wx,stepSamples.zy,f.xx);return mix(lerpx.x,lerpx.y,f.y);}float shadow_occlusion(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,highp float bias) {
#ifdef SHADOWS_SINGLE_CASCADE
light_view_pos0.xyz/=light_view_pos0.w;vec2 abs_bounds=abs(light_view_pos0.xy);if (abs_bounds.x >=1.0 || abs_bounds.y >=1.0) {return 0.0;}light_view_pos0.xyz=light_view_pos0.xyz*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);
#else
light_view_pos0.xyz/=light_view_pos0.w;light_view_pos1.xyz/=light_view_pos1.w;vec4 uv=vec4(light_view_pos0.xy,light_view_pos1.xy);vec4 abs_bounds=abs(uv);if (abs_bounds.x < 1.0 && abs_bounds.y < 1.0) {light_view_pos0.xyz=light_view_pos0.xyz*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);}if (abs_bounds.z >=1.0 || abs_bounds.w >=1.0) {return 0.0;}light_view_pos1.xyz=light_view_pos1.xyz*0.5+0.5;float occlusion1=shadow_occlusion_1(light_view_pos1,bias);return mix(occlusion1,0.0,smoothstep(u_fade_range.x,u_fade_range.y,view_depth));
#endif
}highp float calculate_shadow_bias(float NDotL) {
#ifdef NORMAL_OFFSET
return 0.5*u_shadow_bias.x;
#else
return 0.5*(u_shadow_bias.x+clamp(u_shadow_bias.y*tan(acos(NDotL)),0.0,u_shadow_bias.z));
#endif
}float shadowed_light_factor_normal(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_opacity(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,float shadow_opacity) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias)*shadow_opacity;return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_unbiased(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}highp vec2 compute_receiver_plane_depth_bias(highp vec3 pos_dx,highp vec3 pos_dy)
{highp vec2 biasUV=vec2(
pos_dy.y*pos_dx.z-pos_dx.y*pos_dy.z,pos_dx.x*pos_dy.z-pos_dy.x*pos_dx.z);biasUV*=1.0/((pos_dx.x*pos_dy.y)-(pos_dx.y*pos_dy.x));return biasUV;}float shadowed_light_factor_plane_bias(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {highp vec3 light_view_pos0_xyz=light_view_pos0.xyz/light_view_pos0.w*0.5+0.5;highp vec3 light_view_pos0_ddx=dFdx(light_view_pos0_xyz);highp vec3 light_view_pos0_ddy=dFdy(light_view_pos0_xyz);highp vec2 plane_depth_bias=compute_receiver_plane_depth_bias(light_view_pos0_ddx,light_view_pos0_ddy);highp float bias=dot(vec2(u_shadow_texel_size,u_shadow_texel_size),plane_depth_bias)+0.0001;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadowed_light_factor(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadow_occlusion(float ndotl,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=calculate_shadow_bias(ndotl);return shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);}
#endif`;const ps=[];Ec(Hf,ps),Ec(Zf,ps),Ec(wh,ps);const Sc={"_prelude_fog.vertex.glsl":Nm,"_prelude_terrain.vertex.glsl":mp,"_prelude_shadow.vertex.glsl":fo,"_prelude_fog.fragment.glsl":wc,"_prelude_shadow.fragment.glsl":ka,"_prelude_lighting.glsl":`
#ifdef LIGHTING_3D_MODE
uniform mediump vec3 u_lighting_ambient_color;uniform mediump vec3 u_lighting_directional_dir;uniform mediump vec3 u_lighting_directional_color;uniform mediump vec3 u_ground_radiance;float calculate_ambient_directional_factor(vec3 normal) {float NdotL=dot(normal,u_lighting_directional_dir);const float factor_reduction_max=0.3;float dir_luminance=dot(u_lighting_directional_color,vec3(0.2126,0.7152,0.0722));float directional_factor_min=1.0-factor_reduction_max*min(dir_luminance,1.0);float ambient_directional_factor=mix(directional_factor_min,1.0,min((NdotL+1.0),1.0));const float vertical_factor_min=0.92;float vertical_factor=mix(vertical_factor_min,1.0,normal.z*0.5+0.5);return vertical_factor*ambient_directional_factor;}vec3 linearProduct(vec3 srgbIn,vec3 k) {return srgbIn*pow(k,vec3(1./2.2));}vec3 apply_lighting(vec3 color,vec3 normal,float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return linearProduct(color,ambient_contrib+directional_contrib);}vec4 apply_lighting(vec4 color,vec3 normal,float dir_factor) {return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting(vec3 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return apply_lighting(color.rgb,normal,dir_factor);}vec4 apply_lighting(vec4 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting_ground(vec3 color) {return color*u_ground_radiance;}vec4 apply_lighting_ground(vec4 color) {return vec4(apply_lighting_ground(color.rgb),color.a);}float calculate_NdotL(vec3 normal) {const float ext=0.70710678118;return (clamp(dot(normal,u_lighting_directional_dir),-ext,1.0)+ext)/(1.0+ext);}vec4 apply_lighting_with_emission_ground(vec4 color,float emissive_strength) {return mix(apply_lighting_ground(color),color,emissive_strength);}vec3 compute_flood_lighting(vec3 flood_light_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=flood_light_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);float occlusion_ramp=smoothstep(0.0,0.2,1.0-occlusion);return mix(fully_occluded_color,flood_light_color,occlusion_ramp);}vec3 compute_emissive_draped(vec3 unlit_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=unlit_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);return mix(fully_occluded_color,unlit_color,1.0-occlusion);}
#endif//LIGHTING_3D_MODE`,"_prelude_raster_array.glsl":bu,"_prelude_raster_particle.glsl":Sh},Tc={};sr("",mp),sr(wc,Nm),sr(ka,fo),sr(bu,""),sr(Sh,"");const wu=sr(wh,Zf),Su=Hf;var $o={background:sr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
in vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_lighting.glsl"
in vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform mediump vec4 u_color;out vec4 v_color;uniform float u_emissive_strength;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting_with_emission_ground(u_color,u_emissive_strength);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:sr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform float u_emissive_strength;uniform sampler2D u_image;in highp vec2 v_pos;void main() {highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=textureLodCustom(u_image,pos,v_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec2 u_pattern_units_to_pixels;in vec2 a_pos;out highp vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_pattern_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:sr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
uniform float u_emissive_strength;void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float blur_positive=blur < 0.0 ? 0.0 : 1.0;lowp float antialiasblur=v_data.z;float extrude_length=length(extrude)+antialiasblur*(1.0-blur_positive);float antialiased_blur=-max(abs(blur),antialiasblur);float antialiase_blur_opacity=smoothstep(0.0,antialiasblur,extrude_length-1.0);float opacity_t=blur_positive==1.0 ? 
smoothstep(0.0,-antialiased_blur,1.0-extrude_length) : 
smoothstep(antialiased_blur,0.0,extrude_length-1.0)-antialiase_blur_opacity;float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
glFragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
#ifdef ELEVATED_ROADS
in float a_circle_z_offset;
#endif
out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
#ifdef ELEVATED_ROADS
world_center.z+=a_circle_z_offset+ELEVATION_BIAS;
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:sr("void main() {glFragColor=vec4(1.0);}","in vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:sr(`#include "_prelude_fog.fragment.glsl"
uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);glFragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {glFragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:sr(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));glFragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(0.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,"in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:sr("in float v_placed;in float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);glFragColor =mix(red,blue,step(0.5,v_placed))*0.5;glFragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`#include "_prelude_terrain.vertex.glsl"
in vec3 a_pos;in vec2 a_anchor_pos;in vec2 a_extrude;in vec2 a_placed;in vec2 a_shift;in vec2 a_elevation_from_sea;in float a_size_scale;in vec2 a_padding;in float a_auto_z_offset;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;out float v_placed;out float v_notUsed;void main() {float feature_elevation=a_elevation_from_sea.x+a_auto_z_offset;float terrain_elevation=(a_elevation_from_sea.y==1.0 ? 0.0 : elevation(a_anchor_pos));vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*(feature_elevation+terrain_elevation),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:sr("in float v_radius;in vec2 v_extrude;in float v_perspective_ratio;in float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);glFragColor=color*alpha*opacity_t;}",`in vec2 a_pos_2f;in float a_radius;in vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;out float v_radius;out vec2 v_extrude;out float v_perspective_ratio;out float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:sr("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);glFragColor=mix(u_color,overlay_color,overlay_color.a);}",`#include "_prelude_terrain.vertex.glsl"
in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;
#endif
out vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:sr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=opacity;
#ifdef INDICATOR_CUTOUT
if (v_z_offset >=0.0) {out_color=applyCutout(out_color,v_z_offset);}
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=z_offset;
#endif
}`),fillOutline:sr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
in highp vec2 v_pos;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
uniform mat4 u_matrix;uniform vec2 u_world;out highp vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:sr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
in highp vec2 v_pos;in highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
out highp vec2 v_pos;out highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:sr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;in highp vec2 v_pos;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
out highp vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:sr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec4 v_color;in vec4 v_flat;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;
#endif
uniform lowp float u_opacity;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec2 v_ao;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
in vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
in highp vec3 v_normal;
#endif
uniform vec3 u_flood_light_color;uniform highp float u_vertical_scale;uniform float u_flood_light_intensity;uniform vec3 u_ground_shadow_factor;
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
in float v_flood_radius;in float v_has_floodlight;
#endif
in float v_height;
#pragma mapbox: define highp float emissive_strength
void main() {
#pragma mapbox: initialize highp float emissive_strength
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
vec3 normal=normalize(v_normal);
#endif
float z;vec4 color=v_color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);
#ifdef LIGHTING_3D_MODE
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#else
color=mix(v_color,v_roof_color,z);
#endif
#endif
float h=max(0.0,v_height);float ao_shade=1.0;
#ifdef FAUX_AO
float intensity=u_ao[0];float h_floors=h/(u_ao[1]*u_vertical_scale);float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);ao_shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);ao_shade*=mix(1.0,x_shade*x_shade*x_shade,concave);
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
color.rgb*=mix(ao_shade,1.0,v_has_floodlight);
#else
color.rgb*=ao_shade;
#endif
#else
color.rgb*=ao_shade;
#endif
#endif
#ifdef LIGHTING_3D_MODE
float flood_radiance=0.0;
#ifdef FLOOD_LIGHT
flood_radiance=(1.0-min(h/v_flood_radius,1.0))*u_flood_light_intensity*v_has_floodlight;
#endif
#ifdef RENDER_SHADOWS
#ifdef FLOOD_LIGHT
float ndotl_unclamped=dot(normal,u_shadow_direction);float ndotl=max(0.0,ndotl_unclamped);float occlusion=ndotl_unclamped < 0.0 ? 1.0 : shadow_occlusion(ndotl,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 litColor=apply_lighting(color.rgb,normal,(1.0-u_shadow_intensity*occlusion)*ndotl);vec3 floodLitColor=compute_flood_lighting(u_flood_light_color*u_opacity,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=mix(litColor,floodLitColor,flood_radiance);
#else
float shadowed_lighting_factor;
#ifdef RENDER_CUTOFF
shadowed_lighting_factor=shadowed_light_factor_normal_opacity(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,v_cutoff_opacity);if (v_cutoff_opacity==0.0) {discard;}
#else
shadowed_lighting_factor=shadowed_light_factor_normal(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);
#endif
color.rgb=apply_lighting(color.rgb,normal,shadowed_lighting_factor);
#endif
#else
color.rgb=apply_lighting(color.rgb,normal);
#ifdef FLOOD_LIGHT
color.rgb=mix(color.rgb,u_flood_light_color*u_opacity,flood_radiance);
#endif
#endif
color.rgb=mix(color.rgb,v_flat.rgb,emissive_strength);color*=u_opacity;
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos,h));
#endif
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,h);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;uniform float u_width_scale;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
uniform highp float u_vertical_scale;out vec4 v_color;out vec4 v_flat;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
out vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
out highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec2 v_ao;
#endif
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
out float v_flood_radius;out float v_has_floodlight;
#endif
out float v_height;vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define highp float flood_light_wall_radius
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp float emissive_strength
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize highp float flood_light_wall_radius
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp float emissive_strength
base*=u_vertical_scale;height*=u_vertical_scale;vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
v_normal=normal;
#endif
base=max(0.0,base);float attr_height=height;height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele=0.0;vec3 pos;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;ele=elevation(pos_nx.xy);c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);h=t > 0.0 ? max(h_base,h_height) : h_base;pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float cutoff=1.0;vec3 scaled_pos=pos;
#ifdef RENDER_CUTOFF
vec3 centroid_random=vec3(centroid_pos.xy,centroid_pos.x+centroid_pos.y+1.0);vec3 ground_pos=centroid_pos.x==0.0 ? pos.xyz : (centroid_random/8.0);vec4 ground=u_matrix*vec4(ground_pos.xy,ele,1.0);cutoff=cutoff_opacity(u_cutoff_params,ground.z);if (centroid_pos.y !=0.0 && centroid_pos.x !=0.0) {vec3 g=floor(ground_pos);vec3 mod_=centroid_random-g*8.0;float seed=min(1.0,0.1*(min(3.5,max(mod_.x+mod_.y,0.2*attr_height))*0.35+mod_.z));if (cutoff < 0.8-seed) {cutoff=0.0;}}float cutoff_scale=cutoff;v_cutoff_opacity=cutoff;scaled_pos.z=mix(c_ele,h,cutoff_scale);
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (cutoff==0.0 && centroid_pos.x !=0.0) || (color.a==0.0));
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);scaled_pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;scaled_pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
gl_Position=mix(u_matrix*vec4(scaled_pos,1),AWAY,hidden);h=h-ele;v_height=h;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=pos;vec3 shd_pos1=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(normal);shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifndef LIGHTING_3D_MODE
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);if (normal.y !=0.0) {float r=0.84;r=mix(0.7,0.98,1.0-u_lightintensity);NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#endif
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec2(mix(concave,-concave,start),y_ground);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
float is_wall=1.0-float(t > 0.0 && top_up_ny.y > 0.0);v_has_floodlight=float(flood_light_wall_radius > 0.0 && is_wall > 0.0);v_flood_radius=flood_light_wall_radius*u_vertical_scale;
#endif
v_color=vec4(color.rgb,1.0);float ndotl=calculate_NdotL(normal);v_flat.rgb=sRGBToLinear(color.rgb);v_flat.rgb=v_flat.rgb*(ndotl+(1.0-min(ndotl*57.29,1.0))*emissive_strength);v_flat=vec4(linearTosRGB(v_flat.rgb),1.0);
#else
v_color=vec4(0.0,0.0,0.0,1.0);v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color=vec4(0.0,0.0,0.0,1.0);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionDepth:sr(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_edge_radius;uniform float u_width_scale;uniform float u_vertical_scale;
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp vec4 color
out highp float v_depth;void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp vec4 color
base*=u_vertical_scale;height*=u_vertical_scale;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
vec3 pos;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;float ele=elevation(pos_nx.xy);float c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);float h=t > 0.0 ? max(h_base,h_height) : h_base;pos=vec3(pos_nx.xy,h);
#else
pos=vec3(pos_nx.xy,t > 0.0 ? height : base);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);v_depth=gl_Position.z/gl_Position.w;}`),fillExtrusionPattern:sr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
in vec3 v_normal;
#endif
in highp vec2 v_pos;in vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define highp float pixel_ratio
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize highp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,normalize(v_normal))*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,height);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_width_scale;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
out highp vec2 v_pos;out vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
out vec3 v_normal;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define highp float pixel_ratio
#pragma mapbox: define highp float line_width
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize highp float pixel_ratio
#pragma mapbox: initialize highp float line_width
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;ele=elevation(pos_nx.xy);c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);h=t > 0.0 ? max(h_base,h_height) : h_base;p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);p.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;p.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_normal=normal;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif 
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),groundShadow:sr(`#include "_prelude_shadow.fragment.glsl"
precision highp float;uniform vec3 u_ground_shadow_factor;in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#ifdef FOG
in float v_fog_opacity;
#endif
void main() {float light=shadowed_light_factor_plane_bias(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 shadow=mix(u_ground_shadow_factor,vec3(1.0),light);
#ifdef RENDER_CUTOFF
shadow=mix(vec3(1.0),shadow,cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w));
#endif
#ifdef FOG
shadow=mix(shadow,vec3(1.0),v_fog_opacity);
#endif
#ifdef INDICATOR_CUTOUT
shadow=mix(shadow,vec3(1.0),1.0-applyCutout(vec4(1.0),0.0).r);
#endif
glFragColor=vec4(shadow,1.0);}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;in vec2 a_pos;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;
#ifdef FOG
out float v_fog_opacity;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0.0,1.0);v_pos_light_view_0=u_light_matrix_0*vec4(a_pos,0.0,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(a_pos,0.0,1.0);
#ifdef FOG
v_fog_pos=fog_position(a_pos);v_fog_opacity=fog(v_fog_pos);
#endif
}`),fillExtrusionGroundEffect:sr(`uniform highp float u_ao_pass;uniform highp float u_opacity;uniform highp float u_flood_light_intensity;uniform highp vec3 u_flood_light_color;uniform highp float u_attenuation;uniform sampler2D u_fb;uniform float u_fb_size;
#ifdef SDF_SUBPASS
in highp vec2 v_pos;in highp vec4 v_line_segment;in highp float v_flood_light_radius_tile;in highp vec2 v_ao;float line_df(highp vec2 a,highp vec2 b,highp vec2 p) {highp vec2 ba=b-a;highp vec2 pa=p-a;highp float r=clamp(dot(pa,ba)/dot(ba,ba),0.0,1.0);return length(pa-r*ba);}
#ifdef FOG
in highp float v_fog;
#endif
#endif
void main() {
#ifdef CLEAR_SUBPASS
vec4 color=vec4(1.0);
#ifdef CLEAR_FROM_TEXTURE
color=texture(u_fb,gl_FragCoord.xy/vec2(u_fb_size));
#endif
glFragColor=color;
#else
#ifdef SDF_SUBPASS
highp float d=line_df(v_line_segment.xy,v_line_segment.zw,v_pos);highp float effect_radius=mix(v_flood_light_radius_tile,v_ao.y,u_ao_pass);d/=effect_radius;d=min(d,1.0);d=1.0-pow(1.0-d,u_attenuation);highp float effect_intensity=mix(u_flood_light_intensity,v_ao.x,u_ao_pass);highp float fog=1.0;
#ifdef FOG
fog=v_fog;
#endif
#ifdef RENDER_CUTOFF
fog*=v_cutoff_opacity;
#endif
glFragColor=vec4(vec3(0.0),mix(1.0,d,effect_intensity*u_opacity*fog));
#else
vec4 color=mix(vec4(u_flood_light_color,1.0),vec4(vec3(0.0),1.0),u_ao_pass);
#ifdef OVERDRAW_INSPECTOR
color=vec4(1.0);
#endif
glFragColor=color;
#endif
HANDLE_WIREFRAME_DEBUG;
#endif
}`,`#include "_prelude_fog.vertex.glsl"
in highp vec4 a_pos_end;in highp float a_angular_offset_factor;in highp float a_hidden_by_landmark;
#ifdef SDF_SUBPASS
out highp vec2 v_pos;out highp vec4 v_line_segment;out highp float v_flood_light_radius_tile;out highp vec2 v_ao;
#ifdef FOG
out highp float v_fog;
#endif
#endif
uniform highp float u_flood_light_intensity;uniform highp mat4 u_matrix;uniform highp float u_ao_pass;uniform highp float u_meter_to_tile;uniform highp float u_edge_radius;uniform highp float u_dynamic_offset;uniform highp vec2 u_ao;
#pragma mapbox: define highp float flood_light_ground_radius
const float TANGENT_CUTOFF=4.0;const float NORM=32767.0;void main() {
#pragma mapbox: initialize highp float flood_light_ground_radius
vec2 p=a_pos_end.xy;vec2 q=floor(a_pos_end.zw*0.5);vec2 start_bottom=a_pos_end.zw-q*2.0;float fl_ground_radius=flood_light_ground_radius;fl_ground_radius=abs(flood_light_ground_radius);float direction=flood_light_ground_radius < 0.0 ?-1.0 : 1.0;float flood_radius_tile=fl_ground_radius*u_meter_to_tile;vec2 v=normalize(q-p);float ao_radius=u_ao.y/3.5;float effect_radius=mix(flood_radius_tile,ao_radius,u_ao_pass)+u_edge_radius;float angular_offset_factor=a_angular_offset_factor/NORM*TANGENT_CUTOFF;float angular_offset=direction*angular_offset_factor*effect_radius;float top=1.0-start_bottom.y;float side=(0.5-start_bottom.x)*2.0;vec2 extrusion_parallel=v*side*mix(u_dynamic_offset,angular_offset,top);vec2 perp=vec2(v.y,-v.x);vec2 extrusion_perp=direction*perp*effect_radius*top;vec3 pos=vec3(mix(q,p,start_bottom.x),0.0);pos.xy+=extrusion_parallel+extrusion_perp;
#ifdef SDF_SUBPASS
v_pos=pos.xy;v_line_segment=vec4(p,q)+perp.xyxy*u_edge_radius;v_flood_light_radius_tile=flood_radius_tile;v_ao=vec2(u_ao.x,ao_radius);
#ifdef FOG
v_fog_pos=fog_position(pos);v_fog=1.0-fog(v_fog_pos);
#endif
#endif
float hidden_by_landmark=0.0;
#ifdef HAS_CENTROID
hidden_by_landmark=a_hidden_by_landmark;
#endif
float isFloodlit=float(fl_ground_radius > 0.0 && u_flood_light_intensity > 0.0);float hidden=mix(1.0-isFloodlit,isFloodlit,u_ao_pass);hidden+=hidden_by_landmark;gl_Position=mix(u_matrix*vec4(pos,1.0),AWAY,float(hidden > 0.0));
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
}`),hillshadePrepare:sr(`precision highp float;uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;float getElevation(vec2 coord) {return texture(u_image,coord).r/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));glFragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:sr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;uniform float u_emissive_strength;void main() {vec4 pixel=texture(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);glFragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
glFragColor=apply_lighting_with_emission_ground(glFragColor,u_emissive_strength);
#endif
#ifdef FOG
glFragColor=fog_dither(fog_apply_premultiplied(glFragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:sr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform lowp float u_device_pixel_ratio;uniform highp float u_width_scale;uniform highp float u_floor_width_scale;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;uniform highp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec3 v_uv;
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;in vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float dist=length(v_normal)*v_width2.s;float blur2=(u_width_scale*blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture(u_dash_image,v_tex).r;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;float scaled_floorwidth=(floorwidth*u_floor_width_scale);alpha*=linearstep(0.5-sdfgamma/scaled_floorwidth,0.5+sdfgamma/scaled_floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trim_alpha=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=v_uv[2];if (trim_end > trim_start) {highp float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/max(u_trim_fade_range[0],1.0e-9)));highp float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/max(u_trim_fade_range[1],1.0e-9)));highp float transition_factor=min(start_transition,end_transition);out_color=mix(out_color,u_trim_color,transition_factor);trim_alpha=1.0-transition_factor;}
#endif
if (u_alpha_discard_threshold !=0.0) {if (alpha < u_alpha_discard_threshold) {discard;}}
#ifdef RENDER_LINE_BORDER
float edgeBlur=((border_width*u_width_scale)+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);if (border_color.a==0.0) {float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}} else {out_color=mix(border_color*trim_alpha,out_color,smoothAlpha);}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
out_color.rgb*=mix(v_road_z_offset > 0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=(alpha*opacity);
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_z_offset);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define EXTRUDE_SCALE 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS) || defined(VARIABLE_LINE_WIDTH)
in vec3 a_z_offset_width;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
in highp vec3 a_packed;
#endif
#ifdef RENDER_LINE_DASH
in float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;uniform float u_width_scale;uniform highp float u_floor_width_scale;
#ifdef ELEVATED
uniform lowp float u_zbias_factor;uniform lowp float u_tile_to_meter;float sample_elevation(vec2 apos) {
#ifdef ELEVATION_REFERENCE_SEA
return 0.0;
#else
return elevation(apos);
#endif
}
#endif
out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec3 v_uv;
#ifdef ELEVATED_ROADS
out highp float v_road_z_offset;
#endif
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;out vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float a_z_offset;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
a_z_offset=a_z_offset_width.x;
#endif
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth;
#ifdef VARIABLE_LINE_WIDTH
float left=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);halfwidth=(u_width_scale*(left==1.0 ? a_z_offset_width.y : a_z_offset_width.z))/2.0;
#else
halfwidth=(u_width_scale*width)/2.0;
#endif
offset=-1.0*offset*u_width_scale;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec2 extrude=dist*u_pixels_to_tile_units;vec4 projected_extrude=u_matrix*vec4(extrude,0.0,0.0);vec2 projected_extrude_xy=projected_extrude.xy;
#ifdef ELEVATED_ROADS
v_road_z_offset=a_z_offset;gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset,1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 offset_pos=pos+offsetTile;float ele=0.0;
#ifdef CROSS_SLOPE_VERTICAL
float top=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);float line_height=2.0*u_tile_to_meter*outset*top*u_pixels_to_tile_units[1][1]+a_z_offset;ele=sample_elevation(offset_pos)+line_height;projected_extrude=vec4(0);
#else
#ifdef CROSS_SLOPE_HORIZONTAL
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,max(ele1,ele2));ele=ele_max+a_z_offset;
#else
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,0.5*(ele1+ele2));ele=ele_max-ele0+ele1+a_z_offset;
#endif
#endif
gl_Position=u_matrix*vec4(offset_pos,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*u_zbias_factor*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifdef ELEVATED_ROADS
#ifdef RENDER_SHADOWS
vec3 shd_pos=vec3(pos+(offset2+dist)*u_pixels_to_tile_units,a_z_offset);vec3 shd_pos0=shd_pos;vec3 shd_pos1=shd_pos;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude_xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=mix(extrude_length_without_perspective/extrude_length_with_perspective,1.0,step(0.01,blur));
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
highp float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float line_progress=a_packed[2];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec3(a_uv_x,a_split_index*texel_height-half_texel_height,line_progress);
#else
v_uv=vec3(a_uv_x,0.0,line_progress);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/(floorwidth*u_floor_width_scale),(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=a_z_offset;
#endif
}`),linePattern:sr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform highp float u_device_pixel_ratio;uniform highp float u_width_scale;uniform highp float u_alpha_discard_threshold;uniform highp vec2 u_texsize;uniform highp float u_tile_units_to_pixels;uniform highp vec2 u_trim_offset;uniform highp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in highp float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec3 v_uv;
#endif
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef LINE_JOIN_NONE
in vec2 v_pattern_data;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
uniform float u_emissive_strength;
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define mediump float pixel_ratio
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize mediump float pixel_ratio
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;highp float pattern_size=display_size.x/u_tile_units_to_pixels;float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(u_width_scale*blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);highp float pattern_x=v_linesofar/pattern_size*aspect;highp float x=mod(pattern_x,1.0);highp float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;highp vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));highp vec2 lod_pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(pattern_x,y));vec4 color=textureLodCustom(u_image,pos,lod_pos);
#ifdef RENDER_LINE_TRIM_OFFSET
highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=v_uv[2];if (trim_end > trim_start) {highp float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/max(u_trim_fade_range[0],1.0e-9)));highp float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/max(u_trim_fade_range[1],1.0e-9)));highp float transition_factor=min(start_transition,end_transition);color=mix(color,color.a*u_trim_color,transition_factor);}
#endif
#ifdef LINE_JOIN_NONE
highp float pattern_len=pattern_size/aspect;highp float segment_phase=pattern_len-mod(v_linesofar-v_pattern_data.x+pattern_len,pattern_len);highp float visible_start=segment_phase-step(pattern_len*0.5,segment_phase)*pattern_len;highp float visible_end=floor((v_pattern_data.y-segment_phase)/pattern_len)*pattern_len+segment_phase;visible_end+=step(pattern_len*0.5,v_pattern_data.y-visible_end)*pattern_len;if (v_pattern_data.x < visible_start || v_pattern_data.x >=visible_end) {color=vec4(0.0);}
#endif
#ifdef LIGHTING_3D_MODE
color=apply_lighting_with_emission_ground(color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
color.rgb*=mix(v_road_z_offset > 0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=(alpha*opacity);if (u_alpha_discard_threshold !=0.0) {if (color.a < u_alpha_discard_threshold) {discard;}}
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,v_z_offset);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
in vec3 a_z_offset_width;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec3 a_packed;
#endif
in highp float a_linesofar;
#ifdef LINE_JOIN_NONE
in highp vec3 a_pattern_data;out vec2 v_pattern_data;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
uniform mat4 u_matrix;uniform float u_tile_units_to_pixels;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform float u_device_pixel_ratio;uniform float u_width_scale;uniform float u_floor_width_scale;
#ifdef ELEVATED
uniform lowp float u_zbias_factor;uniform lowp float u_tile_to_meter;float sample_elevation(vec2 apos) {
#ifdef ELEVATION_REFERENCE_SEA
return 0.0;
#else
return elevation(apos);
#endif
}
#endif
out vec2 v_normal;out vec2 v_width2;out highp float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
out highp vec3 v_uv;
#endif
#ifdef ELEVATED_ROADS
out highp float v_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
#pragma mapbox: define mediump float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define mediump float floorwidth
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define mediump float pixel_ratio
void main() {
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
#pragma mapbox: initialize mediump float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize mediump float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize mediump float pixel_ratio
float a_z_offset;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
a_z_offset=a_z_offset_width.x;
#endif
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=(u_width_scale*width)/2.0;offset=-1.0*offset*u_width_scale;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);vec2 dist=outset*a_extrude*scale;float u=0.5*a_direction;float t=1.0-abs(u);vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec2 extrude=dist*u_pixels_to_tile_units;vec4 projected_extrude=u_matrix*vec4(extrude,0.0,0.0);vec2 projected_extrude_xy=projected_extrude.xy;
#ifdef ELEVATED_ROADS
v_road_z_offset=a_z_offset;gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset,1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 offset_pos=pos+offsetTile;float ele=0.0;
#ifdef CROSS_SLOPE_VERTICAL
float top=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);float line_height=2.0*u_tile_to_meter*outset*top*u_pixels_to_tile_units[1][1]+a_z_offset;ele=sample_elevation(offset_pos)+line_height;projected_extrude=vec4(0);
#else
#ifdef CROSS_SLOPE_HORIZONTAL
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,max(ele1,ele2));ele=ele_max+a_z_offset;
#else
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,0.5*(ele1+ele2));ele=ele_max-ele0+ele1+a_z_offset;
#endif
#endif
gl_Position=u_matrix*vec4(offset_pos,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*u_zbias_factor*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifdef ELEVATED_ROADS
#ifdef RENDER_SHADOWS
vec3 shd_pos=vec3(pos+(offset2+dist)*u_pixels_to_tile_units,a_z_offset);vec3 shd_pos0=shd_pos;vec3 shd_pos1=shd_pos;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude_xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=mix(extrude_length_without_perspective/extrude_length_with_perspective,1.0,step(0.01,blur));
#else
v_gamma_scale=1.0;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
highp float a_uv_x=a_packed[0];highp float line_progress=a_packed[2];v_uv=vec3(a_uv_x,0.0,line_progress);
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=(floorwidth*u_floor_width_scale);
#ifdef LINE_JOIN_NONE
v_width=(floorwidth*u_floor_width_scale)+ANTIALIASING;mediump float pixels_to_tile_units=1.0/u_tile_units_to_pixels;mediump float pixel_ratio_inverse=1.0/pixel_ratio;mediump float aspect=v_width/((pattern.w-pattern.y)*pixel_ratio_inverse);highp float subt_multiple=(pattern.z-pattern.x)*pixel_ratio_inverse*pixels_to_tile_units*aspect*32.0;highp float subt=floor(a_pattern_data.z/subt_multiple)*subt_multiple;float offset_sign=(fract(a_pattern_data.x)-0.5)*4.0;float line_progress_offset=offset_sign*v_width*0.5*pixels_to_tile_units;v_linesofar=(a_pattern_data.z-subt)+a_linesofar+line_progress_offset;v_pattern_data=vec2(a_pattern_data.x+line_progress_offset,a_pattern_data.y);
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=a_z_offset;
#endif
}`),raster:sr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_raster_array.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;uniform highp float u_zoom_transition;in vec2 v_pos0;in vec2 v_pos1;in float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
in float v_split_fade;
#endif
uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;uniform float u_emissive_strength;
#ifndef RASTER_ARRAY
uniform highp sampler2D u_image0;uniform sampler2D u_image1;
#endif
#ifdef RASTER_COLOR
uniform sampler2D u_color_ramp;uniform highp vec4 u_colorization_mix;uniform highp float u_colorization_offset;uniform vec2 u_texture_res;
#endif
void main() {vec4 color0,color1,color;vec2 value;
#ifdef RASTER_COLOR
#ifdef RASTER_ARRAY
#ifdef RASTER_ARRAY_LINEAR
value=mix(
raTexture2D_image0_linear(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_linear(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#else
value=mix(
raTexture2D_image0_nearest(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_nearest(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#endif
if (value.y > 0.0) value.x/=value.y;
#else
color=mix(texture(u_image0,v_pos0),texture(u_image1,v_pos1),u_fade_t);value=vec2(u_colorization_offset+dot(color.rgb,u_colorization_mix.rgb),color.a);
#endif
color=texture(u_color_ramp,vec2(value.x,0.5));if (color.a > 0.0) color.rgb/=color.a;color.a*=value.y;
#else
color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);
#endif
color.a*=u_opacity;
#ifdef GLOBE_POLES
color.a*=1.0-smoothstep(0.0,0.05,u_zoom_transition);
#endif
vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),u_emissive_strength).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef PROJECTION_GLOBE_VIEW
glFragColor*=mix(1.0,1.0-smoothstep(0.0,0.05,u_zoom_transition),smoothstep(0.8,0.9,v_split_fade));
#endif
#ifdef RENDER_CUTOFF
glFragColor=glFragColor*cutoff_opacity(u_cutoff_params,v_depth);
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;uniform vec2 u_texture_offset;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;in vec2 a_texture_pos;
#endif
out vec2 v_pos0;out vec2 v_pos1;out float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
out float v_split_fade;
#endif
void main() {vec2 uv;
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;gl_Position=u_matrix*u_globe_matrix*vec4(globe_pos   ,1.0);uv=a_uv;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(a_globe_pos,1.0)).xyz);
#endif
#else
float w=1.0+dot(a_texture_pos,u_perspective_transform);uv=a_texture_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);    
v_split_fade=0.0;if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;float opposite_merc_center=mod(u_merc_center.x+0.5,1.0);float dist_from_poles=(abs(mercatorY-0.5)*2.0);float range=0.1;v_split_fade=abs(opposite_merc_center-mercatorX);v_split_fade=clamp(1.0-v_split_fade,0.0,1.0);v_split_fade=max(smoothstep(1.0-range,1.0,dist_from_poles),max(smoothstep(1.0-range,1.0,v_split_fade),smoothstep(1.0-range,1.0,1.0-v_split_fade)));}float tiles=u_grid_matrix[0][2];if (tiles > 0.0) {float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvY=mercatorY*tiles-idy;float uvX=mercatorX*tiles-idx;uv=vec2(uvX,uvY);}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;v_pos0=u_texture_offset.x+u_texture_offset.y*v_pos0;v_pos1=u_texture_offset.x+u_texture_offset.y*v_pos1;
#ifdef RENDER_CUTOFF
v_depth=gl_Position.z;
#endif
}`),rasterParticle:sr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;in vec2 v_pos0;in vec2 v_pos1;uniform sampler2D u_image0;uniform sampler2D u_image1;void main() {vec4 color0,color1,color;color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 out_color=color.rgb;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),0.0).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {float w=1.0;vec2 uv;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvX=mercatorX*tiles-idx;float uvY=mercatorY*tiles-idy;uv=vec2(uvX,uvY);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
uv=a_texture_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),rasterParticleDraw:sr("uniform sampler2D u_color_ramp;in float v_particle_speed;void main() {glFragColor=texture(u_color_ramp,vec2(v_particle_speed,0.5));}",`#include "_prelude_raster_particle.glsl"
in float a_index;uniform sampler2D u_particle_texture;uniform float u_particle_texture_side_len;uniform vec2 u_tile_offset;out float v_particle_speed;void main() {ivec2 pixel_coord=ivec2(
mod(a_index,u_particle_texture_side_len),a_index/u_particle_texture_side_len);vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);vec2 pos=unpack_pos_from_rgba(pixel)+u_tile_offset;vec2 tex_coord=fract(pos);vec2 velocity=lookup_velocity(tex_coord);if (velocity==INVALID_VELOCITY) {gl_Position=AWAY;v_particle_speed=0.0;} else {gl_Position=vec4(2.0*pos-1.0,0,1);v_particle_speed=length(velocity);}gl_PointSize=1.0;}`),rasterParticleTexture:sr("uniform sampler2D u_texture;uniform float u_opacity;in vec2 v_tex_pos;void main() {vec4 color=texture(u_texture,v_tex_pos);glFragColor=vec4(floor(255.0*color*u_opacity)/255.0);}","in vec2 a_pos;out vec2 v_tex_pos;void main() {vec2 uv=0.5*a_pos+vec2(0.5);v_tex_pos=uv;gl_Position=vec4(a_pos,0.0,1.0);}"),rasterParticleUpdate:sr(`#include "_prelude_raster_particle.glsl"
uniform sampler2D u_particle_texture;uniform mediump float u_particle_texture_side_len;uniform mediump float u_speed_factor;uniform highp float u_reset_rate;uniform highp float u_rand_seed;in highp vec2 v_tex_coord;vec2 linearstep(vec2 edge0,vec2 edge1,vec2 x) {return  clamp((x-edge0)/(edge1-edge0),vec2(0),vec2(1));}const highp vec3 rand_constants=vec3(12.9898,78.233,4375.85453);highp float rand(const highp vec2 co) {highp float t=dot(rand_constants.xy,co);return fract(sin(t)*(rand_constants.z+t));}void main() {ivec2 pixel_coord=ivec2(v_tex_coord*u_particle_texture_side_len);highp vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);highp vec2 pos=unpack_pos_from_rgba(pixel);highp vec2 velocity=lookup_velocity(clamp(pos,0.0,1.0));highp vec2 dp=velocity==INVALID_VELOCITY ? vec2(0) : velocity*u_speed_factor;pos=pos+dp;highp vec2 seed=(pos+v_tex_coord)*u_rand_seed;highp vec2 random_pos=vec2(rand(seed+1.3),rand(seed+2.1));highp vec2 persist_rate=pow(
linearstep(vec2(-u_particle_pos_offset),vec2(0),pos)*linearstep(vec2(1.0+u_particle_pos_offset),vec2(1),pos),vec2(4)
);highp vec2 per_frame_persist=pow(persist_rate,abs(dp)/u_particle_pos_offset);highp float drop_rate=1.0-per_frame_persist.x*per_frame_persist.y;drop_rate=any(greaterThanEqual(abs(pos-0.5),vec2(0.5+u_particle_pos_offset))) ? 1.0 : drop_rate;highp float drop=step(1.0-drop_rate-u_reset_rate,rand(seed));highp vec2 next_pos=mix(pos,random_pos,drop);glFragColor=pack_pos_to_rgba(next_pos);}`,"in vec2 a_pos;out vec2 v_tex_coord;void main() {v_tex_coord=0.5*(a_pos+vec2(1.0));gl_Position=vec4(a_pos,0.0,1.0);}"),symbol:sr(`#include "_prelude_lighting.glsl"
#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;uniform bool u_is_halo;uniform lowp float u_scale_factor;
#ifdef ICON_TRANSITION
uniform float u_icon_transition;
#endif
#ifdef COLOR_ADJUSTMENT
uniform mat4 u_color_adj_mat;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
in vec2 v_tex_a;
#ifdef ICON_TRANSITION
in vec2 v_tex_b;
#endif
in float v_draw_halo;in vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
in float is_sdf;in vec2 v_tex_a_icon;
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
vec4 out_color;float fade_opacity=v_gamma_scale_size_fade_opacity[2];
#ifdef RENDER_TEXT_AND_SYMBOL
if (is_sdf==ICON) {vec2 tex_icon=v_tex_a_icon;lowp float alpha=opacity*fade_opacity;glFragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
return;}
#endif
#ifdef RENDER_SDF
float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_gamma_scale_size_fade_opacity.x;float size=v_gamma_scale_size_fade_opacity.y;float fontScale=u_is_text ? size/24.0 : size;out_color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo=v_draw_halo > 0.0;if (draw_halo) {out_color=halo_color;gamma=(halo_blur*u_scale_factor*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width*u_scale_factor/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,v_tex_a).r;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);out_color*=alpha;
#else
#ifdef ICON_TRANSITION
vec4 a=texture(u_texture,v_tex_a)*(1.0-u_icon_transition);vec4 b=texture(u_texture,v_tex_b)*u_icon_transition;out_color=(a+b);
#else
out_color=texture(u_texture,v_tex_a);
#endif
#ifdef COLOR_ADJUSTMENT
out_color=u_color_adj_mat*out_color;
#endif
#endif
out_color*=opacity*fade_opacity;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_z_offset);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
in vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_pixeloffset;in vec4 a_projected_pos;in float a_fade_opacity;
#ifdef Z_OFFSET
in float a_auto_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_globe_anchor;in vec3 a_globe_normal;
#endif
#ifdef ICON_TRANSITION
in vec2 a_texb;
#endif
#ifdef OCCLUSION_QUERIES
in float a_occlusion_query_opacity;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_elevation_from_sea;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;uniform bool u_is_halo;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
out vec2 v_tex_a;
#ifdef ICON_TRANSITION
out vec2 v_tex_b;
#endif
out float v_draw_halo;out vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
out float is_sdf;out vec2 v_tex_a_icon;
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
#pragma mapbox: define lowp float occlusion_opacity
#pragma mapbox: define lowp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
#pragma mapbox: initialize lowp float occlusion_opacity
#pragma mapbox: initialize lowp float z_offset
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=u_elevation_from_sea ? z_offset : z_offset+elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_auto_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;vec3 world_pos_globe;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos_globe=a_globe_anchor+h;world_pos=mix_globe_mercator(world_pos_globe,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;vec2 a;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);vec4 projected_point_globe=u_matrix*vec4(world_pos_globe,1);a=projected_point_globe.xy/projected_point_globe.w;
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);a=projected_point.xy/projected_point.w;
#endif
vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
#ifdef PROJECTED_POS_ON_VIEWPORT
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xyz+h,1.0);
#else
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz,mercator_pos,u_zoom_transition)+h;projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);    
#endif
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
#ifdef Z_OFFSET
z+=u_pitch_with_map ? a_auto_z_offset+(u_elevation_from_sea ? z_offset : z_offset) : 0.0;
#else
z+=u_pitch_with_map ? (u_elevation_from_sea ? z_offset : z_offset) : 0.0;
#endif
float occlusion_fade=globe_occlusion_fade;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float out_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));
#ifdef DEPTH_OCCLUSION
float depth_occlusion=occlusionFadeMultiSample(projected_point);float depth_occlusion_multplier=mix(occlusion_opacity,1.0,depth_occlusion);out_fade_opacity*=depth_occlusion_multplier;
#endif
#ifdef OCCLUSION_QUERIES
float occludedFadeMultiplier=mix(occlusion_opacity,1.0,a_occlusion_query_opacity);out_fade_opacity*=occludedFadeMultiplier;
#endif
float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);
#endif
float gamma_scale=gl_Position.w;v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;v_gamma_scale_size_fade_opacity=vec3(gamma_scale,size,out_fade_opacity);v_tex_a=a_tex/u_texsize;
#ifdef RENDER_TEXT_AND_SYMBOL
is_sdf=a_size[0]-2.0*a_size_min;v_tex_a_icon=a_tex/u_texsize_icon;
#endif
#ifdef ICON_TRANSITION
v_tex_b=a_texb/u_texsize;
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=e;
#endif
}`),terrainRaster:sr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;in vec2 v_pos0;
#ifdef FOG
in float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#endif
uniform vec3 u_ground_shadow_factor;void main() {vec4 image_color=texture(u_image0,v_pos0);vec4 color;
#ifdef LIGHTING_3D_MODE
const vec3 normal=vec3(0.0,0.0,1.0);
#ifdef RENDER_SHADOWS
float cutoffOpacity=1.0;
#ifdef RENDER_CUTOFF
cutoffOpacity=cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w);
#endif
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
vec3 unlit_base=image_color.rgb*(1.0-image_color.a);vec3 emissive_base=image_color.rgb*image_color.a;float ndotl=u_shadow_direction.z;float occlusion=ndotl < 0.0 ? 1.0 : shadow_occlusion(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,0.0);ndotl=max(0.0,ndotl);vec3 lit=apply_lighting(unlit_base,normal,mix(1.0,(1.0-(u_shadow_intensity*occlusion))*ndotl,cutoffOpacity));vec3 emissive=compute_emissive_draped(emissive_base,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=lit+emissive;color.a=1.0;
#else
float lighting_factor=shadowed_light_factor_normal_unbiased(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);color=apply_lighting(image_color,normal,mix(1.0,lighting_factor,cutoffOpacity));
#endif
#else
float lighting_factor=u_lighting_directional_dir.z;color=apply_lighting(image_color,normal,lighting_factor);
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color.rgb=mix(color.rgb,image_color.rgb,image_color.a);color.a=1.0;
#endif
#endif
#else
color=image_color;
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_skirt_height;in vec2 a_pos;out vec2 v_pos0;
#ifdef FOG
out float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;out float v_depth;
#endif
void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);
#endif
}`),terrainDepth:sr("precision highp float;in float v_depth;void main() {glFragColor=pack_depth(v_depth);}",`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;out float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}`),skybox:sr(`#include "_prelude_fog.fragment.glsl"
in lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=texture(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color+=0.1*sun_disk(v_uv,u_sun_direction);glFragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,bc),skyboxGradient:sr(`#include "_prelude_fog.fragment.glsl"
in highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,bc),skyboxCapture:sr(`
in highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;precision highp float;
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;glFragColor=vec4(color,1.0);}`,"in highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;out highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:sr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;uniform float u_far_z_cutoff;in vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;highp float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);highp float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
raster=apply_lighting_with_emission_ground(raster,raster.a);color=vec4(clamp(raster.rgb,vec3(0),vec3(1))*antialias,antialias);
#else
raster=apply_lighting_ground(raster);color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color=apply_lighting_with_emission_ground(color,color.a);color.a=1.0;
#else
color=apply_lighting_ground(color);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=1.0-step(u_far_z_cutoff,1.0/gl_FragCoord.w);glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;
#endif
out vec2 v_pos0;void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:sr(`#include "_prelude_fog.fragment.glsl"
uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec4 u_color;uniform vec4 u_high_color;uniform vec4 u_space_color;uniform float u_horizon_angle;in highp vec3 v_ray_dir;in highp vec3 v_horizon_dir;void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {
#ifdef ALPHA_PASS
glFragColor=vec4(0,0,0,0);return;
#else
#ifdef NATIVE
glFragColor=vec4(1,1,1,1);
#else
glFragColor=vec4(0,0,0,1);
#endif
return;
#endif
}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(clamp(dot(dir,horizon_dir),-1.0,1.0)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;highp float closest_point_to_center=length(closest_point-u_globe_pos);highp float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;
#ifdef ALPHA_PASS
float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);glFragColor=vec4(1.0,1.0,1.0,a);
#else
vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c=c2;glFragColor=vec4(c*t,t);
#endif
}`,`in vec3 a_pos;in vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;out highp vec3 v_ray_dir;out highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`),model:sr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_opacity;uniform vec3 u_lightcolor;uniform vec3 u_lightpos;uniform float u_lightintensity;uniform vec4 u_baseColorFactor;uniform vec4 u_emissiveFactor;uniform float u_metallicFactor;uniform float u_roughnessFactor;uniform float u_emissive_strength;in highp vec4 v_position_height;in lowp vec4 v_color_mix;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth_shadows;
#endif
#ifdef OCCLUSION_TEXTURE_TRANSFORM
uniform vec4 u_occlusionTextureTransform;
#endif
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#ifdef HAS_ATTRIBUTE_a_pbr
in lowp vec4 v_roughness_metallic_emissive_alpha;in mediump vec4 v_height_based_emission_params;
#endif
#ifdef HAS_TEXTURE_u_baseColorTexture
uniform sampler2D u_baseColorTexture;uniform bool u_baseTextureIsAlpha;uniform bool u_alphaMask;uniform float u_alphaCutoff;
#endif
#ifdef HAS_TEXTURE_u_metallicRoughnessTexture
uniform sampler2D u_metallicRoughnessTexture;
#endif
#ifdef HAS_TEXTURE_u_occlusionTexture
uniform sampler2D u_occlusionTexture;uniform float u_aoIntensity;
#endif
#ifdef HAS_TEXTURE_u_normalTexture
uniform sampler2D u_normalTexture;
#endif
#ifdef HAS_TEXTURE_u_emissionTexture
uniform sampler2D u_emissionTexture;
#endif
#ifdef APPLY_LUT_ON_GPU
uniform highp sampler3D u_lutTexture;
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
in highp float v_depth;uniform highp sampler2D u_depthTexture;uniform highp vec2 u_inv_depth_size;uniform highp vec2 u_depth_range_unpack;
#ifdef DEPTH_D24
highp float unpack_depth(highp float depth) {return  depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}
#else
highp float unpack_depth_rgba(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded() {highp vec2 coord=gl_FragCoord.xy*u_inv_depth_size;
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depthTexture,coord).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depthTexture,coord));
#endif
return v_depth > depth+0.0005;}
#endif
#define saturate(_x) clamp(_x,0.,1.)
vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}float calculate_NdotL(vec3 normal,vec3 lightDir) {const float ext=0.70710678118;return (clamp(dot(normal,lightDir),-ext,1.0)+ext)/(1.0+ext);}vec3 getDiffuseShadedColor(vec3 albedo,vec3 normal,vec3 lightDir,vec3 lightColor)
{
#ifdef LIGHTING_3D_MODE
vec3 transformed_normal=vec3(-normal.xy,normal.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=saturate(dot(transformed_normal,u_lighting_directional_dir));
#endif
return apply_lighting(albedo,transformed_normal,lighting_factor);
#else
vec3 n=normal;float colorvalue=((albedo.x*0.2126)+(albedo.y*0.7152))+(albedo.z*0.0722);vec3 c=vec3(0.03,0.03,0.03);float directional=clamp(dot(n,vec3(lightDir)),0.0,1.0);directional=mix(1.0-u_lightintensity,max((1.0-colorvalue)+u_lightintensity,1.0),directional);vec3 c3=c+clamp((albedo*directional)*lightColor,mix(vec3(0.0),vec3(0.3),vec3(1.0)-lightColor),vec3(1.0));return c3;
#endif
}vec4 getBaseColor() {vec4 albedo=u_baseColorFactor;
#ifdef HAS_ATTRIBUTE_a_color_3f
albedo*=vec4(color_3f,1.0);
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#else
#ifdef HAS_ATTRIBUTE_a_color_4f
albedo*=color_4f;
#endif
#endif
#if defined (HAS_TEXTURE_u_baseColorTexture) && defined (HAS_ATTRIBUTE_a_uv_2f)
vec4 texColor=texture(u_baseColorTexture,uv_2f);if(u_alphaMask) {if (texColor.w < u_alphaCutoff) {discard;}}
#ifdef UNPREMULT_TEXTURE_IN_SHADER
if(texColor.w > 0.0) {texColor.rgb/=texColor.w;}texColor.w=1.0;
#endif
if(u_baseTextureIsAlpha) {if (texColor.r < 0.5) {discard;}} else {texColor.rgb=sRGBToLinear(texColor.rgb);albedo*=texColor;}
#endif
vec4 color=vec4(mix(albedo.rgb,v_color_mix.rgb,v_color_mix.a),albedo.a);
#ifdef APPLY_LUT_ON_GPU
color=applyLUT(u_lutTexture,color);
#endif
return color;}highp mat3 cotangentFrame(highp vec3 N,highp vec3 p,highp vec2 uv ) {
#ifdef HAS_TEXTURE_u_normalTexture
highp vec3 dp1=vec3(dFdx(p.x),dFdx(p.y),dFdx(p.z));highp vec3 dp2=vec3(dFdy(p.x),dFdy(p.y),dFdy(p.z));highp vec2 duv1=vec2(dFdx(uv.x),dFdx(uv.y));highp vec2 duv2=vec2(dFdy(uv.x),dFdy(uv.y));highp vec3 dp2perp=cross( dp2,N );highp vec3 dp1perp=cross( N,dp1 );highp vec3 T=dp2perp*duv1.x+dp1perp*duv2.x;highp vec3 B=dp2perp*duv1.y+dp1perp*duv2.y;highp float lengthT=dot(T,T);highp float lengthB=dot(B,B);highp float maxLength=max(lengthT,lengthB);highp float invmax=inversesqrt( maxLength );highp mat3 res=mat3( T*invmax,B*invmax,N );return res;
#else
return mat3(1.0);
#endif
}highp vec3 getNormal(){highp vec3 n;
#ifdef HAS_ATTRIBUTE_a_normal_3f
n=normalize(normal_3f);
#else
highp vec3 fdx=vec3(dFdx(v_position_height.x),dFdx(v_position_height.y),dFdx(v_position_height.z));highp vec3 fdy=vec3(dFdy(v_position_height.x),dFdy(v_position_height.y),dFdy(v_position_height.z));n=normalize(cross(fdx,fdy))*-1.0;
#endif
#if defined(HAS_TEXTURE_u_normalTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
vec3 nMap=texture( u_normalTexture,uv_2f).xyz;nMap=normalize(2.0*nMap-vec3(1.0));highp vec3 v=normalize(-v_position_height.xyz);highp mat3 TBN=cotangentFrame(n,v,uv_2f);n=normalize(TBN*nMap);
#endif
return n;}struct Material {float perceptualRoughness;float alphaRoughness;float metallic;vec3 f90;vec4 baseColor;vec3 diffuseColor;vec3 specularColor;highp vec3 normal;};Material getPBRMaterial() {Material mat;mat.baseColor=getBaseColor();mat.perceptualRoughness=u_roughnessFactor;mat.metallic=u_metallicFactor;
#ifdef HAS_ATTRIBUTE_a_pbr
mat.perceptualRoughness=v_roughness_metallic_emissive_alpha.x;mat.metallic=v_roughness_metallic_emissive_alpha.y;mat.baseColor.w*=v_roughness_metallic_emissive_alpha.w;
#endif
#if defined(HAS_TEXTURE_u_metallicRoughnessTexture) && defined(HAS_ATTRIBUTE_a_uv_2f) 
vec4 mrSample=texture(u_metallicRoughnessTexture,uv_2f);mat.perceptualRoughness*=mrSample.g;mat.metallic*=mrSample.b;
#endif
const float c_minRoughness=0.04;mat.perceptualRoughness=clamp(mat.perceptualRoughness,c_minRoughness,1.0);mat.metallic=saturate(mat.metallic);mat.alphaRoughness=mat.perceptualRoughness*mat.perceptualRoughness;const vec3 f0=vec3(0.04);mat.diffuseColor=mat.baseColor.rgb*(vec3(1.0)-f0);mat.diffuseColor*=1.0-mat.metallic;mat.specularColor=mix(f0,mat.baseColor.rgb,mat.metallic);highp float reflectance=max(max(mat.specularColor.r,mat.specularColor.g),mat.specularColor.b);highp float reflectance90=saturate(reflectance*25.0);mat.f90=vec3(reflectance90);mat.normal=getNormal();return mat;}float V_GGX(float NdotL,float NdotV,float roughness)
{float a2=roughness*roughness;float GGXV=NdotL*sqrt(NdotV*NdotV*(1.0-a2)+a2);float GGXL=NdotV*sqrt(NdotL*NdotL*(1.0-a2)+a2);return 0.5/(GGXV+GGXL);}float V_GGXFast(float NdotL,float NdotV,float roughness) {float a=roughness;float GGXV=NdotL*(NdotV*(1.0-a)+a);float GGXL=NdotV*(NdotL*(1.0-a)+a);return 0.5/(GGXV+GGXL);}vec3 F_Schlick(vec3 specularColor,vec3 f90,float VdotH)
{return specularColor+(f90-specularColor)*pow(clamp(1.0-VdotH,0.0,1.0),5.0);}vec3 F_SchlickFast(vec3 specularColor,float VdotH)
{float x=1.0-VdotH;float x4=x*x*x*x;return specularColor+(1.0-specularColor)*x4*x;}float D_GGX(highp float NdotH,float alphaRoughness)
{highp float a4=alphaRoughness*alphaRoughness;highp float f=(NdotH*a4-NdotH)*NdotH+1.0;return a4/(PI*f*f);}vec3 diffuseBurley(Material mat,float LdotH,float NdotL,float NdotV)
{float f90=2.0*LdotH*LdotH*mat.alphaRoughness-0.5;return (mat.diffuseColor/PI)*(1.0+f90*pow((1.0-NdotL),5.0))*(1.0+f90*pow((1.0-NdotV),5.0));}vec3 diffuseLambertian(Material mat)
{
#ifdef LIGHTING_3D_MODE
return mat.diffuseColor;
#else
return mat.diffuseColor/PI;
#endif
}vec3 EnvBRDFApprox(vec3 specularColor,float roughness,highp float NdotV)
{vec4 c0=vec4(-1,-0.0275,-0.572,0.022);vec4 c1=vec4(1,0.0425,1.04,-0.04);highp vec4 r=roughness*c0+c1;highp float a004=min(r.x*r.x,exp2(-9.28*NdotV))*r.x+r.y;vec2 AB=vec2(-1.04,1.04)*a004+r.zw;return specularColor*AB.x+AB.y;}vec3 computeIndirectLightContribution(Material mat,float NdotV,vec3 normal)
{vec3 env_light=vec3(0.65,0.65,0.65);
#ifdef LIGHTING_3D_MODE
float ambient_factor=calculate_ambient_directional_factor(normal);env_light=u_lighting_ambient_color*ambient_factor;
#endif
vec3 envBRDF=EnvBRDFApprox(mat.specularColor,mat.perceptualRoughness,NdotV);vec3 indirectSpecular= envBRDF*env_light;vec3 indirectDiffuse=mat.diffuseColor*env_light;return indirectSpecular+indirectDiffuse;}vec3 computeLightContribution(Material mat,vec3 lightPosition,vec3 lightColor)
{highp vec3 n=mat.normal;highp vec3 v=normalize(-v_position_height.xyz);highp vec3 l=normalize(lightPosition);highp vec3 h=normalize(v+l);float NdotV=clamp(abs(dot(n,v)),0.001,1.0);float NdotL=saturate(dot(n,l));highp float NdotH=saturate(dot(n,h));float VdotH=saturate(dot(v,h));vec3 f=F_SchlickFast(mat.specularColor,VdotH);float g=V_GGXFast(NdotL,NdotV,mat.alphaRoughness);float d=D_GGX(NdotH,mat.alphaRoughness);vec3 diffuseTerm=(1.0-f)*diffuseLambertian(mat);vec3 specularTerm=f*g*d;vec3 transformed_normal=vec3(-n.xy,n.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=NdotL;
#endif
vec3 directLightColor=(specularTerm+diffuseTerm)*lighting_factor*lightColor;vec3 indirectLightColor=computeIndirectLightContribution(mat,NdotV,transformed_normal);vec3 color=(saturate(directLightColor)+indirectLightColor);float intensityFactor=1.0;
#if !defined(LIGHTING_3D_MODE)
const vec3 luminosityFactor=vec3(0.2126,0.7152,0.0722);float luminance=dot(diffuseTerm,luminosityFactor);intensityFactor=mix((1.0-u_lightintensity),max((1.0-luminance+u_lightintensity),1.0),NdotL);
#endif
color*=intensityFactor;return color;}void main() {
#ifdef TERRAIN_FRAGMENT_OCCLUSION
if (isOccluded()) {discard;}
#endif
vec3 lightDir=u_lightpos;vec3 lightColor=u_lightcolor;
#ifdef LIGHTING_3D_MODE
lightDir=u_lighting_directional_dir;lightDir.xy=-lightDir.xy;lightColor=u_lighting_directional_color;
#endif
vec4 finalColor;
#ifdef DIFFUSE_SHADED
vec3 N=getNormal();vec3 baseColor=getBaseColor().rgb;vec3 diffuse=getDiffuseShadedColor(baseColor,N,lightDir,lightColor);
#ifdef HAS_TEXTURE_u_occlusionTexture
float ao=(texture(u_occlusionTexture,uv_2f).r-1.0)*u_aoIntensity+1.0;diffuse*=ao;
#endif
finalColor=vec4(mix(diffuse,baseColor,u_emissive_strength),1.0)*u_opacity;
#else
Material mat=getPBRMaterial();vec3 color=computeLightContribution(mat,lightDir,lightColor);float ao=1.0;
#if defined (HAS_TEXTURE_u_occlusionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
#ifdef OCCLUSION_TEXTURE_TRANSFORM
vec2 uv=uv_2f.xy*u_occlusionTextureTransform.zw+u_occlusionTextureTransform.xy;
#else
vec2 uv=uv_2f;
#endif
ao=(texture(u_occlusionTexture,uv).x-1.0)*u_aoIntensity+1.0;color*=ao;
#endif
vec4 emissive=u_emissiveFactor;
#if defined(HAS_TEXTURE_u_emissionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
emissive.rgb*=sRGBToLinear(texture(u_emissionTexture,uv_2f).rgb);
#endif
#ifdef APPLY_LUT_ON_GPU
float emissiveFactorLength=max(length(u_emissiveFactor.rgb),0.001);emissive.rgb=sRGBToLinear(applyLUT(u_lutTexture,linearTosRGB(emissive.rgb/emissiveFactorLength).rbg))*emissiveFactorLength;
#endif
color+=emissive.rgb;float opacity=mat.baseColor.w*u_opacity;
#ifdef HAS_ATTRIBUTE_a_pbr
float resEmission=v_roughness_metallic_emissive_alpha.z;resEmission*=v_height_based_emission_params.z+v_height_based_emission_params.w*pow(clamp(v_height_based_emission_params.x,0.0,1.0),v_height_based_emission_params.y);vec3 color_mix=v_color_mix.rgb;
#ifdef APPLY_LUT_ON_GPU
color_mix=applyLUT(u_lutTexture,color_mix);
#endif
color=mix(color,color_mix,min(1.0,resEmission));
#ifdef HAS_ATTRIBUTE_a_color_4f
float distance=length(vec2(1.3*max(0.0,abs(color_4f.x)-color_4f.z),color_4f.y));distance+= mix(0.5,0.0,clamp(resEmission-1.0,0.0,1.0));opacity*=v_roughness_metallic_emissive_alpha.w*saturate(1.0-distance*distance);
#endif
#endif
vec3 unlitColor=mat.baseColor.rgb*ao+emissive.rgb;color=mix(color,unlitColor,u_emissive_strength);color=linearTosRGB(color);color*=opacity;finalColor=vec4(color,opacity);
#endif
#ifdef FOG
finalColor=fog_dither(fog_apply_premultiplied(finalColor,v_fog_pos,v_position_height.w));
#endif
#ifdef RENDER_CUTOFF
finalColor*=v_cutoff_opacity;
#endif
#ifdef INDICATOR_CUTOUT
finalColor=applyCutout(finalColor,v_position_height.w);
#endif
glFragColor=finalColor;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec3 a_pos_3f;
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute-vertex-shader-only highp vec4 pbr
#pragma mapbox: define-attribute-vertex-shader-only highp vec3 heightBasedEmissiveStrength
uniform mat4 u_matrix;uniform mat4 u_node_matrix;uniform mat4 u_lighting_matrix;uniform vec3 u_camera_pos;uniform vec4 u_color_mix;
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_normal_matrix;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth_shadows;
#endif
out vec4 v_position_height;out lowp vec4 v_color_mix;
#ifdef TERRAIN_FRAGMENT_OCCLUSION
out highp float v_depth;
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
out lowp vec4 v_roughness_metallic_emissive_alpha;out mediump vec4 v_height_based_emission_params;
#endif
vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}void main() {
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute-custom highp vec4 pbr
#pragma mapbox: initialize-attribute-custom highp vec3 heightBasedEmissiveStrength
highp mat4 normal_matrix;
#ifdef INSTANCED_ARRAYS
normal_matrix=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
normal_matrix=u_normal_matrix;
#endif
vec3 local_pos;mat3 rs;
#ifdef MODEL_POSITION_ON_GPU
vec3 pos_color=normal_matrix[0].xyz;vec4 translate=normal_matrix[1];vec3 pos_a=floor(pos_color);vec3 rgb=1.05*(pos_color-pos_a);float hidden=float(pos_a.x > EXTENT);float color_mix=pos_a.z/100.0;v_color_mix=vec4(sRGBToLinear(rgb),color_mix);float meter_to_tile=normal_matrix[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);rs[0].x=normal_matrix[1].w;rs[0].yz=normal_matrix[2].xy;rs[1].xy=normal_matrix[2].zw;rs[1].z=normal_matrix[3].x;rs[2].xyz=normal_matrix[3].yzw;vec4 pos_node=u_lighting_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;local_pos=pos.xyz;gl_Position=mix(u_matrix*pos,AWAY,hidden);pos.z*=meter_to_tile;v_position_height.xyz=pos.xyz-u_camera_pos;
#else
local_pos=a_pos_3f;gl_Position=u_matrix*vec4(a_pos_3f,1);v_position_height.xyz=vec3(u_lighting_matrix*vec4(a_pos_3f,1));v_color_mix=vec4(sRGBToLinear(u_color_mix.rgb),u_color_mix.a);
#endif
v_position_height.w=a_pos_3f.z;
#ifdef HAS_ATTRIBUTE_a_pbr
vec4 albedo_c=decode_color(pbr.xy);vec2 e_r_m=unpack_float(pbr.z);vec2 r_m= unpack_float(e_r_m.y*16.0);r_m.r=r_m.r*16.0;v_color_mix=vec4(albedo_c.rgb,1.0);v_roughness_metallic_emissive_alpha=vec4(vec3(r_m,e_r_m.x)/255.0,albedo_c.a);v_roughness_metallic_emissive_alpha.z*=2.0;float heightBasedRelativeIntepolation=a_pos_3f.z*heightBasedEmissiveStrength.x+heightBasedEmissiveStrength.y;v_height_based_emission_params.x=heightBasedRelativeIntepolation;v_height_based_emission_params.y=heightBasedEmissiveStrength.z;vec2 emissionMultiplierValues=unpack_float(pbr.w)/256.0;v_height_based_emission_params.z=emissionMultiplierValues.x;v_height_based_emission_params.w=emissionMultiplierValues.y-emissionMultiplierValues.x;
#endif
#ifdef FOG
v_fog_pos=fog_position(local_pos);
#endif
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
float x_squared_scale=dot(rs[0],rs[0]);float y_squared_scale=dot(rs[1],rs[1]);float z_squared_scale=dot(rs[2],rs[2]);vec3 squared_scale=vec3(x_squared_scale,y_squared_scale,z_squared_scale);normal_3f=rs*((u_lighting_matrix*vec4(normal_3f,0.0)).xyz/squared_scale);normal_3f=normalize(normal_3f);
#else
normal_3f=vec3(normal_matrix*vec4(normal_3f,0));
#endif
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#ifdef HAS_ATTRIBUTE_a_color_4f
v_roughness_metallic_emissive_alpha.w=clamp(color_4f.a*v_roughness_metallic_emissive_alpha.w*(v_roughness_metallic_emissive_alpha.z-1.0),0.0,1.0);
#endif
#endif
#ifdef RENDER_SHADOWS
vec4 shadow_pos=u_node_matrix*vec4(local_pos,1.0);
#ifdef NORMAL_OFFSET
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
vec3 offset=shadow_normal_offset(vec3(-normal_3f.xy,normal_3f.z));shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#else
vec3 offset=shadow_normal_offset_model(normal_3f);shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#endif
#endif
#endif
v_pos_light_view_0=u_light_matrix_0*shadow_pos;v_pos_light_view_1=u_light_matrix_1*shadow_pos;v_depth_shadows=gl_Position.w;
#endif
}`),modelDepth:sr(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`in vec3 a_pos_3f;uniform mat4 u_matrix;out highp float v_depth;
#ifdef MODEL_POSITION_ON_GPU
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_instance;
#endif
uniform highp mat4 u_node_matrix;
#endif
void main() {
#ifdef MODEL_POSITION_ON_GPU
highp mat4 instance;
#ifdef INSTANCED_ARRAYS
instance=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
instance=u_instance;
#endif
vec3 pos_color=instance[0].xyz;vec4 translate=instance[1];vec3 pos_a=floor(pos_color);float hidden=float(pos_a.x > EXTENT);float meter_to_tile=instance[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);mat3 rs;rs[0].x=instance[1].w;rs[0].yz=instance[2].xy;rs[1].xy=instance[2].zw;rs[1].z=instance[3].x;rs[2].xyz=instance[3].yzw;vec4 pos_node=u_node_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;gl_Position=mix(u_matrix*pos,AWAY,hidden);
#else
gl_Position=u_matrix*vec4(a_pos_3f,1);
#endif
v_depth=gl_Position.z/gl_Position.w;}`),stars:sr(`in highp vec2 v_uv;in mediump float v_intensity;float shapeCircle(in vec2 uv)
{float beginFade=0.6;float lengthFromCenter=length(v_uv);return 1.0-clamp((lengthFromCenter-beginFade)/(1.0-beginFade),0.0,1.0);}void main() {float alpha=shapeCircle(v_uv);vec3 color=vec3(1.0,1.0,1.0);alpha*=v_intensity;glFragColor=vec4(color*alpha,alpha);HANDLE_WIREFRAME_DEBUG;}`,`
in vec3 a_pos_3f;in vec2 a_uv;in float a_size_scale;in float a_fade_opacity;uniform mat4 u_matrix;uniform vec3 u_up;uniform vec3 u_right;uniform float u_intensity_multiplier;out highp vec2 v_uv;out mediump float v_intensity;void main() {v_uv=a_uv;v_intensity=a_fade_opacity*u_intensity_multiplier;vec3 pos=a_pos_3f;pos+=a_uv.x*u_right*a_size_scale;pos+=a_uv.y*u_up*a_size_scale;gl_Position=u_matrix*vec4(pos,1.0);}`),snowParticle:sr("in highp vec2 uv;in highp float alphaMultiplier;uniform vec4 u_particleColor;uniform vec2 u_simpleShapeParameters;void main() {float t=clamp((length(uv)-u_simpleShapeParameters.x)/(1.0-u_simpleShapeParameters.x),0.0,1.0);float alpha=1.0-pow(t,pow(10.0,u_simpleShapeParameters.y));alpha*=alphaMultiplier;alpha*=u_particleColor.a;vec3 color=u_particleColor.rgb*alpha;glFragColor=vec4(color,alpha) ;HANDLE_WIREFRAME_DEBUG;}",`
in highp vec3 a_pos_3f;in highp vec2 a_uv;in highp vec4 a_snowParticleData;in highp vec4 a_snowParticleDataHorizontalOscillation;uniform mat4 u_modelview;uniform mat4 u_projection;uniform vec3 u_cam_pos;uniform vec2 u_screenSize;uniform float u_time;uniform float u_boxSize;uniform float u_velocityConeAperture; 
uniform float u_velocity;uniform vec3 u_direction;uniform float u_horizontalOscillationRadius; 
uniform float u_horizontalOscillationRate; 
uniform float u_billboardSize;uniform vec2 u_thinningCenterPos;uniform vec3 u_thinningShape;uniform float u_thinningAffectedRatio;uniform float u_thinningParticleOffset;out highp vec2 uv;out highp float alphaMultiplier;void main() {vec3 pos=a_pos_3f;float halfBoxSize=0.5*u_boxSize;pos.xyz*=halfBoxSize;pos+=u_cam_pos;float velocityConeApertureRad=radians(u_velocityConeAperture*0.5);float coneAnglePichRad=velocityConeApertureRad*a_snowParticleData.z;float coneAngleHeadingRad=a_snowParticleData.w*radians(360.0);vec3 localZ=normalize(u_direction);vec3 localX=normalize(cross(localZ,vec3(1,0,0)));vec3 localY=normalize(cross(localZ,localX));vec3 direction;direction.x=cos(coneAngleHeadingRad)*sin(coneAnglePichRad);direction.y=sin(coneAngleHeadingRad)*sin(coneAnglePichRad);direction.z=cos(coneAnglePichRad);direction=normalize(direction);vec3 simPosLocal=vec3(0,0,0);float velocityScale=(1.0+3.0*a_snowParticleData.y)*u_velocity;simPosLocal+=direction*velocityScale*u_time;float horizontalOscillationRadius=u_horizontalOscillationRadius*a_snowParticleDataHorizontalOscillation.x;float horizontalOscillationAngle=u_horizontalOscillationRate*u_time*(-1.0+2.0*a_snowParticleDataHorizontalOscillation.y);simPosLocal.xy+=horizontalOscillationRadius*vec2(cos(horizontalOscillationAngle),sin(horizontalOscillationAngle));vec3 simPos=localX*simPosLocal.x+
localY*simPosLocal.y+localZ*simPosLocal.z;pos+=simPos;pos=fract((pos+vec3(halfBoxSize))/vec3(u_boxSize))*u_boxSize-vec3(halfBoxSize);float clipZ=-u_cam_pos.z+pos.z;vec4 posView=u_modelview*vec4(pos,1.0);float size=u_billboardSize;alphaMultiplier=1.0;vec4 posScreen=u_projection*posView;posScreen/=posScreen.w;posScreen.xy=vec2(0.5)+posScreen.xy*0.5;posScreen.xy*=u_screenSize;vec2 thinningCenterPos=u_thinningCenterPos.xy;thinningCenterPos.y=u_screenSize.y-thinningCenterPos.y;float screenDist=length((thinningCenterPos-posScreen.xy)/(0.5*u_screenSize));screenDist+=a_snowParticleData.x*u_thinningParticleOffset;float scaleFactorMode=0.0;float thinningShapeDist=u_thinningShape.x+u_thinningShape.y;if (screenDist < thinningShapeDist) {float thinningFadeRatio=clamp((screenDist-u_thinningShape.x)/u_thinningShape.y,0.0,1.0);thinningFadeRatio=pow(thinningFadeRatio,u_thinningShape.z);if (a_snowParticleData.x < u_thinningAffectedRatio) {scaleFactorMode=1.0-thinningFadeRatio;alphaMultiplier=thinningFadeRatio;}}vec4 posScreen1=u_projection*vec4(posView.x-size,posView.yzw);posScreen1/=posScreen1.w;vec4 posScreen2=u_projection*vec4(posView.x+size,posView.yzw);posScreen2/=posScreen2.w;posScreen1.xy=vec2(0.5)+posScreen1.xy*0.5;posScreen1.xy*=u_screenSize;posScreen2.xy=vec2(0.5)+posScreen2.xy*0.5;posScreen2.xy*=u_screenSize;float screenLength=length(posScreen1.xy-posScreen2.xy);float screenEpsilon=3.0;float scaleFactor=1.0;if (screenLength < screenEpsilon) {scaleFactor=screenEpsilon/max(screenLength,0.01);scaleFactor=mix(scaleFactor,1.0,scaleFactorMode);}float screenEpsilon2=15.0;if (screenLength > screenEpsilon2) {scaleFactor=screenEpsilon2/max(screenLength,0.01);}size*=scaleFactor;vec2 right=size*vec2(1,0);vec2 up=size*vec2(0,1);posView.xy+=right*a_uv.x;posView.xy+=up*a_uv.y;uv=a_uv;gl_Position=u_projection*posView;}`),rainParticle:sr("in highp vec2 uv;in highp float particleRandomValue;uniform sampler2D u_texScreen;uniform float u_distortionStrength;uniform vec4 u_color;uniform vec2 u_thinningCenterPos;uniform vec3 u_thinningShape;uniform float u_thinningAffectedRatio;uniform float u_thinningParticleOffset;uniform float u_shapeDirectionalPower;uniform float u_mode;void main() {vec2 st=uv*0.5+vec2(0.5);vec2 uvm=uv;uvm.y=-1.0+2.0*pow(st.y,u_shapeDirectionalPower);float shape=clamp(1.0-length(uvm),0.0,1.0);float alpha=abs(shape)*u_color.a;vec2 screenSize=vec2(textureSize(u_texScreen,0));vec2 thinningCenterPos=u_thinningCenterPos.xy;thinningCenterPos.y=screenSize.y-thinningCenterPos.y;float screenDist=length((thinningCenterPos-gl_FragCoord.xy)/(0.5*screenSize));screenDist+=(0.5+0.5*particleRandomValue)*u_thinningParticleOffset;float thinningShapeDist=u_thinningShape.x+u_thinningShape.y;float thinningAlpha=1.0;if (screenDist < thinningShapeDist) {float thinningFadeRatio=clamp((screenDist-u_thinningShape.x)/u_thinningShape.y,0.0,1.0);thinningFadeRatio=pow(thinningFadeRatio,u_thinningShape.z);thinningAlpha*=thinningFadeRatio;}vec2 offsetXY=normalize(uvm)*abs(shape);vec2 stScreen=(gl_FragCoord.xy+offsetXY*u_distortionStrength*thinningAlpha)/screenSize;vec3 colorScreen=texture(u_texScreen,stScreen).rgb;alpha*=thinningAlpha;glFragColor=mix(vec4(colorScreen,1.0),vec4(u_color.rgb*alpha,alpha),u_mode);HANDLE_WIREFRAME_DEBUG;}",`
in highp vec3 a_pos_3f;in highp vec2 a_uv;in highp vec4 a_rainParticleData;uniform mat4 u_modelview;uniform mat4 u_projection;uniform vec3 u_cam_pos;uniform float u_time;uniform float u_boxSize;uniform float u_velocityConeAperture; 
uniform float u_velocity; 
uniform vec2 u_rainDropletSize;uniform vec3 u_rainDirection;out highp vec2 uv;out highp float particleRandomValue;void main() {vec3 pos=a_pos_3f;float halfBoxSize=0.5*u_boxSize;pos*=halfBoxSize; 
pos+=u_cam_pos;float velocityConeApertureRad=radians(u_velocityConeAperture*0.5);float coneAnglePichRad=velocityConeApertureRad*a_rainParticleData.z;float coneAngleHeadingRad=a_rainParticleData.w*radians(360.0);vec3 localZ=normalize(u_rainDirection);vec3 localX=normalize(cross(localZ,vec3(1,0,0)));vec3 localY=normalize(cross(localZ,localX));vec3 directionLocal;directionLocal.x=cos(coneAngleHeadingRad)*sin(coneAnglePichRad);directionLocal.y=sin(coneAngleHeadingRad)*sin(coneAnglePichRad);directionLocal.z=cos(coneAnglePichRad);directionLocal=normalize(directionLocal);vec3 directionWorld=localX*directionLocal.x+localY*directionLocal.y+localZ*directionLocal.z;float velocityScale=(1.0+3.0*a_rainParticleData.y)*u_velocity;vec3 simPosLocal=vec3(0,0,0);simPosLocal+=directionLocal*velocityScale*u_time;vec3 simPos=localX*simPosLocal.x+
localY*simPosLocal.y+localZ*simPosLocal.z;pos+=simPos;pos=fract((pos+vec3(halfBoxSize))/vec3(u_boxSize))*u_boxSize-vec3(halfBoxSize);vec4 posView=u_modelview*vec4(pos,1.0);vec3 directionView=normalize((u_modelview*vec4(directionWorld,0.0)).xyz);vec3 side=cross(directionView,normalize(posView.xyz));posView.xyz+=side*a_uv.x*u_rainDropletSize.x;posView.xyz+=directionView*a_uv.y*u_rainDropletSize.y;uv=a_uv;particleRandomValue=a_rainParticleData.x;gl_Position=u_projection*posView;}`),vignette:sr("uniform vec3 u_vignetteShape;uniform vec4 u_vignetteColor;in vec2 st;void main() {float screenDist=length(st);float alpha=clamp((screenDist-u_vignetteShape.x)/u_vignetteShape.y,0.0,1.0);alpha=pow(alpha,u_vignetteShape.z)*u_vignetteColor.a;vec3 color=u_vignetteColor.rgb;glFragColor=vec4(color*alpha,alpha) ;}","in vec2 a_pos_2f;out vec2 st;void main() {st=a_pos_2f;gl_Position=vec4(a_pos_2f,0,1);}"),occlusion:sr("uniform vec4 u_color;void main() {glFragColor=u_color;}",`#include "_prelude_terrain.vertex.glsl"
in highp vec2 a_offset_xy;uniform highp vec3 u_anchorPos;uniform mat4 u_matrix;uniform vec2 u_screenSizePx;uniform vec2 u_occluderSizePx;void main() {vec3 world_pos=u_anchorPos;
#ifdef TERRAIN
float e=elevation(world_pos.xy);world_pos.z+=e;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1.0);projected_point.xy+=projected_point.w*a_offset_xy*0.5*u_occluderSizePx/u_screenSizePx;gl_Position=projected_point;}`)};function Ec(p,r){const l=p.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let m of l)if(m=m.trim(),m[0]==="#"&&m.includes("if")&&!m.includes("endif")){m=m.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const x=m.split(" ");for(const w of x)r.includes(w)||r.push(w)}}function sr(p,r){const l=/#include\s+"([^"]+)"/g,m=/#pragma mapbox: ([\w\-]+) ([\w]+) ([\w]+) ([\w]+)/g;let x=r.match(/(attribute(\S*)|(^\s*|;)in) (highp |mediump |lowp )?([\w]+) ([\w]+)/gm);x&&(x=x.map(U=>{const $=U.split(" ");return $[$.length-1]}),x=[...new Set(x)]);const w={},A=[],D=[];if(p=p.replace(l,(U,$)=>(D.push($),"")),(r=r.replace(l,(U,$)=>(A.push($),""))).includes("flat out"))return void console.error('The usage of "flat" qualifier is disallowed, see: https://bugs.webkit.org/show_bug.cgi?id=268071');let N=[...ps];Ec(p,N),Ec(r,N);for(const U of[...A,...D])Sc[U]||console.error(`Undefined include: ${U}`),Tc[U]||(Tc[U]=[],Ec(Sc[U],Tc[U])),N=[...N,...Tc[U]];return{fragmentSource:p=p.replace(m,(U,$,Z,W,te)=>(w[te]=!0,$==="define"?`
#ifndef HAS_UNIFORM_u_${te}
in ${Z} ${W} ${te};
#else
uniform ${Z} ${W} u_${te};
#endif
`:$==="initialize"?`
#ifdef HAS_UNIFORM_u_${te}
    ${Z} ${W} ${te} = u_${te};
#endif
`:$==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${te}
    in ${Z} ${W} ${te};
#endif
`:$==="initialize-attribute"?"":void 0)),vertexSource:r=r.replace(m,(U,$,Z,W,te)=>{const ue=W==="float"?"vec2":W,se=te.match(/color/)?"color":ue;return $==="define-attribute-vertex-shader-only"?`
#ifdef HAS_ATTRIBUTE_a_${te}
in ${Z} ${W} a_${te};
#endif
`:w[te]?$==="define"?`
#ifndef HAS_UNIFORM_u_${te}
uniform lowp float u_${te}_t;
in ${Z} ${ue} a_${te};
out ${Z} ${W} ${te};
#else
uniform ${Z} ${W} u_${te};
#endif
`:$==="initialize"?se==="vec4"?`
#ifndef HAS_UNIFORM_u_${te}
    ${te} = a_${te};
#else
    ${Z} ${W} ${te} = u_${te};
#endif
`:`
#ifndef HAS_UNIFORM_u_${te}
    ${te} = unpack_mix_${se}(a_${te}, u_${te}_t);
#else
    ${Z} ${W} ${te} = u_${te};
#endif
`:$==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${te}
    in ${Z} ${W} a_${te};
    out ${Z} ${W} ${te};
#endif
`:$==="initialize-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${te}
    ${te} = a_${te};
#endif
`:void 0:$==="define"?`
#ifndef HAS_UNIFORM_u_${te}
uniform lowp float u_${te}_t;
in ${Z} ${ue} a_${te};
#else
uniform ${Z} ${W} u_${te};
#endif
`:$==="define-instanced"?se==="mat4"?`
#ifdef INSTANCED_ARRAYS
in vec4 a_${te}0;
in vec4 a_${te}1;
in vec4 a_${te}2;
in vec4 a_${te}3;
#else
uniform ${Z} ${W} u_${te};
#endif
`:`
#ifdef INSTANCED_ARRAYS
in ${Z} ${ue} a_${te};
#else
uniform ${Z} ${W} u_${te};
#endif
`:$==="initialize-attribute-custom"?`
#ifdef HAS_ATTRIBUTE_a_${te}
    ${Z} ${W} ${te} = a_${te};
#endif
`:se==="vec4"?`
#ifndef HAS_UNIFORM_u_${te}
    ${Z} ${W} ${te} = a_${te};
#else
    ${Z} ${W} ${te} = u_${te};
#endif
`:`
#ifndef HAS_UNIFORM_u_${te}
    ${Z} ${W} ${te} = unpack_mix_${se}(a_${te}, u_${te}_t);
#else
    ${Z} ${W} ${te} = u_${te};
#endif
`}),staticAttributes:x,usedDefines:N,vertexIncludes:A,fragmentIncludes:D}}class Tu{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(r,l,m,x,w,A,D,N){this.context=r;let U=this.boundPaintVertexBuffers.length!==x.length;for(let Z=0;!U&&Z<x.length;Z++)this.boundPaintVertexBuffers[Z]!==x[Z]&&(U=!0);let $=this.boundDynamicVertexBuffers.length!==D.length;for(let Z=0;!$&&Z<D.length;Z++)this.boundDynamicVertexBuffers[Z]!==D[Z]&&($=!0);if(!this.vao||this.boundProgram!==l||this.boundLayoutVertexBuffer!==m||U||$||this.boundIndexBuffer!==w||this.boundVertexOffset!==A)this.freshBind(l,m,x,w,A,D,N);else{r.bindVertexArrayOES.set(this.vao);for(const Z of D)Z&&(Z.bind(),N&&Z.instanceCount&&Z.setVertexAttribDivisor(r.gl,l,N));w&&w.dynamicDraw&&w.bind()}}freshBind(r,l,m,x,w,A,D){const N=r.numAttributes,U=this.context,$=U.gl;this.vao&&this.destroy(),this.vao=U.gl.createVertexArray(),U.bindVertexArrayOES.set(this.vao),this.boundProgram=r,this.boundLayoutVertexBuffer=l,this.boundPaintVertexBuffers=m,this.boundIndexBuffer=x,this.boundVertexOffset=w,this.boundDynamicVertexBuffers=A,l.enableAttributes($,r),l.bind(),l.setVertexAttribPointers($,r,w);for(const Z of m)Z.enableAttributes($,r),Z.bind(),Z.setVertexAttribPointers($,r,w);for(const Z of A)Z&&(Z.enableAttributes($,r),Z.bind(),Z.setVertexAttribPointers($,r,w),D&&Z.instanceCount&&Z.setVertexAttribDivisor($,r,D));x&&x.bind(),U.currentNumAttributes=N}destroy(){this.vao&&(this.context.gl.deleteVertexArray(this.vao),this.vao=null)}}function Eu(p,r){const l=Math.pow(2,r.canonical.z),m=r.canonical.y;return[new i.aa(0,m/l).toLngLat().lat,new i.aa(0,(m+1)/l).toLngLat().lat]}function qo(p,r,l,m,x,w,A){const D=p.context,N=D.gl,U=l.hillshadeFBO;if(!U)return;p.prepareDrawTile();const $=p.isTileAffectedByFog(r),Z=p.getOrCreateProgram("hillshade",{overrideFog:$});D.activeTexture.set(N.TEXTURE0),N.bindTexture(N.TEXTURE_2D,U.colorAttachment.get());const W=((de,he,Te,Pe)=>{const Me=Te.paint.get("hillshade-shadow-color"),Fe=Te.paint.get("hillshade-shadow-color-use-theme").constantOr("default")==="none",Re=Te.paint.get("hillshade-highlight-color"),ze=Te.paint.get("hillshade-highlight-color-use-theme").constantOr("default")==="none",De=Te.paint.get("hillshade-accent-color"),$e=Te.paint.get("hillshade-accent-color-use-theme").constantOr("default")==="none",Xe=Te.paint.get("hillshade-emissive-strength");let ht=i.ai(Te.paint.get("hillshade-illumination-direction"));if(Te.paint.get("hillshade-illumination-anchor")==="viewport")ht-=de.transform.angle;else if(de.style&&de.style.enable3dLights()&&de.style.directionalLight){const Et=de.style.directionalLight.properties.get("direction"),yt=i.cb(Et.x,Et.y,Et.z);ht=i.ai(yt[1])}const ot=!de.options.moving;return{u_matrix:Pe||de.transform.calculateProjMatrix(he.tileID.toUnwrapped(),ot),u_image:0,u_latrange:Eu(0,he.tileID),u_light:[Te.paint.get("hillshade-exaggeration"),ht],u_shadow:Me.toRenderColor(Fe?null:Te.lut),u_highlight:Re.toRenderColor(ze?null:Te.lut),u_emissive_strength:Xe,u_accent:De.toRenderColor($e?null:Te.lut)}})(p,l,m,p.terrain?r.projMatrix:null);p.uploadCommonUniforms(D,Z,r.toUnwrapped());const{tileBoundsBuffer:te,tileBoundsIndexBuffer:ue,tileBoundsSegments:se}=p.getTileBoundsBuffers(l);Z.draw(p,N.TRIANGLES,x,w,A,Rn.disabled,W,m.id,te,ue,se)}function Au(p,r,l){if(!r.needsDEMTextureUpload)return;const m=p.context,x=m.gl;m.pixelStoreUnpackPremultiplyAlpha.set(!1),r.demTexture=r.demTexture||p.getTileTexture(l.stride);const w=l.getPixels();r.demTexture?r.demTexture.update(w,{premultiply:!1}):r.demTexture=new i.T(m,w,x.R32F,{premultiply:!1}),r.needsDEMTextureUpload=!1}function Th(p,r,l){const m=p.context,x=m.gl;if(!r.dem)return;const w=r.dem;if(m.activeTexture.set(x.TEXTURE1),Au(p,r,w),!r.demTexture)return;r.demTexture.bind(x.NEAREST,x.CLAMP_TO_EDGE);const A=w.dim;m.activeTexture.set(x.TEXTURE0);let D=r.hillshadeFBO;if(!D){const W=new i.T(m,{width:A,height:A,data:null},x.RGBA8);W.bind(x.LINEAR,x.CLAMP_TO_EDGE),D=r.hillshadeFBO=m.createFramebuffer(A,A,!0,"renderbuffer"),D.colorAttachment.set(W.texture)}m.bindFramebuffer.set(D.framebuffer),m.viewport.set([0,0,A,A]);const{tileBoundsBuffer:N,tileBoundsIndexBuffer:U,tileBoundsSegments:$}=p.getMercatorTileBoundsBuffers(),Z=[];p.linearFloatFilteringSupported()&&Z.push("TERRAIN_DEM_FLOAT_FORMAT"),p.getOrCreateProgram("hillshadePrepare",{defines:Z}).draw(p,x.TRIANGLES,Tn.disabled,Dn.disabled,Jn.unblended,Rn.disabled,((W,te)=>{const ue=te.stride,se=i.ab.mat4.create();return i.ab.mat4.ortho(se,0,i.ag,-i.ag,0,0,1),i.ab.mat4.translate(se,se,[0,-i.ag,0]),{u_matrix:se,u_image:1,u_dimension:[ue,ue],u_zoom:W.overscaledZ}})(r.tileID,w),l.id,N,U,$),r.needsHillshadePrepare=!1}class jr{constructor(r){this.gl=r.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(r){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Eh extends jr{getDefault(){return i.aj.transparent}set(r){const l=this.current;(r.r!==l.r||r.g!==l.g||r.b!==l.b||r.a!==l.a||this.dirty)&&(this.gl.clearColor(r.r,r.g,r.b,r.a),this.current=r,this.dirty=!1)}}class To extends jr{getDefault(){return 1}set(r){(r!==this.current||this.dirty)&&(this.gl.clearDepth(r),this.current=r,this.dirty=!1)}}class Eo extends jr{getDefault(){return 0}set(r){(r!==this.current||this.dirty)&&(this.gl.clearStencil(r),this.current=r,this.dirty=!1)}}class Bl extends jr{getDefault(){return[!0,!0,!0,!0]}set(r){const l=this.current;(r[0]!==l[0]||r[1]!==l[1]||r[2]!==l[2]||r[3]!==l[3]||this.dirty)&&(this.gl.colorMask(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)}}class il extends jr{getDefault(){return!0}set(r){(r!==this.current||this.dirty)&&(this.gl.depthMask(r),this.current=r,this.dirty=!1)}}class al extends jr{getDefault(){return 255}set(r){(r!==this.current||this.dirty)&&(this.gl.stencilMask(r),this.current=r,this.dirty=!1)}}class Cu extends jr{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(r){const l=this.current;(r.func!==l.func||r.ref!==l.ref||r.mask!==l.mask||this.dirty)&&(this.gl.stencilFunc(r.func,r.ref,r.mask),this.current=r,this.dirty=!1)}}class Ah extends jr{getDefault(){const r=this.gl;return[r.KEEP,r.KEEP,r.KEEP]}set(r){const l=this.current;(r[0]!==l[0]||r[1]!==l[1]||r[2]!==l[2]||this.dirty)&&(this.gl.stencilOp(r[0],r[1],r[2]),this.current=r,this.dirty=!1)}}class Mu extends jr{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;r?l.enable(l.STENCIL_TEST):l.disable(l.STENCIL_TEST),this.current=r,this.dirty=!1}}class _p extends jr{getDefault(){return[0,1]}set(r){const l=this.current;(r[0]!==l[0]||r[1]!==l[1]||this.dirty)&&(this.gl.depthRange(r[0],r[1]),this.current=r,this.dirty=!1)}}class li extends jr{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;r?l.enable(l.DEPTH_TEST):l.disable(l.DEPTH_TEST),this.current=r,this.dirty=!1}}class ba extends jr{getDefault(){return this.gl.LESS}set(r){(r!==this.current||this.dirty)&&(this.gl.depthFunc(r),this.current=r,this.dirty=!1)}}class Ur extends jr{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;r?l.enable(l.BLEND):l.disable(l.BLEND),this.current=r,this.dirty=!1}}class Ao extends jr{getDefault(){const r=this.gl;return[r.ONE,r.ZERO,r.ONE,r.ZERO]}set(r){const l=this.current;(r[0]!==l[0]||r[1]!==l[1]||r[2]!==l[2]||r[3]!==l[3]||this.dirty)&&(this.gl.blendFuncSeparate(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)}}class ms extends jr{getDefault(){return i.aj.transparent}set(r){const l=this.current;(r.r!==l.r||r.g!==l.g||r.b!==l.b||r.a!==l.a||this.dirty)&&(this.gl.blendColor(r.r,r.g,r.b,r.a),this.current=r,this.dirty=!1)}}class Wf extends jr{getDefault(){return this.gl.FUNC_ADD}set(r){(r!==this.current||this.dirty)&&(this.gl.blendEquationSeparate(r,r),this.current=r,this.dirty=!1)}}class ol extends jr{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;r?l.enable(l.CULL_FACE):l.disable(l.CULL_FACE),this.current=r,this.dirty=!1}}class gp extends jr{getDefault(){return this.gl.BACK}set(r){(r!==this.current||this.dirty)&&(this.gl.cullFace(r),this.current=r,this.dirty=!1)}}class yp extends jr{getDefault(){return this.gl.CCW}set(r){(r!==this.current||this.dirty)&&(this.gl.frontFace(r),this.current=r,this.dirty=!1)}}let Ac=class extends jr{getDefault(){return null}set(p){(p!==this.current||this.dirty)&&(this.gl.useProgram(p),this.current=p,this.dirty=!1)}};class Ch extends jr{getDefault(){return this.gl.TEXTURE0}set(r){(r!==this.current||this.dirty)&&(this.gl.activeTexture(r),this.current=r,this.dirty=!1)}}class Mh extends jr{getDefault(){const r=this.gl;return[0,0,r.drawingBufferWidth,r.drawingBufferHeight]}set(r){const l=this.current;(r[0]!==l[0]||r[1]!==l[1]||r[2]!==l[2]||r[3]!==l[3]||this.dirty)&&(this.gl.viewport(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)}}class sl extends jr{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;l.bindFramebuffer(l.FRAMEBUFFER,r),this.current=r,this.dirty=!1}}class l_ extends jr{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;l.bindRenderbuffer(l.RENDERBUFFER,r),this.current=r,this.dirty=!1}}class Fm extends jr{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;l.bindTexture(l.TEXTURE_2D,r),this.current=r,this.dirty=!1}}class c_ extends jr{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;l.bindBuffer(l.ARRAY_BUFFER,r),this.current=r,this.dirty=!1}}class vp extends jr{getDefault(){return null}set(r){const l=this.gl;l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,r),this.current=r,this.dirty=!1}}class u_ extends jr{getDefault(){return null}set(r){this.gl&&(r!==this.current||this.dirty)&&(this.gl.bindVertexArray(r),this.current=r,this.dirty=!1)}}class Xf extends jr{getDefault(){return 4}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;l.pixelStorei(l.UNPACK_ALIGNMENT,r),this.current=r,this.dirty=!1}}class xp extends jr{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;l.pixelStorei(l.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r),this.current=r,this.dirty=!1}}class Cc extends jr{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;l.pixelStorei(l.UNPACK_FLIP_Y_WEBGL,r),this.current=r,this.dirty=!1}}class Mc extends jr{constructor(r,l){super(r),this.context=r,this.parent=l}getDefault(){return null}}class Nl extends Mc{setDirty(){this.dirty=!0}set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const l=this.gl;l.framebufferTexture2D(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0,l.TEXTURE_2D,r,0),this.current=r,this.dirty=!1}}class Ou extends Mc{attachment(){return this.gl.DEPTH_ATTACHMENT}set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const l=this.gl;l.framebufferRenderbuffer(l.FRAMEBUFFER,this.attachment(),l.RENDERBUFFER,r),this.current=r,this.dirty=!1}}class Yf extends Mc{attachment(){return this.gl.DEPTH_ATTACHMENT}set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const l=this.gl;l.framebufferTexture2D(l.FRAMEBUFFER,this.attachment(),l.TEXTURE_2D,r,0),this.current=r,this.dirty=!1}}class jm extends Ou{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}const bp=(p,r,l)=>({u_matrix:p,u_image0:0,u_skirt_height:r,u_ground_shadow_factor:l}),Co=(p,r,l,m,x,w,A,D,N,U,$,Z,W,te,ue,se)=>({u_proj_matrix:Float32Array.from(p),u_globe_matrix:r,u_normalize_matrix:Float32Array.from(m),u_merc_matrix:l,u_zoom_transition:x,u_merc_center:w,u_image0:0,u_frustum_tl:A,u_frustum_tr:D,u_frustum_br:N,u_frustum_bl:U,u_globe_pos:$,u_globe_radius:Z,u_viewport:W,u_grid_matrix:se?Float32Array.from(se):new Float32Array(9),u_skirt_height:te,u_far_z_cutoff:ue});function wp(p,r){return p!=null&&r!=null&&!(!p.hasData()||!r.hasData())&&p.demTexture!=null&&r.demTexture!=null&&p.tileID.key!==r.tileID.key}const za=new class{constructor(){this.operations={}}newMorphing(p,r,l,m,x){if(p in this.operations){const w=this.operations[p];w.to.tileID.key!==l.tileID.key&&(w.queued=l)}else this.operations[p]={startTime:m,phase:0,duration:x,from:r,to:l,queued:null}}getMorphValuesForProxy(p){if(!(p in this.operations))return null;const r=this.operations[p];return{from:r.from,to:r.to,phase:r.phase}}update(p){for(const r in this.operations){const l=this.operations[r];for(l.phase=(p-l.startTime)/l.duration;l.phase>=1||!this._validOp(l);)if(!this._nextOp(l,p)){delete this.operations[r];break}}}_nextOp(p,r){return!!p.queued&&(p.from=p.to,p.to=p.queued,p.queued=null,p.phase=0,p.startTime=r,!0)}_validOp(p){return p.from.hasData()&&p.to.hasData()}},Pu={0:null,1:"TERRAIN_VERTEX_MORPHING"};function Oh(p,r,l){if(r===0)return 0;const m=r<1&&l===514?.25/r:1;return 6*Math.pow(1.5,22-p)*Math.max(r,1)*m}function Sp(p,r){const l=1<<p.z;return!r&&(p.x===0||p.x===l-1)||p.y===0||p.y===l-1}const Ph=p=>({u_matrix:p});function eo(p,r,l,m,x){if(x>0){const w=i.q.now(),A=(w-p.timeAdded)/x,D=r?(w-r.timeAdded)/x:-1,N=l.getSource(),U=m.coveringZoomLevel({tileSize:N.tileSize,roundZoom:N.roundZoom}),$=!r||Math.abs(r.tileID.overscaledZ-U)>Math.abs(p.tileID.overscaledZ-U),Z=$&&p.refreshedUponExpiration?1:i.aw($?A:1-D,0,1);return p.refreshedUponExpiration&&A>=1&&(p.refreshedUponExpiration=!1),r?{opacity:1,mix:1-Z}:{opacity:Z,mix:0}}return{opacity:1,mix:0}}class _s extends cs{constructor(r){const l={type:"raster-dem",maxzoom:r.transform.maxZoom},m=new i.D(i.ci(),null),x=di("mock-dem",l,m,r.style);super("mock-dem",x,!1),x.setEventedParent(this),this._sourceLoaded=!0}_loadTile(r,l){r.state="loaded",l(null)}}class Oc extends cs{constructor(r){const l=di("proxy",{type:"geojson",maxzoom:r.transform.maxZoom},new i.D(i.ci(),null),r.style);super("proxy",l,!1),l.setEventedParent(this),this.map=this.getSource().map=r,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(r,l,m){if(r.freezeTileCoverage)return;this.transform=r;const x=r.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((w,A)=>{if(w[A.key]="",!this._tiles[A.key]){const D=new Ol(A,this._source.tileSize*A.overscaleFactor(),r.tileZoom);D.state="loaded",this._tiles[A.key]=D}return w},{});for(const w in this._tiles)w in x||(this.freeFBO(w),this._tiles[w].unloadVectorData(),delete this._tiles[w])}freeFBO(r){const l=this.proxyCachedFBO[r];if(l!==void 0){const m=Object.values(l);this.renderCachePool.push(...m),delete this.proxyCachedFBO[r]}}deallocRenderCache(){this.renderCache.forEach(r=>r.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class Tp extends i.aG{constructor(r,l,m){super(r.overscaledZ,r.wrap,r.canonical.z,r.canonical.x,r.canonical.y),this.proxyTileKey=l,this.projMatrix=m}}class Go extends i.cJ{constructor(r,l){super(),this._debugParams={sortTilesHiZFirst:!0,disableRenderCache:!1},r.tp.registerParameter(this._debugParams,["Terrain"],"sortTilesHiZFirst",{},()=>{this._style.map.triggerRepaint()}),r.tp.registerParameter(this._debugParams,["Terrain"],"disableRenderCache",{},()=>{this._style.map.triggerRepaint()}),r.tp.registerButton(["Terrain"],"Invalidate Render Cache",()=>{this.invalidateRenderCache=!0,this._style.map.triggerRepaint()}),this.painter=r,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[m,x,w]=function(N){const U=new i.b4,$=new i.aU,Z=131;U.reserve(17161),$.reserve(33800);const W=i.ag/128,te=i.ag+W/2,ue=te+W;for(let de=-W;de<ue;de+=W)for(let he=-W;he<ue;he+=W){const Te=he<0||he>te||de<0||de>te?24575:0,Pe=i.aw(Math.round(he),0,i.ag),Me=i.aw(Math.round(de),0,i.ag);U.emplaceBack(Pe+Te,Me)}const se=(de,he)=>{const Te=he*Z+de;$.emplaceBack(Te+1,Te,Te+Z),$.emplaceBack(Te+Z,Te+Z+1,Te+1)};for(let de=1;de<129;de++)for(let he=1;he<129;he++)se(he,de);return[0,129].forEach(de=>{for(let he=0;he<130;he++)se(he,de),se(de,he)}),[U,$,32768]}(),A=r.context;this.gridBuffer=A.createVertexBuffer(m,i.b6.members),this.gridIndexBuffer=A.createIndexBuffer(x),this.gridSegments=i.b7.simpleSegment(0,0,m.length,x.length),this.gridNoSkirtSegments=i.b7.simpleSegment(0,0,m.length,w),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new Oc(l.map),this.orthoMatrix=i.ab.mat4.create(),i.ab.mat4.ortho(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,i.ag,0,i.ag,0,1);const D=A.gl;this._overlapStencilMode=new Dn({func:D.GEQUAL,mask:255},0,255,D.KEEP,D.KEEP,D.REPLACE),this._previousZoom=r.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=l,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new _s(l.map),this._pendingGroundEffectLayers=[]}set style(r){r.on("data",this._onStyleDataEvent.bind(this)),this._style=r,this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(r,l,m){if(r&&r.terrain){this._style!==r&&(this.style=r,this._evaluationZoom=void 0);const x=r.terrain.properties,w=r.terrain.drapeRenderMode===0,A=r.terrain.isZoomDependent();this._previousUpdateTimestamp=this.enabled?this._updateTimestamp:void 0,this._updateTimestamp=i.q.now();const D=r.terrain&&r.terrain.scope,N=x.get("source"),U=w?this._mockSourceCache:r.getSourceCache(N,D);if(!U)return void i.w(`Couldn't find terrain source "${N}".`);if(this.sourceCache=U,this._attenuationRange=r.terrain.getAttenuationRange(),this._exaggeration=A?this.calculateExaggeration(l):x.get("exaggeration"),!l.projection.requiresDraping&&A&&this._exaggeration===0)return void this._disable();this.enabled=!0;const $=()=>{this.sourceCache.used&&i.w(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const Z=this.getScaledDemTileSize();this.sourceCache.update(l,Z,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,$(),this._initializing=!0),$(),l.updateElevation(!0,m),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(l),this._emptyDEMTextureDirty=!0,this._previousZoom=l.zoom}else this._disable()}calculateExaggeration(r){if(this._attenuationRange&&r.zoom>=Math.ceil(this._attenuationRange[1]))return this._style.terrain.getExaggeration(r.zoom);const l=this._previousCameraAltitude,m=r.getFreeCameraOptions().position.z/r.pixelsPerMeter*r.worldSize;this._previousCameraAltitude=m;const x=l!=null?m-l:Number.MAX_VALUE;if(Math.abs(x)<2)return this._exaggeration;const w=r.zoom,A=this._style.terrain;if(!this._previousUpdateTimestamp)return A.getExaggeration(w);let D=w-this._previousZoom;const N=this._previousUpdateTimestamp;let U=w;this._evaluationZoom!=null&&(U=this._evaluationZoom,Math.abs(w-U)>.5&&(D=.5*(w-U+D)),D*x<0&&(U+=D)),this._evaluationZoom=U;const $=A.getExaggeration(U),Z=$===A.getExaggeration(Math.max(0,U-.1));if(Z&&Math.abs($-this._exaggeration)<.01)return $;let W=Math.min(.1,.00375*(this._updateTimestamp-N));return(Z||$<.1||Math.abs(D)<1e-4)&&(W=Math.min(.2,4*W)),i.af(this._exaggeration,$,W)}resetTileLookupCache(r){this._findCoveringTileCache[r]={}}attenuationRange(){return this._attenuationRange}getDemUpscale(){return this.proxySourceCache.getSource().tileSize/128}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_onStyleDataEvent(r){r.coord&&r.dataType==="source"?this._clearRenderCacheForTile(r.sourceCacheId,r.coord):r.dataType==="style"&&(this.invalidateRenderCache=!0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this._previousCameraAltitude=void 0)}_disable(){if(this.enabled&&(this.enabled=!1,this._emptyDEMTextureDirty=!0,this._sharedDepthStencil=void 0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const r in this._style._mergedSourceCaches)this._style._mergedSourceCaches[r].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this.pool.forEach(r=>r.fb.destroy()),this.pool=[],this.framebufferCopyTexture&&this.framebufferCopyTexture.destroy()}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this.enabled?this._exaggeration:0}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const r=2*this.proxySourceCache.getSource().tileSize;return[r,r]}set useVertexMorphing(r){this._useVertexMorphing=r}updateTileBinding(r){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const l=this.proxySourceCache,m=this.painter.transform;this._initializing&&(this._initializing=m._centerAltitude===0&&this.getAtPointOrZero(i.aa.fromLngLat(m.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const x=this.proxyCoords=l.getIds().map(N=>{const U=l.getTileByID(N).tileID;return U.projMatrix=m.calculateProjMatrix(U.toUnwrapped()),U});(function(N,U){const $=U.transform.pointCoordinate(U.transform.getCameraPoint()),Z=new i.P($.x,$.y);N.sort((W,te)=>{if(te.overscaledZ-W.overscaledZ)return te.overscaledZ-W.overscaledZ;const ue=new i.P(W.canonical.x+(1<<W.canonical.z)*W.wrap,W.canonical.y),se=new i.P(te.canonical.x+(1<<te.canonical.z)*te.wrap,te.canonical.y),de=Z.mult(1<<W.canonical.z);return de.x-=.5,de.y-=.5,de.distSqr(ue)-de.distSqr(se)})})(x,this.painter);const w=this.proxyToSource||{};this.proxyToSource={},x.forEach(N=>{this.proxyToSource[N.key]={}}),this.terrainTileForTile={};const A=this._style._mergedSourceCaches;for(const N in A){const U=A[N];if(!U.used||(U!==this.sourceCache&&this.resetTileLookupCache(U.id),this._setupProxiedCoordsForOrtho(U,r[N],w),U.usedForTerrain))continue;const $=r[N];U.getSource().reparseOverscaled&&this._assignTerrainTiles($)}this.proxiedCoords[l.id]=x.map(N=>new Tp(N,N.key,this.orthoMatrix)),this._assignTerrainTiles(x),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(w),this.renderingToTexture=!1;const D={};this._visibleDemTiles=[];for(const N of this.proxyCoords){const U=this.terrainTileForTile[N.key];if(!U)continue;const $=U.tileID.key;$ in D||(this._visibleDemTiles.push(U),D[$]=$)}}_assignTerrainTiles(r){this._initializing||r.forEach(l=>{if(this.terrainTileForTile[l.key])return;const m=this._findTileCoveringTileID(l,this.sourceCache);m&&(this.terrainTileForTile[l.key]=m)})}_prepareDEMTextures(){const r=this.painter.context,l=r.gl;for(const m in this.terrainTileForTile){const x=this.terrainTileForTile[m],w=x.dem;!w||x.demTexture&&!x.needsDEMTextureUpload||(r.activeTexture.set(l.TEXTURE1),Au(this.painter,x,w))}}_prepareDemTileUniforms(r,l,m,x){if(!l||l.demTexture==null)return!1;const w=r.tileID.canonical,A=Math.pow(2,l.tileID.canonical.z-w.z),D=x||"";return m[`u_dem_tl${D}`]=[w.x*A%1,w.y*A%1],m[`u_dem_scale${D}`]=A,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}_getLoadedAreaMinimum(){if(!this.enabled)return 0;let r=0;const l=this._visibleDemTiles.reduce((m,x)=>{if(!x.dem)return m;const w=x.dem.tree.minimums[0];return w>0&&r++,m+w},0);return r?l/r:0}_updateEmptyDEMTexture(){const r=this.painter.context,l=r.gl;r.activeTexture.set(l.TEXTURE2);const m=this._getLoadedAreaMinimum(),x=new i.cK({width:1,height:1},new Float32Array([m]));this._emptyDEMTextureDirty=!1;let w=this._emptyDEMTexture;return w?w.update(x,{premultiply:!1}):w=this._emptyDEMTexture=new i.T(r,x,l.R32F,{premultiply:!1}),w}setupElevationDraw(r,l,m){const x=this.painter.context,w=x.gl,A={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0};A.u_exaggeration=this.exaggeration();let D=null,N=null,U=1;if(m&&m.morphing&&this._useVertexMorphing){const te=m.morphing.srcDemTile,ue=m.morphing.dstDemTile;U=m.morphing.phase,te&&ue&&(this._prepareDemTileUniforms(r,te,A,"_prev")&&(N=te),this._prepareDemTileUniforms(r,ue,A)&&(D=ue))}const $=te=>te&&te.demTexture&&this.painter.linearFloatFilteringSupported()?w.LINEAR:w.NEAREST;let Z=null;var W;if(this.enabled?N&&D?(Z=D.demTexture,x.activeTexture.set(w.TEXTURE4),N.demTexture.bind($(N),w.CLAMP_TO_EDGE),A.u_dem_lerp=U):(D=this.terrainTileForTile[r.tileID.key],Z=this._prepareDemTileUniforms(r,D,A)?D.demTexture:this.emptyDEMTexture):Z=this.emptyDEMTexture,x.activeTexture.set(w.TEXTURE2),Z&&(A.u_dem_size=(W=Z).size[0]===1?1:W.size[0]-2,Z.bind($(D),w.CLAMP_TO_EDGE)),this.painter.setupDepthForOcclusion(m&&m.useDepthForOcclusion,l,A),m&&m.useMeterToDem&&D){const te=(1<<D.tileID.canonical.z)*i.bH(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;A.u_meter_to_dem=te}if(m&&m.labelPlaneMatrixInv&&(A.u_label_plane_matrix_inv=m.labelPlaneMatrixInv),l.setTerrainUniformValues(x,A),this.painter.transform.projection.name==="globe"){const te=this.globeUniformValues(this.painter.transform,r.tileID.canonical,m&&m.useDenormalizedUpVectorScale);l.setGlobeUniformValues(x,te)}}globeUniformValues(r,l,m){const x=r.projection;return{u_tile_tl_up:x.upVector(l,0,0),u_tile_tr_up:x.upVector(l,i.ag,0),u_tile_br_up:x.upVector(l,i.ag,i.ag),u_tile_bl_up:x.upVector(l,0,i.ag),u_tile_up_scale:m?i.cL(1):x.upVectorScale(l,r.center.lat,r.worldSize).metersToTile}}renderToBackBuffer(r){const l=this.painter,m=this.painter.context;r.length!==0&&(m.bindFramebuffer.set(null),m.viewport.set([0,0,l.width,l.height]),l.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(x,w,A,D,N){if(x.transform.projection.name==="globe")(function(U,$,Z,W,te){const ue=U.context,se=ue.gl;let de,he;const Te=U.transform,Pe=i.cC(U,ue,Te),Me=(Et,yt)=>{if(he===yt)return;const nt=[Pu[yt],"PROJECTION_GLOBE_VIEW"];Pe&&nt.push("CUSTOM_ANTIALIASING");const pt=U.isTileAffectedByFog(Et);de=U.getOrCreateProgram("globeRaster",{defines:nt,overrideFog:pt}),he=yt},Fe=U.colorModeForRenderPass(),Re=new Tn(se.LEQUAL,Tn.ReadWrite,U.depthRangeFor3D);za.update(te);const ze=i.cD(Te),De=[i.at(Te.center.lng),i.aA(Te.center.lat)],$e=U.globeSharedBuffers,Xe=[Te.width*i.q.devicePixelRatio,Te.height*i.q.devicePixelRatio],ht=Float32Array.from(Te.globeMatrix),ot={useDenormalizedUpVectorScale:!0};{const Et=U.transform,yt=Oh(Et.zoom,$.exaggeration(),$.sourceCache._source.tileSize);he=-1;const nt=se.TRIANGLES;for(const pt of W){const Lt=Z.getTile(pt),tt=Dn.disabled,St=$.prevTerrainTileForTile[pt.key],mt=$.terrainTileForTile[pt.key];wp(St,mt)&&za.newMorphing(pt.key,St,mt,te,250),ue.activeTexture.set(se.TEXTURE0),Lt.texture&&Lt.texture.bind(se.LINEAR,se.CLAMP_TO_EDGE);const Gt=za.getMorphValuesForProxy(pt.key),It=Gt?1:0;Gt&&i.J(ot,{morphing:{srcDemTile:Gt.from,dstDemTile:Gt.to,phase:i.cB(Gt.phase)}});const At=i.cE(pt.canonical),zt=i.cF(At.getCenter().lat),Wt=i.cG(pt.canonical,At,zt,Et.worldSize/Et._pixelsPerMercatorPixel),on=i.bb(i.cH(pt.canonical)),dn=Co(Et.expandedFarZProjMatrix,ht,ze,on,i.ae(Et.zoom),De,Et.frustumCorners.TL,Et.frustumCorners.TR,Et.frustumCorners.BR,Et.frustumCorners.BL,Et.globeCenterInViewSpace,Et.globeRadius,Xe,yt,Et._farZ,Wt);if(Me(pt,It),de&&($.setupElevationDraw(Lt,de,ot),U.uploadCommonUniforms(ue,de,pt.toUnwrapped()),$e)){const[En,Sn,bn]=$e.getGridBuffers(zt,yt!==0);de.draw(U,nt,Re,tt,Fe,Rn.backCCW,dn,"globe_raster",En,Sn,bn)}}}if($e&&(U.renderDefaultNorthPole||U.renderDefaultSouthPole)){const Et=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];Pe&&Et.push("CUSTOM_ANTIALIASING"),de=U.getOrCreateProgram("globeRaster",{defines:Et});for(const yt of W){const{x:nt,y:pt,z:Lt}=yt.canonical,tt=pt===0,St=pt===(1<<Lt)-1,[mt,Gt,It,At]=$e.getPoleBuffers(Lt,!1);if(At&&(tt||St)){const zt=Z.getTile(yt);ue.activeTexture.set(se.TEXTURE0),zt.texture&&zt.texture.bind(se.LINEAR,se.CLAMP_TO_EDGE);let Wt=i.cI(Lt,nt,Te);const on=i.bb(i.cH(yt.canonical)),dn=(En,Sn)=>En.draw(U,se.TRIANGLES,Re,Dn.disabled,Fe,Rn.disabled,Co(Te.expandedFarZProjMatrix,Wt,Wt,on,0,De,Te.frustumCorners.TL,Te.frustumCorners.TR,Te.frustumCorners.BR,Te.frustumCorners.BL,Te.globeCenterInViewSpace,Te.globeRadius,Xe,0,Te._farZ),"globe_pole_raster",Sn,It,At);$.setupElevationDraw(zt,de,ot),U.uploadCommonUniforms(ue,de,yt.toUnwrapped()),tt&&U.renderDefaultNorthPole&&dn(de,mt),St&&U.renderDefaultSouthPole&&(Wt=i.ab.mat4.scale(i.ab.mat4.create(),Wt,[1,-1,1]),dn(de,Gt))}}}})(x,w,A,D,N);else{const U=x.context,$=U.gl;let Z,W;const te=x.shadowRenderer,ue=_c(x,x.longestCutoffRange),se=Fe=>{if(W===Fe)return;const Re=[];Re.push(Pu[Fe]),ue.shouldRenderCutoff&&Re.push("RENDER_CUTOFF"),te&&(Re.push("RENDER_SHADOWS","DEPTH_TEXTURE"),te.useNormalOffset&&Re.push("NORMAL_OFFSET")),Z=x.getOrCreateProgram("terrainRaster",{defines:Re}),W=Fe},de=x.colorModeForRenderPass(),he=new Tn($.LEQUAL,Tn.ReadWrite,x.depthRangeFor3D);za.update(N);const Te=x.transform,Pe=Oh(Te.zoom,w.exaggeration(),w.sourceCache._source.tileSize);let Me=[0,0,0];if(te){const Fe=x.style.directionalLight,Re=x.style.ambientLight;Fe&&Re&&(Me=dp(x.style,Fe,Re))}{W=-1;const Fe=$.TRIANGLES,[Re,ze]=[w.gridIndexBuffer,w.gridSegments];for(const De of D){const $e=A.getTile(De),Xe=Dn.disabled,ht=w.prevTerrainTileForTile[De.key],ot=w.terrainTileForTile[De.key];wp(ht,ot)&&za.newMorphing(De.key,ht,ot,N,250),U.activeTexture.set($.TEXTURE0),$e.texture&&$e.texture.bind($.LINEAR,$.CLAMP_TO_EDGE);const Et=za.getMorphValuesForProxy(De.key),yt=Et?1:0;let nt;Et&&(nt={morphing:{srcDemTile:Et.from,dstDemTile:Et.to,phase:i.cB(Et.phase)}});const pt=bp(De.projMatrix,Sp(De.canonical,Te.renderWorldCopies)?Pe/10:Pe,Me);if(se(yt),!Z)continue;w.setupElevationDraw($e,Z,nt);const Lt=De.toUnwrapped();te&&te.setupShadows(Lt,Z),x.uploadCommonUniforms(U,Z,Lt,null,ue),Z.draw(x,Fe,he,Xe,de,Rn.backCCW,pt,"terrain_raster",w.gridBuffer,Re,ze)}}}}(l,this,this.proxySourceCache,r,this._updateTimestamp),this.renderingToTexture=!0,l.gpuTimingDeferredRenderEnd(),r.splice(0,r.length))}renderBatch(r){if(this._drapedRenderBatches.length===0)return r+1;this.renderingToTexture=!0;const l=this.painter,m=this.painter.context,x=this.proxySourceCache,w=this.proxiedCoords[x.id],A=this._drapedRenderBatches.shift(),D=l.style.order,N=[];let U=0;for(const $ of w){const Z=x.getTileByID($.proxyTileKey),W=x.proxyCachedFBO[$.key]?x.proxyCachedFBO[$.key][r]:void 0,te=W!==void 0?x.renderCache[W]:this.pool[U++],ue=W!==void 0;if(Z.texture=te.tex,ue&&!te.dirty){N.push(Z.tileID);continue}let se;m.bindFramebuffer.set(te.fb.framebuffer),this.renderedToTile=!1,te.dirty&&(m.clear({color:i.aj.transparent,stencil:0}),te.dirty=!1);for(let de=A.start;de<=A.end;++de){const he=l.style._mergedLayers[D[de]];if(he.isHidden(l.transform.zoom))continue;const Te=l.style.getLayerSourceCache(he),Pe=Te?this.proxyToSource[$.key][Te.id]:[$];if(!Pe)continue;const Me=Pe;m.viewport.set([0,0,te.fb.width,te.fb.height]),se!==(Te?Te.id:null)&&(this._setupStencil(te,Pe,he,Te),se=Te?Te.id:null),l.renderLayer(l,Te,he,Me)}if(this._drapedRenderBatches.length===0)for(const de of this._pendingGroundEffectLayers){const he=l.style._mergedLayers[D[de]];if(he.isHidden(l.transform.zoom))continue;const Te=l.style.getLayerSourceCache(he),Pe=Te?this.proxyToSource[$.key][Te.id]:[$];if(!Pe)continue;const Me=Pe;m.viewport.set([0,0,te.fb.width,te.fb.height]),se!==(Te?Te.id:null)&&(this._setupStencil(te,Pe,he,Te),se=Te?Te.id:null),l.renderLayer(l,Te,he,Me)}this.renderedToTile?(te.dirty=!0,N.push(Z.tileID)):ue||--U,U===5&&(U=0,this.renderToBackBuffer(N))}return this.renderToBackBuffer(N),this.renderingToTexture=!1,m.bindFramebuffer.set(null),m.viewport.set([0,0,l.width,l.height]),A.end+1}postRender(){}isLayerOrderingCorrect(r){const l=r.order.length;let m=-1,x=l;for(let w=0;w<l;++w)this._style.isLayerDraped(r._mergedLayers[r.order[w]])?m=Math.max(m,w):x=Math.min(x,w);return x>m}getMinElevationBelowMSL(){let r=0;return this._visibleDemTiles.filter(l=>l.dem).forEach(l=>{r=Math.min(r,l.dem.tree.minimums[0])}),r===0?r:(r-30)*this._exaggeration}raycast(r,l,m){if(!this._visibleDemTiles)return null;const x=this._visibleDemTiles.filter(w=>w.dem).map(w=>{const A=w.tileID,D=1<<A.overscaledZ,{x:N,y:U}=A.canonical,$=N/D,Z=(N+1)/D,W=U/D,te=(U+1)/D;return{minx:$,miny:W,maxx:Z,maxy:te,t:w.dem.tree.raycastRoot($,W,Z,te,r,l,m),tile:w}});x.sort((w,A)=>(w.t!==null?w.t:Number.MAX_VALUE)-(A.t!==null?A.t:Number.MAX_VALUE));for(const w of x){if(w.t==null)return null;const A=w.tile.dem.tree.raycast(w.minx,w.miny,w.maxx,w.maxy,r,l,m);if(A!=null)return A}return null}_createFBO(){const r=this.painter.context,l=r.gl,m=this.drapeBufferSize;r.activeTexture.set(l.TEXTURE0);const x=new i.T(r,{width:m[0],height:m[1],data:null},l.RGBA8);x.bind(l.LINEAR,l.CLAMP_TO_EDGE);const w=r.createFramebuffer(m[0],m[1],!0,null);return w.colorAttachment.set(x.texture),w.depthAttachment=new jm(r,w.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=r.createRenderbuffer(r.gl.DEPTH_STENCIL,m[0],m[1]),this._stencilRef=0,w.depthAttachment.set(this._sharedDepthStencil),r.clear({stencil:0})):w.depthAttachment.set(this._sharedDepthStencil),r.extTextureFilterAnisotropic&&l.texParameterf(l.TEXTURE_2D,r.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,r.extTextureFilterAnisotropicMax),{fb:w,tex:x,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._debugParams.disableRenderCache||this._style.hasLightTransitions())return!0;for(const r in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[r].hasTransition())return!0;return this._style.order.some(r=>{const l=this._style._mergedLayers[r],m=l.isHidden(this.painter.transform.zoom);return l.type==="hillshade"||l.type==="custom"?!m&&l.shouldRedrape():!m&&l.hasTransition()})}_clearLineLayersFromRenderCache(){let r=!1;for(const m of this._style.getSources())if(m instanceof Pi){r=!0;break}if(!r)return;const l={};for(let m=0;m<this._style.order.length;++m){const x=this._style._mergedLayers[this._style.order[m]],w=this._style.getLayerSourceCache(x);if(w&&!l[w.id]&&!x.isHidden(this.painter.transform.zoom)&&x.type==="line"&&x.widthExpression()instanceof i.a9){l[w.id]=!0;for(const A of this.proxyCoords){const D=this.proxyToSource[A.key][w.id];if(D)for(const N of D)this._clearRenderCacheForTile(w.id,N)}}}}_clearRasterLayersFromRenderCache(){let r=!1;for(const m in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[m]._source instanceof Uo){r=!0;break}if(!r)return;const l={};for(let m=0;m<this._style.order.length;++m){const x=this._style._mergedLayers[this._style.order[m]],w=this._style.getLayerSourceCache(x);if(!w||l[w.id]||x.isHidden(this.painter.transform.zoom)||x.type!=="raster")continue;const A=x.paint.get("raster-fade-duration");for(const D of this.proxyCoords){const N=this.proxyToSource[D.key][w.id];if(N)for(const U of N){const $=eo(w.getTile(U),w.findLoadedParent(U,0),w,this.painter.transform,A);($.opacity!==1||$.mix!==0)&&this._clearRenderCacheForTile(w.id,U)}}}}_setupDrapedRenderBatches(){this._style.updateDrapeFirstLayers();const r=this._style.order,l=r.length;if(l===0)return;const m=[];this._pendingGroundEffectLayers=[];let x,w=0,A=this._style._mergedLayers[r[w]];for(;!this._style.isLayerDraped(A)&&A.isHidden(this.painter.transform.zoom)&&++w<l;)A=this._style._mergedLayers[r[w]];for(;w<l;++w){const D=this._style._mergedLayers[r[w]];D.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(D)?x===void 0&&(x=w):(D.type==="fill-extrusion"&&this._pendingGroundEffectLayers.push(w),x!==void 0&&(m.push({start:x,end:w-1}),x=void 0)))}if(x!==void 0&&m.push({start:x,end:w-1}),m.length!==0){const D=m[m.length-1];this._pendingGroundEffectLayers.every(N=>N>D.end)||i.w("fill-extrusion with flood lighting and/or ground ambient occlusion should be moved to be on top of all draped layers.")}this._drapedRenderBatches=m}_setupRenderCache(r){const l=this.proxySourceCache;if(this._shouldDisableRenderCache()||this.invalidateRenderCache){if(this.invalidateRenderCache=!1,l.renderCache.length>l.renderCachePool.length){const A=Object.values(l.proxyCachedFBO);l.proxyCachedFBO={};for(let D=0;D<A.length;++D){const N=Object.values(A[D]);l.renderCachePool.push(...N)}}return}this._clearRasterLayersFromRenderCache();const m=this.proxyCoords,x=this._tilesDirty;for(let A=m.length-1;A>=0;A--){const D=m[A];if(l.getTileByID(D.key),l.proxyCachedFBO[D.key]!==void 0){const N=r[D.key],U=this.proxyToSource[D.key];let $=0;for(const Z in U){const W=U[Z],te=N[Z];if(!te||te.length!==W.length||W.some((ue,se)=>ue!==te[se]||x[Z]&&x[Z].hasOwnProperty(ue.key))){$=-1;break}++$}for(const Z in l.proxyCachedFBO[D.key])l.renderCache[l.proxyCachedFBO[D.key][Z]].dirty=$<0||$!==Object.values(N).length}}const w=[...this._drapedRenderBatches];w.sort((A,D)=>D.end-D.start-(A.end-A.start));for(const A of w)for(const D of m){if(l.proxyCachedFBO[D.key])continue;let N=l.renderCachePool.pop();N===void 0&&l.renderCache.length<50&&(N=l.renderCache.length,l.renderCache.push(this._createFBO())),N!==void 0&&(l.proxyCachedFBO[D.key]={},l.proxyCachedFBO[D.key][A.start]=N,l.renderCache[N].dirty=!0)}this._tilesDirty={}}_setupStencil(r,l,m,x){if(!x||!this._sourceTilesOverlap[x.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const w=this.painter.context,A=w.gl;if(l.length<=1)return void(this._overlapStencilType=!1);let D;if(m.isTileClipped())D=l.length,this._overlapStencilMode.test={func:A.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(l[0].overscaledZ>l[l.length-1].overscaledZ))return void(this._overlapStencilType=!1);D=1,this._overlapStencilMode.test={func:A.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+D>255&&(w.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=D,this._overlapStencilMode.ref=this._stencilRef,m.isTileClipped()&&this._renderTileClippingMasks(l,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(r){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[r.key]),this._overlapStencilMode):Dn.disabled}_renderTileClippingMasks(r,l){const m=this.painter,x=this.painter.context,w=x.gl;m._tileClippingMaskIDs={},x.setColorMode(Jn.disabled),x.setDepthMode(Tn.disabled);const A=m.getOrCreateProgram("clippingMask");for(const D of r){const N=m._tileClippingMaskIDs[D.key]=--l;A.draw(m,w.TRIANGLES,Tn.disabled,new Dn({func:w.ALWAYS,mask:0},N,255,w.KEEP,w.KEEP,w.REPLACE),Jn.disabled,Rn.disabled,Ph(D.projMatrix),"$clipping",m.tileExtentBuffer,m.quadTriangleIndexBuffer,m.tileExtentSegments)}}pointCoordinate(r){const l=this.painter.transform;if(r.x<0||r.x>l.width||r.y<0||r.y>l.height)return null;const m=[r.x,r.y,1,1];i.ab.vec4.transformMat4(m,m,l.pixelMatrixInverse),i.ab.vec4.scale(m,m,1/m[3]),m[0]/=l.worldSize,m[1]/=l.worldSize;const x=l._camera.position,w=i.bH(1,l.center.lat),A=[x[0],x[1],x[2]/w,0],D=i.ab.vec3.subtract([],m.slice(0,3),A);i.ab.vec3.normalize(D,D);const N=this.raycast(A,D,this._exaggeration);return N!==null&&N?(i.ab.vec3.scaleAndAdd(A,A,D,N),A[3]=A[2],A[2]*=w,A):null}_setupProxiedCoordsForOrtho(r,l,m){if(r.getSource()instanceof i.aJ)return this._setupProxiedCoordsForImageSource(r,l,m);this._findCoveringTileCache[r.id]=this._findCoveringTileCache[r.id]||{};const x=this.proxiedCoords[r.id]=[],w=this.proxyCoords;for(let N=0;N<w.length;N++){const U=w[N],$=this._findTileCoveringTileID(U,r);if($){const Z=this._createProxiedId(U,$,m[U.key]&&m[U.key][r.id]);x.push(Z),this.proxyToSource[U.key][r.id]=[Z]}}let A=!1;const D=new Set;for(let N=0;N<l.length;N++){const U=r.getTile(l[N]);if(!U||!U.hasData())continue;const $=this._findTileCoveringTileID(U.tileID,this.proxySourceCache);if($&&$.tileID.canonical.z!==U.tileID.canonical.z){const Z=this.proxyToSource[$.tileID.key][r.id],W=this._createProxiedId($.tileID,U,m[$.tileID.key]&&m[$.tileID.key][r.id]);Z?Z.splice(Z.length-1,0,W):this.proxyToSource[$.tileID.key][r.id]=[W];const te=this.proxyToSource[$.tileID.key][r.id];D.has(te)||D.add(te),x.push(W),A=!0}}if(this._sourceTilesOverlap[r.id]=A,A&&this._debugParams.sortTilesHiZFirst)for(const N of D)N.sort((U,$)=>$.overscaledZ-U.overscaledZ)}_setupProxiedCoordsForImageSource(r,l,m){if(!r.getSource().loaded())return;const x=this.proxiedCoords[r.id]=[],w=this.proxyCoords,A=r.getSource(),D=A.tileID;if(!D)return;const N=new i.P(D.x,D.y)._div(1<<D.z),U=A.coordinates.map(i.aa.fromLngLat).reduce((Z,W)=>(Z.min.x=Math.min(Z.min.x,W.x-N.x),Z.min.y=Math.min(Z.min.y,W.y-N.y),Z.max.x=Math.max(Z.max.x,W.x-N.x),Z.max.y=Math.max(Z.max.y,W.y-N.y),Z),{min:new i.P(Number.MAX_VALUE,Number.MAX_VALUE),max:new i.P(-Number.MAX_VALUE,-Number.MAX_VALUE)}),$=(Z,W)=>{const te=Z.wrap+Z.canonical.x/(1<<Z.canonical.z),ue=Z.canonical.y/(1<<Z.canonical.z),se=i.ag/(1<<Z.canonical.z),de=W.wrap+W.canonical.x/(1<<W.canonical.z),he=W.canonical.y/(1<<W.canonical.z);return te+se<de+U.min.x||te>de+U.max.x||ue+se<he+U.min.y||ue>he+U.max.y};for(let Z=0;Z<w.length;Z++){const W=w[Z];for(let te=0;te<l.length;te++){const ue=r.getTile(l[te]);if(!ue||!ue.hasData()||$(W,ue.tileID))continue;const se=this._createProxiedId(W,ue,m[W.key]&&m[W.key][r.id]),de=this.proxyToSource[W.key][r.id];de?de.push(se):this.proxyToSource[W.key][r.id]=[se],x.push(se)}}}_createProxiedId(r,l,m){let x=this.orthoMatrix;if(m){const w=m.find(A=>A.key===l.tileID.key);if(w)return w}if(l.tileID.key!==r.key){const w=r.canonical.z-l.tileID.canonical.z;let A,D,N;x=i.ab.mat4.create();const U=l.tileID.wrap-r.wrap<<r.overscaledZ;w>0?(A=i.ag>>w,D=A*((l.tileID.canonical.x<<w)-r.canonical.x+U),N=A*((l.tileID.canonical.y<<w)-r.canonical.y)):(A=i.ag<<-w,D=i.ag*(l.tileID.canonical.x-(r.canonical.x+U<<-w)),N=i.ag*(l.tileID.canonical.y-(r.canonical.y<<-w))),i.ab.mat4.ortho(x,0,A,0,A,0,1),i.ab.mat4.translate(x,x,[D,N,0])}return new Tp(l.tileID,r.key,x)}_findTileCoveringTileID(r,l){let m=l.getTile(r);if(m&&m.hasData())return m;const x=this._findCoveringTileCache[l.id],w=x[r.key];if(m=w?l.getTileByID(w):null,m&&m.hasData()||w===null)return m;let A=m?m.tileID:r,D=A.overscaledZ;const N=l.getSource().minzoom,U=[];if(!w){const Z=l.getSource().maxzoom;if(r.canonical.z>=Z){const W=r.canonical.z-Z;l.getSource().reparseOverscaled?(D=Math.max(r.canonical.z+2,l.transform.tileZoom),A=new i.aG(D,r.wrap,Z,r.canonical.x>>W,r.canonical.y>>W)):W!==0&&(D=Z,A=new i.aG(D,r.wrap,Z,r.canonical.x>>W,r.canonical.y>>W))}A.key!==r.key&&(U.push(A.key),m=l.getTile(A))}const $=Z=>{U.forEach(W=>{x[W]=Z}),U.length=0};for(D-=1;D>=N&&(!m||!m.hasData());D--){m&&$(m.tileID.key);const Z=A.calculateScaledKey(D);if(m=l.getTileByID(Z),m&&m.hasData())break;const W=x[Z];if(W===null)break;W===void 0?U.push(Z):m=l.getTileByID(W)}return $(m?m.tileID.key:null),m&&m.hasData()?m:null}findDEMTileFor(r){return this.enabled?this._findTileCoveringTileID(r,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(r,l){let m=this._tilesDirty[r];m||(m=this._tilesDirty[r]={}),m[l.key]=!0}}function Fl(p,r,l){const m=function(D,N,U){const $=i.ab.vec3.dot(N,D),Z=i.ab.vec3.dot(U,[.2126,.7152,.0722]),W=(ue,se,de)=>(1-de)*ue+de*se,te=W(1-.3*Math.min(Z,1),1,Math.min($+1,1));return W(.92,1,Math.asin(i.aw(N[2],-1,1))/Math.PI+.5)*te}(p,[0,0,1],r),x=[0,0,0];i.ab.vec3.scale(x,l.slice(0,3),m);const w=[0,0,0];i.ab.vec3.scale(w,r.slice(0,3),p[2]);const A=[0,0,0];return i.ab.vec3.add(A,x,w),i.cf(A)}const wa=["fill","fillOutline","fillPattern","line","linePattern","background","backgroundPattern","hillshade","raster"],Kf=["stars","rainParticle","snowParticle","fillExtrusion","fillExtrusionGroundEffect","model","symbol"];class h_{static cacheKey(r,l,m,x){let w=`${l}${x?x.cacheKey:""}`;for(const A of m)r.usedDefines.includes(A)&&(w+=`/${A}`);return w}constructor(r,l,m,x,w,A){const D=r.gl;this.program=D.createProgram(),this.configuration=x,this.name=l,this.fixedDefines=[...A];const N=x?x.getBinderAttributes():[],U=(m.staticAttributes||[]).concat(N);let $=x?x.defines():[];$=$.concat(A.map(de=>`#define ${de}`));const Z=`#version 300 es
`;let W=Z+$.concat("precision mediump float;",Su,wu.fragmentSource).join(`
`);for(const de of m.fragmentIncludes)W+=`
${Sc[de]}`;W+=`
${m.fragmentSource}`;let te=Z+$.concat("precision highp float;",Su,wu.vertexSource).join(`
`);for(const de of m.vertexIncludes)te+=`
${Sc[de]}`;this.forceManualRenderingForInstanceIDShaders=r.forceManualRenderingForInstanceIDShaders&&m.vertexSource.indexOf("gl_InstanceID")!==-1,this.forceManualRenderingForInstanceIDShaders&&(te+=`
uniform int u_instanceID;
`),te+=`
${m.vertexSource}`,this.forceManualRenderingForInstanceIDShaders&&(te=te.replaceAll("gl_InstanceID","u_instanceID"));const ue=D.createShader(D.FRAGMENT_SHADER);if(D.isContextLost())return void(this.failedToCreate=!0);D.shaderSource(ue,W),D.compileShader(ue),D.attachShader(this.program,ue);const se=D.createShader(D.VERTEX_SHADER);if(D.isContextLost())this.failedToCreate=!0;else{D.shaderSource(se,te),D.compileShader(se),D.attachShader(this.program,se),this.attributes={},this.numAttributes=U.length;for(let de=0;de<this.numAttributes;de++)if(U[de]){const he=U[de].startsWith("a_")?U[de]:`a_${U[de]}`;D.bindAttribLocation(this.program,de,he),this.attributes[he]=de}D.linkProgram(this.program),D.deleteShader(se),D.deleteShader(ue),this.fixedUniforms=w(r),this.binderUniforms=x?x.getUniforms(r):[],this.forceManualRenderingForInstanceIDShaders&&(this.instancingUniforms=(de=>({u_instanceID:new i.bN(de)}))(r)),(A.includes("TERRAIN")||l.indexOf("symbol")!==-1||l.indexOf("circle")!==-1)&&(this.terrainUniforms=(de=>({u_dem:new i.bN(de),u_dem_prev:new i.bN(de),u_dem_tl:new i.bK(de),u_dem_scale:new i.bM(de),u_dem_tl_prev:new i.bK(de),u_dem_scale_prev:new i.bM(de),u_dem_size:new i.bM(de),u_dem_lerp:new i.bM(de),u_exaggeration:new i.bM(de),u_depth:new i.bN(de),u_depth_size_inv:new i.bK(de),u_depth_range_unpack:new i.bK(de),u_occluder_half_size:new i.bM(de),u_occlusion_depth_offset:new i.bM(de),u_meter_to_dem:new i.bM(de),u_label_plane_matrix_inv:new i.bJ(de)}))(r)),A.includes("GLOBE")&&(this.globeUniforms=(de=>({u_tile_tl_up:new i.bL(de),u_tile_tr_up:new i.bL(de),u_tile_br_up:new i.bL(de),u_tile_bl_up:new i.bL(de),u_tile_up_scale:new i.bM(de)}))(r)),A.includes("FOG")&&(this.fogUniforms=(de=>({u_fog_matrix:new i.bJ(de),u_fog_range:new i.bK(de),u_fog_color:new i.ca(de),u_fog_horizon_blend:new i.bM(de),u_fog_vertical_limit:new i.bK(de),u_fog_temporal_offset:new i.bM(de),u_frustum_tl:new i.bL(de),u_frustum_tr:new i.bL(de),u_frustum_br:new i.bL(de),u_frustum_bl:new i.bL(de),u_globe_pos:new i.bL(de),u_globe_radius:new i.bM(de),u_globe_transition:new i.bM(de),u_is_globe:new i.bN(de),u_viewport:new i.bK(de)}))(r)),A.includes("RENDER_CUTOFF")&&(this.cutoffUniforms=(de=>({u_cutoff_params:new i.ca(de)}))(r)),A.includes("LIGHTING_3D_MODE")&&(this.lightsUniforms=(de=>({u_lighting_ambient_color:new i.bL(de),u_lighting_directional_dir:new i.bL(de),u_lighting_directional_color:new i.bL(de),u_ground_radiance:new i.bL(de)}))(r)),A.includes("RENDER_SHADOWS")&&(this.shadowUniforms=(de=>({u_light_matrix_0:new i.bJ(de),u_light_matrix_1:new i.bJ(de),u_fade_range:new i.bK(de),u_shadow_normal_offset:new i.bL(de),u_shadow_intensity:new i.bM(de),u_shadow_texel_size:new i.bM(de),u_shadow_map_resolution:new i.bM(de),u_shadow_direction:new i.bL(de),u_shadow_bias:new i.bL(de),u_shadowmap_0:new i.bN(de),u_shadowmap_1:new i.bN(de)}))(r))}}setTerrainUniformValues(r,l){if(!this.terrainUniforms)return;const m=this.terrainUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const x in l)m[x]&&m[x].set(this.program,x,l[x])}}setGlobeUniformValues(r,l){if(!this.globeUniforms)return;const m=this.globeUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const x in l)m[x]&&m[x].set(this.program,x,l[x])}}setFogUniformValues(r,l){if(!this.fogUniforms)return;const m=this.fogUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const x in l)m[x].set(this.program,x,l[x])}}setCutoffUniformValues(r,l){if(!this.cutoffUniforms)return;const m=this.cutoffUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const x in l)m[x].set(this.program,x,l[x])}}setLightsUniformValues(r,l){if(!this.lightsUniforms)return;const m=this.lightsUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const x in l)m[x].set(this.program,x,l[x])}}setShadowUniformValues(r,l){if(this.failedToCreate||!this.shadowUniforms)return;const m=this.shadowUniforms;r.program.set(this.program);for(const x in l)m[x].set(this.program,x,l[x])}_drawDebugWireframe(r,l,m,x,w,A,D,N,U,$){const Z=r.options.wireframe;if(Z.terrain===!1&&Z.layers2D===!1&&Z.layers3D===!1)return;const W=r.context;if(!(!(!Z.terrain||this.name!=="terrainRaster"&&this.name!=="globeRaster")||!(!Z.layers2D||r._terrain&&r._terrain.renderingToTexture||!wa.includes(this.name))||!(!Z.layers3D||!Kf.includes(this.name))))return;const te=W.gl,ue=r.wireframeDebugCache.getLinesFromTrianglesBuffer(r.frameCounter,w,W);if(!ue)return;const se=[...this.fixedDefines];se.push("DEBUG_WIREFRAME");const de=r.getOrCreateProgram(this.name,{config:this.configuration,defines:se});W.program.set(de.program);const he=(Me,Fe,Re)=>{if(Fe[Me]&&Re[Me])for(const ze in Fe[Me])Re[Me][ze]&&Re[Me][ze].set(Re.program,ze,Fe[Me][ze].current)};U&&U.setUniforms(de.program,W,de.binderUniforms,D,{zoom:N}),he("fixedUniforms",this,de),he("terrainUniforms",this,de),he("globeUniforms",this,de),he("fogUniforms",this,de),he("lightsUniforms",this,de),he("shadowUniforms",this,de),ue.bind(),W.setColorMode(new Jn([te.ONE,te.ONE_MINUS_SRC_ALPHA,te.ZERO,te.ONE],i.aj.transparent,[!0,!0,!0,!1])),W.setDepthMode(new Tn(l.func===te.LESS?te.LEQUAL:l.func,Tn.ReadOnly,l.range)),W.setStencilMode(Dn.disabled);const Te=3*A.primitiveLength*2,Pe=3*A.primitiveOffset*2*2;if(this.forceManualRenderingForInstanceIDShaders){const Me=$||1;for(let Fe=0;Fe<Me;++Fe)de.instancingUniforms.u_instanceID.set(this.program,"u_instanceID",Fe),te.drawElements(te.LINES,Te,te.UNSIGNED_SHORT,Pe)}else $&&$>1?te.drawElementsInstanced(te.LINES,Te,te.UNSIGNED_SHORT,Pe,$):te.drawElements(te.LINES,Te,te.UNSIGNED_SHORT,Pe);w.bind(),W.program.set(this.program),W.setDepthMode(l),W.setStencilMode(m),W.setColorMode(x)}checkUniforms(r,l,m){if(this.fixedDefines.includes(l)){for(const x of Object.keys(m))if(!m[x].initialized)throw new Error(`Program '${this.name}', from draw '${r}': uniform ${x} not set but required by ${l} being defined`)}}draw(r,l,m,x,w,A,D,N,U,$,Z,W,te,ue,se,de){const he=r.context,Te=he.gl;if(this.failedToCreate)return;he.program.set(this.program),he.setDepthMode(m),he.setStencilMode(x),he.setColorMode(w),he.setCullFace(A);for(const Fe of Object.keys(this.fixedUniforms))this.fixedUniforms[Fe].set(this.program,Fe,D[Fe]);ue&&ue.setUniforms(this.program,he,this.binderUniforms,W,{zoom:te});const Pe={[Te.POINTS]:1,[Te.LINES]:2,[Te.TRIANGLES]:3,[Te.LINE_STRIP]:1}[l];this.checkUniforms(N,"RENDER_SHADOWS",this.shadowUniforms);const Me=de&&de>0?1:void 0;for(const Fe of Z.get()){const Re=Fe.vaos||(Fe.vaos={});if((Re[N]||(Re[N]=new Tu)).bind(he,this,U,ue?ue.getPaintVertexBuffers():[],$,Fe.vertexOffset,se||[],Me),this.forceManualRenderingForInstanceIDShaders){const ze=de||1;for(let De=0;De<ze;++De)this.instancingUniforms.u_instanceID.set(this.program,"u_instanceID",De),$?Te.drawElements(l,Fe.primitiveLength*Pe,Te.UNSIGNED_SHORT,Fe.primitiveOffset*Pe*2):Te.drawArrays(l,Fe.vertexOffset,Fe.vertexLength)}else de&&de>1?Te.drawElementsInstanced(l,Fe.primitiveLength*Pe,Te.UNSIGNED_SHORT,Fe.primitiveOffset*Pe*2,de):$?Te.drawElements(l,Fe.primitiveLength*Pe,Te.UNSIGNED_SHORT,Fe.primitiveOffset*Pe*2):Te.drawArrays(l,Fe.vertexOffset,Fe.vertexLength);l===Te.TRIANGLES&&$&&this._drawDebugWireframe(r,m,x,w,$,Fe,W,te,ue,de)}}}function Ep(p,r){const l=Math.pow(2,r.tileID.overscaledZ),m=r.tileSize*Math.pow(2,p.transform.tileZoom)/l,x=m*(r.tileID.canonical.x+r.tileID.wrap*l),w=m*r.tileID.canonical.y;return{u_image:0,u_texsize:r.imageAtlasTexture?r.imageAtlasTexture.size:[0,0],u_tile_units_to_pixels:1/i.ar(r,1,p.transform.tileZoom),u_pixel_coord_upper:[x>>16,w>>16],u_pixel_coord_lower:[65535&x,65535&w]}}const Ih={terrain:0,flat:1},Ri=i.ab.mat4.create(),Rh=(p,r,l,m,x,w,A,D,N,U,$,Z,W,te,ue,se,de,he)=>{const Te=r.style.light,Pe=Te.properties.get("position"),Me=[Pe.x,Pe.y,Pe.z],Fe=i.ab.mat3.create();Te.properties.get("anchor")==="viewport"&&(i.ab.mat3.fromRotation(Fe,-r.transform.angle),i.ab.vec3.transformMat3(Me,Me,Fe));const Re=Te.properties.get("color"),ze=r.transform,De={u_matrix:p,u_lightpos:Me,u_lightintensity:Te.properties.get("intensity"),u_lightcolor:[Re.r,Re.g,Re.b],u_vertical_gradient:+l,u_opacity:m,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Ri,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_height_type:Ih[U],u_base_type:Ih[$],u_ao:x,u_edge_radius:w,u_width_scale:A,u_flood_light_color:ue,u_vertical_scale:se,u_flood_light_intensity:de,u_ground_shadow_factor:he};return ze.projection.name==="globe"&&(De.u_tile_id=[D.canonical.x,D.canonical.y,1<<D.canonical.z],De.u_zoom_transition=Z,De.u_inv_rot_matrix=te,De.u_merc_center=W,De.u_up_dir=ze.projection.upVector(new i.bT(0,0,0),W[0]*i.ag,W[1]*i.ag),De.u_height_lift=N),De},jl=(p,r,l,m,x,w)=>({u_matrix:p,u_edge_radius:r,u_width_scale:l,u_vertical_scale:m,u_height_type:Ih[x],u_base_type:Ih[w]}),Dh=(p,r,l,m,x,w,A,D,N,U,$,Z,W,te,ue,se,de)=>{const he=Rh(p,r,l,m,x,w,A,D,U,$,Z,W,te,ue,se,de,1,[0,0,0]),Te={u_height_factor:-Math.pow(2,D.overscaledZ)/N.tileSize/8};return i.l(he,Ep(r,N),Te)},Iu=(p,r)=>({u_matrix:p,u_emissive_strength:r}),ll=(p,r,l,m)=>i.l(Iu(p,r),Ep(l,m)),Pc=(p,r,l)=>({u_matrix:p,u_world:l,u_emissive_strength:r}),f_=(p,r,l,m,x)=>i.l(ll(p,r,l,m),{u_world:x}),d_=(p,r,l,m)=>{const x=i.ag/l.tileSize;return{u_matrix:p,u_camera_to_center_distance:r.getCameraToCenterDistance(m),u_extrude_scale:[r.pixelsToGLUnits[0]/x,r.pixelsToGLUnits[1]/x]}},Ru=(p,r,l=1)=>({u_matrix:p,u_color:r.toRenderColor(null),u_overlay:0,u_overlay_scale:l}),Jf=i.ab.mat4.create(),hn=(p,r,l,m,x,w,A)=>{const D=p.transform,N=D.projection.name==="globe",U=N?i.cN(D.zoom,r.canonical)*D._pixelsPerMercatorPixel:i.ar(l,1,w),$={u_matrix:r.projMatrix,u_extrude_scale:U,u_intensity:A,u_inv_rot_matrix:Jf,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(N){$.u_inv_rot_matrix=m,$.u_merc_center=x,$.u_tile_id=[r.canonical.x,r.canonical.y,1<<r.canonical.z],$.u_zoom_transition=i.ae(D.zoom);const Z=x[0]*i.ag,W=x[1]*i.ag;$.u_up_dir=D.projection.upVector(new i.bT(0,0,0),Z,W)}return $};function Qf(p,[r,l,m,x],[w,A]){if(w===A)return[0,0,0,0];const D=255*(p-1)/(p*(A-w));return[r*D,l*D,m*D,x*D]}function Lh(p,r,[l,m]){return l===m?0:.5/p+(r-l)*(p-1)/(p*(m-l))}const Ul=(p,r,l,m,x,w,A,D,N,U,$,Z,W,te,ue,se,de,he,Te,Pe,Me)=>({u_matrix:p,u_normalize_matrix:r,u_globe_matrix:l,u_merc_matrix:m,u_grid_matrix:x,u_tl_parent:w,u_scale_parent:U,u_fade_t:$.mix,u_opacity:$.opacity*Z.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:Z.paint.get("raster-brightness-min"),u_brightness_high:Z.paint.get("raster-brightness-max"),u_saturation_factor:i.cO(Z.paint.get("raster-saturation")),u_contrast_factor:i.cP(Z.paint.get("raster-contrast")),u_spin_weights:Mo(Z.paint.get("raster-hue-rotate")),u_perspective_transform:W,u_raster_elevation:te,u_zoom_transition:A,u_merc_center:D,u_cutoff_params:N,u_colorization_mix:Qf(i.cQ,se,he),u_colorization_offset:Lh(i.cQ,de,he),u_color_ramp:ue,u_texture_offset:[Pe/(Te+2*Pe),Te/(Te+2*Pe)],u_texture_res:[Te+2*Pe,Te+2*Pe],u_emissive_strength:Me});function Mo(p){p*=Math.PI/180;const r=Math.sin(p),l=Math.cos(p);return[(2*l+1)/3,(-Math.sqrt(3)*r-l+1)/3,(Math.sqrt(3)*r-l+1)/3]}const Yt=.05,ti=(p,r,l,m,x,w,A,D,N,U,$,Z)=>({u_matrix:p,u_normalize_matrix:r,u_globe_matrix:l,u_merc_matrix:m,u_grid_matrix:x,u_tl_parent:w,u_scale_parent:U,u_fade_t:$.mix,u_opacity:$.opacity,u_image0:0,u_image1:1,u_raster_elevation:Z,u_zoom_transition:A,u_merc_center:D,u_cutoff_params:N}),oa=(p,r,l,m,x,w,A,D,N,U)=>({u_particle_texture:p,u_particle_texture_side_len:r,u_tile_offset:l,u_velocity:m,u_color_ramp:w,u_velocity_res:x,u_max_speed:A,u_uv_offset:D,u_data_scale:[255*N[0],255*N[1]],u_data_offset:U,u_particle_pos_scale:1.1,u_particle_pos_offset:[Yt,Yt]}),Ap=(p,r,l,m,x,w,A,D,N,U)=>({u_particle_texture:p,u_particle_texture_side_len:r,u_velocity:l,u_velocity_res:m,u_max_speed:x,u_speed_factor:w,u_reset_rate:A,u_rand_seed:Math.random(),u_uv_offset:D,u_data_scale:[255*N[0],255*N[1]],u_data_offset:U,u_particle_pos_scale:1.1,u_particle_pos_offset:[Yt,Yt]}),Vl=i.ab.mat4.create(),$l=(p,r,l,m,x,w,A,D,N,U,$,Z,W,te,ue,se,de,he,Te,Pe,Me,Fe)=>{const Re=x.transform,ze={u_is_size_zoom_constant:+(p==="constant"||p==="source"),u_is_size_feature_constant:+(p==="constant"||p==="camera"),u_size_t:r?r.uSizeT:0,u_size:r?r.uSize:0,u_camera_to_center_distance:Re.getCameraToCenterDistance(Te),u_rotate_symbol:+l,u_aspect_ratio:Re.width/Re.height,u_fade_change:x.options.fadeDuration?x.symbolFadeChange:1,u_matrix:w,u_label_plane_matrix:A,u_coord_matrix:D,u_is_text:+U,u_elevation_from_sea:N?1:0,u_pitch_with_map:+m,u_texsize:$,u_texsize_icon:Z,u_texture:0,u_texture_icon:1,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Vl,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:Vl,u_up_vector:[0,-1,0],u_color_adj_mat:Pe,u_icon_transition:Me||0,u_gamma_scale:m?x.transform.getCameraToCenterDistance(Te)*Math.cos(x.terrain?0:x.transform._pitch):1,u_device_pixel_ratio:i.q.devicePixelRatio,u_is_halo:1,u_scale_factor:Fe||1};return Te.name==="globe"&&(ze.u_tile_id=[te.canonical.x,te.canonical.y,1<<te.canonical.z],ze.u_zoom_transition=ue,ze.u_inv_rot_matrix=de,ze.u_merc_center=se,ze.u_camera_forward=Re._camera.forward(),ze.u_ecef_origin=i.cR(Re.globeMatrix,te.toUnwrapped()),ze.u_tile_matrix=Float32Array.from(Re.globeMatrix),ze.u_up_vector=he),ze},kh=(p,r,l,m)=>({u_matrix:p,u_emissive_strength:r,u_opacity:l,u_color:m}),zh=(p,r,l,m,x,w,A,D,N)=>i.l(function(U,$,Z,W,te,ue){const{width:se,height:de}=W.imageManager.getPixelSize($),he=Math.pow(2,ue.tileID.overscaledZ),Te=ue.tileSize*Math.pow(2,W.transform.tileZoom)/he,Pe=Te*(ue.tileID.canonical.x+ue.tileID.wrap*he),Me=Te*ue.tileID.canonical.y;return{u_image:0,u_pattern_tl:Z.tl,u_pattern_br:Z.br,u_texsize:[se,de],u_pattern_size:Z.displaySize,u_pattern_units_to_pixels:te?[W.transform.width,-1*W.transform.height]:[1/i.ar(ue,1,W.transform.tileZoom),1/i.ar(ue,1,W.transform.tileZoom)],u_pixel_coord_upper:[Pe>>16,Me>>16],u_pixel_coord_lower:[65535&Pe,65535&Me]}}(0,w,A,m,D,N),{u_matrix:p,u_emissive_strength:r,u_opacity:l}),Ic=new Float32Array(i.ab.mat4.identity([])),ed=(p,r,l,m,x,w,A,D,N,U,$,Z,W,te=[0,0,0],ue)=>{const se=x.style.light,de=se.properties.get("position"),he=[-de.x,-de.y,de.z],Te=i.ab.mat3.create();se.properties.get("anchor")==="viewport"&&(i.ab.mat3.fromRotation(Te,-x.transform.angle),i.ab.vec3.transformMat3(he,he,Te));const Pe=$.alphaMode==="MASK",Me=se.properties.get("color").toRenderColor(null),Fe=W.paint.get("model-ambient-occlusion-intensity"),Re=W.paint.get("model-color").constantOr(i.aj.white).toRenderColor(null),ze=W.paint.get("model-color-mix-intensity").constantOr(0);return{u_matrix:p,u_lighting_matrix:r,u_normal_matrix:l,u_node_matrix:m||Ic,u_lightpos:he,u_lightintensity:se.properties.get("intensity"),u_lightcolor:[Me.r,Me.g,Me.b],u_camera_pos:te,u_opacity:w,u_baseTextureIsAlpha:0,u_alphaMask:+Pe,u_alphaCutoff:$.alphaCutoff,u_baseColorFactor:[A.r,A.g,A.b,A.a],u_emissiveFactor:[D[0],D[1],D[2],1],u_metallicFactor:N,u_roughnessFactor:U,u_baseColorTexture:aa.BaseColor,u_metallicRoughnessTexture:aa.MetallicRoughness,u_normalTexture:aa.Normal,u_occlusionTexture:aa.Occlusion,u_emissionTexture:aa.Emission,u_lutTexture:aa.LUT,u_color_mix:[Re.r,Re.g,Re.b,ze],u_aoIntensity:Fe,u_emissive_strength:Z,u_occlusionTextureTransform:ue||[0,0,0,0]}},Di=(p,r=Ic,l=Ic)=>({u_matrix:p,u_instance:r,u_node_matrix:l}),td={fillExtrusion:p=>({u_matrix:new i.bJ(p),u_lightpos:new i.bL(p),u_lightintensity:new i.bM(p),u_lightcolor:new i.bL(p),u_vertical_gradient:new i.bM(p),u_opacity:new i.bM(p),u_edge_radius:new i.bM(p),u_width_scale:new i.bM(p),u_ao:new i.bK(p),u_height_type:new i.bN(p),u_base_type:new i.bN(p),u_tile_id:new i.bL(p),u_zoom_transition:new i.bM(p),u_inv_rot_matrix:new i.bJ(p),u_merc_center:new i.bK(p),u_up_dir:new i.bL(p),u_height_lift:new i.bM(p),u_flood_light_color:new i.bL(p),u_vertical_scale:new i.bM(p),u_flood_light_intensity:new i.bM(p),u_ground_shadow_factor:new i.bL(p)}),fillExtrusionDepth:p=>({u_matrix:new i.bJ(p),u_edge_radius:new i.bM(p),u_width_scale:new i.bM(p),u_vertical_scale:new i.bM(p),u_height_type:new i.bN(p),u_base_type:new i.bN(p)}),fillExtrusionPattern:p=>({u_matrix:new i.bJ(p),u_lightpos:new i.bL(p),u_lightintensity:new i.bM(p),u_lightcolor:new i.bL(p),u_vertical_gradient:new i.bM(p),u_height_factor:new i.bM(p),u_edge_radius:new i.bM(p),u_width_scale:new i.bM(p),u_ao:new i.bK(p),u_height_type:new i.bN(p),u_base_type:new i.bN(p),u_tile_id:new i.bL(p),u_zoom_transition:new i.bM(p),u_inv_rot_matrix:new i.bJ(p),u_merc_center:new i.bK(p),u_up_dir:new i.bL(p),u_height_lift:new i.bM(p),u_image:new i.bN(p),u_texsize:new i.bK(p),u_pixel_coord_upper:new i.bK(p),u_pixel_coord_lower:new i.bK(p),u_tile_units_to_pixels:new i.bM(p),u_opacity:new i.bM(p)}),fillExtrusionGroundEffect:p=>({u_matrix:new i.bJ(p),u_opacity:new i.bM(p),u_ao_pass:new i.bM(p),u_meter_to_tile:new i.bM(p),u_ao:new i.bK(p),u_flood_light_intensity:new i.bM(p),u_flood_light_color:new i.bL(p),u_attenuation:new i.bM(p),u_edge_radius:new i.bM(p),u_fb:new i.bN(p),u_fb_size:new i.bM(p),u_dynamic_offset:new i.bM(p)}),fill:p=>({u_matrix:new i.bJ(p),u_emissive_strength:new i.bM(p)}),fillPattern:p=>({u_matrix:new i.bJ(p),u_emissive_strength:new i.bM(p),u_image:new i.bN(p),u_texsize:new i.bK(p),u_pixel_coord_upper:new i.bK(p),u_pixel_coord_lower:new i.bK(p),u_tile_units_to_pixels:new i.bM(p)}),fillOutline:p=>({u_matrix:new i.bJ(p),u_emissive_strength:new i.bM(p),u_world:new i.bK(p)}),fillOutlinePattern:p=>({u_matrix:new i.bJ(p),u_emissive_strength:new i.bM(p),u_world:new i.bK(p),u_image:new i.bN(p),u_texsize:new i.bK(p),u_pixel_coord_upper:new i.bK(p),u_pixel_coord_lower:new i.bK(p),u_tile_units_to_pixels:new i.bM(p)}),circle:i.cS,collisionBox:p=>({u_matrix:new i.bJ(p),u_camera_to_center_distance:new i.bM(p),u_extrude_scale:new i.bK(p)}),collisionCircle:p=>({u_matrix:new i.bJ(p),u_inv_matrix:new i.bJ(p),u_camera_to_center_distance:new i.bM(p),u_viewport_size:new i.bK(p)}),debug:p=>({u_color:new i.cz(p),u_matrix:new i.bJ(p),u_overlay:new i.bN(p),u_overlay_scale:new i.bM(p)}),clippingMask:p=>({u_matrix:new i.bJ(p)}),heatmap:p=>({u_extrude_scale:new i.bM(p),u_intensity:new i.bM(p),u_matrix:new i.bJ(p),u_inv_rot_matrix:new i.bJ(p),u_merc_center:new i.bK(p),u_tile_id:new i.bL(p),u_zoom_transition:new i.bM(p),u_up_dir:new i.bL(p)}),heatmapTexture:p=>({u_image:new i.bN(p),u_color_ramp:new i.bN(p),u_opacity:new i.bM(p)}),hillshade:p=>({u_matrix:new i.bJ(p),u_image:new i.bN(p),u_latrange:new i.bK(p),u_light:new i.bK(p),u_shadow:new i.cz(p),u_highlight:new i.cz(p),u_emissive_strength:new i.bM(p),u_accent:new i.cz(p)}),hillshadePrepare:p=>({u_matrix:new i.bJ(p),u_image:new i.bN(p),u_dimension:new i.bK(p),u_zoom:new i.bM(p)}),line:i.cT,linePattern:i.cU,raster:p=>({u_matrix:new i.bJ(p),u_normalize_matrix:new i.bJ(p),u_globe_matrix:new i.bJ(p),u_merc_matrix:new i.bJ(p),u_grid_matrix:new i.cA(p),u_tl_parent:new i.bK(p),u_scale_parent:new i.bM(p),u_fade_t:new i.bM(p),u_opacity:new i.bM(p),u_image0:new i.bN(p),u_image1:new i.bN(p),u_brightness_low:new i.bM(p),u_brightness_high:new i.bM(p),u_saturation_factor:new i.bM(p),u_contrast_factor:new i.bM(p),u_spin_weights:new i.bL(p),u_perspective_transform:new i.bK(p),u_raster_elevation:new i.bM(p),u_zoom_transition:new i.bM(p),u_merc_center:new i.bK(p),u_cutoff_params:new i.ca(p),u_colorization_mix:new i.ca(p),u_colorization_offset:new i.bM(p),u_color_ramp:new i.bN(p),u_texture_offset:new i.bK(p),u_texture_res:new i.bK(p),u_emissive_strength:new i.bM(p)}),rasterParticle:p=>({u_matrix:new i.bJ(p),u_normalize_matrix:new i.bJ(p),u_globe_matrix:new i.bJ(p),u_merc_matrix:new i.bJ(p),u_grid_matrix:new i.cA(p),u_tl_parent:new i.bK(p),u_scale_parent:new i.bM(p),u_fade_t:new i.bM(p),u_opacity:new i.bM(p),u_image0:new i.bN(p),u_image1:new i.bN(p),u_raster_elevation:new i.bM(p),u_zoom_transition:new i.bM(p),u_merc_center:new i.bK(p),u_cutoff_params:new i.ca(p)}),rasterParticleTexture:p=>({u_texture:new i.bN(p),u_opacity:new i.bM(p)}),rasterParticleDraw:p=>({u_particle_texture:new i.bN(p),u_particle_texture_side_len:new i.bM(p),u_tile_offset:new i.bK(p),u_velocity:new i.bN(p),u_color_ramp:new i.bN(p),u_velocity_res:new i.bK(p),u_max_speed:new i.bM(p),u_uv_offset:new i.bK(p),u_data_scale:new i.bK(p),u_data_offset:new i.bM(p),u_particle_pos_scale:new i.bM(p),u_particle_pos_offset:new i.bK(p)}),rasterParticleUpdate:p=>({u_particle_texture:new i.bN(p),u_particle_texture_side_len:new i.bM(p),u_velocity:new i.bN(p),u_velocity_res:new i.bK(p),u_max_speed:new i.bM(p),u_speed_factor:new i.bM(p),u_reset_rate:new i.bM(p),u_rand_seed:new i.bM(p),u_uv_offset:new i.bK(p),u_data_scale:new i.bK(p),u_data_offset:new i.bM(p),u_particle_pos_scale:new i.bM(p),u_particle_pos_offset:new i.bK(p)}),symbol:p=>({u_is_size_zoom_constant:new i.bN(p),u_is_size_feature_constant:new i.bN(p),u_size_t:new i.bM(p),u_size:new i.bM(p),u_camera_to_center_distance:new i.bM(p),u_rotate_symbol:new i.bN(p),u_aspect_ratio:new i.bM(p),u_fade_change:new i.bM(p),u_matrix:new i.bJ(p),u_label_plane_matrix:new i.bJ(p),u_coord_matrix:new i.bJ(p),u_is_text:new i.bN(p),u_elevation_from_sea:new i.bN(p),u_pitch_with_map:new i.bN(p),u_texsize:new i.bK(p),u_texsize_icon:new i.bK(p),u_texture:new i.bN(p),u_texture_icon:new i.bN(p),u_gamma_scale:new i.bM(p),u_device_pixel_ratio:new i.bM(p),u_tile_id:new i.bL(p),u_zoom_transition:new i.bM(p),u_inv_rot_matrix:new i.bJ(p),u_merc_center:new i.bK(p),u_camera_forward:new i.bL(p),u_tile_matrix:new i.bJ(p),u_up_vector:new i.bL(p),u_ecef_origin:new i.bL(p),u_is_halo:new i.bN(p),u_icon_transition:new i.bM(p),u_color_adj_mat:new i.bJ(p),u_scale_factor:new i.bM(p)}),background:p=>({u_matrix:new i.bJ(p),u_emissive_strength:new i.bM(p),u_opacity:new i.bM(p),u_color:new i.cz(p)}),backgroundPattern:p=>({u_matrix:new i.bJ(p),u_emissive_strength:new i.bM(p),u_opacity:new i.bM(p),u_image:new i.bN(p),u_pattern_tl:new i.bK(p),u_pattern_br:new i.bK(p),u_texsize:new i.bK(p),u_pattern_size:new i.bK(p),u_pixel_coord_upper:new i.bK(p),u_pixel_coord_lower:new i.bK(p),u_pattern_units_to_pixels:new i.bK(p)}),terrainRaster:p=>({u_matrix:new i.bJ(p),u_image0:new i.bN(p),u_skirt_height:new i.bM(p),u_ground_shadow_factor:new i.bL(p)}),skybox:p=>({u_matrix:new i.bJ(p),u_sun_direction:new i.bL(p),u_cubemap:new i.bN(p),u_opacity:new i.bM(p),u_temporal_offset:new i.bM(p)}),skyboxGradient:p=>({u_matrix:new i.bJ(p),u_color_ramp:new i.bN(p),u_center_direction:new i.bL(p),u_radius:new i.bM(p),u_opacity:new i.bM(p),u_temporal_offset:new i.bM(p)}),skyboxCapture:p=>({u_matrix_3f:new i.cA(p),u_sun_direction:new i.bL(p),u_sun_intensity:new i.bM(p),u_color_tint_r:new i.ca(p),u_color_tint_m:new i.ca(p),u_luminance:new i.bM(p)}),globeRaster:p=>({u_proj_matrix:new i.bJ(p),u_globe_matrix:new i.bJ(p),u_normalize_matrix:new i.bJ(p),u_merc_matrix:new i.bJ(p),u_zoom_transition:new i.bM(p),u_merc_center:new i.bK(p),u_image0:new i.bN(p),u_grid_matrix:new i.cA(p),u_skirt_height:new i.bM(p),u_far_z_cutoff:new i.bM(p),u_frustum_tl:new i.bL(p),u_frustum_tr:new i.bL(p),u_frustum_br:new i.bL(p),u_frustum_bl:new i.bL(p),u_globe_pos:new i.bL(p),u_globe_radius:new i.bM(p),u_viewport:new i.bK(p)}),globeAtmosphere:p=>({u_frustum_tl:new i.bL(p),u_frustum_tr:new i.bL(p),u_frustum_br:new i.bL(p),u_frustum_bl:new i.bL(p),u_horizon:new i.bM(p),u_transition:new i.bM(p),u_fadeout_range:new i.bM(p),u_color:new i.ca(p),u_high_color:new i.ca(p),u_space_color:new i.ca(p),u_temporal_offset:new i.bM(p),u_horizon_angle:new i.bM(p)}),model:p=>({u_matrix:new i.bJ(p),u_lighting_matrix:new i.bJ(p),u_normal_matrix:new i.bJ(p),u_node_matrix:new i.bJ(p),u_lightpos:new i.bL(p),u_lightintensity:new i.bM(p),u_lightcolor:new i.bL(p),u_camera_pos:new i.bL(p),u_opacity:new i.bM(p),u_baseColorFactor:new i.ca(p),u_emissiveFactor:new i.ca(p),u_metallicFactor:new i.bM(p),u_roughnessFactor:new i.bM(p),u_baseTextureIsAlpha:new i.bN(p),u_alphaMask:new i.bN(p),u_alphaCutoff:new i.bM(p),u_baseColorTexture:new i.bN(p),u_metallicRoughnessTexture:new i.bN(p),u_normalTexture:new i.bN(p),u_occlusionTexture:new i.bN(p),u_emissionTexture:new i.bN(p),u_lutTexture:new i.bN(p),u_color_mix:new i.ca(p),u_aoIntensity:new i.bM(p),u_emissive_strength:new i.bM(p),u_occlusionTextureTransform:new i.ca(p)}),modelDepth:p=>({u_matrix:new i.bJ(p),u_instance:new i.bJ(p),u_node_matrix:new i.bJ(p)}),groundShadow:p=>({u_matrix:new i.bJ(p),u_ground_shadow_factor:new i.bL(p)}),stars:p=>({u_matrix:new i.bJ(p),u_up:new i.bL(p),u_right:new i.bL(p),u_intensity_multiplier:new i.bM(p)}),snowParticle:p=>({u_modelview:new i.bJ(p),u_projection:new i.bJ(p),u_time:new i.bM(p),u_cam_pos:new i.bL(p),u_velocityConeAperture:new i.bM(p),u_velocity:new i.bM(p),u_horizontalOscillationRadius:new i.bM(p),u_horizontalOscillationRate:new i.bM(p),u_boxSize:new i.bM(p),u_billboardSize:new i.bM(p),u_simpleShapeParameters:new i.bK(p),u_screenSize:new i.bK(p),u_thinningCenterPos:new i.bK(p),u_thinningShape:new i.bL(p),u_thinningAffectedRatio:new i.bM(p),u_thinningParticleOffset:new i.bM(p),u_particleColor:new i.ca(p),u_direction:new i.bL(p)}),rainParticle:p=>({u_modelview:new i.bJ(p),u_projection:new i.bJ(p),u_time:new i.bM(p),u_cam_pos:new i.bL(p),u_texScreen:new i.bN(p),u_velocityConeAperture:new i.bM(p),u_velocity:new i.bM(p),u_boxSize:new i.bM(p),u_rainDropletSize:new i.bK(p),u_distortionStrength:new i.bM(p),u_rainDirection:new i.bL(p),u_color:new i.ca(p),u_screenSize:new i.bK(p),u_thinningCenterPos:new i.bK(p),u_thinningShape:new i.bL(p),u_thinningAffectedRatio:new i.bM(p),u_thinningParticleOffset:new i.bM(p),u_shapeDirectionalPower:new i.bM(p),u_shapeNormalPower:new i.bM(p),u_mode:new i.bM(p)}),vignette:p=>({u_vignetteShape:new i.bL(p),u_vignetteColor:new i.ca(p)}),occlusion:p=>({u_matrix:new i.bJ(p),u_anchorPos:new i.bL(p),u_screenSizePx:new i.bK(p),u_occluderSizePx:new i.bK(p),u_color:new i.ca(p)})};class gs{constructor(r,l,m,x){this.id=gs.uniqueIdxCounter,gs.uniqueIdxCounter++,this.context=r;const w=r.gl;this.buffer=w.createBuffer(),this.dynamicDraw=!!m,this.context.unbindVAO(),r.bindElementBuffer.set(this.buffer),w.bufferData(w.ELEMENT_ARRAY_BUFFER,l.arrayBuffer,this.dynamicDraw?w.DYNAMIC_DRAW:w.STATIC_DRAW),this.dynamicDraw||x||l.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(r){this.id=gs.uniqueIdxCounter,gs.uniqueIdxCounter++;const l=this.context.gl;this.context.unbindVAO(),this.bind(),l.bufferSubData(l.ELEMENT_ARRAY_BUFFER,0,r.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}gs.uniqueIdxCounter=0;const po={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class ql{constructor(r,l,m,x,w,A){this.length=l.length,this.attributes=m,this.itemSize=l.bytesPerElement,this.dynamicDraw=x,this.instanceCount=A,this.context=r;const D=r.gl;this.buffer=D.createBuffer(),r.bindVertexBuffer.set(this.buffer),D.bufferData(D.ARRAY_BUFFER,l.arrayBuffer,this.dynamicDraw?D.DYNAMIC_DRAW:D.STATIC_DRAW),this.dynamicDraw||w||l.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(r){const l=this.context.gl;this.bind(),l.bufferSubData(l.ARRAY_BUFFER,0,r.arrayBuffer)}enableAttributes(r,l){for(let m=0;m<this.attributes.length;m++){const x=l.attributes[this.attributes[m].name];x!==void 0&&r.enableVertexAttribArray(x)}}setVertexAttribPointers(r,l,m){for(let x=0;x<this.attributes.length;x++){const w=this.attributes[x],A=l.attributes[w.name];A!==void 0&&r.vertexAttribPointer(A,w.components,r[po[w.type]],!1,this.itemSize,w.offset+this.itemSize*(m||0))}}setVertexAttribDivisor(r,l,m){for(let x=0;x<this.attributes.length;x++){const w=l.attributes[this.attributes[x].name];w!==void 0&&this.instanceCount&&this.instanceCount>0&&r.vertexAttribDivisor(w,m)}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Um{constructor(r,l,m,x,w){this.context=r,this.width=l,this.height=m;const A=this.framebuffer=r.gl.createFramebuffer();x&&(this.colorAttachment=new Nl(r,A)),w&&(this.depthAttachmentType=w,this.depthAttachment=w==="renderbuffer"?new Ou(r,A):new Yf(r,A))}destroy(){const r=this.context.gl;if(this.colorAttachment){const l=this.colorAttachment.get();l&&r.deleteTexture(l)}if(this.depthAttachment&&this.depthAttachmentType)if(this.depthAttachmentType==="renderbuffer"){const l=this.depthAttachment.get();l&&r.deleteRenderbuffer(l)}else{const l=this.depthAttachment.get();l&&r.deleteTexture(l)}r.deleteFramebuffer(this.framebuffer)}}class nd{constructor(r,l){this.gl=r,this.clearColor=new Eh(this),this.clearDepth=new To(this),this.clearStencil=new Eo(this),this.colorMask=new Bl(this),this.depthMask=new il(this),this.stencilMask=new al(this),this.stencilFunc=new Cu(this),this.stencilOp=new Ah(this),this.stencilTest=new Mu(this),this.depthRange=new _p(this),this.depthTest=new li(this),this.depthFunc=new ba(this),this.blend=new Ur(this),this.blendFunc=new Ao(this),this.blendColor=new ms(this),this.blendEquation=new Wf(this),this.cullFace=new ol(this),this.cullFaceSide=new gp(this),this.frontFace=new yp(this),this.program=new Ac(this),this.activeTexture=new Ch(this),this.viewport=new Mh(this),this.bindFramebuffer=new sl(this),this.bindRenderbuffer=new l_(this),this.bindTexture=new Fm(this),this.bindVertexBuffer=new c_(this),this.bindElementBuffer=new vp(this),this.bindVertexArrayOES=new u_(this),this.pixelStoreUnpack=new Xf(this),this.pixelStoreUnpackPremultiplyAlpha=new xp(this),this.pixelStoreUnpackFlipY=new Cc(this),this.options=l?Object.assign({},l):{},this.options.extTextureFilterAnisotropicForceOff||(this.extTextureFilterAnisotropic=r.getExtension("EXT_texture_filter_anisotropic")||r.getExtension("MOZ_EXT_texture_filter_anisotropic")||r.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=r.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT))),this.extDebugRendererInfo=r.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=r.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=r.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),this.forceManualRenderingForInstanceIDShaders=l&&!!l.forceManualRenderingForInstanceIDShaders||this.renderer&&this.renderer.indexOf("PowerVR")!==-1,this.options.extTextureFloatLinearForceOff||(this.extTextureFloatLinear=r.getExtension("OES_texture_float_linear")),this.extRenderToTextureHalfFloat=r.getExtension("EXT_color_buffer_half_float"),this.extTimerQuery=r.getExtension("EXT_disjoint_timer_query_webgl2"),this.maxTextureSize=r.getParameter(r.MAX_TEXTURE_SIZE),this.maxPointSize=r.getParameter(r.ALIASED_POINT_SIZE_RANGE)[1]}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArrayOES.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(r,l,m){return new gs(this,r,l,m)}createVertexBuffer(r,l,m,x,w){return new ql(this,r,l,m,x,w)}createRenderbuffer(r,l,m){const x=this.gl,w=x.createRenderbuffer();return this.bindRenderbuffer.set(w),x.renderbufferStorage(x.RENDERBUFFER,r,l,m),this.bindRenderbuffer.set(null),w}createFramebuffer(r,l,m,x){return new Um(this,r,l,m,x)}clear({color:r,depth:l,stencil:m,colorMask:x}){const w=this.gl;let A=0;r&&(A|=w.COLOR_BUFFER_BIT,this.clearColor.set(r),this.colorMask.set(x||[!0,!0,!0,!0])),l!==void 0&&(A|=w.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(l),this.depthMask.set(!0)),m!==void 0&&(A|=w.STENCIL_BUFFER_BIT,this.clearStencil.set(m),this.stencilMask.set(255)),w.clear(A)}setCullFace(r){r.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(r.mode),this.frontFace.set(r.frontFace))}setDepthMode(r){r.func!==this.gl.ALWAYS||r.mask?(this.depthTest.set(!0),this.depthFunc.set(r.func),this.depthMask.set(r.mask),this.depthRange.set(r.range)):this.depthTest.set(!1)}setStencilMode(r){r.test.func!==this.gl.ALWAYS||r.mask?(this.stencilTest.set(!0),this.stencilMask.set(r.mask),this.stencilOp.set([r.fail,r.depthFail,r.pass]),this.stencilFunc.set({func:r.test.func,ref:r.ref,mask:r.test.mask})):this.stencilTest.set(!1)}setColorMode(r){i.bn(r.blendFunction,Jn.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(r.blendFunction),this.blendColor.set(r.blendColor),r.blendEquation?this.blendEquation.set(r.blendEquation):this.blendEquation.setDefault()),this.colorMask.set(r.mask)}unbindVAO(){this.bindVertexArrayOES.set(null)}}let Rc;function Bh(p,r,l,m,x,w,A){const D=p.context,N=D.gl,U=p.transform,$=p.getOrCreateProgram("collisionBox"),Z=[];let W=0,te=0;for(let Me=0;Me<m.length;Me++){const Fe=m[Me],Re=r.getTile(Fe),ze=Re.getBucket(l);if(!ze)continue;const De=Ns(Fe,ze,U);let $e=De;x[0]===0&&x[1]===0||($e=p.translatePosMatrix(De,Re,x,w));const Xe=A?ze.textCollisionBox:ze.iconCollisionBox,ht=ze.collisionCircleArray;if(ht.length>0){const ot=i.ab.mat4.create(),Et=$e;i.ab.mat4.mul(ot,ze.placementInvProjMatrix,U.glCoordMatrix),i.ab.mat4.mul(ot,ot,ze.placementViewportMatrix),Z.push({circleArray:ht,circleOffset:te,transform:Et,invTransform:ot,projection:ze.getProjection()}),W+=ht.length/4,te=W}Xe&&(p.terrain&&p.terrain.setupElevationDraw(Re,$),$.draw(p,N.LINES,Tn.disabled,Dn.disabled,p.colorModeForRenderPass(),Rn.disabled,d_($e,U,Re,ze.getProjection()),l.id,Xe.layoutVertexBuffer,Xe.indexBuffer,Xe.segments,null,U.zoom,null,[Xe.collisionVertexBuffer,Xe.collisionVertexBufferExt]))}if(!A||!Z.length)return;const ue=p.getOrCreateProgram("collisionCircle"),se=new i.cV;se.resize(4*W),se._trim();let de=0;for(const Me of Z)for(let Fe=0;Fe<Me.circleArray.length/4;Fe++){const Re=4*Fe,ze=Me.circleArray[Re+0],De=Me.circleArray[Re+1],$e=Me.circleArray[Re+2],Xe=Me.circleArray[Re+3];se.emplace(de++,ze,De,$e,Xe,0),se.emplace(de++,ze,De,$e,Xe,1),se.emplace(de++,ze,De,$e,Xe,2),se.emplace(de++,ze,De,$e,Xe,3)}(!Rc||Rc.length<2*W)&&(Rc=function(Me){const Fe=2*Me,Re=new i.aU;Re.resize(Fe),Re._trim();for(let ze=0;ze<Fe;ze++){const De=6*ze;Re.uint16[De+0]=4*ze+0,Re.uint16[De+1]=4*ze+1,Re.uint16[De+2]=4*ze+2,Re.uint16[De+3]=4*ze+2,Re.uint16[De+4]=4*ze+3,Re.uint16[De+5]=4*ze+0}return Re}(W));const he=D.createIndexBuffer(Rc,!0),Te=D.createVertexBuffer(se,i.cW.members,!0);for(const Me of Z){const Fe={u_matrix:Me.transform,u_inv_matrix:Me.invTransform,u_camera_to_center_distance:(Pe=U).getCameraToCenterDistance(Me.projection),u_viewport_size:[Pe.width,Pe.height]};ue.draw(p,N.TRIANGLES,Tn.disabled,Dn.disabled,p.colorModeForRenderPass(),Rn.disabled,Fe,l.id,Te,he,i.b7.simpleSegment(0,2*Me.circleOffset,Me.circleArray.length,Me.circleArray.length/2),null,U.zoom)}var Pe;Te.destroy(),he.destroy()}const Ba=i.ab.mat4.create();function Yr(p){const r=p._camera.getWorldToCamera(p.worldSize,1),l=i.ab.mat4.multiply([],r,p.globeMatrix);i.ab.mat4.invert(l,l);const m=[0,0,0],x=[0,1,0,0];return i.ab.vec4.transformMat4(x,x,l),m[0]=x[0],m[1]=x[1],m[2]=x[2],i.ab.vec3.normalize(m,m),m}function zr({width:p,height:r,anchor:l,textOffset:m,textScale:x},w){const{horizontalAlign:A,verticalAlign:D}=i.bD(l),N=-(A-.5)*p,U=-(D-.5)*r,$=i.bC(l,m);return new i.P((N/x+$[0])*w,(U/x+$[1])*w)}function Dc(p,r,l,m,x,w,A,D,N,U,$){const Z=p.text.placedSymbolArray,W=p.text.dynamicLayoutVertexArray,te=p.icon.dynamicLayoutVertexArray,ue={},se=p.getProjection(),de=pc(D,se,w),he=w.elevation,Te=se.upVectorScale(D.canonical,w.center.lat,w.worldSize).metersToTile;W.clear();for(let Pe=0;Pe<Z.length;Pe++){const Me=Z.get(Pe),{tileAnchorX:Fe,tileAnchorY:Re,numGlyphs:ze}=Me,De=Me.hidden||!Me.crossTileID||p.allowVerticalPlacement&&!Me.placedOrientation?null:m[Me.crossTileID];if(De){let $e=0,Xe=0,ht=0;if(he){const mt=he?he.getAtTileOffset(D,Fe,Re):0,[Gt,It,At]=se.upVector(D.canonical,Fe,Re);$e=mt*Gt*Te,Xe=mt*It*Te,ht=mt*At*Te}let[ot,Et,yt,nt]=ga(Me.projectedAnchorX+$e,Me.projectedAnchorY+Xe,Me.projectedAnchorZ+ht,l?de:A);const pt=sp(w.getCameraToCenterDistance(se),nt);let Lt=x.evaluateSizeForFeature(p.textSizeData,U,Me)*pt/i.bw;l&&(Lt*=p.tilePixelRatio/N);const tt=zr(De,Lt);l?({x:ot,y:Et,z:yt}=se.projectTilePoint(Fe+tt.x,Re+tt.y,D.canonical),[ot,Et,yt]=ga(ot+$e,Et+Xe,yt+ht,A)):(r&&tt._rotate(-w.angle),ot+=tt.x,Et+=tt.y,yt=0);const St=p.allowVerticalPlacement&&Me.placedOrientation===i.bq.vertical?Math.PI/2:0;for(let mt=0;mt<ze;mt++)i.bt(W,ot,Et,yt,St);$&&Me.associatedIconIndex>=0&&(ue[Me.associatedIconIndex]={x:ot,y:Et,z:yt,angle:St})}else ai(ze,W)}if($){te.clear();const Pe=p.icon.placedSymbolArray;for(let Me=0;Me<Pe.length;Me++){const Fe=Pe.get(Me),{numGlyphs:Re}=Fe,ze=ue[Me];if(Fe.hidden||!ze)ai(Re,te);else{const{x:De,y:$e,z:Xe,angle:ht}=ze;for(let ot=0;ot<Re;ot++)i.bt(te,De,$e,Xe,ht)}}p.icon.dynamicLayoutVertexBuffer.updateData(te)}p.text.dynamicLayoutVertexBuffer.updateData(W)}function Lc(p,r,l,m,x,w,A={}){const D=l.paint.get("icon-translate"),N=l.paint.get("text-translate"),U=l.paint.get("icon-translate-anchor"),$=l.paint.get("text-translate-anchor"),Z=l.layout.get("icon-rotation-alignment"),W=l.layout.get("text-rotation-alignment"),te=l.layout.get("icon-pitch-alignment"),ue=l.layout.get("text-pitch-alignment"),se=l.layout.get("icon-keep-upright"),de=l.layout.get("text-keep-upright"),he=l.paint.get("icon-color-saturation"),Te=l.paint.get("icon-color-contrast"),Pe=l.paint.get("icon-color-brightness-min"),Me=l.paint.get("icon-color-brightness-max"),Fe=l.layout.get("symbol-elevation-reference")==="sea",Re=p.context,ze=Re.gl,De=p.transform,$e=Z==="map",Xe=W==="map",ht=te==="map",ot=ue==="map",Et=l.layout.get("symbol-sort-key").constantOr(1)!==void 0;let yt=!1;const nt=p.depthModeForSublayer(0,Tn.ReadOnly),pt=[i.at(De.center.lng),i.aA(De.center.lat)],Lt=l.layout.get("text-variable-anchor"),tt=De.projection.name==="globe",St=[],mt=[0,-1,0];for(const Gt of m){const It=r.getTile(Gt),At=It.getBucket(l);if(!At||At.projection.name==="mercator"&&tt||At.fullyClipped)continue;const zt=At.projection.name==="globe",Wt=zt?i.ae(De.zoom):0,on=pc(Gt,At.getProjection(),De),dn=De.calculatePixelsToTileUnitsMatrix(It),En=Lt&&At.hasTextData(),Sn=At.hasIconTextFit()&&En&&At.hasIconData(),bn=At.getProjection().createInversionMatrix(De,Gt.canonical),Ln=An=>{De.depthOcclusionForSymbolsAndCircles&&(l.hasInitialOcclusionOpacityProperties||p.terrain)&&(An.push("DEPTH_D24"),An.push("DEPTH_OCCLUSION"))},kn=()=>{const An=$e&&l.layout.get("symbol-placement")!=="point",In=[];Ln(In);const or=An||Sn,Gr=l.paint.get("icon-image-cross-fade").constantOr(0);p.terrainRenderModeElevated()&&ht&&In.push("PITCH_WITH_MAP_TERRAIN"),zt&&(In.push("PROJECTION_GLOBE_VIEW"),or&&In.push("PROJECTED_POS_ON_VIEWPORT")),Gr>0&&In.push("ICON_TRANSITION"),At.icon.zOffsetVertexBuffer&&In.push("Z_OFFSET"),he===0&&Te===0&&Pe===0&&Me===1||In.push("COLOR_ADJUSTMENT"),At.sdfIcons&&In.push("RENDER_SDF");const Kr=At.icon.programConfigurations.get(l.id),hi=p.getOrCreateProgram("symbol",{config:Kr,defines:In}),yo=It.imageAtlasTexture?It.imageAtlasTexture.size:[0,0],Ci=At.iconSizeData,hr=i.bp(Ci,De.zoom),Er=ht||De.pitch!==0,Tr=Wr(on,It.tileID.canonical,ht,$e,De,At.getProjection(),dn),cr=gh(on,It.tileID.canonical,ht,$e,De,At.getProjection(),dn),Nr=p.translatePosMatrix(cr,It,D,U,!0),xi=p.translatePosMatrix(on,It,D,U),Or=or?Ba:Tr,bi=$e&&!ht&&!An;let Io=mt;!tt&&!De.mercatorFromTransition||$e||(Io=Yr(De));const ro=zt?Io:mt,ja=l.getColorAdjustmentMatrix(he,Te,Pe,Me),Ko=$l(Ci.kind,hr,bi,ht,p,xi,Or,Nr,Fe,!1,yo,[0,0],!0,Gt,Wt,pt,bn,ro,At.getProjection(),ja,Gr),Ea=It.imageAtlasTexture?It.imageAtlasTexture:null,io=l.layout.get("icon-size").constantOr(0)!==1||At.iconsNeedLinear,Jo=At.sdfIcons||p.options.rotating||p.options.zooming||io||Er?ze.LINEAR:ze.NEAREST,Ro=At.sdfIcons&&l.paint.get("icon-halo-width").constantOr(1)!==0,Yl=p.terrain&&ht&&An?i.ab.mat4.invert(i.ab.mat4.create(),Tr):Ba;if(An&&At.icon){const Hc=De.elevation,Zc=Hc?Hc.getAtTileOffsetFunc(Gt,De.center.lat,De.worldSize,At.getProjection()):null,yd=Xr(on,It.tileID.canonical,ht,$e,De,At.getProjection(),dn);yh(At,on,p,!1,yd,cr,ht,se,Zc,Gt)}return{program:hi,buffers:At.icon,uniformValues:Ko,atlasTexture:Ea,atlasTextureIcon:null,atlasInterpolation:Jo,atlasInterpolationIcon:null,isSDF:At.sdfIcons,hasHalo:Ro,tile:It,labelPlaneMatrixInv:Yl}},Mr=()=>{const An=Xe&&l.layout.get("symbol-placement")!=="point",In=[],or=An||Lt||Sn;p.terrainRenderModeElevated()&&ot&&In.push("PITCH_WITH_MAP_TERRAIN"),zt&&(In.push("PROJECTION_GLOBE_VIEW"),or&&In.push("PROJECTED_POS_ON_VIEWPORT")),At.text.zOffsetVertexBuffer&&In.push("Z_OFFSET"),At.iconsInText&&In.push("RENDER_TEXT_AND_SYMBOL"),In.push("RENDER_SDF"),Ln(In);const Gr=At.text.programConfigurations.get(l.id),Kr=p.getOrCreateProgram("symbol",{config:Gr,defines:In});let hi,yo=[0,0],Ci=null;const hr=At.textSizeData;At.iconsInText&&(yo=It.imageAtlasTexture?It.imageAtlasTexture.size:[0,0],Ci=It.imageAtlasTexture?It.imageAtlasTexture:null,hi=ot||De.pitch!==0||p.options.rotating||p.options.zooming||hr.kind==="composite"||hr.kind==="camera"?ze.LINEAR:ze.NEAREST);const Er=It.glyphAtlasTexture?It.glyphAtlasTexture.size:[0,0],Tr=l.layout.get("text-size-scale-range"),cr=i.aw(p.scaleFactor,Tr[0],Tr[1]),Nr=i.bp(hr,De.zoom,cr),xi=Wr(on,It.tileID.canonical,ot,Xe,De,At.getProjection(),dn),Or=gh(on,It.tileID.canonical,ot,Xe,De,At.getProjection(),dn),bi=p.translatePosMatrix(Or,It,N,$,!0),Io=p.translatePosMatrix(on,It,N,$),ro=or?Ba:xi,ja=Xe&&!ot&&!An;let Ko=mt;!tt&&!De.mercatorFromTransition||Xe||(Ko=Yr(De));const Ea=$l(hr.kind,Nr,ja,ot,p,Io,ro,bi,Fe,!0,Er,yo,!0,Gt,Wt,pt,bn,zt?Ko:mt,At.getProjection(),null,null,cr),io=It.glyphAtlasTexture?It.glyphAtlasTexture:null,Jo=ze.LINEAR,Ro=l.paint.get("text-halo-width").constantOr(1)!==0,Yl=p.terrain&&ot&&An?i.ab.mat4.invert(i.ab.mat4.create(),xi):Ba;if(An&&At.text){const Hc=De.elevation,Zc=Hc?Hc.getAtTileOffsetFunc(Gt,De.center.lat,De.worldSize,At.getProjection()):null,yd=Xr(on,It.tileID.canonical,ot,Xe,De,At.getProjection(),dn);yh(At,on,p,!0,yd,Or,ot,de,Zc,Gt)}return{program:Kr,buffers:At.text,uniformValues:Ea,atlasTexture:io,atlasTextureIcon:Ci,atlasInterpolation:Jo,atlasInterpolationIcon:hi,isSDF:!0,hasHalo:Ro,tile:It,labelPlaneMatrixInv:Yl}},ui=At.icon.segments.get().length,qr=At.text.segments.get().length,Fn=ui&&!A.onlyText?kn():null,mr=qr&&!A.onlyIcons?Mr():null,sn=l.paint.get("icon-opacity").constantOr(1),Pn=l.paint.get("text-opacity").constantOr(1);if(Et&&At.canOverlap){yt=!0;const An=sn&&!A.onlyText?At.icon.segments.get():[],In=Pn&&!A.onlyIcons?At.text.segments.get():[];for(const or of An)St.push({segments:new i.b7([or]),sortKey:or.sortKey,state:Fn});for(const or of In)St.push({segments:new i.b7([or]),sortKey:or.sortKey,state:mr})}else A.onlyText||St.push({segments:sn?At.icon.segments:new i.b7([]),sortKey:0,state:Fn}),A.onlyIcons||St.push({segments:Pn?At.text.segments:new i.b7([]),sortKey:0,state:mr})}yt&&St.sort((Gt,It)=>Gt.sortKey-It.sortKey);for(const Gt of St){const It=Gt.state;if(It)if(p.terrain?p.terrain.setupElevationDraw(It.tile,It.program,{useDepthForOcclusion:De.depthOcclusionForSymbolsAndCircles,labelPlaneMatrixInv:It.labelPlaneMatrixInv}):p.setupDepthForOcclusion(De.depthOcclusionForSymbolsAndCircles,It.program),Re.activeTexture.set(ze.TEXTURE0),It.atlasTexture&&It.atlasTexture.bind(It.atlasInterpolation,ze.CLAMP_TO_EDGE,!0),It.atlasTextureIcon&&(Re.activeTexture.set(ze.TEXTURE1),It.atlasTextureIcon&&It.atlasTextureIcon.bind(It.atlasInterpolationIcon,ze.CLAMP_TO_EDGE,!0)),p.uploadCommonLightUniforms(p.context,It.program),It.hasHalo){const At=It.uniformValues;At.u_is_halo=1,Nh(It.buffers,Gt.segments,l,p,It.program,nt,x,w,At,2),At.u_is_halo=0}else{if(It.isSDF){const At=It.uniformValues;It.hasHalo&&(At.u_is_halo=1,Nh(It.buffers,Gt.segments,l,p,It.program,nt,x,w,At,1)),At.u_is_halo=0}Nh(It.buffers,Gt.segments,l,p,It.program,nt,x,w,It.uniformValues,1)}}}function Nh(p,r,l,m,x,w,A,D,N,U){const $=[p.dynamicLayoutVertexBuffer,p.opacityVertexBuffer,p.iconTransitioningVertexBuffer,p.globeExtVertexBuffer,p.zOffsetVertexBuffer];x.draw(m,m.context.gl.TRIANGLES,w,A,D,Rn.disabled,N,l.id,p.layoutVertexBuffer,p.indexBuffer,r,l.paint,m.transform.zoom,p.programConfigurations.get(l.id),$,U)}function Vs(p,r,l,m,x,w,A){const D=p.context.gl,N=l.paint.get("fill-pattern"),U=l.is3D(),$=U?p.stencilModeFor3D():Dn.disabled,Z=N&&N.constantOr(1);let W,te,ue,se,de;A?(te=Z&&!l.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",W=D.LINES):(te=Z?"fillPattern":"fill",W=D.TRIANGLES);for(const he of m){const Te=r.getTile(he);if(Z&&!Te.patternsLoaded())continue;const Pe=Te.getBucket(l);if(!Pe)continue;p.prepareDrawTile();const Me=Pe.programConfigurations.get(l.id),Fe=p.isTileAffectedByFog(he),Re=p.getOrCreateProgram(te,{config:Me,overrideFog:Fe});Z&&(p.context.activeTexture.set(D.TEXTURE0),Te.imageAtlasTexture&&Te.imageAtlasTexture.bind(D.LINEAR,D.CLAMP_TO_EDGE),Me.updatePaintBuffers());const ze=N.constantOr(null);if(ze&&Te.imageAtlas){const Xe=Te.imageAtlas,ht=i.A.from(ze).getPrimary().scaleSelf(i.q.devicePixelRatio).serialize(),ot=Xe.patternPositions[ht];ot&&Me.setConstantPatternPositions(ot)}const De=p.translatePosMatrix(he.projMatrix,Te,l.paint.get("fill-translate"),l.paint.get("fill-translate-anchor")),$e=l.paint.get("fill-emissive-strength");if(A){se=Pe.indexBuffer2,de=Pe.segments2;const Xe=p.terrain&&p.terrain.renderingToTexture?p.terrain.drapeBufferSize:[D.drawingBufferWidth,D.drawingBufferHeight];ue=te==="fillOutlinePattern"&&Z?f_(De,$e,p,Te,Xe):Pc(De,$e,Xe)}else se=Pe.indexBuffer,de=Pe.segments,ue=Z?ll(De,$e,p,Te):Iu(De,$e);p.uploadCommonUniforms(p.context,Re,he.toUnwrapped()),Re.draw(p,W,x,U?$:p.stencilModeForClipping(he),w,Rn.disabled,ue,l.id,Pe.layoutVertexBuffer,se,de,l.paint,p.transform.zoom,Me,void 0)}}function kc(p,r,l,m,x,w,A,D){l.resetLayerRenderingStats(p);const N=p.context,U=N.gl,$=p.transform,Z=l.paint.get("fill-extrusion-pattern"),W=Z.constantOr(1),te=l.paint.get("fill-extrusion-opacity"),ue=p.style.enable3dLights(),se=l.paint.get(ue&&!W?"fill-extrusion-ambient-occlusion-wall-radius":"fill-extrusion-ambient-occlusion-radius"),de=[l.paint.get("fill-extrusion-ambient-occlusion-intensity"),se],he=l.layout.get("fill-extrusion-edge-radius"),Te=he>0&&!l.paint.get("fill-extrusion-rounded-roof"),Pe=Te?0:he,Me=$.projection.name==="globe"?i.d3():0,Fe=$.projection.name==="globe",Re=Fe?i.ae($.zoom):0,ze=[i.at($.center.lng),i.aA($.center.lat)],De=l.paint.get("fill-extrusion-flood-light-color-use-theme").constantOr("default")==="none",$e=l.paint.get("fill-extrusion-flood-light-color").toRenderColor(De?null:l.lut).toArray01().slice(0,3),Xe=l.paint.get("fill-extrusion-flood-light-intensity"),ht=l.paint.get("fill-extrusion-vertical-scale"),ot=l.paint.get("fill-extrusion-line-width").constantOr(1)!==0,Et=l.paint.get("fill-extrusion-height-alignment"),yt=l.paint.get("fill-extrusion-base-alignment"),nt=_c(p,l.paint.get("fill-extrusion-cutoff-fade-range")),pt=[];let Lt;Fe&&pt.push("PROJECTION_GLOBE_VIEW"),de[0]>0&&pt.push("FAUX_AO"),Te&&pt.push("ZERO_ROOF_RADIUS"),D&&pt.push("HAS_CENTROID"),Xe>0&&pt.push("FLOOD_LIGHT"),nt.shouldRenderCutoff&&pt.push("RENDER_CUTOFF"),ot&&pt.push("RENDER_WALL_MODE");const tt=p.renderPass==="shadow",St=p.shadowRenderer,mt=tt&&!!St;p.shadowRenderer&&(p.shadowRenderer.useNormalOffset=!0);let Gt=[0,0,0];if(St){const zt=p.style.directionalLight,Wt=p.style.ambientLight;zt&&Wt&&(Gt=dp(p.style,zt,Wt)),tt||(pt.push("RENDER_SHADOWS","DEPTH_TEXTURE"),St.useNormalOffset&&pt.push("NORMAL_OFFSET")),Lt=pt.concat(["SHADOWS_SINGLE_CASCADE"])}const It=mt?"fillExtrusionDepth":W?"fillExtrusionPattern":"fillExtrusion",At=l.getLayerRenderingStats();for(const zt of m){const Wt=r.getTile(zt),on=Wt.getBucket(l);if(!on||on.projection.name!==$.projection.name)continue;let dn=!1;St&&(dn=St.getMaxCascadeForTile(zt.toUnwrapped())===0);const En=p.isTileAffectedByFog(zt),Sn=on.programConfigurations.get(l.id),bn=p.getOrCreateProgram(It,{config:Sn,defines:dn?Lt:pt,overrideFog:En});if(p.terrain&&p.terrain.setupElevationDraw(Wt,bn,{useMeterToDem:!0}),!on.centroidVertexBuffer){const mr=bn.attributes.a_centroid_pos;mr!==void 0&&U.vertexAttrib2f(mr,0,0)}!tt&&St&&St.setupShadows(Wt.tileID.toUnwrapped(),bn,"vector-tile",Wt.tileID.overscaledZ),W&&(p.context.activeTexture.set(U.TEXTURE0),Wt.imageAtlasTexture&&Wt.imageAtlasTexture.bind(U.LINEAR,U.CLAMP_TO_EDGE),Sn.updatePaintBuffers());const Ln=Z.constantOr(null);if(Ln&&Wt.imageAtlas){const mr=Wt.imageAtlas,sn=i.A.from(Ln).getPrimary().scaleSelf(i.q.devicePixelRatio),Pn=mr.patternPositions[sn.serialize()];Pn&&Sn.setConstantPatternPositions(Pn)}const kn=l.paint.get("fill-extrusion-vertical-gradient"),Mr=1/on.tileToMeter;let ui;if(tt&&St){if(Lu(Wt.tileID,on,p))continue;const mr=St.calculateShadowPassMatrixFromTile(Wt.tileID.toUnwrapped());ui=jl(mr,Pe,Mr,ht,Et,yt)}else{const mr=p.translatePosMatrix(zt.expandedProjMatrix,Wt,l.paint.get("fill-extrusion-translate"),l.paint.get("fill-extrusion-translate-anchor")),sn=$.projection.createInversionMatrix($,zt.canonical);ui=W?Dh(mr,p,kn,te,de,Pe,Mr,zt,Wt,Me,Et,yt,Re,ze,sn,$e,ht):Rh(mr,p,kn,te,de,Pe,Mr,zt,Me,Et,yt,Re,ze,sn,$e,ht,Xe,Gt)}p.uploadCommonUniforms(N,bn,zt.toUnwrapped(),null,nt);let qr=on.segments;if($.projection.name==="mercator"&&!tt&&(qr=on.getVisibleSegments(Wt.tileID,p.terrain,p.transform.getFrustum(0)),!qr.get().length))continue;if(At)if(tt)for(const mr of qr.get())At.numRenderedVerticesInShadowPass+=mr.primitiveLength;else for(const mr of qr.get())At.numRenderedVerticesInTransparentPass+=mr.primitiveLength;const Fn=[];(p.terrain||D)&&Fn.push(on.centroidVertexBuffer),Fe&&Fn.push(on.layoutVertexExtBuffer),ot&&Fn.push(on.wallVertexBuffer),bn.draw(p,N.gl.TRIANGLES,x,w,A,Rn.backCCW,ui,l.id,on.layoutVertexBuffer,on.indexBuffer,qr,l.paint,p.transform.zoom,Sn,Fn)}p.shadowRenderer&&(p.shadowRenderer.useNormalOffset=!1)}function zc(p,r,l,m,x,w,A,D,N,U,$,Z,W,te,ue,se,de,he,Te){const Pe=p.context,Me=Pe.gl,Fe=p.transform,Re=p.transform.zoom,ze=[],De=_c(p,l.paint.get("fill-extrusion-cutoff-fade-range"));U==="clear"?(ze.push("CLEAR_SUBPASS"),Te&&(ze.push("CLEAR_FROM_TEXTURE"),Pe.activeTexture.set(Me.TEXTURE0),Te.bind(Me.LINEAR,Me.CLAMP_TO_EDGE))):U==="sdf"&&ze.push("SDF_SUBPASS"),de&&ze.push("HAS_CENTROID"),De.shouldRenderCutoff&&ze.push("RENDER_CUTOFF");const $e=l.layout.get("fill-extrusion-edge-radius"),Xe=(ht,ot,Et,yt,nt)=>{const pt=ot.programConfigurations.get(l.id),Lt=p.isTileAffectedByFog(ht),tt=p.getOrCreateProgram("fillExtrusionGroundEffect",{config:pt,defines:ze,overrideFog:Lt}),St=((Gt,It,At,zt,Wt,on,dn,En,Sn,bn,Ln)=>({u_matrix:It,u_opacity:At,u_ao_pass:zt?1:0,u_meter_to_tile:Wt,u_ao:on,u_flood_light_intensity:dn,u_flood_light_color:En,u_attenuation:Sn,u_edge_radius:bn,u_fb:0,u_fb_size:Ln,u_dynamic_offset:1}))(0,yt,$,N,nt,[Z,W*nt],te,ue,se,Re>=17?0:$e*nt,Te?Te.size[0]:0),mt=[];de&&mt.push(ot.hiddenByLandmarkVertexBuffer),p.uploadCommonUniforms(Pe,tt,ht.toUnwrapped(),null,De),tt.draw(p,Pe.gl.TRIANGLES,x,w,A,D,St,l.id,ot.vertexBuffer,ot.indexBuffer,Et,l.paint,Re,pt,mt)};for(const ht of m){const ot=r.getTile(ht),Et=ot.getBucket(l);if(!Et||Et.projection.name!==Fe.projection.name||!Et.groundEffect||Et.groundEffect&&!Et.groundEffect.hasData())continue;const yt=Et.groundEffect,nt=1/Et.tileToMeter;{const pt=p.translatePosMatrix(ht.projMatrix,ot,l.paint.get("fill-extrusion-translate"),l.paint.get("fill-extrusion-translate-anchor")),Lt=yt.getDefaultSegment();Xe(ht,yt,Lt,pt,nt)}if(he)for(let pt=0;pt<4;pt++){const Lt=i.d4[pt](ht),tt=r.getTile(Lt);if(!tt)continue;const St=tt.getBucket(l);if(!St||St.projection.name!==Fe.projection.name||!St.groundEffect||St.groundEffect&&!St.groundEffect.hasData())continue;const mt=St.groundEffect;let Gt,It;pt===0?(Gt=[-i.ag,0,0],It=1):pt===1?(Gt=[i.ag,0,0],It=0):pt===2?(Gt=[0,-i.ag,0],It=3):(Gt=[0,i.ag,0],It=2);const At=mt.regionSegments[It];if(!At)continue;const zt=new Float32Array(16);i.ab.mat4.translate(zt,ht.projMatrix,Gt),Xe(ht,mt,At,p.translatePosMatrix(zt,ot,l.paint.get("fill-extrusion-translate"),l.paint.get("fill-extrusion-translate-anchor")),nt)}}}function Bc(p,r,l,m,x,w,A){m.centroidVertexArray.length===0&&m.createCentroidsBuffer();const D=w?w.findDEMTileFor(l):null;if(!(D&&D.dem||A))return;w&&D&&D.dem&&m.selfDEMTileTimestamp!==D.dem._timestamp&&(m.borderDoneWithNeighborZ=[-1,-1,-1,-1],m.selfDEMTileTimestamp=D.dem._timestamp);const N=he=>new i.P(Math.ceil((he+i.d7)*i.d8),0),U=he=>{const Te=r.getSource().minzoom,Pe=Fe=>{const Re=r.getTileByID(Fe);if(Re&&Re.hasData())return Re.getBucket(x)},Me=[0,-1,1];for(const Fe of Me){if(he.overscaledZ+Fe<Te)continue;const Re=Pe(he.calculateScaledKey(he.overscaledZ+Fe));if(Re)return Re}},$=[0,0,0],Z=(he,Te)=>($[0]=Math.min(he.min.y,Te.min.y),$[1]=Math.max(he.max.y,Te.max.y),$[2]=i.ag-Te.min.x>he.max.x?Te.min.x-i.ag:he.max.x,$),W=(he,Te)=>($[0]=Math.min(he.min.x,Te.min.x),$[1]=Math.max(he.max.x,Te.max.x),$[2]=i.ag-Te.min.y>he.max.y?Te.min.y-i.ag:he.max.y,$),te=[(he,Te)=>Z(he,Te),(he,Te)=>Z(Te,he),(he,Te)=>W(he,Te),(he,Te)=>W(Te,he)],ue=(he,Te,Pe,Me,Fe,Re,ze)=>{if(!w)return 0;const De=[[Re?Pe:he,Re?he:Pe,0],[Re?Pe:Te,Re?Te:Pe,0]],$e=ze<0?i.ag+ze:ze,Xe=[Re?$e:(he+Te)/2,Re?(he+Te)/2:$e,0];return Pe===0&&ze<0||Pe!==0&&ze>0?w.getForTilePoints(Fe,[Xe],!0,Me):De.push(Xe),w.getForTilePoints(l,De,!0,D),Math.max(De[0][2],De[1][2],Xe[2])/w.exaggeration()};for(let he=0;he<4;he++){const Te=m.borderFeatureIndices[he];if(Te.length===0)continue;const Pe=i.d4[he](l),Me=U(Pe);if(!(Me&&Me instanceof i.d5))continue;const Fe=w?w.findDEMTileFor(Pe):null;if(!(Fe&&Fe.dem||A)||(w&&Fe&&Fe.dem&&m.borderDEMTileTimestamp[he]!==Fe.dem._timestamp&&(m.borderDoneWithNeighborZ[he]=-1,m.borderDEMTileTimestamp[he]=Fe.dem._timestamp),m.borderDoneWithNeighborZ[he]===Me.canonical.z))continue;Me.centroidVertexArray.length===0&&Me.createCentroidsBuffer();const Re=(he<2?1:5)-he,ze=Me.borderDoneWithNeighborZ[Re]!==m.canonical.z,De=Me.borderFeatureIndices[Re];let $e=0;if(m.canonical.z!==Me.canonical.z){for(const Xe of Te)m.showCentroid(m.featuresOnBorder[Xe]);if(ze)for(const Xe of De)Me.showCentroid(Me.featuresOnBorder[Xe]);m.borderDoneWithNeighborZ[he]=Me.canonical.z,Me.borderDoneWithNeighborZ[Re]=m.canonical.z}for(const Xe of Te){const ht=m.featuresOnBorder[Xe],ot=m.centroidData[ht.centroidDataIndex],Et=ht.borders[he];let yt;for(;$e<De.length;){yt=Me.featuresOnBorder[De[$e]];const nt=yt.borders[Re];if(nt[1]>Et[0]+3||nt[0]>Et[0]-3)break;Me.showCentroid(yt),$e++}if(yt&&$e<De.length){const nt=$e;let pt=0;for(;!(yt.borders[Re][0]>Et[1]-3)&&(pt++,++$e!==De.length);)yt=Me.featuresOnBorder[De[$e]];yt=Me.featuresOnBorder[De[nt]];let Lt=!1;if(pt>=1){const mt=yt.borders[Re];Math.abs(Et[0]-mt[0])<3&&Math.abs(Et[1]-mt[1])<3&&(pt=1,Lt=!0,$e=nt+1)}else if(pt===0){m.showCentroid(ht);continue}const tt=Me.centroidData[yt.centroidDataIndex];A&&Lt&&(((se=ot).flags|(de=tt).flags)&i.d6?(se.flags|=i.d6,de.flags|=i.d6):(se.flags&=~i.d6,de.flags&=~i.d6));const St=ht.intersectsCount()>1||yt.intersectsCount()>1;if(pt>1)$e=nt,ot.centroidXY=tt.centroidXY=new i.P(0,0);else if(Fe&&Fe.dem&&!St){const mt=te[he](ot,tt),Gt=he%2?i.ag-1:0,It=ue(mt[0],Math.min(i.ag-1,mt[1]),Gt,Fe,Pe,he<2,mt[2]);ot.centroidXY=tt.centroidXY=N(It)}else St?ot.centroidXY=tt.centroidXY=new i.P(0,0):(ot.centroidXY=m.encodeBorderCentroid(ht),tt.centroidXY=Me.encodeBorderCentroid(yt));m.writeCentroidToBuffer(ot),Me.writeCentroidToBuffer(tt)}else m.showCentroid(ht)}m.borderDoneWithNeighborZ[he]=Me.canonical.z,Me.borderDoneWithNeighborZ[Re]=m.canonical.z}var se,de;(m.needsCentroidUpdate||!m.centroidVertexBuffer&&m.centroidVertexArray.length!==0)&&m.uploadCentroid(p)}const Du=[1,0,0],qt=[0,1,0],cn=[0,0,1];function Lu(p,r,l){const m=l.transform,x=l.shadowRenderer;if(!x)return!0;const w=p.toUnwrapped(),A=m.tileSize*x._cascades[l.currentShadowCascade].scale;let D=r.maxHeight;if(m.elevation){const se=m.elevation.getMinMaxForTile(p);se&&(D+=se.max)}const N=[...x.shadowDirection];N[2]=-N[2];const U=x.computeSimplifiedTileShadowVolume(w,D,A,N);if(!U)return!1;const $=[Du,qt,cn,N,[N[0],0,N[2]],[0,N[1],N[2]]],Z=m.projection.name==="globe",W=m.scaleZoom(A),te=i.bR.fromInvProjectionMatrix(m.invProjMatrix,m.worldSize,W,!Z),ue=x.getCurrentCascadeFrustum();return te.intersectsPrecise(U.vertices,U.planes,$)===0||ue.intersectsPrecise(U.vertices,U.planes,$)===0}function ni(p){return[p[0]*i.d9,p[1]*i.d9,p[2]*i.d9,0]}function st(p,r,l,m,x,w,A,D,N){const U=m.getSource(),$=l.globeSharedBuffers;if(!$)return;let Z,W,te;if(r&&(Z=m.getTile(r)),U instanceof i.aJ?(W=U.texture,te=i.cI(0,0,l.transform)):Z&&r&&(W=Z.texture,te=i.cI(r.canonical.z,r.canonical.x,l.transform)),!W||!te)return;p||(te=i.ab.mat4.scale(i.ab.mat4.create(),te,[1,-1,1]));const ue=l.context,se=ue.gl,de=x.paint.get("raster-resampling")==="nearest"?se.NEAREST:se.LINEAR,he=l.colorModeForDrapableLayerRenderPass(w),Te=A.defines;Te.push("GLOBE_POLES");const Pe=new Tn(se.LEQUAL,Tn.ReadWrite,l.depthRangeFor3D),Me=Float32Array.from(l.transform.expandedFarZProjMatrix),Fe=Float32Array.from(i.bb(i.cH(new i.bT(0,0,0))));l.terrain&&l.terrain.prepareDrawTile(),ue.activeTexture.set(se.TEXTURE0),W.bind(de,se.CLAMP_TO_EDGE),ue.activeTexture.set(se.TEXTURE1),W.bind(de,se.CLAMP_TO_EDGE),W.useMipmap&&ue.extTextureFilterAnisotropic&&l.transform.pitch>20&&se.texParameterf(se.TEXTURE_2D,ue.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,ue.extTextureFilterAnisotropicMax);const[Re,ze,De,$e]=r?$.getPoleBuffers(r.canonical.z,!1):$.getPoleBuffers(0,!0),Xe=x.paint.get("raster-elevation");let ht;p?(ht=Re,l.renderDefaultNorthPole=Xe!==0):(ht=ze,l.renderDefaultSouthPole=Xe!==0);const ot=ni(A.mix),Et=((nt,pt,Lt,tt,St,mt,Gt,It,At,zt,Wt,on,dn)=>Ul(nt,pt,Lt,new Float32Array(16),new Float32Array(9),[0,0],tt,[0,0],[0,0,0,0],1,{opacity:1,mix:0},mt,[0,0],It,2,zt,Wt,on,1,0,dn))(Me,Fe,te,i.ae(l.transform.zoom),0,x,0,Xe,0,ot,A.offset,A.range,w),yt=l.getOrCreateProgram("raster",{defines:Te});l.uploadCommonUniforms(ue,yt,null),yt.draw(l,se.TRIANGLES,Pe,N,he,D,Et,x.id,ht,De,$e)}function Cp(p){const r=p._nearZ,l=p.projection.farthestPixelDistance(p),m=l-r,x=.2*p.height,w=r+x;return[r,l,(w-x-r)/m,(w-r)/m]}function rd(p,r,l,m){if(p)return r instanceof Ai&&p instanceof Pl?r.getTextureDescriptor(p,l,!0):{texture:p.texture,mix:ni(m.mix),offset:m.offset,buffer:0,tileSize:1}}var Vm=i.da([{name:"a_index",type:"Int16",components:1}]);class $m{constructor(r,l,m,x){const w={width:m[0],height:m[1],data:null},A=r.gl;this.targetColorTexture=new i.T(r,w,A.RGBA8,{useMipmap:!1}),this.backgroundColorTexture=new i.T(r,w,A.RGBA8,{useMipmap:!1}),this.context=r,this.updateParticleTexture(l,x),this.lastInvalidatedAt=0}updateParticleTexture(r,l){if(this.particleTextureDimension===l.width)return;(this.particleTexture0||this.particleTexture1||this.particleIndexBuffer||this.particleSegment)&&(this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleIndexBuffer.destroy(),this.particleSegment.destroy());const m=this.context.gl,x=l.width*l.height;this.particleTexture0=new i.T(this.context,l,m.RGBA8,{premultiply:!1,useMipmap:!1}),this.particleTexture1=new i.T(this.context,l,m.RGBA8,{premultiply:!1,useMipmap:!1});const w=new i.db;w.reserve(x);for(let A=0;A<x;A++)w.emplaceBack(A);this.particleIndexBuffer=this.context.createVertexBuffer(w,Vm.members,!0),this.particleSegment=i.b7.simpleSegment(0,0,this.particleIndexBuffer.length,0),this.particleTextureDimension=l.width}update(r){return!(this.lastInvalidatedAt<r&&(this.lastInvalidatedAt=i.q.now(),1))}destroy(){this.targetColorTexture.destroy(),this.backgroundColorTexture.destroy(),this.particleIndexBuffer.destroy(),this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleSegment.destroy()}}function qm(p,r,l){if(!p)return null;const m=r.getTextureDescriptor(p,l,!0);if(!m)return null;let{texture:x,mix:w,offset:A,tileSize:D,buffer:N,format:U}=m;if(!x||!U)return null;let $=!1;return U==="uint32"&&($=!0,w[3]=0,w=Qf(i.dc,w,[0,l.paint.get("raster-particle-max-speed")]),A=Lh(i.dc,A,[0,l.paint.get("raster-particle-max-speed")])),{texture:x,textureOffset:[N/(D+2*N),D/(D+2*N)],tileSize:D,scalarData:$,scale:w,offset:A,defines:["RASTER_ARRAY",{uint8:"DATA_FORMAT_UINT8",uint16:"DATA_FORMAT_UINT16",uint32:"DATA_FORMAT_UINT32"}[U]]}}function Gm(p){const r=p._nearZ,l=p.projection.farthestPixelDistance(p),m=l-r,x=.2*p.height,w=r+x;return[r,l,(w-x-r)/m,(w-r)/m]}const Nc=new i.aj(1,0,0,1),p_=new i.aj(0,1,0,1),m_=new i.aj(0,0,1,1),Hm=new i.aj(1,0,1,1),id=new i.aj(0,1,1,1);function Gl(p,r,l,m,x,w,A){const D=p.context,N=p.transform,U=D.gl,$=N.projection.name==="globe",Z=$?["PROJECTION_GLOBE_VIEW"]:[];let W=i.ab.mat4.clone(l.projMatrix);if($&&i.ae(N.zoom)>0){const ot=i.ba(l.canonical,N),Et=i.dd(ot);W=i.ab.mat4.multiply(new Float32Array(16),N.globeMatrix,Et),i.ab.mat4.multiply(W,N.projMatrix,W)}const te=i.ab.mat4.create();te[12]+=2*x/(i.q.devicePixelRatio*N.width),te[13]+=2*w/(i.q.devicePixelRatio*N.height),i.ab.mat4.multiply(W,te,W);const ue=p.getOrCreateProgram("debug",{defines:Z}),se=r.getTileByID(l.key);p.terrain&&p.terrain.setupElevationDraw(se,ue);const de=Tn.disabled,he=Dn.disabled,Te=p.colorModeForRenderPass(),Pe="$debug";D.activeTexture.set(U.TEXTURE0),p.emptyTexture.bind(U.LINEAR,U.CLAMP_TO_EDGE),$?se._makeGlobeTileDebugBuffers(p.context,N):se._makeDebugTileBoundsBuffers(p.context,N.projection);const Me=se._tileDebugBuffer||p.debugBuffer,Fe=se._tileDebugIndexBuffer||p.debugIndexBuffer,Re=se._tileDebugSegments||p.debugSegments;if(ue.draw(p,U.LINE_STRIP,de,he,Te,Rn.disabled,Ru(W,m),Pe,Me,Fe,Re,null,null,null,[se._globeTileDebugBorderBuffer]),A){const ot=se.latestRawTileData,Et=Math.floor((ot&&ot.byteLength||0)/1024);let yt=l.canonical.toString();l.overscaledZ!==l.canonical.z&&(yt+=` => ${l.overscaledZ}`),yt+=` ${se.state}`,yt+=` ${Et}kb`,function(nt,pt){nt.initDebugOverlayCanvas();const Lt=nt.debugOverlayCanvas,tt=nt.context.gl,St=nt.debugOverlayCanvas.getContext("2d");St.clearRect(0,0,Lt.width,Lt.height),St.shadowColor="white",St.shadowBlur=2,St.lineWidth=1.5,St.strokeStyle="white",St.textBaseline="top",St.font="bold 36px Open Sans, sans-serif",St.fillText(pt,5,5),St.strokeText(pt,5,5),nt.debugOverlayTexture.update(Lt),nt.debugOverlayTexture.bind(tt.LINEAR,tt.CLAMP_TO_EDGE)}(p,yt)}const ze=r.getTile(l).tileSize,De=512/Math.min(ze,512)*(l.overscaledZ/N.zoom)*.5,$e=se._tileDebugTextBuffer||p.debugBuffer,Xe=se._tileDebugTextIndexBuffer||p.quadTriangleIndexBuffer,ht=se._tileDebugTextSegments||p.debugSegments;ue.draw(p,U.TRIANGLES,de,he,Jn.alphaBlended,Rn.disabled,Ru(W,i.aj.transparent,De),Pe,$e,Xe,ht,null,null,null,[se._globeTileDebugTextBuffer])}function Zm(p,r,l,m){ys(p,0,r+l/2,p.transform.width,l,m)}function Mp(p,r,l,m){ys(p,r-l/2,0,l,p.transform.height,m)}function ys(p,r,l,m,x,w){const A=p.context,D=A.gl;D.enable(D.SCISSOR_TEST),D.scissor(r*i.q.devicePixelRatio,l*i.q.devicePixelRatio,m*i.q.devicePixelRatio,x*i.q.devicePixelRatio),A.clear({color:w}),D.disable(D.SCISSOR_TEST)}const ad=i.da([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:Ho}=ad;function vs(p,r,l,m){p.emplaceBack(r,l,m)}class Wm{constructor(r){this.vertexArray=new i.de,this.indices=new i.aU,vs(this.vertexArray,-1,-1,1),vs(this.vertexArray,1,-1,1),vs(this.vertexArray,-1,1,1),vs(this.vertexArray,1,1,1),vs(this.vertexArray,-1,-1,-1),vs(this.vertexArray,1,-1,-1),vs(this.vertexArray,-1,1,-1),vs(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=r.createVertexBuffer(this.vertexArray,Ho),this.indexBuffer=r.createIndexBuffer(this.indices),this.segment=i.b7.simpleSegment(0,0,36,12)}}function $i(p,r,l,m,x,w){const A=p.context.gl,D=r.paint.get("sky-atmosphere-color"),N=r.paint.get("sky-atmosphere-halo-color"),U=r.paint.get("sky-atmosphere-sun-intensity"),$=((Z,W,te,ue,se)=>({u_matrix_3f:Z,u_sun_direction:W,u_sun_intensity:te,u_color_tint_r:[ue.r,ue.g,ue.b,ue.a],u_color_tint_m:[se.r,se.g,se.b,se.a],u_luminance:5e-5}))(i.ab.mat3.fromMat4(i.ab.mat3.create(),m),x,U,D,N);A.framebufferTexture2D(A.FRAMEBUFFER,A.COLOR_ATTACHMENT0,A.TEXTURE_CUBE_MAP_POSITIVE_X+w,r.skyboxTexture,0),l.draw(p,A.TRIANGLES,Tn.disabled,Dn.disabled,Jn.unblended,Rn.frontCW,$,"skyboxCapture",r.skyboxGeometry.vertexBuffer,r.skyboxGeometry.indexBuffer,r.skyboxGeometry.segment)}const __=i.da([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class Fh{constructor(r){const l=new i.df;l.emplaceBack(-1,1,1,0,0),l.emplaceBack(1,1,1,1,0),l.emplaceBack(1,-1,1,1,1),l.emplaceBack(-1,-1,1,0,1);const m=new i.aU;m.emplaceBack(0,1,2),m.emplaceBack(2,3,0),this.vertexBuffer=r.createVertexBuffer(l,__.members),this.indexBuffer=r.createIndexBuffer(m),this.segments=i.b7.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const $r=i.da([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_size_scale",components:1},{type:"Float32",name:"a_fade_opacity",components:1}]);class br{constructor(){this.starsCount=16e3,this.sizeMultiplier=.15,this.sizeRange=100,this.intensityRange=200}}class Op{constructor(r){this.colorModeAlphaBlendedWriteRGB=new Jn([1,ds,1,ds],i.aj.transparent,[!0,!0,!0,!1]),this.colorModeWriteAlpha=new Jn([1,0,1,0],i.aj.transparent,[!1,!1,!1,!0]),this.params=new br,this.updateNeeded=!0,r.tp.registerParameter(this.params,["Stars"],"starsCount",{min:100,max:16e3,step:1},()=>{this.updateNeeded=!0}),r.tp.registerParameter(this.params,["Stars"],"sizeMultiplier",{min:.01,max:2,step:.01}),r.tp.registerParameter(this.params,["Stars"],"sizeRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0}),r.tp.registerParameter(this.params,["Stars"],"intensityRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0})}update(r){const l=r.context;if(!this.atmosphereBuffer||this.updateNeeded){this.updateNeeded=!1,this.atmosphereBuffer=new Fh(l);const m=this.params.sizeRange,x=this.params.intensityRange,w=function($){const Z=i.di(30),W=[];for(let te=0;te<$;++te){const ue=2*Math.PI*Z(),se=Math.acos(1-2*Z())-.5*Math.PI;W.push(i.ab.vec3.fromValues(Math.cos(se)*Math.cos(ue),Math.cos(se)*Math.sin(ue),Math.sin(se)))}return W}(this.params.starsCount),A=i.di(300),D=new i.dg,N=new i.aU;let U=0;for(let $=0;$<w.length;++$){const Z=i.ab.vec3.scale([],w[$],200),W=Math.max(0,1+.01*m*(1*A()-.5)),te=Math.max(0,1+.01*x*(1*A()-.5));D.emplaceBack(Z[0],Z[1],Z[2],-1,-1,W,te),D.emplaceBack(Z[0],Z[1],Z[2],1,-1,W,te),D.emplaceBack(Z[0],Z[1],Z[2],1,1,W,te),D.emplaceBack(Z[0],Z[1],Z[2],-1,1,W,te),N.emplaceBack(U+0,U+1,U+2),N.emplaceBack(U+0,U+2,U+3),U+=4}this.starsVx=l.createVertexBuffer(D,$r.members),this.starsIdx=l.createIndexBuffer(N),this.starsSegments=i.b7.simpleSegment(0,0,D.length,N.length)}}destroy(){this.atmosphereBuffer&&this.atmosphereBuffer.destroy(),this.starsVx&&this.starsVx.destroy(),this.starsIdx&&this.starsIdx.destroy()}drawAtmosphereGlow(r,l){const m=r.context,x=m.gl,w=r.transform,A=new Tn(x.LEQUAL,Tn.ReadOnly,[0,1]),D=i.ae(w.zoom),N=r.style.getLut(l.scope),U=l.properties.get("color-use-theme")==="none",$=l.properties.get("color").toRenderColor(U?null:N).toArray01(),Z=l.properties.get("high-color-use-theme")==="none",W=l.properties.get("high-color").toRenderColor(Z?null:N).toArray01(),te=l.properties.get("space-color-use-theme")==="none",ue=l.properties.get("space-color").toRenderColor(te?null:N).toArray01PremultipliedAlpha(),se=5e-4,de=i.dh(l.properties.get("horizon-blend"),0,1,se,.25),he=i.cC(r,m,w)&&de===se?w.worldSize/(2*Math.PI*1.025)-1:w.globeRadius,Te=r.frameCounter/1e3%1,Pe=i.ab.vec3.length(w.globeCenterInViewSpace),Me=Math.sqrt(Math.pow(Pe,2)-Math.pow(he,2)),Fe=Math.acos(Me/Pe),Re=ze=>{const De=w.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"];ze&&De.push("ALPHA_PASS");const $e=r.getOrCreateProgram("globeAtmosphere",{defines:De}),Xe=((ot,Et,yt,nt,pt,Lt,tt,St,mt,Gt,It,At)=>({u_frustum_tl:ot,u_frustum_tr:Et,u_frustum_br:yt,u_frustum_bl:nt,u_horizon:pt,u_transition:Lt,u_fadeout_range:tt,u_color:St,u_high_color:mt,u_space_color:Gt,u_temporal_offset:It,u_horizon_angle:At}))(w.frustumCorners.TL,w.frustumCorners.TR,w.frustumCorners.BR,w.frustumCorners.BL,w.frustumCorners.horizon,D,de,$,W,ue,Te,Fe);r.uploadCommonUniforms(m,$e);const ht=this.atmosphereBuffer;ht&&$e.draw(r,x.TRIANGLES,A,Dn.disabled,ze?this.colorModeWriteAlpha:this.colorModeAlphaBlendedWriteRGB,Rn.backCW,Xe,ze?"atmosphere_glow_alpha":"atmosphere_glow",ht.vertexBuffer,ht.indexBuffer,ht.segments)};Re(!1),Re(!0)}drawStars(r,l){const m=i.aw(l.properties.get("star-intensity"),0,1);if(m===0)return;const x=r.context,w=x.gl,A=r.transform,D=r.getOrCreateProgram("stars"),N=i.ab.quat.identity([]);i.ab.quat.rotateX(N,N,-A._pitch),i.ab.quat.rotateZ(N,N,-A.angle),i.ab.quat.rotateX(N,N,i.ai(A._center.lat)),i.ab.quat.rotateY(N,N,-i.ai(A._center.lng));const U=i.ab.mat4.fromQuat(new Float32Array(16),N),$=i.ab.mat4.multiply([],A.starsProjMatrix,U),Z=i.ab.mat3.fromMat4([],U),W=i.ab.mat3.invert([],Z),te=[0,1,0];i.ab.vec3.transformMat3(te,te,W),i.ab.vec3.scale(te,te,this.params.sizeMultiplier);const ue=[1,0,0];i.ab.vec3.transformMat3(ue,ue,W),i.ab.vec3.scale(ue,ue,this.params.sizeMultiplier);const se=(de=te,he=ue,Te=m,{u_matrix:Float32Array.from($),u_up:de,u_right:he,u_intensity_multiplier:Te});var de,he,Te;r.uploadCommonUniforms(x,D),this.starsVx&&this.starsIdx&&D.draw(r,w.TRIANGLES,Tn.disabled,Dn.disabled,this.colorModeAlphaBlendedWriteRGB,Rn.disabled,se,"atmosphere_stars",this.starsVx,this.starsIdx,this.starsSegments)}}function cl(p,r){const l=[...p],m=r.cameraWorldSizeForFog/r.worldSize,x=i.ab.mat4.identity([]);return i.ab.mat4.scale(x,x,[m,m,1]),i.ab.mat4.multiply(l,x,l),i.ab.mat4.multiply(l,r.worldToFogMatrix,l),l}function ku(p,r,l,m,x){const w=l.material,A=m.context,{baseColorTexture:D,metallicRoughnessTexture:N}=w.pbrMetallicRoughness,{normalTexture:U,occlusionTexture:$,emissionTexture:Z}=w;function W(ue,se,de){if(ue&&(p.push(se),A.activeTexture.set(A.gl.TEXTURE0+de),ue.gfxTexture)){const{minFilter:he,magFilter:Te,wrapS:Pe,wrapT:Me}=ue.sampler;ue.gfxTexture.bindExtraParam(he,Te,Pe,Me)}}W(D,"HAS_TEXTURE_u_baseColorTexture",aa.BaseColor),W(N,"HAS_TEXTURE_u_metallicRoughnessTexture",aa.MetallicRoughness),W(U,"HAS_TEXTURE_u_normalTexture",aa.Normal),W($,"HAS_TEXTURE_u_occlusionTexture",aa.Occlusion),W(Z,"HAS_TEXTURE_u_emissionTexture",aa.Emission),x&&(x.texture||(x.texture=new i.dk(m.context,x.image,[x.image.height,x.image.height,x.image.height],A.gl.RGBA8)),A.activeTexture.set(A.gl.TEXTURE0+aa.LUT),x.texture&&x.texture.bind(A.gl.LINEAR,A.gl.CLAMP_TO_EDGE),p.push("APPLY_LUT_ON_GPU")),l.texcoordBuffer&&(p.push("HAS_ATTRIBUTE_a_uv_2f"),r.push(l.texcoordBuffer)),l.colorBuffer&&(p.push(l.colorBuffer.itemSize===12?"HAS_ATTRIBUTE_a_color_3f":"HAS_ATTRIBUTE_a_color_4f"),r.push(l.colorBuffer)),l.normalBuffer&&(p.push("HAS_ATTRIBUTE_a_normal_3f"),r.push(l.normalBuffer)),l.pbrBuffer&&(p.push("HAS_ATTRIBUTE_a_pbr"),p.push("HAS_ATTRIBUTE_a_heightBasedEmissiveStrength"),r.push(l.pbrBuffer)),w.alphaMode!=="OPAQUE"&&w.alphaMode!=="MASK"||p.push("UNPREMULT_TEXTURE_IN_SHADER"),w.defined||p.push("DIFFUSE_SHADED");const te=m.shadowRenderer;te&&(p.push("RENDER_SHADOWS","DEPTH_TEXTURE"),te.useNormalOffset&&p.push("NORMAL_OFFSET"))}function $s(p,r,l,m,x,w){const A=l.paint.get("model-opacity").constantOr(1),D=r.context,N=new Tn(r.context.gl.LEQUAL,Tn.ReadWrite,r.depthRangeFor3D),U=r.transform,$=p.mesh,Z=$.material,W=Z.pbrMetallicRoughness,te=r.style.fog;let ue;ue=r.transform.projection.zAxisUnit==="pixels"?[...p.nodeModelMatrix]:i.ab.mat4.multiply([],m.zScaleMatrix,p.nodeModelMatrix),i.ab.mat4.multiply(ue,m.negCameraPosMatrix,ue);const se=i.ab.mat4.invert([],ue);i.ab.mat4.transpose(se,se);const de=l.paint.get("model-color-use-theme").constantOr("default")==="none",he=l.paint.get("model-emissive-strength").constantOr(0),Te=ed(new Float32Array(p.worldViewProjection),new Float32Array(ue),new Float32Array(se),null,r,A,W.baseColorFactor.toRenderColor(null),Z.emissiveFactor,W.metallicFactor,W.roughnessFactor,Z,he,l),Pe={defines:[]},Me=[],Fe=r.shadowRenderer;Fe&&(Fe.useNormalOffset=!1),ku(Pe.defines,Me,$,r,de?null:l.lut);let Re=null;if(te){const $e=cl(p.nodeModelMatrix,r.transform);if(Re=new Float32Array($e),U.projection.name!=="globe"){const Xe=$.aabb.min,ht=$.aabb.max,[ot,Et]=te.getOpacityForBounds($e,Xe[0],Xe[1],ht[0],ht[1]);Pe.overrideFog=ot>=je||Et>=je}}const ze=_c(r,l.paint.get("model-cutoff-fade-range"));ze.shouldRenderCutoff&&Pe.defines.push("RENDER_CUTOFF");const De=r.getOrCreateProgram("model",Pe);r.uploadCommonUniforms(D,De,null,Re,ze),r.renderPass!=="shadow"&&Fe&&Fe.setupShadowsFromMatrix(p.nodeModelMatrix,De),De.draw(r,D.gl.TRIANGLES,N,x,w,$.material.doubleSided?Rn.disabled:Rn.backCCW,Te,l.id,$.vertexBuffer,$.indexBuffer,$.segments,l.paint,r.transform.zoom,void 0,Me)}function od(p,r,l,m,x,w,A){let D;D=p.projection.name==="globe"?i.dl(l,p):[...l],i.ab.mat4.multiply(D,D,r.matrix);const N=i.ab.mat4.multiply([],m,D);if(r.meshes)for(const U of r.meshes){if(U.material.alphaMode!=="BLEND"){A.push({mesh:U,depth:0,modelIndex:x,worldViewProjection:N,nodeModelMatrix:D});continue}const $=i.ab.vec3.transformMat4([],U.centroid,N);!p.isOrthographic&&$[2]<=0||w.push({mesh:U,depth:$[2],modelIndex:x,worldViewProjection:N,nodeModelMatrix:D})}if(r.children)for(const U of r.children)od(p,U,l,m,x,w,A)}function jh(p,r,l,m){const x=l.shadowRenderer;if(!x)return;const w=x.getShadowPassDepthMode(),A=x.getShadowPassColorMode(),D=x.calculateShadowPassMatrixFromMatrix(r),N=Di(D);l.getOrCreateProgram("modelDepth",{defines:l._shadowMapDebug?[]:["DEPTH_TEXTURE"]}).draw(l,l.context.gl.TRIANGLES,w,Dn.disabled,A,Rn.backCCW,N,m.id,p.vertexBuffer,p.indexBuffer,p.segments,m.paint,l.transform.zoom,void 0,void 0)}function ul(p,r,l){const m=r.updateZoomBasedPaintProperties(),x=function(w,A,D){let N,U,$,Z=w.terrain?w.terrain.exaggeration():0;if(w.terrain&&Z>0){const W=w.terrain,te=W.findDEMTileFor(D);te&&te.dem?N=i.dn.create(W,D,te):Z=0}if(Z===0&&(A.terrainElevationMin=0,A.terrainElevationMax=0),Z===A.validForExaggeration&&(Z===0||N&&N._demTile&&N._demTile.tileID===A.validForDEMTile.id&&N._dem._timestamp===A.validForDEMTile.timestamp))return!1;for(const W in A.instancesPerModel){const te=A.instancesPerModel[W];for(let ue=0;ue<te.instancedDataArray.length;++ue){const se=(N?Z*N.getElevationAt(0|te.instancedDataArray.float32[16*ue],0|te.instancedDataArray.float32[16*ue+1],!0,!0):0)+te.instancesEvaluatedElevation[ue];te.instancedDataArray.float32[16*ue+6]=se,U=U?Math.min(A.terrainElevationMin,se):se,$=$?Math.max(A.terrainElevationMax,se):se}}return A.terrainElevationMin=U||0,A.terrainElevationMax=$||0,A.validForExaggeration=Z,A.validForDEMTile=N&&N._demTile?{id:N._demTile.tileID,timestamp:N._dem._timestamp}:{id:void 0,timestamp:0},!0}(p,r,l);(m||x)&&(r.uploaded=!1,r.upload(p.context))}const Sa={shadowUniformsInitialized:!1,useSingleShadowCascade:!1,tileMatrix:new Float64Array(16),shadowTileMatrix:new Float32Array(16),aabb:new i.cd([0,0,0],[i.ag,i.ag,0])};function sd(p,r){const l=1<<p.canonical.z,m=r.getFreeCameraOptions().position,x=r.elevation,w=p.canonical.x/l,A=(p.canonical.x+1)/l,D=p.canonical.y/l,N=(p.canonical.y+1)/l;let U=r._centerAltitude;if(x){const te=x.getMinMaxForTile(p);te&&te.max>U&&(U=te.max)}const $=i.aw(m.x,w,A)-m.x,Z=i.aw(m.y,D,N)-m.y,W=i.bH(U,r.center.lat)-m.z;return r._zoomFromMercatorZ(Math.sqrt($*$+Z*Z+W*W))}function Uh(p,r,l,m,x,w,A){const D=p.context,N=p.renderPass==="shadow",U=p.shadowRenderer,$=N&&U?U.getShadowPassDepthMode():new Tn(D.gl.LEQUAL,Tn.ReadWrite,p.depthRangeFor3D),Z=p.isTileAffectedByFog(w);if(l.meshes)for(const W of l.meshes){const te=["MODEL_POSITION_ON_GPU"],ue=[];let se,de,he;m.instancedDataArray.length>20&&te.push("INSTANCED_ARRAYS");const Te=_c(p,r.paint.get("model-cutoff-fade-range"));if(Te.shouldRenderCutoff&&te.push("RENDER_CUTOFF"),N&&U)se=p.getOrCreateProgram("modelDepth",{defines:te}),de=Di(A.shadowTileMatrix,A.shadowTileMatrix,Float32Array.from(l.matrix)),he=U.getShadowPassColorMode();else{ku(te,ue,W,p,r.paint.get("model-color-use-theme").constantOr("default")==="none"?null:r.lut),se=p.getOrCreateProgram("model",{defines:te,overrideFog:Z});const Me=W.material,Fe=Me.pbrMetallicRoughness,Re=r.paint.get("model-opacity").constantOr(1),ze=r.paint.get("model-emissive-strength").constantOr(0);de=ed(w.expandedProjMatrix,Float32Array.from(l.matrix),new Float32Array(16),null,p,Re,Fe.baseColorFactor.toRenderColor(null),Me.emissiveFactor,Fe.metallicFactor,Fe.roughnessFactor,Me,ze,r,x),U&&(A.shadowUniformsInitialized?se.setShadowUniformValues(D,U.getShadowUniformValues()):(U.setupShadows(w.toUnwrapped(),se,"model-tile",w.overscaledZ),A.shadowUniformsInitialized=!0)),he=Te.shouldRenderCutoff||Re<1||Me.alphaMode!=="OPAQUE"?Jn.alphaBlended:Jn.unblended}p.uploadCommonUniforms(D,se,w.toUnwrapped(),null,Te);const Pe=W.material.doubleSided?Rn.disabled:Rn.backCCW;if(m.instancedDataArray.length>20)ue.push(m.instancedDataBuffer),se.draw(p,D.gl.TRIANGLES,$,Dn.disabled,he,Pe,de,r.id,W.vertexBuffer,W.indexBuffer,W.segments,r.paint,p.transform.zoom,void 0,ue,m.instancedDataArray.length);else{const Me=N?"u_instance":"u_normal_matrix";for(let Fe=0;Fe<m.instancedDataArray.length;++Fe)de[Me]=new Float32Array(m.instancedDataArray.arrayBuffer,64*Fe,16),se.draw(p,D.gl.TRIANGLES,$,Dn.disabled,he,Pe,de,r.id,W.vertexBuffer,W.indexBuffer,W.segments,r.paint,p.transform.zoom,void 0,ue)}}if(l.children)for(const W of l.children)Uh(p,r,W,m,x,w,A)}const ld=[1,-1,1];function Pp(p,r,l,m){if(!l.modelManager)return!0;const x=l.modelManager;if(!l.shadowRenderer)return!0;const w=l.shadowRenderer,A=r.aabb;let D=!0,N=p.maxHeight;if(N===0){let $=0;for(const Z in p.instancesPerModel){const W=x.getModel(Z,m);W?$=Math.max($,Math.max(Math.max(W.aabb.max[0],W.aabb.max[1]),W.aabb.max[2])):D=!1}N=p.maxScale*$*1.41+p.maxVerticalOffset,D&&(p.maxHeight=N)}A.max[2]=N,A.min[2]+=p.terrainElevationMin,A.max[2]+=p.terrainElevationMax,i.ab.vec3.transformMat4(A.min,A.min,r.tileMatrix),i.ab.vec3.transformMat4(A.max,A.max,r.tileMatrix);const U=A.intersects(w.getCurrentCascadeFrustum());return l.currentShadowCascade===0&&(p.isInsideFirstShadowMapFrustum=U===2),U===0}function Fc(p,r){const l=p.uniformValues.u_cutoff_params[0],m=p.uniformValues.u_cutoff_params[1],x=p.uniformValues.u_cutoff_params[2],w=p.uniformValues.u_cutoff_params[3];return m===l||w===x?1:i.aw(((r-l)/(m-l)-x)/(w-x),0,1)}function Xm(p,r,l,m){if(r.pitch<20)return 1;const x=r.getWorldToCameraMatrix();i.ab.mat4.multiply(x,x,p);const w=i.ab.vec4.fromValues(l.min[0],l.min[1],l.min[2],1);let A=i.ab.vec4.transformMat4(i.ab.vec4.create(),w,x),D=A,N=A;w[1]=l.max[1],A=i.ab.vec4.transformMat4(i.ab.vec4.create(),w,x),D=A[1]<D[1]?A:D,N=A[1]>N[1]?A:N,w[0]=l.max[0],A=i.ab.vec4.transformMat4(i.ab.vec4.create(),w,x),D=A[1]<D[1]?A:D,N=A[1]>N[1]?A:N,w[1]=l.min[1],A=i.ab.vec4.transformMat4(i.ab.vec4.create(),w,x),D=A[1]<D[1]?A:D,N=A[1]>N[1]?A:N;const U=i.aw(m[0],0,1),$=100*r.pixelsPerMeter*i.aw(m[1],0,1),Z=i.aw(m[2],0,1),W=i.ab.vec4.lerp(i.ab.vec4.create(),D,N,U),te=Math.tan(.5*r.fovX),ue=-W[2]*te;if($===0)return W[1]<-Math.abs(ue)?Z:1;const se=(-Math.abs(ue)-W[1])/$,de=(Te,Pe,Me)=>(1-Me)*Te+Me*Pe,he=i.aw(de(1,Z,se),Z,1);return de(1,he,i.aw((r.pitch-20)/20,0,1))}class jc{}class Ip{constructor(){this._storage=new Map}getLinesFromTrianglesBuffer(r,l,m){{const Z=this._storage.get(l.id);if(Z)return Z.lastUsedFrameIdx=r,Z.buf}const x=m.gl,w=x.getBufferParameter(x.ELEMENT_ARRAY_BUFFER,x.BUFFER_SIZE),A=new ArrayBuffer(w),D=new Int16Array(A);x.getBufferSubData(x.ELEMENT_ARRAY_BUFFER,0,new Int16Array(A));const N=new i.dq;for(let Z=0;Z<w/2;Z+=3){const W=D[Z],te=D[Z+1],ue=D[Z+2];N.emplaceBack(W,te),N.emplaceBack(te,ue),N.emplaceBack(ue,W)}const U=m.bindVertexArrayOES.current,$=new jc;return $.buf=new gs(m,N),$.lastUsedFrameIdx=r,this._storage.set(l.id,$),m.bindVertexArrayOES.set(U),$.buf}update(r){for(const[l,m]of this._storage)r-m.lastUsedFrameIdx>30&&(m.buf.destroy(),this._storage.delete(l))}destroy(){for(const[r,l]of this._storage)l.buf.destroy(),this._storage.delete(r)}}class Uc{constructor(r){this.occluderSize=30,this.depthOffset=-1e-4,r.registerParameter(this,["Occlusion"],"occluderSize",{min:1,max:100,step:1}),r.registerParameter(this,["Occlusion"],"depthOffset",{min:-.05,max:0,step:1e-5})}}const cd=i.da([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_rainParticleData",components:4}]);class Vh{registerParameter(){}registerButton(){}registerBinding(){}refreshUI(){}}class sa{constructor(r,l){this.revealStart=11,this.revealRange=2,r.registerParameter(this,[...l,"Reveal"],"revealStart",{min:0,max:17,step:.05}),r.registerParameter(this,[...l,"Reveal"],"revealRange",{min:.1,max:5.1,step:.05})}}const Rp=i.da([{type:"Float32",name:"a_pos_2f",components:2}]);class xs{destroy(){this.vignetteVx&&this.vignetteVx.destroy(),this.vignetteIdx&&this.vignetteIdx.destroy()}draw(r,l){const m=r.getOrCreateProgram("vignette");if(!this.vignetteVx||!this.vignetteIdx){const A=new i.dr,D=new i.aU;A.emplaceBack(-1,-1),A.emplaceBack(1,-1),A.emplaceBack(1,1),A.emplaceBack(-1,1),D.emplaceBack(0,1,2),D.emplaceBack(0,2,3),this.vignetteVx=r.context.createVertexBuffer(A,Rp.members),this.vignetteIdx=r.context.createIndexBuffer(D)}const x=i.b7.simpleSegment(0,0,4,6);if(this.vignetteVx&&this.vignetteIdx){r.uploadCommonUniforms(r.context,m);const A={u_vignetteShape:(w={vignetteShape:[l.start,l.range,Math.pow(10,l.fadePower)],vignetteColor:[l.color.r,l.color.g,l.color.b,l.color.a*l.strength]}).vignetteShape,u_vignetteColor:w.vignetteColor};m.draw(r,r.context.gl.TRIANGLES,Tn.disabled,Dn.disabled,Jn.alphaBlended,Rn.disabled,A,"vignette",this.vignetteVx,this.vignetteIdx,x,{})}var w}}class qs{constructor(){this._accumulatedOffsetX=0,this._accumulatedOffsetY=0,this._accumulatedElevation=0}update(r,l){const m=r.getFreeCameraOptions().position,x=m.toAltitude(),w=m.toLngLat(),A=i.ai(w.lng),D=i.ai(w.lat),N=r.pixelsPerMeter/l,U=A*i.ds,$=i.ds*Math.log(Math.tan(Math.PI/4+D/2));if(this._offsetXPrev===void 0)this._offsetXPrev=0,this._offsetYPrev=0,this._elevationPrev=0,this._accumulatedOffsetX=0,this._accumulatedOffsetY=0,this._accumulatedElevation=0;else{const Z=-this._offsetYPrev+$,W=-this._elevationPrev+x;this._accumulatedOffsetX+=(-this._offsetXPrev+U)*N,this._accumulatedOffsetY+=Z*N,this._accumulatedElevation+=W*N,this._offsetXPrev=U,this._offsetYPrev=$,this._elevationPrev=x}}getPosition(){return[this._accumulatedOffsetX,this._accumulatedOffsetY,this._accumulatedElevation]}}function mo(p,r){return[-(p[0]-Math.floor(p[0]/r)*r),-(p[1]-Math.floor(p[1]/r)*r),-(p[2]-Math.floor(p[2]/r)*r)]}function hl(p){const r=i.di(1323123451230),l=[];for(let m=0;m<p;++m){const x=2*r()-1,w=2*r()-1,A=2*r()-1;l.push(i.ab.vec3.fromValues(x,w,A))}return l}function bs(p,r,l,m,x){const w=i.aw((x-l)/(m-l),0,1);return(1-w)*p+w*r}class $h{constructor(r){this._movement=new qs,this._accumulatedTimeFromStart=0,this._prevTime=Date.now()/1e3,this._vignette=new xs,this._ppmScaleFactor=r}destroy(){this.particlesVx&&this.particlesVx.destroy(),this.particlesIdx&&this.particlesIdx.destroy(),this._vignette&&this._vignette.destroy()}updateOnRender(r,l){const m=r.transform;this._movement.update(m,this._ppmScaleFactor);const x=m.starsProjMatrix,w=i.ab.quat.identity([]);i.ab.quat.rotateX(w,w,i.ai(90)-m._pitch),i.ab.quat.rotateZ(w,w,-m.angle);const A=i.ab.mat4.fromQuat(new Float32Array(16),w),D=i.ab.mat4.fromValues(1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1),N=i.ab.mat4.transpose([],D),U=i.ab.mat4.multiply([],N,A),$=Date.now()/1e3;return this._accumulatedTimeFromStart+=($-this._prevTime)*l,this._prevTime=$,{projectionMatrix:x,modelviewMatrix:U}}}class zu extends $h{constructor(r){super(4.25),this._params={overrideStyleParameters:!1,intensity:.5,timeFactor:1,velocityConeAperture:0,velocity:300,boxSize:2500,dropletSizeX:1,dropletSizeYScale:10,distortionStrength:70,screenThinning:{intensity:.57,start:.46,range:1.17,fadePower:.17,affectedRatio:1,particleOffset:-.2},color:{r:.66,g:.68,b:.74,a:.7},direction:{x:-50,y:-35},shapeDirPower:2,shapeNormalPower:1},this._revealParams=new sa(r.tp,["Precipitation","Rain"]),this._vignetteParams={strength:1,start:.7,range:1,fadePower:.4,color:{r:.27,g:.27,b:.27,a:1}},this.particlesCount=16e3}update(r){const l=r.context;if(!this.particlesVx){const m=hl(this.particlesCount),x=new i.dt,w=new i.aU;let A=0;const D=i.di(1323123451230);for(let N=0;N<m.length;++N){const U=m[N],$=[2*D()-1,D(),D(),D()];x.emplaceBack(U[0],U[1],U[2],-1,-1,...$),x.emplaceBack(U[0],U[1],U[2],1,-1,...$),x.emplaceBack(U[0],U[1],U[2],1,1,...$),x.emplaceBack(U[0],U[1],U[2],-1,1,...$),w.emplaceBack(A+0,A+1,A+2),w.emplaceBack(A+0,A+2,A+3),A+=4}this.particlesVx=l.createVertexBuffer(x,cd.members),this.particlesIdx=l.createIndexBuffer(w)}}draw(r){if(!this._params.overrideStyleParameters&&!r.style.rain)return;const l=this._params.overrideStyleParameters?this._revealParams:{revealStart:0,revealRange:.01},m=r.transform.zoom;if(l.revealStart>m)return;const x=bs(0,1,l.revealStart,l.revealStart+l.revealRange,m);if(!this.particlesVx||!this.particlesIdx)return;const w=structuredClone(this._params);let A=[-w.direction.x,w.direction.y,-100];i.ab.vec3.normalize(A,A);const D=structuredClone(this._vignetteParams);D.strength*=x,w.overrideStyleParameters||(w.intensity=r.style.rain.state.density,w.timeFactor=r.style.rain.state.intensity,w.color=structuredClone(r.style.rain.state.color),A=structuredClone(r.style.rain.state.direction),w.screenThinning.intensity=r.style.rain.state.centerThinning,w.dropletSizeX=r.style.rain.state.dropletSize[0],w.dropletSizeYScale=r.style.rain.state.dropletSize[1]/r.style.rain.state.dropletSize[0],w.distortionStrength=100*r.style.rain.state.distortionStrength,D.strength=1,D.color=structuredClone(r.style.rain.state.vignetteColor));const N=this.updateOnRender(r,w.timeFactor),U=r.context,$=U.gl,Z=r.transform;this.screenTexture&&this.screenTexture.size[0]===r.width&&this.screenTexture.size[1]===r.height||(this.screenTexture=new i.T(U,{width:r.width,height:r.height,data:null},$.RGBA8)),w.distortionStrength>0&&(U.activeTexture.set($.TEXTURE0),this.screenTexture.bind($.LINEAR,$.CLAMP_TO_EDGE),$.copyTexSubImage2D($.TEXTURE_2D,0,0,0,0,0,r.width,r.height));const W=r.getOrCreateProgram("rainParticle");r.uploadCommonUniforms(U,W),U.activeTexture.set($.TEXTURE0),this.screenTexture.bind($.LINEAR,$.CLAMP_TO_EDGE);const te=[w.color.r,w.color.g,w.color.b,w.color.a],ue=(se,de)=>{const he=mo(this._movement.getPosition(),se),Te=w.dropletSizeX,Pe=w.dropletSizeX*w.dropletSizeYScale,Me=r.width/2,Fe=r.height/2,Re=bs(0,w.screenThinning.start,0,1,w.screenThinning.intensity),ze=bs(.001,w.screenThinning.range,0,1,w.screenThinning.intensity),De=bs(0,w.screenThinning.particleOffset,0,1,w.screenThinning.intensity),$e=(Xe={modelview:N.modelviewMatrix,projection:N.projectionMatrix,time:this._accumulatedTimeFromStart,camPos:he,velocityConeAperture:w.velocityConeAperture,velocity:w.velocity,boxSize:se,rainDropletSize:[Te,Pe],distortionStrength:w.distortionStrength,rainDirection:A,color:te,screenSize:[Z.width,Z.height],thinningCenterPos:[Me,Fe],thinningShape:[Re,ze,Math.pow(10,w.screenThinning.fadePower)],thinningAffectedRatio:w.screenThinning.affectedRatio,thinningParticleOffset:De,shapeDirectionalPower:w.shapeDirPower,shapeNormalPower:w.shapeNormalPower,mode:de?0:1},{u_modelview:Float32Array.from(Xe.modelview),u_projection:Float32Array.from(Xe.projection),u_time:Xe.time,u_cam_pos:Xe.camPos,u_texScreen:0,u_velocityConeAperture:Xe.velocityConeAperture,u_velocity:Xe.velocity,u_boxSize:Xe.boxSize,u_rainDropletSize:Xe.rainDropletSize,u_distortionStrength:Xe.distortionStrength,u_rainDirection:Xe.rainDirection,u_color:Xe.color,u_screenSize:Xe.screenSize,u_thinningCenterPos:Xe.thinningCenterPos,u_thinningShape:Xe.thinningShape,u_thinningAffectedRatio:Xe.thinningAffectedRatio,u_thinningParticleOffset:Xe.thinningParticleOffset,u_shapeDirectionalPower:Xe.shapeDirectionalPower,u_shapeNormalPower:Xe.shapeNormalPower,u_mode:Xe.mode});var Xe;const ht=Math.round(w.intensity*this.particlesCount),ot=i.b7.simpleSegment(0,0,4*ht,2*ht);W.draw(r,$.TRIANGLES,Tn.disabled,Dn.disabled,Jn.alphaBlended,Rn.disabled,$e,"rain_particles",this.particlesVx,this.particlesIdx,ot,{})};w.distortionStrength>0&&ue(w.boxSize,!0),ue(w.boxSize,!1),this._vignette.draw(r,D)}}const Dp=i.da([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_snowParticleData",components:4},{type:"Float32",name:"a_snowParticleDataHorizontalOscillation",components:2}]);class Hl extends $h{constructor(r){super(2.25),this._params={overrideStyleParameters:!1,intensity:.85,timeFactor:.75,velocityConeAperture:70,velocity:40,horizontalOscillationRadius:4,horizontalOscillationRate:1.5,boxSize:2e3,billboardSize:2,shapeFadeStart:.27,shapeFadePower:.21,screenThinning:{intensity:.4,start:.15,range:1.4,fadePower:.24,affectedRatio:1,particleOffset:-.2},color:{r:1,g:1,b:1,a:1},direction:{x:-50,y:-35}},this._revealParams=new sa(r.tp,["Precipitation","Snow"]),this._vignetteParams={strength:.3,start:.78,range:.46,fadePower:.2,color:{r:1,g:1,b:1,a:1}},this.particlesCount=16e3}update(r){const l=r.context;if(!this.particlesVx){const m=hl(this.particlesCount),x=new i.du,w=new i.aU;let A=0;const D=i.di(1323123451230);for(let N=0;N<m.length;++N){const U=m[N],$=D(),Z=D(),W=D(),te=[N/m.length,$,Z,W],ue=[D(),D()];x.emplaceBack(U[0],U[1],U[2],-1,-1,...te,...ue),x.emplaceBack(U[0],U[1],U[2],1,-1,...te,...ue),x.emplaceBack(U[0],U[1],U[2],1,1,...te,...ue),x.emplaceBack(U[0],U[1],U[2],-1,1,...te,...ue),w.emplaceBack(A+0,A+1,A+2),w.emplaceBack(A+0,A+2,A+3),A+=4}this.particlesVx=l.createVertexBuffer(x,Dp.members),this.particlesIdx=l.createIndexBuffer(w)}}draw(r){if(!this._params.overrideStyleParameters&&!r.style.snow)return;const l=structuredClone(this._params);let m=[-l.direction.x,l.direction.y,-100];i.ab.vec3.normalize(m,m);const x=structuredClone(this._vignetteParams),w=l.overrideStyleParameters?this._revealParams:{revealStart:0,revealRange:.01},A=r.transform.zoom;if(w.revealStart>A)return;const D=bs(0,1,w.revealStart,w.revealStart+w.revealRange,A);x.strength*=D,l.overrideStyleParameters||(l.intensity=r.style.snow.state.density,l.timeFactor=r.style.snow.state.intensity,l.color=structuredClone(r.style.snow.state.color),m=structuredClone(r.style.snow.state.direction),l.screenThinning.intensity=r.style.snow.state.centerThinning,l.billboardSize=2.79*r.style.snow.state.flakeSize,x.strength=1,x.color=structuredClone(r.style.snow.state.vignetteColor));const N=this.updateOnRender(r,l.timeFactor);if(!this.particlesVx||!this.particlesIdx)return;const U=r.context,$=U.gl,Z=r.transform,W=r.getOrCreateProgram("snowParticle");r.uploadCommonUniforms(U,W),((te,ue,se)=>{const de=mo(this._movement.getPosition(),te),he=Z.width/2,Te=Z.height/2,Pe=bs(0,se.screenThinning.start,0,1,se.screenThinning.intensity),Me=bs(.001,se.screenThinning.range,0,1,se.screenThinning.intensity),Fe=bs(0,se.screenThinning.particleOffset,0,1,se.screenThinning.intensity),Re=(ze={modelview:N.modelviewMatrix,projection:N.projectionMatrix,time:this._accumulatedTimeFromStart,camPos:de,velocityConeAperture:se.velocityConeAperture,velocity:se.velocity,horizontalOscillationRadius:se.horizontalOscillationRadius,horizontalOscillationRate:se.horizontalOscillationRate,boxSize:te,billboardSize:1*se.billboardSize,simpleShapeParameters:[se.shapeFadeStart,se.shapeFadePower],screenSize:[Z.width,Z.height],thinningCenterPos:[he,Te],thinningShape:[Pe,Me,Math.pow(10,se.screenThinning.fadePower)],thinningAffectedRatio:se.screenThinning.affectedRatio,thinningParticleOffset:Fe,color:[se.color.r,se.color.g,se.color.b,se.color.a],direction:m},{u_modelview:Float32Array.from(ze.modelview),u_projection:Float32Array.from(ze.projection),u_time:ze.time,u_cam_pos:ze.camPos,u_velocityConeAperture:ze.velocityConeAperture,u_velocity:ze.velocity,u_horizontalOscillationRadius:ze.horizontalOscillationRadius,u_horizontalOscillationRate:ze.horizontalOscillationRate,u_boxSize:ze.boxSize,u_billboardSize:ze.billboardSize,u_simpleShapeParameters:ze.simpleShapeParameters,u_screenSize:ze.screenSize,u_thinningCenterPos:ze.thinningCenterPos,u_thinningShape:ze.thinningShape,u_thinningAffectedRatio:ze.thinningAffectedRatio,u_thinningParticleOffset:ze.thinningParticleOffset,u_particleColor:ze.color,u_direction:ze.direction});var ze;const De=Math.round(se.intensity*this.particlesCount),$e=i.b7.simpleSegment(0,0,4*De,2*De);this.particlesVx&&this.particlesIdx&&W.draw(r,$.TRIANGLES,Tn.disabled,Dn.disabled,Jn.alphaBlended,Rn.disabled,Re,"snow_particles",this.particlesVx,this.particlesIdx,$e,{})})(l.boxSize,0,l),this._vignette.draw(r,x)}}const Vc={symbol:function(p,r,l,m,x){if(p.renderPass!=="translucent")return;const w=Dn.disabled,A=p.colorModeForRenderPass(),D=l.layout.get("text-variable-anchor"),N=l.layout.get("text-size-scale-range"),U=i.aw(p.scaleFactor,N[0],N[1]);D&&function(W,te,ue,se,de,he,Te,Pe){const Me=te.transform,Fe=de==="map",Re=he==="map";for(const ze of W){const De=se.getTile(ze),$e=De.getBucket(ue);if(!$e||!$e.text||!$e.text.segments.get().length)continue;const Xe=i.bp($e.textSizeData,Me.zoom,Pe),ht=pc(ze,$e.getProjection(),Me),ot=Me.calculatePixelsToTileUnitsMatrix(De),Et=Wr(ht,De.tileID.canonical,Re,Fe,Me,$e.getProjection(),ot),yt=$e.hasIconTextFit()&&$e.hasIconData();if(Xe){const nt=Math.pow(2,Me.zoom-De.tileID.overscaledZ);Dc($e,Fe,Re,Te,i.cX,Me,Et,ze,nt,Xe,yt)}}}(m,p,l,r,l.layout.get("text-rotation-alignment"),l.layout.get("text-pitch-alignment"),x,U);const $=l.paint.get("icon-opacity").constantOr(1)!==0,Z=l.paint.get("text-opacity").constantOr(1)!==0;l.layout.get("symbol-sort-key").constantOr(1)!==void 0&&($||Z)?Lc(p,r,l,m,w,A):($&&Lc(p,r,l,m,w,A,{onlyIcons:!0}),Z&&Lc(p,r,l,m,w,A,{onlyText:!0})),r.map.showCollisionBoxes&&(Bh(p,r,l,m,l.paint.get("text-translate"),l.paint.get("text-translate-anchor"),!0),Bh(p,r,l,m,l.paint.get("icon-translate"),l.paint.get("icon-translate-anchor"),!1))},circle:function(p,r,l,m){if(p.renderPass!=="translucent")return;const x=l.paint.get("circle-opacity"),w=l.paint.get("circle-stroke-width"),A=l.paint.get("circle-stroke-opacity"),D=l.layout.get("circle-sort-key").constantOr(1)!==void 0,N=l.paint.get("circle-emissive-strength");if(x.constantOr(1)===0&&(w.constantOr(1)===0||A.constantOr(1)===0))return;const U=p.context,$=U.gl,Z=p.transform,W=p.depthModeForSublayer(0,Tn.ReadOnly),te=Dn.disabled,ue=p.colorModeForDrapableLayerRenderPass(N),se=Z.projection.name==="globe",de=[i.at(Z.center.lng),i.aA(Z.center.lat)],he=[];for(let Pe=0;Pe<m.length;Pe++){const Me=m[Pe],Fe=r.getTile(Me),Re=Fe.getBucket(l);if(!Re||Re.projection.name!==Z.projection.name)continue;const ze=Re.programConfigurations.get(l.id),De=i.cY(l),$e=p.isTileAffectedByFog(Me);se&&De.push("PROJECTION_GLOBE_VIEW"),De.push("DEPTH_D24"),p.terrain&&Z.depthOcclusionForSymbolsAndCircles&&De.push("DEPTH_OCCLUSION");const Xe=p.getOrCreateProgram("circle",{config:ze,defines:De,overrideFog:$e}),ht=Re.layoutVertexBuffer,ot=Re.globeExtVertexBuffer,Et=Re.indexBuffer,yt=Z.projection.createInversionMatrix(Z,Me.canonical),nt={programConfiguration:ze,program:Xe,layoutVertexBuffer:ht,globeExtVertexBuffer:ot,indexBuffer:Et,uniformValues:i.cZ(p,Me,Fe,yt,de,l),tile:Fe};if(D){const pt=Re.segments.get();for(const Lt of pt)he.push({segments:new i.b7([Lt]),sortKey:Lt.sortKey,state:nt})}else he.push({segments:Re.segments,sortKey:0,state:nt})}D&&he.sort((Pe,Me)=>Pe.sortKey-Me.sortKey);const Te={useDepthForOcclusion:Z.depthOcclusionForSymbolsAndCircles};for(const Pe of he){const{programConfiguration:Me,program:Fe,layoutVertexBuffer:Re,globeExtVertexBuffer:ze,indexBuffer:De,uniformValues:$e,tile:Xe}=Pe.state,ht=Pe.segments;p.terrain&&p.terrain.setupElevationDraw(Xe,Fe,Te),p.uploadCommonUniforms(U,Fe,Xe.tileID.toUnwrapped()),Fe.draw(p,$.TRIANGLES,W,te,ue,Rn.disabled,$e,l.id,Re,De,ht,l.paint,Z.zoom,Me,[ze])}},heatmap:function(p,r,l,m){if(l.paint.get("heatmap-opacity")!==0)if(p.renderPass==="offscreen"){const x=p.context,w=x.gl,A=Dn.disabled,D=new Jn([w.ONE,w.ONE,w.ONE,w.ONE],i.aj.transparent,[!0,!0,!0,!0]);(function(te,ue,se,de){const he=te.gl,Te=ue.width*de,Pe=ue.height*de;te.activeTexture.set(he.TEXTURE1),te.viewport.set([0,0,Te,Pe]);let Me=se.heatmapFbo;if(!Me||Me&&(Me.width!==Te||Me.height!==Pe)){Me&&Me.destroy();const Fe=he.createTexture();he.bindTexture(he.TEXTURE_2D,Fe),he.texParameteri(he.TEXTURE_2D,he.TEXTURE_WRAP_S,he.CLAMP_TO_EDGE),he.texParameteri(he.TEXTURE_2D,he.TEXTURE_WRAP_T,he.CLAMP_TO_EDGE),he.texParameteri(he.TEXTURE_2D,he.TEXTURE_MIN_FILTER,he.LINEAR),he.texParameteri(he.TEXTURE_2D,he.TEXTURE_MAG_FILTER,he.LINEAR),Me=se.heatmapFbo=te.createFramebuffer(Te,Pe,!0,null),function(Re,ze,De,$e,Xe,ht){const ot=Re.gl;ot.texImage2D(ot.TEXTURE_2D,0,Re.extRenderToTextureHalfFloat?ot.RGBA16F:ot.RGBA,Xe,ht,0,ot.RGBA,Re.extRenderToTextureHalfFloat?ot.HALF_FLOAT:ot.UNSIGNED_BYTE,null),$e.colorAttachment.set(De)}(te,0,Fe,Me,Te,Pe)}else he.bindTexture(he.TEXTURE_2D,Me.colorAttachment.get()),te.bindFramebuffer.set(Me.framebuffer)})(x,p,l,p.transform.projection.name==="globe"?.5:.25),x.clear({color:i.aj.transparent});const N=p.transform,U=N.projection.name==="globe",$=U?["PROJECTION_GLOBE_VIEW"]:[],Z=U?Rn.frontCCW:Rn.disabled,W=[i.at(N.center.lng),i.aA(N.center.lat)];for(let te=0;te<m.length;te++){const ue=m[te];if(r.hasRenderableParent(ue))continue;const se=r.getTile(ue),de=se.getBucket(l);if(!de||de.projection.name!==N.projection.name)continue;const he=p.isTileAffectedByFog(ue),Te=de.programConfigurations.get(l.id),Pe=p.getOrCreateProgram("heatmap",{config:Te,defines:$,overrideFog:he}),{zoom:Me}=p.transform;p.terrain&&p.terrain.setupElevationDraw(se,Pe),p.uploadCommonUniforms(x,Pe,ue.toUnwrapped());const Fe=N.projection.createInversionMatrix(N,ue.canonical);Pe.draw(p,w.TRIANGLES,Tn.disabled,A,D,Z,hn(p,ue,se,Fe,W,Me,l.paint.get("heatmap-intensity")),l.id,de.layoutVertexBuffer,de.indexBuffer,de.segments,l.paint,p.transform.zoom,Te,U?[de.globeExtVertexBuffer]:null)}x.viewport.set([0,0,p.width,p.height])}else p.renderPass==="translucent"&&(p.context.setColorMode(p.colorModeForRenderPass()),function(x,w){const A=x.context,D=A.gl,N=w.heatmapFbo;if(!N)return;A.activeTexture.set(D.TEXTURE0),D.bindTexture(D.TEXTURE_2D,N.colorAttachment.get()),A.activeTexture.set(D.TEXTURE1);let U=w.colorRampTexture;U||(U=w.colorRampTexture=new i.T(A,w.colorRamp,D.RGBA8)),U.bind(D.LINEAR,D.CLAMP_TO_EDGE),x.getOrCreateProgram("heatmapTexture").draw(x,D.TRIANGLES,Tn.disabled,Dn.disabled,x.colorModeForRenderPass(),Rn.disabled,(($,Z,W,te)=>({u_image:0,u_color_ramp:1,u_opacity:Z.paint.get("heatmap-opacity")}))(0,w),w.id,x.viewportBuffer,x.quadTriangleIndexBuffer,x.viewportSegments,w.paint,x.transform.zoom)}(p,l))},line:function(p,r,l,m){if(p.renderPass!=="translucent")return;const x=l.paint.get("line-opacity"),w=l.paint.get("line-width");if(x.constantOr(1)===0||w.constantOr(1)===0)return;const A=l.paint.get("line-emissive-strength"),D=l.paint.get("line-occlusion-opacity"),N=l.layout.get("line-elevation-reference"),U=l.layout.get("line-width-unit")==="meters",$=N==="sea",Z=p.context,W=Z.gl;if(l.hasElevatedBuckets&&p.transform.projection.name==="globe")return;const te=l.layout.get("line-cross-slope"),ue=te!==void 0,se=te<1,de=p.colorModeForDrapableLayerRenderPass(A),he=p.terrain&&p.terrain.renderingToTexture,Te=he?1:i.q.devicePixelRatio,Pe=l.paint.get("line-dasharray"),Me=Pe.constantOr(1),Fe=l.layout.get("line-cap"),Re=Pe.constantOr(null),ze=Fe.constantOr(null),De=l.paint.get("line-pattern"),$e=De.constantOr(1),Xe=De.constantOr(null),ht=l.paint.get("line-opacity").constantOr(1);let ot=!$e&&ht!==1||p.depthOcclusion&&D>0&&D<1;const Et=l.paint.get("line-gradient"),yt=$e?"linePattern":"line",nt=i.c_(l);let pt;if(he&&p.terrain&&p.terrain.clipOrMaskOverlapStencilType()&&(ot=!1),D!==0&&p.depthOcclusion){const tt=l.paint._values["line-opacity"];tt&&tt.value&&tt.value.kind==="constant"?pt=tt.value:i.w(`Occlusion opacity for layer ${l.id} is supported only when line-opacity isn't data-driven.`)}w.value.kind!=="constant"&&w.value.isLineProgressConstant===!1&&nt.push("VARIABLE_LINE_WIDTH");const Lt=(tt,St,mt,Gt,It)=>{for(const At of tt){const zt=r.getTile(At);if($e&&!zt.patternsLoaded())continue;const Wt=zt.getBucket(l);if(!Wt||Wt.hasZOffset&&!It||!Wt.hasZOffset&&It)continue;p.prepareDrawTile();const on=Wt.programConfigurations.get(l.id),dn=p.isTileAffectedByFog(At),En=p.getOrCreateProgram(yt,{config:on,defines:St,overrideFog:dn,overrideRtt:!It&&void 0});if(Xe&&zt.imageAtlas){const Fn=i.A.from(Xe).getPrimary().scaleSelf(Te).serialize(),mr=zt.imageAtlas.patternPositions[Fn];mr&&on.setConstantPatternPositions(mr)}if(!$e&&Re&&ze&&zt.lineAtlas){const Fn=zt.lineAtlas.getDash(Re,ze);Fn&&on.setConstantPatternPositions(Fn)}let[Sn,bn]=l.paint.get("line-trim-offset");(ze==="round"||ze==="square")&&Sn!==bn&&(Sn===0&&(Sn-=1),bn===1&&(bn+=1));const Ln=he?At.projMatrix:null,kn=U?1/Wt.tileToMeter/i.ar(zt,1,p.transform.zoom):1,Mr=U?1/Wt.tileToMeter/i.ar(zt,1,Math.floor(p.transform.zoom)):1,ui=$e?i.c$(p,zt,l,Ln,Te,kn,Mr,[Sn,bn]):i.d0(p,zt,l,Ln,Wt.lineClipsArray.length,Te,kn,Mr,[Sn,bn]);if(Et){const Fn=Wt.gradients[l.id];let mr=Fn.texture;if(l.gradientVersion!==Fn.version){let sn=256;if(l.stepInterpolant){const Pn=r.getSource().maxzoom,An=At.canonical.z===Pn?Math.ceil(1<<p.transform.maxZoom-At.canonical.z):1;sn=i.aw(i.d1(Wt.maxLineLength/i.ag*1024*An),256,Z.maxTextureSize)}Fn.gradient=i.d2({expression:l.gradientExpression(),evaluationKey:"lineProgress",resolution:sn,image:Fn.gradient||void 0,clips:Wt.lineClipsArray}),Fn.texture?Fn.texture.update(Fn.gradient):Fn.texture=new i.T(Z,Fn.gradient,W.RGBA8),Fn.version=l.gradientVersion,mr=Fn.texture}Z.activeTexture.set(W.TEXTURE1),mr.bind(l.stepInterpolant?W.NEAREST:W.LINEAR,W.CLAMP_TO_EDGE)}Me&&(Z.activeTexture.set(W.TEXTURE0),zt.lineAtlasTexture&&zt.lineAtlasTexture.bind(W.LINEAR,W.REPEAT),on.updatePaintBuffers()),$e&&(Z.activeTexture.set(W.TEXTURE0),zt.imageAtlasTexture&&zt.imageAtlasTexture.bind(W.LINEAR,W.CLAMP_TO_EDGE),on.updatePaintBuffers()),It&&!$&&p.terrain.setupElevationDraw(zt,En),p.uploadCommonUniforms(Z,En,At.toUnwrapped());const qr=Fn=>{pt!=null&&(pt.value=ht*D),En.draw(p,W.TRIANGLES,mt,Fn,de,Rn.disabled,ui,l.id,Wt.layoutVertexBuffer,Wt.indexBuffer,Wt.segments,l.paint,p.transform.zoom,on,[Wt.layoutVertexBuffer2,Wt.patternVertexBuffer,Wt.zOffsetVertexBuffer]),pt!=null&&(pt.value=ht)};if(ot&&!It){const Fn=p.stencilModeForClipping(At).ref;Fn===0&&he&&Z.clear({stencil:0});const mr={func:W.EQUAL,mask:255};ui.u_alpha_discard_threshold=.8,qr(new Dn(mr,Fn,255,W.KEEP,W.KEEP,W.INVERT)),ui.u_alpha_discard_threshold=0,qr(new Dn(mr,Fn,255,W.KEEP,W.KEEP,W.KEEP))}else ot&&It&&(ui.u_alpha_discard_threshold=.001),qr(It?Gt:p.stencilModeForClipping(At))}};if(l.hasNonElevatedBuckets){const tt=!he&&p.terrain;D!==0&&tt?i.w(`Occlusion opacity for layer ${l.id} is supported on terrain only if the layer has line-z-offset enabled.`):tt?i.w(`Cannot render non-elevated lines in immediate mode when terrain is enabled. Layer: ${l.id}.`):Lt(m,nt,p.depthModeForSublayer(0,Tn.ReadOnly),Dn.disabled,!1)}if(l.hasElevatedBuckets){nt.push("ELEVATED"),ue&&nt.push(se?"CROSS_SLOPE_HORIZONTAL":"CROSS_SLOPE_VERTICAL"),$&&nt.push("ELEVATION_REFERENCE_SEA");const tt=ot?p.stencilModeFor3D():Dn.disabled,St=new Tn(p.depthOcclusion?W.GREATER:W.LEQUAL,Tn.ReadOnly,p.depthRangeFor3D);p.forceTerrainMode=!0,Lt(m,nt,St,tt,!0),p.forceTerrainMode=!1}ot&&(p.resetStencilClippingMasks(),he&&Z.clear({stencil:0})),D===0||p.depthOcclusion||he||p.layersWithOcclusionOpacity.push(p.currentLayer)},fill:function(p,r,l,m){const x=l.paint.get("fill-color"),w=l.paint.get("fill-opacity"),A=l.is3D(),D=new Tn(p.context.gl.LEQUAL,Tn.ReadWrite,p.depthRangeFor3D);if(w.constantOr(1)===0)return;const N=l.paint.get("fill-emissive-strength"),U=p.colorModeForDrapableLayerRenderPass(N),$=l.paint.get("fill-pattern"),Z=p.opaquePassEnabledForLayer()&&!$.constantOr(1)&&x.constantOr(i.aj.transparent).a===1&&w.constantOr(0)===1?"opaque":"translucent";if(p.renderPass===Z){const W=A?D:p.depthModeForSublayer(1,p.renderPass==="opaque"?Tn.ReadWrite:Tn.ReadOnly);Vs(p,r,l,m,W,U,!1)}if(!A&&p.renderPass==="translucent"&&l.paint.get("fill-antialias")){const W=A?D:p.depthModeForSublayer(l.getPaintProperty("fill-outline-color")?2:0,Tn.ReadOnly);Vs(p,r,l,m,W,U,!0)}},"fill-extrusion":function(p,r,l,m){const x=l.paint.get("fill-extrusion-opacity"),w=p.context,A=w.gl,D=p.terrain,N=D&&D.renderingToTexture;if(x===0)return;const U=p.conflationActive&&p.style.isLayerClipped(l,r.getSource()),$=p.style.order.indexOf(l.fqid);if(U&&function(Z,W,te,ue,se){for(const de of ue){const he=W.getTile(de).getBucket(te);he&&(he.updateReplacement(de,Z.replacementSource,se),he.uploadCentroid(Z.context))}}(p,r,l,m,$),D||U)for(const Z of m){const W=r.getTile(Z).getBucket(l);W&&Bc(p.context,r,Z,W,l,D,U)}if(p.renderPass==="shadow"&&p.shadowRenderer){const Z=p.shadowRenderer;if(D&&x<.65&&l._transitionablePaint._values["fill-extrusion-opacity"].value.expression instanceof i.a9)return;const W=Z.getShadowPassDepthMode(),te=Z.getShadowPassColorMode();kc(p,r,l,m,W,Dn.disabled,te,U)}else if(p.renderPass==="translucent"){const Z=!l.paint.get("fill-extrusion-pattern").constantOr(1),W=l.paint.get("fill-extrusion-color").constantOr(i.aj.white);if(!N&&W.a!==0){const te=new Tn(p.context.gl.LEQUAL,Tn.ReadWrite,p.depthRangeFor3D);x===1&&Z?kc(p,r,l,m,te,Dn.disabled,Jn.unblended,U):(kc(p,r,l,m,te,Dn.disabled,Jn.disabled,U),kc(p,r,l,m,te,p.stencilModeFor3D(),p.colorModeForRenderPass(),U),p.resetStencilClippingMasks())}if(p.style.enable3dLights()&&Z&&(!D&&p.transform.projection.name!=="globe"||N)){const te=l.paint.get("fill-extrusion-opacity"),ue=l.paint.get("fill-extrusion-ambient-occlusion-intensity"),se=l.paint.get("fill-extrusion-ambient-occlusion-ground-radius"),de=l.paint.get("fill-extrusion-flood-light-intensity"),he=l.paint.get("fill-extrusion-flood-light-color-use-theme").constantOr("default")==="none",Te=l.paint.get("fill-extrusion-flood-light-color").toRenderColor(he?null:l.lut).toArray01().slice(0,3),Pe=ue>0&&se>0,Me=de>0,Fe=(ze,De,$e)=>(1-$e)*ze+$e*De,Re=ze=>{const De=p.depthModeForSublayer(1,Tn.ReadOnly,A.LEQUAL,!0),$e=l.paint.get(ze?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),Xe=Fe(.1,3,$e),ht=p._showOverdrawInspector;if(!ht){const ot=new Dn({func:A.ALWAYS,mask:255},255,255,A.KEEP,A.KEEP,A.REPLACE),Et=new Jn([A.ONE,A.ONE,A.ONE,A.ONE],i.aj.transparent,[!1,!1,!1,!0],A.MIN);zc(p,r,l,m,De,ot,Et,Rn.disabled,ze,"sdf",te,ue,se,de,Te,Xe,U,!1)}{const ot=ht?Dn.disabled:new Dn({func:A.EQUAL,mask:255},255,255,A.KEEP,A.DECR,A.DECR),Et=ht?p.colorModeForRenderPass():new Jn([A.ONE_MINUS_DST_ALPHA,A.DST_ALPHA,A.ONE,A.ONE],i.aj.transparent,[!0,!0,!0,!0]);zc(p,r,l,m,De,ot,Et,Rn.disabled,ze,"color",te,ue,se,de,Te,Xe,U,!1)}};if(N){const ze=(De,$e,Xe)=>{const ht=p.depthModeForSublayer(1,Tn.ReadOnly,A.LEQUAL,!1),ot=l.paint.get(De?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),Et=Fe(.1,3,ot);{const yt=new Jn([A.ONE,A.ONE,A.ONE,A.ONE],i.aj.transparent,[!1,!1,!1,!0]);zc(p,r,l,m,ht,Dn.disabled,yt,Rn.disabled,De,"clear",te,ue,se,de,Te,Et,U,$e)}{const yt=new Dn({func:A.ALWAYS,mask:255},255,255,A.KEEP,A.KEEP,A.REPLACE),nt=new Jn([A.ONE,A.ONE,A.ONE,A.ONE],i.aj.transparent,[!1,!1,!1,!0],A.MIN);zc(p,r,l,m,ht,yt,nt,Rn.disabled,De,"sdf",te,ue,se,de,Te,Et,U,$e)}{const yt=De?A.ZERO:A.ONE_MINUS_DST_ALPHA,nt=new Dn({func:A.EQUAL,mask:255},255,255,A.KEEP,A.DECR,A.DECR),pt=new Jn([yt,A.DST_ALPHA,A.ONE_MINUS_DST_ALPHA,A.ZERO],i.aj.transparent,[!0,!0,!0,!0]);zc(p,r,l,m,ht,nt,pt,Rn.disabled,De,"color",te,ue,se,de,Te,Et,U,$e)}{const yt=new Jn([A.ONE,A.ONE,A.ONE,De?A.ZERO:A.ONE],i.aj.transparent,[!1,!1,!1,!0],De?A.FUNC_ADD:A.MAX);zc(p,r,l,m,ht,Dn.disabled,yt,Rn.disabled,De,"clear",te,ue,se,de,Te,Et,U,$e,Xe)}};if(Pe||Me){let De;if(p.prepareDrawTile(),D){const $e=D.drapeBufferSize[0],Xe=D.drapeBufferSize[1];De=D.framebufferCopyTexture,De&&(!De||De.size[0]===$e&&De.size[1]===Xe)||(De&&De.destroy(),De=D.framebufferCopyTexture=new i.T(w,new i.r({width:$e,height:Xe}),A.RGBA8)),De.bind(A.LINEAR,A.CLAMP_TO_EDGE),A.copyTexSubImage2D(A.TEXTURE_2D,0,0,0,0,0,$e,Xe)}Pe&&ze(!0,!1,De),Me&&ze(!1,!0,De)}}else Pe&&Re(!0),Me&&Re(!1),(Pe||Me)&&p.resetStencilClippingMasks()}}},hillshade:function(p,r,l,m){if(p.renderPass!=="offscreen"&&p.renderPass!=="translucent"||p.style.disableElevatedTerrain)return;const x=p.context,w=p.terrain&&p.terrain.renderingToTexture,[A,D]=p.renderPass!=="translucent"||w?[{},m]:p.stencilConfigForOverlap(m);for(const N of D){const U=r.getTile(N);if(U.needsHillshadePrepare&&p.renderPass==="offscreen")Th(p,U,l);else if(p.renderPass==="translucent"){const $=p.depthModeForSublayer(0,Tn.ReadOnly),Z=l.paint.get("hillshade-emissive-strength"),W=p.colorModeForDrapableLayerRenderPass(Z),te=w&&p.terrain?p.terrain.stencilModeForRTTOverlap(N):A[N.overscaledZ];qo(p,N,U,l,$,te,W)}}x.viewport.set([0,0,p.width,p.height]),p.resetStencilClippingMasks()},raster:function(p,r,l,m,x,w){if(p.renderPass!=="translucent"||l.paint.get("raster-opacity")===0)return;const A=p.transform.projection.name==="globe",D=l.paint.get("raster-elevation")!==0,N=D&&A;if(p.renderElevatedRasterBackface&&!N)return;const U=p.context,$=U.gl,Z=r.getSource(),W=function(Re,ze,De,$e){const Xe=ze.paint.get("raster-color"),ht=Re.type==="raster-array",ot=[],Et=ze.paint.get("raster-resampling"),yt=ze.paint.get("raster-color-mix");let nt=ze.paint.get("raster-color-range");const pt=[yt[0],yt[1],yt[2],0],Lt=yt[3];let tt=Et==="nearest"?$e.NEAREST:$e.LINEAR;if(ht&&(ot.push("RASTER_ARRAY"),Xe||ot.push("RASTER_COLOR"),Et==="linear"&&ot.push("RASTER_ARRAY_LINEAR"),tt=$e.NEAREST,!nt&&Re.rasterLayers)){const St=Re.rasterLayers.find(({id:mt})=>mt===ze.sourceLayer);St&&St.fields&&St.fields.range&&(nt=St.fields.range)}if(nt=nt||[0,1],Xe){ot.push("RASTER_COLOR"),De.activeTexture.set($e.TEXTURE2),ze.updateColorRamp(nt);let St=ze.colorRampTexture;St||(St=ze.colorRampTexture=new i.T(De,ze.colorRamp,$e.RGBA8)),St.bind($e.LINEAR,$e.CLAMP_TO_EDGE)}return{mix:pt,range:nt,offset:Lt,defines:ot,resampling:tt}}(Z,l,U,$);if(Z instanceof i.aJ&&!m.length&&!A)return;const te=l.paint.get("raster-emissive-strength"),ue=p.colorModeForDrapableLayerRenderPass(te),se=p.terrain&&p.terrain.renderingToTexture,de=!p.options.moving,he=l.paint.get("raster-resampling")==="nearest"?$.NEAREST:$.LINEAR;if(Z instanceof i.aJ&&!m.length&&(Z.onNorthPole||Z.onSouthPole)){const Re=D?p.stencilModeFor3D():Dn.disabled;return void st(!!Z.onNorthPole,null,p,r,l,te,W,Rn.disabled,Re)}if(!m.length)return;const[Te,Pe]=Z instanceof i.aJ||se?[{},m]:p.stencilConfigForOverlap(m),Me=Pe[Pe.length-1].overscaledZ;N&&W.defines.push("PROJECTION_GLOBE_VIEW"),D&&W.defines.push("RENDER_CUTOFF");const Fe=(Re,ze,De)=>{for(const $e of Re){const Xe=$e.toUnwrapped(),ht=r.getTile($e);if(se&&(!ht||!ht.hasData()))continue;U.activeTexture.set($.TEXTURE0);const ot=rd(ht,Z,l,W);if(!ot||!ot.texture)continue;const{texture:Et,mix:yt,offset:nt,tileSize:pt,buffer:Lt}=ot;let tt,St;se?(tt=Tn.disabled,St=$e.projMatrix):D?(tt=new Tn($.LEQUAL,Tn.ReadWrite,p.depthRangeFor3D),St=A?Float32Array.from(p.transform.expandedFarZProjMatrix):p.transform.calculateProjMatrix(Xe,de)):(tt=p.depthModeForSublayer($e.overscaledZ-Me,l.paint.get("raster-opacity")===1?Tn.ReadWrite:Tn.ReadOnly,$.LESS),St=p.transform.calculateProjMatrix(Xe,de));const mt=p.terrain&&se?p.terrain.stencilModeForRTTOverlap($e):Te[$e.overscaledZ],Gt=w?0:l.paint.get("raster-fade-duration");ht.registerFadeDuration(Gt);const It=r.findLoadedParent($e,0),At=eo(ht,It,r,p.transform,Gt);let zt,Wt;p.terrain&&p.terrain.prepareDrawTile(),U.activeTexture.set($.TEXTURE0),Et.bind(he,$.CLAMP_TO_EDGE),U.activeTexture.set($.TEXTURE1),It?(It.texture&&It.texture.bind(he,$.CLAMP_TO_EDGE),zt=Math.pow(2,It.tileID.overscaledZ-ht.tileID.overscaledZ),Wt=[ht.tileID.canonical.x*zt%1,ht.tileID.canonical.y*zt%1]):Et.bind(he,$.CLAMP_TO_EDGE),Et.useMipmap&&U.extTextureFilterAnisotropic&&p.transform.pitch>20&&$.texParameterf($.TEXTURE_2D,U.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,U.extTextureFilterAnisotropicMax);const on=p.transform;let dn;const En=D?Cp(on):[0,0,0,0];let Sn,bn,Ln,kn,Mr,ui=0;if(N&&Z instanceof i.aJ&&Z.coordinates.length>3)Sn=Float32Array.from(i.bb(i.cH(new i.bT(0,0,0)))),bn=Float32Array.from(on.globeMatrix),Ln=Float32Array.from(i.cD(on)),kn=[i.at(on.center.lng),i.aA(on.center.lat)],dn=Z.elevatedGlobePerspectiveTransform,Mr=Z.elevatedGlobeGridMatrix||new Float32Array(9);else if(N){const sn=i.cE($e.canonical);ui=i.cF(sn.getCenter().lat),Sn=Float32Array.from(i.bb(i.cH($e.canonical))),bn=Float32Array.from(on.globeMatrix),Ln=Float32Array.from(i.cD(on)),kn=[i.at(on.center.lng),i.aA(on.center.lat)],dn=[0,0],Mr=Float32Array.from(i.cG($e.canonical,sn,ui,on.worldSize/on._pixelsPerMercatorPixel))}else dn=Z instanceof i.aJ?Z.perspectiveTransform:[0,0],Sn=new Float32Array(16),bn=new Float32Array(9),Ln=new Float32Array(16),kn=[0,0],Mr=new Float32Array(9);const qr=Ul(St,Sn,bn,Ln,Mr,Wt||[0,0],i.ae(p.transform.zoom),kn,En,zt||1,At,l,dn,D?l.paint.get("raster-elevation"):0,2,yt,nt,W.range,pt,Lt,te),Fn=p.isTileAffectedByFog($e),mr=p.getOrCreateProgram("raster",{defines:W.defines,overrideFog:Fn});if(p.uploadCommonUniforms(U,mr,Xe),Z instanceof i.aJ){const sn=Z.elevatedGlobeVertexBuffer,Pn=Z.elevatedGlobeIndexBuffer;if(se||!A)Z.boundsBuffer&&Z.boundsSegments&&mr.draw(p,$.TRIANGLES,tt,Dn.disabled,ue,Rn.disabled,qr,l.id,Z.boundsBuffer,p.quadTriangleIndexBuffer,Z.boundsSegments);else if(sn&&Pn){const An=on.zoom<=i.c6?Z.elevatedGlobeSegments:Z.getSegmentsForLongitude(on.center.lng);An&&mr.draw(p,$.TRIANGLES,tt,Dn.disabled,ue,ze,qr,l.id,sn,Pn,An)}}else if(N){tt=new Tn($.LEQUAL,Tn.ReadOnly,p.depthRangeFor3D);const sn=p.globeSharedBuffers;if(sn){const[Pn,An,In]=sn.getGridBuffers(ui,!1);mr.draw(p,$.TRIANGLES,tt,De||mt,p.colorModeForRenderPass(),ze,qr,l.id,Pn,An,In)}}else{const{tileBoundsBuffer:sn,tileBoundsIndexBuffer:Pn,tileBoundsSegments:An}=p.getTileBoundsBuffers(ht);mr.draw(p,$.TRIANGLES,tt,mt,ue,Rn.disabled,qr,l.id,sn,Pn,An)}}if(!(Z instanceof i.aJ)&&N)for(const $e of Re){const Xe=$e.canonical.y===(1<<$e.canonical.z)-1;$e.canonical.y===0&&st(!0,$e,p,r,l,te,W,ze,De||Dn.disabled),Xe&&st(!1,$e,p,r,l,te,W,ze===Rn.frontCW?Rn.backCW:Rn.frontCW,De||Dn.disabled)}};N?Fe(Pe,p.renderElevatedRasterBackface?Rn.backCW:Rn.frontCW,p.stencilModeFor3D()):Fe(Pe,Rn.disabled,void 0),p.resetStencilClippingMasks()},"raster-particle":function(p,r,l,m,x,w){p.renderPass==="offscreen"&&function(A,D,N,U){if(!U.length)return;const $=A.context,Z=$.gl,W=D.getSource();if(!(W instanceof Ai))return;const te=Math.ceil(Math.sqrt(N.paint.get("raster-particle-count")));let ue=N.particlePositionRGBAImage;if(!ue||ue.width!==te){const Pe=function(Me){const Fe=Me*Me,Re=new Uint8Array(4*Fe),ze=function($e){return $e|=0,$e=Math.imul(2747636419^$e,2654435769),$e=Math.imul($e^$e>>>16,2654435769),(($e=Math.imul($e^$e>>>16,2654435769))>>>0)/4294967296},De=1/1.1;for(let $e=0;$e<Fe;$e++){const Xe=De*(ze(2*$e+0)+Yt),ht=De*(ze(2*$e+1)+Yt),ot=255*Xe%1,Et=255*ht%1,yt=ot,nt=ht-Et/255,pt=Et;Re[4*$e+0]=255*(Xe-ot/255),Re[4*$e+1]=255*yt,Re[4*$e+2]=255*nt,Re[4*$e+3]=255*pt}return Re}(te);ue=N.particlePositionRGBAImage=new i.r({width:te,height:te},Pe)}let se=N.particleFramebuffer;se?se.width!==te&&(se.destroy(),se=N.particleFramebuffer=$.createFramebuffer(te,te,!0,null)):se=N.particleFramebuffer=$.createFramebuffer(te,te,!0,null);const de=[];for(const Pe of U){const Me=D.getTile(Pe);if(!(Me instanceof Pl))continue;const Fe=qm(Me,W,N);if(!Fe)continue;const Re=[Me.tileSize,Me.tileSize];let ze=N.tileFramebuffer;ze||(ze=N.tileFramebuffer=$.createFramebuffer(Re[0],Re[1],!0,null));let De=Me.rasterParticleState;De||(De=Me.rasterParticleState=new $m($,Pe,Re,ue));const $e=De.update(N.lastInvalidatedAt);De.particleTextureDimension!==te&&De.updateParticleTexture(Pe,ue);const Xe=De.targetColorTexture;De.targetColorTexture=De.backgroundColorTexture,De.backgroundColorTexture=Xe;const ht=De.particleTexture0;De.particleTexture0=De.particleTexture1,De.particleTexture1=ht,de.push([Pe,Fe,De,$e])}if(de.length===0)return;const he=i.q.now(),Te=N.previousDrawTimestamp?.001*(he-N.previousDrawTimestamp):.0167;if(N.previousDrawTimestamp=he,N.hasColorMap()){$.activeTexture.set(Z.TEXTURE0+2);let Pe=N.colorRampTexture;Pe||(Pe=N.colorRampTexture=new i.T($,N.colorRamp,Z.RGBA8)),Pe.bind(Z.LINEAR,Z.CLAMP_TO_EDGE)}$.bindFramebuffer.set(N.tileFramebuffer.framebuffer),function(Pe,Me,Fe){const Re=Pe.context,ze=Re.gl,De=Me.tileFramebuffer;Re.activeTexture.set(ze.TEXTURE0);const $e={u_texture:0,u_opacity:1.05*(ht=Me.paint.get("raster-particle-fade-opacity-factor"))/(ht+.05)},Xe=Pe.getOrCreateProgram("rasterParticleTexture",{defines:[],overrideFog:!1});var ht;for(const ot of Fe){const[,,Et,yt]=ot;De.colorAttachment.set(Et.targetColorTexture.texture),Re.viewport.set([0,0,De.width,De.height]),Re.clear({color:i.aj.transparent}),yt&&(Et.backgroundColorTexture.bind(ze.NEAREST,ze.CLAMP_TO_EDGE),Xe.draw(Pe,ze.TRIANGLES,Tn.disabled,Dn.disabled,Jn.alphaBlended,Rn.disabled,$e,Me.id,Pe.viewportBuffer,Pe.quadTriangleIndexBuffer,Pe.viewportSegments))}}(A,N,de),function(Pe,Me,Fe,Re){const ze=Pe.context,De=ze.gl,$e=Fe.tileFramebuffer,Xe=Pe.transform.projection.name==="globe",ht=Fe.paint.get("raster-particle-max-speed");for(const ot of Re){const[Et,yt,nt]=ot;ze.activeTexture.set(De.TEXTURE0+0),yt.texture.bind(De.LINEAR,De.CLAMP_TO_EDGE),$e.colorAttachment.set(nt.targetColorTexture.texture);const pt=Pe.getOrCreateProgram("rasterParticleDraw",{defines:yt.defines,overrideFog:!1});ze.activeTexture.set(De.TEXTURE0+1);const Lt=yt.scalarData?[]:[0,1,2,3].map(mt=>i.d4[mt](Et));Lt.push(Et);const tt=Et.canonical.x,St=Et.canonical.y;for(const mt of Lt){const Gt=Me.getTile(Xe?mt.wrapped():mt);if(!Gt)continue;const It=Gt.rasterParticleState;if(!It)continue;const At=mt.canonical.x+(1<<mt.canonical.z)*(mt.wrap-Et.wrap),zt=mt.canonical.y;It.particleTexture0.bind(De.NEAREST,De.CLAMP_TO_EDGE);const Wt=oa(1,It.particleTexture0.size[0],[At-tt,zt-St],0,yt.texture.size,2,ht,yt.textureOffset,yt.scale,yt.offset);pt.draw(Pe,De.POINTS,Tn.disabled,Dn.disabled,Jn.alphaBlended,Rn.disabled,Wt,Fe.id,It.particleIndexBuffer,void 0,It.particleSegment)}}}(A,D,N,de),$.bindFramebuffer.set(N.particleFramebuffer.framebuffer),function(Pe,Me,Fe,Re){const ze=Pe.context,De=ze.gl,$e=Me.paint.get("raster-particle-max-speed"),Xe=Re*Me.paint.get("raster-particle-speed-factor")*.15,ht=function(Et){return Math.pow(Et,6)}(.01+1*Me.paint.get("raster-particle-reset-rate-factor")),ot=Me.particleFramebuffer;ze.viewport.set([0,0,ot.width,ot.height]);for(const Et of Fe){const[,yt,nt]=Et;ze.activeTexture.set(De.TEXTURE0+0),yt.texture.bind(De.LINEAR,De.CLAMP_TO_EDGE),ze.activeTexture.set(De.TEXTURE0+1);const pt=nt.particleTexture0;pt.bind(De.NEAREST,De.CLAMP_TO_EDGE);const Lt=Ap(1,pt.size[0],0,yt.texture.size,$e,Xe,ht,yt.textureOffset,yt.scale,yt.offset);ot.colorAttachment.set(nt.particleTexture1.texture),ze.clear({color:i.aj.transparent}),Pe.getOrCreateProgram("rasterParticleUpdate",{defines:yt.defines}).draw(Pe,De.TRIANGLES,Tn.disabled,Dn.disabled,Jn.unblended,Rn.disabled,Lt,Me.id,Pe.viewportBuffer,Pe.quadTriangleIndexBuffer,Pe.viewportSegments)}}(A,N,de,Te)}(p,r,l,m),p.renderPass==="translucent"&&(function(A,D,N,U,$){const Z=A.context,W=Z.gl,te=D.getSource().tileSize,ue=5*(1-i.ac(i.bY,i.bY+1,A.transform.zoom))*te+N.paint.get("raster-particle-elevation"),se=!A.options.moving,de=A.transform.projection.name==="globe";if(!U.length)return;const[he,Te]=A.stencilConfigForOverlap(U),Pe=[];de&&Pe.push("PROJECTION_GLOBE_VIEW");const Me=A.stencilModeFor3D();for(const Fe of Te){const Re=Fe.toUnwrapped(),ze=D.getTile(Fe);if(!ze.rasterParticleState)continue;const De=ze.rasterParticleState,$e=100;ze.registerFadeDuration($e);const Xe=D.findLoadedParent(Fe,0),ht=eo(ze,Xe,D,A.transform,$e);let ot,Et;A.terrain&&A.terrain.prepareDrawTile(),Z.activeTexture.set(W.TEXTURE0),De.targetColorTexture.bind(W.LINEAR,W.CLAMP_TO_EDGE),Z.activeTexture.set(W.TEXTURE1),Xe&&Xe.rasterParticleState?(Xe.rasterParticleState.targetColorTexture.bind(W.LINEAR,W.CLAMP_TO_EDGE),ot=Math.pow(2,Xe.tileID.overscaledZ-ze.tileID.overscaledZ),Et=[ze.tileID.canonical.x*ot%1,ze.tileID.canonical.y*ot%1]):De.targetColorTexture.bind(W.LINEAR,W.CLAMP_TO_EDGE);const yt=de?Float32Array.from(A.transform.expandedFarZProjMatrix):A.transform.calculateProjMatrix(Re,se),nt=A.transform,pt=Gm(nt),Lt=i.cE(Fe.canonical),tt=i.cF(Lt.getCenter().lat);let St,mt,Gt,It,At;de?(St=Float32Array.from(i.bb(i.cH(Fe.canonical))),mt=Float32Array.from(nt.globeMatrix),Gt=Float32Array.from(i.cD(nt)),It=[i.at(nt.center.lng),i.aA(nt.center.lat)],At=Float32Array.from(i.cG(Fe.canonical,Lt,tt,nt.worldSize/nt._pixelsPerMercatorPixel))):(St=new Float32Array(16),mt=new Float32Array(9),Gt=new Float32Array(16),It=[0,0],At=new Float32Array(9));const zt=ti(yt,St,mt,Gt,At,Et||[0,0],i.ae(A.transform.zoom),It,pt,ot||1,ht,ue),Wt=A.isTileAffectedByFog(Fe),on=A.getOrCreateProgram("rasterParticle",{defines:Pe,overrideFog:Wt});if(A.uploadCommonUniforms(Z,on,Re),de){const dn=new Tn(W.LEQUAL,Tn.ReadOnly,A.depthRangeFor3D),En=0,Sn=A.globeSharedBuffers;if(Sn){const[bn,Ln,kn]=Sn.getGridBuffers(tt,En!==0);on.draw(A,W.TRIANGLES,dn,Me,Jn.alphaBlended,A.renderElevatedRasterBackface?Rn.frontCCW:Rn.backCCW,zt,N.id,bn,Ln,kn)}}else{const dn=A.depthModeForSublayer(0,Tn.ReadOnly),En=he[Fe.overscaledZ],{tileBoundsBuffer:Sn,tileBoundsIndexBuffer:bn,tileBoundsSegments:Ln}=A.getTileBoundsBuffers(ze);on.draw(A,W.TRIANGLES,dn,En,Jn.alphaBlended,Rn.disabled,zt,N.id,Sn,bn,Ln)}}A.resetStencilClippingMasks()}(p,r,l,m),p.style.map.triggerRepaint())},background:function(p,r,l,m){const x=l.paint.get("background-color"),w=l.paint.get("background-color-use-theme").constantOr("default")==="none",A=l.paint.get("background-opacity"),D=l.paint.get("background-emissive-strength"),N=l.paint.get("background-pitch-alignment")==="viewport";if(A===0)return;const U=p.context,$=U.gl,Z=p.transform,W=Z.tileSize,te=l.paint.get("background-pattern");let ue;if(te!==void 0&&(te===null||(ue=p.imageManager.getPattern(te.toString(),l.scope,p.style.getLut(l.scope)),!ue)))return;const se=!te&&x.a===1&&A===1&&p.opaquePassEnabledForLayer()?"opaque":"translucent";if(p.renderPass!==se)return;const de=Dn.disabled,he=p.depthModeForSublayer(0,se==="opaque"?Tn.ReadWrite:Tn.ReadOnly),Te=p.colorModeForDrapableLayerRenderPass(D),Pe=te?"backgroundPattern":"background";let Me,Fe=m;if(Fe||(Me=p.getBackgroundTiles(),Fe=Object.values(Me).map(Re=>Re.tileID)),te&&(U.activeTexture.set($.TEXTURE0),p.imageManager.bind(p.context,l.scope)),N){const Re=p.getOrCreateProgram(Pe,{overrideFog:!1,overrideRtt:!0}),ze=new Float32Array(i.ab.mat4.identity([])),De=new i.aG(0,0,0,0,0),$e=te?zh(ze,D,A,p,0,l.scope,ue,N,{tileID:De,tileSize:W}):kh(ze,D,A,x.toRenderColor(w?null:l.lut));Re.draw(p,$.TRIANGLES,he,de,Te,Rn.disabled,$e,l.id,p.viewportBuffer,p.quadTriangleIndexBuffer,p.viewportSegments)}else for(const Re of Fe){const ze=p.isTileAffectedByFog(Re),De=p.getOrCreateProgram(Pe,{overrideFog:ze}),$e=Re.toUnwrapped(),Xe=m?Re.projMatrix:p.transform.calculateProjMatrix($e);p.prepareDrawTile();const ht=r?r.getTile(Re):Me?Me[Re.key]:new Ol(Re,W,Z.zoom,p),ot=te?zh(Xe,D,A,p,0,l.scope,ue,N,{tileID:Re,tileSize:W}):kh(Xe,D,A,x.toRenderColor(w?null:l.lut));p.uploadCommonUniforms(U,De,$e);const{tileBoundsBuffer:Et,tileBoundsIndexBuffer:yt,tileBoundsSegments:nt}=p.getTileBoundsBuffers(ht);De.draw(p,$.TRIANGLES,he,de,Te,Rn.disabled,ot,l.id,Et,yt,nt)}},sky:function(p,r,l){const m=p._atmosphere?i.ae(p.transform.zoom):1,x=l.paint.get("sky-opacity")*m;if(x===0)return;const w=p.context,A=l.paint.get("sky-type"),D=new Tn(w.gl.LEQUAL,Tn.ReadOnly,[0,1]),N=p.frameCounter/1e3%1;A==="atmosphere"?p.renderPass==="offscreen"?l.needsSkyboxCapture(p)&&(function(U,$,Z,W){const te=U.context,ue=te.gl;let se=$.skyboxFbo;if(!se){se=$.skyboxFbo=te.createFramebuffer(32,32,!0,null),$.skyboxGeometry=new Wm(te),$.skyboxTexture=te.gl.createTexture(),ue.bindTexture(ue.TEXTURE_CUBE_MAP,$.skyboxTexture),ue.texParameteri(ue.TEXTURE_CUBE_MAP,ue.TEXTURE_WRAP_S,ue.CLAMP_TO_EDGE),ue.texParameteri(ue.TEXTURE_CUBE_MAP,ue.TEXTURE_WRAP_T,ue.CLAMP_TO_EDGE),ue.texParameteri(ue.TEXTURE_CUBE_MAP,ue.TEXTURE_MIN_FILTER,ue.LINEAR),ue.texParameteri(ue.TEXTURE_CUBE_MAP,ue.TEXTURE_MAG_FILTER,ue.LINEAR);for(let Pe=0;Pe<6;++Pe)ue.texImage2D(ue.TEXTURE_CUBE_MAP_POSITIVE_X+Pe,0,ue.RGBA,32,32,0,ue.RGBA,ue.UNSIGNED_BYTE,null)}te.bindFramebuffer.set(se.framebuffer),te.viewport.set([0,0,32,32]);const de=$.getCenter(U,!0),he=U.getOrCreateProgram("skyboxCapture"),Te=new Float64Array(16);i.ab.mat4.identity(Te),i.ab.mat4.rotateY(Te,Te,.5*-Math.PI),$i(U,$,he,Te,de,0),i.ab.mat4.identity(Te),i.ab.mat4.rotateY(Te,Te,.5*Math.PI),$i(U,$,he,Te,de,1),i.ab.mat4.identity(Te),i.ab.mat4.rotateX(Te,Te,.5*-Math.PI),$i(U,$,he,Te,de,2),i.ab.mat4.identity(Te),i.ab.mat4.rotateX(Te,Te,.5*Math.PI),$i(U,$,he,Te,de,3),i.ab.mat4.identity(Te),$i(U,$,he,Te,de,4),i.ab.mat4.identity(Te),i.ab.mat4.rotateY(Te,Te,Math.PI),$i(U,$,he,Te,de,5),te.viewport.set([0,0,U.width,U.height])}(p,l),l.markSkyboxValid(p)):p.renderPass==="sky"&&function(U,$,Z,W,te){const ue=U.context,se=ue.gl,de=U.transform,he=U.getOrCreateProgram("skybox");ue.activeTexture.set(se.TEXTURE0),se.bindTexture(se.TEXTURE_CUBE_MAP,$.skyboxTexture);const Te=((Pe,Me,Fe,Re,ze)=>({u_matrix:Pe,u_sun_direction:Me,u_cubemap:0,u_opacity:Re,u_temporal_offset:ze}))(de.skyboxMatrix,$.getCenter(U,!1),0,W,te);U.uploadCommonUniforms(ue,he),he.draw(U,se.TRIANGLES,Z,Dn.disabled,U.colorModeForRenderPass(),Rn.backCW,Te,"skybox",$.skyboxGeometry.vertexBuffer,$.skyboxGeometry.indexBuffer,$.skyboxGeometry.segment)}(p,l,D,x,N):A==="gradient"&&p.renderPass==="sky"&&function(U,$,Z,W,te){const ue=U.context,se=ue.gl,de=U.transform,he=U.getOrCreateProgram("skyboxGradient");$.skyboxGeometry||($.skyboxGeometry=new Wm(ue)),ue.activeTexture.set(se.TEXTURE0);let Te=$.colorRampTexture;Te||(Te=$.colorRampTexture=new i.T(ue,$.colorRamp,se.RGBA8)),Te.bind(se.LINEAR,se.CLAMP_TO_EDGE);const Pe=((Me,Fe,Re,ze,De)=>({u_matrix:Me,u_color_ramp:0,u_center_direction:Fe,u_radius:i.ai(Re),u_opacity:ze,u_temporal_offset:De}))(de.skyboxMatrix,$.getCenter(U,!1),$.paint.get("sky-gradient-radius"),W,te);U.uploadCommonUniforms(ue,he),he.draw(U,se.TRIANGLES,Z,Dn.disabled,U.colorModeForRenderPass(),Rn.backCW,Pe,"skyboxGradient",$.skyboxGeometry.vertexBuffer,$.skyboxGeometry.indexBuffer,$.skyboxGeometry.segment)}(p,l,D,x,N)},debug:function(p,r,l,m,x,w){for(let A=0;A<l.length;A++)if(x){const U=new i.aj(m.r*.8,m.g*.8,m.b*.8,1);Gl(p,r,l[A],m,-1,-1,w),Gl(p,r,l[A],m,-1,1,w),Gl(p,r,l[A],m,1,1,w),Gl(p,r,l[A],m,1,-1,w),Gl(p,r,l[A],U,0,0,w)}else Gl(p,r,l[A],m,0,0,w)},custom:function(p,r,l,m){const x=p.context,w=l.implementation;if(!p.transform.projection.unsupportedLayers||!p.transform.projection.unsupportedLayers.includes("custom")||p.terrain&&(p.terrain.renderingToTexture||p.renderPass==="offscreen")&&l.isDraped(r)){if(p.renderPass==="offscreen"){const A=w.prerender;if(A){if(p.setCustomLayerDefaults(),x.setColorMode(p.colorModeForRenderPass()),p.transform.projection.name==="globe"){const D=p.transform.pointMerc;A.call(w,x.gl,p.transform.customLayerMatrix(),p.transform.getProjection(),p.transform.globeToMercatorMatrix(),i.ae(p.transform.zoom),[D.x,D.y],p.transform.pixelsPerMeterRatio)}else A.call(w,x.gl,p.transform.customLayerMatrix());x.setDirty(),p.setBaseState()}}else if(p.renderPass==="translucent"){if(p.terrain&&p.terrain.renderingToTexture){const D=w.renderToTile;if(D){const N=m[0].canonical,U=new i.aa(N.x+m[0].wrap*(1<<N.z),N.y,N.z);x.setDepthMode(Tn.disabled),x.setStencilMode(Dn.disabled),x.setColorMode(p.colorModeForRenderPass()),p.setCustomLayerDefaults(),D.call(w,x.gl,U),x.setDirty(),p.setBaseState()}return}p.setCustomLayerDefaults(),x.setColorMode(p.colorModeForRenderPass()),x.setStencilMode(Dn.disabled);const A=w.renderingMode==="3d"?new Tn(p.context.gl.LEQUAL,Tn.ReadWrite,p.depthRangeFor3D):p.depthModeForSublayer(0,Tn.ReadOnly);if(x.setDepthMode(A),p.transform.projection.name==="globe"){const D=p.transform.pointMerc;w.render(x.gl,p.transform.customLayerMatrix(),p.transform.getProjection(),p.transform.globeToMercatorMatrix(),i.ae(p.transform.zoom),[D.x,D.y],p.transform.pixelsPerMeterRatio)}else w.render(x.gl,p.transform.customLayerMatrix());x.setDirty(),p.setBaseState(),x.bindFramebuffer.set(null)}}else i.w("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")},model:function(p,r,l,m){if(p.renderPass==="opaque")return;const x=l.paint.get("model-opacity").constantOr(1);if(x===0)return;const w=l.paint.get("model-cast-shadows");if(p.renderPass==="shadow"&&(!w||p.terrain&&x<.65&&l._transitionablePaint._values["model-opacity"].value.expression instanceof i.a9))return;const A=p.shadowRenderer,D=l.paint.get("model-receive-shadows");A&&(A.useNormalOffset=!0,D||(A.enabled=!1));const N=()=>{A&&(A.useNormalOffset=!0,D||(A.enabled=!0))},U=r.getSource();if(p.renderPass==="light-beam"&&U.type!=="batched-model")return;if(U.type==="vector"||U.type==="geojson")return function(he,Te,Pe,Me,Fe){const Re=he.transform;if(Re.projection.name!=="mercator")return void i.w(`Drawing 3D models for ${Re.projection.name} projection is not yet implemented`);const ze=Re.getFreeCameraOptions().position;if(!he.modelManager)return;const De=he.modelManager;Pe.modelManager=De;const $e=he.shadowRenderer;if(!Pe._unevaluatedLayout._values.hasOwnProperty("model-id"))return;const Xe=Pe._unevaluatedLayout._values["model-id"],ht=Object.assign({},Pe.layout.get("model-id").parameters),ot=he.style.order.indexOf(Pe.fqid);for(const Et of Me){const yt=Te.getTile(Et).getBucket(Pe);if(!yt||yt.projection.name!==Re.projection.name)continue;const nt=yt.getModelUris();nt&&!yt.modelsRequested&&(De.addModelsFromBucket(nt,Fe),yt.modelsRequested=!0);const pt=sd(Et,Re);ht.zoom=pt;const Lt=Xe.possiblyEvaluate(ht);if(ul(he,yt,Et),Sa.shadowUniformsInitialized=!1,Sa.useSingleShadowCascade=!!$e&&$e.getMaxCascadeForTile(Et.toUnwrapped())===0,he.renderPass==="shadow"&&$e){if(he.currentShadowCascade===1&&yt.isInsideFirstShadowMapFrustum)continue;const mt=Re.calculatePosMatrix(Et.toUnwrapped(),Re.worldSize);if(Sa.tileMatrix.set(mt),Sa.shadowTileMatrix=Float32Array.from($e.calculateShadowPassMatrixFromMatrix(mt)),Sa.aabb.min.fill(0),Sa.aabb.max[0]=Sa.aabb.max[1]=i.ag,Sa.aabb.max[2]=0,Pp(yt,Sa,he,Pe.scope))continue}const tt=1<<Et.canonical.z,St=[((ze.x-Et.wrap)*tt-Et.canonical.x)*i.ag,(ze.y*tt-Et.canonical.y)*i.ag,ze.z*tt*i.ag];he.conflationActive&&Object.keys(yt.instancesPerModel).length>0&&he.style.isLayerClipped(Pe,Te.getSource())&&yt.updateReplacement(Et,he.replacementSource,ot,Fe)&&(yt.uploaded=!1,yt.upload(he.context));for(let mt in yt.instancesPerModel){const Gt=yt.instancesPerModel[mt];Gt.features.length>0&&(mt=Lt.evaluate(Gt.features[0].feature,{}));const It=De.getModel(mt,Fe);if(It&&It.uploaded)for(const At of It.nodes)Uh(he,Pe,At,Gt,St,Et,Sa)}}}(p,r,l,m,U.type==="vector"?l.scope:""),void N();if(!U.loaded())return;if(U.type==="batched-model")return function(he,Te,Pe,Me){Pe.resetLayerRenderingStats(he);const Fe=he.context,Re=he.transform,ze=he.style.fog,De=he.shadowRenderer;if(Re.projection.name!=="mercator")return void i.w(`Drawing 3D landmark models for ${Re.projection.name} projection is not yet implemented`);const $e=he.transform.getFreeCameraOptions().position,Xe=i.ab.vec3.scale([],[$e.x,$e.y,$e.z],he.transform.worldSize),ht=i.ab.vec3.negate([],Xe),ot=i.ab.mat4.identity([]),Et=i.dj(Re.center.lat,Re.zoom),yt=i.ab.mat4.fromScaling([],[1,1,1/Et]);i.ab.mat4.translate(ot,ot,ht);const nt=Pe.paint.get("model-opacity").constantOr(1),pt=new Tn(Fe.gl.LEQUAL,Tn.ReadWrite,he.depthRangeFor3D),Lt=new Tn(Fe.gl.LEQUAL,Tn.ReadOnly,he.depthRangeFor3D),tt=new i.cd([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),St=he.renderPass==="shadow",mt=St&&De?De.getCurrentCascadeFrustum():Re.getFrustum(Re.scaleZoom(Re.worldSize)),Gt=Pe.paint.get("model-front-cutoff"),It=Gt[2]<1,At=_c(he,Pe.paint.get("model-cutoff-fade-range")),zt=Pe.getLayerRenderingStats();(function(Wt,on,dn,En){const Sn=Wt.terrain?Wt.terrain.exaggeration():0,bn=Wt.transform.zoom;for(const Ln of En){const kn=on.getTile(Ln).getBucket(dn);kn&&(Wt.conflationActive&&kn.updateReplacement(Ln,Wt.replacementSource),kn.evaluateScale(Wt,dn),Wt.terrain&&Sn>0&&kn.elevationUpdate(Wt.terrain,Sn,Ln,dn.source),kn.needsReEvaluation(Wt,bn,dn)&&kn.evaluate(dn))}})(he,Te,Pe,Me),function(){let Wt,on,dn;It?(Wt=Me.length-1,on=-1,dn=-1):(Wt=0,on=Me.length,dn=1);const En=new Float64Array(16),Sn=i.ab.vec3.create(),bn=new i.P(0,0);for(let Ln=Wt;Ln!==on;Ln+=dn){const kn=Me[Ln],Mr=Te.getTile(kn).getBucket(Pe);if(!Mr||!Mr.uploaded)continue;let ui=!1;De&&(ui=De.getMaxCascadeForTile(kn.toUnwrapped())===0);const qr=Re.calculatePosMatrix(kn.toUnwrapped(),Re.worldSize),Fn=Mr.modelTraits;!St&&It&&(i.ab.mat4.invert(En,qr),i.ab.vec3.transformMat4(Sn,Xe,En),bn.x=Sn[0],bn.y=Sn[1]);const mr=[];for(const sn of Mr.getNodesInfo()){if(sn.hiddenByReplacement||!sn.node.meshes)continue;const Pn=sn.node;let An=0;he.terrain&&Pn.elevation&&(An=Pn.elevation*he.terrain.exaggeration());const In=(()=>{const cr=sn.aabb;return tt.min=[...cr.min],tt.max=[...cr.max],tt.min[2]+=An,tt.max[2]+=An,i.ab.vec3.transformMat4(tt.min,tt.min,qr),i.ab.vec3.transformMat4(tt.max,tt.max,qr),tt})(),or=sn.evaluatedScale;if(or[0]<=1&&or[1]<=1&&or[2]<=1&&In.intersects(mt)===0)continue;if(!St&&It){const cr=.16666666666666666;sn.cameraCollisionOpacity=Xe[0]>In.min[0]&&Xe[0]<In.max[0]&&Xe[1]>In.min[1]&&Xe[1]<In.max[1]&&Xe[2]*Et<In.max[2]&&Pn.footprint&&i.bA(bn,Pn.footprint)?Math.max(sn.cameraCollisionOpacity-cr,0):Math.min(1,sn.cameraCollisionOpacity+cr)}const Gr=[...qr],Kr=Pn.anchor?Pn.anchor[0]:0,hi=Pn.anchor?Pn.anchor[1]:0;i.ab.mat4.translate(Gr,Gr,[Kr*(or[0]-1),hi*(or[1]-1),An]),i.ab.vec3.exactEquals(or,i.dm)||i.ab.mat4.scale(Gr,Gr,or);const yo=i.ab.mat4.multiply([],Gr,Pn.matrix),Ci=i.ab.mat4.multiply([],Re.expandedFarZProjMatrix,yo),hr=i.ab.mat4.multiply([],Re.expandedFarZProjMatrix,Gr),Er=i.ab.vec4.transformMat4([],[Kr,hi,An,1],Ci)[2];Pn.hidden=!1;let Tr=nt;St||(It&&(Tr*=sn.cameraCollisionOpacity,Tr*=Xm(Gr,Re,sn.aabb,Gt)),Tr*=Fc(At,Er)),Tr!==0?mr.push({nodeInfo:sn,depth:Er,opacity:Tr,wvpForNode:Ci,wvpForTile:hr,nodeModelMatrix:yo,tileModelMatrix:Gr}):Pn.hidden=!0}St||mr.sort((sn,Pn)=>!It||sn.opacity===1&&Pn.opacity===1?sn.depth<Pn.depth?-1:1:sn.opacity===1?-1:Pn.opacity===1?1:sn.depth>Pn.depth?-1:1);for(const sn of mr){const Pn=sn.nodeInfo,An=Pn.node;let In=i.ab.mat4.multiply([],yt,sn.tileModelMatrix);i.ab.mat4.multiply(In,ot,In);const or=i.ab.mat4.invert([],In);i.ab.mat4.transpose(or,or),i.ab.mat4.scale(or,or,ld),In=i.ab.mat4.multiply(In,In,An.matrix);const Gr=he.renderPass==="light-beam",Kr=Pe.paint.get("model-color-use-theme").constantOr("default")==="none",hi=Fn&i.dp.HasMapboxMeshFeatures,yo=hi?0:Pn.evaluatedRMEA[0][2];for(let Ci=0;Ci<An.meshes.length;++Ci){const hr=An.meshes[Ci],Er=Ci===An.lightMeshIndex;let Tr=sn.wvpForNode;if(Er){if(!Gr&&!he.terrain&&he.shadowRenderer){he.currentLayer<he.firstLightBeamLayer&&(he.firstLightBeamLayer=he.currentLayer);continue}Tr=sn.wvpForTile}else if(Gr)continue;const cr={defines:[]},Nr=[];if(!St&&De&&(De.useNormalOffset=!!hr.normalBuffer),ku(cr.defines,Nr,hr,he,Kr?null:Pe.lut),hi||cr.defines.push("DIFFUSE_SHADED"),ui&&cr.defines.push("SHADOWS_SINGLE_CASCADE"),zt&&(St?zt.numRenderedVerticesInShadowPass+=hr.vertexArray.length:zt.numRenderedVerticesInTransparentPass+=hr.vertexArray.length),St){jh(hr,sn.nodeModelMatrix,he,Pe);continue}let xi=null;if(ze){const Ko=cl(sn.nodeModelMatrix,he.transform);if(xi=new Float32Array(Ko),Re.projection.name!=="globe"){const Ea=hr.aabb.min,io=hr.aabb.max,[Jo,Ro]=ze.getOpacityForBounds(Ko,Ea[0],Ea[1],io[0],io[1]);cr.overrideFog=Jo>=je||Ro>=je}}const Or=hr.material;let bi;Or.occlusionTexture&&Or.occlusionTexture.offsetScale&&(bi=Or.occlusionTexture.offsetScale,cr.defines.push("OCCLUSION_TEXTURE_TRANSFORM"));const Io=he.getOrCreateProgram("model",cr);!St&&De&&De.setupShadowsFromMatrix(sn.tileModelMatrix,Io,De.useNormalOffset),he.uploadCommonUniforms(Fe,Io,null,xi);const ro=Or.pbrMetallicRoughness;ro.metallicFactor=.9,ro.roughnessFactor=.5;const ja=ed(new Float32Array(Tr),new Float32Array(In),new Float32Array(or),new Float32Array(An.matrix),he,sn.opacity,ro.baseColorFactor.toRenderColor(null),Or.emissiveFactor,ro.metallicFactor,ro.roughnessFactor,Or,yo,Pe,[0,0,0],bi);!Er&&(Pn.hasTranslucentParts||sn.opacity<1)&&Io.draw(he,Fe.gl.TRIANGLES,pt,Dn.disabled,Jn.disabled,Rn.backCCW,ja,Pe.id,hr.vertexBuffer,hr.indexBuffer,hr.segments,Pe.paint,he.transform.zoom,void 0,Nr),Io.draw(he,Fe.gl.TRIANGLES,Er?Lt:pt,Dn.disabled,Er||sn.opacity<1||Pn.hasTranslucentParts?Jn.alphaBlended:Jn.unblended,Rn.backCCW,ja,Pe.id,hr.vertexBuffer,hr.indexBuffer,hr.segments,Pe.paint,he.transform.zoom,void 0,Nr)}}}}()}(p,r,l,m),void N();if(U.type!=="model")return;const $=U.getModels(),Z=[],W=p.transform.getFreeCameraOptions().position,te=i.ab.vec3.scale([],[W.x,W.y,W.z],p.transform.worldSize);i.ab.vec3.negate(te,te);const ue=[],se=[];let de=0;for(const he of $){const Te=l.paint.get("model-rotation").constantOr(null),Pe=l.paint.get("model-scale").constantOr(null),Me=l.paint.get("model-translation").constantOr(null);he.computeModelMatrix(p,Te,Pe,Me,!0,!0,!1);const Fe=i.ab.mat4.identity([]),Re=i.dj(he.position.lat,p.transform.zoom),ze=i.ab.mat4.fromScaling([],[1,1,1/Re]);i.ab.mat4.translate(Fe,Fe,te),Z.push({zScaleMatrix:ze,negCameraPosMatrix:Fe});for(const De of he.nodes)od(p.transform,De,he.matrix,p.transform.expandedFarZProjMatrix,de,ue,se);de++}if(ue.sort((he,Te)=>Te.depth-he.depth),p.renderPass!=="shadow"){if(x===1)for(const he of se)$s(he,p,l,Z[he.modelIndex],Dn.disabled,p.colorModeForRenderPass());else{for(const he of se)$s(he,p,l,Z[he.modelIndex],Dn.disabled,Jn.disabled);for(const he of se)$s(he,p,l,Z[he.modelIndex],p.stencilModeFor3D(),p.colorModeForRenderPass());p.resetStencilClippingMasks()}for(const he of ue)$s(he,p,l,Z[he.modelIndex],Dn.disabled,p.colorModeForRenderPass());N()}else{for(const he of se)jh(he.mesh,he.nodeModelMatrix,p,l);for(const he of ue)jh(he.mesh,he.nodeModelMatrix,p,l);N()}}},qh={line:function(p,r,l){if(p.hasElevatedBuckets=!1,p.hasNonElevatedBuckets=!1,p._unevaluatedLayout.getValue("line-elevation-reference")!==void 0||p._unevaluatedLayout.getValue("line-z-offset")!==void 0){if(r){const m=r.getVisibleCoordinates();for(const x of m){const w=r.getTile(x).getBucket(p);if(w&&(w.hasZOffset?p.hasElevatedBuckets=!0:p.hasNonElevatedBuckets=!0,p.hasElevatedBuckets&&p.hasNonElevatedBuckets))break}}}else p.hasNonElevatedBuckets=!0},model:function(p,r,l){const m=r.getSource();if(!m.loaded())return;if(m.type==="vector"||m.type==="geojson")return void(l.modelManager&&l.modelManager.upload(l,m.type==="vector"?p.scope:""));if(m.type==="batched-model"||m.type!=="model")return;const x=m.getModels();for(const w of x)w.upload(l.context)},raster:function(p,r,l){const m=r.getSource();if(!(m instanceof Ai&&m.loaded()))return;const x=p.sourceLayer||m.rasterLayerIds&&m.rasterLayerIds[0];if(!x)return;const w=p.paint.get("raster-array-band")||m.getInitialBand(x);if(w==null)return;const A=r.getIds().map(D=>r.getTileByID(D));for(const D of A)D.updateNeeded(x,w)&&m.prepareTile(D,x,w)},"raster-particle":function(p,r,l){const m=r.getSource();if(!(m instanceof Ai&&m.loaded()))return;const x=p.sourceLayer||m.rasterLayerIds&&m.rasterLayerIds[0];if(!x)return;const w=p.paint.get("raster-particle-array-band")||m.getInitialBand(x);if(w==null)return;const A=r.getIds().map(D=>r.getTileByID(D));for(const D of A)D.updateNeeded(x,w)&&m.prepareTile(D,x,w)}};class Lp{constructor(r,l,m,x,w){this.context=new nd(r,l),this.transform=m,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.tp=w,this._timeStamp=i.q.now(),this._averageFPS=0,this._fpsHistory=[],this._dt=0,this._debugParams={forceEnablePrecipitation:!1,showTerrainProxyTiles:!1,fpsWindow:30,continousRedraw:!1,enabledLayers:{}};const A=["fill","line","symbol","circle","heatmap","fill-extrusion","raster","raster-particle","hillshade","model","background","sky"];for(const N of A)this._debugParams.enabledLayers[N]=!0;w.registerParameter(this._debugParams,["Terrain"],"showTerrainProxyTiles",{},()=>{this.style.map.triggerRepaint()}),w.registerParameter(this._debugParams,["Precipitation"],"forceEnablePrecipitation"),w.registerParameter(this._debugParams,["FPS"],"fpsWindow",{min:1,max:100,step:1}),w.registerBinding(this._debugParams,["FPS"],"continousRedraw",{readonly:!0,label:"continuous redraw"}),w.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"value"}),w.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"graph",view:"graph",min:0,max:200});for(const N of A)w.registerParameter(this._debugParams.enabledLayers,["Debug","Layers"],N);this.occlusionParams=new Uc(w),this.setup(),this.numSublayers=cs.maxUnderzooming+cs.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={},this.conflationActive=!1,this.replacementSource=new i.dv,this.longestCutoffRange=0,this.minCutoffZoom=0,this._fogVisible=!1,this._cachedTileFogOpacities={},this._shadowRenderer=new xa(this),this._wireframeDebugCache=new Ip,this.renderDefaultNorthPole=!0,this.renderDefaultSouthPole=!0,this.layersWithOcclusionOpacity=[];const D=new i.r({width:1,height:1},Uint8Array.of(0,0,0,0));this.emptyDepthTexture=new i.T(this.context,D,r.RGBA8),this._clippingActiveLastFrame=!1,this.scaleFactor=x}updateTerrain(r,l){const m=!!r&&!!r.terrain&&this.transform.projection.supportsTerrain;if(!(m||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new Go(this,r));const x=this._terrain;this.transform.elevation=m?x:null,x.update(r,this.transform,l),this.transform.elevation&&!x.enabled&&(this.transform.elevation=null)}_updateFog(r){const l=r.fog;if(!l||this.transform.projection.name==="globe"||l.getOpacity(this.transform.pitch)<1||l.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[m,x]=l.getFovAdjustedRange(this.transform._fov);if(m>x)return void(this.transform.fogCullDistSq=null);const w=m+.78*(x-m);this.transform.fogCullDistSq=w*w}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled||this._forceTerrainMode?this._terrain:null}get forceTerrainMode(){return this._forceTerrainMode}set forceTerrainMode(r){r&&!this._terrain&&(this._terrain=new Go(this,this.style)),this._forceTerrainMode=r}get shadowRenderer(){return this._shadowRenderer&&this._shadowRenderer.enabled?this._shadowRenderer:null}get wireframeDebugCache(){return this._wireframeDebugCache}resize(r,l){if(this.width=r*i.q.devicePixelRatio,this.height=l*i.q.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const m of this.style.order)this.style._mergedLayers[m].resize()}setup(){const r=this.context,l=new i.b4;l.emplaceBack(0,0),l.emplaceBack(i.ag,0),l.emplaceBack(0,i.ag),l.emplaceBack(i.ag,i.ag),this.tileExtentBuffer=r.createVertexBuffer(l,i.b6.members),this.tileExtentSegments=i.b7.simpleSegment(0,0,4,2);const m=new i.b4;m.emplaceBack(0,0),m.emplaceBack(i.ag,0),m.emplaceBack(0,i.ag),m.emplaceBack(i.ag,i.ag),this.debugBuffer=r.createVertexBuffer(m,i.b6.members),this.debugSegments=i.b7.simpleSegment(0,0,4,5);const x=new i.b4;x.emplaceBack(-1,-1),x.emplaceBack(1,-1),x.emplaceBack(-1,1),x.emplaceBack(1,1),this.viewportBuffer=r.createVertexBuffer(x,i.b6.members),this.viewportSegments=i.b7.simpleSegment(0,0,4,2);const w=new i.aT;w.emplaceBack(0,0,0,0),w.emplaceBack(i.ag,0,i.ag,0),w.emplaceBack(0,i.ag,0,i.ag),w.emplaceBack(i.ag,i.ag,i.ag,i.ag),this.mercatorBoundsBuffer=r.createVertexBuffer(w,i.b9.members),this.mercatorBoundsSegments=i.b7.simpleSegment(0,0,4,2);const A=new i.aU;A.emplaceBack(0,1,2),A.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=r.createIndexBuffer(A);const D=new i.b5;for(const U of[0,1,3,2,0])D.emplaceBack(U);this.debugIndexBuffer=r.createIndexBuffer(D),this.emptyTexture=new i.T(r,new i.r({width:1,height:1},Uint8Array.of(0,0,0,0)),r.gl.RGBA8),this.identityMat=i.ab.mat4.create();const N=this.context.gl;this.stencilClearMode=new Dn({func:N.ALWAYS,mask:0},0,255,N.ZERO,N.ZERO,N.ZERO),this.loadTimeStamps.push(performance.now())}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(r){return r._makeTileBoundsBuffers(this.context,this.transform.projection),r._tileBoundsBuffer?{tileBoundsBuffer:r._tileBoundsBuffer,tileBoundsIndexBuffer:r._tileBoundsIndexBuffer,tileBoundsSegments:r._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const r=this.context.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.getOrCreateProgram("clippingMask").draw(this,r.TRIANGLES,Tn.disabled,this.stencilClearMode,Jn.disabled,Rn.disabled,Ph(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(r,l,m){if(!l||this.currentStencilSource===l.id||!r.isTileClipped()||!m||m.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let D=!1;for(const N of m)if(this._tileClippingMaskIDs[N.key]===void 0){D=!0;break}if(!D)return}this.currentStencilSource=l.id;const x=this.context,w=x.gl;this.nextStencilID+m.length>256&&this.clearStencil(),x.setColorMode(Jn.disabled),x.setDepthMode(Tn.disabled);const A=this.getOrCreateProgram("clippingMask");this._tileClippingMaskIDs={};for(const D of m){const N=l.getTile(D),U=this._tileClippingMaskIDs[D.key]=this.nextStencilID++,{tileBoundsBuffer:$,tileBoundsIndexBuffer:Z,tileBoundsSegments:W}=this.getTileBoundsBuffers(N);A.draw(this,w.TRIANGLES,Tn.disabled,new Dn({func:w.ALWAYS,mask:0},U,255,w.KEEP,w.KEEP,w.REPLACE),Jn.disabled,Rn.disabled,Ph(D.projMatrix),"$clipping",$,Z,W)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const r=this.nextStencilID++,l=this.context.gl;return new Dn({func:l.NOTEQUAL,mask:255},r,255,l.KEEP,l.KEEP,l.REPLACE)}stencilModeForClipping(r){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(r);const l=this.context.gl;return new Dn({func:l.EQUAL,mask:255},this._tileClippingMaskIDs[r.key],0,l.KEEP,l.KEEP,l.REPLACE)}stencilConfigForOverlap(r){const l=this.context.gl,m=r.sort((A,D)=>D.overscaledZ-A.overscaledZ),x=m[m.length-1].overscaledZ,w=m[0].overscaledZ-x+1;if(w>1){this.currentStencilSource=void 0,this.nextStencilID+w>256&&this.clearStencil();const A={};for(let D=0;D<w;D++)A[D+x]=new Dn({func:l.GEQUAL,mask:255},D+this.nextStencilID,255,l.KEEP,l.KEEP,l.REPLACE);return this.nextStencilID+=w,[A,m]}return[{[x]:Dn.disabled},m]}colorModeForRenderPass(){const r=this.context.gl;return this._showOverdrawInspector?new Jn([r.CONSTANT_COLOR,r.ONE,r.CONSTANT_COLOR,r.ONE],new i.aj(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Jn.unblended:Jn.alphaBlended}colorModeForDrapableLayerRenderPass(r){const l=this.context.gl;return this.style&&this.style.enable3dLights()&&this.terrain&&this.terrain.renderingToTexture&&this.renderPass==="translucent"?new Jn([l.ONE,l.ONE_MINUS_SRC_ALPHA,l.CONSTANT_ALPHA,l.ONE_MINUS_SRC_ALPHA],new i.aj(0,0,0,r===void 0?0:r),[!0,!0,!0,!0]):this.colorModeForRenderPass()}depthModeForSublayer(r,l,m,x=!1){if(this.depthOcclusion)return new Tn(this.context.gl.GREATER,Tn.ReadOnly,this.depthRangeFor3D);if(!this.opaquePassEnabledForLayer()&&!x)return Tn.disabled;const w=1-((1+this.currentLayer)*this.numSublayers+r)*this.depthEpsilon;return new Tn(m||this.context.gl.LEQUAL,l,[w,w])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}blitDepth(){const r=this.context.gl,l=Math.ceil(this.width),m=Math.ceil(this.height),x=this.context.bindFramebuffer.get(),w=r.getParameter(r.TEXTURE_BINDING_2D);this.depthFBO&&this.depthFBO.width===l&&this.depthFBO.height===m||(this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),l!==0&&m!==0&&(this.depthFBO=new Um(this.context,l,m,!1,"texture"),this.depthTexture=new i.T(this.context,{width:l,height:m,data:null},r.DEPTH24_STENCIL8),this.depthFBO.depthAttachment.set(this.depthTexture.texture))),this.context.bindFramebuffer.set(x),r.bindTexture(r.TEXTURE_2D,w),this.depthFBO&&(r.bindFramebuffer(r.READ_FRAMEBUFFER,null),r.bindFramebuffer(r.DRAW_FRAMEBUFFER,this.depthFBO.framebuffer),r.blitFramebuffer(0,0,l,m,0,0,l,m,r.DEPTH_BUFFER_BIT,r.NEAREST),r.bindFramebuffer(r.FRAMEBUFFER,this.context.bindFramebuffer.current))}updateAverageFPS(){this._fpsHistory.push(this._dt===0?0:1e3/this._dt),this._fpsHistory.length>this._debugParams.fpsWindow&&this._fpsHistory.splice(0,this._fpsHistory.length-this._debugParams.fpsWindow),this._averageFPS=Math.round(this._fpsHistory.reduce((r,l)=>r+l/this._fpsHistory.length,0))}render(r,l){const m=i.q.now();this._dt=m-this._timeStamp,this._timeStamp=m,this._wireframeDebugCache.update(this.frameCounter),this._debugParams.continousRedraw=r.map.repaint,this.style=r,this.options=l;const x=this.style._mergedLayers,w=!(!this.terrain||!this.terrain.enabled),A=()=>this.style._getOrder(w).filter(nt=>{const pt=x[nt];return!(pt.type in this._debugParams.enabledLayers)||this._debugParams.enabledLayers[pt.type]});let D=A(),N=!1,U=!1;for(const nt of D){const pt=x[nt];pt.type==="circle"&&(N=!0),pt.type==="symbol"&&(pt.hasInitialOcclusionOpacityProperties?U=!0:N=!0)}let $=D.map(nt=>x[nt]);const Z=this.style._mergedSourceCaches;this.imageManager=r.imageManager,this.modelManager=r.modelManager,this.symbolFadeChange=r.placement.symbolFadeChange(i.q.now()),this.imageManager.beginFrame();let W=0,te=!1;for(const nt in Z){const pt=Z[nt];pt.used&&(pt.prepare(this.context),pt.getSource().usedInConflation&&++W)}let ue=!1;for(const nt of $)nt.isHidden(this.transform.zoom)||(nt.type==="clip"&&(ue=!0),this.prepareLayer(nt));const se={},de={},he={},Te={},Pe={};for(const nt in Z){const pt=Z[nt];se[nt]=pt.getVisibleCoordinates(),de[nt]=se[nt].slice().reverse(),he[nt]=pt.getVisibleCoordinates(!0).reverse(),Te[nt]=pt.getShadowCasterCoordinates(),Pe[nt]=pt.sortCoordinatesByDistance(se[nt])}const Me=nt=>{const pt=this.style.getLayerSourceCache(nt);return pt&&pt.used?pt.getSource():null};if(W||ue||this._clippingActiveLastFrame){const nt=[],pt=[];let Lt=0;for(const tt of $)this.isSourceForClippingOrConflation(tt,Me(tt))&&(nt.push(tt),pt.push(Lt)),Lt++;if(nt&&(ue||nt.length>1)||this._clippingActiveLastFrame){ue=!1;const tt=[];for(let St=0;St<nt.length;St++){const mt=nt[St],Gt=pt[St],It=this.style.getLayerSourceCache(mt);if(!It||!It.used||!It.getSource().usedInConflation&&mt.type!=="clip")continue;let At=i.dx,zt=i.by.None;const Wt=[];let on=!0;if(mt.type==="clip"){At=Gt;for(const dn of mt.layout.get("clip-layer-types"))zt|=dn==="model"?i.by.Model:dn==="symbol"?i.by.Symbol:i.by.FillExtrusion;for(const dn of mt.layout.get("clip-layer-scope"))Wt.push(dn);mt.isHidden(this.transform.zoom)?on=!1:ue=!0}on&&tt.push({layer:mt.fqid,cache:It,order:At,clipMask:zt,clipScope:Wt})}this.replacementSource.setSources(tt),te=!0}}this._clippingActiveLastFrame=ue,te||this.replacementSource.clear(),this.conflationActive=te,this.minCutoffZoom=0,this.longestCutoffRange=0,this.opaquePassCutoff=1/0,this._lastOcclusionLayer=-1,this.layersWithOcclusionOpacity=[];for(let nt=0;nt<$.length;nt++){const pt=$[nt],Lt=pt.cutoffRange();if(this.longestCutoffRange=Math.max(Lt,this.longestCutoffRange),Lt>0){const tt=Me(pt);tt&&(this.minCutoffZoom=Math.max(tt.minzoom,this.minCutoffZoom)),pt.minzoom&&(this.minCutoffZoom=Math.max(pt.minzoom,this.minCutoffZoom))}pt.is3D()&&(this.opaquePassCutoff===1/0&&(this.opaquePassCutoff=nt),this._lastOcclusionLayer=nt)}const Fe=this.style&&this.style.fog;Fe?(this._fogVisible=Fe.getOpacity(this.transform.pitch)!==0,this._fogVisible&&this.transform.projection.name!=="globe"&&(this._fogVisible=Fe.isVisibleOnFrustum(this.transform.cameraFrustum))):this._fogVisible=!1,this._cachedTileFogOpacities={},this.terrain&&(this.terrain.updateTileBinding(he),this.opaquePassCutoff=0,D=A(),$=D.map(nt=>x[nt]));const Re=this._shadowRenderer;if(Re){Re.updateShadowParameters(this.transform,this.style.directionalLight);for(const nt in Z)for(const pt of se[nt]){let Lt={min:0,max:0};this.terrain&&(Lt=this.terrain.getMinMaxForTile(pt)||Lt),Re.addShadowReceiver(pt.toUnwrapped(),Lt.min,Lt.max)}}this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new i.dw(this.context)),this.style.fog&&this.transform.projection.supportsFog?(this._atmosphere||(this._atmosphere=new Op(this)),this._atmosphere.update(this)):this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0);const ze=this._debugParams.forceEnablePrecipitation||!(!this.style||!this.style.snow),De=this._debugParams.forceEnablePrecipitation||!(!this.style||!this.style.rain);if(ze&&!this._snow&&(this._snow=new Hl(this)),!ze&&this._snow&&(this._snow.destroy(),delete this._snow),De&&!this._rain&&(this._rain=new zu(this)),!De&&this._rain&&(this._rain.destroy(),delete this._rain),this._snow&&this._snow.update(this),this._rain&&this._rain.update(this),!Qn.has(this.context.gl))return;this.renderPass="offscreen";for(const nt of $){const pt=r.getLayerSourceCache(nt);if(!nt.hasOffscreenPass()||nt.isHidden(this.transform.zoom))continue;const Lt=pt?de[pt.id]:void 0;(nt.type==="custom"||nt.type==="raster"||nt.type==="raster-particle"||nt.isSky()||Lt&&Lt.length)&&this.renderLayer(this,pt,nt,Lt)}this.depthRangeFor3D=[0,1-($.length+2)*this.numSublayers*this.depthEpsilon],this._shadowRenderer&&(this.renderPass="shadow",this._shadowRenderer.drawShadowPass(this.style,Te)),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);const $e=this.transform.projection.name==="globe"||this.transform.isHorizonVisible(),Xe=(()=>{if(l.showOverdrawInspector)return i.aj.black;const nt=this.style.fog;if(nt&&this.transform.projection.supportsFog){const pt=this.style.getLut(nt.scope);if(!$e){const Lt=nt.properties.get("color-use-theme")==="none",tt=nt.properties.get("color").toRenderColor(Lt?null:pt).toArray01();return new i.aj(...tt)}if($e){const Lt=nt.properties.get("space-color-use-theme")==="none",tt=nt.properties.get("space-color").toRenderColor(Lt?null:pt).toArray01();return new i.aj(...tt)}}return i.aj.transparent})();if(this.context.clear({color:Xe,depth:1}),this.clearStencil(),this._showOverdrawInspector=l.showOverdrawInspector,this.renderPass="opaque",this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&$e&&this._atmosphere.drawStars(this,this.style.fog),!this.terrain)for(this.currentLayer=D.length-1;this.currentLayer>=0;this.currentLayer--){const nt=$[this.currentLayer],pt=r.getLayerSourceCache(nt);if(nt.isSky())continue;const Lt=pt?(nt.is3D()?Pe:de)[pt.id]:void 0;this._renderTileClippingMasks(nt,pt,Lt),this.renderLayer(this,pt,nt,Lt)}if(this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&$e&&this._atmosphere.drawAtmosphereGlow(this,this.style.fog),this.renderPass="sky",(!this._atmosphere||i.ae(this.transform.zoom)>0)&&(this.transform.projection.name==="globe"||this.transform.isHorizonVisible()))for(this.currentLayer=0;this.currentLayer<D.length;this.currentLayer++){const nt=$[this.currentLayer],pt=r.getLayerSourceCache(nt);nt.isSky()&&this.renderLayer(this,pt,nt,pt?de[pt.id]:void 0)}function ht(nt,pt){let Lt;return pt&&(Lt=(nt.type==="symbol"?he:nt.is3D()?Pe:de)[pt.id]),Lt}if(this.renderPass="translucent",this.transform.projection.name==="globe"){for(this.renderElevatedRasterBackface=!0,this.currentLayer=0;this.currentLayer<D.length;){const nt=$[this.currentLayer];if(nt.type==="raster"||nt.type==="raster-particle"){const pt=r.getLayerSourceCache(nt);this.renderLayer(this,pt,nt,ht(nt,pt))}++this.currentLayer}this.renderElevatedRasterBackface=!1}this.currentLayer=0,this.firstLightBeamLayer=Number.MAX_SAFE_INTEGER;let ot=0;Re&&(ot=Re.getShadowCastingLayerCount());let Et=!1,yt=-1;for(let nt=0;nt<D.length;++nt){const pt=$[nt];pt.isHidden(this.transform.zoom)||pt.is3D()&&(yt=nt)}for(U&&yt===-1&&(N=!0);this.currentLayer<D.length;){const nt=$[this.currentLayer],pt=r.getLayerSourceCache(nt);if(nt.isSky())++this.currentLayer;else if(this.terrain&&this.style.isLayerDraped(nt)){if(nt.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer),this._lastOcclusionLayer=Math.max(this.currentLayer,this._lastOcclusionLayer)}else{if(N&&!Et&&this.terrain&&!this.transform.isOrthographic&&(Et=!0,this.blitDepth()),U&&yt!==-1&&this.currentLayer===yt+1&&!this.transform.isOrthographic&&this.blitDepth(),nt.is3D()||this.terrain||this._renderTileClippingMasks(nt,pt,pt?se[pt.id]:void 0),this.renderLayer(this,pt,nt,ht(nt,pt)),!this.terrain&&Re&&ot>0&&nt.hasShadowPass()&&--ot==0&&(Re.drawGroundShadows(),this.firstLightBeamLayer<=this.currentLayer)){const Lt=this.currentLayer;for(this.renderPass="light-beam",this.currentLayer=this.firstLightBeamLayer;this.currentLayer<=Lt;this.currentLayer++){const tt=$[this.currentLayer];if(!tt.hasLightBeamPass())continue;const St=r.getLayerSourceCache(tt);this.renderLayer(this,St,tt,St?de[St.id]:void 0)}this.currentLayer=Lt,this.renderPass="translucent"}if(this.currentLayer>=this._lastOcclusionLayer&&this.layersWithOcclusionOpacity.length>0){const Lt=this.currentLayer;this.depthOcclusion=!0;for(const tt of this.layersWithOcclusionOpacity){this.currentLayer=tt;const St=$[this.currentLayer],mt=r.getLayerSourceCache(St),Gt=mt?de[mt.id]:void 0;St.is3D()||this.terrain||this._renderTileClippingMasks(St,mt,mt?se[mt.id]:void 0),this.renderLayer(this,mt,St,Gt)}this.depthOcclusion=!1,this.currentLayer=Lt,this.renderPass="translucent",this.layersWithOcclusionOpacity=[]}++this.currentLayer}}if(this.terrain&&this.terrain.postRender(),this._snow&&this._snow.draw(this),this._rain&&this._rain.draw(this),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let nt=null;$.forEach(pt=>{const Lt=r.getLayerSourceCache(pt);Lt&&!pt.isHidden(this.transform.zoom)&&Lt.getVisibleCoordinates().length&&(!nt||nt.getSource().maxzoom<Lt.getSource().maxzoom)&&(nt=Lt)}),nt&&this.options.showTileBoundaries&&Vc.debug(this,nt,nt.getVisibleCoordinates(),i.aj.red,!1,this.options.showParseStatus)}this.terrain&&this._debugParams.showTerrainProxyTiles&&Vc.debug(this,this.terrain.proxySourceCache,this.terrain.proxyCoords,new i.aj(1,.8,.1,1),!0,this.options.showParseStatus),this.options.showPadding&&function(nt){const pt=nt.transform.padding;Zm(nt,nt.transform.height-(pt.top||0),3,Nc),Zm(nt,pt.bottom||0,3,p_),Mp(nt,pt.left||0,3,m_),Mp(nt,nt.transform.width-(pt.right||0),3,Hm);const Lt=nt.transform.centerPoint;(function(tt,St,mt,Gt){ys(tt,St-1,mt-10,2,20,Gt),ys(tt,St-10,mt-1,20,2,Gt)})(nt,Lt.x,nt.transform.height-Lt.y,id)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(performance.now()),this.saveCanvasCopy()),te||(this.conflationActive=!1)}prepareLayer(r){this.gpuTimingStart(r);const{unsupportedLayers:l}=this.transform.projection,m=!l||!l.includes(r.type);if(qh[r.type]&&(m||this.terrain&&r.type==="custom")){const x=this.style.getLayerSourceCache(r);qh[r.type](r,x,this)}this.gpuTimingEnd()}renderLayer(r,l,m,x){m.isHidden(this.transform.zoom)||(m.type==="background"||m.type==="sky"||m.type==="custom"||m.type==="model"||m.type==="raster"||m.type==="raster-particle"||x&&x.length)&&(this.id=m.id,this.gpuTimingStart(m),r.transform.projection.unsupportedLayers&&r.transform.projection.unsupportedLayers.includes(m.type)&&(!r.terrain||m.type!=="custom")||m.type==="clip"||Vc[m.type](r,l,m,x,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(r){if(!this.options.gpuTiming)return;const l=this.context.extTimerQuery,m=this.context.gl;let x=this.gpuTimers[r.id];x||(x=this.gpuTimers[r.id]={calls:0,cpuTime:0,query:m.createQuery()}),x.calls++,m.beginQuery(l.TIME_ELAPSED_EXT,x.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const r=this.context.extTimerQuery,l=this.context.gl,m=l.createQuery();this.deferredRenderGpuTimeQueries.push(m),l.beginQuery(r.TIME_ELAPSED_EXT,m)}}gpuTimingDeferredRenderEnd(){this.options.gpuTimingDeferredRender&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}gpuTimingEnd(){this.options.gpuTiming&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}collectGpuTimers(){const r=this.gpuTimers;return this.gpuTimers={},r}collectDeferredRenderGpuQueries(){const r=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],r}queryGpuTimers(r){const l={};for(const m in r){const x=r[m],w=this.context.extTimerQuery,A=w.getQueryParameter(x.query,this.context.gl.QUERY_RESULT)/1e6;w.deleteQueryEXT(x.query),l[m]=A}return l}queryGpuTimeDeferredRender(r){if(!this.options.gpuTimingDeferredRender)return 0;const l=this.context.gl;let m=0;for(const x of r)m+=l.getQueryParameter(x,l.QUERY_RESULT)/1e6,l.deleteQuery(x);return m}translatePosMatrix(r,l,m,x,w){if(!m[0]&&!m[1])return r;const A=w?x==="map"?this.transform.angle:0:x==="viewport"?-this.transform.angle:0;if(A){const U=Math.sin(A),$=Math.cos(A);m=[m[0]*$-m[1]*U,m[0]*U+m[1]*$]}const D=[w?m[0]:i.ar(l,m[0],this.transform.zoom),w?m[1]:i.ar(l,m[1],this.transform.zoom),0],N=new Float32Array(16);return i.ab.mat4.translate(N,r,D),N}saveTileTexture(r){const l=r.size[0],m=this._tileTextures[l];m?m.push(r):this._tileTextures[l]=[r]}getTileTexture(r){const l=this._tileTextures[r];return l&&l.length>0?l.pop():null}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture||this.forceTerrainMode}linearFloatFilteringSupported(){return this.context.extTextureFloatLinear!=null}currentGlobalDefines(r,l,m){const x=m===void 0?this.terrain&&this.terrain.renderingToTexture:m,w=[];return this.style&&this.style.enable3dLights()&&(r==="globeRaster"||r==="terrainRaster"?(w.push("LIGHTING_3D_MODE"),w.push("LIGHTING_3D_ALPHA_EMISSIVENESS")):x||w.push("LIGHTING_3D_MODE")),this.renderPass==="shadow"&&(this._shadowMapDebug||w.push("DEPTH_TEXTURE")),this.terrainRenderModeElevated()&&(w.push("TERRAIN"),this.linearFloatFilteringSupported()&&w.push("TERRAIN_DEM_FLOAT_FORMAT")),this.transform.projection.name==="globe"&&w.push("GLOBE"),!this._fogVisible||x||l!==void 0&&!l||w.push("FOG","FOG_DITHERING"),x&&w.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&w.push("OVERDRAW_INSPECTOR"),w}getOrCreateProgram(r,l){this.cache=this.cache||{};const m=l&&l.defines||[],x=l&&l.config,w=this.currentGlobalDefines(r,l&&l.overrideFog,l&&l.overrideRtt).concat(m),A=h_.cacheKey($o[r],r,w,x);return this.cache[A]||(this.cache[A]=new h_(this.context,r,$o[r],x,td[r],w)),this.cache[A]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const r=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(r.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new i.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA8))}destroy(){this._terrain&&this._terrain.destroy(),this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this._wireframeDebugCache.destroy(),this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),this.emptyDepthTexture&&this.emptyDepthTexture.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}uploadCommonLightUniforms(r,l){if(this.style.enable3dLights()){const m=this.style.directionalLight,x=this.style.ambientLight;if(m&&x){const w=((A,D,N)=>{const U=A.properties.get("direction"),$=A.properties.get("color-use-theme")==="none",Z=A.properties.get("color").toRenderColor($?null:N.getLut(A.scope)).toArray01(),W=A.properties.get("intensity"),te=D.properties.get("color-use-theme")==="none",ue=D.properties.get("color").toRenderColor(te?null:N.getLut(D.scope)).toArray01(),se=D.properties.get("intensity"),de=[U.x,U.y,U.z],he=i.cM(ue,se),Te=i.cM(Z,W);return{u_lighting_ambient_color:he,u_lighting_directional_dir:de,u_lighting_directional_color:Te,u_ground_radiance:Fl(de,Te,he)}})(m,x,this.style);l.setLightsUniformValues(r,w)}}}uploadCommonUniforms(r,l,m,x,w){if(this.uploadCommonLightUniforms(r,l),this.terrain&&this.terrain.renderingToTexture)return;const A=this.style.fog;if(A){const D=A.getOpacity(this.transform.pitch),N=((U,$,Z,W,te,ue,se,de,he,Te,Pe,Me)=>{const Fe=U.transform,Re=$.properties.get("color-use-theme")==="none",ze=$.properties.get("color").toRenderColor(Re?null:U.style.getLut($.scope)).toArray01();ze[3]=W;const De=U.frameCounter/1e3%1,[$e,Xe]=$.properties.get("vertical-range");return{u_fog_matrix:Z?Fe.calculateFogTileMatrix(Z):Me||U.identityMat,u_fog_range:$.getFovAdjustedRange(Fe._fov),u_fog_color:ze,u_fog_horizon_blend:$.properties.get("horizon-blend"),u_fog_vertical_limit:[Math.min($e,Xe),Xe],u_fog_temporal_offset:De,u_frustum_tl:te,u_frustum_tr:ue,u_frustum_br:se,u_frustum_bl:de,u_globe_pos:he,u_globe_radius:Te,u_viewport:Pe,u_globe_transition:i.ae(Fe.zoom),u_is_globe:+(Fe.projection.name==="globe")}})(this,A,m,D,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*i.q.devicePixelRatio,this.transform.height*i.q.devicePixelRatio],x);l.setFogUniformValues(r,N)}w&&l.setCutoffUniformValues(r,w.uniformValues)}setTileLoadedFlag(r){this.tileLoaded=r}saveCanvasCopy(){const r=this.canvasCopy();r&&(this.frameCopies.push(r),this.tileLoaded=!1)}canvasCopy(){const r=this.context.gl,l=r.createTexture();return r.bindTexture(r.TEXTURE_2D,l),r.copyTexImage2D(r.TEXTURE_2D,0,r.RGBA,0,0,r.drawingBufferWidth,r.drawingBufferHeight,0),l}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const r=this.style&&this.style.fog;return!!r&&r.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const r=this._backgroundTiles,l=this._backgroundTiles={},m=this.transform.coveringTiles({tileSize:512});for(const x of m)l[x.key]=r[x.key]||new Ol(x,512,this.transform.tileZoom,this);return l}clearBackgroundTiles(){this._backgroundTiles={}}isSourceForClippingOrConflation(r,l){return!(!r.is3D()||r.type!=="clip"&&(r.minzoom&&r.minzoom>this.transform.zoom||(this.style._clipLayerPresent||r.sourceLayer!=="building")&&(!l||l.type!=="batched-model")))}isTileAffectedByFog(r){if(!this.style||!this.style.fog)return!1;if(this.transform.projection.name==="globe")return!0;let l=this._cachedTileFogOpacities[r.key];return l||(this._cachedTileFogOpacities[r.key]=l=this.style.fog.getOpacityForTile(r)),l[0]>=je||l[1]>=je}setupDepthForOcclusion(r,l,m){const x=this.context,w=x.gl,A=!!m;var D;m||(m={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0}),x.activeTexture.set(w.TEXTURE3),r&&this.depthFBO&&this.depthTexture?(this.depthTexture.bind(w.NEAREST,w.CLAMP_TO_EDGE),m.u_depth_size_inv=[1/this.depthFBO.width,1/this.depthFBO.height],m.u_depth_range_unpack=[2/((D=this.depthRangeFor3D)[1]-D[0]),-1-2*D[0]/(D[1]-D[0])],m.u_occluder_half_size=.5*this.occlusionParams.occluderSize,m.u_occlusion_depth_offset=this.occlusionParams.depthOffset):this.emptyDepthTexture.bind(w.NEAREST,w.CLAMP_TO_EDGE),x.activeTexture.set(w.TEXTURE0),A||l.setTerrainUniformValues(x,m)}}function ud(p,r){let l=!1,m=null;const x=()=>{m=null,l&&(p(),m=setTimeout(x,r),l=!1)};return()=>(l=!0,m||x(),m)}class hd{constructor(r){this._hashName=r&&encodeURIComponent(r),i.aP(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=ud(this._updateHashUnthrottled.bind(this),300)}addTo(r){return this._map=r,window.addEventListener("hashchange",this._onHashChange,!1),r.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const r=this._map;if(!r)return"";const l=kp(r);if(this._hashName){const m=this._hashName;let x=!1;const w=location.hash.slice(1).split("&").map(A=>{const D=A.split("=")[0];return D===m?(x=!0,`${D}=${l}`):A}).filter(A=>A);return x||w.push(`${m}=${l}`),`#${w.join("&")}`}return`#${l}`}_getCurrentHash(){const r=location.hash.replace("#","");if(this._hashName){let l;return r.split("&").map(m=>m.split("=")).forEach(m=>{m[0]===this._hashName&&(l=m)}),(l&&l[1]||"").split("/")}return r.split("/")}_onHashChange(){const r=this._map;if(!r)return!1;const l=this._getCurrentHash();if(l.length>=3&&!l.some(m=>isNaN(m))){const m=r.dragRotate.isEnabled()&&r.touchZoomRotate.isEnabled()?+(l[3]||0):r.getBearing();return r.jumpTo({center:[+l[2],+l[1]],zoom:+l[0],bearing:m,pitch:+(l[4]||0)}),!0}return!1}_updateHashUnthrottled(){history.replaceState(history.state,"",location.href.replace(/(#.+)?$/,this.getHashString()))}}function kp(p,r){const l=p.getCenter(),m=Math.round(100*p.getZoom())/100,x=Math.ceil((m*Math.LN2+Math.log(512/360/.5))/Math.LN10),w=Math.pow(10,x),A=Math.round(l.lng*w)/w,D=Math.round(l.lat*w)/w,N=p.getBearing(),U=p.getPitch();let $=r?`/${A}/${D}/${m}`:`${m}/${D}/${A}`;return(N||U)&&($+="/"+Math.round(10*N)/10),U&&($+=`/${Math.round(U)}`),$}const Bu={linearity:.3,easing:i.dy(0,0,.3,1)},Ym=i.l({deceleration:2500,maxSpeed:1400},Bu),Km=i.l({deceleration:20,maxSpeed:1400},Bu),g_=i.l({deceleration:1e3,maxSpeed:360},Bu),Jm=i.l({deceleration:1e3,maxSpeed:90},Bu);class Ta{constructor(r){this._map=r,this.clear()}clear(){this._inertiaBuffer=[]}record(r){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:i.q.now(),settings:r})}_drainInertiaBuffer(){const r=this._inertiaBuffer,l=i.q.now();for(;r.length>0&&l-r[0].time>160;)r.shift()}_onMoveEnd(r){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const l={zoom:0,bearing:0,pitch:0,pan:new i.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:w}of this._inertiaBuffer)l.zoom+=w.zoomDelta||0,l.bearing+=w.bearingDelta||0,l.pitch+=w.pitchDelta||0,w.panDelta&&l.pan._add(w.panDelta),w.around&&(l.around=w.around),w.pinchAround&&(l.pinchAround=w.pinchAround);const m=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,x={};if(l.pan.mag()){const w=Gh(l.pan.mag(),m,i.l({},Ym,r||{}));x.offset=l.pan.mult(w.amount/l.pan.mag()),x.center=this._map.transform.center,Ji(x,w)}if(l.zoom){const w=Gh(l.zoom,m,Km);x.zoom=this._map.transform.zoom+w.amount,Ji(x,w)}if(l.bearing){const w=Gh(l.bearing,m,g_);x.bearing=this._map.transform.bearing+i.aw(w.amount,-179,179),Ji(x,w)}if(l.pitch){const w=Gh(l.pitch,m,Jm);x.pitch=this._map.transform.pitch+w.amount,Ji(x,w)}if(x.zoom||x.bearing){const w=l.pinchAround===void 0?l.around:l.pinchAround;x.around=w?this._map.unproject(w):this._map.getCenter()}return this.clear(),x.noMoveStart=!0,x}}function Ji(p,r){(!p.duration||p.duration<r.duration)&&(p.duration=r.duration,p.easing=r.easing)}function Gh(p,r,l){const{maxSpeed:m,linearity:x,deceleration:w}=l,A=i.aw(p*x/(r/1e3),-m,m),D=Math.abs(A)/(w*x);return{easing:l.easing,duration:1e3*D,amount:A*(D/2)}}class _o extends i.z{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,l,m,x={}){const w=Ge(l.getCanvasContainer(),m),A=l.unproject(w);super(r,i.l({point:w,lngLat:A,originalEvent:m},x)),this._defaultPrevented=!1,this.target=l}}class Hh extends i.z{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,l,m){const x=r==="touchend"?m.changedTouches:m.touches,w=He(l.getCanvasContainer(),x),A=w.map(N=>l.unproject(N)),D=w.reduce((N,U,$,Z)=>N.add(U.div(Z.length)),new i.P(0,0));super(r,{points:w,point:D,lngLats:A,lngLat:l.unproject(D),originalEvent:m}),this._defaultPrevented=!1}}class Qm extends i.z{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,l){super("wheel",{originalEvent:l}),this._defaultPrevented=!1}}class y_{constructor(r,l){this._map=r,this._clickTolerance=l.clickTolerance}reset(){this._mousedownPos=void 0}wheel(r){return this._firePreventable(new Qm(this._map,r))}mousedown(r,l){return this._mousedownPos=l,this._firePreventable(new _o(r.type,this._map,r))}mouseup(r){this._map.fire(new _o(r.type,this._map,r))}preclick(r){const l=i.l({},r);l.type="preclick",this._map.fire(new _o(l.type,this._map,l))}click(r,l){this._mousedownPos&&this._mousedownPos.dist(l)>=this._clickTolerance||(this.preclick(r),this._map.fire(new _o(r.type,this._map,r)))}dblclick(r){return this._firePreventable(new _o(r.type,this._map,r))}mouseover(r){this._map.fire(new _o(r.type,this._map,r))}mouseout(r){this._map.fire(new _o(r.type,this._map,r))}touchstart(r){return this._firePreventable(new Hh(r.type,this._map,r))}touchmove(r){this._map.fire(new Hh(r.type,this._map,r))}touchend(r){this._map.fire(new Hh(r.type,this._map,r))}touchcancel(r){this._map.fire(new Hh(r.type,this._map,r))}_firePreventable(r){if(this._map.fire(r),r.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class fd{constructor(r){this._map=r}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(r){this._map.fire(new _o(r.type,this._map,r))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new _o("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(r){this._delayContextMenu?this._contextMenuEvent=r:this._map.fire(new _o(r.type,this._map,r)),this._map.listens("contextmenu")&&r.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class ci{constructor(r,l){this._map=r,this._el=r.getCanvasContainer(),this._container=r.getContainer(),this._clickTolerance=l.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(r,l){this.isEnabled()&&r.shiftKey&&r.button===0&&(xe(),this._startPos=this._lastPos=l,this._active=!0)}mousemoveWindow(r,l){if(!this._active)return;const m=l,x=this._startPos,w=this._lastPos;if(!x||!w||w.equals(m)||!this._box&&m.dist(x)<this._clickTolerance)return;this._lastPos=m,this._box||(this._box=J("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",r));const A=Math.min(x.x,m.x),D=Math.max(x.x,m.x),N=Math.min(x.y,m.y),U=Math.max(x.y,m.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${A}px,${N}px)`,this._box.style.width=D-A+"px",this._box.style.height=U-N+"px")})}mouseupWindow(r,l){if(!this._active)return;const m=this._startPos,x=l;if(m&&r.button===0){if(this.reset(),we(),m.x!==x.x||m.y!==x.y)return this._map.fire(new i.z("boxzoomend",{originalEvent:r})),{cameraAnimation:w=>w.fitScreenCoordinates(m,x,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",r)}}keydown(r){this._active&&r.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",r))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),ae(),delete this._startPos,delete this._lastPos}_fireEvent(r,l){return this._map.fire(new i.z(r,{originalEvent:l}))}}function dd(p,r){const l={};for(let m=0;m<p.length;m++)l[p[m].identifier]=r[m];return l}class v_{constructor(r){this.reset(),this.numTouches=r.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(r,l,m){(this.centroid||m.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=r.timeStamp),m.length===this.numTouches&&(this.centroid=function(x){const w=new i.P(0,0);for(const A of x)w._add(A);return w.div(x.length)}(l),this.touches=dd(m,l)))}touchmove(r,l,m){if(this.aborted||!this.centroid)return;const x=dd(m,l);for(const w in this.touches){const A=x[w];(!A||A.dist(this.touches[w])>30)&&(this.aborted=!0)}}touchend(r,l,m){if((!this.centroid||r.timeStamp-this.startTime>500)&&(this.aborted=!0),m.length===0){const x=!this.aborted&&this.centroid;if(this.reset(),x)return x}}}class zp{constructor(r){this.singleTap=new v_(r),this.numTaps=r.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(r,l,m){this.singleTap.touchstart(r,l,m)}touchmove(r,l,m){this.singleTap.touchmove(r,l,m)}touchend(r,l,m){const x=this.singleTap.touchend(r,l,m);if(x){const w=r.timeStamp-this.lastTime<500,A=!this.lastTap||this.lastTap.dist(x)<30;if(w&&A||this.reset(),this.count++,this.lastTime=r.timeStamp,this.lastTap=x,this.count===this.numTaps)return this.reset(),x}}}class Nu{constructor(){this._zoomIn=new zp({numTouches:1,numTaps:2}),this._zoomOut=new zp({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(r,l,m){this._zoomIn.touchstart(r,l,m),this._zoomOut.touchstart(r,l,m)}touchmove(r,l,m){this._zoomIn.touchmove(r,l,m),this._zoomOut.touchmove(r,l,m)}touchend(r,l,m){const x=this._zoomIn.touchend(r,l,m),w=this._zoomOut.touchend(r,l,m);return x?(this._active=!0,r.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:A=>A.easeTo({duration:300,zoom:A.getZoom()+1,around:A.unproject(x)},{originalEvent:r})}):w?(this._active=!0,r.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:A=>A.easeTo({duration:300,zoom:A.getZoom()-1,around:A.unproject(w)},{originalEvent:r})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Bp={0:1,2:2};class Fu{constructor(r){this.reset(),this._clickTolerance=r.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(r,l){return!1}_move(r,l){return{}}mousedown(r,l){if(this._lastPoint)return;const m=ye(r);this._correctButton(r,m)&&(this._lastPoint=l,this._eventButton=m)}mousemoveWindow(r,l){const m=this._lastPoint;if(m){if(r.preventDefault(),this._eventButton!=null&&function(x,w){const A=Bp[w];return x.buttons===void 0||(x.buttons&A)!==A}(r,this._eventButton))this.reset();else if(this._moved||!(l.dist(m)<this._clickTolerance))return this._moved=!0,this._lastPoint=l,this._move(m,l)}}mouseupWindow(r){this._lastPoint&&ye(r)===this._eventButton&&(this._moved&&we(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class pd extends Fu{mousedown(r,l){super.mousedown(r,l),this._lastPoint&&(this._active=!0)}_correctButton(r,l){return l===0&&!r.ctrlKey}_move(r,l){return{around:l,panDelta:l.sub(r)}}}class ws extends Fu{_correctButton(r,l){return l===0&&r.ctrlKey||l===2}_move(r,l){const m=.8*(l.x-r.x);if(m)return this._active=!0,{bearingDelta:m}}contextmenu(r){r.preventDefault()}}class ju extends Fu{_correctButton(r,l){return l===0&&r.ctrlKey||l===2}_move(r,l){const m=-.5*(l.y-r.y);if(m)return this._active=!0,{pitchDelta:m}}contextmenu(r){r.preventDefault()}}class pi{constructor(r,l){this._map=r,this._el=r.getCanvasContainer(),this._minTouches=1,this._clickTolerance=l.clickTolerance||1,this.reset(),i.aP(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new i.P(0,0)}touchstart(r,l,m){return this._calculateTransform(r,l,m)}touchmove(r,l,m){if(this._active&&!(m.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(m.length===1&&!i.dz())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return r.cancelable&&r.preventDefault(),this._calculateTransform(r,l,m)}}touchend(r,l,m){this._calculateTransform(r,l,m),this._active&&m.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(r,l,m){m.length>0&&(this._active=!0);const x=dd(m,l),w=new i.P(0,0),A=new i.P(0,0);let D=0;for(const U in x){const $=x[U],Z=this._touches[U];Z&&(w._add($),A._add($.sub(Z)),D++,x[U]=$)}if(this._touches=x,D<this._minTouches||!A.mag())return;const N=A.div(D);return this._sum._add(N),this._sum.mag()<this._clickTolerance?void 0:{around:w.div(D),panDelta:N}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=J("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.removeAttribute("role")},500)}}class Zo{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(r){}_move(r,l,m){return{}}touchstart(r,l,m){this._firstTwoTouches||m.length<2||(this._firstTwoTouches=[m[0].identifier,m[1].identifier],this._start([l[0],l[1]]))}touchmove(r,l,m){const x=this._firstTwoTouches;if(!x)return;r.preventDefault();const[w,A]=x,D=$c(m,l,w),N=$c(m,l,A);if(!D||!N)return;const U=this._aroundCenter?null:D.add(N).div(2);return this._move([D,N],U,r)}touchend(r,l,m){if(!this._firstTwoTouches)return;const[x,w]=this._firstTwoTouches,A=$c(m,l,x),D=$c(m,l,w);A&&D||(this._active&&we(),this.reset())}touchcancel(){this.reset()}enable(r){this._enabled=!0,this._aroundCenter=!!r&&r.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function $c(p,r,l){for(let m=0;m<p.length;m++)if(p[m].identifier===l)return r[m]}function Zh(p,r){return Math.log(p/r)/Math.LN2}class fl extends Zo{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(r){this._startDistance=this._distance=r[0].dist(r[1])}_move(r,l){const m=this._distance;if(this._distance=r[0].dist(r[1]),this._active||!(Math.abs(Zh(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Zh(this._distance,m),pinchAround:l}}}function Np(p,r){return 180*p.angleWith(r)/Math.PI}class md extends Zo{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(r){this._startVector=this._vector=r[0].sub(r[1]),this._minDiameter=r[0].dist(r[1])}_move(r,l){const m=this._vector;if(this._vector=r[0].sub(r[1]),m&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:Np(this._vector,m),pinchAround:l}}_isBelowThreshold(r){this._minDiameter=Math.min(this._minDiameter,r.mag());const l=25/(Math.PI*this._minDiameter)*360,m=this._startVector;if(!m)return!1;const x=Np(r,m);return Math.abs(x)<l}}function Fp(p){return Math.abs(p.y)>Math.abs(p.x)}class e0 extends Zo{constructor(r){super(),this._map=r}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(r){this._lastPoints=r,Fp(r[0].sub(r[1]))&&(this._valid=!1)}_move(r,l,m){const x=this._lastPoints;if(!x)return;const w=r[0].sub(x[0]),A=r[1].sub(x[1]);return this._map._cooperativeGestures&&!i.dz()&&m.touches.length<3||(this._valid=this.gestureBeginsVertically(w,A,m.timeStamp),!this._valid)?void 0:(this._lastPoints=r,this._active=!0,{pitchDelta:(w.y+A.y)/2*-.5})}gestureBeginsVertically(r,l,m){if(this._valid!==void 0)return this._valid;const x=r.mag()>=2,w=l.mag()>=2;if(!x&&!w)return;if(!x||!w)return this._firstMove==null&&(this._firstMove=m),m-this._firstMove<100&&void 0;const A=r.y>0==l.y>0;return Fp(r)&&Fp(l)&&A}}const Zl={panStep:100,bearingStep:15,pitchStep:10};class Gs{constructor(){const r=Zl;this._panStep=r.panStep,this._bearingStep=r.bearingStep,this._pitchStep=r.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(r){if(r.altKey||r.ctrlKey||r.metaKey)return;let l=0,m=0,x=0,w=0,A=0;switch(r.keyCode){case 61:case 107:case 171:case 187:l=1;break;case 189:case 109:case 173:l=-1;break;case 37:r.shiftKey?m=-1:(r.preventDefault(),w=-1);break;case 39:r.shiftKey?m=1:(r.preventDefault(),w=1);break;case 38:r.shiftKey?x=1:(r.preventDefault(),A=-1);break;case 40:r.shiftKey?x=-1:(r.preventDefault(),A=1);break;default:return}return this._rotationDisabled&&(m=0,x=0),{cameraAnimation:D=>{const N=D.getZoom();D.easeTo({duration:300,easeId:"keyboardHandler",easing:Oo,zoom:l?Math.round(N)+l*(r.shiftKey?2:1):N,bearing:D.getBearing()+m*this._bearingStep,pitch:D.getPitch()+x*this._pitchStep,offset:[-w*this._panStep,-A*this._panStep],center:D.getCenter()},{originalEvent:r})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Oo(p){return p*(2-p)}const go=4.000244140625,Hs=1/450;class Wo{constructor(r,l){this._map=r,this._el=r.getCanvasContainer(),this._handler=l,this._delta=0,this._lastDelta=0,this._defaultZoomRate=.01,this._wheelZoomRate=Hs,i.aP(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(r){this._defaultZoomRate=r}setWheelZoomRate(r){this._wheelZoomRate=r}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(r){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!r&&r.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(r){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(r.ctrlKey||r.metaKey||this.isZooming()||i.dz()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let l=r.deltaMode===WheelEvent.DOM_DELTA_LINE?40*r.deltaY:r.deltaY;const m=i.q.now(),x=m-(this._lastWheelEventTime||0);this._lastWheelEventTime=m,l!==0&&l%go==0?this._type="wheel":l!==0&&Math.abs(l)<4?this._type="trackpad":x>400?(this._type=null,this._lastValue=l,this._timeout=window.setTimeout(this._onTimeout,40,r)):this._type||(this._type=Math.abs(x*l)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,l+=this._lastValue)),r.shiftKey&&l&&(l/=4),this._type&&(this._lastWheelEvent=r,this._delta-=l,this._active||this._start(r)),r.preventDefault()}_onTimeout(r){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(r)}_start(r){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const l=Ge(this._el,r);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:l,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const r=this._map.transform;this._type==="wheel"&&r.projection.wrap&&(r._center.lng>=180||r._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const l=()=>r._terrainEnabled()&&this._aroundCoord?r.computeZoomRelativeTo(this._aroundCoord):r.zoom;if(this._delta!==0){const U=this._type==="wheel"&&Math.abs(this._delta)>go?this._wheelZoomRate:this._defaultZoomRate;let $=2/(1+Math.exp(-Math.abs(this._delta*U)));this._delta<0&&$!==0&&($=1/$);const Z=l(),W=Math.pow(2,Z),te=typeof this._targetZoom=="number"?r.zoomScale(this._targetZoom):W;this._targetZoom=Math.min(r.maxZoom,Math.max(r.minZoom,r.scaleZoom(te*$))),this._type==="wheel"&&(this._startZoom=Z,this._easing=this._smoothOutEasing(200)),this._lastDelta=this._delta,this._delta=0}const m=typeof this._targetZoom=="number"?this._targetZoom:l(),x=this._startZoom,w=this._easing;let A,D=!1;if(this._type==="wheel"&&x&&w){const U=Math.min((i.q.now()-this._lastWheelEventTime)/200,1),$=w(U);A=i.af(x,m,$),U<1?this._frameId||(this._frameId=!0):D=!0}else A=m,D=!0;this._active=!0,D&&(this._active=!1,this._finishTimeout=window.setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200));let N=A-l();return N*this._lastDelta<0&&(N=0),{noInertia:!0,needsRenderFrame:!D,zoomDelta:N,around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(r){let l=i.dA;if(this._prevEase){const m=this._prevEase,x=(i.q.now()-m.start)/m.duration,w=m.easing(x+.01)-m.easing(x),A=.27/Math.sqrt(w*w+1e-4)*.01,D=Math.sqrt(.0729-A*A);l=i.dy(A,D,.25,1)}return this._prevEase={start:i.q.now(),duration:r,easing:l},l}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=J("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.removeAttribute("role")},200)}}class Ss{constructor(r,l){this._clickZoom=r,this._tapZoom=l}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class dl{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(r,l){return r.preventDefault(),{cameraAnimation:m=>{m.easeTo({duration:300,zoom:m.getZoom()+(r.shiftKey?-1:1),around:m.unproject(l)},{originalEvent:r})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Po{constructor(){this._tap=new zp({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(r,l,m){this._swipePoint||(this._tapTime&&r.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?m.length>0&&(this._swipePoint=l[0],this._swipeTouch=m[0].identifier):this._tap.touchstart(r,l,m))}touchmove(r,l,m){if(this._tapTime){if(this._swipePoint){if(m[0].identifier!==this._swipeTouch)return;const x=l[0],w=x.y-this._swipePoint.y;return this._swipePoint=x,r.preventDefault(),this._active=!0,{zoomDelta:w/128}}}else this._tap.touchmove(r,l,m)}touchend(r,l,m){this._tapTime?this._swipePoint&&m.length===0&&this.reset():this._tap.touchend(r,l,m)&&(this._tapTime=r.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class to{constructor(r,l,m){this._el=r,this._mousePan=l,this._touchPan=m}enable(r){this._inertiaOptions=r||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class jp{constructor(r,l,m){this._pitchWithRotate=r.pitchWithRotate,this._mouseRotate=l,this._mousePitch=m}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class x_{constructor(r,l,m,x){this._el=r,this._touchZoom=l,this._touchRotate=m,this._tapDragZoom=x,this._rotationDisabled=!1,this._enabled=!0}enable(r){this._touchZoom.enable(r),this._rotationDisabled||this._touchRotate.enable(r),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Zs=p=>p.zoom||p.drag||p.pitch||p.rotate;class Up extends i.z{}class Na{constructor(){this.constants=[1,1,.01],this.radius=0}setup(r,l){const m=i.ab.vec3.sub([],l,r);this.radius=i.ab.vec3.length(m[2]<0?i.ab.vec3.div([],m,this.constants):[m[0],m[1],0])}projectRay(r){i.ab.vec3.div(r,r,this.constants),i.ab.vec3.normalize(r,r),i.ab.vec3.mul(r,r,this.constants);const l=i.ab.vec3.scale([],r,this.radius);if(l[2]>0){const m=i.ab.vec3.scale([],[0,0,1],i.ab.vec3.dot(l,[0,0,1])),x=i.ab.vec3.scale([],i.ab.vec3.normalize([],[l[0],l[1],0]),this.radius),w=i.ab.vec3.add([],l,i.ab.vec3.scale([],i.ab.vec3.sub([],i.ab.vec3.add([],x,m),l),2));l[0]=w[0],l[1]=w[1]}return l}}function Xo(p){return p.panDelta&&p.panDelta.mag()||p.zoomDelta||p.bearingDelta||p.pitchDelta}class Wl{constructor(r,l){this._map=r,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Ta(r),this._bearingSnap=l.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new Na,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(l),i.aP(["handleEvent","handleWindowEvent"],this);const m=this._el;this._listeners=[[m,"touchstart",{passive:!0}],[m,"touchmove",{passive:!1}],[m,"touchend",void 0],[m,"touchcancel",void 0],[m,"mousedown",void 0],[m,"mousemove",void 0],[m,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[m,"mouseover",void 0],[m,"mouseout",void 0],[m,"dblclick",void 0],[m,"click",void 0],[m,"keydown",{capture:!1}],[m,"keyup",void 0],[m,"wheel",{passive:!1}],[m,"contextmenu",void 0],[window,"blur",void 0]];for(const[x,w,A]of this._listeners){const D=x===document?this.handleWindowEvent:this.handleEvent;x.addEventListener(w,D,A)}}destroy(){for(const[r,l,m]of this._listeners){const x=r===document?this.handleWindowEvent:this.handleEvent;r.removeEventListener(l,x,m)}}_addDefaultHandlers(r){const l=this._map,m=l.getCanvasContainer();this._add("mapEvent",new y_(l,r));const x=l.boxZoom=new ci(l,r);this._add("boxZoom",x);const w=new Nu,A=new dl;l.doubleClickZoom=new Ss(A,w),this._add("tapZoom",w),this._add("clickZoom",A);const D=new Po;this._add("tapDragZoom",D);const N=l.touchPitch=new e0(l);this._add("touchPitch",N);const U=new ws(r),$=new ju(r);l.dragRotate=new jp(r,U,$),this._add("mouseRotate",U,["mousePitch"]),this._add("mousePitch",$,["mouseRotate"]);const Z=new pd(r),W=new pi(l,r);l.dragPan=new to(m,Z,W),this._add("mousePan",Z),this._add("touchPan",W,["touchZoom","touchRotate"]);const te=new md,ue=new fl;l.touchZoomRotate=new x_(m,ue,te,D),this._add("touchRotate",te,["touchPan","touchZoom"]),this._add("touchZoom",ue,["touchPan","touchRotate"]),this._add("blockableMapEvent",new fd(l));const se=l.scrollZoom=new Wo(l,this);this._add("scrollZoom",se,["mousePan"]);const de=l.keyboard=new Gs;this._add("keyboard",de);for(const he of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])r.interactive&&r[he]&&l[he].enable(r[he])}_add(r,l,m){this._handlers.push({handlerName:r,handler:l,allowed:m}),this._handlersById[r]=l}stop(r){if(!this._updatingCamera){for(const{handler:l}of this._handlers)l.reset();this._inertia.clear(),this._fireEvents({},{},r),this._changes=[],this._originalZoom=void 0}}isActive(){for(const{handler:r}of this._handlers)if(r.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Zs(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(r,l,m){for(const x in r)if(x!==m&&(!l||l.indexOf(x)<0))return!0;return!1}handleWindowEvent(r){this.handleEvent(r,`${r.type}Window`)}_getMapTouches(r){const l=[];for(const m of r)this._el.contains(m.target)&&l.push(m);return l}handleEvent(r,l){this._updatingCamera=!0;const m=r.type==="renderFrame",x=m?void 0:r,w={needsRenderFrame:!1},A={},D={},N=r.touches?this._getMapTouches(r.touches):void 0,U=N?He(this._el,N):m?void 0:Ge(this._el,r);for(const{handlerName:W,handler:te,allowed:ue}of this._handlers){if(!te.isEnabled())continue;let se;this._blockedByActive(D,ue,W)?te.reset():te[l||r.type]&&(se=te[l||r.type](r,U,N),this.mergeHandlerResult(w,A,se,W,x),se&&se.needsRenderFrame&&this._triggerRenderFrame()),(se||te.isActive())&&(D[W]=te)}const $={};for(const W in this._previousActiveHandlers)D[W]||($[W]=x);this._previousActiveHandlers=D,(Object.keys($).length||Xo(w))&&(this._changes.push([w,A,$]),this._triggerRenderFrame()),(Object.keys(D).length||Xo(w))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:Z}=w;Z&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],Z(this._map))}mergeHandlerResult(r,l,m,x,w){if(!m)return;i.l(r,m);const A={handlerName:x,originalEvent:m.originalEvent||w};m.zoomDelta!==void 0&&(l.zoom=A),m.panDelta!==void 0&&(l.drag=A),m.pitchDelta!==void 0&&(l.pitch=A),m.bearingDelta!==void 0&&(l.rotate=A)}_applyChanges(){const r={},l={},m={};for(const[x,w,A]of this._changes)x.panDelta&&(r.panDelta=(r.panDelta||new i.P(0,0))._add(x.panDelta)),x.zoomDelta&&(r.zoomDelta=(r.zoomDelta||0)+x.zoomDelta),x.bearingDelta&&(r.bearingDelta=(r.bearingDelta||0)+x.bearingDelta),x.pitchDelta&&(r.pitchDelta=(r.pitchDelta||0)+x.pitchDelta),x.around!==void 0&&(r.around=x.around),x.aroundCoord!==void 0&&(r.aroundCoord=x.aroundCoord),x.pinchAround!==void 0&&(r.pinchAround=x.pinchAround),x.noInertia&&(r.noInertia=x.noInertia),i.l(l,w),i.l(m,A);this._updateMapTransform(r,l,m),this._changes=[]}_updateMapTransform(r,l,m){const x=this._map,w=x.transform,A=Te=>[Te.x,Te.y,Te.z];if((Te=>{const Pe=this._eventsInProgress.drag;return Pe&&!this._handlersById[Pe.handlerName].isActive()})()&&!Xo(r)){const Te=w.zoom;w.cameraElevationReference="sea",this._originalZoom!=null&&w._orthographicProjectionAtLowPitch&&w.projection.name!=="globe"&&w.pitch===0?(w.cameraElevationReference="ground",w.zoom=this._originalZoom):(w.recenterOnTerrain(),w.cameraElevationReference="ground"),Te!==w.zoom&&this._map._update(!0)}if(w._isCameraConstrained&&x._stop(!0),!Xo(r))return void this._fireEvents(l,m,!0);let{panDelta:D,zoomDelta:N,bearingDelta:U,pitchDelta:$,around:Z,aroundCoord:W,pinchAround:te}=r;w._isCameraConstrained&&(N>0&&(N=0),w._isCameraConstrained=!1),te!==void 0&&(Z=te),(N||(Te=>l[Te]&&!this._eventsInProgress[Te])("drag"))&&Z&&(this._dragOrigin=A(w.pointCoordinate3D(Z)),this._originalZoom=w.zoom,this._trackingEllipsoid.setup(w._camera.position,this._dragOrigin)),w.cameraElevationReference="sea",x._stop(!0),Z=Z||x.transform.centerPoint,U&&(w.bearing+=U),$&&(w.pitch+=$),w._updateCameraState();const ue=[0,0,0];if(D)if(w.projection.name==="mercator"){const Te=this._trackingEllipsoid.projectRay(w.screenPointToMercatorRay(Z).dir),Pe=this._trackingEllipsoid.projectRay(w.screenPointToMercatorRay(Z.sub(D)).dir);ue[0]=Pe[0]-Te[0],ue[1]=Pe[1]-Te[1]}else{const Te=w.pointCoordinate(Z);if(w.projection.name==="globe"){D=D.rotate(-w.angle);const Pe=w._pixelsPerMercatorPixel/w.worldSize;ue[0]=-D.x*i.dB(i.aS(Te.y))*Pe,ue[1]=-D.y*i.dB(w.center.lat)*Pe}else{const Pe=w.pointCoordinate(Z.sub(D));Te&&Pe&&(ue[0]=Pe.x-Te.x,ue[1]=Pe.y-Te.y)}}const se=w.zoom,de=[0,0,0];if(N){const Te=A(W||w.pointCoordinate3D(Z)),Pe={dir:i.ab.vec3.normalize([],i.ab.vec3.sub([],Te,w._camera.position))};if(Pe.dir[2]<0){const Me=w.zoomDeltaToMovement(Te,N);i.ab.vec3.scale(de,Pe.dir,Me)}}const he=i.ab.vec3.add(ue,ue,de);w._translateCameraConstrained(he),N&&Math.abs(w.zoom-se)>1e-4&&w.recenterOnTerrain(),w.cameraElevationReference="ground",this._map._update(),r.noInertia||this._inertia.record(r),this._fireEvents(l,m,!0)}_fireEvents(r,l,m){const x=Zs(this._eventsInProgress),w=Zs(r),A={};for(const $ in r){const{originalEvent:Z}=r[$];this._eventsInProgress[$]||(A[`${$}start`]=Z),this._eventsInProgress[$]=r[$]}!x&&w&&this._fireEvent("movestart",w.originalEvent);for(const $ in A)this._fireEvent($,A[$]);w&&this._fireEvent("move",w.originalEvent);for(const $ in r){const{originalEvent:Z}=r[$];this._fireEvent($,Z)}const D={};let N;for(const $ in this._eventsInProgress){const{handlerName:Z,originalEvent:W}=this._eventsInProgress[$];this._handlersById[Z].isActive()||(delete this._eventsInProgress[$],N=l[Z]||W,D[`${$}end`]=N)}for(const $ in D)this._fireEvent($,D[$]);const U=Zs(this._eventsInProgress);if(m&&(x||w)&&!U){this._updatingCamera=!0;const $=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),Z=W=>W!==0&&-this._bearingSnap<W&&W<this._bearingSnap;$?(Z($.bearing||this._map.getBearing())&&($.bearing=0),this._map.easeTo($,{originalEvent:N})):(this._map.fire(new i.z("moveend",{originalEvent:N})),Z(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(r,l){this._map.fire(new i.z(r,l?{originalEvent:l}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(r=>{this._frameId=void 0,this.handleEvent(new Up("renderFrame",{timeStamp:r})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const Wh="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class qc extends i.E{constructor(r,l){super(),this._moving=!1,this._zooming=!1,this.transform=r,this._bearingSnap=l.bearingSnap,this._respectPrefersReducedMotion=l.respectPrefersReducedMotion!==!1,i.aP(["_renderFrameCallback"],this)}getCenter(){return new i.bO(this.transform.center.lng,this.transform.center.lat)}setCenter(r,l){return this.jumpTo({center:r},l)}panBy(r,l,m){return r=i.P.convert(r).mult(-1),this.panTo(this.transform.center,i.l({offset:r},l),m)}panTo(r,l,m){return this.easeTo(i.l({center:r},l),m)}getZoom(){return this.transform.zoom}setZoom(r,l){return this.jumpTo({zoom:r},l),this}zoomTo(r,l,m){return this.easeTo(i.l({zoom:r},l),m)}zoomIn(r,l){return this.zoomTo(this.getZoom()+1,r,l),this}zoomOut(r,l){return this.zoomTo(this.getZoom()-1,r,l),this}getBearing(){return this.transform.bearing}setBearing(r,l){return this.jumpTo({bearing:r},l),this}getPadding(){return this.transform.padding}setPadding(r,l){return this.jumpTo({padding:r},l),this}rotateTo(r,l,m){return this.easeTo(i.l({bearing:r},l),m)}resetNorth(r,l){return this.rotateTo(0,i.l({duration:1e3},r),l),this}resetNorthPitch(r,l){return this.easeTo(i.l({bearing:0,pitch:0,duration:1e3},r),l),this}snapToNorth(r,l){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(r,l):this}getPitch(){return this.transform.pitch}setPitch(r,l){return this.jumpTo({pitch:r},l),this}cameraForBounds(r,l){r=i.az.convert(r);const m=l&&l.bearing||0,x=l&&l.pitch||0,w=r.getNorthWest(),A=r.getSouthEast();return this._cameraForBounds(this.transform,w,A,m,x,l)}_extendPadding(r){const l={top:0,right:0,bottom:0,left:0};return r==null?i.l({},l,this.transform.padding):typeof r=="number"?{top:r,bottom:r,right:r,left:r}:i.l({},l,r)}_extendCameraOptions(r){return(r=i.l({offset:[0,0],maxZoom:this.transform.maxZoom},r)).padding=this._extendPadding(r.padding),r}_minimumAABBFrustumDistance(r,l){const m=l.max[0]-l.min[0],x=l.max[1]-l.min[1];return m/x>r.aspect?m/(2*Math.tan(.5*r.fovX)*r.aspect):x/(2*Math.tan(.5*r.fovY)*r.aspect)}_cameraForBoundsOnGlobe(r,l,m,x,w,A){const D=r.clone(),N=this._extendCameraOptions(A);D.bearing=x,D.pitch=w;const U=i.bO.convert(l),$=i.bO.convert(m),Z=.5*(U.lat+$.lat),W=.5*(U.lng+$.lng),te=i.dC(Z,W),ue=i.ab.vec3.normalize([],te),se=i.ab.vec3.normalize([],i.ab.vec3.cross([],ue,[0,1,0])),de=i.ab.vec3.cross([],se,ue),he=[se[0],se[1],se[2],0,de[0],de[1],de[2],0,ue[0],ue[1],ue[2],0,0,0,0,1],Te=[te,i.dC(U.lat,U.lng),i.dC($.lat,U.lng),i.dC($.lat,$.lng),i.dC(U.lat,$.lng),i.dC(Z,U.lng),i.dC(Z,$.lng),i.dC(U.lat,W),i.dC($.lat,W)];let Pe=i.cd.fromPoints(Te.map(mt=>[i.ab.vec3.dot(se,mt),i.ab.vec3.dot(de,mt),i.ab.vec3.dot(ue,mt)]));const Me=i.ab.vec3.transformMat4([],Pe.center,he);i.ab.vec3.squaredLength(Me)===0&&i.ab.vec3.set(Me,0,0,1),i.ab.vec3.normalize(Me,Me),i.ab.vec3.scale(Me,Me,i.ax),D.center=i.dD(Me);const Fe=D.getWorldToCameraMatrix(),Re=i.ab.mat4.invert(new Float64Array(16),Fe);Pe=i.cd.applyTransform(Pe,i.ab.mat4.multiply([],Fe,he));const ze=this._extendAABB(Pe,D,N,x);if(!ze)return void i.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");Pe=ze,i.ab.vec3.transformMat4(Me,Me,Fe);const De=.5*(Pe.max[2]-Pe.min[2]),$e=this._minimumAABBFrustumDistance(D,Pe),Xe=i.ab.vec3.scale([],[0,0,1],De),ht=i.ab.vec3.add(Xe,Me,Xe),ot=$e+(D.pitch===0?0:i.ab.vec3.distance(Me,ht)),Et=D.globeCenterInViewSpace,yt=i.ab.vec3.sub([],Me,[Et[0],Et[1],Et[2]]);i.ab.vec3.normalize(yt,yt),i.ab.vec3.scale(yt,yt,ot);const nt=i.ab.vec3.add([],Me,yt);i.ab.vec3.transformMat4(nt,nt,Re);const pt=i.ds/i.ax,Lt=i.ab.vec3.length(nt),tt=i.bH(Math.max(Lt*pt-i.ds,Number.EPSILON),0),St=Math.min(D.zoomFromMercatorZAdjusted(tt),N.maxZoom);return St>.5*(i.c6+i.bY)?(D.setProjection({name:"mercator"}),D.zoom=St,this._cameraForBounds(D,l,m,x,w,A)):{center:D.center,zoom:St,bearing:x,pitch:w}}_extendAABB(r,l,m,x){const w=.5*((m.padding.left||0)+(m.padding.right||0)),A=.5*((m.padding.top||0)+(m.padding.bottom||0)),D=A,N=w,U=w,$=A,Z=l.width-(N+U),W=l.height-(D+$),te=i.ab.vec3.sub([],r.max,r.min),ue=Math.min(Z/te[0],W/te[1]),se=Math.min(l.scaleZoom(l.scale*ue),m.maxZoom);if(isNaN(se))return null;const de=l.scale/l.zoomScale(se),he=new i.cd([r.min[0]-N*de,r.min[1]-$*de,r.min[2]],[r.max[0]+U*de,r.max[1]+D*de,r.max[2]]),Te=(typeof m.offset.x=="number"&&typeof m.offset.y=="number"?new i.P(m.offset.x,m.offset.y):i.P.convert(m.offset)).rotate(-i.ai(x));return he.center[0]-=Te.x*de,he.center[1]+=Te.y*de,he}queryTerrainElevation(r,l){const m=this.transform.elevation;return m?(l=i.l({},{exaggerated:!0},l),m.getAtPoint(i.aa.fromLngLat(r),null,l.exaggerated)):null}_cameraForBounds(r,l,m,x,w,A){if(r.projection.name==="globe")return this._cameraForBoundsOnGlobe(r,l,m,x,w,A);const D=r.clone(),N=this._extendCameraOptions(A);D.bearing=x,D.pitch=w;const U=i.bO.convert(l),$=i.bO.convert(m),Z=new i.bO(U.lng,$.lat),W=new i.bO($.lng,U.lat),te=D.project(U),ue=D.project($),se=this.queryTerrainElevation(U),de=this.queryTerrainElevation($),he=this.queryTerrainElevation(Z),Te=this.queryTerrainElevation(W),Pe=[[te.x,te.y,Math.min(se||0,de||0,he||0,Te||0)],[ue.x,ue.y,Math.max(se||0,de||0,he||0,Te||0)]];let Me=i.cd.fromPoints(Pe);const Fe=D.getWorldToCameraMatrix(),Re=i.ab.mat4.invert(new Float64Array(16),Fe);Me=i.cd.applyTransform(Me,Fe);const ze=this._extendAABB(Me,D,N,x);if(!ze)return void i.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");Me=ze;const De=.5*i.ab.vec3.sub([],Me.max,Me.min)[2],$e=this._minimumAABBFrustumDistance(D,Me),Xe=[0,0,1,0];i.ab.vec4.transformMat4(Xe,Xe,Fe),i.ab.vec4.normalize(Xe,Xe);const ht=i.ab.vec3.scale([],Xe,$e+De),ot=i.ab.vec3.add([],Me.center,ht);i.ab.vec3.transformMat4(Me.center,Me.center,Re),i.ab.vec3.transformMat4(ot,ot,Re);const Et=D.unproject(new i.P(Me.center[0],Me.center[1])),yt=i.dE(D.projection,Et),nt=Math.pow(2,yt),pt=Math.min(D._zoomFromMercatorZ(ot[2]*D.pixelsPerMeter*nt/D.worldSize),N.maxZoom);return D.mercatorFromTransition&&pt<.5*(i.c6+i.bY)?(D.setProjection({name:"globe"}),D.zoom=pt,this._cameraForBounds(D,l,m,x,w,A)):{center:Et,zoom:pt,bearing:x,pitch:w}}fitBounds(r,l,m){const x=this.cameraForBounds(r,l);return this._fitInternal(x,l,m)}fitScreenCoordinates(r,l,m,x,w){const A=i.P.convert(r),D=i.P.convert(l),N=new i.P(Math.min(A.x,D.x),Math.min(A.y,D.y)),U=new i.P(Math.max(A.x,D.x),Math.max(A.y,D.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(A,D))return this;const $=this.transform.pointLocation3D(N),Z=this.transform.pointLocation3D(U),W=this.transform.pointLocation3D(new i.P(N.x,U.y)),te=this.transform.pointLocation3D(new i.P(U.x,N.y)),ue=[Math.min($.lng,Z.lng,W.lng,te.lng),Math.min($.lat,Z.lat,W.lat,te.lat)],se=[Math.max($.lng,Z.lng,W.lng,te.lng),Math.max($.lat,Z.lat,W.lat,te.lat)],de=x&&x.pitch?x.pitch:this.getPitch(),he=this._cameraForBounds(this.transform,ue,se,m,de,x);return this._fitInternal(he,x,w)}_fitInternal(r,l,m){return r?(l=i.l(r,l)).linear?this.easeTo(l,m):this.flyTo(l,m):this}jumpTo(r,l){this.stop();const m=r.preloadOnly?this.transform.clone():this.transform;let x=!1,w=!1,A=!1;"zoom"in r&&m.zoom!==+r.zoom&&(x=!0,m.zoom=+r.zoom),r.center!==void 0&&(m.center=i.bO.convert(r.center)),"bearing"in r&&m.bearing!==+r.bearing&&(w=!0,m.bearing=+r.bearing),"pitch"in r&&m.pitch!==+r.pitch&&(A=!0,m.pitch=+r.pitch);const D=typeof r.padding=="number"?this._extendPadding(r.padding):r.padding;if(r.padding!=null&&!m.isPaddingEqual(D))if(r.retainPadding===!1){const N=m.clone();N.padding=D,m.setLocationAtPoint(m.center,N.centerPoint)}else m.padding=D;return r.preloadOnly?(this._preloadTiles(m),this):(this.fire(new i.z("movestart",l)).fire(new i.z("move",l)),x&&this.fire(new i.z("zoomstart",l)).fire(new i.z("zoom",l)).fire(new i.z("zoomend",l)),w&&this.fire(new i.z("rotatestart",l)).fire(new i.z("rotate",l)).fire(new i.z("rotateend",l)),A&&this.fire(new i.z("pitchstart",l)).fire(new i.z("pitch",l)).fire(new i.z("pitchend",l)),this.fire(new i.z("moveend",l)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||i.w(Wh),this.transform.getFreeCameraOptions()}setFreeCameraOptions(r,l){const m=this.transform;if(!m.projection.supportsFreeCamera)return i.w(Wh),this;this.stop();const x=m.zoom,w=m.pitch,A=m.bearing;m.setFreeCameraOptions(r);const D=x!==m.zoom,N=w!==m.pitch,U=A!==m.bearing;return this.fire(new i.z("movestart",l)).fire(new i.z("move",l)),D&&this.fire(new i.z("zoomstart",l)).fire(new i.z("zoom",l)).fire(new i.z("zoomend",l)),U&&this.fire(new i.z("rotatestart",l)).fire(new i.z("rotate",l)).fire(new i.z("rotateend",l)),N&&this.fire(new i.z("pitchstart",l)).fire(new i.z("pitch",l)).fire(new i.z("pitchend",l)),this.fire(new i.z("moveend",l)),this}easeTo(r,l){this._stop(!1,r.easeId),((r=i.l({offset:[0,0],duration:500,easing:i.dA},r)).animate===!1||this._prefersReducedMotion(r))&&(r.duration=0);const m=this.transform,x=this.getZoom(),w=this.getBearing(),A=this.getPitch(),D=this.getPadding(),N="zoom"in r?+r.zoom:x,U="bearing"in r?this._normalizeBearing(r.bearing,w):w,$="pitch"in r?+r.pitch:A,Z=this._extendPadding(r.padding),W=i.P.convert(r.offset);let te,ue,se;if(m.projection.name==="globe"){const Xe=i.aa.fromLngLat(m.center),ht=W.rotate(-m.angle);Xe.x+=ht.x/m.worldSize,Xe.y+=ht.y/m.worldSize;const ot=Xe.toLngLat(),Et=i.bO.convert(r.center||ot);this._normalizeCenter(Et),te=m.centerPoint.add(ht),ue=new i.P(Xe.x,Xe.y).mult(m.worldSize),se=new i.P(i.at(Et.lng),i.aA(Et.lat)).mult(m.worldSize).sub(ue)}else{te=m.centerPoint.add(W);const Xe=m.pointLocation(te),ht=i.bO.convert(r.center||Xe);this._normalizeCenter(ht),ue=m.project(Xe),se=m.project(ht).sub(ue)}const de=m.zoomScale(N-x);let he,Te;r.around&&(he=i.bO.convert(r.around),Te=m.locationPoint(he));const Pe=this._zooming||N!==x,Me=this._rotating||w!==U,Fe=this._pitching||$!==A,Re=!m.isPaddingEqual(Z),ze=r.retainPadding===!1?m.clone():m,De=Xe=>ht=>{if(Pe&&(Xe.zoom=i.af(x,N,ht)),Me&&(Xe.bearing=i.af(w,U,ht)),Fe&&(Xe.pitch=i.af(A,$,ht)),Re&&(ze.interpolatePadding(D,Z,ht),te=ze.centerPoint.add(W)),he)Xe.setLocationAtPoint(he,Te);else{const ot=Xe.zoomScale(Xe.zoom-x),Et=N>x?Math.min(2,de):Math.max(.5,de),yt=Math.pow(Et,1-ht),nt=Xe.unproject(ue.add(se.mult(ht*yt)).mult(ot));Xe.setLocationAtPoint(Xe.renderWorldCopies?nt.wrap():nt,te)}return r.preloadOnly||this._fireMoveEvents(l),Xe};if(r.preloadOnly){const Xe=this._emulate(De,r.duration,m);return this._preloadTiles(Xe),this}const $e={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=Pe,this._rotating=Me,this._pitching=Fe,this._padding=Re,this._easeId=r.easeId,this._prepareEase(l,r.noMoveStart,$e),this._ease(De(m),Xe=>{m.cameraElevationReference==="sea"&&m.recenterOnTerrain(),this._afterEase(l,Xe)},r),this}_prepareEase(r,l,m={}){this._moving=!0,this.transform.cameraElevationReference="sea",this.transform._orthographicProjectionAtLowPitch&&this.transform.pitch===0&&this.transform.projection.name!=="globe"&&(this.transform.cameraElevationReference="ground"),l||m.moving||this.fire(new i.z("movestart",r)),this._zooming&&!m.zooming&&this.fire(new i.z("zoomstart",r)),this._rotating&&!m.rotating&&this.fire(new i.z("rotatestart",r)),this._pitching&&!m.pitching&&this.fire(new i.z("pitchstart",r))}_fireMoveEvents(r){this.fire(new i.z("move",r)),this._zooming&&this.fire(new i.z("zoom",r)),this._rotating&&this.fire(new i.z("rotate",r)),this._pitching&&this.fire(new i.z("pitch",r))}_afterEase(r,l){if(this._easeId&&l&&this._easeId===l)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const m=this._zooming,x=this._rotating,w=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,m&&this.fire(new i.z("zoomend",r)),x&&this.fire(new i.z("rotateend",r)),w&&this.fire(new i.z("pitchend",r)),this.fire(new i.z("moveend",r))}flyTo(r,l){if(this._prefersReducedMotion(r)){const mt=i.ay(r,["center","zoom","bearing","pitch","around","padding","retainPadding"]);return this.jumpTo(mt,l)}this.stop(),r=i.l({offset:[0,0],speed:1.2,curve:1.42,easing:i.dA},r);const m=this.transform,x=this.getZoom(),w=this.getBearing(),A=this.getPitch(),D=this.getPadding(),N="zoom"in r?i.aw(+r.zoom,m.minZoom,m.maxZoom):x,U="bearing"in r?this._normalizeBearing(r.bearing,w):w,$="pitch"in r?+r.pitch:A,Z=this._extendPadding(r.padding),W=m.zoomScale(N-x),te=i.P.convert(r.offset);let ue=m.centerPoint.add(te);const se=m.pointLocation(ue),de=i.bO.convert(r.center||se);this._normalizeCenter(de);const he=m.project(se),Te=m.project(de).sub(he);let Pe=r.curve;const Me=Math.max(m.width,m.height),Fe=Me/W,Re=Te.mag();if("minZoom"in r){const mt=i.aw(Math.min(r.minZoom,x,N),m.minZoom,m.maxZoom),Gt=Me/m.zoomScale(mt-x);Pe=Math.sqrt(Gt/Re*2)}const ze=Pe*Pe;function De(mt){const Gt=(Fe*Fe-Me*Me+(mt?-1:1)*ze*ze*Re*Re)/(2*(mt?Fe:Me)*ze*Re);return Math.log(Math.sqrt(Gt*Gt+1)-Gt)}function $e(mt){return(Math.exp(mt)-Math.exp(-mt))/2}function Xe(mt){return(Math.exp(mt)+Math.exp(-mt))/2}const ht=De(0);let ot=function(mt){return Xe(ht)/Xe(ht+Pe*mt)},Et=function(mt){return Me*((Xe(ht)*($e(Gt=ht+Pe*mt)/Xe(Gt))-$e(ht))/ze)/Re;var Gt},yt=(De(1)-ht)/Pe;if(Math.abs(Re)<1e-6||!isFinite(yt)){if(Math.abs(Me-Fe)<1e-6)return this.easeTo(r,l);const mt=Fe<Me?-1:1;yt=Math.abs(Math.log(Fe/Me))/Pe,Et=function(){return 0},ot=function(Gt){return Math.exp(mt*Pe*Gt)}}r.duration="duration"in r?+r.duration:1e3*yt/("screenSpeed"in r?+r.screenSpeed/Pe:+r.speed),r.maxDuration&&r.duration>r.maxDuration&&(r.duration=0);const nt=w!==U,pt=$!==A,Lt=!m.isPaddingEqual(Z),tt=r.retainPadding===!1?m.clone():m,St=mt=>Gt=>{const It=Gt*yt,At=1/ot(It);mt.zoom=Gt===1?N:x+mt.scaleZoom(At),nt&&(mt.bearing=i.af(w,U,Gt)),pt&&(mt.pitch=i.af(A,$,Gt)),Lt&&(tt.interpolatePadding(D,Z,Gt),ue=tt.centerPoint.add(te));const zt=Gt===1?de:mt.unproject(he.add(Te.mult(Et(It))).mult(At));return mt.setLocationAtPoint(mt.renderWorldCopies?zt.wrap():zt,ue),mt._updateCameraOnTerrain(),r.preloadOnly||this._fireMoveEvents(l),mt};if(r.preloadOnly){const mt=this._emulate(St,r.duration,m);return this._preloadTiles(mt),this}return this._zooming=!0,this._rotating=nt,this._pitching=pt,this._padding=Lt,this._prepareEase(l,!1),this._ease(St(m),()=>this._afterEase(l),r),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_requestRenderFrame(r){}_cancelRenderFrame(r){}_stop(r,l){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const m=this._onEaseEnd;this._onEaseEnd=void 0,m.call(this,l)}if(!r){const m=this.handlers;m&&m.stop(!1)}return this}_ease(r,l,m){m.animate===!1||m.duration===0?(r(1),l()):(this._easeStart=i.q.now(),this._easeOptions=m,this._onEaseFrame=r,this._onEaseEnd=l,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const r=Math.min((i.q.now()-this._easeStart)/this._easeOptions.duration,1),l=this._onEaseFrame;l&&l(this._easeOptions.easing(r)),r<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(r,l){r=i.bF(r,-180,180);const m=Math.abs(r-l);return Math.abs(r-360-l)<m&&(r-=360),Math.abs(r+360-l)<m&&(r+=360),r}_normalizeCenter(r){const l=this.transform;if(l.maxBounds||l.projection.name!=="globe"&&!l.renderWorldCopies)return;const m=r.lng-l.center.lng;r.lng+=m>180?-360:m<-180?360:0}_prefersReducedMotion(r){return this._respectPrefersReducedMotion&&i.q.prefersReducedMotion&&!(r&&r.essential)}_emulate(r,l,m){const x=Math.ceil(15*l/1e3),w=[],A=r(m.clone());for(let D=0;D<=x;D++){const N=A(D/x);w.push(N.clone())}return w}_preloadTiles(r,l){}}class Xh{constructor(r={}){this.options=r,i.aP(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(r){const l=this.options&&this.options.compact,m=r._getUIString("AttributionControl.ToggleAttribution");this._map=r,this._container=J("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=J("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._compactButton.setAttribute("aria-label",m);const x=J("span","mapboxgl-ctrl-icon",this._compactButton);return x.setAttribute("aria-hidden","true"),x.setAttribute("title",m),this._innerContainer=J("div","mapboxgl-ctrl-attrib-inner",this._container),l&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),l===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let r=this._editLink;r||(r=this._editLink=this._container.querySelector(".mapbox-improve-map"));const l=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||i.e.ACCESS_TOKEN}];if(r){const m=l.reduce((x,w,A)=>(w.value&&(x+=`${w.key}=${w.value}${A<l.length-1?"&":""}`),x),"?");r.href=`${i.e.FEEDBACK_URL}/${m}#${kp(this._map,!0)}`,r.rel="noopener nofollow"}}_updateData(r){!r||r.sourceDataType!=="metadata"&&r.sourceDataType!=="visibility"&&r.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let r=[];if(this._map.style.stylesheet){const x=this._map.style.stylesheet;this.styleOwner=x.owner,this.styleId=x.id}const l=this._map.style._mergedSourceCaches;for(const x in l){const w=l[x];if(w.used){const A=w.getSource();A.attribution&&r.indexOf(A.attribution)<0&&r.push(A.attribution)}}r.sort((x,w)=>x.length-w.length),r=r.filter((x,w)=>{for(let A=w+1;A<r.length;A++)if(r[A].indexOf(x)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?r=[...this.options.customAttribution,...r]:r.unshift(this.options.customAttribution));const m=r.join(" | ");m!==this._attribHTML&&(this._attribHTML=m,r.length?(this._innerContainer.innerHTML=m,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class Xa{constructor(){i.aP(["_updateLogo","_updateCompact"],this)}onAdd(r){this._map=r,this._container=J("div","mapboxgl-ctrl");const l=J("a","mapboxgl-ctrl-logo");return l.target="_blank",l.rel="noopener nofollow",l.href="https://www.mapbox.com/",l.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),l.setAttribute("rel","noopener nofollow"),this._container.appendChild(l),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(r){r&&r.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const r=this._map.style._sourceCaches;if(Object.entries(r).length===0)return!0;for(const l in r){const m=r[l].getSource();if(m.hasOwnProperty("mapbox_logo")&&!m.mapbox_logo)return!1}return!0}_updateCompact(){const r=this._container.children;if(r.length){const l=r[0];this._map.getCanvasContainer().offsetWidth<250?l.classList.add("mapboxgl-compact"):l.classList.remove("mapboxgl-compact")}}}class Ya{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(r){const l=++this._id;return this._queue.push({callback:r,id:l,cancelled:!1}),l}remove(r){const l=this._currentlyRunning,m=l?this._queue.concat(l):this._queue;for(const x of m)if(x.id===r)return void(x.cancelled=!0)}run(r=0){const l=this._currentlyRunning=this._queue;this._queue=[];for(const m of l)if(!m.cancelled&&(m.callback(r),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}class Uu{constructor(r){this.jumpTo(r)}getValue(r){if(r<=this._startTime)return this._start;if(r>=this._endTime)return this._end;const l=i.cB((r-this._startTime)/(this._endTime-this._startTime));return this._start*(1-l)+this._end*l}isEasing(r){return r>=this._startTime&&r<=this._endTime}jumpTo(r){this._startTime=-1/0,this._endTime=-1/0,this._start=r,this._end=r}easeTo(r,l,m){this._start=this.getValue(l),this._end=r,this._startTime=l,this._endTime=l+m}}const Gc={"AttributionControl.ToggleAttribution":"Toggle attribution","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox homepage","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use  + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"};class Ws extends i.z{constructor(r,l,m,x){const{point:w,lngLat:A,originalEvent:D,target:N}=r;super(r.type,{point:w,lngLat:A,originalEvent:D,target:N}),this.preventDefault=()=>{r.preventDefault()},this.id=l,this.interaction=m,this.feature=x}}class pl{constructor(r){this.map=r,this.interactionsByType=new Map,this.delegatedInteractions=new Map,this.typeById=new Map,this.filters=new Map,this.handleType=this.handleType.bind(this),this.handleMove=this.handleMove.bind(this),this.handleOut=this.handleOut.bind(this),this.hoveredFeatures=new Map,this.prevHoveredFeatures=new Map}add(r,l){if(this.typeById.has(r))throw new Error(`Interaction id "${r}" already exists.`);const m=l.filter;let x=l.type;m&&this.filters.set(r,i.aZ(m)),x==="mouseover"&&(x="mouseenter"),x==="mouseout"&&(x="mouseleave");const w=this.interactionsByType.get(x)||new Map;x==="mouseenter"||x==="mouseleave"?(this.delegatedInteractions.size===0&&(this.map.on("mousemove",this.handleMove),this.map.on("mouseout",this.handleOut)),this.delegatedInteractions.set(r,l)):w.size===0&&this.map.on(x,this.handleType),w.size===0&&this.interactionsByType.set(x,w),w.set(r,l),this.typeById.set(r,x)}get(r){const l=this.typeById.get(r);if(!l)return;const m=this.interactionsByType.get(l);return m?m.get(r):void 0}remove(r){const l=this.typeById.get(r);if(!l)return;this.typeById.delete(r),this.filters.delete(r);const m=this.interactionsByType.get(l);m&&(m.delete(r),l==="mouseenter"||l==="mouseleave"?(this.delegatedInteractions.delete(r),this.delegatedInteractions.size===0&&(this.map.off("mousemove",this.handleMove),this.map.off("mouseout",this.handleOut))):m.size===0&&this.map.off(l,this.handleType))}queryTargets(r,l){const m=[];for(const[x,w]of l)w.target&&m.push({targetId:x,target:w.target,filter:this.filters.get(x)});return this.map.style.queryRenderedTargets(r,m,this.map.transform)}handleMove(r){this.prevHoveredFeatures=this.hoveredFeatures,this.hoveredFeatures=new Map;const l=this.queryTargets(r.point,Array.from(this.delegatedInteractions).reverse());l.length&&(r.type="mouseenter",this.handleType(r,l));const m=new Map;for(const[x,{feature:w}]of this.prevHoveredFeatures)this.hoveredFeatures.has(x)||m.set(w.id,w);m.size&&(r.type="mouseleave",this.handleType(r,Array.from(m.values())))}handleOut(r){const l=Array.from(this.hoveredFeatures.values()).map(({feature:m})=>m);l.length&&(r.type="mouseleave",this.handleType(r,l)),this.hoveredFeatures.clear()}handleType(r,l){const m=Array.from(this.interactionsByType.get(r.type)).reverse(),x=!!l;l=l||this.queryTargets(r.point,m);const w=r.type==="mouseenter";let A=!1;const D=new Set;for(const N of l){for(const[U,$]of m){if(!$.target)continue;const Z=N.variants?N.variants[U]:null;if(Z){for(const W of Z){if(Cl(W,N,D,U))continue;const te=new i.cw(N,W),ue=mh(W,N,U);x&&(te.state=this.map.getFeatureState(te));const se=w?this.prevHoveredFeatures.get(ue):null,de=new Ws(r,U,$,te),he=se?se.stop:$.handler(de);if(w&&this.hoveredFeatures.set(ue,{feature:N,stop:he}),he!==!1){A=!0;break}}if(A)break}}if(A)break}if(!A)for(const[N,U]of m){const{handler:$,target:Z}=U;if(!Z&&$(new Ws(r,N,U,null))!==!1)break}}}function pr(p,r){if(Array.isArray(p)&&Array.isArray(r)){const l=new Set(p),m=new Set(r);return l.size===m.size&&p.every(x=>m.has(x))}return i.bn(p,r)}const Xl={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,antialias:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0,collectResourceTiming:!1,testMode:!1,precompilePrograms:!0,scaleFactor:1,spriteFormat:"auto"},Vu={showCompass:!0,showZoom:!0,visualizePitch:!1};class Yo{constructor(r,l,m=!1){this._clickTolerance=10,this.element=l,this.mouseRotate=new ws({clickTolerance:r.dragRotate._mouseRotate._clickTolerance}),this.map=r,m&&(this.mousePitch=new ju({clickTolerance:r.dragRotate._mousePitch._clickTolerance})),i.aP(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),l.addEventListener("mousedown",this.mousedown),l.addEventListener("touchstart",this.touchstart,{passive:!1}),l.addEventListener("touchmove",this.touchmove),l.addEventListener("touchend",this.touchend),l.addEventListener("touchcancel",this.reset)}down(r,l){this.mouseRotate.mousedown(r,l),this.mousePitch&&this.mousePitch.mousedown(r,l),xe()}move(r,l){const m=this.map,x=this.mouseRotate.mousemoveWindow(r,l),w=x&&x.bearingDelta;if(w&&m.setBearing(m.getBearing()+w),this.mousePitch){const A=this.mousePitch.mousemoveWindow(r,l),D=A&&A.pitchDelta;D&&m.setPitch(m.getPitch()+D)}}off(){const r=this.element;r.removeEventListener("mousedown",this.mousedown),r.removeEventListener("touchstart",this.touchstart,{passive:!1}),r.removeEventListener("touchmove",this.touchmove),r.removeEventListener("touchend",this.touchend),r.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){ae(),window.removeEventListener("mousemove",this.mousemove),window.removeEventListener("mouseup",this.mouseup)}mousedown(r){this.down(i.l({},r,{ctrlKey:!0,preventDefault:()=>r.preventDefault()}),Ge(this.element,r)),window.addEventListener("mousemove",this.mousemove),window.addEventListener("mouseup",this.mouseup)}mousemove(r){this.move(r,Ge(this.element,r))}mouseup(r){this.mouseRotate.mouseupWindow(r),this.mousePitch&&this.mousePitch.mouseupWindow(r),this.offTemp()}touchstart(r){r.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=He(this.element,r.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>r.preventDefault()},this._startPos))}touchmove(r){r.targetTouches.length!==1?this.reset():(this._lastPos=He(this.element,r.targetTouches)[0],this.move({preventDefault:()=>r.preventDefault()},this._lastPos))}touchend(r){r.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}function _d(p,r,l){if(p=new i.bO(p.lng,p.lat),r){const m=new i.bO(p.lng-360,p.lat),x=new i.bO(p.lng+360,p.lat),w=360*Math.ceil(Math.abs(p.lng-l.center.lng)/360),A=l.locationPoint(p).distSqr(r),D=r.x<0||r.y<0||r.x>l.width||r.y>l.height;l.locationPoint(m).distSqr(r)<A&&(D||Math.abs(m.lng-l.center.lng)<w)?p=m:l.locationPoint(x).distSqr(r)<A&&(D||Math.abs(x.lng-l.center.lng)<w)&&(p=x)}for(;Math.abs(p.lng-l.center.lng)>180;){const m=l.locationPoint(p);if(m.x>=0&&m.y>=0&&m.x<=l.width&&m.y<=l.height)break;p.lng>l.center.lng?p.lng-=360:p.lng+=360}return p}const Xs={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class Ts extends i.E{constructor(r,l){if(super(),(r instanceof HTMLElement||l)&&(r=i.l({element:r},l)),i.aP(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=r&&r.anchor||"center",this._color=r&&r.color||"#3FB1CE",this._scale=r&&r.scale||1,this._draggable=r&&r.draggable||!1,this._clickTolerance=r&&r.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=r&&r.rotation||0,this._rotationAlignment=r&&r.rotationAlignment||"auto",this._pitchAlignment=r&&r.pitchAlignment&&r.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=r&&r.occludedOpacity||.2,r&&r.element)this._element=r.element,this._offset=i.P.convert(r&&r.offset||[0,0]);else{this._defaultMarker=!0,this._element=J("div");const w=41,A=27,D=ee("svg",{display:"block",height:w*this._scale+"px",width:A*this._scale+"px",viewBox:`0 0 ${A} ${w}`},this._element),N=ee("radialGradient",{id:"shadowGradient"},ee("defs",{},D));ee("stop",{offset:"10%","stop-opacity":.4},N),ee("stop",{offset:"100%","stop-opacity":.05},N),ee("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},D),ee("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},D),ee("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},D),ee("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},D),this._offset=i.P.convert(r&&r.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.hasAttribute("role")||this._element.setAttribute("role","img"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",w=>{w.preventDefault()}),this._element.addEventListener("mousedown",w=>{w.preventDefault()});const m=this._element.classList;for(const w in Xs)m.remove(`mapboxgl-marker-anchor-${w}`);m.add(`mapboxgl-marker-anchor-${this._anchor}`);const x=r&&r.className?r.className.trim().split(/\s+/):[];m.add(...x),this._popup=null}addTo(r){return r===this._map||(this.remove(),this._map=r,r.getCanvasContainer().appendChild(this._element),r.on("move",this._updateMoving),r.on("moveend",this._update),r.on("remove",this._clearFadeTimer),r._addMarker(this),this.setDraggable(this._draggable),this._update(),r.on("click",this._onMapClick)),this}remove(){const r=this._map;return r&&(r.off("click",this._onMapClick),r.off("move",this._updateMoving),r.off("moveend",this._update),r.off("mousedown",this._addDragHandler),r.off("touchstart",this._addDragHandler),r.off("mouseup",this._onUp),r.off("touchend",this._onUp),r.off("mousemove",this._onMove),r.off("touchmove",this._onMove),r.off("remove",this._clearFadeTimer),r._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(r){return this._lngLat=i.bO.convert(r),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(r){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),r){if(!("offset"in r.options)){const x=Math.sqrt(Math.pow(13.5,2)/2);r.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[x,-1*(38.1-13.5+x)],"bottom-right":[-x,-1*(38.1-13.5+x)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=r,r._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(r){const l=r.code,m=r.charCode||r.keyCode;l!=="Space"&&l!=="Enter"&&m!==32&&m!==13||this.togglePopup()}_onMapClick(r){const l=r.originalEvent.target,m=this._element;this._popup&&(l===m||m.contains(l))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const r=this._popup;return r?(r.isOpen()?(r.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(r.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const r=this._map,l=this._pos;if(!r||!l)return!1;const m=r.unproject(l),x=r.getFreeCameraOptions();if(!x.position)return!1;const w=x.position.toLngLat();return w.distanceTo(m)<.9*w.distanceTo(this._lngLat)}_evaluateOpacity(){const r=this._map;if(!r)return;const l=this._pos;if(!l||l.x<0||l.x>r.transform.width||l.y<0||l.y>r.transform.height)return void this._clearFadeTimer();const m=r.unproject(l);let x;r._showingGlobe()&&i.dH(r.transform,this._lngLat)?x=0:(x=1-r._queryFogOpacity(m),r.transform._terrainEnabled()&&r.getTerrain()&&this._behindTerrain()&&(x*=this._occludedOpacity)),this._element.style.opacity=`${x}`,this._element.style.pointerEvents=x>0?"auto":"none",this._popup&&this._popup._setOpacity(x),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const r=this._pos;if(!r||!this._map)return;const l=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${r.x}px,${r.y}px)
            ${Xs[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${l.x}px,${l.y}px)
        `}_calculateXYTransform(){const r=this._pos,l=this._map,m=this.getPitchAlignment();if(!l||!r||m!=="map")return"";if(!l._showingGlobe()){const N=l.getPitch();return N?`rotateX(${N}deg)`:""}const x=i.c4(i.dI(l.transform,this._lngLat)),w=r.sub(i.dJ(l.transform)),A=Math.abs(w.x)+Math.abs(w.y);if(A===0)return"";const D=x/A;return`rotateX(${-w.y*D}deg) rotateY(${w.x*D}deg)`}_calculateZTransform(){const r=this._pos,l=this._map;if(!l||!r)return"";let m=0;const x=this.getRotationAlignment();if(x==="map")if(l._showingGlobe()){const w=l.project(new i.bO(this._lngLat.lng,this._lngLat.lat+.001)),A=l.project(new i.bO(this._lngLat.lng,this._lngLat.lat-.001)).sub(w);m=i.c4(Math.atan2(A.y,A.x))-90}else m=-l.getBearing();else if(x==="horizon"){const w=i.ac(4,6,l.getZoom()),A=i.dJ(l.transform);A.y+=w*l.transform.height;const D=r.sub(A),N=i.c4(Math.atan2(D.y,D.x));m=(N>90?N-270:N+90)*(1-w)}return m+=this._rotation,m?`rotateZ(${m}deg)`:""}_update(r){cancelAnimationFrame(this._updateFrameId);const l=this._map;l&&(l.transform.renderWorldCopies&&(this._lngLat=_d(this._lngLat,this._pos,l.transform)),this._pos=l.project(this._lngLat),r===!0?this._updateFrameId=requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),l._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(l._showingGlobe()||l.getTerrain()||l.getFog())&&!this._fadeTimer&&(this._fadeTimer=window.setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(r){return this._offset=i.P.convert(r),this._update(),this}addClassName(r){return this._element.classList.add(r),this}removeClassName(r){return this._element.classList.remove(r),this}toggleClassName(r){return this._element.classList.toggle(r)}_onMove(r){const l=this._map;if(!l)return;const m=this._pointerdownPos,x=this._positionDelta;if(m&&x){if(!this._isDragging){const w=this._clickTolerance||l._clickTolerance;if(r.point.dist(m)<w)return;this._isDragging=!0}this._pos=r.point.sub(x),this._lngLat=l.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new i.z("dragstart"))),this.fire(new i.z("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const r=this._map;r&&(r.off("mousemove",this._onMove),r.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new i.z("dragend")),this._state="inactive"}_addDragHandler(r){const l=this._map,m=this._pos;l&&m&&this._element.contains(r.originalEvent.target)&&(r.preventDefault(),this._positionDelta=r.point.sub(m),this._pointerdownPos=r.point,this._state="pending",l.on("mousemove",this._onMove),l.on("touchmove",this._onMove),l.once("mouseup",this._onUp),l.once("touchend",this._onUp))}setDraggable(r){this._draggable=!!r;const l=this._map;return l&&(r?(l.on("mousedown",this._addDragHandler),l.on("touchstart",this._addDragHandler)):(l.off("mousedown",this._addDragHandler),l.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(r){return this._rotation=r||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(r){return this._rotationAlignment=r||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(r){return this._pitchAlignment=r||"auto",this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(r){return this._occludedOpacity=r||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const Fa={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},no={maxWidth:100,unit:"metric"},qi={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},ml={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Br=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function gd(p=new i.P(0,0),r="bottom"){if(typeof p=="number"){const l=Math.round(Math.sqrt(.5*Math.pow(p,2)));switch(r){case"top":return new i.P(0,p);case"top-left":return new i.P(l,l);case"top-right":return new i.P(-l,l);case"bottom":return new i.P(0,-p);case"bottom-left":return new i.P(l,-l);case"bottom-right":return new i.P(-l,-l);case"left":return new i.P(p,0);case"right":return new i.P(-p,0)}return new i.P(0,0)}return p instanceof i.P||Array.isArray(p)?i.P.convert(p):i.P.convert(p[r]||[0,0])}return{version:C,supported:Y.supported,setRTLTextPlugin:i.dK,getRTLTextPluginStatus:i.dL,Map:class extends qc{constructor(p){j.mark(I.create);const r=p;if((p=i.l({},Xl,p)).minZoom!=null&&p.maxZoom!=null&&p.minZoom>p.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(p.minPitch!=null&&p.maxPitch!=null&&p.minPitch>p.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(p.minPitch!=null&&p.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(p.maxPitch!=null&&p.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(p.antialias&&i.dF(window)&&(p.antialias=!1,i.w("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new Gf(p.minZoom,p.maxZoom,p.minPitch,p.maxPitch,p.renderWorldCopies),p),this._repaint=!!p.repaint,this._interactive=p.interactive,this._minTileCacheSize=p.minTileCacheSize,this._maxTileCacheSize=p.maxTileCacheSize,this._failIfMajorPerformanceCaveat=p.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=p.preserveDrawingBuffer,this._antialias=p.antialias,this._trackResize=p.trackResize,this._bearingSnap=p.bearingSnap,this._refreshExpiredTiles=p.refreshExpiredTiles,this._fadeDuration=p.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=p.crossSourceCollisions,this._collectResourceTiming=p.collectResourceTiming,this._language=this._parseLanguage(p.language),this._worldview=p.worldview,this._renderTaskQueue=new Ya,this._domRenderTaskQueue=new Ya,this._controls=[],this._markers=[],this._popups=[],this._mapId=i.aV(),this._locale=i.l({},Gc,p.locale),this._clickTolerance=p.clickTolerance,this._cooperativeGestures=p.cooperativeGestures,this._performanceMetricsCollection=p.performanceMetricsCollection,this._tessellationStep=p.tessellationStep,this._containerWidth=0,this._containerHeight=0,this._showParseStatus=!0,this._precompilePrograms=p.precompilePrograms,this._scaleFactorChanged=!1,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new Uu(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._frameId=0,this._scaleFactor=p.scaleFactor,this._requestManager=new jt(p.transformRequest,p.accessToken,p.testMode),this._silenceAuthErrors=!!p.testMode,this._contextCreateOptions=p.contextCreateOptions?Object.assign({},p.contextCreateOptions):{},typeof p.container=="string"){const l=document.getElementById(p.container);if(!l)throw new Error(`Container '${p.container.toString()}' not found.`);this._container=l}else{if(!(p.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=p.container}if(this._container.childNodes.length>0&&i.w("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),p.maxBounds&&this.setMaxBounds(p.maxBounds),this._spriteFormat=p.spriteFormat,i.aP(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._tp||(this._tp=new Vh),this._tp.registerParameter(this,["Debug"],"showOverdrawInspector"),this._tp.registerParameter(this,["Debug"],"showTileBoundaries"),this._tp.registerParameter(this,["Debug"],"showParseStatus"),this._tp.registerParameter(this,["Debug"],"repaint"),this._tp.registerParameter(this,["Debug"],"showTileAABBs"),this._tp.registerParameter(this,["Debug"],"showPadding"),this._tp.registerParameter(this,["Debug"],"showCollisionBoxes",{noSave:!0}),this._tp.registerParameter(this.transform,["Debug"],"freezeTileCoverage",{noSave:!0},()=>{this._update()}),this._tp.registerParameter(this,["Debug","Wireframe"],"showTerrainWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers2DWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers3DWireframe"),this._tp.registerParameter(this,["Scaling"],"_scaleFactor",{min:.1,max:10,step:.1},()=>{this.setScaleFactor(this._scaleFactor)}),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");if(this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this._fullscreenchangeEvent="onfullscreenchange"in document?"fullscreenchange":"webkitfullscreenchange",window.addEventListener("online",this._onWindowOnline,!1),window.addEventListener("resize",this._onWindowResize,!1),window.addEventListener("orientationchange",this._onWindowResize,!1),window.addEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.addEventListener("visibilitychange",this._onVisibilityChange,!1),this.handlers=new Wl(this,p),this._localFontFamily=p.localFontFamily,this._localIdeographFontFamily=p.localIdeographFontFamily,(p.style||!p.testMode)&&this.setStyle(p.style||i.e.DEFAULT_STYLE,{config:p.config,localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),p.projection&&this.setProjection(p.projection),this.indoor=new yc(this),p.hash&&(this._hash=new hd(typeof p.hash=="string"&&p.hash||void 0).addTo(this)),!this._hash||!this._hash._onHashChange()){r.center==null&&r.zoom==null||(this.transform._unmodified=!1),this.jumpTo({center:p.center,zoom:p.zoom,bearing:p.bearing,pitch:p.pitch});const l=p.bounds;l&&(this.resize(),this.fitBounds(l,i.l({},p.fitBoundsOptions,{duration:0})))}this.resize(),p.attributionControl&&this.addControl(new Xh({customAttribution:p.customAttribution})),this._logoControl=new Xa,this.addControl(this._logoControl,p.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet),this._postStyleLoadEvent()}),this.on("data",l=>{this._update(l.dataType==="style"),this.fire(new i.z(`${l.dataType}data`,l))}),this.on("dataloading",l=>{this.fire(new i.z(`${l.dataType}dataloading`,l))}),this._interactions=new pl(this)}_getMapId(){return this._mapId}addControl(p,r){if(r===void 0&&(r=p.getDefaultPosition?p.getDefaultPosition():"top-right"),!p||!p.onAdd)return this.fire(new i.y(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const l=p.onAdd(this);this._controls.push(p);const m=this._controlPositions[r];return r.indexOf("bottom")!==-1?m.insertBefore(l,m.firstChild):m.appendChild(l),this}removeControl(p){if(!p||!p.onRemove)return this.fire(new i.y(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const r=this._controls.indexOf(p);return r>-1&&this._controls.splice(r,1),p.onRemove(this),this}hasControl(p){return this._controls.indexOf(p)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(p){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const r=!this._moving;return r&&this.fire(new i.z("movestart",p)).fire(new i.z("move",p)),this.fire(new i.z("resize",p)),r&&this.fire(new i.z("moveend",p)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(p){return this.transform.setMaxBounds(i.az.convert(p)),this._update()}setMinZoom(p){if((p=p??-2)>=-2&&p<=this.transform.maxZoom)return this.transform.minZoom=p,this._update(),this.getZoom()<p?this.setZoom(p):this.fire(new i.z("zoomstart")).fire(new i.z("zoom")).fire(new i.z("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(p){if((p=p??22)>=this.transform.minZoom)return this.transform.maxZoom=p,this._update(),this.getZoom()>p?this.setZoom(p):this.fire(new i.z("zoomstart")).fire(new i.z("zoom")).fire(new i.z("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(p){if((p=p??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(p>=0&&p<=this.transform.maxPitch)return this.transform.minPitch=p,this._update(),this.getPitch()<p?this.setPitch(p):this.fire(new i.z("pitchstart")).fire(new i.z("pitch")).fire(new i.z("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(p){if((p=p??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(p>=this.transform.minPitch)return this.transform.maxPitch=p,this._update(),this.getPitch()>p?this.setPitch(p):this.fire(new i.z("pitchstart")).fire(new i.z("pitch")).fire(new i.z("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getScaleFactor(){return this._scaleFactor}setScaleFactor(p){return this._scaleFactor=p,this.painter.scaleFactor=p,this._tp.refreshUI(),this._scaleFactorChanged=!0,this.style._updateFilteredLayers(r=>r.type==="symbol"),this._update(!0),this}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(p){return this.transform.renderWorldCopies=p,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(p){return p==="auto"?navigator.language:Array.isArray(p)?p.length===0?void 0:p.map(r=>r==="auto"?navigator.language:r):p}setLanguage(p){const r=this._parseLanguage(p);if(!this.style||r===this._language)return this;this._language=r,this.style.reloadSources();for(const l of this._controls)l._setLanguage&&l._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(p){return this.style&&p!==this._worldview?(this._worldview=p,this.style.reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(p){return this._lazyInitEmptyStyle(),p?typeof p=="string"&&(p={name:p}):p=null,this._useExplicitProjection=!!p,this._prioritizeAndUpdateProjection(p,this.style.projection)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const p=this.transform,r=p.projection.name;let l;r==="globe"&&p.zoom>=i.bY?(p.setMercatorFromTransition(),l=!0):r==="mercator"&&p.zoom<i.bY&&(p.setProjection({name:"globe"}),l=!0),l&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(p,r){return this._updateProjection(p||r||{name:"mercator"})}_updateProjection(p){let r;return r=p.name==="globe"&&this.transform.zoom>=i.bY?this.transform.setMercatorFromTransition():this.transform.setProjection(p),this.style.applyProjectionUpdate(),r&&(this.painter.clearBackgroundTiles(),this.style.clearSources(),this._update(!0),this._forceMarkerAndPopupUpdate(!0)),this}project(p){return this.transform.locationPoint3D(i.bO.convert(p))}unproject(p){return this.transform.pointLocation3D(i.P.convert(p))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(p,r,l){const m=x=>{let w=[];if(Array.isArray(r)){const A=r.filter(D=>this.getLayer(D));w=A.length?this.queryRenderedFeatures(x,{layers:A}):[]}else w=this.queryRenderedFeatures(x,{target:r});return w};if(p==="mouseenter"||p==="mouseover"){let x=!1;return{listener:l,targets:r,delegates:{mousemove:A=>{const D=m(A.point);D.length?x||(x=!0,l.call(this,new _o(p,this,A.originalEvent,{features:D}))):x=!1},mouseout:()=>{x=!1}}}}if(p==="mouseleave"||p==="mouseout"){let x=!1;return{listener:l,targets:r,delegates:{mousemove:D=>{m(D.point).length?x=!0:x&&(x=!1,l.call(this,new _o(p,this,D.originalEvent)))},mouseout:D=>{x&&(x=!1,l.call(this,new _o(p,this,D.originalEvent)))}}}}{const x=w=>{const A=m(w.point);A.length&&(w.features=A,l.call(this,w),delete w.features)};return{listener:l,targets:r,delegates:{[p]:x}}}}on(p,r,l){if(typeof r=="function"||l===void 0)return super.on(p,r);if(typeof r=="string"&&(r=[r]),!this._areTargetsValid(r))return this;const m=this._createDelegatedListener(p,r,l);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[p]=this._delegatedListeners[p]||[],this._delegatedListeners[p].push(m);for(const x in m.delegates)this.on(x,m.delegates[x]);return this}once(p,r,l){if(typeof r=="function"||l===void 0)return super.once(p,r);if(typeof r=="string"&&(r=[r]),!this._areTargetsValid(r))return this;const m=this._createDelegatedListener(p,r,l);for(const x in m.delegates)this.once(x,m.delegates[x]);return this}off(p,r,l){if(typeof r=="function"||l===void 0)return super.off(p,r);if(typeof r=="string"&&(r=[r]),!this._areTargetsValid(r))return this;const m=this._delegatedListeners?this._delegatedListeners[p]:void 0;return m&&(x=>{for(let w=0;w<x.length;w++){const A=x[w];if(A.listener===l&&pr(A.targets,r)){for(const D in A.delegates)this.off(D,A.delegates[D]);return x.splice(w,1),this}}})(m),this}queryRenderedFeatures(p,r){if(!this.style)return[];if(p===void 0||p instanceof i.P||Array.isArray(p)||r!==void 0||(r=p,p=void 0),p=p||[[0,0],[this.transform.width,this.transform.height]],!r){const w=this.style.queryRenderedFeatures(p,void 0,this.transform),A=this.style.queryRenderedFeatureset(p,void 0,this.transform);return w.concat(A)}let l=!0;if(r.target&&(l=this._isTargetValid(r.target),l&&!r.layers))return this.style.queryRenderedFeatureset(p,r,this.transform);let m=!0;if(r.layers&&Array.isArray(r.layers)){for(const w of r.layers)if(!this._isValidId(w)){m=!1;break}if(m&&!r.target)return this.style.queryRenderedFeatures(p,r,this.transform)}let x=[];return m&&(x=x.concat(this.style.queryRenderedFeatures(p,r,this.transform))),l&&(x=x.concat(this.style.queryRenderedFeatureset(p,r,this.transform))),x}querySourceFeatures(p,r){return!p||typeof p=="string"&&!this._isValidId(p)?[]:this.style.querySourceFeatures(p,r)}isPointOnSurface(p){const{name:r}=this.transform.projection;return r!=="globe"&&r!=="mercator"&&i.w(`${r} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(i.P.convert(p))}addInteraction(p,r){return this._interactions.add(p,r),this}removeInteraction(p){return this._interactions.remove(p),this}setStyle(p,r){return r=i.l({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},r),this.style&&p&&r.diff!==!1&&r.localFontFamily===this._localFontFamily&&r.localIdeographFontFamily===this._localIdeographFontFamily&&!r.config?(this.style._diffStyle(p,(l,m)=>{l?(i.w(`Unable to perform style diff: ${String(l.message||l.error||l)}. Rebuilding the style from scratch.`),this._updateStyle(p,r)):m&&this._update(!0)},()=>{this._postStyleLoadEvent()}),this):(this._localIdeographFontFamily=r.localIdeographFontFamily,this._localFontFamily=r.localFontFamily,this._updateStyle(p,r))}_getUIString(p){const r=this._locale[p];if(r==null)throw new Error(`Missing UI string '${p}'`);return r}_updateStyle(p,r){if(this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),p){const l=i.l({},r);r&&r.config&&(l.initialConfig=r.config,delete l.config),this.style=new La(this,l).load(p),this.style.setEventedParent(this,{style:this.style})}return this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new La(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(i.w("There is no style added to the map."),!1)}_isValidId(p){return p==null?(this.fire(new i.y(new Error("IDs can't be empty."))),!1):!i.cr(p)||(this.fire(new i.y(new Error(`IDs can't contain special symbols: "${p}".`))),!1)}_isTargetValid(p){return"featuresetId"in p?this._isValidId("importId"in p?p.importId:p.featuresetId):"layerId"in p&&this._isValidId(p.layerId)}_areTargetsValid(p){if(Array.isArray(p)){for(const r of p)if(!this._isValidId(r))return!1;return!0}return this._isTargetValid(p)}addSource(p,r){return this._isValidId(p)?(this._lazyInitEmptyStyle(),this.style.addSource(p,r),this._update(!0)):this}isSourceLoaded(p){return!!this._isValidId(p)&&!!this.style&&this.style._isSourceCacheLoaded(p)}areTilesLoaded(){return this.style.areTilesLoaded()}addSourceType(p,r,l){this._lazyInitEmptyStyle(),this.style.addSourceType(p,r,l)}removeSource(p){return this._isValidId(p)?(this.style.removeSource(p),this._updateTerrain(),this._update(!0)):this}getSource(p){return this._isValidId(p)?this.style.getOwnSource(p):null}addImage(p,r,{pixelRatio:l=1,sdf:m=!1,stretchX:x,stretchY:w,content:A}={}){if(this._lazyInitEmptyStyle(),r instanceof HTMLImageElement||ImageBitmap&&r instanceof ImageBitmap){const{width:D,height:N,data:U}=i.q.getImageData(r);this.style.addImage(p,{data:new i.r({width:D,height:N},U),pixelRatio:l,stretchX:x,stretchY:w,content:A,sdf:m,version:0,usvg:!1})}else if(r.width===void 0||r.height===void 0)this.fire(new i.y(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:D,height:N}=r,U=r;this.style.addImage(p,{data:new i.r({width:D,height:N},new Uint8Array(U.data)),pixelRatio:l,stretchX:x,stretchY:w,content:A,sdf:m,usvg:!1,version:0,userImage:U}),U.onAdd&&U.onAdd(this,p)}}updateImage(p,r){this._lazyInitEmptyStyle();const l=this.style.getImage(p);if(!l)return void this.fire(new i.y(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const m=r instanceof HTMLImageElement||ImageBitmap&&r instanceof ImageBitmap?i.q.getImageData(r):r,{width:x,height:w,data:A}=m;if(x===void 0||w===void 0)return void this.fire(new i.y(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(x!==(l.usvg?l.icon.usvg_tree.width:l.data.width)||w!==(l.usvg?l.icon.usvg_tree.height:l.data.height))return void this.fire(new i.y(new Error(`The width and height of the updated image (${x}, ${w})
                must be that same as the previous version of the image
                (${l.data.width}, ${l.data.height})`)));const D=!(r instanceof HTMLImageElement||ImageBitmap&&r instanceof ImageBitmap);let N=!1;l.usvg?(l.data=new i.r({width:x,height:w},new Uint8Array(A)),l.usvg=!1,l.icon=void 0,N=!0):l.data.replace(A,D),this.style.updateImage(p,l,N)}hasImage(p){return p?!!this.style&&!!this.style.getImage(p):(this.fire(new i.y(new Error("Missing required image id"))),!1)}removeImage(p){this.style.removeImage(p)}loadImage(p,r){i.o(this._requestManager.transformRequest(p,i.R.Image),(l,m)=>{r(l,m instanceof HTMLImageElement?i.q.getImageData(m):m)})}listImages(){return this.style.listImages()}addModel(p,r){this._lazyInitEmptyStyle(),this.style.addModel(p,r)}hasModel(p){return p?this.style.hasModel(p):(this.fire(new i.y(new Error("Missing required model id"))),!1)}removeModel(p){this.style.removeModel(p)}listModels(){return this.style.listModels()}addLayer(p,r){return this._isValidId(p.id)?(this._lazyInitEmptyStyle(),this.style.addLayer(p,r),this._update(!0)):this}getSlot(p){const r=this.getLayer(p);return r&&r.slot||null}setSlot(p,r){return this.style.setSlot(p,r),this.style.mergeLayers(),this._update(!0)}addImport(p,r){return this.style.addImport(p,r),this}updateImport(p,r){return typeof r!="string"&&r.id!==p?(this.removeImport(p),this.addImport(r)):(this.style.updateImport(p,r),this._update(!0))}removeImport(p){return this.style.removeImport(p),this}moveImport(p,r){return this.style.moveImport(p,r),this._update(!0)}moveLayer(p,r){return this._isValidId(p)?(this.style.moveLayer(p,r),this._update(!0)):this}removeLayer(p){return this._isValidId(p)?(this.style.removeLayer(p),this._update(!0)):this}getLayer(p){if(!this._isValidId(p))return null;const r=this.style.getOwnLayer(p);return r?r.type==="custom"?r.implementation:r.serialize():void 0}getSlots(){return this.style.getSlots()}setLayerZoomRange(p,r,l){return this._isValidId(p)?(this.style.setLayerZoomRange(p,r,l),this._update(!0)):this}setFilter(p,r,l={}){return this._isValidId(p)?(this.style.setFilter(p,r,l),this._update(!0)):this}getFilter(p){return this._isValidId(p)?this.style.getFilter(p):null}setPaintProperty(p,r,l,m={}){return this._isValidId(p)?(this.style.setPaintProperty(p,r,l,m),this._update(!0)):this}getPaintProperty(p,r){return this._isValidId(p)?this.style.getPaintProperty(p,r):null}setLayoutProperty(p,r,l,m={}){return this._isValidId(p)?(this.style.setLayoutProperty(p,r,l,m),this._update(!0)):this}getLayoutProperty(p,r){return this._isValidId(p)?this.style.getLayoutProperty(p,r):null}getSchema(p){return this.style.getSchema(p)}setSchema(p,r){return this.style.setSchema(p,r),this._update(!0)}getConfig(p){return this.style.getConfig(p)}setConfig(p,r){return this.style.setConfig(p,r),this._update(!0)}getConfigProperty(p,r){return this.style.getConfigProperty(p,r)}setConfigProperty(p,r,l){return this.style.setConfigProperty(p,r,l),this._update(!0)}getFeaturesetDescriptors(p){return this.style.getFeaturesetDescriptors(p)}setLights(p){if(this._lazyInitEmptyStyle(),p&&p.length===1&&p[0].type==="flat"){const r=p[0];r.properties?this.style.setFlatLight(r.properties,r.id,{}):this.style.setFlatLight({},"flat")}else this.style.setLights(p),this.painter.terrain&&(this.painter.terrain.invalidateRenderCache=!0);return this._update(!0)}getLights(){const p=this.style.getLights()||[];return p.length===0&&p.push({id:this.style.light.id,type:"flat",properties:this.style.getFlatLight()}),p}setLight(p,r={}){return console.log("The `map.setLight` function is deprecated, prefer using `map.setLights` with `flat` light type instead."),this.setLights([{id:"flat",type:"flat",properties:p}])}getLight(){return console.log("The `map.getLight` function is deprecated, prefer using `map.getLights` instead."),this.style.getFlatLight()}setTerrain(p){return this._lazyInitEmptyStyle(),!p&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(p),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(p){return this._lazyInitEmptyStyle(),this.style.setFog(p),this._update(!0)}getFog(){return this.style?this.style.getFog():null}setSnow(p){return this._lazyInitEmptyStyle(),this.style.setSnow(p),this._update(!0)}getSnow(){return this.style?this.style.getSnow():null}setRain(p){return this._lazyInitEmptyStyle(),this.style.setRain(p),this._update(!0)}getRain(){return this.style?this.style.getRain():null}setColorTheme(p){return this._lazyInitEmptyStyle(),this.style.setColorTheme(p),this._update(!0)}setImportColorTheme(p,r){return this._lazyInitEmptyStyle(),this.style.setImportColorTheme(p,r),this._update(!0)}setCamera(p){return this.style.setCamera(p),this._triggerCameraUpdate(p)}_triggerCameraUpdate(p){return this._update(this.transform.setOrthographicProjectionAtLowPitch(p["camera-projection"]==="orthographic"))}getCamera(){return this.style.camera}_queryFogOpacity(p){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(i.bO.convert(p),this.transform):0}setFeatureState(p,r){return p.source&&!this._isValidId(p.source)?this:(this.style.setFeatureState(p,r),this._update())}removeFeatureState(p,r){return p.source&&!this._isValidId(p.source)?this:(this.style.removeFeatureState(p,r),this._update())}getFeatureState(p){return p.source&&!this._isValidId(p.source)?null:this.style.getFeatureState(p)}_updateContainerDimensions(){if(!this._container)return;const p=this._container.getBoundingClientRect().width||400,r=this._container.getBoundingClientRect().height||300;let l,m,x,w=this._container;for(;w&&(!m||!x);){const A=window.getComputedStyle(w).transform;A&&A!=="none"&&(l=A.match(/matrix.*\((.+)\)/)[1].split(", "),l[0]&&l[0]!=="0"&&l[0]!=="1"&&(m=l[0]),l[3]&&l[3]!=="0"&&l[3]!=="1"&&(x=l[3])),w=w.parentElement}this._containerWidth=m?Math.abs(p/m):p,this._containerHeight=x?Math.abs(r/x):r}_detectMissingCSS(){window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&i.w("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const p=this._container;p.classList.add("mapboxgl-map"),(this._missingCSSCanary=J("div","mapboxgl-canary",p)).style.visibility="hidden",this._detectMissingCSS();const r=this._canvasContainer=J("div","mapboxgl-canvas-container",p);this._canvas=J("canvas","mapboxgl-canvas",r),this._interactive&&(r.classList.add("mapboxgl-interactive"),this._canvas.setAttribute("tabindex","0")),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const l=this._controlContainer=J("div","mapboxgl-control-container",p),m=this._controlPositions={};["top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"].forEach(x=>{m[x]=J("div",`mapboxgl-ctrl-${x}`,l)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(p,r){const l=i.q.devicePixelRatio||1;this._canvas.width=l*Math.ceil(p),this._canvas.height=l*Math.ceil(r),this._canvas.style.width=`${p}px`,this._canvas.style.height=`${r}px`}_addMarker(p){this._markers.push(p)}_removeMarker(p){const r=this._markers.indexOf(p);r!==-1&&this._markers.splice(r,1)}_addPopup(p){this._popups.push(p)}_removePopup(p){const r=this._popups.indexOf(p);r!==-1&&this._popups.splice(r,1)}_setupPainter(){const p=i.l({},Y.supported.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),r=this._canvas.getContext("webgl2",p);r?(fn(r,!0),this.painter=new Lp(r,this._contextCreateOptions,this.transform,this._scaleFactor,this._tp),this.on("data",l=>{l.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),i.m.testSupport(r)):this.fire(new i.y(new Error("Failed to initialize WebGL")))}_contextLost(p){p.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new i.z("webglcontextlost",{originalEvent:p}))}_contextRestored(p){this._setupPainter(),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight)),this._updateTerrain(),this.style.reloadModels(),this.style.clearSources(),this._update(),this.fire(new i.z("webglcontextrestored",{originalEvent:p}))}_onMapScroll(p){if(p.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}idle(){return!this.isMoving()&&this.loaded()}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}frameReady(){return this.loaded()&&!this._placementDirty}_update(p){return this.style?(this._styleDirty=this._styleDirty||p,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(p){return this._update(),this._renderTaskQueue.add(p)}_cancelRenderFrame(p){this._renderTaskQueue.remove(p)}_requestDomTask(p){!this.loaded()||this.loaded()&&!this.isMoving()?p():this._domRenderTaskQueue.add(p)}_render(p){let r;this.fire(new i.z("renderstart")),++this._frameId;const l=this.painter.context.extTimerQuery,m=i.q.now(),x=this.painter.context.gl;if(this.listens("gpu-timing-frame")&&(r=x.createQuery(),x.beginQuery(l.TIME_ELAPSED_EXT,r)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],performance.now())),this._renderTaskQueue.run(p),this._domRenderTaskQueue.run(p),this._removed)return;this._updateProjectionTransition();const w=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const U=this.transform.zoom,$=this.transform.pitch,Z=i.q.now(),W=new i.a8(U,{now:Z,fadeDuration:w,pitch:$,transition:this.style.transition});this.style.update(W)}this.style&&this.style.hasFogTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let A=!1;this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),A=this._updateAverageElevation(m),this.style.updateSources(this.transform),this._forceMarkerAndPopupUpdate()):A=this._updateAverageElevation(m);const D=this.style&&this.style._updatePlacement(this.painter,this.painter.transform,this.showCollisionBoxes,w,this._crossSourceCollisions,this.painter.replacementSource,this._scaleFactorChanged);if(this._scaleFactorChanged&&(this._scaleFactorChanged=!1),D&&(this._placementDirty=D.needsRerender),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showParseStatus:this.showParseStatus,wireframe:{terrain:this.showTerrainWireframe,layers2D:this.showLayers2DWireframe,layers3D:this.showLayers3DWireframe},showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:w,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new i.z("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,j.mark(I.load),this.fire(new i.z("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&(this.style.snow||this.style.rain)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),r){const U=i.q.now()-m;x.endQuery(l.TIME_ELAPSED_EXT),setTimeout(()=>{const $=x.getQueryParameter(r,x.QUERY_RESULT)/1e6;x.deleteQuery(r),this.fire(new i.z("gpu-timing-frame",{cpuTime:U,gpuTime:$}))},50)}if(this.listens("gpu-timing-layer")){const U=this.painter.collectGpuTimers();setTimeout(()=>{const $=this.painter.queryGpuTimers(U);this.fire(new i.z("gpu-timing-layer",{layerTimes:$}))},50)}if(this.listens("gpu-timing-deferred-render")){const U=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const $=this.painter.queryGpuTimeDeferredRender(U);this.fire(new i.z("gpu-timing-deferred-render",{gpuTime:$}))},50)}const N=this._sourcesDirty||this._styleDirty||this._placementDirty||A;if(N||this._repaint)this.triggerRepaint();else{const U=this.idle();if(U&&(A=this._updateAverageElevation(m,!0)),A)this.triggerRepaint();else if(this._triggerFrame(!1),U&&(this.fire(new i.z("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const $=this._calculateSpeedIndex();this.fire(new i.z("speedindexcompleted",{speedIndex:$})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||N||(this._fullyLoaded=!0,j.mark(I.fullLoad),this._performanceMetricsCollection&&ir(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(p){for(const r of this._markers)p&&!this.getRenderWorldCopies()&&(r._lngLat=r._lngLat.wrap()),r._update();for(const r of this._popups)!p||this.getRenderWorldCopies()||r._trackPointer||(r._lngLat=r._lngLat.wrap()),r._update()}_updateAverageElevation(p,r=!1){const l=x=>(this.transform.averageElevation=x,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&l(0);const m=this.transform.elevation&&this.transform.elevation.exaggeration()!==this._averageElevationExaggeration;if(m||(r||p-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(p)){const x=this.transform.averageElevation;let w=this.transform.sampleAverageElevation();this.transform.elevation!=null&&(this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(w)?w=0:this._averageElevationLastSampledAt=p;const A=Math.abs(x-w);if(A>1){if(this._isInitialLoad||m)return this._averageElevation.jumpTo(w),l(w);this._averageElevation.easeTo(w,p,300)}else if(A>1e-4)return this._averageElevation.jumpTo(w),l(w)}return!!this._averageElevation.isEasing(p)&&l(this._averageElevation.getValue(p))}_authenticate(){Ne(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,p=>{if(p&&(p.message===vt||p.status===401)){const r=this.painter.context.gl;fn(r,!1),this._logoControl instanceof Xa&&this._logoControl._updateLogo(),r&&r.clear(r.DEPTH_BUFFER_BIT|r.COLOR_BUFFER_BIT|r.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new i.y(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),xn(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_postStyleLoadEvent(){this.style.globalId&&Xn(this._requestManager._customAccessToken,{map:this,skuToken:this._requestManager._skuToken,style:this.style.globalId,importedStyles:this.style.getImportGlobalIds()})}_updateTerrain(){const p=this._isDragging();this.painter.updateTerrain(this.style,p)}_calculateSpeedIndex(){const p=this.painter.canvasCopy(),r=this.painter.getCanvasCopiesAndTimestamps();r.timeStamps.push(performance.now());const l=this.painter.context.gl,m=l.createFramebuffer();function x(w){l.framebufferTexture2D(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0,l.TEXTURE_2D,w,0);const A=new Uint8Array(l.drawingBufferWidth*l.drawingBufferHeight*4);return l.readPixels(0,0,l.drawingBufferWidth,l.drawingBufferHeight,l.RGBA,l.UNSIGNED_BYTE,A),A}return l.bindFramebuffer(l.FRAMEBUFFER,m),this._canvasPixelComparison(x(p),r.canvasCopies.map(x),r.timeStamps)}_canvasPixelComparison(p,r,l){let m=l[1]-l[0];const x=p.length/4;for(let w=0;w<r.length;w++){const A=r[w];let D=0;for(let N=0;N<A.length;N+=4)A[N]===p[N]&&A[N+1]===p[N+1]&&A[N+2]===p[N+2]&&A[N+3]===p[N+3]&&(D+=1);m+=(l[w+2]-l[w+1])*(1-D/x)}return m}remove(){this._hash&&this._hash.remove();for(const r of this._controls)r.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.indoor.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),window.removeEventListener("resize",this._onWindowResize,!1),window.removeEventListener("orientationchange",this._onWindowResize,!1),window.removeEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.removeEventListener("online",this._onWindowOnline,!1),window.removeEventListener("visibilitychange",this._onVisibilityChange,!1);const p=this.painter.context.gl.getExtension("WEBGL_lose_context");p&&p.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),Qn.delete(this.painter.context.gl),yn.remove(),Nt.remove(),this._removed=!0,this.fire(new i.z("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(p){this._renderNextFrame=this._renderNextFrame||p,this.style&&!this._frame&&(this._frame=i.q.frame(r=>{const l=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,l&&this._render(r)}))}_preloadTiles(p){const r=this.style?this.style.getSourceCaches():[];return i.bl(r,(l,m)=>l._preloadTiles(p,m),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(p){this._trackResize&&this.resize({originalEvent:p})._update()}_onVisibilityChange(){document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(p){this._showTileBoundaries!==p&&(this._showTileBoundaries=p,this._tp.refreshUI(),this._update())}get showParseStatus(){return!!this._showParseStatus}set showParseStatus(p){this._showParseStatus!==p&&(this._showParseStatus=p,this._tp.refreshUI(),this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(p){this._showTerrainWireframe!==p&&(this._showTerrainWireframe=p,this._tp.refreshUI(),this._update())}get showLayers2DWireframe(){return!!this._showLayers2DWireframe}set showLayers2DWireframe(p){this._showLayers2DWireframe!==p&&(this._showLayers2DWireframe=p,this._tp.refreshUI(),this._update())}get showLayers3DWireframe(){return!!this._showLayers3DWireframe}set showLayers3DWireframe(p){this._showLayers3DWireframe!==p&&(this._showLayers3DWireframe=p,this._tp.refreshUI(),this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(p){this._speedIndexTiming!==p&&(this._speedIndexTiming=p,this._update())}get showPadding(){return!!this._showPadding}set showPadding(p){this._showPadding!==p&&(this._showPadding=p,this._tp.refreshUI(),this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(p){this._showCollisionBoxes!==p&&(this._showCollisionBoxes=p,this._tp.refreshUI(),p?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(p){this._showOverdrawInspector!==p&&(this._showOverdrawInspector=p,this._tp.refreshUI(),this._update())}get repaint(){return!!this._repaint}set repaint(p){this._repaint!==p&&(this._repaint=p,this._tp.refreshUI(),this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(p){this._vertices=p,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(p){this._showTileAABBs!==p&&(this._showTileAABBs=p,this._tp.refreshUI(),p&&this._update())}_setCacheLimits(p,r){i.dG(p,r)}get version(){return C}},NavigationControl:class{constructor(p={}){this.options=i.l({},Vu,p),this._container=J("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",r=>r.preventDefault()),this.options.showZoom&&(i.aP(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",r=>{this._map&&this._map.zoomIn({},{originalEvent:r})}),J("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",r=>{this._map&&this._map.zoomOut({},{originalEvent:r})}),J("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(i.aP(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",r=>{const l=this._map;l&&(this.options.visualizePitch?l.resetNorthPitch({},{originalEvent:r}):l.resetNorth({},{originalEvent:r}))}),this._compassIcon=J("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const p=this._map;if(!p)return;const r=p.getZoom(),l=r===p.getMaxZoom(),m=r===p.getMinZoom();this._zoomInButton.disabled=l,this._zoomOutButton.disabled=m,this._zoomInButton.setAttribute("aria-disabled",l.toString()),this._zoomOutButton.setAttribute("aria-disabled",m.toString())}_rotateCompassArrow(){const p=this._map;if(!p)return;const r=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(p.transform.pitch*(Math.PI/180)),.5)}) rotateX(${p.transform.pitch}deg) rotateZ(${p.transform.angle*(180/Math.PI)}deg)`:`rotate(${p.transform.angle*(180/Math.PI)}deg)`;p._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=r)})}onAdd(p){return this._map=p,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),p.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&p.on("pitch",this._rotateCompassArrow),p.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Yo(p,this._compass,this.options.visualizePitch)),this._container}onRemove(){const p=this._map;p&&(this._container.remove(),this.options.showZoom&&p.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&p.off("pitch",this._rotateCompassArrow),p.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(p,r){const l=J("button",p,this._container);return l.type="button",l.addEventListener("click",r),l}_setButtonTitle(p,r){if(!this._map)return;const l=this._map._getUIString(`NavigationControl.${r}`);p.setAttribute("aria-label",l),p.firstElementChild&&p.firstElementChild.setAttribute("title",l)}},GeolocateControl:class extends i.E{constructor(p={}){super();const r=navigator.geolocation;this.options=i.l({geolocation:r},Fa,p),i.aP(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=ud(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(p){return this._map=p,this._container=J("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(p){const r=(l=!!this.options.geolocation)=>{this._supportsGeolocation=l,p(l)};this._supportsGeolocation!==void 0?p(this._supportsGeolocation):navigator.permissions!==void 0?navigator.permissions.query({name:"geolocation"}).then(l=>r(l.state!=="denied")).catch(()=>r()):r()}_isOutOfMapMaxBounds(p){const r=this._map.getMaxBounds(),l=p.coords;return!!r&&(l.longitude<r.getWest()||l.longitude>r.getEast()||l.latitude<r.getSouth()||l.latitude>r.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(p){if(this._map){if(this._isOutOfMapMaxBounds(p))return this._setErrorState(),this.fire(new i.z("outofmaxbounds",p)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=p,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(p),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(p),this.options.showUserLocation&&this._userLocationDotMarker.removeClassName("mapboxgl-user-location-dot-stale"),this.fire(new i.z("geolocate",p)),this._finish()}}_updateCamera(p){const r=new i.bO(p.coords.longitude,p.coords.latitude),l=p.coords.accuracy,m=this._map.getBearing(),x=i.l({bearing:m},this.options.fitBoundsOptions);this._map.fitBounds(r.toBounds(l),x,{geolocateSource:!0})}_updateMarker(p){if(p){const r=new i.bO(p.coords.longitude,p.coords.latitude);this._accuracyCircleMarker.setLngLat(r).addTo(this._map),this._userLocationDotMarker.setLngLat(r).addTo(this._map),this._accuracy=p.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const p=this._map.transform,r=i.bH(1,p._center.lat)*p.worldSize,l=Math.ceil(2*this._accuracy*r);this._circleElement.style.width=`${l}px`,this._circleElement.style.height=`${l}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._userLocationDotMarker.addClassName("mapboxgl-user-location-show-heading")):(this._userLocationDotMarker.removeClassName("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(p){if(this._map){if(this.options.trackUserLocation)if(p.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",r),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",r),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(p.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._userLocationDotMarker.addClassName("mapboxgl-user-location-dot-stale"),this.fire(new i.z("error",p)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(p){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",r=>r.preventDefault()),this._geolocateButton=J("button","mapboxgl-ctrl-geolocate",this._container),J("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",p===!1){i.w("Geolocation support is not available so the GeolocateControl will be disabled.");const r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",r),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",r)}else{const r=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",r),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",r)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=J("div","mapboxgl-user-location"),this._dotElement.appendChild(J("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(J("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new Ts({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=J("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Ts({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",r=>{r.geolocateSource||this._watchState!=="ACTIVE_LOCK"||r.originalEvent&&r.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new i.z("trackuserlocationend")))})}}_onDeviceOrientation(p){this._userLocationDotMarker&&(p.webkitCompassHeading?this._heading=p.webkitCompassHeading:p.absolute===!0&&(this._heading=-1*p.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return i.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new i.z("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new i.z("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new i.z("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let p;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(p={maximumAge:6e5,timeout:0},this._noTimeout=!0):(p=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,p),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=window.setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const p=()=>{"ondeviceorientationabsolute"in window?window.addEventListener("deviceorientationabsolute",this._onDeviceOrientation):window.addEventListener("deviceorientation",this._onDeviceOrientation)};typeof DeviceMotionEvent<"u"&&typeof DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(r=>{r==="granted"&&p()}).catch(console.error):p()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),window.removeEventListener("deviceorientation",this._onDeviceOrientation),window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:Xh,ScaleControl:class{constructor(p={}){this.options=i.l({},no,p),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),i.aP(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const p=this.options.maxWidth||100,r=this._map,l=r._containerHeight/2,m=r._containerWidth/2-p/2,x=r.unproject([m,l]),w=r.unproject([m+p,l]),A=x.distanceTo(w);if(this.options.unit==="imperial"){const D=3.2808*A;D>5280?this._setScale(p,D/5280,"mile"):this._setScale(p,D,"foot")}else this.options.unit==="nautical"?this._setScale(p,A/1852,"nautical-mile"):A>=1e3?this._setScale(p,A/1e3,"kilometer"):this._setScale(p,A,"meter")}_setScale(p,r,l){this._map._requestDomTask(()=>{const m=function(w){const A=Math.pow(10,`${Math.floor(w)}`.length-1);let D=w/A;return D=D>=10?10:D>=5?5:D>=3?3:D>=2?2:D>=1?1:function(N){const U=Math.pow(10,Math.ceil(-Math.log(N)/Math.LN10));return Math.round(N*U)/U}(D),A*D}(r),x=m/r;this._container.innerHTML=this._isNumberFormatSupported&&l!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:l}).format(m):`${m}&nbsp;${qi[l]}`,this._container.style.width=p*x+"px"})}onAdd(p){return this._map=p,this._language=p.getLanguage(),this._container=J("div","mapboxgl-ctrl mapboxgl-ctrl-scale",p.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(p){this._language=p,this._update()}setUnit(p){this.options.unit=p,this._update()}},FullscreenControl:class{constructor(p={}){this._fullscreen=!1,p&&p.container&&(p.container instanceof HTMLElement?this._container=p.container:i.w("Full screen control 'container' must be a DOM element.")),i.aP(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(p){return this._map=p,this._container||(this._container=this._map.getContainer()),this._controlContainer=J("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",i.w("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!document.fullscreenEnabled&&!document.webkitFullscreenEnabled)}_setupUI(){const p=this._fullscreenButton=J("button","mapboxgl-ctrl-fullscreen",this._controlContainer);J("span","mapboxgl-ctrl-icon",p).setAttribute("aria-hidden","true"),p.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const p=this._getTitle();this._fullscreenButton.setAttribute("aria-label",p),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",p)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(document.fullscreenElement||document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?document.exitFullscreen?document.exitFullscreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends i.E{constructor(p){super(),this.options=i.l(Object.create(ml),p),i.aP(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(p&&p.className?p.className.trim().split(/\s+/):[])}addTo(p){return this._map&&this.remove(),this._map=p,this.options.closeOnClick&&p.on("preclick",this._onClose),this.options.closeOnMove&&p.on("move",this._onClose),p.on("remove",this.remove),this._update(),p._addPopup(this),this._focusFirstElement(),this._trackPointer?(p.on("mousemove",this._onMouseEvent),p.on("mouseup",this._onMouseEvent),p._canvasContainer.classList.add("mapboxgl-track-pointer")):p.on("move",this._update),this.fire(new i.z("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const p=this._map;return p&&(p.off("move",this._update),p.off("move",this._onClose),p.off("preclick",this._onClose),p.off("click",this._onClose),p.off("remove",this.remove),p.off("mousemove",this._onMouseEvent),p.off("mouseup",this._onMouseEvent),p.off("drag",this._onMouseEvent),p._canvasContainer&&p._canvasContainer.classList.remove("mapboxgl-track-pointer"),p._removePopup(this),this._map=void 0),this.fire(new i.z("close")),this}getLngLat(){return this._lngLat}setLngLat(p){this._lngLat=i.bO.convert(p),this._pos=null,this._trackPointer=!1,this._update();const r=this._map;return r&&(r.on("move",this._update),r.off("mousemove",this._onMouseEvent),r._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const p=this._map;return p&&(p.off("move",this._update),p.on("mousemove",this._onMouseEvent),p.on("drag",this._onMouseEvent),p._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(p){return this.setDOMContent(document.createTextNode(p))}setHTML(p){const r=document.createDocumentFragment(),l=document.createElement("body");let m;for(l.innerHTML=p;m=l.firstChild,m;)r.appendChild(m);return this.setDOMContent(r)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(p){return this.options.maxWidth=p,this._update(),this}setDOMContent(p){let r=this._content;if(r)for(;r.hasChildNodes();)r.firstChild&&r.removeChild(r.firstChild);else r=this._content=J("div","mapboxgl-popup-content",this._container||void 0);if(r.appendChild(p),this.options.closeButton){const l=this._closeButton=J("button","mapboxgl-popup-close-button",r);l.type="button",l.setAttribute("aria-label","Close popup"),l.innerHTML='<span aria-hidden="true">&#215;</span>',l.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(p){return this._classList.add(p),this._updateClassList(),this}removeClassName(p){return this._classList.delete(p),this._updateClassList(),this}setOffset(p){return this.options.offset=p,this._update(),this}toggleClassName(p){let r;return this._classList.delete(p)?r=!1:(this._classList.add(p),r=!0),this._updateClassList(),r}_onMouseEvent(p){this._update(p.point)}_getAnchor(p){if(this.options.anchor)return this.options.anchor;const r=this._map,l=this._container,m=this._pos;if(!r||!l||!m)return"bottom";const x=l.offsetWidth,w=l.offsetHeight,A=m.x<x/2,D=m.x>r.transform.width-x/2;if(m.y+p<w)return A?"top-left":D?"top-right":"top";if(m.y>r.transform.height-w){if(A)return"bottom-left";if(D)return"bottom-right"}return A?"left":D?"right":"bottom"}_updateClassList(){const p=this._container;if(!p)return;const r=[...this._classList];r.push("mapboxgl-popup"),this._anchor&&r.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&r.push("mapboxgl-popup-track-pointer"),p.className=r.join(" ")}_update(p){const r=this._map,l=this._content;if(!r||!this._lngLat&&!this._trackPointer||!l)return;let m=this._container;if(m||(m=this._container=J("div","mapboxgl-popup",r.getContainer()),this._tip=J("div","mapboxgl-popup-tip",m),m.appendChild(l)),this.options.maxWidth&&m.style.maxWidth!==this.options.maxWidth&&(m.style.maxWidth=this.options.maxWidth),r.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=_d(this._lngLat,this._pos,r.transform)),!this._trackPointer||p){const x=this._pos=this._trackPointer&&p instanceof i.P?p:r.project(this._lngLat),w=gd(this.options.offset),A=this._anchor=this._getAnchor(w.y),D=gd(this.options.offset,A),N=x.add(D).round();r._requestDomTask(()=>{this._container&&A&&(this._container.style.transform=`${Xs[A]} translate(${N.x}px,${N.y}px)`)})}if(!this._marker&&r._showingGlobe()){const x=i.dH(r.transform,this._lngLat)?0:1;this._setOpacity(x)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const p=this._container.querySelector(Br);p&&p.focus()}_onClose(){this.remove()}_setOpacity(p){this._container&&(this._container.style.opacity=`${p}`),this._content&&(this._content.style.pointerEvents=p?"auto":"none")}},Marker:Ts,Style:La,LngLat:i.bO,LngLatBounds:i.az,Point:i.P,MercatorCoordinate:i.aa,FreeCameraOptions:$f,Evented:i.E,config:i.e,prewarm:i.dM,clearPrewarmedResources:i.dN,get accessToken(){return i.e.ACCESS_TOKEN},set accessToken(p){i.e.ACCESS_TOKEN=p},get baseApiUrl(){return i.e.API_URL},set baseApiUrl(p){i.e.API_URL=p},get workerCount(){return i.dO.workerCount},set workerCount(p){i.dO.workerCount=p},get maxParallelImageRequests(){return i.e.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(p){i.e.MAX_PARALLEL_IMAGE_REQUESTS=p},clearStorage(p){i.dP(p)},get workerUrl(){return i.dQ.workerUrl},set workerUrl(p){i.dQ.workerUrl=p},get workerClass(){return i.dQ.workerClass},set workerClass(p){i.dQ.workerClass=p},get workerParams(){return i.dQ.workerParams},set workerParams(p){i.dQ.workerParams=p},get dracoUrl(){return i.dR()},set dracoUrl(p){i.dS(p)},get meshoptUrl(){return i.dT()},set meshoptUrl(p){i.dU(p)},setNow:i.q.setNow,restoreNow:i.q.restoreNow}});var b=h;return b})}(Mb)),Mb.exports}var jV=cve();const UV=Ei(jV),uve=hN({__proto__:null,default:UV},[jV]),uB=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],zM=1,Xv=8;class AP{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[a,o]=new Uint8Array(t,0,2);if(a!==219)throw new Error("Data does not appear to be in a KDBush format.");const h=o>>4;if(h!==zM)throw new Error(`Got v${h} data when expected v${zM}.`);const y=uB[o&15];if(!y)throw new Error("Unrecognized array type.");const[b]=new Uint16Array(t,2,1),[i]=new Uint32Array(t,4,1);return new AP(i,b,y,t)}constructor(t,a=64,o=Float64Array,h){if(isNaN(t)||t<0)throw new Error(`Unpexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+a,2),65535),this.ArrayType=o,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;const y=uB.indexOf(this.ArrayType),b=t*2*this.ArrayType.BYTES_PER_ELEMENT,i=t*this.IndexArrayType.BYTES_PER_ELEMENT,C=(8-i%8)%8;if(y<0)throw new Error(`Unexpected typed array class: ${o}.`);h&&h instanceof ArrayBuffer?(this.data=h,this.ids=new this.IndexArrayType(this.data,Xv,t),this.coords=new this.ArrayType(this.data,Xv+i+C,t*2),this._pos=t*2,this._finished=!0):(this.data=new ArrayBuffer(Xv+b+i+C),this.ids=new this.IndexArrayType(this.data,Xv,t),this.coords=new this.ArrayType(this.data,Xv+i+C,t*2),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,(zM<<4)+y]),new Uint16Array(this.data,2,1)[0]=a,new Uint32Array(this.data,4,1)[0]=t)}add(t,a){const o=this._pos>>1;return this.ids[o]=o,this.coords[this._pos++]=t,this.coords[this._pos++]=a,o}finish(){const t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return R4(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,a,o,h){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:y,coords:b,nodeSize:i}=this,C=[0,y.length-1,0],I=[];for(;C.length;){const j=C.pop()||0,F=C.pop()||0,G=C.pop()||0;if(F-G<=i){for(let ee=G;ee<=F;ee++){const oe=b[2*ee],ge=b[2*ee+1];oe>=t&&oe<=o&&ge>=a&&ge<=h&&I.push(y[ee])}continue}const X=G+F>>1,Y=b[2*X],J=b[2*X+1];Y>=t&&Y<=o&&J>=a&&J<=h&&I.push(y[X]),(j===0?t<=Y:a<=J)&&(C.push(G),C.push(X-1),C.push(1-j)),(j===0?o>=Y:h>=J)&&(C.push(X+1),C.push(F),C.push(1-j))}return I}within(t,a,o){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:h,coords:y,nodeSize:b}=this,i=[0,h.length-1,0],C=[],I=o*o;for(;i.length;){const j=i.pop()||0,F=i.pop()||0,G=i.pop()||0;if(F-G<=b){for(let ee=G;ee<=F;ee++)hB(y[2*ee],y[2*ee+1],t,a)<=I&&C.push(h[ee]);continue}const X=G+F>>1,Y=y[2*X],J=y[2*X+1];hB(Y,J,t,a)<=I&&C.push(h[X]),(j===0?t-o<=Y:a-o<=J)&&(i.push(G),i.push(X-1),i.push(1-j)),(j===0?t+o>=Y:a+o>=J)&&(i.push(X+1),i.push(F),i.push(1-j))}return C}}function R4(e,t,a,o,h,y){if(h-o<=a)return;const b=o+h>>1;VV(e,t,b,o,h,y),R4(e,t,a,o,b-1,1-y),R4(e,t,a,b+1,h,1-y)}function VV(e,t,a,o,h,y){for(;h>o;){if(h-o>600){const I=h-o+1,j=a-o+1,F=Math.log(I),G=.5*Math.exp(2*F/3),X=.5*Math.sqrt(F*G*(I-G)/I)*(j-I/2<0?-1:1),Y=Math.max(o,Math.floor(a-j*G/I+X)),J=Math.min(h,Math.floor(a+(I-j)*G/I+X));VV(e,t,a,Y,J,y)}const b=t[2*a+y];let i=o,C=h;for(Yv(e,t,o,a),t[2*h+y]>b&&Yv(e,t,o,h);i<C;){for(Yv(e,t,i,C),i++,C--;t[2*i+y]<b;)i++;for(;t[2*C+y]>b;)C--}t[2*o+y]===b?Yv(e,t,o,C):(C++,Yv(e,t,C,h)),C<=a&&(o=C+1),a<=C&&(h=C-1)}}function Yv(e,t,a,o){BM(e,a,o),BM(t,2*a,2*o),BM(t,2*a+1,2*o+1)}function BM(e,t,a){const o=e[t];e[t]=e[a],e[a]=o}function hB(e,t,a,o){const h=e-a,y=t-o;return h*h+y*y}const hve={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:e=>e},fB=Math.fround||(e=>t=>(e[0]=+t,e[0]))(new Float32Array(1)),D0=2,cm=3,NM=4,om=5,$V=6;class fve{constructor(t){this.options=Object.assign(Object.create(hve),t),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(t){const{log:a,minZoom:o,maxZoom:h}=this.options;a&&console.time("total time");const y=`prepare ${t.length} points`;a&&console.time(y),this.points=t;const b=[];for(let C=0;C<t.length;C++){const I=t[C];if(!I.geometry)continue;const[j,F]=I.geometry.coordinates,G=fB(_b(j)),X=fB(gb(F));b.push(G,X,1/0,C,-1,1),this.options.reduce&&b.push(0)}let i=this.trees[h+1]=this._createTree(b);a&&console.timeEnd(y);for(let C=h;C>=o;C--){const I=+Date.now();i=this.trees[C]=this._createTree(this._cluster(i,C)),a&&console.log("z%d: %d clusters in %dms",C,i.numItems,+Date.now()-I)}return a&&console.timeEnd("total time"),this}getClusters(t,a){let o=((t[0]+180)%360+360)%360-180;const h=Math.max(-90,Math.min(90,t[1]));let y=t[2]===180?180:((t[2]+180)%360+360)%360-180;const b=Math.max(-90,Math.min(90,t[3]));if(t[2]-t[0]>=360)o=-180,y=180;else if(o>y){const F=this.getClusters([o,h,180,b],a),G=this.getClusters([-180,h,y,b],a);return F.concat(G)}const i=this.trees[this._limitZoom(a)],C=i.range(_b(o),gb(b),_b(y),gb(h)),I=i.data,j=[];for(const F of C){const G=this.stride*F;j.push(I[G+om]>1?dB(I,G,this.clusterProps):this.points[I[G+cm]])}return j}getChildren(t){const a=this._getOriginId(t),o=this._getOriginZoom(t),h="No cluster with the specified id.",y=this.trees[o];if(!y)throw new Error(h);const b=y.data;if(a*this.stride>=b.length)throw new Error(h);const i=this.options.radius/(this.options.extent*Math.pow(2,o-1)),C=b[a*this.stride],I=b[a*this.stride+1],j=y.within(C,I,i),F=[];for(const G of j){const X=G*this.stride;b[X+NM]===t&&F.push(b[X+om]>1?dB(b,X,this.clusterProps):this.points[b[X+cm]])}if(F.length===0)throw new Error(h);return F}getLeaves(t,a,o){a=a||10,o=o||0;const h=[];return this._appendLeaves(h,t,a,o,0),h}getTile(t,a,o){const h=this.trees[this._limitZoom(t)],y=Math.pow(2,t),{extent:b,radius:i}=this.options,C=i/b,I=(o-C)/y,j=(o+1+C)/y,F={features:[]};return this._addTileFeatures(h.range((a-C)/y,I,(a+1+C)/y,j),h.data,a,o,y,F),a===0&&this._addTileFeatures(h.range(1-C/y,I,1,j),h.data,y,o,y,F),a===y-1&&this._addTileFeatures(h.range(0,I,C/y,j),h.data,-1,o,y,F),F.features.length?F:null}getClusterExpansionZoom(t){let a=this._getOriginZoom(t)-1;for(;a<=this.options.maxZoom;){const o=this.getChildren(t);if(a++,o.length!==1)break;t=o[0].properties.cluster_id}return a}_appendLeaves(t,a,o,h,y){const b=this.getChildren(a);for(const i of b){const C=i.properties;if(C&&C.cluster?y+C.point_count<=h?y+=C.point_count:y=this._appendLeaves(t,C.cluster_id,o,h,y):y<h?y++:t.push(i),t.length===o)break}return y}_createTree(t){const a=new AP(t.length/this.stride|0,this.options.nodeSize,Float32Array);for(let o=0;o<t.length;o+=this.stride)a.add(t[o],t[o+1]);return a.finish(),a.data=t,a}_addTileFeatures(t,a,o,h,y,b){for(const i of t){const C=i*this.stride,I=a[C+om]>1;let j,F,G;if(I)j=qV(a,C,this.clusterProps),F=a[C],G=a[C+1];else{const J=this.points[a[C+cm]];j=J.properties;const[ee,oe]=J.geometry.coordinates;F=_b(ee),G=gb(oe)}const X={type:1,geometry:[[Math.round(this.options.extent*(F*y-o)),Math.round(this.options.extent*(G*y-h))]],tags:j};let Y;I||this.options.generateId?Y=a[C+cm]:Y=this.points[a[C+cm]].id,Y!==void 0&&(X.id=Y),b.features.push(X)}}_limitZoom(t){return Math.max(this.options.minZoom,Math.min(Math.floor(+t),this.options.maxZoom+1))}_cluster(t,a){const{radius:o,extent:h,reduce:y,minPoints:b}=this.options,i=o/(h*Math.pow(2,a)),C=t.data,I=[],j=this.stride;for(let F=0;F<C.length;F+=j){if(C[F+D0]<=a)continue;C[F+D0]=a;const G=C[F],X=C[F+1],Y=t.within(C[F],C[F+1],i),J=C[F+om];let ee=J;for(const oe of Y){const ge=oe*j;C[ge+D0]>a&&(ee+=C[ge+om])}if(ee>J&&ee>=b){let oe=G*J,ge=X*J,fe,xe=-1;const ae=((F/j|0)<<5)+(a+1)+this.points.length;for(const me of Y){const we=me*j;if(C[we+D0]<=a)continue;C[we+D0]=a;const Ge=C[we+om];oe+=C[we]*Ge,ge+=C[we+1]*Ge,C[we+NM]=ae,y&&(fe||(fe=this._map(C,F,!0),xe=this.clusterProps.length,this.clusterProps.push(fe)),y(fe,this._map(C,we)))}C[F+NM]=ae,I.push(oe/ee,ge/ee,1/0,ae,-1,ee),y&&I.push(xe)}else{for(let oe=0;oe<j;oe++)I.push(C[F+oe]);if(ee>1)for(const oe of Y){const ge=oe*j;if(!(C[ge+D0]<=a)){C[ge+D0]=a;for(let fe=0;fe<j;fe++)I.push(C[ge+fe])}}}}return I}_getOriginId(t){return t-this.points.length>>5}_getOriginZoom(t){return(t-this.points.length)%32}_map(t,a,o){if(t[a+om]>1){const b=this.clusterProps[t[a+$V]];return o?Object.assign({},b):b}const h=this.points[t[a+cm]].properties,y=this.options.map(h);return o&&y===h?Object.assign({},y):y}}function dB(e,t,a){return{type:"Feature",id:e[t+cm],properties:qV(e,t,a),geometry:{type:"Point",coordinates:[dve(e[t]),pve(e[t+1])]}}}function qV(e,t,a){const o=e[t+om],h=o>=1e4?`${Math.round(o/1e3)}k`:o>=1e3?`${Math.round(o/100)/10}k`:o,y=e[t+$V],b=y===-1?{}:Object.assign({},a[y]);return Object.assign(b,{cluster:!0,cluster_id:e[t+cm],point_count:o,point_count_abbreviated:h})}function _b(e){return e/360+.5}function gb(e){const t=Math.sin(e*Math.PI/180),a=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return a<0?0:a>1?1:a}function dve(e){return(e-.5)*360}function pve(e){const t=(180-e*360)*Math.PI/180;return 360*Math.atan(Math.exp(t))/Math.PI-90}const mve="_map_hvdpg_1",_ve="_map__loading_hvdpg_11",gve="_map__popUp_hvdpg_15",yve="_map__coordinates_hvdpg_20",vve="_popUp__container_hvdpg_26",Kv={map:mve,map__loading:_ve,map__popUp:gve,map__coordinates:yve,popUp__container:vve},xve=e=>({type:"Feature",geometry:{type:"Point",coordinates:e}}),bve="_marker_quyfj_1",wve="_marker__text_quyfj_20",pB={marker:bve,marker__text:wve};function Sve(e){return ve.jsx("div",{className:pB.marker,onClick:()=>{e.onClick&&e.onClick()},children:ve.jsx("a",{className:pB.marker__text,children:e.count})})}const Tve="_coordinates_3xwc4_1",Eve="_coordinates__text_3xwc4_10",FM={coordinates:Tve,coordinates__text:Eve};function Ave(e){return ve.jsxs("div",{className:FM.coordinates,children:[ve.jsx("a",{className:FM.coordinates__text,children:e.latitude.substring(0,10)}),ve.jsx("a",{className:FM.coordinates__text,children:e.longitude.substring(0,10)})]})}const Cve=16,mB=4,jM=50,UM=55,Mve=61,Ove="modulepreload",Pve=function(e){return"/"+e},_B={},Ive=function(t,a,o){let h=Promise.resolve();if(a&&a.length>0){document.getElementsByTagName("link");const b=document.querySelector("meta[property=csp-nonce]"),i=(b==null?void 0:b.nonce)||(b==null?void 0:b.getAttribute("nonce"));h=Promise.allSettled(a.map(C=>{if(C=Pve(C),C in _B)return;_B[C]=!0;const I=C.endsWith(".css"),j=I?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${C}"]${j}`))return;const F=document.createElement("link");if(F.rel=I?"stylesheet":Ove,I||(F.as="script"),F.crossOrigin="",F.href=C,i&&F.setAttribute("nonce",i),document.head.appendChild(F),I)return new Promise((G,X)=>{F.addEventListener("load",G),F.addEventListener("error",()=>X(new Error(`Unable to preload CSS for ${C}`)))})}))}function y(b){const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=b,window.dispatchEvent(i),!i.defaultPrevented)throw b}return h.then(b=>{for(const i of b||[])i.status==="rejected"&&y(i.reason);return t().catch(y)})},Rve=Ie.createContext(null);function Dve(e,t){const a=Array.isArray(e)?e[0]:e?e.x:0,o=Array.isArray(e)?e[1]:e?e.y:0,h=Array.isArray(t)?t[0]:t?t.x:0,y=Array.isArray(t)?t[1]:t?t.y:0;return a===h&&o===y}function Bd(e,t){if(e===t)return!0;if(!e||!t)return!1;if(Array.isArray(e)){if(!Array.isArray(t)||e.length!==t.length)return!1;for(let a=0;a<e.length;a++)if(!Bd(e[a],t[a]))return!1;return!0}else if(Array.isArray(t))return!1;if(typeof e=="object"&&typeof t=="object"){const a=Object.keys(e),o=Object.keys(t);if(a.length!==o.length)return!1;for(const h of a)if(!t.hasOwnProperty(h)||!Bd(e[h],t[h]))return!1;return!0}return!1}function Lve(e){const t=e.clone();return t.pixelsToGLUnits=e.pixelsToGLUnits,t}function gB(e,t){if(!e.getProjection)return;const a=e.getProjection(),o=t.getProjection();Bd(a,o)||t.setProjection(a)}function yB(e){return{longitude:e.center.lng,latitude:e.center.lat,zoom:e.zoom,pitch:e.pitch,bearing:e.bearing,padding:e.padding}}function vB(e,t){const a=t.viewState||t;let o=!1;if("zoom"in a){const h=e.zoom;e.zoom=a.zoom,o=o||h!==e.zoom}if("bearing"in a){const h=e.bearing;e.bearing=a.bearing,o=o||h!==e.bearing}if("pitch"in a){const h=e.pitch;e.pitch=a.pitch,o=o||h!==e.pitch}if(a.padding&&!e.isPaddingEqual(a.padding)&&(o=!0,e.padding=a.padding),"longitude"in a&&"latitude"in a){const h=e.center;e.center=new h.constructor(a.longitude,a.latitude),o=o||h!==e.center}return o}const kve=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function xB(e){if(!e)return null;if(typeof e=="string"||("toJS"in e&&(e=e.toJS()),!e.layers))return e;const t={};for(const o of e.layers)t[o.id]=o;const a=e.layers.map(o=>{let h=null;"interactive"in o&&(h=Object.assign({},o),delete h.interactive);const y=t[o.ref];if(y){h=h||Object.assign({},o),delete h.ref;for(const b of kve)b in y&&(h[b]=y[b])}return h||o});return{...e,layers:a}}var bB={};const wB={version:8,sources:{},layers:[]},SB={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},VM={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},TB={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},zve=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],Bve=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class cy{constructor(t,a,o){this._map=null,this._internalUpdate=!1,this._inRender=!1,this._hoveredFeatures=null,this._deferredEvents={move:!1,zoom:!1,pitch:!1,rotate:!1},this._onEvent=h=>{const y=this.props[TB[h.type]];y?y(h):h.type==="error"&&console.error(h.error)},this._onPointerEvent=h=>{(h.type==="mousemove"||h.type==="mouseout")&&this._updateHover(h);const y=this.props[SB[h.type]];y&&(this.props.interactiveLayerIds&&h.type!=="mouseover"&&h.type!=="mouseout"&&(h.features=this._hoveredFeatures||this._queryRenderedFeatures(h.point)),y(h),delete h.features)},this._onCameraEvent=h=>{if(!this._internalUpdate){const y=this.props[VM[h.type]];y&&y(h)}h.type in this._deferredEvents&&(this._deferredEvents[h.type]=!1)},this._MapClass=t,this.props=a,this._initialize(o)}get map(){return this._map}get transform(){return this._renderTransform}setProps(t){const a=this.props;this.props=t;const o=this._updateSettings(t,a);o&&this._createShadowTransform(this._map);const h=this._updateSize(t),y=this._updateViewState(t,!0);this._updateStyle(t,a),this._updateStyleComponents(t,a),this._updateHandlers(t,a),(o||h||y&&!this._map.isMoving())&&this.redraw()}static reuse(t,a){const o=cy.savedMaps.pop();if(!o)return null;const h=o.map,y=h.getContainer();for(a.className=y.className;y.childNodes.length>0;)a.appendChild(y.childNodes[0]);h._container=a,o.setProps({...t,styleDiffing:!1}),h.resize();const{initialViewState:b}=t;return b&&(b.bounds?h.fitBounds(b.bounds,{...b.fitBoundsOptions,duration:0}):o._updateViewState(b,!1)),h.isStyleLoaded()?h.fire("load"):h.once("styledata",()=>h.fire("load")),h._update(),o}_initialize(t){const{props:a}=this,{mapStyle:o=wB}=a,h={...a,...a.initialViewState,accessToken:a.mapboxAccessToken||Nve()||null,container:t,style:xB(o)},y=h.initialViewState||h.viewState||h;if(Object.assign(h,{center:[y.longitude||0,y.latitude||0],zoom:y.zoom||0,pitch:y.pitch||0,bearing:y.bearing||0}),a.gl){const j=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=j,a.gl)}const b=new this._MapClass(h);y.padding&&b.setPadding(y.padding),a.cursor&&(b.getCanvas().style.cursor=a.cursor),this._createShadowTransform(b);const i=b._render;b._render=j=>{this._inRender=!0,i.call(b,j),this._inRender=!1};const C=b._renderTaskQueue.run;b._renderTaskQueue.run=j=>{C.call(b._renderTaskQueue,j),this._onBeforeRepaint()},b.on("render",()=>this._onAfterRepaint());const I=b.fire;b.fire=this._fireEvent.bind(this,I),b.on("resize",()=>{this._renderTransform.resize(b.transform.width,b.transform.height)}),b.on("styledata",()=>{this._updateStyleComponents(this.props,{}),gB(b.transform,this._renderTransform)}),b.on("sourcedata",()=>this._updateStyleComponents(this.props,{}));for(const j in SB)b.on(j,this._onPointerEvent);for(const j in VM)b.on(j,this._onCameraEvent);for(const j in TB)b.on(j,this._onEvent);this._map=b}recycle(){const a=this.map.getContainer().querySelector("[mapboxgl-children]");a==null||a.remove(),cy.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){const t=this._map;!this._inRender&&t.style&&(t._frame&&(t._frame.cancel(),t._frame=null),t._render())}_createShadowTransform(t){const a=Lve(t.transform);t.painter.transform=a,this._renderTransform=a}_updateSize(t){const{viewState:a}=t;if(a){const o=this._map;if(a.width!==o.transform.width||a.height!==o.transform.height)return o.resize(),!0}return!1}_updateViewState(t,a){if(this._internalUpdate)return!1;const o=this._map,h=this._renderTransform,{zoom:y,pitch:b,bearing:i}=h,C=o.isMoving();C&&(h.cameraElevationReference="sea");const I=vB(h,{...yB(o.transform),...t});if(C&&(h.cameraElevationReference="ground"),I&&a){const j=this._deferredEvents;j.move=!0,j.zoom||(j.zoom=y!==h.zoom),j.rotate||(j.rotate=i!==h.bearing),j.pitch||(j.pitch=b!==h.pitch)}return C||vB(o.transform,t),I}_updateSettings(t,a){const o=this._map;let h=!1;for(const y of zve)if(y in t&&!Bd(t[y],a[y])){h=!0;const b=o[`set${y[0].toUpperCase()}${y.slice(1)}`];b==null||b.call(o,t[y])}return h}_updateStyle(t,a){if(t.cursor!==a.cursor&&(this._map.getCanvas().style.cursor=t.cursor||""),t.mapStyle!==a.mapStyle){const{mapStyle:o=wB,styleDiffing:h=!0}=t,y={diff:h};return"localIdeographFontFamily"in t&&(y.localIdeographFontFamily=t.localIdeographFontFamily),this._map.setStyle(xB(o),y),!0}return!1}_updateStyleComponents(t,a){const o=this._map;let h=!1;return o.isStyleLoaded()&&("light"in t&&o.setLight&&!Bd(t.light,a.light)&&(h=!0,o.setLight(t.light)),"fog"in t&&o.setFog&&!Bd(t.fog,a.fog)&&(h=!0,o.setFog(t.fog)),"terrain"in t&&o.setTerrain&&!Bd(t.terrain,a.terrain)&&(!t.terrain||o.getSource(t.terrain.source))&&(h=!0,o.setTerrain(t.terrain))),h}_updateHandlers(t,a){const o=this._map;let h=!1;for(const y of Bve){const b=t[y]??!0,i=a[y]??!0;Bd(b,i)||(h=!0,b?o[y].enable(b):o[y].disable())}return h}_queryRenderedFeatures(t){const a=this._map,o=a.transform,{interactiveLayerIds:h=[]}=this.props;try{return a.transform=this._renderTransform,a.queryRenderedFeatures(t,{layers:h.filter(a.getLayer.bind(a))})}catch{return[]}finally{a.transform=o}}_updateHover(t){var h;const{props:a}=this;if(a.interactiveLayerIds&&(a.onMouseMove||a.onMouseEnter||a.onMouseLeave)){const y=t.type,b=((h=this._hoveredFeatures)==null?void 0:h.length)>0,i=this._queryRenderedFeatures(t.point),C=i.length>0;!C&&b&&(t.type="mouseleave",this._onPointerEvent(t)),this._hoveredFeatures=i,C&&!b&&(t.type="mouseenter",this._onPointerEvent(t)),t.type=y}else this._hoveredFeatures=null}_fireEvent(t,a,o){const h=this._map,y=h.transform,b=typeof a=="string"?a:a.type;return b==="move"&&this._updateViewState(this.props,!1),b in VM&&(typeof a=="object"&&(a.viewState=yB(y)),this._map.isMoving())?(h.transform=this._renderTransform,t.call(h,a,o),h.transform=y,h):(t.call(h,a,o),h)}_onBeforeRepaint(){const t=this._map;this._internalUpdate=!0;for(const o in this._deferredEvents)this._deferredEvents[o]&&t.fire(o);this._internalUpdate=!1;const a=this._map.transform;t.transform=this._renderTransform,this._onAfterRepaint=()=>{gB(this._renderTransform,a),t.transform=a}}}cy.savedMaps=[];function Nve(){let e=null;if(typeof location<"u"){const t=/access_token=([^&\/]*)/.exec(location.search);e=t&&t[1]}try{e=e||bB.MapboxAccessToken}catch{}try{e=e||bB.REACT_APP_MAPBOX_ACCESS_TOKEN}catch{}return e}const Fve=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function jve(e){if(!e)return null;const t=e.map,a={getMap:()=>t,getCenter:()=>e.transform.center,getZoom:()=>e.transform.zoom,getBearing:()=>e.transform.bearing,getPitch:()=>e.transform.pitch,getPadding:()=>e.transform.padding,getBounds:()=>e.transform.getBounds(),project:o=>{const h=t.transform;t.transform=e.transform;const y=t.project(o);return t.transform=h,y},unproject:o=>{const h=t.transform;t.transform=e.transform;const y=t.unproject(o);return t.transform=h,y},queryTerrainElevation:(o,h)=>{const y=t.transform;t.transform=e.transform;const b=t.queryTerrainElevation(o,h);return t.transform=y,b},queryRenderedFeatures:(o,h)=>{const y=t.transform;t.transform=e.transform;const b=t.queryRenderedFeatures(o,h);return t.transform=y,b}};for(const o of Uve(t))!(o in a)&&!Fve.includes(o)&&(a[o]=t[o].bind(t));return a}function Uve(e){const t=new Set;let a=e;for(;a;){for(const o of Object.getOwnPropertyNames(a))o[0]!=="_"&&typeof e[o]=="function"&&o!=="fire"&&o!=="setEventedParent"&&t.add(o);a=Object.getPrototypeOf(a)}return Array.from(t)}const Vve=typeof document<"u"?Ie.useLayoutEffect:Ie.useEffect,$ve=["baseApiUrl","maxParallelImageRequests","workerClass","workerCount","workerUrl"];function qve(e,t){for(const o of $ve)o in t&&(e[o]=t[o]);const{RTLTextPlugin:a="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.js"}=t;a&&e.getRTLTextPluginStatus&&e.getRTLTextPluginStatus()==="unavailable"&&e.setRTLTextPlugin(a,o=>{o&&console.error(o)},!0)}const zS=Ie.createContext(null);function Gve(e,t){const a=Ie.useContext(Rve),[o,h]=Ie.useState(null),y=Ie.useRef(),{current:b}=Ie.useRef({mapLib:null,map:null});Ie.useEffect(()=>{const I=e.mapLib;let j=!0,F;return Promise.resolve(I||Ive(()=>Promise.resolve().then(()=>uve),[])).then(G=>{if(!j)return;if(!G)throw new Error("Invalid mapLib");const X="Map"in G?G:G.default;if(!X.Map)throw new Error("Invalid mapLib");if(qve(X,e),!X.supported||X.supported(e))e.reuseMaps&&(F=cy.reuse(e,y.current)),F||(F=new cy(X.Map,e,y.current)),b.map=jve(F),b.mapLib=X,h(F),a==null||a.onMapMount(b.map,e.id);else throw new Error("Map is not supported by this browser")}).catch(G=>{const{onError:X}=e;X?X({type:"error",target:null,error:G}):console.error(G)}),()=>{j=!1,F&&(a==null||a.onMapUnmount(e.id),e.reuseMaps?F.recycle():F.destroy())}},[]),Vve(()=>{o&&o.setProps(e)}),Ie.useImperativeHandle(t,()=>b.map,[o]);const i=Ie.useMemo(()=>({position:"relative",width:"100%",height:"100%",...e.style}),[e.style]),C={height:"100%"};return Ie.createElement("div",{id:e.id,ref:y,style:i},o&&Ie.createElement(zS.Provider,{value:b},Ie.createElement("div",{"mapboxgl-children":"",style:C},e.children)))}const Hve=Ie.forwardRef(Gve),Zve=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function e_(e,t){if(!e||!t)return;const a=e.style;for(const o in t){const h=t[o];Number.isFinite(h)&&!Zve.test(o)?a[o]=`${h}px`:a[o]=h}}const Wve=Ie.memo(Ie.forwardRef((e,t)=>{const{map:a,mapLib:o}=Ie.useContext(zS),h=Ie.useRef({props:e});h.current.props=e;const y=Ie.useMemo(()=>{let J=!1;Ie.Children.forEach(e.children,ge=>{ge&&(J=!0)});const ee={...e,element:J?document.createElement("div"):null},oe=new o.Marker(ee);return oe.setLngLat([e.longitude,e.latitude]),oe.getElement().addEventListener("click",ge=>{var fe,xe;(xe=(fe=h.current.props).onClick)==null||xe.call(fe,{type:"click",target:oe,originalEvent:ge})}),oe.on("dragstart",ge=>{var xe,ae;const fe=ge;fe.lngLat=y.getLngLat(),(ae=(xe=h.current.props).onDragStart)==null||ae.call(xe,fe)}),oe.on("drag",ge=>{var xe,ae;const fe=ge;fe.lngLat=y.getLngLat(),(ae=(xe=h.current.props).onDrag)==null||ae.call(xe,fe)}),oe.on("dragend",ge=>{var xe,ae;const fe=ge;fe.lngLat=y.getLngLat(),(ae=(xe=h.current.props).onDragEnd)==null||ae.call(xe,fe)}),oe},[]);Ie.useEffect(()=>(y.addTo(a.getMap()),()=>{y.remove()}),[]);const{longitude:b,latitude:i,offset:C,style:I,draggable:j=!1,popup:F=null,rotation:G=0,rotationAlignment:X="auto",pitchAlignment:Y="auto"}=e;return Ie.useEffect(()=>{e_(y.getElement(),I)},[I]),Ie.useImperativeHandle(t,()=>y,[]),(y.getLngLat().lng!==b||y.getLngLat().lat!==i)&&y.setLngLat([b,i]),C&&!Dve(y.getOffset(),C)&&y.setOffset(C),y.isDraggable()!==j&&y.setDraggable(j),y.getRotation()!==G&&y.setRotation(G),y.getRotationAlignment()!==X&&y.setRotationAlignment(X),y.getPitchAlignment()!==Y&&y.setPitchAlignment(Y),y.getPopup()!==F&&y.setPopup(F),sV.createPortal(e.children,y.getElement())}));function EB(e){return new Set(e?e.trim().split(/\s+/):[])}const Xve=Ie.memo(Ie.forwardRef((e,t)=>{const{map:a,mapLib:o}=Ie.useContext(zS),h=Ie.useMemo(()=>document.createElement("div"),[]),y=Ie.useRef({props:e});y.current.props=e;const b=Ie.useMemo(()=>{const i={...e},C=new o.Popup(i);return C.setLngLat([e.longitude,e.latitude]),C.once("open",I=>{var j,F;(F=(j=y.current.props).onOpen)==null||F.call(j,I)}),C},[]);if(Ie.useEffect(()=>{const i=C=>{var I,j;(j=(I=y.current.props).onClose)==null||j.call(I,C)};return b.on("close",i),b.setDOMContent(h).addTo(a.getMap()),()=>{b.off("close",i),b.isOpen()&&b.remove()}},[]),Ie.useEffect(()=>{e_(b.getElement(),e.style)},[e.style]),Ie.useImperativeHandle(t,()=>b,[]),b.isOpen()&&((b.getLngLat().lng!==e.longitude||b.getLngLat().lat!==e.latitude)&&b.setLngLat([e.longitude,e.latitude]),e.offset&&!Bd(b.options.offset,e.offset)&&b.setOffset(e.offset),(b.options.anchor!==e.anchor||b.options.maxWidth!==e.maxWidth)&&(b.options.anchor=e.anchor,b.setMaxWidth(e.maxWidth)),b.options.className!==e.className)){const i=EB(b.options.className),C=EB(e.className);for(const I of i)C.has(I)||b.removeClassName(I);for(const I of C)i.has(I)||b.addClassName(I);b.options.className=e.className}return sV.createPortal(e.children,h)}));function O2(e,t,a,o){const h=Ie.useContext(zS),y=Ie.useMemo(()=>e(h),[]);return Ie.useEffect(()=>{const b=t,i=null,C=typeof t=="function"?t:null,{map:I}=h;return I.hasControl(y)||(I.addControl(y,b==null?void 0:b.position),i&&i(h)),()=>{C&&C(h),I.hasControl(y)&&I.removeControl(y)}},[]),y}function Yve(e){const t=O2(({mapLib:a})=>new a.AttributionControl(e),{position:e.position});return Ie.useEffect(()=>{e_(t._container,e.style)},[e.style]),null}Ie.memo(Yve);function Kve(e){const t=O2(({mapLib:a})=>new a.FullscreenControl({container:e.containerId&&document.getElementById(e.containerId)}),{position:e.position});return Ie.useEffect(()=>{e_(t._controlContainer,e.style)},[e.style]),null}Ie.memo(Kve);function Jve(e,t){const a=Ie.useRef({props:e}),o=O2(({mapLib:h})=>{const y=new h.GeolocateControl(e),b=y._setupUI.bind(y);return y._setupUI=i=>{y._container.hasChildNodes()||b(i)},y.on("geolocate",i=>{var C,I;(I=(C=a.current.props).onGeolocate)==null||I.call(C,i)}),y.on("error",i=>{var C,I;(I=(C=a.current.props).onError)==null||I.call(C,i)}),y.on("outofmaxbounds",i=>{var C,I;(I=(C=a.current.props).onOutOfMaxBounds)==null||I.call(C,i)}),y.on("trackuserlocationstart",i=>{var C,I;(I=(C=a.current.props).onTrackUserLocationStart)==null||I.call(C,i)}),y.on("trackuserlocationend",i=>{var C,I;(I=(C=a.current.props).onTrackUserLocationEnd)==null||I.call(C,i)}),y},{position:e.position});return a.current.props=e,Ie.useImperativeHandle(t,()=>o,[]),Ie.useEffect(()=>{e_(o._container,e.style)},[e.style]),null}Ie.memo(Ie.forwardRef(Jve));function Qve(e){const t=O2(({mapLib:a})=>new a.NavigationControl(e),{position:e.position});return Ie.useEffect(()=>{e_(t._container,e.style)},[e.style]),null}Ie.memo(Qve);function e1e(e){const t=O2(({mapLib:y})=>new y.ScaleControl(e),{position:e.position}),a=Ie.useRef(e),o=a.current;a.current=e;const{style:h}=e;return e.maxWidth!==void 0&&e.maxWidth!==o.maxWidth&&(t.options.maxWidth=e.maxWidth),e.unit!==void 0&&e.unit!==o.unit&&t.setUnit(e.unit),Ie.useEffect(()=>{e_(t._container,h)},[h]),null}Ie.memo(e1e);function t1e(e){var oe,ge,fe,xe;const{windowSizes:t}=wF(),a=e.maxZoom??Cve,o=e.minZoom??mB,[h,y]=Ie.useState(!1),[b,i]=Ie.useState({zoom:e.startZoom??mB,longitude:((oe=e.viewCoordinates)==null?void 0:oe.longitude)??jM,latitude:((ge=e.viewCoordinates)==null?void 0:ge.latitude)??UM}),[C,I]=Ie.useState({longitude:((fe=e.viewCoordinates)==null?void 0:fe.longitude)??jM,latitude:((xe=e.viewCoordinates)==null?void 0:xe.latitude)??UM}),[j,F]=Ie.useState([]),[G,X]=Ie.useState(null),[Y,J]=Ie.useState([]);Ie.useEffect(()=>{UV.accessToken="pk.eyJ1IjoiZW5zdWItMTIiLCJhIjoiY204NHd6dXpvMTJ6aDJqcXYyczJmczFudiJ9.mqTIXJmg2hQXjkJ8eSsw1g"},[]),Ie.useEffect(()=>{e.fixedLatAndLon||I({latitude:b.latitude,longitude:b.longitude})},[b]),Ie.useEffect(()=>{e.viewCoordinates&&(i({...b,latitude:e.viewCoordinates.latitude,longitude:e.viewCoordinates.longitude}),I({latitude:e.viewCoordinates.latitude,longitude:e.viewCoordinates.longitude}))},[e.viewCoordinates]),Ie.useEffect(()=>{e.loading!==void 0&&y(!e.loading)},[e.loading]),Ie.useEffect(()=>{J(e.markers.map(ae=>xve([ae.longitude,ae.latitude])))},[e.markers]),Ie.useEffect(()=>{const ae=new fve({radius:40,maxZoom:a-2});ae.load(Y);const me=ae.getClusters([-180,-85,180,85],b.zoom);me.length<j.length&&X(null),F(me)},[Y,b.zoom,a]);const ee=()=>{var me,we;if(!j.length)return{latitude:UM,longitude:jM};let ae=j[0];for(const Ge of j)(((me=Ge.properties)==null?void 0:me.point_count)??1)>(((we=ae.properties)==null?void 0:we.point_count)??1)&&(ae=Ge);return{longitude:ae.geometry.coordinates[0],latitude:ae.geometry.coordinates[1]}};return Ie.useEffect(()=>{if(h)return;const ae=ee();i({...b,latitude:ae.latitude,longitude:ae.longitude})},[j]),ve.jsxs("div",{className:`${Kv.map} ${e.className}`,style:{height:t.height-Mve+"px"},children:[!h&&ve.jsx(jg,{className:Kv.map__loading}),ve.jsxs(Hve,{...b,mapStyle:"mapbox://styles/mapbox/streets-v12",doubleClickZoom:!0,minZoom:o,maxZoom:a,fadeDuration:100,onClick:()=>{G&&X(null)},onMove:ae=>{i({zoom:ae.viewState.zoom,latitude:ae.viewState.latitude,longitude:ae.viewState.longitude})},onZoomEnd:ae=>i({...b,zoom:ae.target.getZoom()}),onLoad:()=>{e.loading||y(!0),e.whenLoaded&&e.whenLoaded()},style:{opacity:h?1:e.showMapIfLoading?.3:0},projection:{name:"mercator"},children:[j.map((ae,me)=>{var dt,vt,jt;const we=((dt=ae.properties)==null?void 0:dt.point_count)??1,Ge=ae.geometry.coordinates[0],He=ae.geometry.coordinates[1],ye=e.markers.find(_t=>_t.longitude===Ge&&_t.latitude===He);if(!ye&&!((vt=ae.properties)!=null&&vt.cluster))return ve.jsx("div",{},me);const ke=e.useMarkerAutoSize?`${10+we/Y.length*20}px`:"auto";return ve.jsx(Wve,{longitude:Ge,latitude:He,onClick:()=>setTimeout(()=>{G&&G.latitude===He&&G.longitude===Ge?X(null):X({longitude:Ge,latitude:He})},10),children:ve.jsx("div",{style:{width:ke,height:ke},children:(jt=ae.properties)!=null&&jt.cluster?ve.jsx(Sve,{count:we}):e.getDefaultMarker(ye)})},me)}),G&&ve.jsx(Xve,{longitude:G.longitude,latitude:G.latitude,closeOnClick:!1,className:Kv.map__popUp,children:ve.jsx("div",{className:Kv.popUp__container,children:e.getPopUp&&e.getPopUp(G)})}),e.showLatAndLon&&ve.jsx("div",{className:Kv.map__coordinates,children:ve.jsx(Ave,{latitude:C.latitude+"",longitude:C.longitude+""})})]})]})}const n1e=(e,t)=>{if(e.id===t.id)return!1;const a=Math.max(e.latitude,t.latitude)-Math.min(e.latitude,t.latitude),o=Math.max(e.longitude,t.longitude)-Math.min(e.longitude,t.longitude);return a<=1e-4&&o<=1e-4},r1e="_block_17t58_1",i1e="_block__header_17t58_12",a1e="_header__button_17t58_23",o1e="_header__text_17t58_27",s1e="_block__content_17t58_35",xg={block:r1e,block__header:i1e,header__button:a1e,header__text:o1e,block__content:s1e},l1e="data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M15%2018L9%2012L15%206'%20stroke='%23373435'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",c1e="data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M9%2018L15%2012L9%206'%20stroke='%23373435'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e";function u1e(e){var i,C;const t=zo(),[a,o]=Ie.useState(0),h=(((i=e.otherStations)==null?void 0:i.length)??0)>0,y=h?[e.station].concat(...e.otherStations??[])[a]:e.station,b=()=>{t(_2+y.id+lc([{key:Hd.PREVIOUS_PAGE,value:Vd.MAIN}]))};return ve.jsxs("div",{className:xg.block,children:[ve.jsxs("div",{className:xg.block__header,children:[ve.jsx("div",{className:xg.header__button,children:h&&a!==0&&ve.jsx(vf,{iconSrc:l1e,onClick:()=>o(a-1),variant:"iconSmall"})}),h?ve.jsxs("div",{className:xg.header__text,children:[" ",a+1]}):ve.jsx(ve.Fragment,{}),ve.jsx("div",{className:xg.header__button,children:h&&((C=e.otherStations)==null?void 0:C.length)!==a&&ve.jsx(vf,{iconSrc:c1e,onClick:()=>o(a+1),variant:"iconSmall"})})]}),ve.jsx("div",{className:xg.block__content,children:ve.jsx(AF,{onClick:b,station:y})})]})}const h1e="_marker_1obvt_1",f1e="_groupMarker_1obvt_2",d1e="_green_1obvt_34",p1e="_orange_1obvt_42",m1e="_grey_1obvt_50",_1e="_groupMarker__counter_1obvt_58",Cw={marker:h1e,groupMarker:f1e,green:d1e,orange:p1e,grey:m1e,groupMarker__counter:_1e};function g1e(e){return ve.jsx("div",{className:Cw.groupMarker,children:ve.jsx("a",{className:Cw.groupMarker__counter,children:e.stationsCount})})}function y1e(e){return ve.jsx("div",{className:`${Cw.marker} ${Cw[e.color]}`,children:ve.jsx(EF,{color:e.color})})}function v1e(e){const{stations:t}=Ie.useContext(Bo),[a,o]=Ie.useState([]);Ie.useEffect(()=>{o(t.map((y,b)=>({id:b,latitude:Number.parseFloat(y.coordinates.latitude)??0,longitude:Number.parseFloat(y.coordinates.longitude)??0,color:aO[y.status]})))},[t]);const h=y=>{const b=[];for(const i of a)n1e(i,y)&&b.push(i);return b};return ve.jsx(t1e,{useMarkerAutoSize:!0,markers:a,getPopUp:y=>{const b=a.find(j=>j.longitude===y.longitude&&j.latitude===y.latitude);if(!b)return ve.jsx(ve.Fragment,{});const i=t.find((j,F)=>F===b.id),I=h(b).map(j=>t.find((F,G)=>j.id===G)).filter(j=>!!j).sort((j,F)=>j.id<F.id?-1:1);return i?ve.jsx(u1e,{station:i,otherStations:I}):ve.jsx(ve.Fragment,{})},getDefaultMarker:y=>{const b=h(y);return b.length?[y.id].concat(b.map(C=>C.id)).sort((C,I)=>C<I?-1:1)[0]===y.id?ve.jsx(g1e,{stationsCount:b.length+1}):ve.jsx(ve.Fragment,{}):ve.jsx(y1e,{color:y.color})},loading:e.loading})}const x1e="_header_iompl_1",b1e="_footer_iompl_2",w1e="_header__activeSession_iompl_19",$M={header:x1e,footer:b1e,header__activeSession:w1e},S1e="_button_yxhdm_1",T1e="_button__icon_yxhdm_21",AB={button:S1e,button__icon:T1e};function Jv(e){return ve.jsx("button",{className:AB.button,onClick:e.onClick,children:ve.jsx("img",{className:AB.button__icon,src:e.iconSrc,alt:"Control"})})}const E1e="_panel_lxkg4_1",A1e={panel:E1e},C1e="data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M9.99988%202.00006H8.99988C6.17145%202.00006%204.75724%202.00006%203.87856%202.87874C2.99988%203.75742%202.99988%205.17163%202.99988%208.00006V21.2501H1.99988C1.58566%2021.2501%201.24988%2021.5858%201.24988%2022.0001C1.24988%2022.4143%201.58566%2022.7501%201.99988%2022.7501H17.2499C17.6641%2022.7501%2017.9999%2022.4143%2017.9999%2022.0001C17.9999%2021.5858%2017.6641%2021.2501%2017.2499%2021.2501H15.9999V17.7501H17.5713C17.9461%2017.7501%2018.2499%2018.0539%2018.2499%2018.4287V18.5001C18.2499%2019.7427%2019.2572%2020.7501%2020.4999%2020.7501C21.7425%2020.7501%2022.7499%2019.7427%2022.7499%2018.5001V7.60183C22.7499%207.44517%2022.7499%207.33708%2022.744%207.23167C22.6883%206.24069%2022.2421%205.3122%2021.503%204.64968C21.4244%204.57921%2021.34%204.5117%2021.2177%204.41384L19.9684%203.41444C19.645%203.15568%2019.173%203.20812%2018.9142%203.53157C18.6555%203.85501%2018.7079%204.32698%2019.0314%204.58574L20.2644%205.57221C20.4089%205.6878%2020.4584%205.72774%2020.5018%205.76659C20.9452%206.16411%2021.2129%206.7212%2021.2463%207.31579C21.2496%207.3739%2021.2499%207.43749%2021.2499%207.62253V8.00006H20.4999C19.6715%208.00006%2018.9999%208.67163%2018.9999%209.50006V11.9189C18.9999%2012.5646%2019.413%2013.1378%2020.0255%2013.3419L21.2499%2013.7501V18.5001C21.2499%2018.9143%2020.9141%2019.2501%2020.4999%2019.2501C20.0857%2019.2501%2019.7499%2018.9143%2019.7499%2018.5001V18.4287C19.7499%2017.2255%2018.7745%2016.2501%2017.5713%2016.2501H15.9999V8.00006C15.9999%205.17163%2015.9999%203.75742%2015.1212%202.87874C14.2425%202.00006%2012.8283%202.00006%209.99988%202.00006ZM9.88575%209.35694C10.2409%209.57005%2010.3561%2010.0307%2010.143%2010.3859L9.32452%2011.7501H10.9999C11.2701%2011.7501%2011.5194%2011.8954%2011.6525%2012.1305C11.7857%2012.3657%2011.782%2012.6542%2011.643%2012.8859L10.143%2015.3859C9.92989%2015.7411%209.46919%2015.8563%209.11401%2015.6432C8.75882%2015.4301%208.64365%2014.9694%208.85676%2014.6142L9.67524%2013.2501H7.99988C7.72967%2013.2501%207.48036%2013.1047%207.34723%2012.8696C7.2141%2012.6345%207.21774%2012.3459%207.35676%2012.1142L8.85676%209.61419C9.06987%209.259%209.53056%209.14383%209.88575%209.35694Z'%20fill='%2316B8AF'/%3e%3c/svg%3e",M1e="data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M1.75024%2010.0004V14.0004C1.75024%2016.8288%201.75024%2018.2431%202.62892%2019.1217C2.84626%2019.3391%203.09636%2019.5026%203.39252%2019.6258C3.38581%2019.5813%203.37946%2019.5367%203.37346%2019.492C3.2501%2018.5746%203.25017%2017.4288%203.25024%2016.0991L3.25024%208.00036L3.25024%207.90161V7.90161C3.25017%206.57188%203.2501%205.42616%203.37346%204.50867C3.37945%204.46405%203.3858%204.41951%203.39251%204.37506C3.09635%204.49818%202.84626%204.66176%202.62892%204.87909C1.75024%205.75777%201.75024%207.17198%201.75024%2010.0004Z'%20fill='%2316B8AF'/%3e%3cpath%20d='M21.7502%2010.0004V14.0004C21.7502%2016.8288%2021.7502%2018.2431%2020.8716%2019.1217C20.6542%2019.3391%2020.4041%2019.5026%2020.108%2019.6258C20.1147%2019.5813%2020.121%2019.5367%2020.127%2019.492C20.2504%2018.5746%2020.2503%2017.4288%2020.2502%2016.0991V7.90162C20.2503%206.57189%2020.2504%205.42616%2020.127%204.50867C20.121%204.46405%2020.1147%204.41951%2020.108%204.37506C20.4041%204.49818%2020.6542%204.66176%2020.8716%204.87909C21.7502%205.75777%2021.7502%207.17198%2021.7502%2010.0004Z'%20fill='%2316B8AF'/%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M5.62892%202.87874C4.75024%203.75742%204.75024%205.17163%204.75024%208.00006V16.0001C4.75024%2018.8285%204.75024%2020.2427%205.62892%2021.1214C6.5076%2022.0001%207.92182%2022.0001%2010.7502%2022.0001H12.7502C15.5787%2022.0001%2016.9929%2022.0001%2017.8716%2021.1214C18.7502%2020.2427%2018.7502%2018.8285%2018.7502%2016.0001V8.00006C18.7502%205.17163%2018.7502%203.75742%2017.8716%202.87874C16.9929%202.00006%2015.5787%202.00006%2012.7502%202.00006H10.7502C7.92182%202.00006%206.5076%202.00006%205.62892%202.87874ZM8.00024%2017.0001C8.00024%2016.5858%208.33603%2016.2501%208.75024%2016.2501H11.7502C12.1645%2016.2501%2012.5002%2016.5858%2012.5002%2017.0001C12.5002%2017.4143%2012.1645%2017.7501%2011.7502%2017.7501H8.75024C8.33603%2017.7501%208.00024%2017.4143%208.00024%2017.0001ZM8.75024%2012.2501C8.33603%2012.2501%208.00024%2012.5858%208.00024%2013.0001C8.00024%2013.4143%208.33603%2013.7501%208.75024%2013.7501H14.7502C15.1645%2013.7501%2015.5002%2013.4143%2015.5002%2013.0001C15.5002%2012.5858%2015.1645%2012.2501%2014.7502%2012.2501H8.75024ZM8.00024%209.00006C8.00024%208.58585%208.33603%208.25006%208.75024%208.25006H14.7502C15.1645%208.25006%2015.5002%208.58585%2015.5002%209.00006C15.5002%209.41427%2015.1645%209.75006%2014.7502%209.75006H8.75024C8.33603%209.75006%208.00024%209.41427%208.00024%209.00006Z'%20fill='%2316B8AF'/%3e%3c/svg%3e",O1e="data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M21.1011%208.00353C21.0445%207.99996%2020.9828%207.99998%2020.9188%208L20.9028%208.00001H18.3944C16.3267%208.00001%2014.5575%209.62757%2014.5575%2011.75C14.5575%2013.8724%2016.3267%2015.5%2018.3944%2015.5H20.9028L20.9188%2015.5C20.9828%2015.5%2021.0445%2015.5001%2021.1011%2015.4965C21.941%2015.4434%2022.6838%2014.7862%2022.7462%2013.8682C22.7503%2013.808%2022.7503%2013.7431%2022.7502%2013.683L22.7502%2013.6667V9.83334L22.7502%209.81702C22.7503%209.75688%2022.7503%209.69199%2022.7462%209.6318C22.6838%208.71381%2021.941%208.05657%2021.1011%208.00353ZM18.1719%2012.75C18.7042%2012.75%2019.1358%2012.3023%2019.1358%2011.75C19.1358%2011.1977%2018.7042%2010.75%2018.1719%2010.75C17.6396%2010.75%2017.2081%2011.1977%2017.2081%2011.75C17.2081%2012.3023%2017.6396%2012.75%2018.1719%2012.75Z'%20fill='%2316B8AF'/%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M20.9182%2017C21.0673%2016.9961%2021.1801%2017.1342%2021.1397%2017.2778C20.9389%2017.9902%2020.6203%2018.5975%2020.109%2019.1088C19.3606%2019.8571%2018.4117%2020.1892%2017.2393%2020.3469C16.1001%2020.5%2014.6444%2020.5%2012.8067%2020.5H10.6938C8.85607%2020.5%207.40044%2020.5%206.26122%2020.3469C5.0888%2020.1892%204.13985%2019.8571%203.39149%2019.1088C2.64312%2018.3604%202.31101%2017.4114%202.15338%2016.239C2.00022%2015.0998%202.00023%2013.6442%202.00024%2011.8064V11.6936C2.00023%209.85583%202.00022%208.40019%202.15338%207.26098C2.31101%206.08856%202.64312%205.13961%203.39149%204.39124C4.13985%203.64288%205.0888%203.31076%206.26122%203.15314C7.40044%202.99997%208.85607%202.99998%2010.6938%203L12.8067%203C14.6444%202.99998%2016.1001%202.99997%2017.2393%203.15314C18.4117%203.31076%2019.3606%203.64288%2020.109%204.39124C20.6203%204.90252%2020.9389%205.50974%2021.1396%206.22218C21.1801%206.36575%2021.0672%206.50387%2020.9181%206.5L18.3943%206.50001C15.5576%206.50001%2013.0574%208.74091%2013.0574%2011.75C13.0574%2014.7591%2015.5576%2017%2018.3943%2017L20.9182%2017ZM5.75024%207C5.33603%207%205.00024%207.33579%205.00024%207.75C5.00024%208.16421%205.33603%208.5%205.75024%208.5H9.75024C10.1645%208.5%2010.5002%208.16421%2010.5002%207.75C10.5002%207.33579%2010.1645%207%209.75024%207H5.75024Z'%20fill='%2316B8AF'/%3e%3c/svg%3e",P1e="data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M6%2019C4.34314%2019%203%2017.6569%203%2016V10C3%206.22877%203%204.34316%204.17157%203.17157C5.34315%202%207.22876%202%2011%202H15C16.6569%202%2018%203.34315%2018%205.00001'%20fill='%2316B8AF'/%3e%3cpath%20d='M5%2010.3529C5%207.35813%205%205.86074%205.93724%204.93035C6.87452%204%208.383%204%2011.4%204H14.6C17.617%204%2019.1255%204%2020.0628%204.93035C21%205.86074%2021%207.35813%2021%2010.3529V15.6471C21%2018.6419%2021%2020.1393%2020.0628%2021.0697C19.1255%2022%2017.617%2022%2014.6%2022H11.4C8.383%2022%206.87452%2022%205.93724%2021.0697C5%2020.1393%205%2018.6419%205%2015.6471V10.3529Z'%20fill='white'/%3e%3cpath%20d='M6%2011C6%208.17156%206%206.75736%206.87866%205.87866C7.75736%205%209.17156%205%2012%205H15C17.8284%205%2019.2426%205%2020.1213%205.87866C21%206.75736%2021%208.17156%2021%2011V16C21%2018.8284%2021%2020.2426%2020.1213%2021.1213C19.2426%2022%2017.8284%2022%2015%2022H12C9.17156%2022%207.75736%2022%206.87866%2021.1213C6%2020.2426%206%2018.8284%206%2016V11Z'%20fill='%2316B8AF'/%3e%3c/svg%3e",I1e="data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3ccircle%20cx='9.00073'%20cy='6'%20r='4'%20fill='%2316B8AF'/%3e%3cellipse%20cx='9.00073'%20cy='17.001'%20rx='7'%20ry='4'%20fill='%2316B8AF'/%3e%3cpath%20d='M20.9994%2017.0005C20.9994%2018.6573%2018.9638%2020.0004%2016.4786%2020.0004C17.2108%2019.2001%2017.7142%2018.1955%2017.7142%2017.0018C17.7142%2015.8068%2017.2096%2014.8013%2016.476%2014.0005C18.9613%2014.0005%2020.9994%2015.3436%2020.9994%2017.0005Z'%20fill='%2316B8AF'/%3e%3cpath%20d='M17.9994%206.00073C17.9994%207.65759%2016.6562%209.00073%2014.9994%209.00073C14.6381%209.00073%2014.2917%208.93687%2013.9709%208.81981C14.444%207.98772%2014.7142%207.02522%2014.7142%205.99962C14.7142%204.97477%2014.4444%204.01294%2013.972%203.18127C14.2925%203.06446%2014.6385%203.00073%2014.9994%203.00073C16.6562%203.00073%2017.9994%204.34388%2017.9994%206.00073Z'%20fill='%2316B8AF'/%3e%3c/svg%3e";function R1e(){const e=zo();return ve.jsxs("div",{className:A1e.panel,children:[ve.jsx(Jv,{iconSrc:C1e,onClick:()=>e(Lw)}),ve.jsx(Jv,{iconSrc:M1e,onClick:()=>e(dy)}),ve.jsx(Jv,{iconSrc:O1e,onClick:()=>e(IN)}),ve.jsx(Jv,{iconSrc:P1e,onClick:()=>e(S1)}),ve.jsx(Jv,{iconSrc:I1e,onClick:()=>window.location.replace("https://t.me/egine_cpo")})]})}const D1e="data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20clip-path='url(%23clip0_1_383)'%3e%3cpath%20d='M17.1268%200.102663C17.2736%200.18777%2017.3872%200.320148%2017.4491%200.478169C17.5109%200.63619%2017.5173%200.810514%2017.4673%200.972663L14.7658%209.75066H19.7503C19.8968%209.7506%2020.0401%209.79344%2020.1625%209.87389C20.2849%209.95434%2020.3811%2010.0689%2020.4392%2010.2034C20.4972%2010.3378%2020.5146%2010.4864%2020.4893%2010.6306C20.4639%2010.7749%2020.3968%2010.9086%2020.2963%2011.0152L8.2963%2023.7652C8.18019%2023.8886%208.02568%2023.9691%207.85796%2023.9935C7.69024%2024.018%207.51919%2023.9848%207.3727%2023.8996C7.22622%2023.8143%207.11292%2023.682%207.05129%2023.5241C6.98965%2023.3662%206.98331%2023.1921%207.0333%2023.0302L9.7348%2014.2507H4.7503C4.60382%2014.2507%204.46052%2014.2079%204.33811%2014.1274C4.21569%2014.047%204.11951%2013.9325%204.06145%2013.798C4.00338%2013.6635%203.98596%2013.5149%204.01135%2013.3707C4.03674%2013.2264%204.10381%2013.0927%204.2043%2012.9862L16.2043%200.236163C16.3203%200.112861%2016.4745%200.0324155%2016.642%200.00790543C16.8095%20-0.0166046%2016.9804%200.0162624%2017.1268%200.101163V0.102663Z'%20fill='white'/%3e%3c/g%3e%3cdefs%3e%3cclipPath%20id='clip0_1_383'%3e%3crect%20width='24'%20height='24'%20fill='white'/%3e%3c/clipPath%3e%3c/defs%3e%3c/svg%3e",L1e="_notify_13sw7_1",k1e={notify:L1e};function z1e(){const e=zo(),{activeChargingSession:t}=Ie.useContext(Bo);return NV(),t?ve.jsx("div",{className:k1e.notify,children:ve.jsx(vf,{onClick:()=>e(kw+t.id+lc([{key:E1.PREVIOUS_PAGE,value:A1.MAIN}])),variant:"icon",iconSrc:D1e})}):ve.jsx(ve.Fragment,{})}const B1e="data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3ccircle%20cx='11.5'%20cy='11.5'%20r='9.5'%20stroke='%23373435'%20stroke-width='1.5'/%3e%3cpath%20d='M18.5%2018.5L22%2022'%20stroke='%23373435'%20stroke-width='1.5'%20stroke-linecap='round'/%3e%3c/svg%3e",N1e="_search_xfj89_1",F1e="_search__input_xfj89_9",j1e="_search__input_outlined_xfj89_25",U1e="_search__input_shadow_xfj89_30",V1e="_search__input_disabled_xfj89_44",$1e="_search__icon_xfj89_49",Qv={search:N1e,search__input:F1e,search__input_outlined:j1e,search__input_shadow:U1e,search__input_disabled:V1e,search__icon:$1e};function q1e(e){var o;const[t,a]=Ie.useState(((o=e.value)==null?void 0:o.toString())??"");return Ie.useEffect(()=>{e.value!==void 0&&a(e.value.toString())},[e.value]),ve.jsxs("div",{className:Qv.search,children:[ve.jsx("img",{className:Qv.search__icon,src:B1e,alt:"Search"}),ve.jsx("input",{placeholder:e.placeholder,className:`${Qv.search__input} ${Qv["search__input_"+e.variant]} ${e.disabled?Qv.search__input_disabled:""}`,disabled:e.disabled,value:t,onChange:h=>{var b;const y=h.target.value;a(y),(b=e.onChange)==null||b.call(e,y)},maxLength:e.maxLength})]})}const G1e=()=>{const{setStations:e,stationFilters:t,position:a}=Ie.useContext(Bo),{getStationsFromApi:o}=X0(),[h,y]=Ie.useState(!0);return Ie.useEffect(()=>{if(!t.shouldUpdateStations){y(!1);return}o(i5(t,a)).then(b=>{e(b)}).finally(()=>y(!1))},[t]),{stationsLoading:h}};function H1e(){const e=zo(),{position:t,setPosition:a}=Ie.useContext(Bo),{stationsLoading:o}=G1e();Ie.useEffect(()=>{const y=navigator.geolocation;if(t!==void 0||!y)return;const b=y.watchPosition(i=>{a({latitude:i.coords.latitude,longitude:i.coords.longitude})},()=>{a(null)});return()=>y.clearWatch(b)},[]);const h=()=>{e(rO+lc([{key:T1.PREVIOUS_PAGE,value:zg.MAIN}]))};return ve.jsxs("div",{children:[!o&&ve.jsxs("div",{className:$M.header,children:[ve.jsx(q1e,{placeholder:"",variant:"shadow",disabled:!0}),ve.jsx(zw,{onClick:h,variant:"outlined",iconSrc:iO}),ve.jsx("div",{className:$M.header__activeSession,children:ve.jsx(z1e,{})})]}),ve.jsx(v1e,{loading:o}),!o&&ve.jsx("div",{className:$M.footer,children:ve.jsx(R1e,{})})]})}const Z1e="_page__main_1avjm_1",W1e={page__main:Z1e},X1e="_actionButton_6qrpp_1",Y1e="_actionButton_green_6qrpp_21",K1e="_actionButton_red_6qrpp_29",J1e="_actionButton_disabled_6qrpp_37",Q1e="_actionButton__loader_6qrpp_44",yb={actionButton:X1e,actionButton_green:Y1e,actionButton_red:K1e,actionButton_disabled:J1e,actionButton__loader:Q1e};function CP(e){return ve.jsx("button",{className:`${yb.actionButton} ${yb[`actionButton_${e.variant}`]} ${e.disabled||e.loading?yb.actionButton_disabled:""}`,onClick:()=>{!e.loading&&!e.disabled&&e.onClick()},disabled:e.disabled,children:e.loading?ve.jsx(jg,{className:yb.actionButton__loader}):e.text})}const e2e="_content__info_129k4_1",t2e="_info__title_129k4_9",n2e="_info__icon_129k4_21",r2e="_info__text_129k4_27",i2e="_info__text_paymentMethod_129k4_36",e1={content__info:e2e,info__title:t2e,info__icon:n2e,info__text:r2e,info__text_paymentMethod:i2e};function a2e(e){const t=!!e.paymentMethod;return ve.jsxs("div",{className:e1.content__info,children:[ve.jsx("p",{className:e1.info__title,children:t?"  ":"   "}),ve.jsx("img",{src:t?BF:TO,alt:"Notify icon",className:e1.info__icon}),ve.jsx("p",{className:`${e1.info__text} ${t?e1.info__text_paymentMethod:""}`,children:t?e.paymentMethod:"         "})]})}const o2e=()=>{const{setPaymentMethod:e}=Ie.useContext(Bo),{getPaymentMethodFromApi:t}=X0(),[a,o]=Ie.useState(!0);return Ie.useEffect(()=>{t({}).then(h=>{e(h)}).finally(()=>o(!1))},[]),{loading:a}};function s2e(){const e=zo(),{loading:t}=o2e(),{paymentMethod:a}=Ie.useContext(Bo);return ve.jsxs(Qd,{onReturn:()=>e("/"),title:" ",loading:t,children:[ve.jsx("div",{className:W1e.page__main,children:ve.jsx(a2e,{paymentMethod:a})}),ve.jsx(CP,{text:a?"  ":"  ",variant:a?"red":"green",onClick:()=>{console.log(a?"  ":"  ")}})]})}const l2e="_page__content_withCard_1qie9_1",c2e="_page__content_withoutCard_1qie9_2",CB={page__content_withCard:l2e,page__content_withoutCard:c2e},u2e=()=>{const{setRfidCard:e}=Ie.useContext(Bo),{getRfidCardFromApi:t}=X0(),[a,o]=Ie.useState(!0);return Ie.useEffect(()=>{t({}).then(h=>{e(h)}).finally(()=>o(!1))},[]),{loading:a}},h2e="data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M20%2012.421C20%205.74751%2015.7143%202.38016%2015.5306%202.25771C14.9796%201.82914%2014.2449%201.95159%2013.8163%202.50261C13.6193%202.75663%2013.5283%203.07712%2013.5626%203.39678C13.5968%203.71644%2013.7536%204.01039%2014%204.2169C14.1224%204.33935%2017.4898%207.03322%2017.4898%2012.421C17.4898%2017.8087%2014.1224%2020.5026%2014%2020.6251C13.8509%2020.7419%2013.7296%2020.8903%2013.6449%2021.0597C13.5602%2021.2292%2013.5142%2021.4153%2013.5102%2021.6047C13.5102%2021.8495%2013.5714%2022.1557%2013.7551%2022.3393C14.2449%2022.8904%2014.9796%2023.0128%2015.5306%2022.5842C15.7143%2022.4618%2020%2019.0944%2020%2012.421Z'%20fill='%23373435'%20stroke='%23373435'%20stroke-width='0.000533333'/%3e%3cpath%20d='M15.4082%2012.4209C15.4082%208.5638%2013.0204%206.17605%2012.898%206.0536C12.6699%205.83005%2012.3627%205.70556%2012.0434%205.70717C11.724%205.70878%2011.4181%205.83637%2011.1923%206.06221C10.9664%206.28805%2010.8389%206.59389%2010.8372%206.91328C10.8356%207.23266%2010.9601%207.53977%2011.1837%207.76788C12.3104%209.0582%2012.9399%2010.7081%2012.9592%2012.4209C12.9399%2014.1338%2012.3104%2015.7837%2011.1837%2017.074C11.0676%2017.1846%2010.9753%2017.3176%2010.9122%2017.4649C10.8491%2017.6122%2010.8165%2017.7709%2010.8165%2017.9311C10.8165%2018.0914%2010.8491%2018.25%2010.9122%2018.3974C10.9753%2018.5447%2011.0676%2018.6777%2011.1837%2018.7883C11.2943%2018.9043%2011.4272%2018.9967%2011.5746%2019.0598C11.7219%2019.1229%2011.8805%2019.1555%2012.0408%2019.1555C12.2011%2019.1555%2012.3597%2019.1229%2012.5071%2019.0598C12.6544%2018.9967%2012.7874%2018.9043%2012.898%2018.7883C13.0204%2018.6658%2015.4082%2016.2781%2015.4082%2012.4209Z'%20fill='%23373435'%20stroke='%23373435'%20stroke-width='0.000533333'/%3e%3cpath%20d='M7.44898%2012.421C7.44898%2012.0962%207.31997%2011.7848%207.09034%2011.5551C6.8607%2011.3255%206.54925%2011.1965%206.22449%2011.1965C5.98231%2011.1965%205.74557%2011.2683%205.5442%2011.4028C5.34284%2011.5374%205.18589%2011.7286%205.09321%2011.9524C5.00053%2012.1761%204.97628%2012.4223%205.02353%2012.6598C5.07078%2012.8974%205.1874%2013.1156%205.35865%2013.2868C5.52989%2013.4581%205.74808%2013.5747%205.98561%2013.6219C6.22313%2013.6692%206.46934%2013.6449%206.69308%2013.5522C6.91683%2013.4596%207.10807%2013.3026%207.24262%2013.1013C7.37717%2012.8999%207.44898%2012.6631%207.44898%2012.421Z'%20fill='%23373435'%20stroke='%23373435'%20stroke-width='0.000533333'/%3e%3cpath%20d='M9.83674%2015.6659C10.0204%2015.5434%2011.1225%2014.2577%2011.1225%2012.421C11.1225%2010.6455%2010.0204%209.29854%209.89796%209.17609C9.683%208.9388%209.38476%208.79361%209.06539%208.7708C8.74603%208.74799%208.43018%208.84931%208.18368%209.05364C7.69388%209.48221%207.57143%2010.2781%208%2010.7679C8%2010.7679%208.61225%2011.5638%208.61225%2012.421C8.61225%2013.3394%208%2014.074%208%2014.074C7.82001%2014.3024%207.7133%2014.5799%207.69388%2014.87C7.69281%2015.0452%207.73071%2015.2185%207.80483%2015.3774C7.87895%2015.5362%207.98744%2015.6766%208.12245%2015.7883C8.61225%2016.2169%209.40817%2016.2169%209.83674%2015.6659Z'%20fill='%23373435'%20stroke='%23373435'%20stroke-width='0.000533333'/%3e%3c/svg%3e",f2e="_card_1tkln_1",d2e="_card__header_1tkln_10",p2e="_header__left_1tkln_16",m2e="_left__text_1tkln_22",_2e="_left__icon_1tkln_30",g2e="_card__content_1tkln_36",bg={card:f2e,card__header:d2e,header__left:p2e,left__text:m2e,left__icon:_2e,card__content:g2e},y2e="_number_1hr8m_1",v2e="_number__text_1hr8m_9",MB={number:y2e,number__text:v2e},x2e="data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M3.27489%2015.2957C2.42496%2014.1915%202%2013.6394%202%2012C2%2010.3606%202.42496%209.80853%203.27489%208.70433C4.97196%206.49956%207.81811%204%2012%204C16.1819%204%2019.028%206.49956%2020.7251%208.70433C21.575%209.80853%2022%2010.3606%2022%2012C22%2013.6394%2021.575%2014.1915%2020.7251%2015.2957C19.028%2017.5004%2016.1819%2020%2012%2020C7.81811%2020%204.97196%2017.5004%203.27489%2015.2957Z'%20stroke='%23373435'%20stroke-width='1.5'/%3e%3cpath%20d='M15%2012C15%2013.6569%2013.6569%2015%2012%2015C10.3431%2015%209%2013.6569%209%2012C9%2010.3431%2010.3431%209%2012%209C13.6569%209%2015%2010.3431%2015%2012Z'%20stroke='%23373435'%20stroke-width='1.5'/%3e%3c/svg%3e",b2e="data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M2.68936%206.70456C2.52619%206.32384%202.08528%206.14747%201.70456%206.31064C1.32384%206.47381%201.14747%206.91472%201.31064%207.29544L2.68936%206.70456ZM15.5872%2013.3287L15.3125%2012.6308L15.5872%2013.3287ZM9.04145%2013.7377C9.26736%2013.3906%209.16904%2012.926%208.82185%2012.7001C8.47466%2012.4742%208.01008%2012.5725%207.78417%2012.9197L9.04145%2013.7377ZM6.37136%2015.091C6.14545%2015.4381%206.24377%2015.9027%206.59096%2016.1286C6.93815%2016.3545%207.40273%2016.2562%207.62864%2015.909L6.37136%2015.091ZM22.6894%207.29544C22.8525%206.91472%2022.6762%206.47381%2022.2954%206.31064C21.9147%206.14747%2021.4738%206.32384%2021.3106%206.70456L22.6894%207.29544ZM19%2011.1288L18.4867%2010.582V10.582L19%2011.1288ZM19.9697%2013.1592C20.2626%2013.4521%2020.7374%2013.4521%2021.0303%2013.1592C21.3232%2012.8663%2021.3232%2012.3914%2021.0303%2012.0985L19.9697%2013.1592ZM11.25%2016.5C11.25%2016.9142%2011.5858%2017.25%2012%2017.25C12.4142%2017.25%2012.75%2016.9142%2012.75%2016.5H11.25ZM16.3714%2015.909C16.5973%2016.2562%2017.0619%2016.3545%2017.409%2016.1286C17.7562%2015.9027%2017.8545%2015.4381%2017.6286%2015.091L16.3714%2015.909ZM5.53033%2011.6592C5.82322%2011.3663%205.82322%2010.8914%205.53033%2010.5985C5.23744%2010.3056%204.76256%2010.3056%204.46967%2010.5985L5.53033%2011.6592ZM2.96967%2012.0985C2.67678%2012.3914%202.67678%2012.8663%202.96967%2013.1592C3.26256%2013.4521%203.73744%2013.4521%204.03033%2013.1592L2.96967%2012.0985ZM12%2013.25C8.77611%2013.25%206.46133%2011.6446%204.9246%209.98966C4.15645%209.16243%203.59325%208.33284%203.22259%207.71014C3.03769%207.3995%202.90187%207.14232%202.8134%206.96537C2.76919%206.87696%202.73689%206.80875%202.71627%206.76411C2.70597%206.7418%202.69859%206.7254%202.69411%206.71533C2.69187%206.7103%202.69036%206.70684%202.68957%206.70503C2.68917%206.70413%202.68896%206.70363%202.68892%206.70355C2.68891%206.70351%202.68893%206.70357%202.68901%206.70374C2.68904%206.70382%202.68913%206.70403%202.68915%206.70407C2.68925%206.7043%202.68936%206.70456%202%207C1.31064%207.29544%201.31077%207.29575%201.31092%207.29609C1.31098%207.29624%201.31114%207.2966%201.31127%207.2969C1.31152%207.29749%201.31183%207.2982%201.31218%207.299C1.31287%207.30062%201.31376%207.30266%201.31483%207.30512C1.31698%207.31003%201.31988%207.31662%201.32353%207.32483C1.33083%207.34125%201.34115%207.36415%201.35453%207.39311C1.38127%207.45102%201.42026%207.5332%201.47176%207.63619C1.57469%207.84206%201.72794%208.13175%201.93366%208.47736C2.34425%209.16716%202.96855%2010.0876%203.8254%2011.0103C5.53867%2012.8554%208.22389%2014.75%2012%2014.75V13.25ZM15.3125%2012.6308C14.3421%2013.0128%2013.2417%2013.25%2012%2013.25V14.75C13.4382%2014.75%2014.7246%2014.4742%2015.8619%2014.0266L15.3125%2012.6308ZM7.78417%2012.9197L6.37136%2015.091L7.62864%2015.909L9.04145%2013.7377L7.78417%2012.9197ZM22%207C21.3106%206.70456%2021.3107%206.70441%2021.3108%206.70427C21.3108%206.70423%2021.3108%206.7041%2021.3109%206.70402C21.3109%206.70388%2021.311%206.70376%2021.311%206.70368C21.3111%206.70352%2021.3111%206.70349%2021.3111%206.7036C21.311%206.7038%2021.3107%206.70452%2021.3101%206.70576C21.309%206.70823%2021.307%206.71275%2021.3041%206.71924C21.2983%206.73223%2021.2889%206.75309%2021.2758%206.78125C21.2495%206.83757%2021.2086%206.92295%2021.1526%207.03267C21.0406%207.25227%2020.869%207.56831%2020.6354%207.9432C20.1669%208.69516%2019.4563%209.67197%2018.4867%2010.582L19.5133%2011.6757C20.6023%2010.6535%2021.3917%209.56587%2021.9085%208.73646C22.1676%208.32068%2022.36%207.9668%2022.4889%207.71415C22.5533%207.58775%2022.602%207.48643%2022.6353%207.41507C22.6519%207.37939%2022.6647%207.35118%2022.6737%207.33104C22.6782%207.32097%2022.6818%207.31292%2022.6844%207.30696C22.6857%207.30398%2022.6867%207.30153%2022.6876%207.2996C22.688%207.29864%2022.6883%207.29781%2022.6886%207.29712C22.6888%207.29677%2022.6889%207.29646%2022.689%207.29618C22.6891%207.29604%2022.6892%207.29585%2022.6892%207.29578C22.6893%207.29561%2022.6894%207.29544%2022%207ZM18.4867%2010.582C17.6277%2011.3882%2016.5739%2012.1343%2015.3125%2012.6308L15.8619%2014.0266C17.3355%2013.4466%2018.5466%2012.583%2019.5133%2011.6757L18.4867%2010.582ZM18.4697%2011.6592L19.9697%2013.1592L21.0303%2012.0985L19.5303%2010.5985L18.4697%2011.6592ZM11.25%2014V16.5H12.75V14H11.25ZM14.9586%2013.7377L16.3714%2015.909L17.6286%2015.091L16.2158%2012.9197L14.9586%2013.7377ZM4.46967%2010.5985L2.96967%2012.0985L4.03033%2013.1592L5.53033%2011.6592L4.46967%2010.5985Z'%20fill='%23373435'/%3e%3c/svg%3e",w2e=(e,t="*")=>{const a=e.length;let o=0;return a>8?o=4:a>6?o=3:a>4&&(o=1),t.repeat(e.length-o)+e.slice(-o)};function S2e(e){const[t,a]=Ie.useState(!0);return ve.jsxs("div",{className:MB.number,children:[ve.jsx("a",{className:MB.number__text,children:t?w2e(e.number):e.number}),ve.jsx(vf,{variant:"text",iconSrc:t?x2e:b2e,onClick:()=>a(!t),text:t?"":""})]})}const T2e="_row_1qbe6_1",E2e="_row__first_1qbe6_7",A2e="_row__second_1qbe6_8",qM={row:T2e,row__first:E2e,row__second:A2e};function OB(e){return ve.jsxs("div",{className:qM.row,children:[ve.jsxs("a",{className:qM.row__first,children:[e.name,":"]}),ve.jsx("a",{className:qM.row__second,children:e.value})]})}function C2e(e){return ve.jsxs(ko,{className:bg.card,children:[ve.jsxs("div",{className:bg.card__header,children:[ve.jsxs("div",{className:bg.header__left,children:[ve.jsx("a",{className:bg.left__text,children:"RFID"}),ve.jsx("img",{className:bg.left__icon,src:h2e,alt:"NFC"})]}),ve.jsx(S2e,{number:e.card.visual_number})]}),ve.jsxs("div",{className:bg.card__content,children:[ve.jsx(OB,{name:"",value:""}),e.card.group&&ve.jsx(OB,{name:"",value:e.card.group})]})]})}const M2e="_card_1sr6t_1",O2e="_card__title_1sr6t_8",P2e="_card__icon_1sr6t_17",I2e="_card__description_1sr6t_22",vb={card:M2e,card__title:O2e,card__icon:P2e,card__description:I2e};function R2e(){const{rfidCard:e}=Ie.useContext(Bo);return e?ve.jsx(C2e,{card:e}):ve.jsxs("div",{className:vb.card,children:[ve.jsx("a",{className:vb.card__title,children:" RFID  "}),ve.jsx("img",{className:vb.card__icon,src:TO,alt:"Warning"}),ve.jsx("a",{className:vb.card__description,children:"        "})]})}function D2e(){const e=zo(),{rfidCard:t}=Ie.useContext(Bo),{loading:a}=u2e(),o=()=>{t||e(PN)};return ve.jsxs(Qd,{onReturn:()=>e("/"),title:" ",loading:a,children:[ve.jsx("div",{className:t?CB.page__content_withCard:CB.page__content_withoutCard,children:ve.jsx(R2e,{})}),ve.jsx(CP,{text:t?" ":" ",variant:t?"red":"green",onClick:o})]})}const L2e="_page_gyrrp_1",k2e="_page__content_gyrrp_5",PB={page:L2e,page__content:k2e},z2e="_container_hy4xf_1",B2e="_container__input_hy4xf_6",N2e="_input__required_hy4xf_60",F2e="_container__input_error_hy4xf_64",j2e="_container__error_hy4xf_68",t1={container:z2e,container__input:B2e,input__required:N2e,container__input_error:F2e,container__error:j2e};function U2e(e){var y;const t=Ie.useId(),[a,o]=Ie.useState(((y=e.value)==null?void 0:y.toString())??"");Ie.useEffect(()=>{e.value!==void 0&&o(e.value.toString())},[e.value]);const h=e.id??t;return ve.jsxs("div",{className:t1.container,children:[ve.jsxs("div",{className:t1.container__input,children:[ve.jsx("input",{id:e.id??h,placeholder:" ",required:e.required,className:e.error?t1.container__input_error:"",disabled:e.disabled,value:a,onChange:b=>{var C;const i=b.target.value;o(i),(C=e.onChange)==null||C.call(e,i)},maxLength:e.maxLength}),ve.jsxs("label",{htmlFor:h,children:[e.label," ",e.required&&ve.jsx("span",{className:t1.input__required,children:"*"})]})]}),e.error&&e.errorText&&ve.jsx("p",{className:t1.container__error,children:e.errorText})]})}const V2e="_form_1uszz_1",$2e="_form__description_1uszz_7",IB={form:V2e,form__description:$2e},GV={visualNumber:""},HV=Ie.createContext({form:GV,setForm:e=>{}});function q2e(){const{form:e,setForm:t,error:a}=Ie.useContext(HV);return ve.jsxs("div",{className:IB.form,children:[ve.jsx("a",{className:IB.form__description,children:"         :"}),ve.jsx(U2e,{label:" ",required:!0,value:e.visualNumber,onChange:o=>t({...e,visualNumber:o}),error:!!a,errorText:a})]})}const G2e=()=>{const{attachRfidCardFromApi:e}=X0(),[t,a]=Ie.useState(!1);return{addRfidCard:async h=>(a(!0),e({visualCardNumber:h.visualNumber}).then(y=>y==null?void 0:y.message).finally(()=>a(!1))),loading:t}};function H2e(){const e=zo(),{addRfidCard:t,loading:a}=G2e(),[o,h]=Ie.useState(GV),[y,b]=Ie.useState(),i=!!o.visualNumber.length,C=async()=>{const I=await t(o);I?b(I):e(S1)};return ve.jsxs(Qd,{onReturn:()=>e(S1),title:"  ",className:PB.page,children:[ve.jsx("div",{className:PB.page__content,children:ve.jsx(HV.Provider,{value:{form:o,setForm:I=>{h(I),b(void 0)},error:y},children:ve.jsx(q2e,{})})}),ve.jsx(CP,{text:" ",variant:"green",onClick:C,disabled:!i||!!y,loading:a})]})}function Z2e(){return ve.jsxs(_Z,{children:[ve.jsx(th,{path:rO,element:ve.jsx(Wte,{})}),ve.jsx(th,{path:ON,element:ve.jsx(vne,{})}),ve.jsx(th,{path:Lw,element:ve.jsx(jQ,{})}),ve.jsx(th,{path:`${_2}:id`,element:ve.jsx(fte,{})}),ve.jsx(th,{path:dy,element:ve.jsx(xre,{})}),ve.jsx(th,{path:`${kw}:id`,element:ve.jsx(sve,{})}),ve.jsx(th,{path:IN,element:ve.jsx(s2e,{})}),ve.jsx(th,{path:S1,element:ve.jsx(D2e,{})}),ve.jsx(th,{path:PN,element:ve.jsx(H2e,{})}),ve.jsx(th,{path:"*",element:ve.jsx(H1e,{})})]})}function W2e(){const[e,t]=Ie.useState({text:void 0,variant:void 0,isVisible:!1}),a=(h,y)=>{t({text:y,variant:h,isVisible:!0}),setTimeout(()=>{t(b=>({...b,isVisible:!1}))},3e3)},o=e.isVisible&&e.variant&&e.text?ve.jsx(_5,{variant:e.variant,text:e.text}):ve.jsx(ve.Fragment,{});return{showSnackbar:a,snackbar:o}}function ZV(e){return{lang:(e==null?void 0:e.lang)??void 0,message:e==null?void 0:e.message,abortEarly:(e==null?void 0:e.abortEarly)??void 0,abortPipeEarly:(e==null?void 0:e.abortPipeEarly)??void 0}}function X2e(e,t){var a;return(a=void 0)==null?void 0:a.get(t)}function Y2e(e){var t,a;const o=typeof e;return o==="string"?`"${e}"`:o==="number"||o==="bigint"||o==="boolean"?`${e}`:o==="object"||o==="function"?(e&&((a=(t=Object.getPrototypeOf(e))==null?void 0:t.constructor)==null?void 0:a.name))??"null":o}function uy(e,t,a,o,h){const y=h&&"input"in h?h.input:a.value,b=(h==null?void 0:h.expected)??e.expects??null,i=(h==null?void 0:h.received)??Y2e(y),C={kind:e.kind,type:e.type,input:y,expected:b,received:i,message:`Invalid ${t}: ${b?`Expected ${b} but r`:"R"}eceived ${i}`,requirement:e.requirement,path:h==null?void 0:h.path,issues:h==null?void 0:h.issues,lang:o.lang,abortEarly:o.abortEarly,abortPipeEarly:o.abortPipeEarly},I=e.kind==="schema",j=(h==null?void 0:h.message)??e.message??X2e(e.reference,C.lang)??(I?(C.lang,void 0):null)??o.message??(C.lang,void 0);j&&(C.message=typeof j=="function"?j(C):j),I&&(a.typed=!1),a.issues?a.issues.push(C):a.issues=[C]}function Af(e){return{version:1,vendor:"valibot",validate(t){return e["~run"]({value:t},ZV())}}}function K2e(e,t){return Object.hasOwn(e,t)&&t!=="__proto__"&&t!=="prototype"&&t!=="constructor"}var J2e=class extends Error{constructor(e){super(e[0].message),this.name="ValiError",this.issues=e}};function MP(e,t,a){return typeof e.default=="function"?e.default(t,a):e.default}function OP(e,t){return!e["~run"]({value:t},{abortEarly:!0}).issues}function WV(){return{kind:"schema",type:"any",reference:WV,expects:"any",async:!1,get"~standard"(){return Af(this)},"~run"(e){return e.typed=!0,e}}}function D4(e){return{kind:"schema",type:"boolean",reference:D4,expects:"boolean",async:!1,message:e,get"~standard"(){return Af(this)},"~run"(t,a){return typeof t.value=="boolean"?t.typed=!0:uy(this,"type",t,a),t}}}function PP(e){return{kind:"schema",type:"function",reference:PP,expects:"Function",async:!1,message:e,get"~standard"(){return Af(this)},"~run"(t,a){return typeof t.value=="function"?t.typed=!0:uy(this,"type",t,a),t}}}function ih(e,t){return{kind:"schema",type:"loose_object",reference:ih,expects:"Object",async:!1,entries:e,message:t,get"~standard"(){return Af(this)},"~run"(a,o){var h;const y=a.value;if(y&&typeof y=="object"){a.typed=!0,a.value={};for(const b in this.entries){const i=this.entries[b];if(b in y||(i.type==="exact_optional"||i.type==="optional"||i.type==="nullish")&&i.default!==void 0){const C=b in y?y[b]:MP(i),I=i["~run"]({value:C},o);if(I.issues){const j={type:"object",origin:"value",input:y,key:b,value:C};for(const F of I.issues)F.path?F.path.unshift(j):F.path=[j],(h=a.issues)==null||h.push(F);if(a.issues||(a.issues=I.issues),o.abortEarly){a.typed=!1;break}}I.typed||(a.typed=!1),a.value[b]=I.value}else if(i.type!=="exact_optional"&&i.type!=="optional"&&i.type!=="nullish"&&(uy(this,"key",a,o,{input:void 0,expected:`"${b}"`,path:[{type:"object",origin:"key",input:y,key:b,value:y[b]}]}),o.abortEarly))break}if(!a.issues||!o.abortEarly)for(const b in y)K2e(y,b)&&!(b in this.entries)&&(a.value[b]=y[b])}else uy(this,"type",a,o);return a}}}function c1(e,t){return{kind:"schema",type:"nullish",reference:c1,expects:`(${e.expects} | null | undefined)`,async:!1,wrapped:e,default:t,get"~standard"(){return Af(this)},"~run"(a,o){return(a.value===null||a.value===void 0)&&(this.default!==void 0&&(a.value=MP(this,a,o)),a.value===null||a.value===void 0)?(a.typed=!0,a):this.wrapped["~run"](a,o)}}}function L4(e){return{kind:"schema",type:"number",reference:L4,expects:"number",async:!1,message:e,get"~standard"(){return Af(this)},"~run"(t,a){return typeof t.value=="number"&&!isNaN(t.value)?t.typed=!0:uy(this,"type",t,a),t}}}function k4(e,t){return{kind:"schema",type:"optional",reference:k4,expects:`(${e.expects} | undefined)`,async:!1,wrapped:e,default:t,get"~standard"(){return Af(this)},"~run"(a,o){return a.value===void 0&&(this.default!==void 0&&(a.value=MP(this,a,o)),a.value===void 0)?(a.typed=!0,a):this.wrapped["~run"](a,o)}}}function B0(e){return{kind:"schema",type:"string",reference:B0,expects:"string",async:!1,message:e,get"~standard"(){return Af(this)},"~run"(t,a){return typeof t.value=="string"?t.typed=!0:uy(this,"type",t,a),t}}}function XV(){return{kind:"schema",type:"unknown",reference:XV,expects:"unknown",async:!1,get"~standard"(){return Af(this)},"~run"(e){return e.typed=!0,e}}}function RB(e,t,a){const o=e["~run"]({value:t},ZV(a));if(o.issues)throw new J2e(o.issues);return o.value}function Q2e(...e){return{...e[0],pipe:e,get"~standard"(){return Af(this)},"~run"(t,a){for(const o of e)if(o.kind!=="metadata"){if(t.issues&&(o.kind==="schema"||o.kind==="transformation")){t.typed=!1;break}(!t.issues||!a.abortEarly&&!a.abortPipeEarly)&&(t=o["~run"](t,a))}return t}}}function YV(e){return OP(ih({TelegramWebviewProxy:ih({postEvent:PP()})}),e)}function exe(){try{return window.self!==window.top}catch{return!0}}var txe=Object.defineProperty,nxe=(e,t,a)=>t in e?txe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,DB=(e,t,a)=>nxe(e,typeof t!="symbol"?t+"":t,a);function rxe(e){return t=>t instanceof e}function KV(e,t){t||(t=[]);class a extends Error{constructor(...h){const y=typeof t=="function"?t(...h):typeof t=="string"?[t]:t||[];super(...y),this.name=e}}return Object.defineProperty(a,"name",{value:e}),[a,rxe(a)]}const[ixe,p3e]=KV("CancelledError","Promise was canceled"),[axe,m3e]=KV("TimeoutError",(e,t)=>[`Timeout reached: ${e}ms`,{cause:t}]),JV=Symbol("Resolved");function LB(e){return Array.isArray(e)&&e[0]===JV}function oxe(e){return[JV,e]}function kB(e,t){return e.reject=t.reject,e.abort=t.abort,e}let QV=class z4 extends Promise{constructor(t,a){let o,h;super((y,b)=>{let i,C;typeof t=="function"?(i=t,C=a):C=t;const I=[],j=me=>(...we)=>{const Ge=me(...we);return I.forEach(He=>He()),Ge},F=new AbortController,{signal:G}=F;h=me=>{!G.aborted&&F.abort(me)};const X=()=>G.reason,Y=me=>{const we=()=>{me(X())};G.addEventListener("abort",we,!0);const Ge=()=>{G.removeEventListener("abort",we,!0)};return I.push(Ge),Ge},J=j(me=>{y(me),h(oxe(me))});o=j(me=>{b(me),h(me)}),C||(C={});const{abortSignal:ee,rejectOnAbort:oe=!0}=C;if(ee)if(ee.aborted){const{reason:me}=ee;if(oe)return o(me);h(me)}else{const me=()=>{h(ee.reason)};ee.addEventListener("abort",me),I.push(()=>{ee.removeEventListener("abort",me)})}oe&&Y(b);const{timeout:ge}=C;if(ge){const me=setTimeout(()=>{h(new axe(ge))},ge);I.push(()=>{clearTimeout(me)})}const fe=()=>G.aborted,xe=()=>LB(X()),ae=()=>{const me=X();return LB(me)?me[1]:void 0};try{const me=i&&i(J,o,{abortReason:X,abortSignal:G,isAborted:fe,isResolved:xe,onAborted:Y,onResolved:we=>Y(()=>{xe()&&we(ae())}),resolved:ae,throwIfAborted(){if(fe())throw X()}});me instanceof Promise&&me.catch(o)}catch(me){o(me)}}),DB(this,"abort"),DB(this,"reject"),this.abort=h,this.reject=o}static fn(t,a){return new z4(async(o,h,y)=>{try{o(await t(y))}catch(b){h(b)}},a)}static resolve(t){return this.fn(()=>t)}static reject(t){return new z4((a,o)=>{o(t)})}cancel(){this.abort(new ixe)}catch(t){return this.then(void 0,t)}finally(t){return kB(super.finally(t),this)}then(t,a){return kB(super.then(t,a),this)}};function e$(e){return`tapps/${e}`}function sxe(e,t){sessionStorage.setItem(e$(e),JSON.stringify(t))}function lxe(e){const t=sessionStorage.getItem(e$(e));try{return t?JSON.parse(t):void 0}catch{}}function cxe(...e){const t=e.flat(1);return[t.push.bind(t),()=>{t.forEach(a=>{a()})}]}function uxe(e,t){t||(t={});const{textColor:a,bgColor:o,shouldLog:h}=t,y=h===void 0?!0:h,b=typeof y=="boolean"?()=>y:y;function i(C,I,...j){if(I||b()){const F="font-weight:bold;padding:0 5px;border-radius:5px";console[C](`%c${Intl.DateTimeFormat("en-GB",{hour:"2-digit",minute:"2-digit",second:"2-digit",fractionalSecondDigits:3,timeZone:"UTC"}).format(new Date)}%c / %c${e}`,`${F};background-color: lightblue;color:black`,"",`${F};${a?`color:${a};`:""}${o?`background-color:${o}`:""}`,...j)}}return[i.bind(void 0,"log"),i.bind(void 0,"error")]}function t$(e){return{lang:(e==null?void 0:e.lang)??void 0,message:e==null?void 0:e.message,abortEarly:(e==null?void 0:e.abortEarly)??void 0,abortPipeEarly:(e==null?void 0:e.abortPipeEarly)??void 0}}function hxe(e,t){var a;return(a=void 0)==null?void 0:a.get(t)}function fxe(e){var t,a;const o=typeof e;return o==="string"?`"${e}"`:o==="number"||o==="bigint"||o==="boolean"?`${e}`:o==="object"||o==="function"?(e&&((a=(t=Object.getPrototypeOf(e))==null?void 0:t.constructor)==null?void 0:a.name))??"null":o}function cc(e,t,a,o,h){const y=h&&"input"in h?h.input:a.value,b=(h==null?void 0:h.expected)??e.expects??null,i=(h==null?void 0:h.received)??fxe(y),C={kind:e.kind,type:e.type,input:y,expected:b,received:i,message:`Invalid ${t}: ${b?`Expected ${b} but r`:"R"}eceived ${i}`,requirement:e.requirement,path:h==null?void 0:h.path,issues:h==null?void 0:h.issues,lang:o.lang,abortEarly:o.abortEarly,abortPipeEarly:o.abortPipeEarly},I=e.kind==="schema",j=(h==null?void 0:h.message)??e.message??hxe(e.reference,C.lang)??(I?(C.lang,void 0):null)??o.message??(C.lang,void 0);j&&(C.message=typeof j=="function"?j(C):j),I&&(a.typed=!1),a.issues?a.issues.push(C):a.issues=[C]}function mu(e){return{version:1,vendor:"valibot",validate(t){return e["~run"]({value:t},t$())}}}function n$(e,t){return Object.hasOwn(e,t)&&t!=="__proto__"&&t!=="prototype"&&t!=="constructor"}function dxe(e,t){const a=[...new Set(e)];return a.length>1?`(${a.join(` ${t} `)})`:a[0]??"never"}var pxe=class extends Error{constructor(e){super(e[0].message),this.name="ValiError",this.issues=e}};function r$(e,t){return{kind:"validation",type:"check",reference:r$,async:!1,expects:null,requirement:e,message:t,"~run"(a,o){return a.typed&&!this.requirement(a.value)&&cc(this,"input",a,o),a}}}function i$(e){return{kind:"validation",type:"integer",reference:i$,async:!1,expects:null,requirement:Number.isInteger,message:e,"~run"(t,a){return t.typed&&!this.requirement(t.value)&&cc(this,"integer",t,a),t}}}function mm(e){return{kind:"transformation",type:"transform",reference:mm,async:!1,operation:e,"~run"(t){return t.value=this.operation(t.value),t}}}function a$(e,t,a){return typeof e.default=="function"?e.default(t,a):e.default}function mxe(e,t){return!e["~run"]({value:t},{abortEarly:!0}).issues}function u1(e){return{kind:"schema",type:"boolean",reference:u1,expects:"boolean",async:!1,message:e,get"~standard"(){return mu(this)},"~run"(t,a){return typeof t.value=="boolean"?t.typed=!0:cc(this,"type",t,a),t}}}function o$(e){return{kind:"schema",type:"date",reference:o$,expects:"Date",async:!1,message:e,get"~standard"(){return mu(this)},"~run"(t,a){return t.value instanceof Date?isNaN(t.value)?cc(this,"type",t,a,{received:'"Invalid Date"'}):t.typed=!0:cc(this,"type",t,a),t}}}function s$(e,t){return{kind:"schema",type:"instance",reference:s$,expects:e.name,async:!1,class:e,message:t,get"~standard"(){return mu(this)},"~run"(a,o){return a.value instanceof this.class?a.typed=!0:cc(this,"type",a,o),a}}}function IP(e){return{kind:"schema",type:"lazy",reference:IP,expects:"unknown",async:!1,getter:e,get"~standard"(){return mu(this)},"~run"(t,a){return this.getter(t.value)["~run"](t,a)}}}function by(e,t){return{kind:"schema",type:"loose_object",reference:by,expects:"Object",async:!1,entries:e,message:t,get"~standard"(){return mu(this)},"~run"(a,o){var h;const y=a.value;if(y&&typeof y=="object"){a.typed=!0,a.value={};for(const b in this.entries){const i=this.entries[b];if(b in y||(i.type==="exact_optional"||i.type==="optional"||i.type==="nullish")&&i.default!==void 0){const C=b in y?y[b]:a$(i),I=i["~run"]({value:C},o);if(I.issues){const j={type:"object",origin:"value",input:y,key:b,value:C};for(const F of I.issues)F.path?F.path.unshift(j):F.path=[j],(h=a.issues)==null||h.push(F);if(a.issues||(a.issues=I.issues),o.abortEarly){a.typed=!1;break}}I.typed||(a.typed=!1),a.value[b]=I.value}else if(i.type!=="exact_optional"&&i.type!=="optional"&&i.type!=="nullish"&&(cc(this,"key",a,o,{input:void 0,expected:`"${b}"`,path:[{type:"object",origin:"key",input:y,key:b,value:y[b]}]}),o.abortEarly))break}if(!a.issues||!o.abortEarly)for(const b in y)n$(y,b)&&!(b in this.entries)&&(a.value[b]=y[b])}else cc(this,"type",a,o);return a}}}function BS(e){return{kind:"schema",type:"number",reference:BS,expects:"number",async:!1,message:e,get"~standard"(){return mu(this)},"~run"(t,a){return typeof t.value=="number"&&!isNaN(t.value)?t.typed=!0:cc(this,"type",t,a),t}}}function Ma(e,t){return{kind:"schema",type:"optional",reference:Ma,expects:`(${e.expects} | undefined)`,async:!1,wrapped:e,default:t,get"~standard"(){return mu(this)},"~run"(a,o){return a.value===void 0&&(this.default!==void 0&&(a.value=a$(this,a,o)),a.value===void 0)?(a.typed=!0,a):this.wrapped["~run"](a,o)}}}function l$(e,t,a){return{kind:"schema",type:"record",reference:l$,expects:"Object",async:!1,key:e,value:t,message:a,get"~standard"(){return mu(this)},"~run"(o,h){var y,b;const i=o.value;if(i&&typeof i=="object"){o.typed=!0,o.value={};for(const C in i)if(n$(i,C)){const I=i[C],j=this.key["~run"]({value:C},h);if(j.issues){const G={type:"object",origin:"key",input:i,key:C,value:I};for(const X of j.issues)X.path=[G],(y=o.issues)==null||y.push(X);if(o.issues||(o.issues=j.issues),h.abortEarly){o.typed=!1;break}}const F=this.value["~run"]({value:I},h);if(F.issues){const G={type:"object",origin:"value",input:i,key:C,value:I};for(const X of F.issues)X.path?X.path.unshift(G):X.path=[G],(b=o.issues)==null||b.push(X);if(o.issues||(o.issues=F.issues),h.abortEarly){o.typed=!1;break}}(!j.typed||!F.typed)&&(o.typed=!1),j.typed&&(o.value[j.value]=F.value)}}else cc(this,"type",o,h);return o}}}function Ui(e){return{kind:"schema",type:"string",reference:Ui,expects:"string",async:!1,message:e,get"~standard"(){return mu(this)},"~run"(t,a){return typeof t.value=="string"?t.typed=!0:cc(this,"type",t,a),t}}}function zB(e){let t;if(e)for(const a of e)t?t.push(...a.issues):t=a.issues;return t}function RP(e,t){return{kind:"schema",type:"union",reference:RP,expects:dxe(e.map(a=>a.expects),"|"),async:!1,options:e,message:t,get"~standard"(){return mu(this)},"~run"(a,o){let h,y,b;for(const i of this.options){const C=i["~run"]({value:a.value},o);if(C.typed)if(C.issues)y?y.push(C):y=[C];else{h=C;break}else b?b.push(C):b=[C]}if(h)return h;if(y){if(y.length===1)return y[0];cc(this,"type",a,o,{issues:zB(y)}),a.typed=!0}else{if((b==null?void 0:b.length)===1)return b[0];cc(this,"type",a,o,{issues:zB(b)})}return a}}}function c$(){return{kind:"schema",type:"unknown",reference:c$,expects:"unknown",async:!1,get"~standard"(){return mu(this)},"~run"(e){return e.typed=!0,e}}}function u$(e,t,a){const o=e["~run"]({value:t},t$(a));if(o.issues)throw new pxe(o.issues);return o.value}function _m(...e){return{...e[0],pipe:e,get"~standard"(){return mu(this)},"~run"(t,a){for(const o of e)if(o.kind!=="metadata"){if(t.issues&&(o.kind==="schema"||o.kind==="transformation")){t.typed=!1;break}(!t.issues||!a.abortEarly&&!a.abortPipeEarly)&&(t=o["~run"](t,a))}return t}}}function _xe(e){return e.replace(/_[a-z]/g,t=>t[1].toUpperCase())}function gxe(e){return Object.entries(e).reduce((t,[a,o])=>(t[_xe(a)]=o,t),{})}function B4(e){const t=gxe(e);for(const a in t){const o=t[a];o&&typeof o=="object"&&!(o instanceof Date)&&(t[a]=Array.isArray(o)?o.map(B4):B4(o))}return t}function DP(e){return mm(t=>e?B4(t):t)}function h$(e){return t=>_m(e,DP(t))}function yxe(e){return(t,a)=>u$(_m(e,DP(a)),t)}function f$(){return mm(JSON.parse)}function LP(e){const t=h$(e);return a=>_m(Ui(),f$(),t(a))}function vxe(e){return mm(t=>{const a={};return new URLSearchParams(t).forEach((o,h)=>{const y=a[h];Array.isArray(y)?y.push(o):y===void 0?a[h]=o:a[h]=[y,o]}),u$(e,a)})}function d$(e){return t=>_m(RP([Ui(),s$(URLSearchParams)]),vxe(e),DP(t))}const BB=Ma(IP(()=>Txe())),xxe=by({id:BS(),photo_url:Ma(Ui()),type:Ui(),title:Ui(),username:Ma(Ui())}),bxe=by({added_to_attachment_menu:Ma(u1()),allows_write_to_pm:Ma(u1()),first_name:Ui(),id:BS(),is_bot:Ma(u1()),is_premium:Ma(u1()),last_name:Ma(Ui()),language_code:Ma(Ui()),photo_url:Ma(Ui()),username:Ma(Ui())}),wxe=by({auth_date:_m(Ui(),mm(e=>new Date(Number(e)*1e3)),o$()),can_send_after:Ma(_m(Ui(),mm(Number),i$())),chat:Ma(IP(()=>Sxe())),chat_type:Ma(Ui()),chat_instance:Ma(Ui()),hash:Ui(),query_id:Ma(Ui()),receiver:BB,start_param:Ma(Ui()),signature:Ui(),user:BB}),Sxe=LP(xxe),Txe=LP(bxe),Exe=d$(wxe);function Axe(e){return/^#[\da-f]{6}$/i.test(e)}const p$=h$(l$(Ui(),_m(RP([Ui(),BS()]),mm(e=>typeof e=="number"?`#${(e&16777215).toString(16).padStart(6,"0")}`:e),r$(Axe)))),GM=Ma(_m(Ui(),mm(e=>e==="1"))),NB=LP(p$()),Cxe=by({tgWebAppBotInline:GM,tgWebAppData:Ma(Exe()),tgWebAppDefaultColors:Ma(NB()),tgWebAppFullscreen:GM,tgWebAppPlatform:Ui(),tgWebAppShowSettings:GM,tgWebAppStartParam:Ma(Ui()),tgWebAppThemeParams:NB(),tgWebAppVersion:Ui()}),m$=d$(Cxe),Mxe=yxe(m$()),Oxe=by({eventType:Ui(),eventData:Ma(c$())});function Pxe(e){try{return mxe(m$(),e)}catch{return!1}}function Ixe(e){return{all:e=e||new Map,on:function(t,a){var o=e.get(t);o?o.push(a):e.set(t,[a])},off:function(t,a){var o=e.get(t);o&&(a?o.splice(o.indexOf(a)>>>0,1):e.set(t,[]))},emit:function(t,a){var o=e.get(t);o&&o.slice().map(function(h){h(a)}),(o=e.get("*"))&&o.slice().map(function(h){h(t,a)})}}}function Rxe(e,t){const a=Ixe(),o=new Map,h=(y,b,i)=>{i||(i=!1);const C=o.get(y)||new Map;o.set(y,C);const I=C.get(b)||[];C.set(b,I);const j=I.findIndex(F=>F[1]===i);j>=0&&(a.off(y,I[j][0]),I.splice(j,1),!I.length&&C.delete(b),C.size||(o.delete(y),!o.size&&t()))};return[function(y,b,i){!o.size&&e();function C(){h(y,b,i)}function I(...G){i&&C(),y==="*"?b(G):b(...G)}a.on(y,I);const j=o.get(y)||new Map;o.set(y,j);const F=j.get(b)||[];return j.set(b,F),F.push([I,i||!1]),C},h,a.emit,function(){const y=a.all.size;a.all.clear(),o.clear(),y&&t()}]}function FB(e,t){window.dispatchEvent(new MessageEvent("message",{data:JSON.stringify({eventType:e,eventData:t}),source:window.parent}))}let Dxe=!1;const[Lxe,kxe]=uxe("Bridge",{bgColor:"#9147ff",textColor:"white",shouldLog(){return Dxe}}),zxe={clipboard_text_received:ih({req_id:B0(),data:c1(B0())}),custom_method_invoked:ih({req_id:B0(),result:k4(XV()),error:k4(B0())}),popup_closed:c1(ih({button_id:c1(B0(),()=>{})}),{}),viewport_changed:ih({height:L4(),width:c1(L4(),()=>window.innerWidth),is_state_stable:D4(),is_expanded:D4()}),theme_changed:ih({theme_params:p$()})};function jB(e){if(e.source!==window.parent)return;let t;try{t=RB(Q2e(B0(),f$(),Oxe),e.data)}catch{return}const{eventType:a,eventData:o}=t,h=zxe[a];try{const y=h?RB(h,o):o;Bxe(a,y)}catch(y){kxe(!0,[`An error occurred processing the "${a}" event from the Telegram application.`,"Please, file an issue here:","https://github.com/Telegram-Mini-Apps/telegram-apps/issues/new/choose"].join(`
`),t,y)}}const[Ps,P2,Bxe,_3e]=Rxe(()=>{const e=window,t={receiveEvent:FB};e.TelegramGameProxy_receiveEvent=FB,e.TelegramGameProxy=t,e.Telegram={WebView:t},window.addEventListener("message",jB)},()=>{["TelegramGameProxy_receiveEvent","TelegramGameProxy","Telegram"].forEach(e=>{delete window[e]}),window.removeEventListener("message",jB)});function Nxe(e){return t=>t instanceof e}function wy(e,t){t||(t=[]);class a extends Error{constructor(...h){const y=typeof t=="function"?t(...h):typeof t=="string"?[t]:t||[];super(...y),this.name=e}}return Object.defineProperty(a,"name",{value:e}),[a,Nxe(a)]}const[Fxe,g3e]=wy("MethodUnsupportedError",(e,t)=>[`Method "${e}" is unsupported in Mini Apps version ${t}`]),[jxe,y3e]=wy("MethodParameterUnsupportedError",(e,t,a)=>[`Parameter "${t}" of "${e}" method is unsupported in Mini Apps version ${a}`]),Uxe=["Unable to retrieve launch parameters from any known source. Perhaps, you have opened your app outside Telegram?"," Refer to docs for more information:","https://docs.telegram-mini-apps.com/packages/telegram-apps-bridge/environment"].join(`
`),[Vxe,v3e]=wy("LaunchParamsRetrieveError",Uxe);wy("InvalidLaunchParamsError",e=>[`Invalid value for launch params: ${e}`]);const[$xe,x3e]=wy("UnknownEnvError"),[qxe,b3e]=wy("InvokeCustomMethodError",e=>[`Server returned error: ${e}`]);function Gxe(e,t){t()}function Hxe(e,t){t||(t={});const a=t.equals||Object.is;let o=[],h=e;const y=I=>{if(!a(h,I)){const j=h;h=I,Gxe(C,()=>{[...o].forEach(([F,G])=>{F(I,j),G&&i(F,!0)})})}};function b(I){const j=typeof I!="object"?{once:I}:I;return{once:j.once||!1,signal:j.signal||!1}}const i=(I,j)=>{const F=b(j),G=o.findIndex(([X,Y])=>X===I&&Y.once===F.once&&Y.signal===F.signal);G>=0&&o.splice(G,1)},C=Object.assign(function(){return Zxe(C),h},{destroy(){o=[]},set:y,reset(){y(e)},sub(I,j){return o.push([I,b(j)]),()=>i(I,j)},unsub:i,unsubAll(){o=o.filter(I=>I[1].signal)}});return C}const HM=[];function Zxe(e){HM.length&&HM[HM.length-1].add(e)}const Wxe=Hxe("https://web.telegram.org");function kP(e,t){Lxe(!1,"Posting event:",t?{eventType:e,eventData:t}:{eventType:e});const a=window,o=JSON.stringify({eventType:e,eventData:t});if(exe())return a.parent.postMessage(o,Wxe());if(YV(a)){a.TelegramWebviewProxy.postEvent(e,JSON.stringify(t));return}if(OP(ih({external:ih({notify:PP()})}),a)){a.external.notify(o);return}throw new $xe}function zP(e,t,a){a||(a={});const{capture:o}=a,[h,y]=cxe();return new QV(b=>{(Array.isArray(t)?t:[t]).forEach(i=>{h(Ps(i,C=>{(!o||(Array.isArray(t)?o({event:i,payload:C}):o(C)))&&b(C)}))}),(a.postEvent||kP)(e,a.params)},a).finally(y)}const UB="launchParams";function VB(e){return e.replace(/^[^?#]*[?#]/,"").replace(/[?#]/g,"&")}function Xxe(){for(const e of[()=>VB(window.location.href),()=>{const t=performance.getEntriesByType("navigation")[0];return t&&VB(t.name)},()=>lxe(UB)]){const t=e();if(t&&Pxe(t))return sxe(UB,t),t}throw new Vxe}function _$(e){return Mxe(Xxe())}function $B(e,t){try{return _$(),!0}catch{return!1}return QV.fn(async a=>{if(YV(window))return!0;try{return await zP("web_app_request_theme","theme_changed",a),!0}catch{return!1}},{timeout:100})}function Yxe(e){return({req_id:t})=>t===e}function qB(e){return e.split(".").map(Number)}function Kxe(e,t){const a=qB(e),o=qB(t),h=Math.max(a.length,o.length);for(let y=0;y<h;y+=1){const b=a[y]||0,i=o[y]||0;if(b!==i)return b>i?1:-1}return 0}function Cs(e,t){return Kxe(e,t)<=0}function Z0(e,t,a){if(typeof a=="string"){if(e==="web_app_open_link"){if(t==="try_instant_view")return Cs("6.4",a);if(t==="try_browser")return Cs("7.6",a)}if(e==="web_app_set_header_color"&&t==="color")return Cs("6.9",a);if(e==="web_app_close"&&t==="return_back")return Cs("7.6",a);if(e==="web_app_setup_main_button"&&t==="has_shine_effect")return Cs("7.10",a)}switch(e){case"web_app_open_tg_link":case"web_app_open_invoice":case"web_app_setup_back_button":case"web_app_set_background_color":case"web_app_set_header_color":case"web_app_trigger_haptic_feedback":return Cs("6.1",t);case"web_app_open_popup":return Cs("6.2",t);case"web_app_close_scan_qr_popup":case"web_app_open_scan_qr_popup":case"web_app_read_text_from_clipboard":return Cs("6.4",t);case"web_app_switch_inline_query":return Cs("6.7",t);case"web_app_invoke_custom_method":case"web_app_request_write_access":case"web_app_request_phone":return Cs("6.9",t);case"web_app_setup_settings_button":return Cs("6.10",t);case"web_app_biometry_get_info":case"web_app_biometry_open_settings":case"web_app_biometry_request_access":case"web_app_biometry_request_auth":case"web_app_biometry_update_token":return Cs("7.2",t);case"web_app_setup_swipe_behavior":return Cs("7.7",t);case"web_app_share_to_story":return Cs("7.8",t);case"web_app_setup_secondary_button":case"web_app_set_bottom_bar_color":return Cs("7.10",t);case"web_app_request_safe_area":case"web_app_request_content_safe_area":case"web_app_request_fullscreen":case"web_app_exit_fullscreen":case"web_app_set_emoji_status":case"web_app_add_to_home_screen":case"web_app_check_home_screen":case"web_app_request_emoji_status_access":case"web_app_check_location":case"web_app_open_location_settings":case"web_app_request_file_download":case"web_app_request_location":case"web_app_send_prepared_message":case"web_app_start_accelerometer":case"web_app_start_device_orientation":case"web_app_start_gyroscope":case"web_app_stop_accelerometer":case"web_app_stop_device_orientation":case"web_app_stop_gyroscope":case"web_app_toggle_orientation_lock":return Cs("8.0",t);default:return["iframe_ready","iframe_will_reload","web_app_close","web_app_data_send","web_app_expand","web_app_open_link","web_app_ready","web_app_request_theme","web_app_request_viewport","web_app_setup_main_button","web_app_setup_closing_behavior"].includes(e)}}function Jxe(e,t){t||(t="strict");const a=typeof t=="function"?t:o=>{const{method:h,version:y}=o,b="param"in o?new jxe(h,o.param,y):new Fxe(h,y);if(t==="strict")throw b;return console.warn(b.message)};return(o,h)=>Z0(o,e)?o==="web_app_set_header_color"&&OP(ih({color:WV()}),h)&&!Z0(o,"color",e)?a({version:e,method:o,param:"color"}):kP(o,h):a({version:e,method:o})}function Qxe(e,t,a,o){return zP("web_app_invoke_custom_method","custom_method_invoked",{...o||{},params:{method:e,params:t,req_id:a},capture:Yxe(a)}).then(({result:h,error:y})=>{if(y)throw new qxe(y);return h})}function g$(e){return e.replace(/[A-Z]/g,t=>`-${t.toLowerCase()}`)}function ebe(e){return e.replace(/_([a-z])/g,(t,a)=>`-${a.toLowerCase()}`)}function y$(e){return`tapps/${e}`}function sh(e,t){sessionStorage.setItem(y$(e),JSON.stringify(t))}function lh(e){const t=sessionStorage.getItem(y$(e));try{return t?JSON.parse(t):void 0}catch{}}function BP(...e){const t=e.flat(1);return[t.push.bind(t),()=>{t.forEach(a=>{a()})}]}function tbe(e,t){t||(t={});const{textColor:a,bgColor:o,shouldLog:h}=t,y=h===void 0?!0:h,b=typeof y=="boolean"?()=>y:y;function i(C,I,...j){if(I||b()){const F="font-weight:bold;padding:0 5px;border-radius:5px";console[C](`%c${Intl.DateTimeFormat("en-GB",{hour:"2-digit",minute:"2-digit",second:"2-digit",fractionalSecondDigits:3,timeZone:"UTC"}).format(new Date)}%c / %c${e}`,`${F};background-color: lightblue;color:black`,"",`${F};${a?`color:${a};`:""}${o?`background-color:${o}`:""}`,...j)}}return[i.bind(void 0,"log"),i.bind(void 0,"error")]}function nbe(){return performance.getEntriesByType("navigation")[0]}function ch(){const e=nbe();return!!e&&e.type==="reload"}let Og;function rbe(e,t){Og&&Og.set(e,t)||t()}function N4(e){if(Og)return e();Og=new Map;try{e()}finally{Og.forEach(t=>t()),Og=void 0}}function v$(e,t){t||(t={});const a=t.equals||Object.is;let o=[],h=e;const y=I=>{if(!a(h,I)){const j=h;h=I,rbe(C,()=>{[...o].forEach(([F,G])=>{F(I,j),G&&i(F,!0)})})}};function b(I){const j=typeof I!="object"?{once:I}:I;return{once:j.once||!1,signal:j.signal||!1}}const i=(I,j)=>{const F=b(j),G=o.findIndex(([X,Y])=>X===I&&Y.once===F.once&&Y.signal===F.signal);G>=0&&o.splice(G,1)},C=Object.assign(function(){return ibe(C),h},{destroy(){o=[]},set:y,reset(){y(e)},sub(I,j){return o.push([I,b(j)]),()=>i(I,j)},unsub:i,unsubAll(){o=o.filter(I=>I[1].signal)}});return C}const y1=[];function ibe(e){y1.length&&y1[y1.length-1].add(e)}function abe(e,t){let a=new Set,o;function h(){return o||(o=v$(b(),t))}function y(){h().set(b())}function b(){a.forEach(I=>{I.unsub(y,{signal:!0})});const i=new Set;let C;y1.push(i);try{C=e()}finally{y1.pop()}return i.forEach(I=>{I.sub(y,{signal:!0})}),a=i,C}return Object.assign(function(){return h()()},{destroy(){h().destroy()},sub(...i){return h().sub(...i)},unsub(...i){h().unsub(...i)},unsubAll(...i){h().unsubAll(...i)}})}function Sy(e,t){return v$(e,t)}function Ha(e,t){return abe(e,t)}function Yi(e,t){const a=Sy(e,t);return[a,Ha(a)]}let obe=!1;const[F4,w3e]=tbe("SDK",{bgColor:"forestgreen",textColor:"white",shouldLog(){return obe}}),ZM=Sy(0),x$=Sy(kP),[GB,b$]=Yi({tgWebAppPlatform:"unknown",tgWebAppVersion:"0.0"}),um=Ha(()=>b$().tgWebAppVersion);function sbe(e){e||(e={});const{postEvent:t}=e,a=e.launchParams||_$();GB.set(a),x$.set(typeof t=="function"?t:Jxe(a.tgWebAppVersion)),F4(!1,"The package was configured. Launch params:",GB())}function lbe(){return ZM.set(ZM()+1),ZM().toString()}function I2(e,t,a){return Qxe(e,t,lbe(),{...a||{},postEvent:Ki})}const Fo=(e,t,a)=>(a||(a={}),a.postEvent||(a.postEvent=Ki),zP(e,t,a)),Ki=(e,t)=>x$()(e,t);function cbe(e){return Ha(()=>Z0(e,um()))}function ube(e){return t=>t instanceof e}function Cf(e,t){t||(t=[]);class a extends Error{constructor(...h){const y=typeof t=="function"?t(...h):typeof t=="string"?[t]:t||[];super(...y),this.name=e}}return Object.defineProperty(a,"name",{value:e}),[a,ube(a)]}function t_(e){return[e]}const[NP,S3e]=Cf("CSSVarsBoundError","CSS variables are already bound"),[w$,T3e]=Cf("NotAvailableError",t_);Cf("InvalidEnvError",t_);const[n1,E3e]=Cf("FunctionNotAvailableError",t_),[Nd,A3e]=Cf("InvalidArgumentsError",(e,t)=>[e,{cause:t}]),[hbe,C3e]=Cf("ConcurrentCallError",t_),[fbe,M3e]=Cf("SetEmojiStatusError",e=>[`Failed to set emoji status: ${e}`]),[dbe,O3e]=Cf("AccessDeniedError",t_),[pbe,P3e]=Cf("FullscreenFailedError",t_);Cf("ShareMessageError",t_);function HB(){return typeof window>"u"}function FP(e,t,a){a||(a={});const{isSupported:o,isMounted:h,isMounting:y,component:b,supports:i}=a||{},C=`${b?`${b}.`:""}${e}()`,I=o?Array.isArray(o)||typeof o=="object"&&"any"in o?o:[o]:void 0;function j(ge){if(i){const fe=i[ge];return Z0(fe[0],fe[1],um())}return!0}function F(){if(!I)return;function ge(ae){return typeof ae=="function"?ae():Z0(ae,um())?void 0:`it is unsupported in Mini Apps version ${um()}`}const fe=Array.isArray(I)?I:I.any,xe=fe.map(ge).filter(Boolean);return Array.isArray(I)?xe[0]:xe.length===fe.length?xe[xe.length-1]:void 0}function G(...ge){for(const fe in i)if(i[fe][2](...ge)&&!j(fe))return`option ${fe} is not supported in Mini Apps version ${um()}`}let X;if(i){X={};for(const ge in i)X[ge]=Ha(()=>j(ge))}const Y=Ha(()=>!F()),J=Ha(()=>um()!=="0.0"),ee=Ha(()=>!h||h()),oe=Ha(()=>$B()&&!HB()&&J()&&Y()&&ee());return Object.assign((...ge)=>{const fe=`Unable to call the ${C} ${b?"method":"function"}:`;if(HB()||!$B())throw new n1(`${fe} it can't be called outside Mini Apps`);if(!J())throw new n1(`${fe} the SDK was not initialized. Use the SDK init() function`);const xe=F();if(xe)throw new n1(`${fe} ${xe}`);const ae=G(...ge);if(ae)throw new n1(`${fe} ${ae}`);if(!ee()){const me=y&&y()?"mounting. Wait for the mount completion":`unmounted. Use the ${b}.mount() method`;throw new n1(`${fe} the component is ${me}`)}return t(...ge)},t,{isAvailable:oe,ifAvailable(...ge){return oe()?[!0,t(...ge)]:[!1]}},I?{isSupported:Y}:{},X?{supports:X}:{})}function NS(e,t){return t||(t={}),(a,o,h,y)=>FP(a,o,{...t,isSupported:h||t.isSupported,supports:y,component:e})}function bm(e,t,a){return NS(e,{isSupported:a,isMounted:t})}function uc(e,t){return NS(e,{isSupported:t})}const FS="web_app_setup_back_button",S$="back_button_pressed",jS="backButton",[ZB,mbe]=Yi(!1),[Mw,_be]=Yi(!1),gbe=cbe(FS),T$=bm(jS,Mw,FS),jP=uc(jS,FS),ybe=T$("hide",()=>{UP(!1)}),vbe=jP("mount",()=>{Mw()||(UP(ch()&&lh(jS)||!1),Mw.set(!0))});function UP(e){e!==ZB()&&(Ki(FS,{is_visible:e}),sh(jS,e),ZB.set(e))}const xbe=jP("onClick",e=>Ps(S$,e)),bbe=jP("offClick",e=>{P2(S$,e)}),wbe=T$("show",()=>{UP(!0)});function Sbe(){Mw.set(!1)}const hf=Object.freeze(Object.defineProperty({__proto__:null,hide:ybe,isMounted:_be,isSupported:gbe,isVisible:mbe,mount:vbe,offClick:bbe,onClick:xbe,show:wbe,unmount:Sbe},Symbol.toStringTag,{value:"Module"}));var Tbe=Object.defineProperty,Ebe=(e,t,a)=>t in e?Tbe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,j4=(e,t,a)=>Ebe(e,typeof t!="symbol"?t+"":t,a);function Abe(e){return t=>t instanceof e}function E$(e,t){t||(t=[]);class a extends Error{constructor(...h){const y=typeof t=="function"?t(...h):typeof t=="string"?[t]:t||[];super(...y),this.name=e}}return Object.defineProperty(a,"name",{value:e}),[a,Abe(a)]}const[Cbe,Mbe]=E$("CancelledError","Promise was canceled"),[Obe,I3e]=E$("TimeoutError",(e,t)=>[`Timeout reached: ${e}ms`,{cause:t}]),A$=Symbol("Resolved");function WB(e){return Array.isArray(e)&&e[0]===A$}function Pbe(e){return[A$,e]}function XB(e,t){return e.reject=t.reject,e.abort=t.abort,e}let Is=class U4 extends Promise{constructor(t,a){let o,h;super((y,b)=>{let i,C;typeof t=="function"?(i=t,C=a):C=t;const I=[],j=me=>(...we)=>{const Ge=me(...we);return I.forEach(He=>He()),Ge},F=new AbortController,{signal:G}=F;h=me=>{!G.aborted&&F.abort(me)};const X=()=>G.reason,Y=me=>{const we=()=>{me(X())};G.addEventListener("abort",we,!0);const Ge=()=>{G.removeEventListener("abort",we,!0)};return I.push(Ge),Ge},J=j(me=>{y(me),h(Pbe(me))});o=j(me=>{b(me),h(me)}),C||(C={});const{abortSignal:ee,rejectOnAbort:oe=!0}=C;if(ee)if(ee.aborted){const{reason:me}=ee;if(oe)return o(me);h(me)}else{const me=()=>{h(ee.reason)};ee.addEventListener("abort",me),I.push(()=>{ee.removeEventListener("abort",me)})}oe&&Y(b);const{timeout:ge}=C;if(ge){const me=setTimeout(()=>{h(new Obe(ge))},ge);I.push(()=>{clearTimeout(me)})}const fe=()=>G.aborted,xe=()=>WB(X()),ae=()=>{const me=X();return WB(me)?me[1]:void 0};try{const me=i&&i(J,o,{abortReason:X,abortSignal:G,isAborted:fe,isResolved:xe,onAborted:Y,onResolved:we=>Y(()=>{xe()&&we(ae())}),resolved:ae,throwIfAborted(){if(fe())throw X()}});me instanceof Promise&&me.catch(o)}catch(me){o(me)}}),j4(this,"abort"),j4(this,"reject"),this.abort=h,this.reject=o}static fn(t,a){return new U4(async(o,h,y)=>{try{o(await t(y))}catch(b){h(b)}},a)}static resolve(t){return this.fn(()=>t)}static reject(t){return new U4((a,o)=>{o(t)})}cancel(){this.abort(new Cbe)}catch(t){return this.then(void 0,t)}finally(t){return XB(super.finally(t),this)}then(t,a){return XB(super.then(t,a),this)}};function YB(e,t){return e.resolve=t.resolve,e}let Ibe=class V4 extends Is{constructor(t,a){let o,h;typeof t=="function"?(o=t,h=a):h=t;let y;super((b,i,C)=>{y=b,o&&o(b,i,C)},h),j4(this,"resolve"),this.resolve=y}static fn(t,a){return new V4((o,h,y)=>{try{Promise.resolve(t(y)).then(o,h)}catch(b){h(b)}},a)}static resolve(t){return this.fn(()=>t)}static reject(t){return new V4((a,o)=>{o(t)})}catch(t){return this.then(void 0,t)}finally(t){return YB(super.finally(t),this)}then(t,a){return YB(super.then(t,a),this)}};function Sl(e,t,a){a||(a={});const{promise:o,error:h}=a,[y,b]=o?[o,Ha(o)]:Yi(),[i,C]=h?[h,Ha(h)]:Yi();return[Object.assign((...I)=>{if(y()){const F=new hbe(t);return i.set(F),Is.reject(F)}N4(()=>{y.set(e(...I)),i.set(void 0)});let j;return y().catch(F=>{throw j=F,F}).finally(()=>{N4(()=>{y.set(void 0),i.set(j)})})},e),[y,b,Ha(()=>!!y())],[i,C]]}function R2(e,t,a){const[o,...h]=Sl(t,`The ${e} component is already mounting`),[y,b]=Yi(!1);return[(...i)=>y()?Is.resolve():o(...i).then(C=>{N4(()=>{y.set(!0),a(C)})}),...h,[y,b]]}const[C$,R3e]=Yi({available:!1,type:"",accessGranted:!1,accessRequested:!1,deviceId:"",tokenSaved:!1}),KB="web_app_biometry_get_info",Rbe=FP("requestBiometry",e=>Fo(KB,"biometry_info_received",e),{isSupported:KB});function M$(e){if(!Mbe(e))throw e}function O$(e){const t=e();t&&t.catch(M$).cancel()}const u2="biometry",VP="web_app_biometry_request_auth",P$="biometry_info_received",Dbe=e=>{US($P(e))};function I$(){throw new w$("Biometry is not available")}function $P(e){let t=!1,a=!1,o="",h=!1,y="",b=!1;return e.available&&(t=!0,a=e.token_saved,o=e.device_id,h=e.access_requested,y=e.type,b=e.access_granted),{available:t,tokenSaved:a,deviceId:o,type:y,accessGranted:b,accessRequested:h}}const[Lbe,kbe,zbe,R$]=R2(u2,e=>{const t=ch()&&lh(u2);return t?Is.resolve(t):Rbe({abortSignal:e}).then($P)},e=>{Ps(P$,Dbe),US(e)}),D$=uc(u2,VP),qP=bm(u2,R$[0],VP);D$("mount",Lbe);const[,D3e,L3e]=kbe,[,k3e]=zbe,[z3e,B3e]=R$,[Bbe,Nbe,Fbe]=Sl(e=>Is.fn(async t=>{const a=C$();a.available||I$();const o=await Fo(VP,"biometry_auth_requested",{...e,...t,params:{reason:((e||{}).reason||"").trim()}}),{token:h}=o;return typeof h=="string"&&US({...a,token:h}),o},e),"Biometry authentication is already in progress");qP("authenticate",Bbe);const[,N3e,F3e]=Nbe,[,j3e]=Fbe;D$("openSettings",()=>{Ki("web_app_biometry_open_settings")});const[jbe,Ube,Vbe]=Sl(e=>Is.fn(async t=>{const a=await Fo("web_app_biometry_request_access",P$,{...e,...t,params:{reason:(e||{}).reason||""}}).then($P);return a.available||I$(),US(a),a.accessGranted},e),"Biometry access request is already in progress");qP("requestAccess",jbe);const[,U3e,V3e]=Ube,[,$3e]=Vbe;function US(e){C$.set(e),sh(u2,e)}qP("updateToken",e=>(e||(e={}),Fo("web_app_biometry_update_token","biometry_token_updated",{...e,params:{token:e.token||"",reason:e.reason}}).then(t=>t.status)));function VS(e,t){return NS(e,{isMounted:t})}const wm=NS,$S="closingBehavior",[JB,q3e]=Yi(!1),[QB,$be]=Yi(!1),L$=VS($S,$be),qbe=wm($S);L$("disableConfirmation",()=>{GP(!1)});L$("enableConfirmation",()=>{GP(!0)});qbe("mount",()=>{QB()||(GP(ch()&&lh($S)||!1),QB.set(!0))});function GP(e){e!==JB()&&(Ki("web_app_setup_closing_behavior",{need_confirmation:e}),sh($S,e),JB.set(e))}function k$(e){return{lang:(e==null?void 0:e.lang)??void 0,message:e==null?void 0:e.message,abortEarly:(e==null?void 0:e.abortEarly)??void 0,abortPipeEarly:(e==null?void 0:e.abortPipeEarly)??void 0}}function Gbe(e,t){var a;return(a=void 0)==null?void 0:a.get(t)}function Hbe(e){var t,a;const o=typeof e;return o==="string"?`"${e}"`:o==="number"||o==="bigint"||o==="boolean"?`${e}`:o==="object"||o==="function"?(e&&((a=(t=Object.getPrototypeOf(e))==null?void 0:t.constructor)==null?void 0:a.name))??"null":o}function fu(e,t,a,o,h){const y=h&&"input"in h?h.input:a.value,b=(h==null?void 0:h.expected)??e.expects??null,i=(h==null?void 0:h.received)??Hbe(y),C={kind:e.kind,type:e.type,input:y,expected:b,received:i,message:`Invalid ${t}: ${b?`Expected ${b} but r`:"R"}eceived ${i}`,requirement:e.requirement,path:h==null?void 0:h.path,issues:h==null?void 0:h.issues,lang:o.lang,abortEarly:o.abortEarly,abortPipeEarly:o.abortPipeEarly},I=e.kind==="schema",j=(h==null?void 0:h.message)??e.message??Gbe(e.reference,C.lang)??(I?(C.lang,void 0):null)??o.message??(C.lang,void 0);j&&(C.message=typeof j=="function"?j(C):j),I&&(a.typed=!1),a.issues?a.issues.push(C):a.issues=[C]}function Mf(e){return{version:1,vendor:"valibot",validate(t){return e["~run"]({value:t},k$())}}}function z$(e,t){return Object.hasOwn(e,t)&&t!=="__proto__"&&t!=="prototype"&&t!=="constructor"}function Zbe(e,t){const a=[...new Set(e)];return a.length>1?`(${a.join(` ${t} `)})`:a[0]??"never"}var $4=class extends Error{constructor(e){super(e[0].message),this.name="ValiError",this.issues=e}};function B$(e,t){return{kind:"validation",type:"check",reference:B$,async:!1,expects:null,requirement:e,message:t,"~run"(a,o){return a.typed&&!this.requirement(a.value)&&fu(this,"input",a,o),a}}}function N$(e){return{kind:"transformation",type:"transform",reference:N$,async:!1,operation:e,"~run"(t){return t.value=this.operation(t.value),t}}}function F$(e,t,a){return typeof e.default=="function"?e.default(t,a):e.default}function j$(e,t){return{kind:"schema",type:"array",reference:j$,expects:"Array",async:!1,item:e,message:t,get"~standard"(){return Mf(this)},"~run"(a,o){var h;const y=a.value;if(Array.isArray(y)){a.typed=!0,a.value=[];for(let b=0;b<y.length;b++){const i=y[b],C=this.item["~run"]({value:i},o);if(C.issues){const I={type:"array",origin:"value",input:y,key:b,value:i};for(const j of C.issues)j.path?j.path.unshift(I):j.path=[I],(h=a.issues)==null||h.push(j);if(a.issues||(a.issues=C.issues),o.abortEarly){a.typed=!1;break}}C.typed||(a.typed=!1),a.value.push(C.value)}}else fu(this,"type",a,o);return a}}}function U$(e){return{kind:"schema",type:"date",reference:U$,expects:"Date",async:!1,message:e,get"~standard"(){return Mf(this)},"~run"(t,a){return t.value instanceof Date?isNaN(t.value)?fu(this,"type",t,a,{received:'"Invalid Date"'}):t.typed=!0:fu(this,"type",t,a),t}}}function V$(e,t){return{kind:"schema",type:"instance",reference:V$,expects:e.name,async:!1,class:e,message:t,get"~standard"(){return Mf(this)},"~run"(a,o){return a.value instanceof this.class?a.typed=!0:fu(this,"type",a,o),a}}}function q4(e,t){return{kind:"schema",type:"loose_object",reference:q4,expects:"Object",async:!1,entries:e,message:t,get"~standard"(){return Mf(this)},"~run"(a,o){var h;const y=a.value;if(y&&typeof y=="object"){a.typed=!0,a.value={};for(const b in this.entries){const i=this.entries[b];if(b in y||(i.type==="exact_optional"||i.type==="optional"||i.type==="nullish")&&i.default!==void 0){const C=b in y?y[b]:F$(i),I=i["~run"]({value:C},o);if(I.issues){const j={type:"object",origin:"value",input:y,key:b,value:C};for(const F of I.issues)F.path?F.path.unshift(j):F.path=[j],(h=a.issues)==null||h.push(F);if(a.issues||(a.issues=I.issues),o.abortEarly){a.typed=!1;break}}I.typed||(a.typed=!1),a.value[b]=I.value}else if(i.type!=="exact_optional"&&i.type!=="optional"&&i.type!=="nullish"&&(fu(this,"key",a,o,{input:void 0,expected:`"${b}"`,path:[{type:"object",origin:"key",input:y,key:b,value:y[b]}]}),o.abortEarly))break}if(!a.issues||!o.abortEarly)for(const b in y)z$(y,b)&&!(b in this.entries)&&(a.value[b]=y[b])}else fu(this,"type",a,o);return a}}}function $$(e){return{kind:"schema",type:"number",reference:$$,expects:"number",async:!1,message:e,get"~standard"(){return Mf(this)},"~run"(t,a){return typeof t.value=="number"&&!isNaN(t.value)?t.typed=!0:fu(this,"type",t,a),t}}}function q$(e,t){return{kind:"schema",type:"optional",reference:q$,expects:`(${e.expects} | undefined)`,async:!1,wrapped:e,default:t,get"~standard"(){return Mf(this)},"~run"(a,o){return a.value===void 0&&(this.default!==void 0&&(a.value=F$(this,a,o)),a.value===void 0)?(a.typed=!0,a):this.wrapped["~run"](a,o)}}}function G$(e,t,a){return{kind:"schema",type:"record",reference:G$,expects:"Object",async:!1,key:e,value:t,message:a,get"~standard"(){return Mf(this)},"~run"(o,h){var y,b;const i=o.value;if(i&&typeof i=="object"){o.typed=!0,o.value={};for(const C in i)if(z$(i,C)){const I=i[C],j=this.key["~run"]({value:C},h);if(j.issues){const G={type:"object",origin:"key",input:i,key:C,value:I};for(const X of j.issues)X.path=[G],(y=o.issues)==null||y.push(X);if(o.issues||(o.issues=j.issues),h.abortEarly){o.typed=!1;break}}const F=this.value["~run"]({value:I},h);if(F.issues){const G={type:"object",origin:"value",input:i,key:C,value:I};for(const X of F.issues)X.path?X.path.unshift(G):X.path=[G],(b=o.issues)==null||b.push(X);if(o.issues||(o.issues=F.issues),h.abortEarly){o.typed=!1;break}}(!j.typed||!F.typed)&&(o.typed=!1),j.typed&&(o.value[j.value]=F.value)}}else fu(this,"type",o,h);return o}}}function nh(e){return{kind:"schema",type:"string",reference:nh,expects:"string",async:!1,message:e,get"~standard"(){return Mf(this)},"~run"(t,a){return typeof t.value=="string"?t.typed=!0:fu(this,"type",t,a),t}}}function eN(e){let t;if(e)for(const a of e)t?t.push(...a.issues):t=a.issues;return t}function H$(e,t){return{kind:"schema",type:"union",reference:H$,expects:Zbe(e.map(a=>a.expects),"|"),async:!1,options:e,message:t,get"~standard"(){return Mf(this)},"~run"(a,o){let h,y,b;for(const i of this.options){const C=i["~run"]({value:a.value},o);if(C.typed)if(C.issues)y?y.push(C):y=[C];else{h=C;break}else b?b.push(C):b=[C]}if(h)return h;if(y){if(y.length===1)return y[0];fu(this,"type",a,o,{issues:eN(y)}),a.typed=!0}else{if((b==null?void 0:b.length)===1)return b[0];fu(this,"type",a,o,{issues:eN(b)})}return a}}}function HP(e,t,a){const o=e["~run"]({value:t},k$(a));if(o.issues)throw new $4(o.issues);return o.value}function Ob(...e){return{...e[0],pipe:e,get"~standard"(){return Mf(this)},"~run"(t,a){for(const o of e)if(o.kind!=="metadata"){if(t.issues&&(o.kind==="schema"||o.kind==="transformation")){t.typed=!1;break}(!t.issues||!a.abortEarly&&!a.abortPipeEarly)&&(t=o["~run"](t,a))}return t}}}const Wbe="web_app_invoke_custom_method",D2=uc("cloudStorage",Wbe),Xbe=D2("deleteItem",(e,t)=>{const a=Array.isArray(e)?e:[e];return a.length?I2("deleteStorageValues",{keys:a},t).then():Is.resolve()});function Ybe(e,t){const a=Array.isArray(e)?e:[e];return a.length?I2("getStorageValues",{keys:a},t).then(o=>HP(G$(Ob(nh(),B$(h=>a.includes(h))),nh()),o)):Is.resolve(typeof e=="string"?"":{})}D2("getItem",Ybe);const Kbe=D2("getKeys",e=>I2("getStorageKeys",{},e).then(t=>HP(j$(nh()),t)));D2("setItem",(e,t,a)=>I2("saveStorageValue",{key:e,value:t},a).then());D2("clear",e=>Kbe(e).then(Xbe));const qS="web_app_trigger_haptic_feedback",ZP=uc("hapticFeedback",qS);ZP("impactOccurred",e=>{Ki(qS,{type:"impact",impact_style:e})});ZP("notificationOccurred",e=>{Ki(qS,{type:"notification",notification_type:e})});ZP("selectionChanged",()=>{Ki(qS,{type:"selection_change"})});const Z$="web_app_open_invoice",Jbe=uc("invoice",Z$);function Qbe(e,t,a){let o;if(t==="url"){const{hostname:h,pathname:y}=new URL(e,window.location.href);if(h!=="t.me")throw new Nd(`Link has unexpected hostname: ${h}`);const b=y.match(/^\/(\$|invoice\/)([A-Za-z0-9\-_=]+)$/);if(!b)throw new Nd('Expected to receive a link with a pathname in format "/invoice/{slug}" or "/${slug}"');[,,o]=b}else o=e,a=t;return Fo(Z$,"invoice_closed",{...a,params:{slug:o},capture:h=>o===h.slug}).then(h=>h.status)}const[ewe,twe,nwe]=Sl(Qbe,"Invoice is already opened");Jbe("open",ewe);const[,G3e,H3e]=twe,[,Z3e]=nwe,v1="locationManager",W$="web_app_check_location",tN="web_app_open_location_settings",G4=Sy({available:!1,accessGranted:!1,accessRequested:!1});function rwe(e){let t=!1,a,o;return e.available&&(t=!0,a=e.access_requested,o=e.access_granted),{available:t,accessGranted:o||!1,accessRequested:a||!1}}const[iwe,awe,owe,X$]=R2(v1,e=>{const t=ch()&&lh(v1);return t?Is.resolve(t):Fo("web_app_check_location","location_checked",e).then(rwe)},e=>{G4.set(e),sh(v1,e)}),Y$=uc(v1,W$),swe=bm(v1,X$[0],W$);Y$("mount",iwe);const[,W3e,X3e]=awe,[,Y3e]=owe,[K3e,J3e]=X$,[lwe,cwe,uwe]=Sl(e=>Fo("web_app_request_location","location_requested",e).then(t=>{if(!t.available)throw G4.set({...G4(),available:!1}),new w$("Location data tracking is not available");const{available:a,...o}=t;return o}),"Location request is currently in progress");swe("requestLocation",lwe);const[,Q3e,eTe]=cwe,[,tTe]=uwe;Y$("openSettings",()=>{Ki(tN)},tN);function WP(e){const t={};for(const a in e){const o=e[a];o!==void 0&&(t[a]=o)}return t}function hwe(e){return{lang:(e==null?void 0:e.lang)??void 0,message:e==null?void 0:e.message,abortEarly:(e==null?void 0:e.abortEarly)??void 0,abortPipeEarly:(e==null?void 0:e.abortPipeEarly)??void 0}}var fwe=class extends Error{constructor(e){super(e[0].message),this.name="ValiError",this.issues=e}};function XP(e){return{kind:"transformation",type:"transform",reference:XP,async:!1,operation:e,"~run"(t){return t.value=this.operation(t.value),t}}}function dwe(e,t,a){const o=e["~run"]({value:t},hwe(a));if(o.issues)throw new fwe(o.issues);return o.value}function pwe(){return XP(JSON.parse)}function mwe(e){return XP(t=>{const a={};return new URLSearchParams(t).forEach((o,h)=>{const y=a[h];Array.isArray(y)?y.push(o):y===void 0?a[h]=o:a[h]=[y,o]}),dwe(e,a)})}function h2(e){return/^#[\da-f]{6}$/i.test(e)}function _we(e){return/^#[\da-f]{3}$/i.test(e)}function gwe(e){const t=e.replace(/\s/g,"").toLowerCase();if(h2(t))return t;if(_we(t)){let o="#";for(let h=0;h<3;h+=1)o+=t[1+h].repeat(2);return o}const a=t.match(/^rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)$/)||t.match(/^rgba\((\d{1,3}),(\d{1,3}),(\d{1,3}),\d{1,3}\)$/);if(!a)throw new Error(`Value "${e}" does not satisfy any of known RGB formats.`);return a.slice(1).reduce((o,h)=>o+parseInt(h,10).toString(16).padStart(2,"0"),"#")}function ywe(e){const t=gwe(e);return Math.sqrt([.299,.587,.114].reduce((a,o,h)=>{const y=parseInt(t.slice(1+h*2,1+(h+1)*2),16);return a+y*y*o},0))<120}const[WM,nTe]=Yi(!1),[kg,rTe]=Yi({});function L2(e){return Ha(()=>kg()[e])}const K$=L2("bg_color"),J$=L2("button_color"),vwe=L2("button_text_color"),xwe=L2("bottom_bar_bg_color"),H4=L2("secondary_bg_color"),x1=Sy({hasShineEffect:!1,isEnabled:!0,isLoaderVisible:!1,isVisible:!1,text:"Continue"}),bwe=Ha(()=>{const e=x1();return{...e,backgroundColor:e.backgroundColor||J$()||"#2481cc",textColor:e.textColor||vwe()||"#ffffff"}}),[nN,wwe]=Yi(!1),Swe="web_app_setup_main_button",Q$="main_button_pressed",GS="mainButton",YP=wm(GS),Twe=VS(GS,wwe);YP("mount",()=>{if(!nN()){const e=ch()&&lh(GS);e&&x1.set(e),nN.set(!0)}});YP("onClick",e=>Ps(Q$,e));YP("offClick",e=>{P2(Q$,e)});Twe("setParams",e=>{x1.set({...x1(),...WP(e)}),sh(GS,x1());const t=bwe();t.text&&Ki(Swe,{color:t.backgroundColor,has_shine_effect:t.hasShineEffect,is_active:t.isEnabled,is_progress_visible:t.isLoaderVisible,is_visible:t.isVisible,text:t.text,text_color:t.textColor})});function KP(e,t){document.documentElement.style.setProperty(e,t)}function JP(e){document.documentElement.style.removeProperty(e)}const f2="themeParams",Ewe="theme_changed",Awe=wm(f2),Cwe=({theme_params:e})=>{kg.set(e),sh(f2,e)},[Mwe,Owe,Pwe,eq]=R2(f2,e=>{const t=ch()&&lh(f2);return t?Is.resolve(t):Fo("web_app_request_theme","theme_changed",e).then(a=>a.theme_params)},e=>{Ps(Ewe,Cwe),kg.set(e)}),Iwe=VS(f2,eq[0]);Iwe("bindCssVars",e=>{if(WM())throw new NP;e||(e=o=>`--tg-theme-${ebe(o)}`);function t(o){Object.entries(kg()).forEach(([h,y])=>{y&&o(h,y)})}function a(){t((o,h)=>{KP(e(o),h)})}return a(),kg.sub(a),WM.set(!0),()=>{t(JP),kg.unsub(a),WM.set(!1)}});const Rwe=Awe("mount",Mwe),[,iTe,aTe]=Owe,[,oTe]=Pwe,[sTe,lTe]=eq;function tq(e){return Ha(()=>{const t=e();return h2(t)?t:t==="bg_color"?K$():H4()})}const[Ow,Dwe]=Yi("bg_color"),QP=tq(Ow),[Pw,Lwe]=Yi("bottom_bar_bg_color"),eI=Ha(()=>{const e=Pw();return h2(e)?e:e==="bottom_bar_bg_color"?xwe()||H4():e==="secondary_bg_color"?H4():K$()}),[Iw,kwe]=Yi("bg_color"),nq=tq(Iw),[XM,zwe]=Yi(!1),Bwe=Ha(()=>{const e=QP();return e?ywe(e):!1}),[tI,Nwe]=Yi(!0),rq=Ha(()=>({backgroundColor:Ow(),bottomBarColor:Pw(),headerColor:Iw(),isActive:tI()})),Z4="web_app_set_background_color",W4="web_app_set_bottom_bar_color",Pb="web_app_set_header_color",iq="visibility_changed",hy="miniApp",nI={any:[Z4,W4,Pb]},Fwe=Ha(()=>nI.any.some(e=>Z0(e,um()))),aq=e=>{tI.set(e.is_visible),ZS()},[jwe,Uwe,Vwe,oq]=R2(hy,e=>Rwe(e).then(()=>ch()&&lh(hy)||void 0),e=>{cq.ifAvailable(e?e.backgroundColor:"bg_color"),uq.ifAvailable(e?e.bottomBarColor:"bottom_bar_bg_color"),hq.ifAvailable(e?e.headerColor:"bg_color"),tI.set(e?e.isActive:!0),Ps(iq,aq)}),sq=wm(hy),$we=uc(hy,nI),HS=bm(hy,oq[0],nI),qwe=HS("bindCssVars",e=>{if(XM())throw new NP;const[t,a]=BP();function o(h,y){function b(){KP(h,y()||null)}b(),t(y.sub(b),JP.bind(null,h))}return e||(e=h=>`--tg-${g$(h)}`),o(e("bgColor"),QP),o(e("bottomBarColor"),eI),o(e("headerColor"),nq),t(()=>{XM.set(!1)}),XM.set(!0),a}),Gwe=sq("close",e=>{Ki("web_app_close",{return_back:e})}),Hwe=$we("mount",jwe),[,lq,Zwe]=Uwe,[,Wwe]=Vwe,[Xwe,Ywe]=oq,Kwe=sq("ready",()=>{Ki("web_app_ready")});function ZS(){sh(hy,rq())}const cq=HS("setBackgroundColor",e=>{e!==Ow()&&(Ki(Z4,{color:e}),Ow.set(e),ZS())},Z4),uq=HS("setBottomBarColor",e=>{e!==Pw()&&(Ki(W4,{color:e}),Pw.set(e),ZS())},W4),hq=HS("setHeaderColor",e=>{e!==Iw()&&(Ki(Pb,h2(e)?{color:e}:{color_key:e}),Iw.set(e),ZS())},Pb,{rgb:[Pb,"color",h2]});function Jwe(){O$(lq),P2(iq,aq),Xwe.set(!1)}const YM=Object.freeze(Object.defineProperty({__proto__:null,backgroundColor:Dwe,backgroundColorRGB:QP,bindCssVars:qwe,bottomBarColor:Lwe,bottomBarColorRGB:eI,close:Gwe,headerColor:kwe,headerColorRGB:nq,isActive:Nwe,isCssVarsBound:zwe,isDark:Bwe,isMounted:Ywe,isMounting:Zwe,isSupported:Fwe,mount:Hwe,mountError:Wwe,mountPromise:lq,ready:Kwe,setBackgroundColor:cq,setBottomBarColor:uq,setHeaderColor:hq,state:rq,unmount:Jwe},Symbol.toStringTag,{value:"Module"}));function Qwe(e){const t=e.message.trim(),a=(e.title||"").trim(),o=e.buttons||[];if(a.length>64)throw new Nd(`Invalid title: ${a}`);if(!t||t.length>256)throw new Nd(`Invalid message: ${t}`);if(o.length>3)throw new Nd(`Invalid buttons count: ${o.length}`);return{title:a,message:t,buttons:o.length?o.map((h,y)=>{const b=h.id||"";if(b.length>64)throw new Nd(`Button with index ${y} has invalid id: ${b}`);if(!h.type||h.type==="default"||h.type==="destructive"){const i=h.text.trim();if(!i||i.length>64)throw new Nd(`Button with index ${y} has invalid text: ${i}`);return{type:h.type,text:i,id:b}}return{type:h.type,id:b}}):[{type:"close",id:""}]}}const fq="web_app_open_popup",eSe=uc("popup",fq),[tSe,nSe,rSe]=Sl(e=>Fo(fq,"popup_closed",{...e,params:Qwe(e)}).then(({button_id:t})=>t===void 0?null:t),"A popup is already opened");eSe("open",tSe);const[,cTe,uTe]=nSe,[,hTe]=rSe,dq="web_app_close_scan_qr_popup",pq="web_app_open_scan_qr_popup",iSe="scan_qr_popup_closed",aSe="qr_text_received",mq=uc("qrScanner",pq);mq("close",()=>{Ki(dq),O$(uSe)});function oSe(e){e||(e={});const{onCaptured:t,text:a,capture:o}=e,[,h]=BP(Ps(iSe,()=>{y.resolve()}),Ps(aSe,b=>{t?t(b.data):(!o||o(b.data))&&(y.resolve(b.data),Ki(dq))})),y=new Ibe(e);return(e.postEvent||Ki)(pq,{text:a}),Is.resolve(y).catch(M$).finally(h)}const[sSe,lSe,cSe]=Sl(oSe,"The QR Scanner is already opened");mq("open",sSe);const[,uSe,fTe]=lSe,[,dTe]=cSe,b1=Sy({hasShineEffect:!1,isEnabled:!0,isLoaderVisible:!1,isVisible:!1,position:"left",text:"Cancel"}),hSe=Ha(()=>{const e=b1();return{...e,backgroundColor:e.backgroundColor||eI()||"#000000",textColor:e.textColor||J$()||"#2481cc"}}),[rN,fSe]=Yi(!1),rI="web_app_setup_secondary_button",_q="secondary_button_pressed",WS="secondaryButton",iI=uc(WS,rI),dSe=bm(WS,fSe,rI);iI("mount",()=>{if(!rN()){const e=ch()&&lh(WS);e&&b1.set(e),rN.set(!0)}});iI("onClick",e=>Ps(_q,e));iI("offClick",e=>{P2(_q,e)});dSe("setParams",e=>{b1.set({...b1(),...WP(e)}),sh(WS,b1());const t=hSe();t.text&&Ki(rI,{color:t.backgroundColor,has_shine_effect:t.hasShineEffect,is_active:t.isEnabled,is_progress_visible:t.isLoaderVisible,is_visible:t.isVisible,position:t.position,text:t.text,text_color:t.textColor})});const aI="web_app_setup_settings_button",gq="settings_button_pressed",XS="settingsButton",[iN,pTe]=Yi(!1),[X4,mTe]=Yi(!1),oI=uc(XS,aI),yq=bm(XS,X4,aI);yq("hide",()=>{sI(!1)});oI("mount",()=>{X4()||(sI(ch()&&lh(XS)||!1),X4.set(!0))});function sI(e){e!==iN()&&(Ki(aI,{is_visible:e}),sh(XS,e),iN.set(e))}oI("onClick",e=>Ps(gq,e));oI("offClick",e=>{P2(gq,e)});yq("show",()=>{sI(!0)});const lI="web_app_setup_swipe_behavior",YS="swipeBehavior",[Y4,_Te]=Yi(!1),[aN,gTe]=Yi(!0),pSe=uc(YS,lI),vq=bm(YS,Y4,lI);vq("disableVertical",()=>{cI(!1)});vq("enableVertical",()=>{cI(!0)});pSe("mount",()=>{Y4()||(cI(ch()&&lh(YS)||!1,!0),Y4.set(!0))});function cI(e,t){(e!==aN()||t)&&(Ki(lI,{allow_vertical_swipe:e}),sh(YS,e),aN.set(e))}const n_="viewport",xq="fullscreen_changed",bq="safe_area_changed",wq="content_safe_area_changed",Sq="viewport_changed",Tq=wm(n_),oN={left:0,top:0,bottom:0,right:0};function KM(e){return Math.max(e,0)}const[JM,mSe]=Yi({contentSafeAreaInsets:oN,height:0,isExpanded:!1,isFullscreen:!1,safeAreaInsets:oN,stableHeight:0,width:0});function Ty(e){return Ha(()=>mSe()[e])}const _Se=Ty("height"),gSe=Ty("stableHeight"),ySe=Ty("width");function Ey(e){const{height:t,stableHeight:a,width:o}=e;JM.set({...JM(),...WP({...e,height:t?KM(t):void 0,width:o?KM(o):void 0,stableHeight:a?KM(a):void 0})}),sh(n_,JM())}function vSe(){return lh(n_)}function KS(e){return Ha(()=>Eq()[e])}const Eq=Ty("contentSafeAreaInsets"),xSe=KS("bottom"),bSe=KS("left"),wSe=KS("right"),SSe=KS("top");function JS(e){return Ha(()=>Aq()[e])}const Aq=Ty("safeAreaInsets"),TSe=JS("bottom"),ESe=JS("left"),ASe=JS("right"),CSe=JS("top"),Cq="web_app_request_safe_area",Mq=uc(n_,Cq),sN=Mq("requestContentSafeAreaInsets",e=>Fo("web_app_request_content_safe_area",wq,e));function MSe(e){return Fo("web_app_request_viewport",Sq,e)}const lN=Mq("requestSafeAreaInsets",e=>Fo(Cq,bq,e)),OSe=e=>{const{height:t}=e;Ey({isExpanded:e.is_expanded,height:t,width:e.width,stableHeight:e.is_state_stable?t:void 0})},PSe=e=>{Ey({isFullscreen:e.is_fullscreen})},ISe=e=>{Ey({safeAreaInsets:e})},RSe=e=>{Ey({contentSafeAreaInsets:e})},[DSe,LSe,kSe,zSe]=R2(n_,e=>{const t=ch()&&vSe();return t?Is.resolve(t):Is.fn(async a=>{const o=await Is.all([lN.isAvailable()?lN(a):Aq(),sN.isAvailable()?sN(a):Eq()]),h=b$(),y={contentSafeAreaInsets:o[1],isFullscreen:!!h.tgWebAppFullscreen,safeAreaInsets:o[0]};if(["macos","tdesktop","unigram","webk","weba","web"].includes(h.tgWebAppPlatform)){const b=window;return{...y,height:b.innerHeight,isExpanded:!0,stableHeight:b.innerHeight,width:b.innerWidth}}return MSe(a).then(b=>({...y,height:b.height,isExpanded:b.is_expanded,stableHeight:b.is_state_stable?b.height:0,width:b.width}))},e)},e=>{Ps(Sq,OSe),Ps(xq,PSe),Ps(bq,ISe),Ps(wq,RSe),Ey(e)});Tq("mount",DSe);const[,yTe,vTe]=LSe,[,xTe]=kSe,[Oq,bTe]=zSe,BSe=VS(n_,Oq),[QM,wTe]=Yi(!1);BSe("bindCssVars",e=>{if(QM())throw new NP;e||(e=a=>`--tg-viewport-${g$(a)}`);const t=[["height",_Se],["stableHeight",gSe],["width",ySe],["safeAreaInsetTop",CSe],["safeAreaInsetBottom",TSe],["safeAreaInsetLeft",ESe],["safeAreaInsetRight",ASe],["contentSafeAreaInsetTop",SSe],["contentSafeAreaInsetBottom",xSe],["contentSafeAreaInsetLeft",bSe],["contentSafeAreaInsetRight",wSe]].reduce((a,[o,h])=>{const y=e(o);if(y){const b=()=>{KP(y,`${h()}px`)};a.push([b,h.sub(b),y])}return a},[]);return t.forEach(a=>{a[0]()}),QM.set(!0),()=>{t.forEach(a=>{a[1](),JP(a[2])}),QM.set(!1)}});Tq("expand",()=>{Ki("web_app_expand")});const Pq="web_app_request_fullscreen",NSe=bm(n_,Oq,Pq),FSe=Ty("isFullscreen"),[jSe,STe]=Yi(),[USe,TTe]=Yi();function Iq(e,t){return NSe(e,Sl(a=>Fo(t?Pq:"web_app_exit_fullscreen",[xq,"fullscreen_failed"],a).then(o=>{if("error"in o&&o.error!=="ALREADY_FULLSCREEN")throw new pbe(o.error);const h="is_fullscreen"in o?o.is_fullscreen:!0;h!==FSe()&&Ey({isFullscreen:h})}),"Fullscreen mode change is already being requested",{promise:jSe,error:USe})[0])}Iq("requestFullscreen",!0);Iq("exitFullscreen");const VSe="web_app_request_emoji_status_access",[ETe,$Se,qSe]=Sl(e=>Fo(VSe,"emoji_status_access_requested",e).then(t=>t.status),"Emoji status access request is already in progress"),[,ATe,CTe]=$Se,[,MTe]=qSe,GSe="web_app_set_emoji_status",[OTe,HSe,ZSe]=Sl((e,t)=>Fo(GSe,["emoji_status_set","emoji_status_failed"],{params:{custom_emoji_id:e,duration:(t||{}).duration},...t}).then(a=>{if(a&&"error"in a)throw new fbe(a.error)}),"Emoji status set request is currently in progress"),[,PTe,ITe]=HSe,[,RTe]=ZSe,WSe="web_app_check_home_screen",[DTe,XSe,YSe]=Sl(e=>Fo(WSe,"home_screen_checked",e).then(t=>t.status||"unknown"),"Check home screen status request is currently in progress"),[,LTe,kTe]=XSe,[,zTe]=YSe,KSe=wm();KSe("openLink",(e,t)=>{if(typeof e=="string")try{e=new URL(e)}catch(a){throw new Nd(`"${e.toString()}" is invalid URL`,a)}t||(t={}),Ki("web_app_open_link",{url:e.toString(),try_browser:t.tryBrowser,try_instant_view:t.tryInstantView})});const cN="web_app_open_tg_link",JSe=wm(),QSe=JSe("openTelegramLink",e=>{const t=e.toString();if(!t.match(/^https:\/\/t.me\/.+/))throw new Nd(`"${t}" is invalid URL`);if(!Z0(cN,um())){window.location.href=t;return}e=new URL(e),Ki(cN,{path_full:e.pathname+e.search})}),e3e=wm();e3e("shareURL",(e,t)=>{QSe("https://t.me/share/url?"+new URLSearchParams({url:e,text:t||""}).toString().replace(/\+/g,"%20"))});function t3e(e,t){return new Is({abortSignal:t,timeout:e}).catch(()=>{})}const Rq="web_app_request_phone",[n3e,r3e,i3e]=Sl(e=>Fo(Rq,"phone_requested",e).then(t=>t.status),"Phone access request is currently in progress"),a3e=FP("requestPhoneAccess",n3e,{isSupported:Rq}),[,BTe,NTe]=r3e,[,FTe]=i3e;async function uN(e){const t=await I2("getRequestedContact",{},{...e,timeout:(e||{}).timeout||5e3});return HP(Ob(H$([nh(),V$(URLSearchParams)]),mwe(q4({contact:Ob(nh(),pwe(),q4({user_id:$$(),phone_number:nh(),first_name:nh(),last_name:q$(nh())})),auth_date:Ob(nh(),N$(a=>new Date(Number(a)*1e3)),U$()),hash:nh()}))),t)}const[jTe,o3e,s3e]=Sl(e=>new Is(async(t,a,o)=>{try{return t(await uN(o))}catch(y){if(y instanceof $4)throw y}if(await a3e(o)!=="sent")throw new dbe("User denied access");let h=50;for(;!o.isAborted();){try{return t(await uN(o))}catch(y){if(y instanceof $4)throw y}await t3e(h),h+=50}},e),"Contact is already being requested"),[,UTe,VTe]=o3e,[,$Te]=s3e,l3e="web_app_request_write_access",[qTe,c3e,u3e]=Sl(e=>Fo(l3e,"write_access_requested",e).then(t=>t.status),"Write access request is currently in progress"),[,GTe,HTe]=c3e,[,ZTe]=u3e;function h3e(e){sbe(e);const[t,a]=BP(Ps("reload_iframe",()=>{F4(!1,"Received a request to reload the page"),Ki("iframe_will_reload"),window.location.reload()})),{acceptCustomStyles:o=!0}={};if(o){const h=document.createElement("style");h.id="telegram-custom-styles",document.head.appendChild(h),t(Ps("set_custom_style",y=>{h.innerHTML=y}),()=>{document.head.removeChild(h)})}return Ki("iframe_ready",{reload_supported:!0}),F4(!1,"The package was initialized"),a}function f3e(){const e=Jd(),t=zo();return Ie.useEffect(()=>{function a(){t(-1)}return hf.onClick(a),()=>hf.offClick(a)},[t]),Ie.useEffect(()=>{e.pathname==="/"?hf.isSupported()&&hf.isMounted()&&hf.hide():hf.isSupported()&&hf.isMounted()&&hf.show()},[e]),null}function d3e(){const[e,t]=Ie.useState(DN),{snackbar:a,showSnackbar:o}=W2e();try{e.isInitTelegramSdk===void 0&&(h3e(),t({...e,isInitTelegramSdk:!0}))}catch(h){console.error("  teleram sdk:",h),t({...e,isInitTelegramSdk:!1})}return e.isInitTelegramSdk&&!YM.isMounting&&!YM.isMounted()&&YM.mount(),Ie.useEffect(()=>{e.isInitTelegramSdk&&!hf.isMounted()&&hf.mount()},[]),ve.jsxs(Bo.Provider,{value:{...e,setStationFilters:h=>t({...e,stationFilters:h}),setStations:h=>t({...e,stations:h,stationFilters:{...e.stationFilters,shouldUpdateStations:!1}}),setSessionFilters:h=>t({...e,sessionFilters:h}),setSessions:h=>t({...e,sessions:h,sessionFilters:{...e.sessionFilters,shouldUpdateSession:!1}}),showSnackbar:o,setRfidCard:h=>t({...e,rfidCard:h}),setActiveChargingSession:h=>t({...e,activeChargingSession:h}),setPaymentMethod:h=>t({...e,paymentMethod:h}),setPosition:h=>t({...e,position:h})},children:[e.isInitTelegramSdk&&ve.jsx(f3e,{}),a,ve.jsx(Z2e,{})]})}EH.createRoot(document.getElementById("root")).render(ve.jsx(Ie.StrictMode,{children:ve.jsx(UZ,{children:ve.jsx(d3e,{})})}));
