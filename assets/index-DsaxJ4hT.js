function _8(e,t){for(var a=0;a<t.length;a++){const s=t[a];if(typeof s!="string"&&!Array.isArray(s)){for(const f in s)if(f!=="default"&&!(f in e)){const v=Object.getOwnPropertyDescriptor(s,f);v&&Object.defineProperty(e,f,v.get?v:{enumerable:!0,get:()=>s[f]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const f of document.querySelectorAll('link[rel="modulepreload"]'))s(f);new MutationObserver(f=>{for(const v of f)if(v.type==="childList")for(const S of v.addedNodes)S.tagName==="LINK"&&S.rel==="modulepreload"&&s(S)}).observe(document,{childList:!0,subtree:!0});function a(f){const v={};return f.integrity&&(v.integrity=f.integrity),f.referrerPolicy&&(v.referrerPolicy=f.referrerPolicy),f.crossOrigin==="use-credentials"?v.credentials="include":f.crossOrigin==="anonymous"?v.credentials="omit":v.credentials="same-origin",v}function s(f){if(f.ep)return;f.ep=!0;const v=a(f);fetch(f.href,v)}})();var $2=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ei(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var HS={exports:{}},Wy={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var UI;function BU(){if(UI)return Wy;UI=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function a(s,f,v){var S=null;if(v!==void 0&&(S=""+v),f.key!==void 0&&(S=""+f.key),"key"in f){v={};for(var i in f)i!=="key"&&(v[i]=f[i])}else v=f;return f=v.ref,{$$typeof:e,type:s,key:S,ref:f!==void 0?f:null,props:v}}return Wy.Fragment=t,Wy.jsx=a,Wy.jsxs=a,Wy}var VI;function NU(){return VI||(VI=1,HS.exports=BU()),HS.exports}var he=NU(),ZS={exports:{}},zr={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $I;function FU(){if($I)return zr;$I=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),f=Symbol.for("react.profiler"),v=Symbol.for("react.consumer"),S=Symbol.for("react.context"),i=Symbol.for("react.forward_ref"),O=Symbol.for("react.suspense"),z=Symbol.for("react.memo"),j=Symbol.for("react.lazy"),F=Symbol.iterator;function G(et){return et===null||typeof et!="object"?null:(et=F&&et[F]||et["@@iterator"],typeof et=="function"?et:null)}var Y={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},X=Object.assign,K={};function ne(et,$t,rn){this.props=et,this.context=$t,this.refs=K,this.updater=rn||Y}ne.prototype.isReactComponent={},ne.prototype.setState=function(et,$t){if(typeof et!="object"&&typeof et!="function"&&et!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,et,$t,"setState")},ne.prototype.forceUpdate=function(et){this.updater.enqueueForceUpdate(this,et,"forceUpdate")};function se(){}se.prototype=ne.prototype;function ge(et,$t,rn){this.props=et,this.context=$t,this.refs=K,this.updater=rn||Y}var _e=ge.prototype=new se;_e.constructor=ge,X(_e,ne.prototype),_e.isPureReactComponent=!0;var xe=Array.isArray,ae={H:null,A:null,T:null,S:null},ve=Object.prototype.hasOwnProperty;function Se(et,$t,rn,Nt,xn,rr){return rn=rr.ref,{$$typeof:e,type:et,key:$t,ref:rn!==void 0?rn:null,props:rr}}function He(et,$t){return Se(et.type,$t,void 0,void 0,void 0,et.props)}function Ge(et){return typeof et=="object"&&et!==null&&et.$$typeof===e}function ye(et){var $t={"=":"=0",":":"=2"};return"$"+et.replace(/[=:]/g,function(rn){return $t[rn]})}var Le=/\/+/g;function ht(et,$t){return typeof et=="object"&&et!==null&&et.key!=null?ye(""+et.key):$t.toString(36)}function gt(){}function Ft(et){switch(et.status){case"fulfilled":return et.value;case"rejected":throw et.reason;default:switch(typeof et.status=="string"?et.then(gt,gt):(et.status="pending",et.then(function($t){et.status==="pending"&&(et.status="fulfilled",et.value=$t)},function($t){et.status==="pending"&&(et.status="rejected",et.reason=$t)})),et.status){case"fulfilled":return et.value;case"rejected":throw et.reason}}throw et}function _t(et,$t,rn,Nt,xn){var rr=typeof et;(rr==="undefined"||rr==="boolean")&&(et=null);var Xn=!1;if(et===null)Xn=!0;else switch(rr){case"bigint":case"string":case"number":Xn=!0;break;case"object":switch(et.$$typeof){case e:case t:Xn=!0;break;case j:return Xn=et._init,_t(Xn(et._payload),$t,rn,Nt,xn)}}if(Xn)return xn=xn(et),Xn=Nt===""?"."+ht(et,0):Nt,xe(xn)?(rn="",Xn!=null&&(rn=Xn.replace(Le,"$&/")+"/"),_t(xn,$t,rn,"",function(yn){return yn})):xn!=null&&(Ge(xn)&&(xn=He(xn,rn+(xn.key==null||et&&et.key===xn.key?"":(""+xn.key).replace(Le,"$&/")+"/")+Xn)),$t.push(xn)),1;Xn=0;var yi=Nt===""?".":Nt+":";if(xe(et))for(var ir=0;ir<et.length;ir++)Nt=et[ir],rr=yi+ht(Nt,ir),Xn+=_t(Nt,$t,rn,rr,xn);else if(ir=G(et),typeof ir=="function")for(et=ir.call(et),ir=0;!(Nt=et.next()).done;)Nt=Nt.value,rr=yi+ht(Nt,ir++),Xn+=_t(Nt,$t,rn,rr,xn);else if(rr==="object"){if(typeof et.then=="function")return _t(Ft(et),$t,rn,Nt,xn);throw $t=String(et),Error("Objects are not valid as a React child (found: "+($t==="[object Object]"?"object with keys {"+Object.keys(et).join(", ")+"}":$t)+"). If you meant to render a collection of children, use an array instead.")}return Xn}function yt(et,$t,rn){if(et==null)return et;var Nt=[],xn=0;return _t(et,Nt,"","",function(rr){return $t.call(rn,rr,xn++)}),Nt}function Vt(et){if(et._status===-1){var $t=et._result;$t=$t(),$t.then(function(rn){(et._status===0||et._status===-1)&&(et._status=1,et._result=rn)},function(rn){(et._status===0||et._status===-1)&&(et._status=2,et._result=rn)}),et._status===-1&&(et._status=0,et._result=$t)}if(et._status===1)return et._result.default;throw et._result}var Ht=typeof reportError=="function"?reportError:function(et){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var $t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof et=="object"&&et!==null&&typeof et.message=="string"?String(et.message):String(et),error:et});if(!window.dispatchEvent($t))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",et);return}console.error(et)};function Bt(){}return zr.Children={map:yt,forEach:function(et,$t,rn){yt(et,function(){$t.apply(this,arguments)},rn)},count:function(et){var $t=0;return yt(et,function(){$t++}),$t},toArray:function(et){return yt(et,function($t){return $t})||[]},only:function(et){if(!Ge(et))throw Error("React.Children.only expected to receive a single React element child.");return et}},zr.Component=ne,zr.Fragment=a,zr.Profiler=f,zr.PureComponent=ge,zr.StrictMode=s,zr.Suspense=O,zr.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=ae,zr.act=function(){throw Error("act(...) is not supported in production builds of React.")},zr.cache=function(et){return function(){return et.apply(null,arguments)}},zr.cloneElement=function(et,$t,rn){if(et==null)throw Error("The argument must be a React element, but you passed "+et+".");var Nt=X({},et.props),xn=et.key,rr=void 0;if($t!=null)for(Xn in $t.ref!==void 0&&(rr=void 0),$t.key!==void 0&&(xn=""+$t.key),$t)!ve.call($t,Xn)||Xn==="key"||Xn==="__self"||Xn==="__source"||Xn==="ref"&&$t.ref===void 0||(Nt[Xn]=$t[Xn]);var Xn=arguments.length-2;if(Xn===1)Nt.children=rn;else if(1<Xn){for(var yi=Array(Xn),ir=0;ir<Xn;ir++)yi[ir]=arguments[ir+2];Nt.children=yi}return Se(et.type,xn,void 0,void 0,rr,Nt)},zr.createContext=function(et){return et={$$typeof:S,_currentValue:et,_currentValue2:et,_threadCount:0,Provider:null,Consumer:null},et.Provider=et,et.Consumer={$$typeof:v,_context:et},et},zr.createElement=function(et,$t,rn){var Nt,xn={},rr=null;if($t!=null)for(Nt in $t.key!==void 0&&(rr=""+$t.key),$t)ve.call($t,Nt)&&Nt!=="key"&&Nt!=="__self"&&Nt!=="__source"&&(xn[Nt]=$t[Nt]);var Xn=arguments.length-2;if(Xn===1)xn.children=rn;else if(1<Xn){for(var yi=Array(Xn),ir=0;ir<Xn;ir++)yi[ir]=arguments[ir+2];xn.children=yi}if(et&&et.defaultProps)for(Nt in Xn=et.defaultProps,Xn)xn[Nt]===void 0&&(xn[Nt]=Xn[Nt]);return Se(et,rr,void 0,void 0,null,xn)},zr.createRef=function(){return{current:null}},zr.forwardRef=function(et){return{$$typeof:i,render:et}},zr.isValidElement=Ge,zr.lazy=function(et){return{$$typeof:j,_payload:{_status:-1,_result:et},_init:Vt}},zr.memo=function(et,$t){return{$$typeof:z,type:et,compare:$t===void 0?null:$t}},zr.startTransition=function(et){var $t=ae.T,rn={};ae.T=rn;try{var Nt=et(),xn=ae.S;xn!==null&&xn(rn,Nt),typeof Nt=="object"&&Nt!==null&&typeof Nt.then=="function"&&Nt.then(Bt,Ht)}catch(rr){Ht(rr)}finally{ae.T=$t}},zr.unstable_useCacheRefresh=function(){return ae.H.useCacheRefresh()},zr.use=function(et){return ae.H.use(et)},zr.useActionState=function(et,$t,rn){return ae.H.useActionState(et,$t,rn)},zr.useCallback=function(et,$t){return ae.H.useCallback(et,$t)},zr.useContext=function(et){return ae.H.useContext(et)},zr.useDebugValue=function(){},zr.useDeferredValue=function(et,$t){return ae.H.useDeferredValue(et,$t)},zr.useEffect=function(et,$t){return ae.H.useEffect(et,$t)},zr.useId=function(){return ae.H.useId()},zr.useImperativeHandle=function(et,$t,rn){return ae.H.useImperativeHandle(et,$t,rn)},zr.useInsertionEffect=function(et,$t){return ae.H.useInsertionEffect(et,$t)},zr.useLayoutEffect=function(et,$t){return ae.H.useLayoutEffect(et,$t)},zr.useMemo=function(et,$t){return ae.H.useMemo(et,$t)},zr.useOptimistic=function(et,$t){return ae.H.useOptimistic(et,$t)},zr.useReducer=function(et,$t,rn){return ae.H.useReducer(et,$t,rn)},zr.useRef=function(et){return ae.H.useRef(et)},zr.useState=function(et){return ae.H.useState(et)},zr.useSyncExternalStore=function(et,$t,rn){return ae.H.useSyncExternalStore(et,$t,rn)},zr.useTransition=function(){return ae.H.useTransition()},zr.version="19.0.0",zr}var qI;function Od(){return qI||(qI=1,ZS.exports=FU()),ZS.exports}var Me=Od();const Ot=Ei(Me),GI=_8({__proto__:null,default:Ot},[Me]);var WS={exports:{}},Xy={},XS={exports:{}},YS={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var HI;function jU(){return HI||(HI=1,function(e){function t(yt,Vt){var Ht=yt.length;yt.push(Vt);e:for(;0<Ht;){var Bt=Ht-1>>>1,et=yt[Bt];if(0<f(et,Vt))yt[Bt]=Vt,yt[Ht]=et,Ht=Bt;else break e}}function a(yt){return yt.length===0?null:yt[0]}function s(yt){if(yt.length===0)return null;var Vt=yt[0],Ht=yt.pop();if(Ht!==Vt){yt[0]=Ht;e:for(var Bt=0,et=yt.length,$t=et>>>1;Bt<$t;){var rn=2*(Bt+1)-1,Nt=yt[rn],xn=rn+1,rr=yt[xn];if(0>f(Nt,Ht))xn<et&&0>f(rr,Nt)?(yt[Bt]=rr,yt[xn]=Ht,Bt=xn):(yt[Bt]=Nt,yt[rn]=Ht,Bt=rn);else if(xn<et&&0>f(rr,Ht))yt[Bt]=rr,yt[xn]=Ht,Bt=xn;else break e}}return Vt}function f(yt,Vt){var Ht=yt.sortIndex-Vt.sortIndex;return Ht!==0?Ht:yt.id-Vt.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var v=performance;e.unstable_now=function(){return v.now()}}else{var S=Date,i=S.now();e.unstable_now=function(){return S.now()-i}}var O=[],z=[],j=1,F=null,G=3,Y=!1,X=!1,K=!1,ne=typeof setTimeout=="function"?setTimeout:null,se=typeof clearTimeout=="function"?clearTimeout:null,ge=typeof setImmediate<"u"?setImmediate:null;function _e(yt){for(var Vt=a(z);Vt!==null;){if(Vt.callback===null)s(z);else if(Vt.startTime<=yt)s(z),Vt.sortIndex=Vt.expirationTime,t(O,Vt);else break;Vt=a(z)}}function xe(yt){if(K=!1,_e(yt),!X)if(a(O)!==null)X=!0,Ft();else{var Vt=a(z);Vt!==null&&_t(xe,Vt.startTime-yt)}}var ae=!1,ve=-1,Se=5,He=-1;function Ge(){return!(e.unstable_now()-He<Se)}function ye(){if(ae){var yt=e.unstable_now();He=yt;var Vt=!0;try{e:{X=!1,K&&(K=!1,se(ve),ve=-1),Y=!0;var Ht=G;try{t:{for(_e(yt),F=a(O);F!==null&&!(F.expirationTime>yt&&Ge());){var Bt=F.callback;if(typeof Bt=="function"){F.callback=null,G=F.priorityLevel;var et=Bt(F.expirationTime<=yt);if(yt=e.unstable_now(),typeof et=="function"){F.callback=et,_e(yt),Vt=!0;break t}F===a(O)&&s(O),_e(yt)}else s(O);F=a(O)}if(F!==null)Vt=!0;else{var $t=a(z);$t!==null&&_t(xe,$t.startTime-yt),Vt=!1}}break e}finally{F=null,G=Ht,Y=!1}Vt=void 0}}finally{Vt?Le():ae=!1}}}var Le;if(typeof ge=="function")Le=function(){ge(ye)};else if(typeof MessageChannel<"u"){var ht=new MessageChannel,gt=ht.port2;ht.port1.onmessage=ye,Le=function(){gt.postMessage(null)}}else Le=function(){ne(ye,0)};function Ft(){ae||(ae=!0,Le())}function _t(yt,Vt){ve=ne(function(){yt(e.unstable_now())},Vt)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(yt){yt.callback=null},e.unstable_continueExecution=function(){X||Y||(X=!0,Ft())},e.unstable_forceFrameRate=function(yt){0>yt||125<yt?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Se=0<yt?Math.floor(1e3/yt):5},e.unstable_getCurrentPriorityLevel=function(){return G},e.unstable_getFirstCallbackNode=function(){return a(O)},e.unstable_next=function(yt){switch(G){case 1:case 2:case 3:var Vt=3;break;default:Vt=G}var Ht=G;G=Vt;try{return yt()}finally{G=Ht}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(yt,Vt){switch(yt){case 1:case 2:case 3:case 4:case 5:break;default:yt=3}var Ht=G;G=yt;try{return Vt()}finally{G=Ht}},e.unstable_scheduleCallback=function(yt,Vt,Ht){var Bt=e.unstable_now();switch(typeof Ht=="object"&&Ht!==null?(Ht=Ht.delay,Ht=typeof Ht=="number"&&0<Ht?Bt+Ht:Bt):Ht=Bt,yt){case 1:var et=-1;break;case 2:et=250;break;case 5:et=1073741823;break;case 4:et=1e4;break;default:et=5e3}return et=Ht+et,yt={id:j++,callback:Vt,priorityLevel:yt,startTime:Ht,expirationTime:et,sortIndex:-1},Ht>Bt?(yt.sortIndex=Ht,t(z,yt),a(O)===null&&yt===a(z)&&(K?(se(ve),ve=-1):K=!0,_t(xe,Ht-Bt))):(yt.sortIndex=et,t(O,yt),X||Y||(X=!0,Ft())),yt},e.unstable_shouldYield=Ge,e.unstable_wrapCallback=function(yt){var Vt=G;return function(){var Ht=G;G=Vt;try{return yt.apply(this,arguments)}finally{G=Ht}}}}(YS)),YS}var ZI;function UU(){return ZI||(ZI=1,XS.exports=jU()),XS.exports}var KS={exports:{}},xs={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var WI;function VU(){if(WI)return xs;WI=1;var e=Od();function t(O){var z="https://react.dev/errors/"+O;if(1<arguments.length){z+="?args[]="+encodeURIComponent(arguments[1]);for(var j=2;j<arguments.length;j++)z+="&args[]="+encodeURIComponent(arguments[j])}return"Minified React error #"+O+"; visit "+z+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(){}var s={d:{f:a,r:function(){throw Error(t(522))},D:a,C:a,L:a,m:a,X:a,S:a,M:a},p:0,findDOMNode:null},f=Symbol.for("react.portal");function v(O,z,j){var F=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:f,key:F==null?null:""+F,children:O,containerInfo:z,implementation:j}}var S=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function i(O,z){if(O==="font")return"";if(typeof z=="string")return z==="use-credentials"?z:""}return xs.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=s,xs.createPortal=function(O,z){var j=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!z||z.nodeType!==1&&z.nodeType!==9&&z.nodeType!==11)throw Error(t(299));return v(O,z,null,j)},xs.flushSync=function(O){var z=S.T,j=s.p;try{if(S.T=null,s.p=2,O)return O()}finally{S.T=z,s.p=j,s.d.f()}},xs.preconnect=function(O,z){typeof O=="string"&&(z?(z=z.crossOrigin,z=typeof z=="string"?z==="use-credentials"?z:"":void 0):z=null,s.d.C(O,z))},xs.prefetchDNS=function(O){typeof O=="string"&&s.d.D(O)},xs.preinit=function(O,z){if(typeof O=="string"&&z&&typeof z.as=="string"){var j=z.as,F=i(j,z.crossOrigin),G=typeof z.integrity=="string"?z.integrity:void 0,Y=typeof z.fetchPriority=="string"?z.fetchPriority:void 0;j==="style"?s.d.S(O,typeof z.precedence=="string"?z.precedence:void 0,{crossOrigin:F,integrity:G,fetchPriority:Y}):j==="script"&&s.d.X(O,{crossOrigin:F,integrity:G,fetchPriority:Y,nonce:typeof z.nonce=="string"?z.nonce:void 0})}},xs.preinitModule=function(O,z){if(typeof O=="string")if(typeof z=="object"&&z!==null){if(z.as==null||z.as==="script"){var j=i(z.as,z.crossOrigin);s.d.M(O,{crossOrigin:j,integrity:typeof z.integrity=="string"?z.integrity:void 0,nonce:typeof z.nonce=="string"?z.nonce:void 0})}}else z==null&&s.d.M(O)},xs.preload=function(O,z){if(typeof O=="string"&&typeof z=="object"&&z!==null&&typeof z.as=="string"){var j=z.as,F=i(j,z.crossOrigin);s.d.L(O,j,{crossOrigin:F,integrity:typeof z.integrity=="string"?z.integrity:void 0,nonce:typeof z.nonce=="string"?z.nonce:void 0,type:typeof z.type=="string"?z.type:void 0,fetchPriority:typeof z.fetchPriority=="string"?z.fetchPriority:void 0,referrerPolicy:typeof z.referrerPolicy=="string"?z.referrerPolicy:void 0,imageSrcSet:typeof z.imageSrcSet=="string"?z.imageSrcSet:void 0,imageSizes:typeof z.imageSizes=="string"?z.imageSizes:void 0,media:typeof z.media=="string"?z.media:void 0})}},xs.preloadModule=function(O,z){if(typeof O=="string")if(z){var j=i(z.as,z.crossOrigin);s.d.m(O,{as:typeof z.as=="string"&&z.as!=="script"?z.as:void 0,crossOrigin:j,integrity:typeof z.integrity=="string"?z.integrity:void 0})}else s.d.m(O)},xs.requestFormReset=function(O){s.d.r(O)},xs.unstable_batchedUpdates=function(O,z){return O(z)},xs.useFormState=function(O,z,j){return S.H.useFormState(O,z,j)},xs.useFormStatus=function(){return S.H.useHostTransitionStatus()},xs.version="19.0.0",xs}var XI;function g8(){if(XI)return KS.exports;XI=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),KS.exports=VU(),KS.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var YI;function $U(){if(YI)return Xy;YI=1;var e=UU(),t=Od(),a=g8();function s(h){var g="https://react.dev/errors/"+h;if(1<arguments.length){g+="?args[]="+encodeURIComponent(arguments[1]);for(var T=2;T<arguments.length;T++)g+="&args[]="+encodeURIComponent(arguments[T])}return"Minified React error #"+h+"; visit "+g+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function f(h){return!(!h||h.nodeType!==1&&h.nodeType!==9&&h.nodeType!==11)}var v=Symbol.for("react.element"),S=Symbol.for("react.transitional.element"),i=Symbol.for("react.portal"),O=Symbol.for("react.fragment"),z=Symbol.for("react.strict_mode"),j=Symbol.for("react.profiler"),F=Symbol.for("react.provider"),G=Symbol.for("react.consumer"),Y=Symbol.for("react.context"),X=Symbol.for("react.forward_ref"),K=Symbol.for("react.suspense"),ne=Symbol.for("react.suspense_list"),se=Symbol.for("react.memo"),ge=Symbol.for("react.lazy"),_e=Symbol.for("react.offscreen"),xe=Symbol.for("react.memo_cache_sentinel"),ae=Symbol.iterator;function ve(h){return h===null||typeof h!="object"?null:(h=ae&&h[ae]||h["@@iterator"],typeof h=="function"?h:null)}var Se=Symbol.for("react.client.reference");function He(h){if(h==null)return null;if(typeof h=="function")return h.$$typeof===Se?null:h.displayName||h.name||null;if(typeof h=="string")return h;switch(h){case O:return"Fragment";case i:return"Portal";case j:return"Profiler";case z:return"StrictMode";case K:return"Suspense";case ne:return"SuspenseList"}if(typeof h=="object")switch(h.$$typeof){case Y:return(h.displayName||"Context")+".Provider";case G:return(h._context.displayName||"Context")+".Consumer";case X:var g=h.render;return h=h.displayName,h||(h=g.displayName||g.name||"",h=h!==""?"ForwardRef("+h+")":"ForwardRef"),h;case se:return g=h.displayName||null,g!==null?g:He(h.type)||"Memo";case ge:g=h._payload,h=h._init;try{return He(h(g))}catch{}}return null}var Ge=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ye=Object.assign,Le,ht;function gt(h){if(Le===void 0)try{throw Error()}catch(T){var g=T.stack.trim().match(/\n( *(at )?)/);Le=g&&g[1]||"",ht=-1<T.stack.indexOf(`
    at`)?" (<anonymous>)":-1<T.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Le+h+ht}var Ft=!1;function _t(h,g){if(!h||Ft)return"";Ft=!0;var T=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var L={DetermineComponentFrameRoot:function(){try{if(g){var mn=function(){throw Error()};if(Object.defineProperty(mn.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(mn,[])}catch(Qt){var jt=Qt}Reflect.construct(h,[],mn)}else{try{mn.call()}catch(Qt){jt=Qt}h.call(mn.prototype)}}else{try{throw Error()}catch(Qt){jt=Qt}(mn=h())&&typeof mn.catch=="function"&&mn.catch(function(){})}}catch(Qt){if(Qt&&jt&&typeof Qt.stack=="string")return[Qt.stack,jt.stack]}return[null,null]}};L.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var V=Object.getOwnPropertyDescriptor(L.DetermineComponentFrameRoot,"name");V&&V.configurable&&Object.defineProperty(L.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var Q=L.DetermineComponentFrameRoot(),be=Q[0],Be=Q[1];if(be&&Be){var rt=be.split(`
`),Tt=Be.split(`
`);for(V=L=0;L<rt.length&&!rt[L].includes("DetermineComponentFrameRoot");)L++;for(;V<Tt.length&&!Tt[V].includes("DetermineComponentFrameRoot");)V++;if(L===rt.length||V===Tt.length)for(L=rt.length-1,V=Tt.length-1;1<=L&&0<=V&&rt[L]!==Tt[V];)V--;for(;1<=L&&0<=V;L--,V--)if(rt[L]!==Tt[V]){if(L!==1||V!==1)do if(L--,V--,0>V||rt[L]!==Tt[V]){var en=`
`+rt[L].replace(" at new "," at ");return h.displayName&&en.includes("<anonymous>")&&(en=en.replace("<anonymous>",h.displayName)),en}while(1<=L&&0<=V);break}}}finally{Ft=!1,Error.prepareStackTrace=T}return(T=h?h.displayName||h.name:"")?gt(T):""}function yt(h){switch(h.tag){case 26:case 27:case 5:return gt(h.type);case 16:return gt("Lazy");case 13:return gt("Suspense");case 19:return gt("SuspenseList");case 0:case 15:return h=_t(h.type,!1),h;case 11:return h=_t(h.type.render,!1),h;case 1:return h=_t(h.type,!0),h;default:return""}}function Vt(h){try{var g="";do g+=yt(h),h=h.return;while(h);return g}catch(T){return`
Error generating stack: `+T.message+`
`+T.stack}}function Ht(h){var g=h,T=h;if(h.alternate)for(;g.return;)g=g.return;else{h=g;do g=h,g.flags&4098&&(T=g.return),h=g.return;while(h)}return g.tag===3?T:null}function Bt(h){if(h.tag===13){var g=h.memoizedState;if(g===null&&(h=h.alternate,h!==null&&(g=h.memoizedState)),g!==null)return g.dehydrated}return null}function et(h){if(Ht(h)!==h)throw Error(s(188))}function $t(h){var g=h.alternate;if(!g){if(g=Ht(h),g===null)throw Error(s(188));return g!==h?null:h}for(var T=h,L=g;;){var V=T.return;if(V===null)break;var Q=V.alternate;if(Q===null){if(L=V.return,L!==null){T=L;continue}break}if(V.child===Q.child){for(Q=V.child;Q;){if(Q===T)return et(V),h;if(Q===L)return et(V),g;Q=Q.sibling}throw Error(s(188))}if(T.return!==L.return)T=V,L=Q;else{for(var be=!1,Be=V.child;Be;){if(Be===T){be=!0,T=V,L=Q;break}if(Be===L){be=!0,L=V,T=Q;break}Be=Be.sibling}if(!be){for(Be=Q.child;Be;){if(Be===T){be=!0,T=Q,L=V;break}if(Be===L){be=!0,L=Q,T=V;break}Be=Be.sibling}if(!be)throw Error(s(189))}}if(T.alternate!==L)throw Error(s(190))}if(T.tag!==3)throw Error(s(188));return T.stateNode.current===T?h:g}function rn(h){var g=h.tag;if(g===5||g===26||g===27||g===6)return h;for(h=h.child;h!==null;){if(g=rn(h),g!==null)return g;h=h.sibling}return null}var Nt=Array.isArray,xn=a.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,rr={pending:!1,data:null,method:null,action:null},Xn=[],yi=-1;function ir(h){return{current:h}}function yn(h){0>yi||(h.current=Xn[yi],Xn[yi]=null,yi--)}function Ne(h,g){yi++,Xn[yi]=h.current,h.current=g}var Qn=ir(null),fn=ir(null),Dr=ir(null),It=ir(null);function Ir(h,g){switch(Ne(Dr,g),Ne(fn,h),Ne(Qn,null),h=g.nodeType,h){case 9:case 11:g=(g=g.documentElement)&&(g=g.namespaceURI)?iy(g):0;break;default:if(h=h===8?g.parentNode:g,g=h.tagName,h=h.namespaceURI)h=iy(h),g=l_(h,g);else switch(g){case"svg":g=1;break;case"math":g=2;break;default:g=0}}yn(Qn),Ne(Qn,g)}function Cr(){yn(Qn),yn(fn),yn(Dr)}function ki(h){h.memoizedState!==null&&Ne(It,h);var g=Qn.current,T=l_(g,h.type);g!==T&&(Ne(fn,h),Ne(Qn,T))}function $n(h){fn.current===h&&(yn(Qn),yn(fn)),It.current===h&&(yn(It),ld._currentValue=rr)}var si=Object.prototype.hasOwnProperty,ca=e.unstable_scheduleCallback,Aa=e.unstable_cancelCallback,ao=e.unstable_shouldYield,Ss=e.unstable_requestPaint,Bn=e.unstable_now,Lo=e.unstable_getCurrentPriorityLevel,Jo=e.unstable_ImmediatePriority,ml=e.unstable_UserBlockingPriority,ua=e.unstable_NormalPriority,_l=e.unstable_LowPriority,nc=e.unstable_IdlePriority,Yu=e.log,Ku=e.unstable_setDisableYieldValue,ha=null,Ca=null;function Ju(h){if(Ca&&typeof Ca.onCommitFiberRoot=="function")try{Ca.onCommitFiberRoot(ha,h,void 0,(h.current.flags&128)===128)}catch{}}function ea(h){if(typeof Yu=="function"&&Ku(h),Ca&&typeof Ca.setStrictMode=="function")try{Ca.setStrictMode(ha,h)}catch{}}var fa=Math.clz32?Math.clz32:zd,qn=Math.log,Hs=Math.LN2;function zd(h){return h>>>=0,h===0?32:31-(qn(h)/Hs|0)|0}var $a=128,Qo=4194304;function es(h){var g=h&42;if(g!==0)return g;switch(h&-h){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return h&4194176;case 4194304:case 8388608:case 16777216:case 33554432:return h&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return h}}function gl(h,g){var T=h.pendingLanes;if(T===0)return 0;var L=0,V=h.suspendedLanes,Q=h.pingedLanes,be=h.warmLanes;h=h.finishedLanes!==0;var Be=T&134217727;return Be!==0?(T=Be&~V,T!==0?L=es(T):(Q&=Be,Q!==0?L=es(Q):h||(be=Be&~be,be!==0&&(L=es(be))))):(Be=T&~V,Be!==0?L=es(Be):Q!==0?L=es(Q):h||(be=T&~be,be!==0&&(L=es(be)))),L===0?0:g!==0&&g!==L&&!(g&V)&&(V=L&-L,be=g&-g,V>=be||V===32&&(be&4194176)!==0)?g:L}function Zs(h,g){return(h.pendingLanes&~(h.suspendedLanes&~h.pingedLanes)&g)===0}function kd(h,g){switch(h){case 1:case 2:case 4:case 8:return g+250;case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return g+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function au(){var h=$a;return $a<<=1,!($a&4194176)&&($a=128),h}function lf(){var h=Qo;return Qo<<=1,!(Qo&62914560)&&(Qo=4194304),h}function Qu(h){for(var g=[],T=0;31>T;T++)g.push(h);return g}function vi(h,g){h.pendingLanes|=g,g!==268435456&&(h.suspendedLanes=0,h.pingedLanes=0,h.warmLanes=0)}function cf(h,g,T,L,V,Q){var be=h.pendingLanes;h.pendingLanes=T,h.suspendedLanes=0,h.pingedLanes=0,h.warmLanes=0,h.expiredLanes&=T,h.entangledLanes&=T,h.errorRecoveryDisabledLanes&=T,h.shellSuspendCounter=0;var Be=h.entanglements,rt=h.expirationTimes,Tt=h.hiddenUpdates;for(T=be&~T;0<T;){var en=31-fa(T),mn=1<<en;Be[en]=0,rt[en]=-1;var jt=Tt[en];if(jt!==null)for(Tt[en]=null,en=0;en<jt.length;en++){var Qt=jt[en];Qt!==null&&(Qt.lane&=-536870913)}T&=~mn}L!==0&&uf(h,L,0),Q!==0&&V===0&&h.tag!==0&&(h.suspendedLanes|=Q&~(be&~g))}function uf(h,g,T){h.pendingLanes|=g,h.suspendedLanes&=~g;var L=31-fa(g);h.entangledLanes|=g,h.entanglements[L]=h.entanglements[L]|1073741824|T&4194218}function eh(h,g){var T=h.entangledLanes|=g;for(h=h.entanglements;T;){var L=31-fa(T),V=1<<L;V&g|h[L]&g&&(h[L]|=g),T&=~V}}function da(h){return h&=-h,2<h?8<h?h&134217727?32:268435456:8:2}function Ts(){var h=xn.p;return h!==0?h:(h=window.event,h===void 0?32:h2(h.type))}function dt(h,g){var T=xn.p;try{return xn.p=h,g()}finally{xn.p=T}}var le=Math.random().toString(36).slice(2),pe="__reactFiber$"+le,we="__reactProps$"+le,ze="__reactContainer$"+le,je="__reactEvents$"+le,We="__reactListeners$"+le,it="__reactHandles$"+le,Ye="__reactResources$"+le,ct="__reactMarker$"+le;function lt(h){delete h[pe],delete h[we],delete h[je],delete h[We],delete h[it]}function ut(h){var g=h[pe];if(g)return g;for(var T=h.parentNode;T;){if(g=T[ze]||T[pe]){if(T=g.alternate,g.child!==null||T!==null&&T.child!==null)for(h=t2(h);h!==null;){if(T=h[pe])return T;h=t2(h)}return g}h=T,T=h.parentNode}return null}function Ct(h){if(h=h[pe]||h[ze]){var g=h.tag;if(g===5||g===6||g===13||g===26||g===27||g===3)return h}return null}function Zt(h){var g=h.tag;if(g===5||g===26||g===27||g===6)return h.stateNode;throw Error(s(33))}function Xt(h){var g=h[Ye];return g||(g=h[Ye]={hoistableStyles:new Map,hoistableScripts:new Map}),g}function gn(h){h[ct]=!0}var Cn=new Set,On={};function wn(h,g){er(h,g),er(h+"Capture",g)}function er(h,g){for(On[h]=g,h=0;h<g.length;h++)Cn.add(g[h])}var tr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Yn=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),dr={},vr={};function Ii(h){return si.call(vr,h)?!0:si.call(dr,h)?!1:Yn.test(h)?vr[h]=!0:(dr[h]=!0,!1)}function zo(h,g,T){if(Ii(g))if(T===null)h.removeAttribute(g);else{switch(typeof T){case"undefined":case"function":case"symbol":h.removeAttribute(g);return;case"boolean":var L=g.toLowerCase().slice(0,5);if(L!=="data-"&&L!=="aria-"){h.removeAttribute(g);return}}h.setAttribute(g,""+T)}}function Ai(h,g,T){if(T===null)h.removeAttribute(g);else{switch(typeof T){case"undefined":case"function":case"symbol":case"boolean":h.removeAttribute(g);return}h.setAttribute(g,""+T)}}function ii(h,g,T,L){if(L===null)h.removeAttribute(T);else{switch(typeof L){case"undefined":case"function":case"symbol":case"boolean":h.removeAttribute(T);return}h.setAttributeNS(g,T,""+L)}}function di(h){switch(typeof h){case"bigint":case"boolean":case"number":case"string":case"undefined":return h;case"object":return h;default:return""}}function th(h){var g=h.type;return(h=h.nodeName)&&h.toLowerCase()==="input"&&(g==="checkbox"||g==="radio")}function yl(h){var g=th(h)?"checked":"value",T=Object.getOwnPropertyDescriptor(h.constructor.prototype,g),L=""+h[g];if(!h.hasOwnProperty(g)&&typeof T<"u"&&typeof T.get=="function"&&typeof T.set=="function"){var V=T.get,Q=T.set;return Object.defineProperty(h,g,{configurable:!0,get:function(){return V.call(this)},set:function(be){L=""+be,Q.call(this,be)}}),Object.defineProperty(h,g,{enumerable:T.enumerable}),{getValue:function(){return L},setValue:function(be){L=""+be},stopTracking:function(){h._valueTracker=null,delete h[g]}}}}function rc(h){h._valueTracker||(h._valueTracker=yl(h))}function Bd(h){if(!h)return!1;var g=h._valueTracker;if(!g)return!0;var T=g.getValue(),L="";return h&&(L=th(h)?h.checked?"true":"false":h.value),h=L,h!==T?(g.setValue(h),!0):!1}function hf(h){if(h=h||(typeof document<"u"?document:void 0),typeof h>"u")return null;try{return h.activeElement||h.body}catch{return h.body}}var Jp=/[\n"\\]/g;function xo(h){return h.replace(Jp,function(g){return"\\"+g.charCodeAt(0).toString(16)+" "})}function Ma(h,g,T,L,V,Q,be,Be){h.name="",be!=null&&typeof be!="function"&&typeof be!="symbol"&&typeof be!="boolean"?h.type=be:h.removeAttribute("type"),g!=null?be==="number"?(g===0&&h.value===""||h.value!=g)&&(h.value=""+di(g)):h.value!==""+di(g)&&(h.value=""+di(g)):be!=="submit"&&be!=="reset"||h.removeAttribute("value"),g!=null?Es(h,be,di(g)):T!=null?Es(h,be,di(T)):L!=null&&h.removeAttribute("value"),V==null&&Q!=null&&(h.defaultChecked=!!Q),V!=null&&(h.checked=V&&typeof V!="function"&&typeof V!="symbol"),Be!=null&&typeof Be!="function"&&typeof Be!="symbol"&&typeof Be!="boolean"?h.name=""+di(Be):h.removeAttribute("name")}function ts(h,g,T,L,V,Q,be,Be){if(Q!=null&&typeof Q!="function"&&typeof Q!="symbol"&&typeof Q!="boolean"&&(h.type=Q),g!=null||T!=null){if(!(Q!=="submit"&&Q!=="reset"||g!=null))return;T=T!=null?""+di(T):"",g=g!=null?""+di(g):T,Be||g===h.value||(h.value=g),h.defaultValue=g}L=L??V,L=typeof L!="function"&&typeof L!="symbol"&&!!L,h.checked=Be?h.checked:!!L,h.defaultChecked=!!L,be!=null&&typeof be!="function"&&typeof be!="symbol"&&typeof be!="boolean"&&(h.name=be)}function Es(h,g,T){g==="number"&&hf(h.ownerDocument)===h||h.defaultValue===""+T||(h.defaultValue=""+T)}function oo(h,g,T,L){if(h=h.options,g){g={};for(var V=0;V<T.length;V++)g["$"+T[V]]=!0;for(T=0;T<h.length;T++)V=g.hasOwnProperty("$"+h[T].value),h[T].selected!==V&&(h[T].selected=V),V&&L&&(h[T].defaultSelected=!0)}else{for(T=""+di(T),g=null,V=0;V<h.length;V++){if(h[V].value===T){h[V].selected=!0,L&&(h[V].defaultSelected=!0);return}g!==null||h[V].disabled||(g=h[V])}g!==null&&(g.selected=!0)}}function ns(h,g,T){if(g!=null&&(g=""+di(g),g!==h.value&&(h.value=g),T==null)){h.defaultValue!==g&&(h.defaultValue=g);return}h.defaultValue=T!=null?""+di(T):""}function As(h,g,T,L){if(g==null){if(L!=null){if(T!=null)throw Error(s(92));if(Nt(L)){if(1<L.length)throw Error(s(93));L=L[0]}T=L}T==null&&(T=""),g=T}T=di(g),h.defaultValue=T,L=h.textContent,L===T&&L!==""&&L!==null&&(h.value=L)}function vl(h,g){if(g){var T=h.firstChild;if(T&&T===h.lastChild&&T.nodeType===3){T.nodeValue=g;return}}h.textContent=g}var Qp=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function xl(h,g,T){var L=g.indexOf("--")===0;T==null||typeof T=="boolean"||T===""?L?h.setProperty(g,""):g==="float"?h.cssFloat="":h[g]="":L?h.setProperty(g,T):typeof T!="number"||T===0||Qp.has(g)?g==="float"?h.cssFloat=T:h[g]=(""+T).trim():h[g]=T+"px"}function bl(h,g,T){if(g!=null&&typeof g!="object")throw Error(s(62));if(h=h.style,T!=null){for(var L in T)!T.hasOwnProperty(L)||g!=null&&g.hasOwnProperty(L)||(L.indexOf("--")===0?h.setProperty(L,""):L==="float"?h.cssFloat="":h[L]="");for(var V in g)L=g[V],g.hasOwnProperty(V)&&T[V]!==L&&xl(h,V,L)}else for(var Q in g)g.hasOwnProperty(Q)&&xl(h,Q,g[Q])}function Nd(h){if(h.indexOf("-")===-1)return!1;switch(h){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var em=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),rs=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function _r(h){return rs.test(""+h)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":h}var ff=null;function Mn(h){return h=h.target||h.srcElement||window,h.correspondingUseElement&&(h=h.correspondingUseElement),h.nodeType===3?h.parentNode:h}var ou=null,wl=null;function df(h){var g=Ct(h);if(g&&(h=g.stateNode)){var T=h[we]||null;e:switch(h=g.stateNode,g.type){case"input":if(Ma(h,T.value,T.defaultValue,T.defaultValue,T.checked,T.defaultChecked,T.type,T.name),g=T.name,T.type==="radio"&&g!=null){for(T=h;T.parentNode;)T=T.parentNode;for(T=T.querySelectorAll('input[name="'+xo(""+g)+'"][type="radio"]'),g=0;g<T.length;g++){var L=T[g];if(L!==h&&L.form===h.form){var V=L[we]||null;if(!V)throw Error(s(90));Ma(L,V.value,V.defaultValue,V.defaultValue,V.checked,V.defaultChecked,V.type,V.name)}}for(g=0;g<T.length;g++)L=T[g],L.form===h.form&&Bd(L)}break e;case"textarea":ns(h,T.value,T.defaultValue);break e;case"select":g=T.value,g!=null&&oo(h,!!T.multiple,g,!1)}}}var Kn=!1;function pf(h,g,T){if(Kn)return h(g,T);Kn=!0;try{var L=h(g);return L}finally{if(Kn=!1,(ou!==null||wl!==null)&&(Im(),ou&&(g=ou,h=wl,wl=ou=null,df(g),h)))for(g=0;g<h.length;g++)df(h[g])}}function Cs(h,g){var T=h.stateNode;if(T===null)return null;var L=T[we]||null;if(L===null)return null;T=L[g];e:switch(g){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(L=!L.disabled)||(h=h.type,L=!(h==="button"||h==="input"||h==="select"||h==="textarea")),h=!L;break e;default:h=!1}if(h)return null;if(T&&typeof T!="function")throw Error(s(231,g,typeof T));return T}var _n=!1;if(tr)try{var xr={};Object.defineProperty(xr,"passive",{get:function(){_n=!0}}),window.addEventListener("test",xr,xr),window.removeEventListener("test",xr,xr)}catch{_n=!1}var ar=null,pa=null,is=null;function gr(){if(is)return is;var h,g=pa,T=g.length,L,V="value"in ar?ar.value:ar.textContent,Q=V.length;for(h=0;h<T&&g[h]===V[h];h++);var be=T-h;for(L=1;L<=be&&g[T-L]===V[Q-L];L++);return is=V.slice(h,1<L?1-L:void 0)}function ic(h){var g=h.keyCode;return"charCode"in h?(h=h.charCode,h===0&&g===13&&(h=13)):h=g,h===10&&(h=13),32<=h||h===13?h:0}function ko(){return!0}function nh(){return!1}function Wr(h){function g(T,L,V,Q,be){this._reactName=T,this._targetInst=V,this.type=L,this.nativeEvent=Q,this.target=be,this.currentTarget=null;for(var Be in h)h.hasOwnProperty(Be)&&(T=h[Be],this[Be]=T?T(Q):Q[Be]);return this.isDefaultPrevented=(Q.defaultPrevented!=null?Q.defaultPrevented:Q.returnValue===!1)?ko:nh,this.isPropagationStopped=nh,this}return ye(g.prototype,{preventDefault:function(){this.defaultPrevented=!0;var T=this.nativeEvent;T&&(T.preventDefault?T.preventDefault():typeof T.returnValue!="unknown"&&(T.returnValue=!1),this.isDefaultPrevented=ko)},stopPropagation:function(){var T=this.nativeEvent;T&&(T.stopPropagation?T.stopPropagation():typeof T.cancelBubble!="unknown"&&(T.cancelBubble=!0),this.isPropagationStopped=ko)},persist:function(){},isPersistent:ko}),g}var Xr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(h){return h.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},rh=Wr(Xr),ma=ye({},Xr,{view:0,detail:0}),Fd=Wr(ma),su,ih,Sl,ta=ye({},ma,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:rm,button:0,buttons:0,relatedTarget:function(h){return h.relatedTarget===void 0?h.fromElement===h.srcElement?h.toElement:h.fromElement:h.relatedTarget},movementX:function(h){return"movementX"in h?h.movementX:(h!==Sl&&(Sl&&h.type==="mousemove"?(su=h.screenX-Sl.screenX,ih=h.screenY-Sl.screenY):ih=su=0,Sl=h),su)},movementY:function(h){return"movementY"in h?h.movementY:ih}}),Ms=Wr(ta),Oa=ye({},ta,{dataTransfer:0}),tm=Wr(Oa),Tl=ye({},ma,{relatedTarget:0}),ai=Wr(Tl),as=ye({},Xr,{animationName:0,elapsedTime:0,pseudoElement:0}),_a=Wr(as),Pi=ye({},Xr,{clipboardData:function(h){return"clipboardData"in h?h.clipboardData:window.clipboardData}}),mf=Wr(Pi),Os=ye({},Xr,{data:0}),ac=Wr(Os),_f={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Is={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},nm={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function El(h){var g=this.nativeEvent;return g.getModifierState?g.getModifierState(h):(h=nm[h])?!!g[h]:!1}function rm(){return El}var im=ye({},ma,{key:function(h){if(h.key){var g=_f[h.key]||h.key;if(g!=="Unidentified")return g}return h.type==="keypress"?(h=ic(h),h===13?"Enter":String.fromCharCode(h)):h.type==="keydown"||h.type==="keyup"?Is[h.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:rm,charCode:function(h){return h.type==="keypress"?ic(h):0},keyCode:function(h){return h.type==="keydown"||h.type==="keyup"?h.keyCode:0},which:function(h){return h.type==="keypress"?ic(h):h.type==="keydown"||h.type==="keyup"?h.keyCode:0}}),so=Wr(im),am=ye({},ta,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),gf=Wr(am),yf=ye({},ma,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:rm}),vf=Wr(yf),Gg=ye({},Xr,{propertyName:0,elapsedTime:0,pseudoElement:0}),Hg=Wr(Gg),xf=ye({},ta,{deltaX:function(h){return"deltaX"in h?h.deltaX:"wheelDeltaX"in h?-h.wheelDeltaX:0},deltaY:function(h){return"deltaY"in h?h.deltaY:"wheelDeltaY"in h?-h.wheelDeltaY:"wheelDelta"in h?-h.wheelDelta:0},deltaZ:0,deltaMode:0}),bf=Wr(xf),Zg=ye({},Xr,{newState:0,oldState:0}),ah=Wr(Zg),om=[9,13,27,32],Ps=tr&&"CompositionEvent"in window,os=null;tr&&"documentMode"in document&&(os=document.documentMode);var Wg=tr&&"TextEvent"in window&&!os,jd=tr&&(!Ps||os&&8<os&&11>=os),M0=" ",sm=!1;function O0(h,g){switch(h){case"keyup":return om.indexOf(g.keyCode)!==-1;case"keydown":return g.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ud(h){return h=h.detail,typeof h=="object"&&"data"in h?h.data:null}var ss=!1;function Jn(h,g){switch(h){case"compositionend":return Ud(g);case"keypress":return g.which!==32?null:(sm=!0,M0);case"textInput":return h=g.data,h===M0&&sm?null:h;default:return null}}function Tn(h,g){if(ss)return h==="compositionend"||!Ps&&O0(h,g)?(h=gr(),is=pa=ar=null,ss=!1,h):null;switch(h){case"paste":return null;case"keypress":if(!(g.ctrlKey||g.altKey||g.metaKey)||g.ctrlKey&&g.altKey){if(g.char&&1<g.char.length)return g.char;if(g.which)return String.fromCharCode(g.which)}return null;case"compositionend":return jd&&g.locale!=="ko"?null:g.data;default:return null}}var Vd={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Dn(h){var g=h&&h.nodeName&&h.nodeName.toLowerCase();return g==="input"?!!Vd[h.type]:g==="textarea"}function lu(h,g,T,L){ou?wl?wl.push(L):wl=[L]:ou=L,g=zm(g,"onChange"),0<g.length&&(T=new rh("onChange","change",null,T,L),h.push({event:T,listeners:g}))}var oc=null,Rn=null;function oh(h){X1(h,0)}function Ws(h){var g=Zt(h);if(Bd(g))return h}function $d(h,g){if(h==="change")return g}var wf=!1;if(tr){var qa;if(tr){var na="oninput"in document;if(!na){var Kt=document.createElement("div");Kt.setAttribute("oninput","return;"),na=typeof Kt.oninput=="function"}qa=na}else qa=!1;wf=qa&&(!document.documentMode||9<document.documentMode)}function qd(){oc&&(oc.detachEvent("onpropertychange",Sf),Rn=oc=null)}function Sf(h){if(h.propertyName==="value"&&Ws(Rn)){var g=[];lu(g,Rn,h,Mn(h)),pf(oh,g)}}function Tf(h,g,T){h==="focusin"?(qd(),oc=g,Rn=T,oc.attachEvent("onpropertychange",Sf)):h==="focusout"&&qd()}function sc(h){if(h==="selectionchange"||h==="keyup"||h==="keydown")return Ws(Rn)}function ga(h,g){if(h==="click")return Ws(g)}function Al(h,g){if(h==="input"||h==="change")return Ws(g)}function lm(h,g){return h===g&&(h!==0||1/h===1/g)||h!==h&&g!==g}var ya=typeof Object.is=="function"?Object.is:lm;function Rs(h,g){if(ya(h,g))return!0;if(typeof h!="object"||h===null||typeof g!="object"||g===null)return!1;var T=Object.keys(h),L=Object.keys(g);if(T.length!==L.length)return!1;for(L=0;L<T.length;L++){var V=T[L];if(!si.call(g,V)||!ya(h[V],g[V]))return!1}return!0}function lc(h){for(;h&&h.firstChild;)h=h.firstChild;return h}function Gd(h,g){var T=lc(h);h=0;for(var L;T;){if(T.nodeType===3){if(L=h+T.textContent.length,h<=g&&L>=g)return{node:T,offset:g-h};h=L}e:{for(;T;){if(T.nextSibling){T=T.nextSibling;break e}T=T.parentNode}T=void 0}T=lc(T)}}function I0(h,g){return h&&g?h===g?!0:h&&h.nodeType===3?!1:g&&g.nodeType===3?I0(h,g.parentNode):"contains"in h?h.contains(g):h.compareDocumentPosition?!!(h.compareDocumentPosition(g)&16):!1:!1}function Hd(h){h=h!=null&&h.ownerDocument!=null&&h.ownerDocument.defaultView!=null?h.ownerDocument.defaultView:window;for(var g=hf(h.document);g instanceof h.HTMLIFrameElement;){try{var T=typeof g.contentWindow.location.href=="string"}catch{T=!1}if(T)h=g.contentWindow;else break;g=hf(h.document)}return g}function cm(h){var g=h&&h.nodeName&&h.nodeName.toLowerCase();return g&&(g==="input"&&(h.type==="text"||h.type==="search"||h.type==="tel"||h.type==="url"||h.type==="password")||g==="textarea"||h.contentEditable==="true")}function P0(h,g){var T=Hd(g);g=h.focusedElem;var L=h.selectionRange;if(T!==g&&g&&g.ownerDocument&&I0(g.ownerDocument.documentElement,g)){if(L!==null&&cm(g)){if(h=L.start,T=L.end,T===void 0&&(T=h),"selectionStart"in g)g.selectionStart=h,g.selectionEnd=Math.min(T,g.value.length);else if(T=(h=g.ownerDocument||document)&&h.defaultView||window,T.getSelection){T=T.getSelection();var V=g.textContent.length,Q=Math.min(L.start,V);L=L.end===void 0?Q:Math.min(L.end,V),!T.extend&&Q>L&&(V=L,L=Q,Q=V),V=Gd(g,Q);var be=Gd(g,L);V&&be&&(T.rangeCount!==1||T.anchorNode!==V.node||T.anchorOffset!==V.offset||T.focusNode!==be.node||T.focusOffset!==be.offset)&&(h=h.createRange(),h.setStart(V.node,V.offset),T.removeAllRanges(),Q>L?(T.addRange(h),T.extend(be.node,be.offset)):(h.setEnd(be.node,be.offset),T.addRange(h)))}}for(h=[],T=g;T=T.parentNode;)T.nodeType===1&&h.push({element:T,left:T.scrollLeft,top:T.scrollTop});for(typeof g.focus=="function"&&g.focus(),g=0;g<h.length;g++)T=h[g],T.element.scrollLeft=T.left,T.element.scrollTop=T.top}}var um=tr&&"documentMode"in document&&11>=document.documentMode,cc=null,hm=null,sh=null,Cl=!1;function R0(h,g,T){var L=T.window===T?T.document:T.nodeType===9?T:T.ownerDocument;Cl||cc==null||cc!==hf(L)||(L=cc,"selectionStart"in L&&cm(L)?L={start:L.selectionStart,end:L.selectionEnd}:(L=(L.ownerDocument&&L.ownerDocument.defaultView||window).getSelection(),L={anchorNode:L.anchorNode,anchorOffset:L.anchorOffset,focusNode:L.focusNode,focusOffset:L.focusOffset}),sh&&Rs(sh,L)||(sh=L,L=zm(hm,"onSelect"),0<L.length&&(g=new rh("onSelect","select",null,g,T),h.push({event:g,listeners:L}),g.target=cc)))}function uc(h,g){var T={};return T[h.toLowerCase()]=g.toLowerCase(),T["Webkit"+h]="webkit"+g,T["Moz"+h]="moz"+g,T}var hc={animationend:uc("Animation","AnimationEnd"),animationiteration:uc("Animation","AnimationIteration"),animationstart:uc("Animation","AnimationStart"),transitionrun:uc("Transition","TransitionRun"),transitionstart:uc("Transition","TransitionStart"),transitioncancel:uc("Transition","TransitionCancel"),transitionend:uc("Transition","TransitionEnd")},cu={},fm={};tr&&(fm=document.createElement("div").style,"AnimationEvent"in window||(delete hc.animationend.animation,delete hc.animationiteration.animation,delete hc.animationstart.animation),"TransitionEvent"in window||delete hc.transitionend.transition);function Ia(h){if(cu[h])return cu[h];if(!hc[h])return h;var g=hc[h],T;for(T in g)if(g.hasOwnProperty(T)&&T in fm)return cu[h]=g[T];return h}var Ef=Ia("animationend"),lh=Ia("animationiteration"),Af=Ia("animationstart"),fc=Ia("transitionrun"),Zd=Ia("transitionstart"),dm=Ia("transitioncancel"),dc=Ia("transitionend"),uu=new Map,ch="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll scrollEnd toggle touchMove waiting wheel".split(" ");function lo(h,g){uu.set(h,g),wn(g,[h])}var Pa=[],ls=0,pc=0;function mc(){for(var h=ls,g=pc=ls=0;g<h;){var T=Pa[g];Pa[g++]=null;var L=Pa[g];Pa[g++]=null;var V=Pa[g];Pa[g++]=null;var Q=Pa[g];if(Pa[g++]=null,L!==null&&V!==null){var be=L.pending;be===null?V.next=V:(V.next=be.next,be.next=V),L.pending=V}Q!==0&&_c(T,V,Q)}}function hu(h,g,T,L){Pa[ls++]=h,Pa[ls++]=g,Pa[ls++]=T,Pa[ls++]=L,pc|=L,h.lanes|=L,h=h.alternate,h!==null&&(h.lanes|=L)}function fu(h,g,T,L){return hu(h,g,T,L),sr(h)}function Bo(h,g){return hu(h,null,null,g),sr(h)}function _c(h,g,T){h.lanes|=T;var L=h.alternate;L!==null&&(L.lanes|=T);for(var V=!1,Q=h.return;Q!==null;)Q.childLanes|=T,L=Q.alternate,L!==null&&(L.childLanes|=T),Q.tag===22&&(h=Q.stateNode,h===null||h._visibility&1||(V=!0)),h=Q,Q=Q.return;V&&g!==null&&h.tag===3&&(Q=h.stateNode,V=31-fa(T),Q=Q.hiddenUpdates,h=Q[V],h===null?Q[V]=[g]:h.push(g),g.lane=T|536870912)}function sr(h){if(50<Nc)throw Nc=0,Kf=null,Error(s(185));for(var g=h.return;g!==null;)h=g,g=h.return;return h.tag===3?h.stateNode:null}var du={},pu=new WeakMap;function No(h,g){if(typeof h=="object"&&h!==null){var T=pu.get(h);return T!==void 0?T:(g={value:h,source:g,stack:Vt(g)},pu.set(h,g),g)}return{value:h,source:g,stack:Vt(g)}}var mu=[],uh=0,jr=null,hh=0,bo=[],wo=0,Ml=null,Xs=1,Ys="";function _u(h,g){mu[uh++]=hh,mu[uh++]=jr,jr=h,hh=g}function fh(h,g,T){bo[wo++]=Xs,bo[wo++]=Ys,bo[wo++]=Ml,Ml=h;var L=Xs;h=Ys;var V=32-fa(L)-1;L&=~(1<<V),T+=1;var Q=32-fa(g)+V;if(30<Q){var be=V-V%5;Q=(L&(1<<be)-1).toString(32),L>>=be,V-=be,Xs=1<<32-fa(g)+V|T<<V|L,Ys=Q+h}else Xs=1<<Q|T<<V|L,Ys=h}function gu(h){h.return!==null&&(_u(h,1),fh(h,1,0))}function Wd(h){for(;h===jr;)jr=mu[--uh],mu[uh]=null,hh=mu[--uh],mu[uh]=null;for(;h===Ml;)Ml=bo[--wo],bo[wo]=null,Ys=bo[--wo],bo[wo]=null,Xs=bo[--wo],bo[wo]=null}var li=null,va=null,Ur=!1,So=null,cs=!1,Cf=Error(s(519));function Ks(h){var g=Error(s(418,""));throw ph(No(g,h)),Cf}function Xd(h){var g=h.stateNode,T=h.type,L=h.memoizedProps;switch(g[pe]=h,g[we]=L,T){case"dialog":Hr("cancel",g),Hr("close",g);break;case"iframe":case"object":case"embed":Hr("load",g);break;case"video":case"audio":for(T=0;T<Lm.length;T++)Hr(Lm[T],g);break;case"source":Hr("error",g);break;case"img":case"image":case"link":Hr("error",g),Hr("load",g);break;case"details":Hr("toggle",g);break;case"input":Hr("invalid",g),ts(g,L.value,L.defaultValue,L.checked,L.defaultChecked,L.type,L.name,!0),rc(g);break;case"select":Hr("invalid",g);break;case"textarea":Hr("invalid",g),As(g,L.value,L.defaultValue,L.children),rc(g)}T=L.children,typeof T!="string"&&typeof T!="number"&&typeof T!="bigint"||g.textContent===""+T||L.suppressHydrationWarning===!0||rd(g.textContent,T)?(L.popover!=null&&(Hr("beforetoggle",g),Hr("toggle",g)),L.onScroll!=null&&Hr("scroll",g),L.onScrollEnd!=null&&Hr("scrollend",g),L.onClick!=null&&(g.onclick=Uc),g=!0):g=!1,g||Ks(h)}function Yd(h){for(li=h.return;li;)switch(li.tag){case 3:case 27:cs=!0;return;case 5:case 13:cs=!1;return;default:li=li.return}}function gc(h){if(h!==li)return!1;if(!Ur)return Yd(h),Ur=!0,!1;var g=!1,T;if((T=h.tag!==3&&h.tag!==27)&&((T=h.tag===5)&&(T=h.type,T=!(T!=="form"&&T!=="button")||Bm(h.type,h.memoizedProps)),T=!T),T&&(g=!0),g&&va&&Ks(h),Yd(h),h.tag===13){if(h=h.memoizedState,h=h!==null?h.dehydrated:null,!h)throw Error(s(317));e:{for(h=h.nextSibling,g=0;h;){if(h.nodeType===8)if(T=h.data,T==="/$"){if(g===0){va=Vl(h.nextSibling);break e}g--}else T!=="$"&&T!=="$!"&&T!=="$?"||g++;h=h.nextSibling}va=null}}else va=li?Vl(h.stateNode.nextSibling):null;return!0}function dh(){va=li=null,Ur=!1}function ph(h){So===null?So=[h]:So.push(h)}var Js=Error(s(460)),D0=Error(s(474)),pm={then:function(){}};function L0(h){return h=h.status,h==="fulfilled"||h==="rejected"}function Kd(){}function z0(h,g,T){switch(T=h[T],T===void 0?h.push(g):T!==g&&(g.then(Kd,Kd),g=T),g.status){case"fulfilled":return g.value;case"rejected":throw h=g.reason,h===Js?Error(s(483)):h;default:if(typeof g.status=="string")g.then(Kd,Kd);else{if(h=In,h!==null&&100<h.shellSuspendCounter)throw Error(s(482));h=g,h.status="pending",h.then(function(L){if(g.status==="pending"){var V=g;V.status="fulfilled",V.value=L}},function(L){if(g.status==="pending"){var V=g;V.status="rejected",V.reason=L}})}switch(g.status){case"fulfilled":return g.value;case"rejected":throw h=g.reason,h===Js?Error(s(483)):h}throw Mf=g,Js}}var Mf=null;function Jd(){if(Mf===null)throw Error(s(459));var h=Mf;return Mf=null,h}var yc=null,vc=0;function Ol(h){var g=vc;return vc+=1,yc===null&&(yc=[]),z0(yc,h,g)}function yu(h,g){g=g.props.ref,h.ref=g!==void 0?g:null}function Of(h,g){throw g.$$typeof===v?Error(s(525)):(h=Object.prototype.toString.call(g),Error(s(31,h==="[object Object]"?"object with keys {"+Object.keys(g).join(", ")+"}":h)))}function mm(h){var g=h._init;return g(h._payload)}function Qd(h){function g(Mt,xt){if(h){var Dt=Mt.deletions;Dt===null?(Mt.deletions=[xt],Mt.flags|=16):Dt.push(xt)}}function T(Mt,xt){if(!h)return null;for(;xt!==null;)g(Mt,xt),xt=xt.sibling;return null}function L(Mt){for(var xt=new Map;Mt!==null;)Mt.key!==null?xt.set(Mt.key,Mt):xt.set(Mt.index,Mt),Mt=Mt.sibling;return xt}function V(Mt,xt){return Mt=Gt(Mt,xt),Mt.index=0,Mt.sibling=null,Mt}function Q(Mt,xt,Dt){return Mt.index=Dt,h?(Dt=Mt.alternate,Dt!==null?(Dt=Dt.index,Dt<xt?(Mt.flags|=33554434,xt):Dt):(Mt.flags|=33554434,xt)):(Mt.flags|=1048576,xt)}function be(Mt){return h&&Mt.alternate===null&&(Mt.flags|=33554434),Mt}function Be(Mt,xt,Dt,un){return xt===null||xt.tag!==6?(xt=on(Dt,Mt.mode,un),xt.return=Mt,xt):(xt=V(xt,Dt),xt.return=Mt,xt)}function rt(Mt,xt,Dt,un){var Un=Dt.type;return Un===O?en(Mt,xt,Dt.props.children,un,Dt.key):xt!==null&&(xt.elementType===Un||typeof Un=="object"&&Un!==null&&Un.$$typeof===ge&&mm(Un)===xt.type)?(xt=V(xt,Dt.props),yu(xt,Dt),xt.return=Mt,xt):(xt=At(Dt.type,Dt.key,Dt.props,null,Mt.mode,un),yu(xt,Dt),xt.return=Mt,xt)}function Tt(Mt,xt,Dt,un){return xt===null||xt.tag!==4||xt.stateNode.containerInfo!==Dt.containerInfo||xt.stateNode.implementation!==Dt.implementation?(xt=dn(Dt,Mt.mode,un),xt.return=Mt,xt):(xt=V(xt,Dt.children||[]),xt.return=Mt,xt)}function en(Mt,xt,Dt,un,Un){return xt===null||xt.tag!==7?(xt=kt(Dt,Mt.mode,un,Un),xt.return=Mt,xt):(xt=V(xt,Dt),xt.return=Mt,xt)}function mn(Mt,xt,Dt){if(typeof xt=="string"&&xt!==""||typeof xt=="number"||typeof xt=="bigint")return xt=on(""+xt,Mt.mode,Dt),xt.return=Mt,xt;if(typeof xt=="object"&&xt!==null){switch(xt.$$typeof){case S:return Dt=At(xt.type,xt.key,xt.props,null,Mt.mode,Dt),yu(Dt,xt),Dt.return=Mt,Dt;case i:return xt=dn(xt,Mt.mode,Dt),xt.return=Mt,xt;case ge:var un=xt._init;return xt=un(xt._payload),mn(Mt,xt,Dt)}if(Nt(xt)||ve(xt))return xt=kt(xt,Mt.mode,Dt,null),xt.return=Mt,xt;if(typeof xt.then=="function")return mn(Mt,Ol(xt),Dt);if(xt.$$typeof===Y)return mn(Mt,yp(Mt,xt),Dt);Of(Mt,xt)}return null}function jt(Mt,xt,Dt,un){var Un=xt!==null?xt.key:null;if(typeof Dt=="string"&&Dt!==""||typeof Dt=="number"||typeof Dt=="bigint")return Un!==null?null:Be(Mt,xt,""+Dt,un);if(typeof Dt=="object"&&Dt!==null){switch(Dt.$$typeof){case S:return Dt.key===Un?rt(Mt,xt,Dt,un):null;case i:return Dt.key===Un?Tt(Mt,xt,Dt,un):null;case ge:return Un=Dt._init,Dt=Un(Dt._payload),jt(Mt,xt,Dt,un)}if(Nt(Dt)||ve(Dt))return Un!==null?null:en(Mt,xt,Dt,un,null);if(typeof Dt.then=="function")return jt(Mt,xt,Ol(Dt),un);if(Dt.$$typeof===Y)return jt(Mt,xt,yp(Mt,Dt),un);Of(Mt,Dt)}return null}function Qt(Mt,xt,Dt,un,Un){if(typeof un=="string"&&un!==""||typeof un=="number"||typeof un=="bigint")return Mt=Mt.get(Dt)||null,Be(xt,Mt,""+un,Un);if(typeof un=="object"&&un!==null){switch(un.$$typeof){case S:return Mt=Mt.get(un.key===null?Dt:un.key)||null,rt(xt,Mt,un,Un);case i:return Mt=Mt.get(un.key===null?Dt:un.key)||null,Tt(xt,Mt,un,Un);case ge:var wr=un._init;return un=wr(un._payload),Qt(Mt,xt,Dt,un,Un)}if(Nt(un)||ve(un))return Mt=Mt.get(Dt)||null,en(xt,Mt,un,Un,null);if(typeof un.then=="function")return Qt(Mt,xt,Dt,Ol(un),Un);if(un.$$typeof===Y)return Qt(Mt,xt,Dt,yp(xt,un),Un);Of(xt,un)}return null}function Hn(Mt,xt,Dt,un){for(var Un=null,wr=null,nr=xt,fr=xt=0,Wa=null;nr!==null&&fr<Dt.length;fr++){nr.index>fr?(Wa=nr,nr=null):Wa=nr.sibling;var Jr=jt(Mt,nr,Dt[fr],un);if(Jr===null){nr===null&&(nr=Wa);break}h&&nr&&Jr.alternate===null&&g(Mt,nr),xt=Q(Jr,xt,fr),wr===null?Un=Jr:wr.sibling=Jr,wr=Jr,nr=Wa}if(fr===Dt.length)return T(Mt,nr),Ur&&_u(Mt,fr),Un;if(nr===null){for(;fr<Dt.length;fr++)nr=mn(Mt,Dt[fr],un),nr!==null&&(xt=Q(nr,xt,fr),wr===null?Un=nr:wr.sibling=nr,wr=nr);return Ur&&_u(Mt,fr),Un}for(nr=L(nr);fr<Dt.length;fr++)Wa=Qt(nr,Mt,fr,Dt[fr],un),Wa!==null&&(h&&Wa.alternate!==null&&nr.delete(Wa.key===null?fr:Wa.key),xt=Q(Wa,xt,fr),wr===null?Un=Wa:wr.sibling=Wa,wr=Wa);return h&&nr.forEach(function(Hh){return g(Mt,Hh)}),Ur&&_u(Mt,fr),Un}function Er(Mt,xt,Dt,un){if(Dt==null)throw Error(s(151));for(var Un=null,wr=null,nr=xt,fr=xt=0,Wa=null,Jr=Dt.next();nr!==null&&!Jr.done;fr++,Jr=Dt.next()){nr.index>fr?(Wa=nr,nr=null):Wa=nr.sibling;var Hh=jt(Mt,nr,Jr.value,un);if(Hh===null){nr===null&&(nr=Wa);break}h&&nr&&Hh.alternate===null&&g(Mt,nr),xt=Q(Hh,xt,fr),wr===null?Un=Hh:wr.sibling=Hh,wr=Hh,nr=Wa}if(Jr.done)return T(Mt,nr),Ur&&_u(Mt,fr),Un;if(nr===null){for(;!Jr.done;fr++,Jr=Dt.next())Jr=mn(Mt,Jr.value,un),Jr!==null&&(xt=Q(Jr,xt,fr),wr===null?Un=Jr:wr.sibling=Jr,wr=Jr);return Ur&&_u(Mt,fr),Un}for(nr=L(nr);!Jr.done;fr++,Jr=Dt.next())Jr=Qt(nr,Mt,fr,Jr.value,un),Jr!==null&&(h&&Jr.alternate!==null&&nr.delete(Jr.key===null?fr:Jr.key),xt=Q(Jr,xt,fr),wr===null?Un=Jr:wr.sibling=Jr,wr=Jr);return h&&nr.forEach(function(tS){return g(Mt,tS)}),Ur&&_u(Mt,fr),Un}function Yi(Mt,xt,Dt,un){if(typeof Dt=="object"&&Dt!==null&&Dt.type===O&&Dt.key===null&&(Dt=Dt.props.children),typeof Dt=="object"&&Dt!==null){switch(Dt.$$typeof){case S:e:{for(var Un=Dt.key;xt!==null;){if(xt.key===Un){if(Un=Dt.type,Un===O){if(xt.tag===7){T(Mt,xt.sibling),un=V(xt,Dt.props.children),un.return=Mt,Mt=un;break e}}else if(xt.elementType===Un||typeof Un=="object"&&Un!==null&&Un.$$typeof===ge&&mm(Un)===xt.type){T(Mt,xt.sibling),un=V(xt,Dt.props),yu(un,Dt),un.return=Mt,Mt=un;break e}T(Mt,xt);break}else g(Mt,xt);xt=xt.sibling}Dt.type===O?(un=kt(Dt.props.children,Mt.mode,un,Dt.key),un.return=Mt,Mt=un):(un=At(Dt.type,Dt.key,Dt.props,null,Mt.mode,un),yu(un,Dt),un.return=Mt,Mt=un)}return be(Mt);case i:e:{for(Un=Dt.key;xt!==null;){if(xt.key===Un)if(xt.tag===4&&xt.stateNode.containerInfo===Dt.containerInfo&&xt.stateNode.implementation===Dt.implementation){T(Mt,xt.sibling),un=V(xt,Dt.children||[]),un.return=Mt,Mt=un;break e}else{T(Mt,xt);break}else g(Mt,xt);xt=xt.sibling}un=dn(Dt,Mt.mode,un),un.return=Mt,Mt=un}return be(Mt);case ge:return Un=Dt._init,Dt=Un(Dt._payload),Yi(Mt,xt,Dt,un)}if(Nt(Dt))return Hn(Mt,xt,Dt,un);if(ve(Dt)){if(Un=ve(Dt),typeof Un!="function")throw Error(s(150));return Dt=Un.call(Dt),Er(Mt,xt,Dt,un)}if(typeof Dt.then=="function")return Yi(Mt,xt,Ol(Dt),un);if(Dt.$$typeof===Y)return Yi(Mt,xt,yp(Mt,Dt),un);Of(Mt,Dt)}return typeof Dt=="string"&&Dt!==""||typeof Dt=="number"||typeof Dt=="bigint"?(Dt=""+Dt,xt!==null&&xt.tag===6?(T(Mt,xt.sibling),un=V(xt,Dt),un.return=Mt,Mt=un):(T(Mt,xt),un=on(Dt,Mt.mode,un),un.return=Mt,Mt=un),be(Mt)):T(Mt,xt)}return function(Mt,xt,Dt,un){try{vc=0;var Un=Yi(Mt,xt,Dt,un);return yc=null,Un}catch(nr){if(nr===Js)throw nr;var wr=St(29,nr,null,Mt.mode);return wr.lanes=un,wr.return=Mt,wr}finally{}}}var To=Qd(!0),ep=Qd(!1),Ra=ir(null),vu=ir(0);function mh(h,g){h=Ci,Ne(vu,h),Ne(Ra,g),Ci=h|g.baseLanes}function tp(){Ne(vu,Ci),Ne(Ra,Ra.current)}function _h(){Ci=vu.current,yn(Ra),yn(vu)}var Ya=ir(null),us=null;function xc(h){var g=h.alternate;Ne(xa,xa.current&1),Ne(Ya,h),us===null&&(g===null||Ra.current!==null||g.memoizedState!==null)&&(us=h)}function np(h){if(h.tag===22){if(Ne(xa,xa.current),Ne(Ya,h),us===null){var g=h.alternate;g!==null&&g.memoizedState!==null&&(us=h)}}else Fo()}function Fo(){Ne(xa,xa.current),Ne(Ya,Ya.current)}function Il(h){yn(Ya),us===h&&(us=null),yn(xa)}var xa=ir(0);function If(h){for(var g=h;g!==null;){if(g.tag===13){var T=g.memoizedState;if(T!==null&&(T=T.dehydrated,T===null||T.data==="$?"||T.data==="$!"))return g}else if(g.tag===19&&g.memoizedProps.revealOrder!==void 0){if(g.flags&128)return g}else if(g.child!==null){g.child.return=g,g=g.child;continue}if(g===h)break;for(;g.sibling===null;){if(g.return===null||g.return===h)return null;g=g.return}g.sibling.return=g.return,g=g.sibling}return null}var k0=typeof AbortController<"u"?AbortController:function(){var h=[],g=this.signal={aborted:!1,addEventListener:function(T,L){h.push(L)}};this.abort=function(){g.aborted=!0,h.forEach(function(T){return T()})}},rp=e.unstable_scheduleCallback,gh=e.unstable_NormalPriority,Ri={$$typeof:Y,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function yh(){return{controller:new k0,data:new Map,refCount:0}}function Pl(h){h.refCount--,h.refCount===0&&rp(gh,function(){h.controller.abort()})}var vh=null,xu=0,Qs=0,bc=null;function B0(h,g){if(vh===null){var T=vh=[];xu=0,Qs=n_(),bc={status:"pending",value:void 0,then:function(L){T.push(L)}}}return xu++,g.then(N0,N0),g}function N0(){if(--xu===0&&vh!==null){bc!==null&&(bc.status="fulfilled");var h=vh;vh=null,Qs=0,bc=null;for(var g=0;g<h.length;g++)(0,h[g])()}}function bu(h,g){var T=[],L={status:"pending",value:null,reason:null,then:function(V){T.push(V)}};return h.then(function(){L.status="fulfilled",L.value=g;for(var V=0;V<T.length;V++)(0,T[V])(g)},function(V){for(L.status="rejected",L.reason=V,V=0;V<T.length;V++)(0,T[V])(void 0)}),L}var Pf=Ge.S;Ge.S=function(h,g){typeof g=="object"&&g!==null&&typeof g.then=="function"&&B0(h,g),Pf!==null&&Pf(h,g)};var hn=ir(null);function Rf(){var h=hn.current;return h!==null?h:In.pooledCache}function xh(h,g){g===null?Ne(hn,hn.current):Ne(hn,g.pool)}function Rl(){var h=Rf();return h===null?null:{parent:Ri._currentValue,pool:h}}var Eo=0,Yt=null,ti=null,ra=null,ip=!1,Dl=!1,Ll=!1,bh=0,wh=0,wc=null,Df=0;function Di(){throw Error(s(321))}function Lf(h,g){if(g===null)return!1;for(var T=0;T<g.length&&T<h.length;T++)if(!ya(h[T],g[T]))return!1;return!0}function hs(h,g,T,L,V,Q){return Eo=Q,Yt=g,g.memoizedState=null,g.updateQueue=null,g.lanes=0,Ge.H=h===null||h.memoizedState===null?zs:uo,Ll=!1,Q=T(L,V),Ll=!1,Dl&&(Q=zl(g,T,L,V)),co(h),Q}function co(h){Ge.H=ps;var g=ti!==null&&ti.next!==null;if(Eo=0,ra=ti=Yt=null,ip=!1,wh=0,wc=null,g)throw Error(s(300));h===null||wa||(h=h.dependencies,h!==null&&il(h)&&(wa=!0))}function zl(h,g,T,L){Yt=h;var V=0;do{if(Dl&&(wc=null),wh=0,Dl=!1,25<=V)throw Error(s(301));if(V+=1,ra=ti=null,h.updateQueue!=null){var Q=h.updateQueue;Q.lastEffect=null,Q.events=null,Q.stores=null,Q.memoCache!=null&&(Q.memoCache.index=0)}Ge.H=nl,Q=g(T,L)}while(Dl);return Q}function _m(){var h=Ge.H,g=h.useState()[0];return g=typeof g.then=="function"?Tc(g):g,h=h.useState()[0],(ti!==null?ti.memoizedState:null)!==h&&(Yt.flags|=1024),g}function zf(){var h=bh!==0;return bh=0,h}function Sc(h,g,T){g.updateQueue=h.updateQueue,g.flags&=-2053,h.lanes&=~T}function Sh(h){if(ip){for(h=h.memoizedState;h!==null;){var g=h.queue;g!==null&&(g.pending=null),h=h.next}ip=!1}Eo=0,ra=ti=Yt=null,Dl=!1,wh=bh=0,wc=null}function Da(){var h={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ra===null?Yt.memoizedState=ra=h:ra=ra.next=h,ra}function Yr(){if(ti===null){var h=Yt.alternate;h=h!==null?h.memoizedState:null}else h=ti.next;var g=ra===null?Yt.memoizedState:ra.next;if(g!==null)ra=g,ti=h;else{if(h===null)throw Yt.alternate===null?Error(s(467)):Error(s(310));ti=h,h={memoizedState:ti.memoizedState,baseState:ti.baseState,baseQueue:ti.baseQueue,queue:ti.queue,next:null},ra===null?Yt.memoizedState=ra=h:ra=ra.next=h}return ra}var kr;kr=function(){return{lastEffect:null,events:null,stores:null,memoCache:null}};function Tc(h){var g=wh;return wh+=1,wc===null&&(wc=[]),h=z0(wc,h,g),g=Yt,(ra===null?g.memoizedState:ra.next)===null&&(g=g.alternate,Ge.H=g===null||g.memoizedState===null?zs:uo),h}function Ec(h){if(h!==null&&typeof h=="object"){if(typeof h.then=="function")return Tc(h);if(h.$$typeof===Y)return Ka(h)}throw Error(s(438,String(h)))}function Th(h){var g=null,T=Yt.updateQueue;if(T!==null&&(g=T.memoCache),g==null){var L=Yt.alternate;L!==null&&(L=L.updateQueue,L!==null&&(L=L.memoCache,L!=null&&(g={data:L.data.map(function(V){return V.slice()}),index:0})))}if(g==null&&(g={data:[],index:0}),T===null&&(T=kr(),Yt.updateQueue=T),T.memoCache=g,T=g.data[g.index],T===void 0)for(T=g.data[g.index]=Array(h),L=0;L<h;L++)T[L]=xe;return g.index++,T}function Ds(h,g){return typeof g=="function"?g(h):g}function Ac(h){var g=Yr();return Cc(g,ti,h)}function Cc(h,g,T){var L=h.queue;if(L===null)throw Error(s(311));L.lastRenderedReducer=T;var V=h.baseQueue,Q=L.pending;if(Q!==null){if(V!==null){var be=V.next;V.next=Q.next,Q.next=be}g.baseQueue=V=Q,L.pending=null}if(Q=h.baseState,V===null)h.memoizedState=Q;else{g=V.next;var Be=be=null,rt=null,Tt=g,en=!1;do{var mn=Tt.lane&-536870913;if(mn!==Tt.lane?(Pn&mn)===mn:(Eo&mn)===mn){var jt=Tt.revertLane;if(jt===0)rt!==null&&(rt=rt.next={lane:0,revertLane:0,action:Tt.action,hasEagerState:Tt.hasEagerState,eagerState:Tt.eagerState,next:null}),mn===Qs&&(en=!0);else if((Eo&jt)===jt){Tt=Tt.next,jt===Qs&&(en=!0);continue}else mn={lane:0,revertLane:Tt.revertLane,action:Tt.action,hasEagerState:Tt.hasEagerState,eagerState:Tt.eagerState,next:null},rt===null?(Be=rt=mn,be=Q):rt=rt.next=mn,Yt.lanes|=jt,Tr|=jt;mn=Tt.action,Ll&&T(Q,mn),Q=Tt.hasEagerState?Tt.eagerState:T(Q,mn)}else jt={lane:mn,revertLane:Tt.revertLane,action:Tt.action,hasEagerState:Tt.hasEagerState,eagerState:Tt.eagerState,next:null},rt===null?(Be=rt=jt,be=Q):rt=rt.next=jt,Yt.lanes|=mn,Tr|=mn;Tt=Tt.next}while(Tt!==null&&Tt!==g);if(rt===null?be=Q:rt.next=Be,!ya(Q,h.memoizedState)&&(wa=!0,en&&(T=bc,T!==null)))throw T;h.memoizedState=Q,h.baseState=be,h.baseQueue=rt,L.lastRenderedState=Q}return V===null&&(L.lanes=0),[h.memoizedState,L.dispatch]}function Mc(h){var g=Yr(),T=g.queue;if(T===null)throw Error(s(311));T.lastRenderedReducer=h;var L=T.dispatch,V=T.pending,Q=g.memoizedState;if(V!==null){T.pending=null;var be=V=V.next;do Q=h(Q,be.action),be=be.next;while(be!==V);ya(Q,g.memoizedState)||(wa=!0),g.memoizedState=Q,g.baseQueue===null&&(g.baseState=Q),T.lastRenderedState=Q}return[Q,L]}function wu(h,g,T){var L=Yt,V=Yr(),Q=Ur;if(Q){if(T===void 0)throw Error(s(407));T=T()}else T=g();var be=!ya((ti||V).memoizedState,T);if(be&&(V.memoizedState=T,wa=!0),V=V.queue,Vi(Su.bind(null,L,V,h),[h]),V.getSnapshot!==g||be||ra!==null&&ra.memoizedState.tag&1){if(L.flags|=2048,fs(9,cn.bind(null,L,V,T,g),{destroy:void 0},null),In===null)throw Error(s(349));Q||Eo&60||qt(L,g,T)}return T}function qt(h,g,T){h.flags|=16384,h={getSnapshot:g,value:T},g=Yt.updateQueue,g===null?(g=kr(),Yt.updateQueue=g,g.stores=[h]):(T=g.stores,T===null?g.stores=[h]:T.push(h))}function cn(h,g,T,L){g.value=T,g.getSnapshot=L,ni(g)&&st(h)}function Su(h,g,T){return T(function(){ni(g)&&st(h)})}function ni(h){var g=h.getSnapshot;h=h.value;try{var T=g();return!ya(h,T)}catch{return!0}}function st(h){var g=Bo(h,2);g!==null&&Zo(g,h,2)}function ap(h){var g=Da();if(typeof h=="function"){var T=h;if(h=T(),Ll){ea(!0);try{T()}finally{ea(!1)}}}return g.memoizedState=g.baseState=h,g.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ds,lastRenderedState:h},g}function kf(h,g,T,L){return h.baseState=T,Cc(h,ti,typeof L=="function"?L:Ds)}function gm(h,g,T,L,V){if(Mh(h))throw Error(s(485));if(h=g.action,h!==null){var Q={payload:V,action:h,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(be){Q.listeners.push(be)}};Ge.T!==null?T(!0):Q.isTransition=!1,L(Q),T=g.pending,T===null?(Q.next=g.pending=Q,ym(g,Q)):(Q.next=T.next,g.pending=T.next=Q)}}function ym(h,g){var T=g.action,L=g.payload,V=h.state;if(g.isTransition){var Q=Ge.T,be={};Ge.T=be;try{var Be=T(V,L),rt=Ge.S;rt!==null&&rt(be,Be),vm(h,g,Be)}catch(Tt){Oc(h,g,Tt)}finally{Ge.T=Q}}else try{Q=T(V,L),vm(h,g,Q)}catch(Tt){Oc(h,g,Tt)}}function vm(h,g,T){T!==null&&typeof T=="object"&&typeof T.then=="function"?T.then(function(L){xm(h,g,L)},function(L){return Oc(h,g,L)}):xm(h,g,T)}function xm(h,g,T){g.status="fulfilled",g.value=T,F0(g),h.state=T,g=h.pending,g!==null&&(T=g.next,T===g?h.pending=null:(T=T.next,g.next=T,ym(h,T)))}function Oc(h,g,T){var L=h.pending;if(h.pending=null,L!==null){L=L.next;do g.status="rejected",g.reason=T,F0(g),g=g.next;while(g!==L)}h.action=null}function F0(h){h=h.listeners;for(var g=0;g<h.length;g++)(0,h[g])()}function j0(h,g){return g}function bm(h,g){if(Ur){var T=In.formState;if(T!==null){e:{var L=Yt;if(Ur){if(va){t:{for(var V=va,Q=cs;V.nodeType!==8;){if(!Q){V=null;break t}if(V=Vl(V.nextSibling),V===null){V=null;break t}}Q=V.data,V=Q==="F!"||Q==="F"?V:null}if(V){va=Vl(V.nextSibling),L=V.data==="F!";break e}}Ks(L)}L=!1}L&&(g=T[0])}}return T=Da(),T.memoizedState=T.baseState=g,L={pending:null,lanes:0,dispatch:null,lastRenderedReducer:j0,lastRenderedState:g},T.queue=L,T=cp.bind(null,Yt,L),L.dispatch=T,L=ap(!1),Q=Vf.bind(null,Yt,!1,L.queue),L=Da(),V={state:g,dispatch:null,action:h,pending:null},L.queue=V,T=gm.bind(null,Yt,V,Q,T),V.dispatch=T,L.memoizedState=h,[g,T,!1]}function Bf(h){var g=Yr();return kl(g,ti,h)}function kl(h,g,T){g=Cc(h,g,j0)[0],h=Ac(Ds)[0],g=typeof g=="object"&&g!==null&&typeof g.then=="function"?Tc(g):g;var L=Yr(),V=L.queue,Q=V.dispatch;return T!==L.memoizedState&&(Yt.flags|=2048,fs(9,wm.bind(null,V,T),{destroy:void 0},null)),[g,Q,h]}function wm(h,g){h.action=g}function op(h){var g=Yr(),T=ti;if(T!==null)return kl(g,T,h);Yr(),g=g.memoizedState,T=Yr();var L=T.queue.dispatch;return T.memoizedState=h,[g,L,!1]}function fs(h,g,T,L){return h={tag:h,create:g,inst:T,deps:L,next:null},g=Yt.updateQueue,g===null&&(g=kr(),Yt.updateQueue=g),T=g.lastEffect,T===null?g.lastEffect=h.next=h:(L=T.next,T.next=h,h.next=L,g.lastEffect=h),h}function Nf(){return Yr().memoizedState}function jo(h,g,T,L){var V=Da();Yt.flags|=h,V.memoizedState=fs(1|g,T,{destroy:void 0},L===void 0?null:L)}function ds(h,g,T,L){var V=Yr();L=L===void 0?null:L;var Q=V.memoizedState.inst;ti!==null&&L!==null&&Lf(L,ti.memoizedState.deps)?V.memoizedState=fs(g,T,Q,L):(Yt.flags|=h,V.memoizedState=fs(1|g,T,Q,L))}function Sm(h,g){jo(8390656,8,h,g)}function Vi(h,g){ds(2048,8,h,g)}function U0(h,g){return ds(4,2,h,g)}function Eh(h,g){return ds(4,4,h,g)}function $r(h,g){if(typeof g=="function"){h=h();var T=g(h);return function(){typeof T=="function"?T():g(null)}}if(g!=null)return h=h(),g.current=h,function(){g.current=null}}function br(h,g,T){T=T!=null?T.concat([h]):null,ds(4,4,$r.bind(null,g,h),T)}function sp(){}function el(h,g){var T=Yr();g=g===void 0?null:g;var L=T.memoizedState;return g!==null&&Lf(g,L[1])?L[0]:(T.memoizedState=[h,g],h)}function Tu(h,g){var T=Yr();g=g===void 0?null:g;var L=T.memoizedState;if(g!==null&&Lf(g,L[1]))return L[0];if(L=h(),Ll){ea(!0);try{h()}finally{ea(!1)}}return T.memoizedState=[L,g],L}function Ls(h,g,T){return T===void 0||Eo&1073741824?h.memoizedState=g:(h.memoizedState=T,h=j1(),Yt.lanes|=h,Tr|=h,T)}function Ff(h,g,T,L){return ya(T,g)?T:Ra.current!==null?(h=Ls(h,T,L),ya(h,g)||(wa=!0),h):Eo&42?(h=j1(),Yt.lanes|=h,Tr|=h,g):(wa=!0,h.memoizedState=T)}function Ah(h,g,T,L,V){var Q=xn.p;xn.p=Q!==0&&8>Q?Q:8;var be=Ge.T,Be={};Ge.T=Be,Vf(h,!1,g,T);try{var rt=V(),Tt=Ge.S;if(Tt!==null&&Tt(Be,rt),rt!==null&&typeof rt=="object"&&typeof rt.then=="function"){var en=bu(rt,L);Rc(h,g,en,vs(h))}else Rc(h,g,L,vs(h))}catch(mn){Rc(h,g,{then:function(){},status:"rejected",reason:mn},vs())}finally{xn.p=Q,Ge.T=be}}function tl(){}function ba(h,g,T,L){if(h.tag!==5)throw Error(s(476));var V=jf(h).queue;Ah(h,V,g,rr,T===null?tl:function(){return Ch(h),T(L)})}function jf(h){var g=h.memoizedState;if(g!==null)return g;g={memoizedState:rr,baseState:rr,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ds,lastRenderedState:rr},next:null};var T={};return g.next={memoizedState:T,baseState:T,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ds,lastRenderedState:T},next:null},h.memoizedState=g,h=h.alternate,h!==null&&(h.memoizedState=g),g}function Ch(h){var g=jf(h).next.queue;Rc(h,g,{},vs())}function Uf(){return Ka(ld)}function lp(){return Yr().memoizedState}function Ic(){return Yr().memoizedState}function Tm(h){for(var g=h.return;g!==null;){switch(g.tag){case 24:case 3:var T=vs();h=$o(T);var L=Fl(g,h,T);L!==null&&(Zo(L,g,T),Lh(L,g,T)),g={cache:yh()},h.payload=g;return}g=g.return}}function Pc(h,g,T){var L=vs();T={lane:L,revertLane:0,action:T,hasEagerState:!1,eagerState:null,next:null},Mh(h)?ia(g,T):(T=fu(h,g,T,L),T!==null&&(Zo(T,h,L),up(T,g,L)))}function cp(h,g,T){var L=vs();Rc(h,g,T,L)}function Rc(h,g,T,L){var V={lane:L,revertLane:0,action:T,hasEagerState:!1,eagerState:null,next:null};if(Mh(h))ia(g,V);else{var Q=h.alternate;if(h.lanes===0&&(Q===null||Q.lanes===0)&&(Q=g.lastRenderedReducer,Q!==null))try{var be=g.lastRenderedState,Be=Q(be,T);if(V.hasEagerState=!0,V.eagerState=Be,ya(Be,be))return hu(h,g,V,0),In===null&&mc(),!1}catch{}finally{}if(T=fu(h,g,V,L),T!==null)return Zo(T,h,L),up(T,g,L),!0}return!1}function Vf(h,g,T,L){if(L={lane:2,revertLane:n_(),action:L,hasEagerState:!1,eagerState:null,next:null},Mh(h)){if(g)throw Error(s(479))}else g=fu(h,T,L,2),g!==null&&Zo(g,h,2)}function Mh(h){var g=h.alternate;return h===Yt||g!==null&&g===Yt}function ia(h,g){Dl=ip=!0;var T=h.pending;T===null?g.next=g:(g.next=T.next,T.next=g),h.pending=g}function up(h,g,T){if(T&4194176){var L=g.lanes;L&=h.pendingLanes,T|=L,g.lanes=T,eh(h,T)}}var ps={readContext:Ka,use:Ec,useCallback:Di,useContext:Di,useEffect:Di,useImperativeHandle:Di,useLayoutEffect:Di,useInsertionEffect:Di,useMemo:Di,useReducer:Di,useRef:Di,useState:Di,useDebugValue:Di,useDeferredValue:Di,useTransition:Di,useSyncExternalStore:Di,useId:Di};ps.useCacheRefresh=Di,ps.useMemoCache=Di,ps.useHostTransitionStatus=Di,ps.useFormState=Di,ps.useActionState=Di,ps.useOptimistic=Di;var zs={readContext:Ka,use:Ec,useCallback:function(h,g){return Da().memoizedState=[h,g===void 0?null:g],h},useContext:Ka,useEffect:Sm,useImperativeHandle:function(h,g,T){T=T!=null?T.concat([h]):null,jo(4194308,4,$r.bind(null,g,h),T)},useLayoutEffect:function(h,g){return jo(4194308,4,h,g)},useInsertionEffect:function(h,g){jo(4,2,h,g)},useMemo:function(h,g){var T=Da();g=g===void 0?null:g;var L=h();if(Ll){ea(!0);try{h()}finally{ea(!1)}}return T.memoizedState=[L,g],L},useReducer:function(h,g,T){var L=Da();if(T!==void 0){var V=T(g);if(Ll){ea(!0);try{T(g)}finally{ea(!1)}}}else V=g;return L.memoizedState=L.baseState=V,h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:h,lastRenderedState:V},L.queue=h,h=h.dispatch=Pc.bind(null,Yt,h),[L.memoizedState,h]},useRef:function(h){var g=Da();return h={current:h},g.memoizedState=h},useState:function(h){h=ap(h);var g=h.queue,T=cp.bind(null,Yt,g);return g.dispatch=T,[h.memoizedState,T]},useDebugValue:sp,useDeferredValue:function(h,g){var T=Da();return Ls(T,h,g)},useTransition:function(){var h=ap(!1);return h=Ah.bind(null,Yt,h.queue,!0,!1),Da().memoizedState=h,[!1,h]},useSyncExternalStore:function(h,g,T){var L=Yt,V=Da();if(Ur){if(T===void 0)throw Error(s(407));T=T()}else{if(T=g(),In===null)throw Error(s(349));Pn&60||qt(L,g,T)}V.memoizedState=T;var Q={value:T,getSnapshot:g};return V.queue=Q,Sm(Su.bind(null,L,Q,h),[h]),L.flags|=2048,fs(9,cn.bind(null,L,Q,T,g),{destroy:void 0},null),T},useId:function(){var h=Da(),g=In.identifierPrefix;if(Ur){var T=Ys,L=Xs;T=(L&~(1<<32-fa(L)-1)).toString(32)+T,g=":"+g+"R"+T,T=bh++,0<T&&(g+="H"+T.toString(32)),g+=":"}else T=Df++,g=":"+g+"r"+T.toString(32)+":";return h.memoizedState=g},useCacheRefresh:function(){return Da().memoizedState=Tm.bind(null,Yt)}};zs.useMemoCache=Th,zs.useHostTransitionStatus=Uf,zs.useFormState=bm,zs.useActionState=bm,zs.useOptimistic=function(h){var g=Da();g.memoizedState=g.baseState=h;var T={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return g.queue=T,g=Vf.bind(null,Yt,!0,T),T.dispatch=g,[h,g]};var uo={readContext:Ka,use:Ec,useCallback:el,useContext:Ka,useEffect:Vi,useImperativeHandle:br,useInsertionEffect:U0,useLayoutEffect:Eh,useMemo:Tu,useReducer:Ac,useRef:Nf,useState:function(){return Ac(Ds)},useDebugValue:sp,useDeferredValue:function(h,g){var T=Yr();return Ff(T,ti.memoizedState,h,g)},useTransition:function(){var h=Ac(Ds)[0],g=Yr().memoizedState;return[typeof h=="boolean"?h:Tc(h),g]},useSyncExternalStore:wu,useId:lp};uo.useCacheRefresh=Ic,uo.useMemoCache=Th,uo.useHostTransitionStatus=Uf,uo.useFormState=Bf,uo.useActionState=Bf,uo.useOptimistic=function(h,g){var T=Yr();return kf(T,ti,h,g)};var nl={readContext:Ka,use:Ec,useCallback:el,useContext:Ka,useEffect:Vi,useImperativeHandle:br,useInsertionEffect:U0,useLayoutEffect:Eh,useMemo:Tu,useReducer:Mc,useRef:Nf,useState:function(){return Mc(Ds)},useDebugValue:sp,useDeferredValue:function(h,g){var T=Yr();return ti===null?Ls(T,h,g):Ff(T,ti.memoizedState,h,g)},useTransition:function(){var h=Mc(Ds)[0],g=Yr().memoizedState;return[typeof h=="boolean"?h:Tc(h),g]},useSyncExternalStore:wu,useId:lp};nl.useCacheRefresh=Ic,nl.useMemoCache=Th,nl.useHostTransitionStatus=Uf,nl.useFormState=op,nl.useActionState=op,nl.useOptimistic=function(h,g){var T=Yr();return ti!==null?kf(T,ti,h,g):(T.baseState=h,[h,T.queue.dispatch])};function ms(h,g,T,L){g=h.memoizedState,T=T(L,g),T=T==null?g:ye({},g,T),h.memoizedState=T,h.lanes===0&&(h.updateQueue.baseState=T)}var Oh={isMounted:function(h){return(h=h._reactInternals)?Ht(h)===h:!1},enqueueSetState:function(h,g,T){h=h._reactInternals;var L=vs(),V=$o(L);V.payload=g,T!=null&&(V.callback=T),g=Fl(h,V,L),g!==null&&(Zo(g,h,L),Lh(g,h,L))},enqueueReplaceState:function(h,g,T){h=h._reactInternals;var L=vs(),V=$o(L);V.tag=1,V.payload=g,T!=null&&(V.callback=T),g=Fl(h,V,L),g!==null&&(Zo(g,h,L),Lh(g,h,L))},enqueueForceUpdate:function(h,g){h=h._reactInternals;var T=vs(),L=$o(T);L.tag=2,g!=null&&(L.callback=g),g=Fl(h,L,T),g!==null&&(Zo(g,h,T),Lh(g,h,T))}};function Eu(h,g,T,L,V,Q,be){return h=h.stateNode,typeof h.shouldComponentUpdate=="function"?h.shouldComponentUpdate(L,Q,be):g.prototype&&g.prototype.isPureReactComponent?!Rs(T,L)||!Rs(V,Q):!0}function hp(h,g,T,L){h=g.state,typeof g.componentWillReceiveProps=="function"&&g.componentWillReceiveProps(T,L),typeof g.UNSAFE_componentWillReceiveProps=="function"&&g.UNSAFE_componentWillReceiveProps(T,L),g.state!==h&&Oh.enqueueReplaceState(g,g.state,null)}function Bl(h,g){var T=g;if("ref"in g){T={};for(var L in g)L!=="ref"&&(T[L]=g[L])}if(h=h.defaultProps){T===g&&(T=ye({},T));for(var V in h)T[V]===void 0&&(T[V]=h[V])}return T}var Dc=typeof reportError=="function"?reportError:function(h){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var g=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof h=="object"&&h!==null&&typeof h.message=="string"?String(h.message):String(h),error:h});if(!window.dispatchEvent(g))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",h);return}console.error(h)};function Ih(h){Dc(h)}function fp(h){console.error(h)}function $f(h){Dc(h)}function qf(h,g){try{var T=h.onUncaughtError;T(g.value,{componentStack:g.stack})}catch(L){setTimeout(function(){throw L})}}function dp(h,g,T){try{var L=h.onCaughtError;L(T.value,{componentStack:T.stack,errorBoundary:g.tag===1?g.stateNode:null})}catch(V){setTimeout(function(){throw V})}}function Au(h,g,T){return T=$o(T),T.tag=3,T.payload={element:null},T.callback=function(){qf(h,g)},T}function Em(h){return h=$o(h),h.tag=3,h}function Am(h,g,T,L){var V=T.type.getDerivedStateFromError;if(typeof V=="function"){var Q=L.value;h.payload=function(){return V(Q)},h.callback=function(){dp(g,T,L)}}var be=T.stateNode;be!==null&&typeof be.componentDidCatch=="function"&&(h.callback=function(){dp(g,T,L),typeof V!="function"&&(Sa===null?Sa=new Set([this]):Sa.add(this));var Be=L.stack;this.componentDidCatch(L.value,{componentStack:Be!==null?Be:""})})}function V0(h,g,T,L,V){if(T.flags|=32768,L!==null&&typeof L=="object"&&typeof L.then=="function"){if(g=T.alternate,g!==null&&gs(g,T,V,!0),T=Ya.current,T!==null){switch(T.tag){case 13:return us===null?Jf():T.alternate===null&&hr===0&&(hr=3),T.flags&=-257,T.flags|=65536,T.lanes=V,L===pm?T.flags|=16384:(g=T.updateQueue,g===null?T.updateQueue=new Set([L]):g.add(L),Nh(h,L,V)),!1;case 22:return T.flags|=65536,L===pm?T.flags|=16384:(g=T.updateQueue,g===null?(g={transitions:null,markerInstances:null,retryQueue:new Set([L])},T.updateQueue=g):(T=g.retryQueue,T===null?g.retryQueue=new Set([L]):T.add(L)),Nh(h,L,V)),!1}throw Error(s(435,T.tag))}return Nh(h,L,V),Jf(),!1}if(Ur)return g=Ya.current,g!==null?(!(g.flags&65536)&&(g.flags|=256),g.flags|=65536,g.lanes=V,L!==Cf&&(h=Error(s(422),{cause:L}),ph(No(h,T)))):(L!==Cf&&(g=Error(s(423),{cause:L}),ph(No(g,T))),h=h.current.alternate,h.flags|=65536,V&=-V,h.lanes|=V,L=No(L,T),V=Au(h.stateNode,L,V),zc(h,V),hr!==4&&(hr=2)),!1;var Q=Error(s(520),{cause:L});if(Q=No(Q,T),Or===null?Or=[Q]:Or.push(Q),hr!==4&&(hr=2),g===null)return!0;L=No(L,T),T=g;do{switch(T.tag){case 3:return T.flags|=65536,h=V&-V,T.lanes|=h,h=Au(T.stateNode,L,h),zc(T,h),!1;case 1:if(g=T.type,Q=T.stateNode,(T.flags&128)===0&&(typeof g.getDerivedStateFromError=="function"||Q!==null&&typeof Q.componentDidCatch=="function"&&(Sa===null||!Sa.has(Q))))return T.flags|=65536,V&=-V,T.lanes|=V,V=Em(V),Am(V,h,T,L),zc(T,V),!1}T=T.return}while(T!==null);return!1}var Cm=Error(s(461)),wa=!1;function Xi(h,g,T,L){g.child=h===null?ep(g,null,T,L):To(g,h.child,T,L)}function Ph(h,g,T,L,V){T=T.render;var Q=g.ref;if("ref"in L){var be={};for(var Be in L)Be!=="ref"&&(be[Be]=L[Be])}else be=L;return Co(g),L=hs(h,g,T,be,Q,V),Be=zf(),h!==null&&!wa?(Sc(h,g,V),rl(h,g,V)):(Ur&&Be&&gu(g),g.flags|=1,Xi(h,g,L,V),g.child)}function ho(h,g,T,L,V){if(h===null){var Q=T.type;return typeof Q=="function"&&!mt(Q)&&Q.defaultProps===void 0&&T.compare===null?(g.tag=15,g.type=Q,Rh(h,g,Q,L,V)):(h=At(T.type,null,L,g,g.mode,V),h.ref=g.ref,h.return=g,g.child=h)}if(Q=h.child,!_p(h,V)){var be=Q.memoizedProps;if(T=T.compare,T=T!==null?T:Rs,T(be,L)&&h.ref===g.ref)return rl(h,g,V)}return g.flags|=1,h=Gt(Q,L),h.ref=g.ref,h.return=g,g.child=h}function Rh(h,g,T,L,V){if(h!==null){var Q=h.memoizedProps;if(Rs(Q,L)&&h.ref===g.ref)if(wa=!1,g.pendingProps=L=Q,_p(h,V))h.flags&131072&&(wa=!0);else return g.lanes=h.lanes,rl(h,g,V)}return ci(h,g,T,L,V)}function Mm(h,g,T){var L=g.pendingProps,V=L.children,Q=(g.stateNode._pendingVisibility&2)!==0,be=h!==null?h.memoizedState:null;if(Gf(h,g),L.mode==="hidden"||Q){if(g.flags&128){if(L=be!==null?be.baseLanes|T:T,h!==null){for(V=g.child=h.child,Q=0;V!==null;)Q=Q|V.lanes|V.childLanes,V=V.sibling;g.childLanes=Q&~L}else g.childLanes=0,g.child=null;return $0(h,g,L,T)}if(T&536870912)g.memoizedState={baseLanes:0,cachePool:null},h!==null&&xh(g,be!==null?be.cachePool:null),be!==null?mh(g,be):tp(),np(g);else return g.lanes=g.childLanes=536870912,$0(h,g,be!==null?be.baseLanes|T:T,T)}else be!==null?(xh(g,be.cachePool),mh(g,be),Fo(),g.memoizedState=null):(h!==null&&xh(g,null),tp(),Fo());return Xi(h,g,V,T),g.child}function $0(h,g,T,L){var V=Rf();return V=V===null?null:{parent:Ri._currentValue,pool:V},g.memoizedState={baseLanes:T,cachePool:V},h!==null&&xh(g,null),tp(),np(g),h!==null&&gs(h,g,L,!0),null}function Gf(h,g){var T=g.ref;if(T===null)h!==null&&h.ref!==null&&(g.flags|=2097664);else{if(typeof T!="function"&&typeof T!="object")throw Error(s(284));(h===null||h.ref!==T)&&(g.flags|=2097664)}}function ci(h,g,T,L,V){return Co(g),T=hs(h,g,T,L,void 0,V),L=zf(),h!==null&&!wa?(Sc(h,g,V),rl(h,g,V)):(Ur&&L&&gu(g),g.flags|=1,Xi(h,g,T,V),g.child)}function Hf(h,g,T,L,V,Q){return Co(g),g.updateQueue=null,T=zl(g,L,T,V),co(h),L=zf(),h!==null&&!wa?(Sc(h,g,Q),rl(h,g,Q)):(Ur&&L&&gu(g),g.flags|=1,Xi(h,g,T,Q),g.child)}function q0(h,g,T,L,V){if(Co(g),g.stateNode===null){var Q=du,be=T.contextType;typeof be=="object"&&be!==null&&(Q=Ka(be)),Q=new T(L,Q),g.memoizedState=Q.state!==null&&Q.state!==void 0?Q.state:null,Q.updater=Oh,g.stateNode=Q,Q._reactInternals=g,Q=g.stateNode,Q.props=L,Q.state=g.memoizedState,Q.refs={},vp(g),be=T.contextType,Q.context=typeof be=="object"&&be!==null?Ka(be):du,Q.state=g.memoizedState,be=T.getDerivedStateFromProps,typeof be=="function"&&(ms(g,T,be,L),Q.state=g.memoizedState),typeof T.getDerivedStateFromProps=="function"||typeof Q.getSnapshotBeforeUpdate=="function"||typeof Q.UNSAFE_componentWillMount!="function"&&typeof Q.componentWillMount!="function"||(be=Q.state,typeof Q.componentWillMount=="function"&&Q.componentWillMount(),typeof Q.UNSAFE_componentWillMount=="function"&&Q.UNSAFE_componentWillMount(),be!==Q.state&&Oh.enqueueReplaceState(Q,Q.state,null),Ha(g,L,Q,V),Ga(),Q.state=g.memoizedState),typeof Q.componentDidMount=="function"&&(g.flags|=4194308),L=!0}else if(h===null){Q=g.stateNode;var Be=g.memoizedProps,rt=Bl(T,Be);Q.props=rt;var Tt=Q.context,en=T.contextType;be=du,typeof en=="object"&&en!==null&&(be=Ka(en));var mn=T.getDerivedStateFromProps;en=typeof mn=="function"||typeof Q.getSnapshotBeforeUpdate=="function",Be=g.pendingProps!==Be,en||typeof Q.UNSAFE_componentWillReceiveProps!="function"&&typeof Q.componentWillReceiveProps!="function"||(Be||Tt!==be)&&hp(g,Q,L,be),Ns=!1;var jt=g.memoizedState;Q.state=jt,Ha(g,L,Q,V),Ga(),Tt=g.memoizedState,Be||jt!==Tt||Ns?(typeof mn=="function"&&(ms(g,T,mn,L),Tt=g.memoizedState),(rt=Ns||Eu(g,T,rt,L,jt,Tt,be))?(en||typeof Q.UNSAFE_componentWillMount!="function"&&typeof Q.componentWillMount!="function"||(typeof Q.componentWillMount=="function"&&Q.componentWillMount(),typeof Q.UNSAFE_componentWillMount=="function"&&Q.UNSAFE_componentWillMount()),typeof Q.componentDidMount=="function"&&(g.flags|=4194308)):(typeof Q.componentDidMount=="function"&&(g.flags|=4194308),g.memoizedProps=L,g.memoizedState=Tt),Q.props=L,Q.state=Tt,Q.context=be,L=rt):(typeof Q.componentDidMount=="function"&&(g.flags|=4194308),L=!1)}else{Q=g.stateNode,La(h,g),be=g.memoizedProps,en=Bl(T,be),Q.props=en,mn=g.pendingProps,jt=Q.context,Tt=T.contextType,rt=du,typeof Tt=="object"&&Tt!==null&&(rt=Ka(Tt)),Be=T.getDerivedStateFromProps,(Tt=typeof Be=="function"||typeof Q.getSnapshotBeforeUpdate=="function")||typeof Q.UNSAFE_componentWillReceiveProps!="function"&&typeof Q.componentWillReceiveProps!="function"||(be!==mn||jt!==rt)&&hp(g,Q,L,rt),Ns=!1,jt=g.memoizedState,Q.state=jt,Ha(g,L,Q,V),Ga();var Qt=g.memoizedState;be!==mn||jt!==Qt||Ns||h!==null&&h.dependencies!==null&&il(h.dependencies)?(typeof Be=="function"&&(ms(g,T,Be,L),Qt=g.memoizedState),(en=Ns||Eu(g,T,en,L,jt,Qt,rt)||h!==null&&h.dependencies!==null&&il(h.dependencies))?(Tt||typeof Q.UNSAFE_componentWillUpdate!="function"&&typeof Q.componentWillUpdate!="function"||(typeof Q.componentWillUpdate=="function"&&Q.componentWillUpdate(L,Qt,rt),typeof Q.UNSAFE_componentWillUpdate=="function"&&Q.UNSAFE_componentWillUpdate(L,Qt,rt)),typeof Q.componentDidUpdate=="function"&&(g.flags|=4),typeof Q.getSnapshotBeforeUpdate=="function"&&(g.flags|=1024)):(typeof Q.componentDidUpdate!="function"||be===h.memoizedProps&&jt===h.memoizedState||(g.flags|=4),typeof Q.getSnapshotBeforeUpdate!="function"||be===h.memoizedProps&&jt===h.memoizedState||(g.flags|=1024),g.memoizedProps=L,g.memoizedState=Qt),Q.props=L,Q.state=Qt,Q.context=rt,L=en):(typeof Q.componentDidUpdate!="function"||be===h.memoizedProps&&jt===h.memoizedState||(g.flags|=4),typeof Q.getSnapshotBeforeUpdate!="function"||be===h.memoizedProps&&jt===h.memoizedState||(g.flags|=1024),L=!1)}return Q=L,Gf(h,g),L=(g.flags&128)!==0,Q||L?(Q=g.stateNode,T=L&&typeof T.getDerivedStateFromError!="function"?null:Q.render(),g.flags|=1,h!==null&&L?(g.child=To(g,h.child,null,V),g.child=To(g,null,T,V)):Xi(h,g,T,V),g.memoizedState=Q.state,h=g.child):h=rl(h,g,V),h}function pp(h,g,T,L){return dh(),g.flags|=256,Xi(h,g,T,L),g.child}var Cu={dehydrated:null,treeContext:null,retryLane:0};function mp(h){return{baseLanes:h,cachePool:Rl()}}function Mu(h,g,T){return h=h!==null?h.childLanes&~T:0,g&&(h|=Nr),h}function Zf(h,g,T){var L=g.pendingProps,V=!1,Q=(g.flags&128)!==0,be;if((be=Q)||(be=h!==null&&h.memoizedState===null?!1:(xa.current&2)!==0),be&&(V=!0,g.flags&=-129),be=(g.flags&32)!==0,g.flags&=-33,h===null){if(Ur){if(V?xc(g):Fo(),Ur){var Be=va,rt;if(rt=Be){e:{for(rt=Be,Be=cs;rt.nodeType!==8;){if(!Be){Be=null;break e}if(rt=Vl(rt.nextSibling),rt===null){Be=null;break e}}Be=rt}Be!==null?(g.memoizedState={dehydrated:Be,treeContext:Ml!==null?{id:Xs,overflow:Ys}:null,retryLane:536870912},rt=St(18,null,null,0),rt.stateNode=Be,rt.return=g,g.child=rt,li=g,va=null,rt=!0):rt=!1}rt||Ks(g)}if(Be=g.memoizedState,Be!==null&&(Be=Be.dehydrated,Be!==null))return Be.data==="$!"?g.lanes=16:g.lanes=536870912,null;Il(g)}return Be=L.children,L=L.fallback,V?(Fo(),V=g.mode,Be=Ou({mode:"hidden",children:Be},V),L=kt(L,V,T,null),Be.return=g,L.return=g,Be.sibling=L,g.child=Be,V=g.child,V.memoizedState=mp(T),V.childLanes=Mu(h,be,T),g.memoizedState=Cu,L):(xc(g),_s(g,Be))}if(rt=h.memoizedState,rt!==null&&(Be=rt.dehydrated,Be!==null)){if(Q)g.flags&256?(xc(g),g.flags&=-257,g=pi(h,g,T)):g.memoizedState!==null?(Fo(),g.child=h.child,g.flags|=128,g=null):(Fo(),V=L.fallback,Be=g.mode,L=Ou({mode:"visible",children:L.children},Be),V=kt(V,Be,T,null),V.flags|=2,L.return=g,V.return=g,L.sibling=V,g.child=L,To(g,h.child,null,T),L=g.child,L.memoizedState=mp(T),L.childLanes=Mu(h,be,T),g.memoizedState=Cu,g=V);else if(xc(g),Be.data==="$!"){if(be=Be.nextSibling&&Be.nextSibling.dataset,be)var Tt=be.dgst;be=Tt,L=Error(s(419)),L.stack="",L.digest=be,ph({value:L,source:null,stack:null}),g=pi(h,g,T)}else if(wa||gs(h,g,T,!1),be=(T&h.childLanes)!==0,wa||be){if(be=In,be!==null){if(L=T&-T,L&42)L=1;else switch(L){case 2:L=1;break;case 8:L=4;break;case 32:L=16;break;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:L=64;break;case 268435456:L=134217728;break;default:L=0}if(L=L&(be.suspendedLanes|T)?0:L,L!==0&&L!==rt.retryLane)throw rt.retryLane=L,Bo(h,L),Zo(be,h,L),Cm}Be.data==="$?"||Jf(),g=pi(h,g,T)}else Be.data==="$?"?(g.flags|=128,g.child=h.child,g=Y0.bind(null,h),Be._reactRetry=g,g=null):(h=rt.treeContext,va=Vl(Be.nextSibling),li=g,Ur=!0,So=null,cs=!1,h!==null&&(bo[wo++]=Xs,bo[wo++]=Ys,bo[wo++]=Ml,Xs=h.id,Ys=h.overflow,Ml=g),g=_s(g,L.children),g.flags|=4096);return g}return V?(Fo(),V=L.fallback,Be=g.mode,rt=h.child,Tt=rt.sibling,L=Gt(rt,{mode:"hidden",children:L.children}),L.subtreeFlags=rt.subtreeFlags&31457280,Tt!==null?V=Gt(Tt,V):(V=kt(V,Be,T,null),V.flags|=2),V.return=g,L.return=g,L.sibling=V,g.child=L,L=V,V=g.child,Be=h.child.memoizedState,Be===null?Be=mp(T):(rt=Be.cachePool,rt!==null?(Tt=Ri._currentValue,rt=rt.parent!==Tt?{parent:Tt,pool:Tt}:rt):rt=Rl(),Be={baseLanes:Be.baseLanes|T,cachePool:rt}),V.memoizedState=Be,V.childLanes=Mu(h,be,T),g.memoizedState=Cu,L):(xc(g),T=h.child,h=T.sibling,T=Gt(T,{mode:"visible",children:L.children}),T.return=g,T.sibling=null,h!==null&&(be=g.deletions,be===null?(g.deletions=[h],g.flags|=16):be.push(h)),g.child=T,g.memoizedState=null,T)}function _s(h,g){return g=Ou({mode:"visible",children:g},h.mode),g.return=h,h.child=g}function Ou(h,g){return Wt(h,g,0,null)}function pi(h,g,T){return To(g,h.child,null,T),h=_s(g,g.pendingProps.children),h.flags|=2,g.memoizedState=null,h}function Uo(h,g,T){h.lanes|=g;var L=h.alternate;L!==null&&(L.lanes|=g),Bs(h.return,g,T)}function Lc(h,g,T,L,V){var Q=h.memoizedState;Q===null?h.memoizedState={isBackwards:g,rendering:null,renderingStartTime:0,last:L,tail:T,tailMode:V}:(Q.isBackwards=g,Q.rendering=null,Q.renderingStartTime=0,Q.last=L,Q.tail=T,Q.tailMode=V)}function Dh(h,g,T){var L=g.pendingProps,V=L.revealOrder,Q=L.tail;if(Xi(h,g,L.children,T),L=xa.current,L&2)L=L&1|2,g.flags|=128;else{if(h!==null&&h.flags&128)e:for(h=g.child;h!==null;){if(h.tag===13)h.memoizedState!==null&&Uo(h,T,g);else if(h.tag===19)Uo(h,T,g);else if(h.child!==null){h.child.return=h,h=h.child;continue}if(h===g)break e;for(;h.sibling===null;){if(h.return===null||h.return===g)break e;h=h.return}h.sibling.return=h.return,h=h.sibling}L&=1}switch(Ne(xa,L),V){case"forwards":for(T=g.child,V=null;T!==null;)h=T.alternate,h!==null&&If(h)===null&&(V=T),T=T.sibling;T=V,T===null?(V=g.child,g.child=null):(V=T.sibling,T.sibling=null),Lc(g,!1,V,T,Q);break;case"backwards":for(T=null,V=g.child,g.child=null;V!==null;){if(h=V.alternate,h!==null&&If(h)===null){g.child=V;break}h=V.sibling,V.sibling=T,T=V,V=h}Lc(g,!0,T,null,Q);break;case"together":Lc(g,!1,null,null,void 0);break;default:g.memoizedState=null}return g.child}function rl(h,g,T){if(h!==null&&(g.dependencies=h.dependencies),Tr|=g.lanes,!(T&g.childLanes))if(h!==null){if(gs(h,g,T,!1),(T&g.childLanes)===0)return null}else return null;if(h!==null&&g.child!==h.child)throw Error(s(153));if(g.child!==null){for(h=g.child,T=Gt(h,h.pendingProps),g.child=T,T.return=g;h.sibling!==null;)h=h.sibling,T=T.sibling=Gt(h,h.pendingProps),T.return=g;T.sibling=null}return g.child}function _p(h,g){return h.lanes&g?!0:(h=h.dependencies,!!(h!==null&&il(h)))}function Wf(h,g,T){switch(g.tag){case 3:Ir(g,g.stateNode.containerInfo),Ao(g,Ri,h.memoizedState.cache),dh();break;case 27:case 5:ki(g);break;case 4:Ir(g,g.stateNode.containerInfo);break;case 10:Ao(g,g.type,g.memoizedProps.value);break;case 13:var L=g.memoizedState;if(L!==null)return L.dehydrated!==null?(xc(g),g.flags|=128,null):T&g.child.childLanes?Zf(h,g,T):(xc(g),h=rl(h,g,T),h!==null?h.sibling:null);xc(g);break;case 19:var V=(h.flags&128)!==0;if(L=(T&g.childLanes)!==0,L||(gs(h,g,T,!1),L=(T&g.childLanes)!==0),V){if(L)return Dh(h,g,T);g.flags|=128}if(V=g.memoizedState,V!==null&&(V.rendering=null,V.tail=null,V.lastEffect=null),Ne(xa,xa.current),L)break;return null;case 22:case 23:return g.lanes=0,Mm(h,g,T);case 24:Ao(g,Ri,h.memoizedState.cache)}return rl(h,g,T)}function gp(h,g,T){if(h!==null)if(h.memoizedProps!==g.pendingProps)wa=!0;else{if(!_p(h,T)&&!(g.flags&128))return wa=!1,Wf(h,g,T);wa=!!(h.flags&131072)}else wa=!1,Ur&&g.flags&1048576&&fh(g,hh,g.index);switch(g.lanes=0,g.tag){case 16:e:{h=g.pendingProps;var L=g.elementType,V=L._init;if(L=V(L._payload),g.type=L,typeof L=="function")mt(L)?(h=Bl(L,h),g.tag=1,g=q0(null,g,L,h,T)):(g.tag=0,g=ci(null,g,L,h,T));else{if(L!=null){if(V=L.$$typeof,V===X){g.tag=11,g=Ph(null,g,L,h,T);break e}else if(V===se){g.tag=14,g=ho(null,g,L,h,T);break e}}throw g=He(L)||L,Error(s(306,g,""))}}return g;case 0:return ci(h,g,g.type,g.pendingProps,T);case 1:return L=g.type,V=Bl(L,g.pendingProps),q0(h,g,L,V,T);case 3:e:{if(Ir(g,g.stateNode.containerInfo),h===null)throw Error(s(387));var Q=g.pendingProps;V=g.memoizedState,L=V.element,La(h,g),Ha(g,Q,null,T);var be=g.memoizedState;if(Q=be.cache,Ao(g,Ri,Q),Q!==V.cache&&Vo(g,[Ri],T,!0),Ga(),Q=be.element,V.isDehydrated)if(V={element:Q,isDehydrated:!1,cache:be.cache},g.updateQueue.baseState=V,g.memoizedState=V,g.flags&256){g=pp(h,g,Q,T);break e}else if(Q!==L){L=No(Error(s(424)),g),ph(L),g=pp(h,g,Q,T);break e}else for(va=Vl(g.stateNode.containerInfo.firstChild),li=g,Ur=!0,So=null,cs=!0,T=ep(g,null,Q,T),g.child=T;T;)T.flags=T.flags&-3|4096,T=T.sibling;else{if(dh(),Q===L){g=rl(h,g,T);break e}Xi(h,g,Q,T)}g=g.child}return g;case 26:return Gf(h,g),h===null?(T=uy(g.type,null,g.pendingProps,null))?g.memoizedState=T:Ur||(T=g.type,h=g.pendingProps,L=id(Dr.current).createElement(T),L[pe]=g,L[we]=h,to(L,T,h),gn(L),g.stateNode=L):g.memoizedState=uy(g.type,h.memoizedProps,g.pendingProps,h.memoizedState),null;case 27:return ki(g),h===null&&Ur&&(L=g.stateNode=ly(g.type,g.pendingProps,Dr.current),li=g,cs=!0,va=Vl(L.firstChild)),L=g.pendingProps.children,h!==null||Ur?Xi(h,g,L,T):g.child=To(g,null,L,T),Gf(h,g),g.child;case 5:return h===null&&Ur&&((V=L=va)&&(L=$w(L,g.type,g.pendingProps,cs),L!==null?(g.stateNode=L,li=g,va=Vl(L.firstChild),cs=!1,V=!0):V=!1),V||Ks(g)),ki(g),V=g.type,Q=g.pendingProps,be=h!==null?h.memoizedProps:null,L=Q.children,Bm(V,Q)?L=null:be!==null&&Bm(V,be)&&(g.flags|=32),g.memoizedState!==null&&(V=hs(h,g,_m,null,null,T),ld._currentValue=V),Gf(h,g),Xi(h,g,L,T),g.child;case 6:return h===null&&Ur&&((h=T=va)&&(T=qw(T,g.pendingProps,cs),T!==null?(g.stateNode=T,li=g,va=null,h=!0):h=!1),h||Ks(g)),null;case 13:return Zf(h,g,T);case 4:return Ir(g,g.stateNode.containerInfo),L=g.pendingProps,h===null?g.child=To(g,null,L,T):Xi(h,g,L,T),g.child;case 11:return Ph(h,g,g.type,g.pendingProps,T);case 7:return Xi(h,g,g.pendingProps,T),g.child;case 8:return Xi(h,g,g.pendingProps.children,T),g.child;case 12:return Xi(h,g,g.pendingProps.children,T),g.child;case 10:return L=g.pendingProps,Ao(g,g.type,L.value),Xi(h,g,L.children,T),g.child;case 9:return V=g.type._context,L=g.pendingProps.children,Co(g),V=Ka(V),L=L(V),g.flags|=1,Xi(h,g,L,T),g.child;case 14:return ho(h,g,g.type,g.pendingProps,T);case 15:return Rh(h,g,g.type,g.pendingProps,T);case 19:return Dh(h,g,T);case 22:return Mm(h,g,T);case 24:return Co(g),L=Ka(Ri),h===null?(V=Rf(),V===null&&(V=In,Q=yh(),V.pooledCache=Q,Q.refCount++,Q!==null&&(V.pooledCacheLanes|=T),V=Q),g.memoizedState={parent:L,cache:V},vp(g),Ao(g,Ri,V)):(h.lanes&T&&(La(h,g),Ha(g,null,null,T),Ga()),V=h.memoizedState,Q=g.memoizedState,V.parent!==L?(V={parent:L,cache:L},g.memoizedState=V,g.lanes===0&&(g.memoizedState=g.updateQueue.baseState=V),Ao(g,Ri,L)):(L=Q.cache,Ao(g,Ri,L),L!==V.cache&&Vo(g,[Ri],T,!0))),Xi(h,g,g.pendingProps.children,T),g.child;case 29:throw g.pendingProps}throw Error(s(156,g.tag))}var Om=ir(null),Nl=null,ks=null;function Ao(h,g,T){Ne(Om,g._currentValue),g._currentValue=T}function fo(h){h._currentValue=Om.current,yn(Om)}function Bs(h,g,T){for(;h!==null;){var L=h.alternate;if((h.childLanes&g)!==g?(h.childLanes|=g,L!==null&&(L.childLanes|=g)):L!==null&&(L.childLanes&g)!==g&&(L.childLanes|=g),h===T)break;h=h.return}}function Vo(h,g,T,L){var V=h.child;for(V!==null&&(V.return=h);V!==null;){var Q=V.dependencies;if(Q!==null){var be=V.child;Q=Q.firstContext;e:for(;Q!==null;){var Be=Q;Q=V;for(var rt=0;rt<g.length;rt++)if(Be.context===g[rt]){Q.lanes|=T,Be=Q.alternate,Be!==null&&(Be.lanes|=T),Bs(Q.return,T,h),L||(be=null);break e}Q=Be.next}}else if(V.tag===18){if(be=V.return,be===null)throw Error(s(341));be.lanes|=T,Q=be.alternate,Q!==null&&(Q.lanes|=T),Bs(be,T,h),be=null}else be=V.child;if(be!==null)be.return=V;else for(be=V;be!==null;){if(be===h){be=null;break}if(V=be.sibling,V!==null){V.return=be.return,be=V;break}be=be.return}V=be}}function gs(h,g,T,L){h=null;for(var V=g,Q=!1;V!==null;){if(!Q){if(V.flags&524288)Q=!0;else if(V.flags&262144)break}if(V.tag===10){var be=V.alternate;if(be===null)throw Error(s(387));if(be=be.memoizedProps,be!==null){var Be=V.type;ya(V.pendingProps.value,be.value)||(h!==null?h.push(Be):h=[Be])}}else if(V===It.current){if(be=V.alternate,be===null)throw Error(s(387));be.memoizedState.memoizedState!==V.memoizedState.memoizedState&&(h!==null?h.push(ld):h=[ld])}V=V.return}h!==null&&Vo(g,h,T,L),g.flags|=262144}function il(h){for(h=h.firstContext;h!==null;){if(!ya(h.context._currentValue,h.memoizedValue))return!0;h=h.next}return!1}function Co(h){Nl=h,ks=null,h=h.dependencies,h!==null&&(h.firstContext=null)}function Ka(h){return G0(Nl,h)}function yp(h,g){return Nl===null&&Co(h),G0(h,g)}function G0(h,g){var T=g._currentValue;if(g={context:g,memoizedValue:T,next:null},ks===null){if(h===null)throw Error(s(308));ks=g,h.dependencies={lanes:0,firstContext:g},h.flags|=524288}else ks=ks.next=g;return T}var Ns=!1;function vp(h){h.updateQueue={baseState:h.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function La(h,g){h=h.updateQueue,g.updateQueue===h&&(g.updateQueue={baseState:h.baseState,firstBaseUpdate:h.firstBaseUpdate,lastBaseUpdate:h.lastBaseUpdate,shared:h.shared,callbacks:null})}function $o(h){return{lane:h,tag:0,payload:null,callback:null,next:null}}function Fl(h,g,T){var L=h.updateQueue;if(L===null)return null;if(L=L.shared,sn&2){var V=L.pending;return V===null?g.next=g:(g.next=V.next,V.next=g),L.pending=g,g=sr(h),_c(h,null,T),g}return hu(h,L,g,T),sr(h)}function Lh(h,g,T){if(g=g.updateQueue,g!==null&&(g=g.shared,(T&4194176)!==0)){var L=g.lanes;L&=h.pendingLanes,T|=L,g.lanes=T,eh(h,T)}}function zc(h,g){var T=h.updateQueue,L=h.alternate;if(L!==null&&(L=L.updateQueue,T===L)){var V=null,Q=null;if(T=T.firstBaseUpdate,T!==null){do{var be={lane:T.lane,tag:T.tag,payload:T.payload,callback:null,next:null};Q===null?V=Q=be:Q=Q.next=be,T=T.next}while(T!==null);Q===null?V=Q=g:Q=Q.next=g}else V=Q=g;T={baseState:L.baseState,firstBaseUpdate:V,lastBaseUpdate:Q,shared:L.shared,callbacks:L.callbacks},h.updateQueue=T;return}h=T.lastBaseUpdate,h===null?T.firstBaseUpdate=g:h.next=g,T.lastBaseUpdate=g}var zh=!1;function Ga(){if(zh){var h=bc;if(h!==null)throw h}}function Ha(h,g,T,L){zh=!1;var V=h.updateQueue;Ns=!1;var Q=V.firstBaseUpdate,be=V.lastBaseUpdate,Be=V.shared.pending;if(Be!==null){V.shared.pending=null;var rt=Be,Tt=rt.next;rt.next=null,be===null?Q=Tt:be.next=Tt,be=rt;var en=h.alternate;en!==null&&(en=en.updateQueue,Be=en.lastBaseUpdate,Be!==be&&(Be===null?en.firstBaseUpdate=Tt:Be.next=Tt,en.lastBaseUpdate=rt))}if(Q!==null){var mn=V.baseState;be=0,en=Tt=rt=null,Be=Q;do{var jt=Be.lane&-536870913,Qt=jt!==Be.lane;if(Qt?(Pn&jt)===jt:(L&jt)===jt){jt!==0&&jt===Qs&&(zh=!0),en!==null&&(en=en.next={lane:0,tag:Be.tag,payload:Be.payload,callback:null,next:null});e:{var Hn=h,Er=Be;jt=g;var Yi=T;switch(Er.tag){case 1:if(Hn=Er.payload,typeof Hn=="function"){mn=Hn.call(Yi,mn,jt);break e}mn=Hn;break e;case 3:Hn.flags=Hn.flags&-65537|128;case 0:if(Hn=Er.payload,jt=typeof Hn=="function"?Hn.call(Yi,mn,jt):Hn,jt==null)break e;mn=ye({},mn,jt);break e;case 2:Ns=!0}}jt=Be.callback,jt!==null&&(h.flags|=64,Qt&&(h.flags|=8192),Qt=V.callbacks,Qt===null?V.callbacks=[jt]:Qt.push(jt))}else Qt={lane:jt,tag:Be.tag,payload:Be.payload,callback:Be.callback,next:null},en===null?(Tt=en=Qt,rt=mn):en=en.next=Qt,be|=jt;if(Be=Be.next,Be===null){if(Be=V.shared.pending,Be===null)break;Qt=Be,Be=Qt.next,Qt.next=null,V.lastBaseUpdate=Qt,V.shared.pending=null}}while(!0);en===null&&(rt=mn),V.baseState=rt,V.firstBaseUpdate=Tt,V.lastBaseUpdate=en,Q===null&&(V.shared.lanes=0),Tr|=be,h.lanes=be,h.memoizedState=mn}}function Iu(h,g){if(typeof h!="function")throw Error(s(191,h));h.call(g)}function kc(h,g){var T=h.callbacks;if(T!==null)for(h.callbacks=null,h=0;h<T.length;h++)Iu(T[h],g)}function Fs(h,g){try{var T=g.updateQueue,L=T!==null?T.lastEffect:null;if(L!==null){var V=L.next;T=V;do{if((T.tag&h)===h){L=void 0;var Q=T.create,be=T.inst;L=Q(),be.destroy=L}T=T.next}while(T!==V)}}catch(Be){Mi(g,g.return,Be)}}function al(h,g,T){try{var L=g.updateQueue,V=L!==null?L.lastEffect:null;if(V!==null){var Q=V.next;L=Q;do{if((L.tag&h)===h){var be=L.inst,Be=be.destroy;if(Be!==void 0){be.destroy=void 0,V=g;var rt=T;try{Be()}catch(Tt){Mi(V,rt,Tt)}}}L=L.next}while(L!==Q)}}catch(Tt){Mi(g,g.return,Tt)}}function pr(h){var g=h.updateQueue;if(g!==null){var T=h.stateNode;try{kc(g,T)}catch(L){Mi(h,h.return,L)}}}function jl(h,g,T){T.props=Bl(h.type,h.memoizedProps),T.state=h.memoizedState;try{T.componentWillUnmount()}catch(L){Mi(h,g,L)}}function Pu(h,g){try{var T=h.ref;if(T!==null){var L=h.stateNode;switch(h.tag){case 26:case 27:case 5:var V=L;break;default:V=L}typeof T=="function"?h.refCleanup=T(V):T.current=V}}catch(Q){Mi(h,g,Q)}}function qo(h,g){var T=h.ref,L=h.refCleanup;if(T!==null)if(typeof L=="function")try{L()}catch(V){Mi(h,g,V)}finally{h.refCleanup=null,h=h.alternate,h!=null&&(h.refCleanup=null)}else if(typeof T=="function")try{T(null)}catch(V){Mi(h,g,V)}else T.current=null}function Xf(h){var g=h.type,T=h.memoizedProps,L=h.stateNode;try{e:switch(g){case"button":case"input":case"select":case"textarea":T.autoFocus&&L.focus();break e;case"img":T.src?L.src=T.src:T.srcSet&&(L.srcset=T.srcSet)}}catch(V){Mi(h,h.return,V)}}function js(h,g,T){try{var L=h.stateNode;J1(L,h.type,T,g),L[we]=g}catch(V){Mi(h,h.return,V)}}function ys(h){return h.tag===5||h.tag===3||h.tag===26||h.tag===27||h.tag===4}function za(h){e:for(;;){for(;h.sibling===null;){if(h.return===null||ys(h.return))return null;h=h.return}for(h.sibling.return=h.return,h=h.sibling;h.tag!==5&&h.tag!==6&&h.tag!==27&&h.tag!==18;){if(h.flags&2||h.child===null||h.tag===4)continue e;h.child.return=h,h=h.child}if(!(h.flags&2))return h.stateNode}}function Ja(h,g,T){var L=h.tag;if(L===5||L===6)h=h.stateNode,g?T.nodeType===8?T.parentNode.insertBefore(h,g):T.insertBefore(h,g):(T.nodeType===8?(g=T.parentNode,g.insertBefore(h,T)):(g=T,g.appendChild(h)),T=T._reactRootContainer,T!=null||g.onclick!==null||(g.onclick=Uc));else if(L!==4&&L!==27&&(h=h.child,h!==null))for(Ja(h,g,T),h=h.sibling;h!==null;)Ja(h,g,T),h=h.sibling}function $i(h,g,T){var L=h.tag;if(L===5||L===6)h=h.stateNode,g?T.insertBefore(h,g):T.appendChild(h);else if(L!==4&&L!==27&&(h=h.child,h!==null))for($i(h,g,T),h=h.sibling;h!==null;)$i(h,g,T),h=h.sibling}var ol=!1,Br=!1,Yf=!1,Ru=typeof WeakSet=="function"?WeakSet:Set,p=null,r=!1;function l(h,g){if(h=h.containerInfo,Ep=qm,h=Hd(h),cm(h)){if("selectionStart"in h)var T={start:h.selectionStart,end:h.selectionEnd};else e:{T=(T=h.ownerDocument)&&T.defaultView||window;var L=T.getSelection&&T.getSelection();if(L&&L.rangeCount!==0){T=L.anchorNode;var V=L.anchorOffset,Q=L.focusNode;L=L.focusOffset;try{T.nodeType,Q.nodeType}catch{T=null;break e}var be=0,Be=-1,rt=-1,Tt=0,en=0,mn=h,jt=null;t:for(;;){for(var Qt;mn!==T||V!==0&&mn.nodeType!==3||(Be=be+V),mn!==Q||L!==0&&mn.nodeType!==3||(rt=be+L),mn.nodeType===3&&(be+=mn.nodeValue.length),(Qt=mn.firstChild)!==null;)jt=mn,mn=Qt;for(;;){if(mn===h)break t;if(jt===T&&++Tt===V&&(Be=be),jt===Q&&++en===L&&(rt=be),(Qt=mn.nextSibling)!==null)break;mn=jt,jt=mn.parentNode}mn=Qt}T=Be===-1||rt===-1?null:{start:Be,end:rt}}else T=null}T=T||{start:0,end:0}}else T=null;for(s_={focusedElem:h,selectionRange:T},qm=!1,p=g;p!==null;)if(g=p,h=g.child,(g.subtreeFlags&1028)!==0&&h!==null)h.return=g,p=h;else for(;p!==null;){switch(g=p,Q=g.alternate,h=g.flags,g.tag){case 0:break;case 11:case 15:break;case 1:if(h&1024&&Q!==null){h=void 0,T=g,V=Q.memoizedProps,Q=Q.memoizedState,L=T.stateNode;try{var Hn=Bl(T.type,V,T.elementType===T.type);h=L.getSnapshotBeforeUpdate(Hn,Q),L.__reactInternalSnapshotBeforeUpdate=h}catch(Er){Mi(T,T.return,Er)}}break;case 3:if(h&1024){if(h=g.stateNode.containerInfo,T=h.nodeType,T===9)Nm(h);else if(T===1)switch(h.nodeName){case"HEAD":case"HTML":case"BODY":Nm(h);break;default:h.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if(h&1024)throw Error(s(163))}if(h=g.sibling,h!==null){h.return=g.return,p=h;break}p=g.return}return Hn=r,r=!1,Hn}function m(h,g,T){var L=T.flags;switch(T.tag){case 0:case 11:case 15:fe(h,T),L&4&&Fs(5,T);break;case 1:if(fe(h,T),L&4)if(h=T.stateNode,g===null)try{h.componentDidMount()}catch(Be){Mi(T,T.return,Be)}else{var V=Bl(T.type,g.memoizedProps);g=g.memoizedState;try{h.componentDidUpdate(V,g,h.__reactInternalSnapshotBeforeUpdate)}catch(Be){Mi(T,T.return,Be)}}L&64&&pr(T),L&512&&Pu(T,T.return);break;case 3:if(fe(h,T),L&64&&(L=T.updateQueue,L!==null)){if(h=null,T.child!==null)switch(T.child.tag){case 27:case 5:h=T.child.stateNode;break;case 1:h=T.child.stateNode}try{kc(L,h)}catch(Be){Mi(T,T.return,Be)}}break;case 26:fe(h,T),L&512&&Pu(T,T.return);break;case 27:case 5:fe(h,T),g===null&&L&4&&Xf(T),L&512&&Pu(T,T.return);break;case 12:fe(h,T);break;case 13:fe(h,T),L&4&&U(h,T);break;case 22:if(V=T.memoizedState!==null||ol,!V){g=g!==null&&g.memoizedState!==null||Br;var Q=ol,be=Br;ol=V,(Br=g)&&!be?Pe(h,T,(T.subtreeFlags&8772)!==0):fe(h,T),ol=Q,Br=be}L&512&&(T.memoizedProps.mode==="manual"?Pu(T,T.return):qo(T,T.return));break;default:fe(h,T)}}function x(h){var g=h.alternate;g!==null&&(h.alternate=null,x(g)),h.child=null,h.deletions=null,h.sibling=null,h.tag===5&&(g=h.stateNode,g!==null&&lt(g)),h.stateNode=null,h.return=null,h.dependencies=null,h.memoizedProps=null,h.memoizedState=null,h.pendingProps=null,h.stateNode=null,h.updateQueue=null}var b=null,A=!1;function R(h,g,T){for(T=T.child;T!==null;)N(h,g,T),T=T.sibling}function N(h,g,T){if(Ca&&typeof Ca.onCommitFiberUnmount=="function")try{Ca.onCommitFiberUnmount(ha,T)}catch{}switch(T.tag){case 26:Br||qo(T,g),R(h,g,T),T.memoizedState?T.memoizedState.count--:T.stateNode&&(T=T.stateNode,T.parentNode.removeChild(T));break;case 27:Br||qo(T,g);var L=b,V=A;for(b=T.stateNode,R(h,g,T),T=T.stateNode,g=T.attributes;g.length;)T.removeAttributeNode(g[0]);lt(T),b=L,A=V;break;case 5:Br||qo(T,g);case 6:V=b;var Q=A;if(b=null,R(h,g,T),b=V,A=Q,b!==null)if(A)try{h=b,L=T.stateNode,h.nodeType===8?h.parentNode.removeChild(L):h.removeChild(L)}catch(be){Mi(T,g,be)}else try{b.removeChild(T.stateNode)}catch(be){Mi(T,g,be)}break;case 18:b!==null&&(A?(g=b,T=T.stateNode,g.nodeType===8?u_(g.parentNode,T):g.nodeType===1&&u_(g,T),Zm(g)):u_(b,T.stateNode));break;case 4:L=b,V=A,b=T.stateNode.containerInfo,A=!0,R(h,g,T),b=L,A=V;break;case 0:case 11:case 14:case 15:Br||al(2,T,g),Br||al(4,T,g),R(h,g,T);break;case 1:Br||(qo(T,g),L=T.stateNode,typeof L.componentWillUnmount=="function"&&jl(T,g,L)),R(h,g,T);break;case 21:R(h,g,T);break;case 22:Br||qo(T,g),Br=(L=Br)||T.memoizedState!==null,R(h,g,T),Br=L;break;default:R(h,g,T)}}function U(h,g){if(g.memoizedState===null&&(h=g.alternate,h!==null&&(h=h.memoizedState,h!==null&&(h=h.dehydrated,h!==null))))try{Zm(h)}catch(T){Mi(g,g.return,T)}}function $(h){switch(h.tag){case 13:case 19:var g=h.stateNode;return g===null&&(g=h.stateNode=new Ru),g;case 22:return h=h.stateNode,g=h._retryCache,g===null&&(g=h._retryCache=new Ru),g;default:throw Error(s(435,h.tag))}}function Z(h,g){var T=$(h);g.forEach(function(L){var V=H1.bind(null,h,L);T.has(L)||(T.add(L),L.then(V,V))})}function W(h,g){var T=g.deletions;if(T!==null)for(var L=0;L<T.length;L++){var V=T[L],Q=h,be=g,Be=be;e:for(;Be!==null;){switch(Be.tag){case 27:case 5:b=Be.stateNode,A=!1;break e;case 3:b=Be.stateNode.containerInfo,A=!0;break e;case 4:b=Be.stateNode.containerInfo,A=!0;break e}Be=Be.return}if(b===null)throw Error(s(160));N(Q,be,V),b=null,A=!1,Q=V.alternate,Q!==null&&(Q.return=null),V.return=null}if(g.subtreeFlags&13878)for(g=g.child;g!==null;)ue(g,h),g=g.sibling}var ee=null;function ue(h,g){var T=h.alternate,L=h.flags;switch(h.tag){case 0:case 11:case 14:case 15:W(g,h),oe(h),L&4&&(al(3,h,h.return),Fs(3,h),al(5,h,h.return));break;case 1:W(g,h),oe(h),L&512&&(Br||T===null||qo(T,T.return)),L&64&&ol&&(h=h.updateQueue,h!==null&&(L=h.callbacks,L!==null&&(T=h.shared.hiddenCallbacks,h.shared.hiddenCallbacks=T===null?L:T.concat(L))));break;case 26:var V=ee;if(W(g,h),oe(h),L&512&&(Br||T===null||qo(T,T.return)),L&4){var Q=T!==null?T.memoizedState:null;if(L=h.memoizedState,T===null)if(L===null)if(h.stateNode===null){e:{L=h.type,T=h.memoizedProps,V=V.ownerDocument||V;t:switch(L){case"title":Q=V.getElementsByTagName("title")[0],(!Q||Q[ct]||Q[pe]||Q.namespaceURI==="http://www.w3.org/2000/svg"||Q.hasAttribute("itemprop"))&&(Q=V.createElement(L),V.head.insertBefore(Q,V.querySelector("head > title"))),to(Q,L,T),Q[pe]=h,gn(Q),L=Q;break e;case"link":var be=fy("link","href",V).get(L+(T.href||""));if(be){for(var Be=0;Be<be.length;Be++)if(Q=be[Be],Q.getAttribute("href")===(T.href==null?null:T.href)&&Q.getAttribute("rel")===(T.rel==null?null:T.rel)&&Q.getAttribute("title")===(T.title==null?null:T.title)&&Q.getAttribute("crossorigin")===(T.crossOrigin==null?null:T.crossOrigin)){be.splice(Be,1);break t}}Q=V.createElement(L),to(Q,L,T),V.head.appendChild(Q);break;case"meta":if(be=fy("meta","content",V).get(L+(T.content||""))){for(Be=0;Be<be.length;Be++)if(Q=be[Be],Q.getAttribute("content")===(T.content==null?null:""+T.content)&&Q.getAttribute("name")===(T.name==null?null:T.name)&&Q.getAttribute("property")===(T.property==null?null:T.property)&&Q.getAttribute("http-equiv")===(T.httpEquiv==null?null:T.httpEquiv)&&Q.getAttribute("charset")===(T.charSet==null?null:T.charSet)){be.splice(Be,1);break t}}Q=V.createElement(L),to(Q,L,T),V.head.appendChild(Q);break;default:throw Error(s(468,L))}Q[pe]=h,gn(Q),L=Q}h.stateNode=L}else l2(V,h.type,h.stateNode);else h.stateNode=s2(V,L,h.memoizedProps);else Q!==L?(Q===null?T.stateNode!==null&&(T=T.stateNode,T.parentNode.removeChild(T)):Q.count--,L===null?l2(V,h.type,h.stateNode):s2(V,L,h.memoizedProps)):L===null&&h.stateNode!==null&&js(h,h.memoizedProps,T.memoizedProps)}break;case 27:if(L&4&&h.alternate===null){V=h.stateNode,Q=h.memoizedProps;try{for(var rt=V.firstChild;rt;){var Tt=rt.nextSibling,en=rt.nodeName;rt[ct]||en==="HEAD"||en==="BODY"||en==="SCRIPT"||en==="STYLE"||en==="LINK"&&rt.rel.toLowerCase()==="stylesheet"||V.removeChild(rt),rt=Tt}for(var mn=h.type,jt=V.attributes;jt.length;)V.removeAttributeNode(jt[0]);to(V,mn,Q),V[pe]=h,V[we]=Q}catch(Hn){Mi(h,h.return,Hn)}}case 5:if(W(g,h),oe(h),L&512&&(Br||T===null||qo(T,T.return)),h.flags&32){V=h.stateNode;try{vl(V,"")}catch(Hn){Mi(h,h.return,Hn)}}L&4&&h.stateNode!=null&&(V=h.memoizedProps,js(h,V,T!==null?T.memoizedProps:V)),L&1024&&(Yf=!0);break;case 6:if(W(g,h),oe(h),L&4){if(h.stateNode===null)throw Error(s(162));L=h.memoizedProps,T=h.stateNode;try{T.nodeValue=L}catch(Hn){Mi(h,h.return,Hn)}}break;case 3:if(Um=null,V=ee,ee=Fh(g.containerInfo),W(g,h),ee=V,oe(h),L&4&&T!==null&&T.memoizedState.isDehydrated)try{Zm(g.containerInfo)}catch(Hn){Mi(h,h.return,Hn)}Yf&&(Yf=!1,de(h));break;case 4:L=ee,ee=Fh(h.stateNode.containerInfo),W(g,h),oe(h),ee=L;break;case 12:W(g,h),oe(h);break;case 13:W(g,h),oe(h),h.child.flags&8192&&h.memoizedState!==null!=(T!==null&&T.memoizedState!==null)&&(Qa=Bn()),L&4&&(L=h.updateQueue,L!==null&&(h.updateQueue=null,Z(h,L)));break;case 22:if(L&512&&(Br||T===null||qo(T,T.return)),rt=h.memoizedState!==null,Tt=T!==null&&T.memoizedState!==null,en=ol,mn=Br,ol=en||rt,Br=mn||Tt,W(g,h),Br=mn,ol=en,oe(h),g=h.stateNode,g._current=h,g._visibility&=-3,g._visibility|=g._pendingVisibility&2,L&8192&&(g._visibility=rt?g._visibility&-2:g._visibility|1,rt&&(g=ol||Br,T===null||Tt||g||Te(h)),h.memoizedProps===null||h.memoizedProps.mode!=="manual"))e:for(T=null,g=h;;){if(g.tag===5||g.tag===26||g.tag===27){if(T===null){Tt=T=g;try{if(V=Tt.stateNode,rt)Q=V.style,typeof Q.setProperty=="function"?Q.setProperty("display","none","important"):Q.display="none";else{be=Tt.stateNode,Be=Tt.memoizedProps.style;var Qt=Be!=null&&Be.hasOwnProperty("display")?Be.display:null;be.style.display=Qt==null||typeof Qt=="boolean"?"":(""+Qt).trim()}}catch(Hn){Mi(Tt,Tt.return,Hn)}}}else if(g.tag===6){if(T===null){Tt=g;try{Tt.stateNode.nodeValue=rt?"":Tt.memoizedProps}catch(Hn){Mi(Tt,Tt.return,Hn)}}}else if((g.tag!==22&&g.tag!==23||g.memoizedState===null||g===h)&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===h)break e;for(;g.sibling===null;){if(g.return===null||g.return===h)break e;T===g&&(T=null),g=g.return}T===g&&(T=null),g.sibling.return=g.return,g=g.sibling}L&4&&(L=h.updateQueue,L!==null&&(T=L.retryQueue,T!==null&&(L.retryQueue=null,Z(h,T))));break;case 19:W(g,h),oe(h),L&4&&(L=h.updateQueue,L!==null&&(h.updateQueue=null,Z(h,L)));break;case 21:break;default:W(g,h),oe(h)}}function oe(h){var g=h.flags;if(g&2){try{if(h.tag!==27){e:{for(var T=h.return;T!==null;){if(ys(T)){var L=T;break e}T=T.return}throw Error(s(160))}switch(L.tag){case 27:var V=L.stateNode,Q=za(h);$i(h,Q,V);break;case 5:var be=L.stateNode;L.flags&32&&(vl(be,""),L.flags&=-33);var Be=za(h);$i(h,Be,be);break;case 3:case 4:var rt=L.stateNode.containerInfo,Tt=za(h);Ja(h,Tt,rt);break;default:throw Error(s(161))}}}catch(en){Mi(h,h.return,en)}h.flags&=-3}g&4096&&(h.flags&=-4097)}function de(h){if(h.subtreeFlags&1024)for(h=h.child;h!==null;){var g=h;de(g),g.tag===5&&g.flags&1024&&g.stateNode.reset(),h=h.sibling}}function fe(h,g){if(g.subtreeFlags&8772)for(g=g.child;g!==null;)m(h,g.alternate,g),g=g.sibling}function Te(h){for(h=h.child;h!==null;){var g=h;switch(g.tag){case 0:case 11:case 14:case 15:al(4,g,g.return),Te(g);break;case 1:qo(g,g.return);var T=g.stateNode;typeof T.componentWillUnmount=="function"&&jl(g,g.return,T),Te(g);break;case 26:case 27:case 5:qo(g,g.return),Te(g);break;case 22:qo(g,g.return),g.memoizedState===null&&Te(g);break;default:Te(g)}h=h.sibling}}function Pe(h,g,T){for(T=T&&(g.subtreeFlags&8772)!==0,g=g.child;g!==null;){var L=g.alternate,V=h,Q=g,be=Q.flags;switch(Q.tag){case 0:case 11:case 15:Pe(V,Q,T),Fs(4,Q);break;case 1:if(Pe(V,Q,T),L=Q,V=L.stateNode,typeof V.componentDidMount=="function")try{V.componentDidMount()}catch(Tt){Mi(L,L.return,Tt)}if(L=Q,V=L.updateQueue,V!==null){var Be=L.stateNode;try{var rt=V.shared.hiddenCallbacks;if(rt!==null)for(V.shared.hiddenCallbacks=null,V=0;V<rt.length;V++)Iu(rt[V],Be)}catch(Tt){Mi(L,L.return,Tt)}}T&&be&64&&pr(Q),Pu(Q,Q.return);break;case 26:case 27:case 5:Pe(V,Q,T),T&&L===null&&be&4&&Xf(Q),Pu(Q,Q.return);break;case 12:Pe(V,Q,T);break;case 13:Pe(V,Q,T),T&&be&4&&U(V,Q);break;case 22:Q.memoizedState===null&&Pe(V,Q,T),Pu(Q,Q.return);break;default:Pe(V,Q,T)}g=g.sibling}}function Oe(h,g){var T=null;h!==null&&h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(T=h.memoizedState.cachePool.pool),h=null,g.memoizedState!==null&&g.memoizedState.cachePool!==null&&(h=g.memoizedState.cachePool.pool),h!==T&&(h!=null&&h.refCount++,T!=null&&Pl(T))}function Fe(h,g){h=null,g.alternate!==null&&(h=g.alternate.memoizedState.cache),g=g.memoizedState.cache,g!==h&&(g.refCount++,h!=null&&Pl(h))}function Re(h,g,T,L){if(g.subtreeFlags&10256)for(g=g.child;g!==null;)ke(h,g,T,L),g=g.sibling}function ke(h,g,T,L){var V=g.flags;switch(g.tag){case 0:case 11:case 15:Re(h,g,T,L),V&2048&&Fs(9,g);break;case 3:Re(h,g,T,L),V&2048&&(h=null,g.alternate!==null&&(h=g.alternate.memoizedState.cache),g=g.memoizedState.cache,g!==h&&(g.refCount++,h!=null&&Pl(h)));break;case 12:if(V&2048){Re(h,g,T,L),h=g.stateNode;try{var Q=g.memoizedProps,be=Q.id,Be=Q.onPostCommit;typeof Be=="function"&&Be(be,g.alternate===null?"mount":"update",h.passiveEffectDuration,-0)}catch(rt){Mi(g,g.return,rt)}}else Re(h,g,T,L);break;case 23:break;case 22:Q=g.stateNode,g.memoizedState!==null?Q._visibility&4?Re(h,g,T,L):$e(h,g):Q._visibility&4?Re(h,g,T,L):(Q._visibility|=4,De(h,g,T,L,(g.subtreeFlags&10256)!==0)),V&2048&&Oe(g.alternate,g);break;case 24:Re(h,g,T,L),V&2048&&Fe(g.alternate,g);break;default:Re(h,g,T,L)}}function De(h,g,T,L,V){for(V=V&&(g.subtreeFlags&10256)!==0,g=g.child;g!==null;){var Q=h,be=g,Be=T,rt=L,Tt=be.flags;switch(be.tag){case 0:case 11:case 15:De(Q,be,Be,rt,V),Fs(8,be);break;case 23:break;case 22:var en=be.stateNode;be.memoizedState!==null?en._visibility&4?De(Q,be,Be,rt,V):$e(Q,be):(en._visibility|=4,De(Q,be,Be,rt,V)),V&&Tt&2048&&Oe(be.alternate,be);break;case 24:De(Q,be,Be,rt,V),V&&Tt&2048&&Fe(be.alternate,be);break;default:De(Q,be,Be,rt,V)}g=g.sibling}}function $e(h,g){if(g.subtreeFlags&10256)for(g=g.child;g!==null;){var T=h,L=g,V=L.flags;switch(L.tag){case 22:$e(T,L),V&2048&&Oe(L.alternate,L);break;case 24:$e(T,L),V&2048&&Fe(L.alternate,L);break;default:$e(T,L)}g=g.sibling}}var Xe=8192;function ft(h){if(h.subtreeFlags&Xe)for(h=h.child;h!==null;)ot(h),h=h.sibling}function ot(h){switch(h.tag){case 26:ft(h),h.flags&Xe&&h.memoizedState!==null&&Yw(ee,h.memoizedState,h.memoizedProps);break;case 5:ft(h);break;case 3:case 4:var g=ee;ee=Fh(h.stateNode.containerInfo),ft(h),ee=g;break;case 22:h.memoizedState===null&&(g=h.alternate,g!==null&&g.memoizedState!==null?(g=Xe,Xe=16777216,ft(h),Xe=g):ft(h));break;default:ft(h)}}function Et(h){var g=h.alternate;if(g!==null&&(h=g.child,h!==null)){g.child=null;do g=h.sibling,h.sibling=null,h=g;while(h!==null)}}function vt(h){var g=h.deletions;if(h.flags&16){if(g!==null)for(var T=0;T<g.length;T++){var L=g[T];p=L,Lt(L,h)}Et(h)}if(h.subtreeFlags&10256)for(h=h.child;h!==null;)nt(h),h=h.sibling}function nt(h){switch(h.tag){case 0:case 11:case 15:vt(h),h.flags&2048&&al(9,h,h.return);break;case 3:vt(h);break;case 12:vt(h);break;case 22:var g=h.stateNode;h.memoizedState!==null&&g._visibility&4&&(h.return===null||h.return.tag!==13)?(g._visibility&=-5,pt(h)):vt(h);break;default:vt(h)}}function pt(h){var g=h.deletions;if(h.flags&16){if(g!==null)for(var T=0;T<g.length;T++){var L=g[T];p=L,Lt(L,h)}Et(h)}for(h=h.child;h!==null;){switch(g=h,g.tag){case 0:case 11:case 15:al(8,g,g.return),pt(g);break;case 22:T=g.stateNode,T._visibility&4&&(T._visibility&=-5,pt(g));break;default:pt(g)}h=h.sibling}}function Lt(h,g){for(;p!==null;){var T=p;switch(T.tag){case 0:case 11:case 15:al(8,T,g);break;case 23:case 22:if(T.memoizedState!==null&&T.memoizedState.cachePool!==null){var L=T.memoizedState.cachePool.pool;L!=null&&L.refCount++}break;case 24:Pl(T.memoizedState.cache)}if(L=T.child,L!==null)L.return=T,p=L;else e:for(T=h;p!==null;){L=p;var V=L.sibling,Q=L.return;if(x(L),L===T){p=null;break e}if(V!==null){V.return=Q,p=V;break e}p=Q}}}function tt(h,g,T,L){this.tag=h,this.key=T,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=g,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=L,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function St(h,g,T,L){return new tt(h,g,T,L)}function mt(h){return h=h.prototype,!(!h||!h.isReactComponent)}function Gt(h,g){var T=h.alternate;return T===null?(T=St(h.tag,g,h.key,h.mode),T.elementType=h.elementType,T.type=h.type,T.stateNode=h.stateNode,T.alternate=h,h.alternate=T):(T.pendingProps=g,T.type=h.type,T.flags=0,T.subtreeFlags=0,T.deletions=null),T.flags=h.flags&31457280,T.childLanes=h.childLanes,T.lanes=h.lanes,T.child=h.child,T.memoizedProps=h.memoizedProps,T.memoizedState=h.memoizedState,T.updateQueue=h.updateQueue,g=h.dependencies,T.dependencies=g===null?null:{lanes:g.lanes,firstContext:g.firstContext},T.sibling=h.sibling,T.index=h.index,T.ref=h.ref,T.refCleanup=h.refCleanup,T}function Pt(h,g){h.flags&=31457282;var T=h.alternate;return T===null?(h.childLanes=0,h.lanes=g,h.child=null,h.subtreeFlags=0,h.memoizedProps=null,h.memoizedState=null,h.updateQueue=null,h.dependencies=null,h.stateNode=null):(h.childLanes=T.childLanes,h.lanes=T.lanes,h.child=T.child,h.subtreeFlags=0,h.deletions=null,h.memoizedProps=T.memoizedProps,h.memoizedState=T.memoizedState,h.updateQueue=T.updateQueue,h.type=T.type,g=T.dependencies,h.dependencies=g===null?null:{lanes:g.lanes,firstContext:g.firstContext}),h}function At(h,g,T,L,V,Q){var be=0;if(L=h,typeof h=="function")mt(h)&&(be=1);else if(typeof h=="string")be=Ww(h,T,Qn.current)?26:h==="html"||h==="head"||h==="body"?27:5;else e:switch(h){case O:return kt(T.children,V,Q,g);case z:be=8,V|=24;break;case j:return h=St(12,T,g,V|2),h.elementType=j,h.lanes=Q,h;case K:return h=St(13,T,g,V),h.elementType=K,h.lanes=Q,h;case ne:return h=St(19,T,g,V),h.elementType=ne,h.lanes=Q,h;case _e:return Wt(T,V,Q,g);default:if(typeof h=="object"&&h!==null)switch(h.$$typeof){case F:case Y:be=10;break e;case G:be=9;break e;case X:be=11;break e;case se:be=14;break e;case ge:be=16,L=null;break e}be=29,T=Error(s(130,h===null?"null":typeof h,"")),L=null}return g=St(be,T,g,V),g.elementType=h,g.type=L,g.lanes=Q,g}function kt(h,g,T,L){return h=St(7,h,L,g),h.lanes=T,h}function Wt(h,g,T,L){h=St(22,h,L,g),h.elementType=_e,h.lanes=T;var V={_visibility:1,_pendingVisibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null,_current:null,detach:function(){var Q=V._current;if(Q===null)throw Error(s(456));if(!(V._pendingVisibility&2)){var be=Bo(Q,2);be!==null&&(V._pendingVisibility|=2,Zo(be,Q,2))}},attach:function(){var Q=V._current;if(Q===null)throw Error(s(456));if(V._pendingVisibility&2){var be=Bo(Q,2);be!==null&&(V._pendingVisibility&=-3,Zo(be,Q,2))}}};return h.stateNode=V,h}function on(h,g,T){return h=St(6,h,null,g),h.lanes=T,h}function dn(h,g,T){return g=St(4,h.children!==null?h.children:[],h.key,g),g.lanes=T,g.stateNode={containerInfo:h.containerInfo,pendingChildren:null,implementation:h.implementation},g}function En(h){h.flags|=4}function Sn(h,g){if(g.type!=="stylesheet"||g.state.loading&4)h.flags&=-16777217;else if(h.flags|=16777216,!c2(g)){if(g=Ya.current,g!==null&&((Pn&4194176)===Pn?us!==null:(Pn&62914560)!==Pn&&!(Pn&536870912)||g!==us))throw Mf=pm,D0;h.flags|=8192}}function bn(h,g){g!==null&&(h.flags|=4),h.flags&16384&&(g=h.tag!==22?lf():536870912,h.lanes|=g,xi|=g)}function Ln(h,g){if(!Ur)switch(h.tailMode){case"hidden":g=h.tail;for(var T=null;g!==null;)g.alternate!==null&&(T=g),g=g.sibling;T===null?h.tail=null:T.sibling=null;break;case"collapsed":T=h.tail;for(var L=null;T!==null;)T.alternate!==null&&(L=T),T=T.sibling;L===null?g||h.tail===null?h.tail=null:h.tail.sibling=null:L.sibling=null}}function zn(h){var g=h.alternate!==null&&h.alternate.child===h.child,T=0,L=0;if(g)for(var V=h.child;V!==null;)T|=V.lanes|V.childLanes,L|=V.subtreeFlags&31457280,L|=V.flags&31457280,V.return=h,V=V.sibling;else for(V=h.child;V!==null;)T|=V.lanes|V.childLanes,L|=V.subtreeFlags,L|=V.flags,V.return=h,V=V.sibling;return h.subtreeFlags|=L,h.childLanes=T,g}function Mr(h,g,T){var L=g.pendingProps;switch(Wd(g),g.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return zn(g),null;case 1:return zn(g),null;case 3:return T=g.stateNode,L=null,h!==null&&(L=h.memoizedState.cache),g.memoizedState.cache!==L&&(g.flags|=2048),fo(Ri),Cr(),T.pendingContext&&(T.context=T.pendingContext,T.pendingContext=null),(h===null||h.child===null)&&(gc(g)?En(g):h===null||h.memoizedState.isDehydrated&&!(g.flags&256)||(g.flags|=1024,So!==null&&(H0(So),So=null))),zn(g),null;case 26:return T=g.memoizedState,h===null?(En(g),T!==null?(zn(g),Sn(g,T)):(zn(g),g.flags&=-16777217)):T?T!==h.memoizedState?(En(g),zn(g),Sn(g,T)):(zn(g),g.flags&=-16777217):(h.memoizedProps!==L&&En(g),zn(g),g.flags&=-16777217),null;case 27:$n(g),T=Dr.current;var V=g.type;if(h!==null&&g.stateNode!=null)h.memoizedProps!==L&&En(g);else{if(!L){if(g.stateNode===null)throw Error(s(166));return zn(g),null}h=Qn.current,gc(g)?Xd(g):(h=ly(V,L,T),g.stateNode=h,En(g))}return zn(g),null;case 5:if($n(g),T=g.type,h!==null&&g.stateNode!=null)h.memoizedProps!==L&&En(g);else{if(!L){if(g.stateNode===null)throw Error(s(166));return zn(g),null}if(h=Qn.current,gc(g))Xd(g);else{switch(V=id(Dr.current),h){case 1:h=V.createElementNS("http://www.w3.org/2000/svg",T);break;case 2:h=V.createElementNS("http://www.w3.org/1998/Math/MathML",T);break;default:switch(T){case"svg":h=V.createElementNS("http://www.w3.org/2000/svg",T);break;case"math":h=V.createElementNS("http://www.w3.org/1998/Math/MathML",T);break;case"script":h=V.createElement("div"),h.innerHTML="<script><\/script>",h=h.removeChild(h.firstChild);break;case"select":h=typeof L.is=="string"?V.createElement("select",{is:L.is}):V.createElement("select"),L.multiple?h.multiple=!0:L.size&&(h.size=L.size);break;default:h=typeof L.is=="string"?V.createElement(T,{is:L.is}):V.createElement(T)}}h[pe]=g,h[we]=L;e:for(V=g.child;V!==null;){if(V.tag===5||V.tag===6)h.appendChild(V.stateNode);else if(V.tag!==4&&V.tag!==27&&V.child!==null){V.child.return=V,V=V.child;continue}if(V===g)break e;for(;V.sibling===null;){if(V.return===null||V.return===g)break e;V=V.return}V.sibling.return=V.return,V=V.sibling}g.stateNode=h;e:switch(to(h,T,L),T){case"button":case"input":case"select":case"textarea":h=!!L.autoFocus;break e;case"img":h=!0;break e;default:h=!1}h&&En(g)}}return zn(g),g.flags&=-16777217,null;case 6:if(h&&g.stateNode!=null)h.memoizedProps!==L&&En(g);else{if(typeof L!="string"&&g.stateNode===null)throw Error(s(166));if(h=Dr.current,gc(g)){if(h=g.stateNode,T=g.memoizedProps,L=null,V=li,V!==null)switch(V.tag){case 27:case 5:L=V.memoizedProps}h[pe]=g,h=!!(h.nodeValue===T||L!==null&&L.suppressHydrationWarning===!0||rd(h.nodeValue,T)),h||Ks(g)}else h=id(h).createTextNode(L),h[pe]=g,g.stateNode=h}return zn(g),null;case 13:if(L=g.memoizedState,h===null||h.memoizedState!==null&&h.memoizedState.dehydrated!==null){if(V=gc(g),L!==null&&L.dehydrated!==null){if(h===null){if(!V)throw Error(s(318));if(V=g.memoizedState,V=V!==null?V.dehydrated:null,!V)throw Error(s(317));V[pe]=g}else dh(),!(g.flags&128)&&(g.memoizedState=null),g.flags|=4;zn(g),V=!1}else So!==null&&(H0(So),So=null),V=!0;if(!V)return g.flags&256?(Il(g),g):(Il(g),null)}if(Il(g),g.flags&128)return g.lanes=T,g;if(T=L!==null,h=h!==null&&h.memoizedState!==null,T){L=g.child,V=null,L.alternate!==null&&L.alternate.memoizedState!==null&&L.alternate.memoizedState.cachePool!==null&&(V=L.alternate.memoizedState.cachePool.pool);var Q=null;L.memoizedState!==null&&L.memoizedState.cachePool!==null&&(Q=L.memoizedState.cachePool.pool),Q!==V&&(L.flags|=2048)}return T!==h&&T&&(g.child.flags|=8192),bn(g,g.updateQueue),zn(g),null;case 4:return Cr(),h===null&&i_(g.stateNode.containerInfo),zn(g),null;case 10:return fo(g.type),zn(g),null;case 19:if(yn(xa),V=g.memoizedState,V===null)return zn(g),null;if(L=(g.flags&128)!==0,Q=V.rendering,Q===null)if(L)Ln(V,!1);else{if(hr!==0||h!==null&&h.flags&128)for(h=g.child;h!==null;){if(Q=If(h),Q!==null){for(g.flags|=128,Ln(V,!1),h=Q.updateQueue,g.updateQueue=h,bn(g,h),g.subtreeFlags=0,h=T,T=g.child;T!==null;)Pt(T,h),T=T.sibling;return Ne(xa,xa.current&1|2),g.child}h=h.sibling}V.tail!==null&&Bn()>ka&&(g.flags|=128,L=!0,Ln(V,!1),g.lanes=4194304)}else{if(!L)if(h=If(Q),h!==null){if(g.flags|=128,L=!0,h=h.updateQueue,g.updateQueue=h,bn(g,h),Ln(V,!0),V.tail===null&&V.tailMode==="hidden"&&!Q.alternate&&!Ur)return zn(g),null}else 2*Bn()-V.renderingStartTime>ka&&T!==536870912&&(g.flags|=128,L=!0,Ln(V,!1),g.lanes=4194304);V.isBackwards?(Q.sibling=g.child,g.child=Q):(h=V.last,h!==null?h.sibling=Q:g.child=Q,V.last=Q)}return V.tail!==null?(g=V.tail,V.rendering=g,V.tail=g.sibling,V.renderingStartTime=Bn(),g.sibling=null,h=xa.current,Ne(xa,L?h&1|2:h&1),g):(zn(g),null);case 22:case 23:return Il(g),_h(),L=g.memoizedState!==null,h!==null?h.memoizedState!==null!==L&&(g.flags|=8192):L&&(g.flags|=8192),L?T&536870912&&!(g.flags&128)&&(zn(g),g.subtreeFlags&6&&(g.flags|=8192)):zn(g),T=g.updateQueue,T!==null&&bn(g,T.retryQueue),T=null,h!==null&&h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(T=h.memoizedState.cachePool.pool),L=null,g.memoizedState!==null&&g.memoizedState.cachePool!==null&&(L=g.memoizedState.cachePool.pool),L!==T&&(g.flags|=2048),h!==null&&yn(hn),null;case 24:return T=null,h!==null&&(T=h.memoizedState.cache),g.memoizedState.cache!==T&&(g.flags|=2048),fo(Ri),zn(g),null;case 25:return null}throw Error(s(156,g.tag))}function ui(h,g){switch(Wd(g),g.tag){case 1:return h=g.flags,h&65536?(g.flags=h&-65537|128,g):null;case 3:return fo(Ri),Cr(),h=g.flags,h&65536&&!(h&128)?(g.flags=h&-65537|128,g):null;case 26:case 27:case 5:return $n(g),null;case 13:if(Il(g),h=g.memoizedState,h!==null&&h.dehydrated!==null){if(g.alternate===null)throw Error(s(340));dh()}return h=g.flags,h&65536?(g.flags=h&-65537|128,g):null;case 19:return yn(xa),null;case 4:return Cr(),null;case 10:return fo(g.type),null;case 22:case 23:return Il(g),_h(),h!==null&&yn(hn),h=g.flags,h&65536?(g.flags=h&-65537|128,g):null;case 24:return fo(Ri),null;case 25:return null;default:return null}}function qr(h,g){switch(Wd(g),g.tag){case 3:fo(Ri),Cr();break;case 26:case 27:case 5:$n(g);break;case 4:Cr();break;case 13:Il(g);break;case 19:yn(xa);break;case 10:fo(g.type);break;case 22:case 23:Il(g),_h(),h!==null&&yn(hn);break;case 24:fo(Ri)}}var Fn={getCacheForType:function(h){var g=Ka(Ri),T=g.data.get(h);return T===void 0&&(T=h(),g.data.set(h,T)),T}},mr=typeof WeakMap=="function"?WeakMap:Map,sn=0,In=null,An=null,Pn=0,or=0,Gr=null,Kr=!1,hi=!1,po=!1,Ci=0,hr=0,Tr=0,Sr=0,cr=0,Nr=0,xi=0,Or=null,bi=null,Mo=!1,Qa=0,ka=1/0,Go=null,Sa=null,eo=!1,Ho=null,Oo=0,Ul=0,Bc=null,Nc=0,Kf=null;function vs(){if(sn&2&&Pn!==0)return Pn&-Pn;if(Ge.T!==null){var h=Qs;return h!==0?h:n_()}return Ts()}function j1(){Nr===0&&(Nr=!(Pn&536870912)||Ur?au():536870912);var h=Ya.current;return h!==null&&(h.flags|=32),Nr}function Zo(h,g,T){(h===In&&or===2||h.cancelPendingCommit!==null)&&(kh(h,0),Fc(h,Pn,Nr,!1)),vi(h,T),(!(sn&2)||h!==In)&&(h===In&&(!(sn&2)&&(Sr|=T),hr===4&&Fc(h,Pn,Nr,!1)),Us(h))}function Xg(h,g,T){if(sn&6)throw Error(s(327));var L=!T&&(g&60)===0&&(g&h.expiredLanes)===0||Zs(h,g),V=L?Pm(h,g):Jg(h,g,!0),Q=L;do{if(V===0){hi&&!L&&Fc(h,g,0,!1);break}else if(V===6)Fc(h,g,0,!Kr);else{if(T=h.current.alternate,Q&&!U1(T)){V=Jg(h,g,!1),Q=!1;continue}if(V===2){if(Q=g,h.errorRecoveryDisabledLanes&Q)var be=0;else be=h.pendingLanes&-536870913,be=be!==0?be:be&536870912?536870912:0;if(be!==0){g=be;e:{var Be=h;V=Or;var rt=Be.current.memoizedState.isDehydrated;if(rt&&(kh(Be,be).flags|=256),be=Jg(Be,be,!1),be!==2){if(po&&!rt){Be.errorRecoveryDisabledLanes|=Q,Sr|=Q,V=4;break e}Q=bi,bi=V,Q!==null&&H0(Q)}V=be}if(Q=!1,V!==2)continue}}if(V===1){kh(h,0),Fc(h,g,0,!0);break}e:{switch(L=h,V){case 0:case 1:throw Error(s(345));case 4:if((g&4194176)===g){Fc(L,g,Nr,!Kr);break e}break;case 2:bi=null;break;case 3:case 5:break;default:throw Error(s(329))}if(L.finishedWork=T,L.finishedLanes=g,(g&62914560)===g&&(Q=Qa+300-Bn(),10<Q)){if(Fc(L,g,Nr,!Kr),gl(L,0)!==0)break e;L.timeoutHandle=ay(Yg.bind(null,L,T,bi,Go,Mo,g,Nr,Sr,xi,Kr,2,-0,0),Q);break e}Yg(L,T,bi,Go,Mo,g,Nr,Sr,xi,Kr,0,-0,0)}}break}while(!0);Us(h)}function H0(h){bi===null?bi=h:bi.push.apply(bi,h)}function Yg(h,g,T,L,V,Q,be,Be,rt,Tt,en,mn,jt){var Qt=g.subtreeFlags;if((Qt&8192||(Qt&16785408)===16785408)&&(Vm={stylesheets:null,count:0,unsuspend:Xw},ot(g),g=Kw(),g!==null)){h.cancelPendingCommit=g(q1.bind(null,h,T,L,V,be,Be,rt,1,mn,jt)),Fc(h,Q,be,!Tt);return}q1(h,T,L,V,be,Be,rt,en,mn,jt)}function U1(h){for(var g=h;;){var T=g.tag;if((T===0||T===11||T===15)&&g.flags&16384&&(T=g.updateQueue,T!==null&&(T=T.stores,T!==null)))for(var L=0;L<T.length;L++){var V=T[L],Q=V.getSnapshot;V=V.value;try{if(!ya(Q(),V))return!1}catch{return!1}}if(T=g.child,g.subtreeFlags&16384&&T!==null)T.return=g,g=T;else{if(g===h)break;for(;g.sibling===null;){if(g.return===null||g.return===h)return!0;g=g.return}g.sibling.return=g.return,g=g.sibling}}return!0}function Fc(h,g,T,L){g&=~cr,g&=~Sr,h.suspendedLanes|=g,h.pingedLanes&=~g,L&&(h.warmLanes|=g),L=h.expirationTimes;for(var V=g;0<V;){var Q=31-fa(V),be=1<<Q;L[Q]=-1,V&=~be}T!==0&&uf(h,T,g)}function Im(){return sn&6?!0:(Dm(0),!1)}function Z0(){if(An!==null){if(or===0)var h=An.return;else h=An,ks=Nl=null,Sh(h),yc=null,vc=0,h=An;for(;h!==null;)qr(h.alternate,h),h=h.return;An=null}}function kh(h,g){h.finishedWork=null,h.finishedLanes=0;var T=h.timeoutHandle;T!==-1&&(h.timeoutHandle=-1,Q1(T)),T=h.cancelPendingCommit,T!==null&&(h.cancelPendingCommit=null,T()),Z0(),In=h,An=T=Gt(h.current,null),Pn=g,or=0,Gr=null,Kr=!1,hi=Zs(h,g),po=!1,xi=Nr=cr=Sr=Tr=hr=0,bi=Or=null,Mo=!1,g&8&&(g|=g&32);var L=h.entangledLanes;if(L!==0)for(h=h.entanglements,L&=g;0<L;){var V=31-fa(L),Q=1<<V;g|=h[V],L&=~Q}return Ci=g,mc(),T}function Du(h,g){Yt=null,Ge.H=ps,g===Js?(g=Jd(),or=3):g===D0?(g=Jd(),or=4):or=g===Cm?8:g!==null&&typeof g=="object"&&typeof g.then=="function"?6:1,Gr=g,An===null&&(hr=1,qf(h,No(g,h.current)))}function Ta(){var h=Ge.H;return Ge.H=ps,h===null?ps:h}function Kg(){var h=Ge.A;return Ge.A=Fn,h}function Jf(){hr=4,Kr||(Pn&4194176)!==Pn&&Ya.current!==null||(hi=!0),!(Tr&134217727)&&!(Sr&134217727)||In===null||Fc(In,Pn,Nr,!1)}function Jg(h,g,T){var L=sn;sn|=2;var V=Ta(),Q=Kg();(In!==h||Pn!==g)&&(Go=null,kh(h,g)),g=!1;var be=hr;e:do try{if(or!==0&&An!==null){var Be=An,rt=Gr;switch(or){case 8:Z0(),be=6;break e;case 3:case 2:case 6:Ya.current===null&&(g=!0);var Tt=or;if(or=0,Gr=null,bp(h,Be,rt,Tt),T&&hi){be=0;break e}break;default:Tt=or,or=0,Gr=null,bp(h,Be,rt,Tt)}}kw(),be=hr;break}catch(en){Du(h,en)}while(!0);return g&&h.shellSuspendCounter++,ks=Nl=null,sn=L,Ge.H=V,Ge.A=Q,An===null&&(In=null,Pn=0,mc()),be}function kw(){for(;An!==null;)Bh(An)}function Pm(h,g){var T=sn;sn|=2;var L=Ta(),V=Kg();In!==h||Pn!==g?(Go=null,ka=Bn()+500,kh(h,g)):hi=Zs(h,g);e:do try{if(or!==0&&An!==null){g=An;var Q=Gr;t:switch(or){case 1:or=0,Gr=null,bp(h,g,Q,1);break;case 2:if(L0(Q)){or=0,Gr=null,xp(g);break}g=function(){or===2&&In===h&&(or=7),Us(h)},Q.then(g,g);break e;case 3:or=7;break e;case 4:or=5;break e;case 7:L0(Q)?(or=0,Gr=null,xp(g)):(or=0,Gr=null,bp(h,g,Q,7));break;case 5:var be=null;switch(An.tag){case 26:be=An.memoizedState;case 5:case 27:var Be=An;if(!be||c2(be)){or=0,Gr=null;var rt=Be.sibling;if(rt!==null)An=rt;else{var Tt=Be.return;Tt!==null?(An=Tt,W0(Tt)):An=null}break t}}or=0,Gr=null,bp(h,g,Q,5);break;case 6:or=0,Gr=null,bp(h,g,Q,6);break;case 8:Z0(),hr=6;break e;default:throw Error(s(462))}}V1();break}catch(en){Du(h,en)}while(!0);return ks=Nl=null,Ge.H=L,Ge.A=V,sn=T,An!==null?0:(In=null,Pn=0,mc(),hr)}function V1(){for(;An!==null&&!ao();)Bh(An)}function Bh(h){var g=gp(h.alternate,h,Ci);h.memoizedProps=h.pendingProps,g===null?W0(h):An=g}function xp(h){var g=h,T=g.alternate;switch(g.tag){case 15:case 0:g=Hf(T,g,g.pendingProps,g.type,void 0,Pn);break;case 11:g=Hf(T,g,g.pendingProps,g.type.render,g.ref,Pn);break;case 5:Sh(g);default:qr(T,g),g=An=Pt(g,Ci),g=gp(T,g,Ci)}h.memoizedProps=h.pendingProps,g===null?W0(h):An=g}function bp(h,g,T,L){ks=Nl=null,Sh(g),yc=null,vc=0;var V=g.return;try{if(V0(h,V,g,T,Pn)){hr=1,qf(h,No(T,h.current)),An=null;return}}catch(Q){if(V!==null)throw An=V,Q;hr=1,qf(h,No(T,h.current)),An=null;return}g.flags&32768?(Ur||L===1?h=!0:hi||Pn&536870912?h=!1:(Kr=h=!0,(L===2||L===3||L===6)&&(L=Ya.current,L!==null&&L.tag===13&&(L.flags|=16384))),$1(g,h)):W0(g)}function W0(h){var g=h;do{if(g.flags&32768){$1(g,Kr);return}h=g.return;var T=Mr(g.alternate,g,Ci);if(T!==null){An=T;return}if(g=g.sibling,g!==null){An=g;return}An=g=h}while(g!==null);hr===0&&(hr=5)}function $1(h,g){do{var T=ui(h.alternate,h);if(T!==null){T.flags&=32767,An=T;return}if(T=h.return,T!==null&&(T.flags|=32768,T.subtreeFlags=0,T.deletions=null),!g&&(h=h.sibling,h!==null)){An=h;return}An=h=T}while(h!==null);hr=6,An=null}function q1(h,g,T,L,V,Q,be,Be,rt,Tt){var en=Ge.T,mn=xn.p;try{xn.p=2,Ge.T=null,Bw(h,g,T,L,mn,V,Q,be,Be,rt,Tt)}finally{Ge.T=en,xn.p=mn}}function Bw(h,g,T,L,V,Q,be,Be){do wp();while(Ho!==null);if(sn&6)throw Error(s(327));var rt=h.finishedWork;if(L=h.finishedLanes,rt===null)return null;if(h.finishedWork=null,h.finishedLanes=0,rt===h.current)throw Error(s(177));h.callbackNode=null,h.callbackPriority=0,h.cancelPendingCommit=null;var Tt=rt.lanes|rt.childLanes;if(Tt|=pc,cf(h,L,Tt,Q,be,Be),h===In&&(An=In=null,Pn=0),!(rt.subtreeFlags&10256)&&!(rt.flags&10256)||eo||(eo=!0,Ul=Tt,Bc=T,K0(ua,function(){return wp(),null})),T=(rt.flags&15990)!==0,rt.subtreeFlags&15990||T?(T=Ge.T,Ge.T=null,Q=xn.p,xn.p=2,be=sn,sn|=4,l(h,rt),ue(rt,h),P0(s_,h.containerInfo),qm=!!Ep,s_=Ep=null,h.current=rt,m(h,rt.alternate,rt),Ss(),sn=be,xn.p=Q,Ge.T=T):h.current=rt,eo?(eo=!1,Ho=h,Oo=L):G1(h,Tt),Tt=h.pendingLanes,Tt===0&&(Sa=null),Ju(rt.stateNode),Us(h),g!==null)for(V=h.onRecoverableError,rt=0;rt<g.length;rt++)Tt=g[rt],V(Tt.value,{componentStack:Tt.stack});return Oo&3&&wp(),Tt=h.pendingLanes,L&4194218&&Tt&42?h===Kf?Nc++:(Nc=0,Kf=h):Nc=0,Dm(0),null}function G1(h,g){(h.pooledCacheLanes&=g)===0&&(g=h.pooledCache,g!=null&&(h.pooledCache=null,Pl(g)))}function wp(){if(Ho!==null){var h=Ho,g=Ul;Ul=0;var T=da(Oo),L=Ge.T,V=xn.p;try{if(xn.p=32>T?32:T,Ge.T=null,Ho===null)var Q=!1;else{T=Bc,Bc=null;var be=Ho,Be=Oo;if(Ho=null,Oo=0,sn&6)throw Error(s(331));var rt=sn;if(sn|=4,nt(be.current),ke(be,be.current,Be,T),sn=rt,Dm(0,!1),Ca&&typeof Ca.onPostCommitFiberRoot=="function")try{Ca.onPostCommitFiberRoot(ha,be)}catch{}Q=!0}return Q}finally{xn.p=V,Ge.T=L,G1(h,g)}}return!1}function X0(h,g,T){g=No(T,g),g=Au(h.stateNode,g,2),h=Fl(h,g,2),h!==null&&(vi(h,2),Us(h))}function Mi(h,g,T){if(h.tag===3)X0(h,h,T);else for(;g!==null;){if(g.tag===3){X0(g,h,T);break}else if(g.tag===1){var L=g.stateNode;if(typeof g.type.getDerivedStateFromError=="function"||typeof L.componentDidCatch=="function"&&(Sa===null||!Sa.has(L))){h=No(T,h),T=Em(2),L=Fl(g,T,2),L!==null&&(Am(T,L,g,h),vi(L,2),Us(L));break}}g=g.return}}function Nh(h,g,T){var L=h.pingCache;if(L===null){L=h.pingCache=new mr;var V=new Set;L.set(g,V)}else V=L.get(g),V===void 0&&(V=new Set,L.set(g,V));V.has(T)||(po=!0,V.add(T),h=Nw.bind(null,h,g,T),g.then(h,h))}function Nw(h,g,T){var L=h.pingCache;L!==null&&L.delete(g),h.pingedLanes|=h.suspendedLanes&T,h.warmLanes&=~T,In===h&&(Pn&T)===T&&(hr===4||hr===3&&(Pn&62914560)===Pn&&300>Bn()-Qa?!(sn&2)&&kh(h,0):cr|=T,xi===Pn&&(xi=0)),Us(h)}function qi(h,g){g===0&&(g=lf()),h=Bo(h,g),h!==null&&(vi(h,g),Us(h))}function Y0(h){var g=h.memoizedState,T=0;g!==null&&(T=g.retryLane),qi(h,T)}function H1(h,g){var T=0;switch(h.tag){case 13:var L=h.stateNode,V=h.memoizedState;V!==null&&(T=V.retryLane);break;case 19:L=h.stateNode;break;case 22:L=h.stateNode._retryCache;break;default:throw Error(s(314))}L!==null&&L.delete(g),qi(h,T)}function K0(h,g){return ca(h,g)}var Qf=null,jc=null,J0=!1,Rm=!1,ed=!1,Lu=0;function Us(h){h!==jc&&h.next===null&&(jc===null?Qf=jc=h:jc=jc.next=h),Rm=!0,J0||(J0=!0,W1(Z1))}function Dm(h,g){if(!ed&&Rm){ed=!0;do for(var T=!1,L=Qf;L!==null;){if(h!==0){var V=L.pendingLanes;if(V===0)var Q=0;else{var be=L.suspendedLanes,Be=L.pingedLanes;Q=(1<<31-fa(42|h)+1)-1,Q&=V&~(be&~Be),Q=Q&201326677?Q&201326677|1:Q?Q|2:0}Q!==0&&(T=!0,t_(L,Q))}else Q=Pn,Q=gl(L,L===In?Q:0),!(Q&3)||Zs(L,Q)||(T=!0,t_(L,Q));L=L.next}while(T);ed=!1}}function Z1(){Rm=J0=!1;var h=0;Lu!==0&&(Vw()&&(h=Lu),Lu=0);for(var g=Bn(),T=null,L=Qf;L!==null;){var V=L.next,Q=Q0(L,g);Q===0?(L.next=null,T===null?Qf=V:T.next=V,V===null&&(jc=T)):(T=L,(h!==0||Q&3)&&(Rm=!0)),L=V}Dm(h)}function Q0(h,g){for(var T=h.suspendedLanes,L=h.pingedLanes,V=h.expirationTimes,Q=h.pendingLanes&-62914561;0<Q;){var be=31-fa(Q),Be=1<<be,rt=V[be];rt===-1?(!(Be&T)||Be&L)&&(V[be]=kd(Be,g)):rt<=g&&(h.expiredLanes|=Be),Q&=~Be}if(g=In,T=Pn,T=gl(h,h===g?T:0),L=h.callbackNode,T===0||h===g&&or===2||h.cancelPendingCommit!==null)return L!==null&&L!==null&&Aa(L),h.callbackNode=null,h.callbackPriority=0;if(!(T&3)||Zs(h,T)){if(g=T&-T,g===h.callbackPriority)return g;switch(L!==null&&Aa(L),da(T)){case 2:case 8:T=ml;break;case 32:T=ua;break;case 268435456:T=nc;break;default:T=ua}return L=e_.bind(null,h),T=ca(T,L),h.callbackPriority=g,h.callbackNode=T,g}return L!==null&&L!==null&&Aa(L),h.callbackPriority=2,h.callbackNode=null,2}function e_(h,g){var T=h.callbackNode;if(wp()&&h.callbackNode!==T)return null;var L=Pn;return L=gl(h,h===In?L:0),L===0?null:(Xg(h,L,g),Q0(h,Bn()),h.callbackNode!=null&&h.callbackNode===T?e_.bind(null,h):null)}function t_(h,g){if(wp())return null;Xg(h,g,!0)}function W1(h){e2(function(){sn&6?ca(Jo,h):h()})}function n_(){return Lu===0&&(Lu=au()),Lu}function Qg(h){return h==null||typeof h=="symbol"||typeof h=="boolean"?null:typeof h=="function"?h:_r(""+h)}function ey(h,g){var T=g.ownerDocument.createElement("input");return T.name=g.name,T.value=g.value,h.id&&T.setAttribute("form",h.id),g.parentNode.insertBefore(T,g),h=new FormData(h),T.parentNode.removeChild(T),h}function ty(h,g,T,L,V){if(g==="submit"&&T&&T.stateNode===V){var Q=Qg((V[we]||null).action),be=L.submitter;be&&(g=(g=be[we]||null)?Qg(g.formAction):be.getAttribute("formAction"),g!==null&&(Q=g,be=null));var Be=new rh("action","action",null,L,V);h.push({event:Be,listeners:[{instance:null,listener:function(){if(L.defaultPrevented){if(Lu!==0){var rt=be?ey(V,be):new FormData(V);ba(T,{pending:!0,data:rt,method:V.method,action:Q},null,rt)}}else typeof Q=="function"&&(Be.preventDefault(),rt=be?ey(V,be):new FormData(V),ba(T,{pending:!0,data:rt,method:V.method,action:Q},Q,rt))},currentTarget:V}]})}}for(var sl=0;sl<ch.length;sl++){var r_=ch[sl],Fw=r_.toLowerCase(),jw=r_[0].toUpperCase()+r_.slice(1);lo(Fw,"on"+jw)}lo(Ef,"onAnimationEnd"),lo(lh,"onAnimationIteration"),lo(Af,"onAnimationStart"),lo("dblclick","onDoubleClick"),lo("focusin","onFocus"),lo("focusout","onBlur"),lo(fc,"onTransitionRun"),lo(Zd,"onTransitionStart"),lo(dm,"onTransitionCancel"),lo(dc,"onTransitionEnd"),er("onMouseEnter",["mouseout","mouseover"]),er("onMouseLeave",["mouseout","mouseover"]),er("onPointerEnter",["pointerout","pointerover"]),er("onPointerLeave",["pointerout","pointerover"]),wn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),wn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),wn("onBeforeInput",["compositionend","keypress","textInput","paste"]),wn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),wn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),wn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Lm="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Uw=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Lm));function X1(h,g){g=(g&4)!==0;for(var T=0;T<h.length;T++){var L=h[T],V=L.event;L=L.listeners;e:{var Q=void 0;if(g)for(var be=L.length-1;0<=be;be--){var Be=L[be],rt=Be.instance,Tt=Be.currentTarget;if(Be=Be.listener,rt!==Q&&V.isPropagationStopped())break e;Q=Be,V.currentTarget=Tt;try{Q(V)}catch(en){Dc(en)}V.currentTarget=null,Q=rt}else for(be=0;be<L.length;be++){if(Be=L[be],rt=Be.instance,Tt=Be.currentTarget,Be=Be.listener,rt!==Q&&V.isPropagationStopped())break e;Q=Be,V.currentTarget=Tt;try{Q(V)}catch(en){Dc(en)}V.currentTarget=null,Q=rt}}}}function Hr(h,g){var T=g[je];T===void 0&&(T=g[je]=new Set);var L=h+"__bubble";T.has(L)||(a_(g,h,2,!1),T.add(L))}function ny(h,g,T){var L=0;g&&(L|=4),a_(T,h,L,g)}var Sp="_reactListening"+Math.random().toString(36).slice(2);function i_(h){if(!h[Sp]){h[Sp]=!0,Cn.forEach(function(T){T!=="selectionchange"&&(Uw.has(T)||ny(T,!1,h),ny(T,!0,h))});var g=h.nodeType===9?h:h.ownerDocument;g===null||g[Sp]||(g[Sp]=!0,ny("selectionchange",!1,g))}}function a_(h,g,T,L){switch(h2(g)){case 2:var V=u2;break;case 8:V=xy;break;default:V=m_}T=V.bind(null,g,T,h),V=void 0,!_n||g!=="touchstart"&&g!=="touchmove"&&g!=="wheel"||(V=!0),L?V!==void 0?h.addEventListener(g,T,{capture:!0,passive:V}):h.addEventListener(g,T,!0):V!==void 0?h.addEventListener(g,T,{passive:V}):h.addEventListener(g,T,!1)}function o_(h,g,T,L,V){var Q=L;if(!(g&1)&&!(g&2)&&L!==null)e:for(;;){if(L===null)return;var be=L.tag;if(be===3||be===4){var Be=L.stateNode.containerInfo;if(Be===V||Be.nodeType===8&&Be.parentNode===V)break;if(be===4)for(be=L.return;be!==null;){var rt=be.tag;if((rt===3||rt===4)&&(rt=be.stateNode.containerInfo,rt===V||rt.nodeType===8&&rt.parentNode===V))return;be=be.return}for(;Be!==null;){if(be=ut(Be),be===null)return;if(rt=be.tag,rt===5||rt===6||rt===26||rt===27){L=Q=be;continue e}Be=Be.parentNode}}L=L.return}pf(function(){var Tt=Q,en=Mn(T),mn=[];e:{var jt=uu.get(h);if(jt!==void 0){var Qt=rh,Hn=h;switch(h){case"keypress":if(ic(T)===0)break e;case"keydown":case"keyup":Qt=so;break;case"focusin":Hn="focus",Qt=ai;break;case"focusout":Hn="blur",Qt=ai;break;case"beforeblur":case"afterblur":Qt=ai;break;case"click":if(T.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Qt=Ms;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Qt=tm;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Qt=vf;break;case Ef:case lh:case Af:Qt=_a;break;case dc:Qt=Hg;break;case"scroll":case"scrollend":Qt=Fd;break;case"wheel":Qt=bf;break;case"copy":case"cut":case"paste":Qt=mf;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Qt=gf;break;case"toggle":case"beforetoggle":Qt=ah}var Er=(g&4)!==0,Yi=!Er&&(h==="scroll"||h==="scrollend"),Mt=Er?jt!==null?jt+"Capture":null:jt;Er=[];for(var xt=Tt,Dt;xt!==null;){var un=xt;if(Dt=un.stateNode,un=un.tag,un!==5&&un!==26&&un!==27||Dt===null||Mt===null||(un=Cs(xt,Mt),un!=null&&Er.push(td(xt,un,Dt))),Yi)break;xt=xt.return}0<Er.length&&(jt=new Qt(jt,Hn,null,T,en),mn.push({event:jt,listeners:Er}))}}if(!(g&7)){e:{if(jt=h==="mouseover"||h==="pointerover",Qt=h==="mouseout"||h==="pointerout",jt&&T!==ff&&(Hn=T.relatedTarget||T.fromElement)&&(ut(Hn)||Hn[ze]))break e;if((Qt||jt)&&(jt=en.window===en?en:(jt=en.ownerDocument)?jt.defaultView||jt.parentWindow:window,Qt?(Hn=T.relatedTarget||T.toElement,Qt=Tt,Hn=Hn?ut(Hn):null,Hn!==null&&(Yi=Ht(Hn),Er=Hn.tag,Hn!==Yi||Er!==5&&Er!==27&&Er!==6)&&(Hn=null)):(Qt=null,Hn=Tt),Qt!==Hn)){if(Er=Ms,un="onMouseLeave",Mt="onMouseEnter",xt="mouse",(h==="pointerout"||h==="pointerover")&&(Er=gf,un="onPointerLeave",Mt="onPointerEnter",xt="pointer"),Yi=Qt==null?jt:Zt(Qt),Dt=Hn==null?jt:Zt(Hn),jt=new Er(un,xt+"leave",Qt,T,en),jt.target=Yi,jt.relatedTarget=Dt,un=null,ut(en)===Tt&&(Er=new Er(Mt,xt+"enter",Hn,T,en),Er.target=Dt,Er.relatedTarget=Yi,un=Er),Yi=un,Qt&&Hn)t:{for(Er=Qt,Mt=Hn,xt=0,Dt=Er;Dt;Dt=nd(Dt))xt++;for(Dt=0,un=Mt;un;un=nd(un))Dt++;for(;0<xt-Dt;)Er=nd(Er),xt--;for(;0<Dt-xt;)Mt=nd(Mt),Dt--;for(;xt--;){if(Er===Mt||Mt!==null&&Er===Mt.alternate)break t;Er=nd(Er),Mt=nd(Mt)}Er=null}else Er=null;Qt!==null&&km(mn,jt,Qt,Er,!1),Hn!==null&&Yi!==null&&km(mn,Yi,Hn,Er,!0)}}e:{if(jt=Tt?Zt(Tt):window,Qt=jt.nodeName&&jt.nodeName.toLowerCase(),Qt==="select"||Qt==="input"&&jt.type==="file")var Un=$d;else if(Dn(jt))if(wf)Un=Al;else{Un=sc;var wr=Tf}else Qt=jt.nodeName,!Qt||Qt.toLowerCase()!=="input"||jt.type!=="checkbox"&&jt.type!=="radio"?Tt&&Nd(Tt.elementType)&&(Un=$d):Un=ga;if(Un&&(Un=Un(h,Tt))){lu(mn,Un,T,en);break e}wr&&wr(h,jt,Tt),h==="focusout"&&Tt&&jt.type==="number"&&Tt.memoizedProps.value!=null&&Es(jt,"number",jt.value)}switch(wr=Tt?Zt(Tt):window,h){case"focusin":(Dn(wr)||wr.contentEditable==="true")&&(cc=wr,hm=Tt,sh=null);break;case"focusout":sh=hm=cc=null;break;case"mousedown":Cl=!0;break;case"contextmenu":case"mouseup":case"dragend":Cl=!1,R0(mn,T,en);break;case"selectionchange":if(um)break;case"keydown":case"keyup":R0(mn,T,en)}var nr;if(Ps)e:{switch(h){case"compositionstart":var fr="onCompositionStart";break e;case"compositionend":fr="onCompositionEnd";break e;case"compositionupdate":fr="onCompositionUpdate";break e}fr=void 0}else ss?O0(h,T)&&(fr="onCompositionEnd"):h==="keydown"&&T.keyCode===229&&(fr="onCompositionStart");fr&&(jd&&T.locale!=="ko"&&(ss||fr!=="onCompositionStart"?fr==="onCompositionEnd"&&ss&&(nr=gr()):(ar=en,pa="value"in ar?ar.value:ar.textContent,ss=!0)),wr=zm(Tt,fr),0<wr.length&&(fr=new ac(fr,h,null,T,en),mn.push({event:fr,listeners:wr}),nr?fr.data=nr:(nr=Ud(T),nr!==null&&(fr.data=nr)))),(nr=Wg?Jn(h,T):Tn(h,T))&&(fr=zm(Tt,"onBeforeInput"),0<fr.length&&(wr=new ac("onBeforeInput","beforeinput",null,T,en),mn.push({event:wr,listeners:fr}),wr.data=nr)),ty(mn,h,Tt,T,en)}X1(mn,g)})}function td(h,g,T){return{instance:h,listener:g,currentTarget:T}}function zm(h,g){for(var T=g+"Capture",L=[];h!==null;){var V=h,Q=V.stateNode;V=V.tag,V!==5&&V!==26&&V!==27||Q===null||(V=Cs(h,T),V!=null&&L.unshift(td(h,V,Q)),V=Cs(h,g),V!=null&&L.push(td(h,V,Q))),h=h.return}return L}function nd(h){if(h===null)return null;do h=h.return;while(h&&h.tag!==5&&h.tag!==27);return h||null}function km(h,g,T,L,V){for(var Q=g._reactName,be=[];T!==null&&T!==L;){var Be=T,rt=Be.alternate,Tt=Be.stateNode;if(Be=Be.tag,rt!==null&&rt===L)break;Be!==5&&Be!==26&&Be!==27||Tt===null||(rt=Tt,V?(Tt=Cs(T,Q),Tt!=null&&be.unshift(td(T,Tt,rt))):V||(Tt=Cs(T,Q),Tt!=null&&be.push(td(T,Tt,rt)))),T=T.return}be.length!==0&&h.push({event:g,listeners:be})}var Y1=/\r\n?/g,K1=/\u0000|\uFFFD/g;function ry(h){return(typeof h=="string"?h:""+h).replace(Y1,`
`).replace(K1,"")}function rd(h,g){return g=ry(g),ry(h)===g}function Uc(){}function mi(h,g,T,L,V,Q){switch(T){case"children":typeof L=="string"?g==="body"||g==="textarea"&&L===""||vl(h,L):(typeof L=="number"||typeof L=="bigint")&&g!=="body"&&vl(h,""+L);break;case"className":Ai(h,"class",L);break;case"tabIndex":Ai(h,"tabindex",L);break;case"dir":case"role":case"viewBox":case"width":case"height":Ai(h,T,L);break;case"style":bl(h,L,Q);break;case"data":if(g!=="object"){Ai(h,"data",L);break}case"src":case"href":if(L===""&&(g!=="a"||T!=="href")){h.removeAttribute(T);break}if(L==null||typeof L=="function"||typeof L=="symbol"||typeof L=="boolean"){h.removeAttribute(T);break}L=_r(""+L),h.setAttribute(T,L);break;case"action":case"formAction":if(typeof L=="function"){h.setAttribute(T,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof Q=="function"&&(T==="formAction"?(g!=="input"&&mi(h,g,"name",V.name,V,null),mi(h,g,"formEncType",V.formEncType,V,null),mi(h,g,"formMethod",V.formMethod,V,null),mi(h,g,"formTarget",V.formTarget,V,null)):(mi(h,g,"encType",V.encType,V,null),mi(h,g,"method",V.method,V,null),mi(h,g,"target",V.target,V,null)));if(L==null||typeof L=="symbol"||typeof L=="boolean"){h.removeAttribute(T);break}L=_r(""+L),h.setAttribute(T,L);break;case"onClick":L!=null&&(h.onclick=Uc);break;case"onScroll":L!=null&&Hr("scroll",h);break;case"onScrollEnd":L!=null&&Hr("scrollend",h);break;case"dangerouslySetInnerHTML":if(L!=null){if(typeof L!="object"||!("__html"in L))throw Error(s(61));if(T=L.__html,T!=null){if(V.children!=null)throw Error(s(60));h.innerHTML=T}}break;case"multiple":h.multiple=L&&typeof L!="function"&&typeof L!="symbol";break;case"muted":h.muted=L&&typeof L!="function"&&typeof L!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(L==null||typeof L=="function"||typeof L=="boolean"||typeof L=="symbol"){h.removeAttribute("xlink:href");break}T=_r(""+L),h.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",T);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":L!=null&&typeof L!="function"&&typeof L!="symbol"?h.setAttribute(T,""+L):h.removeAttribute(T);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":L&&typeof L!="function"&&typeof L!="symbol"?h.setAttribute(T,""):h.removeAttribute(T);break;case"capture":case"download":L===!0?h.setAttribute(T,""):L!==!1&&L!=null&&typeof L!="function"&&typeof L!="symbol"?h.setAttribute(T,L):h.removeAttribute(T);break;case"cols":case"rows":case"size":case"span":L!=null&&typeof L!="function"&&typeof L!="symbol"&&!isNaN(L)&&1<=L?h.setAttribute(T,L):h.removeAttribute(T);break;case"rowSpan":case"start":L==null||typeof L=="function"||typeof L=="symbol"||isNaN(L)?h.removeAttribute(T):h.setAttribute(T,L);break;case"popover":Hr("beforetoggle",h),Hr("toggle",h),zo(h,"popover",L);break;case"xlinkActuate":ii(h,"http://www.w3.org/1999/xlink","xlink:actuate",L);break;case"xlinkArcrole":ii(h,"http://www.w3.org/1999/xlink","xlink:arcrole",L);break;case"xlinkRole":ii(h,"http://www.w3.org/1999/xlink","xlink:role",L);break;case"xlinkShow":ii(h,"http://www.w3.org/1999/xlink","xlink:show",L);break;case"xlinkTitle":ii(h,"http://www.w3.org/1999/xlink","xlink:title",L);break;case"xlinkType":ii(h,"http://www.w3.org/1999/xlink","xlink:type",L);break;case"xmlBase":ii(h,"http://www.w3.org/XML/1998/namespace","xml:base",L);break;case"xmlLang":ii(h,"http://www.w3.org/XML/1998/namespace","xml:lang",L);break;case"xmlSpace":ii(h,"http://www.w3.org/XML/1998/namespace","xml:space",L);break;case"is":zo(h,"is",L);break;case"innerText":case"textContent":break;default:(!(2<T.length)||T[0]!=="o"&&T[0]!=="O"||T[1]!=="n"&&T[1]!=="N")&&(T=em.get(T)||T,zo(h,T,L))}}function Tp(h,g,T,L,V,Q){switch(T){case"style":bl(h,L,Q);break;case"dangerouslySetInnerHTML":if(L!=null){if(typeof L!="object"||!("__html"in L))throw Error(s(61));if(T=L.__html,T!=null){if(V.children!=null)throw Error(s(60));h.innerHTML=T}}break;case"children":typeof L=="string"?vl(h,L):(typeof L=="number"||typeof L=="bigint")&&vl(h,""+L);break;case"onScroll":L!=null&&Hr("scroll",h);break;case"onScrollEnd":L!=null&&Hr("scrollend",h);break;case"onClick":L!=null&&(h.onclick=Uc);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!On.hasOwnProperty(T))e:{if(T[0]==="o"&&T[1]==="n"&&(V=T.endsWith("Capture"),g=T.slice(2,V?T.length-7:void 0),Q=h[we]||null,Q=Q!=null?Q[T]:null,typeof Q=="function"&&h.removeEventListener(g,Q,V),typeof L=="function")){typeof Q!="function"&&Q!==null&&(T in h?h[T]=null:h.hasAttribute(T)&&h.removeAttribute(T)),h.addEventListener(g,L,V);break e}T in h?h[T]=L:L===!0?h.setAttribute(T,""):zo(h,T,L)}}}function to(h,g,T){switch(g){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Hr("error",h),Hr("load",h);var L=!1,V=!1,Q;for(Q in T)if(T.hasOwnProperty(Q)){var be=T[Q];if(be!=null)switch(Q){case"src":L=!0;break;case"srcSet":V=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(s(137,g));default:mi(h,g,Q,be,T,null)}}V&&mi(h,g,"srcSet",T.srcSet,T,null),L&&mi(h,g,"src",T.src,T,null);return;case"input":Hr("invalid",h);var Be=Q=be=V=null,rt=null,Tt=null;for(L in T)if(T.hasOwnProperty(L)){var en=T[L];if(en!=null)switch(L){case"name":V=en;break;case"type":be=en;break;case"checked":rt=en;break;case"defaultChecked":Tt=en;break;case"value":Q=en;break;case"defaultValue":Be=en;break;case"children":case"dangerouslySetInnerHTML":if(en!=null)throw Error(s(137,g));break;default:mi(h,g,L,en,T,null)}}ts(h,Q,Be,rt,Tt,be,V,!1),rc(h);return;case"select":Hr("invalid",h),L=be=Q=null;for(V in T)if(T.hasOwnProperty(V)&&(Be=T[V],Be!=null))switch(V){case"value":Q=Be;break;case"defaultValue":be=Be;break;case"multiple":L=Be;default:mi(h,g,V,Be,T,null)}g=Q,T=be,h.multiple=!!L,g!=null?oo(h,!!L,g,!1):T!=null&&oo(h,!!L,T,!0);return;case"textarea":Hr("invalid",h),Q=V=L=null;for(be in T)if(T.hasOwnProperty(be)&&(Be=T[be],Be!=null))switch(be){case"value":L=Be;break;case"defaultValue":V=Be;break;case"children":Q=Be;break;case"dangerouslySetInnerHTML":if(Be!=null)throw Error(s(91));break;default:mi(h,g,be,Be,T,null)}As(h,L,V,Q),rc(h);return;case"option":for(rt in T)if(T.hasOwnProperty(rt)&&(L=T[rt],L!=null))switch(rt){case"selected":h.selected=L&&typeof L!="function"&&typeof L!="symbol";break;default:mi(h,g,rt,L,T,null)}return;case"dialog":Hr("cancel",h),Hr("close",h);break;case"iframe":case"object":Hr("load",h);break;case"video":case"audio":for(L=0;L<Lm.length;L++)Hr(Lm[L],h);break;case"image":Hr("error",h),Hr("load",h);break;case"details":Hr("toggle",h);break;case"embed":case"source":case"link":Hr("error",h),Hr("load",h);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Tt in T)if(T.hasOwnProperty(Tt)&&(L=T[Tt],L!=null))switch(Tt){case"children":case"dangerouslySetInnerHTML":throw Error(s(137,g));default:mi(h,g,Tt,L,T,null)}return;default:if(Nd(g)){for(en in T)T.hasOwnProperty(en)&&(L=T[en],L!==void 0&&Tp(h,g,en,L,T,void 0));return}}for(Be in T)T.hasOwnProperty(Be)&&(L=T[Be],L!=null&&mi(h,g,Be,L,T,null))}function J1(h,g,T,L){switch(g){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var V=null,Q=null,be=null,Be=null,rt=null,Tt=null,en=null;for(Qt in T){var mn=T[Qt];if(T.hasOwnProperty(Qt)&&mn!=null)switch(Qt){case"checked":break;case"value":break;case"defaultValue":rt=mn;default:L.hasOwnProperty(Qt)||mi(h,g,Qt,null,L,mn)}}for(var jt in L){var Qt=L[jt];if(mn=T[jt],L.hasOwnProperty(jt)&&(Qt!=null||mn!=null))switch(jt){case"type":Q=Qt;break;case"name":V=Qt;break;case"checked":Tt=Qt;break;case"defaultChecked":en=Qt;break;case"value":be=Qt;break;case"defaultValue":Be=Qt;break;case"children":case"dangerouslySetInnerHTML":if(Qt!=null)throw Error(s(137,g));break;default:Qt!==mn&&mi(h,g,jt,Qt,L,mn)}}Ma(h,be,Be,rt,Tt,en,Q,V);return;case"select":Qt=be=Be=jt=null;for(Q in T)if(rt=T[Q],T.hasOwnProperty(Q)&&rt!=null)switch(Q){case"value":break;case"multiple":Qt=rt;default:L.hasOwnProperty(Q)||mi(h,g,Q,null,L,rt)}for(V in L)if(Q=L[V],rt=T[V],L.hasOwnProperty(V)&&(Q!=null||rt!=null))switch(V){case"value":jt=Q;break;case"defaultValue":Be=Q;break;case"multiple":be=Q;default:Q!==rt&&mi(h,g,V,Q,L,rt)}g=Be,T=be,L=Qt,jt!=null?oo(h,!!T,jt,!1):!!L!=!!T&&(g!=null?oo(h,!!T,g,!0):oo(h,!!T,T?[]:"",!1));return;case"textarea":Qt=jt=null;for(Be in T)if(V=T[Be],T.hasOwnProperty(Be)&&V!=null&&!L.hasOwnProperty(Be))switch(Be){case"value":break;case"children":break;default:mi(h,g,Be,null,L,V)}for(be in L)if(V=L[be],Q=T[be],L.hasOwnProperty(be)&&(V!=null||Q!=null))switch(be){case"value":jt=V;break;case"defaultValue":Qt=V;break;case"children":break;case"dangerouslySetInnerHTML":if(V!=null)throw Error(s(91));break;default:V!==Q&&mi(h,g,be,V,L,Q)}ns(h,jt,Qt);return;case"option":for(var Hn in T)if(jt=T[Hn],T.hasOwnProperty(Hn)&&jt!=null&&!L.hasOwnProperty(Hn))switch(Hn){case"selected":h.selected=!1;break;default:mi(h,g,Hn,null,L,jt)}for(rt in L)if(jt=L[rt],Qt=T[rt],L.hasOwnProperty(rt)&&jt!==Qt&&(jt!=null||Qt!=null))switch(rt){case"selected":h.selected=jt&&typeof jt!="function"&&typeof jt!="symbol";break;default:mi(h,g,rt,jt,L,Qt)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Er in T)jt=T[Er],T.hasOwnProperty(Er)&&jt!=null&&!L.hasOwnProperty(Er)&&mi(h,g,Er,null,L,jt);for(Tt in L)if(jt=L[Tt],Qt=T[Tt],L.hasOwnProperty(Tt)&&jt!==Qt&&(jt!=null||Qt!=null))switch(Tt){case"children":case"dangerouslySetInnerHTML":if(jt!=null)throw Error(s(137,g));break;default:mi(h,g,Tt,jt,L,Qt)}return;default:if(Nd(g)){for(var Yi in T)jt=T[Yi],T.hasOwnProperty(Yi)&&jt!==void 0&&!L.hasOwnProperty(Yi)&&Tp(h,g,Yi,void 0,L,jt);for(en in L)jt=L[en],Qt=T[en],!L.hasOwnProperty(en)||jt===Qt||jt===void 0&&Qt===void 0||Tp(h,g,en,jt,L,Qt);return}}for(var Mt in T)jt=T[Mt],T.hasOwnProperty(Mt)&&jt!=null&&!L.hasOwnProperty(Mt)&&mi(h,g,Mt,null,L,jt);for(mn in L)jt=L[mn],Qt=T[mn],!L.hasOwnProperty(mn)||jt===Qt||jt==null&&Qt==null||mi(h,g,mn,jt,L,Qt)}var Ep=null,s_=null;function id(h){return h.nodeType===9?h:h.ownerDocument}function iy(h){switch(h){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function l_(h,g){if(h===0)switch(g){case"svg":return 1;case"math":return 2;default:return 0}return h===1&&g==="foreignObject"?0:h}function Bm(h,g){return h==="textarea"||h==="noscript"||typeof g.children=="string"||typeof g.children=="number"||typeof g.children=="bigint"||typeof g.dangerouslySetInnerHTML=="object"&&g.dangerouslySetInnerHTML!==null&&g.dangerouslySetInnerHTML.__html!=null}var c_=null;function Vw(){var h=window.event;return h&&h.type==="popstate"?h===c_?!1:(c_=h,!0):(c_=null,!1)}var ay=typeof setTimeout=="function"?setTimeout:void 0,Q1=typeof clearTimeout=="function"?clearTimeout:void 0,oy=typeof Promise=="function"?Promise:void 0,e2=typeof queueMicrotask=="function"?queueMicrotask:typeof oy<"u"?function(h){return oy.resolve(null).then(h).catch(sy)}:ay;function sy(h){setTimeout(function(){throw h})}function u_(h,g){var T=g,L=0;do{var V=T.nextSibling;if(h.removeChild(T),V&&V.nodeType===8)if(T=V.data,T==="/$"){if(L===0){h.removeChild(V),Zm(g);return}L--}else T!=="$"&&T!=="$?"&&T!=="$!"||L++;T=V}while(T);Zm(g)}function Nm(h){var g=h.firstChild;for(g&&g.nodeType===10&&(g=g.nextSibling);g;){var T=g;switch(g=g.nextSibling,T.nodeName){case"HTML":case"HEAD":case"BODY":Nm(T),lt(T);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(T.rel.toLowerCase()==="stylesheet")continue}h.removeChild(T)}}function $w(h,g,T,L){for(;h.nodeType===1;){var V=T;if(h.nodeName.toLowerCase()!==g.toLowerCase()){if(!L&&(h.nodeName!=="INPUT"||h.type!=="hidden"))break}else if(L){if(!h[ct])switch(g){case"meta":if(!h.hasAttribute("itemprop"))break;return h;case"link":if(Q=h.getAttribute("rel"),Q==="stylesheet"&&h.hasAttribute("data-precedence"))break;if(Q!==V.rel||h.getAttribute("href")!==(V.href==null?null:V.href)||h.getAttribute("crossorigin")!==(V.crossOrigin==null?null:V.crossOrigin)||h.getAttribute("title")!==(V.title==null?null:V.title))break;return h;case"style":if(h.hasAttribute("data-precedence"))break;return h;case"script":if(Q=h.getAttribute("src"),(Q!==(V.src==null?null:V.src)||h.getAttribute("type")!==(V.type==null?null:V.type)||h.getAttribute("crossorigin")!==(V.crossOrigin==null?null:V.crossOrigin))&&Q&&h.hasAttribute("async")&&!h.hasAttribute("itemprop"))break;return h;default:return h}}else if(g==="input"&&h.type==="hidden"){var Q=V.name==null?null:""+V.name;if(V.type==="hidden"&&h.getAttribute("name")===Q)return h}else return h;if(h=Vl(h.nextSibling),h===null)break}return null}function qw(h,g,T){if(g==="")return null;for(;h.nodeType!==3;)if((h.nodeType!==1||h.nodeName!=="INPUT"||h.type!=="hidden")&&!T||(h=Vl(h.nextSibling),h===null))return null;return h}function Vl(h){for(;h!=null;h=h.nextSibling){var g=h.nodeType;if(g===1||g===3)break;if(g===8){if(g=h.data,g==="$"||g==="$!"||g==="$?"||g==="F!"||g==="F")break;if(g==="/$")return null}}return h}function t2(h){h=h.previousSibling;for(var g=0;h;){if(h.nodeType===8){var T=h.data;if(T==="$"||T==="$!"||T==="$?"){if(g===0)return h;g--}else T==="/$"&&g++}h=h.previousSibling}return null}function ly(h,g,T){switch(g=id(T),h){case"html":if(h=g.documentElement,!h)throw Error(s(452));return h;case"head":if(h=g.head,!h)throw Error(s(453));return h;case"body":if(h=g.body,!h)throw Error(s(454));return h;default:throw Error(s(451))}}var Za=new Map,Ap=new Set;function Fh(h){return typeof h.getRootNode=="function"?h.getRootNode():h.ownerDocument}var ll=xn.d;xn.d={f:Fm,r:n2,D:r2,C:Gw,L:Hw,m:i2,X:a2,S:h_,M:Zw};function Fm(){var h=ll.f(),g=Im();return h||g}function n2(h){var g=Ct(h);g!==null&&g.tag===5&&g.type==="form"?Ch(g):ll.r(h)}var ad=typeof document>"u"?null:document;function cy(h,g,T){var L=ad;if(L&&typeof g=="string"&&g){var V=xo(g);V='link[rel="'+h+'"][href="'+V+'"]',typeof T=="string"&&(V+='[crossorigin="'+T+'"]'),Ap.has(V)||(Ap.add(V),h={rel:h,crossOrigin:T,href:g},L.querySelector(V)===null&&(g=L.createElement("link"),to(g,"link",h),gn(g),L.head.appendChild(g)))}}function r2(h){ll.D(h),cy("dns-prefetch",h,null)}function Gw(h,g){ll.C(h,g),cy("preconnect",h,g)}function Hw(h,g,T){ll.L(h,g,T);var L=ad;if(L&&h&&g){var V='link[rel="preload"][as="'+xo(g)+'"]';g==="image"&&T&&T.imageSrcSet?(V+='[imagesrcset="'+xo(T.imageSrcSet)+'"]',typeof T.imageSizes=="string"&&(V+='[imagesizes="'+xo(T.imageSizes)+'"]')):V+='[href="'+xo(h)+'"]';var Q=V;switch(g){case"style":Q=jh(h);break;case"script":Q=od(h)}Za.has(Q)||(h=ye({rel:"preload",href:g==="image"&&T&&T.imageSrcSet?void 0:h,as:g},T),Za.set(Q,h),L.querySelector(V)!==null||g==="style"&&L.querySelector(Cp(Q))||g==="script"&&L.querySelector(Mp(Q))||(g=L.createElement("link"),to(g,"link",h),gn(g),L.head.appendChild(g)))}}function i2(h,g){ll.m(h,g);var T=ad;if(T&&h){var L=g&&typeof g.as=="string"?g.as:"script",V='link[rel="modulepreload"][as="'+xo(L)+'"][href="'+xo(h)+'"]',Q=V;switch(L){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":Q=od(h)}if(!Za.has(Q)&&(h=ye({rel:"modulepreload",href:h},g),Za.set(Q,h),T.querySelector(V)===null)){switch(L){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(T.querySelector(Mp(Q)))return}L=T.createElement("link"),to(L,"link",h),gn(L),T.head.appendChild(L)}}}function h_(h,g,T){ll.S(h,g,T);var L=ad;if(L&&h){var V=Xt(L).hoistableStyles,Q=jh(h);g=g||"default";var be=V.get(Q);if(!be){var Be={loading:0,preload:null};if(be=L.querySelector(Cp(Q)))Be.loading=5;else{h=ye({rel:"stylesheet",href:h,"data-precedence":g},T),(T=Za.get(Q))&&f_(h,T);var rt=be=L.createElement("link");gn(rt),to(rt,"link",h),rt._p=new Promise(function(Tt,en){rt.onload=Tt,rt.onerror=en}),rt.addEventListener("load",function(){Be.loading|=1}),rt.addEventListener("error",function(){Be.loading|=2}),Be.loading|=4,jm(be,g,L)}be={type:"stylesheet",instance:be,count:1,state:Be},V.set(Q,be)}}}function a2(h,g){ll.X(h,g);var T=ad;if(T&&h){var L=Xt(T).hoistableScripts,V=od(h),Q=L.get(V);Q||(Q=T.querySelector(Mp(V)),Q||(h=ye({src:h,async:!0},g),(g=Za.get(V))&&sd(h,g),Q=T.createElement("script"),gn(Q),to(Q,"link",h),T.head.appendChild(Q)),Q={type:"script",instance:Q,count:1,state:null},L.set(V,Q))}}function Zw(h,g){ll.M(h,g);var T=ad;if(T&&h){var L=Xt(T).hoistableScripts,V=od(h),Q=L.get(V);Q||(Q=T.querySelector(Mp(V)),Q||(h=ye({src:h,async:!0,type:"module"},g),(g=Za.get(V))&&sd(h,g),Q=T.createElement("script"),gn(Q),to(Q,"link",h),T.head.appendChild(Q)),Q={type:"script",instance:Q,count:1,state:null},L.set(V,Q))}}function uy(h,g,T,L){var V=(V=Dr.current)?Fh(V):null;if(!V)throw Error(s(446));switch(h){case"meta":case"title":return null;case"style":return typeof T.precedence=="string"&&typeof T.href=="string"?(g=jh(T.href),T=Xt(V).hoistableStyles,L=T.get(g),L||(L={type:"style",instance:null,count:0,state:null},T.set(g,L)),L):{type:"void",instance:null,count:0,state:null};case"link":if(T.rel==="stylesheet"&&typeof T.href=="string"&&typeof T.precedence=="string"){h=jh(T.href);var Q=Xt(V).hoistableStyles,be=Q.get(h);if(be||(V=V.ownerDocument||V,be={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},Q.set(h,be),(Q=V.querySelector(Cp(h)))&&!Q._p&&(be.instance=Q,be.state.loading=5),Za.has(h)||(T={rel:"preload",as:"style",href:T.href,crossOrigin:T.crossOrigin,integrity:T.integrity,media:T.media,hrefLang:T.hrefLang,referrerPolicy:T.referrerPolicy},Za.set(h,T),Q||o2(V,h,T,be.state))),g&&L===null)throw Error(s(528,""));return be}if(g&&L!==null)throw Error(s(529,""));return null;case"script":return g=T.async,T=T.src,typeof T=="string"&&g&&typeof g!="function"&&typeof g!="symbol"?(g=od(T),T=Xt(V).hoistableScripts,L=T.get(g),L||(L={type:"script",instance:null,count:0,state:null},T.set(g,L)),L):{type:"void",instance:null,count:0,state:null};default:throw Error(s(444,h))}}function jh(h){return'href="'+xo(h)+'"'}function Cp(h){return'link[rel="stylesheet"]['+h+"]"}function hy(h){return ye({},h,{"data-precedence":h.precedence,precedence:null})}function o2(h,g,T,L){h.querySelector('link[rel="preload"][as="style"]['+g+"]")?L.loading=1:(g=h.createElement("link"),L.preload=g,g.addEventListener("load",function(){return L.loading|=1}),g.addEventListener("error",function(){return L.loading|=2}),to(g,"link",T),gn(g),h.head.appendChild(g))}function od(h){return'[src="'+xo(h)+'"]'}function Mp(h){return"script[async]"+h}function s2(h,g,T){if(g.count++,g.instance===null)switch(g.type){case"style":var L=h.querySelector('style[data-href~="'+xo(T.href)+'"]');if(L)return g.instance=L,gn(L),L;var V=ye({},T,{"data-href":T.href,"data-precedence":T.precedence,href:null,precedence:null});return L=(h.ownerDocument||h).createElement("style"),gn(L),to(L,"style",V),jm(L,T.precedence,h),g.instance=L;case"stylesheet":V=jh(T.href);var Q=h.querySelector(Cp(V));if(Q)return g.state.loading|=4,g.instance=Q,gn(Q),Q;L=hy(T),(V=Za.get(V))&&f_(L,V),Q=(h.ownerDocument||h).createElement("link"),gn(Q);var be=Q;return be._p=new Promise(function(Be,rt){be.onload=Be,be.onerror=rt}),to(Q,"link",L),g.state.loading|=4,jm(Q,T.precedence,h),g.instance=Q;case"script":return Q=od(T.src),(V=h.querySelector(Mp(Q)))?(g.instance=V,gn(V),V):(L=T,(V=Za.get(Q))&&(L=ye({},T),sd(L,V)),h=h.ownerDocument||h,V=h.createElement("script"),gn(V),to(V,"link",L),h.head.appendChild(V),g.instance=V);case"void":return null;default:throw Error(s(443,g.type))}else g.type==="stylesheet"&&!(g.state.loading&4)&&(L=g.instance,g.state.loading|=4,jm(L,T.precedence,h));return g.instance}function jm(h,g,T){for(var L=T.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),V=L.length?L[L.length-1]:null,Q=V,be=0;be<L.length;be++){var Be=L[be];if(Be.dataset.precedence===g)Q=Be;else if(Q!==V)break}Q?Q.parentNode.insertBefore(h,Q.nextSibling):(g=T.nodeType===9?T.head:T,g.insertBefore(h,g.firstChild))}function f_(h,g){h.crossOrigin==null&&(h.crossOrigin=g.crossOrigin),h.referrerPolicy==null&&(h.referrerPolicy=g.referrerPolicy),h.title==null&&(h.title=g.title)}function sd(h,g){h.crossOrigin==null&&(h.crossOrigin=g.crossOrigin),h.referrerPolicy==null&&(h.referrerPolicy=g.referrerPolicy),h.integrity==null&&(h.integrity=g.integrity)}var Um=null;function fy(h,g,T){if(Um===null){var L=new Map,V=Um=new Map;V.set(T,L)}else V=Um,L=V.get(T),L||(L=new Map,V.set(T,L));if(L.has(h))return L;for(L.set(h,null),T=T.getElementsByTagName(h),V=0;V<T.length;V++){var Q=T[V];if(!(Q[ct]||Q[pe]||h==="link"&&Q.getAttribute("rel")==="stylesheet")&&Q.namespaceURI!=="http://www.w3.org/2000/svg"){var be=Q.getAttribute(g)||"";be=h+be;var Be=L.get(be);Be?Be.push(Q):L.set(be,[Q])}}return L}function l2(h,g,T){h=h.ownerDocument||h,h.head.insertBefore(T,g==="title"?h.querySelector("head > title"):null)}function Ww(h,g,T){if(T===1||g.itemProp!=null)return!1;switch(h){case"meta":case"title":return!0;case"style":if(typeof g.precedence!="string"||typeof g.href!="string"||g.href==="")break;return!0;case"link":if(typeof g.rel!="string"||typeof g.href!="string"||g.href===""||g.onLoad||g.onError)break;switch(g.rel){case"stylesheet":return h=g.disabled,typeof g.precedence=="string"&&h==null;default:return!0}case"script":if(g.async&&typeof g.async!="function"&&typeof g.async!="symbol"&&!g.onLoad&&!g.onError&&g.src&&typeof g.src=="string")return!0}return!1}function c2(h){return!(h.type==="stylesheet"&&!(h.state.loading&3))}var Vm=null;function Xw(){}function Yw(h,g,T){if(Vm===null)throw Error(s(475));var L=Vm;if(g.type==="stylesheet"&&(typeof T.media!="string"||matchMedia(T.media).matches!==!1)&&!(g.state.loading&4)){if(g.instance===null){var V=jh(T.href),Q=h.querySelector(Cp(V));if(Q){h=Q._p,h!==null&&typeof h=="object"&&typeof h.then=="function"&&(L.count++,L=$m.bind(L),h.then(L,L)),g.state.loading|=4,g.instance=Q,gn(Q);return}Q=h.ownerDocument||h,T=hy(T),(V=Za.get(V))&&f_(T,V),Q=Q.createElement("link"),gn(Q);var be=Q;be._p=new Promise(function(Be,rt){be.onload=Be,be.onerror=rt}),to(Q,"link",T),g.instance=Q}L.stylesheets===null&&(L.stylesheets=new Map),L.stylesheets.set(g,h),(h=g.state.preload)&&!(g.state.loading&3)&&(L.count++,g=$m.bind(L),h.addEventListener("load",g),h.addEventListener("error",g))}}function Kw(){if(Vm===null)throw Error(s(475));var h=Vm;return h.stylesheets&&h.count===0&&dy(h,h.stylesheets),0<h.count?function(g){var T=setTimeout(function(){if(h.stylesheets&&dy(h,h.stylesheets),h.unsuspend){var L=h.unsuspend;h.unsuspend=null,L()}},6e4);return h.unsuspend=g,function(){h.unsuspend=null,clearTimeout(T)}}:null}function $m(){if(this.count--,this.count===0){if(this.stylesheets)dy(this,this.stylesheets);else if(this.unsuspend){var h=this.unsuspend;this.unsuspend=null,h()}}}var d_=null;function dy(h,g){h.stylesheets=null,h.unsuspend!==null&&(h.count++,d_=new Map,g.forEach(Jw,h),d_=null,$m.call(h))}function Jw(h,g){if(!(g.state.loading&4)){var T=d_.get(h);if(T)var L=T.get(null);else{T=new Map,d_.set(h,T);for(var V=h.querySelectorAll("link[data-precedence],style[data-precedence]"),Q=0;Q<V.length;Q++){var be=V[Q];(be.nodeName==="LINK"||be.getAttribute("media")!=="not all")&&(T.set(be.dataset.precedence,be),L=be)}L&&T.set(null,L)}V=g.instance,be=V.getAttribute("data-precedence"),Q=T.get(be)||L,Q===L&&T.set(null,V),T.set(be,V),this.count++,L=$m.bind(this),V.addEventListener("load",L),V.addEventListener("error",L),Q?Q.parentNode.insertBefore(V,Q.nextSibling):(h=h.nodeType===9?h.head:h,h.insertBefore(V,h.firstChild)),g.state.loading|=4}}var ld={$$typeof:Y,Provider:null,Consumer:null,_currentValue:rr,_currentValue2:rr,_threadCount:0};function py(h,g,T,L,V,Q,be,Be){this.tag=1,this.containerInfo=h,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Qu(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.finishedLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Qu(0),this.hiddenUpdates=Qu(null),this.identifierPrefix=L,this.onUncaughtError=V,this.onCaughtError=Q,this.onRecoverableError=be,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Be,this.incompleteTransitions=new Map}function my(h,g,T,L,V,Q,be,Be,rt,Tt,en,mn){return h=new py(h,g,T,be,Be,rt,Tt,mn),g=1,Q===!0&&(g|=24),Q=St(3,null,null,g),h.current=Q,Q.stateNode=h,g=yh(),g.refCount++,h.pooledCache=g,g.refCount++,Q.memoizedState={element:L,isDehydrated:T,cache:g},vp(Q),h}function _y(h){return h?(h=du,h):du}function gy(h,g,T,L,V,Q){V=_y(V),L.context===null?L.context=V:L.pendingContext=V,L=$o(g),L.payload={element:T},Q=Q===void 0?null:Q,Q!==null&&(L.callback=Q),T=Fl(h,L,g),T!==null&&(Zo(T,h,g),Lh(T,h,g))}function yy(h,g){if(h=h.memoizedState,h!==null&&h.dehydrated!==null){var T=h.retryLane;h.retryLane=T!==0&&T<g?T:g}}function p_(h,g){yy(h,g),(h=h.alternate)&&yy(h,g)}function vy(h){if(h.tag===13){var g=Bo(h,67108864);g!==null&&Zo(g,h,67108864),p_(h,67108864)}}var qm=!0;function u2(h,g,T,L){var V=Ge.T;Ge.T=null;var Q=xn.p;try{xn.p=2,m_(h,g,T,L)}finally{xn.p=Q,Ge.T=V}}function xy(h,g,T,L){var V=Ge.T;Ge.T=null;var Q=xn.p;try{xn.p=8,m_(h,g,T,L)}finally{xn.p=Q,Ge.T=V}}function m_(h,g,T,L){if(qm){var V=by(L);if(V===null)o_(h,g,L,Uh,T),Ba(h,L);else if(Sy(V,h,g,T,L))L.stopPropagation();else if(Ba(h,L),g&4&&-1<Qw.indexOf(h)){for(;V!==null;){var Q=Ct(V);if(Q!==null)switch(Q.tag){case 3:if(Q=Q.stateNode,Q.current.memoizedState.isDehydrated){var be=es(Q.pendingLanes);if(be!==0){var Be=Q;for(Be.pendingLanes|=2,Be.entangledLanes|=2;be;){var rt=1<<31-fa(be);Be.entanglements[1]|=rt,be&=~rt}Us(Q),!(sn&6)&&(ka=Bn()+500,Dm(0))}}break;case 13:Be=Bo(Q,2),Be!==null&&Zo(Be,Q,2),Im(),p_(Q,2)}if(Q=by(L),Q===null&&o_(h,g,L,Uh,T),Q===V)break;V=Q}V!==null&&L.stopPropagation()}else o_(h,g,L,null,T)}}function by(h){return h=Mn(h),__(h)}var Uh=null;function __(h){if(Uh=null,h=ut(h),h!==null){var g=Ht(h);if(g===null)h=null;else{var T=g.tag;if(T===13){if(h=Bt(g),h!==null)return h;h=null}else if(T===3){if(g.stateNode.current.memoizedState.isDehydrated)return g.tag===3?g.stateNode.containerInfo:null;h=null}else g!==h&&(h=null)}}return Uh=h,null}function h2(h){switch(h){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Lo()){case Jo:return 2;case ml:return 8;case ua:case _l:return 32;case nc:return 268435456;default:return 32}default:return 32}}var wy=!1,Vh=null,$h=null,qh=null,Gm=new Map,Hm=new Map,zu=[],Qw="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Ba(h,g){switch(h){case"focusin":case"focusout":Vh=null;break;case"dragenter":case"dragleave":$h=null;break;case"mouseover":case"mouseout":qh=null;break;case"pointerover":case"pointerout":Gm.delete(g.pointerId);break;case"gotpointercapture":case"lostpointercapture":Hm.delete(g.pointerId)}}function Wo(h,g,T,L,V,Q){return h===null||h.nativeEvent!==Q?(h={blockedOn:g,domEventName:T,eventSystemFlags:L,nativeEvent:Q,targetContainers:[V]},g!==null&&(g=Ct(g),g!==null&&vy(g)),h):(h.eventSystemFlags|=L,g=h.targetContainers,V!==null&&g.indexOf(V)===-1&&g.push(V),h)}function Sy(h,g,T,L,V){switch(g){case"focusin":return Vh=Wo(Vh,h,g,T,L,V),!0;case"dragenter":return $h=Wo($h,h,g,T,L,V),!0;case"mouseover":return qh=Wo(qh,h,g,T,L,V),!0;case"pointerover":var Q=V.pointerId;return Gm.set(Q,Wo(Gm.get(Q)||null,h,g,T,L,V)),!0;case"gotpointercapture":return Q=V.pointerId,Hm.set(Q,Wo(Hm.get(Q)||null,h,g,T,L,V)),!0}return!1}function g_(h){var g=ut(h.target);if(g!==null){var T=Ht(g);if(T!==null){if(g=T.tag,g===13){if(g=Bt(T),g!==null){h.blockedOn=g,dt(h.priority,function(){if(T.tag===13){var L=vs(),V=Bo(T,L);V!==null&&Zo(V,T,L),p_(T,L)}});return}}else if(g===3&&T.stateNode.current.memoizedState.isDehydrated){h.blockedOn=T.tag===3?T.stateNode.containerInfo:null;return}}}h.blockedOn=null}function cd(h){if(h.blockedOn!==null)return!1;for(var g=h.targetContainers;0<g.length;){var T=by(h.nativeEvent);if(T===null){T=h.nativeEvent;var L=new T.constructor(T.type,T);ff=L,T.target.dispatchEvent(L),ff=null}else return g=Ct(T),g!==null&&vy(g),h.blockedOn=T,!1;g.shift()}return!0}function ud(h,g,T){cd(h)&&T.delete(g)}function eS(){wy=!1,Vh!==null&&cd(Vh)&&(Vh=null),$h!==null&&cd($h)&&($h=null),qh!==null&&cd(qh)&&(qh=null),Gm.forEach(ud),Hm.forEach(ud)}function y_(h,g){h.blockedOn===g&&(h.blockedOn=null,wy||(wy=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,eS)))}var Gh=null;function f2(h){Gh!==h&&(Gh=h,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){Gh===h&&(Gh=null);for(var g=0;g<h.length;g+=3){var T=h[g],L=h[g+1],V=h[g+2];if(typeof L!="function"){if(__(L||T)===null)continue;break}var Q=Ct(T);Q!==null&&(h.splice(g,3),g-=3,ba(Q,{pending:!0,data:V,method:T.method,action:L},L,V))}}))}function Zm(h){function g(rt){return y_(rt,h)}Vh!==null&&y_(Vh,h),$h!==null&&y_($h,h),qh!==null&&y_(qh,h),Gm.forEach(g),Hm.forEach(g);for(var T=0;T<zu.length;T++){var L=zu[T];L.blockedOn===h&&(L.blockedOn=null)}for(;0<zu.length&&(T=zu[0],T.blockedOn===null);)g_(T),T.blockedOn===null&&zu.shift();if(T=(h.ownerDocument||h).$$reactFormReplay,T!=null)for(L=0;L<T.length;L+=3){var V=T[L],Q=T[L+1],be=V[we]||null;if(typeof Q=="function")be||f2(T);else if(be){var Be=null;if(Q&&Q.hasAttribute("formAction")){if(V=Q,be=Q[we]||null)Be=be.formAction;else if(__(V)!==null)continue}else Be=be.action;typeof Be=="function"?T[L+1]=Be:(T.splice(L,3),L-=3),f2(T)}}}function v_(h){this._internalRoot=h}Op.prototype.render=v_.prototype.render=function(h){var g=this._internalRoot;if(g===null)throw Error(s(409));var T=g.current,L=vs();gy(T,L,h,g,null,null)},Op.prototype.unmount=v_.prototype.unmount=function(){var h=this._internalRoot;if(h!==null){this._internalRoot=null;var g=h.containerInfo;h.tag===0&&wp(),gy(h.current,2,null,h,null,null),Im(),g[ze]=null}};function Op(h){this._internalRoot=h}Op.prototype.unstable_scheduleHydration=function(h){if(h){var g=Ts();h={blockedOn:null,target:h,priority:g};for(var T=0;T<zu.length&&g!==0&&g<zu[T].priority;T++);zu.splice(T,0,h),T===0&&g_(h)}};var Ty=t.version;if(Ty!=="19.0.0")throw Error(s(527,Ty,"19.0.0"));xn.findDOMNode=function(h){var g=h._reactInternals;if(g===void 0)throw typeof h.render=="function"?Error(s(188)):(h=Object.keys(h).join(","),Error(s(268,h)));return h=$t(g),h=h!==null?rn(h):null,h=h===null?null:h.stateNode,h};var Ey={bundleType:0,version:"19.0.0",rendererPackageName:"react-dom",currentDispatcherRef:Ge,findFiberByHostInstance:ut,reconcilerVersion:"19.0.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var x_=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!x_.isDisabled&&x_.supportsFiber)try{ha=x_.inject(Ey),Ca=x_}catch{}}return Xy.createRoot=function(h,g){if(!f(h))throw Error(s(299));var T=!1,L="",V=Ih,Q=fp,be=$f,Be=null;return g!=null&&(g.unstable_strictMode===!0&&(T=!0),g.identifierPrefix!==void 0&&(L=g.identifierPrefix),g.onUncaughtError!==void 0&&(V=g.onUncaughtError),g.onCaughtError!==void 0&&(Q=g.onCaughtError),g.onRecoverableError!==void 0&&(be=g.onRecoverableError),g.unstable_transitionCallbacks!==void 0&&(Be=g.unstable_transitionCallbacks)),g=my(h,1,!1,null,null,T,L,V,Q,be,Be,null),h[ze]=g.current,i_(h.nodeType===8?h.parentNode:h),new v_(g)},Xy.hydrateRoot=function(h,g,T){if(!f(h))throw Error(s(299));var L=!1,V="",Q=Ih,be=fp,Be=$f,rt=null,Tt=null;return T!=null&&(T.unstable_strictMode===!0&&(L=!0),T.identifierPrefix!==void 0&&(V=T.identifierPrefix),T.onUncaughtError!==void 0&&(Q=T.onUncaughtError),T.onCaughtError!==void 0&&(be=T.onCaughtError),T.onRecoverableError!==void 0&&(Be=T.onRecoverableError),T.unstable_transitionCallbacks!==void 0&&(rt=T.unstable_transitionCallbacks),T.formState!==void 0&&(Tt=T.formState)),g=my(h,1,!0,g,T??null,L,V,Q,be,Be,rt,Tt),g.context=_y(null),T=g.current,L=vs(),V=$o(L),V.callback=null,Fl(T,V,L),g.current.lanes=L,vi(g,L),Us(g),h[ze]=g.current,i_(h),new Op(g)},Xy.version="19.0.0",Xy}var KI;function qU(){if(KI)return WS.exports;KI=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),WS.exports=$U(),WS.exports}var GU=qU(),Yy={},JI;function HU(){if(JI)return Yy;JI=1,Object.defineProperty(Yy,"__esModule",{value:!0}),Yy.parse=S,Yy.serialize=z;const e=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,t=/^[\u0021-\u003A\u003C-\u007E]*$/,a=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,s=/^[\u0020-\u003A\u003D-\u007E]*$/,f=Object.prototype.toString,v=(()=>{const G=function(){};return G.prototype=Object.create(null),G})();function S(G,Y){const X=new v,K=G.length;if(K<2)return X;const ne=(Y==null?void 0:Y.decode)||j;let se=0;do{const ge=G.indexOf("=",se);if(ge===-1)break;const _e=G.indexOf(";",se),xe=_e===-1?K:_e;if(ge>xe){se=G.lastIndexOf(";",ge-1)+1;continue}const ae=i(G,se,ge),ve=O(G,ge,ae),Se=G.slice(ae,ve);if(X[Se]===void 0){let He=i(G,ge+1,xe),Ge=O(G,xe,He);const ye=ne(G.slice(He,Ge));X[Se]=ye}se=xe+1}while(se<K);return X}function i(G,Y,X){do{const K=G.charCodeAt(Y);if(K!==32&&K!==9)return Y}while(++Y<X);return X}function O(G,Y,X){for(;Y>X;){const K=G.charCodeAt(--Y);if(K!==32&&K!==9)return Y+1}return X}function z(G,Y,X){const K=(X==null?void 0:X.encode)||encodeURIComponent;if(!e.test(G))throw new TypeError(`argument name is invalid: ${G}`);const ne=K(Y);if(!t.test(ne))throw new TypeError(`argument val is invalid: ${Y}`);let se=G+"="+ne;if(!X)return se;if(X.maxAge!==void 0){if(!Number.isInteger(X.maxAge))throw new TypeError(`option maxAge is invalid: ${X.maxAge}`);se+="; Max-Age="+X.maxAge}if(X.domain){if(!a.test(X.domain))throw new TypeError(`option domain is invalid: ${X.domain}`);se+="; Domain="+X.domain}if(X.path){if(!s.test(X.path))throw new TypeError(`option path is invalid: ${X.path}`);se+="; Path="+X.path}if(X.expires){if(!F(X.expires)||!Number.isFinite(X.expires.valueOf()))throw new TypeError(`option expires is invalid: ${X.expires}`);se+="; Expires="+X.expires.toUTCString()}if(X.httpOnly&&(se+="; HttpOnly"),X.secure&&(se+="; Secure"),X.partitioned&&(se+="; Partitioned"),X.priority)switch(typeof X.priority=="string"?X.priority.toLowerCase():void 0){case"low":se+="; Priority=Low";break;case"medium":se+="; Priority=Medium";break;case"high":se+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${X.priority}`)}if(X.sameSite)switch(typeof X.sameSite=="string"?X.sameSite.toLowerCase():X.sameSite){case!0:case"strict":se+="; SameSite=Strict";break;case"lax":se+="; SameSite=Lax";break;case"none":se+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${X.sameSite}`)}return se}function j(G){if(G.indexOf("%")===-1)return G;try{return decodeURIComponent(G)}catch{return G}}function F(G){return f.call(G)==="[object Date]"}return Yy}HU();/**
 * react-router v7.1.5
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var QI="popstate";function ZU(e={}){function t(f,v){let{pathname:S="/",search:i="",hash:O=""}=w0(f.location.hash.substring(1));return!S.startsWith("/")&&!S.startsWith(".")&&(S="/"+S),IC("",{pathname:S,search:i,hash:O},v.state&&v.state.usr||null,v.state&&v.state.key||"default")}function a(f,v){let S=f.document.querySelector("base"),i="";if(S&&S.getAttribute("href")){let O=f.location.href,z=O.indexOf("#");i=z===-1?O:O.slice(0,z)}return i+"#"+(typeof v=="string"?v:Lv(v))}function s(f,v){tc(f.pathname.charAt(0)==="/",`relative pathnames are not supported in hash history.push(${JSON.stringify(v)})`)}return XU(t,a,s,e)}function la(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function tc(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function WU(){return Math.random().toString(36).substring(2,10)}function eP(e,t){return{usr:e.state,key:e.key,idx:t}}function IC(e,t,a=null,s){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof t=="string"?w0(t):t,state:a,key:t&&t.key||s||WU()}}function Lv({pathname:e="/",search:t="",hash:a=""}){return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),a&&a!=="#"&&(e+=a.charAt(0)==="#"?a:"#"+a),e}function w0(e){let t={};if(e){let a=e.indexOf("#");a>=0&&(t.hash=e.substring(a),e=e.substring(0,a));let s=e.indexOf("?");s>=0&&(t.search=e.substring(s),e=e.substring(0,s)),e&&(t.pathname=e)}return t}function XU(e,t,a,s={}){let{window:f=document.defaultView,v5Compat:v=!1}=s,S=f.history,i="POP",O=null,z=j();z==null&&(z=0,S.replaceState({...S.state,idx:z},""));function j(){return(S.state||{idx:null}).idx}function F(){i="POP";let ne=j(),se=ne==null?null:ne-z;z=ne,O&&O({action:i,location:K.location,delta:se})}function G(ne,se){i="PUSH";let ge=IC(K.location,ne,se);a&&a(ge,ne),z=j()+1;let _e=eP(ge,z),xe=K.createHref(ge);try{S.pushState(_e,"",xe)}catch(ae){if(ae instanceof DOMException&&ae.name==="DataCloneError")throw ae;f.location.assign(xe)}v&&O&&O({action:i,location:K.location,delta:1})}function Y(ne,se){i="REPLACE";let ge=IC(K.location,ne,se);a&&a(ge,ne),z=j();let _e=eP(ge,z),xe=K.createHref(ge);S.replaceState(_e,"",xe),v&&O&&O({action:i,location:K.location,delta:0})}function X(ne){let se=f.location.origin!=="null"?f.location.origin:f.location.href,ge=typeof ne=="string"?ne:Lv(ne);return ge=ge.replace(/ $/,"%20"),la(se,`No window.location.(origin|href) available to create URL for href: ${ge}`),new URL(ge,se)}let K={get action(){return i},get location(){return e(f,S)},listen(ne){if(O)throw new Error("A history only accepts one active listener");return f.addEventListener(QI,F),O=ne,()=>{f.removeEventListener(QI,F),O=null}},createHref(ne){return t(f,ne)},createURL:X,encodeLocation(ne){let se=X(ne);return{pathname:se.pathname,search:se.search,hash:se.hash}},push:G,replace:Y,go(ne){return S.go(ne)}};return K}function y8(e,t,a="/"){return YU(e,t,a,!1)}function YU(e,t,a,s){let f=typeof t=="string"?w0(t):t,v=$p(f.pathname||"/",a);if(v==null)return null;let S=v8(e);KU(S);let i=null;for(let O=0;i==null&&O<S.length;++O){let z=lV(v);i=oV(S[O],z,s)}return i}function v8(e,t=[],a=[],s=""){let f=(v,S,i)=>{let O={relativePath:i===void 0?v.path||"":i,caseSensitive:v.caseSensitive===!0,childrenIndex:S,route:v};O.relativePath.startsWith("/")&&(la(O.relativePath.startsWith(s),`Absolute route path "${O.relativePath}" nested under path "${s}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),O.relativePath=O.relativePath.slice(s.length));let z=vd([s,O.relativePath]),j=a.concat(O);v.children&&v.children.length>0&&(la(v.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${z}".`),v8(v.children,t,j,z)),!(v.path==null&&!v.index)&&t.push({path:z,score:iV(z,v.index),routesMeta:j})};return e.forEach((v,S)=>{var i;if(v.path===""||!((i=v.path)!=null&&i.includes("?")))f(v,S);else for(let O of x8(v.path))f(v,S,O)}),t}function x8(e){let t=e.split("/");if(t.length===0)return[];let[a,...s]=t,f=a.endsWith("?"),v=a.replace(/\?$/,"");if(s.length===0)return f?[v,""]:[v];let S=x8(s.join("/")),i=[];return i.push(...S.map(O=>O===""?v:[v,O].join("/"))),f&&i.push(...S),i.map(O=>e.startsWith("/")&&O===""?"/":O)}function KU(e){e.sort((t,a)=>t.score!==a.score?a.score-t.score:aV(t.routesMeta.map(s=>s.childrenIndex),a.routesMeta.map(s=>s.childrenIndex)))}var JU=/^:[\w-]+$/,QU=3,eV=2,tV=1,nV=10,rV=-2,tP=e=>e==="*";function iV(e,t){let a=e.split("/"),s=a.length;return a.some(tP)&&(s+=rV),t&&(s+=eV),a.filter(f=>!tP(f)).reduce((f,v)=>f+(JU.test(v)?QU:v===""?tV:nV),s)}function aV(e,t){return e.length===t.length&&e.slice(0,-1).every((s,f)=>s===t[f])?e[e.length-1]-t[t.length-1]:0}function oV(e,t,a=!1){let{routesMeta:s}=e,f={},v="/",S=[];for(let i=0;i<s.length;++i){let O=s[i],z=i===s.length-1,j=v==="/"?t:t.slice(v.length)||"/",F=Lx({path:O.relativePath,caseSensitive:O.caseSensitive,end:z},j),G=O.route;if(!F&&z&&a&&!s[s.length-1].route.index&&(F=Lx({path:O.relativePath,caseSensitive:O.caseSensitive,end:!1},j)),!F)return null;Object.assign(f,F.params),S.push({params:f,pathname:vd([v,F.pathname]),pathnameBase:fV(vd([v,F.pathnameBase])),route:G}),F.pathnameBase!=="/"&&(v=vd([v,F.pathnameBase]))}return S}function Lx(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[a,s]=sV(e.path,e.caseSensitive,e.end),f=t.match(a);if(!f)return null;let v=f[0],S=v.replace(/(.)\/+$/,"$1"),i=f.slice(1);return{params:s.reduce((z,{paramName:j,isOptional:F},G)=>{if(j==="*"){let X=i[G]||"";S=v.slice(0,v.length-X.length).replace(/(.)\/+$/,"$1")}const Y=i[G];return F&&!Y?z[j]=void 0:z[j]=(Y||"").replace(/%2F/g,"/"),z},{}),pathname:v,pathnameBase:S,pattern:e}}function sV(e,t=!1,a=!0){tc(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let s=[],f="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(S,i,O)=>(s.push({paramName:i,isOptional:O!=null}),O?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(s.push({paramName:"*"}),f+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):a?f+="\\/*$":e!==""&&e!=="/"&&(f+="(?:(?=\\/|$))"),[new RegExp(f,t?void 0:"i"),s]}function lV(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return tc(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function $p(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let a=t.endsWith("/")?t.length-1:t.length,s=e.charAt(a);return s&&s!=="/"?null:e.slice(a)||"/"}function cV(e,t="/"){let{pathname:a,search:s="",hash:f=""}=typeof e=="string"?w0(e):e;return{pathname:a?a.startsWith("/")?a:uV(a,t):t,search:dV(s),hash:pV(f)}}function uV(e,t){let a=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(f=>{f===".."?a.length>1&&a.pop():f!=="."&&a.push(f)}),a.length>1?a.join("/"):"/"}function JS(e,t,a,s){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(s)}].  Please separate it out to the \`to.${a}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function hV(e){return e.filter((t,a)=>a===0||t.route.path&&t.route.path.length>0)}function c5(e){let t=hV(e);return t.map((a,s)=>s===t.length-1?a.pathname:a.pathnameBase)}function u5(e,t,a,s=!1){let f;typeof e=="string"?f=w0(e):(f={...e},la(!f.pathname||!f.pathname.includes("?"),JS("?","pathname","search",f)),la(!f.pathname||!f.pathname.includes("#"),JS("#","pathname","hash",f)),la(!f.search||!f.search.includes("#"),JS("#","search","hash",f)));let v=e===""||f.pathname==="",S=v?"/":f.pathname,i;if(S==null)i=a;else{let F=t.length-1;if(!s&&S.startsWith("..")){let G=S.split("/");for(;G[0]==="..";)G.shift(),F-=1;f.pathname=G.join("/")}i=F>=0?t[F]:"/"}let O=cV(f,i),z=S&&S!=="/"&&S.endsWith("/"),j=(v||S===".")&&a.endsWith("/");return!O.pathname.endsWith("/")&&(z||j)&&(O.pathname+="/"),O}var vd=e=>e.join("/").replace(/\/\/+/g,"/"),fV=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),dV=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,pV=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function mV(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}var b8=["POST","PUT","PATCH","DELETE"];new Set(b8);var _V=["GET",...b8];new Set(_V);var kg=Me.createContext(null);kg.displayName="DataRouter";var Pb=Me.createContext(null);Pb.displayName="DataRouterState";var w8=Me.createContext({isTransitioning:!1});w8.displayName="ViewTransition";var gV=Me.createContext(new Map);gV.displayName="Fetchers";var yV=Me.createContext(null);yV.displayName="Await";var Zu=Me.createContext(null);Zu.displayName="Navigation";var S1=Me.createContext(null);S1.displayName="Location";var Wu=Me.createContext({outlet:null,matches:[],isDataRoute:!1});Wu.displayName="Route";var h5=Me.createContext(null);h5.displayName="RouteError";function vV(e,{relative:t}={}){la(Bg(),"useHref() may be used only in the context of a <Router> component.");let{basename:a,navigator:s}=Me.useContext(Zu),{hash:f,pathname:v,search:S}=T1(e,{relative:t}),i=v;return a!=="/"&&(i=v==="/"?a:vd([a,v])),s.createHref({pathname:i,search:S,hash:f})}function Bg(){return Me.useContext(S1)!=null}function Id(){return la(Bg(),"useLocation() may be used only in the context of a <Router> component."),Me.useContext(S1).location}var S8="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function T8(e){Me.useContext(Zu).static||Me.useLayoutEffect(e)}function yo(){let{isDataRoute:e}=Me.useContext(Wu);return e?DV():xV()}function xV(){la(Bg(),"useNavigate() may be used only in the context of a <Router> component.");let e=Me.useContext(kg),{basename:t,navigator:a}=Me.useContext(Zu),{matches:s}=Me.useContext(Wu),{pathname:f}=Id(),v=JSON.stringify(c5(s)),S=Me.useRef(!1);return T8(()=>{S.current=!0}),Me.useCallback((O,z={})=>{if(tc(S.current,S8),!S.current)return;if(typeof O=="number"){a.go(O);return}let j=u5(O,JSON.parse(v),f,z.relative==="path");e==null&&t!=="/"&&(j.pathname=j.pathname==="/"?t:vd([t,j.pathname])),(z.replace?a.replace:a.push)(j,z.state,z)},[t,a,v,f,e])}Me.createContext(null);function bV(){let{matches:e}=Me.useContext(Wu),t=e[e.length-1];return t?t.params:{}}function T1(e,{relative:t}={}){let{matches:a}=Me.useContext(Wu),{pathname:s}=Id(),f=JSON.stringify(c5(a));return Me.useMemo(()=>u5(e,JSON.parse(f),s,t==="path"),[e,f,s,t])}function wV(e,t){return E8(e,t)}function E8(e,t,a,s){var ge;la(Bg(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:f,static:v}=Me.useContext(Zu),{matches:S}=Me.useContext(Wu),i=S[S.length-1],O=i?i.params:{},z=i?i.pathname:"/",j=i?i.pathnameBase:"/",F=i&&i.route;{let _e=F&&F.path||"";A8(z,!F||_e.endsWith("*")||_e.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${z}" (under <Route path="${_e}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${_e}"> to <Route path="${_e==="/"?"*":`${_e}/*`}">.`)}let G=Id(),Y;if(t){let _e=typeof t=="string"?w0(t):t;la(j==="/"||((ge=_e.pathname)==null?void 0:ge.startsWith(j)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${j}" but pathname "${_e.pathname}" was given in the \`location\` prop.`),Y=_e}else Y=G;let X=Y.pathname||"/",K=X;if(j!=="/"){let _e=j.replace(/^\//,"").split("/");K="/"+X.replace(/^\//,"").split("/").slice(_e.length).join("/")}let ne=!v&&a&&a.matches&&a.matches.length>0?a.matches:y8(e,{pathname:K});tc(F||ne!=null,`No routes matched location "${Y.pathname}${Y.search}${Y.hash}" `),tc(ne==null||ne[ne.length-1].route.element!==void 0||ne[ne.length-1].route.Component!==void 0||ne[ne.length-1].route.lazy!==void 0,`Matched leaf route at location "${Y.pathname}${Y.search}${Y.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let se=CV(ne&&ne.map(_e=>Object.assign({},_e,{params:Object.assign({},O,_e.params),pathname:vd([j,f.encodeLocation?f.encodeLocation(_e.pathname).pathname:_e.pathname]),pathnameBase:_e.pathnameBase==="/"?j:vd([j,f.encodeLocation?f.encodeLocation(_e.pathnameBase).pathname:_e.pathnameBase])})),S,a,s);return t&&se?Me.createElement(S1.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...Y},navigationType:"POP"}},se):se}function SV(){let e=RV(),t=mV(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),a=e instanceof Error?e.stack:null,s="rgba(200,200,200, 0.5)",f={padding:"0.5rem",backgroundColor:s},v={padding:"2px 4px",backgroundColor:s},S=null;return console.error("Error handled by React Router default ErrorBoundary:",e),S=Me.createElement(Me.Fragment,null,Me.createElement("p",null,"💿 Hey developer 👋"),Me.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",Me.createElement("code",{style:v},"ErrorBoundary")," or"," ",Me.createElement("code",{style:v},"errorElement")," prop on your route.")),Me.createElement(Me.Fragment,null,Me.createElement("h2",null,"Unexpected Application Error!"),Me.createElement("h3",{style:{fontStyle:"italic"}},t),a?Me.createElement("pre",{style:f},a):null,S)}var TV=Me.createElement(SV,null),EV=class extends Me.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?Me.createElement(Wu.Provider,{value:this.props.routeContext},Me.createElement(h5.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function AV({routeContext:e,match:t,children:a}){let s=Me.useContext(kg);return s&&s.static&&s.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=t.route.id),Me.createElement(Wu.Provider,{value:e},a)}function CV(e,t=[],a=null,s=null){if(e==null){if(!a)return null;if(a.errors)e=a.matches;else if(t.length===0&&!a.initialized&&a.matches.length>0)e=a.matches;else return null}let f=e,v=a==null?void 0:a.errors;if(v!=null){let O=f.findIndex(z=>z.route.id&&(v==null?void 0:v[z.route.id])!==void 0);la(O>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(v).join(",")}`),f=f.slice(0,Math.min(f.length,O+1))}let S=!1,i=-1;if(a)for(let O=0;O<f.length;O++){let z=f[O];if((z.route.HydrateFallback||z.route.hydrateFallbackElement)&&(i=O),z.route.id){let{loaderData:j,errors:F}=a,G=z.route.loader&&!j.hasOwnProperty(z.route.id)&&(!F||F[z.route.id]===void 0);if(z.route.lazy||G){S=!0,i>=0?f=f.slice(0,i+1):f=[f[0]];break}}}return f.reduceRight((O,z,j)=>{let F,G=!1,Y=null,X=null;a&&(F=v&&z.route.id?v[z.route.id]:void 0,Y=z.route.errorElement||TV,S&&(i<0&&j===0?(A8("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),G=!0,X=null):i===j&&(G=!0,X=z.route.hydrateFallbackElement||null)));let K=t.concat(f.slice(0,j+1)),ne=()=>{let se;return F?se=Y:G?se=X:z.route.Component?se=Me.createElement(z.route.Component,null):z.route.element?se=z.route.element:se=O,Me.createElement(AV,{match:z,routeContext:{outlet:O,matches:K,isDataRoute:a!=null},children:se})};return a&&(z.route.ErrorBoundary||z.route.errorElement||j===0)?Me.createElement(EV,{location:a.location,revalidation:a.revalidation,component:Y,error:F,children:ne(),routeContext:{outlet:null,matches:K,isDataRoute:!0}}):ne()},null)}function f5(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function MV(e){let t=Me.useContext(kg);return la(t,f5(e)),t}function OV(e){let t=Me.useContext(Pb);return la(t,f5(e)),t}function IV(e){let t=Me.useContext(Wu);return la(t,f5(e)),t}function d5(e){let t=IV(e),a=t.matches[t.matches.length-1];return la(a.route.id,`${e} can only be used on routes that contain a unique "id"`),a.route.id}function PV(){return d5("useRouteId")}function RV(){var s;let e=Me.useContext(h5),t=OV("useRouteError"),a=d5("useRouteError");return e!==void 0?e:(s=t.errors)==null?void 0:s[a]}function DV(){let{router:e}=MV("useNavigate"),t=d5("useNavigate"),a=Me.useRef(!1);return T8(()=>{a.current=!0}),Me.useCallback(async(f,v={})=>{tc(a.current,S8),a.current&&(typeof f=="number"?e.navigate(f):await e.navigate(f,{fromRouteId:t,...v}))},[e,t])}var nP={};function A8(e,t,a){!t&&!nP[e]&&(nP[e]=!0,tc(!1,a))}Me.memo(LV);function LV({routes:e,future:t,state:a}){return E8(e,void 0,a,t)}function zV({to:e,replace:t,state:a,relative:s}){la(Bg(),"<Navigate> may be used only in the context of a <Router> component.");let{static:f}=Me.useContext(Zu);tc(!f,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:v}=Me.useContext(Wu),{pathname:S}=Id(),i=yo(),O=u5(e,c5(v),S,s==="path"),z=JSON.stringify(O);return Me.useEffect(()=>{i(JSON.parse(z),{replace:t,state:a,relative:s})},[i,z,s,t,a]),null}function qu(e){la(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function kV({basename:e="/",children:t=null,location:a,navigationType:s="POP",navigator:f,static:v=!1}){la(!Bg(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let S=e.replace(/^\/*/,"/"),i=Me.useMemo(()=>({basename:S,navigator:f,static:v,future:{}}),[S,f,v]);typeof a=="string"&&(a=w0(a));let{pathname:O="/",search:z="",hash:j="",state:F=null,key:G="default"}=a,Y=Me.useMemo(()=>{let X=$p(O,S);return X==null?null:{location:{pathname:X,search:z,hash:j,state:F,key:G},navigationType:s}},[S,O,z,j,F,G,s]);return tc(Y!=null,`<Router basename="${S}"> is not able to match the URL "${O}${z}${j}" because it does not start with the basename, so the <Router> won't render anything.`),Y==null?null:Me.createElement(Zu.Provider,{value:i},Me.createElement(S1.Provider,{children:t,value:Y}))}function BV({children:e,location:t}){return wV(PC(e),t)}function PC(e,t=[]){let a=[];return Me.Children.forEach(e,(s,f)=>{if(!Me.isValidElement(s))return;let v=[...t,f];if(s.type===Me.Fragment){a.push.apply(a,PC(s.props.children,v));return}la(s.type===qu,`[${typeof s.type=="string"?s.type:s.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),la(!s.props.index||!s.props.children,"An index route cannot have child routes.");let S={id:s.props.id||v.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,loader:s.props.loader,action:s.props.action,hydrateFallbackElement:s.props.hydrateFallbackElement,HydrateFallback:s.props.HydrateFallback,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.hasErrorBoundary===!0||s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(S.children=PC(s.props.children,v)),a.push(S)}),a}var Ex="get",Ax="application/x-www-form-urlencoded";function Rb(e){return e!=null&&typeof e.tagName=="string"}function NV(e){return Rb(e)&&e.tagName.toLowerCase()==="button"}function FV(e){return Rb(e)&&e.tagName.toLowerCase()==="form"}function jV(e){return Rb(e)&&e.tagName.toLowerCase()==="input"}function UV(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function VV(e,t){return e.button===0&&(!t||t==="_self")&&!UV(e)}function RC(e=""){return new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,a)=>{let s=e[a];return t.concat(Array.isArray(s)?s.map(f=>[a,f]):[[a,s]])},[]))}function $V(e,t){let a=RC(e);return t&&t.forEach((s,f)=>{a.has(f)||t.getAll(f).forEach(v=>{a.append(f,v)})}),a}var q2=null;function qV(){if(q2===null)try{new FormData(document.createElement("form"),0),q2=!1}catch{q2=!0}return q2}var GV=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function QS(e){return e!=null&&!GV.has(e)?(tc(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Ax}"`),null):e}function HV(e,t){let a,s,f,v,S;if(FV(e)){let i=e.getAttribute("action");s=i?$p(i,t):null,a=e.getAttribute("method")||Ex,f=QS(e.getAttribute("enctype"))||Ax,v=new FormData(e)}else if(NV(e)||jV(e)&&(e.type==="submit"||e.type==="image")){let i=e.form;if(i==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let O=e.getAttribute("formaction")||i.getAttribute("action");if(s=O?$p(O,t):null,a=e.getAttribute("formmethod")||i.getAttribute("method")||Ex,f=QS(e.getAttribute("formenctype"))||QS(i.getAttribute("enctype"))||Ax,v=new FormData(i,e),!qV()){let{name:z,type:j,value:F}=e;if(j==="image"){let G=z?`${z}.`:"";v.append(`${G}x`,"0"),v.append(`${G}y`,"0")}else z&&v.append(z,F)}}else{if(Rb(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');a=Ex,s=null,f=Ax,S=e}return v&&f==="text/plain"&&(S=v,v=void 0),{action:s,method:a.toLowerCase(),encType:f,formData:v,body:S}}function p5(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}async function ZV(e,t){if(e.id in t)return t[e.id];try{let a=await import(e.module);return t[e.id]=a,a}catch(a){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(a),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function WV(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function XV(e,t,a){let s=await Promise.all(e.map(async f=>{let v=t.routes[f.route.id];if(v){let S=await ZV(v,a);return S.links?S.links():[]}return[]}));return QV(s.flat(1).filter(WV).filter(f=>f.rel==="stylesheet"||f.rel==="preload").map(f=>f.rel==="stylesheet"?{...f,rel:"prefetch",as:"style"}:{...f,rel:"prefetch"}))}function rP(e,t,a,s,f,v){let S=(O,z)=>a[z]?O.route.id!==a[z].route.id:!0,i=(O,z)=>{var j;return a[z].pathname!==O.pathname||((j=a[z].route.path)==null?void 0:j.endsWith("*"))&&a[z].params["*"]!==O.params["*"]};return v==="assets"?t.filter((O,z)=>S(O,z)||i(O,z)):v==="data"?t.filter((O,z)=>{var F;let j=s.routes[O.route.id];if(!j||!j.hasLoader)return!1;if(S(O,z)||i(O,z))return!0;if(O.route.shouldRevalidate){let G=O.route.shouldRevalidate({currentUrl:new URL(f.pathname+f.search+f.hash,window.origin),currentParams:((F=a[0])==null?void 0:F.params)||{},nextUrl:new URL(e,window.origin),nextParams:O.params,defaultShouldRevalidate:!0});if(typeof G=="boolean")return G}return!0}):[]}function YV(e,t){return KV(e.map(a=>{let s=t.routes[a.route.id];if(!s)return[];let f=[s.module];return s.imports&&(f=f.concat(s.imports)),f}).flat(1))}function KV(e){return[...new Set(e)]}function JV(e){let t={},a=Object.keys(e).sort();for(let s of a)t[s]=e[s];return t}function QV(e,t){let a=new Set;return new Set(t),e.reduce((s,f)=>{let v=JSON.stringify(JV(f));return a.has(v)||(a.add(v),s.push({key:v,link:f})),s},[])}function e$(e){let t=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return t.pathname==="/"?t.pathname="_root.data":t.pathname=`${t.pathname.replace(/\/$/,"")}.data`,t}function t$(){let e=Me.useContext(kg);return p5(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function n$(){let e=Me.useContext(Pb);return p5(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var m5=Me.createContext(void 0);m5.displayName="FrameworkContext";function C8(){let e=Me.useContext(m5);return p5(e,"You must render this element inside a <HydratedRouter> element"),e}function r$(e,t){let a=Me.useContext(m5),[s,f]=Me.useState(!1),[v,S]=Me.useState(!1),{onFocus:i,onBlur:O,onMouseEnter:z,onMouseLeave:j,onTouchStart:F}=t,G=Me.useRef(null);Me.useEffect(()=>{if(e==="render"&&S(!0),e==="viewport"){let K=se=>{se.forEach(ge=>{S(ge.isIntersecting)})},ne=new IntersectionObserver(K,{threshold:.5});return G.current&&ne.observe(G.current),()=>{ne.disconnect()}}},[e]),Me.useEffect(()=>{if(s){let K=setTimeout(()=>{S(!0)},100);return()=>{clearTimeout(K)}}},[s]);let Y=()=>{f(!0)},X=()=>{f(!1),S(!1)};return a?e!=="intent"?[v,G,{}]:[v,G,{onFocus:Ky(i,Y),onBlur:Ky(O,X),onMouseEnter:Ky(z,Y),onMouseLeave:Ky(j,X),onTouchStart:Ky(F,Y)}]:[!1,G,{}]}function Ky(e,t){return a=>{e&&e(a),a.defaultPrevented||t(a)}}function i$({page:e,...t}){let{router:a}=t$(),s=Me.useMemo(()=>y8(a.routes,e,a.basename),[a.routes,e,a.basename]);return s?Me.createElement(o$,{page:e,matches:s,...t}):null}function a$(e){let{manifest:t,routeModules:a}=C8(),[s,f]=Me.useState([]);return Me.useEffect(()=>{let v=!1;return XV(e,t,a).then(S=>{v||f(S)}),()=>{v=!0}},[e,t,a]),s}function o$({page:e,matches:t,...a}){let s=Id(),{manifest:f,routeModules:v}=C8(),{loaderData:S,matches:i}=n$(),O=Me.useMemo(()=>rP(e,t,i,f,s,"data"),[e,t,i,f,s]),z=Me.useMemo(()=>rP(e,t,i,f,s,"assets"),[e,t,i,f,s]),j=Me.useMemo(()=>{if(e===s.pathname+s.search+s.hash)return[];let Y=new Set,X=!1;if(t.forEach(ne=>{var ge;let se=f.routes[ne.route.id];!se||!se.hasLoader||(!O.some(_e=>_e.route.id===ne.route.id)&&ne.route.id in S&&((ge=v[ne.route.id])!=null&&ge.shouldRevalidate)||se.hasClientLoader?X=!0:Y.add(ne.route.id))}),Y.size===0)return[];let K=e$(e);return X&&Y.size>0&&K.searchParams.set("_routes",t.filter(ne=>Y.has(ne.route.id)).map(ne=>ne.route.id).join(",")),[K.pathname+K.search]},[S,s,f,O,t,e,v]),F=Me.useMemo(()=>YV(z,f),[z,f]),G=a$(z);return Me.createElement(Me.Fragment,null,j.map(Y=>Me.createElement("link",{key:Y,rel:"prefetch",as:"fetch",href:Y,...a})),F.map(Y=>Me.createElement("link",{key:Y,rel:"modulepreload",href:Y,...a})),G.map(({key:Y,link:X})=>Me.createElement("link",{key:Y,...X})))}function s$(...e){return t=>{e.forEach(a=>{typeof a=="function"?a(t):a!=null&&(a.current=t)})}}var M8=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{M8&&(window.__reactRouterVersion="7.1.5")}catch{}function l$({basename:e,children:t,window:a}){let s=Me.useRef();s.current==null&&(s.current=ZU({window:a,v5Compat:!0}));let f=s.current,[v,S]=Me.useState({action:f.action,location:f.location}),i=Me.useCallback(O=>{Me.startTransition(()=>S(O))},[S]);return Me.useLayoutEffect(()=>f.listen(i),[f,i]),Me.createElement(kV,{basename:e,children:t,location:v.location,navigationType:v.action,navigator:f})}var O8=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,I8=Me.forwardRef(function({onClick:t,discover:a="render",prefetch:s="none",relative:f,reloadDocument:v,replace:S,state:i,target:O,to:z,preventScrollReset:j,viewTransition:F,...G},Y){let{basename:X}=Me.useContext(Zu),K=typeof z=="string"&&O8.test(z),ne,se=!1;if(typeof z=="string"&&K&&(ne=z,M8))try{let Ge=new URL(window.location.href),ye=z.startsWith("//")?new URL(Ge.protocol+z):new URL(z),Le=$p(ye.pathname,X);ye.origin===Ge.origin&&Le!=null?z=Le+ye.search+ye.hash:se=!0}catch{tc(!1,`<Link to="${z}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let ge=vV(z,{relative:f}),[_e,xe,ae]=r$(s,G),ve=f$(z,{replace:S,state:i,target:O,preventScrollReset:j,relative:f,viewTransition:F});function Se(Ge){t&&t(Ge),Ge.defaultPrevented||ve(Ge)}let He=Me.createElement("a",{...G,...ae,href:ne||ge,onClick:se||v?t:Se,ref:s$(Y,xe),target:O,"data-discover":!K&&a==="render"?"true":void 0});return _e&&!K?Me.createElement(Me.Fragment,null,He,Me.createElement(i$,{page:ge})):He});I8.displayName="Link";var c$=Me.forwardRef(function({"aria-current":t="page",caseSensitive:a=!1,className:s="",end:f=!1,style:v,to:S,viewTransition:i,children:O,...z},j){let F=T1(S,{relative:z.relative}),G=Id(),Y=Me.useContext(Pb),{navigator:X,basename:K}=Me.useContext(Zu),ne=Y!=null&&g$(F)&&i===!0,se=X.encodeLocation?X.encodeLocation(F).pathname:F.pathname,ge=G.pathname,_e=Y&&Y.navigation&&Y.navigation.location?Y.navigation.location.pathname:null;a||(ge=ge.toLowerCase(),_e=_e?_e.toLowerCase():null,se=se.toLowerCase()),_e&&K&&(_e=$p(_e,K)||_e);const xe=se!=="/"&&se.endsWith("/")?se.length-1:se.length;let ae=ge===se||!f&&ge.startsWith(se)&&ge.charAt(xe)==="/",ve=_e!=null&&(_e===se||!f&&_e.startsWith(se)&&_e.charAt(se.length)==="/"),Se={isActive:ae,isPending:ve,isTransitioning:ne},He=ae?t:void 0,Ge;typeof s=="function"?Ge=s(Se):Ge=[s,ae?"active":null,ve?"pending":null,ne?"transitioning":null].filter(Boolean).join(" ");let ye=typeof v=="function"?v(Se):v;return Me.createElement(I8,{...z,"aria-current":He,className:Ge,ref:j,style:ye,to:S,viewTransition:i},typeof O=="function"?O(Se):O)});c$.displayName="NavLink";var u$=Me.forwardRef(({discover:e="render",fetcherKey:t,navigate:a,reloadDocument:s,replace:f,state:v,method:S=Ex,action:i,onSubmit:O,relative:z,preventScrollReset:j,viewTransition:F,...G},Y)=>{let X=m$(),K=_$(i,{relative:z}),ne=S.toLowerCase()==="get"?"get":"post",se=typeof i=="string"&&O8.test(i),ge=_e=>{if(O&&O(_e),_e.defaultPrevented)return;_e.preventDefault();let xe=_e.nativeEvent.submitter,ae=(xe==null?void 0:xe.getAttribute("formmethod"))||S;X(xe||_e.currentTarget,{fetcherKey:t,method:ae,navigate:a,replace:f,state:v,relative:z,preventScrollReset:j,viewTransition:F})};return Me.createElement("form",{ref:Y,method:ne,action:K,onSubmit:s?O:ge,...G,"data-discover":!se&&e==="render"?"true":void 0})});u$.displayName="Form";function h$(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function P8(e){let t=Me.useContext(kg);return la(t,h$(e)),t}function f$(e,{target:t,replace:a,state:s,preventScrollReset:f,relative:v,viewTransition:S}={}){let i=yo(),O=Id(),z=T1(e,{relative:v});return Me.useCallback(j=>{if(VV(j,t)){j.preventDefault();let F=a!==void 0?a:Lv(O)===Lv(z);i(e,{replace:F,state:s,preventScrollReset:f,relative:v,viewTransition:S})}},[O,i,z,a,s,t,e,f,v,S])}function Db(e){tc(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let t=Me.useRef(RC(e)),a=Me.useRef(!1),s=Id(),f=Me.useMemo(()=>$V(s.search,a.current?null:t.current),[s.search]),v=yo(),S=Me.useCallback((i,O)=>{const z=RC(typeof i=="function"?i(f):i);a.current=!0,v("?"+z,O)},[v,f]);return[f,S]}var d$=0,p$=()=>`__${String(++d$)}__`;function m$(){let{router:e}=P8("useSubmit"),{basename:t}=Me.useContext(Zu),a=PV();return Me.useCallback(async(s,f={})=>{let{action:v,method:S,encType:i,formData:O,body:z}=HV(s,t);if(f.navigate===!1){let j=f.fetcherKey||p$();await e.fetch(j,a,f.action||v,{preventScrollReset:f.preventScrollReset,formData:O,body:z,formMethod:f.method||S,formEncType:f.encType||i,flushSync:f.flushSync})}else await e.navigate(f.action||v,{preventScrollReset:f.preventScrollReset,formData:O,body:z,formMethod:f.method||S,formEncType:f.encType||i,replace:f.replace,state:f.state,fromRouteId:a,flushSync:f.flushSync,viewTransition:f.viewTransition})},[e,t,a])}function _$(e,{relative:t}={}){let{basename:a}=Me.useContext(Zu),s=Me.useContext(Wu);la(s,"useFormAction must be used inside a RouteContext");let[f]=s.matches.slice(-1),v={...T1(e||".",{relative:t})},S=Id();if(e==null){v.search=S.search;let i=new URLSearchParams(v.search),O=i.getAll("index");if(O.some(j=>j==="")){i.delete("index"),O.filter(F=>F).forEach(F=>i.append("index",F));let j=i.toString();v.search=j?`?${j}`:""}}return(!e||e===".")&&f.route.index&&(v.search=v.search?v.search.replace(/^\?/,"?index&"):"?index"),a!=="/"&&(v.pathname=v.pathname==="/"?a:vd([a,v.pathname])),Lv(v)}function g$(e,t={}){let a=Me.useContext(w8);la(a!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:s}=P8("useViewTransitionState"),f=T1(e,{relative:t.relative});if(!a.isTransitioning)return!1;let v=$p(a.currentLocation.pathname,s)||a.currentLocation.pathname,S=$p(a.nextLocation.pathname,s)||a.nextLocation.pathname;return Lx(f.pathname,S)!=null||Lx(f.pathname,v)!=null}new TextEncoder;const E1="/stations-list/",_5="/stations/filters/",A1="/station/",qp="/charging-sessions-history/",R8=qp+"filters/",Lb="/charging-session/",zv="/rfid-card/",D8=zv+"add/",L8="/payment-method/",y$="_page_1bygj_1",v$="_page__stationsList_1bygj_6",x$="_stationsList__station_1bygj_17",e3={page:y$,page__stationsList:v$,stationsList__station:x$},g5="data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M9.5%2010C11.1569%2010%2012.5%208.65688%2012.5%207.00002C12.5%205.34317%2011.1569%204.00002%209.5%204.00002C7.84315%204.00002%206.5%205.34317%206.5%207.00002C6.5%208.65688%207.84315%2010%209.5%2010Z'%20stroke='%23373435'%20stroke-width='1.5'/%3e%3cpath%20d='M14.5%2020C12.8431%2020%2011.5%2018.6569%2011.5%2017C11.5%2015.3432%2012.8431%2014%2014.5%2014C16.1569%2014%2017.5%2015.3432%2017.5%2017C17.5%2018.6569%2016.1569%2020%2014.5%2020Z'%20stroke='%23373435'%20stroke-width='1.5'/%3e%3cpath%20d='M15%207.0415L22%207.0415'%20stroke='%23373435'%20stroke-width='1.5'%20stroke-linecap='round'/%3e%3cpath%20d='M9%2017.0415L2%2017.0415'%20stroke='%23373435'%20stroke-width='1.5'%20stroke-linecap='round'/%3e%3cpath%20d='M2%207.0415L4%207.0415'%20stroke='%23373435'%20stroke-width='1.5'%20stroke-linecap='round'/%3e%3cpath%20d='M22%2017.0415L20%2017.0415'%20stroke='%23373435'%20stroke-width='1.5'%20stroke-linecap='round'/%3e%3c/svg%3e",b$="_button_1rwfk_1",w$="_fill_1rwfk_23",S$="_outlined_1rwfk_43",T$="_outlinedDisabled_1rwfk_63",E$="_fillDisabled_1rwfk_64",G2={button:b$,fill:w$,outlined:S$,outlinedDisabled:T$,fillDisabled:E$};function zb(e){const t=()=>{e.disabled||e.onClick()};return he.jsx("button",{onClick:t,disabled:e.disabled,className:`${G2.button} ${G2[e.variant]} ${e.disabled?G2[e.variant+"Disabled"]:""}`,children:he.jsx("img",{src:e.iconSrc,alt:"Icon",className:G2[`${e.variant}__icon`]})})}const A$="data:image/svg+xml,%3csvg%20width='20'%20height='26'%20viewBox='0%200%2020%2026'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M10%2023.4993C15.5228%2023.4993%2020%2019.0221%2020%2013.4993C20%207.97642%2015.5228%203.49927%2010%203.49927C4.47715%203.49927%200%207.97642%200%2013.4993C0%2019.0221%204.47715%2023.4993%2010%2023.4993ZM4.5%2016.9999C5.32843%2016.9999%206%2016.3283%206%2015.4999C6%2014.6715%205.32843%2013.9999%204.5%2013.9999C3.67157%2013.9999%203%2014.6715%203%2015.4999C3%2016.3283%203.67157%2016.9999%204.5%2016.9999ZM12%2019.4999C12%2020.6045%2011.1046%2021.4999%2010%2021.4999C8.89543%2021.4999%208%2020.6045%208%2019.4999C8%2018.3953%208.89543%2017.4999%2010%2017.4999C11.1046%2017.4999%2012%2018.3953%2012%2019.4999ZM15.5%2016.9999C16.3284%2016.9999%2017%2016.3283%2017%2015.4999C17%2014.6715%2016.3284%2013.9999%2015.5%2013.9999C14.6716%2013.9999%2014%2014.6715%2014%2015.4999C14%2016.3283%2014.6716%2016.9999%2015.5%2016.9999ZM16%209.49991C16%2010.6045%2015.1046%2011.4999%2014%2011.4999C12.8954%2011.4999%2012%2010.6045%2012%209.49991C12%208.39534%2012.8954%207.49991%2014%207.49991C15.1046%207.49991%2016%208.39534%2016%209.49991ZM6%2011.4999C7.10457%2011.4999%208%2010.6045%208%209.49991C8%208.39534%207.10457%207.49991%206%207.49991C4.89543%207.49991%204%208.39534%204%209.49991C4%2010.6045%204.89543%2011.4999%206%2011.4999Z'%20fill='%23373435'/%3e%3c/svg%3e",C$="data:image/svg+xml,%3csvg%20width='20'%20height='26'%20viewBox='0%200%2020%2026'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M10%2021.4996C15.5228%2021.4996%2020%2017.0224%2020%2011.4996C20%208.84988%2018.9694%206.44107%2017.2873%204.65172C17.1953%204.55385%2017.0661%204.5002%2016.9318%204.5002L10%204.5H3.0682C2.93386%204.5%202.80472%204.55364%202.7127%204.65152C1.03055%206.44088%200%208.84988%200%2011.4996C0%2017.0224%204.47715%2021.4996%2010%2021.4996ZM6.99976%2010.0006C7.82818%2010.0006%208.49976%209.32904%208.49976%208.50061C8.49976%207.67218%207.82818%207.00061%206.99976%207.00061C6.17133%207.00061%205.49976%207.67218%205.49976%208.50061C5.49976%209.32904%206.17133%2010.0006%206.99976%2010.0006ZM8.99963%2016.0002C8.99963%2017.1048%208.1042%2018.0002%206.99963%2018.0002C5.89506%2018.0002%204.99963%2017.1048%204.99963%2016.0002C4.99963%2014.8957%205.89506%2014.0002%206.99963%2014.0002C8.1042%2014.0002%208.99963%2014.8957%208.99963%2016.0002ZM12.9998%2010.0006C13.8282%2010.0006%2014.4998%209.32904%2014.4998%208.50061C14.4998%207.67218%2013.8282%207.00061%2012.9998%207.00061C12.1713%207.00061%2011.4998%207.67218%2011.4998%208.50061C11.4998%209.32904%2012.1713%2010.0006%2012.9998%2010.0006ZM14.9996%2016.0002C14.9996%2017.1048%2014.1042%2018.0002%2012.9996%2018.0002C11.8951%2018.0002%2010.9996%2017.1048%2010.9996%2016.0002C10.9996%2014.8957%2011.8951%2014.0002%2012.9996%2014.0002C14.1042%2014.0002%2014.9996%2014.8957%2014.9996%2016.0002ZM9.99963%2014.0007C11.1042%2014.0007%2011.9996%2013.1053%2011.9996%2012.0007C11.9996%2010.8962%2011.1042%2010.0007%209.99963%2010.0007C8.89506%2010.0007%207.99963%2010.8962%207.99963%2012.0007C7.99963%2013.1053%208.89506%2014.0007%209.99963%2014.0007ZM17.9999%2012.0007C17.9999%2013.1053%2017.1044%2014.0007%2015.9999%2014.0007C14.8953%2014.0007%2013.9999%2013.1053%2013.9999%2012.0007C13.9999%2010.8962%2014.8953%2010.0007%2015.9999%2010.0007C17.1044%2010.0007%2017.9999%2010.8962%2017.9999%2012.0007ZM4.00012%2014.0007C5.10469%2014.0007%206.00012%2013.1053%206.00012%2012.0007C6.00012%2010.8962%205.10469%2010.0007%204.00012%2010.0007C2.89555%2010.0007%202.00012%2010.8962%202.00012%2012.0007C2.00012%2013.1053%202.89555%2014.0007%204.00012%2014.0007Z'%20fill='%23373435'/%3e%3c/svg%3e",M$="data:image/svg+xml,%3csvg%20width='20'%20height='26'%20viewBox='0%200%2020%2026'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M20%2010.0002C20%2013.9581%2017.7006%2017.379%2014.3649%2018.9999H17.9999C18.276%2018.9999%2018.4999%2019.2237%2018.4999%2019.4999V25.4999C18.4999%2025.776%2018.276%2025.9999%2017.9999%2025.9999H1.99988C1.72374%2025.9999%201.49988%2025.776%201.49988%2025.4999V19.4999C1.49988%2019.2237%201.72374%2018.9999%201.99988%2018.9999H5.63512C2.29936%2017.379%200%2013.9581%200%2010.0002C0%204.4774%204.47715%200.000244141%2010%200.000244141C15.5228%200.000244141%2020%204.4774%2020%2010.0002ZM14.4998%2024.5004C15.6043%2024.5004%2016.4998%2023.6049%2016.4998%2022.5004C16.4998%2021.3958%2015.6043%2020.5004%2014.4998%2020.5004C13.3952%2020.5004%2012.4998%2021.3958%2012.4998%2022.5004C12.4998%2023.6049%2013.3952%2024.5004%2014.4998%2024.5004ZM7.49951%2022.5004C7.49951%2023.6049%206.60408%2024.5004%205.49951%2024.5004C4.39494%2024.5004%203.49951%2023.6049%203.49951%2022.5004C3.49951%2021.3958%204.39494%2020.5004%205.49951%2020.5004C6.60408%2020.5004%207.49951%2021.3958%207.49951%2022.5004ZM4.5%2013.5009C5.32843%2013.5009%206%2012.8293%206%2012.0009C6%2011.1725%205.32843%2010.5009%204.5%2010.5009C3.67157%2010.5009%203%2011.1725%203%2012.0009C3%2012.8293%203.67157%2013.5009%204.5%2013.5009ZM12%2016.0009C12%2017.1055%2011.1046%2018.0009%2010%2018.0009C8.89543%2018.0009%208%2017.1055%208%2016.0009C8%2014.8963%208.89543%2014.0009%2010%2014.0009C11.1046%2014.0009%2012%2014.8963%2012%2016.0009ZM15.5%2013.5009C16.3284%2013.5009%2017%2012.8293%2017%2012.0009C17%2011.1725%2016.3284%2010.5009%2015.5%2010.5009C14.6716%2010.5009%2014%2011.1725%2014%2012.0009C14%2012.8293%2014.6716%2013.5009%2015.5%2013.5009ZM16%206.00089C16%207.10545%2015.1046%208.00089%2014%208.00089C12.8954%208.00089%2012%207.10545%2012%206.00089C12%204.89632%2012.8954%204.00089%2014%204.00089C15.1046%204.00089%2016%204.89632%2016%206.00089ZM6%208.00089C7.10457%208.00089%208%207.10545%208%206.00089C8%204.89632%207.10457%204.00089%206%204.00089C4.89543%204.00089%204%204.89632%204%206.00089C4%207.10545%204.89543%208.00089%206%208.00089Z'%20fill='%23373435'/%3e%3c/svg%3e",O$="data:image/svg+xml,%3csvg%20width='20'%20height='26'%20viewBox='0%200%2020%2026'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M20%208.49958C20%2012.4578%2017.7002%2015.8789%2014.364%2017.4996H17.9999C18.276%2017.4996%2018.4999%2017.7235%2018.4999%2017.9996V23.9996C18.4999%2024.2758%2018.276%2024.4996%2017.9999%2024.4996H1.99988C1.72374%2024.4996%201.49988%2024.2758%201.49988%2023.9996V17.9996C1.49988%2017.7235%201.72374%2017.4996%201.99988%2017.4996H5.63598C2.29975%2015.8789%200%2012.4578%200%208.49958C0%205.84988%201.03055%203.44088%202.7127%201.65152C2.80472%201.55364%202.93386%201.5%203.0682%201.5H10L16.9318%201.5002C17.0661%201.5002%2017.1953%201.55385%2017.2873%201.65172C18.9694%203.44107%2020%205.84988%2020%208.49958ZM6.99976%207.00061C7.82818%207.00061%208.49976%206.32904%208.49976%205.50061C8.49976%204.67218%207.82818%204.00061%206.99976%204.00061C6.17133%204.00061%205.49976%204.67218%205.49976%205.50061C5.49976%206.32904%206.17133%207.00061%206.99976%207.00061ZM8.99963%2013.0002C8.99963%2014.1048%208.1042%2015.0002%206.99963%2015.0002C5.89506%2015.0002%204.99963%2014.1048%204.99963%2013.0002C4.99963%2011.8957%205.89506%2011.0002%206.99963%2011.0002C8.1042%2011.0002%208.99963%2011.8957%208.99963%2013.0002ZM12.9998%207.00061C13.8282%207.00061%2014.4998%206.32904%2014.4998%205.50061C14.4998%204.67218%2013.8282%204.00061%2012.9998%204.00061C12.1713%204.00061%2011.4998%204.67218%2011.4998%205.50061C11.4998%206.32904%2012.1713%207.00061%2012.9998%207.00061ZM14.9996%2013.0002C14.9996%2014.1048%2014.1042%2015.0002%2012.9996%2015.0002C11.8951%2015.0002%2010.9996%2014.1048%2010.9996%2013.0002C10.9996%2011.8957%2011.8951%2011.0002%2012.9996%2011.0002C14.1042%2011.0002%2014.9996%2011.8957%2014.9996%2013.0002ZM14.4998%2023.0001C15.6043%2023.0001%2016.4998%2022.1047%2016.4998%2021.0001C16.4998%2019.8956%2015.6043%2019.0001%2014.4998%2019.0001C13.3952%2019.0001%2012.4998%2019.8956%2012.4998%2021.0001C12.4998%2022.1047%2013.3952%2023.0001%2014.4998%2023.0001ZM7.49951%2021.0001C7.49951%2022.1047%206.60408%2023.0001%205.49951%2023.0001C4.39494%2023.0001%203.49951%2022.1047%203.49951%2021.0001C3.49951%2019.8956%204.39494%2019.0001%205.49951%2019.0001C6.60408%2019.0001%207.49951%2019.8956%207.49951%2021.0001ZM9.99963%2011.0007C11.1042%2011.0007%2011.9996%2010.1053%2011.9996%209.00073C11.9996%207.89616%2011.1042%207.00073%209.99963%207.00073C8.89506%207.00073%207.99963%207.89616%207.99963%209.00073C7.99963%2010.1053%208.89506%2011.0007%209.99963%2011.0007ZM17.9999%209.00073C17.9999%2010.1053%2017.1044%2011.0007%2015.9999%2011.0007C14.8953%2011.0007%2013.9999%2010.1053%2013.9999%209.00073C13.9999%207.89616%2014.8953%207.00073%2015.9999%207.00073C17.1044%207.00073%2017.9999%207.89616%2017.9999%209.00073ZM4.00012%2011.0007C5.10469%2011.0007%206.00012%2010.1053%206.00012%209.00073C6.00012%207.89616%205.10469%207.00073%204.00012%207.00073C2.89555%207.00073%202.00012%207.89616%202.00012%209.00073C2.00012%2010.1053%202.89555%2011.0007%204.00012%2011.0007Z'%20fill='%23373435'/%3e%3c/svg%3e",I$="data:image/svg+xml,%3csvg%20width='20'%20height='26'%20viewBox='0%200%2020%2026'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M10%2021.4996C15.5228%2021.4996%2020%2017.0224%2020%2011.4996C20%208.84988%2018.9694%206.44107%2017.2873%204.65172C17.1953%204.55385%2017.0661%204.5002%2016.9318%204.5002L10%204.5H3.0682C2.93386%204.5%202.80472%204.55364%202.7127%204.65152C1.03055%206.44088%200%208.84988%200%2011.4996C0%2017.0224%204.47715%2021.4996%2010%2021.4996ZM7.49976%208.50061C7.49976%208.77675%207.2759%209.00061%206.99976%209.00061C6.72361%209.00061%206.49976%208.77675%206.49976%208.50061C6.49976%208.22447%206.72361%208.00061%206.99976%208.00061C7.2759%208.00061%207.49976%208.22447%207.49976%208.50061ZM8.49976%208.50061C8.49976%209.32904%207.82818%2010.0006%206.99976%2010.0006C6.17133%2010.0006%205.49976%209.32904%205.49976%208.50061C5.49976%207.67218%206.17133%207.00061%206.99976%207.00061C7.82818%207.00061%208.49976%207.67218%208.49976%208.50061ZM6.99963%2017.0002C7.55192%2017.0002%207.99963%2016.5525%207.99963%2016.0002C7.99963%2015.448%207.55192%2015.0002%206.99963%2015.0002C6.44735%2015.0002%205.99963%2015.448%205.99963%2016.0002C5.99963%2016.5525%206.44735%2017.0002%206.99963%2017.0002ZM6.99963%2018.0002C8.1042%2018.0002%208.99963%2017.1048%208.99963%2016.0002C8.99963%2014.8957%208.1042%2014.0002%206.99963%2014.0002C5.89506%2014.0002%204.99963%2014.8957%204.99963%2016.0002C4.99963%2017.1048%205.89506%2018.0002%206.99963%2018.0002ZM13.4998%208.50061C13.4998%208.77675%2013.2759%209.00061%2012.9998%209.00061C12.7236%209.00061%2012.4998%208.77675%2012.4998%208.50061C12.4998%208.22447%2012.7236%208.00061%2012.9998%208.00061C13.2759%208.00061%2013.4998%208.22447%2013.4998%208.50061ZM14.4998%208.50061C14.4998%209.32904%2013.8282%2010.0006%2012.9998%2010.0006C12.1713%2010.0006%2011.4998%209.32904%2011.4998%208.50061C11.4998%207.67218%2012.1713%207.00061%2012.9998%207.00061C13.8282%207.00061%2014.4998%207.67218%2014.4998%208.50061ZM12.9996%2017.0002C13.5519%2017.0002%2013.9996%2016.5525%2013.9996%2016.0002C13.9996%2015.448%2013.5519%2015.0002%2012.9996%2015.0002C12.4473%2015.0002%2011.9996%2015.448%2011.9996%2016.0002C11.9996%2016.5525%2012.4473%2017.0002%2012.9996%2017.0002ZM12.9996%2018.0002C14.1042%2018.0002%2014.9996%2017.1048%2014.9996%2016.0002C14.9996%2014.8957%2014.1042%2014.0002%2012.9996%2014.0002C11.8951%2014.0002%2010.9996%2014.8957%2010.9996%2016.0002C10.9996%2017.1048%2011.8951%2018.0002%2012.9996%2018.0002ZM10.9996%2012.0007C10.9996%2012.553%2010.5519%2013.0007%209.99963%2013.0007C9.44735%2013.0007%208.99963%2012.553%208.99963%2012.0007C8.99963%2011.4484%209.44735%2011.0007%209.99963%2011.0007C10.5519%2011.0007%2010.9996%2011.4484%2010.9996%2012.0007ZM11.9996%2012.0007C11.9996%2013.1053%2011.1042%2014.0007%209.99963%2014.0007C8.89506%2014.0007%207.99963%2013.1053%207.99963%2012.0007C7.99963%2010.8962%208.89506%2010.0007%209.99963%2010.0007C11.1042%2010.0007%2011.9996%2010.8962%2011.9996%2012.0007ZM15.9999%2013.0007C16.5522%2013.0007%2016.9999%2012.553%2016.9999%2012.0007C16.9999%2011.4484%2016.5522%2011.0007%2015.9999%2011.0007C15.4476%2011.0007%2014.9999%2011.4484%2014.9999%2012.0007C14.9999%2012.553%2015.4476%2013.0007%2015.9999%2013.0007ZM15.9999%2014.0007C17.1044%2014.0007%2017.9999%2013.1053%2017.9999%2012.0007C17.9999%2010.8962%2017.1044%2010.0007%2015.9999%2010.0007C14.8953%2010.0007%2013.9999%2010.8962%2013.9999%2012.0007C13.9999%2013.1053%2014.8953%2014.0007%2015.9999%2014.0007ZM5.00012%2012.0007C5.00012%2012.553%204.55241%2013.0007%204.00012%2013.0007C3.44784%2013.0007%203.00012%2012.553%203.00012%2012.0007C3.00012%2011.4484%203.44784%2011.0007%204.00012%2011.0007C4.55241%2011.0007%205.00012%2011.4484%205.00012%2012.0007ZM6.00012%2012.0007C6.00012%2013.1053%205.10469%2014.0007%204.00012%2014.0007C2.89555%2014.0007%202.00012%2013.1053%202.00012%2012.0007C2.00012%2010.8962%202.89555%2010.0007%204.00012%2010.0007C5.10469%2010.0007%206.00012%2010.8962%206.00012%2012.0007Z'%20fill='%23373435'/%3e%3c/svg%3e",P$="data:image/svg+xml,%3csvg%20width='20'%20height='26'%20viewBox='0%200%2020%2026'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M10%2021.4996C15.5228%2021.4996%2020%2017.0224%2020%2011.4996C20%208.84988%2018.9694%206.44107%2017.2873%204.65172C17.1953%204.55385%2017.0661%204.5002%2016.9318%204.5002L10%204.5H3.0682C2.93386%204.5%202.80472%204.55364%202.7127%204.65152C1.03055%206.44088%200%208.84988%200%2011.4996C0%2017.0224%204.47715%2021.4996%2010%2021.4996ZM4%2014.5C5.65685%2014.5%207%2013.1569%207%2011.5C7%209.84315%205.65685%208.5%204%208.5C2.34315%208.5%201%209.84315%201%2011.5C1%2013.1569%202.34315%2014.5%204%2014.5ZM19%2011.5C19%2013.1569%2017.6569%2014.5%2016%2014.5C14.3431%2014.5%2013%2013.1569%2013%2011.5C13%209.84315%2014.3431%208.5%2016%208.5C17.6569%208.5%2019%209.84315%2019%2011.5ZM10%2019C10.8284%2019%2011.5%2018.3284%2011.5%2017.5C11.5%2016.6716%2010.8284%2016%2010%2016C9.17157%2016%208.5%2016.6716%208.5%2017.5C8.5%2018.3284%209.17157%2019%2010%2019ZM7%2017.5C7%2018.0523%206.55228%2018.5%206%2018.5C5.44772%2018.5%205%2018.0523%205%2017.5C5%2016.9477%205.44772%2016.5%206%2016.5C6.55228%2016.5%207%2016.9477%207%2017.5ZM14%2018.5C14.5523%2018.5%2015%2018.0523%2015%2017.5C15%2016.9477%2014.5523%2016.5%2014%2016.5C13.4477%2016.5%2013%2016.9477%2013%2017.5C13%2018.0523%2013.4477%2018.5%2014%2018.5ZM11%206.5C11%207.05228%2010.5523%207.5%2010%207.5C9.44771%207.5%209%207.05228%209%206.5C9%205.94772%209.44771%205.5%2010%205.5C10.5523%205.5%2011%205.94772%2011%206.5ZM13%207.5C13.5523%207.5%2014%207.05228%2014%206.5C14%205.94772%2013.5523%205.5%2013%205.5C12.4477%205.5%2012%205.94772%2012%206.5C12%207.05228%2012.4477%207.5%2013%207.5ZM8%206.5C8%207.05228%207.55228%207.5%207%207.5C6.44772%207.5%206%207.05228%206%206.5C6%205.94772%206.44772%205.5%207%205.5C7.55228%205.5%208%205.94772%208%206.5ZM10%2010.5C10.5523%2010.5%2011%2010.0523%2011%209.5C11%208.94772%2010.5523%208.5%2010%208.5C9.44771%208.5%209%208.94772%209%209.5C9%2010.0523%209.44771%2010.5%2010%2010.5Z'%20fill='%23373435'/%3e%3c/svg%3e",R$="data:image/svg+xml,%3csvg%20width='20'%20height='26'%20viewBox='0%200%2020%2026'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M20%2013C20%2018.5228%2015.5228%2023%2010%2023C4.47715%2023%200%2018.5228%200%2013C0%2010.9662%200.607169%209.07413%201.65013%207.49529L0.900438%206.73775C0.717242%206.55263%200.717242%206.25251%200.900438%206.06739L3.10891%203.83582C3.2921%203.6507%203.58912%203.6507%203.77232%203.83582L4.54555%204.61715C6.11422%203.59438%207.9877%203%2010%203C12.0123%203%2013.8858%203.59438%2015.4544%204.61715L16.2277%203.83582C16.4109%203.6507%2016.7079%203.6507%2016.8911%203.83582L19.0996%206.06739C19.2828%206.25251%2019.2828%206.55263%2019.0996%206.73775L18.3499%207.49529C19.3928%209.07413%2020%2010.9662%2020%2013ZM11.9357%209.08218C12.2884%208.65122%2012.5%208.10032%2012.5%207.5C12.5%206.90031%2012.2888%206.34993%2011.9368%205.91916L10.3548%207.50122L11.9357%209.08218ZM11.5822%209.43574L10.0012%207.85478L8.41916%209.43684C8.84993%209.78885%209.40031%2010%2010%2010C10.6003%2010%2011.1512%209.78841%2011.5822%209.43574ZM8.06536%209.08353C7.71203%208.65236%207.5%208.10094%207.5%207.5C7.5%206.89968%207.71159%206.34878%208.06426%205.91782L9.64767%207.50122L8.06536%209.08353ZM8.41782%205.56426L10.0012%207.14767L11.5835%205.56536C11.1524%205.21203%2010.6009%205%2010%205C9.39968%205%208.84878%205.21159%208.41782%205.56426ZM12.5%2018.5006C12.5%2019.101%2012.2884%2019.6519%2011.9357%2020.0828L10.3548%2018.5019L11.9368%2016.9198C12.2888%2017.3506%2012.5%2017.9009%2012.5%2018.5006ZM10.0012%2018.8554L11.5822%2020.4364C11.1512%2020.789%2010.6003%2021.0006%2010%2021.0006C9.40031%2021.0006%208.84993%2020.7895%208.41916%2020.4375L10.0012%2018.8554ZM7.5%2018.5006C7.5%2019.1016%207.71203%2019.653%208.06536%2020.0842L9.64767%2018.5019L8.06426%2016.9185C7.71159%2017.3494%207.5%2017.9003%207.5%2018.5006ZM10.0012%2018.1483L8.41782%2016.5649C8.84878%2016.2122%209.39968%2016.0006%2010%2016.0006C10.6009%2016.0006%2011.1524%2016.2127%2011.5835%2016.566L10.0012%2018.1483ZM18%2013C18%2014.3807%2016.8807%2015.5%2015.5%2015.5C14.1193%2015.5%2013%2014.3807%2013%2013C13%2011.6193%2014.1193%2010.5%2015.5%2010.5C16.8807%2010.5%2018%2011.6193%2018%2013ZM4.5%2015.5C5.88071%2015.5%207%2014.3807%207%2013C7%2011.6193%205.88071%2010.5%204.5%2010.5C3.11929%2010.5%202%2011.6193%202%2013C2%2014.3807%203.11929%2015.5%204.5%2015.5Z'%20fill='%23373435'/%3e%3c/svg%3e",D$="data:image/svg+xml,%3csvg%20width='20'%20height='26'%20viewBox='0%200%2020%2026'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M10%2021.4996C15.5228%2021.4996%2020%2017.0224%2020%2011.4996V10.5006C20%207.18697%2017.3138%204.50015%2014.0001%204.50008L10%204.5H5.99997C2.6863%204.5%201.85829e-05%207.18678%202.62218e-06%2010.5005L0%2011.4996C0%2017.0224%204.47715%2021.4996%2010%2021.4996ZM10%2018C10.8284%2018%2011.5%2017.3284%2011.5%2016.5C11.5%2015.6716%2010.8284%2015%2010%2015C9.17157%2015%208.5%2015.6716%208.5%2016.5C8.5%2017.3284%209.17157%2018%2010%2018ZM7%2017C7%2017.5523%206.55228%2018%206%2018C5.44772%2018%205%2017.5523%205%2017C5%2016.4477%205.44772%2016%206%2016C6.55228%2016%207%2016.4477%207%2017ZM14%2018C14.5523%2018%2015%2017.5523%2015%2017C15%2016.4477%2014.5523%2016%2014%2016C13.4477%2016%2013%2016.4477%2013%2017C13%2017.5523%2013.4477%2018%2014%2018ZM8%208.5C8%2010.1569%206.65685%2011.5%205%2011.5C3.34315%2011.5%202%2010.1569%202%208.5C2%206.84315%203.34315%205.5%205%205.5C6.65685%205.5%208%206.84315%208%208.5ZM15%2011.5C16.6569%2011.5%2018%2010.1569%2018%208.5C18%206.84315%2016.6569%205.5%2015%205.5C13.3431%205.5%2012%206.84315%2012%208.5C12%2010.1569%2013.3431%2011.5%2015%2011.5Z'%20fill='%23373435'/%3e%3c/svg%3e",L$="/assets/unknown-type-lli7bkbL.png";var DC;(e=>{e.AVAILABLE="Доступна",e.CHARGING="Занята",e.INOPERATIVE="Не работает"})(DC||(DC={}));const C1={"Type 1":A$,"Type 2":C$,CCS1:M$,CCS2:O$,"GB/T (AC)":I$,"GB/T (DC)":P$,CHAdeMO:R$,Tesla:D$,Другой:L$},z8={Доступен:"green",Занят:"orange",Отключен:"grey","Нет соединения":"grey",Недоступен:"grey"},lg=["Type 1","Type 2","CCS1","CCS2","GB/T (AC)","GB/T (DC)","CHAdeMO","Tesla"],X_={connectors:[...lg],onlyAvailableStations:!1,minimalPower:0,isModified:!1,partOfName:"",shouldUpdateStations:!1},y5={Доступна:"green",Занята:"orange","Не работает":"grey"},k8={stationFilters:{connectors:[...lg],onlyAvailableStations:!1,minimalPower:0,isModified:!1,partOfName:"",shouldUpdateStations:!0},stations:[],sessionFilters:{connectors:[...lg],onlyPaidSessions:!1,durationInHours:0,isModified:!1,shouldUpdateSessions:!0},sessions:[],position:void 0,isInitTelegramSdk:void 0},B8=15,Va=Me.createContext({...k8,setStationFilters:e=>{},setStations:e=>{},setSessionFilters:e=>{},setSessions:e=>{},showSnackbar:e=>{},setPosition:e=>{},setRfidCard:e=>{},setPaymentMethod:e=>{},setMapViewState:e=>{}});var kv;(e=>{e.PREVIOUS_PAGE="prev_page"})(kv||(kv={}));var cg;(e=>{e.MAIN="main",e.STATIONS_LIST="stations_list"})(cg||(cg={}));var Bv;(e=>{e.PREVIOUS_PAGE="prev_page"})(Bv||(Bv={}));var Nv;(e=>{e.MAIN="main",e.SESSIONS_LIST="sessions_list"})(Nv||(Nv={}));var Td;(e=>{e.PREVIOUS_PAGE="prev_page",e.FROM_CHARGING_SESSION_ID="from_charging_session_id"})(Td||(Td={}));var xd;(e=>{e.MAIN="main",e.STATIONS_LIST="stations_list",e.ACTIVE_SESSION="active_session",e.SESSIONS_LIST="sessions_list"})(xd||(xd={}));var zx;(e=>{e.SEARCH_FOCUSED="search_focused"})(zx||(zx={}));const LC=(e,t)=>({minElectricPower:e.minimalPower,standards:e.connectors,stationStatus:e.onlyAvailableStations?DC.AVAILABLE:void 0,latitude:t==null?void 0:t.latitude.toString(),longitude:t==null?void 0:t.longitude.toString()});async function dl(e){const t=new Headers;e.token&&t.set("Authorization","Bearer "+e.token);const a={method:e.method,headers:t,keepalive:e.keepalive};e.content&&(e.isFiles?a.body=e.content:(a.body=JSON.stringify(e.content,(s,f)=>{if(f!==null)return f}),t.set("Content-Type","application/json")));try{const s=await fetch(e.url,a);let f;try{if(e.responseIsString&&s.ok)return{data:await s.text()};f=await s.json()}catch{}if(!f)return{};const v="error"in f;return{data:v?void 0:f,error:v?{status:f.status,error:f.error,message:f.message}:void 0}}catch(s){return console.log("err: ",s),{error:{status:500,error:"InternalServerError",message:"Ошибка выполнения запроса"}}}}const N8="https://94f72dc0a746.vps.myjino.ru/app/api/locations/",v5="https://94f72dc0a746.vps.myjino.ru/app/api/sessions/",x5="https://94f72dc0a746.vps.myjino.ru/app/api/card/",F8="https://94f72dc0a746.vps.myjino.ru/app/api/payment/",kb=F8+"method/",z$="https://94f72dc0a746.vps.myjino.ru/auth/login/",j8=async e=>dl({url:z$,method:"POST",content:e.userInitData}),k$=e=>{switch(e){case"AVAILABLE":return"Доступна";case"CHARGING":return"Занята";case"INOPERATIVE":return"Не работает";default:throw new Error("Conversion for station status not exists")}},B$=e=>{switch(e){case"AVAILABLE":return"Доступен";case"CHARGING":return"Занят";case"INOPERATIVE":return"Недоступен";case"OUTOFORDER":return"Отключен";case"UNKNOWN":return"Нет соединения";default:throw new Error("Conversion for connector status not exists")}},U8=e=>{switch(e){case"CCS1":return"CCS1";case"CCS2":return"CCS2";case"CHADEMO":return"CHAdeMO";case"GBT_AC":return"GB/T (AC)";case"GBT_DC":return"GB/T (DC)";case"TESLA":return"Tesla";case"TYPE_1":return"Type 1";case"TYPE_2":return"Type 2";default:return"Другой"}},V8=e=>{switch(e){case"CABLE":return"Кабель";case"SOCKET":return"Розетка";default:throw new Error("Conversion for connector format not exists")}},$8=e=>{switch(e){case"AC_1_PHASE":return"AC";case"AC_2_PHASE":case"AC_2_PHASE_SPLIT":return"AC-2";case"AC_3_PHASE":return"AC-3";case"DC":return"DC";default:throw new Error("Conversion for connector power type not exists")}},N$=e=>{switch(e){case"ENERGY":return"Энергия";case"FLAT":return"Начало зарядки";case"PARKING_TIME":return"Длительность парковки";case"TIME":return"Длительность";default:throw new Error("Conversion for tariff type not exists")}},F$=e=>{switch(e){case"RUB":return"руб";default:throw new Error("Conversion for tariff currency not exists")}},j$=e=>({latitude:e.latitude,longitude:e.longitude}),U$=e=>({weekday:e.weekday,occupancy_in_percentage:e.occupancy_in_percentage}),V$=e=>({evse_uid:e.evse_uid,id:e.id,status:B$(e.status),standard:U8(e.standard),format:V8(e.format),power_type:$8(e.power_type),max_voltage:e.max_voltage,max_amperage:e.max_amperage,max_electric_power:Number((e.max_electric_power/1e3).toFixed(2)),tariffs:e.tariffs?e.tariffs.map(t=>q8(t)):[]}),q8=e=>({type:N$(e.type),price:e.price,currency:F$(e.currency)}),iP=e=>({id:e.id+"",name:e.name,address:e.address,status:k$(e.status),description:e.description,coordinates:j$(e.coordinates),connectors:e.connectors.map(t=>V$(t)),images:e.images,metres_to_station:e.metres_to_station,occupation:e.occupation?e.occupation.map(t=>U$(t)):[]}),$$=e=>{switch(e){case"Доступна":return"AVAILABLE";case"Занята":return"CHARGING";case"Не работает":return"INOPERATIVE";default:throw new Error("Conversion for station status not exists")}},G8=e=>{switch(e){case"CCS1":return"CCS1";case"CCS2":return"CCS2";case"CHAdeMO":return"CHADEMO";case"GB/T (AC)":return"GBT_AC";case"GB/T (DC)":return"GBT_DC";case"Tesla":return"TESLA";case"Type 1":return"TYPE_1";case"Type 2":return"TYPE_2";default:return"OTHER"}},q$=e=>({station_id:e.station_id,station_name:e.station_name,station_address:e.station_address,evse_uid:e.evse_uid,connector_id:e.connector_id,standard:U8(e.standard),format:V8(e.format),power_type:$8(e.power_type),max_electric_power:e.max_electric_power!==void 0?Number((e.max_electric_power/1e3).toFixed(2)):void 0}),t3=e=>e<10?`0${e}`:`${e}`,Cv=e=>new Date(e.year,e.month-1,e.day,e.hours,e.minutes,e.seconds),b5=e=>({year:e.getFullYear(),month:e.getMonth()+1,day:e.getDate(),hours:e.getHours(),minutes:e.getMinutes(),seconds:e.getSeconds()}),H8=(e,t,a)=>`${t3(e)}:${t3(t)}:${t3(a)}`,Z8=(e,t,a)=>{const s=`${e===0?"":`${e}ч`} ${t===0?"":`${t}м`} ${a===0?"":`${a}сек`}`;return s.trim().length>0?s:"0сек"},kx=(e,t)=>{const a=Cv(e).getTime(),s=Cv(t).getTime(),f=new Date(a<s?s-a:a-s);return{year:0,month:0,day:0,hours:f.getUTCHours(),minutes:f.getUTCMinutes(),seconds:f.getUTCSeconds()}},aP=(e,t)=>{const a=new Date(e);return b5(a)},G$=e=>{switch(e){case"ACTIVE":return"Зарядка";case"COMPLETED":return"Завершена";case"INVALID":return"Невалидна"}throw new Error("Conversion for charging session status not exists")},H$=e=>{switch(e){case"PAID":return"Оплачено";case"UNPAID":return"Неоплачено"}throw new Error("Conversion for payment status not exists")},oP=e=>({id:e.id,connector_info:q$(e.connector_info),tariffs:e.tariffs?e.tariffs.map(t=>q8(t)):void 0,status:G$(e.status),charged_kwh:e.charged_kwh,current_power:e.current_power,max_power:e.max_power,min_power:e.min_power,start_date:aP(e.start_date),end_date:e.end_date?aP(e.end_date):void 0,total_cost:e.total_cost,payment_method:e.payment_method,payment_status:e.payment_status?H$(e.payment_status):void 0,battery_percentage:e.battery_percentage}),Z$=e=>{switch(e){case"Зарядка":return"ACTIVE";case"Завершена":return"COMPLETED";case"Невалидна":return"INVALID"}throw new Error("Conversion for charging session status not exists")},hl=e=>e.length?"?"+e.map(t=>t.value!==void 0?`${t.key}=${encodeURIComponent(t.value)}`:void 0).filter(t=>t!==void 0).join("&"):"",W$=e=>{var a;const t=[];if(e.priceGreaterThan!==void 0&&t.push({key:"priceGreaterThan",value:e.priceGreaterThan}),e.totalHoursGreaterThan!==void 0&&t.push({key:"totalHoursGreaterThan",value:e.totalHoursGreaterThan}),e.status!==void 0&&t.push({key:"status",value:Z$(e.status)}),(a=e.standards)!=null&&a.length){const s=e.standards.length===lg.length?e.standards.concat("Другой"):e.standards;t.push({key:"standards",value:s.map(f=>G8(f)).join(",")})}return e.limit!==void 0&&t.push({key:"limit",value:e.limit}),e.offset!==void 0&&t.push({key:"offset",value:e.offset}),t},X$=async e=>dl({url:v5+hl(W$(e)),method:"GET",token:e.token}),Y$=async e=>dl({url:v5+e.id,method:"GET",token:e.token}),K$=async e=>dl({url:v5+e.id+"/stop/",method:"POST",token:e.token}),J$=async e=>dl({url:F8+"retry/"+e.sessionId,method:"POST",token:e.token}),Q$=async e=>dl({url:kb+"new/",method:"POST",token:e.token}),eq=async e=>dl({url:kb,method:"GET",token:e.token,responseIsString:!0}),tq=async e=>dl({url:kb+"payurl/",method:"GET",token:e.token,responseIsString:!0}),nq=async e=>dl({url:kb+"detach/",method:"DELETE",token:e.token}),rq=async e=>dl({url:x5,method:"GET",token:e.token}),iq=async e=>dl({url:x5+"attach/"+hl([{key:"visualCardNumber",value:e.visualCardNumber}]),method:"PUT",token:e.token}),aq=async e=>dl({url:x5+"detach/"+hl([{key:"visualCardNumber",value:e.visualCardNumber}]),method:"DELETE",token:e.token}),oq=e=>({visual_number:e.visual_number,group:e.group}),sq=e=>{var a;const t=[];if(e.partOfName!==void 0&&t.push({key:"partOfName",value:e.partOfName}),e.latitude!==void 0&&t.push({key:"latitude",value:e.latitude}),e.longitude!==void 0&&t.push({key:"longitude",value:e.longitude}),e.stationStatus!==void 0&&t.push({key:"stationStatus",value:$$(e.stationStatus)}),e.minElectricPower!==void 0&&t.push({key:"minElectricPower",value:e.minElectricPower}),(a=e.standards)!=null&&a.length){const s=e.standards.length===lg.length?e.standards.concat("Другой"):e.standards;t.push({key:"standards",value:s.map(f=>G8(f)).join(",")})}return e.limit!==void 0&&t.push({key:"limit",value:e.limit}),e.offset!==void 0&&t.push({key:"offset",value:e.offset}),t},lq=e=>{const t=[];return e.latitude!==void 0&&t.push({key:"latitude",value:e.latitude}),e.longitude!==void 0&&t.push({key:"longitude",value:e.longitude}),t},cq=async e=>dl({url:N8+hl(sq(e)),method:"GET",token:e.token}),uq=async e=>dl({url:N8+e.id+hl(lq(e)),method:"GET",token:e.token});let n3;const Gl=async()=>{{if(!n3){const e=await j8({userInitData:window.Telegram.WebApp.initData});e.data&&(n3=e.data.token)}return n3}},nu=()=>({authorizationTelegramUserFromApi:async X=>{const K=await j8(X);if(K.data)return K.data.token},getStationsFromApi:async X=>{const K=await cq({...X,token:await Gl()});return K.data?K.data.map(ne=>iP(ne)):[]},getStationByIdFromApi:async X=>{const K=await uq({...X,token:await Gl()});if(K.data)return iP(K.data)},getChargingSessionsFromApi:async X=>{const K=await X$({...X,token:await Gl()});return K.data?K.data.map(ne=>oP(ne)):[]},getChargingSessionByIdFromApi:async X=>{const K=await Y$({...X,token:await Gl()});if(K.data)return oP(K.data)},stopChargingSessionFromApi:async X=>(await K$({...X,token:await Gl()})).error,getRfidCardFromApi:async X=>{const K=await rq({...X,token:await Gl()});if(K.data)return oq(K.data)},attachRfidCardFromApi:async X=>(await iq({...X,token:await Gl()})).error,detachRfidCardFromApi:async X=>(await aq({...X,token:await Gl()})).error,retryPaymentForChargingSessionFromApi:async X=>(await J$({...X,token:await Gl()})).error,createPaymentMethodFromApi:async X=>(await Q$({...X,token:await Gl()})).error,getPaymentMethodFromApi:async X=>{const K=await eq({...X,token:await Gl()});if(K.data!==void 0)return K.data},getPaymentUrlFromApi:async X=>{const K=await tq({...X,token:await Gl()});if(K.data!==void 0)return K.data},deletePaymentMethodFromApi:async X=>(await nq({...X,token:await Gl()})).error}),hq=()=>{const{getStationsFromApi:e}=nu(),{stationFilters:t,setStationFilters:a,setStations:s,position:f}=Me.useContext(Va),[v,S]=Me.useState(!0),i=j=>{e({...LC(t,f),partOfName:t.partOfName??j}).then(F=>{s(F)}).finally(()=>S(!1))};return Me.useEffect(()=>{t.shouldUpdateStations?i():S(!1)},[]),{getByOffsetAndLimit:(j,F)=>e({...LC(t),offset:j,limit:F}),updateStationsByName:j=>{S(!0),i(j),a({...t,partOfName:j,shouldUpdateStations:!0})},loading:v}},fq=()=>{const[e]=Db(),[t,a]=Me.useState({});return Me.useEffect(()=>{const s=e.get(zx.SEARCH_FOCUSED)==="true";a({search_focused:s})},[e]),{pageQueries:t}},dq="_listLayout__list_i507j_1",pq="_list__item_i507j_5",mq="_listLayout__blockButton_i507j_9",_q="_list_noSelection_i507j_15",H2={listLayout__list:dq,list__item:pq,listLayout__blockButton:mq,list_noSelection:_q},gq=(e,t)=>e==="fill"&&t?"fillWithIcon":e==="text"&&t?"textWithIcon":e,yq="_button_ni2a7_1",vq="_outlined_ni2a7_36",xq="_fill_ni2a7_41",bq="_fillWithIcon_ni2a7_46",wq="_icon_ni2a7_51",Sq="_iconSmall_ni2a7_57",Tq="_text_ni2a7_63",Eq="_textWithIcon_ni2a7_73",Aq="_outlinedDisabled_ni2a7_142",Cq="_fillDisabled_ni2a7_143",Mq="_fillWithIconDisabled_ni2a7_144",Oq="_iconDisabled_ni2a7_145",Iq="_iconSmallDisabled_ni2a7_146",Pq="_textDisabled_ni2a7_147",Rq="_textWithIconDisabled_ni2a7_148",r3={button:yq,outlined:vq,fill:xq,fillWithIcon:bq,icon:wq,iconSmall:Sq,text:Tq,textWithIcon:Eq,outlinedDisabled:Aq,fillDisabled:Cq,fillWithIconDisabled:Mq,iconDisabled:Oq,iconSmallDisabled:Iq,textDisabled:Pq,textWithIconDisabled:Rq};function Jl(e){const t=()=>{!e.loading&&!e.disabled&&e.onClick()},a=gq(e.variant,!!e.iconSrc);return he.jsxs("button",{onClick:t,disabled:e.disabled,className:`${r3.button} ${r3[a]} ${e.disabled?r3[a+"Disabled"]:""}`,children:[e.iconSrc&&!e.loading&&he.jsx("img",{src:e.iconSrc,alt:"Icon"}),e.text&&!a.startsWith("icon")&&he.jsx("a",{children:e.text})]})}var i3={exports:{}},a3,sP;function Dq(){if(sP)return a3;sP=1;var e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return a3=e,a3}var o3,lP;function Lq(){if(lP)return o3;lP=1;var e=Dq();function t(){}function a(){}return a.resetWarningCache=t,o3=function(){function s(S,i,O,z,j,F){if(F!==e){var G=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw G.name="Invariant Violation",G}}s.isRequired=s;function f(){return s}var v={array:s,bigint:s,bool:s,func:s,number:s,object:s,string:s,symbol:s,any:s,arrayOf:f,element:s,elementType:s,instanceOf:f,node:s,objectOf:f,oneOf:f,oneOfType:f,shape:f,exact:f,checkPropTypes:a,resetWarningCache:t};return v.PropTypes=v,v},o3}var cP;function zq(){return cP||(cP=1,i3.exports=Lq()()),i3.exports}var kq=zq();const wi=Ei(kq);function W8(e){var t,a,s="";if(typeof e=="string"||typeof e=="number")s+=e;else if(typeof e=="object")if(Array.isArray(e)){var f=e.length;for(t=0;t<f;t++)e[t]&&(a=W8(e[t]))&&(s&&(s+=" "),s+=a)}else for(a in e)e[a]&&(s&&(s+=" "),s+=a);return s}function oi(){for(var e,t,a=0,s="",f=arguments.length;a<f;a++)(e=arguments[a])&&(t=W8(e))&&(s&&(s+=" "),s+=t);return s}function Bq(e,t,a=void 0){const s={};for(const f in e){const v=e[f];let S="",i=!0;for(let O=0;O<v.length;O+=1){const z=v[O];z&&(S+=(i===!0?"":" ")+t(z),i=!1,a&&a[z]&&(S+=" "+a[z]))}s[f]=S}return s}function v0(e,...t){const a=new URL(`https://mui.com/production-error/?code=${e}`);return t.forEach(s=>a.searchParams.append("args[]",s)),`Minified MUI error #${e}; visit ${a} for the full message.`}function ug(e){if(typeof e!="string")throw new Error(v0(7));return e.charAt(0).toUpperCase()+e.slice(1)}var s3={exports:{}},Li={};/**
 * @license React
 * react-is.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var uP;function Nq(){if(uP)return Li;uP=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),f=Symbol.for("react.profiler"),v=Symbol.for("react.consumer"),S=Symbol.for("react.context"),i=Symbol.for("react.forward_ref"),O=Symbol.for("react.suspense"),z=Symbol.for("react.suspense_list"),j=Symbol.for("react.memo"),F=Symbol.for("react.lazy"),G=Symbol.for("react.offscreen"),Y=Symbol.for("react.client.reference");function X(K){if(typeof K=="object"&&K!==null){var ne=K.$$typeof;switch(ne){case e:switch(K=K.type,K){case a:case f:case s:case O:case z:return K;default:switch(K=K&&K.$$typeof,K){case S:case i:case F:case j:return K;case v:return K;default:return ne}}case t:return ne}}}return Li.ContextConsumer=v,Li.ContextProvider=S,Li.Element=e,Li.ForwardRef=i,Li.Fragment=a,Li.Lazy=F,Li.Memo=j,Li.Portal=t,Li.Profiler=f,Li.StrictMode=s,Li.Suspense=O,Li.SuspenseList=z,Li.isContextConsumer=function(K){return X(K)===v},Li.isContextProvider=function(K){return X(K)===S},Li.isElement=function(K){return typeof K=="object"&&K!==null&&K.$$typeof===e},Li.isForwardRef=function(K){return X(K)===i},Li.isFragment=function(K){return X(K)===a},Li.isLazy=function(K){return X(K)===F},Li.isMemo=function(K){return X(K)===j},Li.isPortal=function(K){return X(K)===t},Li.isProfiler=function(K){return X(K)===f},Li.isStrictMode=function(K){return X(K)===s},Li.isSuspense=function(K){return X(K)===O},Li.isSuspenseList=function(K){return X(K)===z},Li.isValidElementType=function(K){return typeof K=="string"||typeof K=="function"||K===a||K===f||K===s||K===O||K===z||K===G||typeof K=="object"&&K!==null&&(K.$$typeof===F||K.$$typeof===j||K.$$typeof===S||K.$$typeof===v||K.$$typeof===i||K.$$typeof===Y||K.getModuleId!==void 0)},Li.typeOf=X,Li}var hP;function Fq(){return hP||(hP=1,s3.exports=Nq()),s3.exports}var X8=Fq();function md(e){if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function Y8(e){if(Me.isValidElement(e)||X8.isValidElementType(e)||!md(e))return e;const t={};return Object.keys(e).forEach(a=>{t[a]=Y8(e[a])}),t}function Ql(e,t,a={clone:!0}){const s=a.clone?{...e}:e;return md(e)&&md(t)&&Object.keys(t).forEach(f=>{Me.isValidElement(t[f])||X8.isValidElementType(t[f])?s[f]=t[f]:md(t[f])&&Object.prototype.hasOwnProperty.call(e,f)&&md(e[f])?s[f]=Ql(e[f],t[f],a):a.clone?s[f]=md(t[f])?Y8(t[f]):t[f]:s[f]=t[f]}),s}function Mv(e,t){return t?Ql(e,t,{clone:!1}):e}function jq(e,t){if(!e.containerQueries)return t;const a=Object.keys(t).filter(s=>s.startsWith("@container")).sort((s,f)=>{var S,i;const v=/min-width:\s*([0-9.]+)/;return+(((S=s.match(v))==null?void 0:S[1])||0)-+(((i=f.match(v))==null?void 0:i[1])||0)});return a.length?a.reduce((s,f)=>{const v=t[f];return delete s[f],s[f]=v,s},{...t}):t}function Uq(e,t){return t==="@"||t.startsWith("@")&&(e.some(a=>t.startsWith(`@${a}`))||!!t.match(/^@\d/))}function Vq(e,t){const a=t.match(/^@([^/]+)?\/?(.+)?$/);if(!a)return null;const[,s,f]=a,v=Number.isNaN(+s)?s||0:+s;return e.containerQueries(f).up(v)}function $q(e){const t=(v,S)=>v.replace("@media",S?`@container ${S}`:"@container");function a(v,S){v.up=(...i)=>t(e.breakpoints.up(...i),S),v.down=(...i)=>t(e.breakpoints.down(...i),S),v.between=(...i)=>t(e.breakpoints.between(...i),S),v.only=(...i)=>t(e.breakpoints.only(...i),S),v.not=(...i)=>{const O=t(e.breakpoints.not(...i),S);return O.includes("not all and")?O.replace("not all and ","").replace("min-width:","width<").replace("max-width:","width>").replace("and","or"):O}}const s={},f=v=>(a(s,v),s);return a(f),{...e,containerQueries:f}}const Bb={xs:0,sm:600,md:900,lg:1200,xl:1536},fP={keys:["xs","sm","md","lg","xl"],up:e=>`@media (min-width:${Bb[e]}px)`},qq={containerQueries:e=>({up:t=>{let a=typeof t=="number"?t:Bb[t]||t;return typeof a=="number"&&(a=`${a}px`),e?`@container ${e} (min-width:${a})`:`@container (min-width:${a})`}})};function Ed(e,t,a){const s=e.theme||{};if(Array.isArray(t)){const v=s.breakpoints||fP;return t.reduce((S,i,O)=>(S[v.up(v.keys[O])]=a(t[O]),S),{})}if(typeof t=="object"){const v=s.breakpoints||fP;return Object.keys(t).reduce((S,i)=>{if(Uq(v.keys,i)){const O=Vq(s.containerQueries?s:qq,i);O&&(S[O]=a(t[i],i))}else if(Object.keys(v.values||Bb).includes(i)){const O=v.up(i);S[O]=a(t[i],i)}else{const O=i;S[O]=t[O]}return S},{})}return a(t)}function Gq(e={}){var a;return((a=e.keys)==null?void 0:a.reduce((s,f)=>{const v=e.up(f);return s[v]={},s},{}))||{}}function Hq(e,t){return e.reduce((a,s)=>{const f=a[s];return(!f||Object.keys(f).length===0)&&delete a[s],a},t)}function Nb(e,t,a=!0){if(!t||typeof t!="string")return null;if(e&&e.vars&&a){const s=`vars.${t}`.split(".").reduce((f,v)=>f&&f[v]?f[v]:null,e);if(s!=null)return s}return t.split(".").reduce((s,f)=>s&&s[f]!=null?s[f]:null,e)}function Bx(e,t,a,s=a){let f;return typeof e=="function"?f=e(a):Array.isArray(e)?f=e[a]||s:f=Nb(e,a)||s,t&&(f=t(f,s,e)),f}function Xa(e){const{prop:t,cssProperty:a=e.prop,themeKey:s,transform:f}=e,v=S=>{if(S[t]==null)return null;const i=S[t],O=S.theme,z=Nb(O,s)||{};return Ed(S,i,F=>{let G=Bx(z,f,F);return F===G&&typeof F=="string"&&(G=Bx(z,f,`${t}${F==="default"?"":ug(F)}`,F)),a===!1?G:{[a]:G}})};return v.propTypes={},v.filterProps=[t],v}function Zq(e){const t={};return a=>(t[a]===void 0&&(t[a]=e(a)),t[a])}const Wq={m:"margin",p:"padding"},Xq={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},dP={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},Yq=Zq(e=>{if(e.length>2)if(dP[e])e=dP[e];else return[e];const[t,a]=e.split(""),s=Wq[t],f=Xq[a]||"";return Array.isArray(f)?f.map(v=>s+v):[s+f]}),w5=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],S5=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"];[...w5,...S5];function M1(e,t,a,s){const f=Nb(e,t,!0)??a;return typeof f=="number"||typeof f=="string"?v=>typeof v=="string"?v:typeof f=="string"?`calc(${v} * ${f})`:f*v:Array.isArray(f)?v=>{if(typeof v=="string")return v;const S=Math.abs(v),i=f[S];return v>=0?i:typeof i=="number"?-i:`-${i}`}:typeof f=="function"?f:()=>{}}function T5(e){return M1(e,"spacing",8)}function O1(e,t){return typeof t=="string"||t==null?t:e(t)}function Kq(e,t){return a=>e.reduce((s,f)=>(s[f]=O1(t,a),s),{})}function Jq(e,t,a,s){if(!t.includes(a))return null;const f=Yq(a),v=Kq(f,s),S=e[a];return Ed(e,S,v)}function K8(e,t){const a=T5(e.theme);return Object.keys(e).map(s=>Jq(e,t,s,a)).reduce(Mv,{})}function Na(e){return K8(e,w5)}Na.propTypes={};Na.filterProps=w5;function Fa(e){return K8(e,S5)}Fa.propTypes={};Fa.filterProps=S5;function Fb(...e){const t=e.reduce((s,f)=>(f.filterProps.forEach(v=>{s[v]=f}),s),{}),a=s=>Object.keys(s).reduce((f,v)=>t[v]?Mv(f,t[v](s)):f,{});return a.propTypes={},a.filterProps=e.reduce((s,f)=>s.concat(f.filterProps),[]),a}function Kc(e){return typeof e!="number"?e:`${e}px solid`}function ru(e,t){return Xa({prop:e,themeKey:"borders",transform:t})}const Qq=ru("border",Kc),eG=ru("borderTop",Kc),tG=ru("borderRight",Kc),nG=ru("borderBottom",Kc),rG=ru("borderLeft",Kc),iG=ru("borderColor"),aG=ru("borderTopColor"),oG=ru("borderRightColor"),sG=ru("borderBottomColor"),lG=ru("borderLeftColor"),cG=ru("outline",Kc),uG=ru("outlineColor"),jb=e=>{if(e.borderRadius!==void 0&&e.borderRadius!==null){const t=M1(e.theme,"shape.borderRadius",4),a=s=>({borderRadius:O1(t,s)});return Ed(e,e.borderRadius,a)}return null};jb.propTypes={};jb.filterProps=["borderRadius"];Fb(Qq,eG,tG,nG,rG,iG,aG,oG,sG,lG,jb,cG,uG);const Ub=e=>{if(e.gap!==void 0&&e.gap!==null){const t=M1(e.theme,"spacing",8),a=s=>({gap:O1(t,s)});return Ed(e,e.gap,a)}return null};Ub.propTypes={};Ub.filterProps=["gap"];const Vb=e=>{if(e.columnGap!==void 0&&e.columnGap!==null){const t=M1(e.theme,"spacing",8),a=s=>({columnGap:O1(t,s)});return Ed(e,e.columnGap,a)}return null};Vb.propTypes={};Vb.filterProps=["columnGap"];const $b=e=>{if(e.rowGap!==void 0&&e.rowGap!==null){const t=M1(e.theme,"spacing",8),a=s=>({rowGap:O1(t,s)});return Ed(e,e.rowGap,a)}return null};$b.propTypes={};$b.filterProps=["rowGap"];const hG=Xa({prop:"gridColumn"}),fG=Xa({prop:"gridRow"}),dG=Xa({prop:"gridAutoFlow"}),pG=Xa({prop:"gridAutoColumns"}),mG=Xa({prop:"gridAutoRows"}),_G=Xa({prop:"gridTemplateColumns"}),gG=Xa({prop:"gridTemplateRows"}),yG=Xa({prop:"gridTemplateAreas"}),vG=Xa({prop:"gridArea"});Fb(Ub,Vb,$b,hG,fG,dG,pG,mG,_G,gG,yG,vG);function rg(e,t){return t==="grey"?t:e}const xG=Xa({prop:"color",themeKey:"palette",transform:rg}),bG=Xa({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:rg}),wG=Xa({prop:"backgroundColor",themeKey:"palette",transform:rg});Fb(xG,bG,wG);function Xl(e){return e<=1&&e!==0?`${e*100}%`:e}const SG=Xa({prop:"width",transform:Xl}),E5=e=>{if(e.maxWidth!==void 0&&e.maxWidth!==null){const t=a=>{var f,v,S,i,O;const s=((S=(v=(f=e.theme)==null?void 0:f.breakpoints)==null?void 0:v.values)==null?void 0:S[a])||Bb[a];return s?((O=(i=e.theme)==null?void 0:i.breakpoints)==null?void 0:O.unit)!=="px"?{maxWidth:`${s}${e.theme.breakpoints.unit}`}:{maxWidth:s}:{maxWidth:Xl(a)}};return Ed(e,e.maxWidth,t)}return null};E5.filterProps=["maxWidth"];const TG=Xa({prop:"minWidth",transform:Xl}),EG=Xa({prop:"height",transform:Xl}),AG=Xa({prop:"maxHeight",transform:Xl}),CG=Xa({prop:"minHeight",transform:Xl});Xa({prop:"size",cssProperty:"width",transform:Xl});Xa({prop:"size",cssProperty:"height",transform:Xl});const MG=Xa({prop:"boxSizing"});Fb(SG,E5,TG,EG,AG,CG,MG);const qb={border:{themeKey:"borders",transform:Kc},borderTop:{themeKey:"borders",transform:Kc},borderRight:{themeKey:"borders",transform:Kc},borderBottom:{themeKey:"borders",transform:Kc},borderLeft:{themeKey:"borders",transform:Kc},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},outline:{themeKey:"borders",transform:Kc},outlineColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:jb},color:{themeKey:"palette",transform:rg},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:rg},backgroundColor:{themeKey:"palette",transform:rg},p:{style:Fa},pt:{style:Fa},pr:{style:Fa},pb:{style:Fa},pl:{style:Fa},px:{style:Fa},py:{style:Fa},padding:{style:Fa},paddingTop:{style:Fa},paddingRight:{style:Fa},paddingBottom:{style:Fa},paddingLeft:{style:Fa},paddingX:{style:Fa},paddingY:{style:Fa},paddingInline:{style:Fa},paddingInlineStart:{style:Fa},paddingInlineEnd:{style:Fa},paddingBlock:{style:Fa},paddingBlockStart:{style:Fa},paddingBlockEnd:{style:Fa},m:{style:Na},mt:{style:Na},mr:{style:Na},mb:{style:Na},ml:{style:Na},mx:{style:Na},my:{style:Na},margin:{style:Na},marginTop:{style:Na},marginRight:{style:Na},marginBottom:{style:Na},marginLeft:{style:Na},marginX:{style:Na},marginY:{style:Na},marginInline:{style:Na},marginInlineStart:{style:Na},marginInlineEnd:{style:Na},marginBlock:{style:Na},marginBlockStart:{style:Na},marginBlockEnd:{style:Na},displayPrint:{cssProperty:!1,transform:e=>({"@media print":{display:e}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:Ub},rowGap:{style:$b},columnGap:{style:Vb},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:Xl},maxWidth:{style:E5},minWidth:{transform:Xl},height:{transform:Xl},maxHeight:{transform:Xl},minHeight:{transform:Xl},boxSizing:{},font:{themeKey:"font"},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}};function OG(...e){const t=e.reduce((s,f)=>s.concat(Object.keys(f)),[]),a=new Set(t);return e.every(s=>a.size===Object.keys(s).length)}function IG(e,t){return typeof e=="function"?e(t):e}function PG(){function e(a,s,f,v){const S={[a]:s,theme:f},i=v[a];if(!i)return{[a]:s};const{cssProperty:O=a,themeKey:z,transform:j,style:F}=i;if(s==null)return null;if(z==="typography"&&s==="inherit")return{[a]:s};const G=Nb(f,z)||{};return F?F(S):Ed(S,s,X=>{let K=Bx(G,j,X);return X===K&&typeof X=="string"&&(K=Bx(G,j,`${a}${X==="default"?"":ug(X)}`,X)),O===!1?K:{[O]:K}})}function t(a){const{sx:s,theme:f={}}=a||{};if(!s)return null;const v=f.unstable_sxConfig??qb;function S(i){let O=i;if(typeof i=="function")O=i(f);else if(typeof i!="object")return i;if(!O)return null;const z=Gq(f.breakpoints),j=Object.keys(z);let F=z;return Object.keys(O).forEach(G=>{const Y=IG(O[G],f);if(Y!=null)if(typeof Y=="object")if(v[G])F=Mv(F,e(G,Y,f,v));else{const X=Ed({theme:f},Y,K=>({[G]:K}));OG(X,Y)?F[G]=t({sx:Y,theme:f}):F=Mv(F,X)}else F=Mv(F,e(G,Y,f,v))}),jq(f,Hq(j,F))}return Array.isArray(s)?s.map(S):S(s)}return t}const hg=PG();hg.filterProps=["sx"];function zC(){return zC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},zC.apply(null,arguments)}function RG(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]}function DG(e){var t=document.createElement("style");return t.setAttribute("data-emotion",e.key),e.nonce!==void 0&&t.setAttribute("nonce",e.nonce),t.appendChild(document.createTextNode("")),t.setAttribute("data-s",""),t}var LG=function(){function e(a){var s=this;this._insertTag=function(f){var v;s.tags.length===0?s.insertionPoint?v=s.insertionPoint.nextSibling:s.prepend?v=s.container.firstChild:v=s.before:v=s.tags[s.tags.length-1].nextSibling,s.container.insertBefore(f,v),s.tags.push(f)},this.isSpeedy=a.speedy===void 0?!0:a.speedy,this.tags=[],this.ctr=0,this.nonce=a.nonce,this.key=a.key,this.container=a.container,this.prepend=a.prepend,this.insertionPoint=a.insertionPoint,this.before=null}var t=e.prototype;return t.hydrate=function(s){s.forEach(this._insertTag)},t.insert=function(s){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(DG(this));var f=this.tags[this.tags.length-1];if(this.isSpeedy){var v=RG(f);try{v.insertRule(s,v.cssRules.length)}catch{}}else f.appendChild(document.createTextNode(s));this.ctr++},t.flush=function(){this.tags.forEach(function(s){var f;return(f=s.parentNode)==null?void 0:f.removeChild(s)}),this.tags=[],this.ctr=0},e}(),bs="-ms-",Nx="-moz-",_i="-webkit-",J8="comm",A5="rule",C5="decl",zG="@import",Q8="@keyframes",kG="@layer",BG=Math.abs,Gb=String.fromCharCode,NG=Object.assign;function FG(e,t){return Yo(e,0)^45?(((t<<2^Yo(e,0))<<2^Yo(e,1))<<2^Yo(e,2))<<2^Yo(e,3):0}function e7(e){return e.trim()}function jG(e,t){return(e=t.exec(e))?e[0]:e}function gi(e,t,a){return e.replace(t,a)}function kC(e,t){return e.indexOf(t)}function Yo(e,t){return e.charCodeAt(t)|0}function Fv(e,t,a){return e.slice(t,a)}function Yh(e){return e.length}function M5(e){return e.length}function Z2(e,t){return t.push(e),e}function UG(e,t){return e.map(t).join("")}var Hb=1,fg=1,t7=0,fl=0,ro=0,Ng="";function Zb(e,t,a,s,f,v,S){return{value:e,root:t,parent:a,type:s,props:f,children:v,line:Hb,column:fg,length:S,return:""}}function Jy(e,t){return NG(Zb("",null,null,"",null,null,0),e,{length:-e.length},t)}function VG(){return ro}function $G(){return ro=fl>0?Yo(Ng,--fl):0,fg--,ro===10&&(fg=1,Hb--),ro}function ec(){return ro=fl<t7?Yo(Ng,fl++):0,fg++,ro===10&&(fg=1,Hb++),ro}function Qh(){return Yo(Ng,fl)}function Cx(){return fl}function I1(e,t){return Fv(Ng,e,t)}function jv(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function n7(e){return Hb=fg=1,t7=Yh(Ng=e),fl=0,[]}function r7(e){return Ng="",e}function Mx(e){return e7(I1(fl-1,BC(e===91?e+2:e===40?e+1:e)))}function qG(e){for(;(ro=Qh())&&ro<33;)ec();return jv(e)>2||jv(ro)>3?"":" "}function GG(e,t){for(;--t&&ec()&&!(ro<48||ro>102||ro>57&&ro<65||ro>70&&ro<97););return I1(e,Cx()+(t<6&&Qh()==32&&ec()==32))}function BC(e){for(;ec();)switch(ro){case e:return fl;case 34:case 39:e!==34&&e!==39&&BC(ro);break;case 40:e===41&&BC(e);break;case 92:ec();break}return fl}function HG(e,t){for(;ec()&&e+ro!==57;)if(e+ro===84&&Qh()===47)break;return"/*"+I1(t,fl-1)+"*"+Gb(e===47?e:ec())}function ZG(e){for(;!jv(Qh());)ec();return I1(e,fl)}function WG(e){return r7(Ox("",null,null,null,[""],e=n7(e),0,[0],e))}function Ox(e,t,a,s,f,v,S,i,O){for(var z=0,j=0,F=S,G=0,Y=0,X=0,K=1,ne=1,se=1,ge=0,_e="",xe=f,ae=v,ve=s,Se=_e;ne;)switch(X=ge,ge=ec()){case 40:if(X!=108&&Yo(Se,F-1)==58){kC(Se+=gi(Mx(ge),"&","&\f"),"&\f")!=-1&&(se=-1);break}case 34:case 39:case 91:Se+=Mx(ge);break;case 9:case 10:case 13:case 32:Se+=qG(X);break;case 92:Se+=GG(Cx()-1,7);continue;case 47:switch(Qh()){case 42:case 47:Z2(XG(HG(ec(),Cx()),t,a),O);break;default:Se+="/"}break;case 123*K:i[z++]=Yh(Se)*se;case 125*K:case 59:case 0:switch(ge){case 0:case 125:ne=0;case 59+j:se==-1&&(Se=gi(Se,/\f/g,"")),Y>0&&Yh(Se)-F&&Z2(Y>32?mP(Se+";",s,a,F-1):mP(gi(Se," ","")+";",s,a,F-2),O);break;case 59:Se+=";";default:if(Z2(ve=pP(Se,t,a,z,j,f,i,_e,xe=[],ae=[],F),v),ge===123)if(j===0)Ox(Se,t,ve,ve,xe,v,F,i,ae);else switch(G===99&&Yo(Se,3)===110?100:G){case 100:case 108:case 109:case 115:Ox(e,ve,ve,s&&Z2(pP(e,ve,ve,0,0,f,i,_e,f,xe=[],F),ae),f,ae,F,i,s?xe:ae);break;default:Ox(Se,ve,ve,ve,[""],ae,0,i,ae)}}z=j=Y=0,K=se=1,_e=Se="",F=S;break;case 58:F=1+Yh(Se),Y=X;default:if(K<1){if(ge==123)--K;else if(ge==125&&K++==0&&$G()==125)continue}switch(Se+=Gb(ge),ge*K){case 38:se=j>0?1:(Se+="\f",-1);break;case 44:i[z++]=(Yh(Se)-1)*se,se=1;break;case 64:Qh()===45&&(Se+=Mx(ec())),G=Qh(),j=F=Yh(_e=Se+=ZG(Cx())),ge++;break;case 45:X===45&&Yh(Se)==2&&(K=0)}}return v}function pP(e,t,a,s,f,v,S,i,O,z,j){for(var F=f-1,G=f===0?v:[""],Y=M5(G),X=0,K=0,ne=0;X<s;++X)for(var se=0,ge=Fv(e,F+1,F=BG(K=S[X])),_e=e;se<Y;++se)(_e=e7(K>0?G[se]+" "+ge:gi(ge,/&\f/g,G[se])))&&(O[ne++]=_e);return Zb(e,t,a,f===0?A5:i,O,z,j)}function XG(e,t,a){return Zb(e,t,a,J8,Gb(VG()),Fv(e,2,-2),0)}function mP(e,t,a,s){return Zb(e,t,a,C5,Fv(e,0,s),Fv(e,s+1,-1),s)}function ig(e,t){for(var a="",s=M5(e),f=0;f<s;f++)a+=t(e[f],f,e,t)||"";return a}function YG(e,t,a,s){switch(e.type){case kG:if(e.children.length)break;case zG:case C5:return e.return=e.return||e.value;case J8:return"";case Q8:return e.return=e.value+"{"+ig(e.children,s)+"}";case A5:e.value=e.props.join(",")}return Yh(a=ig(e.children,s))?e.return=e.value+"{"+a+"}":""}function KG(e){var t=M5(e);return function(a,s,f,v){for(var S="",i=0;i<t;i++)S+=e[i](a,s,f,v)||"";return S}}function JG(e){return function(t){t.root||(t=t.return)&&e(t)}}function i7(e){var t=Object.create(null);return function(a){return t[a]===void 0&&(t[a]=e(a)),t[a]}}var QG=function(t,a,s){for(var f=0,v=0;f=v,v=Qh(),f===38&&v===12&&(a[s]=1),!jv(v);)ec();return I1(t,fl)},eH=function(t,a){var s=-1,f=44;do switch(jv(f)){case 0:f===38&&Qh()===12&&(a[s]=1),t[s]+=QG(fl-1,a,s);break;case 2:t[s]+=Mx(f);break;case 4:if(f===44){t[++s]=Qh()===58?"&\f":"",a[s]=t[s].length;break}default:t[s]+=Gb(f)}while(f=ec());return t},tH=function(t,a){return r7(eH(n7(t),a))},_P=new WeakMap,nH=function(t){if(!(t.type!=="rule"||!t.parent||t.length<1)){for(var a=t.value,s=t.parent,f=t.column===s.column&&t.line===s.line;s.type!=="rule";)if(s=s.parent,!s)return;if(!(t.props.length===1&&a.charCodeAt(0)!==58&&!_P.get(s))&&!f){_P.set(t,!0);for(var v=[],S=tH(a,v),i=s.props,O=0,z=0;O<S.length;O++)for(var j=0;j<i.length;j++,z++)t.props[z]=v[O]?S[O].replace(/&\f/g,i[j]):i[j]+" "+S[O]}}},rH=function(t){if(t.type==="decl"){var a=t.value;a.charCodeAt(0)===108&&a.charCodeAt(2)===98&&(t.return="",t.value="")}};function a7(e,t){switch(FG(e,t)){case 5103:return _i+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return _i+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return _i+e+Nx+e+bs+e+e;case 6828:case 4268:return _i+e+bs+e+e;case 6165:return _i+e+bs+"flex-"+e+e;case 5187:return _i+e+gi(e,/(\w+).+(:[^]+)/,_i+"box-$1$2"+bs+"flex-$1$2")+e;case 5443:return _i+e+bs+"flex-item-"+gi(e,/flex-|-self/,"")+e;case 4675:return _i+e+bs+"flex-line-pack"+gi(e,/align-content|flex-|-self/,"")+e;case 5548:return _i+e+bs+gi(e,"shrink","negative")+e;case 5292:return _i+e+bs+gi(e,"basis","preferred-size")+e;case 6060:return _i+"box-"+gi(e,"-grow","")+_i+e+bs+gi(e,"grow","positive")+e;case 4554:return _i+gi(e,/([^-])(transform)/g,"$1"+_i+"$2")+e;case 6187:return gi(gi(gi(e,/(zoom-|grab)/,_i+"$1"),/(image-set)/,_i+"$1"),e,"")+e;case 5495:case 3959:return gi(e,/(image-set\([^]*)/,_i+"$1$`$1");case 4968:return gi(gi(e,/(.+:)(flex-)?(.*)/,_i+"box-pack:$3"+bs+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+_i+e+e;case 4095:case 3583:case 4068:case 2532:return gi(e,/(.+)-inline(.+)/,_i+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Yh(e)-1-t>6)switch(Yo(e,t+1)){case 109:if(Yo(e,t+4)!==45)break;case 102:return gi(e,/(.+:)(.+)-([^]+)/,"$1"+_i+"$2-$3$1"+Nx+(Yo(e,t+3)==108?"$3":"$2-$3"))+e;case 115:return~kC(e,"stretch")?a7(gi(e,"stretch","fill-available"),t)+e:e}break;case 4949:if(Yo(e,t+1)!==115)break;case 6444:switch(Yo(e,Yh(e)-3-(~kC(e,"!important")&&10))){case 107:return gi(e,":",":"+_i)+e;case 101:return gi(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+_i+(Yo(e,14)===45?"inline-":"")+"box$3$1"+_i+"$2$3$1"+bs+"$2box$3")+e}break;case 5936:switch(Yo(e,t+11)){case 114:return _i+e+bs+gi(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return _i+e+bs+gi(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return _i+e+bs+gi(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return _i+e+bs+e+e}return e}var iH=function(t,a,s,f){if(t.length>-1&&!t.return)switch(t.type){case C5:t.return=a7(t.value,t.length);break;case Q8:return ig([Jy(t,{value:gi(t.value,"@","@"+_i)})],f);case A5:if(t.length)return UG(t.props,function(v){switch(jG(v,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return ig([Jy(t,{props:[gi(v,/:(read-\w+)/,":"+Nx+"$1")]})],f);case"::placeholder":return ig([Jy(t,{props:[gi(v,/:(plac\w+)/,":"+_i+"input-$1")]}),Jy(t,{props:[gi(v,/:(plac\w+)/,":"+Nx+"$1")]}),Jy(t,{props:[gi(v,/:(plac\w+)/,bs+"input-$1")]})],f)}return""})}},aH=[iH],oH=function(t){var a=t.key;if(a==="css"){var s=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(s,function(K){var ne=K.getAttribute("data-emotion");ne.indexOf(" ")!==-1&&(document.head.appendChild(K),K.setAttribute("data-s",""))})}var f=t.stylisPlugins||aH,v={},S,i=[];S=t.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+a+' "]'),function(K){for(var ne=K.getAttribute("data-emotion").split(" "),se=1;se<ne.length;se++)v[ne[se]]=!0;i.push(K)});var O,z=[nH,rH];{var j,F=[YG,JG(function(K){j.insert(K)})],G=KG(z.concat(f,F)),Y=function(ne){return ig(WG(ne),G)};O=function(ne,se,ge,_e){j=ge,Y(ne?ne+"{"+se.styles+"}":se.styles),_e&&(X.inserted[se.name]=!0)}}var X={key:a,sheet:new LG({key:a,container:S,nonce:t.nonce,speedy:t.speedy,prepend:t.prepend,insertionPoint:t.insertionPoint}),nonce:t.nonce,inserted:v,registered:{},insert:O};return X.sheet.hydrate(i),X},l3={exports:{}},Si={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gP;function sH(){if(gP)return Si;gP=1;var e=typeof Symbol=="function"&&Symbol.for,t=e?Symbol.for("react.element"):60103,a=e?Symbol.for("react.portal"):60106,s=e?Symbol.for("react.fragment"):60107,f=e?Symbol.for("react.strict_mode"):60108,v=e?Symbol.for("react.profiler"):60114,S=e?Symbol.for("react.provider"):60109,i=e?Symbol.for("react.context"):60110,O=e?Symbol.for("react.async_mode"):60111,z=e?Symbol.for("react.concurrent_mode"):60111,j=e?Symbol.for("react.forward_ref"):60112,F=e?Symbol.for("react.suspense"):60113,G=e?Symbol.for("react.suspense_list"):60120,Y=e?Symbol.for("react.memo"):60115,X=e?Symbol.for("react.lazy"):60116,K=e?Symbol.for("react.block"):60121,ne=e?Symbol.for("react.fundamental"):60117,se=e?Symbol.for("react.responder"):60118,ge=e?Symbol.for("react.scope"):60119;function _e(ae){if(typeof ae=="object"&&ae!==null){var ve=ae.$$typeof;switch(ve){case t:switch(ae=ae.type,ae){case O:case z:case s:case v:case f:case F:return ae;default:switch(ae=ae&&ae.$$typeof,ae){case i:case j:case X:case Y:case S:return ae;default:return ve}}case a:return ve}}}function xe(ae){return _e(ae)===z}return Si.AsyncMode=O,Si.ConcurrentMode=z,Si.ContextConsumer=i,Si.ContextProvider=S,Si.Element=t,Si.ForwardRef=j,Si.Fragment=s,Si.Lazy=X,Si.Memo=Y,Si.Portal=a,Si.Profiler=v,Si.StrictMode=f,Si.Suspense=F,Si.isAsyncMode=function(ae){return xe(ae)||_e(ae)===O},Si.isConcurrentMode=xe,Si.isContextConsumer=function(ae){return _e(ae)===i},Si.isContextProvider=function(ae){return _e(ae)===S},Si.isElement=function(ae){return typeof ae=="object"&&ae!==null&&ae.$$typeof===t},Si.isForwardRef=function(ae){return _e(ae)===j},Si.isFragment=function(ae){return _e(ae)===s},Si.isLazy=function(ae){return _e(ae)===X},Si.isMemo=function(ae){return _e(ae)===Y},Si.isPortal=function(ae){return _e(ae)===a},Si.isProfiler=function(ae){return _e(ae)===v},Si.isStrictMode=function(ae){return _e(ae)===f},Si.isSuspense=function(ae){return _e(ae)===F},Si.isValidElementType=function(ae){return typeof ae=="string"||typeof ae=="function"||ae===s||ae===z||ae===v||ae===f||ae===F||ae===G||typeof ae=="object"&&ae!==null&&(ae.$$typeof===X||ae.$$typeof===Y||ae.$$typeof===S||ae.$$typeof===i||ae.$$typeof===j||ae.$$typeof===ne||ae.$$typeof===se||ae.$$typeof===ge||ae.$$typeof===K)},Si.typeOf=_e,Si}var yP;function lH(){return yP||(yP=1,l3.exports=sH()),l3.exports}var c3,vP;function cH(){if(vP)return c3;vP=1;var e=lH(),t={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},a={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},s={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},f={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},v={};v[e.ForwardRef]=s,v[e.Memo]=f;function S(X){return e.isMemo(X)?f:v[X.$$typeof]||t}var i=Object.defineProperty,O=Object.getOwnPropertyNames,z=Object.getOwnPropertySymbols,j=Object.getOwnPropertyDescriptor,F=Object.getPrototypeOf,G=Object.prototype;function Y(X,K,ne){if(typeof K!="string"){if(G){var se=F(K);se&&se!==G&&Y(X,se,ne)}var ge=O(K);z&&(ge=ge.concat(z(K)));for(var _e=S(X),xe=S(K),ae=0;ae<ge.length;++ae){var ve=ge[ae];if(!a[ve]&&!(ne&&ne[ve])&&!(xe&&xe[ve])&&!(_e&&_e[ve])){var Se=j(K,ve);try{i(X,ve,Se)}catch{}}}}return X}return c3=Y,c3}cH();var uH=!0;function o7(e,t,a){var s="";return a.split(" ").forEach(function(f){e[f]!==void 0?t.push(e[f]+";"):f&&(s+=f+" ")}),s}var O5=function(t,a,s){var f=t.key+"-"+a.name;(s===!1||uH===!1)&&t.registered[f]===void 0&&(t.registered[f]=a.styles)},s7=function(t,a,s){O5(t,a,s);var f=t.key+"-"+a.name;if(t.inserted[a.name]===void 0){var v=a;do t.insert(a===v?"."+f:"",v,t.sheet,!0),v=v.next;while(v!==void 0)}};function hH(e){for(var t=0,a,s=0,f=e.length;f>=4;++s,f-=4)a=e.charCodeAt(s)&255|(e.charCodeAt(++s)&255)<<8|(e.charCodeAt(++s)&255)<<16|(e.charCodeAt(++s)&255)<<24,a=(a&65535)*1540483477+((a>>>16)*59797<<16),a^=a>>>24,t=(a&65535)*1540483477+((a>>>16)*59797<<16)^(t&65535)*1540483477+((t>>>16)*59797<<16);switch(f){case 3:t^=(e.charCodeAt(s+2)&255)<<16;case 2:t^=(e.charCodeAt(s+1)&255)<<8;case 1:t^=e.charCodeAt(s)&255,t=(t&65535)*1540483477+((t>>>16)*59797<<16)}return t^=t>>>13,t=(t&65535)*1540483477+((t>>>16)*59797<<16),((t^t>>>15)>>>0).toString(36)}var fH={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},dH=/[A-Z]|^ms/g,pH=/_EMO_([^_]+?)_([^]*?)_EMO_/g,l7=function(t){return t.charCodeAt(1)===45},xP=function(t){return t!=null&&typeof t!="boolean"},u3=i7(function(e){return l7(e)?e:e.replace(dH,"-$&").toLowerCase()}),bP=function(t,a){switch(t){case"animation":case"animationName":if(typeof a=="string")return a.replace(pH,function(s,f,v){return Kh={name:f,styles:v,next:Kh},f})}return fH[t]!==1&&!l7(t)&&typeof a=="number"&&a!==0?a+"px":a};function Uv(e,t,a){if(a==null)return"";var s=a;if(s.__emotion_styles!==void 0)return s;switch(typeof a){case"boolean":return"";case"object":{var f=a;if(f.anim===1)return Kh={name:f.name,styles:f.styles,next:Kh},f.name;var v=a;if(v.styles!==void 0){var S=v.next;if(S!==void 0)for(;S!==void 0;)Kh={name:S.name,styles:S.styles,next:Kh},S=S.next;var i=v.styles+";";return i}return mH(e,t,a)}case"function":{if(e!==void 0){var O=Kh,z=a(e);return Kh=O,Uv(e,t,z)}break}}var j=a;if(t==null)return j;var F=t[j];return F!==void 0?F:j}function mH(e,t,a){var s="";if(Array.isArray(a))for(var f=0;f<a.length;f++)s+=Uv(e,t,a[f])+";";else for(var v in a){var S=a[v];if(typeof S!="object"){var i=S;t!=null&&t[i]!==void 0?s+=v+"{"+t[i]+"}":xP(i)&&(s+=u3(v)+":"+bP(v,i)+";")}else if(Array.isArray(S)&&typeof S[0]=="string"&&(t==null||t[S[0]]===void 0))for(var O=0;O<S.length;O++)xP(S[O])&&(s+=u3(v)+":"+bP(v,S[O])+";");else{var z=Uv(e,t,S);switch(v){case"animation":case"animationName":{s+=u3(v)+":"+z+";";break}default:s+=v+"{"+z+"}"}}}return s}var wP=/label:\s*([^\s;{]+)\s*(;|$)/g,Kh;function Wb(e,t,a){if(e.length===1&&typeof e[0]=="object"&&e[0]!==null&&e[0].styles!==void 0)return e[0];var s=!0,f="";Kh=void 0;var v=e[0];if(v==null||v.raw===void 0)s=!1,f+=Uv(a,t,v);else{var S=v;f+=S[0]}for(var i=1;i<e.length;i++)if(f+=Uv(a,t,e[i]),s){var O=v;f+=O[i]}wP.lastIndex=0;for(var z="",j;(j=wP.exec(f))!==null;)z+="-"+j[1];var F=hH(f)+z;return{name:F,styles:f,next:Kh}}var _H=function(t){return t()},gH=GI.useInsertionEffect?GI.useInsertionEffect:!1,c7=gH||_H,u7=Me.createContext(typeof HTMLElement<"u"?oH({key:"css"}):null);u7.Provider;var h7=function(t){return Me.forwardRef(function(a,s){var f=Me.useContext(u7);return t(a,f,s)})},f7=Me.createContext({}),I5={}.hasOwnProperty,NC="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",yH=function(t,a){var s={};for(var f in a)I5.call(a,f)&&(s[f]=a[f]);return s[NC]=t,s},vH=function(t){var a=t.cache,s=t.serialized,f=t.isStringTag;return O5(a,s,f),c7(function(){return s7(a,s,f)}),null},xH=h7(function(e,t,a){var s=e.css;typeof s=="string"&&t.registered[s]!==void 0&&(s=t.registered[s]);var f=e[NC],v=[s],S="";typeof e.className=="string"?S=o7(t.registered,v,e.className):e.className!=null&&(S=e.className+" ");var i=Wb(v,void 0,Me.useContext(f7));S+=t.key+"-"+i.name;var O={};for(var z in e)I5.call(e,z)&&z!=="css"&&z!==NC&&(O[z]=e[z]);return O.className=S,a&&(O.ref=a),Me.createElement(Me.Fragment,null,Me.createElement(vH,{cache:t,serialized:i,isStringTag:typeof f=="string"}),Me.createElement(f,O))}),bH=xH,SP=function(t,a){var s=arguments;if(a==null||!I5.call(a,"css"))return Me.createElement.apply(void 0,s);var f=s.length,v=new Array(f);v[0]=bH,v[1]=yH(t,a);for(var S=2;S<f;S++)v[S]=s[S];return Me.createElement.apply(null,v)};(function(e){var t;t||(t=e.JSX||(e.JSX={}))})(SP||(SP={}));function P5(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return Wb(t)}function d7(){var e=P5.apply(void 0,arguments),t="animation-"+e.name;return{name:t,styles:"@keyframes "+t+"{"+e.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}var wH=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|disableRemotePlayback|download|draggable|encType|enterKeyHint|fetchpriority|fetchPriority|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,SH=i7(function(e){return wH.test(e)||e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)<91}),TH=SH,EH=function(t){return t!=="theme"},TP=function(t){return typeof t=="string"&&t.charCodeAt(0)>96?TH:EH},EP=function(t,a,s){var f;if(a){var v=a.shouldForwardProp;f=t.__emotion_forwardProp&&v?function(S){return t.__emotion_forwardProp(S)&&v(S)}:v}return typeof f!="function"&&s&&(f=t.__emotion_forwardProp),f},AH=function(t){var a=t.cache,s=t.serialized,f=t.isStringTag;return O5(a,s,f),c7(function(){return s7(a,s,f)}),null},CH=function e(t,a){var s=t.__emotion_real===t,f=s&&t.__emotion_base||t,v,S;a!==void 0&&(v=a.label,S=a.target);var i=EP(t,a,s),O=i||TP(f),z=!O("as");return function(){var j=arguments,F=s&&t.__emotion_styles!==void 0?t.__emotion_styles.slice(0):[];if(v!==void 0&&F.push("label:"+v+";"),j[0]==null||j[0].raw===void 0)F.push.apply(F,j);else{var G=j[0];F.push(G[0]);for(var Y=j.length,X=1;X<Y;X++)F.push(j[X],G[X])}var K=h7(function(ne,se,ge){var _e=z&&ne.as||f,xe="",ae=[],ve=ne;if(ne.theme==null){ve={};for(var Se in ne)ve[Se]=ne[Se];ve.theme=Me.useContext(f7)}typeof ne.className=="string"?xe=o7(se.registered,ae,ne.className):ne.className!=null&&(xe=ne.className+" ");var He=Wb(F.concat(ae),se.registered,ve);xe+=se.key+"-"+He.name,S!==void 0&&(xe+=" "+S);var Ge=z&&i===void 0?TP(_e):O,ye={};for(var Le in ne)z&&Le==="as"||Ge(Le)&&(ye[Le]=ne[Le]);return ye.className=xe,ge&&(ye.ref=ge),Me.createElement(Me.Fragment,null,Me.createElement(AH,{cache:se,serialized:He,isStringTag:typeof _e=="string"}),Me.createElement(_e,ye))});return K.displayName=v!==void 0?v:"Styled("+(typeof f=="string"?f:f.displayName||f.name||"Component")+")",K.defaultProps=t.defaultProps,K.__emotion_real=K,K.__emotion_base=f,K.__emotion_styles=F,K.__emotion_forwardProp=i,Object.defineProperty(K,"toString",{value:function(){return"."+S}}),K.withComponent=function(ne,se){var ge=e(ne,zC({},a,se,{shouldForwardProp:EP(K,se,!0)}));return ge.apply(void 0,F)},K}},MH=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],FC=CH.bind(null);MH.forEach(function(e){FC[e]=FC(e)});/**
 * @mui/styled-engine v6.4.6
 *
 * @license MIT
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */function OH(e,t){return FC(e,t)}function IH(e,t){Array.isArray(e.__emotion_styles)&&(e.__emotion_styles=t(e.__emotion_styles))}const AP=[];function CP(e){return AP[0]=e,Wb(AP)}const PH=e=>{const t=Object.keys(e).map(a=>({key:a,val:e[a]}))||[];return t.sort((a,s)=>a.val-s.val),t.reduce((a,s)=>({...a,[s.key]:s.val}),{})};function RH(e){const{values:t={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:a="px",step:s=5,...f}=e,v=PH(t),S=Object.keys(v);function i(G){return`@media (min-width:${typeof t[G]=="number"?t[G]:G}${a})`}function O(G){return`@media (max-width:${(typeof t[G]=="number"?t[G]:G)-s/100}${a})`}function z(G,Y){const X=S.indexOf(Y);return`@media (min-width:${typeof t[G]=="number"?t[G]:G}${a}) and (max-width:${(X!==-1&&typeof t[S[X]]=="number"?t[S[X]]:Y)-s/100}${a})`}function j(G){return S.indexOf(G)+1<S.length?z(G,S[S.indexOf(G)+1]):i(G)}function F(G){const Y=S.indexOf(G);return Y===0?i(S[1]):Y===S.length-1?O(S[Y]):z(G,S[S.indexOf(G)+1]).replace("@media","@media not all and")}return{keys:S,values:v,up:i,down:O,between:z,only:j,not:F,unit:a,...f}}const DH={borderRadius:4};function p7(e=8,t=T5({spacing:e})){if(e.mui)return e;const a=(...s)=>(s.length===0?[1]:s).map(v=>{const S=t(v);return typeof S=="number"?`${S}px`:S}).join(" ");return a.mui=!0,a}function LH(e,t){var s;const a=this;if(a.vars){if(!((s=a.colorSchemes)!=null&&s[e])||typeof a.getColorSchemeSelector!="function")return{};let f=a.getColorSchemeSelector(e);return f==="&"?t:((f.includes("data-")||f.includes("."))&&(f=`*:where(${f.replace(/\s*&$/,"")}) &`),{[f]:t})}return a.palette.mode===e?t:{}}function m7(e={},...t){const{breakpoints:a={},palette:s={},spacing:f,shape:v={},...S}=e,i=RH(a),O=p7(f);let z=Ql({breakpoints:i,direction:"ltr",components:{},palette:{mode:"light",...s},spacing:O,shape:{...DH,...v}},S);return z=$q(z),z.applyStyles=LH,z=t.reduce((j,F)=>Ql(j,F),z),z.unstable_sxConfig={...qb,...S==null?void 0:S.unstable_sxConfig},z.unstable_sx=function(F){return hg({sx:F,theme:this})},z}const MP=e=>e,zH=()=>{let e=MP;return{configure(t){e=t},generate(t){return e(t)},reset(){e=MP}}},kH=zH(),BH={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function _7(e,t,a="Mui"){const s=BH[t];return s?`${a}-${s}`:`${kH.generate(e)}-${t}`}function NH(e,t,a="Mui"){const s={};return t.forEach(f=>{s[f]=_7(e,f,a)}),s}function g7(e){const{variants:t,...a}=e,s={variants:t,style:CP(a),isProcessed:!0};return s.style===a||t&&t.forEach(f=>{typeof f.style!="function"&&(f.style=CP(f.style))}),s}const FH=m7();function h3(e){return e!=="ownerState"&&e!=="theme"&&e!=="sx"&&e!=="as"}function jH(e){return e?(t,a)=>a[e]:null}function UH(e,t,a){e.theme=qH(e.theme)?a:e.theme[t]||e.theme}function Ix(e,t){const a=typeof t=="function"?t(e):t;if(Array.isArray(a))return a.flatMap(s=>Ix(e,s));if(Array.isArray(a==null?void 0:a.variants)){let s;if(a.isProcessed)s=a.style;else{const{variants:f,...v}=a;s=v}return y7(e,a.variants,[s])}return a!=null&&a.isProcessed?a.style:a}function y7(e,t,a=[]){var f;let s;e:for(let v=0;v<t.length;v+=1){const S=t[v];if(typeof S.props=="function"){if(s??(s={...e,...e.ownerState,ownerState:e.ownerState}),!S.props(s))continue}else for(const i in S.props)if(e[i]!==S.props[i]&&((f=e.ownerState)==null?void 0:f[i])!==S.props[i])continue e;typeof S.style=="function"?(s??(s={...e,...e.ownerState,ownerState:e.ownerState}),a.push(S.style(s))):a.push(S.style)}return a}function VH(e={}){const{themeId:t,defaultTheme:a=FH,rootShouldForwardProp:s=h3,slotShouldForwardProp:f=h3}=e;function v(i){UH(i,t,a)}return(i,O={})=>{IH(i,ae=>ae.filter(ve=>ve!==hg));const{name:z,slot:j,skipVariantsResolver:F,skipSx:G,overridesResolver:Y=jH(HH(j)),...X}=O,K=F!==void 0?F:j&&j!=="Root"&&j!=="root"||!1,ne=G||!1;let se=h3;j==="Root"||j==="root"?se=s:j?se=f:GH(i)&&(se=void 0);const ge=OH(i,{shouldForwardProp:se,label:$H(),...X}),_e=ae=>{if(typeof ae=="function"&&ae.__emotion_real!==ae)return function(Se){return Ix(Se,ae)};if(md(ae)){const ve=g7(ae);return ve.variants?function(He){return Ix(He,ve)}:ve.style}return ae},xe=(...ae)=>{const ve=[],Se=ae.map(_e),He=[];if(ve.push(v),z&&Y&&He.push(function(ht){var yt,Vt;const Ft=(Vt=(yt=ht.theme.components)==null?void 0:yt[z])==null?void 0:Vt.styleOverrides;if(!Ft)return null;const _t={};for(const Ht in Ft)_t[Ht]=Ix(ht,Ft[Ht]);return Y(ht,_t)}),z&&!K&&He.push(function(ht){var _t,yt;const gt=ht.theme,Ft=(yt=(_t=gt==null?void 0:gt.components)==null?void 0:_t[z])==null?void 0:yt.variants;return Ft?y7(ht,Ft):null}),ne||He.push(hg),Array.isArray(Se[0])){const Le=Se.shift(),ht=new Array(ve.length).fill(""),gt=new Array(He.length).fill("");let Ft;Ft=[...ht,...Le,...gt],Ft.raw=[...ht,...Le.raw,...gt],ve.unshift(Ft)}const Ge=[...ve,...Se,...He],ye=ge(...Ge);return i.muiName&&(ye.muiName=i.muiName),ye};return ge.withConfig&&(xe.withConfig=ge.withConfig),xe}}function $H(e,t){return void 0}function qH(e){for(const t in e)return!1;return!0}function GH(e){return typeof e=="string"&&e.charCodeAt(0)>96}function HH(e){return e&&e.charAt(0).toLowerCase()+e.slice(1)}function jC(e,t){const a={...t};for(const s in e)if(Object.prototype.hasOwnProperty.call(e,s)){const f=s;if(f==="components"||f==="slots")a[f]={...e[f],...a[f]};else if(f==="componentsProps"||f==="slotProps"){const v=e[f],S=t[f];if(!S)a[f]=v||{};else if(!v)a[f]=S;else{a[f]={...S};for(const i in v)if(Object.prototype.hasOwnProperty.call(v,i)){const O=i;a[f][O]=jC(v[O],S[O])}}}else a[f]===void 0&&(a[f]=e[f])}return a}function ZH(e,t=Number.MIN_SAFE_INTEGER,a=Number.MAX_SAFE_INTEGER){return Math.max(t,Math.min(e,a))}function R5(e,t=0,a=1){return ZH(e,t,a)}function WH(e){e=e.slice(1);const t=new RegExp(`.{1,${e.length>=6?2:1}}`,"g");let a=e.match(t);return a&&a[0].length===1&&(a=a.map(s=>s+s)),a?`rgb${a.length===4?"a":""}(${a.map((s,f)=>f<3?parseInt(s,16):Math.round(parseInt(s,16)/255*1e3)/1e3).join(", ")})`:""}function Gp(e){if(e.type)return e;if(e.charAt(0)==="#")return Gp(WH(e));const t=e.indexOf("("),a=e.substring(0,t);if(!["rgb","rgba","hsl","hsla","color"].includes(a))throw new Error(v0(9,e));let s=e.substring(t+1,e.length-1),f;if(a==="color"){if(s=s.split(" "),f=s.shift(),s.length===4&&s[3].charAt(0)==="/"&&(s[3]=s[3].slice(1)),!["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].includes(f))throw new Error(v0(10,f))}else s=s.split(",");return s=s.map(v=>parseFloat(v)),{type:a,values:s,colorSpace:f}}const XH=e=>{const t=Gp(e);return t.values.slice(0,3).map((a,s)=>t.type.includes("hsl")&&s!==0?`${a}%`:a).join(" ")},bv=(e,t)=>{try{return XH(e)}catch{return e}};function Xb(e){const{type:t,colorSpace:a}=e;let{values:s}=e;return t.includes("rgb")?s=s.map((f,v)=>v<3?parseInt(f,10):f):t.includes("hsl")&&(s[1]=`${s[1]}%`,s[2]=`${s[2]}%`),t.includes("color")?s=`${a} ${s.join(" ")}`:s=`${s.join(", ")}`,`${t}(${s})`}function v7(e){e=Gp(e);const{values:t}=e,a=t[0],s=t[1]/100,f=t[2]/100,v=s*Math.min(f,1-f),S=(z,j=(z+a/30)%12)=>f-v*Math.max(Math.min(j-3,9-j,1),-1);let i="rgb";const O=[Math.round(S(0)*255),Math.round(S(8)*255),Math.round(S(4)*255)];return e.type==="hsla"&&(i+="a",O.push(t[3])),Xb({type:i,values:O})}function UC(e){e=Gp(e);let t=e.type==="hsl"||e.type==="hsla"?Gp(v7(e)).values:e.values;return t=t.map(a=>(e.type!=="color"&&(a/=255),a<=.03928?a/12.92:((a+.055)/1.055)**2.4)),Number((.2126*t[0]+.7152*t[1]+.0722*t[2]).toFixed(3))}function YH(e,t){const a=UC(e),s=UC(t);return(Math.max(a,s)+.05)/(Math.min(a,s)+.05)}function KH(e,t){return e=Gp(e),t=R5(t),(e.type==="rgb"||e.type==="hsl")&&(e.type+="a"),e.type==="color"?e.values[3]=`/${t}`:e.values[3]=t,Xb(e)}function W2(e,t,a){try{return KH(e,t)}catch{return e}}function D5(e,t){if(e=Gp(e),t=R5(t),e.type.includes("hsl"))e.values[2]*=1-t;else if(e.type.includes("rgb")||e.type.includes("color"))for(let a=0;a<3;a+=1)e.values[a]*=1-t;return Xb(e)}function Fi(e,t,a){try{return D5(e,t)}catch{return e}}function L5(e,t){if(e=Gp(e),t=R5(t),e.type.includes("hsl"))e.values[2]+=(100-e.values[2])*t;else if(e.type.includes("rgb"))for(let a=0;a<3;a+=1)e.values[a]+=(255-e.values[a])*t;else if(e.type.includes("color"))for(let a=0;a<3;a+=1)e.values[a]+=(1-e.values[a])*t;return Xb(e)}function ji(e,t,a){try{return L5(e,t)}catch{return e}}function JH(e,t=.15){return UC(e)>.5?D5(e,t):L5(e,t)}function X2(e,t,a){try{return JH(e,t)}catch{return e}}const QH=Me.createContext(void 0);function eZ(e){const{theme:t,name:a,props:s}=e;if(!t||!t.components||!t.components[a])return s;const f=t.components[a];return f.defaultProps?jC(f.defaultProps,s):!f.styleOverrides&&!f.variants?jC(f,s):s}function tZ({props:e,name:t}){const a=Me.useContext(QH);return eZ({props:e,name:t,theme:{components:a}})}const OP={theme:void 0};function nZ(e){let t,a;return function(f){let v=t;return(v===void 0||f.theme!==a)&&(OP.theme=f.theme,v=g7(e(OP)),t=v,a=f.theme),v}}function rZ(e=""){function t(...s){if(!s.length)return"";const f=s[0];return typeof f=="string"&&!f.match(/(#|\(|\)|(-?(\d*\.)?\d+)(px|em|%|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc))|^(-?(\d*\.)?\d+)$|(\d+ \d+ \d+)/)?`, var(--${e?`${e}-`:""}${f}${t(...s.slice(1))})`:`, ${f}`}return(s,...f)=>`var(--${e?`${e}-`:""}${s}${t(...f)})`}const IP=(e,t,a,s=[])=>{let f=e;t.forEach((v,S)=>{S===t.length-1?Array.isArray(f)?f[Number(v)]=a:f&&typeof f=="object"&&(f[v]=a):f&&typeof f=="object"&&(f[v]||(f[v]=s.includes(v)?[]:{}),f=f[v])})},iZ=(e,t,a)=>{function s(f,v=[],S=[]){Object.entries(f).forEach(([i,O])=>{(!a||a&&!a([...v,i]))&&O!=null&&(typeof O=="object"&&Object.keys(O).length>0?s(O,[...v,i],Array.isArray(O)?[...S,i]:S):t([...v,i],O,S))})}s(e)},aZ=(e,t)=>typeof t=="number"?["lineHeight","fontWeight","opacity","zIndex"].some(s=>e.includes(s))||e[e.length-1].toLowerCase().includes("opacity")?t:`${t}px`:t;function f3(e,t){const{prefix:a,shouldSkipGeneratingVar:s}=t||{},f={},v={},S={};return iZ(e,(i,O,z)=>{if((typeof O=="string"||typeof O=="number")&&(!s||!s(i,O))){const j=`--${a?`${a}-`:""}${i.join("-")}`,F=aZ(i,O);Object.assign(f,{[j]:F}),IP(v,i,`var(${j})`,z),IP(S,i,`var(${j}, ${F})`,z)}},i=>i[0]==="vars"),{css:f,vars:v,varsWithDefaults:S}}function oZ(e,t={}){const{getSelector:a=ne,disableCssColorScheme:s,colorSchemeSelector:f}=t,{colorSchemes:v={},components:S,defaultColorScheme:i="light",...O}=e,{vars:z,css:j,varsWithDefaults:F}=f3(O,t);let G=F;const Y={},{[i]:X,...K}=v;if(Object.entries(K||{}).forEach(([_e,xe])=>{const{vars:ae,css:ve,varsWithDefaults:Se}=f3(xe,t);G=Ql(G,Se),Y[_e]={css:ve,vars:ae}}),X){const{css:_e,vars:xe,varsWithDefaults:ae}=f3(X,t);G=Ql(G,ae),Y[i]={css:_e,vars:xe}}function ne(_e,xe){var ve,Se;let ae=f;if(f==="class"&&(ae=".%s"),f==="data"&&(ae="[data-%s]"),f!=null&&f.startsWith("data-")&&!f.includes("%s")&&(ae=`[${f}="%s"]`),_e){if(ae==="media")return e.defaultColorScheme===_e?":root":{[`@media (prefers-color-scheme: ${((Se=(ve=v[_e])==null?void 0:ve.palette)==null?void 0:Se.mode)||_e})`]:{":root":xe}};if(ae)return e.defaultColorScheme===_e?`:root, ${ae.replace("%s",String(_e))}`:ae.replace("%s",String(_e))}return":root"}return{vars:G,generateThemeVars:()=>{let _e={...z};return Object.entries(Y).forEach(([,{vars:xe}])=>{_e=Ql(_e,xe)}),_e},generateStyleSheets:()=>{var He,Ge;const _e=[],xe=e.defaultColorScheme||"light";function ae(ye,Le){Object.keys(Le).length&&_e.push(typeof ye=="string"?{[ye]:{...Le}}:ye)}ae(a(void 0,{...j}),j);const{[xe]:ve,...Se}=Y;if(ve){const{css:ye}=ve,Le=(Ge=(He=v[xe])==null?void 0:He.palette)==null?void 0:Ge.mode,ht=!s&&Le?{colorScheme:Le,...ye}:{...ye};ae(a(xe,{...ht}),ht)}return Object.entries(Se).forEach(([ye,{css:Le}])=>{var Ft,_t;const ht=(_t=(Ft=v[ye])==null?void 0:Ft.palette)==null?void 0:_t.mode,gt=!s&&ht?{colorScheme:ht,...Le}:{...Le};ae(a(ye,{...gt}),gt)}),_e}}}function sZ(e){return function(a){return e==="media"?`@media (prefers-color-scheme: ${a})`:e?e.startsWith("data-")&&!e.includes("%s")?`[${e}="${a}"] &`:e==="class"?`.${a} &`:e==="data"?`[data-${a}] &`:`${e.replace("%s",a)} &`:"&"}}const Vv={black:"#000",white:"#fff"},lZ={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"},D_={50:"#f3e5f5",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",700:"#7b1fa2"},L_={300:"#e57373",400:"#ef5350",500:"#f44336",700:"#d32f2f",800:"#c62828"},Qy={300:"#ffb74d",400:"#ffa726",500:"#ff9800",700:"#f57c00",900:"#e65100"},z_={50:"#e3f2fd",200:"#90caf9",400:"#42a5f5",700:"#1976d2",800:"#1565c0"},k_={300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",700:"#0288d1",900:"#01579b"},B_={300:"#81c784",400:"#66bb6a",500:"#4caf50",700:"#388e3c",800:"#2e7d32",900:"#1b5e20"};function x7(){return{text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:Vv.white,default:Vv.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}}}const cZ=x7();function b7(){return{text:{primary:Vv.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:Vv.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}}}const PP=b7();function RP(e,t,a,s){const f=s.light||s,v=s.dark||s*1.5;e[t]||(e.hasOwnProperty(a)?e[t]=e[a]:t==="light"?e.light=L5(e.main,f):t==="dark"&&(e.dark=D5(e.main,v)))}function uZ(e="light"){return e==="dark"?{main:z_[200],light:z_[50],dark:z_[400]}:{main:z_[700],light:z_[400],dark:z_[800]}}function hZ(e="light"){return e==="dark"?{main:D_[200],light:D_[50],dark:D_[400]}:{main:D_[500],light:D_[300],dark:D_[700]}}function fZ(e="light"){return e==="dark"?{main:L_[500],light:L_[300],dark:L_[700]}:{main:L_[700],light:L_[400],dark:L_[800]}}function dZ(e="light"){return e==="dark"?{main:k_[400],light:k_[300],dark:k_[700]}:{main:k_[700],light:k_[500],dark:k_[900]}}function pZ(e="light"){return e==="dark"?{main:B_[400],light:B_[300],dark:B_[700]}:{main:B_[800],light:B_[500],dark:B_[900]}}function mZ(e="light"){return e==="dark"?{main:Qy[400],light:Qy[300],dark:Qy[700]}:{main:"#ed6c02",light:Qy[500],dark:Qy[900]}}function z5(e){const{mode:t="light",contrastThreshold:a=3,tonalOffset:s=.2,...f}=e,v=e.primary||uZ(t),S=e.secondary||hZ(t),i=e.error||fZ(t),O=e.info||dZ(t),z=e.success||pZ(t),j=e.warning||mZ(t);function F(K){return YH(K,PP.text.primary)>=a?PP.text.primary:cZ.text.primary}const G=({color:K,name:ne,mainShade:se=500,lightShade:ge=300,darkShade:_e=700})=>{if(K={...K},!K.main&&K[se]&&(K.main=K[se]),!K.hasOwnProperty("main"))throw new Error(v0(11,ne?` (${ne})`:"",se));if(typeof K.main!="string")throw new Error(v0(12,ne?` (${ne})`:"",JSON.stringify(K.main)));return RP(K,"light",ge,s),RP(K,"dark",_e,s),K.contrastText||(K.contrastText=F(K.main)),K};let Y;return t==="light"?Y=x7():t==="dark"&&(Y=b7()),Ql({common:{...Vv},mode:t,primary:G({color:v,name:"primary"}),secondary:G({color:S,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:G({color:i,name:"error"}),warning:G({color:j,name:"warning"}),info:G({color:O,name:"info"}),success:G({color:z,name:"success"}),grey:lZ,contrastThreshold:a,getContrastText:F,augmentColor:G,tonalOffset:s,...Y},f)}function _Z(e){const t={};return Object.entries(e).forEach(s=>{const[f,v]=s;typeof v=="object"&&(t[f]=`${v.fontStyle?`${v.fontStyle} `:""}${v.fontVariant?`${v.fontVariant} `:""}${v.fontWeight?`${v.fontWeight} `:""}${v.fontStretch?`${v.fontStretch} `:""}${v.fontSize||""}${v.lineHeight?`/${v.lineHeight} `:""}${v.fontFamily||""}`)}),t}function gZ(e,t){return{toolbar:{minHeight:56,[e.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[e.up("sm")]:{minHeight:64}},...t}}function yZ(e){return Math.round(e*1e5)/1e5}const DP={textTransform:"uppercase"},LP='"Roboto", "Helvetica", "Arial", sans-serif';function vZ(e,t){const{fontFamily:a=LP,fontSize:s=14,fontWeightLight:f=300,fontWeightRegular:v=400,fontWeightMedium:S=500,fontWeightBold:i=700,htmlFontSize:O=16,allVariants:z,pxToRem:j,...F}=typeof t=="function"?t(e):t,G=s/14,Y=j||(ne=>`${ne/O*G}rem`),X=(ne,se,ge,_e,xe)=>({fontFamily:a,fontWeight:ne,fontSize:Y(se),lineHeight:ge,...a===LP?{letterSpacing:`${yZ(_e/se)}em`}:{},...xe,...z}),K={h1:X(f,96,1.167,-1.5),h2:X(f,60,1.2,-.5),h3:X(v,48,1.167,0),h4:X(v,34,1.235,.25),h5:X(v,24,1.334,0),h6:X(S,20,1.6,.15),subtitle1:X(v,16,1.75,.15),subtitle2:X(S,14,1.57,.1),body1:X(v,16,1.5,.15),body2:X(v,14,1.43,.15),button:X(S,14,1.75,.4,DP),caption:X(v,12,1.66,.4),overline:X(v,12,2.66,1,DP),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return Ql({htmlFontSize:O,pxToRem:Y,fontFamily:a,fontSize:s,fontWeightLight:f,fontWeightRegular:v,fontWeightMedium:S,fontWeightBold:i,...K},F,{clone:!1})}const xZ=.2,bZ=.14,wZ=.12;function oa(...e){return[`${e[0]}px ${e[1]}px ${e[2]}px ${e[3]}px rgba(0,0,0,${xZ})`,`${e[4]}px ${e[5]}px ${e[6]}px ${e[7]}px rgba(0,0,0,${bZ})`,`${e[8]}px ${e[9]}px ${e[10]}px ${e[11]}px rgba(0,0,0,${wZ})`].join(",")}const SZ=["none",oa(0,2,1,-1,0,1,1,0,0,1,3,0),oa(0,3,1,-2,0,2,2,0,0,1,5,0),oa(0,3,3,-2,0,3,4,0,0,1,8,0),oa(0,2,4,-1,0,4,5,0,0,1,10,0),oa(0,3,5,-1,0,5,8,0,0,1,14,0),oa(0,3,5,-1,0,6,10,0,0,1,18,0),oa(0,4,5,-2,0,7,10,1,0,2,16,1),oa(0,5,5,-3,0,8,10,1,0,3,14,2),oa(0,5,6,-3,0,9,12,1,0,3,16,2),oa(0,6,6,-3,0,10,14,1,0,4,18,3),oa(0,6,7,-4,0,11,15,1,0,4,20,3),oa(0,7,8,-4,0,12,17,2,0,5,22,4),oa(0,7,8,-4,0,13,19,2,0,5,24,4),oa(0,7,9,-4,0,14,21,2,0,5,26,4),oa(0,8,9,-5,0,15,22,2,0,6,28,5),oa(0,8,10,-5,0,16,24,2,0,6,30,5),oa(0,8,11,-5,0,17,26,2,0,6,32,5),oa(0,9,11,-5,0,18,28,2,0,7,34,6),oa(0,9,12,-6,0,19,29,2,0,7,36,6),oa(0,10,13,-6,0,20,31,3,0,8,38,7),oa(0,10,13,-6,0,21,33,3,0,8,40,7),oa(0,10,14,-6,0,22,35,3,0,8,42,7),oa(0,11,14,-7,0,23,36,3,0,9,44,8),oa(0,11,15,-7,0,24,38,3,0,9,46,8)],TZ={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},EZ={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function zP(e){return`${Math.round(e)}ms`}function AZ(e){if(!e)return 0;const t=e/36;return Math.min(Math.round((4+15*t**.25+t/5)*10),3e3)}function CZ(e){const t={...TZ,...e.easing},a={...EZ,...e.duration};return{getAutoHeightDuration:AZ,create:(f=["all"],v={})=>{const{duration:S=a.standard,easing:i=t.easeInOut,delay:O=0,...z}=v;return(Array.isArray(f)?f:[f]).map(j=>`${j} ${typeof S=="string"?S:zP(S)} ${i} ${typeof O=="string"?O:zP(O)}`).join(",")},...e,easing:t,duration:a}}const MZ={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500};function OZ(e){return md(e)||typeof e>"u"||typeof e=="string"||typeof e=="boolean"||typeof e=="number"||Array.isArray(e)}function w7(e={}){const t={...e};function a(s){const f=Object.entries(s);for(let v=0;v<f.length;v++){const[S,i]=f[v];!OZ(i)||S.startsWith("unstable_")?delete s[S]:md(i)&&(s[S]={...i},a(s[S]))}}return a(t),`import { unstable_createBreakpoints as createBreakpoints, createTransitions } from '@mui/material/styles';

const theme = ${JSON.stringify(t,null,2)};

theme.breakpoints = createBreakpoints(theme.breakpoints || {});
theme.transitions = createTransitions(theme.transitions || {});

export default theme;`}function VC(e={},...t){const{breakpoints:a,mixins:s={},spacing:f,palette:v={},transitions:S={},typography:i={},shape:O,...z}=e;if(e.vars&&e.generateThemeVars===void 0)throw new Error(v0(20));const j=z5(v),F=m7(e);let G=Ql(F,{mixins:gZ(F.breakpoints,s),palette:j,shadows:SZ.slice(),typography:vZ(j,i),transitions:CZ(S),zIndex:{...MZ}});return G=Ql(G,z),G=t.reduce((Y,X)=>Ql(Y,X),G),G.unstable_sxConfig={...qb,...z==null?void 0:z.unstable_sxConfig},G.unstable_sx=function(X){return hg({sx:X,theme:this})},G.toRuntimeSource=w7,G}function IZ(e){let t;return e<1?t=5.11916*e**2:t=4.5*Math.log(e+1)+2,Math.round(t*10)/1e3}const PZ=[...Array(25)].map((e,t)=>{if(t===0)return"none";const a=IZ(t);return`linear-gradient(rgba(255 255 255 / ${a}), rgba(255 255 255 / ${a}))`});function S7(e){return{inputPlaceholder:e==="dark"?.5:.42,inputUnderline:e==="dark"?.7:.42,switchTrackDisabled:e==="dark"?.2:.12,switchTrack:e==="dark"?.3:.38}}function T7(e){return e==="dark"?PZ:[]}function RZ(e){const{palette:t={mode:"light"},opacity:a,overlays:s,...f}=e,v=z5(t);return{palette:v,opacity:{...S7(v.mode),...a},overlays:s||T7(v.mode),...f}}function DZ(e){var t;return!!e[0].match(/(cssVarPrefix|colorSchemeSelector|rootSelector|typography|mixins|breakpoints|direction|transitions)/)||!!e[0].match(/sxConfig$/)||e[0]==="palette"&&!!((t=e[1])!=null&&t.match(/(mode|contrastThreshold|tonalOffset)/))}const LZ=e=>[...[...Array(25)].map((t,a)=>`--${e?`${e}-`:""}overlays-${a}`),`--${e?`${e}-`:""}palette-AppBar-darkBg`,`--${e?`${e}-`:""}palette-AppBar-darkColor`],zZ=e=>(t,a)=>{const s=e.rootSelector||":root",f=e.colorSchemeSelector;let v=f;if(f==="class"&&(v=".%s"),f==="data"&&(v="[data-%s]"),f!=null&&f.startsWith("data-")&&!f.includes("%s")&&(v=`[${f}="%s"]`),e.defaultColorScheme===t){if(t==="dark"){const S={};return LZ(e.cssVarPrefix).forEach(i=>{S[i]=a[i],delete a[i]}),v==="media"?{[s]:a,"@media (prefers-color-scheme: dark)":{[s]:S}}:v?{[v.replace("%s",t)]:S,[`${s}, ${v.replace("%s",t)}`]:a}:{[s]:{...a,...S}}}if(v&&v!=="media")return`${s}, ${v.replace("%s",String(t))}`}else if(t){if(v==="media")return{[`@media (prefers-color-scheme: ${String(t)})`]:{[s]:a}};if(v)return v.replace("%s",String(t))}return s};function kZ(e,t){t.forEach(a=>{e[a]||(e[a]={})})}function tn(e,t,a){!e[t]&&a&&(e[t]=a)}function wv(e){return typeof e!="string"||!e.startsWith("hsl")?e:v7(e)}function hd(e,t){`${t}Channel`in e||(e[`${t}Channel`]=bv(wv(e[t])))}function BZ(e){return typeof e=="number"?`${e}px`:typeof e=="string"||typeof e=="function"||Array.isArray(e)?e:"8px"}const Wh=e=>{try{return e()}catch{}},NZ=(e="mui")=>rZ(e);function d3(e,t,a,s){if(!t)return;t=t===!0?{}:t;const f=s==="dark"?"dark":"light";if(!a){e[s]=RZ({...t,palette:{mode:f,...t==null?void 0:t.palette}});return}const{palette:v,...S}=VC({...a,palette:{mode:f,...t==null?void 0:t.palette}});return e[s]={...t,palette:v,opacity:{...S7(f),...t==null?void 0:t.opacity},overlays:(t==null?void 0:t.overlays)||T7(f)},S}function FZ(e={},...t){const{colorSchemes:a={light:!0},defaultColorScheme:s,disableCssColorScheme:f=!1,cssVarPrefix:v="mui",shouldSkipGeneratingVar:S=DZ,colorSchemeSelector:i=a.light&&a.dark?"media":void 0,rootSelector:O=":root",...z}=e,j=Object.keys(a)[0],F=s||(a.light&&j!=="light"?"light":j),G=NZ(v),{[F]:Y,light:X,dark:K,...ne}=a,se={...ne};let ge=Y;if((F==="dark"&&!("dark"in a)||F==="light"&&!("light"in a))&&(ge=!0),!ge)throw new Error(v0(21,F));const _e=d3(se,ge,z,F);X&&!se.light&&d3(se,X,void 0,"light"),K&&!se.dark&&d3(se,K,void 0,"dark");let xe={defaultColorScheme:F,..._e,cssVarPrefix:v,colorSchemeSelector:i,rootSelector:O,getCssVar:G,colorSchemes:se,font:{..._Z(_e.typography),..._e.font},spacing:BZ(z.spacing)};Object.keys(xe.colorSchemes).forEach(Ge=>{const ye=xe.colorSchemes[Ge].palette,Le=ht=>{const gt=ht.split("-"),Ft=gt[1],_t=gt[2];return G(ht,ye[Ft][_t])};if(ye.mode==="light"&&(tn(ye.common,"background","#fff"),tn(ye.common,"onBackground","#000")),ye.mode==="dark"&&(tn(ye.common,"background","#000"),tn(ye.common,"onBackground","#fff")),kZ(ye,["Alert","AppBar","Avatar","Button","Chip","FilledInput","LinearProgress","Skeleton","Slider","SnackbarContent","SpeedDialAction","StepConnector","StepContent","Switch","TableCell","Tooltip"]),ye.mode==="light"){tn(ye.Alert,"errorColor",Fi(ye.error.light,.6)),tn(ye.Alert,"infoColor",Fi(ye.info.light,.6)),tn(ye.Alert,"successColor",Fi(ye.success.light,.6)),tn(ye.Alert,"warningColor",Fi(ye.warning.light,.6)),tn(ye.Alert,"errorFilledBg",Le("palette-error-main")),tn(ye.Alert,"infoFilledBg",Le("palette-info-main")),tn(ye.Alert,"successFilledBg",Le("palette-success-main")),tn(ye.Alert,"warningFilledBg",Le("palette-warning-main")),tn(ye.Alert,"errorFilledColor",Wh(()=>ye.getContrastText(ye.error.main))),tn(ye.Alert,"infoFilledColor",Wh(()=>ye.getContrastText(ye.info.main))),tn(ye.Alert,"successFilledColor",Wh(()=>ye.getContrastText(ye.success.main))),tn(ye.Alert,"warningFilledColor",Wh(()=>ye.getContrastText(ye.warning.main))),tn(ye.Alert,"errorStandardBg",ji(ye.error.light,.9)),tn(ye.Alert,"infoStandardBg",ji(ye.info.light,.9)),tn(ye.Alert,"successStandardBg",ji(ye.success.light,.9)),tn(ye.Alert,"warningStandardBg",ji(ye.warning.light,.9)),tn(ye.Alert,"errorIconColor",Le("palette-error-main")),tn(ye.Alert,"infoIconColor",Le("palette-info-main")),tn(ye.Alert,"successIconColor",Le("palette-success-main")),tn(ye.Alert,"warningIconColor",Le("palette-warning-main")),tn(ye.AppBar,"defaultBg",Le("palette-grey-100")),tn(ye.Avatar,"defaultBg",Le("palette-grey-400")),tn(ye.Button,"inheritContainedBg",Le("palette-grey-300")),tn(ye.Button,"inheritContainedHoverBg",Le("palette-grey-A100")),tn(ye.Chip,"defaultBorder",Le("palette-grey-400")),tn(ye.Chip,"defaultAvatarColor",Le("palette-grey-700")),tn(ye.Chip,"defaultIconColor",Le("palette-grey-700")),tn(ye.FilledInput,"bg","rgba(0, 0, 0, 0.06)"),tn(ye.FilledInput,"hoverBg","rgba(0, 0, 0, 0.09)"),tn(ye.FilledInput,"disabledBg","rgba(0, 0, 0, 0.12)"),tn(ye.LinearProgress,"primaryBg",ji(ye.primary.main,.62)),tn(ye.LinearProgress,"secondaryBg",ji(ye.secondary.main,.62)),tn(ye.LinearProgress,"errorBg",ji(ye.error.main,.62)),tn(ye.LinearProgress,"infoBg",ji(ye.info.main,.62)),tn(ye.LinearProgress,"successBg",ji(ye.success.main,.62)),tn(ye.LinearProgress,"warningBg",ji(ye.warning.main,.62)),tn(ye.Skeleton,"bg",`rgba(${Le("palette-text-primaryChannel")} / 0.11)`),tn(ye.Slider,"primaryTrack",ji(ye.primary.main,.62)),tn(ye.Slider,"secondaryTrack",ji(ye.secondary.main,.62)),tn(ye.Slider,"errorTrack",ji(ye.error.main,.62)),tn(ye.Slider,"infoTrack",ji(ye.info.main,.62)),tn(ye.Slider,"successTrack",ji(ye.success.main,.62)),tn(ye.Slider,"warningTrack",ji(ye.warning.main,.62));const ht=X2(ye.background.default,.8);tn(ye.SnackbarContent,"bg",ht),tn(ye.SnackbarContent,"color",Wh(()=>ye.getContrastText(ht))),tn(ye.SpeedDialAction,"fabHoverBg",X2(ye.background.paper,.15)),tn(ye.StepConnector,"border",Le("palette-grey-400")),tn(ye.StepContent,"border",Le("palette-grey-400")),tn(ye.Switch,"defaultColor",Le("palette-common-white")),tn(ye.Switch,"defaultDisabledColor",Le("palette-grey-100")),tn(ye.Switch,"primaryDisabledColor",ji(ye.primary.main,.62)),tn(ye.Switch,"secondaryDisabledColor",ji(ye.secondary.main,.62)),tn(ye.Switch,"errorDisabledColor",ji(ye.error.main,.62)),tn(ye.Switch,"infoDisabledColor",ji(ye.info.main,.62)),tn(ye.Switch,"successDisabledColor",ji(ye.success.main,.62)),tn(ye.Switch,"warningDisabledColor",ji(ye.warning.main,.62)),tn(ye.TableCell,"border",ji(W2(ye.divider,1),.88)),tn(ye.Tooltip,"bg",W2(ye.grey[700],.92))}if(ye.mode==="dark"){tn(ye.Alert,"errorColor",ji(ye.error.light,.6)),tn(ye.Alert,"infoColor",ji(ye.info.light,.6)),tn(ye.Alert,"successColor",ji(ye.success.light,.6)),tn(ye.Alert,"warningColor",ji(ye.warning.light,.6)),tn(ye.Alert,"errorFilledBg",Le("palette-error-dark")),tn(ye.Alert,"infoFilledBg",Le("palette-info-dark")),tn(ye.Alert,"successFilledBg",Le("palette-success-dark")),tn(ye.Alert,"warningFilledBg",Le("palette-warning-dark")),tn(ye.Alert,"errorFilledColor",Wh(()=>ye.getContrastText(ye.error.dark))),tn(ye.Alert,"infoFilledColor",Wh(()=>ye.getContrastText(ye.info.dark))),tn(ye.Alert,"successFilledColor",Wh(()=>ye.getContrastText(ye.success.dark))),tn(ye.Alert,"warningFilledColor",Wh(()=>ye.getContrastText(ye.warning.dark))),tn(ye.Alert,"errorStandardBg",Fi(ye.error.light,.9)),tn(ye.Alert,"infoStandardBg",Fi(ye.info.light,.9)),tn(ye.Alert,"successStandardBg",Fi(ye.success.light,.9)),tn(ye.Alert,"warningStandardBg",Fi(ye.warning.light,.9)),tn(ye.Alert,"errorIconColor",Le("palette-error-main")),tn(ye.Alert,"infoIconColor",Le("palette-info-main")),tn(ye.Alert,"successIconColor",Le("palette-success-main")),tn(ye.Alert,"warningIconColor",Le("palette-warning-main")),tn(ye.AppBar,"defaultBg",Le("palette-grey-900")),tn(ye.AppBar,"darkBg",Le("palette-background-paper")),tn(ye.AppBar,"darkColor",Le("palette-text-primary")),tn(ye.Avatar,"defaultBg",Le("palette-grey-600")),tn(ye.Button,"inheritContainedBg",Le("palette-grey-800")),tn(ye.Button,"inheritContainedHoverBg",Le("palette-grey-700")),tn(ye.Chip,"defaultBorder",Le("palette-grey-700")),tn(ye.Chip,"defaultAvatarColor",Le("palette-grey-300")),tn(ye.Chip,"defaultIconColor",Le("palette-grey-300")),tn(ye.FilledInput,"bg","rgba(255, 255, 255, 0.09)"),tn(ye.FilledInput,"hoverBg","rgba(255, 255, 255, 0.13)"),tn(ye.FilledInput,"disabledBg","rgba(255, 255, 255, 0.12)"),tn(ye.LinearProgress,"primaryBg",Fi(ye.primary.main,.5)),tn(ye.LinearProgress,"secondaryBg",Fi(ye.secondary.main,.5)),tn(ye.LinearProgress,"errorBg",Fi(ye.error.main,.5)),tn(ye.LinearProgress,"infoBg",Fi(ye.info.main,.5)),tn(ye.LinearProgress,"successBg",Fi(ye.success.main,.5)),tn(ye.LinearProgress,"warningBg",Fi(ye.warning.main,.5)),tn(ye.Skeleton,"bg",`rgba(${Le("palette-text-primaryChannel")} / 0.13)`),tn(ye.Slider,"primaryTrack",Fi(ye.primary.main,.5)),tn(ye.Slider,"secondaryTrack",Fi(ye.secondary.main,.5)),tn(ye.Slider,"errorTrack",Fi(ye.error.main,.5)),tn(ye.Slider,"infoTrack",Fi(ye.info.main,.5)),tn(ye.Slider,"successTrack",Fi(ye.success.main,.5)),tn(ye.Slider,"warningTrack",Fi(ye.warning.main,.5));const ht=X2(ye.background.default,.98);tn(ye.SnackbarContent,"bg",ht),tn(ye.SnackbarContent,"color",Wh(()=>ye.getContrastText(ht))),tn(ye.SpeedDialAction,"fabHoverBg",X2(ye.background.paper,.15)),tn(ye.StepConnector,"border",Le("palette-grey-600")),tn(ye.StepContent,"border",Le("palette-grey-600")),tn(ye.Switch,"defaultColor",Le("palette-grey-300")),tn(ye.Switch,"defaultDisabledColor",Le("palette-grey-600")),tn(ye.Switch,"primaryDisabledColor",Fi(ye.primary.main,.55)),tn(ye.Switch,"secondaryDisabledColor",Fi(ye.secondary.main,.55)),tn(ye.Switch,"errorDisabledColor",Fi(ye.error.main,.55)),tn(ye.Switch,"infoDisabledColor",Fi(ye.info.main,.55)),tn(ye.Switch,"successDisabledColor",Fi(ye.success.main,.55)),tn(ye.Switch,"warningDisabledColor",Fi(ye.warning.main,.55)),tn(ye.TableCell,"border",Fi(W2(ye.divider,1),.68)),tn(ye.Tooltip,"bg",W2(ye.grey[700],.92))}hd(ye.background,"default"),hd(ye.background,"paper"),hd(ye.common,"background"),hd(ye.common,"onBackground"),hd(ye,"divider"),Object.keys(ye).forEach(ht=>{const gt=ye[ht];ht!=="tonalOffset"&&gt&&typeof gt=="object"&&(gt.main&&tn(ye[ht],"mainChannel",bv(wv(gt.main))),gt.light&&tn(ye[ht],"lightChannel",bv(wv(gt.light))),gt.dark&&tn(ye[ht],"darkChannel",bv(wv(gt.dark))),gt.contrastText&&tn(ye[ht],"contrastTextChannel",bv(wv(gt.contrastText))),ht==="text"&&(hd(ye[ht],"primary"),hd(ye[ht],"secondary")),ht==="action"&&(gt.active&&hd(ye[ht],"active"),gt.selected&&hd(ye[ht],"selected")))})}),xe=t.reduce((Ge,ye)=>Ql(Ge,ye),xe);const ae={prefix:v,disableCssColorScheme:f,shouldSkipGeneratingVar:S,getSelector:zZ(xe)},{vars:ve,generateThemeVars:Se,generateStyleSheets:He}=oZ(xe,ae);return xe.vars=ve,Object.entries(xe.colorSchemes[xe.defaultColorScheme]).forEach(([Ge,ye])=>{xe[Ge]=ye}),xe.generateThemeVars=Se,xe.generateStyleSheets=He,xe.generateSpacing=function(){return p7(z.spacing,T5(this))},xe.getColorSchemeSelector=sZ(i),xe.spacing=xe.generateSpacing(),xe.shouldSkipGeneratingVar=S,xe.unstable_sxConfig={...qb,...z==null?void 0:z.unstable_sxConfig},xe.unstable_sx=function(ye){return hg({sx:ye,theme:this})},xe.toRuntimeSource=w7,xe}function kP(e,t,a){e.colorSchemes&&a&&(e.colorSchemes[t]={...a!==!0&&a,palette:z5({...a===!0?{}:a.palette,mode:t})})}function jZ(e={},...t){const{palette:a,cssVariables:s=!1,colorSchemes:f=a?void 0:{light:!0},defaultColorScheme:v=a==null?void 0:a.mode,...S}=e,i=v||"light",O=f==null?void 0:f[i],z={...f,...a?{[i]:{...typeof O!="boolean"&&O,palette:a}}:void 0};if(s===!1){if(!("colorSchemes"in e))return VC(e,...t);let j=a;"palette"in e||z[i]&&(z[i]!==!0?j=z[i].palette:i==="dark"&&(j={mode:"dark"}));const F=VC({...e,palette:j},...t);return F.defaultColorScheme=i,F.colorSchemes=z,F.palette.mode==="light"&&(F.colorSchemes.light={...z.light!==!0&&z.light,palette:F.palette},kP(F,"dark",z.dark)),F.palette.mode==="dark"&&(F.colorSchemes.dark={...z.dark!==!0&&z.dark,palette:F.palette},kP(F,"light",z.light)),F}return!a&&!("light"in z)&&i==="light"&&(z.light=!0),FZ({...S,colorSchemes:z,defaultColorScheme:i,...typeof s!="boolean"&&s},...t)}const UZ=jZ(),VZ="$$material";function $Z(e){return e!=="ownerState"&&e!=="theme"&&e!=="sx"&&e!=="as"}const qZ=e=>$Z(e)&&e!=="classes",k5=VH({themeId:VZ,defaultTheme:UZ,rootShouldForwardProp:qZ}),E7=nZ;function GZ(e){return tZ(e)}function HZ(e){return typeof e.main=="string"}function ZZ(e,t=[]){if(!HZ(e))return!1;for(const a of t)if(!e.hasOwnProperty(a)||typeof e[a]!="string")return!1;return!0}function WZ(e=[]){return([,t])=>t&&ZZ(t,e)}function XZ(e){return _7("MuiCircularProgress",e)}NH("MuiCircularProgress",["root","determinate","indeterminate","colorPrimary","colorSecondary","svg","circle","circleDeterminate","circleIndeterminate","circleDisableShrink"]);const kp=44,$C=d7`
  0% {
    transform: rotate(0deg);
  }

  100% {
    transform: rotate(360deg);
  }
`,qC=d7`
  0% {
    stroke-dasharray: 1px, 200px;
    stroke-dashoffset: 0;
  }

  50% {
    stroke-dasharray: 100px, 200px;
    stroke-dashoffset: -15px;
  }

  100% {
    stroke-dasharray: 1px, 200px;
    stroke-dashoffset: -126px;
  }
`,YZ=typeof $C!="string"?P5`
        animation: ${$C} 1.4s linear infinite;
      `:null,KZ=typeof qC!="string"?P5`
        animation: ${qC} 1.4s ease-in-out infinite;
      `:null,JZ=e=>{const{classes:t,variant:a,color:s,disableShrink:f}=e,v={root:["root",a,`color${ug(s)}`],svg:["svg"],circle:["circle",`circle${ug(a)}`,f&&"circleDisableShrink"]};return Bq(v,XZ,t)},QZ=k5("span",{name:"MuiCircularProgress",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:a}=e;return[t.root,t[a.variant],t[`color${ug(a.color)}`]]}})(E7(({theme:e})=>({display:"inline-block",variants:[{props:{variant:"determinate"},style:{transition:e.transitions.create("transform")}},{props:{variant:"indeterminate"},style:YZ||{animation:`${$C} 1.4s linear infinite`}},...Object.entries(e.palette).filter(WZ()).map(([t])=>({props:{color:t},style:{color:(e.vars||e).palette[t].main}}))]}))),eW=k5("svg",{name:"MuiCircularProgress",slot:"Svg",overridesResolver:(e,t)=>t.svg})({display:"block"}),tW=k5("circle",{name:"MuiCircularProgress",slot:"Circle",overridesResolver:(e,t)=>{const{ownerState:a}=e;return[t.circle,t[`circle${ug(a.variant)}`],a.disableShrink&&t.circleDisableShrink]}})(E7(({theme:e})=>({stroke:"currentColor",variants:[{props:{variant:"determinate"},style:{transition:e.transitions.create("stroke-dashoffset")}},{props:{variant:"indeterminate"},style:{strokeDasharray:"80px, 200px",strokeDashoffset:0}},{props:({ownerState:t})=>t.variant==="indeterminate"&&!t.disableShrink,style:KZ||{animation:`${qC} 1.4s ease-in-out infinite`}}]}))),nW=Me.forwardRef(function(t,a){const s=GZ({props:t,name:"MuiCircularProgress"}),{className:f,color:v="primary",disableShrink:S=!1,size:i=40,style:O,thickness:z=3.6,value:j=0,variant:F="indeterminate",...G}=s,Y={...s,color:v,disableShrink:S,size:i,thickness:z,value:j,variant:F},X=JZ(Y),K={},ne={},se={};if(F==="determinate"){const ge=2*Math.PI*((kp-z)/2);K.strokeDasharray=ge.toFixed(3),se["aria-valuenow"]=Math.round(j),K.strokeDashoffset=`${((100-j)/100*ge).toFixed(3)}px`,ne.transform="rotate(-90deg)"}return he.jsx(QZ,{className:oi(X.root,f),style:{width:i,height:i,...ne,...O},ownerState:Y,ref:a,role:"progressbar",...se,...G,children:he.jsx(eW,{className:X.svg,ownerState:Y,viewBox:`${kp/2} ${kp/2} ${kp} ${kp}`,children:he.jsx(tW,{className:X.circle,style:K,ownerState:Y,cx:kp,cy:kp,r:(kp-z)/2,fill:"none",strokeWidth:z})})})}),rW="_loader_1tece_1",iW={loader:rW};function Hp(e){return he.jsx("div",{className:iW.loader,children:he.jsx(nW,{className:e.className})})}const A7="data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M18%2015L12%209L6%2015'%20stroke='%23373435'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",C7=()=>{const[e,t]=Me.useState({width:window.innerWidth,height:window.innerHeight});return Me.useEffect(()=>{window.onresize=()=>{t({width:window.innerWidth,height:window.innerHeight})}},[]),{windowSizes:e}},aW=113,oW=178;function M7(e){const{windowSizes:t}=C7(),[a,s]=Me.useState(0),[f,v]=Me.useState(!1),[S,i]=Me.useState(!0),O=Me.useRef(null),[z,j]=Me.useState(!1),[F,G]=Me.useState(!1),[Y,X]=Me.useState(0),[K,ne]=Me.useState(0),[se,ge]=Me.useState([]);Me.useEffect(()=>{xe()},[]);const _e=B8,xe=()=>{e.disable||(v(!0),e.getData(a,_e).then(Le=>{Le.length<_e?i(!1):s(gt=>gt+_e);const ht=se.concat(Le);ge(ht),e.onDataLoad(ht)}).finally(()=>{v(!1)}))},ae=Le=>{const ht=Le.target,gt=ht.scrollHeight<=ht.scrollTop+ht.clientHeight,Ft=ht.scrollHeight>ht.clientHeight,_t=ht.scrollTop>0;j(!!(Ft&&_t)),gt&&S&&xe()},ve=()=>{O.current&&O.current.scrollTo({top:0,behavior:"smooth"})},Se=Le=>{G(!0),X(Le.clientX),ne(Le.clientY)},He=Le=>{if(!F)return;const ht=O.current;if(!ht)return;const gt=Le.clientX-Y,Ft=Le.clientY-K;ht.scrollTop-=Ft,ht.scrollLeft-=gt,X(Le.clientX),ne(Le.clientY),Le.preventDefault()},Ge=()=>{G(!1)},ye=e.fullHeight?aW:oW;return he.jsxs("div",{children:[he.jsxs("div",{ref:O,onScroll:ae,onMouseDown:Se,onMouseMove:He,onMouseUp:Ge,onMouseLeave:Ge,className:H2.listLayout__list,style:{height:t.height-ye+"px"},children:[(f&&e.items.length===0||e.loading)&&he.jsx(Hp,{}),!f&&e.items.length===0&&!e.loading&&e.emptyListNotify,e.items.length>0&&!e.loading&&he.jsx("div",{className:H2.list_noSelection,children:e.items.map((Le,ht)=>he.jsx("div",{className:H2.list__item,children:Le},ht))})]}),f&&e.items.length>0&&he.jsx(Hp,{}),z&&he.jsx("div",{className:H2.listLayout__blockButton,children:he.jsx(Jl,{onClick:ve,variant:"iconSmall",iconSrc:A7})})]})}const sW="_contentBlockLayout_5lbdv_1",lW={contentBlockLayout:sW};function Ro(e){return he.jsx("div",{className:`${lW.contentBlockLayout} ${e.className??""}`,children:e.children})}const cW="_stationCard_1to1b_1",uW="_stationCard__header_1to1b_16",hW="_header__mainInfo_1to1b_32",fW="_path__icon_1to1b_43",dW="_mainInfo__texts_1to1b_59",pW="_texts__name_1to1b_70",mW="_texts__description_1to1b_83",_W="_path__text_1to1b_84",gW="_content__path_1to1b_99",yW="_stationCard__body_1to1b_116",vW="_body__connectorsList_1to1b_130",xW="_connectorsList_1to1b_139",Gc={stationCard:cW,stationCard__header:uW,header__mainInfo:hW,path__icon:fW,mainInfo__texts:dW,texts__name:pW,texts__description:mW,path__text:_W,content__path:gW,stationCard__body:yW,body__connectorsList:vW,connectorsList:xW},O7="/assets/path-ck7PA2gW.svg",bW="_connector_797fs_1",wW="_connector__wrap_797fs_12",SW="_connector__icon_797fs_26",TW="_connector__content_797fs_33",EW="_content__main_797fs_47",AW="_main__standard_797fs_61",CW="_main__power_797fs_70",MW="_content__additional_797fs_79",OW="_additional__verticalSplit_797fs_97",IW="_connector__horizontalSplit_797fs_113",Xh={connector:bW,connector__wrap:wW,connector__icon:SW,connector__content:TW,content__main:EW,main__standard:AW,main__power:CW,content__additional:MW,additional__verticalSplit:OW,connector__horizontalSplit:IW},PW="_status_1hu4o_1",RW="_green_1hu4o_25",DW="_orange_1hu4o_30",LW="_red_1hu4o_35",zW="_grey_1hu4o_40",kW="_text_1hu4o_45",p3={status:PW,green:RW,orange:DW,red:LW,grey:zW,text:kW};function Yb(e){const t=e.color,s={fontSize:{small:12,medium:14,large:16}[e.textSize]+"px"};return he.jsx("div",{className:`${p3.status} ${e.className??""} ${p3[t]}`,children:he.jsx("p",{className:p3.text,style:s,children:e.text})})}function BW(e){return he.jsxs("div",{className:Xh.connector,children:[he.jsxs("div",{className:Xh.connector__wrap,children:[he.jsx("img",{src:C1[e.connector.standard],alt:e.connector.standard,className:Xh.connector__icon}),he.jsxs("div",{className:Xh.connector__content,children:[he.jsxs("div",{className:Xh.content__main,children:[he.jsx("p",{className:Xh.main__standard,children:e.connector.standard}),he.jsxs("p",{className:Xh.main__power,children:[e.connector.max_electric_power," кВт"]})]}),he.jsxs("div",{className:Xh.content__additional,children:[he.jsx("div",{className:Xh.additional__verticalSplit}),he.jsx(Yb,{textSize:"small",text:e.connector.status,color:z8[e.connector.status]})]})]})]}),!e.isLast&&he.jsx("div",{className:Xh.connector__horizontalSplit})]})}const NW="_marker_kkq5n_1",FW="_marker_green_kkq5n_25",jW="_marker_orange_kkq5n_29",UW="_marker_grey_kkq5n_33",BP={marker:NW,marker_green:FW,marker_orange:jW,marker_grey:UW},VW="data:image/svg+xml,%3csvg%20width='14'%20height='13'%20viewBox='0%200%2014%2013'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M5.83335%200.166672H5.25002C3.6001%200.166672%202.77515%200.166672%202.26258%200.679235C1.75002%201.1918%201.75002%202.01676%201.75002%203.66667V11.3958H1.16669C0.925062%2011.3958%200.729187%2011.5917%200.729187%2011.8333C0.729187%2012.075%200.925062%2012.2708%201.16669%2012.2708H10.0625C10.3041%2012.2708%2010.5%2012.075%2010.5%2011.8333C10.5%2011.5917%2010.3041%2011.3958%2010.0625%2011.3958H9.33335V9.35419H10.25C10.4686%209.35419%2010.6459%209.53141%2010.6459%209.75002V9.79169C10.6459%2010.5166%2011.2335%2011.1042%2011.9584%2011.1042C12.6832%2011.1042%2013.2709%2010.5166%2013.2709%209.79169V3.43437C13.2709%203.34298%2013.2709%203.27993%2013.2674%203.21844C13.2349%202.64037%2012.9746%202.09875%2012.5435%201.71228C12.4977%201.67118%2012.4484%201.63179%2012.3771%201.57471L11.6483%200.991724C11.4596%200.840783%2011.1843%200.871373%2011.0334%201.06005C10.8824%201.24873%2010.913%201.52404%2011.1017%201.67498L11.821%202.25042C11.9053%202.31785%2011.9342%202.34115%2011.9594%202.36382C12.2181%202.5957%2012.3743%202.92067%2012.3938%203.26751C12.3957%203.30141%2012.3959%203.33851%2012.3959%203.44645V3.66667H11.9584C11.4751%203.66667%2011.0834%204.05842%2011.0834%204.54167V5.95267C11.0834%206.3293%2011.3244%206.66367%2011.6817%206.78277L12.3959%207.02084V9.79169C12.3959%2010.0333%2012.2%2010.2292%2011.9584%2010.2292C11.7167%2010.2292%2011.5209%2010.0333%2011.5209%209.79169V9.75002C11.5209%209.04816%2010.9519%208.47919%2010.25%208.47919H9.33335V3.66667C9.33335%202.01676%209.33335%201.1918%208.82079%200.679235C8.30823%200.166672%207.48327%200.166672%205.83335%200.166672ZM5.76678%204.45819C5.97397%204.5825%206.04115%204.85124%205.91684%205.05843L5.4394%205.85417H6.41669C6.57431%205.85417%206.71974%205.93896%206.7974%206.07612C6.87506%206.21328%206.87293%206.38161%206.79184%206.51676L5.91684%207.9751C5.79253%208.18229%205.52379%208.24947%205.3166%208.12516C5.1094%208.00084%205.04222%207.7321%205.16653%207.52491L5.64398%206.72917H4.66669C4.50907%206.72917%204.36363%206.64439%204.28597%206.50723C4.20832%206.37007%204.21044%206.20174%204.29153%206.06658L5.16653%204.60825C5.29085%204.40105%205.55959%204.33387%205.76678%204.45819Z'%20fill='white'/%3e%3c/svg%3e";function I7(e){return he.jsx("div",{className:`${BP.marker} ${BP[`marker_${e.color}`]}`,children:he.jsx("img",{src:VW,alt:"Station marker"})})}function P7(e){const t=()=>{e.onClick&&e.onClick()},a=e.station.connectors.length>0?e.station.connectors:[e.station.connectors[0]],s=()=>e.station.metres_to_station?(e.station.metres_to_station/1e3).toLocaleString("ru-RU",{minimumFractionDigits:0,maximumFractionDigits:2}):void 0;return he.jsxs("div",{className:Gc.stationCard,onClick:t,children:[he.jsxs("div",{className:Gc.stationCard__header,children:[he.jsxs("div",{className:Gc.header__mainInfo,children:[he.jsx(I7,{color:y5[e.station.status]}),he.jsxs("div",{className:Gc.mainInfo__texts,children:[he.jsx("p",{className:Gc.texts__name,children:e.station.name}),he.jsx("p",{className:Gc.texts__description,children:e.station.address})]})]}),s()&&e.showDistance&&he.jsxs("div",{className:Gc.content__path,children:[he.jsx("div",{className:Gc.path__icon,children:he.jsx("img",{src:O7,alt:"path"})}),he.jsxs("p",{className:Gc.path__text,children:[s()," км"]})]})]}),he.jsx("div",{className:Gc.stationCard__body,children:he.jsx("div",{className:Gc.body__connectorsList,children:he.jsx("div",{className:Gc.connectorsList,children:a.map((f,v)=>he.jsx(BW,{connector:f,isLast:v===a.length-1},f.id))})})})]})}const $W="_returnButton_1nm50_1",qW="_returnButton_disabled_1nm50_23",NP={returnButton:$W,returnButton_disabled:qW};function GW(e){return he.jsx("button",{className:`${NP.returnButton} ${e.disabled?NP.returnButton_disabled:""}`,onClick:e.onClick,disabled:e.disabled,children:he.jsx("img",{src:e.iconSrc,alt:"returnButton"})})}const HW="data:image/svg+xml,%3csvg%20width='18'%20height='14'%20viewBox='0%200%2018%2014'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M17%207H1M1%207L7%201M1%207L7%2013'%20stroke='%23373435'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",ZW="_header_1n8qm_1",WW="_header__left_1n8qm_19",XW="_header__right_1n8qm_20",YW="_header__title_1n8qm_24",KW="_title__text_1n8qm_42",ev={header:ZW,header__left:WW,header__right:XW,header__title:YW,title__text:KW};function JW(e){return window.Telegram.WebApp.BackButton.show(),window.Telegram.WebApp.onEvent("backButtonClicked",e.onReturn),null}function QW(e){const{isInitTelegramSdk:t}=Me.useContext(Va),a=!t||!1;return he.jsxs(he.Fragment,{children:[t&&he.jsx(JW,{onReturn:e.onReturn}),he.jsxs("div",{className:ev.header,children:[a?he.jsx("div",{className:ev.header__left,children:he.jsx(GW,{onClick:e.onReturn,iconSrc:HW})}):he.jsx("div",{}),he.jsx("div",{className:ev.header__title,children:he.jsx("a",{className:ev.title__text,children:e.title})}),he.jsx("div",{className:ev.header__right,children:e.content})]})]})}const eX="_page_kv1d5_1",R7={page:eX},tX="_page__loader_7rido_1",nX={page__loader:tX};function Pd(e){return he.jsxs("div",{className:`${R7.page} ${e.className}`,children:[he.jsx(QW,{onReturn:e.onReturn,title:e.title,content:e.headerContent}),e.loading?he.jsx("div",{className:nX.page__loader,children:he.jsx(Hp,{})}):e.children]})}const rX="data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3ccircle%20cx='11.5'%20cy='11.5'%20r='9.5'%20stroke='%23373435'%20stroke-width='1.5'/%3e%3cpath%20d='M18.5%2018.5L22%2022'%20stroke='%23373435'%20stroke-width='1.5'%20stroke-linecap='round'/%3e%3c/svg%3e",iX="_search_1bkxv_1",aX="_search__input_1bkxv_16",oX="_search__input_outlined_1bkxv_35",sX="_search__input_shadow_1bkxv_40",lX="_search__input_disabled_1bkxv_55",cX="_search__icon_1bkxv_60",tv={search:iX,search__input:aX,search__input_outlined:oX,search__input_shadow:sX,search__input_disabled:lX,search__icon:cX};function D7(e){var f;const[t,a]=Me.useState(((f=e.value)==null?void 0:f.toString())??""),s=Me.useRef(null);return Me.useEffect(()=>{e.value!==void 0&&a(e.value.toString())},[e.value]),Me.useEffect(()=>{e.focus&&s.current&&s.current.focus()},[e.focus,s]),he.jsxs("div",{className:tv.search,onClick:e.onClick,children:[he.jsx("img",{className:tv.search__icon,src:rX,alt:"Search"}),he.jsx("input",{ref:s,placeholder:e.placeholder,className:`${tv.search__input} ${tv["search__input_"+e.variant]} ${e.disabled?tv.search__input_disabled:""}`,disabled:e.disabled,value:t,onChange:v=>{var i;const S=v.target.value;a(S),(i=e.onChange)==null||i.call(e,S)},maxLength:e.maxLength})]})}const uX="_block_191bz_1",hX="_block__icon_191bz_27",fX="_block__text_191bz_34",m3={block:uX,block__icon:hX,block__text:fX};function L7(e){return he.jsxs("div",{className:m3.block,children:[he.jsx("img",{className:m3.block__icon,src:e.iconSrc,alt:"Icon"}),he.jsx("a",{className:m3.block__text,children:e.text})]})}const dX="data:image/svg+xml,%3csvg%20width='64'%20height='64'%20viewBox='0%200%2064%2064'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%20%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M26.6663%205.33345H23.9997C16.4572%205.33345%2012.686%205.33345%2010.3428%207.6766C7.99967%2010.0197%207.99967%2013.791%207.99967%2021.3334V56.6668H5.33301C4.22844%2056.6668%203.33301%2057.5622%203.33301%2058.6668C3.33301%2059.7713%204.22844%2060.6668%205.33301%2060.6668H45.9997C47.1042%2060.6668%2047.9997%2059.7713%2047.9997%2058.6668C47.9997%2057.5622%2047.1042%2056.6668%2045.9997%2056.6668H42.6663V47.3335H46.8568C47.8562%2047.3335%2048.6663%2048.1437%2048.6663%2049.143V49.3335C48.6663%2052.6472%2051.3526%2055.3335%2054.6663%2055.3335C57.9801%2055.3335%2060.6663%2052.6472%2060.6663%2049.3335V20.2715C60.6664%2019.8537%2060.6664%2019.5655%2060.6506%2019.2844C60.5022%2016.6418%2059.3122%2014.1658%2057.3414%2012.3991C57.1317%2012.2112%2056.9066%2012.0311%2056.5804%2011.7702L53.2491%209.10512C52.3865%208.4151%2051.128%208.55494%2050.4379%209.41747C49.7479%2010.28%2049.8878%2011.5386%2050.7503%2012.2286L54.0385%2014.8592C54.4238%2015.1674%2054.5558%2015.2739%2054.6714%2015.3775C55.8538%2016.4376%2056.5678%2017.9232%2056.6569%2019.5087C56.6656%2019.6637%2056.6663%2019.8333%2056.6663%2020.3267V21.3334H54.6663C52.4572%2021.3334%2050.6663%2023.1243%2050.6663%2025.3334V31.7837C50.6663%2033.5055%2051.7681%2035.034%2053.4014%2035.5785L56.6663%2036.6668V49.3335C56.6663%2050.4381%2055.7709%2051.3335%2054.6663%2051.3335C53.5618%2051.3335%2052.6663%2050.4381%2052.6663%2049.3335V49.143C52.6663%2045.9345%2050.0653%2043.3335%2046.8568%2043.3335H42.6663V21.3334C42.6663%2013.791%2042.6663%2010.0197%2040.3232%207.6766C37.9801%205.33345%2034.2088%205.33345%2026.6663%205.33345ZM26.362%2024.9518C27.3092%2025.5201%2027.6163%2026.7486%2027.048%2027.6958L24.8654%2031.3334H29.333C30.0536%2031.3334%2030.7184%2031.721%2031.0734%2032.3481C31.4284%2032.9751%2031.4187%2033.7446%2031.048%2034.3624L27.048%2041.0291C26.4797%2041.9763%2025.2512%2042.2834%2024.304%2041.7151C23.3569%2041.1468%2023.0497%2039.9183%2023.618%2038.9711L25.8006%2035.3334H21.333C20.6125%2035.3334%2019.9476%2034.9459%2019.5926%2034.3188C19.2376%2033.6918%2019.2473%2032.9223%2019.618%2032.3045L23.618%2025.6378C24.1863%2024.6906%2025.4148%2024.3835%2026.362%2024.9518Z'%20fill='%238E949F'%20/%3e%3c/svg%3e";function pX(){const e=yo(),{stations:t,setStations:a,stationFilters:s,setStationFilters:f}=Me.useContext(Va),{pageQueries:v}=fq(),{getByOffsetAndLimit:S,updateStationsByName:i,loading:O}=hq(),[z,j]=Me.useState(!1),[F,G]=Me.useState();Me.useEffect(()=>{z&&(clearTimeout(F),G(setTimeout(()=>{i(s.partOfName),G(void 0)},900)))},[s.partOfName]);const Y=()=>{e(_5+hl([{key:kv.PREVIOUS_PAGE,value:cg.STATIONS_LIST}]))},X=K=>{e(A1+K+hl([{key:Td.PREVIOUS_PAGE,value:xd.STATIONS_LIST}]))};return he.jsx(Pd,{onReturn:()=>e("/"),title:"Список станций",headerContent:he.jsx(zb,{iconSrc:g5,onClick:Y,variant:"fill"}),className:e3.page,children:he.jsxs("div",{className:e3.page__stationsList,children:[he.jsx(D7,{variant:"outlined",placeholder:"Название станции",focus:v.search_focused,value:s.partOfName,onChange:K=>{f({...s,partOfName:K}),j(!0)}}),he.jsx(M7,{disable:!0,items:t.map((K,ne)=>he.jsx(Ro,{className:e3.stationsList__station,children:he.jsx(P7,{onClick:()=>X(K.id),station:K,showDistance:!0})},ne)),getData:(K,ne)=>S(K,ne),onDataLoad:K=>a(K),loading:O||F!==void 0,emptyListNotify:he.jsx(L7,{text:"Здесь будут показаны зарядные станции",iconSrc:dX})})]})})}const mX="_carousel_et819_1",_X="_carousel__item_et819_36",gX="_item__image_et819_50",_3={carousel:mX,carousel__item:_X,item__image:gX};var Y2={},N_={},Ea={},g3={},FP;function B5(){return FP||(FP=1,function(e){function t(S,i,O){var z=i.slidesToShow,j=i.currentSlide;return O.length>2*z?S+2*z:j>=O.length?O.length+S:S}function a(S,i){if(i.length>2*S){for(var O={},z=i.length-2*S,j=i.length-z,F=z,G=0;G<j;G++)O[G]=F,F++;var Y=i.length+j,X=Y+i.slice(0,2*S).length,K=0;for(G=Y;G<=X;G++)O[G]=K,K++;var ne=Y,se=0;for(G=j;G<ne;G++)O[G]=se,se++;return O}O={};var ge=3*i.length,_e=0;for(G=0;G<ge;G++)O[G]=_e,++_e===i.length&&(_e=0);return O}function s(S,i){return i.length<S?i:i.length>2*S?i.slice(i.length-2*S,i.length).concat(i,i.slice(0,2*S)):i.concat(i,i)}function f(S,i){return i.length>2*S?2*S:i.length}function v(S,i,O){var z,j=S.currentSlide,F=S.slidesToShow,G=S.itemWidth,Y=S.totalItems,X=0,K=0,ne=j===0,se=i.length-(i.length-2*F);return i.length<F?(K=X=0,ne=z=!1):i.length>2*F?((z=j>=se+i.length)&&(K=-G*(X=j-i.length)),ne&&(K=-G*(X=se+(i.length-2*F)))):((z=j>=2*i.length)&&(K=-G*(X=j-i.length)),ne&&(K=O.showDots?-G*(X=i.length):-G*(X=Y/3))),{isReachingTheEnd:z,isReachingTheStart:ne,nextSlide:X,nextPosition:K}}Object.defineProperty(e,"__esModule",{value:!0}),e.getOriginalCounterPart=t,e.getOriginalIndexLookupTableByClones=a,e.getClones=s,e.getInitialSlideInInfiniteMode=f,e.checkClonesPosition=v}(g3)),g3}var F_={},jP;function z7(){if(jP)return F_;jP=1,Object.defineProperty(F_,"__esModule",{value:!0});function e(s,f,v,S){var i=0,O=S||v;return f&&O&&(i=s[O].partialVisibilityGutter||s[O].paritialVisibilityGutter),i}function t(s,f){var v;return f[s]&&(v=(100/f[s].items).toFixed(1)),v}function a(s,f,v){return Math.round(v/(f+(s.centerMode?1:0)))}return F_.getPartialVisibilityGutter=e,F_.getWidthFromDeviceType=t,F_.getItemClientSideWidth=a,F_}var Hl={},UP;function x0(){if(UP)return Hl;UP=1,Object.defineProperty(Hl,"__esModule",{value:!0});var e=z7();function t(F){var G=F.slidesToShow;return F.totalItems<G}function a(F,G){var Y,X=F.domLoaded,K=F.slidesToShow,ne=F.containerWidth,se=F.itemWidth,ge=G.deviceType,_e=G.responsive,xe=G.ssr,ae=G.partialVisbile,ve=G.partialVisible,Se=!!(X&&K&&ne&&se);xe&&ge&&!Se&&(Y=e.getWidthFromDeviceType(ge,_e));var He=!!(xe&&ge&&!Se&&Y);return{shouldRenderOnSSR:He,flexBisis:Y,domFullyLoaded:Se,partialVisibilityGutter:e.getPartialVisibilityGutter(_e,ae||ve,ge,F.deviceType),shouldRenderAtAll:He||Se}}function s(F,G){var Y=G.currentSlide,X=G.slidesToShow;return Y<=F&&F<Y+X}function f(F,G,Y){var X=Y||F.transform;return!G.infinite&&F.currentSlide===0||t(F)?X:X+F.itemWidth/2}function v(F){return!(0<F.currentSlide)}function S(F){var G=F.currentSlide,Y=F.totalItems;return!(G+F.slidesToShow<Y)}function i(F,G,Y,X){G===void 0&&(G=0);var K=F.currentSlide,ne=F.slidesToShow,se=S(F),ge=!Y.infinite&&se,_e=X||F.transform;if(t(F))return _e;var xe=_e+K*G;return ge?xe+(F.containerWidth-(F.itemWidth-G)*ne):xe}function O(F,G){return F.rtl?-1*G:G}function z(F,G,Y){var X=G.partialVisbile,K=G.partialVisible,ne=G.responsive,se=G.deviceType,ge=G.centerMode,_e=Y||F.transform,xe=e.getPartialVisibilityGutter(ne,X||K,se,F.deviceType);return O(G,K||X?i(F,xe,G,Y):ge?f(F,G,Y):_e)}function j(F,G){var Y=F.domLoaded,X=F.slidesToShow,K=F.containerWidth,ne=F.itemWidth,se=G.deviceType,ge=G.responsive,_e=G.slidesToSlide||1,xe=!!(Y&&X&&K&&ne);return G.ssr&&G.deviceType&&!xe&&Object.keys(ge).forEach(function(ae){var ve=ge[ae].slidesToSlide;se===ae&&ve&&(_e=ve)}),xe&&Object.keys(ge).forEach(function(ae){var ve=ge[ae],Se=ve.breakpoint,He=ve.slidesToSlide,Ge=Se.max,ye=Se.min;He&&window.innerWidth>=ye&&window.innerWidth<=Ge&&(_e=He)}),_e}return Hl.notEnoughChildren=t,Hl.getInitialState=a,Hl.getIfSlideIsVisbile=s,Hl.getTransformForCenterMode=f,Hl.isInLeftEnd=v,Hl.isInRightEnd=S,Hl.getTransformForPartialVsibile=i,Hl.parsePosition=O,Hl.getTransform=z,Hl.getSlidesToSlide=j,Hl}var K2={},VP;function yX(){if(VP)return K2;VP=1,Object.defineProperty(K2,"__esModule",{value:!0});var e=function(t,a,s){var f;return function(){var v=arguments;f||(t.apply(this,v),f=!0,typeof s=="function"&&s(!0),setTimeout(function(){f=!1,typeof s=="function"&&s(!1)},a))}};return K2.default=e,K2}var y3={},$P;function vX(){return $P||($P=1,function(e){function t(a,s){var f=s.partialVisbile,v=s.partialVisible,S=s.centerMode,i=s.ssr,O=s.responsive;if((f||v)&&S)throw new Error("center mode can not be used at the same time with partialVisible");if(!O)throw i?new Error("ssr mode need to be used in conjunction with responsive prop"):new Error("Responsive prop is needed for deciding the amount of items to show on the screen");if(O&&typeof O!="object")throw new Error("responsive prop must be an object")}Object.defineProperty(e,"__esModule",{value:!0}),e.default=t}(y3)),y3}var J2={},qP;function xX(){if(qP)return J2;qP=1,Object.defineProperty(J2,"__esModule",{value:!0});var e=x0();function t(a,s,f){f===void 0&&(f=0);var v,S,i=a.slidesToShow,O=a.currentSlide,z=a.itemWidth,j=a.totalItems,F=e.getSlidesToSlide(a,s),G=O+1+f+i+(0<f?0:F);return S=G<=j?-z*(v=O+f+(0<f?0:F)):j<G&&O!==j-i?-z*(v=j-i):v=void 0,{nextSlides:v,nextPosition:S}}return J2.populateNextSlides=t,J2}var Q2={},GP;function bX(){if(GP)return Q2;GP=1,Object.defineProperty(Q2,"__esModule",{value:!0});var e=Od(),t=x0(),a=x0();function s(f,v,S){S===void 0&&(S=0);var i,O,z=f.currentSlide,j=f.itemWidth,F=f.slidesToShow,G=v.children,Y=v.showDots,X=v.infinite,K=t.getSlidesToSlide(f,v),ne=z-S-(0<S?0:K),se=(e.Children.toArray(G).length-F)%K;return O=0<=ne?(i=ne,Y&&!X&&0<se&&a.isInRightEnd(f)&&(i=z-se),-j*i):i=ne<0&&z!==0?0:void 0,{nextSlides:i,nextPosition:O}}return Q2.populatePreviousSlides=s,Q2}var v3={},HP;function wX(){return HP||(HP=1,function(e){function t(a,s,f,v,S,i){var O,z,j=a.itemWidth,F=a.slidesToShow,G=a.totalItems,Y=a.currentSlide,X=s.infinite,K=!1,ne=Math.round((f-v)/j),se=Math.round((v-f)/j),ge=f<S;if(S<f&&ne<=F){O="right";var _e=Math.abs(-j*(G-F)),xe=i-(v-S),ae=Y===G-F;(Math.abs(xe)<=_e||ae&&X)&&(z=xe,K=!0)}return ge&&se<=F&&(O="left",((xe=i+(S-v))<=0||Y===0&&X)&&(K=!0,z=xe)),{direction:O,nextPosition:z,canContinue:K}}Object.defineProperty(e,"__esModule",{value:!0}),e.populateSlidesOnMouseTouchMove=t}(v3)),v3}var ZP;function k7(){if(ZP)return Ea;ZP=1,Object.defineProperty(Ea,"__esModule",{value:!0});var e=B5();Ea.getOriginalCounterPart=e.getOriginalCounterPart,Ea.getClones=e.getClones,Ea.checkClonesPosition=e.checkClonesPosition,Ea.getInitialSlideInInfiniteMode=e.getInitialSlideInInfiniteMode;var t=z7();Ea.getWidthFromDeviceType=t.getWidthFromDeviceType,Ea.getPartialVisibilityGutter=t.getPartialVisibilityGutter,Ea.getItemClientSideWidth=t.getItemClientSideWidth;var a=x0();Ea.getInitialState=a.getInitialState,Ea.getIfSlideIsVisbile=a.getIfSlideIsVisbile,Ea.getTransformForCenterMode=a.getTransformForCenterMode,Ea.getTransformForPartialVsibile=a.getTransformForPartialVsibile,Ea.isInLeftEnd=a.isInLeftEnd,Ea.isInRightEnd=a.isInRightEnd,Ea.notEnoughChildren=a.notEnoughChildren,Ea.getSlidesToSlide=a.getSlidesToSlide;var s=yX();Ea.throttle=s.default;var f=vX();Ea.throwError=f.default;var v=xX();Ea.populateNextSlides=v.populateNextSlides;var S=bX();Ea.populatePreviousSlides=S.populatePreviousSlides;var i=wX();return Ea.populateSlidesOnMouseTouchMove=i.populateSlidesOnMouseTouchMove,Ea}var r0={},WP;function SX(){if(WP)return r0;WP=1;var e=r0&&r0.__extends||function(){var f=function(v,S){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,O){i.__proto__=O}||function(i,O){for(var z in O)O.hasOwnProperty(z)&&(i[z]=O[z])})(v,S)};return function(v,S){function i(){this.constructor=v}f(v,S),v.prototype=S===null?Object.create(S):(i.prototype=S.prototype,new i)}}();Object.defineProperty(r0,"__esModule",{value:!0});var t=Od();function a(f){return"clientY"in f}r0.isMouseMoveEvent=a;var s=function(f){function v(){return f!==null&&f.apply(this,arguments)||this}return e(v,f),v}(t.Component);return r0.default=s,r0}var ex={},tx={},XP;function TX(){if(XP)return tx;XP=1,Object.defineProperty(tx,"__esModule",{value:!0});var e=B5(),t=x0();function a(s,f,v,S){var i={},O=t.getSlidesToSlide(f,v);return Array(s).fill(0).forEach(function(z,j){var F=e.getOriginalCounterPart(j,f,S);if(j===0)i[0]=F;else{var G=i[j-1]+O;i[j]=G}}),i}return tx.getLookupTableForNextSlides=a,tx}var YP;function EX(){if(YP)return ex;YP=1,Object.defineProperty(ex,"__esModule",{value:!0});var e=Od(),t=B5(),a=TX(),s=x0(),f=function(v){var S=v.props,i=v.state,O=v.goToSlide,z=v.getState,j=S.showDots,F=S.customDot,G=S.dotListClass,Y=S.infinite,X=S.children;if(!j||s.notEnoughChildren(i))return null;var K,ne=i.currentSlide,se=i.slidesToShow,ge=s.getSlidesToSlide(i,S),_e=e.Children.toArray(X);K=Y?Math.ceil(_e.length/ge):Math.ceil((_e.length-se)/ge)+1;var xe=a.getLookupTableForNextSlides(K,i,S,_e),ae=t.getOriginalIndexLookupTableByClones(se,_e),ve=ae[ne];return e.createElement("ul",{className:"react-multi-carousel-dot-list "+G},Array(K).fill(0).map(function(Se,He){var Ge,ye;if(Y){ye=xe[He];var Le=ae[ye];Ge=ve===Le||Le<=ve&&ve<Le+ge}else{var ht=_e.length-se,gt=He*ge;Ge=(ye=ht<gt?ht:gt)===ne||ye<ne&&ne<ye+ge&&ne<_e.length-se}return F?e.cloneElement(F,{index:He,active:Ge,key:He,onClick:function(){return O(ye)},carouselState:z()}):e.createElement("li",{"data-index":He,key:He,className:"react-multi-carousel-dot "+(Ge?"react-multi-carousel-dot--active":"")},e.createElement("button",{"aria-label":"Go to slide "+(He+1),onClick:function(){return O(ye)}}))}))};return ex.default=f,ex}var nv={},KP;function AX(){if(KP)return nv;KP=1,Object.defineProperty(nv,"__esModule",{value:!0});var e=Od(),t=function(s){var f=s.customLeftArrow,v=s.getState,S=s.previous,i=s.disabled,O=s.rtl;if(f)return e.cloneElement(f,{onClick:function(){return S()},carouselState:v(),disabled:i,rtl:O});var z=O?"rtl":"";return e.createElement("button",{"aria-label":"Go to previous slide",className:"react-multiple-carousel__arrow react-multiple-carousel__arrow--left "+z,onClick:function(){return S()},type:"button",disabled:i})};nv.LeftArrow=t;var a=function(s){var f=s.customRightArrow,v=s.getState,S=s.next,i=s.disabled,O=s.rtl;if(f)return e.cloneElement(f,{onClick:function(){return S()},carouselState:v(),disabled:i,rtl:O});var z=O?"rtl":"";return e.createElement("button",{"aria-label":"Go to next slide",className:"react-multiple-carousel__arrow react-multiple-carousel__arrow--right "+z,onClick:function(){return S()},type:"button",disabled:i})};return nv.RightArrow=a,nv}var nx={},JP;function CX(){if(JP)return nx;JP=1,Object.defineProperty(nx,"__esModule",{value:!0});var e=Od(),t=k7(),a=function(s){var f=s.props,v=s.state,S=s.goToSlide,i=s.clones,O=s.notEnoughChildren,z=v.itemWidth,j=f.children,F=f.infinite,G=f.itemClass,Y=f.itemAriaLabel,X=f.partialVisbile,K=f.partialVisible,ne=t.getInitialState(v,f),se=ne.flexBisis,ge=ne.shouldRenderOnSSR,_e=ne.domFullyLoaded,xe=ne.partialVisibilityGutter;return ne.shouldRenderAtAll?(X&&console.warn('WARNING: Please correct props name: "partialVisible" as old typo will be removed in future versions!'),e.createElement(e.Fragment,null,(F?i:e.Children.toArray(j)).map(function(ae,ve){return e.createElement("li",{key:ve,"data-index":ve,onClick:function(){f.focusOnSelect&&S(ve)},"aria-hidden":t.getIfSlideIsVisbile(ve,v)?"false":"true","aria-label":Y||(ae.props.ariaLabel?ae.props.ariaLabel:null),style:{flex:ge?"1 0 "+se+"%":"auto",position:"relative",width:_e?((X||K)&&xe&&!O?z-xe:z)+"px":"auto"},className:"react-multi-carousel-item "+(t.getIfSlideIsVisbile(ve,v)?"react-multi-carousel-item--active":"")+" "+G},ae)}))):null};return nx.default=a,nx}var QP;function MX(){if(QP)return N_;QP=1;var e=N_&&N_.__extends||function(){var F=function(G,Y){return(F=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(X,K){X.__proto__=K}||function(X,K){for(var ne in K)K.hasOwnProperty(ne)&&(X[ne]=K[ne])})(G,Y)};return function(G,Y){function X(){this.constructor=G}F(G,Y),G.prototype=Y===null?Object.create(Y):(X.prototype=Y.prototype,new X)}}();Object.defineProperty(N_,"__esModule",{value:!0});var t=Od(),a=k7(),s=SX(),f=EX(),v=AX(),S=CX(),i=x0(),O=400,z="transform 400ms ease-in-out",j=function(F){function G(Y){var X=F.call(this,Y)||this;return X.containerRef=t.createRef(),X.listRef=t.createRef(),X.state={itemWidth:0,slidesToShow:0,currentSlide:0,totalItems:t.Children.count(Y.children),deviceType:"",domLoaded:!1,transform:0,containerWidth:0},X.onResize=X.onResize.bind(X),X.handleDown=X.handleDown.bind(X),X.handleMove=X.handleMove.bind(X),X.handleOut=X.handleOut.bind(X),X.onKeyUp=X.onKeyUp.bind(X),X.handleEnter=X.handleEnter.bind(X),X.setIsInThrottle=X.setIsInThrottle.bind(X),X.next=a.throttle(X.next.bind(X),Y.transitionDuration||O,X.setIsInThrottle),X.previous=a.throttle(X.previous.bind(X),Y.transitionDuration||O,X.setIsInThrottle),X.goToSlide=a.throttle(X.goToSlide.bind(X),Y.transitionDuration||O,X.setIsInThrottle),X.onMove=!1,X.initialX=0,X.lastX=0,X.isAnimationAllowed=!1,X.direction="",X.initialY=0,X.isInThrottle=!1,X.transformPlaceHolder=0,X}return e(G,F),G.prototype.resetTotalItems=function(){var Y=this,X=t.Children.count(this.props.children),K=a.notEnoughChildren(this.state)?0:Math.max(0,Math.min(this.state.currentSlide,X));this.setState({totalItems:X,currentSlide:K},function(){Y.setContainerAndItemWidth(Y.state.slidesToShow,!0)})},G.prototype.setIsInThrottle=function(Y){Y===void 0&&(Y=!1),this.isInThrottle=Y},G.prototype.setTransformDirectly=function(Y,X){var K=this.props.additionalTransfrom;this.transformPlaceHolder=Y;var ne=i.getTransform(this.state,this.props,this.transformPlaceHolder);this.listRef&&this.listRef.current&&(this.setAnimationDirectly(X),this.listRef.current.style.transform="translate3d("+(ne+K)+"px,0,0)")},G.prototype.setAnimationDirectly=function(Y){this.listRef&&this.listRef.current&&(this.listRef.current.style.transition=Y?this.props.customTransition||z:"none")},G.prototype.componentDidMount=function(){this.setState({domLoaded:!0}),this.setItemsToShow(),window.addEventListener("resize",this.onResize),this.onResize(!0),this.props.keyBoardControl&&window.addEventListener("keyup",this.onKeyUp),this.props.autoPlay&&(this.autoPlay=setInterval(this.next,this.props.autoPlaySpeed))},G.prototype.setClones=function(Y,X,K,ne){var se=this;ne===void 0&&(ne=!1),this.isAnimationAllowed=!1;var ge=t.Children.toArray(this.props.children),_e=a.getInitialSlideInInfiniteMode(Y||this.state.slidesToShow,ge),xe=a.getClones(this.state.slidesToShow,ge),ae=ge.length<this.state.slidesToShow?0:this.state.currentSlide;this.setState({totalItems:xe.length,currentSlide:K&&!ne?ae:_e},function(){se.correctItemsPosition(X||se.state.itemWidth)})},G.prototype.setItemsToShow=function(Y,X){var K=this,ne=this.props.responsive;Object.keys(ne).forEach(function(se){var ge=ne[se],_e=ge.breakpoint,xe=ge.items,ae=_e.max,ve=_e.min,Se=[window.innerWidth];window.screen&&window.screen.width&&Se.push(window.screen.width);var He=Math.min.apply(Math,Se);ve<=He&&He<=ae&&(K.setState({slidesToShow:xe,deviceType:se}),K.setContainerAndItemWidth(xe,Y,X))})},G.prototype.setContainerAndItemWidth=function(Y,X,K){var ne=this;if(this.containerRef&&this.containerRef.current){var se=this.containerRef.current.offsetWidth,ge=a.getItemClientSideWidth(this.props,Y,se);this.setState({containerWidth:se,itemWidth:ge},function(){ne.props.infinite&&ne.setClones(Y,ge,X,K)}),X&&this.correctItemsPosition(ge)}},G.prototype.correctItemsPosition=function(Y,X,K){X&&(this.isAnimationAllowed=!0),!X&&this.isAnimationAllowed&&(this.isAnimationAllowed=!1);var ne=this.state.totalItems<this.state.slidesToShow?0:-Y*this.state.currentSlide;K&&this.setTransformDirectly(ne,!0),this.setState({transform:ne})},G.prototype.onResize=function(Y){var X;X=!!this.props.infinite&&(typeof Y!="boolean"||!Y),this.setItemsToShow(X)},G.prototype.componentDidUpdate=function(Y,X){var K=this,ne=Y.keyBoardControl,se=Y.autoPlay,ge=Y.children,_e=X.containerWidth,xe=X.domLoaded,ae=X.currentSlide;if(this.containerRef&&this.containerRef.current&&this.containerRef.current.offsetWidth!==_e&&(this.itemsToShowTimeout&&clearTimeout(this.itemsToShowTimeout),this.itemsToShowTimeout=setTimeout(function(){K.setItemsToShow(!0)},this.props.transitionDuration||O)),ne&&!this.props.keyBoardControl&&window.removeEventListener("keyup",this.onKeyUp),!ne&&this.props.keyBoardControl&&window.addEventListener("keyup",this.onKeyUp),se&&!this.props.autoPlay&&this.autoPlay&&(clearInterval(this.autoPlay),this.autoPlay=void 0),se||!this.props.autoPlay||this.autoPlay||(this.autoPlay=setInterval(this.next,this.props.autoPlaySpeed)),ge.length!==this.props.children.length?G.clonesTimeout=setTimeout(function(){K.props.infinite?K.setClones(K.state.slidesToShow,K.state.itemWidth,!0,!0):K.resetTotalItems()},this.props.transitionDuration||O):this.props.infinite&&this.state.currentSlide!==ae&&this.correctClonesPosition({domLoaded:xe}),this.transformPlaceHolder!==this.state.transform&&(this.transformPlaceHolder=this.state.transform),this.props.autoPlay&&this.props.rewind&&!this.props.infinite&&a.isInRightEnd(this.state)){var ve=this.props.transitionDuration||O;G.isInThrottleTimeout=setTimeout(function(){K.setIsInThrottle(!1),K.resetAutoplayInterval(),K.goToSlide(0,void 0,!!K.props.rewindWithAnimation)},ve+this.props.autoPlaySpeed)}},G.prototype.correctClonesPosition=function(Y){var X=this,K=Y.domLoaded,ne=t.Children.toArray(this.props.children),se=a.checkClonesPosition(this.state,ne,this.props),ge=se.isReachingTheEnd,_e=se.isReachingTheStart,xe=se.nextSlide,ae=se.nextPosition;this.state.domLoaded&&K&&(ge||_e)&&(this.isAnimationAllowed=!1,G.transformTimeout=setTimeout(function(){X.setState({transform:ae,currentSlide:xe})},this.props.transitionDuration||O))},G.prototype.next=function(Y){var X=this;Y===void 0&&(Y=0);var K=this.props,ne=K.afterChange,se=K.beforeChange;if(!a.notEnoughChildren(this.state)){var ge=a.populateNextSlides(this.state,this.props,Y),_e=ge.nextSlides,xe=ge.nextPosition,ae=this.state.currentSlide;_e!==void 0&&xe!==void 0&&(typeof se=="function"&&se(_e,this.getState()),this.isAnimationAllowed=!0,this.props.shouldResetAutoplay&&this.resetAutoplayInterval(),this.setState({transform:xe,currentSlide:_e},function(){typeof ne=="function"&&(G.afterChangeTimeout=setTimeout(function(){ne(ae,X.getState())},X.props.transitionDuration||O))}))}},G.prototype.previous=function(Y){var X=this;Y===void 0&&(Y=0);var K=this.props,ne=K.afterChange,se=K.beforeChange;if(!a.notEnoughChildren(this.state)){var ge=a.populatePreviousSlides(this.state,this.props,Y),_e=ge.nextSlides,xe=ge.nextPosition;if(_e!==void 0&&xe!==void 0){var ae=this.state.currentSlide;typeof se=="function"&&se(_e,this.getState()),this.isAnimationAllowed=!0,this.props.shouldResetAutoplay&&this.resetAutoplayInterval(),this.setState({transform:xe,currentSlide:_e},function(){typeof ne=="function"&&(G.afterChangeTimeout2=setTimeout(function(){ne(ae,X.getState())},X.props.transitionDuration||O))})}}},G.prototype.resetAutoplayInterval=function(){this.props.autoPlay&&(clearInterval(this.autoPlay),this.autoPlay=setInterval(this.next,this.props.autoPlaySpeed))},G.prototype.componentWillUnmount=function(){window.removeEventListener("resize",this.onResize),this.props.keyBoardControl&&window.removeEventListener("keyup",this.onKeyUp),this.props.autoPlay&&this.autoPlay&&(clearInterval(this.autoPlay),this.autoPlay=void 0),this.itemsToShowTimeout&&clearTimeout(this.itemsToShowTimeout),G.clonesTimeout&&clearTimeout(G.clonesTimeout),G.isInThrottleTimeout&&clearTimeout(G.isInThrottleTimeout),G.transformTimeout&&clearTimeout(G.transformTimeout),G.afterChangeTimeout&&clearTimeout(G.afterChangeTimeout),G.afterChangeTimeout2&&clearTimeout(G.afterChangeTimeout2),G.afterChangeTimeout3&&clearTimeout(G.afterChangeTimeout3)},G.prototype.resetMoveStatus=function(){this.onMove=!1,this.initialX=0,this.lastX=0,this.direction="",this.initialY=0},G.prototype.getCords=function(Y){var X=Y.clientX,K=Y.clientY;return{clientX:i.parsePosition(this.props,X),clientY:i.parsePosition(this.props,K)}},G.prototype.handleDown=function(Y){if(!(!s.isMouseMoveEvent(Y)&&!this.props.swipeable||s.isMouseMoveEvent(Y)&&!this.props.draggable||this.isInThrottle)){var X=this.getCords(s.isMouseMoveEvent(Y)?Y:Y.touches[0]),K=X.clientX,ne=X.clientY;this.onMove=!0,this.initialX=K,this.initialY=ne,this.lastX=K,this.isAnimationAllowed=!1}},G.prototype.handleMove=function(Y){if(!(!s.isMouseMoveEvent(Y)&&!this.props.swipeable||s.isMouseMoveEvent(Y)&&!this.props.draggable||a.notEnoughChildren(this.state))){var X=this.getCords(s.isMouseMoveEvent(Y)?Y:Y.touches[0]),K=X.clientX,ne=X.clientY,se=this.initialX-K,ge=this.initialY-ne;if(this.onMove){if(!(Math.abs(se)>Math.abs(ge)))return;var _e=a.populateSlidesOnMouseTouchMove(this.state,this.props,this.initialX,this.lastX,K,this.transformPlaceHolder),xe=_e.direction,ae=_e.nextPosition,ve=_e.canContinue;xe&&(this.direction=xe,ve&&ae!==void 0&&this.setTransformDirectly(ae)),this.lastX=K}}},G.prototype.handleOut=function(Y){this.props.autoPlay&&!this.autoPlay&&(this.autoPlay=setInterval(this.next,this.props.autoPlaySpeed));var X=Y.type==="touchend"&&!this.props.swipeable,K=(Y.type==="mouseleave"||Y.type==="mouseup")&&!this.props.draggable;if(!X&&!K&&this.onMove){if(this.setAnimationDirectly(!0),this.direction==="right")if(this.initialX-this.lastX>=this.props.minimumTouchDrag){var ne=Math.round((this.initialX-this.lastX)/this.state.itemWidth);this.next(ne)}else this.correctItemsPosition(this.state.itemWidth,!0,!0);this.direction==="left"&&(this.lastX-this.initialX>this.props.minimumTouchDrag?(ne=Math.round((this.lastX-this.initialX)/this.state.itemWidth),this.previous(ne)):this.correctItemsPosition(this.state.itemWidth,!0,!0)),this.resetMoveStatus()}},G.prototype.isInViewport=function(Y){var X=Y.getBoundingClientRect(),K=X.top,ne=K===void 0?0:K,se=X.left,ge=se===void 0?0:se,_e=X.bottom,xe=_e===void 0?0:_e,ae=X.right,ve=ae===void 0?0:ae;return 0<=ne&&0<=ge&&xe<=(window.innerHeight||document.documentElement.clientHeight)&&ve<=(window.innerWidth||document.documentElement.clientWidth)},G.prototype.isChildOfCarousel=function(Y){return!!(Y instanceof Element&&this.listRef&&this.listRef.current)&&this.listRef.current.contains(Y)},G.prototype.onKeyUp=function(Y){var X=Y.target;switch(Y.keyCode){case 37:if(this.isChildOfCarousel(X))return this.previous();break;case 39:if(this.isChildOfCarousel(X))return this.next();break;case 9:if(this.isChildOfCarousel(X)&&X instanceof HTMLInputElement&&this.isInViewport(X))return this.next()}},G.prototype.handleEnter=function(Y){s.isMouseMoveEvent(Y)&&this.autoPlay&&this.props.autoPlay&&this.props.pauseOnHover&&(clearInterval(this.autoPlay),this.autoPlay=void 0)},G.prototype.goToSlide=function(Y,X,K){var ne=this;if(K===void 0&&(K=!0),!this.isInThrottle){var se=this.state.itemWidth,ge=this.props,_e=ge.afterChange,xe=ge.beforeChange,ae=this.state.currentSlide;typeof xe!="function"||X&&(typeof X!="object"||X.skipBeforeChange)||xe(Y,this.getState()),this.isAnimationAllowed=K,this.props.shouldResetAutoplay&&this.resetAutoplayInterval(),this.setState({currentSlide:Y,transform:-se*Y},function(){ne.props.infinite&&ne.correctClonesPosition({domLoaded:!0}),typeof _e!="function"||X&&(typeof X!="object"||X.skipAfterChange)||(G.afterChangeTimeout3=setTimeout(function(){_e(ae,ne.getState())},ne.props.transitionDuration||O))})}},G.prototype.getState=function(){return this.state},G.prototype.renderLeftArrow=function(Y){var X=this,K=this.props,ne=K.customLeftArrow,se=K.rtl;return t.createElement(v.LeftArrow,{customLeftArrow:ne,getState:function(){return X.getState()},previous:this.previous,disabled:Y,rtl:se})},G.prototype.renderRightArrow=function(Y){var X=this,K=this.props,ne=K.customRightArrow,se=K.rtl;return t.createElement(v.RightArrow,{customRightArrow:ne,getState:function(){return X.getState()},next:this.next,disabled:Y,rtl:se})},G.prototype.renderButtonGroups=function(){var Y=this,X=this.props.customButtonGroup;return X?t.cloneElement(X,{previous:function(){return Y.previous()},next:function(){return Y.next()},goToSlide:function(K,ne){return Y.goToSlide(K,ne)},carouselState:this.getState()}):null},G.prototype.renderDotsList=function(){var Y=this;return t.createElement(f.default,{state:this.state,props:this.props,goToSlide:this.goToSlide,getState:function(){return Y.getState()}})},G.prototype.renderCarouselItems=function(){var Y=[];if(this.props.infinite){var X=t.Children.toArray(this.props.children);Y=a.getClones(this.state.slidesToShow,X)}return t.createElement(S.default,{clones:Y,goToSlide:this.goToSlide,state:this.state,notEnoughChildren:a.notEnoughChildren(this.state),props:this.props})},G.prototype.render=function(){var Y=this.props,X=Y.deviceType,K=Y.arrows,ne=Y.renderArrowsWhenDisabled,se=Y.removeArrowOnDeviceType,ge=Y.infinite,_e=Y.containerClass,xe=Y.sliderClass,ae=Y.customTransition,ve=Y.additionalTransfrom,Se=Y.renderDotsOutside,He=Y.renderButtonGroupOutside,Ge=Y.className,ye=Y.rtl,Le=a.getInitialState(this.state,this.props),ht=Le.shouldRenderOnSSR,gt=Le.shouldRenderAtAll,Ft=a.isInLeftEnd(this.state),_t=a.isInRightEnd(this.state),yt=K&&!(se&&(X&&-1<se.indexOf(X)||this.state.deviceType&&-1<se.indexOf(this.state.deviceType)))&&!a.notEnoughChildren(this.state)&&gt,Vt=!ge&&Ft,Ht=!ge&&_t,Bt=i.getTransform(this.state,this.props);return t.createElement(t.Fragment,null,t.createElement("div",{className:"react-multi-carousel-list "+_e+" "+Ge,dir:ye?"rtl":"ltr",ref:this.containerRef},t.createElement("ul",{ref:this.listRef,className:"react-multi-carousel-track "+xe,style:{transition:this.isAnimationAllowed?ae||z:"none",overflow:ht?"hidden":"unset",transform:"translate3d("+(Bt+ve)+"px,0,0)"},onMouseMove:this.handleMove,onMouseDown:this.handleDown,onMouseUp:this.handleOut,onMouseEnter:this.handleEnter,onMouseLeave:this.handleOut,onTouchStart:this.handleDown,onTouchMove:this.handleMove,onTouchEnd:this.handleOut},this.renderCarouselItems()),yt&&(!Vt||ne)&&this.renderLeftArrow(Vt),yt&&(!Ht||ne)&&this.renderRightArrow(Ht),gt&&!He&&this.renderButtonGroups(),gt&&!Se&&this.renderDotsList()),gt&&Se&&this.renderDotsList(),gt&&He&&this.renderButtonGroups())},G.defaultProps={slidesToSlide:1,infinite:!1,draggable:!0,swipeable:!0,arrows:!0,renderArrowsWhenDisabled:!1,containerClass:"",sliderClass:"",itemClass:"",keyBoardControl:!0,autoPlaySpeed:3e3,showDots:!1,renderDotsOutside:!1,renderButtonGroupOutside:!1,minimumTouchDrag:80,className:"",dotListClass:"",focusOnSelect:!1,centerMode:!1,additionalTransfrom:0,pauseOnHover:!0,shouldResetAutoplay:!0,rewind:!1,rtl:!1,rewindWithAnimation:!1},G}(t.Component);return N_.default=j,N_}var e6;function OX(){if(e6)return Y2;e6=1,Object.defineProperty(Y2,"__esModule",{value:!0});var e=MX();return Y2.default=e.default,Y2}var x3,t6;function IX(){return t6||(t6=1,x3=OX()),x3}var PX=IX();const RX=Ei(PX);function DX(e){const t={mobile:{breakpoint:{max:3e3,min:0},partialVisibilityGutter:0,items:1}},a=e.imageSources.length>1;return he.jsx(RX,{responsive:t,infinite:!1,autoPlay:!1,arrows:!0,showDots:a,swipeable:!0,draggable:!0,containerClass:_3.carousel,itemClass:_3.carousel__item,beforeChange:s=>{var f;(f=window.getSelection())==null||f.removeAllRanges()},children:e.imageSources.map((s,f)=>he.jsx("img",{src:s,alt:`Slide ${f}`,className:_3.item__image,draggable:!1,onDragStart:v=>v.preventDefault()},f))})}const LX="_photos_1z0tf_1",zX="_photos__infoBar_1z0tf_8",kX="_infoBar__substrate_1z0tf_21",BX="_substrate__customStatus_1z0tf_45",NX="_infoBar__customRating_1z0tf_50",FX="_customRating__text_1z0tf_73",j_={photos:LX,photos__infoBar:zX,infoBar__substrate:kX,substrate__customStatus:BX,infoBar__customRating:NX,customRating__text:FX},jX="data:image/svg+xml,%3csvg%20width='16.67'%20height='16.67'%20viewBox='0%200%2020%2020'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M7.15316%203.40838C8.41981%201.13613%209.05314%200%2010%200C10.9469%200%2011.5802%201.13612%2012.8468%203.40837L13.1745%203.99623C13.5345%204.64193%2013.7144%204.96479%2013.9951%205.17781C14.2757%205.39083%2014.6251%205.4699%2015.3241%205.62805L15.9605%205.77203C18.4201%206.32856%2019.65%206.60682%2019.9426%207.54773C20.2352%208.48864%2019.3968%209.46907%2017.7199%2011.4299L17.2861%2011.9372C16.8096%2012.4944%2016.5713%2012.773%2016.4641%2013.1177C16.357%2013.4624%2016.393%2013.8341%2016.465%2014.5776L16.5306%2015.2544C16.7841%2017.8706%2016.9109%2019.1787%2016.1449%2019.7602C15.3788%2020.3417%2014.2273%2019.8115%2011.9243%2018.7512L11.3285%2018.4768C10.6741%2018.1755%2010.3469%2018.0248%2010%2018.0248C9.65315%2018.0248%209.32593%2018.1755%208.67149%2018.4768L8.07567%2018.7512C5.77268%2019.8115%204.62118%2020.3417%203.85515%2019.7602C3.08912%2019.1787%203.21588%2017.8706%203.4694%2015.2544L3.53498%2014.5776C3.60703%2013.8341%203.64305%2013.4624%203.53586%2013.1177C3.42868%2012.773%203.19043%2012.4944%202.71392%2011.9372L2.2801%2011.4299C0.603249%209.46907%20-0.235175%208.48864%200.057421%207.54773C0.350017%206.60682%201.57986%206.32856%204.03954%205.77203L4.67589%205.62805C5.37485%205.4699%205.72433%205.39083%206.00494%205.17781C6.28555%204.96479%206.46553%204.64194%206.82547%203.99623L7.15316%203.40838Z'%20fill='%23F89520'/%3e%3c/svg%3e";function UX(e){const t=y5[e.stationStatus];return he.jsxs("div",{className:j_.photos,children:[he.jsxs("div",{className:j_.photos__infoBar,children:[he.jsx("div",{className:j_.infoBar__substrate,children:he.jsx(Yb,{textSize:"large",text:e.stationStatus,className:j_.substrate__customStatus,color:t})}),e.rating&&he.jsxs("div",{className:j_.infoBar__customRating,children:[he.jsx("img",{src:jX,alt:"Rating"}),he.jsxs("p",{className:j_.customRating__text,children:[" ",e.rating]})]})]}),he.jsx(DX,{imageSources:e.imageSources})]})}const VX="_connector_1p0w2_1",$X="_connector__status_1p0w2_21",qX="_connector__title_1p0w2_28",GX="_text_1p0w2_37",HX="_connector__image_1p0w2_45",ZX="_connector__info_1p0w2_51",WX="_info__column_1p0w2_68",XX="_connector__lineSeparator_1p0w2_79",YX="_connector__tariffsBlock_1p0w2_87",KX="_tariffsBlock__tariffs_1p0w2_100",JX="_tariffs__icon_1p0w2_114",QX="_tariffs__list_1p0w2_121",eY="_text_blue_1p0w2_132",tY="_text_green_1p0w2_140",nY="_text_orange_1p0w2_144",Io={connector:VX,connector__status:$X,connector__title:qX,text:GX,connector__image:HX,connector__info:ZX,info__column:WX,connector__lineSeparator:XX,connector__tariffsBlock:YX,tariffsBlock__tariffs:KX,tariffs__icon:JX,tariffs__list:QX,text_blue:eY,text_green:tY,text_orange:nY},rY={AC:"green","AC-2":"green","AC-3":"green",DC:"orange"},N5="data:image/svg+xml,%3csvg%20width='18'%20height='18'%20viewBox='0%200%2018%2018'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M4.5%206H7.5'%20stroke='%23373435'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20d='M15.625%206.75H13.6731C12.3348%206.75%2011.25%207.75736%2011.25%209C11.25%2010.2426%2012.3348%2011.25%2013.6731%2011.25H15.625C15.6875%2011.25%2015.7187%2011.25%2015.7451%2011.2484C16.1496%2011.2238%2016.4718%2010.9246%2016.4983%2010.5491C16.5%2010.5246%2016.5%2010.4955%2016.5%2010.4375V7.5625C16.5%207.50447%2016.5%207.47545%2016.4983%207.45095C16.4718%207.07538%2016.1496%206.77622%2015.7451%206.75161C15.7187%206.75%2015.6875%206.75%2015.625%206.75Z'%20stroke='%23373435'%20stroke-width='1.5'/%3e%3cpath%20d='M16.0238%206.4502C15.9654%205.04597%2015.7774%204.185%2015.1713%203.57887C14.2926%202.7002%2012.8784%202.7002%2010.05%202.7002L7.79999%202.7002C4.97156%202.7002%203.55735%202.7002%202.67867%203.57888C1.79999%204.45755%201.79999%205.87177%201.79999%208.7002C1.79999%2011.5286%201.79999%2012.9428%202.67867%2013.8215C3.55735%2014.7002%204.97156%2014.7002%207.79999%2014.7002H10.05C12.8784%2014.7002%2014.2926%2014.7002%2015.1713%2013.8215C15.7774%2013.2154%2015.9654%2012.3544%2016.0238%2010.9502'%20stroke='%23373435'%20stroke-width='1.5'/%3e%3cpath%20d='M13.95%209H13.956'%20stroke='%23373435'%20stroke-width='2'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",B7={Энергия:"кВт·ч","Начало зарядки":null,Длительность:"час","Длительность парковки":"час"};function iY(e){return he.jsxs("div",{className:Io.connector,children:[he.jsx(Yb,{text:e.info.status,color:z8[e.info.status],textSize:"medium",className:Io.connector__status}),he.jsx("div",{className:Io.connector__title,children:e.info.standard}),he.jsx("img",{src:C1[e.info.standard],className:Io.connector__image,alt:"Connector"}),he.jsxs("div",{className:Io.connector__info,children:[he.jsxs("div",{className:Io.info__column,children:[he.jsxs("a",{className:Io.text,children:[e.info.max_electric_power," кВт"]}),he.jsxs("a",{className:Io.text,children:[e.info.max_amperage," А"]})]}),he.jsxs("div",{className:Io.info__column,children:[he.jsx("a",{className:Io.text,children:e.info.format}),he.jsx("a",{className:`${Io.text} ${Io["text_"+rY[e.info.power_type]]}`,children:e.info.power_type})]})]}),he.jsx("div",{className:Io.connector__lineSeparator}),he.jsx("div",{className:Io.connector__tariffsBlock,children:he.jsxs("div",{className:Io.tariffsBlock__tariffs,children:[he.jsx("img",{src:N5,alt:"Wallet",className:Io.tariffs__icon}),he.jsx("div",{className:Io.tariffs__list,children:e.info.tariffs.map((t,a)=>{const s=B7[t.type];return he.jsxs("a",{className:Io.text_blue,children:[t.price," ",t.currency,s?"/"+s:""]},a)})})]})})]})}const aY="_block_4c54q_1",oY="_block__chart_4c54q_9",sY="_chart__text_4c54q_15",lY="_chart__procentage_4c54q_23",rx={block:aY,block__chart:oY,chart__text:sY,chart__procentage:lY},cY=166,uY={1:"ПН",2:"ВТ",3:"СР",4:"ЧТ",5:"ПТ",6:"СБ",7:"ВС"};var qs;(e=>{e.TOP_EDGE_DISTANCE=6,e.BOTTOM_EDGE_DISTANCE=17,e.RIGHT_EDGE_DISTANCE=6,e.LEFT_EDGE_DISTANCE=25,e.DISTANCE_BETWEEN_BOTTOM_AND_TEXT=2})(qs||(qs={}));const ix=20;var Fp;(e=>{e.MIN_GREEN=200,e.MAX_BLUE=128,e.MIN_BLUE=229,e.MAX_GREEN=112})(Fp||(Fp={}));const Px=cY-qs.BOTTOM_EDGE_DISTANCE-qs.TOP_EDGE_DISTANCE,hY=Px/4;var Fx;(e=>{e.INACTIVE_COLUMN_COLOR="#C8CED8",e.LINE_STROKE_COLOR="#E8E8EE"})(Fx||(Fx={}));var jx;(e=>{e.SMALL=3,e.NORMAL=5})(jx||(jx={}));const fY=2,dY=15,pY=5,mY=5,_Y=7,GC=7,gY=e=>{const t=Math.round(Fp.MIN_GREEN-e/100*(Fp.MIN_GREEN-Fp.MAX_GREEN)),a=Math.round(Fp.MIN_BLUE-e/100*(Fp.MIN_BLUE-Fp.MAX_BLUE));return`#00${t.toString(16).padStart(2,"0")}${a.toString(16).padStart(2,"0")}`},yY=e=>{const t=[];let a=0;for(let s=1;s<=GC;s++){const f={weekday:s,occupancy_in_percentage:0};a<e.length&&e[a].weekday===s&&(f.occupancy_in_percentage=e[a].occupancy_in_percentage,a++),t.push(f)}return t};function vY(e){const t=Me.useRef(null),[a,s]=Me.useState({}),[f,v]=Me.useState([window.innerWidth,window.innerHeight]),S="middle",i=Me.useMemo(()=>{const z=e.data.sort((j,F)=>j.weekday===F.weekday?0:j.weekday>F.weekday?1:-1);return e.data.length<7?yY(z):z},[e.data]);Me.useEffect(()=>{if(t.current!==null){const z=t.current.clientWidth,j=z-qs.RIGHT_EDGE_DISTANCE-qs.LEFT_EDGE_DISTANCE,F=(j-ix*GC)/(GC-1);s({clientWidth:z,width:j,distanceBetweenColums:F})}},[t,f]),Me.useEffect(()=>{const z=()=>v([window.innerWidth,window.innerHeight]);return window.addEventListener("resize",z),()=>window.removeEventListener("resize",z)},[]);const O=()=>{const z=[];for(let j=qs.TOP_EDGE_DISTANCE,F=4;j<=Px+qs.TOP_EDGE_DISTANCE,F>=0;j+=hY,F--)z.push(he.jsxs("text",{x:qs.LEFT_EDGE_DISTANCE/2,y:j+qs.TOP_EDGE_DISTANCE/2,textAnchor:S,className:rx.chart__procentage,children:[25*F,"%"]},F)),F!==0&&z.push(he.jsx("line",{x1:qs.LEFT_EDGE_DISTANCE+F,y1:j,x2:a.clientWidth,y2:j,stroke:Fx.LINE_STROKE_COLOR,strokeWidth:fY,strokeDasharray:dY},j));return z};return he.jsx("div",{className:rx.block,ref:t,children:he.jsxs("svg",{className:rx.block__chart,children:[O(),i.map((z,j)=>{const F=qs.LEFT_EDGE_DISTANCE+j*(ix+a.distanceBetweenColums),G=z.occupancy_in_percentage<mY?pY:z.occupancy_in_percentage*Px/100,Y=Px+qs.TOP_EDGE_DISTANCE-G;return he.jsxs("g",{children:[he.jsx("rect",{x:F,y:Y,rx:G>=_Y?jx.NORMAL:jx.SMALL,fill:z.occupancy_in_percentage===0?Fx.INACTIVE_COLUMN_COLOR:gY(z.occupancy_in_percentage),width:ix,height:G}),he.jsx("text",{x:F+ix/2,y:Y+G+qs.BOTTOM_EDGE_DISTANCE-qs.DISTANCE_BETWEEN_BOTTOM_AND_TEXT,textAnchor:S,className:rx.chart__text,children:uY[z.weekday]})]},j)})]})})}const xY="data:image/svg+xml,%3csvg%20width='18'%20height='20'%20viewBox='0%200%2018%2020'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M4.5%207.75L9%2012.25L13.5%207.75'%20stroke='%23373435'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",bY="_expandButton_146hr_1",wY="_expandButton_text_146hr_15",n6={expandButton:bY,expandButton_text:wY};function SY(e){return he.jsxs("button",{className:`${n6.expandButton} ${n6.expandButton_text}`,onClick:()=>e.onClick(e.isOpen),children:[e.isOpen?"Свернуть":"Развернуть",he.jsx("img",{src:e.isOpen?A7:xY,alt:"arrow"})]})}const TY="_page_12t47_1",EY="_page__block_12t47_5",AY="_block__content_12t47_16",CY="_content__distance_12t47_26",MY="_page__lineSeparator_12t47_45",OY="_title_12t47_51",IY="_text_subTitle_12t47_60",PY="_text_12t47_60",RY="_description__footer_12t47_77",DY="_text_collapsed_12t47_89",LY="_text_expanded_12t47_96",zY="_text_distance_12t47_100",kY="_page__connectors_12t47_109",BY="_page__support_12t47_121",no={page:TY,page__block:EY,block__content:AY,content__distance:CY,page__lineSeparator:MY,title:OY,text_subTitle:IY,text:PY,description__footer:RY,text_collapsed:DY,text_expanded:LY,text_distance:zY,page__connectors:kY,page__support:BY},NY=()=>{const[e]=Db(),[t,a]=Me.useState({});return Me.useEffect(()=>{const s=e.get(Td.PREVIOUS_PAGE),f=e.get(Td.FROM_CHARGING_SESSION_ID);a({prev_page:s,from_charging_session_id:f})},[e]),{pageQueries:t}},FY=()=>{const{id:e}=bV(),{position:t}=Me.useContext(Va),{getStationByIdFromApi:a}=nu(),[s,f]=Me.useState(),[v,S]=Me.useState(!0);return Me.useEffect(()=>{e!==void 0&&a({id:e,latitude:t==null?void 0:t.latitude.toString(),longitude:t==null?void 0:t.longitude.toString()}).then(i=>{i&&f(i)}).finally(()=>S(!1))},[e]),{station:s,loading:v}};function jY(){return he.jsx("div",{children:"Не найдено"})}function UY(){const e=yo(),{pageQueries:t}=NY(),{loading:a,station:s}=FY(),[f,v]=Me.useState(!1),S=s==null?void 0:s.description,i=Me.useMemo(()=>S?S.length>50:!1,[S]);if(a)return he.jsx(Hp,{});if(!s)return he.jsx(jY,{});const O=()=>{v(!f)},z=()=>!f&&i?(S==null?void 0:S.slice(0,50))+"...":S,j=i,F=()=>s.metres_to_station?(s.metres_to_station/1e3).toLocaleString("ru-RU",{minimumFractionDigits:0,maximumFractionDigits:2}):void 0,G=()=>{switch(t.prev_page){case xd.STATIONS_LIST:return E1;case xd.ACTIVE_SESSION:return Lb+(t.from_charging_session_id??"");case xd.SESSIONS_LIST:return qp}return"/"};return he.jsxs(Pd,{onReturn:()=>e(G()),title:s.name,className:no.page,children:[s.images&&s.images.length!==0&&he.jsx(UX,{imageSources:s.images,stationStatus:s.status}),he.jsxs("div",{className:no.page__block,children:[he.jsx("a",{className:no.text_subTitle,children:"Адрес"}),he.jsx(Ro,{children:he.jsxs("div",{className:no.block__content,children:[he.jsx("a",{className:no.text,children:s.address}),F()&&he.jsxs("div",{className:no.content__distance,children:[he.jsx("img",{src:O7,alt:"path"}),he.jsxs("a",{className:no.text_distance,children:[F()," км"]})]})]})})]}),S&&he.jsxs("div",{className:no.page__block,children:[he.jsx("a",{className:no.text_subTitle,children:"Описание"}),he.jsxs(Ro,{children:[he.jsx("div",{children:he.jsx("a",{className:`${no.text} ${f?no.text_expanded:no.text_collapsed}`,children:z()})}),j&&he.jsx("div",{className:no.description__footer,children:he.jsx(SY,{onClick:O,isOpen:f})})]})]}),he.jsx("div",{className:no.page__lineSeparator}),he.jsx("div",{className:no.page__connectors,children:s.connectors.map((Y,X)=>he.jsx(iY,{info:Y},X))}),he.jsx("div",{className:no.page__lineSeparator}),he.jsxs("div",{className:no.page__block,children:[he.jsx("a",{className:no.text_subTitle,children:"График загруженности"}),he.jsx(Ro,{children:he.jsx(vY,{data:s.occupation})})]}),he.jsxs("div",{className:no.page__support,children:[he.jsxs("a",{className:no.title,children:["Возникли проблемы со станцией? ",he.jsx("br",{}),"Свяжитесь с нами!"]}),he.jsx(Jl,{variant:"fill",text:"Техподдержка",onClick:()=>window.location.replace("https://t.me/egine_cpo")})]})]})}const VY="_stationFilters_z7i9m_1",$Y="_stationFilters__onlyAvailable_z7i9m_16",qY="_onlyAvailable__text_z7i9m_29",GY="_stationFilters__minimalPower_z7i9m_38",HY="_minimalPower__text_z7i9m_56",ZY="_tittle__text_z7i9m_57",WY="_stationFilters__connectors_z7i9m_65",XY="_connectors__tittle_z7i9m_80",YY="_connectors__row_z7i9m_94",KY="_connectors__lastRow_z7i9m_95",JY="_stationFilters__footer_z7i9m_119",Hc={stationFilters:VY,stationFilters__onlyAvailable:$Y,onlyAvailable__text:qY,stationFilters__minimalPower:GY,minimalPower__text:HY,tittle__text:ZY,stationFilters__connectors:WY,connectors__tittle:XY,connectors__row:YY,connectors__lastRow:KY,stationFilters__footer:JY},QY="_card_1v1cy_1",eK="_card_enabled_1v1cy_21",tK="_card_disabled_1v1cy_26",nK="_card__content_1v1cy_31",rK="_content__icon_1v1cy_43",iK="_content__text_1v1cy_59",U_={card:QY,card_enabled:eK,card_disabled:tK,card__content:nK,content__icon:rK,content__text:iK};function ws(e){const[t,a]=Me.useState(e.enabled??!0);Me.useEffect(()=>{a(e.enabled??!0)},[e.enabled]);const s=()=>{e.disabled||(a(!t),e.onChange(!t))};return he.jsx("div",{className:`${U_.card} ${t?U_.card_enabled:""} ${e.disabled?U_.card_disabled:""}`,onClick:s,children:he.jsxs("div",{className:U_.card__content,children:[he.jsx("div",{className:U_.content__icon,children:he.jsx("img",{src:C1[e.connector],alt:e.connector})}),he.jsx("a",{className:U_.content__text,children:e.connector})]})})}const aK="_resetButton_jn0qq_1",oK="_resetButton__icon_jn0qq_21",sK="_resetButton_active_jn0qq_29",lK="_resetButton_disabled_jn0qq_33",ax={resetButton:aK,resetButton__icon:oK,resetButton_active:sK,resetButton_disabled:lK};function N7(e){return he.jsxs("button",{className:`${ax.resetButton} ${e.disabled?ax.resetButton_disabled:ax.resetButton_active}`,onClick:e.onClick,disabled:e.disabled,children:[he.jsx("img",{src:e.iconSrc,alt:"resetFiltersIcon",className:ax.resetButton__icon}),he.jsx("span",{children:e.text})]})}const F7="data:image/svg+xml,%3csvg%20width='25'%20height='24'%20viewBox='0%200%2025%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M4.17981%2011.3333H3.42981H4.17981ZM4.17981%2013L3.65157%2013.5324C3.94398%2013.8225%204.41565%2013.8225%204.70805%2013.5324L4.17981%2013ZM6.38787%2011.8657C6.68191%2011.574%206.68377%2011.0991%206.39203%2010.8051C6.10029%2010.511%205.62542%2010.5092%205.33138%2010.8009L6.38787%2011.8657ZM3.02824%2010.8009C2.7342%2010.5092%202.25933%2010.511%201.96759%2010.8051C1.67585%2011.0991%201.67772%2011.574%201.97176%2011.8657L3.02824%2010.8009ZM19.1156%207.39279C19.3325%207.74565%2019.7944%207.85585%2020.1473%207.63892C20.5001%207.42199%2020.6103%206.96007%2020.3934%206.60721L19.1156%207.39279ZM12.5789%202.25C7.53155%202.25%203.42981%206.3112%203.42981%2011.3333H4.92981C4.92981%207.15072%208.34884%203.75%2012.5789%203.75V2.25ZM3.42981%2011.3333L3.42981%2013H4.92981L4.92981%2011.3333H3.42981ZM4.70805%2013.5324L6.38787%2011.8657L5.33138%2010.8009L3.65157%2012.4676L4.70805%2013.5324ZM4.70805%2012.4676L3.02824%2010.8009L1.97176%2011.8657L3.65157%2013.5324L4.70805%2012.4676ZM20.3934%206.60721C18.787%203.99427%2015.8873%202.25%2012.5789%202.25V3.75C15.3484%203.75%2017.7727%205.20845%2019.1156%207.39279L20.3934%206.60721Z'%20fill='%23373435'/%3e%3cpath%20d='M20.8139%2011L21.3411%2010.4666C21.049%2010.1778%2020.5788%2010.1778%2020.2867%2010.4666L20.8139%2011ZM18.6004%2012.1333C18.3058%2012.4244%2018.3031%2012.8993%2018.5942%2013.1939C18.8854%2013.4885%2019.3603%2013.4913%2019.6549%2013.2001L18.6004%2012.1333ZM21.9729%2013.2001C22.2675%2013.4913%2022.7424%2013.4885%2023.0335%2013.1939C23.3247%2012.8993%2023.322%2012.4244%2023.0274%2012.1332L21.9729%2013.2001ZM5.81794%2016.6061C5.6004%2016.2536%205.1383%2016.1442%204.78581%2016.3618C4.43331%2016.5793%204.32391%2017.0414%204.54144%2017.3939L5.81794%2016.6061ZM12.3827%2021.75C17.4451%2021.75%2021.5639%2017.6915%2021.5639%2012.6667H20.0639C20.0639%2016.8466%2016.6332%2020.25%2012.3827%2020.25V21.75ZM21.5639%2012.6667V11H20.0639V12.6667H21.5639ZM20.2867%2010.4666L18.6004%2012.1333L19.6549%2013.2001L21.3411%2011.5334L20.2867%2010.4666ZM20.2867%2011.5334L21.9729%2013.2001L23.0274%2012.1332L21.3411%2010.4666L20.2867%2011.5334ZM4.54144%2017.3939C6.15405%2020.007%209.06403%2021.75%2012.3827%2021.75V20.25C9.60023%2020.25%207.16584%2018.7903%205.81794%2016.6061L4.54144%2017.3939Z'%20fill='%23373435'/%3e%3c/svg%3e",cK="_on_1c7f6_20",uK="_switch__toggle_1c7f6_26",hK="_off_1c7f6_31",fK="_disabled_1c7f6_42",rv={switch:"_switch_1c7f6_1",on:cK,switch__toggle:uK,off:hK,disabled:fK};function j7(e){const[t,a]=Me.useState(e.enabled??!0);Me.useEffect(()=>{a(e.enabled??!0)},[e.enabled]);const s=()=>{e.disabled||(a(!t),e.onChange(!t))};return he.jsx("div",{className:`${rv.switch} ${t?rv.on:rv.off} ${e.disabled?rv.disabled:""}`,onClick:s,children:he.jsx("div",{className:rv.switch__toggle})})}const dK=e=>e.connectors.length===X_.connectors.length&&e.connectors.every(t=>X_.connectors.includes(t))&&e.onlyAvailableStations===X_.onlyAvailableStations&&e.minimalPower===X_.minimalPower&&e.isModified===X_.isModified,pK="_sliderContainer_h6yjy_1",mK="_slider_h6yjy_1",_K="_slider__pointer_h6yjy_21",gK="_slider__legendContainer_h6yjy_46",yK="_legendContainer__text_h6yjy_59",V_={sliderContainer:pK,slider:mK,slider__pointer:_K,slider__legendContainer:gK,legendContainer__text:yK},U7=({items:e,onChange:t,current:a,orderedItemKeys:s})=>{if(JSON.stringify(Object.keys(e).slice(0).sort())!=JSON.stringify(s.slice(0).sort()))throw new Error("Items keys does not equal to orderedItemKeys, check you parameters");const[f,v]=Me.useState(0),[S,i]=Me.useState(0),[O,z]=Me.useState(!1),j=Me.useRef(null),F=Me.useRef(null),G=Me.useRef(null),Y=Me.useMemo(()=>s,[s]);Me.useEffect(()=>{if(a!==void 0){const ve=Y.findIndex(He=>e[He]===a);v((ve===-1?0:ve)/(Y.length-1)*100)}},[a]);const X=ve=>{z(!0),xe(ve.clientX),xe(ve.clientX)},K=ve=>{z(!0),xe(ve.touches[0].clientX)},ne=ve=>{O&&xe(ve.clientX)},se=ve=>{O&&xe(ve.touches[0].clientX)},ge=()=>{O&&(z(!1),ae(),t(e[Y[S]]))},_e=()=>{O&&(z(!1),ae(),t(e[Y[S]]))},xe=ve=>{if(j.current){const Se=j.current.getBoundingClientRect(),He=ve-Se.left,Ge=Se.width,ye=Math.round(He/Ge*(Y.length-1));i(Math.max(0,Math.min(Y.length-1,ye)));let Le=He;Le<0?Le=0:Le>Ge&&(Le=Ge),v(Le/Ge*100)}},ae=()=>{if(j.current&&F.current&&G.current){const Se=F.current.getElementsByClassName(V_.legendContainer__text)[S].getBoundingClientRect(),He=G.current.getBoundingClientRect(),Ge=j.current.getBoundingClientRect();if(S===Y.length-1)v((Ge.width-He.width/2)/Ge.width*100);else if(S===0)v(He.width/2/Ge.width*100);else{const ye=Se.left-Ge.left+Se.width/2;v(ye/Ge.width*100)}}};return Me.useEffect(()=>(document.addEventListener("mousemove",ne),document.addEventListener("mouseup",ge),document.addEventListener("touchmove",se),document.addEventListener("touchend",_e),()=>{document.removeEventListener("mousemove",ne),document.removeEventListener("mouseup",ge),document.removeEventListener("touchmove",se),document.removeEventListener("touchend",_e)}),[O,S]),he.jsxs("div",{className:V_.sliderContainer,children:[he.jsx("div",{ref:j,className:V_.slider,onMouseDown:X,onTouchStart:K,children:he.jsx("div",{className:V_.slider__pointer,style:{left:`${f}%`,transition:O?"none":void 0,borderColor:O?"#13A69D":void 0},ref:G})}),he.jsx("div",{className:V_.slider__legendContainer,ref:F,children:Y.map((ve,Se)=>he.jsx("div",{className:V_.legendContainer__text,children:ve},Se))})]})};function vK(){const{stationFilters:e,setStationFilters:t,showSnackbar:a}=Me.useContext(Va),s=(O,z)=>{t({...e,connectors:z?[...e.connectors,O]:e.connectors.filter(j=>j!==O),isModified:!0})},f=O=>{t({...e,onlyAvailableStations:O,isModified:!0})},v=O=>{t({...e,minimalPower:O*1e3,isModified:!0})},S=()=>{t({...e,isModified:!1,shouldUpdateStations:!0}),a("success","Фильтры применены")},i=()=>{t({...X_,partOfName:e.partOfName,shouldUpdateStations:!0}),a("success","Фильтры сброшены")};return he.jsxs("div",{className:Hc.stationFilters,children:[he.jsx(Ro,{children:he.jsxs("div",{className:Hc.stationFilters__onlyAvailable,children:[he.jsx("p",{className:Hc.onlyAvailable__text,children:"Только доступные"}),he.jsx(j7,{onChange:f,enabled:e.onlyAvailableStations})]})}),he.jsxs("div",{className:Hc.stationFilters__minimalPower,children:[he.jsx("span",{className:Hc.minimalPower__text,children:"Минимальная мощность, кВт"}),he.jsx(Ro,{children:he.jsx(U7,{onChange:O=>v(O),items:{3:3,18:18,35:35,50:50,75:75,">100":100},orderedItemKeys:["3","18","35","50","75",">100"],current:e.minimalPower/1e3})})]}),he.jsxs("div",{className:Hc.stationFilters__connectors,children:[he.jsx("div",{className:Hc.connectors__tittle,children:he.jsx("span",{className:Hc.tittle__text,children:"Коннекторы"})}),he.jsx(Ro,{children:he.jsxs("div",{className:Hc.connectors__row,children:[he.jsx(ws,{onChange:O=>s("Type 1",O),connector:"Type 1",enabled:e.connectors.includes("Type 1")}),he.jsx(ws,{onChange:O=>s("Type 2",O),connector:"Type 2",enabled:e.connectors.includes("Type 2")}),he.jsx(ws,{onChange:O=>s("CCS1",O),connector:"CCS1",enabled:e.connectors.includes("CCS1")})]})}),he.jsx(Ro,{children:he.jsxs("div",{className:Hc.connectors__row,children:[he.jsx(ws,{onChange:O=>s("CCS2",O),connector:"CCS2",enabled:e.connectors.includes("CCS2")}),he.jsx(ws,{onChange:O=>s("GB/T (AC)",O),connector:"GB/T (AC)",enabled:e.connectors.includes("GB/T (AC)")}),he.jsx(ws,{onChange:O=>s("GB/T (DC)",O),connector:"GB/T (DC)",enabled:e.connectors.includes("GB/T (DC)")})]})}),he.jsx(Ro,{children:he.jsxs("div",{className:Hc.connectors__lastRow,children:[he.jsx(ws,{onChange:O=>s("CHAdeMO",O),connector:"CHAdeMO",enabled:e.connectors.includes("CHAdeMO")}),he.jsx(ws,{onChange:O=>s("Tesla",O),connector:"Tesla",enabled:e.connectors.includes("Tesla")})]})})]}),he.jsxs("div",{className:Hc.stationFilters__footer,children:[he.jsx(N7,{onClick:i,disabled:dK(e),iconSrc:F7,text:"Сбросить фильтры"}),he.jsx(Jl,{onClick:S,variant:"fill",text:"Применить",disabled:!e.isModified})]})]})}const xK=()=>{const[e]=Db(),[t,a]=Me.useState({});return Me.useEffect(()=>{const s=e.get(kv.PREVIOUS_PAGE);a({prev_page:s})},[e]),{pageQueries:t}},bK="_page_w9u5j_1",wK={page:bK};function SK(){const e=yo(),{pageQueries:t}=xK(),a=()=>{switch(t.prev_page){case cg.MAIN:return"/";case cg.STATIONS_LIST:return E1}};return he.jsx(Pd,{onReturn:()=>{const s=a();s&&e(s)},title:"Фильтры",className:wK.page,children:he.jsx(vK,{})})}const TK="_sessionFilters_1fiq3_1",EK="_sessionFilters__onlyPaid_1fiq3_16",AK="_onlyPaid__text_1fiq3_29",CK="_sessionFilters__minimalDuration_1fiq3_38",MK="_minimalDuration__text_1fiq3_56",OK="_tittle__text_1fiq3_57",IK="_sessionFilters__connectors_1fiq3_65",PK="_connectors__tittle_1fiq3_80",RK="_connectors__row_1fiq3_94",DK="_connectors__lastRow_1fiq3_95",LK="_sessionFilters__footer_1fiq3_119",Zc={sessionFilters:TK,sessionFilters__onlyPaid:EK,onlyPaid__text:AK,sessionFilters__minimalDuration:CK,minimalDuration__text:MK,tittle__text:OK,sessionFilters__connectors:IK,connectors__tittle:PK,connectors__row:RK,connectors__lastRow:DK,sessionFilters__footer:LK};var Ux;(e=>{e.CHARGING="Зарядка",e.COMPLETED="Завершена",e.INVALID="Невалидна"})(Ux||(Ux={}));const zK={Зарядка:"green",Невалидна:"red",Завершена:"grey"},Y_={connectors:[...lg],onlyPaidSessions:!1,durationInHours:0,isModified:!1,shouldUpdateSessions:!1},kK=e=>e.connectors.length===Y_.connectors.length&&e.connectors.every(t=>Y_.connectors.includes(t))&&e.onlyPaidSessions===Y_.onlyPaidSessions&&e.durationInHours===Y_.durationInHours&&e.isModified===Y_.isModified;function BK(){const{sessionFilters:e,setSessionFilters:t,showSnackbar:a}=Me.useContext(Va),s=(O,z)=>{t({...e,connectors:z?[...e.connectors,O]:e.connectors.filter(j=>j!==O),isModified:!0})},f=O=>{t({...e,onlyPaidSessions:O,isModified:!0})},v=O=>{t({...e,durationInHours:O,isModified:!0})},S=()=>{a("success","Фильтры применены"),t({...e,isModified:!1,shouldUpdateSessions:!0})},i=()=>{a("success","Фильтры сброшены"),t({...Y_,shouldUpdateSessions:!0})};return he.jsxs("div",{className:Zc.sessionFilters,children:[he.jsx(Ro,{children:he.jsxs("div",{className:Zc.sessionFilters__onlyPaid,children:[he.jsx("p",{className:Zc.onlyPaid__text,children:"Только платные"}),he.jsx(j7,{onChange:f,enabled:e.onlyPaidSessions})]})}),he.jsxs("div",{className:Zc.sessionFilters__minimalDuration,children:[he.jsx("span",{className:Zc.minimalDuration__text,children:"Минимальная длительность, часы"}),he.jsx(Ro,{children:he.jsx(U7,{onChange:O=>v(O),orderedItemKeys:["<1","2","3","5","8",">12"],items:{"<1":0,2:2,3:3,5:5,8:8,">12":12},current:e.durationInHours})})]}),he.jsxs("div",{className:Zc.sessionFilters__connectors,children:[he.jsx("div",{className:Zc.connectors__tittle,children:he.jsx("a",{className:Zc.tittle__text,children:"Коннекторы"})}),he.jsx(Ro,{children:he.jsxs("div",{className:Zc.connectors__row,children:[he.jsx(ws,{onChange:O=>s("Type 1",O),connector:"Type 1",enabled:e.connectors.includes("Type 1")}),he.jsx(ws,{onChange:O=>s("Type 2",O),connector:"Type 2",enabled:e.connectors.includes("Type 2")}),he.jsx(ws,{onChange:O=>s("CCS1",O),connector:"CCS1",enabled:e.connectors.includes("CCS1")})]})}),he.jsx(Ro,{children:he.jsxs("div",{className:Zc.connectors__row,children:[he.jsx(ws,{onChange:O=>s("CCS2",O),connector:"CCS2",enabled:e.connectors.includes("CCS2")}),he.jsx(ws,{onChange:O=>s("GB/T (AC)",O),connector:"GB/T (AC)",enabled:e.connectors.includes("GB/T (AC)")}),he.jsx(ws,{onChange:O=>s("GB/T (DC)",O),connector:"GB/T (DC)",enabled:e.connectors.includes("GB/T (DC)")})]})}),he.jsx(Ro,{children:he.jsxs("div",{className:Zc.connectors__lastRow,children:[he.jsx(ws,{onChange:O=>s("CHAdeMO",O),connector:"CHAdeMO",enabled:e.connectors.includes("CHAdeMO")}),he.jsx(ws,{onChange:O=>s("Tesla",O),connector:"Tesla",enabled:e.connectors.includes("Tesla")})]})})]}),he.jsxs("div",{className:Zc.sessionFilters__footer,children:[he.jsx(N7,{onClick:i,disabled:kK(e),iconSrc:F7,text:"Сбросить фильтры"}),he.jsx(Jl,{onClick:S,variant:"fill",text:"Применить",disabled:!e.isModified})]})]})}function NK(){const e=yo();return he.jsx(Pd,{onReturn:()=>e(qp),title:"Фильтры",className:R7.page,children:he.jsx(BK,{})})}const FK="_date__text_t5ck0_19",jK="_main__sessionCard_t5ck0_40",UK="_sessionsMap__date_t5ck0_65",b3={date__text:FK,main__sessionCard:jK,sessionsMap__date:UK},VK="_sessionCard_1tf94_1",$K="_sessionCard__header_1tf94_14",qK="_header__content_1tf94_15",GK="_content__connector_1tf94_35",HK="_content__station_1tf94_42",ZK="_station__mainInfo_1tf94_58",WK="_mainInfo__texts_1tf94_71",XK="_texts__name_1tf94_82",YK="_texts__address_1tf94_92",KK="_station__button_1tf94_102",JK="_sessionCard__gradientButton_1tf94_110",Uu={sessionCard:VK,sessionCard__header:$K,header__content:qK,content__connector:GK,content__station:HK,station__mainInfo:ZK,mainInfo__texts:WK,texts__name:XK,texts__address:YK,station__button:KK,sessionCard__gradientButton:JK},QK="_connector_1g0na_1",eJ="_connector__icon_1g0na_12",tJ="_connector__standard_1g0na_32",nJ="_standard__text_1g0na_45",iv={connector:QK,connector__icon:eJ,connector__standard:tJ,standard__text:nJ};function rJ(e){return he.jsxs("div",{className:iv.connector,children:[he.jsx("div",{className:iv.connector__icon,children:he.jsx("img",{src:C1[e.connector.standard],alt:e.connector.standard,className:iv.connector__icon})}),he.jsx("div",{className:iv.connector__standard,children:he.jsx("p",{className:iv.standard__text,children:e.connector.standard})})]})}const iJ="_gradientButton_1dron_1",aJ="_button__arrowIcon_1dron_27",oJ="_orange_1dron_31",sJ="_button__alert_1dron_37",lJ="_alert__icon_1dron_47",cJ="_alert__message_1dron_64",uJ="_message__text_1dron_77",i0={gradientButton:iJ,button__arrowIcon:aJ,orange:oJ,button__alert:sJ,alert__icon:lJ,alert__message:cJ,message__text:uJ},hJ="data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3ccircle%20cx='12'%20cy='12'%20r='10'%20fill='%23373435'/%3e%3cpath%20d='M12%207V13'%20stroke='white'%20stroke-width='1.5'%20stroke-linecap='round'/%3e%3ccircle%20cx='12'%20cy='16'%20r='0.5'%20fill='white'%20stroke='white'/%3e%3c/svg%3e",V7="data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M9%2018L15%2012L9%206'%20stroke='white'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e";function fJ(e){return he.jsxs("button",{"data-gradient-button":"true",onClick:e.onClick,className:`${i0.gradientButton} ${i0[e.gradientTemplate]}`,children:[he.jsxs("div",{className:i0.button__alert,children:[he.jsx("img",{className:i0.alert__icon,src:hJ}),he.jsx("div",{className:i0.alert__message,children:he.jsx("p",{className:i0.message__text,children:e.text})})]}),he.jsx("img",{className:i0.button__arrowIcon,src:V7})]})}const dJ="_horizontalSplit_hyxwz_1",pJ="_sessionCard__chargingInfo_hyxwz_8",mJ="_texts__row_hyxwz_9",_J="_activeSessionTexts__powerInfo_hyxwz_10",gJ="_powerInfo__row_hyxwz_11",yJ="_times__duration_hyxwz_12",vJ="_texts__paymentMethod_hyxwz_13",xJ="_chargingInfo__icon_hyxwz_23",bJ="_chargingInfo__texts_hyxwz_32",wJ="_row__label_hyxwz_45",SJ="_row__value_hyxwz_57",TJ="_sessionCard__session_hyxwz_71",EJ="_sessionCard__payment_hyxwz_72",AJ="_session__icon_hyxwz_85",CJ="_session__times_hyxwz_94",MJ="_times__start_hyxwz_110",OJ="_texts__amount_hyxwz_112",IJ="_bateryInfo__row_hyxwz_114",PJ="_payment__icon_hyxwz_125",RJ="_payment__texts_hyxwz_134",DJ="_chargingInfo__activeSessionTexts_hyxwz_150",LJ="_activeSessionTexts__bateryInfo_hyxwz_166",Ar={horizontalSplit:dJ,sessionCard__chargingInfo:pJ,texts__row:mJ,activeSessionTexts__powerInfo:_J,powerInfo__row:gJ,times__duration:yJ,texts__paymentMethod:vJ,chargingInfo__icon:xJ,chargingInfo__texts:bJ,row__label:wJ,row__value:SJ,sessionCard__session:TJ,sessionCard__payment:EJ,session__icon:AJ,session__times:CJ,times__start:MJ,texts__amount:OJ,bateryInfo__row:IJ,payment__icon:PJ,payment__texts:RJ,chargingInfo__activeSessionTexts:DJ,activeSessionTexts__bateryInfo:LJ},$7="data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M22%209.5V14.5M10.75%209.5L8.25%2012H12L9.5%2014.5M2%208.25V15.75C2%2016.4404%202.55965%2017%203.25%2017H18.25C18.9404%2017%2019.5%2016.4404%2019.5%2015.75V8.25C19.5%207.55965%2018.9404%207%2018.25%207H3.25C2.55965%207%202%207.55965%202%208.25Z'%20stroke='%23373435'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",q7="data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M12%202.625C6.61425%202.625%202.25%206.99%202.25%2012.375C2.25%2017.76%206.61425%2022.125%2012%2022.125C17.3842%2022.125%2021.75%2017.76%2021.75%2012.375C21.75%206.99%2017.385%202.625%2012%202.625ZM11.9213%2020.2703C7.572%2020.2703%204.04625%2016.7445%204.04625%2012.3953C4.04625%208.046%207.572%204.52025%2011.9213%204.52025C16.2698%204.52025%2019.7962%208.046%2019.7962%2012.3953C19.7962%2016.7445%2016.2698%2020.2703%2011.9213%2020.2703ZM14.1975%2012.8483H11.9625V9.07425C11.9625%208.66475%2011.6302%208.33175%2011.2208%208.33175C10.8113%208.33175%2010.4782%208.664%2010.4782%209.07425V13.59C10.4782%2014.0003%2010.8105%2014.3317%2011.2208%2014.3317H14.1975C14.6077%2014.3317%2014.94%2014.0003%2014.94%2013.59C14.94%2013.1805%2014.6077%2012.8483%2014.1975%2012.8483Z'%20fill='%23373435'/%3e%3c/svg%3e",zJ="data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M19.2389%205.02051C20.7014%205.02051%2021.8973%206.16221%2021.9839%207.60299L21.9889%207.77051V16.2756C21.9889%2017.7381%2020.8472%2018.934%2019.4064%2019.0206L19.2389%2019.0256H4.76105C3.29852%2019.0256%202.10264%2017.8839%202.01607%2016.4431L2.01105%2016.2756V7.77051C2.01105%206.30798%203.15275%205.1121%204.59352%205.02553L4.76105%205.02051H19.2389ZM20.488%2010.9945H3.51005L3.51105%2016.2756C3.51105%2016.9228%204.00292%2017.4551%204.63324%2017.5191L4.76105%2017.5256H19.2389C19.8861%2017.5256%2020.4184%2017.0337%2020.4824%2016.4034L20.4889%2016.2756L20.488%2010.9945ZM18.2529%2014.4998C18.6671%2014.4998%2019.0029%2014.8356%2019.0029%2015.2498C19.0029%2015.6295%2018.7207%2015.9433%2018.3547%2015.993L18.2529%2015.9998H15.7529C15.3387%2015.9998%2015.0029%2015.664%2015.0029%2015.2498C15.0029%2014.8701%2015.2851%2014.5563%2015.6511%2014.5066L15.7529%2014.4998H18.2529ZM19.2389%206.52051H4.76105C4.11384%206.52051%203.58151%207.01238%203.5175%207.6427L3.51105%207.77051L3.51005%209.49451H20.488L20.4889%207.77051C20.4889%207.1233%2019.997%206.59097%2019.3667%206.52696L19.2389%206.52051Z'%20fill='%23373435'/%3e%3c/svg%3e";function kJ(e){var f,v,S;const t=e.sessionValues.end_date===void 0?kx(b5(new Date),e.sessionValues.start_date):kx(e.sessionValues.end_date,e.sessionValues.start_date),a=e.sessionValues.charged_kwh<0,s=a?e.sessionValues.charged_kwh*-1:e.sessionValues.charged_kwh;return he.jsxs(he.Fragment,{children:[he.jsx("div",{className:Ar.horizontalSplit}),he.jsxs("div",{className:Ar.sessionCard__chargingInfo,children:[he.jsx("img",{src:$7,alt:"batteryImage",className:Ar.chargingInfo__icon}),e.isActive?he.jsxs("div",{className:Ar.chargingInfo__activeSessionTexts,children:[he.jsxs("div",{className:Ar.activeSessionTexts__bateryInfo,children:[he.jsxs("div",{className:Ar.bateryInfo__row,children:[he.jsxs("p",{className:Ar.row__label,children:[a?"Разряжено":"Заряжено",":"]}),he.jsxs("p",{className:Ar.row__value,children:[s.toFixed(2)," кВт"]})]}),e.sessionValues.battery_percentage!==void 0&&he.jsxs("div",{className:Ar.bateryInfo__row,children:[he.jsx("p",{className:Ar.row__label,children:"Процент батареи:"}),he.jsxs("p",{className:Ar.row__value,children:[(f=e.sessionValues.battery_percentage)==null?void 0:f.toFixed(2)," %"]})]})]}),he.jsx("div",{className:Ar.activeSessionTexts__powerInfo,children:he.jsxs("div",{className:Ar.powerInfo__row,children:[he.jsx("p",{className:Ar.row__label,children:"Мощность:"}),he.jsxs("p",{className:Ar.row__value,children:[(v=e.sessionValues.current_power)==null?void 0:v.toFixed(2)," кВт"]})]})})]}):he.jsxs("div",{className:Ar.chargingInfo__texts,children:[he.jsxs("div",{className:Ar.texts__row,children:[he.jsxs("p",{className:Ar.row__label,children:[a?"Разряжено":"Заряжено",":"]}),he.jsxs("p",{className:Ar.row__value,children:[s.toFixed(2)," кВт·ч"]})]}),e.sessionValues.max_power!==void 0&&he.jsxs("div",{className:Ar.texts__row,children:[he.jsx("p",{className:Ar.row__label,children:"Максимальная мощность:"}),he.jsxs("p",{className:Ar.row__value,children:[e.sessionValues.max_power.toFixed(2)," кВт"]})]}),e.sessionValues.min_power!==void 0&&he.jsxs("div",{className:Ar.texts__row,children:[he.jsx("p",{className:Ar.row__label,children:"Минимальная мощность:"}),he.jsxs("p",{className:Ar.row__value,children:[e.sessionValues.min_power.toFixed(2)," кВт"]})]})]})]}),he.jsx("div",{className:Ar.horizontalSplit}),he.jsxs("div",{className:Ar.sessionCard__session,children:[he.jsx("img",{src:q7,alt:"clockImage",className:Ar.session__icon}),he.jsxs("div",{className:Ar.session__times,children:[he.jsxs("div",{className:Ar.times__start,children:[he.jsx("p",{className:Ar.row__label,children:"Старт:"}),he.jsx("p",{className:Ar.row__value,children:H8(e.sessionValues.start_date.hours,e.sessionValues.start_date.minutes,e.sessionValues.start_date.seconds)})]}),he.jsxs("div",{className:Ar.times__duration,children:[he.jsx("p",{className:Ar.row__label,children:"Длительность:"}),he.jsx("p",{className:Ar.row__value,children:Z8(t.hours,t.minutes,t.seconds)})]})]})]}),!e.sessionValues.total_cost!==void 0&&he.jsxs(he.Fragment,{children:[he.jsx("div",{className:Ar.horizontalSplit}),he.jsxs("div",{className:Ar.sessionCard__payment,children:[he.jsx("img",{src:zJ,alt:"paymentImage",className:Ar.payment__icon}),he.jsxs("div",{className:Ar.payment__texts,children:[he.jsxs("div",{className:Ar.texts__amount,children:[he.jsx("p",{className:Ar.row__label,children:"Сумма:"}),he.jsxs("p",{className:Ar.row__value,children:[(S=e.sessionValues.total_cost)==null?void 0:S.toFixed(2)," руб"]})]}),e.sessionValues.payment_method&&he.jsxs("div",{className:Ar.texts__paymentMethod,children:[he.jsx("p",{className:Ar.row__label,children:"Способ оплаты:"}),he.jsx("p",{className:Ar.row__value,children:e.sessionValues.payment_method})]})]})]})]})]})}const G7="data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M22%2013.9979C21.9711%2017.4119%2021.7815%2019.294%2020.5404%2020.5352C19.0755%2022%2016.7179%2022%2012.0026%2022C7.28733%2022%204.9297%2022%203.46485%2020.5352C2%2019.0703%202%2016.7127%202%2011.9974C2%207.28212%202%204.92448%203.46485%203.45963C4.70599%202.21848%206.58807%202.02895%2010.0021%202'%20stroke='%23373435'%20stroke-width='1.5'%20stroke-linecap='round'/%3e%3cpath%20d='M16%208L22%202M22%202H17.5M22%202V6.5'%20stroke='%23373435'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e";function BJ(e){const{lastStoppedChargingSessionId:t}=Me.useContext(Va),a=e.session.id===t,s=e.session.status==="Зарядка",f=e.session.payment_status==="Неоплачено",v=yo(),S=()=>{v(Lb+e.session.id+hl([{key:Bv.PREVIOUS_PAGE,value:Nv.SESSIONS_LIST}]))},i=()=>{v(A1+e.session.connector_info.station_id+hl([{key:Td.PREVIOUS_PAGE,value:xd.SESSIONS_LIST}]))};return he.jsxs("div",{className:Uu.sessionCard,children:[he.jsx("div",{className:Uu.sessionCard__header,children:he.jsxs("div",{className:Uu.header__content,children:[he.jsx("div",{className:Uu.content__connector,children:he.jsx(rJ,{connector:e.session.connector_info})}),he.jsxs("div",{className:Uu.content__station,children:[he.jsxs("div",{className:Uu.station__mainInfo,children:[he.jsxs("div",{className:Uu.mainInfo__texts,children:[he.jsx("p",{className:Uu.texts__name,children:e.session.connector_info.station_name}),he.jsx("p",{className:Uu.texts__address,children:e.session.connector_info.station_address})]}),he.jsx(Yb,{textSize:"medium",text:e.session.status,color:zK[e.session.status]})]}),he.jsx("div",{className:Uu.station__button,children:he.jsx(zb,{onClick:s&&!a?S:i,variant:"fill",iconSrc:s&&!a?V7:G7})})]})]})}),he.jsx(kJ,{isActive:s,sessionValues:e.session}),f&&he.jsx("div",{className:Uu.sessionCard__gradientButton,children:he.jsx(fJ,{text:"Сессия не оплачена",onClick:e.onDebtClick,gradientTemplate:"orange"})})]})}const NJ=e=>{const a=[...e].sort((s,f)=>{const v=Cv(s.start_date);return Cv(f.start_date).getTime()-v.getTime()}).reduce((s,f)=>{const v=Cv(f.start_date),S=new Intl.DateTimeFormat("ru-RU",{day:"numeric",month:"long",year:"numeric"}).format(v);return s[S]||(s[S]=[]),s[S].push(f),s},{});return Object.keys(a).forEach(s=>{a[s].sort((f,v)=>f.status==="Зарядка"?-1:1)}),a},r6=e=>({priceGreaterThan:e.onlyPaidSessions?0:void 0,totalHoursGreaterThan:e.durationInHours!==0?e.durationInHours:void 0,standards:e.connectors}),FJ=()=>{const{getChargingSessionsFromApi:e}=nu(),{sessionFilters:t,setSessions:a}=Me.useContext(Va),[s,f]=Me.useState(!0);return Me.useEffect(()=>{if(!t.shouldUpdateSessions){f(!1);return}e({...r6(t),limit:B8}).then(S=>{a(S)}).finally(()=>f(!1))},[]),{getByOffsetAndLimit:(S,i)=>e({...r6(t),offset:S,limit:i}),loading:s}},jJ="data:image/svg+xml,%3csvg%20width='64'%20height='64'%20viewBox='0%200%2064%2064'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M4.66736%2026.6677V37.3343C4.66736%2044.8768%204.66736%2048.6481%207.0105%2050.9912C7.59007%2051.5708%208.25701%2052.007%209.04677%2052.3353C9.02886%2052.2167%209.01193%2052.0978%208.99592%2051.9787C8.66698%2049.5321%208.66715%2046.4768%208.66735%2042.9309L8.66736%2021.3342L8.66735%2021.0709V21.0709C8.66715%2017.5249%208.66698%2014.4697%208.99592%2012.023C9.01192%2011.904%209.02883%2011.7853%209.04673%2011.6667C8.25698%2011.9951%207.59006%2012.4313%207.0105%2013.0108C4.66736%2015.354%204.66736%2019.1252%204.66736%2026.6677Z'%20fill='%238E949F'/%3e%3cpath%20d='M58.0007%2026.6677V37.3343C58.0007%2044.8768%2058.0007%2048.6481%2055.6575%2050.9912C55.078%2051.5708%2054.411%2052.007%2053.6213%2052.3353C53.6392%2052.2167%2053.6561%2052.0978%2053.6721%2051.9787C54.0011%2049.5321%2054.0009%2046.4768%2054.0007%2042.9308V21.0709C54.0009%2017.525%2054.0011%2014.4697%2053.6721%2012.023C53.6561%2011.904%2053.6392%2011.7853%2053.6213%2011.6667C54.4111%2011.9951%2055.078%2012.4313%2055.6575%2013.0108C58.0007%2015.354%2058.0007%2019.1252%2058.0007%2026.6677Z'%20fill='%238E949F'/%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M15.0105%207.67664C12.6674%2010.0198%2012.6674%2013.791%2012.6674%2021.3335V42.6668C12.6674%2050.2093%2012.6674%2053.9805%2015.0105%2056.3237C17.3536%2058.6668%2021.1249%2058.6668%2028.6674%2058.6668H34.0007C41.5432%2058.6668%2045.3144%2058.6668%2047.6575%2056.3237C50.0007%2053.9805%2050.0007%2050.2093%2050.0007%2042.6668V21.3335C50.0007%2013.791%2050.0007%2010.0198%2047.6575%207.67664C45.3144%205.3335%2041.5432%205.3335%2034.0007%205.3335H28.6674C21.1249%205.3335%2017.3536%205.3335%2015.0105%207.67664ZM21.334%2045.3335C21.334%2044.2289%2022.2295%2043.3335%2023.334%2043.3335H31.334C32.4386%2043.3335%2033.334%2044.2289%2033.334%2045.3335C33.334%2046.4381%2032.4386%2047.3335%2031.334%2047.3335H23.334C22.2295%2047.3335%2021.334%2046.4381%2021.334%2045.3335ZM23.334%2032.6668C22.2295%2032.6668%2021.334%2033.5623%2021.334%2034.6668C21.334%2035.7714%2022.2295%2036.6668%2023.334%2036.6668H39.334C40.4386%2036.6668%2041.334%2035.7714%2041.334%2034.6668C41.334%2033.5623%2040.4386%2032.6668%2039.334%2032.6668H23.334ZM21.334%2024.0002C21.334%2022.8956%2022.2295%2022.0002%2023.334%2022.0002H39.334C40.4386%2022.0002%2041.334%2022.8956%2041.334%2024.0002C41.334%2025.1047%2040.4386%2026.0002%2039.334%2026.0002H23.334C22.2295%2026.0002%2021.334%2025.1047%2021.334%2024.0002Z'%20fill='%238E949F'/%3e%3c/svg%3e",UJ="Left",VJ="Right",$J="Up",qJ="Down",J_={delta:10,preventScrollOnSwipe:!1,rotationAngle:0,trackMouse:!1,trackTouch:!0,swipeDuration:1/0,touchEventOptions:{passive:!0}},HC={first:!0,initial:[0,0],start:0,swiping:!1,xy:[0,0]},i6="mousemove",a6="mouseup",GJ="touchend",HJ="touchmove",ZJ="touchstart";function WJ(e,t,a,s){return e>t?a>0?VJ:UJ:s>0?qJ:$J}function o6(e,t){if(t===0)return e;const a=Math.PI/180*t,s=e[0]*Math.cos(a)+e[1]*Math.sin(a),f=e[1]*Math.cos(a)-e[0]*Math.sin(a);return[s,f]}function XJ(e,t){const a=j=>{const F="touches"in j;F&&j.touches.length>1||e((G,Y)=>{Y.trackMouse&&!F&&(document.addEventListener(i6,s),document.addEventListener(a6,S));const{clientX:X,clientY:K}=F?j.touches[0]:j,ne=o6([X,K],Y.rotationAngle);return Y.onTouchStartOrOnMouseDown&&Y.onTouchStartOrOnMouseDown({event:j}),Object.assign(Object.assign(Object.assign({},G),HC),{initial:ne.slice(),xy:ne,start:j.timeStamp||0})})},s=j=>{e((F,G)=>{const Y="touches"in j;if(Y&&j.touches.length>1)return F;if(j.timeStamp-F.start>G.swipeDuration)return F.swiping?Object.assign(Object.assign({},F),{swiping:!1}):F;const{clientX:X,clientY:K}=Y?j.touches[0]:j,[ne,se]=o6([X,K],G.rotationAngle),ge=ne-F.xy[0],_e=se-F.xy[1],xe=Math.abs(ge),ae=Math.abs(_e),ve=(j.timeStamp||0)-F.start,Se=Math.sqrt(xe*xe+ae*ae)/(ve||1),He=[ge/(ve||1),_e/(ve||1)],Ge=WJ(xe,ae,ge,_e),ye=typeof G.delta=="number"?G.delta:G.delta[Ge.toLowerCase()]||J_.delta;if(xe<ye&&ae<ye&&!F.swiping)return F;const Le={absX:xe,absY:ae,deltaX:ge,deltaY:_e,dir:Ge,event:j,first:F.first,initial:F.initial,velocity:Se,vxvy:He};Le.first&&G.onSwipeStart&&G.onSwipeStart(Le),G.onSwiping&&G.onSwiping(Le);let ht=!1;return(G.onSwiping||G.onSwiped||G[`onSwiped${Ge}`])&&(ht=!0),ht&&G.preventScrollOnSwipe&&G.trackTouch&&j.cancelable&&j.preventDefault(),Object.assign(Object.assign({},F),{first:!1,eventData:Le,swiping:!0})})},f=j=>{e((F,G)=>{let Y;if(F.swiping&&F.eventData){if(j.timeStamp-F.start<G.swipeDuration){Y=Object.assign(Object.assign({},F.eventData),{event:j}),G.onSwiped&&G.onSwiped(Y);const X=G[`onSwiped${Y.dir}`];X&&X(Y)}}else G.onTap&&G.onTap({event:j});return G.onTouchEndOrOnMouseUp&&G.onTouchEndOrOnMouseUp({event:j}),Object.assign(Object.assign(Object.assign({},F),HC),{eventData:Y})})},v=()=>{document.removeEventListener(i6,s),document.removeEventListener(a6,S)},S=j=>{v(),f(j)},i=(j,F)=>{let G=()=>{};if(j&&j.addEventListener){const Y=Object.assign(Object.assign({},J_.touchEventOptions),F.touchEventOptions),X=[[ZJ,a,Y],[HJ,s,Object.assign(Object.assign({},Y),F.preventScrollOnSwipe?{passive:!1}:{})],[GJ,f,Y]];X.forEach(([K,ne,se])=>j.addEventListener(K,ne,se)),G=()=>X.forEach(([K,ne])=>j.removeEventListener(K,ne))}return G},z={ref:j=>{j!==null&&e((F,G)=>{if(F.el===j)return F;const Y={};return F.el&&F.el!==j&&F.cleanUpTouch&&(F.cleanUpTouch(),Y.cleanUpTouch=void 0),G.trackTouch&&j&&(Y.cleanUpTouch=i(j,G)),Object.assign(Object.assign(Object.assign({},F),{el:j}),Y)})}};return t.trackMouse&&(z.onMouseDown=a),[z,i]}function YJ(e,t,a,s){return!t.trackTouch||!e.el?(e.cleanUpTouch&&e.cleanUpTouch(),Object.assign(Object.assign({},e),{cleanUpTouch:void 0})):e.cleanUpTouch?t.preventScrollOnSwipe!==a.preventScrollOnSwipe||t.touchEventOptions.passive!==a.touchEventOptions.passive?(e.cleanUpTouch(),Object.assign(Object.assign({},e),{cleanUpTouch:s(e.el,t)})):e:Object.assign(Object.assign({},e),{cleanUpTouch:s(e.el,t)})}function KJ(e){const{trackMouse:t}=e,a=Me.useRef(Object.assign({},HC)),s=Me.useRef(Object.assign({},J_)),f=Me.useRef(Object.assign({},s.current));f.current=Object.assign({},s.current),s.current=Object.assign(Object.assign({},J_),e);let v;for(v in J_)s.current[v]===void 0&&(s.current[v]=J_[v]);const[S,i]=Me.useMemo(()=>XJ(O=>a.current=O(a.current,s.current),{trackMouse:t}),[t]);return a.current=YJ(a.current,s.current,f.current,i),S}const JJ="_popup_wc8z0_1",QJ="_active_wc8z0_24",eQ="_popup__content_wc8z0_31",tQ="_contentWrapper_wc8z0_43",nQ="_contentContainer_wc8z0_59",rQ="_content__topLine_wc8z0_72",$_={popup:JJ,active:QJ,popup__content:eQ,contentWrapper:tQ,contentContainer:nQ,content__topLine:rQ},iQ=e=>{const t=KJ({onSwipedDown:()=>e.onClose(),trackMouse:!0});return he.jsx("div",{className:`${$_.popup} ${e.isActive?$_.active:""}`,children:he.jsx("div",{className:$_.popup__content,...t,onClick:a=>a.stopPropagation(),children:he.jsxs("div",{className:$_.contentWrapper,children:[he.jsx("div",{className:$_.content__topLine}),he.jsx("div",{className:$_.contentContainer,children:e.children})]})})})},aQ="_popupWrapper__overlay_1fo8b_1",oQ="_active_1fo8b_17",sQ="_overlay__contentWrapper_1fo8b_23",w3={popupWrapper__overlay:aQ,active:oQ,overlay__contentWrapper:sQ},$v=e=>{const[t,a]=Me.useState(!1);Me.useEffect(()=>{e.isOpen?(a(!0),document.body.style.overflow="hidden"):(a(!1),document.body.style.overflow="unset")},[e.isOpen]);const s=()=>{a(!1),setTimeout(()=>{e.onClose()},500)};return he.jsx("div",{className:`${w3.popupWrapper__overlay} ${t?w3.active:""}`,onClick:s,children:he.jsx("div",{className:w3.overlay__contentWrapper,children:he.jsx(iQ,{onClose:s,isActive:t,children:t&&e.children})})})},lQ="_content_1rxb5_1",cQ="_title_1rxb5_18",uQ="_description_1rxb5_28",hQ="_buttons_1rxb5_38",fQ="_icon_1rxb5_50",a0={content:lQ,title:cQ,description:uQ,buttons:hQ,icon:fQ},H7="data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M5.31171%2010.7615C8.23007%205.58716%209.68925%203%2012%203C14.3107%203%2015.7699%205.58716%2018.6883%2010.7615L19.0519%2011.4063C21.4771%2015.7061%2022.6897%2017.856%2021.5937%2019.428C20.4978%2021%2017.7864%2021%2012.3637%2021H11.6363C6.21356%2021%203.50217%2021%202.40626%2019.428C1.31034%2017.856%202.52291%2015.7061%204.94805%2011.4063L5.31171%2010.7615Z'%20fill='%23F63255'/%3e%3cpath%20d='M12%208V13'%20stroke='white'%20stroke-width='1.5'%20stroke-linecap='round'/%3e%3ccircle%20cx='12'%20cy='16'%20r='1'%20fill='white'/%3e%3c/svg%3e";function Kb(e){const[t,a]=Me.useState(!1),[s,f]=Me.useState(),v=()=>{e.onClose(),f(void 0)},S=()=>{a(!0),e.onConfirm().then(i=>{i?f(i):(v(),setTimeout(()=>{var O;return(O=e.onSuccess)==null?void 0:O.call(e)},200))}).finally(()=>{a(!1)})};return t?he.jsxs("div",{className:a0.content,children:[he.jsx("p",{className:a0.title,children:"Отправляем запрос..."}),he.jsx(Hp,{})]}):he.jsxs("div",{className:a0.content,children:[he.jsx("p",{className:a0.title,children:s?e.errorTitle||"Произошла непредвиденная ошибка":e.title}),(e.description!==void 0||s)&&he.jsx("p",{className:a0.description,children:s?s.message:e.description}),s?he.jsxs(he.Fragment,{children:[he.jsx("img",{src:H7,alt:"Error",className:a0.icon}),he.jsx(Jl,{variant:"fill",onClick:()=>window.location.replace("https://t.me/egine_cpo"),text:"Техподдержка"})]}):he.jsxs("div",{className:a0.buttons,children:[he.jsx(Jl,{variant:"text",onClick:v,text:"Отменить"}),he.jsx(Jl,{variant:"fill",onClick:S,text:"Подтвердить"})]})]})}function dQ(){const e=yo(),{retryPaymentForChargingSessionFromApi:t}=nu(),{sessions:a,setSessions:s,showSnackbar:f}=Me.useContext(Va),{getByOffsetAndLimit:v,loading:S}=FJ(),[i,O]=Me.useState({isOpen:!1}),z=()=>{e(R8)},j=(G,Y,X)=>{const K=NJ(G);return Object.keys(K).flatMap(_e=>{const[xe,ae,ve]=_e.split(" ");return[he.jsx("div",{className:b3.sessionsMap__date,children:he.jsxs("p",{className:b3.date__text,children:[`${xe} ${ae}`," "]})},`date-${_e}`),...K[_e].map((Se,He)=>he.jsx(Ro,{className:b3.main__sessionCard,children:he.jsx(BJ,{session:Se,onDebtClick:()=>{Se.payment_status==="Неоплачено"&&O({isOpen:!0,sessionId:Se.id})}})},He))]})},F=()=>{O({isOpen:!1,sessionId:void 0})};return he.jsxs(Pd,{onReturn:()=>e("/"),title:"Зарядные сессии",headerContent:he.jsx(zb,{iconSrc:g5,onClick:z,variant:"fill"}),children:[he.jsx($v,{isOpen:i.isOpen&&i.sessionId!==void 0,onClose:F,children:he.jsx(Kb,{title:he.jsxs(he.Fragment,{children:["Хотите оплатить ",he.jsx("br",{})," задолженность?"]}),errorTitle:he.jsxs(he.Fragment,{children:["Не удалось произвести ",he.jsx("br",{})," оплату"]}),onConfirm:()=>t({sessionId:i.sessionId}),onSuccess:()=>f("success","Оплата успешно прошла"),onClose:F})}),he.jsx(M7,{items:j(a),loading:S,getData:async(G,Y)=>await v(G,Y),onDataLoad:G=>{s(G)},fullHeight:!0,emptyListNotify:he.jsx(L7,{text:"Здесь будут показаны ваши зарядные сессии",iconSrc:jJ})})]})}const pQ="_buttonBlock_bg1po_1",mQ="_info_bg1po_20",s6={buttonBlock:pQ,info:mQ},_Q="_contentBlock_1ql4k_1",gQ="_contentBlock__title_1ql4k_13",yQ="_contentBlock__content_1ql4k_22",vQ="_content__items_1ql4k_36",xQ="_content__icon_1ql4k_53",bQ="_items__item_1ql4k_58",wQ="_item__text_1ql4k_66",SQ="_item__text_color_1ql4k_67",Bp={contentBlock:_Q,contentBlock__title:gQ,contentBlock__content:yQ,content__items:vQ,content__icon:xQ,items__item:bQ,item__text:wQ,item__text_color:SQ};function ox(e){return he.jsxs("div",{className:Bp.contentBlock,children:[he.jsx("p",{className:Bp.contentBlock__title,children:e.title}),he.jsxs(Ro,{className:Bp.contentBlock__content,children:[he.jsx("img",{className:Bp.content__icon,src:e.iconSrc}),he.jsx("div",{className:Bp.content__items,children:e.items.map((t,a)=>(t.checkVisible===void 0||t.checkVisible(t.value))&&he.jsxs("div",{className:Bp.items__item,children:[he.jsx("p",{className:Bp.item__text,children:t.description}),he.jsx("p",{className:Bp.item__text_color,children:t.value})]},a))})]})]})}const TQ="data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M18.8092%2010.6244L18.8086%2010.6247L18.8092%2010.6244ZM18.8092%2010.6244L18.8136%2010.6225L18.8179%2010.616L18.8136%2010.6225L18.8179%2010.6207L18.8136%2010.6226L18.8114%2010.6258L18.8136%2010.6226L18.8092%2010.6244ZM5.32985%2013.3124L15.9429%201.94224L13.5694%209.71865L13.2737%2010.6876H14.2867H18.6701L8.05767%2022.0571L10.4306%2014.2813L10.7263%2013.3124H9.71326H5.32985Z'%20stroke='%23373435'%20stroke-width='1.5'/%3e%3c/svg%3e",av=e=>e!=="";var S3,l6;function pl(){if(l6)return S3;l6=1;var e=Array.isArray;return S3=e,S3}var T3,c6;function Z7(){if(c6)return T3;c6=1;var e=typeof $2=="object"&&$2&&$2.Object===Object&&$2;return T3=e,T3}var E3,u6;function of(){if(u6)return E3;u6=1;var e=Z7(),t=typeof self=="object"&&self&&self.Object===Object&&self,a=e||t||Function("return this")();return E3=a,E3}var A3,h6;function P1(){if(h6)return A3;h6=1;var e=of(),t=e.Symbol;return A3=t,A3}var C3,f6;function EQ(){if(f6)return C3;f6=1;var e=P1(),t=Object.prototype,a=t.hasOwnProperty,s=t.toString,f=e?e.toStringTag:void 0;function v(S){var i=a.call(S,f),O=S[f];try{S[f]=void 0;var z=!0}catch{}var j=s.call(S);return z&&(i?S[f]=O:delete S[f]),j}return C3=v,C3}var M3,d6;function AQ(){if(d6)return M3;d6=1;var e=Object.prototype,t=e.toString;function a(s){return t.call(s)}return M3=a,M3}var O3,p6;function Rd(){if(p6)return O3;p6=1;var e=P1(),t=EQ(),a=AQ(),s="[object Null]",f="[object Undefined]",v=e?e.toStringTag:void 0;function S(i){return i==null?i===void 0?f:s:v&&v in Object(i)?t(i):a(i)}return O3=S,O3}var I3,m6;function Dd(){if(m6)return I3;m6=1;function e(t){return t!=null&&typeof t=="object"}return I3=e,I3}var P3,_6;function Fg(){if(_6)return P3;_6=1;var e=Rd(),t=Dd(),a="[object Symbol]";function s(f){return typeof f=="symbol"||t(f)&&e(f)==a}return P3=s,P3}var R3,g6;function F5(){if(g6)return R3;g6=1;var e=pl(),t=Fg(),a=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,s=/^\w*$/;function f(v,S){if(e(v))return!1;var i=typeof v;return i=="number"||i=="symbol"||i=="boolean"||v==null||t(v)?!0:s.test(v)||!a.test(v)||S!=null&&v in Object(S)}return R3=f,R3}var D3,y6;function Wp(){if(y6)return D3;y6=1;function e(t){var a=typeof t;return t!=null&&(a=="object"||a=="function")}return D3=e,D3}var L3,v6;function j5(){if(v6)return L3;v6=1;var e=Rd(),t=Wp(),a="[object AsyncFunction]",s="[object Function]",f="[object GeneratorFunction]",v="[object Proxy]";function S(i){if(!t(i))return!1;var O=e(i);return O==s||O==f||O==a||O==v}return L3=S,L3}var z3,x6;function CQ(){if(x6)return z3;x6=1;var e=of(),t=e["__core-js_shared__"];return z3=t,z3}var k3,b6;function MQ(){if(b6)return k3;b6=1;var e=CQ(),t=function(){var s=/[^.]+$/.exec(e&&e.keys&&e.keys.IE_PROTO||"");return s?"Symbol(src)_1."+s:""}();function a(s){return!!t&&t in s}return k3=a,k3}var B3,w6;function W7(){if(w6)return B3;w6=1;var e=Function.prototype,t=e.toString;function a(s){if(s!=null){try{return t.call(s)}catch{}try{return s+""}catch{}}return""}return B3=a,B3}var N3,S6;function OQ(){if(S6)return N3;S6=1;var e=j5(),t=MQ(),a=Wp(),s=W7(),f=/[\\^$.*+?()[\]{}|]/g,v=/^\[object .+?Constructor\]$/,S=Function.prototype,i=Object.prototype,O=S.toString,z=i.hasOwnProperty,j=RegExp("^"+O.call(z).replace(f,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function F(G){if(!a(G)||t(G))return!1;var Y=e(G)?j:v;return Y.test(s(G))}return N3=F,N3}var F3,T6;function IQ(){if(T6)return F3;T6=1;function e(t,a){return t==null?void 0:t[a]}return F3=e,F3}var j3,E6;function S0(){if(E6)return j3;E6=1;var e=OQ(),t=IQ();function a(s,f){var v=t(s,f);return e(v)?v:void 0}return j3=a,j3}var U3,A6;function Jb(){if(A6)return U3;A6=1;var e=S0(),t=e(Object,"create");return U3=t,U3}var V3,C6;function PQ(){if(C6)return V3;C6=1;var e=Jb();function t(){this.__data__=e?e(null):{},this.size=0}return V3=t,V3}var $3,M6;function RQ(){if(M6)return $3;M6=1;function e(t){var a=this.has(t)&&delete this.__data__[t];return this.size-=a?1:0,a}return $3=e,$3}var q3,O6;function DQ(){if(O6)return q3;O6=1;var e=Jb(),t="__lodash_hash_undefined__",a=Object.prototype,s=a.hasOwnProperty;function f(v){var S=this.__data__;if(e){var i=S[v];return i===t?void 0:i}return s.call(S,v)?S[v]:void 0}return q3=f,q3}var G3,I6;function LQ(){if(I6)return G3;I6=1;var e=Jb(),t=Object.prototype,a=t.hasOwnProperty;function s(f){var v=this.__data__;return e?v[f]!==void 0:a.call(v,f)}return G3=s,G3}var H3,P6;function zQ(){if(P6)return H3;P6=1;var e=Jb(),t="__lodash_hash_undefined__";function a(s,f){var v=this.__data__;return this.size+=this.has(s)?0:1,v[s]=e&&f===void 0?t:f,this}return H3=a,H3}var Z3,R6;function kQ(){if(R6)return Z3;R6=1;var e=PQ(),t=RQ(),a=DQ(),s=LQ(),f=zQ();function v(S){var i=-1,O=S==null?0:S.length;for(this.clear();++i<O;){var z=S[i];this.set(z[0],z[1])}}return v.prototype.clear=e,v.prototype.delete=t,v.prototype.get=a,v.prototype.has=s,v.prototype.set=f,Z3=v,Z3}var W3,D6;function BQ(){if(D6)return W3;D6=1;function e(){this.__data__=[],this.size=0}return W3=e,W3}var X3,L6;function U5(){if(L6)return X3;L6=1;function e(t,a){return t===a||t!==t&&a!==a}return X3=e,X3}var Y3,z6;function Qb(){if(z6)return Y3;z6=1;var e=U5();function t(a,s){for(var f=a.length;f--;)if(e(a[f][0],s))return f;return-1}return Y3=t,Y3}var K3,k6;function NQ(){if(k6)return K3;k6=1;var e=Qb(),t=Array.prototype,a=t.splice;function s(f){var v=this.__data__,S=e(v,f);if(S<0)return!1;var i=v.length-1;return S==i?v.pop():a.call(v,S,1),--this.size,!0}return K3=s,K3}var J3,B6;function FQ(){if(B6)return J3;B6=1;var e=Qb();function t(a){var s=this.__data__,f=e(s,a);return f<0?void 0:s[f][1]}return J3=t,J3}var Q3,N6;function jQ(){if(N6)return Q3;N6=1;var e=Qb();function t(a){return e(this.__data__,a)>-1}return Q3=t,Q3}var eT,F6;function UQ(){if(F6)return eT;F6=1;var e=Qb();function t(a,s){var f=this.__data__,v=e(f,a);return v<0?(++this.size,f.push([a,s])):f[v][1]=s,this}return eT=t,eT}var tT,j6;function ew(){if(j6)return tT;j6=1;var e=BQ(),t=NQ(),a=FQ(),s=jQ(),f=UQ();function v(S){var i=-1,O=S==null?0:S.length;for(this.clear();++i<O;){var z=S[i];this.set(z[0],z[1])}}return v.prototype.clear=e,v.prototype.delete=t,v.prototype.get=a,v.prototype.has=s,v.prototype.set=f,tT=v,tT}var nT,U6;function V5(){if(U6)return nT;U6=1;var e=S0(),t=of(),a=e(t,"Map");return nT=a,nT}var rT,V6;function VQ(){if(V6)return rT;V6=1;var e=kQ(),t=ew(),a=V5();function s(){this.size=0,this.__data__={hash:new e,map:new(a||t),string:new e}}return rT=s,rT}var iT,$6;function $Q(){if($6)return iT;$6=1;function e(t){var a=typeof t;return a=="string"||a=="number"||a=="symbol"||a=="boolean"?t!=="__proto__":t===null}return iT=e,iT}var aT,q6;function tw(){if(q6)return aT;q6=1;var e=$Q();function t(a,s){var f=a.__data__;return e(s)?f[typeof s=="string"?"string":"hash"]:f.map}return aT=t,aT}var oT,G6;function qQ(){if(G6)return oT;G6=1;var e=tw();function t(a){var s=e(this,a).delete(a);return this.size-=s?1:0,s}return oT=t,oT}var sT,H6;function GQ(){if(H6)return sT;H6=1;var e=tw();function t(a){return e(this,a).get(a)}return sT=t,sT}var lT,Z6;function HQ(){if(Z6)return lT;Z6=1;var e=tw();function t(a){return e(this,a).has(a)}return lT=t,lT}var cT,W6;function ZQ(){if(W6)return cT;W6=1;var e=tw();function t(a,s){var f=e(this,a),v=f.size;return f.set(a,s),this.size+=f.size==v?0:1,this}return cT=t,cT}var uT,X6;function $5(){if(X6)return uT;X6=1;var e=VQ(),t=qQ(),a=GQ(),s=HQ(),f=ZQ();function v(S){var i=-1,O=S==null?0:S.length;for(this.clear();++i<O;){var z=S[i];this.set(z[0],z[1])}}return v.prototype.clear=e,v.prototype.delete=t,v.prototype.get=a,v.prototype.has=s,v.prototype.set=f,uT=v,uT}var hT,Y6;function X7(){if(Y6)return hT;Y6=1;var e=$5(),t="Expected a function";function a(s,f){if(typeof s!="function"||f!=null&&typeof f!="function")throw new TypeError(t);var v=function(){var S=arguments,i=f?f.apply(this,S):S[0],O=v.cache;if(O.has(i))return O.get(i);var z=s.apply(this,S);return v.cache=O.set(i,z)||O,z};return v.cache=new(a.Cache||e),v}return a.Cache=e,hT=a,hT}var fT,K6;function WQ(){if(K6)return fT;K6=1;var e=X7(),t=500;function a(s){var f=e(s,function(S){return v.size===t&&v.clear(),S}),v=f.cache;return f}return fT=a,fT}var dT,J6;function XQ(){if(J6)return dT;J6=1;var e=WQ(),t=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,a=/\\(\\)?/g,s=e(function(f){var v=[];return f.charCodeAt(0)===46&&v.push(""),f.replace(t,function(S,i,O,z){v.push(O?z.replace(a,"$1"):i||S)}),v});return dT=s,dT}var pT,Q6;function q5(){if(Q6)return pT;Q6=1;function e(t,a){for(var s=-1,f=t==null?0:t.length,v=Array(f);++s<f;)v[s]=a(t[s],s,t);return v}return pT=e,pT}var mT,eR;function YQ(){if(eR)return mT;eR=1;var e=P1(),t=q5(),a=pl(),s=Fg(),f=e?e.prototype:void 0,v=f?f.toString:void 0;function S(i){if(typeof i=="string")return i;if(a(i))return t(i,S)+"";if(s(i))return v?v.call(i):"";var O=i+"";return O=="0"&&1/i==-1/0?"-0":O}return mT=S,mT}var _T,tR;function Y7(){if(tR)return _T;tR=1;var e=YQ();function t(a){return a==null?"":e(a)}return _T=t,_T}var gT,nR;function K7(){if(nR)return gT;nR=1;var e=pl(),t=F5(),a=XQ(),s=Y7();function f(v,S){return e(v)?v:t(v,S)?[v]:a(s(v))}return gT=f,gT}var yT,rR;function nw(){if(rR)return yT;rR=1;var e=Fg();function t(a){if(typeof a=="string"||e(a))return a;var s=a+"";return s=="0"&&1/a==-1/0?"-0":s}return yT=t,yT}var vT,iR;function G5(){if(iR)return vT;iR=1;var e=K7(),t=nw();function a(s,f){f=e(f,s);for(var v=0,S=f.length;s!=null&&v<S;)s=s[t(f[v++])];return v&&v==S?s:void 0}return vT=a,vT}var xT,aR;function J7(){if(aR)return xT;aR=1;var e=G5();function t(a,s,f){var v=a==null?void 0:e(a,s);return v===void 0?f:v}return xT=t,xT}var KQ=J7();const Hu=Ei(KQ);var bT,oR;function JQ(){if(oR)return bT;oR=1;function e(t){return t==null}return bT=e,bT}var QQ=JQ();const ei=Ei(QQ);var wT,sR;function eee(){if(sR)return wT;sR=1;var e=Rd(),t=pl(),a=Dd(),s="[object String]";function f(v){return typeof v=="string"||!t(v)&&a(v)&&e(v)==s}return wT=f,wT}var tee=eee();const R1=Ei(tee);var nee=j5();const Vr=Ei(nee);var ree=Wp();const jg=Ei(ree);var ST={exports:{}},Ti={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lR;function iee(){if(lR)return Ti;lR=1;var e=Symbol.for("react.element"),t=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),f=Symbol.for("react.profiler"),v=Symbol.for("react.provider"),S=Symbol.for("react.context"),i=Symbol.for("react.server_context"),O=Symbol.for("react.forward_ref"),z=Symbol.for("react.suspense"),j=Symbol.for("react.suspense_list"),F=Symbol.for("react.memo"),G=Symbol.for("react.lazy"),Y=Symbol.for("react.offscreen"),X;X=Symbol.for("react.module.reference");function K(ne){if(typeof ne=="object"&&ne!==null){var se=ne.$$typeof;switch(se){case e:switch(ne=ne.type,ne){case a:case f:case s:case z:case j:return ne;default:switch(ne=ne&&ne.$$typeof,ne){case i:case S:case O:case G:case F:case v:return ne;default:return se}}case t:return se}}}return Ti.ContextConsumer=S,Ti.ContextProvider=v,Ti.Element=e,Ti.ForwardRef=O,Ti.Fragment=a,Ti.Lazy=G,Ti.Memo=F,Ti.Portal=t,Ti.Profiler=f,Ti.StrictMode=s,Ti.Suspense=z,Ti.SuspenseList=j,Ti.isAsyncMode=function(){return!1},Ti.isConcurrentMode=function(){return!1},Ti.isContextConsumer=function(ne){return K(ne)===S},Ti.isContextProvider=function(ne){return K(ne)===v},Ti.isElement=function(ne){return typeof ne=="object"&&ne!==null&&ne.$$typeof===e},Ti.isForwardRef=function(ne){return K(ne)===O},Ti.isFragment=function(ne){return K(ne)===a},Ti.isLazy=function(ne){return K(ne)===G},Ti.isMemo=function(ne){return K(ne)===F},Ti.isPortal=function(ne){return K(ne)===t},Ti.isProfiler=function(ne){return K(ne)===f},Ti.isStrictMode=function(ne){return K(ne)===s},Ti.isSuspense=function(ne){return K(ne)===z},Ti.isSuspenseList=function(ne){return K(ne)===j},Ti.isValidElementType=function(ne){return typeof ne=="string"||typeof ne=="function"||ne===a||ne===f||ne===s||ne===z||ne===j||ne===Y||typeof ne=="object"&&ne!==null&&(ne.$$typeof===G||ne.$$typeof===F||ne.$$typeof===v||ne.$$typeof===S||ne.$$typeof===O||ne.$$typeof===X||ne.getModuleId!==void 0)},Ti.typeOf=K,Ti}var cR;function aee(){return cR||(cR=1,ST.exports=iee()),ST.exports}var oee=aee(),TT,uR;function Q7(){if(uR)return TT;uR=1;var e=Rd(),t=Dd(),a="[object Number]";function s(f){return typeof f=="number"||t(f)&&e(f)==a}return TT=s,TT}var ET,hR;function see(){if(hR)return ET;hR=1;var e=Q7();function t(a){return e(a)&&a!=+a}return ET=t,ET}var lee=see();const D1=Ei(lee);var cee=Q7();const uee=Ei(cee);var Qc=function(t){return t===0?0:t>0?1:-1},d0=function(t){return R1(t)&&t.indexOf("%")===t.length-1},Nn=function(t){return uee(t)&&!D1(t)},go=function(t){return Nn(t)||R1(t)},hee=0,rw=function(t){var a=++hee;return"".concat(t||"").concat(a)},cl=function(t,a){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,f=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!Nn(t)&&!R1(t))return s;var v;if(d0(t)){var S=t.indexOf("%");v=a*parseFloat(t.slice(0,S))/100}else v=+t;return D1(v)&&(v=s),f&&v>a&&(v=a),v},K_=function(t){if(!t)return null;var a=Object.keys(t);return a&&a.length?t[a[0]]:null},fee=function(t){if(!Array.isArray(t))return!1;for(var a=t.length,s={},f=0;f<a;f++)if(!s[t[f]])s[t[f]]=!0;else return!0;return!1},fR=function(t,a){return Nn(t)&&Nn(a)?function(s){return t+s*(a-t)}:function(){return a}};function ZC(e,t,a){return!e||!e.length?null:e.find(function(s){return s&&(typeof t=="function"?t(s):Hu(s,t))===a})}function WC(e,t){for(var a in e)if({}.hasOwnProperty.call(e,a)&&(!{}.hasOwnProperty.call(t,a)||e[a]!==t[a]))return!1;for(var s in t)if({}.hasOwnProperty.call(t,s)&&!{}.hasOwnProperty.call(e,s))return!1;return!0}function XC(e){"@babel/helpers - typeof";return XC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},XC(e)}var dee=["viewBox","children"],pee=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],dR=["points","pathLength"],AT={svg:dee,polygon:dR,polyline:dR},H5=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],Vx=function(t,a){if(!t||typeof t=="function"||typeof t=="boolean")return null;var s=t;if(Me.isValidElement(t)&&(s=t.props),!jg(s))return null;var f={};return Object.keys(s).forEach(function(v){H5.includes(v)&&(f[v]=a||function(S){return s[v](s,S)})}),f},mee=function(t,a,s){return function(f){return t(a,s,f),null}},iw=function(t,a,s){if(!jg(t)||XC(t)!=="object")return null;var f=null;return Object.keys(t).forEach(function(v){var S=t[v];H5.includes(v)&&typeof S=="function"&&(f||(f={}),f[v]=mee(S,a,s))}),f},_ee=["children"],gee=["children"];function pR(e,t){if(e==null)return{};var a=yee(e,t),s,f;if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(e);for(f=0;f<v.length;f++)s=v[f],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(a[s]=e[s])}return a}function yee(e,t){if(e==null)return{};var a={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(t.indexOf(s)>=0)continue;a[s]=e[s]}return a}var mR={click:"onClick",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart",contextmenu:"onContextMenu",dblclick:"onDoubleClick"},bd=function(t){return typeof t=="string"?t:t?t.displayName||t.name||"Component":""},_R=null,CT=null,Z5=function e(t){if(t===_R&&Array.isArray(CT))return CT;var a=[];return Me.Children.forEach(t,function(s){ei(s)||(oee.isFragment(s)?a=a.concat(e(s.props.children)):a.push(s))}),CT=a,_R=t,a};function ef(e,t){var a=[],s=[];return Array.isArray(t)?s=t.map(function(f){return bd(f)}):s=[bd(t)],Z5(e).forEach(function(f){var v=Hu(f,"type.displayName")||Hu(f,"type.name");s.indexOf(v)!==-1&&a.push(f)}),a}function Yc(e,t){var a=ef(e,t);return a&&a[0]}var gR=function(t){if(!t||!t.props)return!1;var a=t.props,s=a.width,f=a.height;return!(!Nn(s)||s<=0||!Nn(f)||f<=0)},vee=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColormatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-url","foreignObject","g","glyph","glyphRef","hkern","image","line","lineGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],xee=function(t){return t&&t.type&&R1(t.type)&&vee.indexOf(t.type)>=0},bee=function(t,a,s,f){var v,S=(v=AT==null?void 0:AT[f])!==null&&v!==void 0?v:[];return!Vr(t)&&(f&&S.includes(a)||pee.includes(a))||s&&H5.includes(a)},Fr=function(t,a,s){if(!t||typeof t=="function"||typeof t=="boolean")return null;var f=t;if(Me.isValidElement(t)&&(f=t.props),!jg(f))return null;var v={};return Object.keys(f).forEach(function(S){var i;bee((i=f)===null||i===void 0?void 0:i[S],S,a,s)&&(v[S]=f[S])}),v},YC=function e(t,a){if(t===a)return!0;var s=Me.Children.count(t);if(s!==Me.Children.count(a))return!1;if(s===0)return!0;if(s===1)return yR(Array.isArray(t)?t[0]:t,Array.isArray(a)?a[0]:a);for(var f=0;f<s;f++){var v=t[f],S=a[f];if(Array.isArray(v)||Array.isArray(S)){if(!e(v,S))return!1}else if(!yR(v,S))return!1}return!0},yR=function(t,a){if(ei(t)&&ei(a))return!0;if(!ei(t)&&!ei(a)){var s=t.props||{},f=s.children,v=pR(s,_ee),S=a.props||{},i=S.children,O=pR(S,gee);return f&&i?WC(v,O)&&YC(f,i):!f&&!i?WC(v,O):!1}return!1},vR=function(t,a){var s=[],f={};return Z5(t).forEach(function(v,S){if(xee(v))s.push(v);else if(v){var i=bd(v.type),O=a[i]||{},z=O.handler,j=O.once;if(z&&(!j||!f[i])){var F=z(v,i,S);s.push(F),f[i]=!0}}}),s},wee=function(t){var a=t&&t.type;return a&&mR[a]?mR[a]:null},See=function(t,a){return Z5(a).indexOf(t)},Tee=["children","width","height","viewBox","className","style","title","desc"];function KC(){return KC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},KC.apply(this,arguments)}function Eee(e,t){if(e==null)return{};var a=Aee(e,t),s,f;if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(e);for(f=0;f<v.length;f++)s=v[f],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(a[s]=e[s])}return a}function Aee(e,t){if(e==null)return{};var a={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(t.indexOf(s)>=0)continue;a[s]=e[s]}return a}function JC(e){var t=e.children,a=e.width,s=e.height,f=e.viewBox,v=e.className,S=e.style,i=e.title,O=e.desc,z=Eee(e,Tee),j=f||{width:a,height:s,x:0,y:0},F=oi("recharts-surface",v);return Ot.createElement("svg",KC({},Fr(z,!0,"svg"),{className:F,width:a,height:s,style:S,viewBox:"".concat(j.x," ").concat(j.y," ").concat(j.width," ").concat(j.height)}),Ot.createElement("title",null,i),Ot.createElement("desc",null,O),t)}var Cee=["children","className"];function QC(){return QC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},QC.apply(this,arguments)}function Mee(e,t){if(e==null)return{};var a=Oee(e,t),s,f;if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(e);for(f=0;f<v.length;f++)s=v[f],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(a[s]=e[s])}return a}function Oee(e,t){if(e==null)return{};var a={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(t.indexOf(s)>=0)continue;a[s]=e[s]}return a}var Ua=Ot.forwardRef(function(e,t){var a=e.children,s=e.className,f=Mee(e,Cee),v=oi("recharts-layer",s);return Ot.createElement("g",QC({className:v},Fr(f,!0),{ref:t}),a)}),wd=function(t,a){for(var s=arguments.length,f=new Array(s>2?s-2:0),v=2;v<s;v++)f[v-2]=arguments[v]},MT,xR;function Iee(){if(xR)return MT;xR=1;function e(t,a,s){var f=-1,v=t.length;a<0&&(a=-a>v?0:v+a),s=s>v?v:s,s<0&&(s+=v),v=a>s?0:s-a>>>0,a>>>=0;for(var S=Array(v);++f<v;)S[f]=t[f+a];return S}return MT=e,MT}var OT,bR;function Pee(){if(bR)return OT;bR=1;var e=Iee();function t(a,s,f){var v=a.length;return f=f===void 0?v:f,!s&&f>=v?a:e(a,s,f)}return OT=t,OT}var IT,wR;function eB(){if(wR)return IT;wR=1;var e="\\ud800-\\udfff",t="\\u0300-\\u036f",a="\\ufe20-\\ufe2f",s="\\u20d0-\\u20ff",f=t+a+s,v="\\ufe0e\\ufe0f",S="\\u200d",i=RegExp("["+S+e+f+v+"]");function O(z){return i.test(z)}return IT=O,IT}var PT,SR;function Ree(){if(SR)return PT;SR=1;function e(t){return t.split("")}return PT=e,PT}var RT,TR;function Dee(){if(TR)return RT;TR=1;var e="\\ud800-\\udfff",t="\\u0300-\\u036f",a="\\ufe20-\\ufe2f",s="\\u20d0-\\u20ff",f=t+a+s,v="\\ufe0e\\ufe0f",S="["+e+"]",i="["+f+"]",O="\\ud83c[\\udffb-\\udfff]",z="(?:"+i+"|"+O+")",j="[^"+e+"]",F="(?:\\ud83c[\\udde6-\\uddff]){2}",G="[\\ud800-\\udbff][\\udc00-\\udfff]",Y="\\u200d",X=z+"?",K="["+v+"]?",ne="(?:"+Y+"(?:"+[j,F,G].join("|")+")"+K+X+")*",se=K+X+ne,ge="(?:"+[j+i+"?",i,F,G,S].join("|")+")",_e=RegExp(O+"(?="+O+")|"+ge+se,"g");function xe(ae){return ae.match(_e)||[]}return RT=xe,RT}var DT,ER;function Lee(){if(ER)return DT;ER=1;var e=Ree(),t=eB(),a=Dee();function s(f){return t(f)?a(f):e(f)}return DT=s,DT}var LT,AR;function zee(){if(AR)return LT;AR=1;var e=Pee(),t=eB(),a=Lee(),s=Y7();function f(v){return function(S){S=s(S);var i=t(S)?a(S):void 0,O=i?i[0]:S.charAt(0),z=i?e(i,1).join(""):S.slice(1);return O[v]()+z}}return LT=f,LT}var zT,CR;function kee(){if(CR)return zT;CR=1;var e=zee(),t=e("toUpperCase");return zT=t,zT}var Bee=kee();const aw=Ei(Bee);function Zi(e){return function(){return e}}const tB=Math.cos,$x=Math.sin,Xu=Math.sqrt,qx=Math.PI,ow=2*qx,eM=Math.PI,tM=2*eM,u0=1e-6,Nee=tM-u0;function nB(e){this._+=e[0];for(let t=1,a=e.length;t<a;++t)this._+=arguments[t]+e[t]}function Fee(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return nB;const a=10**t;return function(s){this._+=s[0];for(let f=1,v=s.length;f<v;++f)this._+=Math.round(arguments[f]*a)/a+s[f]}}class jee{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?nB:Fee(t)}moveTo(t,a){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+a}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,a){this._append`L${this._x1=+t},${this._y1=+a}`}quadraticCurveTo(t,a,s,f){this._append`Q${+t},${+a},${this._x1=+s},${this._y1=+f}`}bezierCurveTo(t,a,s,f,v,S){this._append`C${+t},${+a},${+s},${+f},${this._x1=+v},${this._y1=+S}`}arcTo(t,a,s,f,v){if(t=+t,a=+a,s=+s,f=+f,v=+v,v<0)throw new Error(`negative radius: ${v}`);let S=this._x1,i=this._y1,O=s-t,z=f-a,j=S-t,F=i-a,G=j*j+F*F;if(this._x1===null)this._append`M${this._x1=t},${this._y1=a}`;else if(G>u0)if(!(Math.abs(F*O-z*j)>u0)||!v)this._append`L${this._x1=t},${this._y1=a}`;else{let Y=s-S,X=f-i,K=O*O+z*z,ne=Y*Y+X*X,se=Math.sqrt(K),ge=Math.sqrt(G),_e=v*Math.tan((eM-Math.acos((K+G-ne)/(2*se*ge)))/2),xe=_e/ge,ae=_e/se;Math.abs(xe-1)>u0&&this._append`L${t+xe*j},${a+xe*F}`,this._append`A${v},${v},0,0,${+(F*Y>j*X)},${this._x1=t+ae*O},${this._y1=a+ae*z}`}}arc(t,a,s,f,v,S){if(t=+t,a=+a,s=+s,S=!!S,s<0)throw new Error(`negative radius: ${s}`);let i=s*Math.cos(f),O=s*Math.sin(f),z=t+i,j=a+O,F=1^S,G=S?f-v:v-f;this._x1===null?this._append`M${z},${j}`:(Math.abs(this._x1-z)>u0||Math.abs(this._y1-j)>u0)&&this._append`L${z},${j}`,s&&(G<0&&(G=G%tM+tM),G>Nee?this._append`A${s},${s},0,1,${F},${t-i},${a-O}A${s},${s},0,1,${F},${this._x1=z},${this._y1=j}`:G>u0&&this._append`A${s},${s},0,${+(G>=eM)},${F},${this._x1=t+s*Math.cos(v)},${this._y1=a+s*Math.sin(v)}`)}rect(t,a,s,f){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+a}h${s=+s}v${+f}h${-s}Z`}toString(){return this._}}function W5(e){let t=3;return e.digits=function(a){if(!arguments.length)return t;if(a==null)t=null;else{const s=Math.floor(a);if(!(s>=0))throw new RangeError(`invalid digits: ${a}`);t=s}return e},()=>new jee(t)}function X5(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function rB(e){this._context=e}rB.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function sw(e){return new rB(e)}function iB(e){return e[0]}function aB(e){return e[1]}function oB(e,t){var a=Zi(!0),s=null,f=sw,v=null,S=W5(i);e=typeof e=="function"?e:e===void 0?iB:Zi(e),t=typeof t=="function"?t:t===void 0?aB:Zi(t);function i(O){var z,j=(O=X5(O)).length,F,G=!1,Y;for(s==null&&(v=f(Y=S())),z=0;z<=j;++z)!(z<j&&a(F=O[z],z,O))===G&&((G=!G)?v.lineStart():v.lineEnd()),G&&v.point(+e(F,z,O),+t(F,z,O));if(Y)return v=null,Y+""||null}return i.x=function(O){return arguments.length?(e=typeof O=="function"?O:Zi(+O),i):e},i.y=function(O){return arguments.length?(t=typeof O=="function"?O:Zi(+O),i):t},i.defined=function(O){return arguments.length?(a=typeof O=="function"?O:Zi(!!O),i):a},i.curve=function(O){return arguments.length?(f=O,s!=null&&(v=f(s)),i):f},i.context=function(O){return arguments.length?(O==null?s=v=null:v=f(s=O),i):s},i}function sx(e,t,a){var s=null,f=Zi(!0),v=null,S=sw,i=null,O=W5(z);e=typeof e=="function"?e:e===void 0?iB:Zi(+e),t=typeof t=="function"?t:Zi(t===void 0?0:+t),a=typeof a=="function"?a:a===void 0?aB:Zi(+a);function z(F){var G,Y,X,K=(F=X5(F)).length,ne,se=!1,ge,_e=new Array(K),xe=new Array(K);for(v==null&&(i=S(ge=O())),G=0;G<=K;++G){if(!(G<K&&f(ne=F[G],G,F))===se)if(se=!se)Y=G,i.areaStart(),i.lineStart();else{for(i.lineEnd(),i.lineStart(),X=G-1;X>=Y;--X)i.point(_e[X],xe[X]);i.lineEnd(),i.areaEnd()}se&&(_e[G]=+e(ne,G,F),xe[G]=+t(ne,G,F),i.point(s?+s(ne,G,F):_e[G],a?+a(ne,G,F):xe[G]))}if(ge)return i=null,ge+""||null}function j(){return oB().defined(f).curve(S).context(v)}return z.x=function(F){return arguments.length?(e=typeof F=="function"?F:Zi(+F),s=null,z):e},z.x0=function(F){return arguments.length?(e=typeof F=="function"?F:Zi(+F),z):e},z.x1=function(F){return arguments.length?(s=F==null?null:typeof F=="function"?F:Zi(+F),z):s},z.y=function(F){return arguments.length?(t=typeof F=="function"?F:Zi(+F),a=null,z):t},z.y0=function(F){return arguments.length?(t=typeof F=="function"?F:Zi(+F),z):t},z.y1=function(F){return arguments.length?(a=F==null?null:typeof F=="function"?F:Zi(+F),z):a},z.lineX0=z.lineY0=function(){return j().x(e).y(t)},z.lineY1=function(){return j().x(e).y(a)},z.lineX1=function(){return j().x(s).y(t)},z.defined=function(F){return arguments.length?(f=typeof F=="function"?F:Zi(!!F),z):f},z.curve=function(F){return arguments.length?(S=F,v!=null&&(i=S(v)),z):S},z.context=function(F){return arguments.length?(F==null?v=i=null:i=S(v=F),z):v},z}class sB{constructor(t,a){this._context=t,this._x=a}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,a){switch(t=+t,a=+a,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,a):this._context.moveTo(t,a);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,a,t,a):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+a)/2,t,this._y0,t,a);break}}this._x0=t,this._y0=a}}function Uee(e){return new sB(e,!0)}function Vee(e){return new sB(e,!1)}const Y5={draw(e,t){const a=Xu(t/qx);e.moveTo(a,0),e.arc(0,0,a,0,ow)}},$ee={draw(e,t){const a=Xu(t/5)/2;e.moveTo(-3*a,-a),e.lineTo(-a,-a),e.lineTo(-a,-3*a),e.lineTo(a,-3*a),e.lineTo(a,-a),e.lineTo(3*a,-a),e.lineTo(3*a,a),e.lineTo(a,a),e.lineTo(a,3*a),e.lineTo(-a,3*a),e.lineTo(-a,a),e.lineTo(-3*a,a),e.closePath()}},lB=Xu(1/3),qee=lB*2,Gee={draw(e,t){const a=Xu(t/qee),s=a*lB;e.moveTo(0,-a),e.lineTo(s,0),e.lineTo(0,a),e.lineTo(-s,0),e.closePath()}},Hee={draw(e,t){const a=Xu(t),s=-a/2;e.rect(s,s,a,a)}},Zee=.8908130915292852,cB=$x(qx/10)/$x(7*qx/10),Wee=$x(ow/10)*cB,Xee=-tB(ow/10)*cB,Yee={draw(e,t){const a=Xu(t*Zee),s=Wee*a,f=Xee*a;e.moveTo(0,-a),e.lineTo(s,f);for(let v=1;v<5;++v){const S=ow*v/5,i=tB(S),O=$x(S);e.lineTo(O*a,-i*a),e.lineTo(i*s-O*f,O*s+i*f)}e.closePath()}},kT=Xu(3),Kee={draw(e,t){const a=-Xu(t/(kT*3));e.moveTo(0,a*2),e.lineTo(-kT*a,-a),e.lineTo(kT*a,-a),e.closePath()}},Wc=-.5,Xc=Xu(3)/2,nM=1/Xu(12),Jee=(nM/2+1)*3,Qee={draw(e,t){const a=Xu(t/Jee),s=a/2,f=a*nM,v=s,S=a*nM+a,i=-v,O=S;e.moveTo(s,f),e.lineTo(v,S),e.lineTo(i,O),e.lineTo(Wc*s-Xc*f,Xc*s+Wc*f),e.lineTo(Wc*v-Xc*S,Xc*v+Wc*S),e.lineTo(Wc*i-Xc*O,Xc*i+Wc*O),e.lineTo(Wc*s+Xc*f,Wc*f-Xc*s),e.lineTo(Wc*v+Xc*S,Wc*S-Xc*v),e.lineTo(Wc*i+Xc*O,Wc*O-Xc*i),e.closePath()}};function ete(e,t){let a=null,s=W5(f);e=typeof e=="function"?e:Zi(e||Y5),t=typeof t=="function"?t:Zi(t===void 0?64:+t);function f(){let v;if(a||(a=v=s()),e.apply(this,arguments).draw(a,+t.apply(this,arguments)),v)return a=null,v+""||null}return f.type=function(v){return arguments.length?(e=typeof v=="function"?v:Zi(v),f):e},f.size=function(v){return arguments.length?(t=typeof v=="function"?v:Zi(+v),f):t},f.context=function(v){return arguments.length?(a=v??null,f):a},f}function Gx(){}function Hx(e,t,a){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+a)/6)}function uB(e){this._context=e}uB.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Hx(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Hx(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function tte(e){return new uB(e)}function hB(e){this._context=e}hB.prototype={areaStart:Gx,areaEnd:Gx,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:Hx(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function nte(e){return new hB(e)}function fB(e){this._context=e}fB.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var a=(this._x0+4*this._x1+e)/6,s=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(a,s):this._context.moveTo(a,s);break;case 3:this._point=4;default:Hx(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function rte(e){return new fB(e)}function dB(e){this._context=e}dB.prototype={areaStart:Gx,areaEnd:Gx,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function ite(e){return new dB(e)}function MR(e){return e<0?-1:1}function OR(e,t,a){var s=e._x1-e._x0,f=t-e._x1,v=(e._y1-e._y0)/(s||f<0&&-0),S=(a-e._y1)/(f||s<0&&-0),i=(v*f+S*s)/(s+f);return(MR(v)+MR(S))*Math.min(Math.abs(v),Math.abs(S),.5*Math.abs(i))||0}function IR(e,t){var a=e._x1-e._x0;return a?(3*(e._y1-e._y0)/a-t)/2:t}function BT(e,t,a){var s=e._x0,f=e._y0,v=e._x1,S=e._y1,i=(v-s)/3;e._context.bezierCurveTo(s+i,f+i*t,v-i,S-i*a,v,S)}function Zx(e){this._context=e}Zx.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:BT(this,this._t0,IR(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var a=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,BT(this,IR(this,a=OR(this,e,t)),a);break;default:BT(this,this._t0,a=OR(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=a}}};function pB(e){this._context=new mB(e)}(pB.prototype=Object.create(Zx.prototype)).point=function(e,t){Zx.prototype.point.call(this,t,e)};function mB(e){this._context=e}mB.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,a,s,f,v){this._context.bezierCurveTo(t,e,s,a,v,f)}};function ate(e){return new Zx(e)}function ote(e){return new pB(e)}function _B(e){this._context=e}_B.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,a=e.length;if(a)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),a===2)this._context.lineTo(e[1],t[1]);else for(var s=PR(e),f=PR(t),v=0,S=1;S<a;++v,++S)this._context.bezierCurveTo(s[0][v],f[0][v],s[1][v],f[1][v],e[S],t[S]);(this._line||this._line!==0&&a===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function PR(e){var t,a=e.length-1,s,f=new Array(a),v=new Array(a),S=new Array(a);for(f[0]=0,v[0]=2,S[0]=e[0]+2*e[1],t=1;t<a-1;++t)f[t]=1,v[t]=4,S[t]=4*e[t]+2*e[t+1];for(f[a-1]=2,v[a-1]=7,S[a-1]=8*e[a-1]+e[a],t=1;t<a;++t)s=f[t]/v[t-1],v[t]-=s,S[t]-=s*S[t-1];for(f[a-1]=S[a-1]/v[a-1],t=a-2;t>=0;--t)f[t]=(S[t]-f[t+1])/v[t];for(v[a-1]=(e[a]+f[a-1])/2,t=0;t<a-1;++t)v[t]=2*e[t+1]-f[t+1];return[f,v]}function ste(e){return new _B(e)}function lw(e,t){this._context=e,this._t=t}lw.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var a=this._x*(1-this._t)+e*this._t;this._context.lineTo(a,this._y),this._context.lineTo(a,t)}break}}this._x=e,this._y=t}};function lte(e){return new lw(e,.5)}function cte(e){return new lw(e,0)}function ute(e){return new lw(e,1)}function dg(e,t){if((S=e.length)>1)for(var a=1,s,f,v=e[t[0]],S,i=v.length;a<S;++a)for(f=v,v=e[t[a]],s=0;s<i;++s)v[s][1]+=v[s][0]=isNaN(f[s][1])?f[s][0]:f[s][1]}function rM(e){for(var t=e.length,a=new Array(t);--t>=0;)a[t]=t;return a}function hte(e,t){return e[t]}function fte(e){const t=[];return t.key=e,t}function dte(){var e=Zi([]),t=rM,a=dg,s=hte;function f(v){var S=Array.from(e.apply(this,arguments),fte),i,O=S.length,z=-1,j;for(const F of v)for(i=0,++z;i<O;++i)(S[i][z]=[0,+s(F,S[i].key,z,v)]).data=F;for(i=0,j=X5(t(S));i<O;++i)S[j[i]].index=i;return a(S,j),S}return f.keys=function(v){return arguments.length?(e=typeof v=="function"?v:Zi(Array.from(v)),f):e},f.value=function(v){return arguments.length?(s=typeof v=="function"?v:Zi(+v),f):s},f.order=function(v){return arguments.length?(t=v==null?rM:typeof v=="function"?v:Zi(Array.from(v)),f):t},f.offset=function(v){return arguments.length?(a=v??dg,f):a},f}function pte(e,t){if((s=e.length)>0){for(var a,s,f=0,v=e[0].length,S;f<v;++f){for(S=a=0;a<s;++a)S+=e[a][f][1]||0;if(S)for(a=0;a<s;++a)e[a][f][1]/=S}dg(e,t)}}function mte(e,t){if((f=e.length)>0){for(var a=0,s=e[t[0]],f,v=s.length;a<v;++a){for(var S=0,i=0;S<f;++S)i+=e[S][a][1]||0;s[a][1]+=s[a][0]=-i/2}dg(e,t)}}function _te(e,t){if(!(!((S=e.length)>0)||!((v=(f=e[t[0]]).length)>0))){for(var a=0,s=1,f,v,S;s<v;++s){for(var i=0,O=0,z=0;i<S;++i){for(var j=e[t[i]],F=j[s][1]||0,G=j[s-1][1]||0,Y=(F-G)/2,X=0;X<i;++X){var K=e[t[X]],ne=K[s][1]||0,se=K[s-1][1]||0;Y+=ne-se}O+=F,z+=Y*F}f[s-1][1]+=f[s-1][0]=a,O&&(a-=z/O)}f[s-1][1]+=f[s-1][0]=a,dg(e,t)}}function qv(e){"@babel/helpers - typeof";return qv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qv(e)}var gte=["type","size","sizeType"];function iM(){return iM=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},iM.apply(this,arguments)}function RR(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(f){return Object.getOwnPropertyDescriptor(e,f).enumerable})),a.push.apply(a,s)}return a}function DR(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?RR(Object(a),!0).forEach(function(s){yte(e,s,a[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):RR(Object(a)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(a,s))})}return e}function yte(e,t,a){return t=vte(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function vte(e){var t=xte(e,"string");return qv(t)=="symbol"?t:t+""}function xte(e,t){if(qv(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var s=a.call(e,t);if(qv(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function bte(e,t){if(e==null)return{};var a=wte(e,t),s,f;if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(e);for(f=0;f<v.length;f++)s=v[f],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(a[s]=e[s])}return a}function wte(e,t){if(e==null)return{};var a={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(t.indexOf(s)>=0)continue;a[s]=e[s]}return a}var gB={symbolCircle:Y5,symbolCross:$ee,symbolDiamond:Gee,symbolSquare:Hee,symbolStar:Yee,symbolTriangle:Kee,symbolWye:Qee},Ste=Math.PI/180,Tte=function(t){var a="symbol".concat(aw(t));return gB[a]||Y5},Ete=function(t,a,s){if(a==="area")return t;switch(s){case"cross":return 5*t*t/9;case"diamond":return .5*t*t/Math.sqrt(3);case"square":return t*t;case"star":{var f=18*Ste;return 1.25*t*t*(Math.tan(f)-Math.tan(f*2)*Math.pow(Math.tan(f),2))}case"triangle":return Math.sqrt(3)*t*t/4;case"wye":return(21-10*Math.sqrt(3))*t*t/8;default:return Math.PI*t*t/4}},Ate=function(t,a){gB["symbol".concat(aw(t))]=a},K5=function(t){var a=t.type,s=a===void 0?"circle":a,f=t.size,v=f===void 0?64:f,S=t.sizeType,i=S===void 0?"area":S,O=bte(t,gte),z=DR(DR({},O),{},{type:s,size:v,sizeType:i}),j=function(){var ne=Tte(s),se=ete().type(ne).size(Ete(v,i,s));return se()},F=z.className,G=z.cx,Y=z.cy,X=Fr(z,!0);return G===+G&&Y===+Y&&v===+v?Ot.createElement("path",iM({},X,{className:oi("recharts-symbols",F),transform:"translate(".concat(G,", ").concat(Y,")"),d:j()})):null};K5.registerSymbol=Ate;function pg(e){"@babel/helpers - typeof";return pg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pg(e)}function aM(){return aM=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},aM.apply(this,arguments)}function LR(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(f){return Object.getOwnPropertyDescriptor(e,f).enumerable})),a.push.apply(a,s)}return a}function Cte(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?LR(Object(a),!0).forEach(function(s){Gv(e,s,a[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):LR(Object(a)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(a,s))})}return e}function Mte(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ote(e,t){for(var a=0;a<t.length;a++){var s=t[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,vB(s.key),s)}}function Ite(e,t,a){return t&&Ote(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Pte(e,t,a){return t=Wx(t),Rte(e,yB()?Reflect.construct(t,a||[],Wx(e).constructor):t.apply(e,a))}function Rte(e,t){if(t&&(pg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Dte(e)}function Dte(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function yB(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(yB=function(){return!!e})()}function Wx(e){return Wx=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)},Wx(e)}function Lte(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&oM(e,t)}function oM(e,t){return oM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,f){return s.__proto__=f,s},oM(e,t)}function Gv(e,t,a){return t=vB(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function vB(e){var t=zte(e,"string");return pg(t)=="symbol"?t:t+""}function zte(e,t){if(pg(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var s=a.call(e,t);if(pg(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Vu=32,J5=function(e){function t(){return Mte(this,t),Pte(this,t,arguments)}return Lte(t,e),Ite(t,[{key:"renderIcon",value:function(s){var f=this.props.inactiveColor,v=Vu/2,S=Vu/6,i=Vu/3,O=s.inactive?f:s.color;if(s.type==="plainline")return Ot.createElement("line",{strokeWidth:4,fill:"none",stroke:O,strokeDasharray:s.payload.strokeDasharray,x1:0,y1:v,x2:Vu,y2:v,className:"recharts-legend-icon"});if(s.type==="line")return Ot.createElement("path",{strokeWidth:4,fill:"none",stroke:O,d:"M0,".concat(v,"h").concat(i,`
            A`).concat(S,",").concat(S,",0,1,1,").concat(2*i,",").concat(v,`
            H`).concat(Vu,"M").concat(2*i,",").concat(v,`
            A`).concat(S,",").concat(S,",0,1,1,").concat(i,",").concat(v),className:"recharts-legend-icon"});if(s.type==="rect")return Ot.createElement("path",{stroke:"none",fill:O,d:"M0,".concat(Vu/8,"h").concat(Vu,"v").concat(Vu*3/4,"h").concat(-32,"z"),className:"recharts-legend-icon"});if(Ot.isValidElement(s.legendIcon)){var z=Cte({},s);return delete z.legendIcon,Ot.cloneElement(s.legendIcon,z)}return Ot.createElement(K5,{fill:O,cx:v,cy:v,size:Vu,sizeType:"diameter",type:s.type})}},{key:"renderItems",value:function(){var s=this,f=this.props,v=f.payload,S=f.iconSize,i=f.layout,O=f.formatter,z=f.inactiveColor,j={x:0,y:0,width:Vu,height:Vu},F={display:i==="horizontal"?"inline-block":"block",marginRight:10},G={display:"inline-block",verticalAlign:"middle",marginRight:4};return v.map(function(Y,X){var K=Y.formatter||O,ne=oi(Gv(Gv({"recharts-legend-item":!0},"legend-item-".concat(X),!0),"inactive",Y.inactive));if(Y.type==="none")return null;var se=Vr(Y.value)?null:Y.value;wd(!Vr(Y.value),`The name property is also required when using a function for the dataKey of a chart's cartesian components. Ex: <Bar name="Name of my Data"/>`);var ge=Y.inactive?z:Y.color;return Ot.createElement("li",aM({className:ne,style:F,key:"legend-item-".concat(X)},iw(s.props,Y,X)),Ot.createElement(JC,{width:S,height:S,viewBox:j,style:G},s.renderIcon(Y)),Ot.createElement("span",{className:"recharts-legend-item-text",style:{color:ge}},K?K(se,Y,X):se))})}},{key:"render",value:function(){var s=this.props,f=s.payload,v=s.layout,S=s.align;if(!f||!f.length)return null;var i={padding:0,margin:0,textAlign:v==="horizontal"?S:"left"};return Ot.createElement("ul",{className:"recharts-default-legend",style:i},this.renderItems())}}])}(Me.PureComponent);Gv(J5,"displayName","Legend");Gv(J5,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"middle",inactiveColor:"#ccc"});var NT,zR;function kte(){if(zR)return NT;zR=1;var e=ew();function t(){this.__data__=new e,this.size=0}return NT=t,NT}var FT,kR;function Bte(){if(kR)return FT;kR=1;function e(t){var a=this.__data__,s=a.delete(t);return this.size=a.size,s}return FT=e,FT}var jT,BR;function Nte(){if(BR)return jT;BR=1;function e(t){return this.__data__.get(t)}return jT=e,jT}var UT,NR;function Fte(){if(NR)return UT;NR=1;function e(t){return this.__data__.has(t)}return UT=e,UT}var VT,FR;function jte(){if(FR)return VT;FR=1;var e=ew(),t=V5(),a=$5(),s=200;function f(v,S){var i=this.__data__;if(i instanceof e){var O=i.__data__;if(!t||O.length<s-1)return O.push([v,S]),this.size=++i.size,this;i=this.__data__=new a(O)}return i.set(v,S),this.size=i.size,this}return VT=f,VT}var $T,jR;function xB(){if(jR)return $T;jR=1;var e=ew(),t=kte(),a=Bte(),s=Nte(),f=Fte(),v=jte();function S(i){var O=this.__data__=new e(i);this.size=O.size}return S.prototype.clear=t,S.prototype.delete=a,S.prototype.get=s,S.prototype.has=f,S.prototype.set=v,$T=S,$T}var qT,UR;function Ute(){if(UR)return qT;UR=1;var e="__lodash_hash_undefined__";function t(a){return this.__data__.set(a,e),this}return qT=t,qT}var GT,VR;function Vte(){if(VR)return GT;VR=1;function e(t){return this.__data__.has(t)}return GT=e,GT}var HT,$R;function bB(){if($R)return HT;$R=1;var e=$5(),t=Ute(),a=Vte();function s(f){var v=-1,S=f==null?0:f.length;for(this.__data__=new e;++v<S;)this.add(f[v])}return s.prototype.add=s.prototype.push=t,s.prototype.has=a,HT=s,HT}var ZT,qR;function wB(){if(qR)return ZT;qR=1;function e(t,a){for(var s=-1,f=t==null?0:t.length;++s<f;)if(a(t[s],s,t))return!0;return!1}return ZT=e,ZT}var WT,GR;function SB(){if(GR)return WT;GR=1;function e(t,a){return t.has(a)}return WT=e,WT}var XT,HR;function TB(){if(HR)return XT;HR=1;var e=bB(),t=wB(),a=SB(),s=1,f=2;function v(S,i,O,z,j,F){var G=O&s,Y=S.length,X=i.length;if(Y!=X&&!(G&&X>Y))return!1;var K=F.get(S),ne=F.get(i);if(K&&ne)return K==i&&ne==S;var se=-1,ge=!0,_e=O&f?new e:void 0;for(F.set(S,i),F.set(i,S);++se<Y;){var xe=S[se],ae=i[se];if(z)var ve=G?z(ae,xe,se,i,S,F):z(xe,ae,se,S,i,F);if(ve!==void 0){if(ve)continue;ge=!1;break}if(_e){if(!t(i,function(Se,He){if(!a(_e,He)&&(xe===Se||j(xe,Se,O,z,F)))return _e.push(He)})){ge=!1;break}}else if(!(xe===ae||j(xe,ae,O,z,F))){ge=!1;break}}return F.delete(S),F.delete(i),ge}return XT=v,XT}var YT,ZR;function $te(){if(ZR)return YT;ZR=1;var e=of(),t=e.Uint8Array;return YT=t,YT}var KT,WR;function qte(){if(WR)return KT;WR=1;function e(t){var a=-1,s=Array(t.size);return t.forEach(function(f,v){s[++a]=[v,f]}),s}return KT=e,KT}var JT,XR;function Q5(){if(XR)return JT;XR=1;function e(t){var a=-1,s=Array(t.size);return t.forEach(function(f){s[++a]=f}),s}return JT=e,JT}var QT,YR;function Gte(){if(YR)return QT;YR=1;var e=P1(),t=$te(),a=U5(),s=TB(),f=qte(),v=Q5(),S=1,i=2,O="[object Boolean]",z="[object Date]",j="[object Error]",F="[object Map]",G="[object Number]",Y="[object RegExp]",X="[object Set]",K="[object String]",ne="[object Symbol]",se="[object ArrayBuffer]",ge="[object DataView]",_e=e?e.prototype:void 0,xe=_e?_e.valueOf:void 0;function ae(ve,Se,He,Ge,ye,Le,ht){switch(He){case ge:if(ve.byteLength!=Se.byteLength||ve.byteOffset!=Se.byteOffset)return!1;ve=ve.buffer,Se=Se.buffer;case se:return!(ve.byteLength!=Se.byteLength||!Le(new t(ve),new t(Se)));case O:case z:case G:return a(+ve,+Se);case j:return ve.name==Se.name&&ve.message==Se.message;case Y:case K:return ve==Se+"";case F:var gt=f;case X:var Ft=Ge&S;if(gt||(gt=v),ve.size!=Se.size&&!Ft)return!1;var _t=ht.get(ve);if(_t)return _t==Se;Ge|=i,ht.set(ve,Se);var yt=s(gt(ve),gt(Se),Ge,ye,Le,ht);return ht.delete(ve),yt;case ne:if(xe)return xe.call(ve)==xe.call(Se)}return!1}return QT=ae,QT}var eE,KR;function EB(){if(KR)return eE;KR=1;function e(t,a){for(var s=-1,f=a.length,v=t.length;++s<f;)t[v+s]=a[s];return t}return eE=e,eE}var tE,JR;function Hte(){if(JR)return tE;JR=1;var e=EB(),t=pl();function a(s,f,v){var S=f(s);return t(s)?S:e(S,v(s))}return tE=a,tE}var nE,QR;function Zte(){if(QR)return nE;QR=1;function e(t,a){for(var s=-1,f=t==null?0:t.length,v=0,S=[];++s<f;){var i=t[s];a(i,s,t)&&(S[v++]=i)}return S}return nE=e,nE}var rE,eD;function Wte(){if(eD)return rE;eD=1;function e(){return[]}return rE=e,rE}var iE,tD;function Xte(){if(tD)return iE;tD=1;var e=Zte(),t=Wte(),a=Object.prototype,s=a.propertyIsEnumerable,f=Object.getOwnPropertySymbols,v=f?function(S){return S==null?[]:(S=Object(S),e(f(S),function(i){return s.call(S,i)}))}:t;return iE=v,iE}var aE,nD;function Yte(){if(nD)return aE;nD=1;function e(t,a){for(var s=-1,f=Array(t);++s<t;)f[s]=a(s);return f}return aE=e,aE}var oE,rD;function Kte(){if(rD)return oE;rD=1;var e=Rd(),t=Dd(),a="[object Arguments]";function s(f){return t(f)&&e(f)==a}return oE=s,oE}var sE,iD;function e4(){if(iD)return sE;iD=1;var e=Kte(),t=Dd(),a=Object.prototype,s=a.hasOwnProperty,f=a.propertyIsEnumerable,v=e(function(){return arguments}())?e:function(S){return t(S)&&s.call(S,"callee")&&!f.call(S,"callee")};return sE=v,sE}var Sv={exports:{}},lE,aD;function Jte(){if(aD)return lE;aD=1;function e(){return!1}return lE=e,lE}Sv.exports;var oD;function AB(){return oD||(oD=1,function(e,t){var a=of(),s=Jte(),f=t&&!t.nodeType&&t,v=f&&!0&&e&&!e.nodeType&&e,S=v&&v.exports===f,i=S?a.Buffer:void 0,O=i?i.isBuffer:void 0,z=O||s;e.exports=z}(Sv,Sv.exports)),Sv.exports}var cE,sD;function t4(){if(sD)return cE;sD=1;var e=9007199254740991,t=/^(?:0|[1-9]\d*)$/;function a(s,f){var v=typeof s;return f=f??e,!!f&&(v=="number"||v!="symbol"&&t.test(s))&&s>-1&&s%1==0&&s<f}return cE=a,cE}var uE,lD;function n4(){if(lD)return uE;lD=1;var e=9007199254740991;function t(a){return typeof a=="number"&&a>-1&&a%1==0&&a<=e}return uE=t,uE}var hE,cD;function Qte(){if(cD)return hE;cD=1;var e=Rd(),t=n4(),a=Dd(),s="[object Arguments]",f="[object Array]",v="[object Boolean]",S="[object Date]",i="[object Error]",O="[object Function]",z="[object Map]",j="[object Number]",F="[object Object]",G="[object RegExp]",Y="[object Set]",X="[object String]",K="[object WeakMap]",ne="[object ArrayBuffer]",se="[object DataView]",ge="[object Float32Array]",_e="[object Float64Array]",xe="[object Int8Array]",ae="[object Int16Array]",ve="[object Int32Array]",Se="[object Uint8Array]",He="[object Uint8ClampedArray]",Ge="[object Uint16Array]",ye="[object Uint32Array]",Le={};Le[ge]=Le[_e]=Le[xe]=Le[ae]=Le[ve]=Le[Se]=Le[He]=Le[Ge]=Le[ye]=!0,Le[s]=Le[f]=Le[ne]=Le[v]=Le[se]=Le[S]=Le[i]=Le[O]=Le[z]=Le[j]=Le[F]=Le[G]=Le[Y]=Le[X]=Le[K]=!1;function ht(gt){return a(gt)&&t(gt.length)&&!!Le[e(gt)]}return hE=ht,hE}var fE,uD;function CB(){if(uD)return fE;uD=1;function e(t){return function(a){return t(a)}}return fE=e,fE}var Tv={exports:{}};Tv.exports;var hD;function ene(){return hD||(hD=1,function(e,t){var a=Z7(),s=t&&!t.nodeType&&t,f=s&&!0&&e&&!e.nodeType&&e,v=f&&f.exports===s,S=v&&a.process,i=function(){try{var O=f&&f.require&&f.require("util").types;return O||S&&S.binding&&S.binding("util")}catch{}}();e.exports=i}(Tv,Tv.exports)),Tv.exports}var dE,fD;function MB(){if(fD)return dE;fD=1;var e=Qte(),t=CB(),a=ene(),s=a&&a.isTypedArray,f=s?t(s):e;return dE=f,dE}var pE,dD;function tne(){if(dD)return pE;dD=1;var e=Yte(),t=e4(),a=pl(),s=AB(),f=t4(),v=MB(),S=Object.prototype,i=S.hasOwnProperty;function O(z,j){var F=a(z),G=!F&&t(z),Y=!F&&!G&&s(z),X=!F&&!G&&!Y&&v(z),K=F||G||Y||X,ne=K?e(z.length,String):[],se=ne.length;for(var ge in z)(j||i.call(z,ge))&&!(K&&(ge=="length"||Y&&(ge=="offset"||ge=="parent")||X&&(ge=="buffer"||ge=="byteLength"||ge=="byteOffset")||f(ge,se)))&&ne.push(ge);return ne}return pE=O,pE}var mE,pD;function nne(){if(pD)return mE;pD=1;var e=Object.prototype;function t(a){var s=a&&a.constructor,f=typeof s=="function"&&s.prototype||e;return a===f}return mE=t,mE}var _E,mD;function OB(){if(mD)return _E;mD=1;function e(t,a){return function(s){return t(a(s))}}return _E=e,_E}var gE,_D;function rne(){if(_D)return gE;_D=1;var e=OB(),t=e(Object.keys,Object);return gE=t,gE}var yE,gD;function ine(){if(gD)return yE;gD=1;var e=nne(),t=rne(),a=Object.prototype,s=a.hasOwnProperty;function f(v){if(!e(v))return t(v);var S=[];for(var i in Object(v))s.call(v,i)&&i!="constructor"&&S.push(i);return S}return yE=f,yE}var vE,yD;function L1(){if(yD)return vE;yD=1;var e=j5(),t=n4();function a(s){return s!=null&&t(s.length)&&!e(s)}return vE=a,vE}var xE,vD;function cw(){if(vD)return xE;vD=1;var e=tne(),t=ine(),a=L1();function s(f){return a(f)?e(f):t(f)}return xE=s,xE}var bE,xD;function ane(){if(xD)return bE;xD=1;var e=Hte(),t=Xte(),a=cw();function s(f){return e(f,a,t)}return bE=s,bE}var wE,bD;function one(){if(bD)return wE;bD=1;var e=ane(),t=1,a=Object.prototype,s=a.hasOwnProperty;function f(v,S,i,O,z,j){var F=i&t,G=e(v),Y=G.length,X=e(S),K=X.length;if(Y!=K&&!F)return!1;for(var ne=Y;ne--;){var se=G[ne];if(!(F?se in S:s.call(S,se)))return!1}var ge=j.get(v),_e=j.get(S);if(ge&&_e)return ge==S&&_e==v;var xe=!0;j.set(v,S),j.set(S,v);for(var ae=F;++ne<Y;){se=G[ne];var ve=v[se],Se=S[se];if(O)var He=F?O(Se,ve,se,S,v,j):O(ve,Se,se,v,S,j);if(!(He===void 0?ve===Se||z(ve,Se,i,O,j):He)){xe=!1;break}ae||(ae=se=="constructor")}if(xe&&!ae){var Ge=v.constructor,ye=S.constructor;Ge!=ye&&"constructor"in v&&"constructor"in S&&!(typeof Ge=="function"&&Ge instanceof Ge&&typeof ye=="function"&&ye instanceof ye)&&(xe=!1)}return j.delete(v),j.delete(S),xe}return wE=f,wE}var SE,wD;function sne(){if(wD)return SE;wD=1;var e=S0(),t=of(),a=e(t,"DataView");return SE=a,SE}var TE,SD;function lne(){if(SD)return TE;SD=1;var e=S0(),t=of(),a=e(t,"Promise");return TE=a,TE}var EE,TD;function IB(){if(TD)return EE;TD=1;var e=S0(),t=of(),a=e(t,"Set");return EE=a,EE}var AE,ED;function cne(){if(ED)return AE;ED=1;var e=S0(),t=of(),a=e(t,"WeakMap");return AE=a,AE}var CE,AD;function une(){if(AD)return CE;AD=1;var e=sne(),t=V5(),a=lne(),s=IB(),f=cne(),v=Rd(),S=W7(),i="[object Map]",O="[object Object]",z="[object Promise]",j="[object Set]",F="[object WeakMap]",G="[object DataView]",Y=S(e),X=S(t),K=S(a),ne=S(s),se=S(f),ge=v;return(e&&ge(new e(new ArrayBuffer(1)))!=G||t&&ge(new t)!=i||a&&ge(a.resolve())!=z||s&&ge(new s)!=j||f&&ge(new f)!=F)&&(ge=function(_e){var xe=v(_e),ae=xe==O?_e.constructor:void 0,ve=ae?S(ae):"";if(ve)switch(ve){case Y:return G;case X:return i;case K:return z;case ne:return j;case se:return F}return xe}),CE=ge,CE}var ME,CD;function hne(){if(CD)return ME;CD=1;var e=xB(),t=TB(),a=Gte(),s=one(),f=une(),v=pl(),S=AB(),i=MB(),O=1,z="[object Arguments]",j="[object Array]",F="[object Object]",G=Object.prototype,Y=G.hasOwnProperty;function X(K,ne,se,ge,_e,xe){var ae=v(K),ve=v(ne),Se=ae?j:f(K),He=ve?j:f(ne);Se=Se==z?F:Se,He=He==z?F:He;var Ge=Se==F,ye=He==F,Le=Se==He;if(Le&&S(K)){if(!S(ne))return!1;ae=!0,Ge=!1}if(Le&&!Ge)return xe||(xe=new e),ae||i(K)?t(K,ne,se,ge,_e,xe):a(K,ne,Se,se,ge,_e,xe);if(!(se&O)){var ht=Ge&&Y.call(K,"__wrapped__"),gt=ye&&Y.call(ne,"__wrapped__");if(ht||gt){var Ft=ht?K.value():K,_t=gt?ne.value():ne;return xe||(xe=new e),_e(Ft,_t,se,ge,xe)}}return Le?(xe||(xe=new e),s(K,ne,se,ge,_e,xe)):!1}return ME=X,ME}var OE,MD;function r4(){if(MD)return OE;MD=1;var e=hne(),t=Dd();function a(s,f,v,S,i){return s===f?!0:s==null||f==null||!t(s)&&!t(f)?s!==s&&f!==f:e(s,f,v,S,a,i)}return OE=a,OE}var IE,OD;function fne(){if(OD)return IE;OD=1;var e=xB(),t=r4(),a=1,s=2;function f(v,S,i,O){var z=i.length,j=z,F=!O;if(v==null)return!j;for(v=Object(v);z--;){var G=i[z];if(F&&G[2]?G[1]!==v[G[0]]:!(G[0]in v))return!1}for(;++z<j;){G=i[z];var Y=G[0],X=v[Y],K=G[1];if(F&&G[2]){if(X===void 0&&!(Y in v))return!1}else{var ne=new e;if(O)var se=O(X,K,Y,v,S,ne);if(!(se===void 0?t(K,X,a|s,O,ne):se))return!1}}return!0}return IE=f,IE}var PE,ID;function PB(){if(ID)return PE;ID=1;var e=Wp();function t(a){return a===a&&!e(a)}return PE=t,PE}var RE,PD;function dne(){if(PD)return RE;PD=1;var e=PB(),t=cw();function a(s){for(var f=t(s),v=f.length;v--;){var S=f[v],i=s[S];f[v]=[S,i,e(i)]}return f}return RE=a,RE}var DE,RD;function RB(){if(RD)return DE;RD=1;function e(t,a){return function(s){return s==null?!1:s[t]===a&&(a!==void 0||t in Object(s))}}return DE=e,DE}var LE,DD;function pne(){if(DD)return LE;DD=1;var e=fne(),t=dne(),a=RB();function s(f){var v=t(f);return v.length==1&&v[0][2]?a(v[0][0],v[0][1]):function(S){return S===f||e(S,f,v)}}return LE=s,LE}var zE,LD;function mne(){if(LD)return zE;LD=1;function e(t,a){return t!=null&&a in Object(t)}return zE=e,zE}var kE,zD;function _ne(){if(zD)return kE;zD=1;var e=K7(),t=e4(),a=pl(),s=t4(),f=n4(),v=nw();function S(i,O,z){O=e(O,i);for(var j=-1,F=O.length,G=!1;++j<F;){var Y=v(O[j]);if(!(G=i!=null&&z(i,Y)))break;i=i[Y]}return G||++j!=F?G:(F=i==null?0:i.length,!!F&&f(F)&&s(Y,F)&&(a(i)||t(i)))}return kE=S,kE}var BE,kD;function gne(){if(kD)return BE;kD=1;var e=mne(),t=_ne();function a(s,f){return s!=null&&t(s,f,e)}return BE=a,BE}var NE,BD;function yne(){if(BD)return NE;BD=1;var e=r4(),t=J7(),a=gne(),s=F5(),f=PB(),v=RB(),S=nw(),i=1,O=2;function z(j,F){return s(j)&&f(F)?v(S(j),F):function(G){var Y=t(G,j);return Y===void 0&&Y===F?a(G,j):e(F,Y,i|O)}}return NE=z,NE}var FE,ND;function Ug(){if(ND)return FE;ND=1;function e(t){return t}return FE=e,FE}var jE,FD;function vne(){if(FD)return jE;FD=1;function e(t){return function(a){return a==null?void 0:a[t]}}return jE=e,jE}var UE,jD;function xne(){if(jD)return UE;jD=1;var e=G5();function t(a){return function(s){return e(s,a)}}return UE=t,UE}var VE,UD;function bne(){if(UD)return VE;UD=1;var e=vne(),t=xne(),a=F5(),s=nw();function f(v){return a(v)?e(s(v)):t(v)}return VE=f,VE}var $E,VD;function sf(){if(VD)return $E;VD=1;var e=pne(),t=yne(),a=Ug(),s=pl(),f=bne();function v(S){return typeof S=="function"?S:S==null?a:typeof S=="object"?s(S)?t(S[0],S[1]):e(S):f(S)}return $E=v,$E}var qE,$D;function DB(){if($D)return qE;$D=1;function e(t,a,s,f){for(var v=t.length,S=s+(f?1:-1);f?S--:++S<v;)if(a(t[S],S,t))return S;return-1}return qE=e,qE}var GE,qD;function wne(){if(qD)return GE;qD=1;function e(t){return t!==t}return GE=e,GE}var HE,GD;function Sne(){if(GD)return HE;GD=1;function e(t,a,s){for(var f=s-1,v=t.length;++f<v;)if(t[f]===a)return f;return-1}return HE=e,HE}var ZE,HD;function Tne(){if(HD)return ZE;HD=1;var e=DB(),t=wne(),a=Sne();function s(f,v,S){return v===v?a(f,v,S):e(f,t,S)}return ZE=s,ZE}var WE,ZD;function Ene(){if(ZD)return WE;ZD=1;var e=Tne();function t(a,s){var f=a==null?0:a.length;return!!f&&e(a,s,0)>-1}return WE=t,WE}var XE,WD;function Ane(){if(WD)return XE;WD=1;function e(t,a,s){for(var f=-1,v=t==null?0:t.length;++f<v;)if(s(a,t[f]))return!0;return!1}return XE=e,XE}var YE,XD;function Cne(){if(XD)return YE;XD=1;function e(){}return YE=e,YE}var KE,YD;function Mne(){if(YD)return KE;YD=1;var e=IB(),t=Cne(),a=Q5(),s=1/0,f=e&&1/a(new e([,-0]))[1]==s?function(v){return new e(v)}:t;return KE=f,KE}var JE,KD;function One(){if(KD)return JE;KD=1;var e=bB(),t=Ene(),a=Ane(),s=SB(),f=Mne(),v=Q5(),S=200;function i(O,z,j){var F=-1,G=t,Y=O.length,X=!0,K=[],ne=K;if(j)X=!1,G=a;else if(Y>=S){var se=z?null:f(O);if(se)return v(se);X=!1,G=s,ne=new e}else ne=z?[]:K;e:for(;++F<Y;){var ge=O[F],_e=z?z(ge):ge;if(ge=j||ge!==0?ge:0,X&&_e===_e){for(var xe=ne.length;xe--;)if(ne[xe]===_e)continue e;z&&ne.push(_e),K.push(ge)}else G(ne,_e,j)||(ne!==K&&ne.push(_e),K.push(ge))}return K}return JE=i,JE}var QE,JD;function Ine(){if(JD)return QE;JD=1;var e=sf(),t=One();function a(s,f){return s&&s.length?t(s,e(f,2)):[]}return QE=a,QE}var Pne=Ine();const QD=Ei(Pne);function LB(e,t,a){return t===!0?QD(e,a):Vr(t)?QD(e,t):e}function mg(e){"@babel/helpers - typeof";return mg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mg(e)}var Rne=["ref"];function eL(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(f){return Object.getOwnPropertyDescriptor(e,f).enumerable})),a.push.apply(a,s)}return a}function fd(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?eL(Object(a),!0).forEach(function(s){uw(e,s,a[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):eL(Object(a)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(a,s))})}return e}function Dne(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tL(e,t){for(var a=0;a<t.length;a++){var s=t[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,kB(s.key),s)}}function Lne(e,t,a){return t&&tL(e.prototype,t),a&&tL(e,a),Object.defineProperty(e,"prototype",{writable:!1}),e}function zne(e,t,a){return t=Xx(t),kne(e,zB()?Reflect.construct(t,a||[],Xx(e).constructor):t.apply(e,a))}function kne(e,t){if(t&&(mg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Bne(e)}function Bne(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function zB(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(zB=function(){return!!e})()}function Xx(e){return Xx=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)},Xx(e)}function Nne(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&sM(e,t)}function sM(e,t){return sM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,f){return s.__proto__=f,s},sM(e,t)}function uw(e,t,a){return t=kB(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function kB(e){var t=Fne(e,"string");return mg(t)=="symbol"?t:t+""}function Fne(e,t){if(mg(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var s=a.call(e,t);if(mg(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function jne(e,t){if(e==null)return{};var a=Une(e,t),s,f;if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(e);for(f=0;f<v.length;f++)s=v[f],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(a[s]=e[s])}return a}function Une(e,t){if(e==null)return{};var a={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(t.indexOf(s)>=0)continue;a[s]=e[s]}return a}function Vne(e){return e.value}function $ne(e,t){if(Ot.isValidElement(e))return Ot.cloneElement(e,t);if(typeof e=="function")return Ot.createElement(e,t);t.ref;var a=jne(t,Rne);return Ot.createElement(J5,a)}var nL=1,ag=function(e){function t(){var a;Dne(this,t);for(var s=arguments.length,f=new Array(s),v=0;v<s;v++)f[v]=arguments[v];return a=zne(this,t,[].concat(f)),uw(a,"lastBoundingBox",{width:-1,height:-1}),a}return Nne(t,e),Lne(t,[{key:"componentDidMount",value:function(){this.updateBBox()}},{key:"componentDidUpdate",value:function(){this.updateBBox()}},{key:"getBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var s=this.wrapperNode.getBoundingClientRect();return s.height=this.wrapperNode.offsetHeight,s.width=this.wrapperNode.offsetWidth,s}return null}},{key:"updateBBox",value:function(){var s=this.props.onBBoxUpdate,f=this.getBBox();f?(Math.abs(f.width-this.lastBoundingBox.width)>nL||Math.abs(f.height-this.lastBoundingBox.height)>nL)&&(this.lastBoundingBox.width=f.width,this.lastBoundingBox.height=f.height,s&&s(f)):(this.lastBoundingBox.width!==-1||this.lastBoundingBox.height!==-1)&&(this.lastBoundingBox.width=-1,this.lastBoundingBox.height=-1,s&&s(null))}},{key:"getBBoxSnapshot",value:function(){return this.lastBoundingBox.width>=0&&this.lastBoundingBox.height>=0?fd({},this.lastBoundingBox):{width:0,height:0}}},{key:"getDefaultPosition",value:function(s){var f=this.props,v=f.layout,S=f.align,i=f.verticalAlign,O=f.margin,z=f.chartWidth,j=f.chartHeight,F,G;if(!s||(s.left===void 0||s.left===null)&&(s.right===void 0||s.right===null))if(S==="center"&&v==="vertical"){var Y=this.getBBoxSnapshot();F={left:((z||0)-Y.width)/2}}else F=S==="right"?{right:O&&O.right||0}:{left:O&&O.left||0};if(!s||(s.top===void 0||s.top===null)&&(s.bottom===void 0||s.bottom===null))if(i==="middle"){var X=this.getBBoxSnapshot();G={top:((j||0)-X.height)/2}}else G=i==="bottom"?{bottom:O&&O.bottom||0}:{top:O&&O.top||0};return fd(fd({},F),G)}},{key:"render",value:function(){var s=this,f=this.props,v=f.content,S=f.width,i=f.height,O=f.wrapperStyle,z=f.payloadUniqBy,j=f.payload,F=fd(fd({position:"absolute",width:S||"auto",height:i||"auto"},this.getDefaultPosition(O)),O);return Ot.createElement("div",{className:"recharts-legend-wrapper",style:F,ref:function(Y){s.wrapperNode=Y}},$ne(v,fd(fd({},this.props),{},{payload:LB(j,z,Vne)})))}}],[{key:"getWithHeight",value:function(s,f){var v=fd(fd({},this.defaultProps),s.props),S=v.layout;return S==="vertical"&&Nn(s.props.height)?{height:s.props.height}:S==="horizontal"?{width:s.props.width||f}:null}}])}(Me.PureComponent);uw(ag,"displayName","Legend");uw(ag,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"bottom"});var eA,rL;function qne(){if(rL)return eA;rL=1;var e=P1(),t=e4(),a=pl(),s=e?e.isConcatSpreadable:void 0;function f(v){return a(v)||t(v)||!!(s&&v&&v[s])}return eA=f,eA}var tA,iL;function BB(){if(iL)return tA;iL=1;var e=EB(),t=qne();function a(s,f,v,S,i){var O=-1,z=s.length;for(v||(v=t),i||(i=[]);++O<z;){var j=s[O];f>0&&v(j)?f>1?a(j,f-1,v,S,i):e(i,j):S||(i[i.length]=j)}return i}return tA=a,tA}var nA,aL;function Gne(){if(aL)return nA;aL=1;function e(t){return function(a,s,f){for(var v=-1,S=Object(a),i=f(a),O=i.length;O--;){var z=i[t?O:++v];if(s(S[z],z,S)===!1)break}return a}}return nA=e,nA}var rA,oL;function Hne(){if(oL)return rA;oL=1;var e=Gne(),t=e();return rA=t,rA}var iA,sL;function NB(){if(sL)return iA;sL=1;var e=Hne(),t=cw();function a(s,f){return s&&e(s,f,t)}return iA=a,iA}var aA,lL;function Zne(){if(lL)return aA;lL=1;var e=L1();function t(a,s){return function(f,v){if(f==null)return f;if(!e(f))return a(f,v);for(var S=f.length,i=s?S:-1,O=Object(f);(s?i--:++i<S)&&v(O[i],i,O)!==!1;);return f}}return aA=t,aA}var oA,cL;function i4(){if(cL)return oA;cL=1;var e=NB(),t=Zne(),a=t(e);return oA=a,oA}var sA,uL;function FB(){if(uL)return sA;uL=1;var e=i4(),t=L1();function a(s,f){var v=-1,S=t(s)?Array(s.length):[];return e(s,function(i,O,z){S[++v]=f(i,O,z)}),S}return sA=a,sA}var lA,hL;function Wne(){if(hL)return lA;hL=1;function e(t,a){var s=t.length;for(t.sort(a);s--;)t[s]=t[s].value;return t}return lA=e,lA}var cA,fL;function Xne(){if(fL)return cA;fL=1;var e=Fg();function t(a,s){if(a!==s){var f=a!==void 0,v=a===null,S=a===a,i=e(a),O=s!==void 0,z=s===null,j=s===s,F=e(s);if(!z&&!F&&!i&&a>s||i&&O&&j&&!z&&!F||v&&O&&j||!f&&j||!S)return 1;if(!v&&!i&&!F&&a<s||F&&f&&S&&!v&&!i||z&&f&&S||!O&&S||!j)return-1}return 0}return cA=t,cA}var uA,dL;function Yne(){if(dL)return uA;dL=1;var e=Xne();function t(a,s,f){for(var v=-1,S=a.criteria,i=s.criteria,O=S.length,z=f.length;++v<O;){var j=e(S[v],i[v]);if(j){if(v>=z)return j;var F=f[v];return j*(F=="desc"?-1:1)}}return a.index-s.index}return uA=t,uA}var hA,pL;function Kne(){if(pL)return hA;pL=1;var e=q5(),t=G5(),a=sf(),s=FB(),f=Wne(),v=CB(),S=Yne(),i=Ug(),O=pl();function z(j,F,G){F.length?F=e(F,function(K){return O(K)?function(ne){return t(ne,K.length===1?K[0]:K)}:K}):F=[i];var Y=-1;F=e(F,v(a));var X=s(j,function(K,ne,se){var ge=e(F,function(_e){return _e(K)});return{criteria:ge,index:++Y,value:K}});return f(X,function(K,ne){return S(K,ne,G)})}return hA=z,hA}var fA,mL;function Jne(){if(mL)return fA;mL=1;function e(t,a,s){switch(s.length){case 0:return t.call(a);case 1:return t.call(a,s[0]);case 2:return t.call(a,s[0],s[1]);case 3:return t.call(a,s[0],s[1],s[2])}return t.apply(a,s)}return fA=e,fA}var dA,_L;function Qne(){if(_L)return dA;_L=1;var e=Jne(),t=Math.max;function a(s,f,v){return f=t(f===void 0?s.length-1:f,0),function(){for(var S=arguments,i=-1,O=t(S.length-f,0),z=Array(O);++i<O;)z[i]=S[f+i];i=-1;for(var j=Array(f+1);++i<f;)j[i]=S[i];return j[f]=v(z),e(s,this,j)}}return dA=a,dA}var pA,gL;function ere(){if(gL)return pA;gL=1;function e(t){return function(){return t}}return pA=e,pA}var mA,yL;function jB(){if(yL)return mA;yL=1;var e=S0(),t=function(){try{var a=e(Object,"defineProperty");return a({},"",{}),a}catch{}}();return mA=t,mA}var _A,vL;function tre(){if(vL)return _A;vL=1;var e=ere(),t=jB(),a=Ug(),s=t?function(f,v){return t(f,"toString",{configurable:!0,enumerable:!1,value:e(v),writable:!0})}:a;return _A=s,_A}var gA,xL;function nre(){if(xL)return gA;xL=1;var e=800,t=16,a=Date.now;function s(f){var v=0,S=0;return function(){var i=a(),O=t-(i-S);if(S=i,O>0){if(++v>=e)return arguments[0]}else v=0;return f.apply(void 0,arguments)}}return gA=s,gA}var yA,bL;function rre(){if(bL)return yA;bL=1;var e=tre(),t=nre(),a=t(e);return yA=a,yA}var vA,wL;function ire(){if(wL)return vA;wL=1;var e=Ug(),t=Qne(),a=rre();function s(f,v){return a(t(f,v,e),f+"")}return vA=s,vA}var xA,SL;function hw(){if(SL)return xA;SL=1;var e=U5(),t=L1(),a=t4(),s=Wp();function f(v,S,i){if(!s(i))return!1;var O=typeof S;return(O=="number"?t(i)&&a(S,i.length):O=="string"&&S in i)?e(i[S],v):!1}return xA=f,xA}var bA,TL;function are(){if(TL)return bA;TL=1;var e=BB(),t=Kne(),a=ire(),s=hw(),f=a(function(v,S){if(v==null)return[];var i=S.length;return i>1&&s(v,S[0],S[1])?S=[]:i>2&&s(S[0],S[1],S[2])&&(S=[S[0]]),t(v,e(S,1),[])});return bA=f,bA}var ore=are();const a4=Ei(ore);function Hv(e){"@babel/helpers - typeof";return Hv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hv(e)}function lM(){return lM=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},lM.apply(this,arguments)}function sre(e,t){return hre(e)||ure(e,t)||cre(e,t)||lre()}function lre(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function cre(e,t){if(e){if(typeof e=="string")return EL(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return EL(e,t)}}function EL(e,t){(t==null||t>e.length)&&(t=e.length);for(var a=0,s=new Array(t);a<t;a++)s[a]=e[a];return s}function ure(e,t){var a=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(a!=null){var s,f,v,S,i=[],O=!0,z=!1;try{if(v=(a=a.call(e)).next,t!==0)for(;!(O=(s=v.call(a)).done)&&(i.push(s.value),i.length!==t);O=!0);}catch(j){z=!0,f=j}finally{try{if(!O&&a.return!=null&&(S=a.return(),Object(S)!==S))return}finally{if(z)throw f}}return i}}function hre(e){if(Array.isArray(e))return e}function AL(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(f){return Object.getOwnPropertyDescriptor(e,f).enumerable})),a.push.apply(a,s)}return a}function wA(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?AL(Object(a),!0).forEach(function(s){fre(e,s,a[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):AL(Object(a)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(a,s))})}return e}function fre(e,t,a){return t=dre(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function dre(e){var t=pre(e,"string");return Hv(t)=="symbol"?t:t+""}function pre(e,t){if(Hv(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var s=a.call(e,t);if(Hv(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function mre(e){return Array.isArray(e)&&go(e[0])&&go(e[1])?e.join(" ~ "):e}var _re=function(t){var a=t.separator,s=a===void 0?" : ":a,f=t.contentStyle,v=f===void 0?{}:f,S=t.itemStyle,i=S===void 0?{}:S,O=t.labelStyle,z=O===void 0?{}:O,j=t.payload,F=t.formatter,G=t.itemSorter,Y=t.wrapperClassName,X=t.labelClassName,K=t.label,ne=t.labelFormatter,se=t.accessibilityLayer,ge=se===void 0?!1:se,_e=function(){if(j&&j.length){var ht={padding:0,margin:0},gt=(G?a4(j,G):j).map(function(Ft,_t){if(Ft.type==="none")return null;var yt=wA({display:"block",paddingTop:4,paddingBottom:4,color:Ft.color||"#000"},i),Vt=Ft.formatter||F||mre,Ht=Ft.value,Bt=Ft.name,et=Ht,$t=Bt;if(Vt&&et!=null&&$t!=null){var rn=Vt(Ht,Bt,Ft,_t,j);if(Array.isArray(rn)){var Nt=sre(rn,2);et=Nt[0],$t=Nt[1]}else et=rn}return Ot.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(_t),style:yt},go($t)?Ot.createElement("span",{className:"recharts-tooltip-item-name"},$t):null,go($t)?Ot.createElement("span",{className:"recharts-tooltip-item-separator"},s):null,Ot.createElement("span",{className:"recharts-tooltip-item-value"},et),Ot.createElement("span",{className:"recharts-tooltip-item-unit"},Ft.unit||""))});return Ot.createElement("ul",{className:"recharts-tooltip-item-list",style:ht},gt)}return null},xe=wA({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},v),ae=wA({margin:0},z),ve=!ei(K),Se=ve?K:"",He=oi("recharts-default-tooltip",Y),Ge=oi("recharts-tooltip-label",X);ve&&ne&&j!==void 0&&j!==null&&(Se=ne(K,j));var ye=ge?{role:"status","aria-live":"assertive"}:{};return Ot.createElement("div",lM({className:He,style:xe},ye),Ot.createElement("p",{className:Ge,style:ae},Ot.isValidElement(Se)?Se:"".concat(Se)),_e())};function Zv(e){"@babel/helpers - typeof";return Zv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zv(e)}function lx(e,t,a){return t=gre(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function gre(e){var t=yre(e,"string");return Zv(t)=="symbol"?t:t+""}function yre(e,t){if(Zv(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var s=a.call(e,t);if(Zv(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ov="recharts-tooltip-wrapper",vre={visibility:"hidden"};function xre(e){var t=e.coordinate,a=e.translateX,s=e.translateY;return oi(ov,lx(lx(lx(lx({},"".concat(ov,"-right"),Nn(a)&&t&&Nn(t.x)&&a>=t.x),"".concat(ov,"-left"),Nn(a)&&t&&Nn(t.x)&&a<t.x),"".concat(ov,"-bottom"),Nn(s)&&t&&Nn(t.y)&&s>=t.y),"".concat(ov,"-top"),Nn(s)&&t&&Nn(t.y)&&s<t.y))}function CL(e){var t=e.allowEscapeViewBox,a=e.coordinate,s=e.key,f=e.offsetTopLeft,v=e.position,S=e.reverseDirection,i=e.tooltipDimension,O=e.viewBox,z=e.viewBoxDimension;if(v&&Nn(v[s]))return v[s];var j=a[s]-i-f,F=a[s]+f;if(t[s])return S[s]?j:F;if(S[s]){var G=j,Y=O[s];return G<Y?Math.max(F,O[s]):Math.max(j,O[s])}var X=F+i,K=O[s]+z;return X>K?Math.max(j,O[s]):Math.max(F,O[s])}function bre(e){var t=e.translateX,a=e.translateY,s=e.useTranslate3d;return{transform:s?"translate3d(".concat(t,"px, ").concat(a,"px, 0)"):"translate(".concat(t,"px, ").concat(a,"px)")}}function wre(e){var t=e.allowEscapeViewBox,a=e.coordinate,s=e.offsetTopLeft,f=e.position,v=e.reverseDirection,S=e.tooltipBox,i=e.useTranslate3d,O=e.viewBox,z,j,F;return S.height>0&&S.width>0&&a?(j=CL({allowEscapeViewBox:t,coordinate:a,key:"x",offsetTopLeft:s,position:f,reverseDirection:v,tooltipDimension:S.width,viewBox:O,viewBoxDimension:O.width}),F=CL({allowEscapeViewBox:t,coordinate:a,key:"y",offsetTopLeft:s,position:f,reverseDirection:v,tooltipDimension:S.height,viewBox:O,viewBoxDimension:O.height}),z=bre({translateX:j,translateY:F,useTranslate3d:i})):z=vre,{cssProperties:z,cssClasses:xre({translateX:j,translateY:F,coordinate:a})}}function _g(e){"@babel/helpers - typeof";return _g=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_g(e)}function ML(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(f){return Object.getOwnPropertyDescriptor(e,f).enumerable})),a.push.apply(a,s)}return a}function OL(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?ML(Object(a),!0).forEach(function(s){uM(e,s,a[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ML(Object(a)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(a,s))})}return e}function Sre(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Tre(e,t){for(var a=0;a<t.length;a++){var s=t[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,VB(s.key),s)}}function Ere(e,t,a){return t&&Tre(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Are(e,t,a){return t=Yx(t),Cre(e,UB()?Reflect.construct(t,a||[],Yx(e).constructor):t.apply(e,a))}function Cre(e,t){if(t&&(_g(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Mre(e)}function Mre(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function UB(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(UB=function(){return!!e})()}function Yx(e){return Yx=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)},Yx(e)}function Ore(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&cM(e,t)}function cM(e,t){return cM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,f){return s.__proto__=f,s},cM(e,t)}function uM(e,t,a){return t=VB(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function VB(e){var t=Ire(e,"string");return _g(t)=="symbol"?t:t+""}function Ire(e,t){if(_g(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var s=a.call(e,t);if(_g(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var IL=1,Pre=function(e){function t(){var a;Sre(this,t);for(var s=arguments.length,f=new Array(s),v=0;v<s;v++)f[v]=arguments[v];return a=Are(this,t,[].concat(f)),uM(a,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0},lastBoundingBox:{width:-1,height:-1}}),uM(a,"handleKeyDown",function(S){if(S.key==="Escape"){var i,O,z,j;a.setState({dismissed:!0,dismissedAtCoordinate:{x:(i=(O=a.props.coordinate)===null||O===void 0?void 0:O.x)!==null&&i!==void 0?i:0,y:(z=(j=a.props.coordinate)===null||j===void 0?void 0:j.y)!==null&&z!==void 0?z:0}})}}),a}return Ore(t,e),Ere(t,[{key:"updateBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var s=this.wrapperNode.getBoundingClientRect();(Math.abs(s.width-this.state.lastBoundingBox.width)>IL||Math.abs(s.height-this.state.lastBoundingBox.height)>IL)&&this.setState({lastBoundingBox:{width:s.width,height:s.height}})}else(this.state.lastBoundingBox.width!==-1||this.state.lastBoundingBox.height!==-1)&&this.setState({lastBoundingBox:{width:-1,height:-1}})}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown),this.updateBBox()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(){var s,f;this.props.active&&this.updateBBox(),this.state.dismissed&&(((s=this.props.coordinate)===null||s===void 0?void 0:s.x)!==this.state.dismissedAtCoordinate.x||((f=this.props.coordinate)===null||f===void 0?void 0:f.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}},{key:"render",value:function(){var s=this,f=this.props,v=f.active,S=f.allowEscapeViewBox,i=f.animationDuration,O=f.animationEasing,z=f.children,j=f.coordinate,F=f.hasPayload,G=f.isAnimationActive,Y=f.offset,X=f.position,K=f.reverseDirection,ne=f.useTranslate3d,se=f.viewBox,ge=f.wrapperStyle,_e=wre({allowEscapeViewBox:S,coordinate:j,offsetTopLeft:Y,position:X,reverseDirection:K,tooltipBox:this.state.lastBoundingBox,useTranslate3d:ne,viewBox:se}),xe=_e.cssClasses,ae=_e.cssProperties,ve=OL(OL({transition:G&&v?"transform ".concat(i,"ms ").concat(O):void 0},ae),{},{pointerEvents:"none",visibility:!this.state.dismissed&&v&&F?"visible":"hidden",position:"absolute",top:0,left:0},ge);return Ot.createElement("div",{tabIndex:-1,className:xe,style:ve,ref:function(He){s.wrapperNode=He}},z)}}])}(Me.PureComponent),Rre=function(){return!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout)},fw={isSsr:Rre()};function gg(e){"@babel/helpers - typeof";return gg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gg(e)}function PL(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(f){return Object.getOwnPropertyDescriptor(e,f).enumerable})),a.push.apply(a,s)}return a}function RL(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?PL(Object(a),!0).forEach(function(s){o4(e,s,a[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):PL(Object(a)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(a,s))})}return e}function Dre(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Lre(e,t){for(var a=0;a<t.length;a++){var s=t[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,qB(s.key),s)}}function zre(e,t,a){return t&&Lre(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function kre(e,t,a){return t=Kx(t),Bre(e,$B()?Reflect.construct(t,a||[],Kx(e).constructor):t.apply(e,a))}function Bre(e,t){if(t&&(gg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Nre(e)}function Nre(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function $B(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return($B=function(){return!!e})()}function Kx(e){return Kx=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)},Kx(e)}function Fre(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&hM(e,t)}function hM(e,t){return hM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,f){return s.__proto__=f,s},hM(e,t)}function o4(e,t,a){return t=qB(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function qB(e){var t=jre(e,"string");return gg(t)=="symbol"?t:t+""}function jre(e,t){if(gg(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var s=a.call(e,t);if(gg(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function Ure(e){return e.dataKey}function Vre(e,t){return Ot.isValidElement(e)?Ot.cloneElement(e,t):typeof e=="function"?Ot.createElement(e,t):Ot.createElement(_re,t)}var dd=function(e){function t(){return Dre(this,t),kre(this,t,arguments)}return Fre(t,e),zre(t,[{key:"render",value:function(){var s=this,f=this.props,v=f.active,S=f.allowEscapeViewBox,i=f.animationDuration,O=f.animationEasing,z=f.content,j=f.coordinate,F=f.filterNull,G=f.isAnimationActive,Y=f.offset,X=f.payload,K=f.payloadUniqBy,ne=f.position,se=f.reverseDirection,ge=f.useTranslate3d,_e=f.viewBox,xe=f.wrapperStyle,ae=X??[];F&&ae.length&&(ae=LB(X.filter(function(Se){return Se.value!=null&&(Se.hide!==!0||s.props.includeHidden)}),K,Ure));var ve=ae.length>0;return Ot.createElement(Pre,{allowEscapeViewBox:S,animationDuration:i,animationEasing:O,isAnimationActive:G,active:v,coordinate:j,hasPayload:ve,offset:Y,position:ne,reverseDirection:se,useTranslate3d:ge,viewBox:_e,wrapperStyle:xe},Vre(z,RL(RL({},this.props),{},{payload:ae})))}}])}(Me.PureComponent);o4(dd,"displayName","Tooltip");o4(dd,"defaultProps",{accessibilityLayer:!1,allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",contentStyle:{},coordinate:{x:0,y:0},cursor:!0,cursorStyle:{},filterNull:!0,isAnimationActive:!fw.isSsr,itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,viewBox:{x:0,y:0,height:0,width:0},wrapperStyle:{}});var SA,DL;function $re(){if(DL)return SA;DL=1;var e=of(),t=function(){return e.Date.now()};return SA=t,SA}var TA,LL;function qre(){if(LL)return TA;LL=1;var e=/\s/;function t(a){for(var s=a.length;s--&&e.test(a.charAt(s)););return s}return TA=t,TA}var EA,zL;function Gre(){if(zL)return EA;zL=1;var e=qre(),t=/^\s+/;function a(s){return s&&s.slice(0,e(s)+1).replace(t,"")}return EA=a,EA}var AA,kL;function GB(){if(kL)return AA;kL=1;var e=Gre(),t=Wp(),a=Fg(),s=NaN,f=/^[-+]0x[0-9a-f]+$/i,v=/^0b[01]+$/i,S=/^0o[0-7]+$/i,i=parseInt;function O(z){if(typeof z=="number")return z;if(a(z))return s;if(t(z)){var j=typeof z.valueOf=="function"?z.valueOf():z;z=t(j)?j+"":j}if(typeof z!="string")return z===0?z:+z;z=e(z);var F=v.test(z);return F||S.test(z)?i(z.slice(2),F?2:8):f.test(z)?s:+z}return AA=O,AA}var CA,BL;function Hre(){if(BL)return CA;BL=1;var e=Wp(),t=$re(),a=GB(),s="Expected a function",f=Math.max,v=Math.min;function S(i,O,z){var j,F,G,Y,X,K,ne=0,se=!1,ge=!1,_e=!0;if(typeof i!="function")throw new TypeError(s);O=a(O)||0,e(z)&&(se=!!z.leading,ge="maxWait"in z,G=ge?f(a(z.maxWait)||0,O):G,_e="trailing"in z?!!z.trailing:_e);function xe(gt){var Ft=j,_t=F;return j=F=void 0,ne=gt,Y=i.apply(_t,Ft),Y}function ae(gt){return ne=gt,X=setTimeout(He,O),se?xe(gt):Y}function ve(gt){var Ft=gt-K,_t=gt-ne,yt=O-Ft;return ge?v(yt,G-_t):yt}function Se(gt){var Ft=gt-K,_t=gt-ne;return K===void 0||Ft>=O||Ft<0||ge&&_t>=G}function He(){var gt=t();if(Se(gt))return Ge(gt);X=setTimeout(He,ve(gt))}function Ge(gt){return X=void 0,_e&&j?xe(gt):(j=F=void 0,Y)}function ye(){X!==void 0&&clearTimeout(X),ne=0,j=K=F=X=void 0}function Le(){return X===void 0?Y:Ge(t())}function ht(){var gt=t(),Ft=Se(gt);if(j=arguments,F=this,K=gt,Ft){if(X===void 0)return ae(K);if(ge)return clearTimeout(X),X=setTimeout(He,O),xe(K)}return X===void 0&&(X=setTimeout(He,O)),Y}return ht.cancel=ye,ht.flush=Le,ht}return CA=S,CA}var MA,NL;function Zre(){if(NL)return MA;NL=1;var e=Hre(),t=Wp(),a="Expected a function";function s(f,v,S){var i=!0,O=!0;if(typeof f!="function")throw new TypeError(a);return t(S)&&(i="leading"in S?!!S.leading:i,O="trailing"in S?!!S.trailing:O),e(f,v,{leading:i,maxWait:v,trailing:O})}return MA=s,MA}var Wre=Zre();const HB=Ei(Wre);function Wv(e){"@babel/helpers - typeof";return Wv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wv(e)}function FL(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(f){return Object.getOwnPropertyDescriptor(e,f).enumerable})),a.push.apply(a,s)}return a}function cx(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?FL(Object(a),!0).forEach(function(s){Xre(e,s,a[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):FL(Object(a)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(a,s))})}return e}function Xre(e,t,a){return t=Yre(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Yre(e){var t=Kre(e,"string");return Wv(t)=="symbol"?t:t+""}function Kre(e,t){if(Wv(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var s=a.call(e,t);if(Wv(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Jre(e,t){return nie(e)||tie(e,t)||eie(e,t)||Qre()}function Qre(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function eie(e,t){if(e){if(typeof e=="string")return jL(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return jL(e,t)}}function jL(e,t){(t==null||t>e.length)&&(t=e.length);for(var a=0,s=new Array(t);a<t;a++)s[a]=e[a];return s}function tie(e,t){var a=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(a!=null){var s,f,v,S,i=[],O=!0,z=!1;try{if(v=(a=a.call(e)).next,t!==0)for(;!(O=(s=v.call(a)).done)&&(i.push(s.value),i.length!==t);O=!0);}catch(j){z=!0,f=j}finally{try{if(!O&&a.return!=null&&(S=a.return(),Object(S)!==S))return}finally{if(z)throw f}}return i}}function nie(e){if(Array.isArray(e))return e}var rie=Me.forwardRef(function(e,t){var a=e.aspect,s=e.initialDimension,f=s===void 0?{width:-1,height:-1}:s,v=e.width,S=v===void 0?"100%":v,i=e.height,O=i===void 0?"100%":i,z=e.minWidth,j=z===void 0?0:z,F=e.minHeight,G=e.maxHeight,Y=e.children,X=e.debounce,K=X===void 0?0:X,ne=e.id,se=e.className,ge=e.onResize,_e=e.style,xe=_e===void 0?{}:_e,ae=Me.useRef(null),ve=Me.useRef();ve.current=ge,Me.useImperativeHandle(t,function(){return Object.defineProperty(ae.current,"current",{get:function(){return console.warn("The usage of ref.current.current is deprecated and will no longer be supported."),ae.current},configurable:!0})});var Se=Me.useState({containerWidth:f.width,containerHeight:f.height}),He=Jre(Se,2),Ge=He[0],ye=He[1],Le=Me.useCallback(function(gt,Ft){ye(function(_t){var yt=Math.round(gt),Vt=Math.round(Ft);return _t.containerWidth===yt&&_t.containerHeight===Vt?_t:{containerWidth:yt,containerHeight:Vt}})},[]);Me.useEffect(function(){var gt=function(Bt){var et,$t=Bt[0].contentRect,rn=$t.width,Nt=$t.height;Le(rn,Nt),(et=ve.current)===null||et===void 0||et.call(ve,rn,Nt)};K>0&&(gt=HB(gt,K,{trailing:!0,leading:!1}));var Ft=new ResizeObserver(gt),_t=ae.current.getBoundingClientRect(),yt=_t.width,Vt=_t.height;return Le(yt,Vt),Ft.observe(ae.current),function(){Ft.disconnect()}},[Le,K]);var ht=Me.useMemo(function(){var gt=Ge.containerWidth,Ft=Ge.containerHeight;if(gt<0||Ft<0)return null;wd(d0(S)||d0(O),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,S,O),wd(!a||a>0,"The aspect(%s) must be greater than zero.",a);var _t=d0(S)?gt:S,yt=d0(O)?Ft:O;a&&a>0&&(_t?yt=_t/a:yt&&(_t=yt*a),G&&yt>G&&(yt=G)),wd(_t>0||yt>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,_t,yt,S,O,j,F,a);var Vt=!Array.isArray(Y)&&bd(Y.type).endsWith("Chart");return Ot.Children.map(Y,function(Ht){return Ot.isValidElement(Ht)?Me.cloneElement(Ht,cx({width:_t,height:yt},Vt?{style:cx({height:"100%",width:"100%",maxHeight:yt,maxWidth:_t},Ht.props.style)}:{})):Ht})},[a,Y,O,G,F,j,Ge,S]);return Ot.createElement("div",{id:ne?"".concat(ne):void 0,className:oi("recharts-responsive-container",se),style:cx(cx({},xe),{},{width:S,height:O,minWidth:j,minHeight:F,maxHeight:G}),ref:ae},ht)}),ZB=function(t){return null};ZB.displayName="Cell";function Xv(e){"@babel/helpers - typeof";return Xv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xv(e)}function UL(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(f){return Object.getOwnPropertyDescriptor(e,f).enumerable})),a.push.apply(a,s)}return a}function fM(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?UL(Object(a),!0).forEach(function(s){iie(e,s,a[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):UL(Object(a)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(a,s))})}return e}function iie(e,t,a){return t=aie(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function aie(e){var t=oie(e,"string");return Xv(t)=="symbol"?t:t+""}function oie(e,t){if(Xv(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var s=a.call(e,t);if(Xv(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var q_={widthCache:{},cacheCount:0},sie=2e3,lie={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},VL="recharts_measurement_span";function cie(e){var t=fM({},e);return Object.keys(t).forEach(function(a){t[a]||delete t[a]}),t}var $L=function(t){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||fw.isSsr)return{width:0,height:0};var s=cie(a),f=JSON.stringify({text:t,copyStyle:s});if(q_.widthCache[f])return q_.widthCache[f];try{var v=document.getElementById(VL);v||(v=document.createElement("span"),v.setAttribute("id",VL),v.setAttribute("aria-hidden","true"),document.body.appendChild(v));var S=fM(fM({},lie),s);Object.assign(v.style,S),v.textContent="".concat(t);var i=v.getBoundingClientRect(),O={width:i.width,height:i.height};return q_.widthCache[f]=O,++q_.cacheCount>sie&&(q_.cacheCount=0,q_.widthCache={}),O}catch{return{width:0,height:0}}},uie=function(t){return{top:t.top+window.scrollY-document.documentElement.clientTop,left:t.left+window.scrollX-document.documentElement.clientLeft}};function Yv(e){"@babel/helpers - typeof";return Yv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yv(e)}function Jx(e,t){return pie(e)||die(e,t)||fie(e,t)||hie()}function hie(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function fie(e,t){if(e){if(typeof e=="string")return qL(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return qL(e,t)}}function qL(e,t){(t==null||t>e.length)&&(t=e.length);for(var a=0,s=new Array(t);a<t;a++)s[a]=e[a];return s}function die(e,t){var a=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(a!=null){var s,f,v,S,i=[],O=!0,z=!1;try{if(v=(a=a.call(e)).next,t===0){if(Object(a)!==a)return;O=!1}else for(;!(O=(s=v.call(a)).done)&&(i.push(s.value),i.length!==t);O=!0);}catch(j){z=!0,f=j}finally{try{if(!O&&a.return!=null&&(S=a.return(),Object(S)!==S))return}finally{if(z)throw f}}return i}}function pie(e){if(Array.isArray(e))return e}function mie(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function GL(e,t){for(var a=0;a<t.length;a++){var s=t[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,gie(s.key),s)}}function _ie(e,t,a){return t&&GL(e.prototype,t),a&&GL(e,a),Object.defineProperty(e,"prototype",{writable:!1}),e}function gie(e){var t=yie(e,"string");return Yv(t)=="symbol"?t:t+""}function yie(e,t){if(Yv(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var s=a.call(e,t);if(Yv(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var HL=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,ZL=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,vie=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,xie=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,WB={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},bie=Object.keys(WB),Q_="NaN";function wie(e,t){return e*WB[t]}var ux=function(){function e(t,a){mie(this,e),this.num=t,this.unit=a,this.num=t,this.unit=a,Number.isNaN(t)&&(this.unit=""),a!==""&&!vie.test(a)&&(this.num=NaN,this.unit=""),bie.includes(a)&&(this.num=wie(t,a),this.unit="px")}return _ie(e,[{key:"add",value:function(a){return this.unit!==a.unit?new e(NaN,""):new e(this.num+a.num,this.unit)}},{key:"subtract",value:function(a){return this.unit!==a.unit?new e(NaN,""):new e(this.num-a.num,this.unit)}},{key:"multiply",value:function(a){return this.unit!==""&&a.unit!==""&&this.unit!==a.unit?new e(NaN,""):new e(this.num*a.num,this.unit||a.unit)}},{key:"divide",value:function(a){return this.unit!==""&&a.unit!==""&&this.unit!==a.unit?new e(NaN,""):new e(this.num/a.num,this.unit||a.unit)}},{key:"toString",value:function(){return"".concat(this.num).concat(this.unit)}},{key:"isNaN",value:function(){return Number.isNaN(this.num)}}],[{key:"parse",value:function(a){var s,f=(s=xie.exec(a))!==null&&s!==void 0?s:[],v=Jx(f,3),S=v[1],i=v[2];return new e(parseFloat(S),i??"")}}])}();function XB(e){if(e.includes(Q_))return Q_;for(var t=e;t.includes("*")||t.includes("/");){var a,s=(a=HL.exec(t))!==null&&a!==void 0?a:[],f=Jx(s,4),v=f[1],S=f[2],i=f[3],O=ux.parse(v??""),z=ux.parse(i??""),j=S==="*"?O.multiply(z):O.divide(z);if(j.isNaN())return Q_;t=t.replace(HL,j.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var F,G=(F=ZL.exec(t))!==null&&F!==void 0?F:[],Y=Jx(G,4),X=Y[1],K=Y[2],ne=Y[3],se=ux.parse(X??""),ge=ux.parse(ne??""),_e=K==="+"?se.add(ge):se.subtract(ge);if(_e.isNaN())return Q_;t=t.replace(ZL,_e.toString())}return t}var WL=/\(([^()]*)\)/;function Sie(e){for(var t=e;t.includes("(");){var a=WL.exec(t),s=Jx(a,2),f=s[1];t=t.replace(WL,XB(f))}return t}function Tie(e){var t=e.replace(/\s+/g,"");return t=Sie(t),t=XB(t),t}function Eie(e){try{return Tie(e)}catch{return Q_}}function OA(e){var t=Eie(e.slice(5,-1));return t===Q_?"":t}var Aie=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],Cie=["dx","dy","angle","className","breakAll"];function dM(){return dM=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},dM.apply(this,arguments)}function XL(e,t){if(e==null)return{};var a=Mie(e,t),s,f;if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(e);for(f=0;f<v.length;f++)s=v[f],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(a[s]=e[s])}return a}function Mie(e,t){if(e==null)return{};var a={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(t.indexOf(s)>=0)continue;a[s]=e[s]}return a}function YL(e,t){return Rie(e)||Pie(e,t)||Iie(e,t)||Oie()}function Oie(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Iie(e,t){if(e){if(typeof e=="string")return KL(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return KL(e,t)}}function KL(e,t){(t==null||t>e.length)&&(t=e.length);for(var a=0,s=new Array(t);a<t;a++)s[a]=e[a];return s}function Pie(e,t){var a=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(a!=null){var s,f,v,S,i=[],O=!0,z=!1;try{if(v=(a=a.call(e)).next,t===0){if(Object(a)!==a)return;O=!1}else for(;!(O=(s=v.call(a)).done)&&(i.push(s.value),i.length!==t);O=!0);}catch(j){z=!0,f=j}finally{try{if(!O&&a.return!=null&&(S=a.return(),Object(S)!==S))return}finally{if(z)throw f}}return i}}function Rie(e){if(Array.isArray(e))return e}var YB=/[ \f\n\r\t\v\u2028\u2029]+/,KB=function(t){var a=t.children,s=t.breakAll,f=t.style;try{var v=[];ei(a)||(s?v=a.toString().split(""):v=a.toString().split(YB));var S=v.map(function(O){return{word:O,width:$L(O,f).width}}),i=s?0:$L(" ",f).width;return{wordsWithComputedWidth:S,spaceWidth:i}}catch{return null}},Die=function(t,a,s,f,v){var S=t.maxLines,i=t.children,O=t.style,z=t.breakAll,j=Nn(S),F=i,G=function(){var _t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return _t.reduce(function(yt,Vt){var Ht=Vt.word,Bt=Vt.width,et=yt[yt.length-1];if(et&&(f==null||v||et.width+Bt+s<Number(f)))et.words.push(Ht),et.width+=Bt+s;else{var $t={words:[Ht],width:Bt};yt.push($t)}return yt},[])},Y=G(a),X=function(_t){return _t.reduce(function(yt,Vt){return yt.width>Vt.width?yt:Vt})};if(!j)return Y;for(var K="…",ne=function(_t){var yt=F.slice(0,_t),Vt=KB({breakAll:z,style:O,children:yt+K}).wordsWithComputedWidth,Ht=G(Vt),Bt=Ht.length>S||X(Ht).width>Number(f);return[Bt,Ht]},se=0,ge=F.length-1,_e=0,xe;se<=ge&&_e<=F.length-1;){var ae=Math.floor((se+ge)/2),ve=ae-1,Se=ne(ve),He=YL(Se,2),Ge=He[0],ye=He[1],Le=ne(ae),ht=YL(Le,1),gt=ht[0];if(!Ge&&!gt&&(se=ae+1),Ge&&gt&&(ge=ae-1),!Ge&&gt){xe=ye;break}_e++}return xe||Y},JL=function(t){var a=ei(t)?[]:t.toString().split(YB);return[{words:a}]},Lie=function(t){var a=t.width,s=t.scaleToFit,f=t.children,v=t.style,S=t.breakAll,i=t.maxLines;if((a||s)&&!fw.isSsr){var O,z,j=KB({breakAll:S,children:f,style:v});if(j){var F=j.wordsWithComputedWidth,G=j.spaceWidth;O=F,z=G}else return JL(f);return Die({breakAll:S,children:f,maxLines:i,style:v},O,z,a,s)}return JL(f)},QL="#808080",yg=function(t){var a=t.x,s=a===void 0?0:a,f=t.y,v=f===void 0?0:f,S=t.lineHeight,i=S===void 0?"1em":S,O=t.capHeight,z=O===void 0?"0.71em":O,j=t.scaleToFit,F=j===void 0?!1:j,G=t.textAnchor,Y=G===void 0?"start":G,X=t.verticalAnchor,K=X===void 0?"end":X,ne=t.fill,se=ne===void 0?QL:ne,ge=XL(t,Aie),_e=Me.useMemo(function(){return Lie({breakAll:ge.breakAll,children:ge.children,maxLines:ge.maxLines,scaleToFit:F,style:ge.style,width:ge.width})},[ge.breakAll,ge.children,ge.maxLines,F,ge.style,ge.width]),xe=ge.dx,ae=ge.dy,ve=ge.angle,Se=ge.className,He=ge.breakAll,Ge=XL(ge,Cie);if(!go(s)||!go(v))return null;var ye=s+(Nn(xe)?xe:0),Le=v+(Nn(ae)?ae:0),ht;switch(K){case"start":ht=OA("calc(".concat(z,")"));break;case"middle":ht=OA("calc(".concat((_e.length-1)/2," * -").concat(i," + (").concat(z," / 2))"));break;default:ht=OA("calc(".concat(_e.length-1," * -").concat(i,")"));break}var gt=[];if(F){var Ft=_e[0].width,_t=ge.width;gt.push("scale(".concat((Nn(_t)?_t/Ft:1)/Ft,")"))}return ve&&gt.push("rotate(".concat(ve,", ").concat(ye,", ").concat(Le,")")),gt.length&&(Ge.transform=gt.join(" ")),Ot.createElement("text",dM({},Fr(Ge,!0),{x:ye,y:Le,className:oi("recharts-text",Se),textAnchor:Y,fill:se.includes("url")?QL:se}),_e.map(function(yt,Vt){var Ht=yt.words.join(He?"":" ");return Ot.createElement("tspan",{x:ye,dy:Vt===0?ht:i,key:"".concat(Ht,"-").concat(Vt)},Ht)}))};function Vp(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function zie(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function s4(e){let t,a,s;e.length!==2?(t=Vp,a=(i,O)=>Vp(e(i),O),s=(i,O)=>e(i)-O):(t=e===Vp||e===zie?e:kie,a=e,s=e);function f(i,O,z=0,j=i.length){if(z<j){if(t(O,O)!==0)return j;do{const F=z+j>>>1;a(i[F],O)<0?z=F+1:j=F}while(z<j)}return z}function v(i,O,z=0,j=i.length){if(z<j){if(t(O,O)!==0)return j;do{const F=z+j>>>1;a(i[F],O)<=0?z=F+1:j=F}while(z<j)}return z}function S(i,O,z=0,j=i.length){const F=f(i,O,z,j-1);return F>z&&s(i[F-1],O)>-s(i[F],O)?F-1:F}return{left:f,center:S,right:v}}function kie(){return 0}function JB(e){return e===null?NaN:+e}function*Bie(e,t){for(let a of e)a!=null&&(a=+a)>=a&&(yield a)}const Nie=s4(Vp),z1=Nie.right;s4(JB).center;class e9 extends Map{constructor(t,a=Uie){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:a}}),t!=null)for(const[s,f]of t)this.set(s,f)}get(t){return super.get(t9(this,t))}has(t){return super.has(t9(this,t))}set(t,a){return super.set(Fie(this,t),a)}delete(t){return super.delete(jie(this,t))}}function t9({_intern:e,_key:t},a){const s=t(a);return e.has(s)?e.get(s):a}function Fie({_intern:e,_key:t},a){const s=t(a);return e.has(s)?e.get(s):(e.set(s,a),a)}function jie({_intern:e,_key:t},a){const s=t(a);return e.has(s)&&(a=e.get(s),e.delete(s)),a}function Uie(e){return e!==null&&typeof e=="object"?e.valueOf():e}function Vie(e=Vp){if(e===Vp)return QB;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,a)=>{const s=e(t,a);return s||s===0?s:(e(a,a)===0)-(e(t,t)===0)}}function QB(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const $ie=Math.sqrt(50),qie=Math.sqrt(10),Gie=Math.sqrt(2);function Qx(e,t,a){const s=(t-e)/Math.max(0,a),f=Math.floor(Math.log10(s)),v=s/Math.pow(10,f),S=v>=$ie?10:v>=qie?5:v>=Gie?2:1;let i,O,z;return f<0?(z=Math.pow(10,-f)/S,i=Math.round(e*z),O=Math.round(t*z),i/z<e&&++i,O/z>t&&--O,z=-z):(z=Math.pow(10,f)*S,i=Math.round(e/z),O=Math.round(t/z),i*z<e&&++i,O*z>t&&--O),O<i&&.5<=a&&a<2?Qx(e,t,a*2):[i,O,z]}function pM(e,t,a){if(t=+t,e=+e,a=+a,!(a>0))return[];if(e===t)return[e];const s=t<e,[f,v,S]=s?Qx(t,e,a):Qx(e,t,a);if(!(v>=f))return[];const i=v-f+1,O=new Array(i);if(s)if(S<0)for(let z=0;z<i;++z)O[z]=(v-z)/-S;else for(let z=0;z<i;++z)O[z]=(v-z)*S;else if(S<0)for(let z=0;z<i;++z)O[z]=(f+z)/-S;else for(let z=0;z<i;++z)O[z]=(f+z)*S;return O}function mM(e,t,a){return t=+t,e=+e,a=+a,Qx(e,t,a)[2]}function _M(e,t,a){t=+t,e=+e,a=+a;const s=t<e,f=s?mM(t,e,a):mM(e,t,a);return(s?-1:1)*(f<0?1/-f:f)}function n9(e,t){let a;for(const s of e)s!=null&&(a<s||a===void 0&&s>=s)&&(a=s);return a}function r9(e,t){let a;for(const s of e)s!=null&&(a>s||a===void 0&&s>=s)&&(a=s);return a}function eN(e,t,a=0,s=1/0,f){if(t=Math.floor(t),a=Math.floor(Math.max(0,a)),s=Math.floor(Math.min(e.length-1,s)),!(a<=t&&t<=s))return e;for(f=f===void 0?QB:Vie(f);s>a;){if(s-a>600){const O=s-a+1,z=t-a+1,j=Math.log(O),F=.5*Math.exp(2*j/3),G=.5*Math.sqrt(j*F*(O-F)/O)*(z-O/2<0?-1:1),Y=Math.max(a,Math.floor(t-z*F/O+G)),X=Math.min(s,Math.floor(t+(O-z)*F/O+G));eN(e,t,Y,X,f)}const v=e[t];let S=a,i=s;for(sv(e,a,t),f(e[s],v)>0&&sv(e,a,s);S<i;){for(sv(e,S,i),++S,--i;f(e[S],v)<0;)++S;for(;f(e[i],v)>0;)--i}f(e[a],v)===0?sv(e,a,i):(++i,sv(e,i,s)),i<=t&&(a=i+1),t<=i&&(s=i-1)}return e}function sv(e,t,a){const s=e[t];e[t]=e[a],e[a]=s}function Hie(e,t,a){if(e=Float64Array.from(Bie(e)),!(!(s=e.length)||isNaN(t=+t))){if(t<=0||s<2)return r9(e);if(t>=1)return n9(e);var s,f=(s-1)*t,v=Math.floor(f),S=n9(eN(e,v).subarray(0,v+1)),i=r9(e.subarray(v+1));return S+(i-S)*(f-v)}}function Zie(e,t,a=JB){if(!(!(s=e.length)||isNaN(t=+t))){if(t<=0||s<2)return+a(e[0],0,e);if(t>=1)return+a(e[s-1],s-1,e);var s,f=(s-1)*t,v=Math.floor(f),S=+a(e[v],v,e),i=+a(e[v+1],v+1,e);return S+(i-S)*(f-v)}}function Wie(e,t,a){e=+e,t=+t,a=(f=arguments.length)<2?(t=e,e=0,1):f<3?1:+a;for(var s=-1,f=Math.max(0,Math.ceil((t-e)/a))|0,v=new Array(f);++s<f;)v[s]=e+s*a;return v}function iu(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function Ld(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const gM=Symbol("implicit");function l4(){var e=new e9,t=[],a=[],s=gM;function f(v){let S=e.get(v);if(S===void 0){if(s!==gM)return s;e.set(v,S=t.push(v)-1)}return a[S%a.length]}return f.domain=function(v){if(!arguments.length)return t.slice();t=[],e=new e9;for(const S of v)e.has(S)||e.set(S,t.push(S)-1);return f},f.range=function(v){return arguments.length?(a=Array.from(v),f):a.slice()},f.unknown=function(v){return arguments.length?(s=v,f):s},f.copy=function(){return l4(t,a).unknown(s)},iu.apply(f,arguments),f}function Kv(){var e=l4().unknown(void 0),t=e.domain,a=e.range,s=0,f=1,v,S,i=!1,O=0,z=0,j=.5;delete e.unknown;function F(){var G=t().length,Y=f<s,X=Y?f:s,K=Y?s:f;v=(K-X)/Math.max(1,G-O+z*2),i&&(v=Math.floor(v)),X+=(K-X-v*(G-O))*j,S=v*(1-O),i&&(X=Math.round(X),S=Math.round(S));var ne=Wie(G).map(function(se){return X+v*se});return a(Y?ne.reverse():ne)}return e.domain=function(G){return arguments.length?(t(G),F()):t()},e.range=function(G){return arguments.length?([s,f]=G,s=+s,f=+f,F()):[s,f]},e.rangeRound=function(G){return[s,f]=G,s=+s,f=+f,i=!0,F()},e.bandwidth=function(){return S},e.step=function(){return v},e.round=function(G){return arguments.length?(i=!!G,F()):i},e.padding=function(G){return arguments.length?(O=Math.min(1,z=+G),F()):O},e.paddingInner=function(G){return arguments.length?(O=Math.min(1,G),F()):O},e.paddingOuter=function(G){return arguments.length?(z=+G,F()):z},e.align=function(G){return arguments.length?(j=Math.max(0,Math.min(1,G)),F()):j},e.copy=function(){return Kv(t(),[s,f]).round(i).paddingInner(O).paddingOuter(z).align(j)},iu.apply(F(),arguments)}function tN(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return tN(t())},e}function Ov(){return tN(Kv.apply(null,arguments).paddingInner(1))}function c4(e,t,a){e.prototype=t.prototype=a,a.constructor=e}function nN(e,t){var a=Object.create(e.prototype);for(var s in t)a[s]=t[s];return a}function k1(){}var Jv=.7,eb=1/Jv,og="\\s*([+-]?\\d+)\\s*",Qv="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",tf="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Xie=/^#([0-9a-f]{3,8})$/,Yie=new RegExp(`^rgb\\(${og},${og},${og}\\)$`),Kie=new RegExp(`^rgb\\(${tf},${tf},${tf}\\)$`),Jie=new RegExp(`^rgba\\(${og},${og},${og},${Qv}\\)$`),Qie=new RegExp(`^rgba\\(${tf},${tf},${tf},${Qv}\\)$`),eae=new RegExp(`^hsl\\(${Qv},${tf},${tf}\\)$`),tae=new RegExp(`^hsla\\(${Qv},${tf},${tf},${Qv}\\)$`),i9={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};c4(k1,e1,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:a9,formatHex:a9,formatHex8:nae,formatHsl:rae,formatRgb:o9,toString:o9});function a9(){return this.rgb().formatHex()}function nae(){return this.rgb().formatHex8()}function rae(){return rN(this).formatHsl()}function o9(){return this.rgb().formatRgb()}function e1(e){var t,a;return e=(e+"").trim().toLowerCase(),(t=Xie.exec(e))?(a=t[1].length,t=parseInt(t[1],16),a===6?s9(t):a===3?new ul(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):a===8?hx(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):a===4?hx(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=Yie.exec(e))?new ul(t[1],t[2],t[3],1):(t=Kie.exec(e))?new ul(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=Jie.exec(e))?hx(t[1],t[2],t[3],t[4]):(t=Qie.exec(e))?hx(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=eae.exec(e))?u9(t[1],t[2]/100,t[3]/100,1):(t=tae.exec(e))?u9(t[1],t[2]/100,t[3]/100,t[4]):i9.hasOwnProperty(e)?s9(i9[e]):e==="transparent"?new ul(NaN,NaN,NaN,0):null}function s9(e){return new ul(e>>16&255,e>>8&255,e&255,1)}function hx(e,t,a,s){return s<=0&&(e=t=a=NaN),new ul(e,t,a,s)}function iae(e){return e instanceof k1||(e=e1(e)),e?(e=e.rgb(),new ul(e.r,e.g,e.b,e.opacity)):new ul}function yM(e,t,a,s){return arguments.length===1?iae(e):new ul(e,t,a,s??1)}function ul(e,t,a,s){this.r=+e,this.g=+t,this.b=+a,this.opacity=+s}c4(ul,yM,nN(k1,{brighter(e){return e=e==null?eb:Math.pow(eb,e),new ul(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Jv:Math.pow(Jv,e),new ul(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new ul(_0(this.r),_0(this.g),_0(this.b),tb(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:l9,formatHex:l9,formatHex8:aae,formatRgb:c9,toString:c9}));function l9(){return`#${p0(this.r)}${p0(this.g)}${p0(this.b)}`}function aae(){return`#${p0(this.r)}${p0(this.g)}${p0(this.b)}${p0((isNaN(this.opacity)?1:this.opacity)*255)}`}function c9(){const e=tb(this.opacity);return`${e===1?"rgb(":"rgba("}${_0(this.r)}, ${_0(this.g)}, ${_0(this.b)}${e===1?")":`, ${e})`}`}function tb(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function _0(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function p0(e){return e=_0(e),(e<16?"0":"")+e.toString(16)}function u9(e,t,a,s){return s<=0?e=t=a=NaN:a<=0||a>=1?e=t=NaN:t<=0&&(e=NaN),new Gu(e,t,a,s)}function rN(e){if(e instanceof Gu)return new Gu(e.h,e.s,e.l,e.opacity);if(e instanceof k1||(e=e1(e)),!e)return new Gu;if(e instanceof Gu)return e;e=e.rgb();var t=e.r/255,a=e.g/255,s=e.b/255,f=Math.min(t,a,s),v=Math.max(t,a,s),S=NaN,i=v-f,O=(v+f)/2;return i?(t===v?S=(a-s)/i+(a<s)*6:a===v?S=(s-t)/i+2:S=(t-a)/i+4,i/=O<.5?v+f:2-v-f,S*=60):i=O>0&&O<1?0:S,new Gu(S,i,O,e.opacity)}function oae(e,t,a,s){return arguments.length===1?rN(e):new Gu(e,t,a,s??1)}function Gu(e,t,a,s){this.h=+e,this.s=+t,this.l=+a,this.opacity=+s}c4(Gu,oae,nN(k1,{brighter(e){return e=e==null?eb:Math.pow(eb,e),new Gu(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Jv:Math.pow(Jv,e),new Gu(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,a=this.l,s=a+(a<.5?a:1-a)*t,f=2*a-s;return new ul(IA(e>=240?e-240:e+120,f,s),IA(e,f,s),IA(e<120?e+240:e-120,f,s),this.opacity)},clamp(){return new Gu(h9(this.h),fx(this.s),fx(this.l),tb(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=tb(this.opacity);return`${e===1?"hsl(":"hsla("}${h9(this.h)}, ${fx(this.s)*100}%, ${fx(this.l)*100}%${e===1?")":`, ${e})`}`}}));function h9(e){return e=(e||0)%360,e<0?e+360:e}function fx(e){return Math.max(0,Math.min(1,e||0))}function IA(e,t,a){return(e<60?t+(a-t)*e/60:e<180?a:e<240?t+(a-t)*(240-e)/60:t)*255}const u4=e=>()=>e;function sae(e,t){return function(a){return e+a*t}}function lae(e,t,a){return e=Math.pow(e,a),t=Math.pow(t,a)-e,a=1/a,function(s){return Math.pow(e+s*t,a)}}function cae(e){return(e=+e)==1?iN:function(t,a){return a-t?lae(t,a,e):u4(isNaN(t)?a:t)}}function iN(e,t){var a=t-e;return a?sae(e,a):u4(isNaN(e)?t:e)}const f9=function e(t){var a=cae(t);function s(f,v){var S=a((f=yM(f)).r,(v=yM(v)).r),i=a(f.g,v.g),O=a(f.b,v.b),z=iN(f.opacity,v.opacity);return function(j){return f.r=S(j),f.g=i(j),f.b=O(j),f.opacity=z(j),f+""}}return s.gamma=e,s}(1);function uae(e,t){t||(t=[]);var a=e?Math.min(t.length,e.length):0,s=t.slice(),f;return function(v){for(f=0;f<a;++f)s[f]=e[f]*(1-v)+t[f]*v;return s}}function hae(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function fae(e,t){var a=t?t.length:0,s=e?Math.min(a,e.length):0,f=new Array(s),v=new Array(a),S;for(S=0;S<s;++S)f[S]=Vg(e[S],t[S]);for(;S<a;++S)v[S]=t[S];return function(i){for(S=0;S<s;++S)v[S]=f[S](i);return v}}function dae(e,t){var a=new Date;return e=+e,t=+t,function(s){return a.setTime(e*(1-s)+t*s),a}}function nb(e,t){return e=+e,t=+t,function(a){return e*(1-a)+t*a}}function pae(e,t){var a={},s={},f;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(f in t)f in e?a[f]=Vg(e[f],t[f]):s[f]=t[f];return function(v){for(f in a)s[f]=a[f](v);return s}}var vM=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,PA=new RegExp(vM.source,"g");function mae(e){return function(){return e}}function _ae(e){return function(t){return e(t)+""}}function gae(e,t){var a=vM.lastIndex=PA.lastIndex=0,s,f,v,S=-1,i=[],O=[];for(e=e+"",t=t+"";(s=vM.exec(e))&&(f=PA.exec(t));)(v=f.index)>a&&(v=t.slice(a,v),i[S]?i[S]+=v:i[++S]=v),(s=s[0])===(f=f[0])?i[S]?i[S]+=f:i[++S]=f:(i[++S]=null,O.push({i:S,x:nb(s,f)})),a=PA.lastIndex;return a<t.length&&(v=t.slice(a),i[S]?i[S]+=v:i[++S]=v),i.length<2?O[0]?_ae(O[0].x):mae(t):(t=O.length,function(z){for(var j=0,F;j<t;++j)i[(F=O[j]).i]=F.x(z);return i.join("")})}function Vg(e,t){var a=typeof t,s;return t==null||a==="boolean"?u4(t):(a==="number"?nb:a==="string"?(s=e1(t))?(t=s,f9):gae:t instanceof e1?f9:t instanceof Date?dae:hae(t)?uae:Array.isArray(t)?fae:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?pae:nb)(e,t)}function h4(e,t){return e=+e,t=+t,function(a){return Math.round(e*(1-a)+t*a)}}function yae(e,t){t===void 0&&(t=e,e=Vg);for(var a=0,s=t.length-1,f=t[0],v=new Array(s<0?0:s);a<s;)v[a]=e(f,f=t[++a]);return function(S){var i=Math.max(0,Math.min(s-1,Math.floor(S*=s)));return v[i](S-i)}}function vae(e){return function(){return e}}function rb(e){return+e}var d9=[0,1];function Gs(e){return e}function xM(e,t){return(t-=e=+e)?function(a){return(a-e)/t}:vae(isNaN(t)?NaN:.5)}function xae(e,t){var a;return e>t&&(a=e,e=t,t=a),function(s){return Math.max(e,Math.min(t,s))}}function bae(e,t,a){var s=e[0],f=e[1],v=t[0],S=t[1];return f<s?(s=xM(f,s),v=a(S,v)):(s=xM(s,f),v=a(v,S)),function(i){return v(s(i))}}function wae(e,t,a){var s=Math.min(e.length,t.length)-1,f=new Array(s),v=new Array(s),S=-1;for(e[s]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++S<s;)f[S]=xM(e[S],e[S+1]),v[S]=a(t[S],t[S+1]);return function(i){var O=z1(e,i,1,s)-1;return v[O](f[O](i))}}function B1(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function dw(){var e=d9,t=d9,a=Vg,s,f,v,S=Gs,i,O,z;function j(){var G=Math.min(e.length,t.length);return S!==Gs&&(S=xae(e[0],e[G-1])),i=G>2?wae:bae,O=z=null,F}function F(G){return G==null||isNaN(G=+G)?v:(O||(O=i(e.map(s),t,a)))(s(S(G)))}return F.invert=function(G){return S(f((z||(z=i(t,e.map(s),nb)))(G)))},F.domain=function(G){return arguments.length?(e=Array.from(G,rb),j()):e.slice()},F.range=function(G){return arguments.length?(t=Array.from(G),j()):t.slice()},F.rangeRound=function(G){return t=Array.from(G),a=h4,j()},F.clamp=function(G){return arguments.length?(S=G?!0:Gs,j()):S!==Gs},F.interpolate=function(G){return arguments.length?(a=G,j()):a},F.unknown=function(G){return arguments.length?(v=G,F):v},function(G,Y){return s=G,f=Y,j()}}function f4(){return dw()(Gs,Gs)}function Sae(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function ib(e,t){if((a=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var a,s=e.slice(0,a);return[s.length>1?s[0]+s.slice(2):s,+e.slice(a+1)]}function vg(e){return e=ib(Math.abs(e)),e?e[1]:NaN}function Tae(e,t){return function(a,s){for(var f=a.length,v=[],S=0,i=e[0],O=0;f>0&&i>0&&(O+i+1>s&&(i=Math.max(1,s-O)),v.push(a.substring(f-=i,f+i)),!((O+=i+1)>s));)i=e[S=(S+1)%e.length];return v.reverse().join(t)}}function Eae(e){return function(t){return t.replace(/[0-9]/g,function(a){return e[+a]})}}var Aae=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function t1(e){if(!(t=Aae.exec(e)))throw new Error("invalid format: "+e);var t;return new d4({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}t1.prototype=d4.prototype;function d4(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}d4.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Cae(e){e:for(var t=e.length,a=1,s=-1,f;a<t;++a)switch(e[a]){case".":s=f=a;break;case"0":s===0&&(s=a),f=a;break;default:if(!+e[a])break e;s>0&&(s=0);break}return s>0?e.slice(0,s)+e.slice(f+1):e}var aN;function Mae(e,t){var a=ib(e,t);if(!a)return e+"";var s=a[0],f=a[1],v=f-(aN=Math.max(-8,Math.min(8,Math.floor(f/3)))*3)+1,S=s.length;return v===S?s:v>S?s+new Array(v-S+1).join("0"):v>0?s.slice(0,v)+"."+s.slice(v):"0."+new Array(1-v).join("0")+ib(e,Math.max(0,t+v-1))[0]}function p9(e,t){var a=ib(e,t);if(!a)return e+"";var s=a[0],f=a[1];return f<0?"0."+new Array(-f).join("0")+s:s.length>f+1?s.slice(0,f+1)+"."+s.slice(f+1):s+new Array(f-s.length+2).join("0")}const m9={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:Sae,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>p9(e*100,t),r:p9,s:Mae,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function _9(e){return e}var g9=Array.prototype.map,y9=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function Oae(e){var t=e.grouping===void 0||e.thousands===void 0?_9:Tae(g9.call(e.grouping,Number),e.thousands+""),a=e.currency===void 0?"":e.currency[0]+"",s=e.currency===void 0?"":e.currency[1]+"",f=e.decimal===void 0?".":e.decimal+"",v=e.numerals===void 0?_9:Eae(g9.call(e.numerals,String)),S=e.percent===void 0?"%":e.percent+"",i=e.minus===void 0?"−":e.minus+"",O=e.nan===void 0?"NaN":e.nan+"";function z(F){F=t1(F);var G=F.fill,Y=F.align,X=F.sign,K=F.symbol,ne=F.zero,se=F.width,ge=F.comma,_e=F.precision,xe=F.trim,ae=F.type;ae==="n"?(ge=!0,ae="g"):m9[ae]||(_e===void 0&&(_e=12),xe=!0,ae="g"),(ne||G==="0"&&Y==="=")&&(ne=!0,G="0",Y="=");var ve=K==="$"?a:K==="#"&&/[boxX]/.test(ae)?"0"+ae.toLowerCase():"",Se=K==="$"?s:/[%p]/.test(ae)?S:"",He=m9[ae],Ge=/[defgprs%]/.test(ae);_e=_e===void 0?6:/[gprs]/.test(ae)?Math.max(1,Math.min(21,_e)):Math.max(0,Math.min(20,_e));function ye(Le){var ht=ve,gt=Se,Ft,_t,yt;if(ae==="c")gt=He(Le)+gt,Le="";else{Le=+Le;var Vt=Le<0||1/Le<0;if(Le=isNaN(Le)?O:He(Math.abs(Le),_e),xe&&(Le=Cae(Le)),Vt&&+Le==0&&X!=="+"&&(Vt=!1),ht=(Vt?X==="("?X:i:X==="-"||X==="("?"":X)+ht,gt=(ae==="s"?y9[8+aN/3]:"")+gt+(Vt&&X==="("?")":""),Ge){for(Ft=-1,_t=Le.length;++Ft<_t;)if(yt=Le.charCodeAt(Ft),48>yt||yt>57){gt=(yt===46?f+Le.slice(Ft+1):Le.slice(Ft))+gt,Le=Le.slice(0,Ft);break}}}ge&&!ne&&(Le=t(Le,1/0));var Ht=ht.length+Le.length+gt.length,Bt=Ht<se?new Array(se-Ht+1).join(G):"";switch(ge&&ne&&(Le=t(Bt+Le,Bt.length?se-gt.length:1/0),Bt=""),Y){case"<":Le=ht+Le+gt+Bt;break;case"=":Le=ht+Bt+Le+gt;break;case"^":Le=Bt.slice(0,Ht=Bt.length>>1)+ht+Le+gt+Bt.slice(Ht);break;default:Le=Bt+ht+Le+gt;break}return v(Le)}return ye.toString=function(){return F+""},ye}function j(F,G){var Y=z((F=t1(F),F.type="f",F)),X=Math.max(-8,Math.min(8,Math.floor(vg(G)/3)))*3,K=Math.pow(10,-X),ne=y9[8+X/3];return function(se){return Y(K*se)+ne}}return{format:z,formatPrefix:j}}var dx,p4,oN;Iae({thousands:",",grouping:[3],currency:["$",""]});function Iae(e){return dx=Oae(e),p4=dx.format,oN=dx.formatPrefix,dx}function Pae(e){return Math.max(0,-vg(Math.abs(e)))}function Rae(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(vg(t)/3)))*3-vg(Math.abs(e)))}function Dae(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,vg(t)-vg(e))+1}function sN(e,t,a,s){var f=_M(e,t,a),v;switch(s=t1(s??",f"),s.type){case"s":{var S=Math.max(Math.abs(e),Math.abs(t));return s.precision==null&&!isNaN(v=Rae(f,S))&&(s.precision=v),oN(s,S)}case"":case"e":case"g":case"p":case"r":{s.precision==null&&!isNaN(v=Dae(f,Math.max(Math.abs(e),Math.abs(t))))&&(s.precision=v-(s.type==="e"));break}case"f":case"%":{s.precision==null&&!isNaN(v=Pae(f))&&(s.precision=v-(s.type==="%")*2);break}}return p4(s)}function Xp(e){var t=e.domain;return e.ticks=function(a){var s=t();return pM(s[0],s[s.length-1],a??10)},e.tickFormat=function(a,s){var f=t();return sN(f[0],f[f.length-1],a??10,s)},e.nice=function(a){a==null&&(a=10);var s=t(),f=0,v=s.length-1,S=s[f],i=s[v],O,z,j=10;for(i<S&&(z=S,S=i,i=z,z=f,f=v,v=z);j-- >0;){if(z=mM(S,i,a),z===O)return s[f]=S,s[v]=i,t(s);if(z>0)S=Math.floor(S/z)*z,i=Math.ceil(i/z)*z;else if(z<0)S=Math.ceil(S*z)/z,i=Math.floor(i*z)/z;else break;O=z}return e},e}function ab(){var e=f4();return e.copy=function(){return B1(e,ab())},iu.apply(e,arguments),Xp(e)}function lN(e){var t;function a(s){return s==null||isNaN(s=+s)?t:s}return a.invert=a,a.domain=a.range=function(s){return arguments.length?(e=Array.from(s,rb),a):e.slice()},a.unknown=function(s){return arguments.length?(t=s,a):t},a.copy=function(){return lN(e).unknown(t)},e=arguments.length?Array.from(e,rb):[0,1],Xp(a)}function cN(e,t){e=e.slice();var a=0,s=e.length-1,f=e[a],v=e[s],S;return v<f&&(S=a,a=s,s=S,S=f,f=v,v=S),e[a]=t.floor(f),e[s]=t.ceil(v),e}function v9(e){return Math.log(e)}function x9(e){return Math.exp(e)}function Lae(e){return-Math.log(-e)}function zae(e){return-Math.exp(-e)}function kae(e){return isFinite(e)?+("1e"+e):e<0?0:e}function Bae(e){return e===10?kae:e===Math.E?Math.exp:t=>Math.pow(e,t)}function Nae(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function b9(e){return(t,a)=>-e(-t,a)}function m4(e){const t=e(v9,x9),a=t.domain;let s=10,f,v;function S(){return f=Nae(s),v=Bae(s),a()[0]<0?(f=b9(f),v=b9(v),e(Lae,zae)):e(v9,x9),t}return t.base=function(i){return arguments.length?(s=+i,S()):s},t.domain=function(i){return arguments.length?(a(i),S()):a()},t.ticks=i=>{const O=a();let z=O[0],j=O[O.length-1];const F=j<z;F&&([z,j]=[j,z]);let G=f(z),Y=f(j),X,K;const ne=i==null?10:+i;let se=[];if(!(s%1)&&Y-G<ne){if(G=Math.floor(G),Y=Math.ceil(Y),z>0){for(;G<=Y;++G)for(X=1;X<s;++X)if(K=G<0?X/v(-G):X*v(G),!(K<z)){if(K>j)break;se.push(K)}}else for(;G<=Y;++G)for(X=s-1;X>=1;--X)if(K=G>0?X/v(-G):X*v(G),!(K<z)){if(K>j)break;se.push(K)}se.length*2<ne&&(se=pM(z,j,ne))}else se=pM(G,Y,Math.min(Y-G,ne)).map(v);return F?se.reverse():se},t.tickFormat=(i,O)=>{if(i==null&&(i=10),O==null&&(O=s===10?"s":","),typeof O!="function"&&(!(s%1)&&(O=t1(O)).precision==null&&(O.trim=!0),O=p4(O)),i===1/0)return O;const z=Math.max(1,s*i/t.ticks().length);return j=>{let F=j/v(Math.round(f(j)));return F*s<s-.5&&(F*=s),F<=z?O(j):""}},t.nice=()=>a(cN(a(),{floor:i=>v(Math.floor(f(i))),ceil:i=>v(Math.ceil(f(i)))})),t}function uN(){const e=m4(dw()).domain([1,10]);return e.copy=()=>B1(e,uN()).base(e.base()),iu.apply(e,arguments),e}function w9(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function S9(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function _4(e){var t=1,a=e(w9(t),S9(t));return a.constant=function(s){return arguments.length?e(w9(t=+s),S9(t)):t},Xp(a)}function hN(){var e=_4(dw());return e.copy=function(){return B1(e,hN()).constant(e.constant())},iu.apply(e,arguments)}function T9(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function Fae(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function jae(e){return e<0?-e*e:e*e}function g4(e){var t=e(Gs,Gs),a=1;function s(){return a===1?e(Gs,Gs):a===.5?e(Fae,jae):e(T9(a),T9(1/a))}return t.exponent=function(f){return arguments.length?(a=+f,s()):a},Xp(t)}function y4(){var e=g4(dw());return e.copy=function(){return B1(e,y4()).exponent(e.exponent())},iu.apply(e,arguments),e}function Uae(){return y4.apply(null,arguments).exponent(.5)}function E9(e){return Math.sign(e)*e*e}function Vae(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function fN(){var e=f4(),t=[0,1],a=!1,s;function f(v){var S=Vae(e(v));return isNaN(S)?s:a?Math.round(S):S}return f.invert=function(v){return e.invert(E9(v))},f.domain=function(v){return arguments.length?(e.domain(v),f):e.domain()},f.range=function(v){return arguments.length?(e.range((t=Array.from(v,rb)).map(E9)),f):t.slice()},f.rangeRound=function(v){return f.range(v).round(!0)},f.round=function(v){return arguments.length?(a=!!v,f):a},f.clamp=function(v){return arguments.length?(e.clamp(v),f):e.clamp()},f.unknown=function(v){return arguments.length?(s=v,f):s},f.copy=function(){return fN(e.domain(),t).round(a).clamp(e.clamp()).unknown(s)},iu.apply(f,arguments),Xp(f)}function dN(){var e=[],t=[],a=[],s;function f(){var S=0,i=Math.max(1,t.length);for(a=new Array(i-1);++S<i;)a[S-1]=Zie(e,S/i);return v}function v(S){return S==null||isNaN(S=+S)?s:t[z1(a,S)]}return v.invertExtent=function(S){var i=t.indexOf(S);return i<0?[NaN,NaN]:[i>0?a[i-1]:e[0],i<a.length?a[i]:e[e.length-1]]},v.domain=function(S){if(!arguments.length)return e.slice();e=[];for(let i of S)i!=null&&!isNaN(i=+i)&&e.push(i);return e.sort(Vp),f()},v.range=function(S){return arguments.length?(t=Array.from(S),f()):t.slice()},v.unknown=function(S){return arguments.length?(s=S,v):s},v.quantiles=function(){return a.slice()},v.copy=function(){return dN().domain(e).range(t).unknown(s)},iu.apply(v,arguments)}function pN(){var e=0,t=1,a=1,s=[.5],f=[0,1],v;function S(O){return O!=null&&O<=O?f[z1(s,O,0,a)]:v}function i(){var O=-1;for(s=new Array(a);++O<a;)s[O]=((O+1)*t-(O-a)*e)/(a+1);return S}return S.domain=function(O){return arguments.length?([e,t]=O,e=+e,t=+t,i()):[e,t]},S.range=function(O){return arguments.length?(a=(f=Array.from(O)).length-1,i()):f.slice()},S.invertExtent=function(O){var z=f.indexOf(O);return z<0?[NaN,NaN]:z<1?[e,s[0]]:z>=a?[s[a-1],t]:[s[z-1],s[z]]},S.unknown=function(O){return arguments.length&&(v=O),S},S.thresholds=function(){return s.slice()},S.copy=function(){return pN().domain([e,t]).range(f).unknown(v)},iu.apply(Xp(S),arguments)}function mN(){var e=[.5],t=[0,1],a,s=1;function f(v){return v!=null&&v<=v?t[z1(e,v,0,s)]:a}return f.domain=function(v){return arguments.length?(e=Array.from(v),s=Math.min(e.length,t.length-1),f):e.slice()},f.range=function(v){return arguments.length?(t=Array.from(v),s=Math.min(e.length,t.length-1),f):t.slice()},f.invertExtent=function(v){var S=t.indexOf(v);return[e[S-1],e[S]]},f.unknown=function(v){return arguments.length?(a=v,f):a},f.copy=function(){return mN().domain(e).range(t).unknown(a)},iu.apply(f,arguments)}const RA=new Date,DA=new Date;function vo(e,t,a,s){function f(v){return e(v=arguments.length===0?new Date:new Date(+v)),v}return f.floor=v=>(e(v=new Date(+v)),v),f.ceil=v=>(e(v=new Date(v-1)),t(v,1),e(v),v),f.round=v=>{const S=f(v),i=f.ceil(v);return v-S<i-v?S:i},f.offset=(v,S)=>(t(v=new Date(+v),S==null?1:Math.floor(S)),v),f.range=(v,S,i)=>{const O=[];if(v=f.ceil(v),i=i==null?1:Math.floor(i),!(v<S)||!(i>0))return O;let z;do O.push(z=new Date(+v)),t(v,i),e(v);while(z<v&&v<S);return O},f.filter=v=>vo(S=>{if(S>=S)for(;e(S),!v(S);)S.setTime(S-1)},(S,i)=>{if(S>=S)if(i<0)for(;++i<=0;)for(;t(S,-1),!v(S););else for(;--i>=0;)for(;t(S,1),!v(S););}),a&&(f.count=(v,S)=>(RA.setTime(+v),DA.setTime(+S),e(RA),e(DA),Math.floor(a(RA,DA))),f.every=v=>(v=Math.floor(v),!isFinite(v)||!(v>0)?null:v>1?f.filter(s?S=>s(S)%v===0:S=>f.count(0,S)%v===0):f)),f}const ob=vo(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);ob.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?vo(t=>{t.setTime(Math.floor(t/e)*e)},(t,a)=>{t.setTime(+t+a*e)},(t,a)=>(a-t)/e):ob);ob.range;const gd=1e3,eu=gd*60,yd=eu*60,Ad=yd*24,v4=Ad*7,A9=Ad*30,LA=Ad*365,m0=vo(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*gd)},(e,t)=>(t-e)/gd,e=>e.getUTCSeconds());m0.range;const x4=vo(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*gd)},(e,t)=>{e.setTime(+e+t*eu)},(e,t)=>(t-e)/eu,e=>e.getMinutes());x4.range;const b4=vo(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*eu)},(e,t)=>(t-e)/eu,e=>e.getUTCMinutes());b4.range;const w4=vo(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*gd-e.getMinutes()*eu)},(e,t)=>{e.setTime(+e+t*yd)},(e,t)=>(t-e)/yd,e=>e.getHours());w4.range;const S4=vo(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*yd)},(e,t)=>(t-e)/yd,e=>e.getUTCHours());S4.range;const N1=vo(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*eu)/Ad,e=>e.getDate()-1);N1.range;const pw=vo(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Ad,e=>e.getUTCDate()-1);pw.range;const _N=vo(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Ad,e=>Math.floor(e/Ad));_N.range;function T0(e){return vo(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,a)=>{t.setDate(t.getDate()+a*7)},(t,a)=>(a-t-(a.getTimezoneOffset()-t.getTimezoneOffset())*eu)/v4)}const mw=T0(0),sb=T0(1),$ae=T0(2),qae=T0(3),xg=T0(4),Gae=T0(5),Hae=T0(6);mw.range;sb.range;$ae.range;qae.range;xg.range;Gae.range;Hae.range;function E0(e){return vo(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,a)=>{t.setUTCDate(t.getUTCDate()+a*7)},(t,a)=>(a-t)/v4)}const _w=E0(0),lb=E0(1),Zae=E0(2),Wae=E0(3),bg=E0(4),Xae=E0(5),Yae=E0(6);_w.range;lb.range;Zae.range;Wae.range;bg.range;Xae.range;Yae.range;const T4=vo(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());T4.range;const E4=vo(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());E4.range;const Cd=vo(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());Cd.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:vo(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,a)=>{t.setFullYear(t.getFullYear()+a*e)});Cd.range;const Md=vo(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());Md.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:vo(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,a)=>{t.setUTCFullYear(t.getUTCFullYear()+a*e)});Md.range;function gN(e,t,a,s,f,v){const S=[[m0,1,gd],[m0,5,5*gd],[m0,15,15*gd],[m0,30,30*gd],[v,1,eu],[v,5,5*eu],[v,15,15*eu],[v,30,30*eu],[f,1,yd],[f,3,3*yd],[f,6,6*yd],[f,12,12*yd],[s,1,Ad],[s,2,2*Ad],[a,1,v4],[t,1,A9],[t,3,3*A9],[e,1,LA]];function i(z,j,F){const G=j<z;G&&([z,j]=[j,z]);const Y=F&&typeof F.range=="function"?F:O(z,j,F),X=Y?Y.range(z,+j+1):[];return G?X.reverse():X}function O(z,j,F){const G=Math.abs(j-z)/F,Y=s4(([,,ne])=>ne).right(S,G);if(Y===S.length)return e.every(_M(z/LA,j/LA,F));if(Y===0)return ob.every(Math.max(_M(z,j,F),1));const[X,K]=S[G/S[Y-1][2]<S[Y][2]/G?Y-1:Y];return X.every(K)}return[i,O]}const[Kae,Jae]=gN(Md,E4,_w,_N,S4,b4),[Qae,eoe]=gN(Cd,T4,mw,N1,w4,x4);function zA(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function kA(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function lv(e,t,a){return{y:e,m:t,d:a,H:0,M:0,S:0,L:0}}function toe(e){var t=e.dateTime,a=e.date,s=e.time,f=e.periods,v=e.days,S=e.shortDays,i=e.months,O=e.shortMonths,z=cv(f),j=uv(f),F=cv(v),G=uv(v),Y=cv(S),X=uv(S),K=cv(i),ne=uv(i),se=cv(O),ge=uv(O),_e={a:Vt,A:Ht,b:Bt,B:et,c:null,d:R9,e:R9,f:Toe,g:Loe,G:koe,H:boe,I:woe,j:Soe,L:yN,m:Eoe,M:Aoe,p:$t,q:rn,Q:z9,s:k9,S:Coe,u:Moe,U:Ooe,V:Ioe,w:Poe,W:Roe,x:null,X:null,y:Doe,Y:zoe,Z:Boe,"%":L9},xe={a:Nt,A:xn,b:rr,B:Xn,c:null,d:D9,e:D9,f:Uoe,g:Koe,G:Qoe,H:Noe,I:Foe,j:joe,L:xN,m:Voe,M:$oe,p:yi,q:ir,Q:z9,s:k9,S:qoe,u:Goe,U:Hoe,V:Zoe,w:Woe,W:Xoe,x:null,X:null,y:Yoe,Y:Joe,Z:ese,"%":L9},ae={a:ye,A:Le,b:ht,B:gt,c:Ft,d:I9,e:I9,f:goe,g:O9,G:M9,H:P9,I:P9,j:doe,L:_oe,m:foe,M:poe,p:Ge,q:hoe,Q:voe,s:xoe,S:moe,u:ooe,U:soe,V:loe,w:aoe,W:coe,x:_t,X:yt,y:O9,Y:M9,Z:uoe,"%":yoe};_e.x=ve(a,_e),_e.X=ve(s,_e),_e.c=ve(t,_e),xe.x=ve(a,xe),xe.X=ve(s,xe),xe.c=ve(t,xe);function ve(yn,Ne){return function(Qn){var fn=[],Dr=-1,It=0,Ir=yn.length,Cr,ki,$n;for(Qn instanceof Date||(Qn=new Date(+Qn));++Dr<Ir;)yn.charCodeAt(Dr)===37&&(fn.push(yn.slice(It,Dr)),(ki=C9[Cr=yn.charAt(++Dr)])!=null?Cr=yn.charAt(++Dr):ki=Cr==="e"?" ":"0",($n=Ne[Cr])&&(Cr=$n(Qn,ki)),fn.push(Cr),It=Dr+1);return fn.push(yn.slice(It,Dr)),fn.join("")}}function Se(yn,Ne){return function(Qn){var fn=lv(1900,void 0,1),Dr=He(fn,yn,Qn+="",0),It,Ir;if(Dr!=Qn.length)return null;if("Q"in fn)return new Date(fn.Q);if("s"in fn)return new Date(fn.s*1e3+("L"in fn?fn.L:0));if(Ne&&!("Z"in fn)&&(fn.Z=0),"p"in fn&&(fn.H=fn.H%12+fn.p*12),fn.m===void 0&&(fn.m="q"in fn?fn.q:0),"V"in fn){if(fn.V<1||fn.V>53)return null;"w"in fn||(fn.w=1),"Z"in fn?(It=kA(lv(fn.y,0,1)),Ir=It.getUTCDay(),It=Ir>4||Ir===0?lb.ceil(It):lb(It),It=pw.offset(It,(fn.V-1)*7),fn.y=It.getUTCFullYear(),fn.m=It.getUTCMonth(),fn.d=It.getUTCDate()+(fn.w+6)%7):(It=zA(lv(fn.y,0,1)),Ir=It.getDay(),It=Ir>4||Ir===0?sb.ceil(It):sb(It),It=N1.offset(It,(fn.V-1)*7),fn.y=It.getFullYear(),fn.m=It.getMonth(),fn.d=It.getDate()+(fn.w+6)%7)}else("W"in fn||"U"in fn)&&("w"in fn||(fn.w="u"in fn?fn.u%7:"W"in fn?1:0),Ir="Z"in fn?kA(lv(fn.y,0,1)).getUTCDay():zA(lv(fn.y,0,1)).getDay(),fn.m=0,fn.d="W"in fn?(fn.w+6)%7+fn.W*7-(Ir+5)%7:fn.w+fn.U*7-(Ir+6)%7);return"Z"in fn?(fn.H+=fn.Z/100|0,fn.M+=fn.Z%100,kA(fn)):zA(fn)}}function He(yn,Ne,Qn,fn){for(var Dr=0,It=Ne.length,Ir=Qn.length,Cr,ki;Dr<It;){if(fn>=Ir)return-1;if(Cr=Ne.charCodeAt(Dr++),Cr===37){if(Cr=Ne.charAt(Dr++),ki=ae[Cr in C9?Ne.charAt(Dr++):Cr],!ki||(fn=ki(yn,Qn,fn))<0)return-1}else if(Cr!=Qn.charCodeAt(fn++))return-1}return fn}function Ge(yn,Ne,Qn){var fn=z.exec(Ne.slice(Qn));return fn?(yn.p=j.get(fn[0].toLowerCase()),Qn+fn[0].length):-1}function ye(yn,Ne,Qn){var fn=Y.exec(Ne.slice(Qn));return fn?(yn.w=X.get(fn[0].toLowerCase()),Qn+fn[0].length):-1}function Le(yn,Ne,Qn){var fn=F.exec(Ne.slice(Qn));return fn?(yn.w=G.get(fn[0].toLowerCase()),Qn+fn[0].length):-1}function ht(yn,Ne,Qn){var fn=se.exec(Ne.slice(Qn));return fn?(yn.m=ge.get(fn[0].toLowerCase()),Qn+fn[0].length):-1}function gt(yn,Ne,Qn){var fn=K.exec(Ne.slice(Qn));return fn?(yn.m=ne.get(fn[0].toLowerCase()),Qn+fn[0].length):-1}function Ft(yn,Ne,Qn){return He(yn,t,Ne,Qn)}function _t(yn,Ne,Qn){return He(yn,a,Ne,Qn)}function yt(yn,Ne,Qn){return He(yn,s,Ne,Qn)}function Vt(yn){return S[yn.getDay()]}function Ht(yn){return v[yn.getDay()]}function Bt(yn){return O[yn.getMonth()]}function et(yn){return i[yn.getMonth()]}function $t(yn){return f[+(yn.getHours()>=12)]}function rn(yn){return 1+~~(yn.getMonth()/3)}function Nt(yn){return S[yn.getUTCDay()]}function xn(yn){return v[yn.getUTCDay()]}function rr(yn){return O[yn.getUTCMonth()]}function Xn(yn){return i[yn.getUTCMonth()]}function yi(yn){return f[+(yn.getUTCHours()>=12)]}function ir(yn){return 1+~~(yn.getUTCMonth()/3)}return{format:function(yn){var Ne=ve(yn+="",_e);return Ne.toString=function(){return yn},Ne},parse:function(yn){var Ne=Se(yn+="",!1);return Ne.toString=function(){return yn},Ne},utcFormat:function(yn){var Ne=ve(yn+="",xe);return Ne.toString=function(){return yn},Ne},utcParse:function(yn){var Ne=Se(yn+="",!0);return Ne.toString=function(){return yn},Ne}}}var C9={"-":"",_:" ",0:"0"},Do=/^\s*\d+/,noe=/^%/,roe=/[\\^$*+?|[\]().{}]/g;function fi(e,t,a){var s=e<0?"-":"",f=(s?-e:e)+"",v=f.length;return s+(v<a?new Array(a-v+1).join(t)+f:f)}function ioe(e){return e.replace(roe,"\\$&")}function cv(e){return new RegExp("^(?:"+e.map(ioe).join("|")+")","i")}function uv(e){return new Map(e.map((t,a)=>[t.toLowerCase(),a]))}function aoe(e,t,a){var s=Do.exec(t.slice(a,a+1));return s?(e.w=+s[0],a+s[0].length):-1}function ooe(e,t,a){var s=Do.exec(t.slice(a,a+1));return s?(e.u=+s[0],a+s[0].length):-1}function soe(e,t,a){var s=Do.exec(t.slice(a,a+2));return s?(e.U=+s[0],a+s[0].length):-1}function loe(e,t,a){var s=Do.exec(t.slice(a,a+2));return s?(e.V=+s[0],a+s[0].length):-1}function coe(e,t,a){var s=Do.exec(t.slice(a,a+2));return s?(e.W=+s[0],a+s[0].length):-1}function M9(e,t,a){var s=Do.exec(t.slice(a,a+4));return s?(e.y=+s[0],a+s[0].length):-1}function O9(e,t,a){var s=Do.exec(t.slice(a,a+2));return s?(e.y=+s[0]+(+s[0]>68?1900:2e3),a+s[0].length):-1}function uoe(e,t,a){var s=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(a,a+6));return s?(e.Z=s[1]?0:-(s[2]+(s[3]||"00")),a+s[0].length):-1}function hoe(e,t,a){var s=Do.exec(t.slice(a,a+1));return s?(e.q=s[0]*3-3,a+s[0].length):-1}function foe(e,t,a){var s=Do.exec(t.slice(a,a+2));return s?(e.m=s[0]-1,a+s[0].length):-1}function I9(e,t,a){var s=Do.exec(t.slice(a,a+2));return s?(e.d=+s[0],a+s[0].length):-1}function doe(e,t,a){var s=Do.exec(t.slice(a,a+3));return s?(e.m=0,e.d=+s[0],a+s[0].length):-1}function P9(e,t,a){var s=Do.exec(t.slice(a,a+2));return s?(e.H=+s[0],a+s[0].length):-1}function poe(e,t,a){var s=Do.exec(t.slice(a,a+2));return s?(e.M=+s[0],a+s[0].length):-1}function moe(e,t,a){var s=Do.exec(t.slice(a,a+2));return s?(e.S=+s[0],a+s[0].length):-1}function _oe(e,t,a){var s=Do.exec(t.slice(a,a+3));return s?(e.L=+s[0],a+s[0].length):-1}function goe(e,t,a){var s=Do.exec(t.slice(a,a+6));return s?(e.L=Math.floor(s[0]/1e3),a+s[0].length):-1}function yoe(e,t,a){var s=noe.exec(t.slice(a,a+1));return s?a+s[0].length:-1}function voe(e,t,a){var s=Do.exec(t.slice(a));return s?(e.Q=+s[0],a+s[0].length):-1}function xoe(e,t,a){var s=Do.exec(t.slice(a));return s?(e.s=+s[0],a+s[0].length):-1}function R9(e,t){return fi(e.getDate(),t,2)}function boe(e,t){return fi(e.getHours(),t,2)}function woe(e,t){return fi(e.getHours()%12||12,t,2)}function Soe(e,t){return fi(1+N1.count(Cd(e),e),t,3)}function yN(e,t){return fi(e.getMilliseconds(),t,3)}function Toe(e,t){return yN(e,t)+"000"}function Eoe(e,t){return fi(e.getMonth()+1,t,2)}function Aoe(e,t){return fi(e.getMinutes(),t,2)}function Coe(e,t){return fi(e.getSeconds(),t,2)}function Moe(e){var t=e.getDay();return t===0?7:t}function Ooe(e,t){return fi(mw.count(Cd(e)-1,e),t,2)}function vN(e){var t=e.getDay();return t>=4||t===0?xg(e):xg.ceil(e)}function Ioe(e,t){return e=vN(e),fi(xg.count(Cd(e),e)+(Cd(e).getDay()===4),t,2)}function Poe(e){return e.getDay()}function Roe(e,t){return fi(sb.count(Cd(e)-1,e),t,2)}function Doe(e,t){return fi(e.getFullYear()%100,t,2)}function Loe(e,t){return e=vN(e),fi(e.getFullYear()%100,t,2)}function zoe(e,t){return fi(e.getFullYear()%1e4,t,4)}function koe(e,t){var a=e.getDay();return e=a>=4||a===0?xg(e):xg.ceil(e),fi(e.getFullYear()%1e4,t,4)}function Boe(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+fi(t/60|0,"0",2)+fi(t%60,"0",2)}function D9(e,t){return fi(e.getUTCDate(),t,2)}function Noe(e,t){return fi(e.getUTCHours(),t,2)}function Foe(e,t){return fi(e.getUTCHours()%12||12,t,2)}function joe(e,t){return fi(1+pw.count(Md(e),e),t,3)}function xN(e,t){return fi(e.getUTCMilliseconds(),t,3)}function Uoe(e,t){return xN(e,t)+"000"}function Voe(e,t){return fi(e.getUTCMonth()+1,t,2)}function $oe(e,t){return fi(e.getUTCMinutes(),t,2)}function qoe(e,t){return fi(e.getUTCSeconds(),t,2)}function Goe(e){var t=e.getUTCDay();return t===0?7:t}function Hoe(e,t){return fi(_w.count(Md(e)-1,e),t,2)}function bN(e){var t=e.getUTCDay();return t>=4||t===0?bg(e):bg.ceil(e)}function Zoe(e,t){return e=bN(e),fi(bg.count(Md(e),e)+(Md(e).getUTCDay()===4),t,2)}function Woe(e){return e.getUTCDay()}function Xoe(e,t){return fi(lb.count(Md(e)-1,e),t,2)}function Yoe(e,t){return fi(e.getUTCFullYear()%100,t,2)}function Koe(e,t){return e=bN(e),fi(e.getUTCFullYear()%100,t,2)}function Joe(e,t){return fi(e.getUTCFullYear()%1e4,t,4)}function Qoe(e,t){var a=e.getUTCDay();return e=a>=4||a===0?bg(e):bg.ceil(e),fi(e.getUTCFullYear()%1e4,t,4)}function ese(){return"+0000"}function L9(){return"%"}function z9(e){return+e}function k9(e){return Math.floor(+e/1e3)}var G_,wN,SN;tse({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function tse(e){return G_=toe(e),wN=G_.format,G_.parse,SN=G_.utcFormat,G_.utcParse,G_}function nse(e){return new Date(e)}function rse(e){return e instanceof Date?+e:+new Date(+e)}function A4(e,t,a,s,f,v,S,i,O,z){var j=f4(),F=j.invert,G=j.domain,Y=z(".%L"),X=z(":%S"),K=z("%I:%M"),ne=z("%I %p"),se=z("%a %d"),ge=z("%b %d"),_e=z("%B"),xe=z("%Y");function ae(ve){return(O(ve)<ve?Y:i(ve)<ve?X:S(ve)<ve?K:v(ve)<ve?ne:s(ve)<ve?f(ve)<ve?se:ge:a(ve)<ve?_e:xe)(ve)}return j.invert=function(ve){return new Date(F(ve))},j.domain=function(ve){return arguments.length?G(Array.from(ve,rse)):G().map(nse)},j.ticks=function(ve){var Se=G();return e(Se[0],Se[Se.length-1],ve??10)},j.tickFormat=function(ve,Se){return Se==null?ae:z(Se)},j.nice=function(ve){var Se=G();return(!ve||typeof ve.range!="function")&&(ve=t(Se[0],Se[Se.length-1],ve??10)),ve?G(cN(Se,ve)):j},j.copy=function(){return B1(j,A4(e,t,a,s,f,v,S,i,O,z))},j}function ise(){return iu.apply(A4(Qae,eoe,Cd,T4,mw,N1,w4,x4,m0,wN).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function ase(){return iu.apply(A4(Kae,Jae,Md,E4,_w,pw,S4,b4,m0,SN).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function gw(){var e=0,t=1,a,s,f,v,S=Gs,i=!1,O;function z(F){return F==null||isNaN(F=+F)?O:S(f===0?.5:(F=(v(F)-a)*f,i?Math.max(0,Math.min(1,F)):F))}z.domain=function(F){return arguments.length?([e,t]=F,a=v(e=+e),s=v(t=+t),f=a===s?0:1/(s-a),z):[e,t]},z.clamp=function(F){return arguments.length?(i=!!F,z):i},z.interpolator=function(F){return arguments.length?(S=F,z):S};function j(F){return function(G){var Y,X;return arguments.length?([Y,X]=G,S=F(Y,X),z):[S(0),S(1)]}}return z.range=j(Vg),z.rangeRound=j(h4),z.unknown=function(F){return arguments.length?(O=F,z):O},function(F){return v=F,a=F(e),s=F(t),f=a===s?0:1/(s-a),z}}function Yp(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function TN(){var e=Xp(gw()(Gs));return e.copy=function(){return Yp(e,TN())},Ld.apply(e,arguments)}function EN(){var e=m4(gw()).domain([1,10]);return e.copy=function(){return Yp(e,EN()).base(e.base())},Ld.apply(e,arguments)}function AN(){var e=_4(gw());return e.copy=function(){return Yp(e,AN()).constant(e.constant())},Ld.apply(e,arguments)}function C4(){var e=g4(gw());return e.copy=function(){return Yp(e,C4()).exponent(e.exponent())},Ld.apply(e,arguments)}function ose(){return C4.apply(null,arguments).exponent(.5)}function CN(){var e=[],t=Gs;function a(s){if(s!=null&&!isNaN(s=+s))return t((z1(e,s,1)-1)/(e.length-1))}return a.domain=function(s){if(!arguments.length)return e.slice();e=[];for(let f of s)f!=null&&!isNaN(f=+f)&&e.push(f);return e.sort(Vp),a},a.interpolator=function(s){return arguments.length?(t=s,a):t},a.range=function(){return e.map((s,f)=>t(f/(e.length-1)))},a.quantiles=function(s){return Array.from({length:s+1},(f,v)=>Hie(e,v/s))},a.copy=function(){return CN(t).domain(e)},Ld.apply(a,arguments)}function yw(){var e=0,t=.5,a=1,s=1,f,v,S,i,O,z=Gs,j,F=!1,G;function Y(K){return isNaN(K=+K)?G:(K=.5+((K=+j(K))-v)*(s*K<s*v?i:O),z(F?Math.max(0,Math.min(1,K)):K))}Y.domain=function(K){return arguments.length?([e,t,a]=K,f=j(e=+e),v=j(t=+t),S=j(a=+a),i=f===v?0:.5/(v-f),O=v===S?0:.5/(S-v),s=v<f?-1:1,Y):[e,t,a]},Y.clamp=function(K){return arguments.length?(F=!!K,Y):F},Y.interpolator=function(K){return arguments.length?(z=K,Y):z};function X(K){return function(ne){var se,ge,_e;return arguments.length?([se,ge,_e]=ne,z=yae(K,[se,ge,_e]),Y):[z(0),z(.5),z(1)]}}return Y.range=X(Vg),Y.rangeRound=X(h4),Y.unknown=function(K){return arguments.length?(G=K,Y):G},function(K){return j=K,f=K(e),v=K(t),S=K(a),i=f===v?0:.5/(v-f),O=v===S?0:.5/(S-v),s=v<f?-1:1,Y}}function MN(){var e=Xp(yw()(Gs));return e.copy=function(){return Yp(e,MN())},Ld.apply(e,arguments)}function ON(){var e=m4(yw()).domain([.1,1,10]);return e.copy=function(){return Yp(e,ON()).base(e.base())},Ld.apply(e,arguments)}function IN(){var e=_4(yw());return e.copy=function(){return Yp(e,IN()).constant(e.constant())},Ld.apply(e,arguments)}function M4(){var e=g4(yw());return e.copy=function(){return Yp(e,M4()).exponent(e.exponent())},Ld.apply(e,arguments)}function sse(){return M4.apply(null,arguments).exponent(.5)}const B9=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:Kv,scaleDiverging:MN,scaleDivergingLog:ON,scaleDivergingPow:M4,scaleDivergingSqrt:sse,scaleDivergingSymlog:IN,scaleIdentity:lN,scaleImplicit:gM,scaleLinear:ab,scaleLog:uN,scaleOrdinal:l4,scalePoint:Ov,scalePow:y4,scaleQuantile:dN,scaleQuantize:pN,scaleRadial:fN,scaleSequential:TN,scaleSequentialLog:EN,scaleSequentialPow:C4,scaleSequentialQuantile:CN,scaleSequentialSqrt:ose,scaleSequentialSymlog:AN,scaleSqrt:Uae,scaleSymlog:hN,scaleThreshold:mN,scaleTime:ise,scaleUtc:ase,tickFormat:sN},Symbol.toStringTag,{value:"Module"}));var BA,N9;function vw(){if(N9)return BA;N9=1;var e=Fg();function t(a,s,f){for(var v=-1,S=a.length;++v<S;){var i=a[v],O=s(i);if(O!=null&&(z===void 0?O===O&&!e(O):f(O,z)))var z=O,j=i}return j}return BA=t,BA}var NA,F9;function PN(){if(F9)return NA;F9=1;function e(t,a){return t>a}return NA=e,NA}var FA,j9;function lse(){if(j9)return FA;j9=1;var e=vw(),t=PN(),a=Ug();function s(f){return f&&f.length?e(f,a,t):void 0}return FA=s,FA}var cse=lse();const xw=Ei(cse);var jA,U9;function RN(){if(U9)return jA;U9=1;function e(t,a){return t<a}return jA=e,jA}var UA,V9;function use(){if(V9)return UA;V9=1;var e=vw(),t=RN(),a=Ug();function s(f){return f&&f.length?e(f,a,t):void 0}return UA=s,UA}var hse=use();const bw=Ei(hse);var VA,$9;function fse(){if($9)return VA;$9=1;var e=q5(),t=sf(),a=FB(),s=pl();function f(v,S){var i=s(v)?e:a;return i(v,t(S,3))}return VA=f,VA}var $A,q9;function dse(){if(q9)return $A;q9=1;var e=BB(),t=fse();function a(s,f){return e(t(s,f),1)}return $A=a,$A}var pse=dse();const mse=Ei(pse);var qA,G9;function _se(){if(G9)return qA;G9=1;var e=r4();function t(a,s){return e(a,s)}return qA=t,qA}var gse=_se();const O4=Ei(gse);var $g=1e9,yse={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},P4,sa=!0,tu="[DecimalError] ",g0=tu+"Invalid argument: ",I4=tu+"Exponent out of range: ",qg=Math.floor,h0=Math.pow,vse=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Yl,Po=1e7,Qi=7,DN=9007199254740991,cb=qg(DN/Qi),Vn={};Vn.absoluteValue=Vn.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};Vn.comparedTo=Vn.cmp=function(e){var t,a,s,f,v=this;if(e=new v.constructor(e),v.s!==e.s)return v.s||-e.s;if(v.e!==e.e)return v.e>e.e^v.s<0?1:-1;for(s=v.d.length,f=e.d.length,t=0,a=s<f?s:f;t<a;++t)if(v.d[t]!==e.d[t])return v.d[t]>e.d[t]^v.s<0?1:-1;return s===f?0:s>f^v.s<0?1:-1};Vn.decimalPlaces=Vn.dp=function(){var e=this,t=e.d.length-1,a=(t-e.e)*Qi;if(t=e.d[t],t)for(;t%10==0;t/=10)a--;return a<0?0:a};Vn.dividedBy=Vn.div=function(e){return Sd(this,new this.constructor(e))};Vn.dividedToIntegerBy=Vn.idiv=function(e){var t=this,a=t.constructor;return Ui(Sd(t,new a(e),0,1),a.precision)};Vn.equals=Vn.eq=function(e){return!this.cmp(e)};Vn.exponent=function(){return io(this)};Vn.greaterThan=Vn.gt=function(e){return this.cmp(e)>0};Vn.greaterThanOrEqualTo=Vn.gte=function(e){return this.cmp(e)>=0};Vn.isInteger=Vn.isint=function(){return this.e>this.d.length-2};Vn.isNegative=Vn.isneg=function(){return this.s<0};Vn.isPositive=Vn.ispos=function(){return this.s>0};Vn.isZero=function(){return this.s===0};Vn.lessThan=Vn.lt=function(e){return this.cmp(e)<0};Vn.lessThanOrEqualTo=Vn.lte=function(e){return this.cmp(e)<1};Vn.logarithm=Vn.log=function(e){var t,a=this,s=a.constructor,f=s.precision,v=f+5;if(e===void 0)e=new s(10);else if(e=new s(e),e.s<1||e.eq(Yl))throw Error(tu+"NaN");if(a.s<1)throw Error(tu+(a.s?"NaN":"-Infinity"));return a.eq(Yl)?new s(0):(sa=!1,t=Sd(n1(a,v),n1(e,v),v),sa=!0,Ui(t,f))};Vn.minus=Vn.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?kN(t,e):LN(t,(e.s=-e.s,e))};Vn.modulo=Vn.mod=function(e){var t,a=this,s=a.constructor,f=s.precision;if(e=new s(e),!e.s)throw Error(tu+"NaN");return a.s?(sa=!1,t=Sd(a,e,0,1).times(e),sa=!0,a.minus(t)):Ui(new s(a),f)};Vn.naturalExponential=Vn.exp=function(){return zN(this)};Vn.naturalLogarithm=Vn.ln=function(){return n1(this)};Vn.negated=Vn.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};Vn.plus=Vn.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?LN(t,e):kN(t,(e.s=-e.s,e))};Vn.precision=Vn.sd=function(e){var t,a,s,f=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(g0+e);if(t=io(f)+1,s=f.d.length-1,a=s*Qi+1,s=f.d[s],s){for(;s%10==0;s/=10)a--;for(s=f.d[0];s>=10;s/=10)a++}return e&&t>a?t:a};Vn.squareRoot=Vn.sqrt=function(){var e,t,a,s,f,v,S,i=this,O=i.constructor;if(i.s<1){if(!i.s)return new O(0);throw Error(tu+"NaN")}for(e=io(i),sa=!1,f=Math.sqrt(+i),f==0||f==1/0?(t=Jh(i.d),(t.length+e)%2==0&&(t+="0"),f=Math.sqrt(t),e=qg((e+1)/2)-(e<0||e%2),f==1/0?t="5e"+e:(t=f.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),s=new O(t)):s=new O(f.toString()),a=O.precision,f=S=a+3;;)if(v=s,s=v.plus(Sd(i,v,S+2)).times(.5),Jh(v.d).slice(0,S)===(t=Jh(s.d)).slice(0,S)){if(t=t.slice(S-3,S+1),f==S&&t=="4999"){if(Ui(v,a+1,0),v.times(v).eq(i)){s=v;break}}else if(t!="9999")break;S+=4}return sa=!0,Ui(s,a)};Vn.times=Vn.mul=function(e){var t,a,s,f,v,S,i,O,z,j=this,F=j.constructor,G=j.d,Y=(e=new F(e)).d;if(!j.s||!e.s)return new F(0);for(e.s*=j.s,a=j.e+e.e,O=G.length,z=Y.length,O<z&&(v=G,G=Y,Y=v,S=O,O=z,z=S),v=[],S=O+z,s=S;s--;)v.push(0);for(s=z;--s>=0;){for(t=0,f=O+s;f>s;)i=v[f]+Y[s]*G[f-s-1]+t,v[f--]=i%Po|0,t=i/Po|0;v[f]=(v[f]+t)%Po|0}for(;!v[--S];)v.pop();return t?++a:v.shift(),e.d=v,e.e=a,sa?Ui(e,F.precision):e};Vn.toDecimalPlaces=Vn.todp=function(e,t){var a=this,s=a.constructor;return a=new s(a),e===void 0?a:(rf(e,0,$g),t===void 0?t=s.rounding:rf(t,0,8),Ui(a,e+io(a)+1,t))};Vn.toExponential=function(e,t){var a,s=this,f=s.constructor;return e===void 0?a=b0(s,!0):(rf(e,0,$g),t===void 0?t=f.rounding:rf(t,0,8),s=Ui(new f(s),e+1,t),a=b0(s,!0,e+1)),a};Vn.toFixed=function(e,t){var a,s,f=this,v=f.constructor;return e===void 0?b0(f):(rf(e,0,$g),t===void 0?t=v.rounding:rf(t,0,8),s=Ui(new v(f),e+io(f)+1,t),a=b0(s.abs(),!1,e+io(s)+1),f.isneg()&&!f.isZero()?"-"+a:a)};Vn.toInteger=Vn.toint=function(){var e=this,t=e.constructor;return Ui(new t(e),io(e)+1,t.rounding)};Vn.toNumber=function(){return+this};Vn.toPower=Vn.pow=function(e){var t,a,s,f,v,S,i=this,O=i.constructor,z=12,j=+(e=new O(e));if(!e.s)return new O(Yl);if(i=new O(i),!i.s){if(e.s<1)throw Error(tu+"Infinity");return i}if(i.eq(Yl))return i;if(s=O.precision,e.eq(Yl))return Ui(i,s);if(t=e.e,a=e.d.length-1,S=t>=a,v=i.s,S){if((a=j<0?-j:j)<=DN){for(f=new O(Yl),t=Math.ceil(s/Qi+4),sa=!1;a%2&&(f=f.times(i),Z9(f.d,t)),a=qg(a/2),a!==0;)i=i.times(i),Z9(i.d,t);return sa=!0,e.s<0?new O(Yl).div(f):Ui(f,s)}}else if(v<0)throw Error(tu+"NaN");return v=v<0&&e.d[Math.max(t,a)]&1?-1:1,i.s=1,sa=!1,f=e.times(n1(i,s+z)),sa=!0,f=zN(f),f.s=v,f};Vn.toPrecision=function(e,t){var a,s,f=this,v=f.constructor;return e===void 0?(a=io(f),s=b0(f,a<=v.toExpNeg||a>=v.toExpPos)):(rf(e,1,$g),t===void 0?t=v.rounding:rf(t,0,8),f=Ui(new v(f),e,t),a=io(f),s=b0(f,e<=a||a<=v.toExpNeg,e)),s};Vn.toSignificantDigits=Vn.tosd=function(e,t){var a=this,s=a.constructor;return e===void 0?(e=s.precision,t=s.rounding):(rf(e,1,$g),t===void 0?t=s.rounding:rf(t,0,8)),Ui(new s(a),e,t)};Vn.toString=Vn.valueOf=Vn.val=Vn.toJSON=Vn[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=io(e),a=e.constructor;return b0(e,t<=a.toExpNeg||t>=a.toExpPos)};function LN(e,t){var a,s,f,v,S,i,O,z,j=e.constructor,F=j.precision;if(!e.s||!t.s)return t.s||(t=new j(e)),sa?Ui(t,F):t;if(O=e.d,z=t.d,S=e.e,f=t.e,O=O.slice(),v=S-f,v){for(v<0?(s=O,v=-v,i=z.length):(s=z,f=S,i=O.length),S=Math.ceil(F/Qi),i=S>i?S+1:i+1,v>i&&(v=i,s.length=1),s.reverse();v--;)s.push(0);s.reverse()}for(i=O.length,v=z.length,i-v<0&&(v=i,s=z,z=O,O=s),a=0;v;)a=(O[--v]=O[v]+z[v]+a)/Po|0,O[v]%=Po;for(a&&(O.unshift(a),++f),i=O.length;O[--i]==0;)O.pop();return t.d=O,t.e=f,sa?Ui(t,F):t}function rf(e,t,a){if(e!==~~e||e<t||e>a)throw Error(g0+e)}function Jh(e){var t,a,s,f=e.length-1,v="",S=e[0];if(f>0){for(v+=S,t=1;t<f;t++)s=e[t]+"",a=Qi-s.length,a&&(v+=jp(a)),v+=s;S=e[t],s=S+"",a=Qi-s.length,a&&(v+=jp(a))}else if(S===0)return"0";for(;S%10===0;)S/=10;return v+S}var Sd=function(){function e(s,f){var v,S=0,i=s.length;for(s=s.slice();i--;)v=s[i]*f+S,s[i]=v%Po|0,S=v/Po|0;return S&&s.unshift(S),s}function t(s,f,v,S){var i,O;if(v!=S)O=v>S?1:-1;else for(i=O=0;i<v;i++)if(s[i]!=f[i]){O=s[i]>f[i]?1:-1;break}return O}function a(s,f,v){for(var S=0;v--;)s[v]-=S,S=s[v]<f[v]?1:0,s[v]=S*Po+s[v]-f[v];for(;!s[0]&&s.length>1;)s.shift()}return function(s,f,v,S){var i,O,z,j,F,G,Y,X,K,ne,se,ge,_e,xe,ae,ve,Se,He,Ge=s.constructor,ye=s.s==f.s?1:-1,Le=s.d,ht=f.d;if(!s.s)return new Ge(s);if(!f.s)throw Error(tu+"Division by zero");for(O=s.e-f.e,Se=ht.length,ae=Le.length,Y=new Ge(ye),X=Y.d=[],z=0;ht[z]==(Le[z]||0);)++z;if(ht[z]>(Le[z]||0)&&--O,v==null?ge=v=Ge.precision:S?ge=v+(io(s)-io(f))+1:ge=v,ge<0)return new Ge(0);if(ge=ge/Qi+2|0,z=0,Se==1)for(j=0,ht=ht[0],ge++;(z<ae||j)&&ge--;z++)_e=j*Po+(Le[z]||0),X[z]=_e/ht|0,j=_e%ht|0;else{for(j=Po/(ht[0]+1)|0,j>1&&(ht=e(ht,j),Le=e(Le,j),Se=ht.length,ae=Le.length),xe=Se,K=Le.slice(0,Se),ne=K.length;ne<Se;)K[ne++]=0;He=ht.slice(),He.unshift(0),ve=ht[0],ht[1]>=Po/2&&++ve;do j=0,i=t(ht,K,Se,ne),i<0?(se=K[0],Se!=ne&&(se=se*Po+(K[1]||0)),j=se/ve|0,j>1?(j>=Po&&(j=Po-1),F=e(ht,j),G=F.length,ne=K.length,i=t(F,K,G,ne),i==1&&(j--,a(F,Se<G?He:ht,G))):(j==0&&(i=j=1),F=ht.slice()),G=F.length,G<ne&&F.unshift(0),a(K,F,ne),i==-1&&(ne=K.length,i=t(ht,K,Se,ne),i<1&&(j++,a(K,Se<ne?He:ht,ne))),ne=K.length):i===0&&(j++,K=[0]),X[z++]=j,i&&K[0]?K[ne++]=Le[xe]||0:(K=[Le[xe]],ne=1);while((xe++<ae||K[0]!==void 0)&&ge--)}return X[0]||X.shift(),Y.e=O,Ui(Y,S?v+io(Y)+1:v)}}();function zN(e,t){var a,s,f,v,S,i,O=0,z=0,j=e.constructor,F=j.precision;if(io(e)>16)throw Error(I4+io(e));if(!e.s)return new j(Yl);for(sa=!1,i=F,S=new j(.03125);e.abs().gte(.1);)e=e.times(S),z+=5;for(s=Math.log(h0(2,z))/Math.LN10*2+5|0,i+=s,a=f=v=new j(Yl),j.precision=i;;){if(f=Ui(f.times(e),i),a=a.times(++O),S=v.plus(Sd(f,a,i)),Jh(S.d).slice(0,i)===Jh(v.d).slice(0,i)){for(;z--;)v=Ui(v.times(v),i);return j.precision=F,t==null?(sa=!0,Ui(v,F)):v}v=S}}function io(e){for(var t=e.e*Qi,a=e.d[0];a>=10;a/=10)t++;return t}function GA(e,t,a){if(t>e.LN10.sd())throw sa=!0,a&&(e.precision=a),Error(tu+"LN10 precision limit exceeded");return Ui(new e(e.LN10),t)}function jp(e){for(var t="";e--;)t+="0";return t}function n1(e,t){var a,s,f,v,S,i,O,z,j,F=1,G=10,Y=e,X=Y.d,K=Y.constructor,ne=K.precision;if(Y.s<1)throw Error(tu+(Y.s?"NaN":"-Infinity"));if(Y.eq(Yl))return new K(0);if(t==null?(sa=!1,z=ne):z=t,Y.eq(10))return t==null&&(sa=!0),GA(K,z);if(z+=G,K.precision=z,a=Jh(X),s=a.charAt(0),v=io(Y),Math.abs(v)<15e14){for(;s<7&&s!=1||s==1&&a.charAt(1)>3;)Y=Y.times(e),a=Jh(Y.d),s=a.charAt(0),F++;v=io(Y),s>1?(Y=new K("0."+a),v++):Y=new K(s+"."+a.slice(1))}else return O=GA(K,z+2,ne).times(v+""),Y=n1(new K(s+"."+a.slice(1)),z-G).plus(O),K.precision=ne,t==null?(sa=!0,Ui(Y,ne)):Y;for(i=S=Y=Sd(Y.minus(Yl),Y.plus(Yl),z),j=Ui(Y.times(Y),z),f=3;;){if(S=Ui(S.times(j),z),O=i.plus(Sd(S,new K(f),z)),Jh(O.d).slice(0,z)===Jh(i.d).slice(0,z))return i=i.times(2),v!==0&&(i=i.plus(GA(K,z+2,ne).times(v+""))),i=Sd(i,new K(F),z),K.precision=ne,t==null?(sa=!0,Ui(i,ne)):i;i=O,f+=2}}function H9(e,t){var a,s,f;for((a=t.indexOf("."))>-1&&(t=t.replace(".","")),(s=t.search(/e/i))>0?(a<0&&(a=s),a+=+t.slice(s+1),t=t.substring(0,s)):a<0&&(a=t.length),s=0;t.charCodeAt(s)===48;)++s;for(f=t.length;t.charCodeAt(f-1)===48;)--f;if(t=t.slice(s,f),t){if(f-=s,a=a-s-1,e.e=qg(a/Qi),e.d=[],s=(a+1)%Qi,a<0&&(s+=Qi),s<f){for(s&&e.d.push(+t.slice(0,s)),f-=Qi;s<f;)e.d.push(+t.slice(s,s+=Qi));t=t.slice(s),s=Qi-t.length}else s-=f;for(;s--;)t+="0";if(e.d.push(+t),sa&&(e.e>cb||e.e<-cb))throw Error(I4+a)}else e.s=0,e.e=0,e.d=[0];return e}function Ui(e,t,a){var s,f,v,S,i,O,z,j,F=e.d;for(S=1,v=F[0];v>=10;v/=10)S++;if(s=t-S,s<0)s+=Qi,f=t,z=F[j=0];else{if(j=Math.ceil((s+1)/Qi),v=F.length,j>=v)return e;for(z=v=F[j],S=1;v>=10;v/=10)S++;s%=Qi,f=s-Qi+S}if(a!==void 0&&(v=h0(10,S-f-1),i=z/v%10|0,O=t<0||F[j+1]!==void 0||z%v,O=a<4?(i||O)&&(a==0||a==(e.s<0?3:2)):i>5||i==5&&(a==4||O||a==6&&(s>0?f>0?z/h0(10,S-f):0:F[j-1])%10&1||a==(e.s<0?8:7))),t<1||!F[0])return O?(v=io(e),F.length=1,t=t-v-1,F[0]=h0(10,(Qi-t%Qi)%Qi),e.e=qg(-t/Qi)||0):(F.length=1,F[0]=e.e=e.s=0),e;if(s==0?(F.length=j,v=1,j--):(F.length=j+1,v=h0(10,Qi-s),F[j]=f>0?(z/h0(10,S-f)%h0(10,f)|0)*v:0),O)for(;;)if(j==0){(F[0]+=v)==Po&&(F[0]=1,++e.e);break}else{if(F[j]+=v,F[j]!=Po)break;F[j--]=0,v=1}for(s=F.length;F[--s]===0;)F.pop();if(sa&&(e.e>cb||e.e<-cb))throw Error(I4+io(e));return e}function kN(e,t){var a,s,f,v,S,i,O,z,j,F,G=e.constructor,Y=G.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new G(e),sa?Ui(t,Y):t;if(O=e.d,F=t.d,s=t.e,z=e.e,O=O.slice(),S=z-s,S){for(j=S<0,j?(a=O,S=-S,i=F.length):(a=F,s=z,i=O.length),f=Math.max(Math.ceil(Y/Qi),i)+2,S>f&&(S=f,a.length=1),a.reverse(),f=S;f--;)a.push(0);a.reverse()}else{for(f=O.length,i=F.length,j=f<i,j&&(i=f),f=0;f<i;f++)if(O[f]!=F[f]){j=O[f]<F[f];break}S=0}for(j&&(a=O,O=F,F=a,t.s=-t.s),i=O.length,f=F.length-i;f>0;--f)O[i++]=0;for(f=F.length;f>S;){if(O[--f]<F[f]){for(v=f;v&&O[--v]===0;)O[v]=Po-1;--O[v],O[f]+=Po}O[f]-=F[f]}for(;O[--i]===0;)O.pop();for(;O[0]===0;O.shift())--s;return O[0]?(t.d=O,t.e=s,sa?Ui(t,Y):t):new G(0)}function b0(e,t,a){var s,f=io(e),v=Jh(e.d),S=v.length;return t?(a&&(s=a-S)>0?v=v.charAt(0)+"."+v.slice(1)+jp(s):S>1&&(v=v.charAt(0)+"."+v.slice(1)),v=v+(f<0?"e":"e+")+f):f<0?(v="0."+jp(-f-1)+v,a&&(s=a-S)>0&&(v+=jp(s))):f>=S?(v+=jp(f+1-S),a&&(s=a-f-1)>0&&(v=v+"."+jp(s))):((s=f+1)<S&&(v=v.slice(0,s)+"."+v.slice(s)),a&&(s=a-S)>0&&(f+1===S&&(v+="."),v+=jp(s))),e.s<0?"-"+v:v}function Z9(e,t){if(e.length>t)return e.length=t,!0}function BN(e){var t,a,s;function f(v){var S=this;if(!(S instanceof f))return new f(v);if(S.constructor=f,v instanceof f){S.s=v.s,S.e=v.e,S.d=(v=v.d)?v.slice():v;return}if(typeof v=="number"){if(v*0!==0)throw Error(g0+v);if(v>0)S.s=1;else if(v<0)v=-v,S.s=-1;else{S.s=0,S.e=0,S.d=[0];return}if(v===~~v&&v<1e7){S.e=0,S.d=[v];return}return H9(S,v.toString())}else if(typeof v!="string")throw Error(g0+v);if(v.charCodeAt(0)===45?(v=v.slice(1),S.s=-1):S.s=1,vse.test(v))H9(S,v);else throw Error(g0+v)}if(f.prototype=Vn,f.ROUND_UP=0,f.ROUND_DOWN=1,f.ROUND_CEIL=2,f.ROUND_FLOOR=3,f.ROUND_HALF_UP=4,f.ROUND_HALF_DOWN=5,f.ROUND_HALF_EVEN=6,f.ROUND_HALF_CEIL=7,f.ROUND_HALF_FLOOR=8,f.clone=BN,f.config=f.set=xse,e===void 0&&(e={}),e)for(s=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<s.length;)e.hasOwnProperty(a=s[t++])||(e[a]=this[a]);return f.config(e),f}function xse(e){if(!e||typeof e!="object")throw Error(tu+"Object expected");var t,a,s,f=["precision",1,$g,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<f.length;t+=3)if((s=e[a=f[t]])!==void 0)if(qg(s)===s&&s>=f[t+1]&&s<=f[t+2])this[a]=s;else throw Error(g0+a+": "+s);if((s=e[a="LN10"])!==void 0)if(s==Math.LN10)this[a]=new this(s);else throw Error(g0+a+": "+s);return this}var P4=BN(yse);Yl=new P4(1);const zi=P4;function bse(e){return Ese(e)||Tse(e)||Sse(e)||wse()}function wse(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Sse(e,t){if(e){if(typeof e=="string")return bM(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return bM(e,t)}}function Tse(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function Ese(e){if(Array.isArray(e))return bM(e)}function bM(e,t){(t==null||t>e.length)&&(t=e.length);for(var a=0,s=new Array(t);a<t;a++)s[a]=e[a];return s}var Ase=function(t){return t},NN={},FN=function(t){return t===NN},W9=function(t){return function a(){return arguments.length===0||arguments.length===1&&FN(arguments.length<=0?void 0:arguments[0])?a:t.apply(void 0,arguments)}},Cse=function e(t,a){return t===1?a:W9(function(){for(var s=arguments.length,f=new Array(s),v=0;v<s;v++)f[v]=arguments[v];var S=f.filter(function(i){return i!==NN}).length;return S>=t?a.apply(void 0,f):e(t-S,W9(function(){for(var i=arguments.length,O=new Array(i),z=0;z<i;z++)O[z]=arguments[z];var j=f.map(function(F){return FN(F)?O.shift():F});return a.apply(void 0,bse(j).concat(O))}))})},ww=function(t){return Cse(t.length,t)},wM=function(t,a){for(var s=[],f=t;f<a;++f)s[f-t]=f;return s},Mse=ww(function(e,t){return Array.isArray(t)?t.map(e):Object.keys(t).map(function(a){return t[a]}).map(e)}),Ose=function(){for(var t=arguments.length,a=new Array(t),s=0;s<t;s++)a[s]=arguments[s];if(!a.length)return Ase;var f=a.reverse(),v=f[0],S=f.slice(1);return function(){return S.reduce(function(i,O){return O(i)},v.apply(void 0,arguments))}},SM=function(t){return Array.isArray(t)?t.reverse():t.split("").reverse.join("")},jN=function(t){var a=null,s=null;return function(){for(var f=arguments.length,v=new Array(f),S=0;S<f;S++)v[S]=arguments[S];return a&&v.every(function(i,O){return i===a[O]})||(a=v,s=t.apply(void 0,v)),s}};function Ise(e){var t;return e===0?t=1:t=Math.floor(new zi(e).abs().log(10).toNumber())+1,t}function Pse(e,t,a){for(var s=new zi(e),f=0,v=[];s.lt(t)&&f<1e5;)v.push(s.toNumber()),s=s.add(a),f++;return v}var Rse=ww(function(e,t,a){var s=+e,f=+t;return s+a*(f-s)}),Dse=ww(function(e,t,a){var s=t-+e;return s=s||1/0,(a-e)/s}),Lse=ww(function(e,t,a){var s=t-+e;return s=s||1/0,Math.max(0,Math.min(1,(a-e)/s))});const Sw={rangeStep:Pse,getDigitCount:Ise,interpolateNumber:Rse,uninterpolateNumber:Dse,uninterpolateTruncation:Lse};function TM(e){return Bse(e)||kse(e)||UN(e)||zse()}function zse(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function kse(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function Bse(e){if(Array.isArray(e))return EM(e)}function r1(e,t){return jse(e)||Fse(e,t)||UN(e,t)||Nse()}function Nse(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function UN(e,t){if(e){if(typeof e=="string")return EM(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return EM(e,t)}}function EM(e,t){(t==null||t>e.length)&&(t=e.length);for(var a=0,s=new Array(t);a<t;a++)s[a]=e[a];return s}function Fse(e,t){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(e)))){var a=[],s=!0,f=!1,v=void 0;try{for(var S=e[Symbol.iterator](),i;!(s=(i=S.next()).done)&&(a.push(i.value),!(t&&a.length===t));s=!0);}catch(O){f=!0,v=O}finally{try{!s&&S.return!=null&&S.return()}finally{if(f)throw v}}return a}}function jse(e){if(Array.isArray(e))return e}function VN(e){var t=r1(e,2),a=t[0],s=t[1],f=a,v=s;return a>s&&(f=s,v=a),[f,v]}function $N(e,t,a){if(e.lte(0))return new zi(0);var s=Sw.getDigitCount(e.toNumber()),f=new zi(10).pow(s),v=e.div(f),S=s!==1?.05:.1,i=new zi(Math.ceil(v.div(S).toNumber())).add(a).mul(S),O=i.mul(f);return t?O:new zi(Math.ceil(O))}function Use(e,t,a){var s=1,f=new zi(e);if(!f.isint()&&a){var v=Math.abs(e);v<1?(s=new zi(10).pow(Sw.getDigitCount(e)-1),f=new zi(Math.floor(f.div(s).toNumber())).mul(s)):v>1&&(f=new zi(Math.floor(e)))}else e===0?f=new zi(Math.floor((t-1)/2)):a||(f=new zi(Math.floor(e)));var S=Math.floor((t-1)/2),i=Ose(Mse(function(O){return f.add(new zi(O-S).mul(s)).toNumber()}),wM);return i(0,t)}function qN(e,t,a,s){var f=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((t-e)/(a-1)))return{step:new zi(0),tickMin:new zi(0),tickMax:new zi(0)};var v=$N(new zi(t).sub(e).div(a-1),s,f),S;e<=0&&t>=0?S=new zi(0):(S=new zi(e).add(t).div(2),S=S.sub(new zi(S).mod(v)));var i=Math.ceil(S.sub(e).div(v).toNumber()),O=Math.ceil(new zi(t).sub(S).div(v).toNumber()),z=i+O+1;return z>a?qN(e,t,a,s,f+1):(z<a&&(O=t>0?O+(a-z):O,i=t>0?i:i+(a-z)),{step:v,tickMin:S.sub(new zi(i).mul(v)),tickMax:S.add(new zi(O).mul(v))})}function Vse(e){var t=r1(e,2),a=t[0],s=t[1],f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,v=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,S=Math.max(f,2),i=VN([a,s]),O=r1(i,2),z=O[0],j=O[1];if(z===-1/0||j===1/0){var F=j===1/0?[z].concat(TM(wM(0,f-1).map(function(){return 1/0}))):[].concat(TM(wM(0,f-1).map(function(){return-1/0})),[j]);return a>s?SM(F):F}if(z===j)return Use(z,f,v);var G=qN(z,j,S,v),Y=G.step,X=G.tickMin,K=G.tickMax,ne=Sw.rangeStep(X,K.add(new zi(.1).mul(Y)),Y);return a>s?SM(ne):ne}function $se(e,t){var a=r1(e,2),s=a[0],f=a[1],v=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,S=VN([s,f]),i=r1(S,2),O=i[0],z=i[1];if(O===-1/0||z===1/0)return[s,f];if(O===z)return[O];var j=Math.max(t,2),F=$N(new zi(z).sub(O).div(j-1),v,0),G=[].concat(TM(Sw.rangeStep(new zi(O),new zi(z).sub(new zi(.99).mul(F)),F)),[z]);return s>f?SM(G):G}var qse=jN(Vse),Gse=jN($se),Hse="Invariant failed";function wg(e,t){throw new Error(Hse)}var Zse=["offset","layout","width","dataKey","data","dataPointFormatter","xAxis","yAxis"];function Sg(e){"@babel/helpers - typeof";return Sg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sg(e)}function ub(){return ub=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},ub.apply(this,arguments)}function Wse(e,t){return Jse(e)||Kse(e,t)||Yse(e,t)||Xse()}function Xse(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Yse(e,t){if(e){if(typeof e=="string")return X9(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return X9(e,t)}}function X9(e,t){(t==null||t>e.length)&&(t=e.length);for(var a=0,s=new Array(t);a<t;a++)s[a]=e[a];return s}function Kse(e,t){var a=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(a!=null){var s,f,v,S,i=[],O=!0,z=!1;try{if(v=(a=a.call(e)).next,t!==0)for(;!(O=(s=v.call(a)).done)&&(i.push(s.value),i.length!==t);O=!0);}catch(j){z=!0,f=j}finally{try{if(!O&&a.return!=null&&(S=a.return(),Object(S)!==S))return}finally{if(z)throw f}}return i}}function Jse(e){if(Array.isArray(e))return e}function Qse(e,t){if(e==null)return{};var a=ele(e,t),s,f;if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(e);for(f=0;f<v.length;f++)s=v[f],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(a[s]=e[s])}return a}function ele(e,t){if(e==null)return{};var a={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(t.indexOf(s)>=0)continue;a[s]=e[s]}return a}function tle(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nle(e,t){for(var a=0;a<t.length;a++){var s=t[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,ZN(s.key),s)}}function rle(e,t,a){return t&&nle(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function ile(e,t,a){return t=hb(t),ale(e,GN()?Reflect.construct(t,a||[],hb(e).constructor):t.apply(e,a))}function ale(e,t){if(t&&(Sg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ole(e)}function ole(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function GN(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(GN=function(){return!!e})()}function hb(e){return hb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)},hb(e)}function sle(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&AM(e,t)}function AM(e,t){return AM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,f){return s.__proto__=f,s},AM(e,t)}function HN(e,t,a){return t=ZN(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function ZN(e){var t=lle(e,"string");return Sg(t)=="symbol"?t:t+""}function lle(e,t){if(Sg(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var s=a.call(e,t);if(Sg(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var R4=function(e){function t(){return tle(this,t),ile(this,t,arguments)}return sle(t,e),rle(t,[{key:"render",value:function(){var s=this.props,f=s.offset,v=s.layout,S=s.width,i=s.dataKey,O=s.data,z=s.dataPointFormatter,j=s.xAxis,F=s.yAxis,G=Qse(s,Zse),Y=Fr(G,!1);this.props.direction==="x"&&j.type!=="number"&&wg();var X=O.map(function(K){var ne=z(K,i),se=ne.x,ge=ne.y,_e=ne.value,xe=ne.errorVal;if(!xe)return null;var ae=[],ve,Se;if(Array.isArray(xe)){var He=Wse(xe,2);ve=He[0],Se=He[1]}else ve=Se=xe;if(v==="vertical"){var Ge=j.scale,ye=ge+f,Le=ye+S,ht=ye-S,gt=Ge(_e-ve),Ft=Ge(_e+Se);ae.push({x1:Ft,y1:Le,x2:Ft,y2:ht}),ae.push({x1:gt,y1:ye,x2:Ft,y2:ye}),ae.push({x1:gt,y1:Le,x2:gt,y2:ht})}else if(v==="horizontal"){var _t=F.scale,yt=se+f,Vt=yt-S,Ht=yt+S,Bt=_t(_e-ve),et=_t(_e+Se);ae.push({x1:Vt,y1:et,x2:Ht,y2:et}),ae.push({x1:yt,y1:Bt,x2:yt,y2:et}),ae.push({x1:Vt,y1:Bt,x2:Ht,y2:Bt})}return Ot.createElement(Ua,ub({className:"recharts-errorBar",key:"bar-".concat(ae.map(function($t){return"".concat($t.x1,"-").concat($t.x2,"-").concat($t.y1,"-").concat($t.y2)}))},Y),ae.map(function($t){return Ot.createElement("line",ub({},$t,{key:"line-".concat($t.x1,"-").concat($t.x2,"-").concat($t.y1,"-").concat($t.y2)}))}))});return Ot.createElement(Ua,{className:"recharts-errorBars"},X)}}])}(Ot.Component);HN(R4,"defaultProps",{stroke:"black",strokeWidth:1.5,width:5,offset:0,layout:"horizontal"});HN(R4,"displayName","ErrorBar");function i1(e){"@babel/helpers - typeof";return i1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i1(e)}function Y9(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(f){return Object.getOwnPropertyDescriptor(e,f).enumerable})),a.push.apply(a,s)}return a}function o0(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?Y9(Object(a),!0).forEach(function(s){cle(e,s,a[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Y9(Object(a)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(a,s))})}return e}function cle(e,t,a){return t=ule(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function ule(e){var t=hle(e,"string");return i1(t)=="symbol"?t:t+""}function hle(e,t){if(i1(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var s=a.call(e,t);if(i1(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var WN=function(t){var a=t.children,s=t.formattedGraphicalItems,f=t.legendWidth,v=t.legendContent,S=Yc(a,ag);if(!S)return null;var i=ag.defaultProps,O=i!==void 0?o0(o0({},i),S.props):{},z;return S.props&&S.props.payload?z=S.props&&S.props.payload:v==="children"?z=(s||[]).reduce(function(j,F){var G=F.item,Y=F.props,X=Y.sectors||Y.data||[];return j.concat(X.map(function(K){return{type:S.props.iconType||G.props.legendType,value:K.name,color:K.fill,payload:K}}))},[]):z=(s||[]).map(function(j){var F=j.item,G=F.type.defaultProps,Y=G!==void 0?o0(o0({},G),F.props):{},X=Y.dataKey,K=Y.name,ne=Y.legendType,se=Y.hide;return{inactive:se,dataKey:X,type:O.iconType||ne||"square",color:D4(F),value:K||X,payload:Y}}),o0(o0(o0({},O),ag.getWithHeight(S,f)),{},{payload:z,item:S})};function a1(e){"@babel/helpers - typeof";return a1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a1(e)}function K9(e){return mle(e)||ple(e)||dle(e)||fle()}function fle(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function dle(e,t){if(e){if(typeof e=="string")return CM(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return CM(e,t)}}function ple(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function mle(e){if(Array.isArray(e))return CM(e)}function CM(e,t){(t==null||t>e.length)&&(t=e.length);for(var a=0,s=new Array(t);a<t;a++)s[a]=e[a];return s}function J9(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(f){return Object.getOwnPropertyDescriptor(e,f).enumerable})),a.push.apply(a,s)}return a}function ja(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?J9(Object(a),!0).forEach(function(s){sg(e,s,a[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):J9(Object(a)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(a,s))})}return e}function sg(e,t,a){return t=_le(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function _le(e){var t=gle(e,"string");return a1(t)=="symbol"?t:t+""}function gle(e,t){if(a1(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var s=a.call(e,t);if(a1(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Kl(e,t,a){return ei(e)||ei(t)?a:go(t)?Hu(e,t,a):Vr(t)?t(e):a}function Iv(e,t,a,s){var f=mse(e,function(i){return Kl(i,t)});if(a==="number"){var v=f.filter(function(i){return Nn(i)||parseFloat(i)});return v.length?[bw(v),xw(v)]:[1/0,-1/0]}var S=s?f.filter(function(i){return!ei(i)}):f;return S.map(function(i){return go(i)||i instanceof Date?i:""})}var yle=function(t){var a,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],f=arguments.length>2?arguments[2]:void 0,v=arguments.length>3?arguments[3]:void 0,S=-1,i=(a=s==null?void 0:s.length)!==null&&a!==void 0?a:0;if(i<=1)return 0;if(v&&v.axisType==="angleAxis"&&Math.abs(Math.abs(v.range[1]-v.range[0])-360)<=1e-6)for(var O=v.range,z=0;z<i;z++){var j=z>0?f[z-1].coordinate:f[i-1].coordinate,F=f[z].coordinate,G=z>=i-1?f[0].coordinate:f[z+1].coordinate,Y=void 0;if(Qc(F-j)!==Qc(G-F)){var X=[];if(Qc(G-F)===Qc(O[1]-O[0])){Y=G;var K=F+O[1]-O[0];X[0]=Math.min(K,(K+j)/2),X[1]=Math.max(K,(K+j)/2)}else{Y=j;var ne=G+O[1]-O[0];X[0]=Math.min(F,(ne+F)/2),X[1]=Math.max(F,(ne+F)/2)}var se=[Math.min(F,(Y+F)/2),Math.max(F,(Y+F)/2)];if(t>se[0]&&t<=se[1]||t>=X[0]&&t<=X[1]){S=f[z].index;break}}else{var ge=Math.min(j,G),_e=Math.max(j,G);if(t>(ge+F)/2&&t<=(_e+F)/2){S=f[z].index;break}}}else for(var xe=0;xe<i;xe++)if(xe===0&&t<=(s[xe].coordinate+s[xe+1].coordinate)/2||xe>0&&xe<i-1&&t>(s[xe].coordinate+s[xe-1].coordinate)/2&&t<=(s[xe].coordinate+s[xe+1].coordinate)/2||xe===i-1&&t>(s[xe].coordinate+s[xe-1].coordinate)/2){S=s[xe].index;break}return S},D4=function(t){var a,s=t,f=s.type.displayName,v=(a=t.type)!==null&&a!==void 0&&a.defaultProps?ja(ja({},t.type.defaultProps),t.props):t.props,S=v.stroke,i=v.fill,O;switch(f){case"Line":O=S;break;case"Area":case"Radar":O=S&&S!=="none"?S:i;break;default:O=i;break}return O},vle=function(t){var a=t.barSize,s=t.totalSize,f=t.stackGroups,v=f===void 0?{}:f;if(!v)return{};for(var S={},i=Object.keys(v),O=0,z=i.length;O<z;O++)for(var j=v[i[O]].stackGroups,F=Object.keys(j),G=0,Y=F.length;G<Y;G++){var X=j[F[G]],K=X.items,ne=X.cateAxisId,se=K.filter(function(Se){return bd(Se.type).indexOf("Bar")>=0});if(se&&se.length){var ge=se[0].type.defaultProps,_e=ge!==void 0?ja(ja({},ge),se[0].props):se[0].props,xe=_e.barSize,ae=_e[ne];S[ae]||(S[ae]=[]);var ve=ei(xe)?a:xe;S[ae].push({item:se[0],stackList:se.slice(1),barSize:ei(ve)?void 0:cl(ve,s,0)})}}return S},xle=function(t){var a=t.barGap,s=t.barCategoryGap,f=t.bandSize,v=t.sizeList,S=v===void 0?[]:v,i=t.maxBarSize,O=S.length;if(O<1)return null;var z=cl(a,f,0,!0),j,F=[];if(S[0].barSize===+S[0].barSize){var G=!1,Y=f/O,X=S.reduce(function(xe,ae){return xe+ae.barSize||0},0);X+=(O-1)*z,X>=f&&(X-=(O-1)*z,z=0),X>=f&&Y>0&&(G=!0,Y*=.9,X=O*Y);var K=(f-X)/2>>0,ne={offset:K-z,size:0};j=S.reduce(function(xe,ae){var ve={item:ae.item,position:{offset:ne.offset+ne.size+z,size:G?Y:ae.barSize}},Se=[].concat(K9(xe),[ve]);return ne=Se[Se.length-1].position,ae.stackList&&ae.stackList.length&&ae.stackList.forEach(function(He){Se.push({item:He,position:ne})}),Se},F)}else{var se=cl(s,f,0,!0);f-2*se-(O-1)*z<=0&&(z=0);var ge=(f-2*se-(O-1)*z)/O;ge>1&&(ge>>=0);var _e=i===+i?Math.min(ge,i):ge;j=S.reduce(function(xe,ae,ve){var Se=[].concat(K9(xe),[{item:ae.item,position:{offset:se+(ge+z)*ve+(ge-_e)/2,size:_e}}]);return ae.stackList&&ae.stackList.length&&ae.stackList.forEach(function(He){Se.push({item:He,position:Se[Se.length-1].position})}),Se},F)}return j},ble=function(t,a,s,f){var v=s.children,S=s.width,i=s.margin,O=S-(i.left||0)-(i.right||0),z=WN({children:v,legendWidth:O});if(z){var j=f||{},F=j.width,G=j.height,Y=z.align,X=z.verticalAlign,K=z.layout;if((K==="vertical"||K==="horizontal"&&X==="middle")&&Y!=="center"&&Nn(t[Y]))return ja(ja({},t),{},sg({},Y,t[Y]+(F||0)));if((K==="horizontal"||K==="vertical"&&Y==="center")&&X!=="middle"&&Nn(t[X]))return ja(ja({},t),{},sg({},X,t[X]+(G||0)))}return t},wle=function(t,a,s){return ei(a)?!0:t==="horizontal"?a==="yAxis":t==="vertical"||s==="x"?a==="xAxis":s==="y"?a==="yAxis":!0},XN=function(t,a,s,f,v){var S=a.props.children,i=ef(S,R4).filter(function(z){return wle(f,v,z.props.direction)});if(i&&i.length){var O=i.map(function(z){return z.props.dataKey});return t.reduce(function(z,j){var F=Kl(j,s);if(ei(F))return z;var G=Array.isArray(F)?[bw(F),xw(F)]:[F,F],Y=O.reduce(function(X,K){var ne=Kl(j,K,0),se=G[0]-Math.abs(Array.isArray(ne)?ne[0]:ne),ge=G[1]+Math.abs(Array.isArray(ne)?ne[1]:ne);return[Math.min(se,X[0]),Math.max(ge,X[1])]},[1/0,-1/0]);return[Math.min(Y[0],z[0]),Math.max(Y[1],z[1])]},[1/0,-1/0])}return null},Sle=function(t,a,s,f,v){var S=a.map(function(i){return XN(t,i,s,v,f)}).filter(function(i){return!ei(i)});return S&&S.length?S.reduce(function(i,O){return[Math.min(i[0],O[0]),Math.max(i[1],O[1])]},[1/0,-1/0]):null},YN=function(t,a,s,f,v){var S=a.map(function(O){var z=O.props.dataKey;return s==="number"&&z&&XN(t,O,z,f)||Iv(t,z,s,v)});if(s==="number")return S.reduce(function(O,z){return[Math.min(O[0],z[0]),Math.max(O[1],z[1])]},[1/0,-1/0]);var i={};return S.reduce(function(O,z){for(var j=0,F=z.length;j<F;j++)i[z[j]]||(i[z[j]]=!0,O.push(z[j]));return O},[])},KN=function(t,a){return t==="horizontal"&&a==="xAxis"||t==="vertical"&&a==="yAxis"||t==="centric"&&a==="angleAxis"||t==="radial"&&a==="radiusAxis"},Ev=function(t,a,s){if(!t)return null;var f=t.scale,v=t.duplicateDomain,S=t.type,i=t.range,O=t.realScaleType==="scaleBand"?f.bandwidth()/2:2,z=(a||s)&&S==="category"&&f.bandwidth?f.bandwidth()/O:0;if(z=t.axisType==="angleAxis"&&(i==null?void 0:i.length)>=2?Qc(i[0]-i[1])*2*z:z,a&&(t.ticks||t.niceTicks)){var j=(t.ticks||t.niceTicks).map(function(F){var G=v?v.indexOf(F):F;return{coordinate:f(G)+z,value:F,offset:z}});return j.filter(function(F){return!D1(F.coordinate)})}return t.isCategorical&&t.categoricalDomain?t.categoricalDomain.map(function(F,G){return{coordinate:f(F)+z,value:F,index:G,offset:z}}):f.ticks&&!s?f.ticks(t.tickCount).map(function(F){return{coordinate:f(F)+z,value:F,offset:z}}):f.domain().map(function(F,G){return{coordinate:f(F)+z,value:v?v[F]:F,index:G,offset:z}})},HA=new WeakMap,px=function(t,a){if(typeof a!="function")return t;HA.has(t)||HA.set(t,new WeakMap);var s=HA.get(t);if(s.has(a))return s.get(a);var f=function(){t.apply(void 0,arguments),a.apply(void 0,arguments)};return s.set(a,f),f},Tle=function(t,a,s){var f=t.scale,v=t.type,S=t.layout,i=t.axisType;if(f==="auto")return S==="radial"&&i==="radiusAxis"?{scale:Kv(),realScaleType:"band"}:S==="radial"&&i==="angleAxis"?{scale:ab(),realScaleType:"linear"}:v==="category"&&a&&(a.indexOf("LineChart")>=0||a.indexOf("AreaChart")>=0||a.indexOf("ComposedChart")>=0)?{scale:Ov(),realScaleType:"point"}:v==="category"?{scale:Kv(),realScaleType:"band"}:{scale:ab(),realScaleType:"linear"};if(R1(f)){var O="scale".concat(aw(f));return{scale:(B9[O]||Ov)(),realScaleType:B9[O]?O:"point"}}return Vr(f)?{scale:f}:{scale:Ov(),realScaleType:"point"}},Q9=1e-4,Ele=function(t){var a=t.domain();if(!(!a||a.length<=2)){var s=a.length,f=t.range(),v=Math.min(f[0],f[1])-Q9,S=Math.max(f[0],f[1])+Q9,i=t(a[0]),O=t(a[s-1]);(i<v||i>S||O<v||O>S)&&t.domain([a[0],a[s-1]])}},Ale=function(t){var a=t.length;if(!(a<=0))for(var s=0,f=t[0].length;s<f;++s)for(var v=0,S=0,i=0;i<a;++i){var O=D1(t[i][s][1])?t[i][s][0]:t[i][s][1];O>=0?(t[i][s][0]=v,t[i][s][1]=v+O,v=t[i][s][1]):(t[i][s][0]=S,t[i][s][1]=S+O,S=t[i][s][1])}},Cle=function(t){var a=t.length;if(!(a<=0))for(var s=0,f=t[0].length;s<f;++s)for(var v=0,S=0;S<a;++S){var i=D1(t[S][s][1])?t[S][s][0]:t[S][s][1];i>=0?(t[S][s][0]=v,t[S][s][1]=v+i,v=t[S][s][1]):(t[S][s][0]=0,t[S][s][1]=0)}},Mle={sign:Ale,expand:pte,none:dg,silhouette:mte,wiggle:_te,positive:Cle},Ole=function(t,a,s){var f=a.map(function(i){return i.props.dataKey}),v=Mle[s],S=dte().keys(f).value(function(i,O){return+Kl(i,O,0)}).order(rM).offset(v);return S(t)},Ile=function(t,a,s,f,v,S){if(!t)return null;var i=S?a.reverse():a,O={},z=i.reduce(function(F,G){var Y,X=(Y=G.type)!==null&&Y!==void 0&&Y.defaultProps?ja(ja({},G.type.defaultProps),G.props):G.props,K=X.stackId,ne=X.hide;if(ne)return F;var se=X[s],ge=F[se]||{hasStack:!1,stackGroups:{}};if(go(K)){var _e=ge.stackGroups[K]||{numericAxisId:s,cateAxisId:f,items:[]};_e.items.push(G),ge.hasStack=!0,ge.stackGroups[K]=_e}else ge.stackGroups[rw("_stackId_")]={numericAxisId:s,cateAxisId:f,items:[G]};return ja(ja({},F),{},sg({},se,ge))},O),j={};return Object.keys(z).reduce(function(F,G){var Y=z[G];if(Y.hasStack){var X={};Y.stackGroups=Object.keys(Y.stackGroups).reduce(function(K,ne){var se=Y.stackGroups[ne];return ja(ja({},K),{},sg({},ne,{numericAxisId:s,cateAxisId:f,items:se.items,stackedData:Ole(t,se.items,v)}))},X)}return ja(ja({},F),{},sg({},G,Y))},j)},Ple=function(t,a){var s=a.realScaleType,f=a.type,v=a.tickCount,S=a.originalDomain,i=a.allowDecimals,O=s||a.scale;if(O!=="auto"&&O!=="linear")return null;if(v&&f==="number"&&S&&(S[0]==="auto"||S[1]==="auto")){var z=t.domain();if(!z.length)return null;var j=qse(z,v,i);return t.domain([bw(j),xw(j)]),{niceTicks:j}}if(v&&f==="number"){var F=t.domain(),G=Gse(F,v,i);return{niceTicks:G}}return null},Rle=function(t,a){var s,f=(s=t.type)!==null&&s!==void 0&&s.defaultProps?ja(ja({},t.type.defaultProps),t.props):t.props,v=f.stackId;if(go(v)){var S=a[v];if(S){var i=S.items.indexOf(t);return i>=0?S.stackedData[i]:null}}return null},Dle=function(t){return t.reduce(function(a,s){return[bw(s.concat([a[0]]).filter(Nn)),xw(s.concat([a[1]]).filter(Nn))]},[1/0,-1/0])},JN=function(t,a,s){return Object.keys(t).reduce(function(f,v){var S=t[v],i=S.stackedData,O=i.reduce(function(z,j){var F=Dle(j.slice(a,s+1));return[Math.min(z[0],F[0]),Math.max(z[1],F[1])]},[1/0,-1/0]);return[Math.min(O[0],f[0]),Math.max(O[1],f[1])]},[1/0,-1/0]).map(function(f){return f===1/0||f===-1/0?0:f})},ez=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,tz=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,MM=function(t,a,s){if(Vr(t))return t(a,s);if(!Array.isArray(t))return a;var f=[];if(Nn(t[0]))f[0]=s?t[0]:Math.min(t[0],a[0]);else if(ez.test(t[0])){var v=+ez.exec(t[0])[1];f[0]=a[0]-v}else Vr(t[0])?f[0]=t[0](a[0]):f[0]=a[0];if(Nn(t[1]))f[1]=s?t[1]:Math.max(t[1],a[1]);else if(tz.test(t[1])){var S=+tz.exec(t[1])[1];f[1]=a[1]+S}else Vr(t[1])?f[1]=t[1](a[1]):f[1]=a[1];return f},OM=function(t,a,s){if(t&&t.scale&&t.scale.bandwidth){var f=t.scale.bandwidth();if(!s||f>0)return f}if(t&&a&&a.length>=2){for(var v=a4(a,function(F){return F.coordinate}),S=1/0,i=1,O=v.length;i<O;i++){var z=v[i],j=v[i-1];S=Math.min((z.coordinate||0)-(j.coordinate||0),S)}return S===1/0?0:S}return s?void 0:0},nz=function(t,a,s){return!t||!t.length||O4(t,Hu(s,"type.defaultProps.domain"))?a:t},Lle=function(t,a){var s=t.type.defaultProps?ja(ja({},t.type.defaultProps),t.props):t.props,f=s.dataKey,v=s.name,S=s.unit,i=s.formatter,O=s.tooltipType,z=s.chartType,j=s.hide;return ja(ja({},Fr(t,!1)),{},{dataKey:f,unit:S,formatter:i,name:v||f,color:D4(t),value:Kl(a,f),type:O,payload:a,chartType:z,hide:j})};function o1(e){"@babel/helpers - typeof";return o1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o1(e)}function rz(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(f){return Object.getOwnPropertyDescriptor(e,f).enumerable})),a.push.apply(a,s)}return a}function pd(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?rz(Object(a),!0).forEach(function(s){QN(e,s,a[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):rz(Object(a)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(a,s))})}return e}function QN(e,t,a){return t=zle(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function zle(e){var t=kle(e,"string");return o1(t)=="symbol"?t:t+""}function kle(e,t){if(o1(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var s=a.call(e,t);if(o1(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ble(e,t){return Ule(e)||jle(e,t)||Fle(e,t)||Nle()}function Nle(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Fle(e,t){if(e){if(typeof e=="string")return iz(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return iz(e,t)}}function iz(e,t){(t==null||t>e.length)&&(t=e.length);for(var a=0,s=new Array(t);a<t;a++)s[a]=e[a];return s}function jle(e,t){var a=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(a!=null){var s,f,v,S,i=[],O=!0,z=!1;try{if(v=(a=a.call(e)).next,t!==0)for(;!(O=(s=v.call(a)).done)&&(i.push(s.value),i.length!==t);O=!0);}catch(j){z=!0,f=j}finally{try{if(!O&&a.return!=null&&(S=a.return(),Object(S)!==S))return}finally{if(z)throw f}}return i}}function Ule(e){if(Array.isArray(e))return e}var fb=Math.PI/180,Vle=function(t){return t*180/Math.PI},Wi=function(t,a,s,f){return{x:t+Math.cos(-fb*f)*s,y:a+Math.sin(-fb*f)*s}},eF=function(t,a){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(t-(s.left||0)-(s.right||0)),Math.abs(a-(s.top||0)-(s.bottom||0)))/2},$le=function(t,a,s,f,v){var S=t.width,i=t.height,O=t.startAngle,z=t.endAngle,j=cl(t.cx,S,S/2),F=cl(t.cy,i,i/2),G=eF(S,i,s),Y=cl(t.innerRadius,G,0),X=cl(t.outerRadius,G,G*.8),K=Object.keys(a);return K.reduce(function(ne,se){var ge=a[se],_e=ge.domain,xe=ge.reversed,ae;if(ei(ge.range))f==="angleAxis"?ae=[O,z]:f==="radiusAxis"&&(ae=[Y,X]),xe&&(ae=[ae[1],ae[0]]);else{ae=ge.range;var ve=ae,Se=Ble(ve,2);O=Se[0],z=Se[1]}var He=Tle(ge,v),Ge=He.realScaleType,ye=He.scale;ye.domain(_e).range(ae),Ele(ye);var Le=Ple(ye,pd(pd({},ge),{},{realScaleType:Ge})),ht=pd(pd(pd({},ge),Le),{},{range:ae,radius:X,realScaleType:Ge,scale:ye,cx:j,cy:F,innerRadius:Y,outerRadius:X,startAngle:O,endAngle:z});return pd(pd({},ne),{},QN({},se,ht))},{})},qle=function(t,a){var s=t.x,f=t.y,v=a.x,S=a.y;return Math.sqrt(Math.pow(s-v,2)+Math.pow(f-S,2))},Gle=function(t,a){var s=t.x,f=t.y,v=a.cx,S=a.cy,i=qle({x:s,y:f},{x:v,y:S});if(i<=0)return{radius:i};var O=(s-v)/i,z=Math.acos(O);return f>S&&(z=2*Math.PI-z),{radius:i,angle:Vle(z),angleInRadian:z}},Hle=function(t){var a=t.startAngle,s=t.endAngle,f=Math.floor(a/360),v=Math.floor(s/360),S=Math.min(f,v);return{startAngle:a-S*360,endAngle:s-S*360}},Zle=function(t,a){var s=a.startAngle,f=a.endAngle,v=Math.floor(s/360),S=Math.floor(f/360),i=Math.min(v,S);return t+i*360},az=function(t,a){var s=t.x,f=t.y,v=Gle({x:s,y:f},a),S=v.radius,i=v.angle,O=a.innerRadius,z=a.outerRadius;if(S<O||S>z)return!1;if(S===0)return!0;var j=Hle(a),F=j.startAngle,G=j.endAngle,Y=i,X;if(F<=G){for(;Y>G;)Y-=360;for(;Y<F;)Y+=360;X=Y>=F&&Y<=G}else{for(;Y>F;)Y-=360;for(;Y<G;)Y+=360;X=Y>=G&&Y<=F}return X?pd(pd({},a),{},{radius:S,angle:Zle(Y,a)}):null},tF=function(t){return!Me.isValidElement(t)&&!Vr(t)&&typeof t!="boolean"?t.className:""};function s1(e){"@babel/helpers - typeof";return s1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s1(e)}var Wle=["offset"];function Xle(e){return Qle(e)||Jle(e)||Kle(e)||Yle()}function Yle(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Kle(e,t){if(e){if(typeof e=="string")return IM(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return IM(e,t)}}function Jle(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Qle(e){if(Array.isArray(e))return IM(e)}function IM(e,t){(t==null||t>e.length)&&(t=e.length);for(var a=0,s=new Array(t);a<t;a++)s[a]=e[a];return s}function ece(e,t){if(e==null)return{};var a=tce(e,t),s,f;if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(e);for(f=0;f<v.length;f++)s=v[f],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(a[s]=e[s])}return a}function tce(e,t){if(e==null)return{};var a={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(t.indexOf(s)>=0)continue;a[s]=e[s]}return a}function oz(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(f){return Object.getOwnPropertyDescriptor(e,f).enumerable})),a.push.apply(a,s)}return a}function _o(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?oz(Object(a),!0).forEach(function(s){nce(e,s,a[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):oz(Object(a)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(a,s))})}return e}function nce(e,t,a){return t=rce(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function rce(e){var t=ice(e,"string");return s1(t)=="symbol"?t:t+""}function ice(e,t){if(s1(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var s=a.call(e,t);if(s1(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function l1(){return l1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},l1.apply(this,arguments)}var ace=function(t){var a=t.value,s=t.formatter,f=ei(t.children)?a:t.children;return Vr(s)?s(f):f},oce=function(t,a){var s=Qc(a-t),f=Math.min(Math.abs(a-t),360);return s*f},sce=function(t,a,s){var f=t.position,v=t.viewBox,S=t.offset,i=t.className,O=v,z=O.cx,j=O.cy,F=O.innerRadius,G=O.outerRadius,Y=O.startAngle,X=O.endAngle,K=O.clockWise,ne=(F+G)/2,se=oce(Y,X),ge=se>=0?1:-1,_e,xe;f==="insideStart"?(_e=Y+ge*S,xe=K):f==="insideEnd"?(_e=X-ge*S,xe=!K):f==="end"&&(_e=X+ge*S,xe=K),xe=se<=0?xe:!xe;var ae=Wi(z,j,ne,_e),ve=Wi(z,j,ne,_e+(xe?1:-1)*359),Se="M".concat(ae.x,",").concat(ae.y,`
    A`).concat(ne,",").concat(ne,",0,1,").concat(xe?0:1,`,
    `).concat(ve.x,",").concat(ve.y),He=ei(t.id)?rw("recharts-radial-line-"):t.id;return Ot.createElement("text",l1({},s,{dominantBaseline:"central",className:oi("recharts-radial-bar-label",i)}),Ot.createElement("defs",null,Ot.createElement("path",{id:He,d:Se})),Ot.createElement("textPath",{xlinkHref:"#".concat(He)},a))},lce=function(t){var a=t.viewBox,s=t.offset,f=t.position,v=a,S=v.cx,i=v.cy,O=v.innerRadius,z=v.outerRadius,j=v.startAngle,F=v.endAngle,G=(j+F)/2;if(f==="outside"){var Y=Wi(S,i,z+s,G),X=Y.x,K=Y.y;return{x:X,y:K,textAnchor:X>=S?"start":"end",verticalAnchor:"middle"}}if(f==="center")return{x:S,y:i,textAnchor:"middle",verticalAnchor:"middle"};if(f==="centerTop")return{x:S,y:i,textAnchor:"middle",verticalAnchor:"start"};if(f==="centerBottom")return{x:S,y:i,textAnchor:"middle",verticalAnchor:"end"};var ne=(O+z)/2,se=Wi(S,i,ne,G),ge=se.x,_e=se.y;return{x:ge,y:_e,textAnchor:"middle",verticalAnchor:"middle"}},cce=function(t){var a=t.viewBox,s=t.parentViewBox,f=t.offset,v=t.position,S=a,i=S.x,O=S.y,z=S.width,j=S.height,F=j>=0?1:-1,G=F*f,Y=F>0?"end":"start",X=F>0?"start":"end",K=z>=0?1:-1,ne=K*f,se=K>0?"end":"start",ge=K>0?"start":"end";if(v==="top"){var _e={x:i+z/2,y:O-F*f,textAnchor:"middle",verticalAnchor:Y};return _o(_o({},_e),s?{height:Math.max(O-s.y,0),width:z}:{})}if(v==="bottom"){var xe={x:i+z/2,y:O+j+G,textAnchor:"middle",verticalAnchor:X};return _o(_o({},xe),s?{height:Math.max(s.y+s.height-(O+j),0),width:z}:{})}if(v==="left"){var ae={x:i-ne,y:O+j/2,textAnchor:se,verticalAnchor:"middle"};return _o(_o({},ae),s?{width:Math.max(ae.x-s.x,0),height:j}:{})}if(v==="right"){var ve={x:i+z+ne,y:O+j/2,textAnchor:ge,verticalAnchor:"middle"};return _o(_o({},ve),s?{width:Math.max(s.x+s.width-ve.x,0),height:j}:{})}var Se=s?{width:z,height:j}:{};return v==="insideLeft"?_o({x:i+ne,y:O+j/2,textAnchor:ge,verticalAnchor:"middle"},Se):v==="insideRight"?_o({x:i+z-ne,y:O+j/2,textAnchor:se,verticalAnchor:"middle"},Se):v==="insideTop"?_o({x:i+z/2,y:O+G,textAnchor:"middle",verticalAnchor:X},Se):v==="insideBottom"?_o({x:i+z/2,y:O+j-G,textAnchor:"middle",verticalAnchor:Y},Se):v==="insideTopLeft"?_o({x:i+ne,y:O+G,textAnchor:ge,verticalAnchor:X},Se):v==="insideTopRight"?_o({x:i+z-ne,y:O+G,textAnchor:se,verticalAnchor:X},Se):v==="insideBottomLeft"?_o({x:i+ne,y:O+j-G,textAnchor:ge,verticalAnchor:Y},Se):v==="insideBottomRight"?_o({x:i+z-ne,y:O+j-G,textAnchor:se,verticalAnchor:Y},Se):jg(v)&&(Nn(v.x)||d0(v.x))&&(Nn(v.y)||d0(v.y))?_o({x:i+cl(v.x,z),y:O+cl(v.y,j),textAnchor:"end",verticalAnchor:"end"},Se):_o({x:i+z/2,y:O+j/2,textAnchor:"middle",verticalAnchor:"middle"},Se)},uce=function(t){return"cx"in t&&Nn(t.cx)};function Ko(e){var t=e.offset,a=t===void 0?5:t,s=ece(e,Wle),f=_o({offset:a},s),v=f.viewBox,S=f.position,i=f.value,O=f.children,z=f.content,j=f.className,F=j===void 0?"":j,G=f.textBreakAll;if(!v||ei(i)&&ei(O)&&!Me.isValidElement(z)&&!Vr(z))return null;if(Me.isValidElement(z))return Me.cloneElement(z,f);var Y;if(Vr(z)){if(Y=Me.createElement(z,f),Me.isValidElement(Y))return Y}else Y=ace(f);var X=uce(v),K=Fr(f,!0);if(X&&(S==="insideStart"||S==="insideEnd"||S==="end"))return sce(f,Y,K);var ne=X?lce(f):cce(f);return Ot.createElement(yg,l1({className:oi("recharts-label",F)},K,ne,{breakAll:G}),Y)}Ko.displayName="Label";var nF=function(t){var a=t.cx,s=t.cy,f=t.angle,v=t.startAngle,S=t.endAngle,i=t.r,O=t.radius,z=t.innerRadius,j=t.outerRadius,F=t.x,G=t.y,Y=t.top,X=t.left,K=t.width,ne=t.height,se=t.clockWise,ge=t.labelViewBox;if(ge)return ge;if(Nn(K)&&Nn(ne)){if(Nn(F)&&Nn(G))return{x:F,y:G,width:K,height:ne};if(Nn(Y)&&Nn(X))return{x:Y,y:X,width:K,height:ne}}return Nn(F)&&Nn(G)?{x:F,y:G,width:0,height:0}:Nn(a)&&Nn(s)?{cx:a,cy:s,startAngle:v||f||0,endAngle:S||f||0,innerRadius:z||0,outerRadius:j||O||i||0,clockWise:se}:t.viewBox?t.viewBox:{}},hce=function(t,a){return t?t===!0?Ot.createElement(Ko,{key:"label-implicit",viewBox:a}):go(t)?Ot.createElement(Ko,{key:"label-implicit",viewBox:a,value:t}):Me.isValidElement(t)?t.type===Ko?Me.cloneElement(t,{key:"label-implicit",viewBox:a}):Ot.createElement(Ko,{key:"label-implicit",content:t,viewBox:a}):Vr(t)?Ot.createElement(Ko,{key:"label-implicit",content:t,viewBox:a}):jg(t)?Ot.createElement(Ko,l1({viewBox:a},t,{key:"label-implicit"})):null:null},fce=function(t,a){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!t||!t.children&&s&&!t.label)return null;var f=t.children,v=nF(t),S=ef(f,Ko).map(function(O,z){return Me.cloneElement(O,{viewBox:a||v,key:"label-".concat(z)})});if(!s)return S;var i=hce(t.label,a||v);return[i].concat(Xle(S))};Ko.parseViewBox=nF;Ko.renderCallByParent=fce;var ZA,sz;function dce(){if(sz)return ZA;sz=1;function e(t){var a=t==null?0:t.length;return a?t[a-1]:void 0}return ZA=e,ZA}var pce=dce();const mce=Ei(pce);function c1(e){"@babel/helpers - typeof";return c1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},c1(e)}var _ce=["valueAccessor"],gce=["data","dataKey","clockWise","id","textBreakAll"];function yce(e){return wce(e)||bce(e)||xce(e)||vce()}function vce(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function xce(e,t){if(e){if(typeof e=="string")return PM(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return PM(e,t)}}function bce(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function wce(e){if(Array.isArray(e))return PM(e)}function PM(e,t){(t==null||t>e.length)&&(t=e.length);for(var a=0,s=new Array(t);a<t;a++)s[a]=e[a];return s}function db(){return db=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},db.apply(this,arguments)}function lz(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(f){return Object.getOwnPropertyDescriptor(e,f).enumerable})),a.push.apply(a,s)}return a}function cz(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?lz(Object(a),!0).forEach(function(s){Sce(e,s,a[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):lz(Object(a)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(a,s))})}return e}function Sce(e,t,a){return t=Tce(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Tce(e){var t=Ece(e,"string");return c1(t)=="symbol"?t:t+""}function Ece(e,t){if(c1(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var s=a.call(e,t);if(c1(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function uz(e,t){if(e==null)return{};var a=Ace(e,t),s,f;if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(e);for(f=0;f<v.length;f++)s=v[f],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(a[s]=e[s])}return a}function Ace(e,t){if(e==null)return{};var a={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(t.indexOf(s)>=0)continue;a[s]=e[s]}return a}var Cce=function(t){return Array.isArray(t.value)?mce(t.value):t.value};function y0(e){var t=e.valueAccessor,a=t===void 0?Cce:t,s=uz(e,_ce),f=s.data,v=s.dataKey,S=s.clockWise,i=s.id,O=s.textBreakAll,z=uz(s,gce);return!f||!f.length?null:Ot.createElement(Ua,{className:"recharts-label-list"},f.map(function(j,F){var G=ei(v)?a(j,F):Kl(j&&j.payload,v),Y=ei(i)?{}:{id:"".concat(i,"-").concat(F)};return Ot.createElement(Ko,db({},Fr(j,!0),z,Y,{parentViewBox:j.parentViewBox,value:G,textBreakAll:O,viewBox:Ko.parseViewBox(ei(S)?j:cz(cz({},j),{},{clockWise:S})),key:"label-".concat(F),index:F}))}))}y0.displayName="LabelList";function Mce(e,t){return e?e===!0?Ot.createElement(y0,{key:"labelList-implicit",data:t}):Ot.isValidElement(e)||Vr(e)?Ot.createElement(y0,{key:"labelList-implicit",data:t,content:e}):jg(e)?Ot.createElement(y0,db({data:t},e,{key:"labelList-implicit"})):null:null}function Oce(e,t){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&a&&!e.label)return null;var s=e.children,f=ef(s,y0).map(function(S,i){return Me.cloneElement(S,{data:t,key:"labelList-".concat(i)})});if(!a)return f;var v=Mce(e.label,t);return[v].concat(yce(f))}y0.renderCallByParent=Oce;function u1(e){"@babel/helpers - typeof";return u1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u1(e)}function RM(){return RM=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},RM.apply(this,arguments)}function hz(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(f){return Object.getOwnPropertyDescriptor(e,f).enumerable})),a.push.apply(a,s)}return a}function fz(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?hz(Object(a),!0).forEach(function(s){Ice(e,s,a[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):hz(Object(a)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(a,s))})}return e}function Ice(e,t,a){return t=Pce(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Pce(e){var t=Rce(e,"string");return u1(t)=="symbol"?t:t+""}function Rce(e,t){if(u1(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var s=a.call(e,t);if(u1(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Dce=function(t,a){var s=Qc(a-t),f=Math.min(Math.abs(a-t),359.999);return s*f},mx=function(t){var a=t.cx,s=t.cy,f=t.radius,v=t.angle,S=t.sign,i=t.isExternal,O=t.cornerRadius,z=t.cornerIsExternal,j=O*(i?1:-1)+f,F=Math.asin(O/j)/fb,G=z?v:v+S*F,Y=Wi(a,s,j,G),X=Wi(a,s,f,G),K=z?v-S*F:v,ne=Wi(a,s,j*Math.cos(F*fb),K);return{center:Y,circleTangency:X,lineTangency:ne,theta:F}},rF=function(t){var a=t.cx,s=t.cy,f=t.innerRadius,v=t.outerRadius,S=t.startAngle,i=t.endAngle,O=Dce(S,i),z=S+O,j=Wi(a,s,v,S),F=Wi(a,s,v,z),G="M ".concat(j.x,",").concat(j.y,`
    A `).concat(v,",").concat(v,`,0,
    `).concat(+(Math.abs(O)>180),",").concat(+(S>z),`,
    `).concat(F.x,",").concat(F.y,`
  `);if(f>0){var Y=Wi(a,s,f,S),X=Wi(a,s,f,z);G+="L ".concat(X.x,",").concat(X.y,`
            A `).concat(f,",").concat(f,`,0,
            `).concat(+(Math.abs(O)>180),",").concat(+(S<=z),`,
            `).concat(Y.x,",").concat(Y.y," Z")}else G+="L ".concat(a,",").concat(s," Z");return G},Lce=function(t){var a=t.cx,s=t.cy,f=t.innerRadius,v=t.outerRadius,S=t.cornerRadius,i=t.forceCornerRadius,O=t.cornerIsExternal,z=t.startAngle,j=t.endAngle,F=Qc(j-z),G=mx({cx:a,cy:s,radius:v,angle:z,sign:F,cornerRadius:S,cornerIsExternal:O}),Y=G.circleTangency,X=G.lineTangency,K=G.theta,ne=mx({cx:a,cy:s,radius:v,angle:j,sign:-F,cornerRadius:S,cornerIsExternal:O}),se=ne.circleTangency,ge=ne.lineTangency,_e=ne.theta,xe=O?Math.abs(z-j):Math.abs(z-j)-K-_e;if(xe<0)return i?"M ".concat(X.x,",").concat(X.y,`
        a`).concat(S,",").concat(S,",0,0,1,").concat(S*2,`,0
        a`).concat(S,",").concat(S,",0,0,1,").concat(-S*2,`,0
      `):rF({cx:a,cy:s,innerRadius:f,outerRadius:v,startAngle:z,endAngle:j});var ae="M ".concat(X.x,",").concat(X.y,`
    A`).concat(S,",").concat(S,",0,0,").concat(+(F<0),",").concat(Y.x,",").concat(Y.y,`
    A`).concat(v,",").concat(v,",0,").concat(+(xe>180),",").concat(+(F<0),",").concat(se.x,",").concat(se.y,`
    A`).concat(S,",").concat(S,",0,0,").concat(+(F<0),",").concat(ge.x,",").concat(ge.y,`
  `);if(f>0){var ve=mx({cx:a,cy:s,radius:f,angle:z,sign:F,isExternal:!0,cornerRadius:S,cornerIsExternal:O}),Se=ve.circleTangency,He=ve.lineTangency,Ge=ve.theta,ye=mx({cx:a,cy:s,radius:f,angle:j,sign:-F,isExternal:!0,cornerRadius:S,cornerIsExternal:O}),Le=ye.circleTangency,ht=ye.lineTangency,gt=ye.theta,Ft=O?Math.abs(z-j):Math.abs(z-j)-Ge-gt;if(Ft<0&&S===0)return"".concat(ae,"L").concat(a,",").concat(s,"Z");ae+="L".concat(ht.x,",").concat(ht.y,`
      A`).concat(S,",").concat(S,",0,0,").concat(+(F<0),",").concat(Le.x,",").concat(Le.y,`
      A`).concat(f,",").concat(f,",0,").concat(+(Ft>180),",").concat(+(F>0),",").concat(Se.x,",").concat(Se.y,`
      A`).concat(S,",").concat(S,",0,0,").concat(+(F<0),",").concat(He.x,",").concat(He.y,"Z")}else ae+="L".concat(a,",").concat(s,"Z");return ae},zce={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},iF=function(t){var a=fz(fz({},zce),t),s=a.cx,f=a.cy,v=a.innerRadius,S=a.outerRadius,i=a.cornerRadius,O=a.forceCornerRadius,z=a.cornerIsExternal,j=a.startAngle,F=a.endAngle,G=a.className;if(S<v||j===F)return null;var Y=oi("recharts-sector",G),X=S-v,K=cl(i,X,0,!0),ne;return K>0&&Math.abs(j-F)<360?ne=Lce({cx:s,cy:f,innerRadius:v,outerRadius:S,cornerRadius:Math.min(K,X/2),forceCornerRadius:O,cornerIsExternal:z,startAngle:j,endAngle:F}):ne=rF({cx:s,cy:f,innerRadius:v,outerRadius:S,startAngle:j,endAngle:F}),Ot.createElement("path",RM({},Fr(a,!0),{className:Y,d:ne,role:"img"}))};function h1(e){"@babel/helpers - typeof";return h1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},h1(e)}function DM(){return DM=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},DM.apply(this,arguments)}function dz(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(f){return Object.getOwnPropertyDescriptor(e,f).enumerable})),a.push.apply(a,s)}return a}function pz(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?dz(Object(a),!0).forEach(function(s){kce(e,s,a[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):dz(Object(a)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(a,s))})}return e}function kce(e,t,a){return t=Bce(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Bce(e){var t=Nce(e,"string");return h1(t)=="symbol"?t:t+""}function Nce(e,t){if(h1(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var s=a.call(e,t);if(h1(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var mz={curveBasisClosed:nte,curveBasisOpen:rte,curveBasis:tte,curveBumpX:Uee,curveBumpY:Vee,curveLinearClosed:ite,curveLinear:sw,curveMonotoneX:ate,curveMonotoneY:ote,curveNatural:ste,curveStep:lte,curveStepAfter:ute,curveStepBefore:cte},_x=function(t){return t.x===+t.x&&t.y===+t.y},hv=function(t){return t.x},fv=function(t){return t.y},Fce=function(t,a){if(Vr(t))return t;var s="curve".concat(aw(t));return(s==="curveMonotone"||s==="curveBump")&&a?mz["".concat(s).concat(a==="vertical"?"Y":"X")]:mz[s]||sw},jce=function(t){var a=t.type,s=a===void 0?"linear":a,f=t.points,v=f===void 0?[]:f,S=t.baseLine,i=t.layout,O=t.connectNulls,z=O===void 0?!1:O,j=Fce(s,i),F=z?v.filter(function(K){return _x(K)}):v,G;if(Array.isArray(S)){var Y=z?S.filter(function(K){return _x(K)}):S,X=F.map(function(K,ne){return pz(pz({},K),{},{base:Y[ne]})});return i==="vertical"?G=sx().y(fv).x1(hv).x0(function(K){return K.base.x}):G=sx().x(hv).y1(fv).y0(function(K){return K.base.y}),G.defined(_x).curve(j),G(X)}return i==="vertical"&&Nn(S)?G=sx().y(fv).x1(hv).x0(S):Nn(S)?G=sx().x(hv).y1(fv).y0(S):G=oB().x(hv).y(fv),G.defined(_x).curve(j),G(F)},LM=function(t){var a=t.className,s=t.points,f=t.path,v=t.pathRef;if((!s||!s.length)&&!f)return null;var S=s&&s.length?jce(t):f;return Ot.createElement("path",DM({},Fr(t,!1),Vx(t),{className:oi("recharts-curve",a),d:S,ref:v}))},Uce=Object.getOwnPropertyNames,Vce=Object.getOwnPropertySymbols,$ce=Object.prototype.hasOwnProperty;function _z(e,t){return function(s,f,v){return e(s,f,v)&&t(s,f,v)}}function gx(e){return function(a,s,f){if(!a||!s||typeof a!="object"||typeof s!="object")return e(a,s,f);var v=f.cache,S=v.get(a),i=v.get(s);if(S&&i)return S===s&&i===a;v.set(a,s),v.set(s,a);var O=e(a,s,f);return v.delete(a),v.delete(s),O}}function gz(e){return Uce(e).concat(Vce(e))}var qce=Object.hasOwn||function(e,t){return $ce.call(e,t)};function A0(e,t){return e===t||!e&&!t&&e!==e&&t!==t}var Gce="__v",Hce="__o",Zce="_owner",yz=Object.getOwnPropertyDescriptor,vz=Object.keys;function Wce(e,t,a){var s=e.length;if(t.length!==s)return!1;for(;s-- >0;)if(!a.equals(e[s],t[s],s,s,e,t,a))return!1;return!0}function Xce(e,t){return A0(e.getTime(),t.getTime())}function Yce(e,t){return e.name===t.name&&e.message===t.message&&e.cause===t.cause&&e.stack===t.stack}function Kce(e,t){return e===t}function xz(e,t,a){var s=e.size;if(s!==t.size)return!1;if(!s)return!0;for(var f=new Array(s),v=e.entries(),S,i,O=0;(S=v.next())&&!S.done;){for(var z=t.entries(),j=!1,F=0;(i=z.next())&&!i.done;){if(f[F]){F++;continue}var G=S.value,Y=i.value;if(a.equals(G[0],Y[0],O,F,e,t,a)&&a.equals(G[1],Y[1],G[0],Y[0],e,t,a)){j=f[F]=!0;break}F++}if(!j)return!1;O++}return!0}var Jce=A0;function Qce(e,t,a){var s=vz(e),f=s.length;if(vz(t).length!==f)return!1;for(;f-- >0;)if(!aF(e,t,a,s[f]))return!1;return!0}function dv(e,t,a){var s=gz(e),f=s.length;if(gz(t).length!==f)return!1;for(var v,S,i;f-- >0;)if(v=s[f],!aF(e,t,a,v)||(S=yz(e,v),i=yz(t,v),(S||i)&&(!S||!i||S.configurable!==i.configurable||S.enumerable!==i.enumerable||S.writable!==i.writable)))return!1;return!0}function eue(e,t){return A0(e.valueOf(),t.valueOf())}function tue(e,t){return e.source===t.source&&e.flags===t.flags}function bz(e,t,a){var s=e.size;if(s!==t.size)return!1;if(!s)return!0;for(var f=new Array(s),v=e.values(),S,i;(S=v.next())&&!S.done;){for(var O=t.values(),z=!1,j=0;(i=O.next())&&!i.done;){if(!f[j]&&a.equals(S.value,i.value,S.value,i.value,e,t,a)){z=f[j]=!0;break}j++}if(!z)return!1}return!0}function nue(e,t){var a=e.length;if(t.length!==a)return!1;for(;a-- >0;)if(e[a]!==t[a])return!1;return!0}function rue(e,t){return e.hostname===t.hostname&&e.pathname===t.pathname&&e.protocol===t.protocol&&e.port===t.port&&e.hash===t.hash&&e.username===t.username&&e.password===t.password}function aF(e,t,a,s){return(s===Zce||s===Hce||s===Gce)&&(e.$$typeof||t.$$typeof)?!0:qce(t,s)&&a.equals(e[s],t[s],s,s,e,t,a)}var iue="[object Arguments]",aue="[object Boolean]",oue="[object Date]",sue="[object Error]",lue="[object Map]",cue="[object Number]",uue="[object Object]",hue="[object RegExp]",fue="[object Set]",due="[object String]",pue="[object URL]",mue=Array.isArray,wz=typeof ArrayBuffer=="function"&&ArrayBuffer.isView?ArrayBuffer.isView:null,Sz=Object.assign,_ue=Object.prototype.toString.call.bind(Object.prototype.toString);function gue(e){var t=e.areArraysEqual,a=e.areDatesEqual,s=e.areErrorsEqual,f=e.areFunctionsEqual,v=e.areMapsEqual,S=e.areNumbersEqual,i=e.areObjectsEqual,O=e.arePrimitiveWrappersEqual,z=e.areRegExpsEqual,j=e.areSetsEqual,F=e.areTypedArraysEqual,G=e.areUrlsEqual;return function(X,K,ne){if(X===K)return!0;if(X==null||K==null)return!1;var se=typeof X;if(se!==typeof K)return!1;if(se!=="object")return se==="number"?S(X,K,ne):se==="function"?f(X,K,ne):!1;var ge=X.constructor;if(ge!==K.constructor)return!1;if(ge===Object)return i(X,K,ne);if(mue(X))return t(X,K,ne);if(wz!=null&&wz(X))return F(X,K,ne);if(ge===Date)return a(X,K,ne);if(ge===RegExp)return z(X,K,ne);if(ge===Map)return v(X,K,ne);if(ge===Set)return j(X,K,ne);var _e=_ue(X);return _e===oue?a(X,K,ne):_e===hue?z(X,K,ne):_e===lue?v(X,K,ne):_e===fue?j(X,K,ne):_e===uue?typeof X.then!="function"&&typeof K.then!="function"&&i(X,K,ne):_e===pue?G(X,K,ne):_e===sue?s(X,K,ne):_e===iue?i(X,K,ne):_e===aue||_e===cue||_e===due?O(X,K,ne):!1}}function yue(e){var t=e.circular,a=e.createCustomConfig,s=e.strict,f={areArraysEqual:s?dv:Wce,areDatesEqual:Xce,areErrorsEqual:Yce,areFunctionsEqual:Kce,areMapsEqual:s?_z(xz,dv):xz,areNumbersEqual:Jce,areObjectsEqual:s?dv:Qce,arePrimitiveWrappersEqual:eue,areRegExpsEqual:tue,areSetsEqual:s?_z(bz,dv):bz,areTypedArraysEqual:s?dv:nue,areUrlsEqual:rue};if(a&&(f=Sz({},f,a(f))),t){var v=gx(f.areArraysEqual),S=gx(f.areMapsEqual),i=gx(f.areObjectsEqual),O=gx(f.areSetsEqual);f=Sz({},f,{areArraysEqual:v,areMapsEqual:S,areObjectsEqual:i,areSetsEqual:O})}return f}function vue(e){return function(t,a,s,f,v,S,i){return e(t,a,i)}}function xue(e){var t=e.circular,a=e.comparator,s=e.createState,f=e.equals,v=e.strict;if(s)return function(O,z){var j=s(),F=j.cache,G=F===void 0?t?new WeakMap:void 0:F,Y=j.meta;return a(O,z,{cache:G,equals:f,meta:Y,strict:v})};if(t)return function(O,z){return a(O,z,{cache:new WeakMap,equals:f,meta:void 0,strict:v})};var S={cache:void 0,equals:f,meta:void 0,strict:v};return function(O,z){return a(O,z,S)}}var bue=Kp();Kp({strict:!0});Kp({circular:!0});Kp({circular:!0,strict:!0});Kp({createInternalComparator:function(){return A0}});Kp({strict:!0,createInternalComparator:function(){return A0}});Kp({circular:!0,createInternalComparator:function(){return A0}});Kp({circular:!0,createInternalComparator:function(){return A0},strict:!0});function Kp(e){e===void 0&&(e={});var t=e.circular,a=t===void 0?!1:t,s=e.createInternalComparator,f=e.createState,v=e.strict,S=v===void 0?!1:v,i=yue(e),O=gue(i),z=s?s(O):vue(O);return xue({circular:a,comparator:O,createState:f,equals:z,strict:S})}function wue(e){typeof requestAnimationFrame<"u"&&requestAnimationFrame(e)}function Tz(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=-1,s=function f(v){a<0&&(a=v),v-a>t?(e(v),a=-1):wue(f)};requestAnimationFrame(s)}function zM(e){"@babel/helpers - typeof";return zM=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zM(e)}function Sue(e){return Cue(e)||Aue(e)||Eue(e)||Tue()}function Tue(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Eue(e,t){if(e){if(typeof e=="string")return Ez(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Ez(e,t)}}function Ez(e,t){(t==null||t>e.length)&&(t=e.length);for(var a=0,s=new Array(t);a<t;a++)s[a]=e[a];return s}function Aue(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Cue(e){if(Array.isArray(e))return e}function Mue(){var e={},t=function(){return null},a=!1,s=function f(v){if(!a){if(Array.isArray(v)){if(!v.length)return;var S=v,i=Sue(S),O=i[0],z=i.slice(1);if(typeof O=="number"){Tz(f.bind(null,z),O);return}f(O),Tz(f.bind(null,z));return}zM(v)==="object"&&(e=v,t(e)),typeof v=="function"&&v()}};return{stop:function(){a=!0},start:function(v){a=!1,s(v)},subscribe:function(v){return t=v,function(){t=function(){return null}}}}}function f1(e){"@babel/helpers - typeof";return f1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},f1(e)}function Az(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(f){return Object.getOwnPropertyDescriptor(e,f).enumerable})),a.push.apply(a,s)}return a}function Cz(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?Az(Object(a),!0).forEach(function(s){oF(e,s,a[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Az(Object(a)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(a,s))})}return e}function oF(e,t,a){return t=Oue(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Oue(e){var t=Iue(e,"string");return f1(t)==="symbol"?t:String(t)}function Iue(e,t){if(f1(e)!=="object"||e===null)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var s=a.call(e,t);if(f1(s)!=="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Pue=function(t,a){return[Object.keys(t),Object.keys(a)].reduce(function(s,f){return s.filter(function(v){return f.includes(v)})})},Rue=function(t){return t},Due=function(t){return t.replace(/([A-Z])/g,function(a){return"-".concat(a.toLowerCase())})},Pv=function(t,a){return Object.keys(a).reduce(function(s,f){return Cz(Cz({},s),{},oF({},f,t(f,a[f])))},{})},Mz=function(t,a,s){return t.map(function(f){return"".concat(Due(f)," ").concat(a,"ms ").concat(s)}).join(",")};function Lue(e,t){return Bue(e)||kue(e,t)||sF(e,t)||zue()}function zue(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function kue(e,t){var a=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(a!=null){var s,f,v,S,i=[],O=!0,z=!1;try{if(v=(a=a.call(e)).next,t!==0)for(;!(O=(s=v.call(a)).done)&&(i.push(s.value),i.length!==t);O=!0);}catch(j){z=!0,f=j}finally{try{if(!O&&a.return!=null&&(S=a.return(),Object(S)!==S))return}finally{if(z)throw f}}return i}}function Bue(e){if(Array.isArray(e))return e}function Nue(e){return Uue(e)||jue(e)||sF(e)||Fue()}function Fue(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function sF(e,t){if(e){if(typeof e=="string")return kM(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return kM(e,t)}}function jue(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Uue(e){if(Array.isArray(e))return kM(e)}function kM(e,t){(t==null||t>e.length)&&(t=e.length);for(var a=0,s=new Array(t);a<t;a++)s[a]=e[a];return s}var pb=1e-4,lF=function(t,a){return[0,3*t,3*a-6*t,3*t-3*a+1]},cF=function(t,a){return t.map(function(s,f){return s*Math.pow(a,f)}).reduce(function(s,f){return s+f})},Oz=function(t,a){return function(s){var f=lF(t,a);return cF(f,s)}},Vue=function(t,a){return function(s){var f=lF(t,a),v=[].concat(Nue(f.map(function(S,i){return S*i}).slice(1)),[0]);return cF(v,s)}},Iz=function(){for(var t=arguments.length,a=new Array(t),s=0;s<t;s++)a[s]=arguments[s];var f=a[0],v=a[1],S=a[2],i=a[3];if(a.length===1)switch(a[0]){case"linear":f=0,v=0,S=1,i=1;break;case"ease":f=.25,v=.1,S=.25,i=1;break;case"ease-in":f=.42,v=0,S=1,i=1;break;case"ease-out":f=.42,v=0,S=.58,i=1;break;case"ease-in-out":f=0,v=0,S=.58,i=1;break;default:{var O=a[0].split("(");if(O[0]==="cubic-bezier"&&O[1].split(")")[0].split(",").length===4){var z=O[1].split(")")[0].split(",").map(function(ne){return parseFloat(ne)}),j=Lue(z,4);f=j[0],v=j[1],S=j[2],i=j[3]}}}var F=Oz(f,S),G=Oz(v,i),Y=Vue(f,S),X=function(se){return se>1?1:se<0?0:se},K=function(se){for(var ge=se>1?1:se,_e=ge,xe=0;xe<8;++xe){var ae=F(_e)-ge,ve=Y(_e);if(Math.abs(ae-ge)<pb||ve<pb)return G(_e);_e=X(_e-ae/ve)}return G(_e)};return K.isStepper=!1,K},$ue=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},a=t.stiff,s=a===void 0?100:a,f=t.damping,v=f===void 0?8:f,S=t.dt,i=S===void 0?17:S,O=function(j,F,G){var Y=-(j-F)*s,X=G*v,K=G+(Y-X)*i/1e3,ne=G*i/1e3+j;return Math.abs(ne-F)<pb&&Math.abs(K)<pb?[F,0]:[ne,K]};return O.isStepper=!0,O.dt=i,O},que=function(){for(var t=arguments.length,a=new Array(t),s=0;s<t;s++)a[s]=arguments[s];var f=a[0];if(typeof f=="string")switch(f){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return Iz(f);case"spring":return $ue();default:if(f.split("(")[0]==="cubic-bezier")return Iz(f)}return typeof f=="function"?f:null};function d1(e){"@babel/helpers - typeof";return d1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},d1(e)}function Pz(e){return Zue(e)||Hue(e)||uF(e)||Gue()}function Gue(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Hue(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Zue(e){if(Array.isArray(e))return NM(e)}function Rz(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(f){return Object.getOwnPropertyDescriptor(e,f).enumerable})),a.push.apply(a,s)}return a}function Xo(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?Rz(Object(a),!0).forEach(function(s){BM(e,s,a[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Rz(Object(a)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(a,s))})}return e}function BM(e,t,a){return t=Wue(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Wue(e){var t=Xue(e,"string");return d1(t)==="symbol"?t:String(t)}function Xue(e,t){if(d1(e)!=="object"||e===null)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var s=a.call(e,t);if(d1(s)!=="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Yue(e,t){return Que(e)||Jue(e,t)||uF(e,t)||Kue()}function Kue(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function uF(e,t){if(e){if(typeof e=="string")return NM(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return NM(e,t)}}function NM(e,t){(t==null||t>e.length)&&(t=e.length);for(var a=0,s=new Array(t);a<t;a++)s[a]=e[a];return s}function Jue(e,t){var a=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(a!=null){var s,f,v,S,i=[],O=!0,z=!1;try{if(v=(a=a.call(e)).next,t!==0)for(;!(O=(s=v.call(a)).done)&&(i.push(s.value),i.length!==t);O=!0);}catch(j){z=!0,f=j}finally{try{if(!O&&a.return!=null&&(S=a.return(),Object(S)!==S))return}finally{if(z)throw f}}return i}}function Que(e){if(Array.isArray(e))return e}var mb=function(t,a,s){return t+(a-t)*s},FM=function(t){var a=t.from,s=t.to;return a!==s},ehe=function e(t,a,s){var f=Pv(function(v,S){if(FM(S)){var i=t(S.from,S.to,S.velocity),O=Yue(i,2),z=O[0],j=O[1];return Xo(Xo({},S),{},{from:z,velocity:j})}return S},a);return s<1?Pv(function(v,S){return FM(S)?Xo(Xo({},S),{},{velocity:mb(S.velocity,f[v].velocity,s),from:mb(S.from,f[v].from,s)}):S},a):e(t,f,s-1)};const the=function(e,t,a,s,f){var v=Pue(e,t),S=v.reduce(function(ne,se){return Xo(Xo({},ne),{},BM({},se,[e[se],t[se]]))},{}),i=v.reduce(function(ne,se){return Xo(Xo({},ne),{},BM({},se,{from:e[se],velocity:0,to:t[se]}))},{}),O=-1,z,j,F=function(){return null},G=function(){return Pv(function(se,ge){return ge.from},i)},Y=function(){return!Object.values(i).filter(FM).length},X=function(se){z||(z=se);var ge=se-z,_e=ge/a.dt;i=ehe(a,i,_e),f(Xo(Xo(Xo({},e),t),G())),z=se,Y()||(O=requestAnimationFrame(F))},K=function(se){j||(j=se);var ge=(se-j)/s,_e=Pv(function(ae,ve){return mb.apply(void 0,Pz(ve).concat([a(ge)]))},S);if(f(Xo(Xo(Xo({},e),t),_e)),ge<1)O=requestAnimationFrame(F);else{var xe=Pv(function(ae,ve){return mb.apply(void 0,Pz(ve).concat([a(1)]))},S);f(Xo(Xo(Xo({},e),t),xe))}};return F=a.isStepper?X:K,function(){return requestAnimationFrame(F),function(){cancelAnimationFrame(O)}}};function Tg(e){"@babel/helpers - typeof";return Tg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Tg(e)}var nhe=["children","begin","duration","attributeName","easing","isActive","steps","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart"];function rhe(e,t){if(e==null)return{};var a=ihe(e,t),s,f;if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(e);for(f=0;f<v.length;f++)s=v[f],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(a[s]=e[s])}return a}function ihe(e,t){if(e==null)return{};var a={},s=Object.keys(e),f,v;for(v=0;v<s.length;v++)f=s[v],!(t.indexOf(f)>=0)&&(a[f]=e[f]);return a}function WA(e){return lhe(e)||she(e)||ohe(e)||ahe()}function ahe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ohe(e,t){if(e){if(typeof e=="string")return jM(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return jM(e,t)}}function she(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function lhe(e){if(Array.isArray(e))return jM(e)}function jM(e,t){(t==null||t>e.length)&&(t=e.length);for(var a=0,s=new Array(t);a<t;a++)s[a]=e[a];return s}function Dz(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(f){return Object.getOwnPropertyDescriptor(e,f).enumerable})),a.push.apply(a,s)}return a}function $u(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?Dz(Object(a),!0).forEach(function(s){Av(e,s,a[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Dz(Object(a)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(a,s))})}return e}function Av(e,t,a){return t=hF(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function che(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function uhe(e,t){for(var a=0;a<t.length;a++){var s=t[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,hF(s.key),s)}}function hhe(e,t,a){return t&&uhe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function hF(e){var t=fhe(e,"string");return Tg(t)==="symbol"?t:String(t)}function fhe(e,t){if(Tg(e)!=="object"||e===null)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var s=a.call(e,t);if(Tg(s)!=="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function dhe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&UM(e,t)}function UM(e,t){return UM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,f){return s.__proto__=f,s},UM(e,t)}function phe(e){var t=mhe();return function(){var s=_b(e),f;if(t){var v=_b(this).constructor;f=Reflect.construct(s,arguments,v)}else f=s.apply(this,arguments);return VM(this,f)}}function VM(e,t){if(t&&(Tg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return $M(e)}function $M(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function mhe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _b(e){return _b=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)},_b(e)}var Zp=function(e){dhe(a,e);var t=phe(a);function a(s,f){var v;che(this,a),v=t.call(this,s,f);var S=v.props,i=S.isActive,O=S.attributeName,z=S.from,j=S.to,F=S.steps,G=S.children,Y=S.duration;if(v.handleStyleChange=v.handleStyleChange.bind($M(v)),v.changeStyle=v.changeStyle.bind($M(v)),!i||Y<=0)return v.state={style:{}},typeof G=="function"&&(v.state={style:j}),VM(v);if(F&&F.length)v.state={style:F[0].style};else if(z){if(typeof G=="function")return v.state={style:z},VM(v);v.state={style:O?Av({},O,z):z}}else v.state={style:{}};return v}return hhe(a,[{key:"componentDidMount",value:function(){var f=this.props,v=f.isActive,S=f.canBegin;this.mounted=!0,!(!v||!S)&&this.runAnimation(this.props)}},{key:"componentDidUpdate",value:function(f){var v=this.props,S=v.isActive,i=v.canBegin,O=v.attributeName,z=v.shouldReAnimate,j=v.to,F=v.from,G=this.state.style;if(i){if(!S){var Y={style:O?Av({},O,j):j};this.state&&G&&(O&&G[O]!==j||!O&&G!==j)&&this.setState(Y);return}if(!(bue(f.to,j)&&f.canBegin&&f.isActive)){var X=!f.canBegin||!f.isActive;this.manager&&this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var K=X||z?F:f.to;if(this.state&&G){var ne={style:O?Av({},O,K):K};(O&&G[O]!==K||!O&&G!==K)&&this.setState(ne)}this.runAnimation($u($u({},this.props),{},{from:K,begin:0}))}}}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var f=this.props.onAnimationEnd;this.unSubscribe&&this.unSubscribe(),this.manager&&(this.manager.stop(),this.manager=null),this.stopJSAnimation&&this.stopJSAnimation(),f&&f()}},{key:"handleStyleChange",value:function(f){this.changeStyle(f)}},{key:"changeStyle",value:function(f){this.mounted&&this.setState({style:f})}},{key:"runJSAnimation",value:function(f){var v=this,S=f.from,i=f.to,O=f.duration,z=f.easing,j=f.begin,F=f.onAnimationEnd,G=f.onAnimationStart,Y=the(S,i,que(z),O,this.changeStyle),X=function(){v.stopJSAnimation=Y()};this.manager.start([G,j,X,O,F])}},{key:"runStepAnimation",value:function(f){var v=this,S=f.steps,i=f.begin,O=f.onAnimationStart,z=S[0],j=z.style,F=z.duration,G=F===void 0?0:F,Y=function(K,ne,se){if(se===0)return K;var ge=ne.duration,_e=ne.easing,xe=_e===void 0?"ease":_e,ae=ne.style,ve=ne.properties,Se=ne.onAnimationEnd,He=se>0?S[se-1]:ne,Ge=ve||Object.keys(ae);if(typeof xe=="function"||xe==="spring")return[].concat(WA(K),[v.runJSAnimation.bind(v,{from:He.style,to:ae,duration:ge,easing:xe}),ge]);var ye=Mz(Ge,ge,xe),Le=$u($u($u({},He.style),ae),{},{transition:ye});return[].concat(WA(K),[Le,ge,Se]).filter(Rue)};return this.manager.start([O].concat(WA(S.reduce(Y,[j,Math.max(G,i)])),[f.onAnimationEnd]))}},{key:"runAnimation",value:function(f){this.manager||(this.manager=Mue());var v=f.begin,S=f.duration,i=f.attributeName,O=f.to,z=f.easing,j=f.onAnimationStart,F=f.onAnimationEnd,G=f.steps,Y=f.children,X=this.manager;if(this.unSubscribe=X.subscribe(this.handleStyleChange),typeof z=="function"||typeof Y=="function"||z==="spring"){this.runJSAnimation(f);return}if(G.length>1){this.runStepAnimation(f);return}var K=i?Av({},i,O):O,ne=Mz(Object.keys(K),S,z);X.start([j,v,$u($u({},K),{},{transition:ne}),S,F])}},{key:"render",value:function(){var f=this.props,v=f.children;f.begin;var S=f.duration;f.attributeName,f.easing;var i=f.isActive;f.steps,f.from,f.to,f.canBegin,f.onAnimationEnd,f.shouldReAnimate,f.onAnimationReStart;var O=rhe(f,nhe),z=Me.Children.count(v),j=this.state.style;if(typeof v=="function")return v(j);if(!i||z===0||S<=0)return v;var F=function(Y){var X=Y.props,K=X.style,ne=K===void 0?{}:K,se=X.className,ge=Me.cloneElement(Y,$u($u({},O),{},{style:$u($u({},ne),j),className:se}));return ge};return z===1?F(Me.Children.only(v)):Ot.createElement("div",null,Me.Children.map(v,function(G){return F(G)}))}}]),a}(Me.PureComponent);Zp.displayName="Animate";Zp.defaultProps={begin:0,duration:1e3,from:"",to:"",attributeName:"",easing:"ease",isActive:!0,canBegin:!0,steps:[],onAnimationEnd:function(){},onAnimationStart:function(){}};Zp.propTypes={from:wi.oneOfType([wi.object,wi.string]),to:wi.oneOfType([wi.object,wi.string]),attributeName:wi.string,duration:wi.number,begin:wi.number,easing:wi.oneOfType([wi.string,wi.func]),steps:wi.arrayOf(wi.shape({duration:wi.number.isRequired,style:wi.object.isRequired,easing:wi.oneOfType([wi.oneOf(["ease","ease-in","ease-out","ease-in-out","linear"]),wi.func]),properties:wi.arrayOf("string"),onAnimationEnd:wi.func})),children:wi.oneOfType([wi.node,wi.func]),isActive:wi.bool,canBegin:wi.bool,onAnimationEnd:wi.func,shouldReAnimate:wi.bool,onAnimationStart:wi.func,onAnimationReStart:wi.func};var fF=g8();function p1(e){"@babel/helpers - typeof";return p1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},p1(e)}function gb(){return gb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},gb.apply(this,arguments)}function _he(e,t){return xhe(e)||vhe(e,t)||yhe(e,t)||ghe()}function ghe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yhe(e,t){if(e){if(typeof e=="string")return Lz(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Lz(e,t)}}function Lz(e,t){(t==null||t>e.length)&&(t=e.length);for(var a=0,s=new Array(t);a<t;a++)s[a]=e[a];return s}function vhe(e,t){var a=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(a!=null){var s,f,v,S,i=[],O=!0,z=!1;try{if(v=(a=a.call(e)).next,t!==0)for(;!(O=(s=v.call(a)).done)&&(i.push(s.value),i.length!==t);O=!0);}catch(j){z=!0,f=j}finally{try{if(!O&&a.return!=null&&(S=a.return(),Object(S)!==S))return}finally{if(z)throw f}}return i}}function xhe(e){if(Array.isArray(e))return e}function zz(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(f){return Object.getOwnPropertyDescriptor(e,f).enumerable})),a.push.apply(a,s)}return a}function kz(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?zz(Object(a),!0).forEach(function(s){bhe(e,s,a[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):zz(Object(a)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(a,s))})}return e}function bhe(e,t,a){return t=whe(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function whe(e){var t=She(e,"string");return p1(t)=="symbol"?t:t+""}function She(e,t){if(p1(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var s=a.call(e,t);if(p1(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Bz=function(t,a,s,f,v){var S=Math.min(Math.abs(s)/2,Math.abs(f)/2),i=f>=0?1:-1,O=s>=0?1:-1,z=f>=0&&s>=0||f<0&&s<0?1:0,j;if(S>0&&v instanceof Array){for(var F=[0,0,0,0],G=0,Y=4;G<Y;G++)F[G]=v[G]>S?S:v[G];j="M".concat(t,",").concat(a+i*F[0]),F[0]>0&&(j+="A ".concat(F[0],",").concat(F[0],",0,0,").concat(z,",").concat(t+O*F[0],",").concat(a)),j+="L ".concat(t+s-O*F[1],",").concat(a),F[1]>0&&(j+="A ".concat(F[1],",").concat(F[1],",0,0,").concat(z,`,
        `).concat(t+s,",").concat(a+i*F[1])),j+="L ".concat(t+s,",").concat(a+f-i*F[2]),F[2]>0&&(j+="A ".concat(F[2],",").concat(F[2],",0,0,").concat(z,`,
        `).concat(t+s-O*F[2],",").concat(a+f)),j+="L ".concat(t+O*F[3],",").concat(a+f),F[3]>0&&(j+="A ".concat(F[3],",").concat(F[3],",0,0,").concat(z,`,
        `).concat(t,",").concat(a+f-i*F[3])),j+="Z"}else if(S>0&&v===+v&&v>0){var X=Math.min(S,v);j="M ".concat(t,",").concat(a+i*X,`
            A `).concat(X,",").concat(X,",0,0,").concat(z,",").concat(t+O*X,",").concat(a,`
            L `).concat(t+s-O*X,",").concat(a,`
            A `).concat(X,",").concat(X,",0,0,").concat(z,",").concat(t+s,",").concat(a+i*X,`
            L `).concat(t+s,",").concat(a+f-i*X,`
            A `).concat(X,",").concat(X,",0,0,").concat(z,",").concat(t+s-O*X,",").concat(a+f,`
            L `).concat(t+O*X,",").concat(a+f,`
            A `).concat(X,",").concat(X,",0,0,").concat(z,",").concat(t,",").concat(a+f-i*X," Z")}else j="M ".concat(t,",").concat(a," h ").concat(s," v ").concat(f," h ").concat(-s," Z");return j},The=function(t,a){if(!t||!a)return!1;var s=t.x,f=t.y,v=a.x,S=a.y,i=a.width,O=a.height;if(Math.abs(i)>0&&Math.abs(O)>0){var z=Math.min(v,v+i),j=Math.max(v,v+i),F=Math.min(S,S+O),G=Math.max(S,S+O);return s>=z&&s<=j&&f>=F&&f<=G}return!1},Ehe={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},L4=function(t){var a=kz(kz({},Ehe),t),s=Me.useRef(),f=Me.useState(-1),v=_he(f,2),S=v[0],i=v[1];Me.useEffect(function(){if(s.current&&s.current.getTotalLength)try{var xe=s.current.getTotalLength();xe&&i(xe)}catch{}},[]);var O=a.x,z=a.y,j=a.width,F=a.height,G=a.radius,Y=a.className,X=a.animationEasing,K=a.animationDuration,ne=a.animationBegin,se=a.isAnimationActive,ge=a.isUpdateAnimationActive;if(O!==+O||z!==+z||j!==+j||F!==+F||j===0||F===0)return null;var _e=oi("recharts-rectangle",Y);return ge?Ot.createElement(Zp,{canBegin:S>0,from:{width:j,height:F,x:O,y:z},to:{width:j,height:F,x:O,y:z},duration:K,animationEasing:X,isActive:ge},function(xe){var ae=xe.width,ve=xe.height,Se=xe.x,He=xe.y;return Ot.createElement(Zp,{canBegin:S>0,from:"0px ".concat(S===-1?1:S,"px"),to:"".concat(S,"px 0px"),attributeName:"strokeDasharray",begin:ne,duration:K,isActive:se,easing:X},Ot.createElement("path",gb({},Fr(a,!0),{className:_e,d:Bz(Se,He,ae,ve,G),ref:s})))}):Ot.createElement("path",gb({},Fr(a,!0),{className:_e,d:Bz(O,z,j,F,G)}))},Ahe=["points","className","baseLinePoints","connectNulls"];function eg(){return eg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},eg.apply(this,arguments)}function Che(e,t){if(e==null)return{};var a=Mhe(e,t),s,f;if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(e);for(f=0;f<v.length;f++)s=v[f],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(a[s]=e[s])}return a}function Mhe(e,t){if(e==null)return{};var a={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(t.indexOf(s)>=0)continue;a[s]=e[s]}return a}function Nz(e){return Rhe(e)||Phe(e)||Ihe(e)||Ohe()}function Ohe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ihe(e,t){if(e){if(typeof e=="string")return qM(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return qM(e,t)}}function Phe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Rhe(e){if(Array.isArray(e))return qM(e)}function qM(e,t){(t==null||t>e.length)&&(t=e.length);for(var a=0,s=new Array(t);a<t;a++)s[a]=e[a];return s}var Fz=function(t){return t&&t.x===+t.x&&t.y===+t.y},Dhe=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],a=[[]];return t.forEach(function(s){Fz(s)?a[a.length-1].push(s):a[a.length-1].length>0&&a.push([])}),Fz(t[0])&&a[a.length-1].push(t[0]),a[a.length-1].length<=0&&(a=a.slice(0,-1)),a},Rv=function(t,a){var s=Dhe(t);a&&(s=[s.reduce(function(v,S){return[].concat(Nz(v),Nz(S))},[])]);var f=s.map(function(v){return v.reduce(function(S,i,O){return"".concat(S).concat(O===0?"M":"L").concat(i.x,",").concat(i.y)},"")}).join("");return s.length===1?"".concat(f,"Z"):f},Lhe=function(t,a,s){var f=Rv(t,s);return"".concat(f.slice(-1)==="Z"?f.slice(0,-1):f,"L").concat(Rv(a.reverse(),s).slice(1))},zhe=function(t){var a=t.points,s=t.className,f=t.baseLinePoints,v=t.connectNulls,S=Che(t,Ahe);if(!a||!a.length)return null;var i=oi("recharts-polygon",s);if(f&&f.length){var O=S.stroke&&S.stroke!=="none",z=Lhe(a,f,v);return Ot.createElement("g",{className:i},Ot.createElement("path",eg({},Fr(S,!0),{fill:z.slice(-1)==="Z"?S.fill:"none",stroke:"none",d:z})),O?Ot.createElement("path",eg({},Fr(S,!0),{fill:"none",d:Rv(a,v)})):null,O?Ot.createElement("path",eg({},Fr(S,!0),{fill:"none",d:Rv(f,v)})):null)}var j=Rv(a,v);return Ot.createElement("path",eg({},Fr(S,!0),{fill:j.slice(-1)==="Z"?S.fill:"none",className:i,d:j}))};function GM(){return GM=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},GM.apply(this,arguments)}var z4=function(t){var a=t.cx,s=t.cy,f=t.r,v=t.className,S=oi("recharts-dot",v);return a===+a&&s===+s&&f===+f?Ot.createElement("circle",GM({},Fr(t,!1),Vx(t),{className:S,cx:a,cy:s,r:f})):null};function m1(e){"@babel/helpers - typeof";return m1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},m1(e)}var khe=["x","y","top","left","width","height","className"];function HM(){return HM=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},HM.apply(this,arguments)}function jz(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(f){return Object.getOwnPropertyDescriptor(e,f).enumerable})),a.push.apply(a,s)}return a}function Bhe(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?jz(Object(a),!0).forEach(function(s){Nhe(e,s,a[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):jz(Object(a)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(a,s))})}return e}function Nhe(e,t,a){return t=Fhe(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Fhe(e){var t=jhe(e,"string");return m1(t)=="symbol"?t:t+""}function jhe(e,t){if(m1(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var s=a.call(e,t);if(m1(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Uhe(e,t){if(e==null)return{};var a=Vhe(e,t),s,f;if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(e);for(f=0;f<v.length;f++)s=v[f],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(a[s]=e[s])}return a}function Vhe(e,t){if(e==null)return{};var a={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(t.indexOf(s)>=0)continue;a[s]=e[s]}return a}var $he=function(t,a,s,f,v,S){return"M".concat(t,",").concat(v,"v").concat(f,"M").concat(S,",").concat(a,"h").concat(s)},qhe=function(t){var a=t.x,s=a===void 0?0:a,f=t.y,v=f===void 0?0:f,S=t.top,i=S===void 0?0:S,O=t.left,z=O===void 0?0:O,j=t.width,F=j===void 0?0:j,G=t.height,Y=G===void 0?0:G,X=t.className,K=Uhe(t,khe),ne=Bhe({x:s,y:v,top:i,left:z,width:F,height:Y},K);return!Nn(s)||!Nn(v)||!Nn(F)||!Nn(Y)||!Nn(i)||!Nn(z)?null:Ot.createElement("path",HM({},Fr(ne,!0),{className:oi("recharts-cross",X),d:$he(s,v,F,Y,i,z)}))},XA,Uz;function Ghe(){if(Uz)return XA;Uz=1;var e=vw(),t=PN(),a=sf();function s(f,v){return f&&f.length?e(f,a(v,2),t):void 0}return XA=s,XA}var Hhe=Ghe();const Zhe=Ei(Hhe);var YA,Vz;function Whe(){if(Vz)return YA;Vz=1;var e=vw(),t=sf(),a=RN();function s(f,v){return f&&f.length?e(f,t(v,2),a):void 0}return YA=s,YA}var Xhe=Whe();const Yhe=Ei(Xhe);var Khe=["cx","cy","angle","ticks","axisLine"],Jhe=["ticks","tick","angle","tickFormatter","stroke"];function Eg(e){"@babel/helpers - typeof";return Eg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Eg(e)}function Dv(){return Dv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},Dv.apply(this,arguments)}function $z(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(f){return Object.getOwnPropertyDescriptor(e,f).enumerable})),a.push.apply(a,s)}return a}function s0(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?$z(Object(a),!0).forEach(function(s){Tw(e,s,a[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):$z(Object(a)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(a,s))})}return e}function qz(e,t){if(e==null)return{};var a=Qhe(e,t),s,f;if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(e);for(f=0;f<v.length;f++)s=v[f],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(a[s]=e[s])}return a}function Qhe(e,t){if(e==null)return{};var a={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(t.indexOf(s)>=0)continue;a[s]=e[s]}return a}function efe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Gz(e,t){for(var a=0;a<t.length;a++){var s=t[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,pF(s.key),s)}}function tfe(e,t,a){return t&&Gz(e.prototype,t),a&&Gz(e,a),Object.defineProperty(e,"prototype",{writable:!1}),e}function nfe(e,t,a){return t=yb(t),rfe(e,dF()?Reflect.construct(t,a||[],yb(e).constructor):t.apply(e,a))}function rfe(e,t){if(t&&(Eg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ife(e)}function ife(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function dF(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(dF=function(){return!!e})()}function yb(e){return yb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)},yb(e)}function afe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ZM(e,t)}function ZM(e,t){return ZM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,f){return s.__proto__=f,s},ZM(e,t)}function Tw(e,t,a){return t=pF(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function pF(e){var t=ofe(e,"string");return Eg(t)=="symbol"?t:t+""}function ofe(e,t){if(Eg(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var s=a.call(e,t);if(Eg(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ew=function(e){function t(){return efe(this,t),nfe(this,t,arguments)}return afe(t,e),tfe(t,[{key:"getTickValueCoord",value:function(s){var f=s.coordinate,v=this.props,S=v.angle,i=v.cx,O=v.cy;return Wi(i,O,f,S)}},{key:"getTickTextAnchor",value:function(){var s=this.props.orientation,f;switch(s){case"left":f="end";break;case"right":f="start";break;default:f="middle";break}return f}},{key:"getViewBox",value:function(){var s=this.props,f=s.cx,v=s.cy,S=s.angle,i=s.ticks,O=Zhe(i,function(j){return j.coordinate||0}),z=Yhe(i,function(j){return j.coordinate||0});return{cx:f,cy:v,startAngle:S,endAngle:S,innerRadius:z.coordinate||0,outerRadius:O.coordinate||0}}},{key:"renderAxisLine",value:function(){var s=this.props,f=s.cx,v=s.cy,S=s.angle,i=s.ticks,O=s.axisLine,z=qz(s,Khe),j=i.reduce(function(X,K){return[Math.min(X[0],K.coordinate),Math.max(X[1],K.coordinate)]},[1/0,-1/0]),F=Wi(f,v,j[0],S),G=Wi(f,v,j[1],S),Y=s0(s0(s0({},Fr(z,!1)),{},{fill:"none"},Fr(O,!1)),{},{x1:F.x,y1:F.y,x2:G.x,y2:G.y});return Ot.createElement("line",Dv({className:"recharts-polar-radius-axis-line"},Y))}},{key:"renderTicks",value:function(){var s=this,f=this.props,v=f.ticks,S=f.tick,i=f.angle,O=f.tickFormatter,z=f.stroke,j=qz(f,Jhe),F=this.getTickTextAnchor(),G=Fr(j,!1),Y=Fr(S,!1),X=v.map(function(K,ne){var se=s.getTickValueCoord(K),ge=s0(s0(s0(s0({textAnchor:F,transform:"rotate(".concat(90-i,", ").concat(se.x,", ").concat(se.y,")")},G),{},{stroke:"none",fill:z},Y),{},{index:ne},se),{},{payload:K});return Ot.createElement(Ua,Dv({className:oi("recharts-polar-radius-axis-tick",tF(S)),key:"tick-".concat(K.coordinate)},iw(s.props,K,ne)),t.renderTickItem(S,ge,O?O(K.value,ne):K.value))});return Ot.createElement(Ua,{className:"recharts-polar-radius-axis-ticks"},X)}},{key:"render",value:function(){var s=this.props,f=s.ticks,v=s.axisLine,S=s.tick;return!f||!f.length?null:Ot.createElement(Ua,{className:oi("recharts-polar-radius-axis",this.props.className)},v&&this.renderAxisLine(),S&&this.renderTicks(),Ko.renderCallByParent(this.props,this.getViewBox()))}}],[{key:"renderTickItem",value:function(s,f,v){var S;return Ot.isValidElement(s)?S=Ot.cloneElement(s,f):Vr(s)?S=s(f):S=Ot.createElement(yg,Dv({},f,{className:"recharts-polar-radius-axis-tick-value"}),v),S}}])}(Me.PureComponent);Tw(Ew,"displayName","PolarRadiusAxis");Tw(Ew,"axisType","radiusAxis");Tw(Ew,"defaultProps",{type:"number",radiusAxisId:0,cx:0,cy:0,angle:0,orientation:"right",stroke:"#ccc",axisLine:!0,tick:!0,tickCount:5,allowDataOverflow:!1,scale:"auto",allowDuplicatedCategory:!0});function Ag(e){"@babel/helpers - typeof";return Ag=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ag(e)}function f0(){return f0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},f0.apply(this,arguments)}function Hz(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(f){return Object.getOwnPropertyDescriptor(e,f).enumerable})),a.push.apply(a,s)}return a}function l0(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?Hz(Object(a),!0).forEach(function(s){Aw(e,s,a[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Hz(Object(a)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(a,s))})}return e}function sfe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Zz(e,t){for(var a=0;a<t.length;a++){var s=t[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,_F(s.key),s)}}function lfe(e,t,a){return t&&Zz(e.prototype,t),a&&Zz(e,a),Object.defineProperty(e,"prototype",{writable:!1}),e}function cfe(e,t,a){return t=vb(t),ufe(e,mF()?Reflect.construct(t,a||[],vb(e).constructor):t.apply(e,a))}function ufe(e,t){if(t&&(Ag(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return hfe(e)}function hfe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function mF(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(mF=function(){return!!e})()}function vb(e){return vb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)},vb(e)}function ffe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&WM(e,t)}function WM(e,t){return WM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,f){return s.__proto__=f,s},WM(e,t)}function Aw(e,t,a){return t=_F(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function _F(e){var t=dfe(e,"string");return Ag(t)=="symbol"?t:t+""}function dfe(e,t){if(Ag(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var s=a.call(e,t);if(Ag(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var pfe=Math.PI/180,mfe=1e-5,Cw=function(e){function t(){return sfe(this,t),cfe(this,t,arguments)}return ffe(t,e),lfe(t,[{key:"getTickLineCoord",value:function(s){var f=this.props,v=f.cx,S=f.cy,i=f.radius,O=f.orientation,z=f.tickSize,j=z||8,F=Wi(v,S,i,s.coordinate),G=Wi(v,S,i+(O==="inner"?-1:1)*j,s.coordinate);return{x1:F.x,y1:F.y,x2:G.x,y2:G.y}}},{key:"getTickTextAnchor",value:function(s){var f=this.props.orientation,v=Math.cos(-s.coordinate*pfe),S;return v>mfe?S=f==="outer"?"start":"end":v<-1e-5?S=f==="outer"?"end":"start":S="middle",S}},{key:"renderAxisLine",value:function(){var s=this.props,f=s.cx,v=s.cy,S=s.radius,i=s.axisLine,O=s.axisLineType,z=l0(l0({},Fr(this.props,!1)),{},{fill:"none"},Fr(i,!1));if(O==="circle")return Ot.createElement(z4,f0({className:"recharts-polar-angle-axis-line"},z,{cx:f,cy:v,r:S}));var j=this.props.ticks,F=j.map(function(G){return Wi(f,v,S,G.coordinate)});return Ot.createElement(zhe,f0({className:"recharts-polar-angle-axis-line"},z,{points:F}))}},{key:"renderTicks",value:function(){var s=this,f=this.props,v=f.ticks,S=f.tick,i=f.tickLine,O=f.tickFormatter,z=f.stroke,j=Fr(this.props,!1),F=Fr(S,!1),G=l0(l0({},j),{},{fill:"none"},Fr(i,!1)),Y=v.map(function(X,K){var ne=s.getTickLineCoord(X),se=s.getTickTextAnchor(X),ge=l0(l0(l0({textAnchor:se},j),{},{stroke:"none",fill:z},F),{},{index:K,payload:X,x:ne.x2,y:ne.y2});return Ot.createElement(Ua,f0({className:oi("recharts-polar-angle-axis-tick",tF(S)),key:"tick-".concat(X.coordinate)},iw(s.props,X,K)),i&&Ot.createElement("line",f0({className:"recharts-polar-angle-axis-tick-line"},G,ne)),S&&t.renderTickItem(S,ge,O?O(X.value,K):X.value))});return Ot.createElement(Ua,{className:"recharts-polar-angle-axis-ticks"},Y)}},{key:"render",value:function(){var s=this.props,f=s.ticks,v=s.radius,S=s.axisLine;return v<=0||!f||!f.length?null:Ot.createElement(Ua,{className:oi("recharts-polar-angle-axis",this.props.className)},S&&this.renderAxisLine(),this.renderTicks())}}],[{key:"renderTickItem",value:function(s,f,v){var S;return Ot.isValidElement(s)?S=Ot.cloneElement(s,f):Vr(s)?S=s(f):S=Ot.createElement(yg,f0({},f,{className:"recharts-polar-angle-axis-tick-value"}),v),S}}])}(Me.PureComponent);Aw(Cw,"displayName","PolarAngleAxis");Aw(Cw,"axisType","angleAxis");Aw(Cw,"defaultProps",{type:"category",angleAxisId:0,scale:"auto",cx:0,cy:0,orientation:"outer",axisLine:!0,tickLine:!0,tickSize:8,tick:!0,hide:!1,allowDuplicatedCategory:!0});var KA,Wz;function _fe(){if(Wz)return KA;Wz=1;var e=OB(),t=e(Object.getPrototypeOf,Object);return KA=t,KA}var JA,Xz;function gfe(){if(Xz)return JA;Xz=1;var e=Rd(),t=_fe(),a=Dd(),s="[object Object]",f=Function.prototype,v=Object.prototype,S=f.toString,i=v.hasOwnProperty,O=S.call(Object);function z(j){if(!a(j)||e(j)!=s)return!1;var F=t(j);if(F===null)return!0;var G=i.call(F,"constructor")&&F.constructor;return typeof G=="function"&&G instanceof G&&S.call(G)==O}return JA=z,JA}var yfe=gfe();const vfe=Ei(yfe);var QA,Yz;function xfe(){if(Yz)return QA;Yz=1;var e=Rd(),t=Dd(),a="[object Boolean]";function s(f){return f===!0||f===!1||t(f)&&e(f)==a}return QA=s,QA}var bfe=xfe();const wfe=Ei(bfe);function _1(e){"@babel/helpers - typeof";return _1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_1(e)}function xb(){return xb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},xb.apply(this,arguments)}function Sfe(e,t){return Cfe(e)||Afe(e,t)||Efe(e,t)||Tfe()}function Tfe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Efe(e,t){if(e){if(typeof e=="string")return Kz(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Kz(e,t)}}function Kz(e,t){(t==null||t>e.length)&&(t=e.length);for(var a=0,s=new Array(t);a<t;a++)s[a]=e[a];return s}function Afe(e,t){var a=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(a!=null){var s,f,v,S,i=[],O=!0,z=!1;try{if(v=(a=a.call(e)).next,t!==0)for(;!(O=(s=v.call(a)).done)&&(i.push(s.value),i.length!==t);O=!0);}catch(j){z=!0,f=j}finally{try{if(!O&&a.return!=null&&(S=a.return(),Object(S)!==S))return}finally{if(z)throw f}}return i}}function Cfe(e){if(Array.isArray(e))return e}function Jz(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(f){return Object.getOwnPropertyDescriptor(e,f).enumerable})),a.push.apply(a,s)}return a}function Qz(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?Jz(Object(a),!0).forEach(function(s){Mfe(e,s,a[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Jz(Object(a)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(a,s))})}return e}function Mfe(e,t,a){return t=Ofe(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Ofe(e){var t=Ife(e,"string");return _1(t)=="symbol"?t:t+""}function Ife(e,t){if(_1(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var s=a.call(e,t);if(_1(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ek=function(t,a,s,f,v){var S=s-f,i;return i="M ".concat(t,",").concat(a),i+="L ".concat(t+s,",").concat(a),i+="L ".concat(t+s-S/2,",").concat(a+v),i+="L ".concat(t+s-S/2-f,",").concat(a+v),i+="L ".concat(t,",").concat(a," Z"),i},Pfe={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},Rfe=function(t){var a=Qz(Qz({},Pfe),t),s=Me.useRef(),f=Me.useState(-1),v=Sfe(f,2),S=v[0],i=v[1];Me.useEffect(function(){if(s.current&&s.current.getTotalLength)try{var _e=s.current.getTotalLength();_e&&i(_e)}catch{}},[]);var O=a.x,z=a.y,j=a.upperWidth,F=a.lowerWidth,G=a.height,Y=a.className,X=a.animationEasing,K=a.animationDuration,ne=a.animationBegin,se=a.isUpdateAnimationActive;if(O!==+O||z!==+z||j!==+j||F!==+F||G!==+G||j===0&&F===0||G===0)return null;var ge=oi("recharts-trapezoid",Y);return se?Ot.createElement(Zp,{canBegin:S>0,from:{upperWidth:0,lowerWidth:0,height:G,x:O,y:z},to:{upperWidth:j,lowerWidth:F,height:G,x:O,y:z},duration:K,animationEasing:X,isActive:se},function(_e){var xe=_e.upperWidth,ae=_e.lowerWidth,ve=_e.height,Se=_e.x,He=_e.y;return Ot.createElement(Zp,{canBegin:S>0,from:"0px ".concat(S===-1?1:S,"px"),to:"".concat(S,"px 0px"),attributeName:"strokeDasharray",begin:ne,duration:K,easing:X},Ot.createElement("path",xb({},Fr(a,!0),{className:ge,d:ek(Se,He,xe,ae,ve),ref:s})))}):Ot.createElement("g",null,Ot.createElement("path",xb({},Fr(a,!0),{className:ge,d:ek(O,z,j,F,G)})))},Dfe=["option","shapeType","propTransformer","activeClassName","isActive"];function g1(e){"@babel/helpers - typeof";return g1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},g1(e)}function Lfe(e,t){if(e==null)return{};var a=zfe(e,t),s,f;if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(e);for(f=0;f<v.length;f++)s=v[f],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(a[s]=e[s])}return a}function zfe(e,t){if(e==null)return{};var a={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(t.indexOf(s)>=0)continue;a[s]=e[s]}return a}function tk(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(f){return Object.getOwnPropertyDescriptor(e,f).enumerable})),a.push.apply(a,s)}return a}function bb(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?tk(Object(a),!0).forEach(function(s){kfe(e,s,a[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):tk(Object(a)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(a,s))})}return e}function kfe(e,t,a){return t=Bfe(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Bfe(e){var t=Nfe(e,"string");return g1(t)=="symbol"?t:t+""}function Nfe(e,t){if(g1(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var s=a.call(e,t);if(g1(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ffe(e,t){return bb(bb({},t),e)}function jfe(e,t){return e==="symbols"}function nk(e){var t=e.shapeType,a=e.elementProps;switch(t){case"rectangle":return Ot.createElement(L4,a);case"trapezoid":return Ot.createElement(Rfe,a);case"sector":return Ot.createElement(iF,a);case"symbols":if(jfe(t))return Ot.createElement(K5,a);break;default:return null}}function Ufe(e){return Me.isValidElement(e)?e.props:e}function Vfe(e){var t=e.option,a=e.shapeType,s=e.propTransformer,f=s===void 0?Ffe:s,v=e.activeClassName,S=v===void 0?"recharts-active-shape":v,i=e.isActive,O=Lfe(e,Dfe),z;if(Me.isValidElement(t))z=Me.cloneElement(t,bb(bb({},O),Ufe(t)));else if(Vr(t))z=t(O);else if(vfe(t)&&!wfe(t)){var j=f(t,O);z=Ot.createElement(nk,{shapeType:a,elementProps:j})}else{var F=O;z=Ot.createElement(nk,{shapeType:a,elementProps:F})}return i?Ot.createElement(Ua,{className:S},z):z}function Mw(e,t){return t!=null&&"trapezoids"in e.props}function Ow(e,t){return t!=null&&"sectors"in e.props}function y1(e,t){return t!=null&&"points"in e.props}function $fe(e,t){var a,s,f=e.x===(t==null||(a=t.labelViewBox)===null||a===void 0?void 0:a.x)||e.x===t.x,v=e.y===(t==null||(s=t.labelViewBox)===null||s===void 0?void 0:s.y)||e.y===t.y;return f&&v}function qfe(e,t){var a=e.endAngle===t.endAngle,s=e.startAngle===t.startAngle;return a&&s}function Gfe(e,t){var a=e.x===t.x,s=e.y===t.y,f=e.z===t.z;return a&&s&&f}function Hfe(e,t){var a;return Mw(e,t)?a=$fe:Ow(e,t)?a=qfe:y1(e,t)&&(a=Gfe),a}function Zfe(e,t){var a;return Mw(e,t)?a="trapezoids":Ow(e,t)?a="sectors":y1(e,t)&&(a="points"),a}function Wfe(e,t){if(Mw(e,t)){var a;return(a=t.tooltipPayload)===null||a===void 0||(a=a[0])===null||a===void 0||(a=a.payload)===null||a===void 0?void 0:a.payload}if(Ow(e,t)){var s;return(s=t.tooltipPayload)===null||s===void 0||(s=s[0])===null||s===void 0||(s=s.payload)===null||s===void 0?void 0:s.payload}return y1(e,t)?t.payload:{}}function Xfe(e){var t=e.activeTooltipItem,a=e.graphicalItem,s=e.itemData,f=Zfe(a,t),v=Wfe(a,t),S=s.filter(function(O,z){var j=O4(v,O),F=a.props[f].filter(function(X){var K=Hfe(a,t);return K(X,t)}),G=a.props[f].indexOf(F[F.length-1]),Y=z===G;return j&&Y}),i=s.indexOf(S[S.length-1]);return i}var Rx;function Cg(e){"@babel/helpers - typeof";return Cg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cg(e)}function tg(){return tg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},tg.apply(this,arguments)}function rk(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(f){return Object.getOwnPropertyDescriptor(e,f).enumerable})),a.push.apply(a,s)}return a}function Hi(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?rk(Object(a),!0).forEach(function(s){Jc(e,s,a[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):rk(Object(a)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(a,s))})}return e}function Yfe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ik(e,t){for(var a=0;a<t.length;a++){var s=t[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,yF(s.key),s)}}function Kfe(e,t,a){return t&&ik(e.prototype,t),a&&ik(e,a),Object.defineProperty(e,"prototype",{writable:!1}),e}function Jfe(e,t,a){return t=wb(t),Qfe(e,gF()?Reflect.construct(t,a||[],wb(e).constructor):t.apply(e,a))}function Qfe(e,t){if(t&&(Cg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ede(e)}function ede(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gF(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(gF=function(){return!!e})()}function wb(e){return wb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)},wb(e)}function tde(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&XM(e,t)}function XM(e,t){return XM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,f){return s.__proto__=f,s},XM(e,t)}function Jc(e,t,a){return t=yF(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function yF(e){var t=nde(e,"string");return Cg(t)=="symbol"?t:t+""}function nde(e,t){if(Cg(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var s=a.call(e,t);if(Cg(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var af=function(e){function t(a){var s;return Yfe(this,t),s=Jfe(this,t,[a]),Jc(s,"pieRef",null),Jc(s,"sectorRefs",[]),Jc(s,"id",rw("recharts-pie-")),Jc(s,"handleAnimationEnd",function(){var f=s.props.onAnimationEnd;s.setState({isAnimationFinished:!0}),Vr(f)&&f()}),Jc(s,"handleAnimationStart",function(){var f=s.props.onAnimationStart;s.setState({isAnimationFinished:!1}),Vr(f)&&f()}),s.state={isAnimationFinished:!a.isAnimationActive,prevIsAnimationActive:a.isAnimationActive,prevAnimationId:a.animationId,sectorToFocus:0},s}return tde(t,e),Kfe(t,[{key:"isActiveIndex",value:function(s){var f=this.props.activeIndex;return Array.isArray(f)?f.indexOf(s)!==-1:s===f}},{key:"hasActiveIndex",value:function(){var s=this.props.activeIndex;return Array.isArray(s)?s.length!==0:s||s===0}},{key:"renderLabels",value:function(s){var f=this.props.isAnimationActive;if(f&&!this.state.isAnimationFinished)return null;var v=this.props,S=v.label,i=v.labelLine,O=v.dataKey,z=v.valueKey,j=Fr(this.props,!1),F=Fr(S,!1),G=Fr(i,!1),Y=S&&S.offsetRadius||20,X=s.map(function(K,ne){var se=(K.startAngle+K.endAngle)/2,ge=Wi(K.cx,K.cy,K.outerRadius+Y,se),_e=Hi(Hi(Hi(Hi({},j),K),{},{stroke:"none"},F),{},{index:ne,textAnchor:t.getTextAnchor(ge.x,K.cx)},ge),xe=Hi(Hi(Hi(Hi({},j),K),{},{fill:"none",stroke:K.fill},G),{},{index:ne,points:[Wi(K.cx,K.cy,K.outerRadius,se),ge]}),ae=O;return ei(O)&&ei(z)?ae="value":ei(O)&&(ae=z),Ot.createElement(Ua,{key:"label-".concat(K.startAngle,"-").concat(K.endAngle,"-").concat(K.midAngle,"-").concat(ne)},i&&t.renderLabelLineItem(i,xe,"line"),t.renderLabelItem(S,_e,Kl(K,ae)))});return Ot.createElement(Ua,{className:"recharts-pie-labels"},X)}},{key:"renderSectorsStatically",value:function(s){var f=this,v=this.props,S=v.activeShape,i=v.blendStroke,O=v.inactiveShape;return s.map(function(z,j){if((z==null?void 0:z.startAngle)===0&&(z==null?void 0:z.endAngle)===0&&s.length!==1)return null;var F=f.isActiveIndex(j),G=O&&f.hasActiveIndex()?O:null,Y=F?S:G,X=Hi(Hi({},z),{},{stroke:i?z.fill:z.stroke,tabIndex:-1});return Ot.createElement(Ua,tg({ref:function(ne){ne&&!f.sectorRefs.includes(ne)&&f.sectorRefs.push(ne)},tabIndex:-1,className:"recharts-pie-sector"},iw(f.props,z,j),{key:"sector-".concat(z==null?void 0:z.startAngle,"-").concat(z==null?void 0:z.endAngle,"-").concat(z.midAngle,"-").concat(j)}),Ot.createElement(Vfe,tg({option:Y,isActive:F,shapeType:"sector"},X)))})}},{key:"renderSectorsWithAnimation",value:function(){var s=this,f=this.props,v=f.sectors,S=f.isAnimationActive,i=f.animationBegin,O=f.animationDuration,z=f.animationEasing,j=f.animationId,F=this.state,G=F.prevSectors,Y=F.prevIsAnimationActive;return Ot.createElement(Zp,{begin:i,duration:O,isActive:S,easing:z,from:{t:0},to:{t:1},key:"pie-".concat(j,"-").concat(Y),onAnimationStart:this.handleAnimationStart,onAnimationEnd:this.handleAnimationEnd},function(X){var K=X.t,ne=[],se=v&&v[0],ge=se.startAngle;return v.forEach(function(_e,xe){var ae=G&&G[xe],ve=xe>0?Hu(_e,"paddingAngle",0):0;if(ae){var Se=fR(ae.endAngle-ae.startAngle,_e.endAngle-_e.startAngle),He=Hi(Hi({},_e),{},{startAngle:ge+ve,endAngle:ge+Se(K)+ve});ne.push(He),ge=He.endAngle}else{var Ge=_e.endAngle,ye=_e.startAngle,Le=fR(0,Ge-ye),ht=Le(K),gt=Hi(Hi({},_e),{},{startAngle:ge+ve,endAngle:ge+ht+ve});ne.push(gt),ge=gt.endAngle}}),Ot.createElement(Ua,null,s.renderSectorsStatically(ne))})}},{key:"attachKeyboardHandlers",value:function(s){var f=this;s.onkeydown=function(v){if(!v.altKey)switch(v.key){case"ArrowLeft":{var S=++f.state.sectorToFocus%f.sectorRefs.length;f.sectorRefs[S].focus(),f.setState({sectorToFocus:S});break}case"ArrowRight":{var i=--f.state.sectorToFocus<0?f.sectorRefs.length-1:f.state.sectorToFocus%f.sectorRefs.length;f.sectorRefs[i].focus(),f.setState({sectorToFocus:i});break}case"Escape":{f.sectorRefs[f.state.sectorToFocus].blur(),f.setState({sectorToFocus:0});break}}}}},{key:"renderSectors",value:function(){var s=this.props,f=s.sectors,v=s.isAnimationActive,S=this.state.prevSectors;return v&&f&&f.length&&(!S||!O4(S,f))?this.renderSectorsWithAnimation():this.renderSectorsStatically(f)}},{key:"componentDidMount",value:function(){this.pieRef&&this.attachKeyboardHandlers(this.pieRef)}},{key:"render",value:function(){var s=this,f=this.props,v=f.hide,S=f.sectors,i=f.className,O=f.label,z=f.cx,j=f.cy,F=f.innerRadius,G=f.outerRadius,Y=f.isAnimationActive,X=this.state.isAnimationFinished;if(v||!S||!S.length||!Nn(z)||!Nn(j)||!Nn(F)||!Nn(G))return null;var K=oi("recharts-pie",i);return Ot.createElement(Ua,{tabIndex:this.props.rootTabIndex,className:K,ref:function(se){s.pieRef=se}},this.renderSectors(),O&&this.renderLabels(S),Ko.renderCallByParent(this.props,null,!1),(!Y||X)&&y0.renderCallByParent(this.props,S,!1))}}],[{key:"getDerivedStateFromProps",value:function(s,f){return f.prevIsAnimationActive!==s.isAnimationActive?{prevIsAnimationActive:s.isAnimationActive,prevAnimationId:s.animationId,curSectors:s.sectors,prevSectors:[],isAnimationFinished:!0}:s.isAnimationActive&&s.animationId!==f.prevAnimationId?{prevAnimationId:s.animationId,curSectors:s.sectors,prevSectors:f.curSectors,isAnimationFinished:!0}:s.sectors!==f.curSectors?{curSectors:s.sectors,isAnimationFinished:!0}:null}},{key:"getTextAnchor",value:function(s,f){return s>f?"start":s<f?"end":"middle"}},{key:"renderLabelLineItem",value:function(s,f,v){if(Ot.isValidElement(s))return Ot.cloneElement(s,f);if(Vr(s))return s(f);var S=oi("recharts-pie-label-line",typeof s!="boolean"?s.className:"");return Ot.createElement(LM,tg({},f,{key:v,type:"linear",className:S}))}},{key:"renderLabelItem",value:function(s,f,v){if(Ot.isValidElement(s))return Ot.cloneElement(s,f);var S=v;if(Vr(s)&&(S=s(f),Ot.isValidElement(S)))return S;var i=oi("recharts-pie-label-text",typeof s!="boolean"&&!Vr(s)?s.className:"");return Ot.createElement(yg,tg({},f,{alignmentBaseline:"middle",className:i}),S)}}])}(Me.PureComponent);Rx=af;Jc(af,"displayName","Pie");Jc(af,"defaultProps",{stroke:"#fff",fill:"#808080",legendType:"rect",cx:"50%",cy:"50%",startAngle:0,endAngle:360,innerRadius:0,outerRadius:"80%",paddingAngle:0,labelLine:!0,hide:!1,minAngle:0,isAnimationActive:!fw.isSsr,animationBegin:400,animationDuration:1500,animationEasing:"ease",nameKey:"name",blendStroke:!1,rootTabIndex:0});Jc(af,"parseDeltaAngle",function(e,t){var a=Qc(t-e),s=Math.min(Math.abs(t-e),360);return a*s});Jc(af,"getRealPieData",function(e){var t=e.data,a=e.children,s=Fr(e,!1),f=ef(a,ZB);return t&&t.length?t.map(function(v,S){return Hi(Hi(Hi({payload:v},s),v),f&&f[S]&&f[S].props)}):f&&f.length?f.map(function(v){return Hi(Hi({},s),v.props)}):[]});Jc(af,"parseCoordinateOfPie",function(e,t){var a=t.top,s=t.left,f=t.width,v=t.height,S=eF(f,v),i=s+cl(e.cx,f,f/2),O=a+cl(e.cy,v,v/2),z=cl(e.innerRadius,S,0),j=cl(e.outerRadius,S,S*.8),F=e.maxRadius||Math.sqrt(f*f+v*v)/2;return{cx:i,cy:O,innerRadius:z,outerRadius:j,maxRadius:F}});Jc(af,"getComposedData",function(e){var t=e.item,a=e.offset,s=t.type.defaultProps!==void 0?Hi(Hi({},t.type.defaultProps),t.props):t.props,f=Rx.getRealPieData(s);if(!f||!f.length)return null;var v=s.cornerRadius,S=s.startAngle,i=s.endAngle,O=s.paddingAngle,z=s.dataKey,j=s.nameKey,F=s.valueKey,G=s.tooltipType,Y=Math.abs(s.minAngle),X=Rx.parseCoordinateOfPie(s,a),K=Rx.parseDeltaAngle(S,i),ne=Math.abs(K),se=z;ei(z)&&ei(F)?(wd(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),se="value"):ei(z)&&(wd(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),se=F);var ge=f.filter(function(He){return Kl(He,se,0)!==0}).length,_e=(ne>=360?ge:ge-1)*O,xe=ne-ge*Y-_e,ae=f.reduce(function(He,Ge){var ye=Kl(Ge,se,0);return He+(Nn(ye)?ye:0)},0),ve;if(ae>0){var Se;ve=f.map(function(He,Ge){var ye=Kl(He,se,0),Le=Kl(He,j,Ge),ht=(Nn(ye)?ye:0)/ae,gt;Ge?gt=Se.endAngle+Qc(K)*O*(ye!==0?1:0):gt=S;var Ft=gt+Qc(K)*((ye!==0?Y:0)+ht*xe),_t=(gt+Ft)/2,yt=(X.innerRadius+X.outerRadius)/2,Vt=[{name:Le,value:ye,payload:He,dataKey:se,type:G}],Ht=Wi(X.cx,X.cy,yt,_t);return Se=Hi(Hi(Hi({percent:ht,cornerRadius:v,name:Le,tooltipPayload:Vt,midAngle:_t,middleRadius:yt,tooltipPosition:Ht},He),X),{},{value:Kl(He,se),startAngle:gt,endAngle:Ft,payload:He,paddingAngle:Qc(K)*O}),Se})}return Hi(Hi({},X),{},{sectors:ve,data:f})});var eC,ak;function rde(){if(ak)return eC;ak=1;var e=Math.ceil,t=Math.max;function a(s,f,v,S){for(var i=-1,O=t(e((f-s)/(v||1)),0),z=Array(O);O--;)z[S?O:++i]=s,s+=v;return z}return eC=a,eC}var tC,ok;function vF(){if(ok)return tC;ok=1;var e=GB(),t=1/0,a=17976931348623157e292;function s(f){if(!f)return f===0?f:0;if(f=e(f),f===t||f===-1/0){var v=f<0?-1:1;return v*a}return f===f?f:0}return tC=s,tC}var nC,sk;function ide(){if(sk)return nC;sk=1;var e=rde(),t=hw(),a=vF();function s(f){return function(v,S,i){return i&&typeof i!="number"&&t(v,S,i)&&(S=i=void 0),v=a(v),S===void 0?(S=v,v=0):S=a(S),i=i===void 0?v<S?1:-1:a(i),e(v,S,i,f)}}return nC=s,nC}var rC,lk;function ade(){if(lk)return rC;lk=1;var e=ide(),t=e();return rC=t,rC}var ode=ade();const Sb=Ei(ode);function v1(e){"@babel/helpers - typeof";return v1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},v1(e)}function ck(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(f){return Object.getOwnPropertyDescriptor(e,f).enumerable})),a.push.apply(a,s)}return a}function uk(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?ck(Object(a),!0).forEach(function(s){xF(e,s,a[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ck(Object(a)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(a,s))})}return e}function xF(e,t,a){return t=sde(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function sde(e){var t=lde(e,"string");return v1(t)=="symbol"?t:t+""}function lde(e,t){if(v1(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var s=a.call(e,t);if(v1(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var cde=["Webkit","Moz","O","ms"],ude=function(t,a){var s=t.replace(/(\w)/,function(v){return v.toUpperCase()}),f=cde.reduce(function(v,S){return uk(uk({},v),{},xF({},S+s,a))},{});return f[t]=a,f};function Mg(e){"@babel/helpers - typeof";return Mg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mg(e)}function Tb(){return Tb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},Tb.apply(this,arguments)}function hk(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(f){return Object.getOwnPropertyDescriptor(e,f).enumerable})),a.push.apply(a,s)}return a}function iC(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?hk(Object(a),!0).forEach(function(s){Wl(e,s,a[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):hk(Object(a)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(a,s))})}return e}function hde(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fk(e,t){for(var a=0;a<t.length;a++){var s=t[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,wF(s.key),s)}}function fde(e,t,a){return t&&fk(e.prototype,t),a&&fk(e,a),Object.defineProperty(e,"prototype",{writable:!1}),e}function dde(e,t,a){return t=Eb(t),pde(e,bF()?Reflect.construct(t,a||[],Eb(e).constructor):t.apply(e,a))}function pde(e,t){if(t&&(Mg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return mde(e)}function mde(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function bF(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(bF=function(){return!!e})()}function Eb(e){return Eb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)},Eb(e)}function _de(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&YM(e,t)}function YM(e,t){return YM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,f){return s.__proto__=f,s},YM(e,t)}function Wl(e,t,a){return t=wF(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function wF(e){var t=gde(e,"string");return Mg(t)=="symbol"?t:t+""}function gde(e,t){if(Mg(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var s=a.call(e,t);if(Mg(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var yde=function(t){var a=t.data,s=t.startIndex,f=t.endIndex,v=t.x,S=t.width,i=t.travellerWidth;if(!a||!a.length)return{};var O=a.length,z=Ov().domain(Sb(0,O)).range([v,v+S-i]),j=z.domain().map(function(F){return z(F)});return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,isTravellerFocused:!1,startX:z(s),endX:z(f),scale:z,scaleValues:j}},dk=function(t){return t.changedTouches&&!!t.changedTouches.length},Og=function(e){function t(a){var s;return hde(this,t),s=dde(this,t,[a]),Wl(s,"handleDrag",function(f){s.leaveTimer&&(clearTimeout(s.leaveTimer),s.leaveTimer=null),s.state.isTravellerMoving?s.handleTravellerMove(f):s.state.isSlideMoving&&s.handleSlideDrag(f)}),Wl(s,"handleTouchMove",function(f){f.changedTouches!=null&&f.changedTouches.length>0&&s.handleDrag(f.changedTouches[0])}),Wl(s,"handleDragEnd",function(){s.setState({isTravellerMoving:!1,isSlideMoving:!1},function(){var f=s.props,v=f.endIndex,S=f.onDragEnd,i=f.startIndex;S==null||S({endIndex:v,startIndex:i})}),s.detachDragEndListener()}),Wl(s,"handleLeaveWrapper",function(){(s.state.isTravellerMoving||s.state.isSlideMoving)&&(s.leaveTimer=window.setTimeout(s.handleDragEnd,s.props.leaveTimeOut))}),Wl(s,"handleEnterSlideOrTraveller",function(){s.setState({isTextActive:!0})}),Wl(s,"handleLeaveSlideOrTraveller",function(){s.setState({isTextActive:!1})}),Wl(s,"handleSlideDragStart",function(f){var v=dk(f)?f.changedTouches[0]:f;s.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:v.pageX}),s.attachDragEndListener()}),s.travellerDragStartHandlers={startX:s.handleTravellerDragStart.bind(s,"startX"),endX:s.handleTravellerDragStart.bind(s,"endX")},s.state={},s}return _de(t,e),fde(t,[{key:"componentWillUnmount",value:function(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}},{key:"getIndex",value:function(s){var f=s.startX,v=s.endX,S=this.state.scaleValues,i=this.props,O=i.gap,z=i.data,j=z.length-1,F=Math.min(f,v),G=Math.max(f,v),Y=t.getIndexInRange(S,F),X=t.getIndexInRange(S,G);return{startIndex:Y-Y%O,endIndex:X===j?j:X-X%O}}},{key:"getTextOfTick",value:function(s){var f=this.props,v=f.data,S=f.tickFormatter,i=f.dataKey,O=Kl(v[s],i,s);return Vr(S)?S(O,s):O}},{key:"attachDragEndListener",value:function(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}},{key:"detachDragEndListener",value:function(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}},{key:"handleSlideDrag",value:function(s){var f=this.state,v=f.slideMoveStartX,S=f.startX,i=f.endX,O=this.props,z=O.x,j=O.width,F=O.travellerWidth,G=O.startIndex,Y=O.endIndex,X=O.onChange,K=s.pageX-v;K>0?K=Math.min(K,z+j-F-i,z+j-F-S):K<0&&(K=Math.max(K,z-S,z-i));var ne=this.getIndex({startX:S+K,endX:i+K});(ne.startIndex!==G||ne.endIndex!==Y)&&X&&X(ne),this.setState({startX:S+K,endX:i+K,slideMoveStartX:s.pageX})}},{key:"handleTravellerDragStart",value:function(s,f){var v=dk(f)?f.changedTouches[0]:f;this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:s,brushMoveStartX:v.pageX}),this.attachDragEndListener()}},{key:"handleTravellerMove",value:function(s){var f=this.state,v=f.brushMoveStartX,S=f.movingTravellerId,i=f.endX,O=f.startX,z=this.state[S],j=this.props,F=j.x,G=j.width,Y=j.travellerWidth,X=j.onChange,K=j.gap,ne=j.data,se={startX:this.state.startX,endX:this.state.endX},ge=s.pageX-v;ge>0?ge=Math.min(ge,F+G-Y-z):ge<0&&(ge=Math.max(ge,F-z)),se[S]=z+ge;var _e=this.getIndex(se),xe=_e.startIndex,ae=_e.endIndex,ve=function(){var He=ne.length-1;return S==="startX"&&(i>O?xe%K===0:ae%K===0)||i<O&&ae===He||S==="endX"&&(i>O?ae%K===0:xe%K===0)||i>O&&ae===He};this.setState(Wl(Wl({},S,z+ge),"brushMoveStartX",s.pageX),function(){X&&ve()&&X(_e)})}},{key:"handleTravellerMoveKeyboard",value:function(s,f){var v=this,S=this.state,i=S.scaleValues,O=S.startX,z=S.endX,j=this.state[f],F=i.indexOf(j);if(F!==-1){var G=F+s;if(!(G===-1||G>=i.length)){var Y=i[G];f==="startX"&&Y>=z||f==="endX"&&Y<=O||this.setState(Wl({},f,Y),function(){v.props.onChange(v.getIndex({startX:v.state.startX,endX:v.state.endX}))})}}}},{key:"renderBackground",value:function(){var s=this.props,f=s.x,v=s.y,S=s.width,i=s.height,O=s.fill,z=s.stroke;return Ot.createElement("rect",{stroke:z,fill:O,x:f,y:v,width:S,height:i})}},{key:"renderPanorama",value:function(){var s=this.props,f=s.x,v=s.y,S=s.width,i=s.height,O=s.data,z=s.children,j=s.padding,F=Me.Children.only(z);return F?Ot.cloneElement(F,{x:f,y:v,width:S,height:i,margin:j,compact:!0,data:O}):null}},{key:"renderTravellerLayer",value:function(s,f){var v,S,i=this,O=this.props,z=O.y,j=O.travellerWidth,F=O.height,G=O.traveller,Y=O.ariaLabel,X=O.data,K=O.startIndex,ne=O.endIndex,se=Math.max(s,this.props.x),ge=iC(iC({},Fr(this.props,!1)),{},{x:se,y:z,width:j,height:F}),_e=Y||"Min value: ".concat((v=X[K])===null||v===void 0?void 0:v.name,", Max value: ").concat((S=X[ne])===null||S===void 0?void 0:S.name);return Ot.createElement(Ua,{tabIndex:0,role:"slider","aria-label":_e,"aria-valuenow":s,className:"recharts-brush-traveller",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers[f],onTouchStart:this.travellerDragStartHandlers[f],onKeyDown:function(ae){["ArrowLeft","ArrowRight"].includes(ae.key)&&(ae.preventDefault(),ae.stopPropagation(),i.handleTravellerMoveKeyboard(ae.key==="ArrowRight"?1:-1,f))},onFocus:function(){i.setState({isTravellerFocused:!0})},onBlur:function(){i.setState({isTravellerFocused:!1})},style:{cursor:"col-resize"}},t.renderTraveller(G,ge))}},{key:"renderSlide",value:function(s,f){var v=this.props,S=v.y,i=v.height,O=v.stroke,z=v.travellerWidth,j=Math.min(s,f)+z,F=Math.max(Math.abs(f-s)-z,0);return Ot.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart,style:{cursor:"move"},stroke:"none",fill:O,fillOpacity:.2,x:j,y:S,width:F,height:i})}},{key:"renderText",value:function(){var s=this.props,f=s.startIndex,v=s.endIndex,S=s.y,i=s.height,O=s.travellerWidth,z=s.stroke,j=this.state,F=j.startX,G=j.endX,Y=5,X={pointerEvents:"none",fill:z};return Ot.createElement(Ua,{className:"recharts-brush-texts"},Ot.createElement(yg,Tb({textAnchor:"end",verticalAnchor:"middle",x:Math.min(F,G)-Y,y:S+i/2},X),this.getTextOfTick(f)),Ot.createElement(yg,Tb({textAnchor:"start",verticalAnchor:"middle",x:Math.max(F,G)+O+Y,y:S+i/2},X),this.getTextOfTick(v)))}},{key:"render",value:function(){var s=this.props,f=s.data,v=s.className,S=s.children,i=s.x,O=s.y,z=s.width,j=s.height,F=s.alwaysShowText,G=this.state,Y=G.startX,X=G.endX,K=G.isTextActive,ne=G.isSlideMoving,se=G.isTravellerMoving,ge=G.isTravellerFocused;if(!f||!f.length||!Nn(i)||!Nn(O)||!Nn(z)||!Nn(j)||z<=0||j<=0)return null;var _e=oi("recharts-brush",v),xe=Ot.Children.count(S)===1,ae=ude("userSelect","none");return Ot.createElement(Ua,{className:_e,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:ae},this.renderBackground(),xe&&this.renderPanorama(),this.renderSlide(Y,X),this.renderTravellerLayer(Y,"startX"),this.renderTravellerLayer(X,"endX"),(K||ne||se||ge||F)&&this.renderText())}}],[{key:"renderDefaultTraveller",value:function(s){var f=s.x,v=s.y,S=s.width,i=s.height,O=s.stroke,z=Math.floor(v+i/2)-1;return Ot.createElement(Ot.Fragment,null,Ot.createElement("rect",{x:f,y:v,width:S,height:i,fill:O,stroke:"none"}),Ot.createElement("line",{x1:f+1,y1:z,x2:f+S-1,y2:z,fill:"none",stroke:"#fff"}),Ot.createElement("line",{x1:f+1,y1:z+2,x2:f+S-1,y2:z+2,fill:"none",stroke:"#fff"}))}},{key:"renderTraveller",value:function(s,f){var v;return Ot.isValidElement(s)?v=Ot.cloneElement(s,f):Vr(s)?v=s(f):v=t.renderDefaultTraveller(f),v}},{key:"getDerivedStateFromProps",value:function(s,f){var v=s.data,S=s.width,i=s.x,O=s.travellerWidth,z=s.updateId,j=s.startIndex,F=s.endIndex;if(v!==f.prevData||z!==f.prevUpdateId)return iC({prevData:v,prevTravellerWidth:O,prevUpdateId:z,prevX:i,prevWidth:S},v&&v.length?yde({data:v,width:S,x:i,travellerWidth:O,startIndex:j,endIndex:F}):{scale:null,scaleValues:null});if(f.scale&&(S!==f.prevWidth||i!==f.prevX||O!==f.prevTravellerWidth)){f.scale.range([i,i+S-O]);var G=f.scale.domain().map(function(Y){return f.scale(Y)});return{prevData:v,prevTravellerWidth:O,prevUpdateId:z,prevX:i,prevWidth:S,startX:f.scale(s.startIndex),endX:f.scale(s.endIndex),scaleValues:G}}return null}},{key:"getIndexInRange",value:function(s,f){for(var v=s.length,S=0,i=v-1;i-S>1;){var O=Math.floor((S+i)/2);s[O]>f?i=O:S=O}return f>=s[i]?i:S}}])}(Me.PureComponent);Wl(Og,"displayName","Brush");Wl(Og,"defaultProps",{height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1});var aC,pk;function vde(){if(pk)return aC;pk=1;var e=i4();function t(a,s){var f;return e(a,function(v,S,i){return f=s(v,S,i),!f}),!!f}return aC=t,aC}var oC,mk;function xde(){if(mk)return oC;mk=1;var e=wB(),t=sf(),a=vde(),s=pl(),f=hw();function v(S,i,O){var z=s(S)?e:a;return O&&f(S,i,O)&&(i=void 0),z(S,t(i,3))}return oC=v,oC}var bde=xde();const wde=Ei(bde);var nf=function(t,a){var s=t.alwaysShow,f=t.ifOverflow;return s&&(f="extendDomain"),f===a},sC,_k;function Sde(){if(_k)return sC;_k=1;var e=jB();function t(a,s,f){s=="__proto__"&&e?e(a,s,{configurable:!0,enumerable:!0,value:f,writable:!0}):a[s]=f}return sC=t,sC}var lC,gk;function Tde(){if(gk)return lC;gk=1;var e=Sde(),t=NB(),a=sf();function s(f,v){var S={};return v=a(v,3),t(f,function(i,O,z){e(S,O,v(i,O,z))}),S}return lC=s,lC}var Ede=Tde();const Ade=Ei(Ede);var cC,yk;function Cde(){if(yk)return cC;yk=1;function e(t,a){for(var s=-1,f=t==null?0:t.length;++s<f;)if(!a(t[s],s,t))return!1;return!0}return cC=e,cC}var uC,vk;function Mde(){if(vk)return uC;vk=1;var e=i4();function t(a,s){var f=!0;return e(a,function(v,S,i){return f=!!s(v,S,i),f}),f}return uC=t,uC}var hC,xk;function Ode(){if(xk)return hC;xk=1;var e=Cde(),t=Mde(),a=sf(),s=pl(),f=hw();function v(S,i,O){var z=s(S)?e:t;return O&&f(S,i,O)&&(i=void 0),z(S,a(i,3))}return hC=v,hC}var Ide=Ode();const Pde=Ei(Ide);function x1(e){"@babel/helpers - typeof";return x1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},x1(e)}function Rde(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bk(e,t){for(var a=0;a<t.length;a++){var s=t[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,SF(s.key),s)}}function Dde(e,t,a){return t&&bk(e.prototype,t),a&&bk(e,a),Object.defineProperty(e,"prototype",{writable:!1}),e}function wk(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(f){return Object.getOwnPropertyDescriptor(e,f).enumerable})),a.push.apply(a,s)}return a}function yx(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?wk(Object(a),!0).forEach(function(s){k4(e,s,a[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):wk(Object(a)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(a,s))})}return e}function k4(e,t,a){return t=SF(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function SF(e){var t=Lde(e,"string");return x1(t)=="symbol"?t:t+""}function Lde(e,t){if(x1(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var s=a.call(e,t);if(x1(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var TF=function(t,a){var s=t.x,f=t.y,v=a.x,S=a.y;return{x:Math.min(s,v),y:Math.min(f,S),width:Math.abs(v-s),height:Math.abs(S-f)}},zde=function(t){var a=t.x1,s=t.y1,f=t.x2,v=t.y2;return TF({x:a,y:s},{x:f,y:v})},EF=function(){function e(t){Rde(this,e),this.scale=t}return Dde(e,[{key:"domain",get:function(){return this.scale.domain}},{key:"range",get:function(){return this.scale.range}},{key:"rangeMin",get:function(){return this.range()[0]}},{key:"rangeMax",get:function(){return this.range()[1]}},{key:"bandwidth",get:function(){return this.scale.bandwidth}},{key:"apply",value:function(a){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},f=s.bandAware,v=s.position;if(a!==void 0){if(v)switch(v){case"start":return this.scale(a);case"middle":{var S=this.bandwidth?this.bandwidth()/2:0;return this.scale(a)+S}case"end":{var i=this.bandwidth?this.bandwidth():0;return this.scale(a)+i}default:return this.scale(a)}if(f){var O=this.bandwidth?this.bandwidth()/2:0;return this.scale(a)+O}return this.scale(a)}}},{key:"isInRange",value:function(a){var s=this.range(),f=s[0],v=s[s.length-1];return f<=v?a>=f&&a<=v:a>=v&&a<=f}}],[{key:"create",value:function(a){return new e(a)}}])}();k4(EF,"EPS",1e-4);var B4=function(t){var a=Object.keys(t).reduce(function(s,f){return yx(yx({},s),{},k4({},f,EF.create(t[f])))},{});return yx(yx({},a),{},{apply:function(f){var v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},S=v.bandAware,i=v.position;return Ade(f,function(O,z){return a[z].apply(O,{bandAware:S,position:i})})},isInRange:function(f){return Pde(f,function(v,S){return a[S].isInRange(v)})}})},fC,Sk;function kde(){if(Sk)return fC;Sk=1;var e=sf(),t=L1(),a=cw();function s(f){return function(v,S,i){var O=Object(v);if(!t(v)){var z=e(S,3);v=a(v),S=function(F){return z(O[F],F,O)}}var j=f(v,S,i);return j>-1?O[z?v[j]:j]:void 0}}return fC=s,fC}var dC,Tk;function Bde(){if(Tk)return dC;Tk=1;var e=vF();function t(a){var s=e(a),f=s%1;return s===s?f?s-f:s:0}return dC=t,dC}var pC,Ek;function Nde(){if(Ek)return pC;Ek=1;var e=DB(),t=sf(),a=Bde(),s=Math.max;function f(v,S,i){var O=v==null?0:v.length;if(!O)return-1;var z=i==null?0:a(i);return z<0&&(z=s(O+z,0)),e(v,t(S,3),z)}return pC=f,pC}var mC,Ak;function Fde(){if(Ak)return mC;Ak=1;var e=kde(),t=Nde(),a=e(t);return mC=a,mC}Fde();var jde=X7();const Ude=Ei(jde);var Vde=Ude(function(e){return{x:e.left,y:e.top,width:e.width,height:e.height}},function(e){return["l",e.left,"t",e.top,"w",e.width,"h",e.height].join("")}),AF=Me.createContext(void 0),CF=Me.createContext(void 0),MF=Me.createContext(void 0),$de=Me.createContext({}),OF=Me.createContext(void 0),qde=Me.createContext(0),Gde=Me.createContext(0),Ck=function(t){var a=t.state,s=a.xAxisMap,f=a.yAxisMap,v=a.offset,S=t.clipPathId,i=t.children,O=t.width,z=t.height,j=Vde(v);return Ot.createElement(AF.Provider,{value:s},Ot.createElement(CF.Provider,{value:f},Ot.createElement($de.Provider,{value:v},Ot.createElement(MF.Provider,{value:j},Ot.createElement(OF.Provider,{value:S},Ot.createElement(qde.Provider,{value:z},Ot.createElement(Gde.Provider,{value:O},i)))))))},Hde=function(){return Me.useContext(OF)},Zde=function(t){var a=Me.useContext(AF);a==null&&wg();var s=a[t];return s==null&&wg(),s},Wde=function(t){var a=Me.useContext(CF);a==null&&wg();var s=a[t];return s==null&&wg(),s},Xde=function(){var t=Me.useContext(MF);return t};function Ig(e){"@babel/helpers - typeof";return Ig=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ig(e)}function Yde(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Kde(e,t){for(var a=0;a<t.length;a++){var s=t[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,PF(s.key),s)}}function Jde(e,t,a){return t&&Kde(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Qde(e,t,a){return t=Ab(t),epe(e,IF()?Reflect.construct(t,a||[],Ab(e).constructor):t.apply(e,a))}function epe(e,t){if(t&&(Ig(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return tpe(e)}function tpe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function IF(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(IF=function(){return!!e})()}function Ab(e){return Ab=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)},Ab(e)}function npe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&KM(e,t)}function KM(e,t){return KM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,f){return s.__proto__=f,s},KM(e,t)}function Mk(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(f){return Object.getOwnPropertyDescriptor(e,f).enumerable})),a.push.apply(a,s)}return a}function Ok(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?Mk(Object(a),!0).forEach(function(s){N4(e,s,a[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Mk(Object(a)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(a,s))})}return e}function N4(e,t,a){return t=PF(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function PF(e){var t=rpe(e,"string");return Ig(t)=="symbol"?t:t+""}function rpe(e,t){if(Ig(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var s=a.call(e,t);if(Ig(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function ipe(e,t){return lpe(e)||spe(e,t)||ope(e,t)||ape()}function ape(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ope(e,t){if(e){if(typeof e=="string")return Ik(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Ik(e,t)}}function Ik(e,t){(t==null||t>e.length)&&(t=e.length);for(var a=0,s=new Array(t);a<t;a++)s[a]=e[a];return s}function spe(e,t){var a=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(a!=null){var s,f,v,S,i=[],O=!0,z=!1;try{if(v=(a=a.call(e)).next,t!==0)for(;!(O=(s=v.call(a)).done)&&(i.push(s.value),i.length!==t);O=!0);}catch(j){z=!0,f=j}finally{try{if(!O&&a.return!=null&&(S=a.return(),Object(S)!==S))return}finally{if(z)throw f}}return i}}function lpe(e){if(Array.isArray(e))return e}function JM(){return JM=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},JM.apply(this,arguments)}var cpe=function(t,a){var s;return Ot.isValidElement(t)?s=Ot.cloneElement(t,a):Vr(t)?s=t(a):s=Ot.createElement("line",JM({},a,{className:"recharts-reference-line-line"})),s},upe=function(t,a,s,f,v,S,i,O,z){var j=v.x,F=v.y,G=v.width,Y=v.height;if(s){var X=z.y,K=t.y.apply(X,{position:S});if(nf(z,"discard")&&!t.y.isInRange(K))return null;var ne=[{x:j+G,y:K},{x:j,y:K}];return O==="left"?ne.reverse():ne}if(a){var se=z.x,ge=t.x.apply(se,{position:S});if(nf(z,"discard")&&!t.x.isInRange(ge))return null;var _e=[{x:ge,y:F+Y},{x:ge,y:F}];return i==="top"?_e.reverse():_e}if(f){var xe=z.segment,ae=xe.map(function(ve){return t.apply(ve,{position:S})});return nf(z,"discard")&&wde(ae,function(ve){return!t.isInRange(ve)})?null:ae}return null};function hpe(e){var t=e.x,a=e.y,s=e.segment,f=e.xAxisId,v=e.yAxisId,S=e.shape,i=e.className,O=e.alwaysShow,z=Hde(),j=Zde(f),F=Wde(v),G=Xde();if(!z||!G)return null;wd(O===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var Y=B4({x:j.scale,y:F.scale}),X=go(t),K=go(a),ne=s&&s.length===2,se=upe(Y,X,K,ne,G,e.position,j.orientation,F.orientation,e);if(!se)return null;var ge=ipe(se,2),_e=ge[0],xe=_e.x,ae=_e.y,ve=ge[1],Se=ve.x,He=ve.y,Ge=nf(e,"hidden")?"url(#".concat(z,")"):void 0,ye=Ok(Ok({clipPath:Ge},Fr(e,!0)),{},{x1:xe,y1:ae,x2:Se,y2:He});return Ot.createElement(Ua,{className:oi("recharts-reference-line",i)},cpe(S,ye),Ko.renderCallByParent(e,zde({x1:xe,y1:ae,x2:Se,y2:He})))}var F4=function(e){function t(){return Yde(this,t),Qde(this,t,arguments)}return npe(t,e),Jde(t,[{key:"render",value:function(){return Ot.createElement(hpe,this.props)}}])}(Ot.Component);N4(F4,"displayName","ReferenceLine");N4(F4,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});function QM(){return QM=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},QM.apply(this,arguments)}function Pg(e){"@babel/helpers - typeof";return Pg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pg(e)}function Pk(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(f){return Object.getOwnPropertyDescriptor(e,f).enumerable})),a.push.apply(a,s)}return a}function Rk(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?Pk(Object(a),!0).forEach(function(s){Iw(e,s,a[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Pk(Object(a)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(a,s))})}return e}function fpe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dpe(e,t){for(var a=0;a<t.length;a++){var s=t[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,DF(s.key),s)}}function ppe(e,t,a){return t&&dpe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function mpe(e,t,a){return t=Cb(t),_pe(e,RF()?Reflect.construct(t,a||[],Cb(e).constructor):t.apply(e,a))}function _pe(e,t){if(t&&(Pg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return gpe(e)}function gpe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function RF(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(RF=function(){return!!e})()}function Cb(e){return Cb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)},Cb(e)}function ype(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&e5(e,t)}function e5(e,t){return e5=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,f){return s.__proto__=f,s},e5(e,t)}function Iw(e,t,a){return t=DF(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function DF(e){var t=vpe(e,"string");return Pg(t)=="symbol"?t:t+""}function vpe(e,t){if(Pg(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var s=a.call(e,t);if(Pg(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var xpe=function(t){var a=t.x,s=t.y,f=t.xAxis,v=t.yAxis,S=B4({x:f.scale,y:v.scale}),i=S.apply({x:a,y:s},{bandAware:!0});return nf(t,"discard")&&!S.isInRange(i)?null:i},Pw=function(e){function t(){return fpe(this,t),mpe(this,t,arguments)}return ype(t,e),ppe(t,[{key:"render",value:function(){var s=this.props,f=s.x,v=s.y,S=s.r,i=s.alwaysShow,O=s.clipPathId,z=go(f),j=go(v);if(wd(i===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.'),!z||!j)return null;var F=xpe(this.props);if(!F)return null;var G=F.x,Y=F.y,X=this.props,K=X.shape,ne=X.className,se=nf(this.props,"hidden")?"url(#".concat(O,")"):void 0,ge=Rk(Rk({clipPath:se},Fr(this.props,!0)),{},{cx:G,cy:Y});return Ot.createElement(Ua,{className:oi("recharts-reference-dot",ne)},t.renderDot(K,ge),Ko.renderCallByParent(this.props,{x:G-S,y:Y-S,width:2*S,height:2*S}))}}])}(Ot.Component);Iw(Pw,"displayName","ReferenceDot");Iw(Pw,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#fff",stroke:"#ccc",fillOpacity:1,strokeWidth:1});Iw(Pw,"renderDot",function(e,t){var a;return Ot.isValidElement(e)?a=Ot.cloneElement(e,t):Vr(e)?a=e(t):a=Ot.createElement(z4,QM({},t,{cx:t.cx,cy:t.cy,className:"recharts-reference-dot-dot"})),a});function t5(){return t5=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},t5.apply(this,arguments)}function Rg(e){"@babel/helpers - typeof";return Rg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rg(e)}function Dk(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(f){return Object.getOwnPropertyDescriptor(e,f).enumerable})),a.push.apply(a,s)}return a}function Lk(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?Dk(Object(a),!0).forEach(function(s){Rw(e,s,a[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Dk(Object(a)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(a,s))})}return e}function bpe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wpe(e,t){for(var a=0;a<t.length;a++){var s=t[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,zF(s.key),s)}}function Spe(e,t,a){return t&&wpe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Tpe(e,t,a){return t=Mb(t),Epe(e,LF()?Reflect.construct(t,a||[],Mb(e).constructor):t.apply(e,a))}function Epe(e,t){if(t&&(Rg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ape(e)}function Ape(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function LF(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(LF=function(){return!!e})()}function Mb(e){return Mb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)},Mb(e)}function Cpe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&n5(e,t)}function n5(e,t){return n5=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,f){return s.__proto__=f,s},n5(e,t)}function Rw(e,t,a){return t=zF(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function zF(e){var t=Mpe(e,"string");return Rg(t)=="symbol"?t:t+""}function Mpe(e,t){if(Rg(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var s=a.call(e,t);if(Rg(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Ope=function(t,a,s,f,v){var S=v.x1,i=v.x2,O=v.y1,z=v.y2,j=v.xAxis,F=v.yAxis;if(!j||!F)return null;var G=B4({x:j.scale,y:F.scale}),Y={x:t?G.x.apply(S,{position:"start"}):G.x.rangeMin,y:s?G.y.apply(O,{position:"start"}):G.y.rangeMin},X={x:a?G.x.apply(i,{position:"end"}):G.x.rangeMax,y:f?G.y.apply(z,{position:"end"}):G.y.rangeMax};return nf(v,"discard")&&(!G.isInRange(Y)||!G.isInRange(X))?null:TF(Y,X)},Dw=function(e){function t(){return bpe(this,t),Tpe(this,t,arguments)}return Cpe(t,e),Spe(t,[{key:"render",value:function(){var s=this.props,f=s.x1,v=s.x2,S=s.y1,i=s.y2,O=s.className,z=s.alwaysShow,j=s.clipPathId;wd(z===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var F=go(f),G=go(v),Y=go(S),X=go(i),K=this.props.shape;if(!F&&!G&&!Y&&!X&&!K)return null;var ne=Ope(F,G,Y,X,this.props);if(!ne&&!K)return null;var se=nf(this.props,"hidden")?"url(#".concat(j,")"):void 0;return Ot.createElement(Ua,{className:oi("recharts-reference-area",O)},t.renderRect(K,Lk(Lk({clipPath:se},Fr(this.props,!0)),ne)),Ko.renderCallByParent(this.props,ne))}}])}(Ot.Component);Rw(Dw,"displayName","ReferenceArea");Rw(Dw,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#ccc",fillOpacity:.5,stroke:"none",strokeWidth:1});Rw(Dw,"renderRect",function(e,t){var a;return Ot.isValidElement(e)?a=Ot.cloneElement(e,t):Vr(e)?a=e(t):a=Ot.createElement(L4,t5({},t,{className:"recharts-reference-area-rect"})),a});function zk(e){return Dpe(e)||Rpe(e)||Ppe(e)||Ipe()}function Ipe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ppe(e,t){if(e){if(typeof e=="string")return r5(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return r5(e,t)}}function Rpe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Dpe(e){if(Array.isArray(e))return r5(e)}function r5(e,t){(t==null||t>e.length)&&(t=e.length);for(var a=0,s=new Array(t);a<t;a++)s[a]=e[a];return s}var i5=function(t,a,s,f,v){var S=ef(t,F4),i=ef(t,Pw),O=[].concat(zk(S),zk(i)),z=ef(t,Dw),j="".concat(f,"Id"),F=f[0],G=a;if(O.length&&(G=O.reduce(function(K,ne){if(ne.props[j]===s&&nf(ne.props,"extendDomain")&&Nn(ne.props[F])){var se=ne.props[F];return[Math.min(K[0],se),Math.max(K[1],se)]}return K},G)),z.length){var Y="".concat(F,"1"),X="".concat(F,"2");G=z.reduce(function(K,ne){if(ne.props[j]===s&&nf(ne.props,"extendDomain")&&Nn(ne.props[Y])&&Nn(ne.props[X])){var se=ne.props[Y],ge=ne.props[X];return[Math.min(K[0],se,ge),Math.max(K[1],se,ge)]}return K},G)}return v&&v.length&&(G=v.reduce(function(K,ne){return Nn(ne)?[Math.min(K[0],ne),Math.max(K[1],ne)]:K},G)),G},_C={exports:{}},kk;function Lpe(){return kk||(kk=1,function(e){var t=Object.prototype.hasOwnProperty,a="~";function s(){}Object.create&&(s.prototype=Object.create(null),new s().__proto__||(a=!1));function f(O,z,j){this.fn=O,this.context=z,this.once=j||!1}function v(O,z,j,F,G){if(typeof j!="function")throw new TypeError("The listener must be a function");var Y=new f(j,F||O,G),X=a?a+z:z;return O._events[X]?O._events[X].fn?O._events[X]=[O._events[X],Y]:O._events[X].push(Y):(O._events[X]=Y,O._eventsCount++),O}function S(O,z){--O._eventsCount===0?O._events=new s:delete O._events[z]}function i(){this._events=new s,this._eventsCount=0}i.prototype.eventNames=function(){var z=[],j,F;if(this._eventsCount===0)return z;for(F in j=this._events)t.call(j,F)&&z.push(a?F.slice(1):F);return Object.getOwnPropertySymbols?z.concat(Object.getOwnPropertySymbols(j)):z},i.prototype.listeners=function(z){var j=a?a+z:z,F=this._events[j];if(!F)return[];if(F.fn)return[F.fn];for(var G=0,Y=F.length,X=new Array(Y);G<Y;G++)X[G]=F[G].fn;return X},i.prototype.listenerCount=function(z){var j=a?a+z:z,F=this._events[j];return F?F.fn?1:F.length:0},i.prototype.emit=function(z,j,F,G,Y,X){var K=a?a+z:z;if(!this._events[K])return!1;var ne=this._events[K],se=arguments.length,ge,_e;if(ne.fn){switch(ne.once&&this.removeListener(z,ne.fn,void 0,!0),se){case 1:return ne.fn.call(ne.context),!0;case 2:return ne.fn.call(ne.context,j),!0;case 3:return ne.fn.call(ne.context,j,F),!0;case 4:return ne.fn.call(ne.context,j,F,G),!0;case 5:return ne.fn.call(ne.context,j,F,G,Y),!0;case 6:return ne.fn.call(ne.context,j,F,G,Y,X),!0}for(_e=1,ge=new Array(se-1);_e<se;_e++)ge[_e-1]=arguments[_e];ne.fn.apply(ne.context,ge)}else{var xe=ne.length,ae;for(_e=0;_e<xe;_e++)switch(ne[_e].once&&this.removeListener(z,ne[_e].fn,void 0,!0),se){case 1:ne[_e].fn.call(ne[_e].context);break;case 2:ne[_e].fn.call(ne[_e].context,j);break;case 3:ne[_e].fn.call(ne[_e].context,j,F);break;case 4:ne[_e].fn.call(ne[_e].context,j,F,G);break;default:if(!ge)for(ae=1,ge=new Array(se-1);ae<se;ae++)ge[ae-1]=arguments[ae];ne[_e].fn.apply(ne[_e].context,ge)}}return!0},i.prototype.on=function(z,j,F){return v(this,z,j,F,!1)},i.prototype.once=function(z,j,F){return v(this,z,j,F,!0)},i.prototype.removeListener=function(z,j,F,G){var Y=a?a+z:z;if(!this._events[Y])return this;if(!j)return S(this,Y),this;var X=this._events[Y];if(X.fn)X.fn===j&&(!G||X.once)&&(!F||X.context===F)&&S(this,Y);else{for(var K=0,ne=[],se=X.length;K<se;K++)(X[K].fn!==j||G&&!X[K].once||F&&X[K].context!==F)&&ne.push(X[K]);ne.length?this._events[Y]=ne.length===1?ne[0]:ne:S(this,Y)}return this},i.prototype.removeAllListeners=function(z){var j;return z?(j=a?a+z:z,this._events[j]&&S(this,j)):(this._events=new s,this._eventsCount=0),this},i.prototype.off=i.prototype.removeListener,i.prototype.addListener=i.prototype.on,i.prefixed=a,i.EventEmitter=i,e.exports=i}(_C)),_C.exports}var zpe=Lpe();const kpe=Ei(zpe);var gC=new kpe,yC="recharts.syncMouseEvents";function b1(e){"@babel/helpers - typeof";return b1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},b1(e)}function Bpe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Npe(e,t){for(var a=0;a<t.length;a++){var s=t[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,kF(s.key),s)}}function Fpe(e,t,a){return t&&Npe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function vC(e,t,a){return t=kF(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function kF(e){var t=jpe(e,"string");return b1(t)=="symbol"?t:t+""}function jpe(e,t){if(b1(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var s=a.call(e,t);if(b1(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Upe=function(){function e(){Bpe(this,e),vC(this,"activeIndex",0),vC(this,"coordinateList",[]),vC(this,"layout","horizontal")}return Fpe(e,[{key:"setDetails",value:function(a){var s,f=a.coordinateList,v=f===void 0?null:f,S=a.container,i=S===void 0?null:S,O=a.layout,z=O===void 0?null:O,j=a.offset,F=j===void 0?null:j,G=a.mouseHandlerCallback,Y=G===void 0?null:G;this.coordinateList=(s=v??this.coordinateList)!==null&&s!==void 0?s:[],this.container=i??this.container,this.layout=z??this.layout,this.offset=F??this.offset,this.mouseHandlerCallback=Y??this.mouseHandlerCallback,this.activeIndex=Math.min(Math.max(this.activeIndex,0),this.coordinateList.length-1)}},{key:"focus",value:function(){this.spoofMouse()}},{key:"keyboardEvent",value:function(a){if(this.coordinateList.length!==0)switch(a.key){case"ArrowRight":{if(this.layout!=="horizontal")return;this.activeIndex=Math.min(this.activeIndex+1,this.coordinateList.length-1),this.spoofMouse();break}case"ArrowLeft":{if(this.layout!=="horizontal")return;this.activeIndex=Math.max(this.activeIndex-1,0),this.spoofMouse();break}}}},{key:"setIndex",value:function(a){this.activeIndex=a}},{key:"spoofMouse",value:function(){var a,s;if(this.layout==="horizontal"&&this.coordinateList.length!==0){var f=this.container.getBoundingClientRect(),v=f.x,S=f.y,i=f.height,O=this.coordinateList[this.activeIndex].coordinate,z=((a=window)===null||a===void 0?void 0:a.scrollX)||0,j=((s=window)===null||s===void 0?void 0:s.scrollY)||0,F=v+O+z,G=S+this.offset.top+i/2+j;this.mouseHandlerCallback({pageX:F,pageY:G})}}}])}();function Vpe(e,t,a){if(a==="number"&&t===!0&&Array.isArray(e)){var s=e==null?void 0:e[0],f=e==null?void 0:e[1];if(s&&f&&Nn(s)&&Nn(f))return!0}return!1}function $pe(e,t,a,s){var f=s/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-f:a.left+.5,y:e==="horizontal"?a.top+.5:t.y-f,width:e==="horizontal"?s:a.width-1,height:e==="horizontal"?a.height-1:s}}function BF(e){var t=e.cx,a=e.cy,s=e.radius,f=e.startAngle,v=e.endAngle,S=Wi(t,a,s,f),i=Wi(t,a,s,v);return{points:[S,i],cx:t,cy:a,radius:s,startAngle:f,endAngle:v}}function qpe(e,t,a){var s,f,v,S;if(e==="horizontal")s=t.x,v=s,f=a.top,S=a.top+a.height;else if(e==="vertical")f=t.y,S=f,s=a.left,v=a.left+a.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var i=t.cx,O=t.cy,z=t.innerRadius,j=t.outerRadius,F=t.angle,G=Wi(i,O,z,F),Y=Wi(i,O,j,F);s=G.x,f=G.y,v=Y.x,S=Y.y}else return BF(t);return[{x:s,y:f},{x:v,y:S}]}function w1(e){"@babel/helpers - typeof";return w1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},w1(e)}function Bk(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(f){return Object.getOwnPropertyDescriptor(e,f).enumerable})),a.push.apply(a,s)}return a}function vx(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?Bk(Object(a),!0).forEach(function(s){Gpe(e,s,a[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Bk(Object(a)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(a,s))})}return e}function Gpe(e,t,a){return t=Hpe(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Hpe(e){var t=Zpe(e,"string");return w1(t)=="symbol"?t:t+""}function Zpe(e,t){if(w1(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var s=a.call(e,t);if(w1(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Wpe(e){var t,a,s=e.element,f=e.tooltipEventType,v=e.isActive,S=e.activeCoordinate,i=e.activePayload,O=e.offset,z=e.activeTooltipIndex,j=e.tooltipAxisBandSize,F=e.layout,G=e.chartName,Y=(t=s.props.cursor)!==null&&t!==void 0?t:(a=s.type.defaultProps)===null||a===void 0?void 0:a.cursor;if(!s||!Y||!v||!S||G!=="ScatterChart"&&f!=="axis")return null;var X,K=LM;if(G==="ScatterChart")X=S,K=qhe;else if(G==="BarChart")X=$pe(F,S,O,j),K=L4;else if(F==="radial"){var ne=BF(S),se=ne.cx,ge=ne.cy,_e=ne.radius,xe=ne.startAngle,ae=ne.endAngle;X={cx:se,cy:ge,startAngle:xe,endAngle:ae,innerRadius:_e,outerRadius:_e},K=iF}else X={points:qpe(F,S,O)},K=LM;var ve=vx(vx(vx(vx({stroke:"#ccc",pointerEvents:"none"},O),X),Fr(Y,!1)),{},{payload:i,payloadIndex:z,className:oi("recharts-tooltip-cursor",Y.className)});return Me.isValidElement(Y)?Me.cloneElement(Y,ve):Me.createElement(K,ve)}var Xpe=["item"],Ype=["children","className","width","height","style","compact","title","desc"];function Dg(e){"@babel/helpers - typeof";return Dg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dg(e)}function ng(){return ng=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},ng.apply(this,arguments)}function Nk(e,t){return Qpe(e)||Jpe(e,t)||FF(e,t)||Kpe()}function Kpe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Jpe(e,t){var a=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(a!=null){var s,f,v,S,i=[],O=!0,z=!1;try{if(v=(a=a.call(e)).next,t!==0)for(;!(O=(s=v.call(a)).done)&&(i.push(s.value),i.length!==t);O=!0);}catch(j){z=!0,f=j}finally{try{if(!O&&a.return!=null&&(S=a.return(),Object(S)!==S))return}finally{if(z)throw f}}return i}}function Qpe(e){if(Array.isArray(e))return e}function Fk(e,t){if(e==null)return{};var a=eme(e,t),s,f;if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(e);for(f=0;f<v.length;f++)s=v[f],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(a[s]=e[s])}return a}function eme(e,t){if(e==null)return{};var a={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(t.indexOf(s)>=0)continue;a[s]=e[s]}return a}function tme(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nme(e,t){for(var a=0;a<t.length;a++){var s=t[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,jF(s.key),s)}}function rme(e,t,a){return t&&nme(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function ime(e,t,a){return t=Ob(t),ame(e,NF()?Reflect.construct(t,a||[],Ob(e).constructor):t.apply(e,a))}function ame(e,t){if(t&&(Dg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ome(e)}function ome(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function NF(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(NF=function(){return!!e})()}function Ob(e){return Ob=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)},Ob(e)}function sme(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&a5(e,t)}function a5(e,t){return a5=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,f){return s.__proto__=f,s},a5(e,t)}function Lg(e){return ume(e)||cme(e)||FF(e)||lme()}function lme(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function FF(e,t){if(e){if(typeof e=="string")return o5(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return o5(e,t)}}function cme(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function ume(e){if(Array.isArray(e))return o5(e)}function o5(e,t){(t==null||t>e.length)&&(t=e.length);for(var a=0,s=new Array(t);a<t;a++)s[a]=e[a];return s}function jk(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(f){return Object.getOwnPropertyDescriptor(e,f).enumerable})),a.push.apply(a,s)}return a}function nn(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?jk(Object(a),!0).forEach(function(s){yr(e,s,a[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):jk(Object(a)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(a,s))})}return e}function yr(e,t,a){return t=jF(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function jF(e){var t=hme(e,"string");return Dg(t)=="symbol"?t:t+""}function hme(e,t){if(Dg(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var s=a.call(e,t);if(Dg(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var fme={xAxis:["bottom","top"],yAxis:["left","right"]},dme={width:"100%",height:"100%"},UF={x:0,y:0};function xx(e){return e}var pme=function(t,a){return a==="horizontal"?t.x:a==="vertical"?t.y:a==="centric"?t.angle:t.radius},mme=function(t,a,s,f){var v=a.find(function(j){return j&&j.index===s});if(v){if(t==="horizontal")return{x:v.coordinate,y:f.y};if(t==="vertical")return{x:f.x,y:v.coordinate};if(t==="centric"){var S=v.coordinate,i=f.radius;return nn(nn(nn({},f),Wi(f.cx,f.cy,i,S)),{},{angle:S,radius:i})}var O=v.coordinate,z=f.angle;return nn(nn(nn({},f),Wi(f.cx,f.cy,O,z)),{},{angle:z,radius:O})}return UF},Lw=function(t,a){var s=a.graphicalItems,f=a.dataStartIndex,v=a.dataEndIndex,S=(s??[]).reduce(function(i,O){var z=O.props.data;return z&&z.length?[].concat(Lg(i),Lg(z)):i},[]);return S.length>0?S:t&&t.length&&Nn(f)&&Nn(v)?t.slice(f,v+1):[]};function VF(e){return e==="number"?[0,"auto"]:void 0}var s5=function(t,a,s,f){var v=t.graphicalItems,S=t.tooltipAxis,i=Lw(a,t);return s<0||!v||!v.length||s>=i.length?null:v.reduce(function(O,z){var j,F=(j=z.props.data)!==null&&j!==void 0?j:a;F&&t.dataStartIndex+t.dataEndIndex!==0&&t.dataEndIndex-t.dataStartIndex>=s&&(F=F.slice(t.dataStartIndex,t.dataEndIndex+1));var G;if(S.dataKey&&!S.allowDuplicatedCategory){var Y=F===void 0?i:F;G=ZC(Y,S.dataKey,f)}else G=F&&F[s]||i[s];return G?[].concat(Lg(O),[Lle(z,G)]):O},[])},Uk=function(t,a,s,f){var v=f||{x:t.chartX,y:t.chartY},S=pme(v,s),i=t.orderedTooltipTicks,O=t.tooltipAxis,z=t.tooltipTicks,j=yle(S,i,z,O);if(j>=0&&z){var F=z[j]&&z[j].value,G=s5(t,a,j,F),Y=mme(s,i,j,v);return{activeTooltipIndex:j,activeLabel:F,activePayload:G,activeCoordinate:Y}}return null},_me=function(t,a){var s=a.axes,f=a.graphicalItems,v=a.axisType,S=a.axisIdKey,i=a.stackGroups,O=a.dataStartIndex,z=a.dataEndIndex,j=t.layout,F=t.children,G=t.stackOffset,Y=KN(j,v);return s.reduce(function(X,K){var ne,se=K.type.defaultProps!==void 0?nn(nn({},K.type.defaultProps),K.props):K.props,ge=se.type,_e=se.dataKey,xe=se.allowDataOverflow,ae=se.allowDuplicatedCategory,ve=se.scale,Se=se.ticks,He=se.includeHidden,Ge=se[S];if(X[Ge])return X;var ye=Lw(t.data,{graphicalItems:f.filter(function(rn){var Nt,xn=S in rn.props?rn.props[S]:(Nt=rn.type.defaultProps)===null||Nt===void 0?void 0:Nt[S];return xn===Ge}),dataStartIndex:O,dataEndIndex:z}),Le=ye.length,ht,gt,Ft;Vpe(se.domain,xe,ge)&&(ht=MM(se.domain,null,xe),Y&&(ge==="number"||ve!=="auto")&&(Ft=Iv(ye,_e,"category")));var _t=VF(ge);if(!ht||ht.length===0){var yt,Vt=(yt=se.domain)!==null&&yt!==void 0?yt:_t;if(_e){if(ht=Iv(ye,_e,ge),ge==="category"&&Y){var Ht=fee(ht);ae&&Ht?(gt=ht,ht=Sb(0,Le)):ae||(ht=nz(Vt,ht,K).reduce(function(rn,Nt){return rn.indexOf(Nt)>=0?rn:[].concat(Lg(rn),[Nt])},[]))}else if(ge==="category")ae?ht=ht.filter(function(rn){return rn!==""&&!ei(rn)}):ht=nz(Vt,ht,K).reduce(function(rn,Nt){return rn.indexOf(Nt)>=0||Nt===""||ei(Nt)?rn:[].concat(Lg(rn),[Nt])},[]);else if(ge==="number"){var Bt=Sle(ye,f.filter(function(rn){var Nt,xn,rr=S in rn.props?rn.props[S]:(Nt=rn.type.defaultProps)===null||Nt===void 0?void 0:Nt[S],Xn="hide"in rn.props?rn.props.hide:(xn=rn.type.defaultProps)===null||xn===void 0?void 0:xn.hide;return rr===Ge&&(He||!Xn)}),_e,v,j);Bt&&(ht=Bt)}Y&&(ge==="number"||ve!=="auto")&&(Ft=Iv(ye,_e,"category"))}else Y?ht=Sb(0,Le):i&&i[Ge]&&i[Ge].hasStack&&ge==="number"?ht=G==="expand"?[0,1]:JN(i[Ge].stackGroups,O,z):ht=YN(ye,f.filter(function(rn){var Nt=S in rn.props?rn.props[S]:rn.type.defaultProps[S],xn="hide"in rn.props?rn.props.hide:rn.type.defaultProps.hide;return Nt===Ge&&(He||!xn)}),ge,j,!0);if(ge==="number")ht=i5(F,ht,Ge,v,Se),Vt&&(ht=MM(Vt,ht,xe));else if(ge==="category"&&Vt){var et=Vt,$t=ht.every(function(rn){return et.indexOf(rn)>=0});$t&&(ht=et)}}return nn(nn({},X),{},yr({},Ge,nn(nn({},se),{},{axisType:v,domain:ht,categoricalDomain:Ft,duplicateDomain:gt,originalDomain:(ne=se.domain)!==null&&ne!==void 0?ne:_t,isCategorical:Y,layout:j})))},{})},gme=function(t,a){var s=a.graphicalItems,f=a.Axis,v=a.axisType,S=a.axisIdKey,i=a.stackGroups,O=a.dataStartIndex,z=a.dataEndIndex,j=t.layout,F=t.children,G=Lw(t.data,{graphicalItems:s,dataStartIndex:O,dataEndIndex:z}),Y=G.length,X=KN(j,v),K=-1;return s.reduce(function(ne,se){var ge=se.type.defaultProps!==void 0?nn(nn({},se.type.defaultProps),se.props):se.props,_e=ge[S],xe=VF("number");if(!ne[_e]){K++;var ae;return X?ae=Sb(0,Y):i&&i[_e]&&i[_e].hasStack?(ae=JN(i[_e].stackGroups,O,z),ae=i5(F,ae,_e,v)):(ae=MM(xe,YN(G,s.filter(function(ve){var Se,He,Ge=S in ve.props?ve.props[S]:(Se=ve.type.defaultProps)===null||Se===void 0?void 0:Se[S],ye="hide"in ve.props?ve.props.hide:(He=ve.type.defaultProps)===null||He===void 0?void 0:He.hide;return Ge===_e&&!ye}),"number",j),f.defaultProps.allowDataOverflow),ae=i5(F,ae,_e,v)),nn(nn({},ne),{},yr({},_e,nn(nn({axisType:v},f.defaultProps),{},{hide:!0,orientation:Hu(fme,"".concat(v,".").concat(K%2),null),domain:ae,originalDomain:xe,isCategorical:X,layout:j})))}return ne},{})},yme=function(t,a){var s=a.axisType,f=s===void 0?"xAxis":s,v=a.AxisComp,S=a.graphicalItems,i=a.stackGroups,O=a.dataStartIndex,z=a.dataEndIndex,j=t.children,F="".concat(f,"Id"),G=ef(j,v),Y={};return G&&G.length?Y=_me(t,{axes:G,graphicalItems:S,axisType:f,axisIdKey:F,stackGroups:i,dataStartIndex:O,dataEndIndex:z}):S&&S.length&&(Y=gme(t,{Axis:v,graphicalItems:S,axisType:f,axisIdKey:F,stackGroups:i,dataStartIndex:O,dataEndIndex:z})),Y},vme=function(t){var a=K_(t),s=Ev(a,!1,!0);return{tooltipTicks:s,orderedTooltipTicks:a4(s,function(f){return f.coordinate}),tooltipAxis:a,tooltipAxisBandSize:OM(a,s)}},Vk=function(t){var a=t.children,s=t.defaultShowTooltip,f=Yc(a,Og),v=0,S=0;return t.data&&t.data.length!==0&&(S=t.data.length-1),f&&f.props&&(f.props.startIndex>=0&&(v=f.props.startIndex),f.props.endIndex>=0&&(S=f.props.endIndex)),{chartX:0,chartY:0,dataStartIndex:v,dataEndIndex:S,activeTooltipIndex:-1,isTooltipActive:!!s}},xme=function(t){return!t||!t.length?!1:t.some(function(a){var s=bd(a&&a.type);return s&&s.indexOf("Bar")>=0})},$k=function(t){return t==="horizontal"?{numericAxisName:"yAxis",cateAxisName:"xAxis"}:t==="vertical"?{numericAxisName:"xAxis",cateAxisName:"yAxis"}:t==="centric"?{numericAxisName:"radiusAxis",cateAxisName:"angleAxis"}:{numericAxisName:"angleAxis",cateAxisName:"radiusAxis"}},bme=function(t,a){var s=t.props,f=t.graphicalItems,v=t.xAxisMap,S=v===void 0?{}:v,i=t.yAxisMap,O=i===void 0?{}:i,z=s.width,j=s.height,F=s.children,G=s.margin||{},Y=Yc(F,Og),X=Yc(F,ag),K=Object.keys(O).reduce(function(ae,ve){var Se=O[ve],He=Se.orientation;return!Se.mirror&&!Se.hide?nn(nn({},ae),{},yr({},He,ae[He]+Se.width)):ae},{left:G.left||0,right:G.right||0}),ne=Object.keys(S).reduce(function(ae,ve){var Se=S[ve],He=Se.orientation;return!Se.mirror&&!Se.hide?nn(nn({},ae),{},yr({},He,Hu(ae,"".concat(He))+Se.height)):ae},{top:G.top||0,bottom:G.bottom||0}),se=nn(nn({},ne),K),ge=se.bottom;Y&&(se.bottom+=Y.props.height||Og.defaultProps.height),X&&a&&(se=ble(se,f,s,a));var _e=z-se.left-se.right,xe=j-se.top-se.bottom;return nn(nn({brushBottom:ge},se),{},{width:Math.max(_e,0),height:Math.max(xe,0)})},wme=function(t,a){if(a==="xAxis")return t[a].width;if(a==="yAxis")return t[a].height},Sme=function(t){var a=t.chartName,s=t.GraphicalChild,f=t.defaultTooltipEventType,v=f===void 0?"axis":f,S=t.validateTooltipEventTypes,i=S===void 0?["axis"]:S,O=t.axisComponents,z=t.legendContent,j=t.formatAxisMap,F=t.defaultProps,G=function(se,ge){var _e=ge.graphicalItems,xe=ge.stackGroups,ae=ge.offset,ve=ge.updateId,Se=ge.dataStartIndex,He=ge.dataEndIndex,Ge=se.barSize,ye=se.layout,Le=se.barGap,ht=se.barCategoryGap,gt=se.maxBarSize,Ft=$k(ye),_t=Ft.numericAxisName,yt=Ft.cateAxisName,Vt=xme(_e),Ht=[];return _e.forEach(function(Bt,et){var $t=Lw(se.data,{graphicalItems:[Bt],dataStartIndex:Se,dataEndIndex:He}),rn=Bt.type.defaultProps!==void 0?nn(nn({},Bt.type.defaultProps),Bt.props):Bt.props,Nt=rn.dataKey,xn=rn.maxBarSize,rr=rn["".concat(_t,"Id")],Xn=rn["".concat(yt,"Id")],yi={},ir=O.reduce(function(Aa,ao){var Ss=ge["".concat(ao.axisType,"Map")],Bn=rn["".concat(ao.axisType,"Id")];Ss&&Ss[Bn]||ao.axisType==="zAxis"||wg();var Lo=Ss[Bn];return nn(nn({},Aa),{},yr(yr({},ao.axisType,Lo),"".concat(ao.axisType,"Ticks"),Ev(Lo)))},yi),yn=ir[yt],Ne=ir["".concat(yt,"Ticks")],Qn=xe&&xe[rr]&&xe[rr].hasStack&&Rle(Bt,xe[rr].stackGroups),fn=bd(Bt.type).indexOf("Bar")>=0,Dr=OM(yn,Ne),It=[],Ir=Vt&&vle({barSize:Ge,stackGroups:xe,totalSize:wme(ir,yt)});if(fn){var Cr,ki,$n=ei(xn)?gt:xn,si=(Cr=(ki=OM(yn,Ne,!0))!==null&&ki!==void 0?ki:$n)!==null&&Cr!==void 0?Cr:0;It=xle({barGap:Le,barCategoryGap:ht,bandSize:si!==Dr?si:Dr,sizeList:Ir[Xn],maxBarSize:$n}),si!==Dr&&(It=It.map(function(Aa){return nn(nn({},Aa),{},{position:nn(nn({},Aa.position),{},{offset:Aa.position.offset-si/2})})}))}var ca=Bt&&Bt.type&&Bt.type.getComposedData;ca&&Ht.push({props:nn(nn({},ca(nn(nn({},ir),{},{displayedData:$t,props:se,dataKey:Nt,item:Bt,bandSize:Dr,barPosition:It,offset:ae,stackedData:Qn,layout:ye,dataStartIndex:Se,dataEndIndex:He}))),{},yr(yr(yr({key:Bt.key||"item-".concat(et)},_t,ir[_t]),yt,ir[yt]),"animationId",ve)),childIndex:See(Bt,se.children),item:Bt})}),Ht},Y=function(se,ge){var _e=se.props,xe=se.dataStartIndex,ae=se.dataEndIndex,ve=se.updateId;if(!gR({props:_e}))return null;var Se=_e.children,He=_e.layout,Ge=_e.stackOffset,ye=_e.data,Le=_e.reverseStackOrder,ht=$k(He),gt=ht.numericAxisName,Ft=ht.cateAxisName,_t=ef(Se,s),yt=Ile(ye,_t,"".concat(gt,"Id"),"".concat(Ft,"Id"),Ge,Le),Vt=O.reduce(function(rn,Nt){var xn="".concat(Nt.axisType,"Map");return nn(nn({},rn),{},yr({},xn,yme(_e,nn(nn({},Nt),{},{graphicalItems:_t,stackGroups:Nt.axisType===gt&&yt,dataStartIndex:xe,dataEndIndex:ae}))))},{}),Ht=bme(nn(nn({},Vt),{},{props:_e,graphicalItems:_t}),ge==null?void 0:ge.legendBBox);Object.keys(Vt).forEach(function(rn){Vt[rn]=j(_e,Vt[rn],Ht,rn.replace("Map",""),a)});var Bt=Vt["".concat(Ft,"Map")],et=vme(Bt),$t=G(_e,nn(nn({},Vt),{},{dataStartIndex:xe,dataEndIndex:ae,updateId:ve,graphicalItems:_t,stackGroups:yt,offset:Ht}));return nn(nn({formattedGraphicalItems:$t,graphicalItems:_t,offset:Ht,stackGroups:yt},et),Vt)},X=function(ne){function se(ge){var _e,xe,ae;return tme(this,se),ae=ime(this,se,[ge]),yr(ae,"eventEmitterSymbol",Symbol("rechartsEventEmitter")),yr(ae,"accessibilityManager",new Upe),yr(ae,"handleLegendBBoxUpdate",function(ve){if(ve){var Se=ae.state,He=Se.dataStartIndex,Ge=Se.dataEndIndex,ye=Se.updateId;ae.setState(nn({legendBBox:ve},Y({props:ae.props,dataStartIndex:He,dataEndIndex:Ge,updateId:ye},nn(nn({},ae.state),{},{legendBBox:ve}))))}}),yr(ae,"handleReceiveSyncEvent",function(ve,Se,He){if(ae.props.syncId===ve){if(He===ae.eventEmitterSymbol&&typeof ae.props.syncMethod!="function")return;ae.applySyncEvent(Se)}}),yr(ae,"handleBrushChange",function(ve){var Se=ve.startIndex,He=ve.endIndex;if(Se!==ae.state.dataStartIndex||He!==ae.state.dataEndIndex){var Ge=ae.state.updateId;ae.setState(function(){return nn({dataStartIndex:Se,dataEndIndex:He},Y({props:ae.props,dataStartIndex:Se,dataEndIndex:He,updateId:Ge},ae.state))}),ae.triggerSyncEvent({dataStartIndex:Se,dataEndIndex:He})}}),yr(ae,"handleMouseEnter",function(ve){var Se=ae.getMouseInfo(ve);if(Se){var He=nn(nn({},Se),{},{isTooltipActive:!0});ae.setState(He),ae.triggerSyncEvent(He);var Ge=ae.props.onMouseEnter;Vr(Ge)&&Ge(He,ve)}}),yr(ae,"triggeredAfterMouseMove",function(ve){var Se=ae.getMouseInfo(ve),He=Se?nn(nn({},Se),{},{isTooltipActive:!0}):{isTooltipActive:!1};ae.setState(He),ae.triggerSyncEvent(He);var Ge=ae.props.onMouseMove;Vr(Ge)&&Ge(He,ve)}),yr(ae,"handleItemMouseEnter",function(ve){ae.setState(function(){return{isTooltipActive:!0,activeItem:ve,activePayload:ve.tooltipPayload,activeCoordinate:ve.tooltipPosition||{x:ve.cx,y:ve.cy}}})}),yr(ae,"handleItemMouseLeave",function(){ae.setState(function(){return{isTooltipActive:!1}})}),yr(ae,"handleMouseMove",function(ve){ve.persist(),ae.throttleTriggeredAfterMouseMove(ve)}),yr(ae,"handleMouseLeave",function(ve){ae.throttleTriggeredAfterMouseMove.cancel();var Se={isTooltipActive:!1};ae.setState(Se),ae.triggerSyncEvent(Se);var He=ae.props.onMouseLeave;Vr(He)&&He(Se,ve)}),yr(ae,"handleOuterEvent",function(ve){var Se=wee(ve),He=Hu(ae.props,"".concat(Se));if(Se&&Vr(He)){var Ge,ye;/.*touch.*/i.test(Se)?ye=ae.getMouseInfo(ve.changedTouches[0]):ye=ae.getMouseInfo(ve),He((Ge=ye)!==null&&Ge!==void 0?Ge:{},ve)}}),yr(ae,"handleClick",function(ve){var Se=ae.getMouseInfo(ve);if(Se){var He=nn(nn({},Se),{},{isTooltipActive:!0});ae.setState(He),ae.triggerSyncEvent(He);var Ge=ae.props.onClick;Vr(Ge)&&Ge(He,ve)}}),yr(ae,"handleMouseDown",function(ve){var Se=ae.props.onMouseDown;if(Vr(Se)){var He=ae.getMouseInfo(ve);Se(He,ve)}}),yr(ae,"handleMouseUp",function(ve){var Se=ae.props.onMouseUp;if(Vr(Se)){var He=ae.getMouseInfo(ve);Se(He,ve)}}),yr(ae,"handleTouchMove",function(ve){ve.changedTouches!=null&&ve.changedTouches.length>0&&ae.throttleTriggeredAfterMouseMove(ve.changedTouches[0])}),yr(ae,"handleTouchStart",function(ve){ve.changedTouches!=null&&ve.changedTouches.length>0&&ae.handleMouseDown(ve.changedTouches[0])}),yr(ae,"handleTouchEnd",function(ve){ve.changedTouches!=null&&ve.changedTouches.length>0&&ae.handleMouseUp(ve.changedTouches[0])}),yr(ae,"handleDoubleClick",function(ve){var Se=ae.props.onDoubleClick;if(Vr(Se)){var He=ae.getMouseInfo(ve);Se(He,ve)}}),yr(ae,"handleContextMenu",function(ve){var Se=ae.props.onContextMenu;if(Vr(Se)){var He=ae.getMouseInfo(ve);Se(He,ve)}}),yr(ae,"triggerSyncEvent",function(ve){ae.props.syncId!==void 0&&gC.emit(yC,ae.props.syncId,ve,ae.eventEmitterSymbol)}),yr(ae,"applySyncEvent",function(ve){var Se=ae.props,He=Se.layout,Ge=Se.syncMethod,ye=ae.state.updateId,Le=ve.dataStartIndex,ht=ve.dataEndIndex;if(ve.dataStartIndex!==void 0||ve.dataEndIndex!==void 0)ae.setState(nn({dataStartIndex:Le,dataEndIndex:ht},Y({props:ae.props,dataStartIndex:Le,dataEndIndex:ht,updateId:ye},ae.state)));else if(ve.activeTooltipIndex!==void 0){var gt=ve.chartX,Ft=ve.chartY,_t=ve.activeTooltipIndex,yt=ae.state,Vt=yt.offset,Ht=yt.tooltipTicks;if(!Vt)return;if(typeof Ge=="function")_t=Ge(Ht,ve);else if(Ge==="value"){_t=-1;for(var Bt=0;Bt<Ht.length;Bt++)if(Ht[Bt].value===ve.activeLabel){_t=Bt;break}}var et=nn(nn({},Vt),{},{x:Vt.left,y:Vt.top}),$t=Math.min(gt,et.x+et.width),rn=Math.min(Ft,et.y+et.height),Nt=Ht[_t]&&Ht[_t].value,xn=s5(ae.state,ae.props.data,_t),rr=Ht[_t]?{x:He==="horizontal"?Ht[_t].coordinate:$t,y:He==="horizontal"?rn:Ht[_t].coordinate}:UF;ae.setState(nn(nn({},ve),{},{activeLabel:Nt,activeCoordinate:rr,activePayload:xn,activeTooltipIndex:_t}))}else ae.setState(ve)}),yr(ae,"renderCursor",function(ve){var Se,He=ae.state,Ge=He.isTooltipActive,ye=He.activeCoordinate,Le=He.activePayload,ht=He.offset,gt=He.activeTooltipIndex,Ft=He.tooltipAxisBandSize,_t=ae.getTooltipEventType(),yt=(Se=ve.props.active)!==null&&Se!==void 0?Se:Ge,Vt=ae.props.layout,Ht=ve.key||"_recharts-cursor";return Ot.createElement(Wpe,{key:Ht,activeCoordinate:ye,activePayload:Le,activeTooltipIndex:gt,chartName:a,element:ve,isActive:yt,layout:Vt,offset:ht,tooltipAxisBandSize:Ft,tooltipEventType:_t})}),yr(ae,"renderPolarAxis",function(ve,Se,He){var Ge=Hu(ve,"type.axisType"),ye=Hu(ae.state,"".concat(Ge,"Map")),Le=ve.type.defaultProps,ht=Le!==void 0?nn(nn({},Le),ve.props):ve.props,gt=ye&&ye[ht["".concat(Ge,"Id")]];return Me.cloneElement(ve,nn(nn({},gt),{},{className:oi(Ge,gt.className),key:ve.key||"".concat(Se,"-").concat(He),ticks:Ev(gt,!0)}))}),yr(ae,"renderPolarGrid",function(ve){var Se=ve.props,He=Se.radialLines,Ge=Se.polarAngles,ye=Se.polarRadius,Le=ae.state,ht=Le.radiusAxisMap,gt=Le.angleAxisMap,Ft=K_(ht),_t=K_(gt),yt=_t.cx,Vt=_t.cy,Ht=_t.innerRadius,Bt=_t.outerRadius;return Me.cloneElement(ve,{polarAngles:Array.isArray(Ge)?Ge:Ev(_t,!0).map(function(et){return et.coordinate}),polarRadius:Array.isArray(ye)?ye:Ev(Ft,!0).map(function(et){return et.coordinate}),cx:yt,cy:Vt,innerRadius:Ht,outerRadius:Bt,key:ve.key||"polar-grid",radialLines:He})}),yr(ae,"renderLegend",function(){var ve=ae.state.formattedGraphicalItems,Se=ae.props,He=Se.children,Ge=Se.width,ye=Se.height,Le=ae.props.margin||{},ht=Ge-(Le.left||0)-(Le.right||0),gt=WN({children:He,formattedGraphicalItems:ve,legendWidth:ht,legendContent:z});if(!gt)return null;var Ft=gt.item,_t=Fk(gt,Xpe);return Me.cloneElement(Ft,nn(nn({},_t),{},{chartWidth:Ge,chartHeight:ye,margin:Le,onBBoxUpdate:ae.handleLegendBBoxUpdate}))}),yr(ae,"renderTooltip",function(){var ve,Se=ae.props,He=Se.children,Ge=Se.accessibilityLayer,ye=Yc(He,dd);if(!ye)return null;var Le=ae.state,ht=Le.isTooltipActive,gt=Le.activeCoordinate,Ft=Le.activePayload,_t=Le.activeLabel,yt=Le.offset,Vt=(ve=ye.props.active)!==null&&ve!==void 0?ve:ht;return Me.cloneElement(ye,{viewBox:nn(nn({},yt),{},{x:yt.left,y:yt.top}),active:Vt,label:_t,payload:Vt?Ft:[],coordinate:gt,accessibilityLayer:Ge})}),yr(ae,"renderBrush",function(ve){var Se=ae.props,He=Se.margin,Ge=Se.data,ye=ae.state,Le=ye.offset,ht=ye.dataStartIndex,gt=ye.dataEndIndex,Ft=ye.updateId;return Me.cloneElement(ve,{key:ve.key||"_recharts-brush",onChange:px(ae.handleBrushChange,ve.props.onChange),data:Ge,x:Nn(ve.props.x)?ve.props.x:Le.left,y:Nn(ve.props.y)?ve.props.y:Le.top+Le.height+Le.brushBottom-(He.bottom||0),width:Nn(ve.props.width)?ve.props.width:Le.width,startIndex:ht,endIndex:gt,updateId:"brush-".concat(Ft)})}),yr(ae,"renderReferenceElement",function(ve,Se,He){if(!ve)return null;var Ge=ae,ye=Ge.clipPathId,Le=ae.state,ht=Le.xAxisMap,gt=Le.yAxisMap,Ft=Le.offset,_t=ve.type.defaultProps||{},yt=ve.props,Vt=yt.xAxisId,Ht=Vt===void 0?_t.xAxisId:Vt,Bt=yt.yAxisId,et=Bt===void 0?_t.yAxisId:Bt;return Me.cloneElement(ve,{key:ve.key||"".concat(Se,"-").concat(He),xAxis:ht[Ht],yAxis:gt[et],viewBox:{x:Ft.left,y:Ft.top,width:Ft.width,height:Ft.height},clipPathId:ye})}),yr(ae,"renderActivePoints",function(ve){var Se=ve.item,He=ve.activePoint,Ge=ve.basePoint,ye=ve.childIndex,Le=ve.isRange,ht=[],gt=Se.props.key,Ft=Se.item.type.defaultProps!==void 0?nn(nn({},Se.item.type.defaultProps),Se.item.props):Se.item.props,_t=Ft.activeDot,yt=Ft.dataKey,Vt=nn(nn({index:ye,dataKey:yt,cx:He.x,cy:He.y,r:4,fill:D4(Se.item),strokeWidth:2,stroke:"#fff",payload:He.payload,value:He.value},Fr(_t,!1)),Vx(_t));return ht.push(se.renderActiveDot(_t,Vt,"".concat(gt,"-activePoint-").concat(ye))),Ge?ht.push(se.renderActiveDot(_t,nn(nn({},Vt),{},{cx:Ge.x,cy:Ge.y}),"".concat(gt,"-basePoint-").concat(ye))):Le&&ht.push(null),ht}),yr(ae,"renderGraphicChild",function(ve,Se,He){var Ge=ae.filterFormatItem(ve,Se,He);if(!Ge)return null;var ye=ae.getTooltipEventType(),Le=ae.state,ht=Le.isTooltipActive,gt=Le.tooltipAxis,Ft=Le.activeTooltipIndex,_t=Le.activeLabel,yt=ae.props.children,Vt=Yc(yt,dd),Ht=Ge.props,Bt=Ht.points,et=Ht.isRange,$t=Ht.baseLine,rn=Ge.item.type.defaultProps!==void 0?nn(nn({},Ge.item.type.defaultProps),Ge.item.props):Ge.item.props,Nt=rn.activeDot,xn=rn.hide,rr=rn.activeBar,Xn=rn.activeShape,yi=!!(!xn&&ht&&Vt&&(Nt||rr||Xn)),ir={};ye!=="axis"&&Vt&&Vt.props.trigger==="click"?ir={onClick:px(ae.handleItemMouseEnter,ve.props.onClick)}:ye!=="axis"&&(ir={onMouseLeave:px(ae.handleItemMouseLeave,ve.props.onMouseLeave),onMouseEnter:px(ae.handleItemMouseEnter,ve.props.onMouseEnter)});var yn=Me.cloneElement(ve,nn(nn({},Ge.props),ir));function Ne(ao){return typeof gt.dataKey=="function"?gt.dataKey(ao.payload):null}if(yi)if(Ft>=0){var Qn,fn;if(gt.dataKey&&!gt.allowDuplicatedCategory){var Dr=typeof gt.dataKey=="function"?Ne:"payload.".concat(gt.dataKey.toString());Qn=ZC(Bt,Dr,_t),fn=et&&$t&&ZC($t,Dr,_t)}else Qn=Bt==null?void 0:Bt[Ft],fn=et&&$t&&$t[Ft];if(Xn||rr){var It=ve.props.activeIndex!==void 0?ve.props.activeIndex:Ft;return[Me.cloneElement(ve,nn(nn(nn({},Ge.props),ir),{},{activeIndex:It})),null,null]}if(!ei(Qn))return[yn].concat(Lg(ae.renderActivePoints({item:Ge,activePoint:Qn,basePoint:fn,childIndex:Ft,isRange:et})))}else{var Ir,Cr=(Ir=ae.getItemByXY(ae.state.activeCoordinate))!==null&&Ir!==void 0?Ir:{graphicalItem:yn},ki=Cr.graphicalItem,$n=ki.item,si=$n===void 0?ve:$n,ca=ki.childIndex,Aa=nn(nn(nn({},Ge.props),ir),{},{activeIndex:ca});return[Me.cloneElement(si,Aa),null,null]}return et?[yn,null,null]:[yn,null]}),yr(ae,"renderCustomized",function(ve,Se,He){return Me.cloneElement(ve,nn(nn({key:"recharts-customized-".concat(He)},ae.props),ae.state))}),yr(ae,"renderMap",{CartesianGrid:{handler:xx,once:!0},ReferenceArea:{handler:ae.renderReferenceElement},ReferenceLine:{handler:xx},ReferenceDot:{handler:ae.renderReferenceElement},XAxis:{handler:xx},YAxis:{handler:xx},Brush:{handler:ae.renderBrush,once:!0},Bar:{handler:ae.renderGraphicChild},Line:{handler:ae.renderGraphicChild},Area:{handler:ae.renderGraphicChild},Radar:{handler:ae.renderGraphicChild},RadialBar:{handler:ae.renderGraphicChild},Scatter:{handler:ae.renderGraphicChild},Pie:{handler:ae.renderGraphicChild},Funnel:{handler:ae.renderGraphicChild},Tooltip:{handler:ae.renderCursor,once:!0},PolarGrid:{handler:ae.renderPolarGrid,once:!0},PolarAngleAxis:{handler:ae.renderPolarAxis},PolarRadiusAxis:{handler:ae.renderPolarAxis},Customized:{handler:ae.renderCustomized}}),ae.clipPathId="".concat((_e=ge.id)!==null&&_e!==void 0?_e:rw("recharts"),"-clip"),ae.throttleTriggeredAfterMouseMove=HB(ae.triggeredAfterMouseMove,(xe=ge.throttleDelay)!==null&&xe!==void 0?xe:1e3/60),ae.state={},ae}return sme(se,ne),rme(se,[{key:"componentDidMount",value:function(){var _e,xe;this.addListener(),this.accessibilityManager.setDetails({container:this.container,offset:{left:(_e=this.props.margin.left)!==null&&_e!==void 0?_e:0,top:(xe=this.props.margin.top)!==null&&xe!==void 0?xe:0},coordinateList:this.state.tooltipTicks,mouseHandlerCallback:this.triggeredAfterMouseMove,layout:this.props.layout}),this.displayDefaultTooltip()}},{key:"displayDefaultTooltip",value:function(){var _e=this.props,xe=_e.children,ae=_e.data,ve=_e.height,Se=_e.layout,He=Yc(xe,dd);if(He){var Ge=He.props.defaultIndex;if(!(typeof Ge!="number"||Ge<0||Ge>this.state.tooltipTicks.length-1)){var ye=this.state.tooltipTicks[Ge]&&this.state.tooltipTicks[Ge].value,Le=s5(this.state,ae,Ge,ye),ht=this.state.tooltipTicks[Ge].coordinate,gt=(this.state.offset.top+ve)/2,Ft=Se==="horizontal",_t=Ft?{x:ht,y:gt}:{y:ht,x:gt},yt=this.state.formattedGraphicalItems.find(function(Ht){var Bt=Ht.item;return Bt.type.name==="Scatter"});yt&&(_t=nn(nn({},_t),yt.props.points[Ge].tooltipPosition),Le=yt.props.points[Ge].tooltipPayload);var Vt={activeTooltipIndex:Ge,isTooltipActive:!0,activeLabel:ye,activePayload:Le,activeCoordinate:_t};this.setState(Vt),this.renderCursor(He),this.accessibilityManager.setIndex(Ge)}}}},{key:"getSnapshotBeforeUpdate",value:function(_e,xe){if(!this.props.accessibilityLayer)return null;if(this.state.tooltipTicks!==xe.tooltipTicks&&this.accessibilityManager.setDetails({coordinateList:this.state.tooltipTicks}),this.props.layout!==_e.layout&&this.accessibilityManager.setDetails({layout:this.props.layout}),this.props.margin!==_e.margin){var ae,ve;this.accessibilityManager.setDetails({offset:{left:(ae=this.props.margin.left)!==null&&ae!==void 0?ae:0,top:(ve=this.props.margin.top)!==null&&ve!==void 0?ve:0}})}return null}},{key:"componentDidUpdate",value:function(_e){YC([Yc(_e.children,dd)],[Yc(this.props.children,dd)])||this.displayDefaultTooltip()}},{key:"componentWillUnmount",value:function(){this.removeListener(),this.throttleTriggeredAfterMouseMove.cancel()}},{key:"getTooltipEventType",value:function(){var _e=Yc(this.props.children,dd);if(_e&&typeof _e.props.shared=="boolean"){var xe=_e.props.shared?"axis":"item";return i.indexOf(xe)>=0?xe:v}return v}},{key:"getMouseInfo",value:function(_e){if(!this.container)return null;var xe=this.container,ae=xe.getBoundingClientRect(),ve=uie(ae),Se={chartX:Math.round(_e.pageX-ve.left),chartY:Math.round(_e.pageY-ve.top)},He=ae.width/xe.offsetWidth||1,Ge=this.inRange(Se.chartX,Se.chartY,He);if(!Ge)return null;var ye=this.state,Le=ye.xAxisMap,ht=ye.yAxisMap,gt=this.getTooltipEventType();if(gt!=="axis"&&Le&&ht){var Ft=K_(Le).scale,_t=K_(ht).scale,yt=Ft&&Ft.invert?Ft.invert(Se.chartX):null,Vt=_t&&_t.invert?_t.invert(Se.chartY):null;return nn(nn({},Se),{},{xValue:yt,yValue:Vt})}var Ht=Uk(this.state,this.props.data,this.props.layout,Ge);return Ht?nn(nn({},Se),Ht):null}},{key:"inRange",value:function(_e,xe){var ae=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,ve=this.props.layout,Se=_e/ae,He=xe/ae;if(ve==="horizontal"||ve==="vertical"){var Ge=this.state.offset,ye=Se>=Ge.left&&Se<=Ge.left+Ge.width&&He>=Ge.top&&He<=Ge.top+Ge.height;return ye?{x:Se,y:He}:null}var Le=this.state,ht=Le.angleAxisMap,gt=Le.radiusAxisMap;if(ht&&gt){var Ft=K_(ht);return az({x:Se,y:He},Ft)}return null}},{key:"parseEventsOfWrapper",value:function(){var _e=this.props.children,xe=this.getTooltipEventType(),ae=Yc(_e,dd),ve={};ae&&xe==="axis"&&(ae.props.trigger==="click"?ve={onClick:this.handleClick}:ve={onMouseEnter:this.handleMouseEnter,onDoubleClick:this.handleDoubleClick,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onTouchMove:this.handleTouchMove,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd,onContextMenu:this.handleContextMenu});var Se=Vx(this.props,this.handleOuterEvent);return nn(nn({},Se),ve)}},{key:"addListener",value:function(){gC.on(yC,this.handleReceiveSyncEvent)}},{key:"removeListener",value:function(){gC.removeListener(yC,this.handleReceiveSyncEvent)}},{key:"filterFormatItem",value:function(_e,xe,ae){for(var ve=this.state.formattedGraphicalItems,Se=0,He=ve.length;Se<He;Se++){var Ge=ve[Se];if(Ge.item===_e||Ge.props.key===_e.key||xe===bd(Ge.item.type)&&ae===Ge.childIndex)return Ge}return null}},{key:"renderClipPath",value:function(){var _e=this.clipPathId,xe=this.state.offset,ae=xe.left,ve=xe.top,Se=xe.height,He=xe.width;return Ot.createElement("defs",null,Ot.createElement("clipPath",{id:_e},Ot.createElement("rect",{x:ae,y:ve,height:Se,width:He})))}},{key:"getXScales",value:function(){var _e=this.state.xAxisMap;return _e?Object.entries(_e).reduce(function(xe,ae){var ve=Nk(ae,2),Se=ve[0],He=ve[1];return nn(nn({},xe),{},yr({},Se,He.scale))},{}):null}},{key:"getYScales",value:function(){var _e=this.state.yAxisMap;return _e?Object.entries(_e).reduce(function(xe,ae){var ve=Nk(ae,2),Se=ve[0],He=ve[1];return nn(nn({},xe),{},yr({},Se,He.scale))},{}):null}},{key:"getXScaleByAxisId",value:function(_e){var xe;return(xe=this.state.xAxisMap)===null||xe===void 0||(xe=xe[_e])===null||xe===void 0?void 0:xe.scale}},{key:"getYScaleByAxisId",value:function(_e){var xe;return(xe=this.state.yAxisMap)===null||xe===void 0||(xe=xe[_e])===null||xe===void 0?void 0:xe.scale}},{key:"getItemByXY",value:function(_e){var xe=this.state,ae=xe.formattedGraphicalItems,ve=xe.activeItem;if(ae&&ae.length)for(var Se=0,He=ae.length;Se<He;Se++){var Ge=ae[Se],ye=Ge.props,Le=Ge.item,ht=Le.type.defaultProps!==void 0?nn(nn({},Le.type.defaultProps),Le.props):Le.props,gt=bd(Le.type);if(gt==="Bar"){var Ft=(ye.data||[]).find(function(Ht){return The(_e,Ht)});if(Ft)return{graphicalItem:Ge,payload:Ft}}else if(gt==="RadialBar"){var _t=(ye.data||[]).find(function(Ht){return az(_e,Ht)});if(_t)return{graphicalItem:Ge,payload:_t}}else if(Mw(Ge,ve)||Ow(Ge,ve)||y1(Ge,ve)){var yt=Xfe({graphicalItem:Ge,activeTooltipItem:ve,itemData:ht.data}),Vt=ht.activeIndex===void 0?yt:ht.activeIndex;return{graphicalItem:nn(nn({},Ge),{},{childIndex:Vt}),payload:y1(Ge,ve)?ht.data[yt]:Ge.props.data[yt]}}}return null}},{key:"render",value:function(){var _e=this;if(!gR(this))return null;var xe=this.props,ae=xe.children,ve=xe.className,Se=xe.width,He=xe.height,Ge=xe.style,ye=xe.compact,Le=xe.title,ht=xe.desc,gt=Fk(xe,Ype),Ft=Fr(gt,!1);if(ye)return Ot.createElement(Ck,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},Ot.createElement(JC,ng({},Ft,{width:Se,height:He,title:Le,desc:ht}),this.renderClipPath(),vR(ae,this.renderMap)));if(this.props.accessibilityLayer){var _t,yt;Ft.tabIndex=(_t=this.props.tabIndex)!==null&&_t!==void 0?_t:0,Ft.role=(yt=this.props.role)!==null&&yt!==void 0?yt:"application",Ft.onKeyDown=function(Ht){_e.accessibilityManager.keyboardEvent(Ht)},Ft.onFocus=function(){_e.accessibilityManager.focus()}}var Vt=this.parseEventsOfWrapper();return Ot.createElement(Ck,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},Ot.createElement("div",ng({className:oi("recharts-wrapper",ve),style:nn({position:"relative",cursor:"default",width:Se,height:He},Ge)},Vt,{ref:function(Bt){_e.container=Bt}}),Ot.createElement(JC,ng({},Ft,{width:Se,height:He,title:Le,desc:ht,style:dme}),this.renderClipPath(),vR(ae,this.renderMap)),this.renderLegend(),this.renderTooltip()))}}])}(Me.Component);yr(X,"displayName",a),yr(X,"defaultProps",nn({layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},F)),yr(X,"getDerivedStateFromProps",function(ne,se){var ge=ne.dataKey,_e=ne.data,xe=ne.children,ae=ne.width,ve=ne.height,Se=ne.layout,He=ne.stackOffset,Ge=ne.margin,ye=se.dataStartIndex,Le=se.dataEndIndex;if(se.updateId===void 0){var ht=Vk(ne);return nn(nn(nn({},ht),{},{updateId:0},Y(nn(nn({props:ne},ht),{},{updateId:0}),se)),{},{prevDataKey:ge,prevData:_e,prevWidth:ae,prevHeight:ve,prevLayout:Se,prevStackOffset:He,prevMargin:Ge,prevChildren:xe})}if(ge!==se.prevDataKey||_e!==se.prevData||ae!==se.prevWidth||ve!==se.prevHeight||Se!==se.prevLayout||He!==se.prevStackOffset||!WC(Ge,se.prevMargin)){var gt=Vk(ne),Ft={chartX:se.chartX,chartY:se.chartY,isTooltipActive:se.isTooltipActive},_t=nn(nn({},Uk(se,_e,Se)),{},{updateId:se.updateId+1}),yt=nn(nn(nn({},gt),Ft),_t);return nn(nn(nn({},yt),Y(nn({props:ne},yt),se)),{},{prevDataKey:ge,prevData:_e,prevWidth:ae,prevHeight:ve,prevLayout:Se,prevStackOffset:He,prevMargin:Ge,prevChildren:xe})}if(!YC(xe,se.prevChildren)){var Vt,Ht,Bt,et,$t=Yc(xe,Og),rn=$t&&(Vt=(Ht=$t.props)===null||Ht===void 0?void 0:Ht.startIndex)!==null&&Vt!==void 0?Vt:ye,Nt=$t&&(Bt=(et=$t.props)===null||et===void 0?void 0:et.endIndex)!==null&&Bt!==void 0?Bt:Le,xn=rn!==ye||Nt!==Le,rr=!ei(_e),Xn=rr&&!xn?se.updateId:se.updateId+1;return nn(nn({updateId:Xn},Y(nn(nn({props:ne},se),{},{updateId:Xn,dataStartIndex:rn,dataEndIndex:Nt}),se)),{},{prevChildren:xe,dataStartIndex:rn,dataEndIndex:Nt})}return null}),yr(X,"renderActiveDot",function(ne,se,ge){var _e;return Me.isValidElement(ne)?_e=Me.cloneElement(ne,se):Vr(ne)?_e=ne(se):_e=Ot.createElement(z4,se),Ot.createElement(Ua,{className:"recharts-active-dot",key:ge},_e)});var K=Me.forwardRef(function(se,ge){return Ot.createElement(X,ng({},se,{ref:ge}))});return K.displayName=X.displayName,K},Tme=Sme({chartName:"PieChart",GraphicalChild:af,validateTooltipEventTypes:["item"],defaultTooltipEventType:"item",legendContent:"children",axisComponents:[{axisType:"angleAxis",AxisComp:Cw},{axisType:"radiusAxis",AxisComp:Ew}],formatAxisMap:$le,defaultProps:{layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"}});const Eme="_chart_1jflt_1",Ame={chart:Eme},qk={blue:{backgroundColor:"#05A6BE33",mainColor:"#05A6BE"}},xC=-90,Cme=-450,Mme=1e3;function Ome(e){let t=e.maxValue;return e.value===t&&(t=e.value===0?100:e.value*100),he.jsx("div",{className:`${Ame.chart} ${e.className}`,children:he.jsx(rie,{width:"100%",height:"100%",children:he.jsxs(Tme,{children:[he.jsx(af,{data:[{value:t}],dataKey:"value",fill:qk[e.colorTemplate].backgroundColor,animationDuration:0,innerRadius:"55%",outerRadius:"100%",stroke:"none"}),he.jsx(af,{data:[{value:e.value}],dataKey:"value",fill:qk[e.colorTemplate].mainColor,innerRadius:"55%",animationDuration:Mme,outerRadius:"100%",startAngle:xC,stroke:"none",endAngle:xC+(Cme-xC)*e.value/e.maxValue})]})})})}const Ime="_power_193ch_1",Pme="_power__content_193ch_5",Rme="_content__icon_193ch_25",Dme="_icon_animation_193ch_30",Lme="_content__text_193ch_45",zme="_power__pieChart_193ch_53",H_={power:Ime,power__content:Pme,content__icon:Rme,icon_animation:Dme,content__text:Lme,power__pieChart:zme},kme="data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20clip-path='url(%23clip0_1_383)'%3e%3cpath%20d='M17.1268%200.102663C17.2736%200.18777%2017.3872%200.320148%2017.4491%200.478169C17.5109%200.63619%2017.5173%200.810514%2017.4673%200.972663L14.7658%209.75066H19.7503C19.8968%209.7506%2020.0401%209.79344%2020.1625%209.87389C20.2849%209.95434%2020.3811%2010.0689%2020.4392%2010.2034C20.4972%2010.3378%2020.5146%2010.4864%2020.4893%2010.6306C20.4639%2010.7749%2020.3968%2010.9086%2020.2963%2011.0152L8.2963%2023.7652C8.18019%2023.8886%208.02568%2023.9691%207.85796%2023.9935C7.69024%2024.018%207.51919%2023.9848%207.3727%2023.8996C7.22622%2023.8143%207.11292%2023.682%207.05129%2023.5241C6.98965%2023.3662%206.98331%2023.1921%207.0333%2023.0302L9.7348%2014.2507H4.7503C4.60382%2014.2507%204.46052%2014.2079%204.33811%2014.1274C4.21569%2014.047%204.11951%2013.9325%204.06145%2013.798C4.00338%2013.6635%203.98596%2013.5149%204.01135%2013.3707C4.03674%2013.2264%204.10381%2013.0927%204.2043%2012.9862L16.2043%200.236163C16.3203%200.112861%2016.4745%200.0324155%2016.642%200.00790543C16.8095%20-0.0166046%2016.9804%200.0162624%2017.1268%200.101163V0.102663Z'%20fill='%2305A6BE'/%3e%3c/g%3e%3cdefs%3e%3cclipPath%20id='clip0_1_383'%3e%3crect%20width='24'%20height='24'%20fill='white'/%3e%3c/clipPath%3e%3c/defs%3e%3c/svg%3e";function Bme(e){return he.jsxs("div",{className:H_.power,children:[he.jsxs("div",{className:H_.power__content,children:[he.jsx("img",{className:`${H_.content__icon} ${e.showAnimation?H_.icon_animation:""} `,src:kme}),e.power!==0&&he.jsxs("span",{className:H_.content__text,children:[e.power.toFixed(2)," кВт"]})]}),he.jsx(Ome,{value:e.power,maxValue:e.maxPower,colorTemplate:"blue",className:H_.power__pieChart})]})}const Nme="_content_1mfk4_1",Fme="_content__connector_1mfk4_14",jme="_connector__icon_1mfk4_31",Ume="_connector__type_1mfk4_36",Vme="_content__details_1mfk4_41",$me="_details__station_1mfk4_57",qme="_station__info_1mfk4_80",Gme="_info__name_1mfk4_94",Hme="_info__address_1mfk4_107",Zme="_details__tariffs_1mfk4_116",Wme="_tariffs__title_1mfk4_130",Xme="_data__item_1mfk4_145",Yme="_tariffs__data_1mfk4_158",Zl={content:Nme,content__connector:Fme,connector__icon:jme,connector__type:Ume,content__details:Vme,details__station:$me,station__info:qme,info__name:Gme,info__address:Hme,details__tariffs:Zme,tariffs__title:Wme,data__item:Xme,tariffs__data:Yme};function Kme(e){var a;const t=yo();return he.jsxs(Ro,{className:Zl.content,children:[he.jsxs("div",{className:Zl.content__connector,children:[he.jsx("img",{className:Zl.connector__icon,src:C1[e.connectorInfo.standard],alt:e.connectorInfo.standard}),he.jsx("p",{className:Zl.connector__type,children:e.connectorInfo.standard})]}),he.jsxs("div",{className:Zl.content__details,children:[he.jsxs("div",{className:Zl.details__station,children:[he.jsxs("div",{className:Zl.station__info,children:[he.jsx("p",{className:Zl.info__name,children:e.connectorInfo.station_name}),he.jsx("p",{className:Zl.info__address,children:e.connectorInfo.station_address})]}),he.jsx(Jl,{variant:"icon",onClick:()=>t(A1+e.connectorInfo.station_id+hl([{key:Td.PREVIOUS_PAGE,value:xd.ACTIVE_SESSION},{key:Td.FROM_CHARGING_SESSION_ID,value:e.sessionId}])),iconSrc:G7})]}),!!((a=e.tariffs)!=null&&a.length)&&he.jsxs("div",{className:Zl.details__tariffs,children:[he.jsxs("p",{className:Zl.tariffs__title,children:[he.jsx("img",{src:N5})," Используемые тарифы:"]}),he.jsx("div",{className:Zl.tariffs__data,children:e.tariffs.map((s,f)=>{const v=B7[s.type];return he.jsx("p",{className:Zl.data__item,children:`${s.price} ${s.currency}${v?"/"+v:""}`},f)})})]})]})]})}function Jme(e){const t=yo(),{showSnackbar:a,setLastStoppedChargingSessionId:s}=Me.useContext(Va),{stopChargingSessionFromApi:f}=nu(),[v,S]=Me.useState(!1),i=e.chargingSession.end_date===void 0?kx(b5(new Date),e.chargingSession.start_date):kx(e.chargingSession.end_date,e.chargingSession.start_date);return he.jsxs(he.Fragment,{children:[he.jsx($v,{isOpen:v,onClose:()=>S(!1),children:he.jsx(Kb,{title:he.jsxs(he.Fragment,{children:["Хотите завершить ",he.jsx("br",{})," зарядную сессию?"]}),errorTitle:he.jsxs(he.Fragment,{children:["Не удалось завершить ",he.jsx("br",{})," зарядную сессию"]}),onConfirm:()=>f({id:e.chargingSession.id}),onSuccess:()=>{t(qp),a("success","Станция приняла запрос на завершение зарядки"),s(e.chargingSession.id)},onClose:()=>S(!1)})}),he.jsx(Bme,{power:e.chargingSession.current_power??0,maxPower:e.chargingSession.connector_info.max_electric_power??0,showAnimation:!0}),he.jsx("div",{className:s6.buttonBlock,children:he.jsx(Jl,{variant:"fill",onClick:()=>S(!0),text:"Завершить"})}),he.jsxs("div",{className:s6.info,children:[he.jsx(Kme,{sessionId:e.chargingSession.id,connectorInfo:e.chargingSession.connector_info,tariffs:e.chargingSession.tariffs}),he.jsx(ox,{title:"Заряд:",iconSrc:$7,items:[{description:"Заряжено:",value:`${e.chargingSession.charged_kwh.toFixed(2)} кВт·ч`},{description:"Процент батареи:",value:e.chargingSession.battery_percentage?`${e.chargingSession.battery_percentage.toFixed(2)} %`:"",checkVisible:av}]}),he.jsx(ox,{title:"Время и длительность:",iconSrc:q7,items:[{description:"Старт:",value:H8(e.chargingSession.start_date.hours,e.chargingSession.start_date.minutes,e.chargingSession.start_date.seconds)},{description:"Длительность:",value:Z8(i.hours,i.minutes,i.seconds)}]}),!!e.chargingSession.current_power&&he.jsx(ox,{title:"Мощность: ",iconSrc:TQ,items:[{description:"Максимальная:",value:e.chargingSession.max_power?`${e.chargingSession.max_power.toFixed(2)} кВт`:"",checkVisible:av},{description:"Минимальная:",value:e.chargingSession.min_power?`${e.chargingSession.min_power.toFixed(2)} кВт`:"",checkVisible:av},{description:"Текущая:",value:e.chargingSession.current_power?`${e.chargingSession.current_power.toFixed(2)} кВт`:"",checkVisible:av},{description:"Средняя:",value:e.chargingSession.min_power&&e.chargingSession.max_power?`${((e.chargingSession.max_power+e.chargingSession.min_power)/2).toFixed(2)} кВт`:"",checkVisible:av}]}),e.chargingSession.total_cost!==void 0&&he.jsx(ox,{title:"Итоговая стоимость:",iconSrc:N5,items:[{description:"Сумма:",value:e.chargingSession.total_cost+" руб"}]})]})]})}const Qme=()=>{const[e]=Db(),[t,a]=Me.useState({});return Me.useEffect(()=>{const s=e.get(Bv.PREVIOUS_PAGE);a({prev_page:s})},[e]),{pageQueries:t}},e0e=(e,t,a)=>{const[s,f]=Me.useState(),[v,S]=Me.useState(!1);return Me.useEffect(()=>{clearInterval(s),f(v?setInterval(()=>e(),t):void 0)},[v].concat(a)),Me.useEffect(()=>()=>{clearInterval(s)},[s]),{activate:()=>S(!0),deactivate:()=>S(!1)}},$F=()=>{const{getChargingSessionByIdFromApi:e,getChargingSessionsFromApi:t}=nu(),{lastStoppedChargingSessionId:a}=Me.useContext(Va),[s,f]=Me.useState(!1),[v,S]=Me.useState(),[i,O]=Me.useState(!!v),z=()=>{v||t({status:Ux.CHARGING}).then(Y=>{Y.length>0&&S(Y[0])}).finally(()=>{f(!1),O(!0)})},j=()=>{v&&e({id:v.id}).then(Y=>{S(Ux.CHARGING===(Y==null?void 0:Y.status)?Y:void 0)}).finally(()=>{f(!1),O(!0)})},{activate:F}=e0e(()=>{f(!0),v?j():z()},5e3,[v,s]);Me.useEffect(()=>{z(),F()},[]);const G=v&&v.id===a;return{initialized:i,activeSession:G?void 0:v}};function t0e(){const e=yo(),{setLastStoppedChargingSessionId:t}=Me.useContext(Va),{pageQueries:a}=Qme(),{initialized:s,activeSession:f}=$F();Me.useEffect(()=>{t(void 0)},[]);const v=()=>{switch(a.prev_page){case Nv.SESSIONS_LIST:return qp}return"/"};return!f&&s?he.jsx(zV,{to:qp,replace:!0}):he.jsx(Pd,{onReturn:()=>e(v()),title:"Зарядная сессия",loading:!s,children:he.jsx(Jme,{chargingSession:f})})}var Dx={exports:{}},n0e=Dx.exports,Gk;function r0e(){return Gk||(Gk=1,function(e,t){(function(a,s){e.exports=s()})(n0e,function(){var a,s,f;function v(i,O){if(!a)a=O;else if(!s)s=O;else{var z="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+a+")(sharedChunk); ("+s+")(sharedChunk); self.onerror = null;",j={};a(j),f=O(j),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(f.workerUrl=window.URL.createObjectURL(new Blob([z],{type:"text/javascript"})))}}v(["exports"],function(i){function O(c){return c&&c.__esModule&&Object.prototype.hasOwnProperty.call(c,"default")?c.default:c}var z,j={},F={};function G(){if(z)return F;z=1,Object.defineProperty(F,"__esModule",{value:!0}),F.setMatrixArrayType=function(_){F.ARRAY_TYPE=n=_},F.toRadian=function(_){return _*u},F.equals=function(_,d){return Math.abs(_-d)<=c*Math.max(1,Math.abs(_),Math.abs(d))},F.RANDOM=F.ARRAY_TYPE=F.EPSILON=void 0;var c=1e-6;F.EPSILON=c;var n=typeof Float32Array<"u"?Float32Array:Array;F.ARRAY_TYPE=n;var o=Math.random;F.RANDOM=o;var u=Math.PI/180;return Math.hypot||(Math.hypot=function(){for(var _=0,d=arguments.length;d--;)_+=arguments[d]*arguments[d];return Math.sqrt(_)}),F}var Y,X={};function K(){if(Y)return X;function c(d){return c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(y){return typeof y}:function(y){return y&&typeof Symbol=="function"&&y.constructor===Symbol&&y!==Symbol.prototype?"symbol":typeof y},c(d)}Y=1,Object.defineProperty(X,"__esModule",{value:!0}),X.create=function(){var d=new n.ARRAY_TYPE(4);return n.ARRAY_TYPE!=Float32Array&&(d[1]=0,d[2]=0),d[0]=1,d[3]=1,d},X.clone=function(d){var y=new n.ARRAY_TYPE(4);return y[0]=d[0],y[1]=d[1],y[2]=d[2],y[3]=d[3],y},X.copy=function(d,y){return d[0]=y[0],d[1]=y[1],d[2]=y[2],d[3]=y[3],d},X.identity=function(d){return d[0]=1,d[1]=0,d[2]=0,d[3]=1,d},X.fromValues=function(d,y,E,M){var k=new n.ARRAY_TYPE(4);return k[0]=d,k[1]=y,k[2]=E,k[3]=M,k},X.set=function(d,y,E,M,k){return d[0]=y,d[1]=E,d[2]=M,d[3]=k,d},X.transpose=function(d,y){if(d===y){var E=y[1];d[1]=y[2],d[2]=E}else d[0]=y[0],d[1]=y[2],d[2]=y[1],d[3]=y[3];return d},X.invert=function(d,y){var E=y[0],M=y[1],k=y[2],w=y[3],I=E*w-k*M;return I?(d[0]=w*(I=1/I),d[1]=-M*I,d[2]=-k*I,d[3]=E*I,d):null},X.adjoint=function(d,y){var E=y[0];return d[0]=y[3],d[1]=-y[1],d[2]=-y[2],d[3]=E,d},X.determinant=function(d){return d[0]*d[3]-d[2]*d[1]},X.multiply=u,X.rotate=function(d,y,E){var M=y[0],k=y[1],w=y[2],I=y[3],D=Math.sin(E),C=Math.cos(E);return d[0]=M*C+w*D,d[1]=k*C+I*D,d[2]=M*-D+w*C,d[3]=k*-D+I*C,d},X.scale=function(d,y,E){var M=y[1],k=y[2],w=y[3],I=E[0],D=E[1];return d[0]=y[0]*I,d[1]=M*I,d[2]=k*D,d[3]=w*D,d},X.fromRotation=function(d,y){var E=Math.sin(y),M=Math.cos(y);return d[0]=M,d[1]=E,d[2]=-E,d[3]=M,d},X.fromScaling=function(d,y){return d[0]=y[0],d[1]=0,d[2]=0,d[3]=y[1],d},X.str=function(d){return"mat2("+d[0]+", "+d[1]+", "+d[2]+", "+d[3]+")"},X.frob=function(d){return Math.hypot(d[0],d[1],d[2],d[3])},X.LDU=function(d,y,E,M){return d[2]=M[2]/M[0],E[0]=M[0],E[1]=M[1],E[3]=M[3]-d[2]*E[1],[d,y,E]},X.add=function(d,y,E){return d[0]=y[0]+E[0],d[1]=y[1]+E[1],d[2]=y[2]+E[2],d[3]=y[3]+E[3],d},X.subtract=_,X.exactEquals=function(d,y){return d[0]===y[0]&&d[1]===y[1]&&d[2]===y[2]&&d[3]===y[3]},X.equals=function(d,y){var E=d[0],M=d[1],k=d[2],w=d[3],I=y[0],D=y[1],C=y[2],P=y[3];return Math.abs(E-I)<=n.EPSILON*Math.max(1,Math.abs(E),Math.abs(I))&&Math.abs(M-D)<=n.EPSILON*Math.max(1,Math.abs(M),Math.abs(D))&&Math.abs(k-C)<=n.EPSILON*Math.max(1,Math.abs(k),Math.abs(C))&&Math.abs(w-P)<=n.EPSILON*Math.max(1,Math.abs(w),Math.abs(P))},X.multiplyScalar=function(d,y,E){return d[0]=y[0]*E,d[1]=y[1]*E,d[2]=y[2]*E,d[3]=y[3]*E,d},X.multiplyScalarAndAdd=function(d,y,E,M){return d[0]=y[0]+E[0]*M,d[1]=y[1]+E[1]*M,d[2]=y[2]+E[2]*M,d[3]=y[3]+E[3]*M,d},X.sub=X.mul=void 0;var n=function(d,y){if(d&&d.__esModule)return d;if(d===null||c(d)!=="object"&&typeof d!="function")return{default:d};var E=o(void 0);if(E&&E.has(d))return E.get(d);var M={},k=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var w in d)if(w!=="default"&&Object.prototype.hasOwnProperty.call(d,w)){var I=k?Object.getOwnPropertyDescriptor(d,w):null;I&&(I.get||I.set)?Object.defineProperty(M,w,I):M[w]=d[w]}return M.default=d,E&&E.set(d,M),M}(G());function o(d){if(typeof WeakMap!="function")return null;var y=new WeakMap,E=new WeakMap;return(o=function(M){return M?E:y})(d)}function u(d,y,E){var M=y[0],k=y[1],w=y[2],I=y[3],D=E[0],C=E[1],P=E[2],B=E[3];return d[0]=M*D+w*C,d[1]=k*D+I*C,d[2]=M*P+w*B,d[3]=k*P+I*B,d}function _(d,y,E){return d[0]=y[0]-E[0],d[1]=y[1]-E[1],d[2]=y[2]-E[2],d[3]=y[3]-E[3],d}return X.mul=u,X.sub=_,X}var ne,se={};function ge(){if(ne)return se;function c(d){return c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(y){return typeof y}:function(y){return y&&typeof Symbol=="function"&&y.constructor===Symbol&&y!==Symbol.prototype?"symbol":typeof y},c(d)}ne=1,Object.defineProperty(se,"__esModule",{value:!0}),se.create=function(){var d=new n.ARRAY_TYPE(6);return n.ARRAY_TYPE!=Float32Array&&(d[1]=0,d[2]=0,d[4]=0,d[5]=0),d[0]=1,d[3]=1,d},se.clone=function(d){var y=new n.ARRAY_TYPE(6);return y[0]=d[0],y[1]=d[1],y[2]=d[2],y[3]=d[3],y[4]=d[4],y[5]=d[5],y},se.copy=function(d,y){return d[0]=y[0],d[1]=y[1],d[2]=y[2],d[3]=y[3],d[4]=y[4],d[5]=y[5],d},se.identity=function(d){return d[0]=1,d[1]=0,d[2]=0,d[3]=1,d[4]=0,d[5]=0,d},se.fromValues=function(d,y,E,M,k,w){var I=new n.ARRAY_TYPE(6);return I[0]=d,I[1]=y,I[2]=E,I[3]=M,I[4]=k,I[5]=w,I},se.set=function(d,y,E,M,k,w,I){return d[0]=y,d[1]=E,d[2]=M,d[3]=k,d[4]=w,d[5]=I,d},se.invert=function(d,y){var E=y[0],M=y[1],k=y[2],w=y[3],I=y[4],D=y[5],C=E*w-M*k;return C?(d[0]=w*(C=1/C),d[1]=-M*C,d[2]=-k*C,d[3]=E*C,d[4]=(k*D-w*I)*C,d[5]=(M*I-E*D)*C,d):null},se.determinant=function(d){return d[0]*d[3]-d[1]*d[2]},se.multiply=u,se.rotate=function(d,y,E){var M=y[0],k=y[1],w=y[2],I=y[3],D=y[4],C=y[5],P=Math.sin(E),B=Math.cos(E);return d[0]=M*B+w*P,d[1]=k*B+I*P,d[2]=M*-P+w*B,d[3]=k*-P+I*B,d[4]=D,d[5]=C,d},se.scale=function(d,y,E){var M=y[1],k=y[2],w=y[3],I=y[4],D=y[5],C=E[0],P=E[1];return d[0]=y[0]*C,d[1]=M*C,d[2]=k*P,d[3]=w*P,d[4]=I,d[5]=D,d},se.translate=function(d,y,E){var M=y[0],k=y[1],w=y[2],I=y[3],D=y[4],C=y[5],P=E[0],B=E[1];return d[0]=M,d[1]=k,d[2]=w,d[3]=I,d[4]=M*P+w*B+D,d[5]=k*P+I*B+C,d},se.fromRotation=function(d,y){var E=Math.sin(y),M=Math.cos(y);return d[0]=M,d[1]=E,d[2]=-E,d[3]=M,d[4]=0,d[5]=0,d},se.fromScaling=function(d,y){return d[0]=y[0],d[1]=0,d[2]=0,d[3]=y[1],d[4]=0,d[5]=0,d},se.fromTranslation=function(d,y){return d[0]=1,d[1]=0,d[2]=0,d[3]=1,d[4]=y[0],d[5]=y[1],d},se.str=function(d){return"mat2d("+d[0]+", "+d[1]+", "+d[2]+", "+d[3]+", "+d[4]+", "+d[5]+")"},se.frob=function(d){return Math.hypot(d[0],d[1],d[2],d[3],d[4],d[5],1)},se.add=function(d,y,E){return d[0]=y[0]+E[0],d[1]=y[1]+E[1],d[2]=y[2]+E[2],d[3]=y[3]+E[3],d[4]=y[4]+E[4],d[5]=y[5]+E[5],d},se.subtract=_,se.multiplyScalar=function(d,y,E){return d[0]=y[0]*E,d[1]=y[1]*E,d[2]=y[2]*E,d[3]=y[3]*E,d[4]=y[4]*E,d[5]=y[5]*E,d},se.multiplyScalarAndAdd=function(d,y,E,M){return d[0]=y[0]+E[0]*M,d[1]=y[1]+E[1]*M,d[2]=y[2]+E[2]*M,d[3]=y[3]+E[3]*M,d[4]=y[4]+E[4]*M,d[5]=y[5]+E[5]*M,d},se.exactEquals=function(d,y){return d[0]===y[0]&&d[1]===y[1]&&d[2]===y[2]&&d[3]===y[3]&&d[4]===y[4]&&d[5]===y[5]},se.equals=function(d,y){var E=d[0],M=d[1],k=d[2],w=d[3],I=d[4],D=d[5],C=y[0],P=y[1],B=y[2],q=y[3],H=y[4],te=y[5];return Math.abs(E-C)<=n.EPSILON*Math.max(1,Math.abs(E),Math.abs(C))&&Math.abs(M-P)<=n.EPSILON*Math.max(1,Math.abs(M),Math.abs(P))&&Math.abs(k-B)<=n.EPSILON*Math.max(1,Math.abs(k),Math.abs(B))&&Math.abs(w-q)<=n.EPSILON*Math.max(1,Math.abs(w),Math.abs(q))&&Math.abs(I-H)<=n.EPSILON*Math.max(1,Math.abs(I),Math.abs(H))&&Math.abs(D-te)<=n.EPSILON*Math.max(1,Math.abs(D),Math.abs(te))},se.sub=se.mul=void 0;var n=function(d,y){if(d&&d.__esModule)return d;if(d===null||c(d)!=="object"&&typeof d!="function")return{default:d};var E=o(void 0);if(E&&E.has(d))return E.get(d);var M={},k=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var w in d)if(w!=="default"&&Object.prototype.hasOwnProperty.call(d,w)){var I=k?Object.getOwnPropertyDescriptor(d,w):null;I&&(I.get||I.set)?Object.defineProperty(M,w,I):M[w]=d[w]}return M.default=d,E&&E.set(d,M),M}(G());function o(d){if(typeof WeakMap!="function")return null;var y=new WeakMap,E=new WeakMap;return(o=function(M){return M?E:y})(d)}function u(d,y,E){var M=y[0],k=y[1],w=y[2],I=y[3],D=y[4],C=y[5],P=E[0],B=E[1],q=E[2],H=E[3],te=E[4],re=E[5];return d[0]=M*P+w*B,d[1]=k*P+I*B,d[2]=M*q+w*H,d[3]=k*q+I*H,d[4]=M*te+w*re+D,d[5]=k*te+I*re+C,d}function _(d,y,E){return d[0]=y[0]-E[0],d[1]=y[1]-E[1],d[2]=y[2]-E[2],d[3]=y[3]-E[3],d[4]=y[4]-E[4],d[5]=y[5]-E[5],d}return se.mul=u,se.sub=_,se}var _e,xe={};function ae(){if(_e)return xe;function c(d){return c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(y){return typeof y}:function(y){return y&&typeof Symbol=="function"&&y.constructor===Symbol&&y!==Symbol.prototype?"symbol":typeof y},c(d)}_e=1,Object.defineProperty(xe,"__esModule",{value:!0}),xe.create=function(){var d=new n.ARRAY_TYPE(9);return n.ARRAY_TYPE!=Float32Array&&(d[1]=0,d[2]=0,d[3]=0,d[5]=0,d[6]=0,d[7]=0),d[0]=1,d[4]=1,d[8]=1,d},xe.fromMat4=function(d,y){return d[0]=y[0],d[1]=y[1],d[2]=y[2],d[3]=y[4],d[4]=y[5],d[5]=y[6],d[6]=y[8],d[7]=y[9],d[8]=y[10],d},xe.clone=function(d){var y=new n.ARRAY_TYPE(9);return y[0]=d[0],y[1]=d[1],y[2]=d[2],y[3]=d[3],y[4]=d[4],y[5]=d[5],y[6]=d[6],y[7]=d[7],y[8]=d[8],y},xe.copy=function(d,y){return d[0]=y[0],d[1]=y[1],d[2]=y[2],d[3]=y[3],d[4]=y[4],d[5]=y[5],d[6]=y[6],d[7]=y[7],d[8]=y[8],d},xe.fromValues=function(d,y,E,M,k,w,I,D,C){var P=new n.ARRAY_TYPE(9);return P[0]=d,P[1]=y,P[2]=E,P[3]=M,P[4]=k,P[5]=w,P[6]=I,P[7]=D,P[8]=C,P},xe.set=function(d,y,E,M,k,w,I,D,C,P){return d[0]=y,d[1]=E,d[2]=M,d[3]=k,d[4]=w,d[5]=I,d[6]=D,d[7]=C,d[8]=P,d},xe.identity=function(d){return d[0]=1,d[1]=0,d[2]=0,d[3]=0,d[4]=1,d[5]=0,d[6]=0,d[7]=0,d[8]=1,d},xe.transpose=function(d,y){if(d===y){var E=y[1],M=y[2],k=y[5];d[1]=y[3],d[2]=y[6],d[3]=E,d[5]=y[7],d[6]=M,d[7]=k}else d[0]=y[0],d[1]=y[3],d[2]=y[6],d[3]=y[1],d[4]=y[4],d[5]=y[7],d[6]=y[2],d[7]=y[5],d[8]=y[8];return d},xe.invert=function(d,y){var E=y[0],M=y[1],k=y[2],w=y[3],I=y[4],D=y[5],C=y[6],P=y[7],B=y[8],q=B*I-D*P,H=-B*w+D*C,te=P*w-I*C,re=E*q+M*H+k*te;return re?(d[0]=q*(re=1/re),d[1]=(-B*M+k*P)*re,d[2]=(D*M-k*I)*re,d[3]=H*re,d[4]=(B*E-k*C)*re,d[5]=(-D*E+k*w)*re,d[6]=te*re,d[7]=(-P*E+M*C)*re,d[8]=(I*E-M*w)*re,d):null},xe.adjoint=function(d,y){var E=y[0],M=y[1],k=y[2],w=y[3],I=y[4],D=y[5],C=y[6],P=y[7],B=y[8];return d[0]=I*B-D*P,d[1]=k*P-M*B,d[2]=M*D-k*I,d[3]=D*C-w*B,d[4]=E*B-k*C,d[5]=k*w-E*D,d[6]=w*P-I*C,d[7]=M*C-E*P,d[8]=E*I-M*w,d},xe.determinant=function(d){var y=d[3],E=d[4],M=d[5],k=d[6],w=d[7],I=d[8];return d[0]*(I*E-M*w)+d[1]*(-I*y+M*k)+d[2]*(w*y-E*k)},xe.multiply=u,xe.translate=function(d,y,E){var M=y[0],k=y[1],w=y[2],I=y[3],D=y[4],C=y[5],P=y[6],B=y[7],q=y[8],H=E[0],te=E[1];return d[0]=M,d[1]=k,d[2]=w,d[3]=I,d[4]=D,d[5]=C,d[6]=H*M+te*I+P,d[7]=H*k+te*D+B,d[8]=H*w+te*C+q,d},xe.rotate=function(d,y,E){var M=y[0],k=y[1],w=y[2],I=y[3],D=y[4],C=y[5],P=y[6],B=y[7],q=y[8],H=Math.sin(E),te=Math.cos(E);return d[0]=te*M+H*I,d[1]=te*k+H*D,d[2]=te*w+H*C,d[3]=te*I-H*M,d[4]=te*D-H*k,d[5]=te*C-H*w,d[6]=P,d[7]=B,d[8]=q,d},xe.scale=function(d,y,E){var M=E[0],k=E[1];return d[0]=M*y[0],d[1]=M*y[1],d[2]=M*y[2],d[3]=k*y[3],d[4]=k*y[4],d[5]=k*y[5],d[6]=y[6],d[7]=y[7],d[8]=y[8],d},xe.fromTranslation=function(d,y){return d[0]=1,d[1]=0,d[2]=0,d[3]=0,d[4]=1,d[5]=0,d[6]=y[0],d[7]=y[1],d[8]=1,d},xe.fromRotation=function(d,y){var E=Math.sin(y),M=Math.cos(y);return d[0]=M,d[1]=E,d[2]=0,d[3]=-E,d[4]=M,d[5]=0,d[6]=0,d[7]=0,d[8]=1,d},xe.fromScaling=function(d,y){return d[0]=y[0],d[1]=0,d[2]=0,d[3]=0,d[4]=y[1],d[5]=0,d[6]=0,d[7]=0,d[8]=1,d},xe.fromMat2d=function(d,y){return d[0]=y[0],d[1]=y[1],d[2]=0,d[3]=y[2],d[4]=y[3],d[5]=0,d[6]=y[4],d[7]=y[5],d[8]=1,d},xe.fromQuat=function(d,y){var E=y[0],M=y[1],k=y[2],w=y[3],I=E+E,D=M+M,C=k+k,P=E*I,B=M*I,q=M*D,H=k*I,te=k*D,re=k*C,J=w*I,ie=w*D,ce=w*C;return d[0]=1-q-re,d[3]=B-ce,d[6]=H+ie,d[1]=B+ce,d[4]=1-P-re,d[7]=te-J,d[2]=H-ie,d[5]=te+J,d[8]=1-P-q,d},xe.normalFromMat4=function(d,y){var E=y[0],M=y[1],k=y[2],w=y[3],I=y[4],D=y[5],C=y[6],P=y[7],B=y[8],q=y[9],H=y[10],te=y[11],re=y[12],J=y[13],ie=y[14],ce=y[15],me=E*D-M*I,Ce=E*C-k*I,Ae=E*P-w*I,Ee=M*C-k*D,Ue=M*P-w*D,Ie=k*P-w*C,Ve=B*J-q*re,Ze=B*ie-H*re,qe=B*ce-te*re,Ke=q*ie-H*J,Qe=q*ce-te*J,at=H*ce-te*ie,Je=me*at-Ce*Qe+Ae*Ke+Ee*qe-Ue*Ze+Ie*Ve;return Je?(d[0]=(D*at-C*Qe+P*Ke)*(Je=1/Je),d[1]=(C*qe-I*at-P*Ze)*Je,d[2]=(I*Qe-D*qe+P*Ve)*Je,d[3]=(k*Qe-M*at-w*Ke)*Je,d[4]=(E*at-k*qe+w*Ze)*Je,d[5]=(M*qe-E*Qe-w*Ve)*Je,d[6]=(J*Ie-ie*Ue+ce*Ee)*Je,d[7]=(ie*Ae-re*Ie-ce*Ce)*Je,d[8]=(re*Ue-J*Ae+ce*me)*Je,d):null},xe.projection=function(d,y,E){return d[0]=2/y,d[1]=0,d[2]=0,d[3]=0,d[4]=-2/E,d[5]=0,d[6]=-1,d[7]=1,d[8]=1,d},xe.str=function(d){return"mat3("+d[0]+", "+d[1]+", "+d[2]+", "+d[3]+", "+d[4]+", "+d[5]+", "+d[6]+", "+d[7]+", "+d[8]+")"},xe.frob=function(d){return Math.hypot(d[0],d[1],d[2],d[3],d[4],d[5],d[6],d[7],d[8])},xe.add=function(d,y,E){return d[0]=y[0]+E[0],d[1]=y[1]+E[1],d[2]=y[2]+E[2],d[3]=y[3]+E[3],d[4]=y[4]+E[4],d[5]=y[5]+E[5],d[6]=y[6]+E[6],d[7]=y[7]+E[7],d[8]=y[8]+E[8],d},xe.subtract=_,xe.multiplyScalar=function(d,y,E){return d[0]=y[0]*E,d[1]=y[1]*E,d[2]=y[2]*E,d[3]=y[3]*E,d[4]=y[4]*E,d[5]=y[5]*E,d[6]=y[6]*E,d[7]=y[7]*E,d[8]=y[8]*E,d},xe.multiplyScalarAndAdd=function(d,y,E,M){return d[0]=y[0]+E[0]*M,d[1]=y[1]+E[1]*M,d[2]=y[2]+E[2]*M,d[3]=y[3]+E[3]*M,d[4]=y[4]+E[4]*M,d[5]=y[5]+E[5]*M,d[6]=y[6]+E[6]*M,d[7]=y[7]+E[7]*M,d[8]=y[8]+E[8]*M,d},xe.exactEquals=function(d,y){return d[0]===y[0]&&d[1]===y[1]&&d[2]===y[2]&&d[3]===y[3]&&d[4]===y[4]&&d[5]===y[5]&&d[6]===y[6]&&d[7]===y[7]&&d[8]===y[8]},xe.equals=function(d,y){var E=d[0],M=d[1],k=d[2],w=d[3],I=d[4],D=d[5],C=d[6],P=d[7],B=d[8],q=y[0],H=y[1],te=y[2],re=y[3],J=y[4],ie=y[5],ce=y[6],me=y[7],Ce=y[8];return Math.abs(E-q)<=n.EPSILON*Math.max(1,Math.abs(E),Math.abs(q))&&Math.abs(M-H)<=n.EPSILON*Math.max(1,Math.abs(M),Math.abs(H))&&Math.abs(k-te)<=n.EPSILON*Math.max(1,Math.abs(k),Math.abs(te))&&Math.abs(w-re)<=n.EPSILON*Math.max(1,Math.abs(w),Math.abs(re))&&Math.abs(I-J)<=n.EPSILON*Math.max(1,Math.abs(I),Math.abs(J))&&Math.abs(D-ie)<=n.EPSILON*Math.max(1,Math.abs(D),Math.abs(ie))&&Math.abs(C-ce)<=n.EPSILON*Math.max(1,Math.abs(C),Math.abs(ce))&&Math.abs(P-me)<=n.EPSILON*Math.max(1,Math.abs(P),Math.abs(me))&&Math.abs(B-Ce)<=n.EPSILON*Math.max(1,Math.abs(B),Math.abs(Ce))},xe.sub=xe.mul=void 0;var n=function(d,y){if(d&&d.__esModule)return d;if(d===null||c(d)!=="object"&&typeof d!="function")return{default:d};var E=o(void 0);if(E&&E.has(d))return E.get(d);var M={},k=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var w in d)if(w!=="default"&&Object.prototype.hasOwnProperty.call(d,w)){var I=k?Object.getOwnPropertyDescriptor(d,w):null;I&&(I.get||I.set)?Object.defineProperty(M,w,I):M[w]=d[w]}return M.default=d,E&&E.set(d,M),M}(G());function o(d){if(typeof WeakMap!="function")return null;var y=new WeakMap,E=new WeakMap;return(o=function(M){return M?E:y})(d)}function u(d,y,E){var M=y[0],k=y[1],w=y[2],I=y[3],D=y[4],C=y[5],P=y[6],B=y[7],q=y[8],H=E[0],te=E[1],re=E[2],J=E[3],ie=E[4],ce=E[5],me=E[6],Ce=E[7],Ae=E[8];return d[0]=H*M+te*I+re*P,d[1]=H*k+te*D+re*B,d[2]=H*w+te*C+re*q,d[3]=J*M+ie*I+ce*P,d[4]=J*k+ie*D+ce*B,d[5]=J*w+ie*C+ce*q,d[6]=me*M+Ce*I+Ae*P,d[7]=me*k+Ce*D+Ae*B,d[8]=me*w+Ce*C+Ae*q,d}function _(d,y,E){return d[0]=y[0]-E[0],d[1]=y[1]-E[1],d[2]=y[2]-E[2],d[3]=y[3]-E[3],d[4]=y[4]-E[4],d[5]=y[5]-E[5],d[6]=y[6]-E[6],d[7]=y[7]-E[7],d[8]=y[8]-E[8],d}return xe.mul=u,xe.sub=_,xe}var ve,Se={};function He(){if(ve)return Se;function c(w){return c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(I){return typeof I}:function(I){return I&&typeof Symbol=="function"&&I.constructor===Symbol&&I!==Symbol.prototype?"symbol":typeof I},c(w)}ve=1,Object.defineProperty(Se,"__esModule",{value:!0}),Se.create=function(){var w=new n.ARRAY_TYPE(16);return n.ARRAY_TYPE!=Float32Array&&(w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[11]=0,w[12]=0,w[13]=0,w[14]=0),w[0]=1,w[5]=1,w[10]=1,w[15]=1,w},Se.clone=function(w){var I=new n.ARRAY_TYPE(16);return I[0]=w[0],I[1]=w[1],I[2]=w[2],I[3]=w[3],I[4]=w[4],I[5]=w[5],I[6]=w[6],I[7]=w[7],I[8]=w[8],I[9]=w[9],I[10]=w[10],I[11]=w[11],I[12]=w[12],I[13]=w[13],I[14]=w[14],I[15]=w[15],I},Se.copy=function(w,I){return w[0]=I[0],w[1]=I[1],w[2]=I[2],w[3]=I[3],w[4]=I[4],w[5]=I[5],w[6]=I[6],w[7]=I[7],w[8]=I[8],w[9]=I[9],w[10]=I[10],w[11]=I[11],w[12]=I[12],w[13]=I[13],w[14]=I[14],w[15]=I[15],w},Se.fromValues=function(w,I,D,C,P,B,q,H,te,re,J,ie,ce,me,Ce,Ae){var Ee=new n.ARRAY_TYPE(16);return Ee[0]=w,Ee[1]=I,Ee[2]=D,Ee[3]=C,Ee[4]=P,Ee[5]=B,Ee[6]=q,Ee[7]=H,Ee[8]=te,Ee[9]=re,Ee[10]=J,Ee[11]=ie,Ee[12]=ce,Ee[13]=me,Ee[14]=Ce,Ee[15]=Ae,Ee},Se.set=function(w,I,D,C,P,B,q,H,te,re,J,ie,ce,me,Ce,Ae,Ee){return w[0]=I,w[1]=D,w[2]=C,w[3]=P,w[4]=B,w[5]=q,w[6]=H,w[7]=te,w[8]=re,w[9]=J,w[10]=ie,w[11]=ce,w[12]=me,w[13]=Ce,w[14]=Ae,w[15]=Ee,w},Se.identity=u,Se.transpose=function(w,I){if(w===I){var D=I[1],C=I[2],P=I[3],B=I[6],q=I[7],H=I[11];w[1]=I[4],w[2]=I[8],w[3]=I[12],w[4]=D,w[6]=I[9],w[7]=I[13],w[8]=C,w[9]=B,w[11]=I[14],w[12]=P,w[13]=q,w[14]=H}else w[0]=I[0],w[1]=I[4],w[2]=I[8],w[3]=I[12],w[4]=I[1],w[5]=I[5],w[6]=I[9],w[7]=I[13],w[8]=I[2],w[9]=I[6],w[10]=I[10],w[11]=I[14],w[12]=I[3],w[13]=I[7],w[14]=I[11],w[15]=I[15];return w},Se.invert=function(w,I){var D=I[0],C=I[1],P=I[2],B=I[3],q=I[4],H=I[5],te=I[6],re=I[7],J=I[8],ie=I[9],ce=I[10],me=I[11],Ce=I[12],Ae=I[13],Ee=I[14],Ue=I[15],Ie=D*H-C*q,Ve=D*te-P*q,Ze=D*re-B*q,qe=C*te-P*H,Ke=C*re-B*H,Qe=P*re-B*te,at=J*Ae-ie*Ce,Je=J*Ee-ce*Ce,wt=J*Ue-me*Ce,Rt=ie*Ee-ce*Ae,bt=ie*Ue-me*Ae,an=ce*Ue-me*Ee,Jt=Ie*an-Ve*bt+Ze*Rt+qe*wt-Ke*Je+Qe*at;return Jt?(w[0]=(H*an-te*bt+re*Rt)*(Jt=1/Jt),w[1]=(P*bt-C*an-B*Rt)*Jt,w[2]=(Ae*Qe-Ee*Ke+Ue*qe)*Jt,w[3]=(ce*Ke-ie*Qe-me*qe)*Jt,w[4]=(te*wt-q*an-re*Je)*Jt,w[5]=(D*an-P*wt+B*Je)*Jt,w[6]=(Ee*Ze-Ce*Qe-Ue*Ve)*Jt,w[7]=(J*Qe-ce*Ze+me*Ve)*Jt,w[8]=(q*bt-H*wt+re*at)*Jt,w[9]=(C*wt-D*bt-B*at)*Jt,w[10]=(Ce*Ke-Ae*Ze+Ue*Ie)*Jt,w[11]=(ie*Ze-J*Ke-me*Ie)*Jt,w[12]=(H*Je-q*Rt-te*at)*Jt,w[13]=(D*Rt-C*Je+P*at)*Jt,w[14]=(Ae*Ve-Ce*qe-Ee*Ie)*Jt,w[15]=(J*qe-ie*Ve+ce*Ie)*Jt,w):null},Se.adjoint=function(w,I){var D=I[0],C=I[1],P=I[2],B=I[3],q=I[4],H=I[5],te=I[6],re=I[7],J=I[8],ie=I[9],ce=I[10],me=I[11],Ce=I[12],Ae=I[13],Ee=I[14],Ue=I[15];return w[0]=H*(ce*Ue-me*Ee)-ie*(te*Ue-re*Ee)+Ae*(te*me-re*ce),w[1]=-(C*(ce*Ue-me*Ee)-ie*(P*Ue-B*Ee)+Ae*(P*me-B*ce)),w[2]=C*(te*Ue-re*Ee)-H*(P*Ue-B*Ee)+Ae*(P*re-B*te),w[3]=-(C*(te*me-re*ce)-H*(P*me-B*ce)+ie*(P*re-B*te)),w[4]=-(q*(ce*Ue-me*Ee)-J*(te*Ue-re*Ee)+Ce*(te*me-re*ce)),w[5]=D*(ce*Ue-me*Ee)-J*(P*Ue-B*Ee)+Ce*(P*me-B*ce),w[6]=-(D*(te*Ue-re*Ee)-q*(P*Ue-B*Ee)+Ce*(P*re-B*te)),w[7]=D*(te*me-re*ce)-q*(P*me-B*ce)+J*(P*re-B*te),w[8]=q*(ie*Ue-me*Ae)-J*(H*Ue-re*Ae)+Ce*(H*me-re*ie),w[9]=-(D*(ie*Ue-me*Ae)-J*(C*Ue-B*Ae)+Ce*(C*me-B*ie)),w[10]=D*(H*Ue-re*Ae)-q*(C*Ue-B*Ae)+Ce*(C*re-B*H),w[11]=-(D*(H*me-re*ie)-q*(C*me-B*ie)+J*(C*re-B*H)),w[12]=-(q*(ie*Ee-ce*Ae)-J*(H*Ee-te*Ae)+Ce*(H*ce-te*ie)),w[13]=D*(ie*Ee-ce*Ae)-J*(C*Ee-P*Ae)+Ce*(C*ce-P*ie),w[14]=-(D*(H*Ee-te*Ae)-q*(C*Ee-P*Ae)+Ce*(C*te-P*H)),w[15]=D*(H*ce-te*ie)-q*(C*ce-P*ie)+J*(C*te-P*H),w},Se.determinant=function(w){var I=w[0],D=w[1],C=w[2],P=w[3],B=w[4],q=w[5],H=w[6],te=w[7],re=w[8],J=w[9],ie=w[10],ce=w[11],me=w[12],Ce=w[13],Ae=w[14],Ee=w[15];return(I*q-D*B)*(ie*Ee-ce*Ae)-(I*H-C*B)*(J*Ee-ce*Ce)+(I*te-P*B)*(J*Ae-ie*Ce)+(D*H-C*q)*(re*Ee-ce*me)-(D*te-P*q)*(re*Ae-ie*me)+(C*te-P*H)*(re*Ce-J*me)},Se.multiply=_,Se.translate=function(w,I,D){var C,P,B,q,H,te,re,J,ie,ce,me,Ce,Ae=D[0],Ee=D[1],Ue=D[2];return I===w?(w[12]=I[0]*Ae+I[4]*Ee+I[8]*Ue+I[12],w[13]=I[1]*Ae+I[5]*Ee+I[9]*Ue+I[13],w[14]=I[2]*Ae+I[6]*Ee+I[10]*Ue+I[14],w[15]=I[3]*Ae+I[7]*Ee+I[11]*Ue+I[15]):(P=I[1],B=I[2],q=I[3],H=I[4],te=I[5],re=I[6],J=I[7],ie=I[8],ce=I[9],me=I[10],Ce=I[11],w[0]=C=I[0],w[1]=P,w[2]=B,w[3]=q,w[4]=H,w[5]=te,w[6]=re,w[7]=J,w[8]=ie,w[9]=ce,w[10]=me,w[11]=Ce,w[12]=C*Ae+H*Ee+ie*Ue+I[12],w[13]=P*Ae+te*Ee+ce*Ue+I[13],w[14]=B*Ae+re*Ee+me*Ue+I[14],w[15]=q*Ae+J*Ee+Ce*Ue+I[15]),w},Se.scale=function(w,I,D){var C=D[0],P=D[1],B=D[2];return w[0]=I[0]*C,w[1]=I[1]*C,w[2]=I[2]*C,w[3]=I[3]*C,w[4]=I[4]*P,w[5]=I[5]*P,w[6]=I[6]*P,w[7]=I[7]*P,w[8]=I[8]*B,w[9]=I[9]*B,w[10]=I[10]*B,w[11]=I[11]*B,w[12]=I[12],w[13]=I[13],w[14]=I[14],w[15]=I[15],w},Se.rotate=function(w,I,D,C){var P,B,q,H,te,re,J,ie,ce,me,Ce,Ae,Ee,Ue,Ie,Ve,Ze,qe,Ke,Qe,at,Je,wt,Rt,bt=C[0],an=C[1],Jt=C[2],Ut=Math.hypot(bt,an,Jt);return Ut<n.EPSILON?null:(bt*=Ut=1/Ut,an*=Ut,Jt*=Ut,P=Math.sin(D),B=Math.cos(D),te=I[1],re=I[2],J=I[3],ce=I[5],me=I[6],Ce=I[7],Ee=I[9],Ue=I[10],Ie=I[11],Ve=bt*bt*(q=1-B)+B,Ke=bt*an*q-Jt*P,Qe=an*an*q+B,at=Jt*an*q+bt*P,Je=bt*Jt*q+an*P,wt=an*Jt*q-bt*P,Rt=Jt*Jt*q+B,w[0]=(H=I[0])*Ve+(ie=I[4])*(Ze=an*bt*q+Jt*P)+(Ae=I[8])*(qe=Jt*bt*q-an*P),w[1]=te*Ve+ce*Ze+Ee*qe,w[2]=re*Ve+me*Ze+Ue*qe,w[3]=J*Ve+Ce*Ze+Ie*qe,w[4]=H*Ke+ie*Qe+Ae*at,w[5]=te*Ke+ce*Qe+Ee*at,w[6]=re*Ke+me*Qe+Ue*at,w[7]=J*Ke+Ce*Qe+Ie*at,w[8]=H*Je+ie*wt+Ae*Rt,w[9]=te*Je+ce*wt+Ee*Rt,w[10]=re*Je+me*wt+Ue*Rt,w[11]=J*Je+Ce*wt+Ie*Rt,I!==w&&(w[12]=I[12],w[13]=I[13],w[14]=I[14],w[15]=I[15]),w)},Se.rotateX=function(w,I,D){var C=Math.sin(D),P=Math.cos(D),B=I[4],q=I[5],H=I[6],te=I[7],re=I[8],J=I[9],ie=I[10],ce=I[11];return I!==w&&(w[0]=I[0],w[1]=I[1],w[2]=I[2],w[3]=I[3],w[12]=I[12],w[13]=I[13],w[14]=I[14],w[15]=I[15]),w[4]=B*P+re*C,w[5]=q*P+J*C,w[6]=H*P+ie*C,w[7]=te*P+ce*C,w[8]=re*P-B*C,w[9]=J*P-q*C,w[10]=ie*P-H*C,w[11]=ce*P-te*C,w},Se.rotateY=function(w,I,D){var C=Math.sin(D),P=Math.cos(D),B=I[0],q=I[1],H=I[2],te=I[3],re=I[8],J=I[9],ie=I[10],ce=I[11];return I!==w&&(w[4]=I[4],w[5]=I[5],w[6]=I[6],w[7]=I[7],w[12]=I[12],w[13]=I[13],w[14]=I[14],w[15]=I[15]),w[0]=B*P-re*C,w[1]=q*P-J*C,w[2]=H*P-ie*C,w[3]=te*P-ce*C,w[8]=B*C+re*P,w[9]=q*C+J*P,w[10]=H*C+ie*P,w[11]=te*C+ce*P,w},Se.rotateZ=function(w,I,D){var C=Math.sin(D),P=Math.cos(D),B=I[0],q=I[1],H=I[2],te=I[3],re=I[4],J=I[5],ie=I[6],ce=I[7];return I!==w&&(w[8]=I[8],w[9]=I[9],w[10]=I[10],w[11]=I[11],w[12]=I[12],w[13]=I[13],w[14]=I[14],w[15]=I[15]),w[0]=B*P+re*C,w[1]=q*P+J*C,w[2]=H*P+ie*C,w[3]=te*P+ce*C,w[4]=re*P-B*C,w[5]=J*P-q*C,w[6]=ie*P-H*C,w[7]=ce*P-te*C,w},Se.fromTranslation=function(w,I){return w[0]=1,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=1,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[10]=1,w[11]=0,w[12]=I[0],w[13]=I[1],w[14]=I[2],w[15]=1,w},Se.fromScaling=function(w,I){return w[0]=I[0],w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=I[1],w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[10]=I[2],w[11]=0,w[12]=0,w[13]=0,w[14]=0,w[15]=1,w},Se.fromRotation=function(w,I,D){var C,P,B,q=D[0],H=D[1],te=D[2],re=Math.hypot(q,H,te);return re<n.EPSILON?null:(q*=re=1/re,H*=re,te*=re,C=Math.sin(I),P=Math.cos(I),w[0]=q*q*(B=1-P)+P,w[1]=H*q*B+te*C,w[2]=te*q*B-H*C,w[3]=0,w[4]=q*H*B-te*C,w[5]=H*H*B+P,w[6]=te*H*B+q*C,w[7]=0,w[8]=q*te*B+H*C,w[9]=H*te*B-q*C,w[10]=te*te*B+P,w[11]=0,w[12]=0,w[13]=0,w[14]=0,w[15]=1,w)},Se.fromXRotation=function(w,I){var D=Math.sin(I),C=Math.cos(I);return w[0]=1,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=C,w[6]=D,w[7]=0,w[8]=0,w[9]=-D,w[10]=C,w[11]=0,w[12]=0,w[13]=0,w[14]=0,w[15]=1,w},Se.fromYRotation=function(w,I){var D=Math.sin(I),C=Math.cos(I);return w[0]=C,w[1]=0,w[2]=-D,w[3]=0,w[4]=0,w[5]=1,w[6]=0,w[7]=0,w[8]=D,w[9]=0,w[10]=C,w[11]=0,w[12]=0,w[13]=0,w[14]=0,w[15]=1,w},Se.fromZRotation=function(w,I){var D=Math.sin(I),C=Math.cos(I);return w[0]=C,w[1]=D,w[2]=0,w[3]=0,w[4]=-D,w[5]=C,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[10]=1,w[11]=0,w[12]=0,w[13]=0,w[14]=0,w[15]=1,w},Se.fromRotationTranslation=d,Se.fromQuat2=function(w,I){var D=new n.ARRAY_TYPE(3),C=-I[0],P=-I[1],B=-I[2],q=I[3],H=I[4],te=I[5],re=I[6],J=I[7],ie=C*C+P*P+B*B+q*q;return ie>0?(D[0]=2*(H*q+J*C+te*B-re*P)/ie,D[1]=2*(te*q+J*P+re*C-H*B)/ie,D[2]=2*(re*q+J*B+H*P-te*C)/ie):(D[0]=2*(H*q+J*C+te*B-re*P),D[1]=2*(te*q+J*P+re*C-H*B),D[2]=2*(re*q+J*B+H*P-te*C)),d(w,I,D),w},Se.getTranslation=function(w,I){return w[0]=I[12],w[1]=I[13],w[2]=I[14],w},Se.getScaling=y,Se.getRotation=function(w,I){var D=new n.ARRAY_TYPE(3);y(D,I);var C=1/D[0],P=1/D[1],B=1/D[2],q=I[0]*C,H=I[1]*P,te=I[2]*B,re=I[4]*C,J=I[5]*P,ie=I[6]*B,ce=I[8]*C,me=I[9]*P,Ce=I[10]*B,Ae=q+J+Ce,Ee=0;return Ae>0?(Ee=2*Math.sqrt(Ae+1),w[3]=.25*Ee,w[0]=(ie-me)/Ee,w[1]=(ce-te)/Ee,w[2]=(H-re)/Ee):q>J&&q>Ce?(Ee=2*Math.sqrt(1+q-J-Ce),w[3]=(ie-me)/Ee,w[0]=.25*Ee,w[1]=(H+re)/Ee,w[2]=(ce+te)/Ee):J>Ce?(Ee=2*Math.sqrt(1+J-q-Ce),w[3]=(ce-te)/Ee,w[0]=(H+re)/Ee,w[1]=.25*Ee,w[2]=(ie+me)/Ee):(Ee=2*Math.sqrt(1+Ce-q-J),w[3]=(H-re)/Ee,w[0]=(ce+te)/Ee,w[1]=(ie+me)/Ee,w[2]=.25*Ee),w},Se.fromRotationTranslationScale=function(w,I,D,C){var P=I[0],B=I[1],q=I[2],H=I[3],te=P+P,re=B+B,J=q+q,ie=P*te,ce=P*re,me=P*J,Ce=B*re,Ae=B*J,Ee=q*J,Ue=H*te,Ie=H*re,Ve=H*J,Ze=C[0],qe=C[1],Ke=C[2];return w[0]=(1-(Ce+Ee))*Ze,w[1]=(ce+Ve)*Ze,w[2]=(me-Ie)*Ze,w[3]=0,w[4]=(ce-Ve)*qe,w[5]=(1-(ie+Ee))*qe,w[6]=(Ae+Ue)*qe,w[7]=0,w[8]=(me+Ie)*Ke,w[9]=(Ae-Ue)*Ke,w[10]=(1-(ie+Ce))*Ke,w[11]=0,w[12]=D[0],w[13]=D[1],w[14]=D[2],w[15]=1,w},Se.fromRotationTranslationScaleOrigin=function(w,I,D,C,P){var B=I[0],q=I[1],H=I[2],te=I[3],re=B+B,J=q+q,ie=H+H,ce=B*re,me=B*J,Ce=B*ie,Ae=q*J,Ee=q*ie,Ue=H*ie,Ie=te*re,Ve=te*J,Ze=te*ie,qe=C[0],Ke=C[1],Qe=C[2],at=P[0],Je=P[1],wt=P[2],Rt=(1-(Ae+Ue))*qe,bt=(me+Ze)*qe,an=(Ce-Ve)*qe,Jt=(me-Ze)*Ke,Ut=(1-(ce+Ue))*Ke,zt=(Ee+Ie)*Ke,vn=(Ce+Ve)*Qe,ln=(Ee-Ie)*Qe,pn=(1-(ce+Ae))*Qe;return w[0]=Rt,w[1]=bt,w[2]=an,w[3]=0,w[4]=Jt,w[5]=Ut,w[6]=zt,w[7]=0,w[8]=vn,w[9]=ln,w[10]=pn,w[11]=0,w[12]=D[0]+at-(Rt*at+Jt*Je+vn*wt),w[13]=D[1]+Je-(bt*at+Ut*Je+ln*wt),w[14]=D[2]+wt-(an*at+zt*Je+pn*wt),w[15]=1,w},Se.fromQuat=function(w,I){var D=I[0],C=I[1],P=I[2],B=I[3],q=D+D,H=C+C,te=P+P,re=D*q,J=C*q,ie=C*H,ce=P*q,me=P*H,Ce=P*te,Ae=B*q,Ee=B*H,Ue=B*te;return w[0]=1-ie-Ce,w[1]=J+Ue,w[2]=ce-Ee,w[3]=0,w[4]=J-Ue,w[5]=1-re-Ce,w[6]=me+Ae,w[7]=0,w[8]=ce+Ee,w[9]=me-Ae,w[10]=1-re-ie,w[11]=0,w[12]=0,w[13]=0,w[14]=0,w[15]=1,w},Se.frustum=function(w,I,D,C,P,B,q){var H=1/(D-I),te=1/(P-C),re=1/(B-q);return w[0]=2*B*H,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=2*B*te,w[6]=0,w[7]=0,w[8]=(D+I)*H,w[9]=(P+C)*te,w[10]=(q+B)*re,w[11]=-1,w[12]=0,w[13]=0,w[14]=q*B*2*re,w[15]=0,w},Se.perspectiveNO=E,Se.perspectiveZO=function(w,I,D,C,P){var B,q=1/Math.tan(I/2);return w[0]=q/D,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=q,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[11]=-1,w[12]=0,w[13]=0,w[15]=0,P!=null&&P!==1/0?(w[10]=P*(B=1/(C-P)),w[14]=P*C*B):(w[10]=-1,w[14]=-C),w},Se.perspectiveFromFieldOfView=function(w,I,D,C){var P=Math.tan(I.upDegrees*Math.PI/180),B=Math.tan(I.downDegrees*Math.PI/180),q=Math.tan(I.leftDegrees*Math.PI/180),H=Math.tan(I.rightDegrees*Math.PI/180),te=2/(q+H),re=2/(P+B);return w[0]=te,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=re,w[6]=0,w[7]=0,w[8]=-(q-H)*te*.5,w[9]=(P-B)*re*.5,w[10]=C/(D-C),w[11]=-1,w[12]=0,w[13]=0,w[14]=C*D/(D-C),w[15]=0,w},Se.orthoNO=M,Se.orthoZO=function(w,I,D,C,P,B,q){var H=1/(I-D),te=1/(C-P),re=1/(B-q);return w[0]=-2*H,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=-2*te,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[10]=re,w[11]=0,w[12]=(I+D)*H,w[13]=(P+C)*te,w[14]=B*re,w[15]=1,w},Se.lookAt=function(w,I,D,C){var P,B,q,H,te,re,J,ie,ce,me,Ce=I[0],Ae=I[1],Ee=I[2],Ue=C[0],Ie=C[1],Ve=C[2],Ze=D[0],qe=D[1],Ke=D[2];return Math.abs(Ce-Ze)<n.EPSILON&&Math.abs(Ae-qe)<n.EPSILON&&Math.abs(Ee-Ke)<n.EPSILON?u(w):(J=Ce-Ze,ie=Ae-qe,ce=Ee-Ke,P=Ie*(ce*=me=1/Math.hypot(J,ie,ce))-Ve*(ie*=me),B=Ve*(J*=me)-Ue*ce,q=Ue*ie-Ie*J,(me=Math.hypot(P,B,q))?(P*=me=1/me,B*=me,q*=me):(P=0,B=0,q=0),H=ie*q-ce*B,te=ce*P-J*q,re=J*B-ie*P,(me=Math.hypot(H,te,re))?(H*=me=1/me,te*=me,re*=me):(H=0,te=0,re=0),w[0]=P,w[1]=H,w[2]=J,w[3]=0,w[4]=B,w[5]=te,w[6]=ie,w[7]=0,w[8]=q,w[9]=re,w[10]=ce,w[11]=0,w[12]=-(P*Ce+B*Ae+q*Ee),w[13]=-(H*Ce+te*Ae+re*Ee),w[14]=-(J*Ce+ie*Ae+ce*Ee),w[15]=1,w)},Se.targetTo=function(w,I,D,C){var P=I[0],B=I[1],q=I[2],H=C[0],te=C[1],re=C[2],J=P-D[0],ie=B-D[1],ce=q-D[2],me=J*J+ie*ie+ce*ce;me>0&&(J*=me=1/Math.sqrt(me),ie*=me,ce*=me);var Ce=te*ce-re*ie,Ae=re*J-H*ce,Ee=H*ie-te*J;return(me=Ce*Ce+Ae*Ae+Ee*Ee)>0&&(Ce*=me=1/Math.sqrt(me),Ae*=me,Ee*=me),w[0]=Ce,w[1]=Ae,w[2]=Ee,w[3]=0,w[4]=ie*Ee-ce*Ae,w[5]=ce*Ce-J*Ee,w[6]=J*Ae-ie*Ce,w[7]=0,w[8]=J,w[9]=ie,w[10]=ce,w[11]=0,w[12]=P,w[13]=B,w[14]=q,w[15]=1,w},Se.str=function(w){return"mat4("+w[0]+", "+w[1]+", "+w[2]+", "+w[3]+", "+w[4]+", "+w[5]+", "+w[6]+", "+w[7]+", "+w[8]+", "+w[9]+", "+w[10]+", "+w[11]+", "+w[12]+", "+w[13]+", "+w[14]+", "+w[15]+")"},Se.frob=function(w){return Math.hypot(w[0],w[1],w[2],w[3],w[4],w[5],w[6],w[7],w[8],w[9],w[10],w[11],w[12],w[13],w[14],w[15])},Se.add=function(w,I,D){return w[0]=I[0]+D[0],w[1]=I[1]+D[1],w[2]=I[2]+D[2],w[3]=I[3]+D[3],w[4]=I[4]+D[4],w[5]=I[5]+D[5],w[6]=I[6]+D[6],w[7]=I[7]+D[7],w[8]=I[8]+D[8],w[9]=I[9]+D[9],w[10]=I[10]+D[10],w[11]=I[11]+D[11],w[12]=I[12]+D[12],w[13]=I[13]+D[13],w[14]=I[14]+D[14],w[15]=I[15]+D[15],w},Se.subtract=k,Se.multiplyScalar=function(w,I,D){return w[0]=I[0]*D,w[1]=I[1]*D,w[2]=I[2]*D,w[3]=I[3]*D,w[4]=I[4]*D,w[5]=I[5]*D,w[6]=I[6]*D,w[7]=I[7]*D,w[8]=I[8]*D,w[9]=I[9]*D,w[10]=I[10]*D,w[11]=I[11]*D,w[12]=I[12]*D,w[13]=I[13]*D,w[14]=I[14]*D,w[15]=I[15]*D,w},Se.multiplyScalarAndAdd=function(w,I,D,C){return w[0]=I[0]+D[0]*C,w[1]=I[1]+D[1]*C,w[2]=I[2]+D[2]*C,w[3]=I[3]+D[3]*C,w[4]=I[4]+D[4]*C,w[5]=I[5]+D[5]*C,w[6]=I[6]+D[6]*C,w[7]=I[7]+D[7]*C,w[8]=I[8]+D[8]*C,w[9]=I[9]+D[9]*C,w[10]=I[10]+D[10]*C,w[11]=I[11]+D[11]*C,w[12]=I[12]+D[12]*C,w[13]=I[13]+D[13]*C,w[14]=I[14]+D[14]*C,w[15]=I[15]+D[15]*C,w},Se.exactEquals=function(w,I){return w[0]===I[0]&&w[1]===I[1]&&w[2]===I[2]&&w[3]===I[3]&&w[4]===I[4]&&w[5]===I[5]&&w[6]===I[6]&&w[7]===I[7]&&w[8]===I[8]&&w[9]===I[9]&&w[10]===I[10]&&w[11]===I[11]&&w[12]===I[12]&&w[13]===I[13]&&w[14]===I[14]&&w[15]===I[15]},Se.equals=function(w,I){var D=w[0],C=w[1],P=w[2],B=w[3],q=w[4],H=w[5],te=w[6],re=w[7],J=w[8],ie=w[9],ce=w[10],me=w[11],Ce=w[12],Ae=w[13],Ee=w[14],Ue=w[15],Ie=I[0],Ve=I[1],Ze=I[2],qe=I[3],Ke=I[4],Qe=I[5],at=I[6],Je=I[7],wt=I[8],Rt=I[9],bt=I[10],an=I[11],Jt=I[12],Ut=I[13],zt=I[14],vn=I[15];return Math.abs(D-Ie)<=n.EPSILON*Math.max(1,Math.abs(D),Math.abs(Ie))&&Math.abs(C-Ve)<=n.EPSILON*Math.max(1,Math.abs(C),Math.abs(Ve))&&Math.abs(P-Ze)<=n.EPSILON*Math.max(1,Math.abs(P),Math.abs(Ze))&&Math.abs(B-qe)<=n.EPSILON*Math.max(1,Math.abs(B),Math.abs(qe))&&Math.abs(q-Ke)<=n.EPSILON*Math.max(1,Math.abs(q),Math.abs(Ke))&&Math.abs(H-Qe)<=n.EPSILON*Math.max(1,Math.abs(H),Math.abs(Qe))&&Math.abs(te-at)<=n.EPSILON*Math.max(1,Math.abs(te),Math.abs(at))&&Math.abs(re-Je)<=n.EPSILON*Math.max(1,Math.abs(re),Math.abs(Je))&&Math.abs(J-wt)<=n.EPSILON*Math.max(1,Math.abs(J),Math.abs(wt))&&Math.abs(ie-Rt)<=n.EPSILON*Math.max(1,Math.abs(ie),Math.abs(Rt))&&Math.abs(ce-bt)<=n.EPSILON*Math.max(1,Math.abs(ce),Math.abs(bt))&&Math.abs(me-an)<=n.EPSILON*Math.max(1,Math.abs(me),Math.abs(an))&&Math.abs(Ce-Jt)<=n.EPSILON*Math.max(1,Math.abs(Ce),Math.abs(Jt))&&Math.abs(Ae-Ut)<=n.EPSILON*Math.max(1,Math.abs(Ae),Math.abs(Ut))&&Math.abs(Ee-zt)<=n.EPSILON*Math.max(1,Math.abs(Ee),Math.abs(zt))&&Math.abs(Ue-vn)<=n.EPSILON*Math.max(1,Math.abs(Ue),Math.abs(vn))},Se.sub=Se.mul=Se.ortho=Se.perspective=void 0;var n=function(w,I){if(w&&w.__esModule)return w;if(w===null||c(w)!=="object"&&typeof w!="function")return{default:w};var D=o(void 0);if(D&&D.has(w))return D.get(w);var C={},P=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var B in w)if(B!=="default"&&Object.prototype.hasOwnProperty.call(w,B)){var q=P?Object.getOwnPropertyDescriptor(w,B):null;q&&(q.get||q.set)?Object.defineProperty(C,B,q):C[B]=w[B]}return C.default=w,D&&D.set(w,C),C}(G());function o(w){if(typeof WeakMap!="function")return null;var I=new WeakMap,D=new WeakMap;return(o=function(C){return C?D:I})(w)}function u(w){return w[0]=1,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=1,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[10]=1,w[11]=0,w[12]=0,w[13]=0,w[14]=0,w[15]=1,w}function _(w,I,D){var C=I[0],P=I[1],B=I[2],q=I[3],H=I[4],te=I[5],re=I[6],J=I[7],ie=I[8],ce=I[9],me=I[10],Ce=I[11],Ae=I[12],Ee=I[13],Ue=I[14],Ie=I[15],Ve=D[0],Ze=D[1],qe=D[2],Ke=D[3];return w[0]=Ve*C+Ze*H+qe*ie+Ke*Ae,w[1]=Ve*P+Ze*te+qe*ce+Ke*Ee,w[2]=Ve*B+Ze*re+qe*me+Ke*Ue,w[3]=Ve*q+Ze*J+qe*Ce+Ke*Ie,w[4]=(Ve=D[4])*C+(Ze=D[5])*H+(qe=D[6])*ie+(Ke=D[7])*Ae,w[5]=Ve*P+Ze*te+qe*ce+Ke*Ee,w[6]=Ve*B+Ze*re+qe*me+Ke*Ue,w[7]=Ve*q+Ze*J+qe*Ce+Ke*Ie,w[8]=(Ve=D[8])*C+(Ze=D[9])*H+(qe=D[10])*ie+(Ke=D[11])*Ae,w[9]=Ve*P+Ze*te+qe*ce+Ke*Ee,w[10]=Ve*B+Ze*re+qe*me+Ke*Ue,w[11]=Ve*q+Ze*J+qe*Ce+Ke*Ie,w[12]=(Ve=D[12])*C+(Ze=D[13])*H+(qe=D[14])*ie+(Ke=D[15])*Ae,w[13]=Ve*P+Ze*te+qe*ce+Ke*Ee,w[14]=Ve*B+Ze*re+qe*me+Ke*Ue,w[15]=Ve*q+Ze*J+qe*Ce+Ke*Ie,w}function d(w,I,D){var C=I[0],P=I[1],B=I[2],q=I[3],H=C+C,te=P+P,re=B+B,J=C*H,ie=C*te,ce=C*re,me=P*te,Ce=P*re,Ae=B*re,Ee=q*H,Ue=q*te,Ie=q*re;return w[0]=1-(me+Ae),w[1]=ie+Ie,w[2]=ce-Ue,w[3]=0,w[4]=ie-Ie,w[5]=1-(J+Ae),w[6]=Ce+Ee,w[7]=0,w[8]=ce+Ue,w[9]=Ce-Ee,w[10]=1-(J+me),w[11]=0,w[12]=D[0],w[13]=D[1],w[14]=D[2],w[15]=1,w}function y(w,I){var D=I[4],C=I[5],P=I[6],B=I[8],q=I[9],H=I[10];return w[0]=Math.hypot(I[0],I[1],I[2]),w[1]=Math.hypot(D,C,P),w[2]=Math.hypot(B,q,H),w}function E(w,I,D,C,P){var B,q=1/Math.tan(I/2);return w[0]=q/D,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=q,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[11]=-1,w[12]=0,w[13]=0,w[15]=0,P!=null&&P!==1/0?(w[10]=(P+C)*(B=1/(C-P)),w[14]=2*P*C*B):(w[10]=-1,w[14]=-2*C),w}function M(w,I,D,C,P,B,q){var H=1/(I-D),te=1/(C-P),re=1/(B-q);return w[0]=-2*H,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=-2*te,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[10]=2*re,w[11]=0,w[12]=(I+D)*H,w[13]=(P+C)*te,w[14]=(q+B)*re,w[15]=1,w}function k(w,I,D){return w[0]=I[0]-D[0],w[1]=I[1]-D[1],w[2]=I[2]-D[2],w[3]=I[3]-D[3],w[4]=I[4]-D[4],w[5]=I[5]-D[5],w[6]=I[6]-D[6],w[7]=I[7]-D[7],w[8]=I[8]-D[8],w[9]=I[9]-D[9],w[10]=I[10]-D[10],w[11]=I[11]-D[11],w[12]=I[12]-D[12],w[13]=I[13]-D[13],w[14]=I[14]-D[14],w[15]=I[15]-D[15],w}return Se.perspective=E,Se.ortho=M,Se.mul=_,Se.sub=k,Se}var Ge,ye={},Le={};function ht(){if(Ge)return Le;function c(P){return c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(B){return typeof B}:function(B){return B&&typeof Symbol=="function"&&B.constructor===Symbol&&B!==Symbol.prototype?"symbol":typeof B},c(P)}Ge=1,Object.defineProperty(Le,"__esModule",{value:!0}),Le.create=u,Le.clone=function(P){var B=new n.ARRAY_TYPE(3);return B[0]=P[0],B[1]=P[1],B[2]=P[2],B},Le.length=_,Le.fromValues=function(P,B,q){var H=new n.ARRAY_TYPE(3);return H[0]=P,H[1]=B,H[2]=q,H},Le.copy=function(P,B){return P[0]=B[0],P[1]=B[1],P[2]=B[2],P},Le.set=function(P,B,q,H){return P[0]=B,P[1]=q,P[2]=H,P},Le.add=function(P,B,q){return P[0]=B[0]+q[0],P[1]=B[1]+q[1],P[2]=B[2]+q[2],P},Le.subtract=d,Le.multiply=y,Le.divide=E,Le.ceil=function(P,B){return P[0]=Math.ceil(B[0]),P[1]=Math.ceil(B[1]),P[2]=Math.ceil(B[2]),P},Le.floor=function(P,B){return P[0]=Math.floor(B[0]),P[1]=Math.floor(B[1]),P[2]=Math.floor(B[2]),P},Le.min=function(P,B,q){return P[0]=Math.min(B[0],q[0]),P[1]=Math.min(B[1],q[1]),P[2]=Math.min(B[2],q[2]),P},Le.max=function(P,B,q){return P[0]=Math.max(B[0],q[0]),P[1]=Math.max(B[1],q[1]),P[2]=Math.max(B[2],q[2]),P},Le.round=function(P,B){return P[0]=Math.round(B[0]),P[1]=Math.round(B[1]),P[2]=Math.round(B[2]),P},Le.scale=function(P,B,q){return P[0]=B[0]*q,P[1]=B[1]*q,P[2]=B[2]*q,P},Le.scaleAndAdd=function(P,B,q,H){return P[0]=B[0]+q[0]*H,P[1]=B[1]+q[1]*H,P[2]=B[2]+q[2]*H,P},Le.distance=M,Le.squaredDistance=k,Le.squaredLength=w,Le.negate=function(P,B){return P[0]=-B[0],P[1]=-B[1],P[2]=-B[2],P},Le.inverse=function(P,B){return P[0]=1/B[0],P[1]=1/B[1],P[2]=1/B[2],P},Le.normalize=function(P,B){var q=B[0],H=B[1],te=B[2],re=q*q+H*H+te*te;return re>0&&(re=1/Math.sqrt(re)),P[0]=B[0]*re,P[1]=B[1]*re,P[2]=B[2]*re,P},Le.dot=I,Le.cross=function(P,B,q){var H=B[0],te=B[1],re=B[2],J=q[0],ie=q[1],ce=q[2];return P[0]=te*ce-re*ie,P[1]=re*J-H*ce,P[2]=H*ie-te*J,P},Le.lerp=function(P,B,q,H){var te=B[0],re=B[1],J=B[2];return P[0]=te+H*(q[0]-te),P[1]=re+H*(q[1]-re),P[2]=J+H*(q[2]-J),P},Le.hermite=function(P,B,q,H,te,re){var J=re*re,ie=J*(2*re-3)+1,ce=J*(re-2)+re,me=J*(re-1),Ce=J*(3-2*re);return P[0]=B[0]*ie+q[0]*ce+H[0]*me+te[0]*Ce,P[1]=B[1]*ie+q[1]*ce+H[1]*me+te[1]*Ce,P[2]=B[2]*ie+q[2]*ce+H[2]*me+te[2]*Ce,P},Le.bezier=function(P,B,q,H,te,re){var J=1-re,ie=J*J,ce=re*re,me=ie*J,Ce=3*re*ie,Ae=3*ce*J,Ee=ce*re;return P[0]=B[0]*me+q[0]*Ce+H[0]*Ae+te[0]*Ee,P[1]=B[1]*me+q[1]*Ce+H[1]*Ae+te[1]*Ee,P[2]=B[2]*me+q[2]*Ce+H[2]*Ae+te[2]*Ee,P},Le.random=function(P,B){B=B||1;var q=2*n.RANDOM()*Math.PI,H=2*n.RANDOM()-1,te=Math.sqrt(1-H*H)*B;return P[0]=Math.cos(q)*te,P[1]=Math.sin(q)*te,P[2]=H*B,P},Le.transformMat4=function(P,B,q){var H=B[0],te=B[1],re=B[2],J=q[3]*H+q[7]*te+q[11]*re+q[15];return P[0]=(q[0]*H+q[4]*te+q[8]*re+q[12])/(J=J||1),P[1]=(q[1]*H+q[5]*te+q[9]*re+q[13])/J,P[2]=(q[2]*H+q[6]*te+q[10]*re+q[14])/J,P},Le.transformMat3=function(P,B,q){var H=B[0],te=B[1],re=B[2];return P[0]=H*q[0]+te*q[3]+re*q[6],P[1]=H*q[1]+te*q[4]+re*q[7],P[2]=H*q[2]+te*q[5]+re*q[8],P},Le.transformQuat=function(P,B,q){var H=q[0],te=q[1],re=q[2],J=B[0],ie=B[1],ce=B[2],me=te*ce-re*ie,Ce=re*J-H*ce,Ae=H*ie-te*J,Ee=te*Ae-re*Ce,Ue=re*me-H*Ae,Ie=H*Ce-te*me,Ve=2*q[3];return Ce*=Ve,Ae*=Ve,Ue*=2,Ie*=2,P[0]=J+(me*=Ve)+(Ee*=2),P[1]=ie+Ce+Ue,P[2]=ce+Ae+Ie,P},Le.rotateX=function(P,B,q,H){var te=[],re=[];return te[0]=B[0]-q[0],te[1]=B[1]-q[1],te[2]=B[2]-q[2],re[0]=te[0],re[1]=te[1]*Math.cos(H)-te[2]*Math.sin(H),re[2]=te[1]*Math.sin(H)+te[2]*Math.cos(H),P[0]=re[0]+q[0],P[1]=re[1]+q[1],P[2]=re[2]+q[2],P},Le.rotateY=function(P,B,q,H){var te=[],re=[];return te[0]=B[0]-q[0],te[1]=B[1]-q[1],te[2]=B[2]-q[2],re[0]=te[2]*Math.sin(H)+te[0]*Math.cos(H),re[1]=te[1],re[2]=te[2]*Math.cos(H)-te[0]*Math.sin(H),P[0]=re[0]+q[0],P[1]=re[1]+q[1],P[2]=re[2]+q[2],P},Le.rotateZ=function(P,B,q,H){var te=[],re=[];return te[0]=B[0]-q[0],te[1]=B[1]-q[1],te[2]=B[2]-q[2],re[0]=te[0]*Math.cos(H)-te[1]*Math.sin(H),re[1]=te[0]*Math.sin(H)+te[1]*Math.cos(H),re[2]=te[2],P[0]=re[0]+q[0],P[1]=re[1]+q[1],P[2]=re[2]+q[2],P},Le.angle=function(P,B){var q=P[0],H=P[1],te=P[2],re=B[0],J=B[1],ie=B[2],ce=Math.sqrt(q*q+H*H+te*te)*Math.sqrt(re*re+J*J+ie*ie),me=ce&&I(P,B)/ce;return Math.acos(Math.min(Math.max(me,-1),1))},Le.zero=function(P){return P[0]=0,P[1]=0,P[2]=0,P},Le.str=function(P){return"vec3("+P[0]+", "+P[1]+", "+P[2]+")"},Le.exactEquals=function(P,B){return P[0]===B[0]&&P[1]===B[1]&&P[2]===B[2]},Le.equals=function(P,B){var q=P[0],H=P[1],te=P[2],re=B[0],J=B[1],ie=B[2];return Math.abs(q-re)<=n.EPSILON*Math.max(1,Math.abs(q),Math.abs(re))&&Math.abs(H-J)<=n.EPSILON*Math.max(1,Math.abs(H),Math.abs(J))&&Math.abs(te-ie)<=n.EPSILON*Math.max(1,Math.abs(te),Math.abs(ie))},Le.forEach=Le.sqrLen=Le.len=Le.sqrDist=Le.dist=Le.div=Le.mul=Le.sub=void 0;var n=function(P,B){if(P&&P.__esModule)return P;if(P===null||c(P)!=="object"&&typeof P!="function")return{default:P};var q=o(void 0);if(q&&q.has(P))return q.get(P);var H={},te=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var re in P)if(re!=="default"&&Object.prototype.hasOwnProperty.call(P,re)){var J=te?Object.getOwnPropertyDescriptor(P,re):null;J&&(J.get||J.set)?Object.defineProperty(H,re,J):H[re]=P[re]}return H.default=P,q&&q.set(P,H),H}(G());function o(P){if(typeof WeakMap!="function")return null;var B=new WeakMap,q=new WeakMap;return(o=function(H){return H?q:B})(P)}function u(){var P=new n.ARRAY_TYPE(3);return n.ARRAY_TYPE!=Float32Array&&(P[0]=0,P[1]=0,P[2]=0),P}function _(P){return Math.hypot(P[0],P[1],P[2])}function d(P,B,q){return P[0]=B[0]-q[0],P[1]=B[1]-q[1],P[2]=B[2]-q[2],P}function y(P,B,q){return P[0]=B[0]*q[0],P[1]=B[1]*q[1],P[2]=B[2]*q[2],P}function E(P,B,q){return P[0]=B[0]/q[0],P[1]=B[1]/q[1],P[2]=B[2]/q[2],P}function M(P,B){return Math.hypot(B[0]-P[0],B[1]-P[1],B[2]-P[2])}function k(P,B){var q=B[0]-P[0],H=B[1]-P[1],te=B[2]-P[2];return q*q+H*H+te*te}function w(P){var B=P[0],q=P[1],H=P[2];return B*B+q*q+H*H}function I(P,B){return P[0]*B[0]+P[1]*B[1]+P[2]*B[2]}Le.sub=d,Le.mul=y,Le.div=E,Le.dist=M,Le.sqrDist=k,Le.len=_,Le.sqrLen=w;var D,C=(D=u(),function(P,B,q,H,te,re){var J,ie;for(B||(B=3),q||(q=0),ie=H?Math.min(H*B+q,P.length):P.length,J=q;J<ie;J+=B)D[0]=P[J],D[1]=P[J+1],D[2]=P[J+2],te(D,D,re),P[J]=D[0],P[J+1]=D[1],P[J+2]=D[2];return P});return Le.forEach=C,Le}var gt,Ft,_t={};function yt(){if(gt)return _t;function c(C){return c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(P){return typeof P}:function(P){return P&&typeof Symbol=="function"&&P.constructor===Symbol&&P!==Symbol.prototype?"symbol":typeof P},c(C)}gt=1,Object.defineProperty(_t,"__esModule",{value:!0}),_t.create=u,_t.clone=function(C){var P=new n.ARRAY_TYPE(4);return P[0]=C[0],P[1]=C[1],P[2]=C[2],P[3]=C[3],P},_t.fromValues=function(C,P,B,q){var H=new n.ARRAY_TYPE(4);return H[0]=C,H[1]=P,H[2]=B,H[3]=q,H},_t.copy=function(C,P){return C[0]=P[0],C[1]=P[1],C[2]=P[2],C[3]=P[3],C},_t.set=function(C,P,B,q,H){return C[0]=P,C[1]=B,C[2]=q,C[3]=H,C},_t.add=function(C,P,B){return C[0]=P[0]+B[0],C[1]=P[1]+B[1],C[2]=P[2]+B[2],C[3]=P[3]+B[3],C},_t.subtract=_,_t.multiply=d,_t.divide=y,_t.ceil=function(C,P){return C[0]=Math.ceil(P[0]),C[1]=Math.ceil(P[1]),C[2]=Math.ceil(P[2]),C[3]=Math.ceil(P[3]),C},_t.floor=function(C,P){return C[0]=Math.floor(P[0]),C[1]=Math.floor(P[1]),C[2]=Math.floor(P[2]),C[3]=Math.floor(P[3]),C},_t.min=function(C,P,B){return C[0]=Math.min(P[0],B[0]),C[1]=Math.min(P[1],B[1]),C[2]=Math.min(P[2],B[2]),C[3]=Math.min(P[3],B[3]),C},_t.max=function(C,P,B){return C[0]=Math.max(P[0],B[0]),C[1]=Math.max(P[1],B[1]),C[2]=Math.max(P[2],B[2]),C[3]=Math.max(P[3],B[3]),C},_t.round=function(C,P){return C[0]=Math.round(P[0]),C[1]=Math.round(P[1]),C[2]=Math.round(P[2]),C[3]=Math.round(P[3]),C},_t.scale=function(C,P,B){return C[0]=P[0]*B,C[1]=P[1]*B,C[2]=P[2]*B,C[3]=P[3]*B,C},_t.scaleAndAdd=function(C,P,B,q){return C[0]=P[0]+B[0]*q,C[1]=P[1]+B[1]*q,C[2]=P[2]+B[2]*q,C[3]=P[3]+B[3]*q,C},_t.distance=E,_t.squaredDistance=M,_t.length=k,_t.squaredLength=w,_t.negate=function(C,P){return C[0]=-P[0],C[1]=-P[1],C[2]=-P[2],C[3]=-P[3],C},_t.inverse=function(C,P){return C[0]=1/P[0],C[1]=1/P[1],C[2]=1/P[2],C[3]=1/P[3],C},_t.normalize=function(C,P){var B=P[0],q=P[1],H=P[2],te=P[3],re=B*B+q*q+H*H+te*te;return re>0&&(re=1/Math.sqrt(re)),C[0]=B*re,C[1]=q*re,C[2]=H*re,C[3]=te*re,C},_t.dot=function(C,P){return C[0]*P[0]+C[1]*P[1]+C[2]*P[2]+C[3]*P[3]},_t.cross=function(C,P,B,q){var H=B[0]*q[1]-B[1]*q[0],te=B[0]*q[2]-B[2]*q[0],re=B[0]*q[3]-B[3]*q[0],J=B[1]*q[2]-B[2]*q[1],ie=B[1]*q[3]-B[3]*q[1],ce=B[2]*q[3]-B[3]*q[2],me=P[0],Ce=P[1],Ae=P[2],Ee=P[3];return C[0]=Ce*ce-Ae*ie+Ee*J,C[1]=-me*ce+Ae*re-Ee*te,C[2]=me*ie-Ce*re+Ee*H,C[3]=-me*J+Ce*te-Ae*H,C},_t.lerp=function(C,P,B,q){var H=P[0],te=P[1],re=P[2],J=P[3];return C[0]=H+q*(B[0]-H),C[1]=te+q*(B[1]-te),C[2]=re+q*(B[2]-re),C[3]=J+q*(B[3]-J),C},_t.random=function(C,P){var B,q,H,te,re,J;P=P||1;do re=(B=2*n.RANDOM()-1)*B+(q=2*n.RANDOM()-1)*q;while(re>=1);do J=(H=2*n.RANDOM()-1)*H+(te=2*n.RANDOM()-1)*te;while(J>=1);var ie=Math.sqrt((1-re)/J);return C[0]=P*B,C[1]=P*q,C[2]=P*H*ie,C[3]=P*te*ie,C},_t.transformMat4=function(C,P,B){var q=P[0],H=P[1],te=P[2],re=P[3];return C[0]=B[0]*q+B[4]*H+B[8]*te+B[12]*re,C[1]=B[1]*q+B[5]*H+B[9]*te+B[13]*re,C[2]=B[2]*q+B[6]*H+B[10]*te+B[14]*re,C[3]=B[3]*q+B[7]*H+B[11]*te+B[15]*re,C},_t.transformQuat=function(C,P,B){var q=P[0],H=P[1],te=P[2],re=B[0],J=B[1],ie=B[2],ce=B[3],me=ce*q+J*te-ie*H,Ce=ce*H+ie*q-re*te,Ae=ce*te+re*H-J*q,Ee=-re*q-J*H-ie*te;return C[0]=me*ce+Ee*-re+Ce*-ie-Ae*-J,C[1]=Ce*ce+Ee*-J+Ae*-re-me*-ie,C[2]=Ae*ce+Ee*-ie+me*-J-Ce*-re,C[3]=P[3],C},_t.zero=function(C){return C[0]=0,C[1]=0,C[2]=0,C[3]=0,C},_t.str=function(C){return"vec4("+C[0]+", "+C[1]+", "+C[2]+", "+C[3]+")"},_t.exactEquals=function(C,P){return C[0]===P[0]&&C[1]===P[1]&&C[2]===P[2]&&C[3]===P[3]},_t.equals=function(C,P){var B=C[0],q=C[1],H=C[2],te=C[3],re=P[0],J=P[1],ie=P[2],ce=P[3];return Math.abs(B-re)<=n.EPSILON*Math.max(1,Math.abs(B),Math.abs(re))&&Math.abs(q-J)<=n.EPSILON*Math.max(1,Math.abs(q),Math.abs(J))&&Math.abs(H-ie)<=n.EPSILON*Math.max(1,Math.abs(H),Math.abs(ie))&&Math.abs(te-ce)<=n.EPSILON*Math.max(1,Math.abs(te),Math.abs(ce))},_t.forEach=_t.sqrLen=_t.len=_t.sqrDist=_t.dist=_t.div=_t.mul=_t.sub=void 0;var n=function(C,P){if(C&&C.__esModule)return C;if(C===null||c(C)!=="object"&&typeof C!="function")return{default:C};var B=o(void 0);if(B&&B.has(C))return B.get(C);var q={},H=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var te in C)if(te!=="default"&&Object.prototype.hasOwnProperty.call(C,te)){var re=H?Object.getOwnPropertyDescriptor(C,te):null;re&&(re.get||re.set)?Object.defineProperty(q,te,re):q[te]=C[te]}return q.default=C,B&&B.set(C,q),q}(G());function o(C){if(typeof WeakMap!="function")return null;var P=new WeakMap,B=new WeakMap;return(o=function(q){return q?B:P})(C)}function u(){var C=new n.ARRAY_TYPE(4);return n.ARRAY_TYPE!=Float32Array&&(C[0]=0,C[1]=0,C[2]=0,C[3]=0),C}function _(C,P,B){return C[0]=P[0]-B[0],C[1]=P[1]-B[1],C[2]=P[2]-B[2],C[3]=P[3]-B[3],C}function d(C,P,B){return C[0]=P[0]*B[0],C[1]=P[1]*B[1],C[2]=P[2]*B[2],C[3]=P[3]*B[3],C}function y(C,P,B){return C[0]=P[0]/B[0],C[1]=P[1]/B[1],C[2]=P[2]/B[2],C[3]=P[3]/B[3],C}function E(C,P){return Math.hypot(P[0]-C[0],P[1]-C[1],P[2]-C[2],P[3]-C[3])}function M(C,P){var B=P[0]-C[0],q=P[1]-C[1],H=P[2]-C[2],te=P[3]-C[3];return B*B+q*q+H*H+te*te}function k(C){return Math.hypot(C[0],C[1],C[2],C[3])}function w(C){var P=C[0],B=C[1],q=C[2],H=C[3];return P*P+B*B+q*q+H*H}_t.sub=_,_t.mul=d,_t.div=y,_t.dist=E,_t.sqrDist=M,_t.len=k,_t.sqrLen=w;var I,D=(I=u(),function(C,P,B,q,H,te){var re,J;for(P||(P=4),B||(B=0),J=q?Math.min(q*P+B,C.length):C.length,re=B;re<J;re+=P)I[0]=C[re],I[1]=C[re+1],I[2]=C[re+2],I[3]=C[re+3],H(I,I,te),C[re]=I[0],C[re+1]=I[1],C[re+2]=I[2],C[re+3]=I[3];return C});return _t.forEach=D,_t}function Vt(){if(Ft)return ye;function c(Ie){return c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Ve){return typeof Ve}:function(Ve){return Ve&&typeof Symbol=="function"&&Ve.constructor===Symbol&&Ve!==Symbol.prototype?"symbol":typeof Ve},c(Ie)}Ft=1,Object.defineProperty(ye,"__esModule",{value:!0}),ye.create=E,ye.identity=function(Ie){return Ie[0]=0,Ie[1]=0,Ie[2]=0,Ie[3]=1,Ie},ye.setAxisAngle=M,ye.getAxisAngle=function(Ie,Ve){var Ze=2*Math.acos(Ve[3]),qe=Math.sin(Ze/2);return qe>n.EPSILON?(Ie[0]=Ve[0]/qe,Ie[1]=Ve[1]/qe,Ie[2]=Ve[2]/qe):(Ie[0]=1,Ie[1]=0,Ie[2]=0),Ze},ye.getAngle=function(Ie,Ve){var Ze=B(Ie,Ve);return Math.acos(2*Ze*Ze-1)},ye.multiply=k,ye.rotateX=function(Ie,Ve,Ze){Ze*=.5;var qe=Ve[0],Ke=Ve[1],Qe=Ve[2],at=Ve[3],Je=Math.sin(Ze),wt=Math.cos(Ze);return Ie[0]=qe*wt+at*Je,Ie[1]=Ke*wt+Qe*Je,Ie[2]=Qe*wt-Ke*Je,Ie[3]=at*wt-qe*Je,Ie},ye.rotateY=function(Ie,Ve,Ze){Ze*=.5;var qe=Ve[0],Ke=Ve[1],Qe=Ve[2],at=Ve[3],Je=Math.sin(Ze),wt=Math.cos(Ze);return Ie[0]=qe*wt-Qe*Je,Ie[1]=Ke*wt+at*Je,Ie[2]=Qe*wt+qe*Je,Ie[3]=at*wt-Ke*Je,Ie},ye.rotateZ=function(Ie,Ve,Ze){Ze*=.5;var qe=Ve[0],Ke=Ve[1],Qe=Ve[2],at=Ve[3],Je=Math.sin(Ze),wt=Math.cos(Ze);return Ie[0]=qe*wt+Ke*Je,Ie[1]=Ke*wt-qe*Je,Ie[2]=Qe*wt+at*Je,Ie[3]=at*wt-Qe*Je,Ie},ye.calculateW=function(Ie,Ve){var Ze=Ve[0],qe=Ve[1],Ke=Ve[2];return Ie[0]=Ze,Ie[1]=qe,Ie[2]=Ke,Ie[3]=Math.sqrt(Math.abs(1-Ze*Ze-qe*qe-Ke*Ke)),Ie},ye.exp=w,ye.ln=I,ye.pow=function(Ie,Ve,Ze){return I(Ie,Ve),P(Ie,Ie,Ze),w(Ie,Ie),Ie},ye.slerp=D,ye.random=function(Ie){var Ve=n.RANDOM(),Ze=n.RANDOM(),qe=n.RANDOM(),Ke=Math.sqrt(1-Ve),Qe=Math.sqrt(Ve);return Ie[0]=Ke*Math.sin(2*Math.PI*Ze),Ie[1]=Ke*Math.cos(2*Math.PI*Ze),Ie[2]=Qe*Math.sin(2*Math.PI*qe),Ie[3]=Qe*Math.cos(2*Math.PI*qe),Ie},ye.invert=function(Ie,Ve){var Ze=Ve[0],qe=Ve[1],Ke=Ve[2],Qe=Ve[3],at=Ze*Ze+qe*qe+Ke*Ke+Qe*Qe,Je=at?1/at:0;return Ie[0]=-Ze*Je,Ie[1]=-qe*Je,Ie[2]=-Ke*Je,Ie[3]=Qe*Je,Ie},ye.conjugate=function(Ie,Ve){return Ie[0]=-Ve[0],Ie[1]=-Ve[1],Ie[2]=-Ve[2],Ie[3]=Ve[3],Ie},ye.fromMat3=C,ye.fromEuler=function(Ie,Ve,Ze,qe){var Ke=.5*Math.PI/180;Ve*=Ke,Ze*=Ke,qe*=Ke;var Qe=Math.sin(Ve),at=Math.cos(Ve),Je=Math.sin(Ze),wt=Math.cos(Ze),Rt=Math.sin(qe),bt=Math.cos(qe);return Ie[0]=Qe*wt*bt-at*Je*Rt,Ie[1]=at*Je*bt+Qe*wt*Rt,Ie[2]=at*wt*Rt-Qe*Je*bt,Ie[3]=at*wt*bt+Qe*Je*Rt,Ie},ye.str=function(Ie){return"quat("+Ie[0]+", "+Ie[1]+", "+Ie[2]+", "+Ie[3]+")"},ye.setAxes=ye.sqlerp=ye.rotationTo=ye.equals=ye.exactEquals=ye.normalize=ye.sqrLen=ye.squaredLength=ye.len=ye.length=ye.lerp=ye.dot=ye.scale=ye.mul=ye.add=ye.set=ye.copy=ye.fromValues=ye.clone=void 0;var n=y(G()),o=y(ae()),u=y(ht()),_=y(yt());function d(Ie){if(typeof WeakMap!="function")return null;var Ve=new WeakMap,Ze=new WeakMap;return(d=function(qe){return qe?Ze:Ve})(Ie)}function y(Ie,Ve){if(Ie&&Ie.__esModule)return Ie;if(Ie===null||c(Ie)!=="object"&&typeof Ie!="function")return{default:Ie};var Ze=d(Ve);if(Ze&&Ze.has(Ie))return Ze.get(Ie);var qe={},Ke=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var Qe in Ie)if(Qe!=="default"&&Object.prototype.hasOwnProperty.call(Ie,Qe)){var at=Ke?Object.getOwnPropertyDescriptor(Ie,Qe):null;at&&(at.get||at.set)?Object.defineProperty(qe,Qe,at):qe[Qe]=Ie[Qe]}return qe.default=Ie,Ze&&Ze.set(Ie,qe),qe}function E(){var Ie=new n.ARRAY_TYPE(4);return n.ARRAY_TYPE!=Float32Array&&(Ie[0]=0,Ie[1]=0,Ie[2]=0),Ie[3]=1,Ie}function M(Ie,Ve,Ze){Ze*=.5;var qe=Math.sin(Ze);return Ie[0]=qe*Ve[0],Ie[1]=qe*Ve[1],Ie[2]=qe*Ve[2],Ie[3]=Math.cos(Ze),Ie}function k(Ie,Ve,Ze){var qe=Ve[0],Ke=Ve[1],Qe=Ve[2],at=Ve[3],Je=Ze[0],wt=Ze[1],Rt=Ze[2],bt=Ze[3];return Ie[0]=qe*bt+at*Je+Ke*Rt-Qe*wt,Ie[1]=Ke*bt+at*wt+Qe*Je-qe*Rt,Ie[2]=Qe*bt+at*Rt+qe*wt-Ke*Je,Ie[3]=at*bt-qe*Je-Ke*wt-Qe*Rt,Ie}function w(Ie,Ve){var Ze=Ve[0],qe=Ve[1],Ke=Ve[2],Qe=Ve[3],at=Math.sqrt(Ze*Ze+qe*qe+Ke*Ke),Je=Math.exp(Qe),wt=at>0?Je*Math.sin(at)/at:0;return Ie[0]=Ze*wt,Ie[1]=qe*wt,Ie[2]=Ke*wt,Ie[3]=Je*Math.cos(at),Ie}function I(Ie,Ve){var Ze=Ve[0],qe=Ve[1],Ke=Ve[2],Qe=Ve[3],at=Math.sqrt(Ze*Ze+qe*qe+Ke*Ke),Je=at>0?Math.atan2(at,Qe)/at:0;return Ie[0]=Ze*Je,Ie[1]=qe*Je,Ie[2]=Ke*Je,Ie[3]=.5*Math.log(Ze*Ze+qe*qe+Ke*Ke+Qe*Qe),Ie}function D(Ie,Ve,Ze,qe){var Ke,Qe,at,Je,wt,Rt=Ve[0],bt=Ve[1],an=Ve[2],Jt=Ve[3],Ut=Ze[0],zt=Ze[1],vn=Ze[2],ln=Ze[3];return(Qe=Rt*Ut+bt*zt+an*vn+Jt*ln)<0&&(Qe=-Qe,Ut=-Ut,zt=-zt,vn=-vn,ln=-ln),1-Qe>n.EPSILON?(Ke=Math.acos(Qe),at=Math.sin(Ke),Je=Math.sin((1-qe)*Ke)/at,wt=Math.sin(qe*Ke)/at):(Je=1-qe,wt=qe),Ie[0]=Je*Rt+wt*Ut,Ie[1]=Je*bt+wt*zt,Ie[2]=Je*an+wt*vn,Ie[3]=Je*Jt+wt*ln,Ie}function C(Ie,Ve){var Ze,qe=Ve[0]+Ve[4]+Ve[8];if(qe>0)Ze=Math.sqrt(qe+1),Ie[3]=.5*Ze,Ie[0]=(Ve[5]-Ve[7])*(Ze=.5/Ze),Ie[1]=(Ve[6]-Ve[2])*Ze,Ie[2]=(Ve[1]-Ve[3])*Ze;else{var Ke=0;Ve[4]>Ve[0]&&(Ke=1),Ve[8]>Ve[3*Ke+Ke]&&(Ke=2);var Qe=(Ke+1)%3,at=(Ke+2)%3;Ze=Math.sqrt(Ve[3*Ke+Ke]-Ve[3*Qe+Qe]-Ve[3*at+at]+1),Ie[Ke]=.5*Ze,Ie[3]=(Ve[3*Qe+at]-Ve[3*at+Qe])*(Ze=.5/Ze),Ie[Qe]=(Ve[3*Qe+Ke]+Ve[3*Ke+Qe])*Ze,Ie[at]=(Ve[3*at+Ke]+Ve[3*Ke+at])*Ze}return Ie}ye.clone=_.clone,ye.fromValues=_.fromValues,ye.copy=_.copy,ye.set=_.set,ye.add=_.add,ye.mul=k;var P=_.scale;ye.scale=P;var B=_.dot;ye.dot=B,ye.lerp=_.lerp;var q=_.length;ye.length=q,ye.len=q;var H=_.squaredLength;ye.squaredLength=H,ye.sqrLen=H;var te=_.normalize;ye.normalize=te,ye.exactEquals=_.exactEquals,ye.equals=_.equals;var re,J,ie,ce=(re=u.create(),J=u.fromValues(1,0,0),ie=u.fromValues(0,1,0),function(Ie,Ve,Ze){var qe=u.dot(Ve,Ze);return qe<-.999999?(u.cross(re,J,Ve),u.len(re)<1e-6&&u.cross(re,ie,Ve),u.normalize(re,re),M(Ie,re,Math.PI),Ie):qe>.999999?(Ie[0]=0,Ie[1]=0,Ie[2]=0,Ie[3]=1,Ie):(u.cross(re,Ve,Ze),Ie[0]=re[0],Ie[1]=re[1],Ie[2]=re[2],Ie[3]=1+qe,te(Ie,Ie))});ye.rotationTo=ce;var me,Ce,Ae=(me=E(),Ce=E(),function(Ie,Ve,Ze,qe,Ke,Qe){return D(me,Ve,Ke,Qe),D(Ce,Ze,qe,Qe),D(Ie,me,Ce,2*Qe*(1-Qe)),Ie});ye.sqlerp=Ae;var Ee,Ue=(Ee=o.create(),function(Ie,Ve,Ze,qe){return Ee[0]=Ze[0],Ee[3]=Ze[1],Ee[6]=Ze[2],Ee[1]=qe[0],Ee[4]=qe[1],Ee[7]=qe[2],Ee[2]=-Ve[0],Ee[5]=-Ve[1],Ee[8]=-Ve[2],te(Ie,C(Ie,Ee))});return ye.setAxes=Ue,ye}var Ht,Bt={};function et(){if(Ht)return Bt;function c(D){return c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(C){return typeof C}:function(C){return C&&typeof Symbol=="function"&&C.constructor===Symbol&&C!==Symbol.prototype?"symbol":typeof C},c(D)}Ht=1,Object.defineProperty(Bt,"__esModule",{value:!0}),Bt.create=function(){var D=new n.ARRAY_TYPE(8);return n.ARRAY_TYPE!=Float32Array&&(D[0]=0,D[1]=0,D[2]=0,D[4]=0,D[5]=0,D[6]=0,D[7]=0),D[3]=1,D},Bt.clone=function(D){var C=new n.ARRAY_TYPE(8);return C[0]=D[0],C[1]=D[1],C[2]=D[2],C[3]=D[3],C[4]=D[4],C[5]=D[5],C[6]=D[6],C[7]=D[7],C},Bt.fromValues=function(D,C,P,B,q,H,te,re){var J=new n.ARRAY_TYPE(8);return J[0]=D,J[1]=C,J[2]=P,J[3]=B,J[4]=q,J[5]=H,J[6]=te,J[7]=re,J},Bt.fromRotationTranslationValues=function(D,C,P,B,q,H,te){var re=new n.ARRAY_TYPE(8);re[0]=D,re[1]=C,re[2]=P,re[3]=B;var J=.5*q,ie=.5*H,ce=.5*te;return re[4]=J*B+ie*P-ce*C,re[5]=ie*B+ce*D-J*P,re[6]=ce*B+J*C-ie*D,re[7]=-J*D-ie*C-ce*P,re},Bt.fromRotationTranslation=y,Bt.fromTranslation=function(D,C){return D[0]=0,D[1]=0,D[2]=0,D[3]=1,D[4]=.5*C[0],D[5]=.5*C[1],D[6]=.5*C[2],D[7]=0,D},Bt.fromRotation=function(D,C){return D[0]=C[0],D[1]=C[1],D[2]=C[2],D[3]=C[3],D[4]=0,D[5]=0,D[6]=0,D[7]=0,D},Bt.fromMat4=function(D,C){var P=o.create();u.getRotation(P,C);var B=new n.ARRAY_TYPE(3);return u.getTranslation(B,C),y(D,P,B),D},Bt.copy=E,Bt.identity=function(D){return D[0]=0,D[1]=0,D[2]=0,D[3]=1,D[4]=0,D[5]=0,D[6]=0,D[7]=0,D},Bt.set=function(D,C,P,B,q,H,te,re,J){return D[0]=C,D[1]=P,D[2]=B,D[3]=q,D[4]=H,D[5]=te,D[6]=re,D[7]=J,D},Bt.getDual=function(D,C){return D[0]=C[4],D[1]=C[5],D[2]=C[6],D[3]=C[7],D},Bt.setDual=function(D,C){return D[4]=C[0],D[5]=C[1],D[6]=C[2],D[7]=C[3],D},Bt.getTranslation=function(D,C){var P=C[4],B=C[5],q=C[6],H=C[7],te=-C[0],re=-C[1],J=-C[2],ie=C[3];return D[0]=2*(P*ie+H*te+B*J-q*re),D[1]=2*(B*ie+H*re+q*te-P*J),D[2]=2*(q*ie+H*J+P*re-B*te),D},Bt.translate=function(D,C,P){var B=C[0],q=C[1],H=C[2],te=C[3],re=.5*P[0],J=.5*P[1],ie=.5*P[2],ce=C[4],me=C[5],Ce=C[6],Ae=C[7];return D[0]=B,D[1]=q,D[2]=H,D[3]=te,D[4]=te*re+q*ie-H*J+ce,D[5]=te*J+H*re-B*ie+me,D[6]=te*ie+B*J-q*re+Ce,D[7]=-B*re-q*J-H*ie+Ae,D},Bt.rotateX=function(D,C,P){var B=-C[0],q=-C[1],H=-C[2],te=C[3],re=C[4],J=C[5],ie=C[6],ce=C[7],me=re*te+ce*B+J*H-ie*q,Ce=J*te+ce*q+ie*B-re*H,Ae=ie*te+ce*H+re*q-J*B,Ee=ce*te-re*B-J*q-ie*H;return o.rotateX(D,C,P),D[4]=me*(te=D[3])+Ee*(B=D[0])+Ce*(H=D[2])-Ae*(q=D[1]),D[5]=Ce*te+Ee*q+Ae*B-me*H,D[6]=Ae*te+Ee*H+me*q-Ce*B,D[7]=Ee*te-me*B-Ce*q-Ae*H,D},Bt.rotateY=function(D,C,P){var B=-C[0],q=-C[1],H=-C[2],te=C[3],re=C[4],J=C[5],ie=C[6],ce=C[7],me=re*te+ce*B+J*H-ie*q,Ce=J*te+ce*q+ie*B-re*H,Ae=ie*te+ce*H+re*q-J*B,Ee=ce*te-re*B-J*q-ie*H;return o.rotateY(D,C,P),D[4]=me*(te=D[3])+Ee*(B=D[0])+Ce*(H=D[2])-Ae*(q=D[1]),D[5]=Ce*te+Ee*q+Ae*B-me*H,D[6]=Ae*te+Ee*H+me*q-Ce*B,D[7]=Ee*te-me*B-Ce*q-Ae*H,D},Bt.rotateZ=function(D,C,P){var B=-C[0],q=-C[1],H=-C[2],te=C[3],re=C[4],J=C[5],ie=C[6],ce=C[7],me=re*te+ce*B+J*H-ie*q,Ce=J*te+ce*q+ie*B-re*H,Ae=ie*te+ce*H+re*q-J*B,Ee=ce*te-re*B-J*q-ie*H;return o.rotateZ(D,C,P),D[4]=me*(te=D[3])+Ee*(B=D[0])+Ce*(H=D[2])-Ae*(q=D[1]),D[5]=Ce*te+Ee*q+Ae*B-me*H,D[6]=Ae*te+Ee*H+me*q-Ce*B,D[7]=Ee*te-me*B-Ce*q-Ae*H,D},Bt.rotateByQuatAppend=function(D,C,P){var B=P[0],q=P[1],H=P[2],te=P[3],re=C[0],J=C[1],ie=C[2],ce=C[3];return D[0]=re*te+ce*B+J*H-ie*q,D[1]=J*te+ce*q+ie*B-re*H,D[2]=ie*te+ce*H+re*q-J*B,D[3]=ce*te-re*B-J*q-ie*H,D[4]=(re=C[4])*te+(ce=C[7])*B+(J=C[5])*H-(ie=C[6])*q,D[5]=J*te+ce*q+ie*B-re*H,D[6]=ie*te+ce*H+re*q-J*B,D[7]=ce*te-re*B-J*q-ie*H,D},Bt.rotateByQuatPrepend=function(D,C,P){var B=C[0],q=C[1],H=C[2],te=C[3],re=P[0],J=P[1],ie=P[2],ce=P[3];return D[0]=B*ce+te*re+q*ie-H*J,D[1]=q*ce+te*J+H*re-B*ie,D[2]=H*ce+te*ie+B*J-q*re,D[3]=te*ce-B*re-q*J-H*ie,D[4]=B*(ce=P[7])+te*(re=P[4])+q*(ie=P[6])-H*(J=P[5]),D[5]=q*ce+te*J+H*re-B*ie,D[6]=H*ce+te*ie+B*J-q*re,D[7]=te*ce-B*re-q*J-H*ie,D},Bt.rotateAroundAxis=function(D,C,P,B){if(Math.abs(B)<n.EPSILON)return E(D,C);var q=Math.hypot(P[0],P[1],P[2]);B*=.5;var H=Math.sin(B),te=H*P[0]/q,re=H*P[1]/q,J=H*P[2]/q,ie=Math.cos(B),ce=C[0],me=C[1],Ce=C[2],Ae=C[3];D[0]=ce*ie+Ae*te+me*J-Ce*re,D[1]=me*ie+Ae*re+Ce*te-ce*J,D[2]=Ce*ie+Ae*J+ce*re-me*te,D[3]=Ae*ie-ce*te-me*re-Ce*J;var Ee=C[4],Ue=C[5],Ie=C[6],Ve=C[7];return D[4]=Ee*ie+Ve*te+Ue*J-Ie*re,D[5]=Ue*ie+Ve*re+Ie*te-Ee*J,D[6]=Ie*ie+Ve*J+Ee*re-Ue*te,D[7]=Ve*ie-Ee*te-Ue*re-Ie*J,D},Bt.add=function(D,C,P){return D[0]=C[0]+P[0],D[1]=C[1]+P[1],D[2]=C[2]+P[2],D[3]=C[3]+P[3],D[4]=C[4]+P[4],D[5]=C[5]+P[5],D[6]=C[6]+P[6],D[7]=C[7]+P[7],D},Bt.multiply=M,Bt.scale=function(D,C,P){return D[0]=C[0]*P,D[1]=C[1]*P,D[2]=C[2]*P,D[3]=C[3]*P,D[4]=C[4]*P,D[5]=C[5]*P,D[6]=C[6]*P,D[7]=C[7]*P,D},Bt.lerp=function(D,C,P,B){var q=1-B;return k(C,P)<0&&(B=-B),D[0]=C[0]*q+P[0]*B,D[1]=C[1]*q+P[1]*B,D[2]=C[2]*q+P[2]*B,D[3]=C[3]*q+P[3]*B,D[4]=C[4]*q+P[4]*B,D[5]=C[5]*q+P[5]*B,D[6]=C[6]*q+P[6]*B,D[7]=C[7]*q+P[7]*B,D},Bt.invert=function(D,C){var P=I(C);return D[0]=-C[0]/P,D[1]=-C[1]/P,D[2]=-C[2]/P,D[3]=C[3]/P,D[4]=-C[4]/P,D[5]=-C[5]/P,D[6]=-C[6]/P,D[7]=C[7]/P,D},Bt.conjugate=function(D,C){return D[0]=-C[0],D[1]=-C[1],D[2]=-C[2],D[3]=C[3],D[4]=-C[4],D[5]=-C[5],D[6]=-C[6],D[7]=C[7],D},Bt.normalize=function(D,C){var P=I(C);if(P>0){P=Math.sqrt(P);var B=C[0]/P,q=C[1]/P,H=C[2]/P,te=C[3]/P,re=C[4],J=C[5],ie=C[6],ce=C[7],me=B*re+q*J+H*ie+te*ce;D[0]=B,D[1]=q,D[2]=H,D[3]=te,D[4]=(re-B*me)/P,D[5]=(J-q*me)/P,D[6]=(ie-H*me)/P,D[7]=(ce-te*me)/P}return D},Bt.str=function(D){return"quat2("+D[0]+", "+D[1]+", "+D[2]+", "+D[3]+", "+D[4]+", "+D[5]+", "+D[6]+", "+D[7]+")"},Bt.exactEquals=function(D,C){return D[0]===C[0]&&D[1]===C[1]&&D[2]===C[2]&&D[3]===C[3]&&D[4]===C[4]&&D[5]===C[5]&&D[6]===C[6]&&D[7]===C[7]},Bt.equals=function(D,C){var P=D[0],B=D[1],q=D[2],H=D[3],te=D[4],re=D[5],J=D[6],ie=D[7],ce=C[0],me=C[1],Ce=C[2],Ae=C[3],Ee=C[4],Ue=C[5],Ie=C[6],Ve=C[7];return Math.abs(P-ce)<=n.EPSILON*Math.max(1,Math.abs(P),Math.abs(ce))&&Math.abs(B-me)<=n.EPSILON*Math.max(1,Math.abs(B),Math.abs(me))&&Math.abs(q-Ce)<=n.EPSILON*Math.max(1,Math.abs(q),Math.abs(Ce))&&Math.abs(H-Ae)<=n.EPSILON*Math.max(1,Math.abs(H),Math.abs(Ae))&&Math.abs(te-Ee)<=n.EPSILON*Math.max(1,Math.abs(te),Math.abs(Ee))&&Math.abs(re-Ue)<=n.EPSILON*Math.max(1,Math.abs(re),Math.abs(Ue))&&Math.abs(J-Ie)<=n.EPSILON*Math.max(1,Math.abs(J),Math.abs(Ie))&&Math.abs(ie-Ve)<=n.EPSILON*Math.max(1,Math.abs(ie),Math.abs(Ve))},Bt.sqrLen=Bt.squaredLength=Bt.len=Bt.length=Bt.dot=Bt.mul=Bt.setReal=Bt.getReal=void 0;var n=d(G()),o=d(Vt()),u=d(He());function _(D){if(typeof WeakMap!="function")return null;var C=new WeakMap,P=new WeakMap;return(_=function(B){return B?P:C})(D)}function d(D,C){if(D&&D.__esModule)return D;if(D===null||c(D)!=="object"&&typeof D!="function")return{default:D};var P=_(C);if(P&&P.has(D))return P.get(D);var B={},q=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var H in D)if(H!=="default"&&Object.prototype.hasOwnProperty.call(D,H)){var te=q?Object.getOwnPropertyDescriptor(D,H):null;te&&(te.get||te.set)?Object.defineProperty(B,H,te):B[H]=D[H]}return B.default=D,P&&P.set(D,B),B}function y(D,C,P){var B=.5*P[0],q=.5*P[1],H=.5*P[2],te=C[0],re=C[1],J=C[2],ie=C[3];return D[0]=te,D[1]=re,D[2]=J,D[3]=ie,D[4]=B*ie+q*J-H*re,D[5]=q*ie+H*te-B*J,D[6]=H*ie+B*re-q*te,D[7]=-B*te-q*re-H*J,D}function E(D,C){return D[0]=C[0],D[1]=C[1],D[2]=C[2],D[3]=C[3],D[4]=C[4],D[5]=C[5],D[6]=C[6],D[7]=C[7],D}function M(D,C,P){var B=C[0],q=C[1],H=C[2],te=C[3],re=P[4],J=P[5],ie=P[6],ce=P[7],me=C[4],Ce=C[5],Ae=C[6],Ee=C[7],Ue=P[0],Ie=P[1],Ve=P[2],Ze=P[3];return D[0]=B*Ze+te*Ue+q*Ve-H*Ie,D[1]=q*Ze+te*Ie+H*Ue-B*Ve,D[2]=H*Ze+te*Ve+B*Ie-q*Ue,D[3]=te*Ze-B*Ue-q*Ie-H*Ve,D[4]=B*ce+te*re+q*ie-H*J+me*Ze+Ee*Ue+Ce*Ve-Ae*Ie,D[5]=q*ce+te*J+H*re-B*ie+Ce*Ze+Ee*Ie+Ae*Ue-me*Ve,D[6]=H*ce+te*ie+B*J-q*re+Ae*Ze+Ee*Ve+me*Ie-Ce*Ue,D[7]=te*ce-B*re-q*J-H*ie+Ee*Ze-me*Ue-Ce*Ie-Ae*Ve,D}Bt.getReal=o.copy,Bt.setReal=o.copy,Bt.mul=M;var k=o.dot;Bt.dot=k;var w=o.length;Bt.length=w,Bt.len=w;var I=o.squaredLength;return Bt.squaredLength=I,Bt.sqrLen=I,Bt}var $t,rn,Nt={};function xn(){if($t)return Nt;function c(C){return c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(P){return typeof P}:function(P){return P&&typeof Symbol=="function"&&P.constructor===Symbol&&P!==Symbol.prototype?"symbol":typeof P},c(C)}$t=1,Object.defineProperty(Nt,"__esModule",{value:!0}),Nt.create=u,Nt.clone=function(C){var P=new n.ARRAY_TYPE(2);return P[0]=C[0],P[1]=C[1],P},Nt.fromValues=function(C,P){var B=new n.ARRAY_TYPE(2);return B[0]=C,B[1]=P,B},Nt.copy=function(C,P){return C[0]=P[0],C[1]=P[1],C},Nt.set=function(C,P,B){return C[0]=P,C[1]=B,C},Nt.add=function(C,P,B){return C[0]=P[0]+B[0],C[1]=P[1]+B[1],C},Nt.subtract=_,Nt.multiply=d,Nt.divide=y,Nt.ceil=function(C,P){return C[0]=Math.ceil(P[0]),C[1]=Math.ceil(P[1]),C},Nt.floor=function(C,P){return C[0]=Math.floor(P[0]),C[1]=Math.floor(P[1]),C},Nt.min=function(C,P,B){return C[0]=Math.min(P[0],B[0]),C[1]=Math.min(P[1],B[1]),C},Nt.max=function(C,P,B){return C[0]=Math.max(P[0],B[0]),C[1]=Math.max(P[1],B[1]),C},Nt.round=function(C,P){return C[0]=Math.round(P[0]),C[1]=Math.round(P[1]),C},Nt.scale=function(C,P,B){return C[0]=P[0]*B,C[1]=P[1]*B,C},Nt.scaleAndAdd=function(C,P,B,q){return C[0]=P[0]+B[0]*q,C[1]=P[1]+B[1]*q,C},Nt.distance=E,Nt.squaredDistance=M,Nt.length=k,Nt.squaredLength=w,Nt.negate=function(C,P){return C[0]=-P[0],C[1]=-P[1],C},Nt.inverse=function(C,P){return C[0]=1/P[0],C[1]=1/P[1],C},Nt.normalize=function(C,P){var B=P[0],q=P[1],H=B*B+q*q;return H>0&&(H=1/Math.sqrt(H)),C[0]=P[0]*H,C[1]=P[1]*H,C},Nt.dot=function(C,P){return C[0]*P[0]+C[1]*P[1]},Nt.cross=function(C,P,B){var q=P[0]*B[1]-P[1]*B[0];return C[0]=C[1]=0,C[2]=q,C},Nt.lerp=function(C,P,B,q){var H=P[0],te=P[1];return C[0]=H+q*(B[0]-H),C[1]=te+q*(B[1]-te),C},Nt.random=function(C,P){P=P||1;var B=2*n.RANDOM()*Math.PI;return C[0]=Math.cos(B)*P,C[1]=Math.sin(B)*P,C},Nt.transformMat2=function(C,P,B){var q=P[0],H=P[1];return C[0]=B[0]*q+B[2]*H,C[1]=B[1]*q+B[3]*H,C},Nt.transformMat2d=function(C,P,B){var q=P[0],H=P[1];return C[0]=B[0]*q+B[2]*H+B[4],C[1]=B[1]*q+B[3]*H+B[5],C},Nt.transformMat3=function(C,P,B){var q=P[0],H=P[1];return C[0]=B[0]*q+B[3]*H+B[6],C[1]=B[1]*q+B[4]*H+B[7],C},Nt.transformMat4=function(C,P,B){var q=P[0],H=P[1];return C[0]=B[0]*q+B[4]*H+B[12],C[1]=B[1]*q+B[5]*H+B[13],C},Nt.rotate=function(C,P,B,q){var H=P[0]-B[0],te=P[1]-B[1],re=Math.sin(q),J=Math.cos(q);return C[0]=H*J-te*re+B[0],C[1]=H*re+te*J+B[1],C},Nt.angle=function(C,P){var B=C[0],q=C[1],H=P[0],te=P[1],re=Math.sqrt(B*B+q*q)*Math.sqrt(H*H+te*te);return Math.acos(Math.min(Math.max(re&&(B*H+q*te)/re,-1),1))},Nt.zero=function(C){return C[0]=0,C[1]=0,C},Nt.str=function(C){return"vec2("+C[0]+", "+C[1]+")"},Nt.exactEquals=function(C,P){return C[0]===P[0]&&C[1]===P[1]},Nt.equals=function(C,P){var B=C[0],q=C[1],H=P[0],te=P[1];return Math.abs(B-H)<=n.EPSILON*Math.max(1,Math.abs(B),Math.abs(H))&&Math.abs(q-te)<=n.EPSILON*Math.max(1,Math.abs(q),Math.abs(te))},Nt.forEach=Nt.sqrLen=Nt.sqrDist=Nt.dist=Nt.div=Nt.mul=Nt.sub=Nt.len=void 0;var n=function(C,P){if(C&&C.__esModule)return C;if(C===null||c(C)!=="object"&&typeof C!="function")return{default:C};var B=o(void 0);if(B&&B.has(C))return B.get(C);var q={},H=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var te in C)if(te!=="default"&&Object.prototype.hasOwnProperty.call(C,te)){var re=H?Object.getOwnPropertyDescriptor(C,te):null;re&&(re.get||re.set)?Object.defineProperty(q,te,re):q[te]=C[te]}return q.default=C,B&&B.set(C,q),q}(G());function o(C){if(typeof WeakMap!="function")return null;var P=new WeakMap,B=new WeakMap;return(o=function(q){return q?B:P})(C)}function u(){var C=new n.ARRAY_TYPE(2);return n.ARRAY_TYPE!=Float32Array&&(C[0]=0,C[1]=0),C}function _(C,P,B){return C[0]=P[0]-B[0],C[1]=P[1]-B[1],C}function d(C,P,B){return C[0]=P[0]*B[0],C[1]=P[1]*B[1],C}function y(C,P,B){return C[0]=P[0]/B[0],C[1]=P[1]/B[1],C}function E(C,P){return Math.hypot(P[0]-C[0],P[1]-C[1])}function M(C,P){var B=P[0]-C[0],q=P[1]-C[1];return B*B+q*q}function k(C){return Math.hypot(C[0],C[1])}function w(C){var P=C[0],B=C[1];return P*P+B*B}Nt.len=k,Nt.sub=_,Nt.mul=d,Nt.div=y,Nt.dist=E,Nt.sqrDist=M,Nt.sqrLen=w;var I,D=(I=u(),function(C,P,B,q,H,te){var re,J;for(P||(P=2),B||(B=0),J=q?Math.min(q*P+B,C.length):C.length,re=B;re<J;re+=P)I[0]=C[re],I[1]=C[re+1],H(I,I,te),C[re]=I[0],C[re+1]=I[1];return C});return Nt.forEach=D,Nt}function rr(){if(rn)return j;function c(C){return c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(P){return typeof P}:function(P){return P&&typeof Symbol=="function"&&P.constructor===Symbol&&P!==Symbol.prototype?"symbol":typeof P},c(C)}rn=1,Object.defineProperty(j,"__esModule",{value:!0}),j.vec4=j.vec3=j.vec2=j.quat2=j.quat=j.mat4=j.mat3=j.mat2d=j.mat2=j.glMatrix=void 0;var n=D(G());j.glMatrix=n;var o=D(K());j.mat2=o;var u=D(ge());j.mat2d=u;var _=D(ae());j.mat3=_;var d=D(He());j.mat4=d;var y=D(Vt());j.quat=y;var E=D(et());j.quat2=E;var M=D(xn());j.vec2=M;var k=D(ht());j.vec3=k;var w=D(yt());function I(C){if(typeof WeakMap!="function")return null;var P=new WeakMap,B=new WeakMap;return(I=function(q){return q?B:P})(C)}function D(C,P){if(C&&C.__esModule)return C;if(C===null||c(C)!=="object"&&typeof C!="function")return{default:C};var B=I(P);if(B&&B.has(C))return B.get(C);var q={},H=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var te in C)if(te!=="default"&&Object.prototype.hasOwnProperty.call(C,te)){var re=H?Object.getOwnPropertyDescriptor(C,te):null;re&&(re.get||re.set)?Object.defineProperty(q,te,re):q[te]=C[te]}return q.default=C,B&&B.set(C,q),q}return j.vec4=w,j}var Xn,yi,ir,yn,Ne=rr(),Qn=function(){if(yi)return Xn;function c(n,o,u,_){this.cx=3*n,this.bx=3*(u-n)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*o,this.by=3*(_-o)-this.cy,this.ay=1-this.cy-this.by,this.p1x=n,this.p1y=o,this.p2x=u,this.p2y=_}return yi=1,Xn=c,c.prototype={sampleCurveX:function(n){return((this.ax*n+this.bx)*n+this.cx)*n},sampleCurveY:function(n){return((this.ay*n+this.by)*n+this.cy)*n},sampleCurveDerivativeX:function(n){return(3*this.ax*n+2*this.bx)*n+this.cx},solveCurveX:function(n,o){if(o===void 0&&(o=1e-6),n<0)return 0;if(n>1)return 1;for(var u=n,_=0;_<8;_++){var d=this.sampleCurveX(u)-n;if(Math.abs(d)<o)return u;var y=this.sampleCurveDerivativeX(u);if(Math.abs(y)<1e-6)break;u-=d/y}var E=0,M=1;for(u=n,_=0;_<20&&(d=this.sampleCurveX(u),!(Math.abs(d-n)<o));_++)n>d?E=u:M=u,u=.5*(M-E)+E;return u},solve:function(n,o){return this.sampleCurveY(this.solveCurveX(n,o))}},Xn}(),fn=O(Qn);function Dr(){if(yn)return ir;function c(n,o){this.x=n,this.y=o}return yn=1,ir=c,c.prototype={clone:function(){return new c(this.x,this.y)},add:function(n){return this.clone()._add(n)},sub:function(n){return this.clone()._sub(n)},multByPoint:function(n){return this.clone()._multByPoint(n)},divByPoint:function(n){return this.clone()._divByPoint(n)},mult:function(n){return this.clone()._mult(n)},div:function(n){return this.clone()._div(n)},rotate:function(n){return this.clone()._rotate(n)},rotateAround:function(n,o){return this.clone()._rotateAround(n,o)},matMult:function(n){return this.clone()._matMult(n)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(n){return this.x===n.x&&this.y===n.y},dist:function(n){return Math.sqrt(this.distSqr(n))},distSqr:function(n){var o=n.x-this.x,u=n.y-this.y;return o*o+u*u},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(n){return Math.atan2(this.y-n.y,this.x-n.x)},angleWith:function(n){return this.angleWithSep(n.x,n.y)},angleWithSep:function(n,o){return Math.atan2(this.x*o-this.y*n,this.x*n+this.y*o)},_matMult:function(n){var o=n[2]*this.x+n[3]*this.y;return this.x=n[0]*this.x+n[1]*this.y,this.y=o,this},_add:function(n){return this.x+=n.x,this.y+=n.y,this},_sub:function(n){return this.x-=n.x,this.y-=n.y,this},_mult:function(n){return this.x*=n,this.y*=n,this},_div:function(n){return this.x/=n,this.y/=n,this},_multByPoint:function(n){return this.x*=n.x,this.y*=n.y,this},_divByPoint:function(n){return this.x/=n.x,this.y/=n.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var n=this.y;return this.y=this.x,this.x=-n,this},_rotate:function(n){var o=Math.cos(n),u=Math.sin(n),_=u*this.x+o*this.y;return this.x=o*this.x-u*this.y,this.y=_,this},_rotateAround:function(n,o){var u=Math.cos(n),_=Math.sin(n),d=o.y+_*(this.x-o.x)+u*(this.y-o.y);return this.x=o.x+u*(this.x-o.x)-_*(this.y-o.y),this.y=d,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},c.convert=function(n){return n instanceof c?n:Array.isArray(n)?new c(n[0],n[1]):n},ir}var It=O(Dr());function Ir(c,n){if(Array.isArray(c)){if(!Array.isArray(n)||c.length!==n.length)return!1;for(let o=0;o<c.length;o++)if(!Ir(c[o],n[o]))return!1;return!0}if(typeof c=="object"&&c!==null&&n!==null){if(typeof n!="object"||Object.keys(c).length!==Object.keys(n).length)return!1;for(const o in c)if(!Ir(c[o],n[o]))return!1;return!0}return c===n}const Cr=Math.PI/180,ki=180/Math.PI;function $n(c){return c*Cr}function si(c){return c*ki}const ca=[[0,0],[1,0],[1,1],[0,1]];function Aa(c){if(c<=0)return 0;if(c>=1)return 1;const n=c*c,o=n*c;return 4*(c<.5?o:3*(c-n)+o-.75)}function ao(c,n,o,u){const _=new fn(c,n,o,u);return function(d){return _.solve(d)}}const Ss=ao(.25,.1,.25,1);function Bn(c,n,o){return Math.min(o,Math.max(n,c))}function Lo(c,n,o){return(o=Bn((o-c)/(n-c),0,1))*o*(3-2*o)}function Jo(c,n,o){const u=o-n,_=((c-n)%u+u)%u+n;return _===n?o:_}function ml(c,n,o){if(!c.length)return o(null,[]);let u=c.length;const _=new Array(c.length);let d=null;c.forEach((y,E)=>{n(y,(M,k)=>{M&&(d=M),_[E]=k,--u==0&&o(d,_)})})}function ua(c,...n){for(const o of n)for(const u in o)c[u]=o[u];return c}let _l=1;function nc(){return _l++}function Yu(c){return c<=1?1:Math.pow(2,Math.ceil(Math.log(c)/Math.LN2))}function Ku(c,n){c.forEach(o=>{n[o]&&(n[o]=n[o].bind(n))})}function ha(c,n){return c.indexOf(n,c.length-n.length)!==-1}function Ca(c,n,o){const u={};for(const _ in c)u[_]=n.call(this,c[_],_,c);return u}function Ju(c,n,o){const u={};for(const _ in c)n.call(this,c[_],_,c)&&(u[_]=c[_]);return u}function ea(c){return Array.isArray(c)?c.map(ea):typeof c=="object"&&c?Ca(c,ea):c}const fa={};function qn(c){fa[c]||(typeof console<"u"&&console.warn(c),fa[c]=!0)}function Hs(c,n,o){return(o.y-c.y)*(n.x-c.x)>(n.y-c.y)*(o.x-c.x)}function zd(c){let n=0;for(let o,u,_=0,d=c.length,y=d-1;_<d;y=_++)o=c[_],u=c[y],n+=(u.x-o.x)*(o.y+u.y);return n}function $a([c,n,o]){const u=$n(n+90),_=$n(o);return{x:c*Math.cos(u)*Math.sin(_),y:c*Math.sin(u)*Math.sin(_),z:c*Math.cos(_),azimuthal:n,polar:o}}function Qo(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function es(c){const n={};if(c.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(o,u,_,d)=>{const y=_||d;return n[u]=!y||y.toLowerCase(),""}),n["max-age"]){const o=parseInt(n["max-age"],10);isNaN(o)?delete n["max-age"]:n["max-age"]=o}return n}let gl=null;function Zs(c,n){return[c[4*n],c[4*n+1],c[4*n+2],c[4*n+3]]}function kd(c,n,o,u){for(;n<o;){const _=n+o>>1;c[_]<u?n=_+1:o=_}return n}function au(c,n,o,u){for(;n<o;){const _=n+o>>1;c[_]<=u?n=_+1:o=_}return n}function lf(c){return c>0?1/(1.001-c):1+c}function Qu(c){return c>0?1-1/(1.001-c):-c}const vi={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!vi.API_URL)return null;try{const c=new URL(vi.API_URL);return c.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":c.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",RASTERARRAYS_URL_PREFIX:"rasterarrays/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,DEFAULT_STYLE:"mapbox://styles/mapbox/standard",MAX_PARALLEL_IMAGE_REQUESTS:16,DRACO_URL:"https://api.mapbox.com/mapbox-gl-js/draco_decoder_gltf_v1.5.6.wasm",MESHOPT_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_base_v0.20.wasm",MESHOPT_SIMD_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_simd_v0.20.wasm",GLYPHS_URL:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf",TILES3D_URL_PREFIX:"3dtiles/v1"};function cf(c){return vi.API_URL_REGEX.test(c)}function uf(c){return vi.API_SPRITE_REGEX.test(c)}let eh,da,Ts,dt,le,pe;function we(){return eh==null&&(eh=self.OffscreenCanvas&&new OffscreenCanvas(1,1).getContext("2d")&&typeof self.createImageBitmap=="function"),eh}const ze={now:()=>dt!==void 0?dt:performance.now(),setNow(c){dt=c},restoreNow(){dt=void 0},frame(c){const n=requestAnimationFrame(c);return{cancel:()=>cancelAnimationFrame(n)}},getImageData(c,n=0){const{width:o,height:u}=c;le||(le=document.createElement("canvas"));const _=le.getContext("2d",{willReadFrequently:!0});if(!_)throw new Error("failed to create canvas 2d context");return(o>le.width||u>le.height)&&(le.width=o,le.height=u),_.clearRect(-n,-n,o+2*n,u+2*n),_.drawImage(c,0,0,o,u),_.getImageData(-n,-n,o+2*n,u+2*n)},resolveURL:c=>(da||(da=document.createElement("a")),da.href=c,da.href),get devicePixelRatio(){return window.devicePixelRatio},get prefersReducedMotion(){return!!window.matchMedia&&(Ts==null&&(Ts=window.matchMedia("(prefers-reduced-motion: reduce)")),Ts.matches)},hasCanvasFingerprintNoise(){if(pe!==void 0)return pe;if(!we())return pe=!1,!1;const c=new OffscreenCanvas(85,1),n=c.getContext("2d",{willReadFrequently:!0});let o=0;for(let _=0;_<c.width;++_)n.fillStyle=`rgba(${o++},${o++},${o++}, 255)`,n.fillRect(_,0,1,1);const u=n.getImageData(0,0,c.width,c.height);o=0;for(let _=0;_<u.data.length;++_)if(_%4!=3&&o++!==u.data[_])return pe=!0,!0;return pe=!1,!1}};function je(c,n){const o=c.indexOf("?");if(o<0)return`${c}?${new URLSearchParams(n).toString()}`;const u=new URLSearchParams(c.slice(o));for(const _ in n)u.set(_,n[_]);return`${c.slice(0,o)}?${u.toString()}`}function We(c,n={persistentParams:[]}){const o=c.indexOf("?");if(o<0)return c;const u=new URLSearchParams,_=new URLSearchParams(c.slice(o));for(const y of n.persistentParams){const E=_.get(y);E&&u.set(y,E)}const d=u.toString();return`${c.slice(0,o)}${d.length>0?`?${d}`:""}`}const it="mapbox-tiles";let Ye=500,ct=50;const lt=["language","worldview","jobid"];let ut,Ct;function Zt(){try{return caches}catch{}}function Xt(){const c=Zt();c&&ut==null&&(ut=c.open(it))}let gn=1/0;const Cn={supported:!1,testSupport:function(c){!er&&wn&&(tr?dr(c):On=c)}};let On,wn,er=!1,tr=!1;const Yn=typeof self<"u"?self:{};function dr(c){const n=c.createTexture();c.bindTexture(c.TEXTURE_2D,n);try{if(c.texImage2D(c.TEXTURE_2D,0,c.RGBA,c.RGBA,c.UNSIGNED_BYTE,wn),c.isContextLost())return;Cn.supported=!0}catch{}c.deleteTexture(n),er=!0}Yn.document&&(wn=Yn.document.createElement("img"),wn.onload=function(){On&&dr(On),On=null,tr=!0},wn.onerror=function(){er=!0,On=null},wn.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const vr={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Iconset:"Iconset",Image:"Image",Model:"Model"};typeof Object.freeze=="function"&&Object.freeze(vr);class Ii extends Error{constructor(n,o,u){o===401&&cf(u)&&(n+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(n),this.status=o,this.url=u}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const zo=Qo()?()=>self.worker&&self.worker.referrer:()=>(location.protocol==="blob:"?parent:self).location.href,Ai=function(c,n){if(!(/^file:/.test(o=c.url)||/^file:/.test(zo())&&!/^\w+:/.test(o))){if(self.fetch&&self.Request&&self.AbortController&&Request.prototype.hasOwnProperty("signal"))return function(u,_){const d=new AbortController,y=new Request(u.url,{method:u.method||"GET",body:u.body,credentials:u.credentials,headers:u.headers,referrer:zo(),referrerPolicy:u.referrerPolicy,signal:d.signal});let E=!1,M=!1;const k=(w=y.url).indexOf("sku=")>0&&cf(w);var w;u.type==="json"&&y.headers.set("Accept","application/json");const I=(C,P,B)=>{if(M)return;if(C&&C.message!=="SecurityError"&&qn(C.toString()),P&&B)return D(P);const q=Date.now();fetch(y).then(H=>{if(H.ok){const te=k?H.clone():null;return D(H,te,q)}return _(new Ii(H.statusText,H.status,u.url))}).catch(H=>{H.name!=="AbortError"&&_(new Error(`${H.message} ${u.url}`))})},D=(C,P,B)=>{(u.type==="arrayBuffer"?C.arrayBuffer():u.type==="json"?C.json():C.text()).then(q=>{M||(P&&B&&function(H,te,re){if(Xt(),ut==null)return;const J=es(te.headers.get("Cache-Control")||"");if(J["no-store"])return;const ie={status:te.status,statusText:te.statusText,headers:new Headers};te.headers.forEach((Ce,Ae)=>ie.headers.set(Ae,Ce)),J["max-age"]&&ie.headers.set("Expires",new Date(re+1e3*J["max-age"]).toUTCString());const ce=ie.headers.get("Expires");if(!ce||new Date(ce).getTime()-re<42e4)return;let me=We(H.url,{persistentParams:lt});if(te.status===206){const Ce=H.headers.get("Range");if(!Ce)return;ie.status=200,me=je(me,{range:Ce})}(function(Ce,Ae){if(Ct===void 0)try{new Response(new ReadableStream),Ct=!0}catch{Ct=!1}Ct?Ae(Ce.body):Ce.blob().then(Ae)})(te,Ce=>{const Ae=new Response((Ee=te.status)!==200&&Ee!==404&&[101,103,204,205,304].includes(Ee)?null:Ce,ie);var Ee;Xt(),ut!=null&&ut.then(Ue=>Ue.put(me,Ae)).catch(Ue=>qn(Ue.message))})}(y,P,B),E=!0,_(null,q,C.headers.get("Cache-Control"),C.headers.get("Expires")))}).catch(q=>{M||_(new Error(q.message))})};return k?function(C,P){if(Xt(),ut==null)return P(null);ut.then(B=>{let q=We(C.url,{persistentParams:lt});const H=C.headers.get("Range");H&&(q=je(q,{range:H})),B.match(q).then(te=>{const re=function(J){if(!J)return!1;const ie=new Date(J.headers.get("Expires")||0),ce=es(J.headers.get("Cache-Control")||"");return ie>Date.now()&&!ce["no-cache"]}(te);B.delete(q),re&&B.put(q,te.clone()),P(null,te,re)}).catch(P)}).catch(P)}(y,I):I(null,null),{cancel:()=>{M=!0,E||d.abort()}}}(c,n);if(Qo()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",c,n,void 0,!0)}var o;return function(u,_){const d=new XMLHttpRequest;d.open(u.method||"GET",u.url,!0),u.type==="arrayBuffer"&&(d.responseType="arraybuffer");for(const y in u.headers)d.setRequestHeader(y,u.headers[y]);return u.type==="json"&&(d.responseType="text",d.setRequestHeader("Accept","application/json")),d.withCredentials=u.credentials==="include",d.onerror=()=>{_(new Error(d.statusText))},d.onload=()=>{if((d.status>=200&&d.status<300||d.status===0)&&d.response!==null){let y=d.response;if(u.type==="json")try{y=JSON.parse(d.response)}catch(E){return _(E)}_(null,y,d.getResponseHeader("Cache-Control"),d.getResponseHeader("Expires"))}else _(new Ii(d.statusText,d.status,u.url))},d.send(u.body),{cancel:()=>d.abort()}}(c,n)},ii=function(c,n){return Ai(ua(c,{type:"arrayBuffer"}),n)};function di(c){const n=document.createElement("a");return n.href=c,n.protocol===location.protocol&&n.host===location.host}const th="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let yl,rc;yl=[],rc=0;const Bd=function(c,n){if(Cn.supported&&(c.headers||(c.headers={}),c.headers.accept="image/webp,*/*"),rc>=vi.MAX_PARALLEL_IMAGE_REQUESTS){const d={requestParameters:c,callback:n,cancelled:!1,cancel(){this.cancelled=!0}};return yl.push(d),d}rc++;let o=!1;const u=()=>{if(!o)for(o=!0,rc--;yl.length&&rc<vi.MAX_PARALLEL_IMAGE_REQUESTS;){const d=yl.shift(),{requestParameters:y,callback:E,cancelled:M}=d;M||(d.cancel=Bd(y,E).cancel)}},_=ii(c,(d,y,E,M)=>{u(),d?n(d):y&&(self.createImageBitmap?function(k,w){const I=new Blob([new Uint8Array(k)],{type:"image/png"});createImageBitmap(I).then(D=>{w(null,D)}).catch(D=>{w(new Error(`Could not load image because of ${D.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(y,(k,w)=>n(k,w,E,M)):function(k,w){const I=new Image;I.onload=()=>{w(null,I),URL.revokeObjectURL(I.src),I.onload=null,requestAnimationFrame(()=>{I.src=th})},I.onerror=()=>w(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const D=new Blob([new Uint8Array(k)],{type:"image/png"});I.src=k.byteLength?URL.createObjectURL(D):th}(y,(k,w)=>n(k,w,E,M)))});return{cancel:()=>{_.cancel(),u()}}};var hf,Jp,xo,Ma={exports:{}},ts={exports:{}},Es={exports:{}},oo=function(){if(xo)return Ma.exports;xo=1;var c=(hf||(hf=1,ts.exports=function(o,u){var _,d,y,E,M,k,w,I;for(d=o.length-(_=3&o.length),y=u,M=3432918353,k=461845907,I=0;I<d;)w=255&o.charCodeAt(I)|(255&o.charCodeAt(++I))<<8|(255&o.charCodeAt(++I))<<16|(255&o.charCodeAt(++I))<<24,++I,y=27492+(65535&(E=5*(65535&(y=(y^=w=(65535&(w=(w=(65535&w)*M+(((w>>>16)*M&65535)<<16)&4294967295)<<15|w>>>17))*k+(((w>>>16)*k&65535)<<16)&4294967295)<<13|y>>>19))+((5*(y>>>16)&65535)<<16)&4294967295))+((58964+(E>>>16)&65535)<<16);switch(w=0,_){case 3:w^=(255&o.charCodeAt(I+2))<<16;case 2:w^=(255&o.charCodeAt(I+1))<<8;case 1:y^=w=(65535&(w=(w=(65535&(w^=255&o.charCodeAt(I)))*M+(((w>>>16)*M&65535)<<16)&4294967295)<<15|w>>>17))*k+(((w>>>16)*k&65535)<<16)&4294967295}return y^=o.length,y=2246822507*(65535&(y^=y>>>16))+((2246822507*(y>>>16)&65535)<<16)&4294967295,y=3266489909*(65535&(y^=y>>>13))+((3266489909*(y>>>16)&65535)<<16)&4294967295,(y^=y>>>16)>>>0}),ts.exports),n=(Jp||(Jp=1,Es.exports=function(o,u){for(var _,d=o.length,y=u^d,E=0;d>=4;)_=1540483477*(65535&(_=255&o.charCodeAt(E)|(255&o.charCodeAt(++E))<<8|(255&o.charCodeAt(++E))<<16|(255&o.charCodeAt(++E))<<24))+((1540483477*(_>>>16)&65535)<<16),y=1540483477*(65535&y)+((1540483477*(y>>>16)&65535)<<16)^(_=1540483477*(65535&(_^=_>>>24))+((1540483477*(_>>>16)&65535)<<16)),d-=4,++E;switch(d){case 3:y^=(255&o.charCodeAt(E+2))<<16;case 2:y^=(255&o.charCodeAt(E+1))<<8;case 1:y=1540483477*(65535&(y^=255&o.charCodeAt(E)))+((1540483477*(y>>>16)&65535)<<16)}return y=1540483477*(65535&(y^=y>>>13))+((1540483477*(y>>>16)&65535)<<16),(y^=y>>>15)>>>0}),Es.exports);return Ma.exports=c,Ma.exports.murmur3=c,Ma.exports.murmur2=n,Ma.exports}(),ns=O(oo);class As{constructor(n,...o){ua(this,o[0]||{}),this.type=n}}class vl extends As{constructor(n,o={}){super("error",ua({error:n},o))}}function Qp(c,n,o){o[c]&&o[c].indexOf(n)!==-1||(o[c]=o[c]||[],o[c].push(n))}function xl(c,n,o){if(o&&o[c]){const u=o[c].indexOf(n);u!==-1&&o[c].splice(u,1)}}class bl{on(n,o){return this._listeners=this._listeners||{},Qp(n,o,this._listeners),this}off(n,o){return xl(n,o,this._listeners),xl(n,o,this._oneTimeListeners),this}once(n,o){return o?(this._oneTimeListeners=this._oneTimeListeners||{},Qp(n,o,this._oneTimeListeners),this):new Promise(u=>this.once(n,u))}fire(n,o){const u=typeof n=="string"?new As(n,o):n,_=u.type;if(this.listens(_)){u.target=this;const d=this._listeners&&this._listeners[_]?this._listeners[_].slice():[];for(const M of d)M.call(this,u);const y=this._oneTimeListeners&&this._oneTimeListeners[_]?this._oneTimeListeners[_].slice():[];for(const M of y)xl(_,M,this._oneTimeListeners),M.call(this,u);const E=this._eventedParent;E&&(ua(u,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),E.fire(u))}else u instanceof vl&&console.error(u.error);return this}listens(n){return!!(this._listeners&&this._listeners[n]&&this._listeners[n].length>0||this._oneTimeListeners&&this._oneTimeListeners[n]&&this._oneTimeListeners[n].length>0||this._eventedParent&&this._eventedParent.listens(n))}setEventedParent(n,o){return this._eventedParent=n,this._eventedParentData=o,this}}var Nd,em={},rs=function(){if(Nd)return em;Nd=1;var c={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function n(d){return(d=Math.round(d))<0?0:d>255?255:d}function o(d){return n(d[d.length-1]==="%"?parseFloat(d)/100*255:parseInt(d))}function u(d){return(y=d[d.length-1]==="%"?parseFloat(d)/100:parseFloat(d))<0?0:y>1?1:y;var y}function _(d,y,E){return E<0?E+=1:E>1&&(E-=1),6*E<1?d+(y-d)*E*6:2*E<1?y:3*E<2?d+(y-d)*(2/3-E)*6:d}try{em.parseCSSColor=function(d){var y,E=d.replace(/ /g,"").toLowerCase();if(E in c)return c[E].slice();if(E[0]==="#")return E.length===4?(y=parseInt(E.substr(1),16))>=0&&y<=4095?[(3840&y)>>4|(3840&y)>>8,240&y|(240&y)>>4,15&y|(15&y)<<4,1]:null:E.length===7&&(y=parseInt(E.substr(1),16))>=0&&y<=16777215?[(16711680&y)>>16,(65280&y)>>8,255&y,1]:null;var M=E.indexOf("("),k=E.indexOf(")");if(M!==-1&&k+1===E.length){var w=E.substr(0,M),I=E.substr(M+1,k-(M+1)).split(","),D=1;switch(w){case"rgba":if(I.length!==4)return null;D=u(I.pop());case"rgb":return I.length!==3?null:[o(I[0]),o(I[1]),o(I[2]),D];case"hsla":if(I.length!==4)return null;D=u(I.pop());case"hsl":if(I.length!==3)return null;var C=(parseFloat(I[0])%360+360)%360/360,P=u(I[1]),B=u(I[2]),q=B<=.5?B*(P+1):B+P-B*P,H=2*B-q;return[n(255*_(H,q,C+1/3)),n(255*_(H,q,C)),n(255*_(H,q,C-1/3)),D];default:return null}}return null}}catch{}return em}();class _r{constructor(n,o,u,_=1){this.r=n,this.g=o,this.b=u,this.a=_}static parse(n){if(!n)return;if(n instanceof _r)return n;if(typeof n!="string")return;const o=rs.parseCSSColor(n);return o?new _r(o[0]/255*o[3],o[1]/255*o[3],o[2]/255*o[3],o[3]):void 0}toStringPremultipliedAlpha(){const[n,o,u,_]=this.a===0?[0,0,0,0]:[255*this.r/this.a,255*this.g/this.a,255*this.b/this.a,this.a];return`rgba(${Math.round(n)},${Math.round(o)},${Math.round(u)},${_})`}toString(){const[n,o,u,_]=[this.r,this.g,this.b,this.a];return`rgba(${Math.round(255*n)},${Math.round(255*o)},${Math.round(255*u)},${_})`}toRenderColor(n){const{r:o,g:u,b:_,a:d}=this;return new ff(n,o,u,_,d)}clone(){return new _r(this.r,this.g,this.b,this.a)}}class ff{constructor(n,o,u,_,d){if(n){const y=n.image.height,E=y*y;o=d===0?0:o/d*(y-1),u=d===0?0:u/d*(y-1),_=d===0?0:_/d*(y-1);const M=Math.floor(o),k=Math.floor(u),w=Math.floor(_),I=Math.ceil(o),D=Math.ceil(u),C=Math.ceil(_),P=o-M,B=u-k,q=_-w,H=n.image.data,te=4*(M+k*E+w*y),re=4*(M+k*E+C*y),J=4*(M+D*E+w*y),ie=4*(M+D*E+C*y),ce=4*(I+k*E+w*y),me=4*(I+k*E+C*y),Ce=4*(I+D*E+w*y),Ae=4*(I+D*E+C*y);if(te<0||Ae>=H.length)throw new Error("out of range");this.r=Mn(Mn(Mn(H[te],H[re],q),Mn(H[J],H[ie],q),B),Mn(Mn(H[ce],H[me],q),Mn(H[Ce],H[Ae],q),B),P)/255*d,this.g=Mn(Mn(Mn(H[te+1],H[re+1],q),Mn(H[J+1],H[ie+1],q),B),Mn(Mn(H[ce+1],H[me+1],q),Mn(H[Ce+1],H[Ae+1],q),B),P)/255*d,this.b=Mn(Mn(Mn(H[te+2],H[re+2],q),Mn(H[J+2],H[ie+2],q),B),Mn(Mn(H[ce+2],H[me+2],q),Mn(H[Ce+2],H[Ae+2],q),B),P)/255*d,this.a=d}else this.r=o,this.g=u,this.b=_,this.a=d}toArray(){const{r:n,g:o,b:u,a:_}=this;return _===0?[0,0,0,0]:[255*n/_,255*o/_,255*u/_,_]}toHslaArray(){if(this.a===0)return[0,0,0,0];const{r:n,g:o,b:u,a:_}=this,d=Math.min(Math.max(n/_,0),1),y=Math.min(Math.max(o/_,0),1),E=Math.min(Math.max(u/_,0),1),M=Math.min(d,y,E),k=Math.max(d,y,E),w=(M+k)/2;if(M===k)return[0,0,100*w,_];const I=k-M,D=w>.5?I/(2-k-M):I/(k+M);let C=0;return k===d?C=(y-E)/I+(y<E?6:0):k===y?C=(E-d)/I+2:k===E&&(C=(d-y)/I+4),C*=60,[Math.min(Math.max(C,0),360),Math.min(Math.max(100*D,0),100),Math.min(Math.max(100*w,0),100),_]}toArray01(){const{r:n,g:o,b:u,a:_}=this;return _===0?[0,0,0,0]:[n/_,o/_,u/_,_]}toArray01Scaled(n){const{r:o,g:u,b:_,a:d}=this;return d===0?[0,0,0]:[o/d*n,u/d*n,_/d*n]}toArray01PremultipliedAlpha(){const{r:n,g:o,b:u,a:_}=this;return[n,o,u,_]}toArray01Linear(){const{r:n,g:o,b:u,a:_}=this;return _===0?[0,0,0,0]:[Math.pow(n/_,2.2),Math.pow(o/_,2.2),Math.pow(u/_,2.2),_]}}function Mn(c,n,o){return c*(1-o)+n*o}function ou(c,n,o){return c.map((u,_)=>Mn(u,n[_],o))}_r.black=new _r(0,0,0,1),_r.white=new _r(1,1,1,1),_r.transparent=new _r(0,0,0,0),_r.red=new _r(1,0,0,1),_r.blue=new _r(0,0,1,1);var wl=Object.freeze({__proto__:null,array:ou,color:function(c,n,o){return new _r(Mn(c.r,n.r,o),Mn(c.g,n.g,o),Mn(c.b,n.b,o),Mn(c.a,n.a,o))},number:Mn});function df(c,...n){for(const o of n)for(const u in o)c[u]=o[u];return c}class Kn extends Error{constructor(n,o){super(o),this.message=o,this.key=n}}class pf{constructor(n,o=[]){this.parent=n,this.bindings={};for(const[u,_]of o)this.bindings[u]=_}concat(n){return new pf(this,n)}get(n){if(this.bindings[n])return this.bindings[n];if(this.parent)return this.parent.get(n);throw new Error(`${n} not found in scope.`)}has(n){return!!this.bindings[n]||!!this.parent&&this.parent.has(n)}}const Cs={kind:"null"},_n={kind:"number"},xr={kind:"string"},ar={kind:"boolean"},pa={kind:"color"},is={kind:"object"},gr={kind:"value"},ic={kind:"collator"},ko={kind:"formatted"},nh={kind:"resolvedImage"};function Wr(c,n){return{kind:"array",itemType:c,N:n}}function Xr(c){if(c.kind==="array"){const n=Xr(c.itemType);return typeof c.N=="number"?`array<${n}, ${c.N}>`:c.itemType.kind==="value"?"array":`array<${n}>`}return c.kind}const rh=[Cs,_n,xr,ar,pa,ko,is,Wr(gr),nh];function ma(c,n){if(n.kind==="error")return null;if(c.kind==="array"){if(n.kind==="array"&&(n.N===0&&n.itemType.kind==="value"||!ma(c.itemType,n.itemType))&&(typeof c.N!="number"||c.N===n.N))return null}else{if(c.kind===n.kind)return null;if(c.kind==="value"){for(const o of rh)if(!ma(o,n))return null}}return`Expected ${Xr(c)} but found ${Xr(n)} instead.`}function Fd(c,n){return n.some(o=>o.kind===c.kind)}function su(c,n){return n.some(o=>o==="null"?c===null:o==="array"?Array.isArray(c):o==="object"?c&&!Array.isArray(c)&&typeof c=="object":o===typeof c)}class ih{constructor(n,o,u){this.sensitivity=n?o?"variant":"case":o?"accent":"base",this.locale=u,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(n,o){return this.collator.compare(n,o)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Sl{constructor(n,o,u,_,d){this.text=n.normalize?n.normalize():n,this.image=o,this.scale=u,this.fontStack=_,this.textColor=d}}class ta{constructor(n){this.sections=n}static fromString(n){return new ta([new Sl(n,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(n=>n.text.length!==0||n.image&&n.image.namePrimary)}static factory(n){return n instanceof ta?n:ta.fromString(n)}toString(){return this.sections.length===0?"":this.sections.map(n=>n.text).join("")}serialize(){const n=["format"];for(const o of this.sections){if(o.image){n.push(["image",o.image.namePrimary]);continue}n.push(o.text);const u={};o.fontStack&&(u["text-font"]=["literal",o.fontStack.split(",")]),o.scale&&(u["font-scale"]=o.scale),o.textColor&&(u["text-color"]=["rgba"].concat(o.textColor.toRenderColor(null).toArray())),n.push(u)}return n}}class Ms{constructor(n,o){if(this.id=n,this.options=o||{params:{}},this.options.transform){const{a:u,b:_,c:d,d:y,e:E,f:M}=this.options.transform;this.options.transform=new DOMMatrix([u,_,d,y,E,M])}else this.options.transform=new DOMMatrix([1,0,0,1,0,0])}static deserializeId(n){return JSON.parse(n).id}static deserializeFromString(n){const o=JSON.parse(n),{a:u,b:_,c:d,d:y,e:E,f:M}=o.options.transform;return new DOMMatrix([u,_,d,y,E,M]),new Ms(o.id,o.options)}scaleSelf(n){return this.options.transform=this.options.transform.scale(n),this}serialize(){const n={id:this.id};this.options&&(n.options=this.options);const{a:o,b:u,c:_,d,e:y,f:E}=this.options.transform;return n.options.transform={a:o,b:u,c:_,d,e:y,f:E},JSON.stringify(n)}}class Oa{constructor(n){this.namePrimary=n.namePrimary,n.nameSecondary&&(this.nameSecondary=n.nameSecondary),n.optionsPrimary&&(this.optionsPrimary=n.optionsPrimary),n.optionsSecondary&&(this.optionsSecondary=n.optionsSecondary),this.available=n.available}toString(){return this.namePrimary&&this.nameSecondary?`[${this.namePrimary},${this.nameSecondary}]`:this.namePrimary}getPrimary(){return new Ms(this.namePrimary,{params:this.optionsPrimary&&this.optionsPrimary.params||{}})}getSerializedPrimary(){return this.getPrimary().serialize()}getSecondary(){return this.nameSecondary?new Ms(this.nameSecondary,{params:this.optionsSecondary&&this.optionsSecondary.params||{}}):null}static from(n){return typeof n=="string"?Oa.build(n):n}static build(n,o,u,_){return n?new Oa({namePrimary:n,nameSecondary:o,optionsPrimary:u,optionsSecondary:_,available:!1}):null}}function tm(c,n,o,u){return typeof c=="number"&&c>=0&&c<=255&&typeof n=="number"&&n>=0&&n<=255&&typeof o=="number"&&o>=0&&o<=255?u===void 0||typeof u=="number"&&u>=0&&u<=1?null:`Invalid rgba value [${[c,n,o,u].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof u=="number"?[c,n,o,u]:[c,n,o]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Tl(c){if(c===null||typeof c=="string"||typeof c=="boolean"||typeof c=="number"||c instanceof _r||c instanceof ih||c instanceof ta||c instanceof Oa)return!0;if(Array.isArray(c)){for(const n of c)if(!Tl(n))return!1;return!0}if(typeof c=="object"){for(const n in c)if(!Tl(c[n]))return!1;return!0}return!1}function ai(c){if(c===null)return Cs;if(typeof c=="string")return xr;if(typeof c=="boolean")return ar;if(typeof c=="number")return _n;if(c instanceof _r)return pa;if(c instanceof ih)return ic;if(c instanceof ta)return ko;if(c instanceof Oa)return nh;if(Array.isArray(c)){const n=c.length;let o;for(const u of c){const _=ai(u);if(o){if(o===_)continue;o=gr;break}o=_}return Wr(o||gr,n)}return is}function as(c){const n=typeof c;return c===null?"":n==="string"||n==="number"||n==="boolean"?String(c):c instanceof _r?c.toStringPremultipliedAlpha():c instanceof ta||c instanceof Oa?c.toString():JSON.stringify(c)}class _a{constructor(n,o){this.type=n,this.value=o}static parse(n,o){if(n.length!==2)return o.error(`'literal' expression requires exactly one argument, but found ${n.length-1} instead.`);if(!Tl(n[1]))return o.error("invalid value");const u=n[1];let _=ai(u);const d=o.expectedType;return _.kind!=="array"||_.N!==0||!d||d.kind!=="array"||typeof d.N=="number"&&d.N!==0||(_=d),new _a(_,u)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof _r?["rgba"].concat(this.value.toRenderColor(null).toArray()):this.value instanceof ta?this.value.serialize():this.value}}class Pi{constructor(n){this.name="ExpressionEvaluationError",this.message=n}toJSON(){return this.message}}const mf={string:xr,number:_n,boolean:ar,object:is};class Os{constructor(n,o){this.type=n,this.args=o}static parse(n,o){if(n.length<2)return o.error("Expected at least one argument.");let u,_=1;const d=n[0];if(d==="array"){let E,M;if(n.length>2){const k=n[1];if(typeof k!="string"||!(k in mf)||k==="object")return o.error('The item type argument of "array" must be one of string, number, boolean',1);E=mf[k],_++}else E=gr;if(n.length>3){if(n[2]!==null&&(typeof n[2]!="number"||n[2]<0||n[2]!==Math.floor(n[2])))return o.error('The length argument to "array" must be a positive integer literal',2);M=n[2],_++}u=Wr(E,M)}else u=mf[d];const y=[];for(;_<n.length;_++){const E=o.parse(n[_],_,gr);if(!E)return null;y.push(E)}return new Os(u,y)}evaluate(n){for(let o=0;o<this.args.length;o++){const u=this.args[o].evaluate(n);if(!ma(this.type,ai(u)))return u;if(o===this.args.length-1)throw new Pi(`The expression ${JSON.stringify(this.args[o].serialize())} evaluated to ${Xr(ai(u))} but was expected to be of type ${Xr(this.type)}.`)}return null}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every(n=>n.outputDefined())}serialize(){const n=this.type,o=[n.kind];if(n.kind==="array"){const u=n.itemType;if(u.kind==="string"||u.kind==="number"||u.kind==="boolean"){o.push(u.kind);const _=n.N;(typeof _=="number"||this.args.length>1)&&o.push(_)}}return o.concat(this.args.map(u=>u.serialize()))}}class ac{constructor(n){this.type=ko,this.sections=n}static parse(n,o){if(n.length<2)return o.error("Expected at least one argument.");const u=n[1];if(!Array.isArray(u)&&typeof u=="object")return o.error("First argument must be an image or text section.");const _=[];let d=!1;for(let y=1;y<=n.length-1;++y){const E=n[y];if(d&&typeof E=="object"&&!Array.isArray(E)){d=!1;let M=null;if(E["font-scale"]&&(M=o.parseObjectValue(E["font-scale"],y,"font-scale",_n),!M))return null;let k=null;if(E["text-font"]&&(k=o.parseObjectValue(E["text-font"],y,"text-font",Wr(xr)),!k))return null;let w=null;if(E["text-color"]&&(w=o.parseObjectValue(E["text-color"],y,"text-color",pa),!w))return null;const I=_[_.length-1];I.scale=M,I.font=k,I.textColor=w}else{const M=o.parse(n[y],y,gr);if(!M)return null;const k=M.type.kind;if(k!=="string"&&k!=="value"&&k!=="null"&&k!=="resolvedImage")return o.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");d=!0,_.push({content:M,scale:null,font:null,textColor:null})}}return new ac(_)}evaluate(n){return new ta(this.sections.map(o=>{const u=o.content.evaluate(n);return ai(u)===nh?new Sl("",u,null,null,null):new Sl(as(u),null,o.scale?o.scale.evaluate(n):null,o.font?o.font.evaluate(n).join(","):null,o.textColor?o.textColor.evaluate(n):null)}))}eachChild(n){for(const o of this.sections)n(o.content),o.scale&&n(o.scale),o.font&&n(o.font),o.textColor&&n(o.textColor)}outputDefined(){return!1}serialize(){const n=["format"];for(const o of this.sections){n.push(o.content.serialize());const u={};o.scale&&(u["font-scale"]=o.scale.serialize()),o.font&&(u["text-font"]=o.font.serialize()),o.textColor&&(u["text-color"]=o.textColor.serialize()),n.push(u)}return n}}class _f{constructor(n,o,u,_){this._imageWarnHistory={},this.type=nh,this.inputPrimary=n,this.inputSecondary=o,this.inputPrimaryParams=u,this.inputSecondaryParams=_}static parse(n,o){if(n.length<2)return o.error("Expected two or more arguments.");let u=1;const _=[];function d(){if(u<n.length){const E=o.parse(n[u],u++,xr);return E?(_.push({image:E,options:void 0}),!0):(o.error(_.length?"Secondary image variant is not a string.":"No image name provided."),!1)}return!0}function y(){if(u<n.length){if((E=n[u])===null||typeof E!="object"||Array.isArray(E))return!0;const M=n[u].params,k=o.concat(u);if(!M)return u++,!0;if(typeof M!="object"||M.constructor!==Object)return k.error('Image options "params" should be an object'),!1;const w={},I=k.concat(void 0,"params");for(const D in M){if(!D)return I.error("Image parameter name should be non-empty"),!1;const C=I.concat(void 0,D).parse(M[D],void 0,pa,void 0,{typeAnnotation:"coerce"});if(!C)return!1;w[D]=C}return _[_.length-1].options=w,u++,!0}var E;return!0}for(let E=0;E<2;E++)if(!d()||!y())return;return new _f(_[0].image,_[1]?_[1].image:void 0,_[0].options,_[1]?_[1].options:void 0)}evaluateParams(n,o){const u={};if(o){for(const _ in o)if(o[_])try{const d=o[_].evaluate(n),y=`Ignoring image parameter "${_}" with semi-transparent color ${d.toString()}`;if(d.a!==1){this._imageWarnHistory[y]||(console.warn(y),this._imageWarnHistory[y]=!0);continue}u[_]=d}catch{continue}if(Object.keys(u).length!==0)return{params:u}}}evaluate(n){const o=Oa.build(this.inputPrimary.evaluate(n),this.inputSecondary?this.inputSecondary.evaluate(n):void 0,this.inputPrimaryParams?this.evaluateParams(n,this.inputPrimaryParams):void 0,this.inputSecondaryParams?this.evaluateParams(n,this.inputSecondaryParams):void 0);return o&&n.availableImages&&(o.available=n.availableImages.indexOf(o.namePrimary)>-1,o.nameSecondary&&o.available&&n.availableImages&&(o.available=n.availableImages.indexOf(o.nameSecondary)>-1)),o}eachChild(n){if(n(this.inputPrimary),this.inputPrimaryParams)for(const o in this.inputPrimaryParams)this.inputPrimaryParams[o]&&n(this.inputPrimaryParams[o]);if(this.inputSecondary&&(n(this.inputSecondary),this.inputSecondaryParams))for(const o in this.inputSecondaryParams)this.inputSecondaryParams[o]&&n(this.inputSecondaryParams[o])}outputDefined(){return!1}serializeParams(n){const o={};if(n){for(const u in n)n[u]&&(o[u]=n[u].serialize());return{params:o}}}serialize(){const n=["image",this.inputPrimary.serialize()];return this.inputPrimaryParams&&n.push(this.serializeParams(this.inputPrimaryParams)),this.inputSecondary&&(n.push(this.inputSecondary.serialize()),this.inputSecondaryParams&&n.push(this.serializeParams(this.inputSecondaryParams))),n}}function Is(c){return c instanceof Number?"number":c instanceof String?"string":c instanceof Boolean?"boolean":Array.isArray(c)?"array":c===null?"null":typeof c}const nm={"to-boolean":ar,"to-color":pa,"to-number":_n,"to-string":xr};class El{constructor(n,o){this.type=n,this.args=o}static parse(n,o){if(n.length<2)return o.error("Expected at least one argument.");const u=n[0],_=[];let d=Cs;if(u==="to-array"){if(!Array.isArray(n[1]))return null;const y=n[1].length;if(o.expectedType){if(o.expectedType.kind!=="array")return o.error(`Expected ${o.expectedType.kind} but found array.`);d=Wr(o.expectedType.itemType,y)}else{if(!(y>0&&Tl(n[1][0])))return null;d=Wr(ai(n[1][0]),y)}for(let E=0;E<y;E++){const M=n[1][E];let k;if(Is(M)==="array")k=o.parse(M,void 0,d.itemType);else{const w=Is(M);if(w!==d.itemType.kind)return o.error(`Expected ${d.itemType.kind} but found ${w}.`);k=o.registry.literal.parse(["literal",M===void 0?null:M],o)}if(!k)return null;_.push(k)}}else{if((u==="to-boolean"||u==="to-string")&&n.length!==2)return o.error("Expected one argument.");d=nm[u];for(let y=1;y<n.length;y++){const E=o.parse(n[y],y,gr);if(!E)return null;_.push(E)}}return new El(d,_)}evaluate(n){if(this.type.kind==="boolean")return!!this.args[0].evaluate(n);if(this.type.kind==="color"){let o,u;for(const _ of this.args){if(o=_.evaluate(n),u=null,o instanceof _r)return o;if(typeof o=="string"){const d=n.parseColor(o);if(d)return d}else if(Array.isArray(o)&&(u=o.length<3||o.length>4?`Invalid rbga value ${JSON.stringify(o)}: expected an array containing either three or four numeric values.`:tm(o[0],o[1],o[2],o[3]),!u))return new _r(o[0]/255,o[1]/255,o[2]/255,o[3])}throw new Pi(u||`Could not parse color from value '${typeof o=="string"?o:String(JSON.stringify(o))}'`)}if(this.type.kind==="number"){let o=null;for(const u of this.args){if(o=u.evaluate(n),o===null)return 0;const _=Number(o);if(!isNaN(_))return _}throw new Pi(`Could not convert ${JSON.stringify(o)} to number.`)}return this.type.kind==="formatted"?ta.fromString(as(this.args[0].evaluate(n))):this.type.kind==="resolvedImage"?Oa.build(as(this.args[0].evaluate(n))):this.type.kind==="array"?this.args.map(o=>o.evaluate(n)):as(this.args[0].evaluate(n))}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every(n=>n.outputDefined())}serialize(){if(this.type.kind==="formatted")return new ac([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new _f(this.args[0]).serialize();const n=this.type.kind==="array"?[]:[`to-${this.type.kind}`];return this.eachChild(o=>{n.push(o.serialize())}),n}}const rm=["Unknown","Point","LineString","Polygon"];class im{constructor(n,o){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null,this.scope=n,this.options=o}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?rm[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}measureLight(n){return this.globals.brightness||0}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const n=this.featureDistanceData.center,o=this.featureDistanceData.scale,{x:u,y:_}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(u*o-n[0])+this.featureDistanceData.bearing[1]*(_*o-n[1])}return 0}parseColor(n){let o=this._parseColorCache[n];return o||(o=this._parseColorCache[n]=_r.parse(n)),o}getConfig(n){return this.options?this.options.get(n):null}}class so{constructor(n,o,u,_,d){this.name=n,this.type=o,this._evaluate=u,this.args=_,this._overloadIndex=d}evaluate(n){if(!this._evaluate){const o=so.definitions[this.name];this._evaluate=Array.isArray(o)?o[2]:o.overloads[this._overloadIndex][1]}return this._evaluate(n,this.args)}eachChild(n){this.args.forEach(n)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(n=>n.serialize()))}static parse(n,o){const u=n[0],_=so.definitions[u];if(!_)return o.error(`Unknown expression "${u}". If you wanted a literal array, use ["literal", [...]].`,0);const d=Array.isArray(_)?_[0]:_.type,y=Array.isArray(_)?[[_[1],_[2]]]:_.overloads,E=[];let M=null,k=-1;for(const[w,I]of y){if(Array.isArray(w)&&w.length!==n.length-1)continue;E.push(w),k++,M=new mc(o.registry,o.path,null,o.scope,void 0,o._scope,o.options);const D=[];let C=!1;for(let P=1;P<n.length;P++){const B=n[P],q=Array.isArray(w)?w[P-1]:w.type,H=M.parse(B,1+D.length,q);if(!H){C=!0;break}D.push(H)}if(!C)if(Array.isArray(w)&&w.length!==D.length)M.error(`Expected ${w.length} arguments, but found ${D.length} instead.`);else{for(let P=0;P<D.length;P++){const B=Array.isArray(w)?w[P]:w.type,q=D[P];M.concat(P+1).checkSubtype(B,q.type)}if(M.errors.length===0)return new so(u,d,I,D,k)}}if(E.length===1)o.errors.push(...M.errors);else{const w=(E.length?E:y.map(([D])=>D)).map(am).join(" | "),I=[];for(let D=1;D<n.length;D++){const C=o.parse(n[D],1+I.length);if(!C)return null;I.push(Xr(C.type))}o.error(`Expected arguments of type ${w}, but found (${I.join(", ")}) instead.`)}return null}static register(n,o){so.definitions=o;for(const u in o)n[u]=so}}function am(c){return Array.isArray(c)?`(${c.map(Xr).join(", ")})`:`(${Xr(c.type)}...)`}class gf{constructor(n,o,u){this.type=ic,this.locale=u,this.caseSensitive=n,this.diacriticSensitive=o}static parse(n,o){if(n.length!==2)return o.error("Expected one argument.");const u=n[1];if(typeof u!="object"||Array.isArray(u))return o.error("Collator options argument must be an object.");const _=u["case-sensitive"]===void 0?o.parse(!1,1,ar):o.parseObjectValue(u["case-sensitive"],1,"case-sensitive",ar);if(!_)return null;const d=u["diacritic-sensitive"]===void 0?o.parse(!1,1,ar):o.parseObjectValue(u["diacritic-sensitive"],1,"diacritic-sensitive",ar);if(!d)return null;let y=null;return u.locale&&(y=o.parseObjectValue(u.locale,1,"locale",xr),!y)?null:new gf(_,d,y)}evaluate(n){return new ih(this.caseSensitive.evaluate(n),this.diacriticSensitive.evaluate(n),this.locale?this.locale.evaluate(n):null)}eachChild(n){n(this.caseSensitive),n(this.diacriticSensitive),this.locale&&n(this.locale)}outputDefined(){return!1}serialize(){const n={};return n["case-sensitive"]=this.caseSensitive.serialize(),n["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(n.locale=this.locale.serialize()),["collator",n]}}function yf(c,n,o=0,u=c.length-1,_=Gg){for(;u>o;){if(u-o>600){const M=u-o+1,k=n-o+1,w=Math.log(M),I=.5*Math.exp(2*w/3),D=.5*Math.sqrt(w*I*(M-I)/M)*(k-M/2<0?-1:1);yf(c,n,Math.max(o,Math.floor(n-k*I/M+D)),Math.min(u,Math.floor(n+(M-k)*I/M+D)),_)}const d=c[n];let y=o,E=u;for(vf(c,o,n),_(c[u],d)>0&&vf(c,o,u);y<E;){for(vf(c,y,E),y++,E--;_(c[y],d)<0;)y++;for(;_(c[E],d)>0;)E--}_(c[o],d)===0?vf(c,o,E):(E++,vf(c,E,u)),E<=n&&(o=E+1),n<=E&&(u=E-1)}}function vf(c,n,o){const u=c[n];c[n]=c[o],c[o]=u}function Gg(c,n){return c<n?-1:c>n?1:0}function Hg(c){let n=0;for(let o,u,_=0,d=c.length,y=d-1;_<d;y=_++)o=c[_],u=c[y],n+=(u.x-o.x)*(o.y+u.y);return n}function xf(c,n){c[0]=Math.min(c[0],n[0]),c[1]=Math.min(c[1],n[1]),c[2]=Math.max(c[2],n[0]),c[3]=Math.max(c[3],n[1])}function bf(c,n){return!(c[0]<=n[0]||c[2]>=n[2]||c[1]<=n[1]||c[3]>=n[3])}function Zg(c,n,o){const u=c[0]-n[0],_=c[1]-n[1],d=c[0]-o[0],y=c[1]-o[1];return u*y-d*_==0&&u*d<=0&&_*y<=0}function ah(c,n,o=!1){let u=!1;for(let E=0,M=n.length;E<M;E++){const k=n[E];for(let w=0,I=k.length,D=I-1;w<I;D=w++){const C=k[D],P=k[w];if(Zg(c,C,P))return o;(d=C)[1]>(_=c)[1]!=(y=P)[1]>_[1]&&_[0]<(y[0]-d[0])*(_[1]-d[1])/(y[1]-d[1])+d[0]&&(u=!u)}}var _,d,y;return u}function om(c,n,o,u){const _=u[0]-o[0],d=u[1]-o[1],y=(c[0]-o[0])*d-_*(c[1]-o[1]),E=(n[0]-o[0])*d-_*(n[1]-o[1]);return y>0&&E<0||y<0&&E>0}function Ps(c,n,o,u){return(_=[u[0]-o[0],u[1]-o[1]])[0]*(d=[n[0]-c[0],n[1]-c[1]])[1]-_[1]*d[0]!=0&&!(!om(c,n,o,u)||!om(o,u,c,n));var _,d}const os=8192;function Wg(c,n){const o=(180+c[0])/360,u=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+c[1]*Math.PI/360)))/360,_=Math.pow(2,n.z);return[Math.round(o*_*os),Math.round(u*_*os)]}function jd(c,n){for(let o=0;o<n.length;o++)if(ah(c,n[o]))return!0;return!1}function M0(c,n,o){for(const u of o)for(let _=0,d=u.length,y=d-1;_<d;y=_++)if(Ps(c,n,u[y],u[_]))return!0;return!1}function sm(c,n){for(let o=0;o<c.length;++o)if(!ah(c[o],n))return!1;for(let o=0;o<c.length-1;++o)if(M0(c[o],c[o+1],n))return!1;return!0}function O0(c,n){for(let o=0;o<n.length;o++)if(sm(c,n[o]))return!0;return!1}function Ud(c,n,o){const u=[];for(let _=0;_<c.length;_++){const d=[];for(let y=0;y<c[_].length;y++){const E=Wg(c[_][y],o);xf(n,E),d.push(E)}u.push(d)}return u}function ss(c,n,o){const u=[];for(let _=0;_<c.length;_++){const d=Ud(c[_],n,o);u.push(d)}return u}function Jn(c,n,o,u){if(c[0]<o[0]||c[0]>o[2]){const _=.5*u;let d=c[0]-o[0]>_?-u:o[0]-c[0]>_?u:0;d===0&&(d=c[0]-o[2]>_?-u:o[2]-c[0]>_?u:0),c[0]+=d}xf(n,c)}function Tn(c,n,o,u){const _=Math.pow(2,u.z)*os,d=[u.x*os,u.y*os],y=[];if(!c)return y;for(const E of c)for(const M of E){const k=[M.x+d[0],M.y+d[1]];Jn(k,n,o,_),y.push(k)}return y}function Vd(c,n,o,u){const _=Math.pow(2,u.z)*os,d=[u.x*os,u.y*os],y=[];if(!c)return y;for(const M of c){const k=[];for(const w of M){const I=[w.x+d[0],w.y+d[1]];xf(n,I),k.push(I)}y.push(k)}if(n[2]-n[0]<=_/2){(E=n)[0]=E[1]=1/0,E[2]=E[3]=-1/0;for(const M of y)for(const k of M)Jn(k,n,o,_)}var E;return y}class Dn{constructor(n,o){this.type=ar,this.geojson=n,this.geometries=o}static parse(n,o){if(n.length!==2)return o.error(`'within' expression requires exactly one argument, but found ${n.length-1} instead.`);if(Tl(n[1])){const u=n[1];if(u.type==="FeatureCollection")for(let _=0;_<u.features.length;++_){const d=u.features[_].geometry.type;if(d==="Polygon"||d==="MultiPolygon")return new Dn(u,u.features[_].geometry)}else if(u.type==="Feature"){const _=u.geometry.type;if(_==="Polygon"||_==="MultiPolygon")return new Dn(u,u.geometry)}else if(u.type==="Polygon"||u.type==="MultiPolygon")return new Dn(u,u)}return o.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(n){if(n.geometry()!=null&&n.canonicalID()!=null){if(n.geometryType()==="Point")return function(o,u){const _=[1/0,1/0,-1/0,-1/0],d=[1/0,1/0,-1/0,-1/0],y=o.canonicalID();if(!y)return!1;if(u.type==="Polygon"){const E=Ud(u.coordinates,d,y),M=Tn(o.geometry(),_,d,y);if(!bf(_,d))return!1;for(const k of M)if(!ah(k,E))return!1}if(u.type==="MultiPolygon"){const E=ss(u.coordinates,d,y),M=Tn(o.geometry(),_,d,y);if(!bf(_,d))return!1;for(const k of M)if(!jd(k,E))return!1}return!0}(n,this.geometries);if(n.geometryType()==="LineString")return function(o,u){const _=[1/0,1/0,-1/0,-1/0],d=[1/0,1/0,-1/0,-1/0],y=o.canonicalID();if(!y)return!1;if(u.type==="Polygon"){const E=Ud(u.coordinates,d,y),M=Vd(o.geometry(),_,d,y);if(!bf(_,d))return!1;for(const k of M)if(!sm(k,E))return!1}if(u.type==="MultiPolygon"){const E=ss(u.coordinates,d,y),M=Vd(o.geometry(),_,d,y);if(!bf(_,d))return!1;for(const k of M)if(!O0(k,E))return!1}return!0}(n,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}const lu={kilometers:1,miles:1e3/1609.344,nauticalmiles:1e3/1852,meters:1e3,metres:1e3,yards:1e3/.9144,feet:1e3/.3048,inches:1e3/.0254},oc=1/298.257223563,Rn=oc*(2-oc),oh=Math.PI/180;class Ws{static fromTile(n,o,u){const _=Math.PI*(1-2*(n+.5)/Math.pow(2,o)),d=Math.atan(.5*(Math.exp(_)-Math.exp(-_)))/oh;return new Ws(d,u)}static get units(){return lu}constructor(n,o){if(n===void 0)throw new Error("No latitude given.");if(o&&!lu[o])throw new Error(`Unknown unit ${o}. Use one of: ${Object.keys(lu).join(", ")}`);const u=6378.137*oh*(o?lu[o]:1),_=Math.cos(n*oh),d=1/(1-Rn*(1-_*_)),y=Math.sqrt(d);this.kx=u*y*_,this.ky=u*y*d*(1-Rn)}distance(n,o){const u=qa(n[0]-o[0])*this.kx,_=(n[1]-o[1])*this.ky;return Math.sqrt(u*u+_*_)}bearing(n,o){const u=qa(o[0]-n[0])*this.kx;return Math.atan2(u,(o[1]-n[1])*this.ky)/oh}destination(n,o,u){const _=u*oh;return this.offset(n,Math.sin(_)*o,Math.cos(_)*o)}offset(n,o,u){return[n[0]+o/this.kx,n[1]+u/this.ky]}lineDistance(n){let o=0;for(let u=0;u<n.length-1;u++)o+=this.distance(n[u],n[u+1]);return o}area(n){let o=0;for(let u=0;u<n.length;u++){const _=n[u];for(let d=0,y=_.length,E=y-1;d<y;E=d++)o+=qa(_[d][0]-_[E][0])*(_[d][1]+_[E][1])*(u?-1:1)}return Math.abs(o)/2*this.kx*this.ky}along(n,o){let u=0;if(o<=0)return n[0];for(let _=0;_<n.length-1;_++){const d=n[_],y=n[_+1],E=this.distance(d,y);if(u+=E,u>o)return wf(d,y,(o-(u-E))/E)}return n[n.length-1]}pointToSegmentDistance(n,o,u){let[_,d]=o,y=qa(u[0]-_)*this.kx,E=(u[1]-d)*this.ky;if(y!==0||E!==0){const M=(qa(n[0]-_)*this.kx*y+(n[1]-d)*this.ky*E)/(y*y+E*E);M>1?(_=u[0],d=u[1]):M>0&&(_+=y/this.kx*M,d+=E/this.ky*M)}return y=qa(n[0]-_)*this.kx,E=(n[1]-d)*this.ky,Math.sqrt(y*y+E*E)}pointOnLine(n,o){let u=1/0,_=n[0][0],d=n[0][1],y=0,E=0;for(let M=0;M<n.length-1;M++){let k=n[M][0],w=n[M][1],I=qa(n[M+1][0]-k)*this.kx,D=(n[M+1][1]-w)*this.ky,C=0;I===0&&D===0||(C=(qa(o[0]-k)*this.kx*I+(o[1]-w)*this.ky*D)/(I*I+D*D),C>1?(k=n[M+1][0],w=n[M+1][1]):C>0&&(k+=I/this.kx*C,w+=D/this.ky*C)),I=qa(o[0]-k)*this.kx,D=(o[1]-w)*this.ky;const P=I*I+D*D;P<u&&(u=P,_=k,d=w,y=M,E=C)}return{point:[_,d],index:y,t:Math.max(0,Math.min(1,E))}}lineSlice(n,o,u){let _=this.pointOnLine(u,n),d=this.pointOnLine(u,o);if(_.index>d.index||_.index===d.index&&_.t>d.t){const k=_;_=d,d=k}const y=[_.point],E=_.index+1,M=d.index;!$d(u[E],y[0])&&E<=M&&y.push(u[E]);for(let k=E+1;k<=M;k++)y.push(u[k]);return $d(u[M],d.point)||y.push(d.point),y}lineSliceAlong(n,o,u){let _=0;const d=[];for(let y=0;y<u.length-1;y++){const E=u[y],M=u[y+1],k=this.distance(E,M);if(_+=k,_>n&&d.length===0&&d.push(wf(E,M,(n-(_-k))/k)),_>=o)return d.push(wf(E,M,(o-(_-k))/k)),d;_>n&&d.push(M)}return d}bufferPoint(n,o){const u=o/this.ky,_=o/this.kx;return[n[0]-_,n[1]-u,n[0]+_,n[1]+u]}bufferBBox(n,o){const u=o/this.ky,_=o/this.kx;return[n[0]-_,n[1]-u,n[2]+_,n[3]+u]}insideBBox(n,o){return qa(n[0]-o[0])>=0&&qa(n[0]-o[2])<=0&&n[1]>=o[1]&&n[1]<=o[3]}}function $d(c,n){return c[0]===n[0]&&c[1]===n[1]}function wf(c,n,o){const u=qa(n[0]-c[0]);return[c[0]+u*o,c[1]+(n[1]-c[1])*o]}function qa(c){for(;c<-180;)c+=360;for(;c>180;)c-=360;return c}class na{constructor(n=[],o=(u,_)=>u<_?-1:u>_?1:0){if(this.data=n,this.length=this.data.length,this.compare=o,this.length>0)for(let u=(this.length>>1)-1;u>=0;u--)this._down(u)}push(n){this.data.push(n),this._up(this.length++)}pop(){if(this.length===0)return;const n=this.data[0],o=this.data.pop();return--this.length>0&&(this.data[0]=o,this._down(0)),n}peek(){return this.data[0]}_up(n){const{data:o,compare:u}=this,_=o[n];for(;n>0;){const d=n-1>>1,y=o[d];if(u(_,y)>=0)break;o[n]=y,n=d}o[n]=_}_down(n){const{data:o,compare:u}=this,_=this.length>>1,d=o[n];for(;n<_;){let y=1+(n<<1);const E=y+1;if(E<this.length&&u(o[E],o[y])<0&&(y=E),u(o[y],d)>=0)break;o[n]=o[y],n=y}o[n]=d}}var Kt=8192;function qd(c,n){return n.dist-c.dist}const Sf=100,Tf=50;function sc(c){const n=[1/0,1/0,-1/0,-1/0];if(n.length!==c.length)return!1;for(let o=0;o<n.length;o++)if(n[o]!==c[o])return!1;return!0}function ga(c){return c[1]-c[0]+1}function Al(c,n){const o=c[1]>=c[0]&&c[1]<n;return o||console.warn("Distance Expression: Index is out of range"),o}function lm(c,n){if(c[0]>c[1])return[null,null];const o=ga(c);if(n){if(o===2)return[c,null];const u=Math.floor(o/2);return[[c[0],c[0]+u],[c[0]+u,c[1]]]}{if(o===1)return[c,null];const u=Math.floor(o/2)-1;return[[c[0],c[0]+u],[c[0]+u+1,c[1]]]}}function ya(c,n){const o=[1/0,1/0,-1/0,-1/0];if(!Al(n,c.length))return o;for(let u=n[0];u<=n[1];++u)xf(o,c[u]);return o}function Rs(c){const n=[1/0,1/0,-1/0,-1/0];for(let o=0;o<c.length;++o)for(let u=0;u<c[o].length;++u)xf(n,c[o][u]);return n}function lc(c,n,o){if(sc(c)||sc(n))return NaN;let u=0,_=0;return c[2]<n[0]&&(u=n[0]-c[2]),c[0]>n[2]&&(u=c[0]-n[2]),c[1]>n[3]&&(_=c[1]-n[3]),c[3]<n[1]&&(_=n[1]-c[3]),o.distance([0,0],[u,_])}function Gd(c){return 360*c-180}function I0(c){return 360/Math.PI*Math.atan(Math.exp((180-360*c)*Math.PI/180))-90}function Hd(c,n){const o=Math.pow(2,n.z),u=(c.y/Kt+n.y)/o;return[Gd((c.x/Kt+n.x)/o),I0(u)]}function cm(c,n){const o=[];for(let u=0;u<c.length;++u)o.push(Hd(c[u],n));return o}function P0(c,n,o){const u=o.pointOnLine(n,c).point;return o.distance(c,u)}function um(c,n,o,u,_){const d=o.slice(u[0],u[1]+1);let y=1/0;for(let E=n[0];E<=n[1];++E)if((y=Math.min(y,P0(c[E],d,_)))===0)return 0;return y}function cc(c,n,o,u,_){const d=Math.min(_.pointToSegmentDistance(c,o,u),_.pointToSegmentDistance(n,o,u)),y=Math.min(_.pointToSegmentDistance(o,c,n),_.pointToSegmentDistance(u,c,n));return Math.min(d,y)}function hm(c,n,o,u,_){if(!Al(n,c.length)||!Al(u,o.length))return NaN;let d=1/0;for(let y=n[0];y<n[1];++y)for(let E=u[0];E<u[1];++E){if(Ps(c[y],c[y+1],o[E],o[E+1]))return 0;d=Math.min(d,cc(c[y],c[y+1],o[E],o[E+1],_))}return d}function sh(c,n,o,u,_){if(!Al(n,c.length)||!Al(u,o.length))return NaN;let d=1/0;for(let y=n[0];y<=n[1];++y)for(let E=u[0];E<=u[1];++E)if((d=Math.min(d,_.distance(c[y],o[E])))===0)return d;return d}function Cl(c,n,o){if(ah(c,n,!0))return 0;let u=1/0;for(const _ of n){const d=_.length;if(d<2)return console.warn("Distance Expression: Invalid polygon!"),NaN;if(_[0]!==_[d-1]&&(u=Math.min(u,o.pointToSegmentDistance(c,_[d-1],_[0])))===0||(u=Math.min(u,P0(c,_,o)))===0)return u}return u}function R0(c,n,o,u){if(!Al(n,c.length))return NaN;for(let d=n[0];d<=n[1];++d)if(ah(c[d],o,!0))return 0;let _=1/0;for(let d=n[0];d<n[1];++d)for(const y of o)for(let E=0,M=y.length,k=M-1;E<M;k=E++){if(Ps(c[d],c[d+1],y[k],y[E]))return 0;_=Math.min(_,cc(c[d],c[d+1],y[k],y[E],u))}return _}function uc(c,n){for(const o of c)for(let u=0;u<=o.length-1;++u)if(ah(o[u],n,!0))return!0;return!1}function hc(c,n,o,u=1/0){const _=Rs(c),d=Rs(n);if(u!==1/0&&lc(_,d,o)>=u)return u;if(bf(_,d)){if(uc(c,n))return 0}else if(uc(n,c))return 0;let y=u;for(const E of c)for(let M=0,k=E.length,w=k-1;M<k;w=M++)for(const I of n)for(let D=0,C=I.length,P=C-1;D<C;P=D++){if(Ps(E[w],E[M],I[P],I[D]))return 0;y=Math.min(y,cc(E[w],E[M],I[P],I[D],o))}return y}function cu(c,n,o,u,_,d,y){if(d===null||y===null)return;const E=lc(ya(u,d),ya(_,y),o);E<n&&c.push({dist:E,range1:d,range2:y})}function fm(c,n,o,u,_=1/0){let d=Math.min(u.distance(c[0],o[0][0]),_);if(d===0)return d;const y=new na([{dist:0,range1:[0,c.length-1],range2:[0,0]}],qd),E=n?Tf:Sf,M=Rs(o);for(;y.length;){const k=y.pop();if(k.dist>=d)continue;const w=k.range1;if(ga(w)<=E){if(!Al(w,c.length))return NaN;if(n){const I=R0(c,w,o,u);if((d=Math.min(d,I))===0)return d}else for(let I=w[0];I<=w[1];++I){const D=Cl(c[I],o,u);if((d=Math.min(d,D))===0)return d}}else{const I=lm(w,n);if(I[0]!==null){const D=lc(ya(c,I[0]),M,u);D<d&&y.push({dist:D,range1:I[0],range2:[0,0]})}if(I[1]!==null){const D=lc(ya(c,I[1]),M,u);D<d&&y.push({dist:D,range1:I[1],range2:[0,0]})}}}return d}function Ia(c,n,o,u,_,d=1/0){let y=Math.min(d,_.distance(c[0],o[0]));if(y===0)return y;const E=new na([{dist:0,range1:[0,c.length-1],range2:[0,o.length-1]}],qd),M=n?Tf:Sf,k=u?Tf:Sf;for(;E.length;){const w=E.pop();if(w.dist>=y)continue;const I=w.range1,D=w.range2;if(ga(I)<=M&&ga(D)<=k){if(!Al(I,c.length)||!Al(D,o.length))return NaN;if(n&&u?y=Math.min(y,hm(c,I,o,D,_)):n||u?n&&!u?y=Math.min(y,um(o,D,c,I,_)):!n&&u&&(y=Math.min(y,um(c,I,o,D,_))):y=Math.min(y,sh(c,I,o,D,_)),y===0)return y}else{const C=lm(I,n),P=lm(D,u);cu(E,y,_,c,o,C[0],P[0]),cu(E,y,_,c,o,C[0],P[1]),cu(E,y,_,c,o,C[1],P[0]),cu(E,y,_,c,o,C[1],P[1])}}return y}function Ef(c,n,o,u,_=1/0){let d=_;const y=ya(c,[0,c.length-1]);for(const E of o)if(!(d!==1/0&&lc(y,ya(E,[0,E.length-1]),u)>=d)&&(d=Math.min(d,Ia(c,n,E,!0,u,d)),d===0))return d;return d}function lh(c,n,o,u,_=1/0){let d=_;const y=ya(c,[0,c.length-1]);for(const E of o){if(d!==1/0&&lc(y,Rs(E),u)>=d)continue;const M=fm(c,n,E,u,d);if(isNaN(M))return M;if((d=Math.min(d,M))===0)return d}return d}function Af(c){return c==="Point"||c==="MultiPoint"||c==="LineString"||c==="MultiLineString"||c==="Polygon"||c==="MultiPolygon"}class fc{constructor(n,o){this.type=_n,this.geojson=n,this.geometries=o}static parse(n,o){if(n.length!==2)return o.error(`'distance' expression requires either one argument, but found ' ${n.length-1} instead.`);if(Tl(n[1])){const u=n[1];if(u.type==="FeatureCollection"){for(let _=0;_<u.features.length;++_)if(Af(u.features[_].geometry.type))return new fc(u,u.features[_].geometry)}else if(u.type==="Feature"){if(Af(u.geometry.type))return new fc(u,u.geometry)}else if(Af(u.type))return new fc(u,u)}return o.error("'distance' expression needs to be an array with format ['Distance', GeoJSONObj].")}evaluate(n){const o=n.geometry(),u=n.canonicalID();if(o!=null&&u!=null){if(n.geometryType()==="Point")return function(_,d,y){const E=[];for(const k of _)for(const w of k)E.push(Hd(w,d));const M=new Ws(E[0][1],"meters");return y.type==="Point"||y.type==="MultiPoint"||y.type==="LineString"?Ia(E,!1,y.type==="Point"?[y.coordinates]:y.coordinates,y.type==="LineString",M):y.type==="MultiLineString"?Ef(E,!1,y.coordinates,M):y.type==="Polygon"||y.type==="MultiPolygon"?lh(E,!1,y.type==="Polygon"?[y.coordinates]:y.coordinates,M):null}(o,u,this.geometries);if(n.geometryType()==="LineString")return function(_,d,y){const E=[];for(const k of _){const w=[];for(const I of k)w.push(Hd(I,d));E.push(w)}const M=new Ws(E[0][0][1],"meters");if(y.type==="Point"||y.type==="MultiPoint"||y.type==="LineString")return Ef(y.type==="Point"?[y.coordinates]:y.coordinates,y.type==="LineString",E,M);if(y.type==="MultiLineString"){let k=1/0;for(let w=0;w<y.coordinates.length;w++){const I=Ef(y.coordinates[w],!0,E,M,k);if(isNaN(I))return I;if((k=Math.min(k,I))===0)return k}return k}if(y.type==="Polygon"||y.type==="MultiPolygon"){let k=1/0;for(let w=0;w<E.length;w++){const I=lh(E[w],!0,y.type==="Polygon"?[y.coordinates]:y.coordinates,M,k);if(isNaN(I))return I;if((k=Math.min(k,I))===0)return k}return k}return null}(o,u,this.geometries);if(n.geometryType()==="Polygon")return function(_,d,y){const E=[];for(const k of function(w,I){const D=w.length;if(D<=1)return[w];const C=[];let P,B;for(let q=0;q<D;q++){const H=Hg(w[q]);H!==0&&(w[q].area=Math.abs(H),B===void 0&&(B=H<0),B===H<0?(P&&C.push(P),P=[w[q]]):P.push(w[q]))}return P&&C.push(P),C}(_)){const w=[];for(let I=0;I<k.length;++I)w.push(cm(k[I],d));E.push(w)}const M=new Ws(E[0][0][0][1],"meters");if(y.type==="Point"||y.type==="MultiPoint"||y.type==="LineString")return lh(y.type==="Point"?[y.coordinates]:y.coordinates,y.type==="LineString",E,M);if(y.type==="MultiLineString"){let k=1/0;for(let w=0;w<y.coordinates.length;w++){const I=lh(y.coordinates[w],!0,E,M,k);if(isNaN(I))return I;if((k=Math.min(k,I))===0)return k}return k}return y.type==="Polygon"||y.type==="MultiPolygon"?function(k,w,I){let D=1/0;for(const C of k)for(const P of w){const B=hc(C,P,I,D);if(isNaN(B))return B;if((D=Math.min(D,B))===0)return D}return D}(y.type==="Polygon"?[y.coordinates]:y.coordinates,E,M):null}(o,u,this.geometries);console.warn("Distance Expression: currently only evaluates valid Point/LineString/Polygon geometries.")}else console.warn("Distance Expression: requirs valid feature and canonical information.");return null}eachChild(){}outputDefined(){return!0}serialize(){return["distance",this.geojson]}}function Zd(c,n){switch(c){case"string":return as(n);case"number":return+n;case"boolean":return!!n;case"color":return _r.parse(n);case"formatted":return ta.fromString(as(n));case"resolvedImage":return Oa.build(as(n))}return n}function dm(c,n,o,u){return u!==void 0&&(c=u*Math.round(c/u)),n!==void 0&&c<n&&(c=n),o!==void 0&&c>o&&(c=o),c}class dc{constructor(n,o,u){this.type=n,this.key=o,this.scope=u}static parse(n,o){let u=o.expectedType;if(u==null&&(u=gr),n.length<2||n.length>3)return o.error("Invalid number of arguments for 'config' expression.");const _=o.parse(n[1],1);if(!(_ instanceof _a))return o.error("Key name of 'config' expression must be a string literal.");if(n.length>=3){const d=o.parse(n[2],2);return d instanceof _a?new dc(u,as(_.value),as(d.value)):o.error("Scope of 'config' expression must be a string literal.")}return new dc(u,as(_.value))}evaluate(n){const o=[this.key,this.scope,n.scope].filter(Boolean).join(""),u=n.getConfig(o);if(!u)return null;const{type:_,value:d,values:y,minValue:E,maxValue:M,stepValue:k}=u,w=u.default.evaluate(n);let I=w;if(d){const D=n.scope;n.scope=(D||"").split("").slice(1).join(""),I=d.evaluate(n),n.scope=D}return _&&(I=Zd(_,I)),I===void 0||E===void 0&&M===void 0&&k===void 0||(typeof I=="number"?I=dm(I,E,M,k):Array.isArray(I)&&(I=I.map(D=>typeof D=="number"?dm(D,E,M,k):D))),d!==void 0&&I!==void 0&&y&&!y.includes(I)&&(I=w,_&&(I=Zd(_,I))),(_&&_!==this.type||I!==void 0&&ai(I)!==this.type)&&(I=Zd(this.type.kind,I)),I}eachChild(){}outputDefined(){return!1}serialize(){const n=["config",this.key];return this.scope&&n.concat(this.key),n}}function uu(c){if(c instanceof so&&(c.name==="get"&&c.args.length===1||c.name==="feature-state"||c.name==="has"&&c.args.length===1||c.name==="properties"||c.name==="geometry-type"||c.name==="id"||/^filter-/.test(c.name))||c instanceof Dn||c instanceof fc)return!1;let n=!0;return c.eachChild(o=>{n&&!uu(o)&&(n=!1)}),n}function ch(c){if(c instanceof so&&c.name==="feature-state")return!1;let n=!0;return c.eachChild(o=>{n&&!ch(o)&&(n=!1)}),n}function lo(c){if(c instanceof dc)return new Set([c.key]);let n=new Set;return c.eachChild(o=>{n=new Set([...n,...lo(o)])}),n}function Pa(c,n){if(c instanceof so&&n.indexOf(c.name)>=0)return!1;let o=!0;return c.eachChild(u=>{o&&!Pa(u,n)&&(o=!1)}),o}class ls{constructor(n,o){this.type=o.type,this.name=n,this.boundExpression=o}static parse(n,o){if(n.length!==2||typeof n[1]!="string")return o.error("'var' expression requires exactly one string literal argument.");const u=n[1];return o.scope.has(u)?new ls(u,o.scope.get(u)):o.error(`Unknown variable "${u}". Make sure "${u}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(n){return this.boundExpression.evaluate(n)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}class pc{constructor(n,o=[],u,_=new pf,d=[],y,E){this.registry=n,this.path=o,this.key=o.map(M=>typeof M=="string"?`['${M}']`:`[${M}]`).join(""),this.scope=_,this.errors=d,this.expectedType=u,this._scope=y,this.options=E}parse(n,o,u,_,d={}){return o||u?this.concat(o,null,u,_)._parse(n,d):this._parse(n,d)}parseObjectValue(n,o,u,_,d,y={}){return this.concat(o,u,_,d)._parse(n,y)}_parse(n,o){function u(_,d,y){return y==="assert"?new Os(d,[_]):y==="coerce"?new El(d,[_]):_}if(n!==null&&typeof n!="string"&&typeof n!="boolean"&&typeof n!="number"||(n=["literal",n]),Array.isArray(n)){if(n.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const _=typeof n[0]=="string"?this.registry[n[0]]:void 0;if(_){let d=_.parse(n,this);if(!d)return null;if(this.expectedType){const y=this.expectedType,E=d.type;if(y.kind!=="string"&&y.kind!=="number"&&y.kind!=="boolean"&&y.kind!=="object"&&y.kind!=="array"||E.kind!=="value")if(y.kind!=="color"&&y.kind!=="formatted"&&y.kind!=="resolvedImage"||E.kind!=="value"&&E.kind!=="string"){if(this.checkSubtype(y,E))return null}else d=u(d,y,o.typeAnnotation||"coerce");else d=u(d,y,o.typeAnnotation||"assert")}if(!(d instanceof _a)&&d.type.kind!=="resolvedImage"&&hu(d)){const y=new im(this._scope,this.options);try{d=new _a(d.type,d.evaluate(y))}catch(E){return this.error(E.message),null}}return d}return El.parse(["to-array",n],this)}return this.error(n===void 0?"'undefined' value invalid. Use null instead.":typeof n=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof n} instead.`)}concat(n,o,u,_){let d=typeof n=="number"?this.path.concat(n):this.path;d=typeof o=="string"?d.concat(o):d;const y=_?this.scope.concat(_):this.scope;return new pc(this.registry,d,u||null,y,this.errors,this._scope,this.options)}error(n,...o){const u=`${this.key}${o.map(_=>`[${_}]`).join("")}`;this.errors.push(new Kn(u,n))}checkSubtype(n,o){const u=ma(n,o);return u&&this.error(u),u}}var mc=pc;function hu(c){if(c instanceof ls)return hu(c.boundExpression);if(c instanceof so&&c.name==="error"||c instanceof gf||c instanceof Dn||c instanceof fc||c instanceof dc)return!1;const n=c instanceof El||c instanceof Os;let o=!0;return c.eachChild(u=>{o=n?o&&hu(u):o&&u instanceof _a}),!!o&&uu(c)&&Pa(c,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])}function fu(c,n){const o=c.length-1;let u,_,d=0,y=o,E=0;for(;d<=y;)if(E=Math.floor((d+y)/2),u=c[E],_=c[E+1],u<=n){if(E===o||n<_)return E;d=E+1}else{if(!(u>n))throw new Pi("Input is not a number.");y=E-1}return 0}class Bo{constructor(n,o,u){this.type=n,this.input=o,this.labels=[],this.outputs=[];for(const[_,d]of u)this.labels.push(_),this.outputs.push(d)}static parse(n,o){if(n.length-1<4)return o.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if((n.length-1)%2!=0)return o.error("Expected an even number of arguments.");const u=o.parse(n[1],1,_n);if(!u)return null;const _=[];let d=null;o.expectedType&&o.expectedType.kind!=="value"&&(d=o.expectedType);for(let y=1;y<n.length;y+=2){const E=y===1?-1/0:n[y],M=n[y+1],k=y,w=y+1;if(typeof E!="number")return o.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',k);if(_.length&&_[_.length-1][0]>=E)return o.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',k);const I=o.parse(M,w,d);if(!I)return null;d=d||I.type,_.push([E,I])}return new Bo(d,u,_)}evaluate(n){const o=this.labels,u=this.outputs;if(o.length===1)return u[0].evaluate(n);const _=this.input.evaluate(n);if(_<=o[0])return u[0].evaluate(n);const d=o.length;return _>=o[d-1]?u[d-1].evaluate(n):u[fu(o,_)].evaluate(n)}eachChild(n){n(this.input);for(const o of this.outputs)n(o)}outputDefined(){return this.outputs.every(n=>n.outputDefined())}serialize(){const n=["step",this.input.serialize()];for(let o=0;o<this.labels.length;o++)o>0&&n.push(this.labels[o]),n.push(this.outputs[o].serialize());return n}}const _c=.95047,sr=1.08883,du=4/29,pu=6/29,No=3*pu*pu,mu=pu*pu*pu,uh=Math.PI/180,jr=180/Math.PI;function hh(c){return c>mu?Math.pow(c,1/3):c/No+du}function bo(c){return c>pu?c*c*c:No*(c-du)}function wo(c){return 255*(c<=.0031308?12.92*c:1.055*Math.pow(c,1/2.4)-.055)}function Ml(c){return(c/=255)<=.04045?c/12.92:Math.pow((c+.055)/1.055,2.4)}function Xs(c){const n=Ml(c.r),o=Ml(c.g),u=Ml(c.b),_=hh((.4124564*n+.3575761*o+.1804375*u)/_c),d=hh((.2126729*n+.7151522*o+.072175*u)/1);return{l:116*d-16,a:500*(_-d),b:200*(d-hh((.0193339*n+.119192*o+.9503041*u)/sr)),alpha:c.a}}function Ys(c){let n=(c.l+16)/116,o=isNaN(c.a)?n:n+c.a/500,u=isNaN(c.b)?n:n-c.b/200;return n=1*bo(n),o=_c*bo(o),u=sr*bo(u),new _r(wo(3.2404542*o-1.5371385*n-.4985314*u),wo(-.969266*o+1.8760108*n+.041556*u),wo(.0556434*o-.2040259*n+1.0572252*u),c.alpha)}function _u(c,n,o){const u=n-c;return c+o*(u>180||u<-180?u-360*Math.round(u/360):u)}const fh={forward:Xs,reverse:Ys,interpolate:function(c,n,o){return{l:Mn(c.l,n.l,o),a:Mn(c.a,n.a,o),b:Mn(c.b,n.b,o),alpha:Mn(c.alpha,n.alpha,o)}}},gu={forward:function(c){const{l:n,a:o,b:u}=Xs(c),_=Math.atan2(u,o)*jr;return{h:_<0?_+360:_,c:Math.sqrt(o*o+u*u),l:n,alpha:c.a}},reverse:function(c){const n=c.h*uh,o=c.c;return Ys({l:c.l,a:Math.cos(n)*o,b:Math.sin(n)*o,alpha:c.alpha})},interpolate:function(c,n,o){return{h:_u(c.h,n.h,o),c:Mn(c.c,n.c,o),l:Mn(c.l,n.l,o),alpha:Mn(c.alpha,n.alpha,o)}}};var Wd=Object.freeze({__proto__:null,hcl:gu,lab:fh});class li{constructor(n,o,u,_,d,y){this.type=n,this.operator=o,this.interpolation=u,this.input=_,this.dynamicStops=d,this.labels=[],this.outputs=[];for(const[E,M]of y)this.labels.push(E),this.outputs.push(M)}static interpolationFactor(n,o,u,_){let d=0;if(n.name==="exponential")d=va(o,n.base,u,_);else if(n.name==="linear")d=va(o,1,u,_);else if(n.name==="cubic-bezier"){const y=n.controlPoints;d=new fn(y[0],y[1],y[2],y[3]).solve(va(o,1,u,_))}return d}static parse(n,o){let[u,_,d,...y]=n;if(!Array.isArray(_)||_.length===0)return o.error("Expected an interpolation type expression.",1);if(_[0]==="linear")_={name:"linear"};else if(_[0]==="exponential"){const k=_[1];if(typeof k!="number")return o.error("Exponential interpolation requires a numeric base.",1,1);_={name:"exponential",base:k}}else{if(_[0]!=="cubic-bezier")return o.error(`Unknown interpolation type ${String(_[0])}`,1,0);{const k=_.slice(1);if(k.length!==4||k.some(w=>typeof w!="number"||w<0||w>1))return o.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);_={name:"cubic-bezier",controlPoints:k}}}if(n.length-1<3)return o.error(`Expected at least 3 arguments, but found only ${n.length-1}.`);if(n.length-1>3&&(n.length-1)%2!=0)return o.error("Expected an even number of arguments.");if(d=o.parse(d,2,_n),!d)return null;const E=[];let M=null;if(u==="interpolate-hcl"||u==="interpolate-lab"?M=pa:o.expectedType&&o.expectedType.kind!=="value"&&(M=o.expectedType),n.length-1==3){const k=o.parse(y[0],3,gr);return k?new li(M,u,_,d,k,E):null}for(let k=0;k<y.length;k+=2){const w=y[k],I=y[k+1],D=k+3,C=k+4;if(typeof w!="number")return o.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',D);if(E.length&&E[E.length-1][0]>=w)return o.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',D);const P=o.parse(I,C,M);if(!P)return null;M=M||P.type,E.push([w,P])}return M.kind==="number"||M.kind==="color"||M.kind==="array"&&M.itemType.kind==="number"&&typeof M.N=="number"?new li(M,u,_,d,null,E):o.error(`Type ${Xr(M)} is not interpolatable.`)}evaluate(n){let o=this.labels,u=this.outputs;if(this.dynamicStops){const w=this.dynamicStops.evaluate(n);if(w.length%2!=0)throw new Pi("Expected an even number of arguments.");o=[],u=[];for(let I=0;I<w.length;I+=2){const D=w[I],C=new _a(_n,w[I+1]);if(typeof D!="number")throw new Pi('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.');if(o.length&&o[o.length-1]>=D)throw new Pi('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.');o.push(D),u.push(C)}if(o.length===0)throw new Pi("Expected at least one input/output pair.")}if(o.length===1)return u[0].evaluate(n);const _=this.input.evaluate(n);if(_<=o[0])return u[0].evaluate(n);const d=o.length;if(_>=o[d-1])return u[d-1].evaluate(n);const y=fu(o,_),E=li.interpolationFactor(this.interpolation,_,o[y],o[y+1]),M=u[y].evaluate(n),k=u[y+1].evaluate(n);return this.operator==="interpolate"?wl[this.type.kind.toLowerCase()](M,k,E):this.operator==="interpolate-hcl"?gu.reverse(gu.interpolate(gu.forward(M),gu.forward(k),E)):fh.reverse(fh.interpolate(fh.forward(M),fh.forward(k),E))}eachChild(n){n(this.input);for(const o of this.outputs)n(o)}outputDefined(){return this.outputs.every(n=>n.outputDefined())}serialize(){let n;n=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const o=[this.operator,n,this.input.serialize()];if(this.dynamicStops)o.push(this.dynamicStops.serialize());else for(let u=0;u<this.labels.length;u++)o.push(this.labels[u],this.outputs[u].serialize());return o}}function va(c,n,o,u){const _=u-o,d=c-o;return _===0?0:n===1?d/_:(Math.pow(n,d)-1)/(Math.pow(n,_)-1)}class Ur{constructor(n,o){this.type=n,this.args=o}static parse(n,o){if(n.length<2)return o.error("Expectected at least one argument.");let u=null;const _=o.expectedType;_&&_.kind!=="value"&&(u=_);const d=[];for(const E of n.slice(1)){const M=o.parse(E,1+d.length,u,void 0,{typeAnnotation:"omit"});if(!M)return null;u=u||M.type,d.push(M)}const y=_&&d.some(E=>ma(_,E.type));return new Ur(y?gr:u,d)}evaluate(n){let o,u=null,_=0;for(const d of this.args){if(_++,u=d.evaluate(n),u&&u instanceof Oa&&!u.available&&(o||(o=u),u=null,_===this.args.length))return o;if(u!==null)break}return u}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every(n=>n.outputDefined())}serialize(){const n=["coalesce"];return this.eachChild(o=>{n.push(o.serialize())}),n}}class So{constructor(n,o){this.type=o.type,this.bindings=[].concat(n),this.result=o}evaluate(n){return this.result.evaluate(n)}eachChild(n){for(const o of this.bindings)n(o[1]);n(this.result)}static parse(n,o){if(n.length<4)return o.error(`Expected at least 3 arguments, but found ${n.length-1} instead.`);const u=[];for(let d=1;d<n.length-1;d+=2){const y=n[d];if(typeof y!="string")return o.error(`Expected string, but found ${typeof y} instead.`,d);if(/[^a-zA-Z0-9_]/.test(y))return o.error("Variable names must contain only alphanumeric characters or '_'.",d);const E=o.parse(n[d+1],d+1);if(!E)return null;u.push([y,E])}const _=o.parse(n[n.length-1],n.length-1,o.expectedType,u);return _?new So(u,_):null}outputDefined(){return this.result.outputDefined()}serialize(){const n=["let"];for(const[o,u]of this.bindings)n.push(o,u.serialize());return n.push(this.result.serialize()),n}}class cs{constructor(n,o,u){this.type=n,this.index=o,this.input=u}static parse(n,o){if(n.length!==3)return o.error(`Expected 2 arguments, but found ${n.length-1} instead.`);const u=o.parse(n[1],1,_n),_=o.parse(n[2],2,Wr(o.expectedType||gr));return u&&_?new cs(_.type.itemType,u,_):null}evaluate(n){const o=this.index.evaluate(n),u=this.input.evaluate(n);if(o<0)throw new Pi(`Array index out of bounds: ${o} < 0.`);if(o>u.length-1)throw new Pi(`Array index out of bounds: ${o} > ${u.length-1}.`);if(o===Math.floor(o))return u[o];const _=Math.floor(o),d=Math.ceil(o),y=u[_],E=u[d];if(typeof y!="number"||typeof E!="number")throw new Pi(`Cannot interpolate between non-number values at index ${o}.`);const M=o-_;return y*(1-M)+E*M}eachChild(n){n(this.index),n(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}class Cf{constructor(n,o){this.type=ar,this.needle=n,this.haystack=o}static parse(n,o){if(n.length!==3)return o.error(`Expected 2 arguments, but found ${n.length-1} instead.`);const u=o.parse(n[1],1,gr),_=o.parse(n[2],2,gr);return u&&_?Fd(u.type,[ar,xr,_n,Cs,gr])?new Cf(u,_):o.error(`Expected first argument to be of type boolean, string, number or null, but found ${Xr(u.type)} instead`):null}evaluate(n){const o=this.needle.evaluate(n),u=this.haystack.evaluate(n);if(u==null)return!1;if(!su(o,["boolean","string","number","null"]))throw new Pi(`Expected first argument to be of type boolean, string, number or null, but found ${Xr(ai(o))} instead.`);if(!su(u,["string","array"]))throw new Pi(`Expected second argument to be of type array or string, but found ${Xr(ai(u))} instead.`);return u.indexOf(o)>=0}eachChild(n){n(this.needle),n(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}class Ks{constructor(n,o,u){this.type=_n,this.needle=n,this.haystack=o,this.fromIndex=u}static parse(n,o){if(n.length<=2||n.length>=5)return o.error(`Expected 3 or 4 arguments, but found ${n.length-1} instead.`);const u=o.parse(n[1],1,gr),_=o.parse(n[2],2,gr);if(!u||!_)return null;if(!Fd(u.type,[ar,xr,_n,Cs,gr]))return o.error(`Expected first argument to be of type boolean, string, number or null, but found ${Xr(u.type)} instead`);if(n.length===4){const d=o.parse(n[3],3,_n);return d?new Ks(u,_,d):null}return new Ks(u,_)}evaluate(n){const o=this.needle.evaluate(n),u=this.haystack.evaluate(n);if(!su(o,["boolean","string","number","null"]))throw new Pi(`Expected first argument to be of type boolean, string, number or null, but found ${Xr(ai(o))} instead.`);if(!su(u,["string","array"]))throw new Pi(`Expected second argument to be of type array or string, but found ${Xr(ai(u))} instead.`);if(this.fromIndex){const _=this.fromIndex.evaluate(n);return u.indexOf(o,_)}return u.indexOf(o)}eachChild(n){n(this.needle),n(this.haystack),this.fromIndex&&n(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const n=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),n]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}class Xd{constructor(n,o,u,_,d,y){this.inputType=n,this.type=o,this.input=u,this.cases=_,this.outputs=d,this.otherwise=y}static parse(n,o){if(n.length<5)return o.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if(n.length%2!=1)return o.error("Expected an even number of arguments.");let u,_;o.expectedType&&o.expectedType.kind!=="value"&&(_=o.expectedType);const d={},y=[];for(let k=2;k<n.length-1;k+=2){let w=n[k];const I=n[k+1];Array.isArray(w)||(w=[w]);const D=o.concat(k);if(w.length===0)return D.error("Expected at least one branch label.");for(const P of w){if(typeof P!="number"&&typeof P!="string")return D.error("Branch labels must be numbers or strings.");if(typeof P=="number"&&Math.abs(P)>Number.MAX_SAFE_INTEGER)return D.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof P=="number"&&Math.floor(P)!==P)return D.error("Numeric branch labels must be integer values.");if(u){if(D.checkSubtype(u,ai(P)))return null}else u=ai(P);if(d[String(P)]!==void 0)return D.error("Branch labels must be unique.");d[String(P)]=y.length}const C=o.parse(I,k,_);if(!C)return null;_=_||C.type,y.push(C)}const E=o.parse(n[1],1,gr);if(!E)return null;const M=o.parse(n[n.length-1],n.length-1,_);return M?E.type.kind!=="value"&&o.concat(1).checkSubtype(u,E.type)?null:new Xd(u,_,E,d,y,M):null}evaluate(n){const o=this.input.evaluate(n);return(ai(o)===this.inputType&&this.outputs[this.cases[o]]||this.otherwise).evaluate(n)}eachChild(n){n(this.input),this.outputs.forEach(n),n(this.otherwise)}outputDefined(){return this.outputs.every(n=>n.outputDefined())&&this.otherwise.outputDefined()}serialize(){const n=["match",this.input.serialize()],o=Object.keys(this.cases).sort(),u=[],_={};for(const y of o){const E=_[this.cases[y]];E===void 0?(_[this.cases[y]]=u.length,u.push([this.cases[y],[y]])):u[E][1].push(y)}const d=y=>this.inputType.kind==="number"?Number(y):y;for(const[y,E]of u)n.push(E.length===1?d(E[0]):E.map(d)),n.push(this.outputs[y].serialize());return n.push(this.otherwise.serialize()),n}}class Yd{constructor(n,o,u){this.type=n,this.branches=o,this.otherwise=u}static parse(n,o){if(n.length<4)return o.error(`Expected at least 3 arguments, but found only ${n.length-1}.`);if(n.length%2!=0)return o.error("Expected an odd number of arguments.");let u;o.expectedType&&o.expectedType.kind!=="value"&&(u=o.expectedType);const _=[];for(let y=1;y<n.length-1;y+=2){const E=o.parse(n[y],y,ar);if(!E)return null;const M=o.parse(n[y+1],y+1,u);if(!M)return null;_.push([E,M]),u=u||M.type}const d=o.parse(n[n.length-1],n.length-1,u);return d?new Yd(u,_,d):null}evaluate(n){for(const[o,u]of this.branches)if(o.evaluate(n))return u.evaluate(n);return this.otherwise.evaluate(n)}eachChild(n){for(const[o,u]of this.branches)n(o),n(u);n(this.otherwise)}outputDefined(){return this.branches.every(([n,o])=>o.outputDefined())&&this.otherwise.outputDefined()}serialize(){const n=["case"];return this.eachChild(o=>{n.push(o.serialize())}),n}}class gc{constructor(n,o,u,_){this.type=n,this.input=o,this.beginIndex=u,this.endIndex=_}static parse(n,o){if(n.length<=2||n.length>=5)return o.error(`Expected 3 or 4 arguments, but found ${n.length-1} instead.`);const u=o.parse(n[1],1,gr),_=o.parse(n[2],2,_n);if(!u||!_)return null;if(!Fd(u.type,[Wr(gr),xr,gr]))return o.error(`Expected first argument to be of type array or string, but found ${Xr(u.type)} instead`);if(n.length===4){const d=o.parse(n[3],3,_n);return d?new gc(u.type,u,_,d):null}return new gc(u.type,u,_)}evaluate(n){const o=this.input.evaluate(n),u=this.beginIndex.evaluate(n);if(!su(o,["string","array"]))throw new Pi(`Expected first argument to be of type array or string, but found ${Xr(ai(o))} instead.`);if(this.endIndex){const _=this.endIndex.evaluate(n);return o.slice(u,_)}return o.slice(u)}eachChild(n){n(this.input),n(this.beginIndex),this.endIndex&&n(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const n=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),n]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}function dh(c,n){return c==="=="||c==="!="?n.kind==="boolean"||n.kind==="string"||n.kind==="number"||n.kind==="null"||n.kind==="value":n.kind==="string"||n.kind==="number"||n.kind==="value"}function ph(c,n,o,u){return u.compare(n,o)===0}function Js(c,n,o){const u=c!=="=="&&c!=="!=";return class qF{constructor(d,y,E){this.type=ar,this.lhs=d,this.rhs=y,this.collator=E,this.hasUntypedArgument=d.type.kind==="value"||y.type.kind==="value"}static parse(d,y){if(d.length!==3&&d.length!==4)return y.error("Expected two or three arguments.");const E=d[0];let M=y.parse(d[1],1,gr);if(!M)return null;if(!dh(E,M.type))return y.concat(1).error(`"${E}" comparisons are not supported for type '${Xr(M.type)}'.`);let k=y.parse(d[2],2,gr);if(!k)return null;if(!dh(E,k.type))return y.concat(2).error(`"${E}" comparisons are not supported for type '${Xr(k.type)}'.`);if(M.type.kind!==k.type.kind&&M.type.kind!=="value"&&k.type.kind!=="value")return y.error(`Cannot compare types '${Xr(M.type)}' and '${Xr(k.type)}'.`);u&&(M.type.kind==="value"&&k.type.kind!=="value"?M=new Os(k.type,[M]):M.type.kind!=="value"&&k.type.kind==="value"&&(k=new Os(M.type,[k])));let w=null;if(d.length===4){if(M.type.kind!=="string"&&k.type.kind!=="string"&&M.type.kind!=="value"&&k.type.kind!=="value")return y.error("Cannot use collator to compare non-string types.");if(w=y.parse(d[3],3,ic),!w)return null}return new qF(M,k,w)}evaluate(d){const y=this.lhs.evaluate(d),E=this.rhs.evaluate(d);if(u&&this.hasUntypedArgument){const M=ai(y),k=ai(E);if(M.kind!==k.kind||M.kind!=="string"&&M.kind!=="number")throw new Pi(`Expected arguments for "${c}" to be (string, string) or (number, number), but found (${M.kind}, ${k.kind}) instead.`)}if(this.collator&&!u&&this.hasUntypedArgument){const M=ai(y),k=ai(E);if(M.kind!=="string"||k.kind!=="string")return n(d,y,E)}return this.collator?o(d,y,E,this.collator.evaluate(d)):n(d,y,E)}eachChild(d){d(this.lhs),d(this.rhs),this.collator&&d(this.collator)}outputDefined(){return!0}serialize(){const d=[c];return this.eachChild(y=>{d.push(y.serialize())}),d}}}const D0=Js("==",function(c,n,o){return n===o},ph),pm=Js("!=",function(c,n,o){return n!==o},function(c,n,o,u){return!ph(0,n,o,u)}),L0=Js("<",function(c,n,o){return n<o},function(c,n,o,u){return u.compare(n,o)<0}),Kd=Js(">",function(c,n,o){return n>o},function(c,n,o,u){return u.compare(n,o)>0}),z0=Js("<=",function(c,n,o){return n<=o},function(c,n,o,u){return u.compare(n,o)<=0}),Mf=Js(">=",function(c,n,o){return n>=o},function(c,n,o,u){return u.compare(n,o)>=0});class Jd{constructor(n,o,u,_,d,y){this.type=xr,this.number=n,this.locale=o,this.currency=u,this.unit=_,this.minFractionDigits=d,this.maxFractionDigits=y}static parse(n,o){if(n.length!==3)return o.error("Expected two arguments.");const u=o.parse(n[1],1,_n);if(!u)return null;const _=n[2];if(typeof _!="object"||Array.isArray(_))return o.error("NumberFormat options argument must be an object.");let d=null;if(_.locale&&(d=o.parseObjectValue(_.locale,2,"locale",xr),!d))return null;let y=null;if(_.currency&&(y=o.parseObjectValue(_.currency,2,"currency",xr),!y))return null;let E=null;if(_.unit&&(E=o.parseObjectValue(_.unit,2,"unit",xr),!E))return null;let M=null;if(_["min-fraction-digits"]&&(M=o.parseObjectValue(_["min-fraction-digits"],2,"min-fraction-digits",_n),!M))return null;let k=null;return _["max-fraction-digits"]&&(k=o.parseObjectValue(_["max-fraction-digits"],2,"max-fraction-digits",_n),!k)?null:new Jd(u,d,y,E,M,k)}evaluate(n){return new Intl.NumberFormat(this.locale?this.locale.evaluate(n):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(n):void 0,unit:this.unit?this.unit.evaluate(n):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(n):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(n):void 0}).format(this.number.evaluate(n))}eachChild(n){n(this.number),this.locale&&n(this.locale),this.currency&&n(this.currency),this.unit&&n(this.unit),this.minFractionDigits&&n(this.minFractionDigits),this.maxFractionDigits&&n(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const n={};return this.locale&&(n.locale=this.locale.serialize()),this.currency&&(n.currency=this.currency.serialize()),this.unit&&(n.unit=this.unit.serialize()),this.minFractionDigits&&(n["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(n["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),n]}}class yc{constructor(n){this.type=_n,this.input=n}static parse(n,o){if(n.length!==2)return o.error(`Expected 1 argument, but found ${n.length-1} instead.`);const u=o.parse(n[1],1);return u?u.type.kind!=="array"&&u.type.kind!=="string"&&u.type.kind!=="value"?o.error(`Expected argument of type string or array, but found ${Xr(u.type)} instead.`):new yc(u):null}evaluate(n){const o=this.input.evaluate(n);if(typeof o=="string"||Array.isArray(o))return o.length;throw new Pi(`Expected value to be of type string or array, but found ${Xr(ai(o))} instead.`)}eachChild(n){n(this.input)}outputDefined(){return!1}serialize(){const n=["length"];return this.eachChild(o=>{n.push(o.serialize())}),n}}function vc(c){return function(){c=1831565813+(c|=0)|0;let n=Math.imul(c^c>>>15,1|c);return n=n+Math.imul(n^n>>>7,61|n)^n,((n^n>>>14)>>>0)/4294967296}}const Ol={"==":D0,"!=":pm,">":Kd,"<":L0,">=":Mf,"<=":z0,array:Os,at:cs,boolean:Os,case:Yd,coalesce:Ur,collator:gf,format:ac,image:_f,in:Cf,"index-of":Ks,interpolate:li,"interpolate-hcl":li,"interpolate-lab":li,length:yc,let:So,literal:_a,match:Xd,number:Os,"number-format":Jd,object:Os,slice:gc,step:Bo,string:Os,"to-boolean":El,"to-color":El,"to-number":El,"to-string":El,var:ls,within:Dn,distance:fc,config:dc};function yu(c,[n,o,u,_]){n=n.evaluate(c),o=o.evaluate(c),u=u.evaluate(c);const d=_?_.evaluate(c):1,y=tm(n,o,u,d);if(y)throw new Pi(y);return new _r(n/255*d,o/255*d,u/255*d,d)}function Of(c,[n,o,u,_]){n=n.evaluate(c),o=o.evaluate(c),u=u.evaluate(c);const d=_?_.evaluate(c):1,y=function(k,w,I,D){return typeof k=="number"&&k>=0&&k<=360?typeof w=="number"&&w>=0&&w<=100&&typeof I=="number"&&I>=0&&I<=100?D===void 0||typeof D=="number"&&D>=0&&D<=1?null:`Invalid hsla value [${[k,w,I,D].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid hsla value [${(typeof D=="number"?[k,w,I,D]:[k,w,I]).join(", ")}]: 's', and 'l' must be between 0 and 100.`:`Invalid hsla value [${(typeof D=="number"?[k,w,I,D]:[k,w,I]).join(", ")}]: 'h' must be between 0 and 360.`}(n,o,u,d);if(y)throw new Pi(y);const E=`hsla(${n}, ${o}%, ${u}%, ${d})`,M=_r.parse(E);if(!M)throw new Pi(`Failed to parse HSLA color: ${E}`);return M}function mm(c,n){return c in n}function Qd(c,n){const o=n[c];return o===void 0?null:o}function To(c){return{type:c}}function ep(c){return{result:"success",value:c}}function Ra(c){return{result:"error",value:c}}function vu(c,n){return!!c&&!!c.parameters&&c.parameters.indexOf(n)>-1}function mh(c){return c["property-type"]==="data-driven"}function tp(c){return vu(c.expression,"measure-light")}function _h(c){return vu(c.expression,"zoom")}function Ya(c){return!!c.expression&&c.expression.interpolated}function us(c){return typeof c=="object"&&c!==null&&!Array.isArray(c)}function xc(c){return c}function np(c,n){const o=n.type==="color",u=c.stops&&typeof c.stops[0][0]=="object",_=u||!(u||c.property!==void 0),d=c.type||(Ya(n)?"exponential":"interval");if(o&&((c=df({},c)).stops&&(c.stops=c.stops.map(k=>[k[0],_r.parse(k[1])])),c.default=_r.parse(c.default?c.default:n.default)),c.colorSpace&&c.colorSpace!=="rgb"&&!Wd[c.colorSpace])throw new Error(`Unknown color space: ${c.colorSpace}`);let y,E,M;if(d==="exponential")y=If;else if(d==="interval")y=xa;else if(d==="categorical"){y=Il,E=Object.create(null);for(const k of c.stops)E[k[0]]=k[1];M=typeof c.stops[0][0]}else{if(d!=="identity")throw new Error(`Unknown function type "${d}"`);y=k0}if(u){const k={},w=[];for(let C=0;C<c.stops.length;C++){const P=c.stops[C],B=P[0].zoom;k[B]===void 0&&(k[B]={zoom:B,type:c.type,property:c.property,default:c.default,stops:[]},w.push(B)),k[B].stops.push([P[0].value,P[1]])}const I=[];for(const C of w)I.push([k[C].zoom,np(k[C],n)]);const D={name:"linear"};return{kind:"composite",interpolationType:D,interpolationFactor:li.interpolationFactor.bind(void 0,D),zoomStops:I.map(C=>C[0]),evaluate:({zoom:C},P)=>If({stops:I,base:c.base},n,C).evaluate(C,P)}}if(_){const k=d==="exponential"?{name:"exponential",base:c.base!==void 0?c.base:1}:null;return{kind:"camera",interpolationType:k,interpolationFactor:li.interpolationFactor.bind(void 0,k),zoomStops:c.stops.map(w=>w[0]),evaluate:({zoom:w})=>y(c,n,w,E,M)}}return{kind:"source",evaluate(k,w){const I=w&&w.properties?w.properties[c.property]:void 0;return I===void 0?Fo(c.default,n.default):y(c,n,I,E,M)}}}function Fo(c,n,o){return c!==void 0?c:n!==void 0?n:o!==void 0?o:void 0}function Il(c,n,o,u,_){return Fo(typeof o===_?u[o]:void 0,c.default,n.default)}function xa(c,n,o){if(Is(o)!=="number")return Fo(c.default,n.default);const u=c.stops.length;if(u===1||o<=c.stops[0][0])return c.stops[0][1];if(o>=c.stops[u-1][0])return c.stops[u-1][1];const _=fu(c.stops.map(d=>d[0]),o);return c.stops[_][1]}function If(c,n,o){const u=c.base!==void 0?c.base:1;if(Is(o)!=="number")return Fo(c.default,n.default);const _=c.stops.length;if(_===1||o<=c.stops[0][0])return c.stops[0][1];if(o>=c.stops[_-1][0])return c.stops[_-1][1];const d=fu(c.stops.map(w=>w[0]),o),y=function(w,I,D,C){const P=C-D,B=w-D;return P===0?0:I===1?B/P:(Math.pow(I,B)-1)/(Math.pow(I,P)-1)}(o,u,c.stops[d][0],c.stops[d+1][0]),E=c.stops[d][1],M=c.stops[d+1][1];let k=wl[n.type]||xc;if(c.colorSpace&&c.colorSpace!=="rgb"){const w=Wd[c.colorSpace];k=(I,D)=>w.reverse(w.interpolate(w.forward(I),w.forward(D),y))}return typeof E.evaluate=="function"?{evaluate(...w){const I=E.evaluate.apply(void 0,w),D=M.evaluate.apply(void 0,w);if(I!==void 0&&D!==void 0)return k(I,D,y)}}:k(E,M,y)}function k0(c,n,o){return n.type==="color"?o=_r.parse(o):n.type==="formatted"?o=ta.fromString(o.toString()):n.type==="resolvedImage"?o=Oa.build(o.toString()):Is(o)===n.type||n.type==="enum"&&n.values[o]||(o=void 0),Fo(o,c.default,n.default)}so.register(Ol,{error:[{kind:"error"},[xr],(c,[n])=>{throw new Pi(n.evaluate(c))}],typeof:[xr,[gr],(c,[n])=>Xr(ai(n.evaluate(c)))],"to-rgba":[Wr(_n,4),[pa],(c,[n])=>n.evaluate(c).toRenderColor(null).toArray()],"to-hsla":[Wr(_n,4),[pa],(c,[n])=>n.evaluate(c).toRenderColor(null).toHslaArray()],rgb:[pa,[_n,_n,_n],yu],rgba:[pa,[_n,_n,_n,_n],yu],hsl:[pa,[_n,_n,_n],Of],hsla:[pa,[_n,_n,_n,_n],Of],has:{type:ar,overloads:[[[xr],(c,[n])=>mm(n.evaluate(c),c.properties())],[[xr,is],(c,[n,o])=>mm(n.evaluate(c),o.evaluate(c))]]},get:{type:gr,overloads:[[[xr],(c,[n])=>Qd(n.evaluate(c),c.properties())],[[xr,is],(c,[n,o])=>Qd(n.evaluate(c),o.evaluate(c))]]},"feature-state":[gr,[xr],(c,[n])=>Qd(n.evaluate(c),c.featureState||{})],properties:[is,[],c=>c.properties()],"geometry-type":[xr,[],c=>c.geometryType()],id:[gr,[],c=>c.id()],zoom:[_n,[],c=>c.globals.zoom],pitch:[_n,[],c=>c.globals.pitch||0],"distance-from-center":[_n,[],c=>c.distanceFromCenter()],"measure-light":[_n,[xr],(c,[n])=>c.measureLight(n.evaluate(c))],"heatmap-density":[_n,[],c=>c.globals.heatmapDensity||0],"line-progress":[_n,[],c=>c.globals.lineProgress||0],"raster-value":[_n,[],c=>c.globals.rasterValue||0],"raster-particle-speed":[_n,[],c=>c.globals.rasterParticleSpeed||0],"sky-radial-progress":[_n,[],c=>c.globals.skyRadialProgress||0],accumulated:[gr,[],c=>c.globals.accumulated===void 0?null:c.globals.accumulated],"+":[_n,To(_n),(c,n)=>{let o=0;for(const u of n)o+=u.evaluate(c);return o}],"*":[_n,To(_n),(c,n)=>{let o=1;for(const u of n)o*=u.evaluate(c);return o}],"-":{type:_n,overloads:[[[_n,_n],(c,[n,o])=>n.evaluate(c)-o.evaluate(c)],[[_n],(c,[n])=>-n.evaluate(c)]]},"/":[_n,[_n,_n],(c,[n,o])=>n.evaluate(c)/o.evaluate(c)],"%":[_n,[_n,_n],(c,[n,o])=>n.evaluate(c)%o.evaluate(c)],ln2:[_n,[],()=>Math.LN2],pi:[_n,[],()=>Math.PI],e:[_n,[],()=>Math.E],"^":[_n,[_n,_n],(c,[n,o])=>Math.pow(n.evaluate(c),o.evaluate(c))],sqrt:[_n,[_n],(c,[n])=>Math.sqrt(n.evaluate(c))],log10:[_n,[_n],(c,[n])=>Math.log(n.evaluate(c))/Math.LN10],ln:[_n,[_n],(c,[n])=>Math.log(n.evaluate(c))],log2:[_n,[_n],(c,[n])=>Math.log(n.evaluate(c))/Math.LN2],sin:[_n,[_n],(c,[n])=>Math.sin(n.evaluate(c))],cos:[_n,[_n],(c,[n])=>Math.cos(n.evaluate(c))],tan:[_n,[_n],(c,[n])=>Math.tan(n.evaluate(c))],asin:[_n,[_n],(c,[n])=>Math.asin(n.evaluate(c))],acos:[_n,[_n],(c,[n])=>Math.acos(n.evaluate(c))],atan:[_n,[_n],(c,[n])=>Math.atan(n.evaluate(c))],min:[_n,To(_n),(c,n)=>Math.min(...n.map(o=>o.evaluate(c)))],max:[_n,To(_n),(c,n)=>Math.max(...n.map(o=>o.evaluate(c)))],abs:[_n,[_n],(c,[n])=>Math.abs(n.evaluate(c))],round:[_n,[_n],(c,[n])=>{const o=n.evaluate(c);return o<0?-Math.round(-o):Math.round(o)}],floor:[_n,[_n],(c,[n])=>Math.floor(n.evaluate(c))],ceil:[_n,[_n],(c,[n])=>Math.ceil(n.evaluate(c))],"filter-==":[ar,[xr,gr],(c,[n,o])=>c.properties()[n.value]===o.value],"filter-id-==":[ar,[gr],(c,[n])=>c.id()===n.value],"filter-type-==":[ar,[xr],(c,[n])=>c.geometryType()===n.value],"filter-<":[ar,[xr,gr],(c,[n,o])=>{const u=c.properties()[n.value],_=o.value;return typeof u==typeof _&&u<_}],"filter-id-<":[ar,[gr],(c,[n])=>{const o=c.id(),u=n.value;return typeof o==typeof u&&o<u}],"filter->":[ar,[xr,gr],(c,[n,o])=>{const u=c.properties()[n.value],_=o.value;return typeof u==typeof _&&u>_}],"filter-id->":[ar,[gr],(c,[n])=>{const o=c.id(),u=n.value;return typeof o==typeof u&&o>u}],"filter-<=":[ar,[xr,gr],(c,[n,o])=>{const u=c.properties()[n.value],_=o.value;return typeof u==typeof _&&u<=_}],"filter-id-<=":[ar,[gr],(c,[n])=>{const o=c.id(),u=n.value;return typeof o==typeof u&&o<=u}],"filter->=":[ar,[xr,gr],(c,[n,o])=>{const u=c.properties()[n.value],_=o.value;return typeof u==typeof _&&u>=_}],"filter-id->=":[ar,[gr],(c,[n])=>{const o=c.id(),u=n.value;return typeof o==typeof u&&o>=u}],"filter-has":[ar,[gr],(c,[n])=>n.value in c.properties()],"filter-has-id":[ar,[],c=>c.id()!==null&&c.id()!==void 0],"filter-type-in":[ar,[Wr(xr)],(c,[n])=>n.value.indexOf(c.geometryType())>=0],"filter-id-in":[ar,[Wr(gr)],(c,[n])=>n.value.indexOf(c.id())>=0],"filter-in-small":[ar,[xr,Wr(gr)],(c,[n,o])=>o.value.indexOf(c.properties()[n.value])>=0],"filter-in-large":[ar,[xr,Wr(gr)],(c,[n,o])=>function(u,_,d,y){for(;d<=y;){const E=d+y>>1;if(_[E]===u)return!0;_[E]>u?y=E-1:d=E+1}return!1}(c.properties()[n.value],o.value,0,o.value.length-1)],all:{type:ar,overloads:[[[ar,ar],(c,[n,o])=>n.evaluate(c)&&o.evaluate(c)],[To(ar),(c,n)=>{for(const o of n)if(!o.evaluate(c))return!1;return!0}]]},any:{type:ar,overloads:[[[ar,ar],(c,[n,o])=>n.evaluate(c)||o.evaluate(c)],[To(ar),(c,n)=>{for(const o of n)if(o.evaluate(c))return!0;return!1}]]},"!":[ar,[ar],(c,[n])=>!n.evaluate(c)],"is-supported-script":[ar,[xr],(c,[n])=>{const o=c.globals&&c.globals.isSupportedScript;return!o||o(n.evaluate(c))}],upcase:[xr,[xr],(c,[n])=>n.evaluate(c).toUpperCase()],downcase:[xr,[xr],(c,[n])=>n.evaluate(c).toLowerCase()],concat:[xr,To(gr),(c,n)=>n.map(o=>as(o.evaluate(c))).join("")],"resolved-locale":[xr,[ic],(c,[n])=>n.evaluate(c).resolvedLocale()],random:[_n,[_n,_n,gr],(c,n)=>{const[o,u,_]=n.map(y=>y.evaluate(c));if(o>u||o===u)return o;let d;if(typeof _=="string")d=function(y){let E=0;if(y.length===0)return E;for(let M=0;M<y.length;M++)E=(E<<5)-E+y.charCodeAt(M),E|=0;return E}(_);else{if(typeof _!="number")throw new Pi(`Invalid seed input: ${_}`);d=_}return o+vc(d)()*(u-o)}]});class rp{constructor(n,o,u,_){this.expression=n,this._warningHistory={},this._evaluator=new im(u,_),this._defaultValue=o?function(d){return d.type==="color"&&(us(d.default)||Array.isArray(d.default))?new _r(0,0,0,0):d.type==="color"?_r.parse(d.default)||null:d.default===void 0?null:d.default}(o):null,this._enumValues=o&&o.type==="enum"?o.values:null,this.configDependencies=lo(n)}evaluateWithoutErrorHandling(n,o,u,_,d,y,E,M){return this._evaluator.globals=n,this._evaluator.feature=o,this._evaluator.featureState=u,this._evaluator.canonical=_||null,this._evaluator.availableImages=d||null,this._evaluator.formattedSection=y,this._evaluator.featureTileCoord=E||null,this._evaluator.featureDistanceData=M||null,this.expression.evaluate(this._evaluator)}evaluate(n,o,u,_,d,y,E,M){this._evaluator.globals=n,this._evaluator.feature=o||null,this._evaluator.featureState=u||null,this._evaluator.canonical=_||null,this._evaluator.availableImages=d||null,this._evaluator.formattedSection=y||null,this._evaluator.featureTileCoord=E||null,this._evaluator.featureDistanceData=M||null;try{const k=this.expression.evaluate(this._evaluator);if(k==null||typeof k=="number"&&k!=k)return this._defaultValue;if(this._enumValues&&!(k in this._enumValues))throw new Pi(`Expected value to be one of ${Object.keys(this._enumValues).map(w=>JSON.stringify(w)).join(", ")}, but found ${JSON.stringify(k)} instead.`);return k}catch(k){return this._warningHistory[k.message]||(this._warningHistory[k.message]=!0,typeof console<"u"&&console.warn(`Failed to evaluate expression "${JSON.stringify(this.expression.serialize())}". ${k.message}`)),this._defaultValue}}}function gh(c){return Array.isArray(c)&&c.length>0&&typeof c[0]=="string"&&c[0]in Ol}function Ri(c,n,o,u){const _=new mc(Ol,[],n?function(y){const E={color:pa,string:xr,number:_n,enum:xr,boolean:ar,formatted:ko,resolvedImage:nh};return y.type==="array"?Wr(E[y.value]||gr,y.length):E[y.type]}(n):void 0,void 0,void 0,o,u),d=_.parse(c,void 0,void 0,void 0,n&&n.type==="string"?{typeAnnotation:"coerce"}:void 0);return d?ep(new rp(d,n,o,u)):Ra(_.errors)}class yh{constructor(n,o,u,_){this.kind=n,this._styleExpression=o,this.isLightConstant=u,this.isLineProgressConstant=_,this.isStateDependent=n!=="constant"&&!ch(o.expression),this.configDependencies=lo(o.expression)}evaluateWithoutErrorHandling(n,o,u,_,d,y){return this._styleExpression.evaluateWithoutErrorHandling(n,o,u,_,d,y)}evaluate(n,o,u,_,d,y){return this._styleExpression.evaluate(n,o,u,_,d,y)}}class Pl{constructor(n,o,u,_,d,y){this.kind=n,this.zoomStops=u,this._styleExpression=o,this.isStateDependent=n!=="camera"&&!ch(o.expression),this.isLightConstant=d,this.isLineProgressConstant=y,this.configDependencies=lo(o.expression),this.interpolationType=_}evaluateWithoutErrorHandling(n,o,u,_,d,y){return this._styleExpression.evaluateWithoutErrorHandling(n,o,u,_,d,y)}evaluate(n,o,u,_,d,y){return this._styleExpression.evaluate(n,o,u,_,d,y)}interpolationFactor(n,o,u){return this.interpolationType?li.interpolationFactor(this.interpolationType,n,o,u):0}}function vh(c,n,o,u){if((c=Ri(c,n,o,u)).result==="error")return c;const _=c.value.expression,d=uu(_);if(!d&&!mh(n))return Ra([new Kn("","data expressions not supported")]);const y=Pa(_,["zoom","pitch","distance-from-center"]);if(!y&&!_h(n))return Ra([new Kn("","zoom expressions not supported")]);const E=Pa(_,["measure-light"]);if(!E&&!tp(n))return Ra([new Kn("","measure-light expression not supported")]);const M=Pa(_,["line-progress"]);if(!M&&!function(I){return vu(I.expression,"line-progress")}(n))return Ra([new Kn("","line-progress expression not supported")]);const k=n.expression&&n.expression.relaxZoomRestriction,w=Qs(_);return w||y||k?w instanceof Kn?Ra([w]):w instanceof li&&!Ya(n)?Ra([new Kn("",'"interpolate" expressions cannot be used with this property')]):ep(w?new Pl(d&&M?"camera":"composite",c.value,w.labels,w instanceof li?w.interpolation:void 0,E,M):new yh(d&&M?"constant":"source",c.value,E,M)):Ra([new Kn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression, or in the properties of atmosphere.')])}class xu{constructor(n,o){this._parameters=n,this._specification=o,df(this,np(this._parameters,this._specification))}static deserialize(n){return new xu(n._parameters,n._specification)}static serialize(n){return{_parameters:n._parameters,_specification:n._specification}}}function Qs(c){let n=null;if(c instanceof So)n=Qs(c.result);else if(c instanceof Ur){for(const o of c.args)if(n=Qs(o),n)break}else(c instanceof Bo||c instanceof li)&&c.input instanceof so&&c.input.name==="zoom"&&(n=c);return n instanceof Kn||c.eachChild(o=>{const u=Qs(o);u instanceof Kn?n=u:n&&u&&n!==u&&(n=new Kn("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),n}var bc,B0,N0=function(){if(B0)return bc;B0=1,bc=n;var c=3;function n(o,u,_){var d=this.cells=[];if(o instanceof ArrayBuffer){this.arrayBuffer=o;var y=new Int32Array(this.arrayBuffer);o=y[0],this.d=(u=y[1])+2*(_=y[2]);for(var E=0;E<this.d*this.d;E++){var M=y[c+E],k=y[c+E+1];d.push(M===k?null:y.subarray(M,k))}var w=y[c+d.length+1];this.keys=y.subarray(y[c+d.length],w),this.bboxes=y.subarray(w),this.insert=this._insertReadonly}else{this.d=u+2*_;for(var I=0;I<this.d*this.d;I++)d.push([]);this.keys=[],this.bboxes=[]}this.n=u,this.extent=o,this.padding=_,this.scale=u/o,this.uid=0;var D=_/u*o;this.min=-D,this.max=o+D}return n.prototype.insert=function(o,u,_,d,y){this._forEachCell(u,_,d,y,this._insertCell,this.uid++),this.keys.push(o),this.bboxes.push(u),this.bboxes.push(_),this.bboxes.push(d),this.bboxes.push(y)},n.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},n.prototype._insertCell=function(o,u,_,d,y,E){this.cells[y].push(E)},n.prototype.query=function(o,u,_,d,y){var E=this.min,M=this.max;if(o<=E&&u<=E&&M<=_&&M<=d&&!y)return Array.prototype.slice.call(this.keys);var k=[];return this._forEachCell(o,u,_,d,this._queryCell,k,{},y),k},n.prototype._queryCell=function(o,u,_,d,y,E,M,k){var w=this.cells[y];if(w!==null)for(var I=this.keys,D=this.bboxes,C=0;C<w.length;C++){var P=w[C];if(M[P]===void 0){var B=4*P;(k?k(D[B+0],D[B+1],D[B+2],D[B+3]):o<=D[B+2]&&u<=D[B+3]&&_>=D[B+0]&&d>=D[B+1])?(M[P]=!0,E.push(I[P])):M[P]=!1}}},n.prototype._forEachCell=function(o,u,_,d,y,E,M,k){for(var w=this._convertToCellCoord(o),I=this._convertToCellCoord(u),D=this._convertToCellCoord(_),C=this._convertToCellCoord(d),P=w;P<=D;P++)for(var B=I;B<=C;B++){var q=this.d*B+P;if((!k||k(this._convertFromCellCoord(P),this._convertFromCellCoord(B),this._convertFromCellCoord(P+1),this._convertFromCellCoord(B+1)))&&y.call(this,o,u,_,d,q,E,M,k))return}},n.prototype._convertFromCellCoord=function(o){return(o-this.padding)/this.scale},n.prototype._convertToCellCoord=function(o){return Math.max(0,Math.min(this.d-1,Math.floor(o*this.scale)+this.padding))},n.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var o=this.cells,u=c+this.cells.length+1+1,_=0,d=0;d<this.cells.length;d++)_+=this.cells[d].length;var y=new Int32Array(u+_+this.keys.length+this.bboxes.length);y[0]=this.extent,y[1]=this.n,y[2]=this.padding;for(var E=u,M=0;M<o.length;M++){var k=o[M];y[c+M]=E,y.set(k,E),E+=k.length}return y[c+o.length]=E,y.set(this.keys,E),y[c+o.length+1]=E+=this.keys.length,y.set(this.bboxes,E),E+=this.bboxes.length,y.buffer},bc}(),bu=O(N0);const Pf={};function hn(c,n,o={}){Object.defineProperty(c,"_classRegistryKey",{value:n,writable:!1}),Pf[n]={klass:c,omit:o.omit||[]}}hn(Object,"Object"),bu.serialize=function(c,n){const o=c.toArrayBuffer();return n&&n.add(o),{buffer:o}},bu.deserialize=function(c){return new bu(c.buffer)},Object.defineProperty(bu,"name",{value:"Grid"}),hn(bu,"Grid"),typeof DOMMatrix<"u"&&hn(DOMMatrix,"DOMMatrix"),hn(_r,"Color"),hn(Error,"Error"),hn(ta,"Formatted"),hn(Sl,"FormattedSection"),hn(Ii,"AJAXError"),hn(Oa,"ResolvedImage"),hn(xu,"StylePropertyFunction"),hn(rp,"StyleExpression",{omit:["_evaluator"]}),hn(Ms,"ImageIdWithOptions"),hn(Pl,"ZoomDependentExpression"),hn(yh,"ZoomConstantExpression"),hn(so,"CompoundExpression",{omit:["_evaluate"]});for(const c in Ol)Pf[Ol[c]._classRegistryKey]||hn(Ol[c],`Expression${c}`);function Rf(c){return c&&typeof ArrayBuffer<"u"&&(c instanceof ArrayBuffer||c.constructor&&c.constructor.name==="ArrayBuffer")}function xh(c){return self.ImageBitmap&&c instanceof ImageBitmap}function Rl(c,n){if(c==null||typeof c=="boolean"||typeof c=="number"||typeof c=="string"||c instanceof Boolean||c instanceof Number||c instanceof String||c instanceof Date||c instanceof RegExp)return c;if(Rf(c)||xh(c))return n&&n.add(c),c;if(ArrayBuffer.isView(c))return n&&n.add(c.buffer),c;if(c instanceof ImageData)return n&&n.add(c.data.buffer),c;if(Array.isArray(c)){const o=[];for(const u of c)o.push(Rl(u,n));return o}if(c instanceof Map){const o={$name:"Map"};for(const[u,_]of c.entries())o[u]=Rl(_);return o}if(c instanceof Set){const o={$name:"Set"};let u=0;for(const _ of c.values())o[++u]=Rl(_);return o}if(typeof c=="object"){const o=c.constructor,u=o._classRegistryKey;if(!u)throw new Error(`Can't serialize object of unregistered class "${u}".`);const _=o.serialize?o.serialize(c,n):{};if(!o.serialize){for(const d in c)c.hasOwnProperty(d)&&(Pf[u].omit.indexOf(d)>=0||(_[d]=Rl(c[d],n)));c instanceof Error&&(_.message=c.message)}if(_.$name)throw new Error("$name property is reserved for worker serialization logic.");return u!=="Object"&&(_.$name=u),_}throw new Error("can't serialize object of type "+typeof c)}function Eo(c){if(c==null||typeof c=="boolean"||typeof c=="number"||typeof c=="string"||c instanceof Boolean||c instanceof Number||c instanceof String||c instanceof Date||c instanceof RegExp||Rf(c)||xh(c)||ArrayBuffer.isView(c)||c instanceof ImageData)return c;if(Array.isArray(c))return c.map(Eo);if(typeof c=="object"){const n=c.$name||"Object";if(n==="Map"){const _=new Map;for(const d of Object.keys(c))d!=="$name"&&_.set(d,Eo(c[d]));return _}if(n==="Set"){const _=new Set;for(const d of Object.keys(c))d!=="$name"&&_.add(Eo(c[d]));return _}const{klass:o}=Pf[n];if(!o)throw new Error(`Can't deserialize unregistered class "${n}".`);if(o.deserialize)return o.deserialize(c);const u=Object.create(o.prototype);for(const _ of Object.keys(c))_!=="$name"&&(u[_]=Eo(c[_]));return u}throw new Error("can't deserialize object of type "+typeof c)}const Yt={"Latin-1 Supplement":c=>c>=128&&c<=255,Arabic:c=>c>=1536&&c<=1791,"Arabic Supplement":c=>c>=1872&&c<=1919,"Arabic Extended-A":c=>c>=2208&&c<=2303,"Hangul Jamo":c=>c>=4352&&c<=4607,"Unified Canadian Aboriginal Syllabics":c=>c>=5120&&c<=5759,Khmer:c=>c>=6016&&c<=6143,"Unified Canadian Aboriginal Syllabics Extended":c=>c>=6320&&c<=6399,"General Punctuation":c=>c>=8192&&c<=8303,"Letterlike Symbols":c=>c>=8448&&c<=8527,"Number Forms":c=>c>=8528&&c<=8591,"Miscellaneous Technical":c=>c>=8960&&c<=9215,"Control Pictures":c=>c>=9216&&c<=9279,"Optical Character Recognition":c=>c>=9280&&c<=9311,"Enclosed Alphanumerics":c=>c>=9312&&c<=9471,"Geometric Shapes":c=>c>=9632&&c<=9727,"Miscellaneous Symbols":c=>c>=9728&&c<=9983,"Miscellaneous Symbols and Arrows":c=>c>=11008&&c<=11263,"CJK Radicals Supplement":c=>c>=11904&&c<=12031,"Kangxi Radicals":c=>c>=12032&&c<=12255,"Ideographic Description Characters":c=>c>=12272&&c<=12287,"CJK Symbols and Punctuation":c=>c>=12288&&c<=12351,Hiragana:c=>c>=12352&&c<=12447,Katakana:c=>c>=12448&&c<=12543,Bopomofo:c=>c>=12544&&c<=12591,"Hangul Compatibility Jamo":c=>c>=12592&&c<=12687,Kanbun:c=>c>=12688&&c<=12703,"Bopomofo Extended":c=>c>=12704&&c<=12735,"CJK Strokes":c=>c>=12736&&c<=12783,"Katakana Phonetic Extensions":c=>c>=12784&&c<=12799,"Enclosed CJK Letters and Months":c=>c>=12800&&c<=13055,"CJK Compatibility":c=>c>=13056&&c<=13311,"CJK Unified Ideographs Extension A":c=>c>=13312&&c<=19903,"Yijing Hexagram Symbols":c=>c>=19904&&c<=19967,"CJK Unified Ideographs":c=>c>=19968&&c<=40959,"Yi Syllables":c=>c>=40960&&c<=42127,"Yi Radicals":c=>c>=42128&&c<=42191,"Hangul Jamo Extended-A":c=>c>=43360&&c<=43391,"Hangul Syllables":c=>c>=44032&&c<=55215,"Hangul Jamo Extended-B":c=>c>=55216&&c<=55295,"Private Use Area":c=>c>=57344&&c<=63743,"CJK Compatibility Ideographs":c=>c>=63744&&c<=64255,"Arabic Presentation Forms-A":c=>c>=64336&&c<=65023,"Vertical Forms":c=>c>=65040&&c<=65055,"CJK Compatibility Forms":c=>c>=65072&&c<=65103,"Small Form Variants":c=>c>=65104&&c<=65135,"Arabic Presentation Forms-B":c=>c>=65136&&c<=65279,"Halfwidth and Fullwidth Forms":c=>c>=65280&&c<=65519,Osage:c=>c>=66736&&c<=66815,"CJK Unified Ideographs Extension B":c=>c>=131072&&c<=173791};function ti(c){for(const n of c)if(Dl(n.charCodeAt(0)))return!0;return!1}function ra(c){for(const n of c)if(!ip(n.charCodeAt(0)))return!1;return!0}function ip(c){return!(Yt.Arabic(c)||Yt["Arabic Supplement"](c)||Yt["Arabic Extended-A"](c)||Yt["Arabic Presentation Forms-A"](c)||Yt["Arabic Presentation Forms-B"](c))}function Dl(c){return!(c!==746&&c!==747&&(c<4352||!(Yt["Bopomofo Extended"](c)||Yt.Bopomofo(c)||Yt["CJK Compatibility Forms"](c)&&!(c>=65097&&c<=65103)||Yt["CJK Compatibility Ideographs"](c)||Yt["CJK Compatibility"](c)||Yt["CJK Radicals Supplement"](c)||Yt["CJK Strokes"](c)||!(!Yt["CJK Symbols and Punctuation"](c)||c>=12296&&c<=12305||c>=12308&&c<=12319||c===12336)||Yt["CJK Unified Ideographs Extension A"](c)||Yt["CJK Unified Ideographs"](c)||Yt["Enclosed CJK Letters and Months"](c)||Yt["Hangul Compatibility Jamo"](c)||Yt["Hangul Jamo Extended-A"](c)||Yt["Hangul Jamo Extended-B"](c)||Yt["Hangul Jamo"](c)||Yt["Hangul Syllables"](c)||Yt.Hiragana(c)||Yt["Ideographic Description Characters"](c)||Yt.Kanbun(c)||Yt["Kangxi Radicals"](c)||Yt["Katakana Phonetic Extensions"](c)||Yt.Katakana(c)&&c!==12540||!(!Yt["Halfwidth and Fullwidth Forms"](c)||c===65288||c===65289||c===65293||c>=65306&&c<=65310||c===65339||c===65341||c===65343||c>=65371&&c<=65503||c===65507||c>=65512&&c<=65519)||!(!Yt["Small Form Variants"](c)||c>=65112&&c<=65118||c>=65123&&c<=65126)||Yt["Unified Canadian Aboriginal Syllabics"](c)||Yt["Unified Canadian Aboriginal Syllabics Extended"](c)||Yt["Vertical Forms"](c)||Yt["Yijing Hexagram Symbols"](c)||Yt["Yi Syllables"](c)||Yt["Yi Radicals"](c))))}function Ll(c){return!(Dl(c)||function(n){return!!(Yt["Latin-1 Supplement"](n)&&(n===167||n===169||n===174||n===177||n===188||n===189||n===190||n===215||n===247)||Yt["General Punctuation"](n)&&(n===8214||n===8224||n===8225||n===8240||n===8241||n===8251||n===8252||n===8258||n===8263||n===8264||n===8265||n===8273)||Yt["Letterlike Symbols"](n)||Yt["Number Forms"](n)||Yt["Miscellaneous Technical"](n)&&(n>=8960&&n<=8967||n>=8972&&n<=8991||n>=8996&&n<=9e3||n===9003||n>=9085&&n<=9114||n>=9150&&n<=9165||n===9167||n>=9169&&n<=9179||n>=9186&&n<=9215)||Yt["Control Pictures"](n)&&n!==9251||Yt["Optical Character Recognition"](n)||Yt["Enclosed Alphanumerics"](n)||Yt["Geometric Shapes"](n)||Yt["Miscellaneous Symbols"](n)&&!(n>=9754&&n<=9759)||Yt["Miscellaneous Symbols and Arrows"](n)&&(n>=11026&&n<=11055||n>=11088&&n<=11097||n>=11192&&n<=11243)||Yt["CJK Symbols and Punctuation"](n)||Yt.Katakana(n)||Yt["Private Use Area"](n)||Yt["CJK Compatibility Forms"](n)||Yt["Small Form Variants"](n)||Yt["Halfwidth and Fullwidth Forms"](n)||n===8734||n===8756||n===8757||n>=9984&&n<=10087||n>=10102&&n<=10131||n===65532||n===65533)}(c))}function bh(c){return c>=1424&&c<=2303||Yt["Arabic Presentation Forms-A"](c)||Yt["Arabic Presentation Forms-B"](c)}function wh(c,n){return!(!n&&bh(c)||c>=2304&&c<=3583||c>=3840&&c<=4255||Yt.Khmer(c))}function wc(c){for(const n of c)if(bh(n.charCodeAt(0)))return!0;return!1}const Df="deferred",Di="loading",Lf="loaded";let hs=null,co="unavailable",zl=null;const _m=function(c){c&&typeof c=="string"&&c.indexOf("NetworkError")>-1&&(co="error"),hs&&hs(c)};function zf(){Sc.fire(new As("pluginStateChange",{pluginStatus:co,pluginURL:zl}))}const Sc=new bl,Sh=function(){return co},Da=function(){if(co!==Df||!zl)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");co=Di,zf(),zl&&ii({url:zl},c=>{c?_m(c):(co=Lf,zf())})},Yr={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>co===Lf||Yr.applyArabicShaping!=null,isLoading:()=>co===Di,setState(c){co=c.pluginStatus,zl=c.pluginURL},isParsed:()=>Yr.applyArabicShaping!=null&&Yr.processBidirectionalText!=null&&Yr.processStyledBidirectionalText!=null,getPluginURL:()=>zl};class kr{constructor(n,o){this.zoom=n,o?(this.now=o.now,this.fadeDuration=o.fadeDuration,this.transition=o.transition,this.pitch=o.pitch,this.brightness=o.brightness):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0,this.brightness=0)}isSupportedScript(n){return function(o,u){for(const _ of o)if(!wh(_.charCodeAt(0),u))return!1;return!0}(n,Yr.isLoaded())}}class Tc{constructor(n,o,u,_){this.property=n,this.value=o,this.expression=function(d,y,E,M){if(us(d))return new xu(d,y);if(gh(d)||Array.isArray(d)&&d.length>0){const k=vh(d,y,E,M);if(k.result==="error")throw new Error(k.value.map(w=>`${w.key}: ${w.message}`).join(", "));return k.value}{let k=d;return typeof d=="string"&&y.type==="color"&&(k=_r.parse(d)),{kind:"constant",configDependencies:new Set,evaluate:()=>k}}}(o===void 0?n.specification.default:o,n.specification,u,_)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(n,o,u){return this.property.possiblyEvaluate(this,n,o,u)}}class Ec{constructor(n,o,u){this.property=n,this.value=new Tc(n,void 0,o,u)}transitioned(n,o){return new Ds(this.property,this.value,o,ua({},n.transition,this.transition),n.now)}untransitioned(){return new Ds(this.property,this.value,null,{},0)}}class Th{constructor(n,o,u){this._properties=n,this._values=Object.create(n.defaultTransitionablePropertyValues),this._scope=o,this._options=u,this.configDependencies=new Set}getValue(n){return ea(this._values[n].value.value)}setValue(n,o){this._values.hasOwnProperty(n)||(this._values[n]=new Ec(this._values[n].property,this._scope,this._options)),this._values[n].value=new Tc(this._values[n].property,o===null?void 0:ea(o),this._scope,this._options),this._values[n].value.expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[n].value.expression.configDependencies]))}setTransitionOrValue(n,o){o&&(this._options=o);const u=this._properties.properties;if(n)for(const _ in n){const d=n[_];if(ha(_,"-transition")){const y=_.slice(0,-11);u[y]&&this.setTransition(y,d)}else u.hasOwnProperty(_)&&this.setValue(_,d)}}getTransition(n){return ea(this._values[n].transition)}setTransition(n,o){this._values.hasOwnProperty(n)||(this._values[n]=new Ec(this._values[n].property)),this._values[n].transition=ea(o)||void 0}serialize(){const n={};for(const o of Object.keys(this._values)){const u=this.getValue(o);u!==void 0&&(n[o]=u);const _=this.getTransition(o);_!==void 0&&(n[`${o}-transition`]=_)}return n}transitioned(n,o){const u=new Ac(this._properties);for(const _ of Object.keys(this._values))u._values[_]=this._values[_].transitioned(n,o._values[_]);return u}untransitioned(){const n=new Ac(this._properties);for(const o of Object.keys(this._values))n._values[o]=this._values[o].untransitioned();return n}}class Ds{constructor(n,o,u,_,d){const y=_.delay||0,E=_.duration||0;d=d||0,this.property=n,this.value=o,this.begin=d+y,this.end=this.begin+E,n.specification.transition&&(_.delay||_.duration)&&(this.prior=u)}possiblyEvaluate(n,o,u){const _=n.now||0,d=this.value.possiblyEvaluate(n,o,u),y=this.prior;if(y){if(_>this.end)return this.prior=null,d;if(this.value.isDataDriven())return this.prior=null,d;if(_<this.begin)return y.possiblyEvaluate(n,o,u);{const E=(_-this.begin)/(this.end-this.begin);return this.property.interpolate(y.possiblyEvaluate(n,o,u),d,Aa(E))}}return d}}class Ac{constructor(n){this._properties=n,this._values=Object.create(n.defaultTransitioningPropertyValues)}possiblyEvaluate(n,o,u){const _=new wu(this._properties);for(const d of Object.keys(this._values))_._values[d]=this._values[d].possiblyEvaluate(n,o,u);return _}hasTransition(){for(const n of Object.keys(this._values))if(this._values[n].prior)return!0;return!1}}class Cc{constructor(n,o,u){this._properties=n,this._values=Object.create(n.defaultPropertyValues),this._scope=o,this._options=u,this.configDependencies=new Set}getValue(n){return ea(this._values[n].value)}setValue(n,o){this._values[n]=new Tc(this._values[n].property,o===null?void 0:ea(o),this._scope,this._options),this._values[n].expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[n].expression.configDependencies]))}serialize(){const n={};for(const o of Object.keys(this._values)){const u=this.getValue(o);u!==void 0&&(n[o]=u)}return n}possiblyEvaluate(n,o,u){const _=new wu(this._properties);for(const d of Object.keys(this._values))_._values[d]=this._values[d].possiblyEvaluate(n,o,u);return _}}class Mc{constructor(n,o,u){this.property=n,this.value=o,this.parameters=u}isConstant(){return this.value.kind==="constant"}constantOr(n){return this.value.kind==="constant"?this.value.value:n}evaluate(n,o,u,_){return this.property.evaluate(this.value,this.parameters,n,o,u,_)}}class wu{constructor(n){this._properties=n,this._values=Object.create(n.defaultPossiblyEvaluatedValues)}get(n){return this._values[n]}}class qt{constructor(n){this.specification=n}possiblyEvaluate(n,o){return n.expression.evaluate(o)}interpolate(n,o,u){const _=wl[this.specification.type];return _?_(n,o,u):n}}class cn{constructor(n,o){this.specification=n,this.overrides=o}possiblyEvaluate(n,o,u,_){return new Mc(this,n.expression.kind==="constant"||n.expression.kind==="camera"?{kind:"constant",value:n.expression.evaluate(o,null,{},u,_)}:n.expression,o)}interpolate(n,o,u){if(n.value.kind!=="constant"||o.value.kind!=="constant")return n;if(n.value.value===void 0||o.value.value===void 0)return new Mc(this,{kind:"constant",value:void 0},n.parameters);const _=wl[this.specification.type];return _?new Mc(this,{kind:"constant",value:_(n.value.value,o.value.value,u)},n.parameters):n}evaluate(n,o,u,_,d,y){return n.kind==="constant"?n.value:n.evaluate(o,u,_,d,y)}}class Su{constructor(n){this.specification=n}possiblyEvaluate(n,o,u,_){return!!n.expression.evaluate(o,null,{},u,_)}interpolate(){return!1}}class ni{constructor(n){this.properties=n,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const o=new kr(0,{});for(const u in n){const _=n[u];_.specification.overridable&&this.overridableProperties.push(u);const d=this.defaultPropertyValues[u]=new Tc(_,void 0),y=this.defaultTransitionablePropertyValues[u]=new Ec(_);this.defaultTransitioningPropertyValues[u]=y.untransitioned(),this.defaultPossiblyEvaluatedValues[u]=d.possiblyEvaluate(o)}}}hn(cn,"DataDrivenProperty"),hn(qt,"DataConstantProperty"),hn(Su,"ColorRampProperty");var st=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"fragment":{"type":"boolean"},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360},"pitch":{"type":"number","default":0},"light":{"type":"light"},"lights":{"required":false,"type":"array","value":"light-3d"},"terrain":{"type":"terrain","optional":true},"fog":{"type":"fog"},"snow":{"type":"snow","experimental":true},"rain":{"type":"rain","experimental":true},"camera":{"type":"camera"},"color-theme":{"type":"colorTheme"},"indoor":{"type":"indoor","experimental":true},"imports":{"type":"array","value":"import"},"schema":{"type":"schema"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string","default":"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"},"models":{"type":"models"},"featuresets":{"experimental":true,"type":"featuresets"}},"featuresets":{"experimental":true,"*":{"type":"featureset"}},"featureset":{"experimental":true,"metadata":{"experimental":true,"type":"*"},"selectors":{"experimental":true,"type":"array","value":"selector"}},"selector":{"experimental":true,"layer":{"experimental":true,"type":"string","required":true},"properties":{"experimental":true,"type":"selectorProperty","required":false},"featureNamespace":{"experimental":true,"type":"string","required":false},"_uniqueFeatureID":{"experimental":true,"type":"boolean","private":true,"required":false}},"selectorProperty":{"experimental":true,"*":{"experimental":true,"type":"*"}},"model":{"type":"string","required":true},"import":{"id":{"type":"string","required":true},"url":{"type":"string","required":true},"config":{"type":"config"},"data":{"type":"$root"},"color-theme":{"type":"colorTheme","optional":true}},"config":{"*":{"type":"*"}},"schema":{"*":{"type":"option"}},"option":{"default":{"type":"*","property-type":"data-constant","expression":{},"required":true},"type":{"type":"enum","values":{"string":1,"number":1,"boolean":1,"color":1}},"array":{"type":"boolean"},"minValue":{"type":"number"},"maxValue":{"type":"number"},"stepValue":{"type":"number"},"values":{"type":"array","value":"*"},"metadata":{"type":"*"}},"models":{"*":{"type":"model"}},"light-3d":{"id":{"type":"string","required":true},"properties":{"type":"properties"},"type":{"type":"enum","values":{"ambient":{},"directional":{},"flat":{}}}},"properties":["properties_light_directional","properties_light_ambient","properties_light_flat"],"properties_light_directional":{"direction":{"type":"array","default":[210,30],"minimum":[0,0],"maximum":[360,90],"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"cast-shadows":{"type":"boolean","default":false,"property-type":"data-constant"},"shadow-quality":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"expression":{"parameters":["zoom"]},"experimental":true},"shadow-intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_ambient":{"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_flat":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_raster_array","source_geojson","source_video","source_image","source_model"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":1,"mapbox":1},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_array":{"experimental":true,"type":{"required":true,"type":"enum","values":{"raster-array":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"rasterLayers":{"type":"*"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":1}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"},"dynamic":{"type":"boolean","default":false}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":1}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":1}},"url":{"required":false,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_model":{"type":{"required":true,"type":"enum","values":{"model":1,"batched-model":1}},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"tiles":{"type":"array","value":"string"}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"raster-particle":{"experimental":true},"hillshade":{},"model":{"experimental":true},"background":{},"sky":{},"slot":{},"clip":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"slot":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_clip","layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_raster-particle","layout_hillshade","layout_background","layout_sky","layout_model"],"layout_background":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_model":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"model-id":{"type":"string","default":"","property-type":"data-driven","expression":{"parameters":["zoom","feature"]}}},"layout_clip":{"clip-layer-types":{"type":"array","value":"enum","values":{"model":1,"symbol":1},"default":[],"expression":{},"property-type":"data-constant"},"clip-layer-scope":{"type":"array","value":"string","default":[],"expression":{},"property-type":"data-constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"fill-elevation-reference":{"type":"enum","values":{"none":1,"hd-road-base":1,"hd-road-markup":1},"default":"none","experimental":true,"private":true,"expression":{},"property-type":"data-constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"circle-elevation-reference":{"type":"enum","values":{"none":1,"hd-road-markup":1},"default":"none","experimental":true,"expression":{},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","experimental":true,"default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":1,"round":1,"square":1},"default":"butt","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":1,"round":1,"miter":1,"none":1},"default":"miter","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-z-offset":{"type":"number","experimental":true,"default":0,"expression":{"parameters":["zoom","feature","line-progress"]},"property-type":"data-driven"},"line-elevation-reference":{"type":"enum","values":{"none":1,"sea":1,"ground":1,"hd-road-markup":1},"default":"none","experimental":true,"expression":{},"property-type":"data-constant"},"line-cross-slope":{"type":"number","experimental":true,"expression":{},"property-type":"constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"line-width-unit":{"type":"enum","values":{"pixels":1,"meters":1},"default":"pixels","experimental":true,"private":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":1,"line":1,"line-center":1},"default":"point","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":1,"viewport-y":1,"source":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-z-elevate":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-elevation-reference":{"type":"enum","values":{"sea":1,"ground":1,"hd-road-markup":1},"default":"ground","experimental":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-size-scale-range":{"type":"array","value":"number","length":2,"default":[0.8,2],"minimum":0.1,"maximum":10,"experimental":true,"private":true,"expression":{},"property-type":"data-constant"},"icon-text-fit":{"type":"enum","values":{"none":1,"width":1,"height":1,"both":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size-scale-range":{"type":"array","value":"number","length":2,"default":[0.8,2],"minimum":0.1,"maximum":10,"experimental":true,"private":true,"expression":{},"property-type":"data-constant"},"text-max-width":{"type":"number","default":10,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":1,"left":1,"center":1,"right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","default":0,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":1,"vertical":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":1,"uppercase":1,"lowercase":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster-particle":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_hillshade":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_raster":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_raster-particle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_clip":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_model":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":1,"!=":1,">":1,">=":1,"<":1,"<=":1,"in":1,"!in":1,"all":1,"any":1,"none":1,"has":1,"!has":1}},"geometry_type":{"type":"enum","values":{"Point":1,"LineString":1,"Polygon":1}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":1,"exponential":1,"interval":1,"categorical":1},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":1,"lab":1,"hcl":1},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vertical-range":{"type":"array","default":[0,0],"minimum":0,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}}},"snow":{"density":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],11,0,13,0.85],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"opacity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],11,0,13,0.3],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette-color":{"type":"color","property-type":"data-constant","default":"#ffffff","experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"center-thinning":{"type":"number","property-type":"data-constant","default":0.4,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"direction":{"type":"array","default":[0,50],"minimum":0,"maximum":360,"length":2,"value":"number","property-type":"data-constant","transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"flake-size":{"type":"number","property-type":"data-constant","default":0.71,"minimum":0,"maximum":5,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true}},"rain":{"density":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],11,0,13,0.5],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["measure-light","brightness"],0,"#03113d",0.3,"#a8adbc"],"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"opacity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["measure-light","brightness"],0,0.88,1,0.7],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],11,0,13,1],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["measure-light","brightness"],0,"#001736",0.3,"#464646"],"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"center-thinning":{"type":"number","property-type":"data-constant","default":0.57,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"direction":{"type":"array","default":[0,80],"minimum":0,"maximum":360,"length":2,"value":"number","property-type":"data-constant","transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"droplet-size":{"type":"array","default":[2.6,18.2],"minimum":0,"maximum":50,"length":2,"value":"number","property-type":"data-constant","transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"distortion-strength":{"type":"number","property-type":"data-constant","default":0.7,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true}},"camera":{"camera-projection":{"type":"enum","values":{"perspective":1,"orthographic":1},"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"default":"perspective","property-type":"data-constant"}},"colorTheme":{"data":{"type":"string","property-type":"data-constant","expression":{}}},"indoor":{"floorplanFeaturesetId":{"type":"string","experimental":true,"property-type":"data-constant","expression":{}},"buildingFeaturesetId":{"type":"string","experimental":true,"property-type":"data-constant","expression":{}}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":1,"equalEarth":1,"equirectangular":1,"lambertConformalConic":1,"mercator":1,"naturalEarth":1,"winkelTripel":1,"globe":1},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_raster-particle","paint_hillshade","paint_background","paint_sky","paint_model"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"fill-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-height-alignment":{"type":"enum","experimental":true,"values":{"terrain":1,"flat":1},"default":"flat","property-type":"data-constant"},"fill-extrusion-base-alignment":{"type":"enum","experimental":true,"values":{"terrain":1,"flat":1},"default":"terrain","property-type":"data-constant"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-wall-radius":{"property-type":"data-constant","type":"number","experimental":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-radius":{"property-type":"data-constant","type":"number","experimental":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-attenuation":{"property-type":"data-constant","type":"number","experimental":true,"default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-flood-light-color":{"property-type":"data-constant","type":"color","experimental":true,"default":"#ffffff","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-intensity":{"property-type":"data-constant","type":"number","experimental":true,"default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-wall-radius":{"property-type":"data-driven","type":"number","experimental":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-radius":{"property-type":"data-driven","type":"number","experimental":true,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-attenuation":{"property-type":"data-constant","type":"number","experimental":true,"default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-vertical-scale":{"property-type":"data-constant","type":"number","experimental":true,"default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-rounded-roof":{"property-type":"data-constant","type":"boolean","default":true,"experimental":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"fill-extrusion-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"fill-extrusion-line-width":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-cast-shadows":{"type":"boolean","default":true,"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light","line-progress"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"property-type":"constant"},"line-trim-fade-range":{"type":"array","value":"number","experimental":true,"length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-trim-color":{"type":"color","experimental":true,"default":"transparent","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-border-width":{"type":"number","private":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-border-color":{"type":"color","private":true,"default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-occlusion-opacity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"property-type":"data-constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"text-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-image-cross-fade":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"transition":true},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-color-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"symbol-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-value"]},"property-type":"color-ramp"},"raster-color-mix":{"type":"array","default":[0.2126,0.7152,0.0722,0],"length":4,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color-range":{"type":"array","length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":1,"nearest":1},"default":"linear","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"raster-array-band":{"type":"string","required":false,"experimental":true,"property-type":"data-constant"},"raster-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster-particle":{"raster-particle-array-band":{"type":"string","required":false,"property-type":"data-constant"},"raster-particle-count":{"type":"number","default":512,"minimum":1,"property-type":"data-constant"},"raster-particle-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-particle-speed"]},"property-type":"color-ramp"},"raster-particle-max-speed":{"type":"number","default":1,"minimum":1,"property-type":"data-constant"},"raster-particle-speed-factor":{"type":"number","default":0.2,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-particle-fade-opacity-factor":{"type":"number","default":0.98,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-particle-reset-rate-factor":{"type":"number","default":0.8,"minimum":0,"maximum":1,"property-type":"data-constant"},"raster-particle-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_background":{"background-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":[]},"experimental":true,"property-type":"data-constant"},"background-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":1,"atmosphere":1},"default":"atmosphere","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","default":10,"minimum":0,"maximum":100,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","value":"number","default":[0,0],"length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","default":90,"minimum":0,"maximum":180,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_model":{"model-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"property-type":"data-driven"},"model-rotation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-scale":{"type":"array","value":"number","length":3,"default":[1,1,1],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-translation":{"type":"array","value":"number","length":3,"default":[0,0,0],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-color":{"type":"color","default":"#ffffff","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light","zoom"]},"transition":true},"model-color-mix-intensity":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-type":{"type":"enum","values":{"common-3d":1,"location-indicator":1},"default":"common-3d","property-type":"data-constant"},"model-cast-shadows":{"type":"boolean","default":true,"property-type":"data-constant"},"model-receive-shadows":{"type":"boolean","default":true,"property-type":"data-constant"},"model-ambient-occlusion-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant","transition":true},"model-emissive-strength":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-roughness":{"type":"number","default":1,"minimum":0,"maximum":1,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state"]},"transition":true},"model-height-based-emissive-strength-multiplier":{"type":"array","default":[1,1,1,1,0],"length":5,"value":"number","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"model-front-cutoff":{"type":"array","private":true,"value":"number","property-type":"data-constant","expression":{"interpolated":true,"parameters":["zoom"]},"length":3,"default":[0,0,1],"minimum":[0,0,0],"maximum":[1,1,1]}},"transition":{"duration":{"type":"number","default":300,"minimum":0},"delay":{"type":"number","default":0,"minimum":0}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"*"}}}');function ap(c){return c instanceof Number||c instanceof String||c instanceof Boolean?c.valueOf():c}function kf(c){if(Array.isArray(c))return c.map(kf);if(c instanceof Object&&!(c instanceof Number||c instanceof String||c instanceof Boolean)){const n={};for(const o in c)n[o]=kf(c[o]);return n}return ap(c)}function gm(c){if(c===!0||c===!1)return!0;if(!Array.isArray(c)||c.length===0)return!1;switch(c[0]){case"has":return c.length>=2&&c[1]!=="$id"&&c[1]!=="$type";case"in":return c.length>=3&&(typeof c[1]!="string"||Array.isArray(c[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return c.length!==3||Array.isArray(c[1])||Array.isArray(c[2]);case"any":case"all":for(const n of c.slice(1))if(!gm(n)&&typeof n!="boolean")return!1;return!0;default:return!0}}function ym(c,n="",o=null,u="fill"){if(c==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};gm(c)||(c=Bf(c));const _=c;let d=!0;try{d=function(w){if(!Oc(w))return w;let I=kf(w);return xm(I),I=vm(I),I}(_)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(_,null,2)}
        `)}let y=null,E=null;if(u!=="background"&&u!=="sky"&&u!=="slot"){E=st[`filter_${u}`];const w=Ri(d,E,n,o);if(w.result==="error")throw new Error(w.value.map(I=>`${I.key}: ${I.message}`).join(", "));y=(I,D,C)=>w.value.evaluate(I,D,{},C)}let M=null,k=null;if(d!==_){const w=Ri(_,E,n,o);if(w.result==="error")throw new Error(w.value.map(I=>`${I.key}: ${I.message}`).join(", "));M=(I,D,C,P,B)=>w.value.evaluate(I,D,{},C,void 0,void 0,P,B),k=!uu(w.value.expression)}return{filter:y,dynamicFilter:M||void 0,needGeometry:bm(d),needFeature:!!k}}function vm(c){if(!Array.isArray(c))return c;const n=function(o){if(F0.has(o[0])){for(let u=1;u<o.length;u++)if(Oc(o[u]))return!0}return o}(c);return n===!0?n:n.map(o=>vm(o))}function xm(c){let n=!1;const o=[];if(c[0]==="case"){for(let u=1;u<c.length-1;u+=2)n=n||Oc(c[u]),o.push(c[u+1]);o.push(c[c.length-1])}else if(c[0]==="match"){n=n||Oc(c[1]);for(let u=2;u<c.length-1;u+=2)o.push(c[u+1]);o.push(c[c.length-1])}else if(c[0]==="step"){n=n||Oc(c[1]);for(let u=1;u<c.length-1;u+=2)o.push(c[u+1])}n&&(c.length=0,c.push("any",...o));for(let u=1;u<c.length;u++)xm(c[u])}function Oc(c){if(!Array.isArray(c))return!1;if((n=c[0])==="pitch"||n==="distance-from-center")return!0;var n;for(let o=1;o<c.length;o++)if(Oc(c[o]))return!0;return!1}const F0=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function j0(c,n){return c<n?-1:c>n?1:0}function bm(c){if(!Array.isArray(c))return!1;if(c[0]==="within"||c[0]==="distance")return!0;for(let n=1;n<c.length;n++)if(bm(c[n]))return!0;return!1}function Bf(c){if(!c)return!0;const n=c[0];return c.length<=1?n!=="any":n==="=="?kl(c[1],c[2],"=="):n==="!="?fs(kl(c[1],c[2],"==")):n==="<"||n===">"||n==="<="||n===">="?kl(c[1],c[2],n):n==="any"?(o=c.slice(1),["any"].concat(o.map(Bf))):n==="all"?["all"].concat(c.slice(1).map(Bf)):n==="none"?["all"].concat(c.slice(1).map(Bf).map(fs)):n==="in"?wm(c[1],c.slice(2)):n==="!in"?fs(wm(c[1],c.slice(2))):n==="has"?op(c[1]):n!=="!has"||fs(op(c[1]));var o}function kl(c,n,o){switch(c){case"$type":return[`filter-type-${o}`,n];case"$id":return[`filter-id-${o}`,n];default:return[`filter-${o}`,c,n]}}function wm(c,n){if(n.length===0)return!1;switch(c){case"$type":return["filter-type-in",["literal",n]];case"$id":return["filter-id-in",["literal",n]];default:return n.length>200&&!n.some(o=>typeof o!=typeof n[0])?["filter-in-large",c,["literal",n.sort(j0)]]:["filter-in-small",c,["literal",n]]}}function op(c){switch(c){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",c]}}function fs(c){return["!",c]}const Nf="";function jo(c,n){return n?`${c}${Nf}${n}`:c}const ds="-transition",Sm=new Set(["fill","line","background","hillshade","raster"]);class Vi extends bl{constructor(n,o,u,_,d){if(super(),this.id=n.id,this.fqid=jo(this.id,u),this.type=n.type,this.scope=u,this.lut=_,this.options=d,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,this.configDependencies=new Set,n.type!=="custom"){if(this.metadata=n.metadata,this.minzoom=n.minzoom,this.maxzoom=n.maxzoom,n.type&&n.type!=="background"&&n.type!=="sky"&&n.type!=="slot"){this.source=n.source,this.sourceLayer=n["source-layer"],this.filter=n.filter;const y=Ri(this.filter,st[`filter_${n.type}`]);y.result!=="error"&&(this.configDependencies=new Set([...this.configDependencies,...y.value.configDependencies]))}if(n.slot&&(this.slot=n.slot),o.layout&&(this._unevaluatedLayout=new Cc(o.layout,this.scope,d),this.configDependencies=new Set([...this.configDependencies,...this._unevaluatedLayout.configDependencies])),o.paint){this._transitionablePaint=new Th(o.paint,this.scope,d);for(const y in n.paint)this.setPaintProperty(y,n.paint[y]);for(const y in n.layout)this.setLayoutProperty(y,n.layout[y]);this.configDependencies=new Set([...this.configDependencies,...this._transitionablePaint.configDependencies]),this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new wu(o.paint)}}}onAdd(n){}onRemove(n){}isDraped(n){return!this.is3D()&&Sm.has(this.type)}getLayoutProperty(n){return n==="visibility"?this.visibility:this._unevaluatedLayout.getValue(n)}setLayoutProperty(n,o){if(this.type==="custom"&&n==="visibility")return void(this.visibility=o);const u=this._unevaluatedLayout;u._properties.properties[n]&&(u.setValue(n,o),this.configDependencies=new Set([...this.configDependencies,...u.configDependencies]),n==="visibility"&&this.possiblyEvaluateVisibility())}possiblyEvaluateVisibility(){this._unevaluatedLayout._values.visibility&&(this.visibility=this._unevaluatedLayout._values.visibility.possiblyEvaluate({zoom:0}))}getPaintProperty(n){return ha(n,ds)?this._transitionablePaint.getTransition(n.slice(0,-11)):this._transitionablePaint.getValue(n)}setPaintProperty(n,o){const u=this._transitionablePaint,_=u._properties.properties;if(ha(n,ds)){const I=n.slice(0,-11);return _[I]&&u.setTransition(I,o||void 0),!1}if(!_[n])return!1;const d=u._values[n],y=d.value.isDataDriven(),E=d.value;u.setValue(n,o),this.configDependencies=new Set([...this.configDependencies,...u.configDependencies]),this._handleSpecialPaintPropertyUpdate(n);const M=u._values[n].value,k=M.isDataDriven(),w=ha(n,"pattern")||n==="line-dasharray";return k||y||w||this._handleOverridablePaintPropertyUpdate(n,E,M)}_handleSpecialPaintPropertyUpdate(n){}getProgramIds(){return null}getDefaultProgramParams(n,o,u){return null}_handleOverridablePaintPropertyUpdate(n,o,u){return!1}isHidden(n){return!!(this.minzoom&&n<this.minzoom)||!!(this.maxzoom&&n>=this.maxzoom)||this.visibility==="none"}updateTransitions(n){this._transitioningPaint=this._transitionablePaint.transitioned(n,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(n,o){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(n,void 0,o)),this.paint=this._transitioningPaint.possiblyEvaluate(n,void 0,o)}serialize(){return Ju({id:this.id,type:this.type,slot:this.slot,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()},(n,o)=>!(n===void 0||o==="layout"&&!Object.keys(n).length||o==="paint"&&!Object.keys(n).length))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}hasShadowPass(){return!1}canCastShadows(){return!1}hasLightBeamPass(){return!1}cutoffRange(){return 0}tileCoverLift(){return 0}resize(){}isStateDependent(){for(const n in this.paint._values){const o=this.paint.get(n);if(o instanceof Mc&&mh(o.property.specification)&&(o.value.kind==="source"||o.value.kind==="composite")&&o.value.isStateDependent)return!0}return!1}compileFilter(n){this._filterCompiled||(this._featureFilter=ym(this.filter,this.scope,n),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}getLayerRenderingStats(){return this._stats}resetLayerRenderingStats(n){this._stats&&(n.renderPass==="shadow"?this._stats.numRenderedVerticesInShadowPass=0:this._stats.numRenderedVerticesInTransparentPass=0)}queryRadius(n){}queryIntersectsFeature(n,o,u,_,d,y,E,M,k){}}const U0={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Eh{constructor(n,o){this._structArray=n,this._pos1=o*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class $r{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(n,o){return n._trim(),o&&(n.isTransferred=!0,o.add(n.arrayBuffer)),{length:n.length,arrayBuffer:n.arrayBuffer}}static deserialize(n){const o=Object.create(this.prototype);return o.arrayBuffer=n.arrayBuffer,o.length=n.length,o.capacity=n.arrayBuffer.byteLength/o.bytesPerElement,o._refreshViews(),o}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(n){this.reserve(n),this.length=n}reserve(n){if(n>this.capacity){this.capacity=Math.max(n,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const o=this.uint8;this._refreshViews(),o&&this.uint8.set(o)}}_refreshViews(){throw new Error("StructArray#_refreshViews() must be implemented by each concrete StructArray layout")}emplace(...n){throw new Error("StructArray#emplace() must be implemented by each concrete StructArray layout")}emplaceBack(...n){throw new Error("StructArray#emplaceBack() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function br(c,n=1){let o=0,u=0;return{members:c.map(_=>{const d=U0[_.type].BYTES_PER_ELEMENT,y=o=sp(o,Math.max(n,d)),E=_.components||1;return u=Math.max(u,d),o+=d*E,{name:_.name,type:_.type,components:E,offset:y}}),size:sp(o,Math.max(u,n)),alignment:n}}function sp(c,n){return Math.ceil(c/n)*n}class el extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,o){const u=this.length;return this.resize(u+1),this.emplace(u,n,o)}emplace(n,o,u){const _=2*n;return this.int16[_+0]=o,this.int16[_+1]=u,n}}el.prototype.bytesPerElement=4,hn(el,"StructArrayLayout2i4");class Tu extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,o,u){const _=this.length;return this.resize(_+1),this.emplace(_,n,o,u)}emplace(n,o,u,_){const d=3*n;return this.int16[d+0]=o,this.int16[d+1]=u,this.int16[d+2]=_,n}}Tu.prototype.bytesPerElement=6,hn(Tu,"StructArrayLayout3i6");class Ls extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,o,u,_){const d=this.length;return this.resize(d+1),this.emplace(d,n,o,u,_)}emplace(n,o,u,_,d){const y=4*n;return this.int16[y+0]=o,this.int16[y+1]=u,this.int16[y+2]=_,this.int16[y+3]=d,n}}Ls.prototype.bytesPerElement=8,hn(Ls,"StructArrayLayout4i8");class Ff extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,o,u,_,d){const y=this.length;return this.resize(y+1),this.emplace(y,n,o,u,_,d)}emplace(n,o,u,_,d,y){const E=5*n;return this.int16[E+0]=o,this.int16[E+1]=u,this.int16[E+2]=_,this.int16[E+3]=d,this.int16[E+4]=y,n}}Ff.prototype.bytesPerElement=10,hn(Ff,"StructArrayLayout5i10");class Ah extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,o,u,_,d,y,E){const M=this.length;return this.resize(M+1),this.emplace(M,n,o,u,_,d,y,E)}emplace(n,o,u,_,d,y,E,M){const k=6*n,w=12*n,I=3*n;return this.int16[k+0]=o,this.int16[k+1]=u,this.uint8[w+4]=_,this.uint8[w+5]=d,this.uint8[w+6]=y,this.uint8[w+7]=E,this.float32[I+2]=M,n}}Ah.prototype.bytesPerElement=12,hn(Ah,"StructArrayLayout2i4ub1f12");class tl extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,o,u){const _=this.length;return this.resize(_+1),this.emplace(_,n,o,u)}emplace(n,o,u,_){const d=3*n;return this.float32[d+0]=o,this.float32[d+1]=u,this.float32[d+2]=_,n}}tl.prototype.bytesPerElement=12,hn(tl,"StructArrayLayout3f12");class ba extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,o,u,_,d){const y=this.length;return this.resize(y+1),this.emplace(y,n,o,u,_,d)}emplace(n,o,u,_,d,y){const E=6*n,M=3*n;return this.uint16[E+0]=o,this.uint16[E+1]=u,this.uint16[E+2]=_,this.uint16[E+3]=d,this.float32[M+2]=y,n}}ba.prototype.bytesPerElement=12,hn(ba,"StructArrayLayout4ui1f12");class jf extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,o,u,_){const d=this.length;return this.resize(d+1),this.emplace(d,n,o,u,_)}emplace(n,o,u,_,d){const y=4*n;return this.uint16[y+0]=o,this.uint16[y+1]=u,this.uint16[y+2]=_,this.uint16[y+3]=d,n}}jf.prototype.bytesPerElement=8,hn(jf,"StructArrayLayout4ui8");class Ch extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,o,u,_,d,y){const E=this.length;return this.resize(E+1),this.emplace(E,n,o,u,_,d,y)}emplace(n,o,u,_,d,y,E){const M=6*n;return this.int16[M+0]=o,this.int16[M+1]=u,this.int16[M+2]=_,this.int16[M+3]=d,this.int16[M+4]=y,this.int16[M+5]=E,n}}Ch.prototype.bytesPerElement=12,hn(Ch,"StructArrayLayout6i12");class Uf extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,o,u,_,d,y,E,M,k,w,I,D){const C=this.length;return this.resize(C+1),this.emplace(C,n,o,u,_,d,y,E,M,k,w,I,D)}emplace(n,o,u,_,d,y,E,M,k,w,I,D,C){const P=12*n;return this.int16[P+0]=o,this.int16[P+1]=u,this.int16[P+2]=_,this.int16[P+3]=d,this.uint16[P+4]=y,this.uint16[P+5]=E,this.uint16[P+6]=M,this.uint16[P+7]=k,this.int16[P+8]=w,this.int16[P+9]=I,this.int16[P+10]=D,this.int16[P+11]=C,n}}Uf.prototype.bytesPerElement=24,hn(Uf,"StructArrayLayout4i4ui4i24");class lp extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,o,u,_,d,y){const E=this.length;return this.resize(E+1),this.emplace(E,n,o,u,_,d,y)}emplace(n,o,u,_,d,y,E){const M=10*n,k=5*n;return this.int16[M+0]=o,this.int16[M+1]=u,this.int16[M+2]=_,this.float32[k+2]=d,this.float32[k+3]=y,this.float32[k+4]=E,n}}lp.prototype.bytesPerElement=20,hn(lp,"StructArrayLayout3i3f20");class Ic extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,o,u,_){const d=this.length;return this.resize(d+1),this.emplace(d,n,o,u,_)}emplace(n,o,u,_,d){const y=4*n;return this.float32[y+0]=o,this.float32[y+1]=u,this.float32[y+2]=_,this.float32[y+3]=d,n}}Ic.prototype.bytesPerElement=16,hn(Ic,"StructArrayLayout4f16");class Tm extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(n){const o=this.length;return this.resize(o+1),this.emplace(o,n)}emplace(n,o){return this.uint32[1*n+0]=o,n}}Tm.prototype.bytesPerElement=4,hn(Tm,"StructArrayLayout1ul4");class Pc extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,o){const u=this.length;return this.resize(u+1),this.emplace(u,n,o)}emplace(n,o,u){const _=2*n;return this.uint16[_+0]=o,this.uint16[_+1]=u,n}}Pc.prototype.bytesPerElement=4,hn(Pc,"StructArrayLayout2ui4");class cp extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,o,u,_,d,y,E,M,k,w,I,D,C){const P=this.length;return this.resize(P+1),this.emplace(P,n,o,u,_,d,y,E,M,k,w,I,D,C)}emplace(n,o,u,_,d,y,E,M,k,w,I,D,C,P){const B=20*n,q=10*n;return this.int16[B+0]=o,this.int16[B+1]=u,this.int16[B+2]=_,this.int16[B+3]=d,this.int16[B+4]=y,this.float32[q+3]=E,this.float32[q+4]=M,this.float32[q+5]=k,this.float32[q+6]=w,this.int16[B+14]=I,this.uint32[q+8]=D,this.uint16[B+18]=C,this.uint16[B+19]=P,n}}cp.prototype.bytesPerElement=40,hn(cp,"StructArrayLayout5i4f1i1ul2ui40");class Rc extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,o,u,_,d,y,E){const M=this.length;return this.resize(M+1),this.emplace(M,n,o,u,_,d,y,E)}emplace(n,o,u,_,d,y,E,M){const k=8*n;return this.int16[k+0]=o,this.int16[k+1]=u,this.int16[k+2]=_,this.int16[k+4]=d,this.int16[k+5]=y,this.int16[k+6]=E,this.int16[k+7]=M,n}}Rc.prototype.bytesPerElement=16,hn(Rc,"StructArrayLayout3i2i2i16");class Vf extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,o,u,_,d){const y=this.length;return this.resize(y+1),this.emplace(y,n,o,u,_,d)}emplace(n,o,u,_,d,y){const E=4*n,M=8*n;return this.float32[E+0]=o,this.float32[E+1]=u,this.float32[E+2]=_,this.int16[M+6]=d,this.int16[M+7]=y,n}}Vf.prototype.bytesPerElement=16,hn(Vf,"StructArrayLayout2f1f2i16");class Mh extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,o,u,_,d,y){const E=this.length;return this.resize(E+1),this.emplace(E,n,o,u,_,d,y)}emplace(n,o,u,_,d,y,E){const M=20*n,k=5*n;return this.uint8[M+0]=o,this.uint8[M+1]=u,this.float32[k+1]=_,this.float32[k+2]=d,this.float32[k+3]=y,this.float32[k+4]=E,n}}Mh.prototype.bytesPerElement=20,hn(Mh,"StructArrayLayout2ub4f20");class ia extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,o,u){const _=this.length;return this.resize(_+1),this.emplace(_,n,o,u)}emplace(n,o,u,_){const d=3*n;return this.uint16[d+0]=o,this.uint16[d+1]=u,this.uint16[d+2]=_,n}}ia.prototype.bytesPerElement=6,hn(ia,"StructArrayLayout3ui6");class up extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(n,o,u,_,d,y,E,M,k,w,I,D,C,P,B,q,H,te,re,J,ie){const ce=this.length;return this.resize(ce+1),this.emplace(ce,n,o,u,_,d,y,E,M,k,w,I,D,C,P,B,q,H,te,re,J,ie)}emplace(n,o,u,_,d,y,E,M,k,w,I,D,C,P,B,q,H,te,re,J,ie,ce){const me=30*n,Ce=15*n,Ae=60*n;return this.int16[me+0]=o,this.int16[me+1]=u,this.int16[me+2]=_,this.float32[Ce+2]=d,this.float32[Ce+3]=y,this.uint16[me+8]=E,this.uint16[me+9]=M,this.uint32[Ce+5]=k,this.uint32[Ce+6]=w,this.uint32[Ce+7]=I,this.uint16[me+16]=D,this.uint16[me+17]=C,this.uint16[me+18]=P,this.float32[Ce+10]=B,this.float32[Ce+11]=q,this.uint8[Ae+48]=H,this.uint8[Ae+49]=te,this.uint8[Ae+50]=re,this.uint32[Ce+13]=J,this.int16[me+28]=ie,this.uint8[Ae+58]=ce,n}}up.prototype.bytesPerElement=60,hn(up,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class ps extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(n,o,u,_,d,y,E,M,k,w,I,D,C,P,B,q,H,te,re,J,ie,ce,me,Ce,Ae,Ee,Ue,Ie,Ve,Ze,qe,Ke){const Qe=this.length;return this.resize(Qe+1),this.emplace(Qe,n,o,u,_,d,y,E,M,k,w,I,D,C,P,B,q,H,te,re,J,ie,ce,me,Ce,Ae,Ee,Ue,Ie,Ve,Ze,qe,Ke)}emplace(n,o,u,_,d,y,E,M,k,w,I,D,C,P,B,q,H,te,re,J,ie,ce,me,Ce,Ae,Ee,Ue,Ie,Ve,Ze,qe,Ke,Qe){const at=20*n,Je=40*n,wt=80*n;return this.float32[at+0]=o,this.float32[at+1]=u,this.int16[Je+4]=_,this.int16[Je+5]=d,this.int16[Je+6]=y,this.int16[Je+7]=E,this.int16[Je+8]=M,this.int16[Je+9]=k,this.int16[Je+10]=w,this.int16[Je+11]=I,this.int16[Je+12]=D,this.uint16[Je+13]=C,this.uint16[Je+14]=P,this.uint16[Je+15]=B,this.uint16[Je+16]=q,this.uint16[Je+17]=H,this.uint16[Je+18]=te,this.uint16[Je+19]=re,this.uint16[Je+20]=J,this.uint16[Je+21]=ie,this.uint16[Je+22]=ce,this.uint16[Je+23]=me,this.uint16[Je+24]=Ce,this.uint16[Je+25]=Ae,this.uint16[Je+26]=Ee,this.uint16[Je+27]=Ue,this.uint32[at+14]=Ie,this.float32[at+15]=Ve,this.float32[at+16]=Ze,this.float32[at+17]=qe,this.float32[at+18]=Ke,this.uint8[wt+76]=Qe,n}}ps.prototype.bytesPerElement=80,hn(ps,"StructArrayLayout2f9i15ui1ul4f1ub80");class zs extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n){const o=this.length;return this.resize(o+1),this.emplace(o,n)}emplace(n,o){return this.float32[1*n+0]=o,n}}zs.prototype.bytesPerElement=4,hn(zs,"StructArrayLayout1f4");class uo extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,o,u,_,d){const y=this.length;return this.resize(y+1),this.emplace(y,n,o,u,_,d)}emplace(n,o,u,_,d,y){const E=5*n;return this.float32[E+0]=o,this.float32[E+1]=u,this.float32[E+2]=_,this.float32[E+3]=d,this.float32[E+4]=y,n}}uo.prototype.bytesPerElement=20,hn(uo,"StructArrayLayout5f20");class nl extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,o,u,_,d,y,E){const M=this.length;return this.resize(M+1),this.emplace(M,n,o,u,_,d,y,E)}emplace(n,o,u,_,d,y,E,M){const k=7*n;return this.float32[k+0]=o,this.float32[k+1]=u,this.float32[k+2]=_,this.float32[k+3]=d,this.float32[k+4]=y,this.float32[k+5]=E,this.float32[k+6]=M,n}}nl.prototype.bytesPerElement=28,hn(nl,"StructArrayLayout7f28");class ms extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,o,u,_,d,y,E,M,k,w,I){const D=this.length;return this.resize(D+1),this.emplace(D,n,o,u,_,d,y,E,M,k,w,I)}emplace(n,o,u,_,d,y,E,M,k,w,I,D){const C=11*n;return this.float32[C+0]=o,this.float32[C+1]=u,this.float32[C+2]=_,this.float32[C+3]=d,this.float32[C+4]=y,this.float32[C+5]=E,this.float32[C+6]=M,this.float32[C+7]=k,this.float32[C+8]=w,this.float32[C+9]=I,this.float32[C+10]=D,n}}ms.prototype.bytesPerElement=44,hn(ms,"StructArrayLayout11f44");class Oh extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,o,u,_,d,y,E,M,k){const w=this.length;return this.resize(w+1),this.emplace(w,n,o,u,_,d,y,E,M,k)}emplace(n,o,u,_,d,y,E,M,k,w){const I=9*n;return this.float32[I+0]=o,this.float32[I+1]=u,this.float32[I+2]=_,this.float32[I+3]=d,this.float32[I+4]=y,this.float32[I+5]=E,this.float32[I+6]=M,this.float32[I+7]=k,this.float32[I+8]=w,n}}Oh.prototype.bytesPerElement=36,hn(Oh,"StructArrayLayout9f36");class Eu extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,o){const u=this.length;return this.resize(u+1),this.emplace(u,n,o)}emplace(n,o,u){const _=2*n;return this.float32[_+0]=o,this.float32[_+1]=u,n}}Eu.prototype.bytesPerElement=8,hn(Eu,"StructArrayLayout2f8");class hp extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,o,u,_){const d=this.length;return this.resize(d+1),this.emplace(d,n,o,u,_)}emplace(n,o,u,_,d){const y=6*n;return this.uint32[3*n+0]=o,this.uint16[y+2]=u,this.uint16[y+3]=_,this.uint16[y+4]=d,n}}hp.prototype.bytesPerElement=12,hn(hp,"StructArrayLayout1ul3ui12");class Bl extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n){const o=this.length;return this.resize(o+1),this.emplace(o,n)}emplace(n,o){return this.uint16[1*n+0]=o,n}}Bl.prototype.bytesPerElement=2,hn(Bl,"StructArrayLayout1ui2");class Dc extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,o,u,_,d,y,E,M,k,w,I,D,C,P,B,q){const H=this.length;return this.resize(H+1),this.emplace(H,n,o,u,_,d,y,E,M,k,w,I,D,C,P,B,q)}emplace(n,o,u,_,d,y,E,M,k,w,I,D,C,P,B,q,H){const te=16*n;return this.float32[te+0]=o,this.float32[te+1]=u,this.float32[te+2]=_,this.float32[te+3]=d,this.float32[te+4]=y,this.float32[te+5]=E,this.float32[te+6]=M,this.float32[te+7]=k,this.float32[te+8]=w,this.float32[te+9]=I,this.float32[te+10]=D,this.float32[te+11]=C,this.float32[te+12]=P,this.float32[te+13]=B,this.float32[te+14]=q,this.float32[te+15]=H,n}}Dc.prototype.bytesPerElement=64,hn(Dc,"StructArrayLayout16f64");class Ih extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,o,u,_,d,y,E){const M=this.length;return this.resize(M+1),this.emplace(M,n,o,u,_,d,y,E)}emplace(n,o,u,_,d,y,E,M){const k=10*n,w=5*n;return this.uint16[k+0]=o,this.uint16[k+1]=u,this.uint16[k+2]=_,this.uint16[k+3]=d,this.float32[w+2]=y,this.float32[w+3]=E,this.float32[w+4]=M,n}}Ih.prototype.bytesPerElement=20,hn(Ih,"StructArrayLayout4ui3f20");class fp extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n){const o=this.length;return this.resize(o+1),this.emplace(o,n)}emplace(n,o){return this.int16[1*n+0]=o,n}}fp.prototype.bytesPerElement=2,hn(fp,"StructArrayLayout1i2");class $f extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer)}emplaceBack(n){const o=this.length;return this.resize(o+1),this.emplace(o,n)}emplace(n,o){return this.uint8[1*n+0]=o,n}}$f.prototype.bytesPerElement=1,hn($f,"StructArrayLayout1ub1");class qf extends Eh{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}qf.prototype.size=40;class dp extends cp{get(n){return new qf(this,n)}}hn(dp,"CollisionBoxArray");class Au extends Eh{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(n){this._structArray.uint8[this._pos1+49]=n}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(n){this._structArray.uint8[this._pos1+50]=n}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(n){this._structArray.uint32[this._pos4+13]=n}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(n){this._structArray.uint8[this._pos1+58]=n}}Au.prototype.size=60;class Em extends up{get(n){return new Au(this,n)}}hn(Em,"PlacedSymbolArray");class Am extends Eh{get tileAnchorX(){return this._structArray.float32[this._pos4+0]}get tileAnchorY(){return this._structArray.float32[this._pos4+1]}get projectedAnchorX(){return this._structArray.int16[this._pos2+4]}get projectedAnchorY(){return this._structArray.int16[this._pos2+5]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+6]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+7]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+11]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get key(){return this._structArray.uint16[this._pos2+13]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+14]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+15]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+17]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+19]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+21]}get featureIndex(){return this._structArray.uint16[this._pos2+22]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+23]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numIconVertices(){return this._structArray.uint16[this._pos2+25]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+26]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+27]}get crossTileID(){return this._structArray.uint32[this._pos4+14]}set crossTileID(n){this._structArray.uint32[this._pos4+14]=n}get textOffset0(){return this._structArray.float32[this._pos4+15]}get textOffset1(){return this._structArray.float32[this._pos4+16]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+17]}get zOffset(){return this._structArray.float32[this._pos4+18]}set zOffset(n){this._structArray.float32[this._pos4+18]=n}get hasIconTextFit(){return this._structArray.uint8[this._pos1+76]}}Am.prototype.size=80;class V0 extends ps{get(n){return new Am(this,n)}}hn(V0,"SymbolInstanceArray");class Cm extends zs{getoffsetX(n){return this.float32[1*n+0]}}hn(Cm,"GlyphOffsetArray");class wa extends el{getx(n){return this.int16[2*n+0]}gety(n){return this.int16[2*n+1]}}hn(wa,"SymbolLineVertexArray");class Xi extends Eh{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}Xi.prototype.size=12;class Ph extends hp{get(n){return new Xi(this,n)}}hn(Ph,"FeatureIndexArray");class ho extends Pc{geta_centroid_pos0(n){return this.uint16[2*n+0]}geta_centroid_pos1(n){return this.uint16[2*n+1]}}hn(ho,"FillExtrusionCentroidArray");class Rh extends Eh{get a_join_normal_inside0(){return this._structArray.int16[this._pos2+0]}get a_join_normal_inside1(){return this._structArray.int16[this._pos2+1]}get a_join_normal_inside2(){return this._structArray.int16[this._pos2+2]}}Rh.prototype.size=6;class Mm extends Tu{get(n){return new Rh(this,n)}}hn(Mm,"FillExtrusionWallArray");const $0=br([{name:"a_pos",components:2,type:"Int16"}],4),Gf=br([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class ci{constructor(n=[]){this.segments=n}_prepareSegment(n,o,u,_){let d=this.segments[this.segments.length-1];return n>ci.MAX_VERTEX_ARRAY_LENGTH&&qn(`Max vertices per segment is ${ci.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${n}`),(!d||d.vertexLength+n>ci.MAX_VERTEX_ARRAY_LENGTH||d.sortKey!==_)&&(d={vertexOffset:o,primitiveOffset:u,vertexLength:0,primitiveLength:0},_!==void 0&&(d.sortKey=_),this.segments.push(d)),d}prepareSegment(n,o,u,_){return this._prepareSegment(n,o.length,u.length,_)}get(){return this.segments}destroy(){for(const n of this.segments)for(const o in n.vaos)n.vaos[o].destroy()}static simpleSegment(n,o,u,_){return new ci([{vertexOffset:n,primitiveOffset:o,vertexLength:u,primitiveLength:_,vaos:{},sortKey:0}])}}function Hf(c,n){return 256*(c=Bn(Math.floor(c),0,255))+Bn(Math.floor(n),0,255)}ci.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,hn(ci,"SegmentVector");const q0=br([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),pp=br([{name:"a_dash",components:4,type:"Uint16"}]);class Cu{constructor(){this.ids=[],this.uniqueIds=[],this.positions=[],this.indexed=!1}add(n,o,u,_){this.ids.push(mp(n)),this.positions.push(o,u,_)}eachPosition(n,o){const u=mp(n);let _=0,d=this.ids.length-1;for(;_<d;){const y=_+d>>1;this.ids[y]>=u?d=y:_=y+1}for(;this.ids[_]===u;)o(this.positions[3*_],this.positions[3*_+1],this.positions[3*_+2]),_++}static serialize(n,o){const u=new Float64Array(n.ids),_=new Uint32Array(n.positions);return Mu(u,_,0,u.length-1),o&&(o.add(u.buffer),o.add(_.buffer)),{ids:u,positions:_}}static deserialize(n){const o=new Cu;let u;o.ids=n.ids,o.positions=n.positions;for(const _ of o.ids)_!==u&&o.uniqueIds.push(_),u=_;return o.indexed=!0,o}}function mp(c){const n=+c;return!isNaN(n)&&Number.MIN_SAFE_INTEGER<=n&&n<=Number.MAX_SAFE_INTEGER?n:ns(String(c))}function Mu(c,n,o,u){for(;o<u;){const _=c[o+u>>1];let d=o-1,y=u+1;for(;;){do d++;while(c[d]<_);do y--;while(c[y]>_);if(d>=y)break;Zf(c,d,y),Zf(n,3*d,3*y),Zf(n,3*d+1,3*y+1),Zf(n,3*d+2,3*y+2)}y-o<u-y?(Mu(c,n,o,y),o=y+1):(Mu(c,n,y+1,u),u=y)}}function Zf(c,n,o){const u=c[n];c[n]=c[o],c[o]=u}hn(Cu,"FeaturePositionMap");class _s{constructor(n){this.gl=n.gl,this.initialized=!1}fetchUniformLocation(n,o){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(n,o),this.initialized=!0),!!this.location}set(n,o,u){throw new Error("Uniform#set() must be implemented by each concrete Uniform")}}class Ou extends _s{constructor(n){super(n),this.current=0}set(n,o,u){this.fetchUniformLocation(n,o)&&this.current!==u&&(this.current=u,this.gl.uniform1i(this.location,u))}}class pi extends _s{constructor(n){super(n),this.current=0}set(n,o,u){this.fetchUniformLocation(n,o)&&this.current!==u&&(this.current=u,this.gl.uniform1f(this.location,u))}}class Uo extends _s{constructor(n){super(n),this.current=[0,0]}set(n,o,u){this.fetchUniformLocation(n,o)&&(u[0]===this.current[0]&&u[1]===this.current[1]||(this.current=u,this.gl.uniform2f(this.location,u[0],u[1])))}}class Lc extends _s{constructor(n){super(n),this.current=[0,0,0]}set(n,o,u){this.fetchUniformLocation(n,o)&&(u[0]===this.current[0]&&u[1]===this.current[1]&&u[2]===this.current[2]||(this.current=u,this.gl.uniform3f(this.location,u[0],u[1],u[2])))}}class Dh extends _s{constructor(n){super(n),this.current=[0,0,0,0]}set(n,o,u){this.fetchUniformLocation(n,o)&&(u[0]===this.current[0]&&u[1]===this.current[1]&&u[2]===this.current[2]&&u[3]===this.current[3]||(this.current=u,this.gl.uniform4f(this.location,u[0],u[1],u[2],u[3])))}}class rl extends _s{constructor(n){super(n),this.current=_r.transparent.toRenderColor(null)}set(n,o,u){this.fetchUniformLocation(n,o)&&(u.r===this.current.r&&u.g===this.current.g&&u.b===this.current.b&&u.a===this.current.a||(this.current=u,this.gl.uniform4f(this.location,u.r,u.g,u.b,u.a)))}}const _p=new Float32Array(16);class Wf extends _s{constructor(n){super(n),this.current=_p}set(n,o,u){if(this.fetchUniformLocation(n,o)){if(u[12]!==this.current[12]||u[0]!==this.current[0])return this.current=u,void this.gl.uniformMatrix4fv(this.location,!1,u);for(let _=1;_<16;_++)if(u[_]!==this.current[_]){this.current=u,this.gl.uniformMatrix4fv(this.location,!1,u);break}}}}const gp=new Float32Array(9),Om=new Float32Array(4);class Nl extends _s{constructor(n){super(n),this.current=Om}set(n,o,u){if(this.fetchUniformLocation(n,o)){for(let _=0;_<4;_++)if(u[_]!==this.current[_]){this.current=u,this.gl.uniformMatrix2fv(this.location,!1,u);break}}}}function ks(c){return[Hf(255*c.r,255*c.g),Hf(255*c.b,255*c.a)]}class Ao{constructor(n,o,u,_){this.value=n,this.uniformNames=o.map(d=>`u_${d}`),this.type=u,this.context=_}setUniform(n,o,u,_,d){const y=_.constantOr(this.value);o.set(n,d,y instanceof _r?y.toRenderColor(this.ignoreLut?null:this.context.lut):y)}getBinding(n,o){return this.type==="color"?new rl(n):new pi(n)}}class fo{constructor(n,o){this.uniformNames=o.map(u=>`u_${u}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(n){this.pixelRatio=n.pixelRatio||1,this.pattern=n.tl.concat(n.br)}setUniform(n,o,u,_,d){const y=d==="u_pattern"||d==="u_dash"?this.pattern:d==="u_pixel_ratio"?this.pixelRatio:null;y&&o.set(n,d,y)}getBinding(n,o){return o==="u_pattern"||o==="u_dash"?new Dh(n):new pi(n)}}class Bs{constructor(n,o,u,_){this.expression=n,this.type=u,this.maxValue=0,this.paintVertexAttributes=o.map(d=>({name:`a_${d}`,type:"Float32",components:u==="color"?2:1,offset:0})),this.paintVertexArray=new _}populatePaintArray(n,o,u,_,d,y,E){const M=this.paintVertexArray.length,k=this.expression.kind==="composite"||this.expression.kind==="source"?this.expression.evaluate(new kr(0,{brightness:y}),o,{},d,_,E):this.expression.kind==="constant"&&this.expression.value;!this.lutExpression||this.lutExpression.kind!=="composite"&&this.lutExpression.kind!=="source"||(this.ignoreLut=this.lutExpression.evaluate(new kr(0,{brightness:y}),o,{},d,_,E)==="none"),this.paintVertexArray.resize(n),this._setPaintValue(M,n,k,this.context)}updatePaintArray(n,o,u,_,d,y,E){const M=this.expression.kind==="composite"||this.expression.kind==="source"?this.expression.evaluate({zoom:0,brightness:E},u,_,void 0,d):this.expression.kind==="constant"&&this.expression.value;!this.lutExpression||this.lutExpression.kind!=="composite"&&this.lutExpression.kind!=="source"||(this.ignoreLut=this.lutExpression.evaluate({zoom:0,brightness:E},u,_,void 0,d)==="none"),this._setPaintValue(n,o,M,this.context)}_setPaintValue(n,o,u,_){if(this.type==="color"){const d=ks(u.toRenderColor(this.ignoreLut?null:_.lut));for(let y=n;y<o;y++)this.paintVertexArray.emplace(y,d[0],d[1])}else{for(let d=n;d<o;d++)this.paintVertexArray.emplace(d,u);this.maxValue=Math.max(this.maxValue,Math.abs(u))}}upload(n){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=n.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.lutExpression&&this.lutExpression.kind!=="constant"&&(this.lutExpression.isStateDependent||!this.lutExpression.isLightConstant)||this.expression.kind!=="constant"&&(this.expression.isStateDependent||!this.expression.isLightConstant)))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Vo{constructor(n,o,u,_,d,y){this.expression=n,this.uniformNames=o.map(E=>`u_${E}_t`),this.type=u,this.useIntegerZoom=_,this.context=d,this.maxValue=0,this.paintVertexAttributes=o.map(E=>({name:`a_${E}`,type:"Float32",components:u==="color"?4:2,offset:0})),this.paintVertexArray=new y}populatePaintArray(n,o,u,_,d,y,E){const M=this.expression.evaluate(new kr(this.context.zoom,{brightness:y}),o,{},d,_,E),k=this.expression.evaluate(new kr(this.context.zoom+1,{brightness:y}),o,{},d,_,E);!this.lutExpression||this.lutExpression.kind!=="composite"&&this.lutExpression.kind!=="source"||(this.ignoreLut=this.lutExpression.evaluate(new kr(this.context.zoom,{brightness:y}),o,{},d,_,E)==="none");const w=this.paintVertexArray.length;this.paintVertexArray.resize(n),this._setPaintValue(w,n,M,k,this.context)}updatePaintArray(n,o,u,_,d,y,E){const M=this.expression.evaluate({zoom:this.context.zoom,brightness:E},u,_,void 0,d),k=this.expression.evaluate({zoom:this.context.zoom+1,brightness:E},u,_,void 0,d);!this.lutExpression||this.lutExpression.kind!=="composite"&&this.lutExpression.kind!=="source"||(this.ignoreLut=this.lutExpression.evaluate({zoom:this.context.zoom,brightness:E},u,_,void 0,d)==="none"),this._setPaintValue(n,o,M,k,this.context)}_setPaintValue(n,o,u,_,d){if(this.type==="color"){const y=ks(u.toRenderColor(this.ignoreLut?null:d.lut)),E=ks(u.toRenderColor(this.ignoreLut?null:d.lut));for(let M=n;M<o;M++)this.paintVertexArray.emplace(M,y[0],y[1],E[0],E[1])}else{for(let y=n;y<o;y++)this.paintVertexArray.emplace(y,u,_);this.maxValue=Math.max(this.maxValue,Math.abs(u),Math.abs(_))}}upload(n){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=n.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(n,o,u,_,d){const y=this.useIntegerZoom?Math.floor(u.zoom):u.zoom,E=Bn(this.expression.interpolationFactor(y,this.context.zoom,this.context.zoom+1),0,1);o.set(n,d,E)}getBinding(n,o){return new pi(n)}}class gs{constructor(n,o,u,_,d){this.expression=n,this.layerId=d,this.paintVertexAttributes=(u==="array"?pp:q0).members;for(let y=0;y<o.length;++y);this.paintVertexArray=new _}populatePaintArray(n,o,u,_){const d=this.paintVertexArray.length;this.paintVertexArray.resize(n),this._setPaintValues(d,n,o.patterns&&o.patterns[this.layerId],u)}updatePaintArray(n,o,u,_,d,y,E){this._setPaintValues(n,o,u.patterns&&u.patterns[this.layerId],y)}_setPaintValues(n,o,u,_){if(!_||!u)return;const d=_[u];if(!d)return;const{tl:y,br:E,pixelRatio:M}=d;for(let k=n;k<o;k++)this.paintVertexArray.emplace(k,y[0],y[1],E[0],E[1],M)}upload(n){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=n.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class il{constructor(n,o,u=()=>!0){this.binders={},this._buffers=[],this.context=o;const _=[];for(const d in n.paint._values){const y=n.paint.get(d),E=n.paint.get(`${d}-use-theme`);if(d.endsWith("-use-theme")||!u(d)||!(y instanceof Mc&&mh(y.property.specification)))continue;const M=yp(d,n.type),k=y.value,w=y.property.specification.type,I=!!y.property.useIntegerZoom,D=d==="line-dasharray"||d.endsWith("pattern"),C=d==="line-dasharray"&&n.layout.get("line-cap").value.kind!=="constant"||E&&E.value.kind!=="constant";if(k.kind!=="constant"||C)if(k.kind==="source"||C||D){const P=vp(d,w,"source");this.binders[d]=D?new gs(k,M,w,P,n.id):new Bs(k,M,w,P),_.push(`/a_${d}`)}else{const P=vp(d,w,"composite");this.binders[d]=new Vo(k,M,w,I,o,P),_.push(`/z_${d}`)}else this.binders[d]=D?new fo(k.value,M):new Ao(k.value,M,w,o),_.push(`/u_${d}`);E&&(this.binders[d].ignoreLut=E.constantOr("default")==="none",this.binders[d].lutExpression=E.value,this.binders[d].checkUseTheme=!0)}this.cacheKey=_.sort().join("")}getMaxValue(n){const o=this.binders[n];return o instanceof Bs||o instanceof Vo?o.maxValue:0}populatePaintArrays(n,o,u,_,d,y,E){for(const M in this.binders){const k=this.binders[M];k.context=this.context,k instanceof Bs||k instanceof Vo||k instanceof gs?k.populatePaintArray(n,o,u,_,d,y,E):k.lutExpression&&k instanceof Ao&&k.lutExpression&&(k.lutExpression.kind==="composite"||k.lutExpression.kind==="source")&&(k.ignoreLut=k.lutExpression.evaluate(new kr(0,{brightness:y}),o,{},d,_,E)==="none")}}setConstantPatternPositions(n){for(const o in this.binders){const u=this.binders[o];u instanceof fo&&u.setConstantPatternPositions(n)}}updatePaintArrays(n,o,u,_,d,y,E,M,k){let w=!1;const I=Object.keys(n),D=I.length!==0&&!M,C=D?I:o.uniqueIds;this.context.lut=d.lut;for(const P in this.binders){const B=this.binders[P];if(B.context=this.context,(B instanceof Bs||B instanceof Vo||B instanceof gs)&&B.expression&&B.expression.kind&&B.expression.kind!=="constant"&&(B.expression.isStateDependent===!0||B.expression.isLightConstant===!1)){const q=d.paint.get(P);B.expression=q.value;for(const H of C){const te=n[H.toString()];o.eachPosition(H,(re,J,ie)=>{const ce=_.feature(re);B.updatePaintArray(J,ie,ce,te,y,E,k)})}if(!D)for(const H of u.uniqueIds){const te=n[H.toString()];u.eachPosition(H,(re,J,ie)=>{const ce=_.feature(re);B.updatePaintArray(J,ie,ce,te,y,E,k)})}w=!0}}return w}defines(){const n=[];for(const o in this.binders){const u=this.binders[o];(u instanceof Ao||u instanceof fo)&&n.push(...u.uniformNames.map(_=>`#define HAS_UNIFORM_${_}`))}return n}getBinderAttributes(){const n=[];for(const o in this.binders){const u=this.binders[o];if(u instanceof Bs||u instanceof Vo||u instanceof gs)for(let _=0;_<u.paintVertexAttributes.length;_++)n.push(u.paintVertexAttributes[_].name)}return n}getBinderUniforms(){const n=[];for(const o in this.binders){const u=this.binders[o];if(u instanceof Ao||u instanceof fo||u instanceof Vo)for(const _ of u.uniformNames)n.push(_)}return n}getPaintVertexBuffers(){return this._buffers}getUniforms(n){const o=[];for(const u in this.binders){const _=this.binders[u];if(_ instanceof Ao||_ instanceof fo||_ instanceof Vo)for(const d of _.uniformNames)o.push({name:d,property:u,binding:_.getBinding(n,d)})}return o}setUniforms(n,o,u,_,d){for(const{name:y,property:E,binding:M}of u){if(this.binders[E].checkUseTheme&&this.binders[E]instanceof Ao){const k=_.get(`${E}-use-theme`);k.isConstant()&&(this.binders[E].ignoreLut=k.constantOr("default")==="none")}this.binders[E].setUniform(n,M,d,_.get(E),y)}}updatePaintBuffers(){this._buffers=[];for(const n in this.binders){const o=this.binders[n];(o instanceof Bs||o instanceof Vo||o instanceof gs)&&o.paintVertexBuffer&&this._buffers.push(o.paintVertexBuffer)}}upload(n){for(const o in this.binders){const u=this.binders[o];(u instanceof Bs||u instanceof Vo||u instanceof gs)&&u.upload(n)}this.updatePaintBuffers()}destroy(){for(const n in this.binders){const o=this.binders[n];(o instanceof Bs||o instanceof Vo||o instanceof gs)&&o.destroy()}}}class Co{constructor(n,o,u=()=>!0){this.programConfigurations={};for(const _ of n)this.programConfigurations[_.id]=new il(_,o,u);this.needsUpload=!1,this._featureMap=new Cu,this._featureMapWithoutIds=new Cu,this._bufferOffset=0,this._idlessCounter=0}populatePaintArrays(n,o,u,_,d,y,E,M){for(const k in this.programConfigurations)this.programConfigurations[k].populatePaintArrays(n,o,_,d,y,E,M);o.id!==void 0?this._featureMap.add(o.id,u,this._bufferOffset,n):(this._featureMapWithoutIds.add(this._idlessCounter,u,this._bufferOffset,n),this._idlessCounter+=1),this._bufferOffset=n,this.needsUpload=!0}updatePaintArrays(n,o,u,_,d,y,E){for(const M of u)this.needsUpload=this.programConfigurations[M.id].updatePaintArrays(n,this._featureMap,this._featureMapWithoutIds,o,M,_,d,y,E||0)||this.needsUpload}get(n){return this.programConfigurations[n]}upload(n){if(this.needsUpload){for(const o in this.programConfigurations)this.programConfigurations[o].upload(n);this.needsUpload=!1}}destroy(){for(const n in this.programConfigurations)this.programConfigurations[n].destroy()}}const Ka={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-occlusion-opacity":["occlusion_opacity"],"icon-occlusion-opacity":["occlusion_opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-emissive-strength":["emissive_strength"],"icon-emissive-strength":["emissive_strength"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"symbol-z-offset":["z_offset"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function yp(c,n){return Ka[c]||[c.replace(`${n}-`,"").replace(/-/g,"_")]}const G0={"line-pattern":{source:ba,composite:ba},"fill-pattern":{source:ba,composite:ba},"fill-extrusion-pattern":{source:ba,composite:ba},"line-dasharray":{source:jf,composite:jf}},Ns={color:{source:Eu,composite:Ic},number:{source:zs,composite:Eu}};function vp(c,n,o){const u=G0[c];return u&&u[o]||Ns[n][o]}hn(Ao,"ConstantBinder"),hn(fo,"PatternConstantBinder"),hn(Bs,"SourceExpressionBinder"),hn(gs,"PatternCompositeBinder"),hn(Vo,"CompositeExpressionBinder"),hn(il,"ProgramConfiguration",{omit:["_buffers"]}),hn(Co,"ProgramConfigurationSet");const La=Kt/Math.PI/2,$o=5,Fl=6,Lh=16383,zc=64,zh=[zc,32,16],Ga=-La,Ha=La;function Iu(c,n,o,u=La){return o=$n(o),[c*Math.sin(o)*u,-n*u,c*Math.cos(o)*u]}function kc(c,n,o){return Iu(Math.cos($n(c)),Math.sin($n(c)),n,o)}const Fs=63710088e-1,al=2*Math.PI*Fs;class pr{constructor(n,o){if(isNaN(n)||isNaN(o))throw new Error(`Invalid LngLat object: (${n}, ${o})`);if(this.lng=+n,this.lat=+o,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new pr(Jo(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(n){const o=Math.PI/180,u=this.lat*o,_=n.lat*o,d=Math.sin(u)*Math.sin(_)+Math.cos(u)*Math.cos(_)*Math.cos((n.lng-this.lng)*o);return Fs*Math.acos(Math.min(d,1))}toBounds(n=0){const o=360*n/40075017,u=o/Math.cos(Math.PI/180*this.lat);return new jl({lng:this.lng-u,lat:this.lat-o},{lng:this.lng+u,lat:this.lat+o})}toEcef(n){return kc(this.lat,this.lng,La+n*La/Fs)}static convert(n){if(n instanceof pr)return n;if(Array.isArray(n)&&(n.length===2||n.length===3))return new pr(Number(n[0]),Number(n[1]));if(!Array.isArray(n)&&typeof n=="object"&&n!==null)return new pr(Number("lng"in n?n.lng:n.lon),Number(n.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class jl{constructor(n,o){if(n)if(o)this.setSouthWest(n).setNorthEast(o);else if(n.length===4){const u=n;this.setSouthWest([u[0],u[1]]).setNorthEast([u[2],u[3]])}else{const u=n;this.setSouthWest(u[0]).setNorthEast(u[1])}}setNorthEast(n){return this._ne=n instanceof pr?new pr(n.lng,n.lat):pr.convert(n),this}setSouthWest(n){return this._sw=n instanceof pr?new pr(n.lng,n.lat):pr.convert(n),this}extend(n){const o=this._sw,u=this._ne;let _,d;if(n instanceof pr)_=n,d=n;else{if(!(n instanceof jl))return Array.isArray(n)?n.length===4||n.every(Array.isArray)?this.extend(jl.convert(n)):this.extend(pr.convert(n)):typeof n=="object"&&n!==null&&n.hasOwnProperty("lat")&&(n.hasOwnProperty("lon")||n.hasOwnProperty("lng"))?this.extend(pr.convert(n)):this;if(_=n._sw,d=n._ne,!_||!d)return this}return o||u?(o.lng=Math.min(_.lng,o.lng),o.lat=Math.min(_.lat,o.lat),u.lng=Math.max(d.lng,u.lng),u.lat=Math.max(d.lat,u.lat)):(this._sw=new pr(_.lng,_.lat),this._ne=new pr(d.lng,d.lat)),this}getCenter(){return new pr((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new pr(this.getWest(),this.getNorth())}getSouthEast(){return new pr(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(n){const{lng:o,lat:u}=pr.convert(n);let _=this._sw.lng<=o&&o<=this._ne.lng;return this._sw.lng>this._ne.lng&&(_=this._sw.lng>=o&&o>=this._ne.lng),this._sw.lat<=u&&u<=this._ne.lat&&_}static convert(n){if(n)return n instanceof jl?n:new jl(n)}}const Pu=0,qo=25.5;function Xf(c){return al*Math.cos(c*Math.PI/180)}function js(c){return(180+c)/360}function ys(c){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+c*Math.PI/360)))/360}function za(c,n){return c/Xf(n)}function Ja(c){return 360*c-180}function $i(c){return 360/Math.PI*Math.atan(Math.exp((180-360*c)*Math.PI/180))-90}function ol(c,n){return c*Xf($i(n))}const Br=85.051129;function Yf(c){return Math.cos($n(Bn(c,-85.051129,Br)))}function Ru(c,n){const o=Bn(n,Pu,qo),u=Math.pow(2,o);return Yf(c)*al/(512*u)}function p(c){return 1/Math.cos(c*Math.PI/180)}function r(c,n=0){const o=Math.exp(Math.PI*(1-(c.y+n/Kt)/(1<<c.z)*2));return 80150034*o/(o*o+1)/Kt/(1<<c.z)}class l{constructor(n,o,u=0){this.x=+n,this.y=+o,this.z=+u}static fromLngLat(n,o=0){const u=pr.convert(n);return new l(js(u.lng),ys(u.lat),za(o,u.lat))}toLngLat(){return new pr(Ja(this.x),$i(this.y))}toAltitude(){return ol(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/al*p($i(this.y))}}function m(c,n,o,u,_,d,y,E,M){const k=(n+u)/2,w=(o+_)/2,I=new It(k,w);E(I),function(D,C,P,B,q,H){const te=P-q,re=B-H;return Math.abs((B-C)*te-(P-D)*re)/Math.hypot(te,re)}(I.x,I.y,d.x,d.y,y.x,y.y)>=M?(m(c,n,o,k,w,d,I,E,M),m(c,k,w,u,_,I,y,E,M)):c.push(y)}function x(c,n,o){let u=c[0],_=u.x,d=u.y;n(u);const y=[u];for(let E=1;E<c.length;E++){const M=c[E],{x:k,y:w}=M;n(M),m(y,_,d,k,w,u,M,n,o),_=k,d=w,u=M}return y}function b(c,n,o,u){if(u(n,o)){const _=n.add(o)._mult(.5);b(c,n,_,u),b(c,_,o,u)}else c.push(o)}function A(c,n){let o=c[0];const u=[o];for(let _=1;_<c.length;_++){const d=c[_];b(u,o,d,n),o=d}return u}const R=Math.pow(2,14)-1,N=-R-1;function U(c,n){const o=Math.round(c.x*n),u=Math.round(c.y*n);return c.x=Bn(o,N,R),c.y=Bn(u,N,R),(o<c.x||o>c.x+1||u<c.y||u>c.y+1)&&qn("Geometry exceeds allowed extent, reduce your vector tile buffer size"),c}function $(c,n,o){const u=c.loadGeometry(),_=c.extent,d=Kt/_;if(n&&o&&o.projection.isReprojectedInTileSpace){const y=1<<n.z,{scale:E,x:M,y:k,projection:w}=o,I=D=>{const C=Ja((n.x+D.x/_)/y),P=$i((n.y+D.y/_)/y),B=w.project(C,P);D.x=(B.x*E-M)*_,D.y=(B.y*E-k)*_};for(let D=0;D<u.length;D++)if(c.type!==1)u[D]=x(u[D],I,1);else{const C=[];for(const P of u[D])P.x<0||P.x>=_||P.y<0||P.y>=_||(I(P),C.push(P));u[D]=C}}for(const y of u)for(const E of y)U(E,d);return u}function Z(c,n){return{type:c.type,id:c.id,properties:c.properties,geometry:n?$(c):[]}}function W(c,n,o,u,_){c.emplaceBack(2*n+(u+1)/2,2*o+(_+1)/2)}function ee(c,n,o){c.emplaceBack(n.x,n.y,n.z,o[0]*16384,o[1]*16384,o[2]*16384)}class ue{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(o=>o.fqid),this.index=n.index,this.hasPattern=!1,this.projection=n.projection,this.layoutVertexArray=new el,this.indexArray=new ia,this.segments=new ci,this.programConfigurations=new Co(n.layers,{zoom:n.zoom,lut:n.lut}),this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}updateFootprints(n,o){}populate(n,o,u,_){const d=this.layers[0],y=[];let E=null;d.type==="circle"&&(E=d.layout.get("circle-sort-key"));for(const{feature:k,id:w,index:I,sourceLayerIndex:D}of n){const C=this.layers[0]._featureFilter.needGeometry,P=Z(k,C);if(!this.layers[0]._featureFilter.filter(new kr(this.zoom),P,u))continue;const B=E?E.evaluate(P,{},u):void 0,q={id:w,properties:k.properties,type:k.type,sourceLayerIndex:D,index:I,geometry:C?P.geometry:$(k,u,_),patterns:{},sortKey:B};y.push(q)}E&&y.sort((k,w)=>k.sortKey-w.sortKey);let M=null;_.projection.name==="globe"&&(this.globeExtVertexArray=new Ch,M=_.projection);for(const k of y){const{geometry:w,index:I,sourceLayerIndex:D}=k,C=n[I].feature;this.addFeature(k,w,I,o.availableImages,u,M,o.brightness),o.featureIndex.insert(C,w,I,D,this.index)}}update(n,o,u,_,d,y,E){this.programConfigurations.updatePaintArrays(n,o,d,u,_,y,E)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,$0.members),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=n.createVertexBuffer(this.globeExtVertexArray,Gf.members))),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(n,o,u,_,d,y,E){for(const M of o)for(const k of M){const w=k.x,I=k.y;if(w<0||w>=Kt||I<0||I>=Kt)continue;if(y){const P=y.projectTilePoint(w,I,d),B=y.upVector(d,w,I),q=this.globeExtVertexArray;ee(q,P,B),ee(q,P,B),ee(q,P,B),ee(q,P,B)}const D=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,n.sortKey),C=D.vertexLength;W(this.layoutVertexArray,w,I,-1,-1),W(this.layoutVertexArray,w,I,1,-1),W(this.layoutVertexArray,w,I,1,1),W(this.layoutVertexArray,w,I,-1,1),this.indexArray.emplaceBack(C,C+1,C+2),this.indexArray.emplaceBack(C,C+2,C+3),D.vertexLength+=4,D.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,u,{},_,d,E)}}function oe(c,n){for(let o=0;o<c.length;o++)if(De(n,c[o]))return!0;for(let o=0;o<n.length;o++)if(De(c,n[o]))return!0;return!!Pe(c,n)}function de(c,n,o){return!!De(c,n)||!!Fe(n,c,o)}function fe(c,n){if(c.length===1)return ke(n,c[0]);for(let o=0;o<n.length;o++){const u=n[o];for(let _=0;_<u.length;_++)if(De(c,u[_]))return!0}for(let o=0;o<c.length;o++)if(ke(n,c[o]))return!0;for(let o=0;o<n.length;o++)if(Pe(c,n[o]))return!0;return!1}function Te(c,n,o){if(c.length>1){if(Pe(c,n))return!0;for(let u=0;u<n.length;u++)if(Fe(n[u],c,o))return!0}for(let u=0;u<c.length;u++)if(Fe(c[u],n,o))return!0;return!1}function Pe(c,n){if(c.length===0||n.length===0)return!1;for(let o=0;o<c.length-1;o++){const u=c[o],_=c[o+1];for(let d=0;d<n.length-1;d++)if(Oe(u,_,n[d],n[d+1]))return!0}return!1}function Oe(c,n,o,u){return Hs(c,o,u)!==Hs(n,o,u)&&Hs(c,n,o)!==Hs(c,n,u)}function Fe(c,n,o){const u=o*o;if(n.length===1)return c.distSqr(n[0])<u;for(let _=1;_<n.length;_++)if(Re(c,n[_-1],n[_])<u)return!0;return!1}function Re(c,n,o){const u=n.distSqr(o);if(u===0)return c.distSqr(n);const _=((c.x-n.x)*(o.x-n.x)+(c.y-n.y)*(o.y-n.y))/u;return c.distSqr(_<0?n:_>1?o:o.sub(n)._mult(_)._add(n))}function ke(c,n){let o,u,_,d=!1;for(let y=0;y<c.length;y++){o=c[y];for(let E=0,M=o.length-1;E<o.length;M=E++)u=o[E],_=o[M],u.y>n.y!=_.y>n.y&&n.x<(_.x-u.x)*(n.y-u.y)/(_.y-u.y)+u.x&&(d=!d)}return d}function De(c,n){let o=!1;for(let u=0,_=c.length-1;u<c.length;_=u++){const d=c[u],y=c[_];d.y>n.y!=y.y>n.y&&n.x<(y.x-d.x)*(n.y-d.y)/(y.y-d.y)+d.x&&(o=!o)}return o}function $e(c,n,o,u,_){for(const y of c)if(n<=y.x&&o<=y.y&&u>=y.x&&_>=y.y)return!0;const d=[new It(n,o),new It(n,_),new It(u,_),new It(u,o)];if(c.length>2){for(const y of d)if(De(c,y))return!0}for(let y=0;y<c.length-1;y++)if(Xe(c[y],c[y+1],d))return!0;return!1}function Xe(c,n,o){const u=o[0],_=o[2];if(c.x<u.x&&n.x<u.x||c.x>_.x&&n.x>_.x||c.y<u.y&&n.y<u.y||c.y>_.y&&n.y>_.y)return!1;const d=Hs(c,n,o[0]);return d!==Hs(c,n,o[1])||d!==Hs(c,n,o[2])||d!==Hs(c,n,o[3])}function ft(c,n,o,u,_,d){let y=n.y-c.y,E=c.x-n.x;if(d=d||0){const M=y*y+E*E;if(M===0)return!0;const k=Math.sqrt(M);y/=k,E/=k}return!((o.x-c.x)*y+(o.y-c.y)*E-d<0||(u.x-c.x)*y+(u.y-c.y)*E-d<0||(_.x-c.x)*y+(_.y-c.y)*E-d<0)}function ot(c,n,o,u,_,d,y){return!(ft(c,n,u,_,d,y)||ft(n,o,u,_,d,y)||ft(o,c,u,_,d,y)||ft(u,_,c,n,o,y)||ft(_,d,c,n,o,y)||ft(d,u,c,n,o,y))}function Et(c,n,o){const u=n.paint.get(c).value;return u.kind==="constant"?u.value:o.programConfigurations.get(n.id).getMaxValue(c)}function vt(c){return Math.sqrt(c[0]*c[0]+c[1]*c[1])}function nt(c,n,o,u,_){if(!n[0]&&!n[1])return c;const d=It.convert(n)._mult(_);o==="viewport"&&d._rotate(-u);const y=[];for(let E=0;E<c.length;E++)y.push(c[E].sub(d));return y}function pt(c,n,o,u){const _=It.convert(c)._mult(u);return n==="viewport"&&_._rotate(-o),_}let Lt,tt;hn(ue,"CircleBucket",{omit:["layers"]});var St,mt={exports:{}},Gt=(St||(St=1,function(c,n){(function(o){function u(d,y,E){var M=_(256*d,256*(y=Math.pow(2,E)-y-1),E),k=_(256*(d+1),256*(y+1),E);return M[0]+","+M[1]+","+k[0]+","+k[1]}function _(d,y,E){var M=2*Math.PI*6378137/256/Math.pow(2,E);return[d*M-2*Math.PI*6378137/2,y*M-2*Math.PI*6378137/2]}o.getURL=function(d,y,E,M,k,w){return w=w||{},d+"?"+["bbox="+u(E,M,k),"format="+(w.format||"image/png"),"service="+(w.service||"WMS"),"version="+(w.version||"1.1.1"),"request="+(w.request||"GetMap"),"srs="+(w.srs||"EPSG:3857"),"width="+(w.width||256),"height="+(w.height||256),"layers="+y].join("&")},o.getTileBBox=u,o.getMercCoords=_,Object.defineProperty(o,"__esModule",{value:!0})})(n)}(0,mt.exports)),mt.exports);class Pt{constructor(n,o,u){this.z=n,this.x=o,this.y=u,this.key=Wt(0,n,n,o,u)}equals(n){return this.z===n.z&&this.x===n.x&&this.y===n.y}url(n,o){const u=Gt.getTileBBox(this.x,this.y,this.z),_=function(d,y,E){let M,k="";for(let w=d;w>0;w--)M=1<<w-1,k+=(y&M?1:0)+(E&M?2:0);return k}(this.z,this.x,this.y);return n[(this.x+this.y)%n.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(o==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",_).replace("{bbox-epsg-3857}",u)}toString(){return`${this.z}/${this.x}/${this.y}`}}class At{constructor(n,o){this.wrap=n,this.canonical=o,this.key=Wt(n,o.z,o.z,o.x,o.y)}}class kt{constructor(n,o,u,_,d){this.overscaledZ=n,this.wrap=o,this.canonical=new Pt(u,+_,+d),this.key=o===0&&n===u?this.canonical.key:Wt(o,n,u,_,d)}equals(n){return this.overscaledZ===n.overscaledZ&&this.wrap===n.wrap&&this.canonical.equals(n.canonical)}scaledTo(n){const o=this.canonical.z-n;return n>this.canonical.z?new kt(n,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new kt(n,this.wrap,n,this.canonical.x>>o,this.canonical.y>>o)}calculateScaledKey(n,o=!0){if(this.overscaledZ===n&&o)return this.key;if(n>this.canonical.z)return Wt(this.wrap*+o,n,this.canonical.z,this.canonical.x,this.canonical.y);{const u=this.canonical.z-n;return Wt(this.wrap*+o,n,n,this.canonical.x>>u,this.canonical.y>>u)}}isChildOf(n){if(n.wrap!==this.wrap)return!1;const o=this.canonical.z-n.canonical.z;return n.overscaledZ===0||n.overscaledZ<this.overscaledZ&&n.canonical.z<this.canonical.z&&n.canonical.x===this.canonical.x>>o&&n.canonical.y===this.canonical.y>>o}children(n){if(this.overscaledZ>=n)return[new kt(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const o=this.canonical.z+1,u=2*this.canonical.x,_=2*this.canonical.y;return[new kt(o,this.wrap,o,u,_),new kt(o,this.wrap,o,u+1,_),new kt(o,this.wrap,o,u,_+1),new kt(o,this.wrap,o,u+1,_+1)]}isLessThan(n){return this.wrap<n.wrap||!(this.wrap>n.wrap)&&(this.overscaledZ<n.overscaledZ||!(this.overscaledZ>n.overscaledZ)&&(this.canonical.x<n.canonical.x||!(this.canonical.x>n.canonical.x)&&this.canonical.y<n.canonical.y))}wrapped(){return new kt(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(n){return new kt(this.overscaledZ,n,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new At(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function Wt(c,n,o,u,_){const d=1<<Math.min(o,22);let y=d*(_%d)+u%d;return c&&o<22&&(y+=d*d*((c<0?-2*c-1:2*c)%(1<<2*(22-o)))),16*(32*y+o)+(n-o)}const on=[c=>{let n=c.canonical.x-1,o=c.wrap;return n<0&&(n=(1<<c.canonical.z)-1,o--),new kt(c.overscaledZ,o,c.canonical.z,n,c.canonical.y)},c=>{let n=c.canonical.x+1,o=c.wrap;return n===1<<c.canonical.z&&(n=0,o++),new kt(c.overscaledZ,o,c.canonical.z,n,c.canonical.y)},c=>new kt(c.overscaledZ,c.wrap,c.canonical.z,c.canonical.x,(c.canonical.y===0?1<<c.canonical.z:c.canonical.y)-1),c=>new kt(c.overscaledZ,c.wrap,c.canonical.z,c.canonical.x,c.canonical.y===(1<<c.canonical.z)-1?0:c.canonical.y+1)];hn(Pt,"CanonicalTileID"),hn(kt,"OverscaledTileID",{omit:["projMatrix","expandedProjMatrix"]});const dn=br([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:En}=dn,Sn=br([{name:"a_pos_3",components:3,type:"Int16"}]);var bn=br([{name:"a_pos",type:"Int16",components:2}]);class Ln{constructor(n,o){this.pos=n,this.dir=o}intersectsPlane(n,o,u){const _=Ne.vec3.dot(o,this.dir);if(Math.abs(_)<1e-6)return!1;const d=((n[0]-this.pos[0])*o[0]+(n[1]-this.pos[1])*o[1]+(n[2]-this.pos[2])*o[2])/_;return u[0]=this.pos[0]+this.dir[0]*d,u[1]=this.pos[1]+this.dir[1]*d,u[2]=this.pos[2]+this.dir[2]*d,!0}closestPointOnSphere(n,o,u){if(Ne.vec3.equals(this.pos,n)||o===0)return u[0]=u[1]=u[2]=0,!1;const[_,d,y]=this.dir,E=this.pos[0]-n[0],M=this.pos[1]-n[1],k=this.pos[2]-n[2],w=_*_+d*d+y*y,I=2*(E*_+M*d+k*y),D=I*I-4*w*(E*E+M*M+k*k-o*o);if(D<0){const C=Math.max(-I/2,0),P=E+_*C,B=M+d*C,q=k+y*C,H=Math.hypot(P,B,q);return u[0]=P*o/H,u[1]=B*o/H,u[2]=q*o/H,!1}{const C=(-I-Math.sqrt(D))/(2*w);if(C<0){const P=Math.hypot(E,M,k);return u[0]=E*o/P,u[1]=M*o/P,u[2]=k*o/P,!1}return u[0]=E+_*C,u[1]=M+d*C,u[2]=k+y*C,!0}}}class zn{constructor(n,o,u,_,d){this.TL=n,this.TR=o,this.BR=u,this.BL=_,this.horizon=d}static fromInvProjectionMatrix(n,o,u){const _=[-1,1,1],d=[1,1,1],y=[1,-1,1],E=[-1,-1,1],M=Ne.vec3.transformMat4(_,_,n),k=Ne.vec3.transformMat4(d,d,n),w=Ne.vec3.transformMat4(y,y,n),I=Ne.vec3.transformMat4(E,E,n);return new zn(M,k,w,I,o/u)}}function Mr(c,n,o){let u=1/0,_=-1/0;const d=[];for(const y of c){Ne.vec3.sub(d,y,n);const E=Ne.vec3.dot(d,o);u=Math.min(u,E),_=Math.max(_,E)}return[u,_]}function ui(c,n){let o=!0;for(let u=0;u<c.planes.length;u++){const _=c.planes[u];let d=0;for(let y=0;y<n.length;y++)d+=Ne.vec3.dot(_,n[y])+_[3]>=0;if(d===0)return 0;d!==n.length&&(o=!1)}return o?2:1}function qr(c,n){for(const o of c.projections){const u=Mr(n,c.points[0],o.axis);if(o.projection[1]<u[0]||o.projection[0]>u[1])return 0}return 1}function Fn(c,n){let o=0;const u=[0,0,0,0];for(let _=0;_<c.length;_++)u[0]=c[_][0],u[1]=c[_][1],u[2]=c[_][2],u[3]=1,Ne.vec4.dot(u,n)>=0&&o++;return o}class mr{constructor(n,o){this.points=n||new Array(8).fill([0,0,0]),this.planes=o||new Array(6).fill([0,0,0,0]),this.bounds=sn.fromPoints(this.points),this.projections=[],this.frustumEdges=[Ne.vec3.sub([],this.points[2],this.points[3]),Ne.vec3.sub([],this.points[0],this.points[3]),Ne.vec3.sub([],this.points[4],this.points[0]),Ne.vec3.sub([],this.points[5],this.points[1]),Ne.vec3.sub([],this.points[6],this.points[2]),Ne.vec3.sub([],this.points[7],this.points[3])];for(const u of this.frustumEdges){const _=[0,-u[2],u[1]],d=[u[2],0,-u[0]];this.projections.push({axis:_,projection:Mr(this.points,this.points[0],_)}),this.projections.push({axis:d,projection:Mr(this.points,this.points[0],d)})}}static fromInvProjectionMatrix(n,o,u,_){const d=Math.pow(2,u),y=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(k=>{const w=Ne.vec4.transformMat4([],k,n),I=1/w[3]/o*d;return Ne.vec4.mul(w,w,[I,I,_?1/w[3]:I,I])}),E=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(k=>{const w=Ne.vec3.sub([],y[k[0]],y[k[1]]),I=Ne.vec3.sub([],y[k[2]],y[k[1]]),D=Ne.vec3.normalize([],Ne.vec3.cross([],w,I)),C=-Ne.vec3.dot(D,y[k[1]]);return D.concat(C)}),M=[];for(let k=0;k<y.length;k++)M.push([y[k][0],y[k][1],y[k][2]]);return new mr(M,E)}intersectsPrecise(n,o,u){for(let _=0;_<o.length;_++)if(!Fn(n,o[_]))return 0;for(let _=0;_<this.planes.length;_++)if(!Fn(n,this.planes[_]))return 0;for(const _ of u)for(const d of this.frustumEdges){const y=Ne.vec3.cross([],_,d),E=Ne.vec3.length(y);if(E===0)continue;Ne.vec3.scale(y,y,1/E);const M=Mr(this.points,this.points[0],y),k=Mr(n,this.points[0],y);if(M[0]>k[1]||k[0]>M[1])return 0}return 1}containsPoint(n){for(const o of this.planes){const u=o[3];if(Ne.vec3.dot([o[0],o[1],o[2]],n)+u<0)return!1}return!0}}class sn{static fromPoints(n){const o=[1/0,1/0,1/0],u=[-1/0,-1/0,-1/0];for(const _ of n)Ne.vec3.min(o,o,_),Ne.vec3.max(u,u,_);return new sn(o,u)}static fromTileIdAndHeight(n,o,u){const _=1<<n.canonical.z,d=n.canonical.x,y=n.canonical.y;return new sn([d/_,y/_,o],[(d+1)/_,(y+1)/_,u])}static applyTransform(n,o){const u=n.getCorners();for(let _=0;_<u.length;++_)Ne.vec3.transformMat4(u[_],u[_],o);return sn.fromPoints(u)}static applyTransformFast(n,o){const u=[o[12],o[13],o[14]],_=[...u];for(let d=0;d<3;d++)for(let y=0;y<3;y++){const E=o[4*y+d],M=E*n.min[y],k=E*n.max[y];u[d]+=Math.min(M,k),_[d]+=Math.max(M,k)}return new sn(u,_)}static projectAabbCorners(n,o){const u=n.getCorners();for(let _=0;_<u.length;++_)Ne.vec3.transformMat4(u[_],u[_],o);return u}constructor(n,o){this.min=n,this.max=o,this.center=Ne.vec3.scale([],Ne.vec3.add([],this.min,this.max),.5)}quadrant(n){const o=[n%2==0,n<2],u=Ne.vec3.clone(this.min),_=Ne.vec3.clone(this.max);for(let d=0;d<o.length;d++)u[d]=o[d]?this.min[d]:this.center[d],_[d]=o[d]?this.center[d]:this.max[d];return _[2]=this.max[2],new sn(u,_)}distanceX(n){return Math.max(Math.min(this.max[0],n[0]),this.min[0])-n[0]}distanceY(n){return Math.max(Math.min(this.max[1],n[1]),this.min[1])-n[1]}distanceZ(n){return Math.max(Math.min(this.max[2],n[2]),this.min[2])-n[2]}getCorners(){const n=this.min,o=this.max;return[[n[0],n[1],n[2]],[o[0],n[1],n[2]],[o[0],o[1],n[2]],[n[0],o[1],n[2]],[n[0],n[1],o[2]],[o[0],n[1],o[2]],[o[0],o[1],o[2]],[n[0],o[1],o[2]]]}intersects(n){return this.intersectsAabb(n.bounds)?ui(n,this.getCorners()):0}intersectsFlat(n){return this.intersectsAabb(n.bounds)?ui(n,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsPrecise(n,o){return o||this.intersects(n)?qr(n,this.getCorners()):0}intersectsPreciseFlat(n,o){return o||this.intersectsFlat(n)?qr(n,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsAabb(n){for(let o=0;o<3;++o)if(this.min[o]>n.max[o]||n.min[o]>this.max[o])return!1;return!0}intersectsAabbXY(n){return!(this.min[0]>n.max[0]||n.min[0]>this.max[0]||this.min[1]>n.max[1]||n.min[1]>this.max[1])}encapsulate(n){for(let o=0;o<3;o++)this.min[o]=Math.min(this.min[o],n.min[o]),this.max[o]=Math.max(this.max[o],n.max[o])}encapsulatePoint(n){for(let o=0;o<3;o++)this.min[o]=Math.min(this.min[o],n[o]),this.max[o]=Math.max(this.max[o],n[o])}closestPoint(n){return[Math.max(Math.min(this.max[0],n[0]),this.min[0]),Math.max(Math.min(this.max[1],n[1]),this.min[1]),Math.max(Math.min(this.max[2],n[2]),this.min[2])]}}function In(c){return c*La/Fs}hn(sn,"Aabb");const An=[new sn([Ga,Ga,Ga],[Ha,Ha,Ha]),new sn([Ga,Ga,Ga],[0,0,Ha]),new sn([0,Ga,Ga],[Ha,0,Ha]),new sn([Ga,0,Ga],[0,Ha,Ha]),new sn([0,0,Ga],[Ha,Ha,Ha])];function Pn(c,n,o,u=!0){const _=Ne.vec3.scale([],c._camera.position,c.worldSize),d=[n,o,1,1];Ne.vec4.transformMat4(d,d,c.pixelMatrixInverse),Ne.vec4.scale(d,d,1/d[3]);const y=Ne.vec3.sub([],d,_),E=Ne.vec3.normalize([],y),M=c.globeMatrix,k=[M[12],M[13],M[14]],w=Ne.vec3.sub([],k,_),I=Ne.vec3.length(w),D=Ne.vec3.normalize([],w),C=c.worldSize/(2*Math.PI),P=Ne.vec3.dot(D,E),B=Math.asin(C/I);if(B<Math.acos(P)){if(!u)return null;const Ue=[],Ie=[];Ne.vec3.scale(Ue,E,I/P),Ne.vec3.normalize(Ie,Ne.vec3.sub(Ie,Ue,w)),Ne.vec3.normalize(E,Ne.vec3.add(E,w,Ne.vec3.scale(E,Ie,Math.tan(B)*I)))}const q=[];new Ln(_,E).closestPointOnSphere(k,C,q);const H=Ne.vec3.normalize([],Zs(M,0)),te=Ne.vec3.normalize([],Zs(M,1)),re=Ne.vec3.normalize([],Zs(M,2)),J=Ne.vec3.dot(H,q),ie=Ne.vec3.dot(te,q),ce=Ne.vec3.dot(re,q),me=si(Math.asin(-ie/C));let Ce=si(Math.atan2(J,ce));Ce=c.center.lng+function(Ue,Ie){const Ve=(Ie-Ue+180)%360-180;return Ve<-180?Ve+360:Ve}(c.center.lng,Ce);const Ae=js(Ce),Ee=Bn(ys(me),0,1);return new l(Ae,Ee)}class or{constructor(n,o,u){this.a=Ne.vec3.sub([],n,u),this.b=Ne.vec3.sub([],o,u),this.center=u;const _=Ne.vec3.normalize([],this.a),d=Ne.vec3.normalize([],this.b);this.angle=Math.acos(Ne.vec3.dot(_,d))}}function Gr(c,n){if(c.angle===0)return null;let o;return o=c.a[n]===0?1/c.angle*.5*Math.PI:1/c.angle*Math.atan(c.b[n]/c.a[n]/Math.sin(c.angle)-1/Math.tan(c.angle)),o<0||o>1?null:function(u,_,d,y){const E=Math.sin(d);return u*(Math.sin((1-y)*d)/E)+_*(Math.sin(y*d)/E)}(c.a[n],c.b[n],c.angle,Bn(o,0,1))+c.center[n]}function Kr(c){if(c.z<=1)return An[c.z+2*c.y+c.x];const n=Tr(hr(c));return sn.fromPoints(n)}function hi(c,n,o){return Ne.vec3.scale(c,c,1-o),Ne.vec3.scaleAndAdd(c,c,n,o)}function po(c,n,o){for(const u of c)Ne.vec3.transformMat4(u,u,n),Ne.vec3.scale(u,u,o)}function Ci(c,n,o,u){const _=n/c.worldSize,d=c.globeMatrix;if(o.z<=1){const Ae=Kr(o).getCorners();return po(Ae,d,_),sn.fromPoints(Ae)}const y=hr(o,u),E=Tr(y,La+In(c._tileCoverLift));po(E,d,_);const M=Number.MAX_VALUE,k=[-M,-M,-M],w=[M,M,M];if(y.contains(c.center)){for(const Ue of E)Ne.vec3.min(w,w,Ue),Ne.vec3.max(k,k,Ue);k[2]=0;const Ae=c.point,Ee=[Ae.x*_,Ae.y*_,0];return Ne.vec3.min(w,w,Ee),Ne.vec3.max(k,k,Ee),new sn(w,k)}if(c._tileCoverLift>0){for(const Ae of E)Ne.vec3.min(w,w,Ae),Ne.vec3.max(k,k,Ae);return new sn(w,k)}const I=[d[12]*_,d[13]*_,d[14]*_],D=y.getCenter(),C=Bn(c.center.lat,-85.051129,Br),P=Bn(D.lat,-85.051129,Br),B=js(c.center.lng),q=ys(C);let H=B-js(D.lng);const te=q-ys(P);H>.5?H-=1:H<-.5&&(H+=1);let re=0;if(Math.abs(H)>Math.abs(te))re=H>=0?1:3;else{re=te>=0?0:2;const Ae=[d[4]*_,d[5]*_,d[6]*_],Ee=-Math.sin($n(te>=0?y.getSouth():y.getNorth()))*La;Ne.vec3.scaleAndAdd(I,I,Ae,Ee)}const J=E[re],ie=E[(re+1)%4],ce=new or(J,ie,I),me=[Gr(ce,0)||J[0],Gr(ce,1)||J[1],Gr(ce,2)||J[2]],Ce=ka(c.zoom);if(Ce>0){const Ae=function({x:Ue,y:Ie,z:Ve},Ze,qe,Ke,Qe){const at=1/(1<<Ve);let Je=Ue*at,wt=Je+at,Rt=Ie*at,bt=Rt+at,an=0;const Jt=(Je+wt)/2-Ke;return Jt>.5?an=-1:Jt<-.5&&(an=1),Je=((Je+an)*Ze-(Ke*=Ze))*qe+Ke,wt=((wt+an)*Ze-Ke)*qe+Ke,Rt=(Rt*Ze-(Qe*=Ze))*qe+Qe,bt=(bt*Ze-Qe)*qe+Qe,[[Je,bt,0],[wt,bt,0],[wt,Rt,0],[Je,Rt,0]]}(o,n,c._pixelsPerMercatorPixel,B,q);for(let Ue=0;Ue<E.length;Ue++)hi(E[Ue],Ae[Ue],Ce);const Ee=Ne.vec3.add([],Ae[re],Ae[(re+1)%4]);Ne.vec3.scale(Ee,Ee,.5),hi(me,Ee,Ce)}for(const Ae of E)Ne.vec3.min(w,w,Ae),Ne.vec3.max(k,k,Ae);return w[2]=Math.min(J[2],ie[2]),Ne.vec3.min(w,w,me),Ne.vec3.max(k,k,me),new sn(w,k)}function hr({x:c,y:n,z:o},u=!1){const _=1/(1<<o),d=new pr(Ja(c*_),n===(1<<o)-1&&u?-90:$i((n+1)*_)),y=new pr(Ja((c+1)*_),n===0&&u?90:$i(n*_));return new jl(d,y)}function Tr(c,n=La){const o=$n(c.getNorth()),u=$n(c.getSouth()),_=Math.cos(o),d=Math.cos(u),y=Math.sin(o),E=Math.sin(u),M=c.getWest(),k=c.getEast();return[Iu(d,E,M,n),Iu(d,E,k,n),Iu(_,y,k,n),Iu(_,y,M,n)]}function Sr(c,n,o,u){const _=1<<o.z,d=(c/Kt+o.x)/_;return kc($i((n/Kt+o.y)/_),Ja(d),u)}function cr({min:c,max:n}){return Lh/Math.max(n[0]-c[0],n[1]-c[1],n[2]-c[2])}const Nr=new Float64Array(16);function xi(c){const n=cr(c),o=Ne.mat4.fromScaling(Nr,[n,n,n]);return Ne.mat4.translate(o,o,Ne.vec3.negate([],c.min))}function Or(c){const n=Ne.mat4.fromTranslation(Nr,c.min),o=1/cr(c);return Ne.mat4.scale(n,n,[o,o,o])}function bi(c){const n=Kt/(2*Math.PI);return c/(2*Math.PI)/n}function Mo(c,n){return Kt/(512*Math.pow(2,c))*cr(Kr(n))}function Qa(c,n,o,u,_){const d=bi(o),y=[c,n,-o/(2*Math.PI)],E=Ne.mat4.identity(new Float64Array(16));return Ne.mat4.translate(E,E,y),Ne.mat4.scale(E,E,[d,d,d]),Ne.mat4.rotateX(E,E,$n(-_)),Ne.mat4.rotateY(E,E,$n(-u)),E}function ka(c){return Lo($o,Fl,c)}function Go(c,n){const o=kc(n.lat,n.lng),u=function(d){const y=kc(d._center.lat,d._center.lng),E=Ne.vec3.fromValues(0,1,0);let M=Ne.vec3.cross([],E,y);const k=Ne.mat4.fromRotation([],-d.angle,y);M=Ne.vec3.transformMat4(M,M,k),Ne.mat4.fromRotation(k,-d._pitch,M);const w=Ne.vec3.normalize([],y);return Ne.vec3.scale(w,w,In(d.cameraToCenterDistance/d.pixelsPerMeter)),Ne.vec3.transformMat4(w,w,k),Ne.vec3.add([],y,w)}(c),_=Ne.vec3.subtract([],u,o);return Ne.vec3.angle(_,o)}function Sa(c,n){return Go(c,n)>Math.PI/2*1.01}const eo=$n(85),Ho=Math.cos(eo),Oo=Math.sin(eo),Ul=Ne.mat4.create(),Bc=c=>{const n=[];return c.paint.get("circle-pitch-alignment")==="map"&&n.push("PITCH_WITH_MAP"),c.paint.get("circle-pitch-scale")==="map"&&n.push("SCALE_WITH_MAP"),n};function Nc(c,n,o,u,_,d,y,E,M){if(d&&c.queryGeometry.isAboveHorizon)return!1;d&&(M*=c.pixelToTileUnitsFactor);const k=c.tileID.canonical,w=o.projection.upVectorScale(k,o.center.lat,o.worldSize).metersToTile;for(const I of n)for(const D of I){const C=D.add(E),P=_&&o.elevation?o.elevation.exaggeration()*_.getElevationAt(C.x,C.y,!0):0,B=o.projection.projectTilePoint(C.x,C.y,k);if(P>0){const re=o.projection.upVector(k,C.x,C.y);B.x+=re[0]*w*P,B.y+=re[1]*w*P,B.z+=re[2]*w*P}const q=d?C:Kf(B.x,B.y,B.z,u),H=d?c.tilespaceRays.map(re=>Zo(re,P)):c.queryGeometry.screenGeometry,te=Ne.vec4.transformMat4([],[B.x,B.y,B.z,1],u);if(!y&&d?M*=te[3]/o.cameraToCenterDistance:y&&!d&&(M*=o.cameraToCenterDistance/te[3]),d){const re=$i((D.y/Kt+k.y)/(1<<k.z));M/=o.projection.pixelsPerMeter(re,1)/za(1,re)}if(de(H,q,M))return!0}return!1}function Kf(c,n,o,u){const _=Ne.vec4.transformMat4([],[c,n,o,1],u);return new It(_[0]/_[3],_[1]/_[3])}const vs=Ne.vec3.fromValues(0,0,0),j1=Ne.vec3.fromValues(0,0,1);function Zo(c,n){const o=Ne.vec3.create();return vs[2]=n,c.intersectsPlane(vs,j1,o),new It(o[0],o[1])}class Xg extends ue{}let H0,Yg,U1,Fc;function Im(c,{width:n,height:o},u,_){if(_){if(_ instanceof Uint8ClampedArray)_=new Uint8Array(_.buffer);else if(_.length!==n*o*u)throw new RangeError("mismatched image size")}else _=new Uint8Array(n*o*u);return c.width=n,c.height=o,c.data=_,c}function Z0(c,n,o){const{width:u,height:_}=n;u===c.width&&_===c.height||(kh(c,n,{x:0,y:0},{x:0,y:0},{width:Math.min(c.width,u),height:Math.min(c.height,_)},o,null),c.width=u,c.height=_,c.data=n.data)}function kh(c,n,o,u,_,d,y,E){if(_.width===0||_.height===0)return n;if(_.width>c.width||_.height>c.height||o.x>c.width-_.width||o.y>c.height-_.height)throw new RangeError("out of range source coordinates for image copy");if(_.width>n.width||_.height>n.height||u.x>n.width-_.width||u.y>n.height-_.height)throw new RangeError("out of range destination coordinates for image copy");const M=c.data,k=n.data,w=d===4&&E;for(let I=0;I<_.height;I++){const D=((o.y+I)*c.width+o.x)*d,C=((u.y+I)*n.width+u.x)*d;if(w)for(let P=0;P<_.width;P++){const B=D+P*d+3,q=C+P*d;k[q+0]=255,k[q+1]=255,k[q+2]=255,k[q+3]=M[B]}else if(y)for(let P=0;P<_.width;P++){const B=D+P*d,q=C+P*d,H=M[B+3],te=new _r(M[B+0]/255*H,M[B+1]/255*H,M[B+2]/255*H,H).toRenderColor(y).toArray();k[q+0]=te[0],k[q+1]=te[1],k[q+2]=te[2],k[q+3]=te[3]}else for(let P=0;P<_.width*d;P++)k[C+P]=M[D+P]}return n}hn(Xg,"HeatmapBucket",{omit:["layers"]});class Du{constructor(n,o){Im(this,n,1,o)}resize(n){Z0(this,new Du(n),1)}clone(){return new Du({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(n,o,u,_,d){kh(n,o,u,_,d,1,null)}}class Ta{constructor(n,o){Im(this,n,4,o)}resize(n){Z0(this,new Ta(n),4)}replace(n,o){o?this.data.set(n):this.data=n instanceof Uint8ClampedArray?new Uint8Array(n.buffer):n}clone(){return new Ta({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(n,o,u,_,d,y,E){kh(n,o,u,_,d,4,y,E)}}class Kg{constructor(n,o){this.width=n.width,this.height=n.height,this.data=o instanceof Uint8Array?new Float32Array(o.buffer):o}}function Jf(c){const n={},o=c.resolution||256,u=c.clips?c.clips.length:1,_=c.image||new Ta({width:o,height:u}),d=(y,E,M)=>{n[c.evaluationKey]=M;const k=c.expression.evaluate(n);k&&(_.data[y+E+0]=Math.floor(255*k.r/k.a),_.data[y+E+1]=Math.floor(255*k.g/k.a),_.data[y+E+2]=Math.floor(255*k.b/k.a),_.data[y+E+3]=Math.floor(255*k.a))};if(c.clips)for(let y=0,E=0;y<u;++y,E+=4*o)for(let M=0,k=0;M<o;M++,k+=4){const w=M/(o-1),{start:I,end:D}=c.clips[y];d(E,k,I*(1-w)+D*w)}else for(let y=0,E=0;y<o;y++,E+=4)d(0,E,y/(o-1));return _}hn(Du,"AlphaImage"),hn(Ta,"RGBAImage");const Jg=br([{name:"a_pos",components:2,type:"Int16"}],4),{members:kw}=Jg;function Pm(c,n,o=2){const u=n&&n.length,_=u?n[0]*o:c.length;let d=V1(c,0,_,o,!0);const y=[];if(!d||d.next===d.prev)return y;let E,M,k;if(u&&(d=function(w,I,D,C){const P=[];for(let B=0,q=I.length;B<q;B++){const H=V1(w,I[B]*C,B<q-1?I[B+1]*C:w.length,C,!1);H===H.next&&(H.steiner=!0),P.push(Mi(H))}P.sort(Bw);for(let B=0;B<P.length;B++)D=G1(P[B],D);return D}(c,n,d,o)),c.length>80*o){E=1/0,M=1/0;let w=-1/0,I=-1/0;for(let D=o;D<_;D+=o){const C=c[D],P=c[D+1];C<E&&(E=C),P<M&&(M=P),C>w&&(w=C),P>I&&(I=P)}k=Math.max(w-E,I-M),k=k!==0?32767/k:0}return xp(d,y,o,E,M,k,0),y}function V1(c,n,o,u,_){let d;if(_===function(y,E,M,k){let w=0;for(let I=E,D=M-k;I<M;I+=k)w+=(y[D]-y[I])*(y[I+1]+y[D+1]),D=I;return w}(c,n,o,u)>0)for(let y=n;y<o;y+=u)d=Rm(y/u|0,c[y],c[y+1],d);else for(let y=o-u;y>=n;y-=u)d=Rm(y/u|0,c[y],c[y+1],d);return d&&Y0(d,d.next)&&(ed(d),d=d.next),d}function Bh(c,n){if(!c)return c;n||(n=c);let o,u=c;do if(o=!1,u.steiner||!Y0(u,u.next)&&qi(u.prev,u,u.next)!==0)u=u.next;else{if(ed(u),u=n=u.prev,u===u.next)break;o=!0}while(o||u!==n);return n}function xp(c,n,o,u,_,d,y){if(!c)return;!y&&d&&function(M,k,w,I){let D=M;do D.z===0&&(D.z=X0(D.x,D.y,k,w,I)),D.prevZ=D.prev,D.nextZ=D.next,D=D.next;while(D!==M);D.prevZ.nextZ=null,D.prevZ=null,function(C){let P,B=1;do{let q,H=C;C=null;let te=null;for(P=0;H;){P++;let re=H,J=0;for(let ce=0;ce<B&&(J++,re=re.nextZ,re);ce++);let ie=B;for(;J>0||ie>0&&re;)J!==0&&(ie===0||!re||H.z<=re.z)?(q=H,H=H.nextZ,J--):(q=re,re=re.nextZ,ie--),te?te.nextZ=q:C=q,q.prevZ=te,te=q;H=re}te.nextZ=null,B*=2}while(P>1)}(D)}(c,u,_,d);let E=c;for(;c.prev!==c.next;){const M=c.prev,k=c.next;if(d?W0(c,u,_,d):bp(c))n.push(M.i,c.i,k.i),ed(c),c=k.next,E=k.next;else if((c=k)===E){y?y===1?xp(c=$1(Bh(c),n),n,o,u,_,d,2):y===2&&q1(c,n,o,u,_,d):xp(Bh(c),n,o,u,_,d,1);break}}}function bp(c){const n=c.prev,o=c,u=c.next;if(qi(n,o,u)>=0)return!1;const _=n.x,d=o.x,y=u.x,E=n.y,M=o.y,k=u.y,w=_<d?_<y?_:y:d<y?d:y,I=E<M?E<k?E:k:M<k?M:k,D=_>d?_>y?_:y:d>y?d:y,C=E>M?E>k?E:k:M>k?M:k;let P=u.next;for(;P!==n;){if(P.x>=w&&P.x<=D&&P.y>=I&&P.y<=C&&Nh(_,E,d,M,y,k,P.x,P.y)&&qi(P.prev,P,P.next)>=0)return!1;P=P.next}return!0}function W0(c,n,o,u){const _=c.prev,d=c,y=c.next;if(qi(_,d,y)>=0)return!1;const E=_.x,M=d.x,k=y.x,w=_.y,I=d.y,D=y.y,C=E<M?E<k?E:k:M<k?M:k,P=w<I?w<D?w:D:I<D?I:D,B=E>M?E>k?E:k:M>k?M:k,q=w>I?w>D?w:D:I>D?I:D,H=X0(C,P,n,o,u),te=X0(B,q,n,o,u);let re=c.prevZ,J=c.nextZ;for(;re&&re.z>=H&&J&&J.z<=te;){if(re.x>=C&&re.x<=B&&re.y>=P&&re.y<=q&&re!==_&&re!==y&&Nh(E,w,M,I,k,D,re.x,re.y)&&qi(re.prev,re,re.next)>=0||(re=re.prevZ,J.x>=C&&J.x<=B&&J.y>=P&&J.y<=q&&J!==_&&J!==y&&Nh(E,w,M,I,k,D,J.x,J.y)&&qi(J.prev,J,J.next)>=0))return!1;J=J.nextZ}for(;re&&re.z>=H;){if(re.x>=C&&re.x<=B&&re.y>=P&&re.y<=q&&re!==_&&re!==y&&Nh(E,w,M,I,k,D,re.x,re.y)&&qi(re.prev,re,re.next)>=0)return!1;re=re.prevZ}for(;J&&J.z<=te;){if(J.x>=C&&J.x<=B&&J.y>=P&&J.y<=q&&J!==_&&J!==y&&Nh(E,w,M,I,k,D,J.x,J.y)&&qi(J.prev,J,J.next)>=0)return!1;J=J.nextZ}return!0}function $1(c,n){let o=c;do{const u=o.prev,_=o.next.next;!Y0(u,_)&&H1(u,o,o.next,_)&&jc(u,_)&&jc(_,u)&&(n.push(u.i,o.i,_.i),ed(o),ed(o.next),o=c=_),o=o.next}while(o!==c);return Bh(o)}function q1(c,n,o,u,_,d){let y=c;do{let E=y.next.next;for(;E!==y.prev;){if(y.i!==E.i&&Nw(y,E)){let M=J0(y,E);return y=Bh(y,y.next),M=Bh(M,M.next),xp(y,n,o,u,_,d,0),void xp(M,n,o,u,_,d,0)}E=E.next}y=y.next}while(y!==c)}function Bw(c,n){return c.x-n.x}function G1(c,n){const o=function(_,d){let y=d;const E=_.x,M=_.y;let k,w=-1/0;do{if(M<=y.y&&M>=y.next.y&&y.next.y!==y.y){const B=y.x+(M-y.y)*(y.next.x-y.x)/(y.next.y-y.y);if(B<=E&&B>w&&(w=B,k=y.x<y.next.x?y:y.next,B===E))return k}y=y.next}while(y!==d);if(!k)return null;const I=k,D=k.x,C=k.y;let P=1/0;y=k;do{if(E>=y.x&&y.x>=D&&E!==y.x&&Nh(M<C?E:w,M,D,C,M<C?w:E,M,y.x,y.y)){const B=Math.abs(M-y.y)/(E-y.x);jc(y,_)&&(B<P||B===P&&(y.x>k.x||y.x===k.x&&wp(k,y)))&&(k=y,P=B)}y=y.next}while(y!==I);return k}(c,n);if(!o)return n;const u=J0(o,c);return Bh(u,u.next),Bh(o,o.next)}function wp(c,n){return qi(c.prev,c,n.prev)<0&&qi(n.next,c,c.next)<0}function X0(c,n,o,u,_){return(c=1431655765&((c=858993459&((c=252645135&((c=16711935&((c=(c-o)*_|0)|c<<8))|c<<4))|c<<2))|c<<1))|(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=(n-u)*_|0)|n<<8))|n<<4))|n<<2))|n<<1))<<1}function Mi(c){let n=c,o=c;do(n.x<o.x||n.x===o.x&&n.y<o.y)&&(o=n),n=n.next;while(n!==c);return o}function Nh(c,n,o,u,_,d,y,E){return(_-y)*(n-E)>=(c-y)*(d-E)&&(c-y)*(u-E)>=(o-y)*(n-E)&&(o-y)*(d-E)>=(_-y)*(u-E)}function Nw(c,n){return c.next.i!==n.i&&c.prev.i!==n.i&&!function(o,u){let _=o;do{if(_.i!==o.i&&_.next.i!==o.i&&_.i!==u.i&&_.next.i!==u.i&&H1(_,_.next,o,u))return!0;_=_.next}while(_!==o);return!1}(c,n)&&(jc(c,n)&&jc(n,c)&&function(o,u){let _=o,d=!1;const y=(o.x+u.x)/2,E=(o.y+u.y)/2;do _.y>E!=_.next.y>E&&_.next.y!==_.y&&y<(_.next.x-_.x)*(E-_.y)/(_.next.y-_.y)+_.x&&(d=!d),_=_.next;while(_!==o);return d}(c,n)&&(qi(c.prev,c,n.prev)||qi(c,n.prev,n))||Y0(c,n)&&qi(c.prev,c,c.next)>0&&qi(n.prev,n,n.next)>0)}function qi(c,n,o){return(n.y-c.y)*(o.x-n.x)-(n.x-c.x)*(o.y-n.y)}function Y0(c,n){return c.x===n.x&&c.y===n.y}function H1(c,n,o,u){const _=Qf(qi(c,n,o)),d=Qf(qi(c,n,u)),y=Qf(qi(o,u,c)),E=Qf(qi(o,u,n));return _!==d&&y!==E||!(_!==0||!K0(c,o,n))||!(d!==0||!K0(c,u,n))||!(y!==0||!K0(o,c,u))||!(E!==0||!K0(o,n,u))}function K0(c,n,o){return n.x<=Math.max(c.x,o.x)&&n.x>=Math.min(c.x,o.x)&&n.y<=Math.max(c.y,o.y)&&n.y>=Math.min(c.y,o.y)}function Qf(c){return c>0?1:c<0?-1:0}function jc(c,n){return qi(c.prev,c,c.next)<0?qi(c,n,c.next)>=0&&qi(c,c.prev,n)>=0:qi(c,n,c.prev)<0||qi(c,c.next,n)<0}function J0(c,n){const o=Lu(c.i,c.x,c.y),u=Lu(n.i,n.x,n.y),_=c.next,d=n.prev;return c.next=n,n.prev=c,o.next=_,_.prev=o,u.next=o,o.prev=u,d.next=u,u.prev=d,u}function Rm(c,n,o,u){const _=Lu(c,n,o);return u?(_.next=u.next,_.prev=u,u.next.prev=_,u.next=_):(_.prev=_,_.next=_),_}function ed(c){c.next.prev=c.prev,c.prev.next=c.next,c.prevZ&&(c.prevZ.nextZ=c.nextZ),c.nextZ&&(c.nextZ.prevZ=c.prevZ)}function Lu(c,n,o){return{i:c,x:n,y:o,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function Us(c,n){const o=c.length;if(o<=1)return[c];const u=[];let _,d;for(let y=0;y<o;y++){const E=zd(c[y]);E!==0&&(c[y].area=Math.abs(E),d===void 0&&(d=E<0),d===E<0?(_&&u.push(_),_=[c[y]]):_.push(c[y]))}if(_&&u.push(_),n>1)for(let y=0;y<u.length;y++)u[y].length<=n||(yf(u[y],n,1,u[y].length-1,Dm),u[y]=u[y].slice(0,n));return u}function Dm(c,n){return n.area-c.area}function Z1(c,n,o=1){if(!c)return null;const u=typeof c=="string"?c:c.getPrimary().id;n[u]||(n[u]=[]);const _=Oa.from(u).getPrimary().scaleSelf(o);return n[u].push(_),_.serialize()}function Q0(c,n,o,u){const _=u.patternDependencies;let d=!1;for(const y of n){const E=y.paint.get(`${c}-pattern`);E.isConstant()||(d=!0),Z1(E.constantOr(null),_,o)&&(d=!0)}return d}function e_(c,n,o,u,_,d){const y=d.patternDependencies;for(const E of n){const M=E.paint.get(`${c}-pattern`).value;if(M.kind!=="constant"){let k=M.evaluate({zoom:u},o,{},d.availableImages);k=k&&k.name?k.name:k;const w=Z1(k,y,_);w&&(o.patterns[E.id]=w)}}return o}class t_{constructor(n){this.zoom=n.zoom,this.pixelRatio=n.pixelRatio,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(o=>o.fqid),this.index=n.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new el,this.indexArray=new ia,this.indexArray2=new Pc,this.programConfigurations=new Co(n.layers,{zoom:n.zoom,lut:n.lut}),this.segments=new ci,this.segments2=new ci,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id),this.projection=n.projection}updateFootprints(n,o){}populate(n,o,u,_){this.hasPattern=Q0("fill",this.layers,this.pixelRatio,o);const d=this.layers[0].layout.get("fill-sort-key"),y=[];for(const{feature:E,id:M,index:k,sourceLayerIndex:w}of n){const I=this.layers[0]._featureFilter.needGeometry,D=Z(E,I);if(!this.layers[0]._featureFilter.filter(new kr(this.zoom),D,u))continue;const C=d?d.evaluate(D,{},u,o.availableImages):void 0,P={id:M,properties:E.properties,type:E.type,sourceLayerIndex:w,index:k,geometry:I?D.geometry:$(E,u,_),patterns:{},sortKey:C};y.push(P)}d&&y.sort((E,M)=>E.sortKey-M.sortKey);for(const E of y){const{geometry:M,index:k,sourceLayerIndex:w}=E;if(this.hasPattern){const I=e_("fill",this.layers,E,this.zoom,this.pixelRatio,o);this.patternFeatures.push(I)}else this.addFeature(E,M,k,u,{},o.availableImages,o.brightness,o.elevationFeatures);o.featureIndex.insert(n[k].feature,M,k,w,this.index)}}update(n,o,u,_,d,y,E){this.programConfigurations.updatePaintArrays(n,o,d,u,_,y,E)}addFeatures(n,o,u,_,d,y){for(const E of this.patternFeatures)this.addFeature(E,E.geometry,E.index,o,u,_,y,n.elevationFeatures)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,kw),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.indexBuffer2=n.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(n,o,u,_,d,y=[],E,M){for(const k of Us(o,500)){let w=0;for(const q of k)w+=q.length;const I=this.segments.prepareSegment(w,this.layoutVertexArray,this.indexArray),D=I.vertexLength,C=[],P=[];for(const q of k){if(q.length===0)continue;q!==k[0]&&P.push(C.length/2);const H=this.segments2.prepareSegment(q.length,this.layoutVertexArray,this.indexArray2),te=H.vertexLength;this.layoutVertexArray.emplaceBack(q[0].x,q[0].y),this.indexArray2.emplaceBack(te+q.length-1,te),C.push(q[0].x),C.push(q[0].y);for(let re=1;re<q.length;re++)this.layoutVertexArray.emplaceBack(q[re].x,q[re].y),this.indexArray2.emplaceBack(te+re-1,te+re),C.push(q[re].x),C.push(q[re].y);H.vertexLength+=q.length,H.primitiveLength+=q.length}const B=Pm(C,P);for(let q=0;q<B.length;q+=3)this.indexArray.emplaceBack(D+B[q],D+B[q+1],D+B[q+2]);I.vertexLength+=w,I.primitiveLength+=B.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,u,d,y,_,E)}}let W1,n_,Qg,ey;hn(t_,"FillBucket",{omit:["layers","patternFeatures"]});class ty{constructor(n,o,u,_){if(this.triangleCount=o.length/3,this.min=new It(0,0),this.max=new It(0,0),this.xScale=0,this.yScale=0,this.cellsX=0,this.cellsY=0,this.cells=[],this.payload=[],this.triangleCount===0||n.length===0)return;const[d,y]=[n[0].clone(),n[0].clone()];for(let I=1;I<n.length;++I){const D=n[I];d.x=Math.min(d.x,D.x),d.y=Math.min(d.y,D.y),y.x=Math.max(y.x,D.x),y.y=Math.max(y.y,D.y)}if(_){const I=Math.ceil(Math.max(y.x-d.x,y.y-d.y)/_);u=Math.max(u,I)}if(u===0)return;this.min=d,this.max=y;const E=this.max.sub(this.min);E.x=Math.max(E.x,1),E.y=Math.max(E.y,1);const M=Math.max(E.x,E.y)/u;this.cellsX=Math.max(1,Math.ceil(E.x/M)),this.cellsY=Math.max(1,Math.ceil(E.y/M)),this.xScale=1/M,this.yScale=1/M;const k=[];for(let I=0;I<this.triangleCount;I++){const D=n[o[3*I+0]].sub(this.min),C=n[o[3*I+1]].sub(this.min),P=n[o[3*I+2]].sub(this.min),B=sl(Math.floor(Math.min(D.x,C.x,P.x)),this.xScale,this.cellsX),q=sl(Math.floor(Math.max(D.x,C.x,P.x)),this.xScale,this.cellsX),H=sl(Math.floor(Math.min(D.y,C.y,P.y)),this.yScale,this.cellsY),te=sl(Math.floor(Math.max(D.y,C.y,P.y)),this.yScale,this.cellsY),re=new It(0,0),J=new It(0,0),ie=new It(0,0),ce=new It(0,0);for(let me=H;me<=te;++me){re.y=J.y=me*M,ie.y=ce.y=(me+1)*M;for(let Ce=B;Ce<=q;++Ce)re.x=ie.x=Ce*M,J.x=ce.x=(Ce+1)*M,(ot(D,C,P,re,J,ce)||ot(D,C,P,re,ce,ie))&&k.push({cellIdx:me*this.cellsX+Ce,triIdx:I})}}if(k.length===0)return;k.sort((I,D)=>I.cellIdx-D.cellIdx||I.triIdx-D.triIdx);let w=0;for(;w<k.length;){const I=k[w].cellIdx,D={start:this.payload.length,len:0};for(;w<k.length&&k[w].cellIdx===I;)++D.len,this.payload.push(k[w++].triIdx);this.cells[I]=D}}_lazyInitLookup(){this.lookup||(this.lookup=new Uint8Array(Math.ceil(this.triangleCount/8))),this.lookup.fill(0)}queryPoint(n,o){if(this.triangleCount===0||this.cells.length===0||n.x>this.max.x||this.min.x>n.x||n.y>this.max.y||this.min.y>n.y)return;const u=sl(n.x-this.min.x,this.xScale,this.cellsX),_=sl(n.y-this.min.y,this.yScale,this.cellsY),d=this.cells[_*this.cellsX+u];if(d){this._lazyInitLookup();for(let y=0;y<d.len;y++){const E=this.payload[d.start+y],M=Math.floor(E/8),k=1<<E%8;if(!(this.lookup[M]&k)&&(this.lookup[M]|=k,o.push(E),o.length===this.triangleCount))return}}}query(n,o,u){if(this.triangleCount===0||this.cells.length===0||n.x>this.max.x||this.min.x>o.x||n.y>this.max.y||this.min.y>o.y)return;this._lazyInitLookup();const _=sl(n.x-this.min.x,this.xScale,this.cellsX),d=sl(o.x-this.min.x,this.xScale,this.cellsX),y=sl(n.y-this.min.y,this.yScale,this.cellsY),E=sl(o.y-this.min.y,this.yScale,this.cellsY);for(let M=y;M<=E;M++)for(let k=_;k<=d;k++){const w=this.cells[M*this.cellsX+k];if(w)for(let I=0;I<w.len;I++){const D=this.payload[w.start+I],C=Math.floor(D/8),P=1<<D%8;if(!(this.lookup[C]&P)&&(this.lookup[C]|=P,u.push(D),u.length===this.triangleCount))return}}}}function sl(c,n,o){return Math.max(0,Math.min(o-1,Math.floor(c*n)))}hn(ty,"TriangleGridIndex");class r_{constructor(n){this.zoom=n.zoom,this.layers=n.layers,this.layerIds=this.layers.map(o=>o.fqid),this.index=n.index,this.hasPattern=!1,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id),this.footprints=[]}updateFootprints(n,o){for(const u of this.footprints)o.push({footprint:u,id:n})}populate(n,o,u,_){const d=[];for(const{feature:y,id:E,index:M,sourceLayerIndex:k}of n){const w=this.layers[0]._featureFilter.needGeometry,I=Z(y,w);if(!this.layers[0]._featureFilter.filter(new kr(this.zoom),I,u))continue;const D={id:E,properties:y.properties,type:y.type,sourceLayerIndex:k,index:M,geometry:w?I.geometry:$(y,u,_),patterns:{}};d.push(D)}for(const y of d){const{geometry:E,index:M,sourceLayerIndex:k}=y;this.addFeature(y,E,M,u,{},o.availableImages,o.brightness),o.featureIndex.insert(n[M].feature,E,M,k,this.index)}}isEmpty(){return this.footprints.length===0}uploadPending(){return!1}upload(n){}update(n,o,u,_,d,y,E){}destroy(){}addFeature(n,o,u,_,d,y=[],E){for(const M of Us(o,2)){const k=[],w=[],I=[],D=new It(1/0,1/0),C=new It(-1/0,-1/0);for(const q of M)if(q.length!==0){q!==M[0]&&I.push(w.length/2);for(let H=0;H<q.length;H++)w.push(q[H].x),w.push(q[H].y),k.push(q[H]),D.x=Math.min(D.x,q[H].x),D.y=Math.min(D.y,q[H].y),C.x=Math.max(C.x,q[H].x),C.y=Math.max(C.y,q[H].y)}const P=Pm(w,I),B=new ty(k,P,8,256);this.footprints.push({vertices:k,indices:P,grid:B,min:D,max:C})}}}hn(r_,"ClipBucket",{omit:["layers"]});const Fw=br([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),jw=br([{name:"a_pos_end",components:4,type:"Int16"},{name:"a_angular_offset_factor",components:1,type:"Int16"}]),Lm=br([{name:"a_centroid_pos",components:2,type:"Uint16"}]),Uw=br([{name:"a_join_normal_inside",components:3,type:"Int16"}]),X1=br([{name:"a_hidden_by_landmark",components:1,type:"Uint8"}]),Hr=br([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:ny}=Fw;var Sp,i_,a_,o_,td,zm,nd,km={};function Y1(){if(i_)return Sp;i_=1;var c=Dr();function n(_,d,y,E,M){this.properties={},this.extent=y,this.type=0,this._pbf=_,this._geometry=-1,this._keys=E,this._values=M,_.readFields(o,this,d)}function o(_,d,y){_==1?d.id=y.readVarint():_==2?function(E,M){for(var k=E.readVarint()+E.pos;E.pos<k;){var w=M._keys[E.readVarint()],I=M._values[E.readVarint()];M.properties[w]=I}}(y,d):_==3?d.type=y.readVarint():_==4&&(d._geometry=y.pos)}function u(_){for(var d,y,E=0,M=0,k=_.length,w=k-1;M<k;w=M++)E+=((y=_[w]).x-(d=_[M]).x)*(d.y+y.y);return E}return Sp=n,n.types=["Unknown","Point","LineString","Polygon"],n.prototype.loadGeometry=function(){var _=this._pbf;_.pos=this._geometry;for(var d,y=_.readVarint()+_.pos,E=1,M=0,k=0,w=0,I=[];_.pos<y;){if(M<=0){var D=_.readVarint();E=7&D,M=D>>3}if(M--,E===1||E===2)k+=_.readSVarint(),w+=_.readSVarint(),E===1&&(d&&I.push(d),d=[]),d.push(new c(k,w));else{if(E!==7)throw new Error("unknown command "+E);d&&d.push(d[0].clone())}}return d&&I.push(d),I},n.prototype.bbox=function(){var _=this._pbf;_.pos=this._geometry;for(var d=_.readVarint()+_.pos,y=1,E=0,M=0,k=0,w=1/0,I=-1/0,D=1/0,C=-1/0;_.pos<d;){if(E<=0){var P=_.readVarint();y=7&P,E=P>>3}if(E--,y===1||y===2)(M+=_.readSVarint())<w&&(w=M),M>I&&(I=M),(k+=_.readSVarint())<D&&(D=k),k>C&&(C=k);else if(y!==7)throw new Error("unknown command "+y)}return[w,D,I,C]},n.prototype.toGeoJSON=function(_,d,y){var E,M,k=this.extent*Math.pow(2,y),w=this.extent*_,I=this.extent*d,D=this.loadGeometry(),C=n.types[this.type];function P(H){for(var te=0;te<H.length;te++){var re=H[te];H[te]=[360*(re.x+w)/k-180,360/Math.PI*Math.atan(Math.exp((180-360*(re.y+I)/k)*Math.PI/180))-90]}}switch(this.type){case 1:var B=[];for(E=0;E<D.length;E++)B[E]=D[E][0];P(D=B);break;case 2:for(E=0;E<D.length;E++)P(D[E]);break;case 3:for(D=function(H){var te=H.length;if(te<=1)return[H];for(var re,J,ie=[],ce=0;ce<te;ce++){var me=u(H[ce]);me!==0&&(J===void 0&&(J=me<0),J===me<0?(re&&ie.push(re),re=[H[ce]]):re.push(H[ce]))}return re&&ie.push(re),ie}(D),E=0;E<D.length;E++)for(M=0;M<D[E].length;M++)P(D[E][M])}D.length===1?D=D[0]:C="Multi"+C;var q={type:"Feature",geometry:{type:C,coordinates:D},properties:this.properties};return"id"in this&&(q.id=this.id),q},Sp}function K1(){if(o_)return a_;o_=1;var c=Y1();function n(u,_){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=u,this._keys=[],this._values=[],this._features=[],u.readFields(o,this,_),this.length=this._features.length}function o(u,_,d){u===15?_.version=d.readVarint():u===1?_.name=d.readString():u===5?_.extent=d.readVarint():u===2?_._features.push(d.pos):u===3?_._keys.push(d.readString()):u===4&&_._values.push(function(y){for(var E=null,M=y.readVarint()+y.pos;y.pos<M;){var k=y.readVarint()>>3;E=k===1?y.readString():k===2?y.readFloat():k===3?y.readDouble():k===4?y.readVarint64():k===5?y.readVarint():k===6?y.readSVarint():k===7?y.readBoolean():null}return E}(d))}return a_=n,n.prototype.feature=function(u){if(u<0||u>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[u];var _=this._pbf.readVarint()+this._pbf.pos;return new c(this._pbf,_,this.extent,this._keys,this._values)},a_}function ry(){return nd||(nd=1,km.VectorTile=function(){if(zm)return td;zm=1;var c=K1();function n(o,u,_){if(o===3){var d=new c(_,_.readVarint()+_.pos);d.length&&(u[d.name]=d)}}return td=function(o,u){this.layers=o.readFields(n,{},u)},td}(),km.VectorTileFeature=Y1(),km.VectorTileLayer=K1()),km}var rd=ry();class Uc extends It{constructor(n,o,u){super(n,o),this.z=u}}class mi extends Uc{constructor(n,o,u,_){super(n,o,u),this.w=_}}function Tp(c,n,o,u){const _=[],d=u===0?(y,E,M,k,w,I)=>{y.push(new It(I,M+(I-E)/(k-E)*(w-M)))}:(y,E,M,k,w,I)=>{y.push(new It(E+(I-M)/(w-M)*(k-E),I))};for(const y of c){const E=[];for(const M of y){if(M.length<=2)continue;const k=[];for(let D=0;D<M.length-1;D++){const C=M[D].x,P=M[D].y,B=M[D+1].x,q=M[D+1].y,H=u===0?C:P,te=u===0?B:q;H<n?te>n&&d(k,C,P,B,q,n):H>o?te<o&&d(k,C,P,B,q,o):k.push(M[D]),te<n&&H>=n&&d(k,C,P,B,q,n),te>o&&H<=o&&d(k,C,P,B,q,o)}let w=M[M.length-1];const I=u===0?w.x:w.y;I>=n&&I<=o&&k.push(w),k.length&&(w=k[k.length-1],k[0].x===w.x&&k[0].y===w.y||k.push(k[0]),E.push(k))}E.length&&_.push(E)}return _}function to(c,n,o,u){const _=o==="x"?"y":"x",d=(u-c[o])/(n[o]-c[o]);c[_]=c[_]+(n[_]-c[_])*d,c[o]=u,c.hasOwnProperty("z")&&(c.z=Mn(c.z,n.z,d)),c.hasOwnProperty("w")&&(c.w=Mn(c.w,n.w,d))}function J1(c,n,o,u){const _=o,d=u;for(const y of["x","y"]){let E=c,M=n;E[y]>=M[y]&&(E=n,M=c),E[y]<_&&M[y]>_&&to(E,M,y,_),E[y]<d&&M[y]>d&&to(M,E,y,d)}}const Ep=Number.MAX_SAFE_INTEGER;function s_(c,n,o,u){return c.order<n||c.order===Ep||!(c.clipMask&o)||function(_,d){return d.length!==0&&d.find(y=>y===_)===void 0}(u,c.clipScope)}function id(c,n){return c.x-n.x||c.y-n.y}function iy(c,n){return id(c.min,n.min)===0&&id(c.max,n.max)===0}function l_(c,n){return!(c.min.x>n.max.x||c.max.x<n.min.x||c.min.y>n.max.y||c.max.y<n.min.y)}function Bm(c,n){if(c.length!==n.length)return!1;for(let o=0;o<c.length;o++)if(c[o].sourceId!==n[o].sourceId||!iy(c[o],n[o])||c[o].order!==n[o].order||c[o].clipMask!==n[o].clipMask||!Ir(c[o].clipScope,n[o].clipScope))return!1;return!0}function c_(c,n,o){const u=1/Kt,_=1/(1<<o.canonical.z),d=(n.x*u+o.canonical.x)*_+o.wrap,y=(n.y*u+o.canonical.y)*_;return{min:new It((c.x*u+o.canonical.x)*_+o.wrap,(c.y*u+o.canonical.y)*_),max:new It(d,y)}}function Vw(c,n,o){const u=1<<o.canonical.z,_=((n.x-o.wrap)*u-o.canonical.x)*Kt,d=(n.y*u-o.canonical.y)*Kt;return{min:new It(((c.x-o.wrap)*u-o.canonical.x)*Kt,(c.y*u-o.canonical.y)*Kt),max:new It(_,d)}}function ay(c,n,o,u,_,d,y){const E=c.indices,M=c.vertices,k=[];for(let w=u;w<u+_;w+=3){const I=n[o[w+0]+d],D=n[o[w+1]+d],C=n[o[w+2]+d],P=Math.min(I.x,D.x,C.x),B=Math.max(I.x,D.x,C.x),q=Math.min(I.y,D.y,C.y),H=Math.max(I.y,D.y,C.y);k.length=0,c.grid.query(new It(P,q),new It(B,H),k);for(let te=0;te<k.length;te++){const re=k[te];if(ot(M[E[3*re+0]],M[E[3*re+1]],M[E[3*re+2]],I,D,C,y))return!0}}return!1}function Q1(c,n,o,u){if(!c||!o)return!1;let _=c.vertices;if(!n.canonical.equals(u.canonical)||n.wrap!==u.wrap){if(o.vertices.length<c.vertices.length)return Q1(o,u,c,n);const d=n.canonical,y=u.canonical,E=Math.pow(2,y.z-d.z);_=c.vertices.map(M=>new It((M.x+d.x*Kt)*E-y.x*Kt,(M.y+d.y*Kt)*E-y.y*Kt))}return ay(o,_,c.indices,0,c.indices.length,0,0)}function oy(c,n,o,u){const _=Math.pow(2,u.z-o.z);return new It((c+o.x*Kt)*_-u.x*Kt,(n+o.y*Kt)*_-u.y*Kt)}function e2(c,n){const o=[];n.grid.queryPoint(c,o);const u=n.indices,_=n.vertices;for(let d=0;d<o.length;d++){const y=o[d];if(De([_[u[3*y+0]],_[u[3*y+1]],_[u[3*y+2]]],c))return!0}return!1}const sy=[new It(0,0),new It(Kt,0),new It(Kt,Kt),new It(0,Kt)];function u_(c,n){const o=[];let u=[];if(!n||c.length<2)return[c];if(c.length===2)return Xe(c[0],c[1],sy)?[c]:[];for(let _=0;_<c.length+2;_++){const d=c[_%c.length],y=c[(_+1)%c.length],E=Xe(_===0?c[c.length-1]:c[(_-1)%c.length],d,sy),M=Xe(d,y,sy),k=E||M;k&&u.push(d),k&&M||u.length>0&&(u.length>1&&o.push(u),u=[])}return u.length>1&&o.push(u),o}const Nm=rd.VectorTileFeature.types,$w=["fill-extrusion-base","fill-extrusion-height","fill-extrusion-color","fill-extrusion-pattern","fill-extrusion-flood-light-wall-radius","fill-extrusion-line-width","fill-extrusion-emissive-strength"],qw=["fill-extrusion-flood-light-ground-radius"],Vl=Math.pow(2,13),t2=Math.pow(2,15)-1,ly=new It(0,1),Za=2147483648;function Ap(c,n,o,u,_,d,y,E){c.emplaceBack((n<<1)+y,(o<<1)+d,(Math.floor(u*Vl)<<1)+_,Math.round(E))}function Fh(c,n,o){c.emplaceBack(n.x*Kt,n.y*Kt,o?1:0)}function ll(c,n,o,u,_,d){c.emplaceBack(n.x,n.y,(o.x<<1)+u,(o.y<<1)+_,d)}function Fm(c,n,o){c.emplaceBack(n.x,n.y,n.z,o[0]*16384,o[1]*16384,o[2]*16384)}class n2{constructor(){this.vertexOffset=0,this.vertexCount=0,this.indexOffset=0,this.indexCount=0}}class ad{constructor(){this.centroidXY=new It(0,0),this.vertexArrayOffset=0,this.vertexCount=0,this.groundVertexArrayOffset=0,this.groundVertexCount=0,this.flags=0,this.footprintSegIdx=-1,this.footprintSegLen=0,this.polygonSegIdx=-1,this.polygonSegLen=0,this.min=new It(Number.MAX_VALUE,Number.MAX_VALUE),this.max=new It(-Number.MAX_VALUE,-Number.MAX_VALUE),this.height=0}span(){return new It(this.max.x-this.min.x,this.max.y-this.min.y)}}class cy{constructor(){this.acc=new It(0,0),this.accCount=0,this.centroidDataIndex=0}startRing(n,o){n.min.x===Number.MAX_VALUE&&(n.min.x=n.max.x=o.x,n.min.y=n.max.y=o.y)}appendEdge(n,o,u){this.accCount++,this.acc._add(o);let _=!!this.borders;o.x<n.min.x?(n.min.x=o.x,_=!0):o.x>n.max.x&&(n.max.x=o.x,_=!0),o.y<n.min.y?(n.min.y=o.y,_=!0):o.y>n.max.y&&(n.max.y=o.y,_=!0),((o.x===0||o.x===Kt)&&o.x===u.x)!=((o.y===0||o.y===Kt)&&o.y===u.y)&&this.processBorderOverlap(o,u),_&&this.checkBorderIntersection(o,u)}checkBorderIntersection(n,o){o.x<0!=n.x<0&&this.addBorderIntersection(0,Mn(o.y,n.y,(0-o.x)/(n.x-o.x))),o.x>Kt!=n.x>Kt&&this.addBorderIntersection(1,Mn(o.y,n.y,(Kt-o.x)/(n.x-o.x))),o.y<0!=n.y<0&&this.addBorderIntersection(2,Mn(o.x,n.x,(0-o.y)/(n.y-o.y))),o.y>Kt!=n.y>Kt&&this.addBorderIntersection(3,Mn(o.x,n.x,(Kt-o.y)/(n.y-o.y)))}addBorderIntersection(n,o){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const u=this.borders[n];o<u[0]&&(u[0]=o),o>u[1]&&(u[1]=o)}processBorderOverlap(n,o){if(n.x===o.x){if(n.y===o.y)return;const u=n.x===0?0:1;this.addBorderIntersection(u,o.y),this.addBorderIntersection(u,n.y)}else{const u=n.y===0?2:3;this.addBorderIntersection(u,o.x),this.addBorderIntersection(u,n.x)}}centroid(){return this.accCount===0?new It(0,0):new It(Math.floor(Math.max(0,this.acc.x)/this.accCount),Math.floor(Math.max(0,this.acc.y)/this.accCount))}intersectsCount(){return this.borders?this.borders.reduce((n,o)=>n+ +(o[0]!==Number.MAX_VALUE),0):0}}function r2(c,n){const o=c.add(n)._unit(),u=Bn(c.x*o.x+c.y*o.y,-1,1);var _,d,y;return y=Math.acos(u),Math.min(4,Math.max(-4,Math.tan(y)))/4*t2*((_=c).x*(d=n).y-_.y*d.x<0?-1:1)}const Gw=[c=>c.x<0,c=>c.x>Kt,c=>c.y<0,c=>c.y>Kt];function Hw(c,n,o,u){const _=[4];if(u===0)return _;o._mult(u);const d=c.sub(o),y=n.sub(o),E=[c,n,d,y];for(let M=0;M<4;M++)for(const k of E)if(Gw[M](k)){_.push(M);break}return _}class i2{constructor(n){this.vertexArray=new Ff,this.indexArray=new ia,this.programConfigurations=new Co(n.layers,{zoom:n.zoom,lut:n.lut},o=>qw.includes(o)),this._segments=new ci,this.hiddenByLandmarkVertexArray=new $f,this._segmentToGroundQuads={},this._segmentToGroundQuads[0]=[],this._segmentToRegionTriCounts={},this._segmentToRegionTriCounts[0]=[0,0,0,0,0],this.regionSegments={},this.regionSegments[4]=new ci}getDefaultSegment(){return this.regionSegments[4]}hasData(){return this.vertexArray.length!==0}addData(n,o,u,_=!1){const d=n.length;if(d>2){let y=Math.max(0,this._segments.get().length-1);const E=this._segments._prepareSegment(4*d,this.vertexArray.length,2*this._segmentToGroundQuads[y].length);let M;y!==this._segments.get().length-1&&(y++,this._segmentToGroundQuads[y]=[],this._segmentToRegionTriCounts[y]=[0,0,0,0,0]);{const k=n[0],w=n[1];M=r2(k.sub(n[d-1])._perp()._unit(),w.sub(k)._perp()._unit())}for(let k=0;k<d;k++){const w=k===d-1?0:k+1,I=n[k],D=n[w],C=n[w===d-1?0:w+1],P=D.sub(I)._perp()._unit(),B=r2(P,C.sub(D)._perp()._unit()),q=M,H=B;if(jh(I,D,o)||_&&Cp(I,o)&&Cp(D,o)){M=B;continue}const te=E.vertexLength;ll(this.vertexArray,I,D,1,1,q),ll(this.vertexArray,I,D,1,0,q),ll(this.vertexArray,I,D,0,1,H),ll(this.vertexArray,I,D,0,0,H),E.vertexLength+=4;const re=Hw(I,D,P,u);for(const J of re)this._segmentToGroundQuads[y].push({id:te,region:J}),this._segmentToRegionTriCounts[y][J]+=2,E.primitiveLength+=2;M=B}}}prepareBorderSegments(){if(!this.hasData())return;const n=this._segments.get(),o=n.length;for(let u=0;u<o;u++)this._segmentToGroundQuads[u].sort((_,d)=>_.region-d.region);for(let u=0;u<o;u++){const _=this._segmentToGroundQuads[u],d=n[u],y=this._segmentToRegionTriCounts[u];y.reduce((M,k)=>M+k,0);let E=0;for(let M=0;M<=4;M++){const k=y[M];if(k!==0){let w=this.regionSegments[M];w||(w=this.regionSegments[M]=new ci);const I={vertexOffset:d.vertexOffset,primitiveOffset:d.primitiveOffset+E,vertexLength:d.vertexLength,primitiveLength:k};w.get().push(I)}E+=k}for(let M=0;M<_.length;M++){const k=_[M].id;this.indexArray.emplaceBack(k,k+1,k+3),this.indexArray.emplaceBack(k,k+3,k+2)}}this._segmentToGroundQuads=null,this._segmentToRegionTriCounts=null,this._segments.destroy(),this._segments=null}addPaintPropertiesData(n,o,u,_,d,y){this.hasData()&&this.programConfigurations.populatePaintArrays(this.vertexArray.length,n,o,u,_,d,y)}upload(n){this.hasData()&&(this.vertexBuffer=n.createVertexBuffer(this.vertexArray,jw.members),this.indexBuffer=n.createIndexBuffer(this.indexArray))}uploadPaintProperties(n){this.hasData()&&this.programConfigurations.upload(n)}update(n,o,u,_,d,y,E){this.hasData()&&this.programConfigurations.updatePaintArrays(n,o,u,_,d,y,E)}updateHiddenByLandmark(n){if(!this.hasData())return;const o=n.groundVertexCount+n.groundVertexArrayOffset;if(n.groundVertexCount===0)return;const u=n.flags&Za?1:0;for(let _=n.groundVertexArrayOffset;_<o;++_)this.hiddenByLandmarkVertexArray.emplace(_,u);this._needsHiddenByLandmarkUpdate=!0}uploadHiddenByLandmark(n){this.hasData()&&this._needsHiddenByLandmarkUpdate&&(!this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexArray.length>0?this.hiddenByLandmarkVertexBuffer=n.createVertexBuffer(this.hiddenByLandmarkVertexArray,X1.members,!0):this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.updateData(this.hiddenByLandmarkVertexArray),this._needsHiddenByLandmarkUpdate=!1)}destroy(){if(this.vertexBuffer){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.destroy(),this._segments&&this._segments.destroy(),this.programConfigurations.destroy();for(let n=0;n<=4;n++){const o=this.regionSegments[n];o&&o.destroy()}}}}class h_{constructor(n){this.zoom=n.zoom,this.canonical=n.canonical,this.overscaling=n.overscaling,this.layers=n.layers,this.pixelRatio=n.pixelRatio,this.layerIds=this.layers.map(o=>o.fqid),this.index=n.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=n.projection,this.activeReplacements=[],this.replacementUpdateTime=0,this.centroidData=[],this.footprintIndices=new ia,this.footprintVertices=new el,this.footprintSegments=[],this.layoutVertexArray=new Ls,this.centroidVertexArray=new ho,this.wallVertexArray=new Mm,this.indexArray=new ia,this.programConfigurations=new Co(n.layers,{zoom:n.zoom,lut:n.lut},o=>$w.includes(o)),this.segments=new ci,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id),this.groundEffect=new i2(n),this.maxHeight=0,this.partLookup={},this.triangleSubSegments=[],this.polygonSegments=[]}updateFootprints(n,o){}populate(n,o,u,_){this.features=[],this.hasPattern=Q0("fill-extrusion",this.layers,this.pixelRatio,o),this.featuresOnBorder=[],this.borderFeatureIndices=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.selfDEMTileTimestamp=Number.MAX_VALUE,this.borderDEMTileTimestamp=[Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE],this.tileToMeter=r(u),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter,this.wallMode=this.layers[0].paint.get("fill-extrusion-line-width").constantOr(1)!==0;for(const{feature:d,id:y,index:E,sourceLayerIndex:M}of n){const k=this.layers[0]._featureFilter.needGeometry,w=Z(d,k);if(!this.layers[0]._featureFilter.filter(new kr(this.zoom),w,u))continue;const I={id:y,sourceLayerIndex:M,index:E,geometry:k?w.geometry:$(d,u,_),properties:d.properties,type:d.type,patterns:{}},D=this.layoutVertexArray.length,C=Nm[I.type]==="Polygon";if(this.hasPattern)this.features.push(e_("fill-extrusion",this.layers,I,this.zoom,this.pixelRatio,o));else if(this.wallMode)for(const P of I.geometry)for(const B of u_(P,C))this.addFeature(I,[B],E,u,{},o.availableImages,_,o.brightness);else this.addFeature(I,I.geometry,E,u,{},o.availableImages,_,o.brightness);o.featureIndex.insert(d,I.geometry,E,M,this.index,D)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles(),this.groundEffect.prepareBorderSegments(),this.polygonSegments.length=0}addFeatures(n,o,u,_,d,y){for(const E of this.features){const M=Nm[E.type]==="Polygon",{geometry:k}=E;if(this.wallMode)for(const w of k)for(const I of u_(w,M))this.addFeature(E,[I],E.index,o,u,_,d,y);else this.addFeature(E,k,E.index,o,u,_,d,y)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles()}update(n,o,u,_,d,y,E){this.programConfigurations.updatePaintArrays(n,o,d,u,_,y,E),this.groundEffect.update(n,o,d,u,_,y,E)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload||this.groundEffect.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,ny),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.wallVertexBuffer=n.createVertexBuffer(this.wallVertexArray,Uw.members),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=n.createVertexBuffer(this.layoutVertexExtArray,Hr.members,!0)),this.groundEffect.upload(n)),this.groundEffect.uploadPaintProperties(n),this.programConfigurations.upload(n),this.uploaded=!0}uploadCentroid(n){this.groundEffect.uploadHiddenByLandmark(n),this.needsCentroidUpdate&&(!this.centroidVertexBuffer&&this.centroidVertexArray.length>0?this.centroidVertexBuffer=n.createVertexBuffer(this.centroidVertexArray,Lm.members,!0):this.centroidVertexBuffer&&this.centroidVertexBuffer.updateData(this.centroidVertexArray),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.groundEffect.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(n,o,u,_,d,y,E,M){const k=this.layers[0].paint.get("fill-extrusion-flood-light-ground-radius").evaluate(n,{})/this.tileToMeter,w=[new It(0,0),new It(Kt,Kt)],I=E.projection,D=I.name==="globe",C=this.wallMode||Nm[n.type]==="Polygon",P=new cy;P.centroidDataIndex=this.centroidData.length;const B=new ad,q=this.layers[0].paint.get("fill-extrusion-base").evaluate(n,{},_)<=0,H=this.layers[0].paint.get("fill-extrusion-height").evaluate(n,{},_);let te;if(B.height=H,B.vertexArrayOffset=this.layoutVertexArray.length,B.groundVertexArrayOffset=this.groundEffect.vertexArray.length,D&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new Ch),this.wallMode){if(D)return void qn("Non zero fill-extrusion-line-width is not yet supported on globe.");if(o.length!==1)return;te=function(Ee){const Ue=Ee[0].x===Ee[Ee.length-1].x&&Ee[0].y===Ee[Ee.length-1].y;(function(Ut){let zt=0;const vn=Ut.length;for(let ln=0;ln<vn;ln++)zt+=(Ut[(ln+1)%vn].x-Ut[ln].x)*(Ut[(ln+1)%vn].y+Ut[ln].y);return zt>=0})(Ee)||(Ee=Ee.reverse());const Ve={geometry:[],joinNormals:[],indices:[]},Ze=[],qe=[],Ke=[];let Qe=Ee.length;for(;Qe>=2&&Ee[Qe-1].equals(Ee[Qe-2]);)Qe--;if(Qe<(Ue?3:2))return Ve;let at,Je,wt,Rt,bt,an=0;for(;an<Qe-1&&Ee[an].equals(Ee[an+1]);)an++;Ue&&(at=Ee[Qe-2],bt=Ee[an].sub(at)._unit()._perp());for(let Ut=an;Ut<Qe;Ut++){if(wt=Ut===Qe-1?Ue?Ee[an+1]:void 0:Ee[Ut+1],wt&&Ee[Ut].equals(wt))continue;bt&&(Rt=bt),at&&(Je=at),at=Ee[Ut],bt=wt?wt.sub(at)._unit()._perp():Rt,Rt=Rt||bt;let zt=Rt.add(bt);zt.x===0&&zt.y===0||zt._unit();const vn=zt.x*bt.x+zt.y*bt.y,ln=vn!==0?1/vn:1/0,pn=Rt.x*bt.y-Rt.y*bt.x>0;let kn="miter";const Gn=2;kn==="miter"&&ln>Gn&&(kn="bevel"),kn==="bevel"&&(ln>100&&(kn="flipbevel"),ln<Gn&&(kn="miter"));const Zn=(Wn,lr,ur,Zr)=>{const Lr=new It(Wn.x,Wn.y),jn=new It(Wn.x,Wn.y);Lr.x+=lr.x*Zr,Lr.y+=lr.y*Zr,jn.x-=lr.x*Math.max(ur,1),jn.y-=lr.y*Math.max(ur,1),Ke.push(lr),Ze.push(Lr),qe.push(jn)};if(kn==="miter")zt._mult(ln),Zn(at,zt,0,0);else if(kn==="flipbevel")zt=bt.mult(-1),Zn(at,zt,0,0),Zn(at,zt.mult(-1),0,0);else{const Wn=-Math.sqrt(ln*ln-1),lr=pn?Wn:0,ur=pn?0:Wn;Je&&Zn(at,Rt,lr,ur),wt&&Zn(at,bt,lr,ur)}}Ve.geometry=[...Ze,...qe.reverse(),Ze[0]],Ve.joinNormals=[...Ke,...Ke.reverse(),Ke[Ke.length-1]];const Jt=Ve.geometry.length-1;for(let Ut=0;Ut<Jt/2;Ut++)if(Ut+1<Jt/2){let zt=Ut,vn=Ut+1,ln=Jt-1-Ut,pn=Jt-2-Ut;zt=zt===0?Jt-1:zt-1,vn=vn===0?Jt-1:vn-1,ln=ln===0?Jt-1:ln-1,pn=pn===0?Jt-1:pn-1,Ve.indices.push(ln),Ve.indices.push(vn),Ve.indices.push(zt),Ve.indices.push(ln),Ve.indices.push(pn),Ve.indices.push(vn)}return Ve}(o[0]),o=[te.geometry]}const re=(Ee,Ue)=>Ee<(Ue.length-1)/2||Ee===Ue.length-1,J=this.wallMode?[o]:Us(o,500);for(let Ee=J.length-1;Ee>=0;Ee--){const Ue=J[Ee];(Ue.length===0||(ie=Ue[0]).every(Ie=>Ie.x<=0)||ie.every(Ie=>Ie.x>=Kt)||ie.every(Ie=>Ie.y<=0)||ie.every(Ie=>Ie.y>=Kt))&&J.splice(Ee,1)}var ie;let ce;if(D)ce=Mp(J,w,_);else{ce=[];for(const Ee of J)ce.push({polygon:Ee,bounds:w})}const me=C?this.edgeRadius:0,Ce=me>0&&this.zoom<17,Ae=(Ee,Ue)=>{if(Ee.length===0)return!1;const Ie=Ee[Ee.length-1];return Ue.x===Ie.x&&Ue.y===Ie.y};for(const{polygon:Ee,bounds:Ue}of ce){let Ie=0,Ve=0;for(const Qe of Ee)C&&!Qe[0].equals(Qe[Qe.length-1])&&Qe.push(Qe[0]),Ve+=C?Qe.length-1:Qe.length;const Ze=this.segments.prepareSegment((C?5:4)*Ve,this.layoutVertexArray,this.indexArray);B.footprintSegIdx<0&&(B.footprintSegIdx=this.footprintSegments.length),B.polygonSegIdx<0&&(B.polygonSegIdx=this.polygonSegments.length);const qe={triangleArrayOffset:this.indexArray.length,triangleCount:0,triangleSegIdx:this.segments.segments.length-1},Ke=new n2;if(Ke.vertexOffset=this.footprintVertices.length,Ke.indexOffset=3*this.footprintIndices.length,Ke.ringIndices=[],C){const Qe=[],at=[];Ie=Ze.vertexLength;for(let wt=0;wt<Ee.length;wt++){const Rt=Ee[wt];Rt.length&&wt!==0&&at.push(Qe.length/2);const bt=[];let an,Jt;an=Rt[1].sub(Rt[0])._perp()._unit(),Ke.ringIndices.push(Rt.length-1);for(let Ut=1;Ut<Rt.length;Ut++){const zt=Rt[Ut],vn=Rt[Ut===Rt.length-1?1:Ut+1],ln=zt.clone();if(me){Jt=vn.sub(zt)._perp()._unit();const pn=an.add(Jt)._unit(),kn=me*Math.min(4,1/(an.x*pn.x+an.y*pn.y));ln.x+=kn*pn.x,ln.y+=kn*pn.y,ln.x=Math.round(ln.x),ln.y=Math.round(ln.y),an=Jt}if(!q||me!==0&&!Ce||Ae(bt,ln)||bt.push(ln),Ap(this.layoutVertexArray,ln.x,ln.y,0,0,1,1,0),this.wallMode){const pn=re(Ut,Rt);Fh(this.wallVertexArray,te.joinNormals[Ut],!pn)}Ze.vertexLength++,this.footprintVertices.emplaceBack(zt.x,zt.y),Qe.push(zt.x,zt.y),D&&Fm(this.layoutVertexExtArray,I.projectTilePoint(ln.x,ln.y,_),I.upVector(_,ln.x,ln.y))}q&&(me===0||Ce)&&(bt.length!==0&&Ae(bt,bt[0])&&bt.pop(),this.groundEffect.addData(bt,Ue,k))}const Je=this.wallMode?te.indices:Pm(Qe,at);for(let wt=0;wt<Je.length;wt+=3)this.footprintIndices.emplaceBack(Ke.vertexOffset+Je[wt+0],Ke.vertexOffset+Je[wt+1],Ke.vertexOffset+Je[wt+2]),this.indexArray.emplaceBack(Ie+Je[wt],Ie+Je[wt+2],Ie+Je[wt+1]),Ze.primitiveLength++;Ke.indexCount+=Je.length,Ke.vertexCount+=this.footprintVertices.length-Ke.vertexOffset}for(let Qe=0;Qe<Ee.length;Qe++){const at=Ee[Qe];P.startRing(B,at[0]);let Je=at.length>4&&hy(at[at.length-2],at[0],at[1]),wt=me?Zw(at[at.length-2],at[0],at[1],me):0;const Rt=[];let bt,an,Jt;an=at[1].sub(at[0])._perp()._unit();let Ut=!0;for(let zt=1,vn=0;zt<at.length;zt++){let ln=at[zt-1],pn=at[zt];const kn=at[zt===at.length-1?1:zt+1];if(P.appendEdge(B,pn,ln),jh(pn,ln,Ue)){me&&(an=kn.sub(pn)._perp()._unit(),Ut=!Ut);continue}const Gn=pn.sub(ln)._perp(),Zn=Gn.x/(Math.abs(Gn.x)+Math.abs(Gn.y)),Wn=Gn.y>0?1:0,lr=ln.dist(pn);if(vn+lr>32768&&(vn=0),me){Jt=kn.sub(pn)._perp()._unit();let jn=uy(ln,pn,kn,a2(an,Jt),me);isNaN(jn)&&(jn=0);const Pr=pn.sub(ln)._unit();ln=ln.add(Pr.mult(wt))._round(),pn=pn.add(Pr.mult(-jn))._round(),wt=jn,an=Jt,q&&this.zoom>=17&&(Ae(Rt,ln)||Rt.push(ln),Ae(Rt,pn)||Rt.push(pn))}const ur=Ze.vertexLength,Zr=at.length>4&&hy(ln,pn,kn);let Lr=o2(vn,Je,Ut);if(Ap(this.layoutVertexArray,ln.x,ln.y,Zn,Wn,0,0,Lr),Ap(this.layoutVertexArray,ln.x,ln.y,Zn,Wn,0,1,Lr),this.wallMode){const jn=re(zt-1,at),Pr=te.joinNormals[zt-1];Fh(this.wallVertexArray,Pr,jn),Fh(this.wallVertexArray,Pr,jn)}if(vn+=lr,Lr=o2(vn,Zr,!Ut),Je=Zr,Ap(this.layoutVertexArray,pn.x,pn.y,Zn,Wn,0,0,Lr),Ap(this.layoutVertexArray,pn.x,pn.y,Zn,Wn,0,1,Lr),this.wallMode){const jn=re(zt,at),Pr=te.joinNormals[zt];Fh(this.wallVertexArray,Pr,jn),Fh(this.wallVertexArray,Pr,jn)}if(Ze.vertexLength+=4,this.indexArray.emplaceBack(ur+0,ur+1,ur+2),this.indexArray.emplaceBack(ur+1,ur+3,ur+2),Ze.primitiveLength+=2,me){const jn=Ie+(zt===1?at.length-2:zt-2),Pr=zt===1?Ie:jn+1;if(this.indexArray.emplaceBack(ur+1,jn,ur+3),this.indexArray.emplaceBack(jn,Pr,ur+3),Ze.primitiveLength+=2,bt===void 0&&(bt=ur),!jh(kn,at[zt],Ue)){const Rr=zt===at.length-1?bt:Ze.vertexLength;this.indexArray.emplaceBack(ur+2,ur+3,Rr),this.indexArray.emplaceBack(ur+3,Rr+1,Rr),this.indexArray.emplaceBack(ur+3,Pr,Rr+1),Ze.primitiveLength+=3}Ut=!Ut}if(D){const jn=this.layoutVertexExtArray,Pr=I.projectTilePoint(ln.x,ln.y,_),Rr=I.projectTilePoint(pn.x,pn.y,_),ri=I.upVector(_,ln.x,ln.y),Bi=I.upVector(_,pn.x,pn.y);Fm(jn,Pr,ri),Fm(jn,Pr,ri),Fm(jn,Rr,Bi),Fm(jn,Rr,Bi)}}C&&(Ie+=at.length-1),q&&me&&this.zoom>=17&&(Rt.length!==0&&Ae(Rt,Rt[0])&&Rt.pop(),this.groundEffect.addData(Rt,Ue,k,me>0))}this.footprintSegments.push(Ke),qe.triangleCount=this.indexArray.length-qe.triangleArrayOffset,this.polygonSegments.push(qe),++B.footprintSegLen,++B.polygonSegLen}if(B.vertexCount=this.layoutVertexArray.length-B.vertexArrayOffset,B.groundVertexCount=this.groundEffect.vertexArray.length-B.groundVertexArrayOffset,B.vertexCount!==0){if(B.centroidXY=P.borders?ly:this.encodeCentroid(P,B),this.centroidData.push(B),P.borders){this.featuresOnBorder.push(P);const Ee=this.featuresOnBorder.length-1;for(let Ue=0;Ue<P.borders.length;Ue++)P.borders[Ue][0]!==Number.MAX_VALUE&&this.borderFeatureIndices[Ue].push(Ee)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,u,d,y,_,M),this.groundEffect.addPaintPropertiesData(n,u,d,y,_,M),this.maxHeight=Math.max(this.maxHeight,H)}}sortBorders(){for(let n=0;n<this.borderFeatureIndices.length;n++)this.borderFeatureIndices[n].sort((o,u)=>this.featuresOnBorder[o].borders[n][0]-this.featuresOnBorder[u].borders[n][0])}splitToSubtiles(){const n=[];for(let E=0;E<this.centroidData.length;E++){const M=this.centroidData[E],k=+(M.min.y+M.max.y>Kt),w=2*k+(+(M.min.x+M.max.x>Kt)^k);for(let I=0;I<M.polygonSegLen;I++){const D=M.polygonSegIdx+I;n.push({centroidIdx:E,subtile:w,polygonSegmentIdx:D,triangleSegmentIdx:this.polygonSegments[D].triangleSegIdx})}}const o=new ia;n.sort((E,M)=>E.triangleSegmentIdx===M.triangleSegmentIdx?E.subtile-M.subtile:E.triangleSegmentIdx-M.triangleSegmentIdx);let u=0,_=0,d=0;for(const E of n){if(E.triangleSegmentIdx!==u)break;d++}const y=n.length;for(;_!==n.length;){u=n[_].triangleSegmentIdx;let E=0,M=_,k=_;for(let w=M;w<d&&n[w].subtile===E;w++)k++;for(;M!==d;){const w=n[M];E=w.subtile;const I=this.centroidData[w.centroidIdx].min.clone(),D=this.centroidData[w.centroidIdx].max.clone(),C={vertexOffset:this.segments.segments[u].vertexOffset,primitiveOffset:o.length,vertexLength:this.segments.segments[u].vertexLength,primitiveLength:0,sortKey:void 0,vaos:{}};for(let P=M;P<k;P++){const B=n[P],q=this.polygonSegments[B.polygonSegmentIdx],H=this.centroidData[B.centroidIdx].min,te=this.centroidData[B.centroidIdx].max,re=this.indexArray.uint16;for(let J=q.triangleArrayOffset;J<q.triangleArrayOffset+q.triangleCount;J++)o.emplaceBack(re[3*J],re[3*J+1],re[3*J+2]);C.primitiveLength+=q.triangleCount,I.x=Math.min(I.x,H.x),I.y=Math.min(I.y,H.y),D.x=Math.max(D.x,te.x),D.y=Math.max(D.y,te.y)}C.primitiveLength>0&&this.triangleSubSegments.push({segment:C,min:I,max:D}),M=k;for(let P=M;P<d&&n[P].subtile===n[M].subtile;P++)k++}_=d;for(let w=_;w<y&&n[w].triangleSegmentIdx===n[_].triangleSegmentIdx;w++)d++}o._trim(),this.indexArray=o}getVisibleSegments(n,o,u){const _=new ci;if(this.wallMode){for(const B of this.triangleSubSegments)_.segments.push(B.segment);return _}let d=0,y=0;const E=1<<n.canonical.z;if(o){const B=o.getMinMaxForTile(n);B&&(d=B.min,y=B.max)}y+=this.maxHeight;const M=n.toUnwrapped();let k;const w=[M.canonical.x/E+M.wrap,M.canonical.y/E],I=[(M.canonical.x+1)/E+M.wrap,(M.canonical.y+1)/E],D=(B,q,H)=>[B[0]*(1-H[0])+q[0]*H[0],B[1]*(1-H[1])+q[1]*H[1]],C=[],P=[];for(const B of this.triangleSubSegments){C[0]=B.min.x/Kt,C[1]=B.min.y/Kt,P[0]=B.max.x/Kt,P[1]=B.max.y/Kt;const q=D(w,I,C),H=D(w,I,P);if(new sn([q[0],q[1],d],[H[0],H[1],y]).intersectsPrecise(u)===0){k&&(_.segments.push(k),k=void 0);continue}const te=B.segment;k&&k.vertexOffset!==te.vertexOffset&&(_.segments.push(k),k=void 0),k?(k.vertexLength+=te.vertexLength,k.primitiveLength+=te.primitiveLength):k={vertexOffset:te.vertexOffset,primitiveLength:te.primitiveLength,vertexLength:te.vertexLength,primitiveOffset:te.primitiveOffset,sortKey:void 0,vaos:{}}}return k&&_.segments.push(k),_}encodeCentroid(n,o){const u=n.centroid(),_=o.span(),d=Math.min(7,Math.round(_.x*this.tileToMeter/10)),y=Math.min(7,Math.round(_.y*this.tileToMeter/10));return new It(Bn(u.x,1,Kt-1)<<3|d,Bn(u.y,1,Kt-1)<<3|y)}encodeBorderCentroid(n){if(!n.borders)return new It(0,0);const o=n.borders,u=Number.MAX_VALUE;if(o[0][0]!==u||o[1][0]!==u){const _=o[0][0]!==u?0:1;return new It(6|(o[0][0]!==u?0:65528),(o[_][0]+o[_][1])/2<<3|6)}{const _=o[2][0]!==u?2:3;return new It((o[_][0]+o[_][1])/2<<3|6,6|(o[2][0]!==u?0:65528))}}showCentroid(n){const o=this.centroidData[n.centroidDataIndex];o.flags&=Za,o.centroidXY.x=0,o.centroidXY.y=0,this.writeCentroidToBuffer(o)}writeCentroidToBuffer(n){this.groundEffect.updateHiddenByLandmark(n);const o=n.vertexArrayOffset,u=n.vertexCount+n.vertexArrayOffset,_=n.flags&Za?ly:n.centroidXY,d=this.centroidVertexArray.geta_centroid_pos0(o);if(this.centroidVertexArray.geta_centroid_pos1(o)!==_.y||d!==_.x){for(let y=o;y<u;++y)this.centroidVertexArray.emplace(y,_.x,_.y);this.needsCentroidUpdate=!0}}createCentroidsBuffer(){this.centroidVertexArray.resize(this.layoutVertexArray.length),this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const n of this.centroidData)this.writeCentroidToBuffer(n)}updateReplacement(n,o,u){if(o.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=o.updateTime;const _=o.getReplacementRegionsForTile(n.toUnwrapped());if(Bm(this.activeReplacements,_))return;if(this.activeReplacements=_,this.centroidVertexArray.length===0)this.createCentroidsBuffer();else for(const y of this.centroidData)y.flags&=2147483647;const d=[];for(const y of this.activeReplacements){if(y.order<u)continue;const E=Math.max(1,Math.pow(2,y.footprintTileId.canonical.z-n.canonical.z));for(const M of this.centroidData)if(!(M.flags&Za||y.min.x>M.max.x||M.min.x>y.max.x||y.min.y>M.max.y||M.min.y>y.max.y))for(let k=0;k<M.footprintSegLen;k++){const w=this.footprintSegments[M.footprintSegIdx+k];if(d.length=0,s2(this.footprintVertices,w.vertexOffset,w.vertexCount,y.footprintTileId.canonical,n.canonical,d),ay(y.footprint,d,this.footprintIndices.uint16,w.indexOffset,w.indexCount,-w.vertexOffset,-E)){M.flags|=Za;break}}}for(const y of this.centroidData)this.writeCentroidToBuffer(y);this.borderDoneWithNeighborZ=[-1,-1,-1,-1]}footprintContainsPoint(n,o,u){let _=!1;for(let d=0;d<u.footprintSegLen;d++){const y=this.footprintSegments[u.footprintSegIdx+d];let E=0;for(const M of y.ringIndices){for(let k=E,w=M+E-1;k<M+E;w=k++){const I=this.footprintVertices.int16[2*(k+y.vertexOffset)+0],D=this.footprintVertices.int16[2*(k+y.vertexOffset)+1],C=this.footprintVertices.int16[2*(w+y.vertexOffset)+1];D>o!=C>o&&n<(this.footprintVertices.int16[2*(w+y.vertexOffset)+0]-I)*(o-D)/(C-D)+I&&(_=!_)}E=M}}return _}getHeightAtTileCoord(n,o){let u=Number.NEGATIVE_INFINITY,_=!0;const d=4*(n+Kt)*Kt+(o+Kt);if(this.partLookup.hasOwnProperty(d)){const y=this.partLookup[d];return y?{height:y.height,hidden:!!(y.flags&Za)}:void 0}for(const y of this.centroidData)n>y.max.x||y.min.x>n||o>y.max.y||y.min.y>o||this.footprintContainsPoint(n,o,y)&&y&&y.height>u&&(u=y.height,this.partLookup[d]=y,_=!!(y.flags&Za));if(u!==Number.NEGATIVE_INFINITY)return{height:u,hidden:_};this.partLookup[d]=void 0}}function a2(c,n){const o=c.add(n)._unit();return c.x*o.x+c.y*o.y}function Zw(c,n,o,u){const _=n.sub(c)._perp()._unit(),d=o.sub(n)._perp()._unit();return uy(c,n,o,a2(_,d),u)}function uy(c,n,o,u,_){const d=Math.sqrt(1-u*u);return Math.min(c.dist(n)/3,n.dist(o)/3,_*d/u)}function jh(c,n,o){return c.x<o[0].x&&n.x<o[0].x||c.x>o[1].x&&n.x>o[1].x||c.y<o[0].y&&n.y<o[0].y||c.y>o[1].y&&n.y>o[1].y}function Cp(c,n){return c.x<n[0].x||c.x>n[1].x||c.y<n[0].y||c.y>n[1].y}function hy(c,n,o){if(c.x<0||c.x>=Kt||n.x<0||n.x>=Kt||o.x<0||o.x>=Kt)return!1;const u=o.sub(n),_=u.perp(),d=c.sub(n);return(u.x*d.x+u.y*d.y)/Math.sqrt((u.x*u.x+u.y*u.y)*(d.x*d.x+d.y*d.y))>-.866&&_.x*d.x+_.y*d.y<0}function o2(c,n,o){const u=n?2|c:-3&c;return o?1|u:-2&u}function od(){const c=Math.PI/32,n=Math.tan(c),o=Fs;return o*Math.sqrt(1+2*n*n)-o}function Mp(c,n,o){const u=1<<o.z,_=Ja(o.x/u),d=Ja((o.x+1)/u),y=$i(o.y/u),E=$i((o.y+1)/u);return function(M,k,w,I,D=0,C){const P=[];if(!M.length||!w||!I)return P;const B=(ce,me)=>{for(const Ce of ce)P.push({polygon:Ce,bounds:me})},q=Math.ceil(Math.log2(w)),H=Math.ceil(Math.log2(I)),te=q-H,re=[];for(let ce=0;ce<Math.abs(te);ce++)re.push(te>0?0:1);for(let ce=0;ce<Math.min(q,H);ce++)re.push(0),re.push(1);let J=M;if(J=Tp(J,k[0].y-D,k[1].y+D,1),J=Tp(J,k[0].x-D,k[1].x+D,0),!J.length)return P;const ie=[];for(re.length?ie.push({polygons:J,bounds:k,depth:0}):B(J,k);ie.length;){const ce=ie.pop(),me=ce.depth,Ce=re[me],Ae=ce.bounds[0],Ee=ce.bounds[1],Ue=Ce===0?Ae.x:Ae.y,Ie=Ce===0?Ee.x:Ee.y,Ve=C?C(Ce,Ue,Ie):.5*(Ue+Ie),Ze=Tp(ce.polygons,Ue-D,Ve+D,Ce),qe=Tp(ce.polygons,Ve-D,Ie+D,Ce);if(Ze.length){const Ke=[Ae,new It(Ce===0?Ve:Ee.x,Ce===1?Ve:Ee.y)];re.length>me+1?ie.push({polygons:Ze,bounds:Ke,depth:me+1}):B(Ze,Ke)}if(qe.length){const Ke=[new It(Ce===0?Ve:Ae.x,Ce===1?Ve:Ae.y),Ee];re.length>me+1?ie.push({polygons:qe,bounds:Ke,depth:me+1}):B(qe,Ke)}}return P}(c,n,Math.ceil((d-_)/11.25),Math.ceil((y-E)/11.25),1,(M,k,w)=>{if(M===0)return .5*(k+w);{const I=$i((o.y+k/Kt)/u);return(ys(.5*($i((o.y+w/Kt)/u)+I))*u-o.y)*Kt}})}function s2(c,n,o,u,_,d){const y=Math.pow(2,u.z-_.z);for(let E=0;E<o;E++){let M=c.int16[2*(E+n)+0],k=c.int16[2*(E+n)+1];M=(M+_.x*Kt)*y-u.x*Kt,k=(k+_.y*Kt)*y-u.y*Kt,d.push(new It(M,k))}}let jm,f_;function sd(c,n){return c.x*n.x+c.y*n.y}function Um(c,n){if(c.length===1){let o=0;const u=n[o++];let _;for(;!_||u.equals(_);)if(_=n[o++],!_)return 1/0;for(;o<n.length;o++){const d=n[o],y=c[0],E=_.sub(u),M=d.sub(u),k=y.sub(u),w=sd(E,E),I=sd(E,M),D=sd(M,M),C=sd(k,E),P=sd(k,M),B=w*D-I*I,q=(D*C-I*P)/B,H=(w*P-I*C)/B,te=u.z*(1-q-H)+_.z*q+d.z*H;if(isFinite(te))return te}return 1/0}{let o=1/0;for(const u of n)o=Math.min(o,u.z);return o}}function fy(c,n,o,u,_,d,y,E){const M=y*_.getElevationAt(c,n,!0,!0),k=d[0]!==0,w=k?d[1]===0?y*(d[0]/7-450):y*function(I,D,C){const P=Math.floor(D[0]/8),B=Math.floor(D[1]/8),q=10*(D[0]-8*P),H=10*(D[1]-8*B),te=I.getElevationAt(P,B,!0,!0),re=I.getMeterToDEM(C),J=Math.floor(.5*(q*re-1)),ie=Math.floor(.5*(H*re-1)),ce=I.tileCoordToPixel(P,B),me=2*J+1,Ce=2*ie+1,Ae=function(qe,Ke,Qe,at,Je){return[qe.getElevationAtPixel(Ke,Qe,!0),qe.getElevationAtPixel(Ke+Je,Qe,!0),qe.getElevationAtPixel(Ke,Qe+Je,!0),qe.getElevationAtPixel(Ke+at,Qe+Je,!0)]}(I,ce.x-J,ce.y-ie,me,Ce),Ee=Math.abs(Ae[0]-Ae[1]),Ue=Math.abs(Ae[2]-Ae[3]),Ie=Math.abs(Ae[0]-Ae[2])+Math.abs(Ae[1]-Ae[3]),Ve=Math.min(.25,.5*re*(Ee+Ue)/me),Ze=Math.min(.25,.5*re*Ie/Ce);return te+Math.max(Ve*q,Ze*H)}(_,d,E):M;return{base:M+(o===0?-1:o),top:k?Math.max(w+u,M+o+2):M+u}}hn(h_,"FillExtrusionBucket",{omit:["layers","features"]}),hn(ad,"PartData"),hn(n2,"FootprintSegment"),hn(cy,"BorderCentroidData"),hn(i2,"GroundEffect");const l2=br([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),Ww=br([{name:"a_z_offset_width",components:3,type:"Float32"}],4),{members:c2}=l2,Vm=br([{name:"a_packed",components:3,type:"Float32"}]),{members:Xw}=Vm,Yw=br([{name:"a_pattern_data",components:3,type:"Float32"}]),{members:Kw}=Yw;class $m{constructor(n,o){this.width=n,this.height=o,this.nextRow=0,this.image=new Du({width:n,height:o}),this.positions={},this.uploaded=!1}getDash(n,o){const u=this.getKey(n,o);return this.positions[u]}trim(){const n=this.width,o=this.height=Yu(this.nextRow);this.image.resize({width:n,height:o})}getKey(n,o){return n.join(",")+o}getDashRanges(n,o,u){const _=[];let d=n.length%2==1?-n[n.length-1]*u:0,y=n[0]*u,E=!0;_.push({left:d,right:y,isDash:E,zeroLength:n[0]===0});let M=n[0];for(let k=1;k<n.length;k++){E=!E;const w=n[k];d=M*u,M+=w,y=M*u,_.push({left:d,right:y,isDash:E,zeroLength:w===0})}return _}addRoundDash(n,o,u){const _=o/2;for(let d=-u;d<=u;d++){const y=this.width*(this.nextRow+u+d);let E=0,M=n[E];for(let k=0;k<this.width;k++){k/M.right>1&&(M=n[++E]);const w=Math.abs(k-M.left),I=Math.abs(k-M.right),D=Math.min(w,I);let C;const P=d/u*(_+1);if(M.isDash){const B=_-Math.abs(P);C=Math.sqrt(D*D+B*B)}else C=_-Math.sqrt(D*D+P*P);this.image.data[y+k]=Math.max(0,Math.min(255,C+128))}}}addRegularDash(n,o){for(let M=n.length-1;M>=0;--M){const k=n[M],w=n[M+1];k.zeroLength?n.splice(M,1):w&&w.isDash===k.isDash&&(w.left=k.left,n.splice(M,1))}const u=n[0],_=n[n.length-1];u.isDash===_.isDash&&(u.left=_.left-this.width,_.right=u.right+this.width);const d=this.width*this.nextRow;let y=0,E=n[y];for(let M=0;M<this.width;M++){M/E.right>1&&(E=n[++y]);const k=Math.abs(M-E.left),w=Math.abs(M-E.right),I=Math.min(k,w);this.image.data[d+M]=Math.max(0,Math.min(255,(E.isDash?I:-I)+o+128))}}addDash(n,o){const u=this.getKey(n,o);if(this.positions[u])return this.positions[u];const _=o==="round",d=_?7:0,y=2*d+1;if(this.nextRow+y>this.height)return qn("LineAtlas out of space"),null;n.length===0&&n.push(1);let E=0;for(let w=0;w<n.length;w++)n[w]<0&&(qn("Negative value is found in line dasharray, replacing values with 0"),n[w]=0),E+=n[w];if(E!==0){const w=this.width/E,I=this.getDashRanges(n,this.width,w);_?this.addRoundDash(I,w,d):this.addRegularDash(I,o==="square"?.5*w:0)}const M=this.nextRow+d;this.nextRow+=y;const k={tl:[M,d],br:[E,0]};return this.positions[u]=k,k}}hn($m,"LineAtlas");const d_=rd.VectorTileFeature.types,dy=Math.cos(Math.PI/180*37.5),Jw=Math.cos(Math.PI/180*5);class ld{constructor(n){this.evaluationGlobals={zoom:0,lineProgress:void 0},this.zoom=n.zoom,this.evaluationGlobals.zoom=this.zoom,this.overscaling=n.overscaling,this.pixelRatio=n.pixelRatio,this.layers=n.layers,this.layerIds=this.layers.map(o=>o.fqid),this.index=n.index,this.projection=n.projection,this.hasPattern=!1,this.hasZOffset=!1,this.hasCrossSlope=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(o=>{this.gradients[o.id]={}}),this.layoutVertexArray=new Ah,this.layoutVertexArray2=new tl,this.patternVertexArray=new tl,this.indexArray=new ia,this.programConfigurations=new Co(n.layers,{zoom:n.zoom,lut:n.lut}),this.segments=new ci,this.maxLineLength=0,this.zOffsetVertexArray=new tl,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id),this.tessellationStep=n.tessellationStep?n.tessellationStep:Kt/64}updateFootprints(n,o){}populate(n,o,u,_){this.hasPattern=Q0("line",this.layers,this.pixelRatio,o);const d=this.layers[0].layout.get("line-sort-key");this.tileToMeter=r(u);const y=this.layers[0].layout.get("line-z-offset"),E=y.isConstant()&&!y.constantOr(0),M=this.layers[0].layout.get("line-elevation-reference");this.hasZOffset=M==="sea"||M==="ground"||!E&&M==="none",this.hasZOffset&&M==="none"&&qn(`line-elevation-reference: ground is used for the layer ${this.layerIds[0]} because non-zero line-z-offset value was found.`);const k=this.layers[0].layout.get("line-cross-slope");this.hasCrossSlope=this.hasZOffset&&k!==void 0;const w=[];for(const{feature:P,id:B,index:q,sourceLayerIndex:H}of n){const te=this.layers[0]._featureFilter.needGeometry,re=Z(P,te);if(!this.layers[0]._featureFilter.filter(new kr(this.zoom),re,u))continue;const J=d?d.evaluate(re,{},u):void 0,ie={id:B,properties:P.properties,type:P.type,sourceLayerIndex:H,index:q,geometry:te?re.geometry:$(P,u,_),patterns:{},sortKey:J};w.push(ie)}d&&w.sort((P,B)=>P.sortKey-B.sortKey);const{lineAtlas:I,featureIndex:D}=o,C=this.addConstantDashes(I);for(const P of w){const{geometry:B,index:q,sourceLayerIndex:H}=P;if(C&&this.addFeatureDashes(P,I),this.hasPattern){const te=e_("line",this.layers,P,this.zoom,this.pixelRatio,o);this.patternFeatures.push(te)}else this.addFeature(P,B,q,u,I.positions,o.availableImages,o.brightness);D.insert(n[q].feature,B,q,H,this.index)}}addConstantDashes(n){let o=!1;for(const u of this.layers){const _=u.paint.get("line-dasharray").value,d=u.layout.get("line-cap").value;if(_.kind!=="constant"||d.kind!=="constant")o=!0;else{const y=d.value,E=_.value;if(!E)continue;n.addDash(E,y)}}return o}addFeatureDashes(n,o){const u=this.zoom;for(const _ of this.layers){const d=_.paint.get("line-dasharray").value,y=_.layout.get("line-cap").value;if(d.kind==="constant"&&y.kind==="constant")continue;let E,M;if(d.kind==="constant"){if(E=d.value,!E)continue}else E=d.evaluate({zoom:u},n);M=y.kind==="constant"?y.value:y.evaluate({zoom:u},n),o.addDash(E,M),n.patterns[_.id]=o.getKey(E,M)}}update(n,o,u,_,d,y,E){this.programConfigurations.updatePaintArrays(n,o,d,u,_,y,E)}addFeatures(n,o,u,_,d,y){for(const E of this.patternFeatures)this.addFeature(E,E.geometry,E.index,o,u,_,y)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=n.createVertexBuffer(this.layoutVertexArray2,Xw)),this.patternVertexArray.length!==0&&(this.patternVertexBuffer=n.createVertexBuffer(this.patternVertexArray,Kw)),!this.zOffsetVertexBuffer&&this.zOffsetVertexArray.length>0&&(this.zOffsetVertexBuffer=n.createVertexBuffer(this.zOffsetVertexArray,Ww.members,!0)),this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,c2),this.indexBuffer=n.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy(),this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(n){if(n.properties&&n.properties.hasOwnProperty("mapbox_clip_start")&&n.properties.hasOwnProperty("mapbox_clip_end"))return{start:+n.properties.mapbox_clip_start,end:+n.properties.mapbox_clip_end}}addFeature(n,o,u,_,d,y,E){const M=this.layers[0].layout,k=M.get("line-join").evaluate(n,{}),w=M.get("line-cap").evaluate(n,{}),I=M.get("line-miter-limit"),D=M.get("line-round-limit");this.lineClips=this.lineFeatureClips(n),this.lineFeature=n,this.zOffsetValue=M.get("line-z-offset").value;const C=this.layers[0].paint.get("line-width").value;C.kind!=="constant"&&C.isLineProgressConstant===!1&&(this.variableWidthValue=C);for(const P of o)this.addLine(P,n,_,k,w,I,D);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,u,d,y,_,E)}addLine(n,o,u,_,d,y,E){this.distance=0,this.prevDistance=0,this.scaledDistance=0,this.totalDistance=0,this.totalFeatureLength=0,this.lineSoFar=0,this.currentVertex=void 0;const M=_==="none";if(this.patternJoinNone=this.hasPattern&&M,this.segmentStart=0,this.segmentStartf32=0,this.segmentPoints=[],this.lineClips){this.lineClipsArray.push(this.lineClips);for(let re=0;re<n.length-1;re++)this.totalDistance+=n[re].dist(n[re+1]);this.totalFeatureLength=this.totalDistance/(this.lineClips.end-this.lineClips.start),this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const k=d_[o.type]==="Polygon";let w=n.length;for(;w>=2&&n[w-1].equals(n[w-2]);)w--;let I=0;for(;I<w-1&&n[I].equals(n[I+1]);)I++;if(w<(k?3:2))return;_==="bevel"&&(y=1.05);const D=this.segments.prepareSegment(10*w,this.layoutVertexArray,this.indexArray);let C,P,B,q,H,te;this.e1=this.e2=-1,k&&(C=n[w-2],H=n[I].sub(C)._unit()._perp());for(let re=I;re<w;re++){if(B=re===w-1?k?n[I+1]:void 0:n[re+1],B&&n[re].equals(B))continue;H&&(q=H),C&&(P=C),C=n[re],te=this.evaluateLineProgressFeatures(P?P.dist(C):0),H=B?B.sub(C)._unit()._perp():q,q=q||H;const J=P&&B;let ie=J?_:k||M?"butt":d;const ce=q.x*H.x+q.y*H.y;if(M){const Ze=function(qe){if(qe.patternJoinNone){const Ke=qe.segmentPoints.length/2,Qe=qe.lineSoFar-qe.segmentStart;for(let at=0;at<Ke;++at){const Je=qe.segmentPoints[2*at+1],wt=Math.round(qe.segmentPoints[2*at])+.5+.25*Je;qe.patternVertexArray.emplaceBack(wt,Qe,qe.segmentStart),qe.patternVertexArray.emplaceBack(wt,Qe,qe.segmentStart)}qe.segmentPoints.length=0}qe.e1=qe.e2=-1};if(J&&ce<Jw){this.updateDistance(P,C),this.addCurrentVertex(C,q,1,1,D,te),Ze(this),this.addCurrentVertex(C,H,-1,-1,D,te);continue}if(P){if(!B){this.updateDistance(P,C),this.addCurrentVertex(C,q,1,1,D,te),Ze(this);continue}ie="miter"}}let me=q.add(H);me.x===0&&me.y===0||me._unit();const Ce=me.x*H.x+me.y*H.y,Ae=Ce!==0?1/Ce:1/0,Ee=2*Math.sqrt(2-2*Ce),Ue=Ce<dy&&P&&B,Ie=q.x*H.y-q.y*H.x>0,Ve=this.overscaling<=16?15*Kt/(512*this.overscaling):0;if(J&&ie==="round"){if(Ae<E)ie="miter";else if(Ae<=2){const Ze=py(C,-10,Kt+10);ie=this.hasZOffset&&(Ze||this.hasCrossSlope)?"miter":"fakeround"}}if(ie==="miter"&&Ae>y&&(ie="bevel"),ie==="bevel"&&(Ae>2&&(ie="flipbevel"),Ae<y&&(ie="miter")),P&&!(ie==="miter"&&Ue)&&this.updateDistance(P,C),ie==="miter")if(Ue){const Ze=C.dist(P);if(Ze>2*Ve){const Ke=C.sub(C.sub(P)._mult(Ve/Ze)._round());this.updateDistance(P,Ke),this.addCurrentVertex(Ke,q,0,0,D,te),P=Ke}this.updateDistance(P,C),me._mult(Ae),this.addCurrentVertex(C,me,0,0,D,te);const qe=C.dist(B);if(qe>2*Ve){const Ke=C.add(B.sub(C)._mult(Ve/qe)._round());this.updateDistance(C,Ke),this.addCurrentVertex(Ke,H,0,0,D,te),C=Ke}}else me._mult(Ae),this.addCurrentVertex(C,me,0,0,D,te);else if(ie==="flipbevel"){if(Ae>100)me=H.mult(-1);else{const Ze=Ae*q.add(H).mag()/q.sub(H).mag();me._perp()._mult(Ze*(Ie?-1:1))}this.addCurrentVertex(C,me,0,0,D,te),this.addCurrentVertex(C,me.mult(-1),0,0,D,te)}else if(ie==="bevel"||ie==="fakeround"){te!=null&&P&&this.addCurrentVertex(C,q,-1,-1,D,te);const Ze=C.dist(P)<=2*Ve&&ie!=="bevel",qe=me.mult(Ie?1:-1);qe._mult(Ae);const Ke=H.mult(Ie?-1:1),Qe=q.mult(Ie?-1:1),at=this.evaluateLineProgressFeatures(this.distance);if(te==null&&(this.addHalfVertex(C,qe.x,qe.y,!1,!Ie,0,D,at),Ze||this.addHalfVertex(C,qe.x+2*Qe.x,qe.y+2*Qe.y,!1,Ie,0,D,at)),ie==="fakeround"){const Je=Math.round(180*Ee/Math.PI/20);this.addHalfVertex(C,Qe.x,Qe.y,!1,Ie,0,D,at);for(let wt=0;wt<Je;wt++){let Rt=wt/Je;if(Rt!==.5){const an=Rt-.5;Rt+=Rt*an*(Rt-1)*((1.0904+ce*(ce*(3.55645-1.43519*ce)-3.2452))*an*an+(.848013+ce*(.215638*ce-1.06021)))}const bt=Ke.sub(Qe)._mult(Rt)._add(Qe)._unit();this.addHalfVertex(C,bt.x,bt.y,!1,Ie,0,D,at)}this.addHalfVertex(C,Ke.x,Ke.y,!1,Ie,0,D,at)}Ze||te!=null||this.addHalfVertex(C,qe.x+2*Ke.x,qe.y+2*Ke.y,!1,Ie,0,D,at),te!=null&&B&&this.addCurrentVertex(C,H,1,1,D,te)}else ie==="butt"?this.addCurrentVertex(C,me,0,0,D,te):ie==="square"?(P||this.addCurrentVertex(C,me,-1,-1,D,te),this.addCurrentVertex(C,me,0,0,D,te),P&&this.addCurrentVertex(C,me,1,1,D,te)):ie==="round"&&(P&&(this.addCurrentVertex(C,q,0,0,D,te),this.addCurrentVertex(C,q,1,1,D,te,!0)),B&&(this.addCurrentVertex(C,H,-1,-1,D,te,!0),this.addCurrentVertex(C,H,0,0,D,te)))}}addVerticesTo(n,o,u,_,d,y,E,M,k,w){const I=(o.w-n.w)/this.tessellationStep|0;let D=0;const C=this.scaledDistance;if(I>1){this.lineSoFar=n.w;const B=(o.x-n.x)/I,q=(o.y-n.y)/I,H=(o.z-n.z)/I,te=(o.w-n.w)/I;for(let re=1;re<I;++re){n.x+=B,n.y+=q,n.z+=H,this.lineSoFar+=te,D+=te;const J=this.evaluateLineProgressFeatures(this.prevDistance+D);this.scaledDistance=(this.prevDistance+D)/this.totalDistance,this.addHalfVertex(n,u,_,w,!1,E,k,J),this.addHalfVertex(n,d,y,w,!0,-M,k,J)}}this.lineSoFar=o.w,this.scaledDistance=C;const P=this.evaluateLineProgressFeatures(this.distance);this.addHalfVertex(o,u,_,w,!1,E,k,P),this.addHalfVertex(o,d,y,w,!0,-M,k,P)}evaluateLineProgressFeatures(n){if(!this.variableWidthValue&&!this.hasZOffset)return null;this.evaluationGlobals.lineProgress=0,this.lineClips?this.evaluationGlobals.lineProgress=Math.min(1,(this.totalFeatureLength*this.lineClips.start+n)/this.totalFeatureLength):qn(`line-progress evaluation for ${this.layerIds[0]} requires enabling 'lineMetrics' for the source.`);let o=0;return this.variableWidthValue&&this.variableWidthValue.kind!=="constant"&&(o=this.variableWidthValue.evaluate(this.evaluationGlobals,this.lineFeature)||0),this.hasZOffset?this.zOffsetValue.kind==="constant"?{zOffset:this.zOffsetValue.value,variableWidth:o}:{zOffset:this.zOffsetValue.evaluate(this.evaluationGlobals,this.lineFeature)||0,variableWidth:o}:{zOffset:0,variableWidth:o}}addCurrentVertex(n,o,u,_,d,y,E=!1){const M=o.x+o.y*u,k=o.y-o.x*u,w=o.y*_-o.x,I=-o.y-o.x*_;if(y!=null){const D=this.hasZOffset,C=-10,P=Kt+10,B=y.zOffset,q=new mi(n.x,n.y,B,this.lineSoFar),H=!!D&&py(n,C,P),te=this.lineSoFar,re=this.distance;if(this.currentVertex)if(H){const J=this.currentVertexIsOutside,ie=this.currentVertex,ce=new mi(n.x,n.y,B,this.lineSoFar);if(J1(ie,ce,C,P),!py(ce,C,P)){if(J){this.e1=this.e2=-1,this.distance-=ie.dist(q),this.lineSoFar=ie.w;const me=this.evaluateLineProgressFeatures(ie.w-this.totalFeatureLength*(this.lineClips?this.lineClips.start:0));this.addHalfVertex(ie,M,k,E,!1,u,d,me),this.addHalfVertex(ie,w,I,E,!0,-_,d,me),this.prevDistance=this.distance}this.distance=this.prevDistance+ie.dist(ce),this.scaledDistance=this.distance/this.totalDistance,this.addVerticesTo(ie,ce,M,k,w,I,u,_,d,E),this.distance=re,this.scaledDistance=this.distance/this.totalDistance}}else{const J=this.currentVertex;if(this.currentVertexIsOutside){J1(J,q,C,P),this.e1=this.e2=-1,this.distance-=J.dist(q),this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=J.w;const ie=this.evaluateLineProgressFeatures(J.w-this.totalFeatureLength*(this.lineClips?this.lineClips.start:0));this.addHalfVertex(J,M,k,E,!1,u,d,ie),this.addHalfVertex(J,w,I,E,!0,-_,d,ie),this.prevDistance=this.distance,this.distance=re,this.scaledDistance=this.distance/this.totalDistance}this.addVerticesTo(J,q,M,k,w,I,u,_,d,E)}else H||(this.addHalfVertex(n,M,k,E,!1,u,d,y),this.addHalfVertex(n,w,I,E,!0,-_,d,y));this.currentVertex=q,this.currentVertexIsOutside=H,this.lineSoFar=te}else this.addHalfVertex(n,M,k,E,!1,u,d,y),this.addHalfVertex(n,w,I,E,!0,-_,d,y)}addHalfVertex({x:n,y:o},u,_,d,y,E,M,k){if(this.patternJoinNone&&(this.segmentPoints.length===0&&(this.segmentStart=this.lineSoFar,this.segmentStartf32=Math.fround(this.lineSoFar)),y||this.segmentPoints.push(this.lineSoFar-this.segmentStart,E)),this.layoutVertexArray.emplaceBack((n<<1)+(d?1:0),(o<<1)+(y?1:0),Math.round(63*u)+128,Math.round(63*_)+128,1+(E===0?0:E<0?-1:1),0,this.lineSoFar-this.segmentStartf32),this.lineClips){const I=Mn(this.lineClips.start,this.lineClips.end,this.scaledDistance);this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,I)}const w=M.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,w),M.primitiveLength++),y?this.e2=w:this.e1=w,k!=null&&this.zOffsetVertexArray.emplaceBack(k.zOffset,k.variableWidth,k.variableWidth)}updateScaledDistance(){this.lineClips?(this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=this.totalFeatureLength*this.lineClips.start+this.distance):this.lineSoFar=this.distance}updateDistance(n,o){this.prevDistance=this.distance,this.distance+=n.dist(o),this.updateScaledDistance()}}function py(c,n,o){return c.x<n||c.x>o||c.y<n||c.y>o}let my,_y;function gy(c,n,o){return n*(Kt/(c.tileSize*Math.pow(2,o-c.tileID.overscaledZ)))}hn(ld,"LineBucket",{omit:["layers","patternFeatures","currentVertex","currentVertexIsOutside"]});const yy=(c,n,o)=>(1-o)*c+o*n;function p_(c,n){return 1/gy(c,1,n.tileZoom)}function vy(c,n,o,u){return c.translatePosMatrix(u||n.tileID.projMatrix,n,o.paint.get("line-translate"),o.paint.get("line-translate-anchor"))}const qm=c=>{const n=[];u2(c)&&n.push("RENDER_LINE_DASH"),c.paint.get("line-gradient")&&n.push("RENDER_LINE_GRADIENT");const o=c.paint.get("line-trim-offset");o[0]===0&&o[1]===0||n.push("RENDER_LINE_TRIM_OFFSET"),c.paint.get("line-border-width").constantOr(1)!==0&&n.push("RENDER_LINE_BORDER");const u=c.layout.get("line-join").constantOr("miter")==="none",_=!!c.paint.get("line-pattern").constantOr(1);return u&&_&&n.push("LINE_JOIN_NONE"),n};function u2(c){const n=c.paint.get("line-dasharray").value;return n.value||n.kind!=="constant"}let xy;const m_=()=>xy||(xy={layout:my||(my=new ni({"line-cap":new cn(st.layout_line["line-cap"]),"line-join":new cn(st.layout_line["line-join"]),"line-miter-limit":new qt(st.layout_line["line-miter-limit"]),"line-round-limit":new qt(st.layout_line["line-round-limit"]),"line-sort-key":new cn(st.layout_line["line-sort-key"]),"line-z-offset":new cn(st.layout_line["line-z-offset"]),"line-elevation-reference":new qt(st.layout_line["line-elevation-reference"]),"line-cross-slope":new qt(st.layout_line["line-cross-slope"]),visibility:new qt(st.layout_line.visibility),"line-width-unit":new qt(st.layout_line["line-width-unit"])})),paint:_y||(_y=new ni({"line-opacity":new cn(st.paint_line["line-opacity"]),"line-color":new cn(st.paint_line["line-color"]),"line-translate":new qt(st.paint_line["line-translate"]),"line-translate-anchor":new qt(st.paint_line["line-translate-anchor"]),"line-width":new cn(st.paint_line["line-width"]),"line-gap-width":new cn(st.paint_line["line-gap-width"]),"line-offset":new cn(st.paint_line["line-offset"]),"line-blur":new cn(st.paint_line["line-blur"]),"line-dasharray":new cn(st.paint_line["line-dasharray"]),"line-pattern":new cn(st.paint_line["line-pattern"]),"line-gradient":new Su(st.paint_line["line-gradient"]),"line-trim-offset":new qt(st.paint_line["line-trim-offset"]),"line-trim-fade-range":new qt(st.paint_line["line-trim-fade-range"]),"line-trim-color":new qt(st.paint_line["line-trim-color"]),"line-emissive-strength":new qt(st.paint_line["line-emissive-strength"]),"line-border-width":new cn(st.paint_line["line-border-width"]),"line-border-color":new cn(st.paint_line["line-border-color"]),"line-occlusion-opacity":new qt(st.paint_line["line-occlusion-opacity"]),"line-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"}),"line-gradient-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"}),"line-trim-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"}),"line-border-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"})}))},xy);class by extends cn{possiblyEvaluate(n,o){return o=new kr(Math.floor(o.zoom),{now:o.now,fadeDuration:o.fadeDuration,transition:o.transition}),super.possiblyEvaluate(n,o)}evaluate(n,o,u,_){return o=ua({},o,{zoom:Math.floor(o.zoom)}),super.evaluate(n,o,u,_)}}let Uh;function __(c,n){return n>0?n+2*c:c}const h2=br([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),wy=br([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),Vh=br([{name:"a_projected_pos",components:4,type:"Float32"}],4);br([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const $h=br([{name:"a_auto_z_offset",components:1,type:"Float32"}],4),qh=br([{name:"a_texb",components:2,type:"Uint16"}]),Gm=br([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_elevation_from_sea",components:2,type:"Float32"}]),Hm=br([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"},{name:"a_auto_z_offset",components:1,type:"Float32"}]);br([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const zu=br([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Qw=br([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);br([{name:"triangle",components:3,type:"Uint16"}]),br([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),br([{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Float32",name:"zOffset"},{type:"Uint8",name:"hasIconTextFit"}]),br([{type:"Float32",name:"offsetX"}]),br([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var Ba=24;const Wo=128;function Sy(c,n,o,u,_){if(c.kind==="camera")return c.maxSize;if(c.kind==="composite"){const d=n.possiblyEvaluate(new kr(c.maxZoom),o).evaluate(_,{},o),y=n.possiblyEvaluate(new kr(c.minZoom),o).evaluate(_,{},o);return Math.max(d,y)}return n.possiblyEvaluate(new kr(u)).evaluate(_,{},o)}function g_(c,n){const{expression:o}=n;if(o.kind==="constant")return{kind:"constant",layoutSize:o.evaluate(new kr(c+1))};if(o.kind==="source")return{kind:"source"};{const{zoomStops:u,interpolationType:_}=o;let d=0;for(;d<u.length&&u[d]<=c;)d++;d=Math.max(0,d-1);let y=d;for(;y<u.length&&u[y]<c+1;)y++;y=Math.min(u.length-1,y);const E=u[d],M=u[y];return o.kind==="composite"?{kind:"composite",minZoom:E,maxZoom:M,interpolationType:_}:{kind:"camera",minZoom:E,maxZoom:M,minSize:o.evaluate(new kr(E)),maxSize:o.evaluate(new kr(M)),interpolationType:_}}}function cd(c,{uSize:n,uSizeT:o},{lowerSize:u,upperSize:_}){return c.kind==="source"?u/Wo:c.kind==="composite"?Mn(u/Wo,_/Wo,o):n}function ud(c,n,o=1){let u=0,_=0;if(c.kind==="constant")_=c.layoutSize*o;else if(c.kind!=="source"){const{interpolationType:d,minZoom:y,maxZoom:E}=c,M=d?Bn(li.interpolationFactor(d,n,y,E),0,1):0;c.kind==="camera"?_=Mn(c.minSize,c.maxSize,M)*o:u=M*o}return{uSizeT:u,uSize:_}}var eS=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:Wo,evaluateSizeForFeature:cd,evaluateSizeForZoom:ud,getRasterizedIconSize:Sy,getSizeData:g_});function y_(c,n,o){return c.sections.forEach(u=>{u.text=function(_,d,y){const E=d.layout.get("text-transform").evaluate(y,{});return E==="uppercase"?_=_.toLocaleUpperCase():E==="lowercase"&&(_=_.toLocaleLowerCase()),Yr.applyArabicShaping&&(_=Yr.applyArabicShaping(_)),_}(u.text,n,o)}),c}const Gh={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂","←":"↑","→":"↓"};function f2(c){return c==="︶"||c==="﹈"||c==="︸"||c==="﹄"||c==="﹂"||c==="︾"||c==="︼"||c==="︺"||c==="︘"||c==="﹀"||c==="︐"||c==="︓"||c==="︔"||c==="｀"||c==="￣"||c==="︑"||c==="︒"}function Zm(c){return c==="︵"||c==="﹇"||c==="︷"||c==="﹃"||c==="﹁"||c==="︽"||c==="︻"||c==="︹"||c==="︗"||c==="︿"}var v_,Op,Ty,Ey={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */function x_(){return v_||(v_=1,Ey.read=function(c,n,o,u,_){var d,y,E=8*_-u-1,M=(1<<E)-1,k=M>>1,w=-7,I=o?_-1:0,D=o?-1:1,C=c[n+I];for(I+=D,d=C&(1<<-w)-1,C>>=-w,w+=E;w>0;d=256*d+c[n+I],I+=D,w-=8);for(y=d&(1<<-w)-1,d>>=-w,w+=u;w>0;y=256*y+c[n+I],I+=D,w-=8);if(d===0)d=1-k;else{if(d===M)return y?NaN:1/0*(C?-1:1);y+=Math.pow(2,u),d-=k}return(C?-1:1)*y*Math.pow(2,d-u)},Ey.write=function(c,n,o,u,_,d){var y,E,M,k=8*d-_-1,w=(1<<k)-1,I=w>>1,D=_===23?Math.pow(2,-24)-Math.pow(2,-77):0,C=u?0:d-1,P=u?1:-1,B=n<0||n===0&&1/n<0?1:0;for(n=Math.abs(n),isNaN(n)||n===1/0?(E=isNaN(n)?1:0,y=w):(y=Math.floor(Math.log(n)/Math.LN2),n*(M=Math.pow(2,-y))<1&&(y--,M*=2),(n+=y+I>=1?D/M:D*Math.pow(2,1-I))*M>=2&&(y++,M/=2),y+I>=w?(E=0,y=w):y+I>=1?(E=(n*M-1)*Math.pow(2,_),y+=I):(E=n*Math.pow(2,I-1)*Math.pow(2,_),y=0));_>=8;c[o+C]=255&E,C+=P,E/=256,_-=8);for(y=y<<_|E,k+=_;k>0;c[o+C]=255&y,C+=P,y/=256,k-=8);c[o+C-P]|=128*B}),Ey}function h(){if(Ty)return Op;Ty=1,Op=n;var c=x_();function n(J){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(J)?J:new Uint8Array(J||0),this.pos=0,this.type=0,this.length=this.buf.length}n.Varint=0,n.Fixed64=1,n.Bytes=2,n.Fixed32=5;var o=4294967296,u=1/o,_=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function d(J){return J.type===n.Bytes?J.readVarint()+J.pos:J.pos+1}function y(J,ie,ce){return ce?4294967296*ie+(J>>>0):4294967296*(ie>>>0)+(J>>>0)}function E(J,ie,ce){var me=ie<=16383?1:ie<=2097151?2:ie<=268435455?3:Math.floor(Math.log(ie)/(7*Math.LN2));ce.realloc(me);for(var Ce=ce.pos-1;Ce>=J;Ce--)ce.buf[Ce+me]=ce.buf[Ce]}function M(J,ie){for(var ce=0;ce<J.length;ce++)ie.writeVarint(J[ce])}function k(J,ie){for(var ce=0;ce<J.length;ce++)ie.writeSVarint(J[ce])}function w(J,ie){for(var ce=0;ce<J.length;ce++)ie.writeFloat(J[ce])}function I(J,ie){for(var ce=0;ce<J.length;ce++)ie.writeDouble(J[ce])}function D(J,ie){for(var ce=0;ce<J.length;ce++)ie.writeBoolean(J[ce])}function C(J,ie){for(var ce=0;ce<J.length;ce++)ie.writeFixed32(J[ce])}function P(J,ie){for(var ce=0;ce<J.length;ce++)ie.writeSFixed32(J[ce])}function B(J,ie){for(var ce=0;ce<J.length;ce++)ie.writeFixed64(J[ce])}function q(J,ie){for(var ce=0;ce<J.length;ce++)ie.writeSFixed64(J[ce])}function H(J,ie){return(J[ie]|J[ie+1]<<8|J[ie+2]<<16)+16777216*J[ie+3]}function te(J,ie,ce){J[ce]=ie,J[ce+1]=ie>>>8,J[ce+2]=ie>>>16,J[ce+3]=ie>>>24}function re(J,ie){return(J[ie]|J[ie+1]<<8|J[ie+2]<<16)+(J[ie+3]<<24)}return n.prototype={destroy:function(){this.buf=null},readFields:function(J,ie,ce){for(ce=ce||this.length;this.pos<ce;){var me=this.readVarint(),Ce=me>>3,Ae=this.pos;this.type=7&me,J(Ce,ie,this),this.pos===Ae&&this.skip(me)}return ie},readMessage:function(J,ie){return this.readFields(J,ie,this.readVarint()+this.pos)},readFixed32:function(){var J=H(this.buf,this.pos);return this.pos+=4,J},readSFixed32:function(){var J=re(this.buf,this.pos);return this.pos+=4,J},readFixed64:function(){var J=H(this.buf,this.pos)+H(this.buf,this.pos+4)*o;return this.pos+=8,J},readSFixed64:function(){var J=H(this.buf,this.pos)+re(this.buf,this.pos+4)*o;return this.pos+=8,J},readFloat:function(){var J=c.read(this.buf,this.pos,!0,23,4);return this.pos+=4,J},readDouble:function(){var J=c.read(this.buf,this.pos,!0,52,8);return this.pos+=8,J},readVarint:function(J){var ie,ce,me=this.buf;return ie=127&(ce=me[this.pos++]),ce<128?ie:(ie|=(127&(ce=me[this.pos++]))<<7,ce<128?ie:(ie|=(127&(ce=me[this.pos++]))<<14,ce<128?ie:(ie|=(127&(ce=me[this.pos++]))<<21,ce<128?ie:function(Ce,Ae,Ee){var Ue,Ie,Ve=Ee.buf;if(Ue=(112&(Ie=Ve[Ee.pos++]))>>4,Ie<128||(Ue|=(127&(Ie=Ve[Ee.pos++]))<<3,Ie<128)||(Ue|=(127&(Ie=Ve[Ee.pos++]))<<10,Ie<128)||(Ue|=(127&(Ie=Ve[Ee.pos++]))<<17,Ie<128)||(Ue|=(127&(Ie=Ve[Ee.pos++]))<<24,Ie<128)||(Ue|=(1&(Ie=Ve[Ee.pos++]))<<31,Ie<128))return y(Ce,Ue,Ae);throw new Error("Expected varint not more than 10 bytes")}(ie|=(15&(ce=me[this.pos]))<<28,J,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var J=this.readVarint();return J%2==1?(J+1)/-2:J/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var J=this.readVarint()+this.pos,ie=this.pos;return this.pos=J,J-ie>=12&&_?function(ce,me,Ce){return _.decode(ce.subarray(me,Ce))}(this.buf,ie,J):function(ce,me,Ce){for(var Ae="",Ee=me;Ee<Ce;){var Ue,Ie,Ve,Ze=ce[Ee],qe=null,Ke=Ze>239?4:Ze>223?3:Ze>191?2:1;if(Ee+Ke>Ce)break;Ke===1?Ze<128&&(qe=Ze):Ke===2?(192&(Ue=ce[Ee+1]))==128&&(qe=(31&Ze)<<6|63&Ue)<=127&&(qe=null):Ke===3?(Ie=ce[Ee+2],(192&(Ue=ce[Ee+1]))==128&&(192&Ie)==128&&((qe=(15&Ze)<<12|(63&Ue)<<6|63&Ie)<=2047||qe>=55296&&qe<=57343)&&(qe=null)):Ke===4&&(Ie=ce[Ee+2],Ve=ce[Ee+3],(192&(Ue=ce[Ee+1]))==128&&(192&Ie)==128&&(192&Ve)==128&&((qe=(15&Ze)<<18|(63&Ue)<<12|(63&Ie)<<6|63&Ve)<=65535||qe>=1114112)&&(qe=null)),qe===null?(qe=65533,Ke=1):qe>65535&&(qe-=65536,Ae+=String.fromCharCode(qe>>>10&1023|55296),qe=56320|1023&qe),Ae+=String.fromCharCode(qe),Ee+=Ke}return Ae}(this.buf,ie,J)},readBytes:function(){var J=this.readVarint()+this.pos,ie=this.buf.subarray(this.pos,J);return this.pos=J,ie},readPackedVarint:function(J,ie){if(this.type!==n.Bytes)return J.push(this.readVarint(ie));var ce=d(this);for(J=J||[];this.pos<ce;)J.push(this.readVarint(ie));return J},readPackedSVarint:function(J){if(this.type!==n.Bytes)return J.push(this.readSVarint());var ie=d(this);for(J=J||[];this.pos<ie;)J.push(this.readSVarint());return J},readPackedBoolean:function(J){if(this.type!==n.Bytes)return J.push(this.readBoolean());var ie=d(this);for(J=J||[];this.pos<ie;)J.push(this.readBoolean());return J},readPackedFloat:function(J){if(this.type!==n.Bytes)return J.push(this.readFloat());var ie=d(this);for(J=J||[];this.pos<ie;)J.push(this.readFloat());return J},readPackedDouble:function(J){if(this.type!==n.Bytes)return J.push(this.readDouble());var ie=d(this);for(J=J||[];this.pos<ie;)J.push(this.readDouble());return J},readPackedFixed32:function(J){if(this.type!==n.Bytes)return J.push(this.readFixed32());var ie=d(this);for(J=J||[];this.pos<ie;)J.push(this.readFixed32());return J},readPackedSFixed32:function(J){if(this.type!==n.Bytes)return J.push(this.readSFixed32());var ie=d(this);for(J=J||[];this.pos<ie;)J.push(this.readSFixed32());return J},readPackedFixed64:function(J){if(this.type!==n.Bytes)return J.push(this.readFixed64());var ie=d(this);for(J=J||[];this.pos<ie;)J.push(this.readFixed64());return J},readPackedSFixed64:function(J){if(this.type!==n.Bytes)return J.push(this.readSFixed64());var ie=d(this);for(J=J||[];this.pos<ie;)J.push(this.readSFixed64());return J},skip:function(J){var ie=7&J;if(ie===n.Varint)for(;this.buf[this.pos++]>127;);else if(ie===n.Bytes)this.pos=this.readVarint()+this.pos;else if(ie===n.Fixed32)this.pos+=4;else{if(ie!==n.Fixed64)throw new Error("Unimplemented type: "+ie);this.pos+=8}},writeTag:function(J,ie){this.writeVarint(J<<3|ie)},realloc:function(J){for(var ie=this.length||16;ie<this.pos+J;)ie*=2;if(ie!==this.length){var ce=new Uint8Array(ie);ce.set(this.buf),this.buf=ce,this.length=ie}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(J){this.realloc(4),te(this.buf,J,this.pos),this.pos+=4},writeSFixed32:function(J){this.realloc(4),te(this.buf,J,this.pos),this.pos+=4},writeFixed64:function(J){this.realloc(8),te(this.buf,-1&J,this.pos),te(this.buf,Math.floor(J*u),this.pos+4),this.pos+=8},writeSFixed64:function(J){this.realloc(8),te(this.buf,-1&J,this.pos),te(this.buf,Math.floor(J*u),this.pos+4),this.pos+=8},writeVarint:function(J){(J=+J||0)>268435455||J<0?function(ie,ce){var me,Ce;if(ie>=0?(me=ie%4294967296|0,Ce=ie/4294967296|0):(Ce=~(-ie/4294967296),4294967295^(me=~(-ie%4294967296))?me=me+1|0:(me=0,Ce=Ce+1|0)),ie>=18446744073709552e3||ie<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");ce.realloc(10),function(Ae,Ee,Ue){Ue.buf[Ue.pos++]=127&Ae|128,Ae>>>=7,Ue.buf[Ue.pos++]=127&Ae|128,Ae>>>=7,Ue.buf[Ue.pos++]=127&Ae|128,Ae>>>=7,Ue.buf[Ue.pos++]=127&Ae|128,Ue.buf[Ue.pos]=127&(Ae>>>=7)}(me,0,ce),function(Ae,Ee){var Ue=(7&Ae)<<4;Ee.buf[Ee.pos++]|=Ue|((Ae>>>=3)?128:0),Ae&&(Ee.buf[Ee.pos++]=127&Ae|((Ae>>>=7)?128:0),Ae&&(Ee.buf[Ee.pos++]=127&Ae|((Ae>>>=7)?128:0),Ae&&(Ee.buf[Ee.pos++]=127&Ae|((Ae>>>=7)?128:0),Ae&&(Ee.buf[Ee.pos++]=127&Ae|((Ae>>>=7)?128:0),Ae&&(Ee.buf[Ee.pos++]=127&Ae)))))}(Ce,ce)}(J,this):(this.realloc(4),this.buf[this.pos++]=127&J|(J>127?128:0),J<=127||(this.buf[this.pos++]=127&(J>>>=7)|(J>127?128:0),J<=127||(this.buf[this.pos++]=127&(J>>>=7)|(J>127?128:0),J<=127||(this.buf[this.pos++]=J>>>7&127))))},writeSVarint:function(J){this.writeVarint(J<0?2*-J-1:2*J)},writeBoolean:function(J){this.writeVarint(!!J)},writeString:function(J){J=String(J),this.realloc(4*J.length),this.pos++;var ie=this.pos;this.pos=function(me,Ce,Ae){for(var Ee,Ue,Ie=0;Ie<Ce.length;Ie++){if((Ee=Ce.charCodeAt(Ie))>55295&&Ee<57344){if(!Ue){Ee>56319||Ie+1===Ce.length?(me[Ae++]=239,me[Ae++]=191,me[Ae++]=189):Ue=Ee;continue}if(Ee<56320){me[Ae++]=239,me[Ae++]=191,me[Ae++]=189,Ue=Ee;continue}Ee=Ue-55296<<10|Ee-56320|65536,Ue=null}else Ue&&(me[Ae++]=239,me[Ae++]=191,me[Ae++]=189,Ue=null);Ee<128?me[Ae++]=Ee:(Ee<2048?me[Ae++]=Ee>>6|192:(Ee<65536?me[Ae++]=Ee>>12|224:(me[Ae++]=Ee>>18|240,me[Ae++]=Ee>>12&63|128),me[Ae++]=Ee>>6&63|128),me[Ae++]=63&Ee|128)}return Ae}(this.buf,J,this.pos);var ce=this.pos-ie;ce>=128&&E(ie,ce,this),this.pos=ie-1,this.writeVarint(ce),this.pos+=ce},writeFloat:function(J){this.realloc(4),c.write(this.buf,J,this.pos,!0,23,4),this.pos+=4},writeDouble:function(J){this.realloc(8),c.write(this.buf,J,this.pos,!0,52,8),this.pos+=8},writeBytes:function(J){var ie=J.length;this.writeVarint(ie),this.realloc(ie);for(var ce=0;ce<ie;ce++)this.buf[this.pos++]=J[ce]},writeRawMessage:function(J,ie){this.pos++;var ce=this.pos;J(ie,this);var me=this.pos-ce;me>=128&&E(ce,me,this),this.pos=ce-1,this.writeVarint(me),this.pos+=me},writeMessage:function(J,ie,ce){this.writeTag(J,n.Bytes),this.writeRawMessage(ie,ce)},writePackedVarint:function(J,ie){ie.length&&this.writeMessage(J,M,ie)},writePackedSVarint:function(J,ie){ie.length&&this.writeMessage(J,k,ie)},writePackedBoolean:function(J,ie){ie.length&&this.writeMessage(J,D,ie)},writePackedFloat:function(J,ie){ie.length&&this.writeMessage(J,w,ie)},writePackedDouble:function(J,ie){ie.length&&this.writeMessage(J,I,ie)},writePackedFixed32:function(J,ie){ie.length&&this.writeMessage(J,C,ie)},writePackedSFixed32:function(J,ie){ie.length&&this.writeMessage(J,P,ie)},writePackedFixed64:function(J,ie){ie.length&&this.writeMessage(J,B,ie)},writePackedSFixed64:function(J,ie){ie.length&&this.writeMessage(J,q,ie)},writeBytesField:function(J,ie){this.writeTag(J,n.Bytes),this.writeBytes(ie)},writeFixed32Field:function(J,ie){this.writeTag(J,n.Fixed32),this.writeFixed32(ie)},writeSFixed32Field:function(J,ie){this.writeTag(J,n.Fixed32),this.writeSFixed32(ie)},writeFixed64Field:function(J,ie){this.writeTag(J,n.Fixed64),this.writeFixed64(ie)},writeSFixed64Field:function(J,ie){this.writeTag(J,n.Fixed64),this.writeSFixed64(ie)},writeVarintField:function(J,ie){this.writeTag(J,n.Varint),this.writeVarint(ie)},writeSVarintField:function(J,ie){this.writeTag(J,n.Varint),this.writeSVarint(ie)},writeStringField:function(J,ie){this.writeTag(J,n.Bytes),this.writeString(ie)},writeFloatField:function(J,ie){this.writeTag(J,n.Fixed32),this.writeFloat(ie)},writeDoubleField:function(J,ie){this.writeTag(J,n.Fixed64),this.writeDouble(ie)},writeBooleanField:function(J,ie){this.writeVarintField(J,!!ie)}},Op}var g=O(h());const T=3;function L(c,n,o){n.glyphs=[],c===1&&o.readMessage(V,n)}function V(c,n,o){if(c===3){const{id:u,bitmap:_,width:d,height:y,left:E,top:M,advance:k}=o.readMessage(Q,{});n.glyphs.push({id:u,bitmap:new Du({width:d+2*T,height:y+2*T},_),metrics:{width:d,height:y,left:E,top:M,advance:k}})}else c===4?n.ascender=o.readSVarint():c===5&&(n.descender=o.readSVarint())}function Q(c,n,o){c===1?n.id=o.readVarint():c===2?n.bitmap=o.readBytes():c===3?n.width=o.readVarint():c===4?n.height=o.readVarint():c===5?n.left=o.readSVarint():c===6?n.top=o.readSVarint():c===7&&(n.advance=o.readVarint())}const be=T,Be={horizontal:1,vertical:2,horizontalOnly:3};class rt{constructor(){this.scale=1,this.fontStack="",this.image=null}static forText(n,o){const u=new rt;return u.scale=n||1,u.fontStack=o,u}static forImage(n){const o=new rt;return o.image=n,o}}class Tt{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(n,o){const u=new Tt;for(let _=0;_<n.sections.length;_++){const d=n.sections[_];d.image?u.addImageSection(d):u.addTextSection(d,o)}return u}length(){return this.text.length}getSection(n){return this.sections[this.sectionIndex[n]]}getSections(){return this.sections}getSectionIndex(n){return this.sectionIndex[n]}getCodePoint(n){return this.text.codePointAt(n)}verticalizePunctuation(n){this.text=function(o,u){let _="";for(let d=0;d<o.length;d++){const y=o.charCodeAt(d+1)||null,E=o.charCodeAt(d-1)||null;_+=!u&&(y&&Ll(y)&&!Gh[o[d+1]]||E&&Ll(E)&&!Gh[o[d-1]])||!Gh[o[d]]?o[d]:Gh[o[d]]}return _}(this.text,n)}trim(){let n=0;for(let u=0;u<this.text.length&&mn[this.text.charCodeAt(u)];u++)n++;let o=this.text.length;for(let u=this.text.length-1;u>=0&&u>=n&&mn[this.text.charCodeAt(u)];u--)o--;this.text=this.text.substring(n,o),this.sectionIndex=this.sectionIndex.slice(n,o)}substring(n,o){const u=new Tt;return u.text=this.text.substring(n,o),u.sectionIndex=this.sectionIndex.slice(n,o),u.sections=this.sections,u}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((n,o)=>Math.max(n,this.sections[o].scale),0)}addTextSection(n,o){this.text+=n.text,this.sections.push(rt.forText(n.scale,n.fontStack||o));const u=this.sections.length-1;for(let _=0;_<n.text.length;++_)this.sectionIndex.push(u)}addImageSection(n){const o=n.image&&n.image.namePrimary?n.image.getPrimary():null;if(!o)return void qn("Can't add FormattedSection with an empty image.");const u=this.getNextImageSectionCharCode();u?(this.text+=String.fromCodePoint(u),this.sections.push(rt.forImage(o)),this.sectionIndex.push(this.sections.length-1)):qn("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function en(c,n,o,u,_,d,y,E,M,k,w,I,D,C,P){const B=Tt.fromFeature(c,_);I===Be.vertical&&B.verticalizePunctuation(D);let q=[];const H=function(ce,me,Ce,Ae,Ee,Ue){if(!ce)return[];const Ie=[],Ve=function(Qe,at,Je,wt,Rt,bt){let an=0;for(let Jt=0;Jt<Qe.length();Jt++){const Ut=Qe.getSection(Jt);an+=Qt(Qe.getCodePoint(Jt),Ut,wt,Rt,at,bt)}return an/Math.max(1,Math.ceil(an/Je))}(ce,me,Ce,Ae,Ee,Ue),Ze=ce.text.indexOf("​")>=0;let qe=0;for(let Qe=0;Qe<ce.length();Qe++){const at=ce.getSection(Qe),Je=ce.getCodePoint(Qe);if(mn[Je]||(qe+=Qt(Je,at,Ae,Ee,me,Ue)),Qe<ce.length()-1){const wt=!((Ke=Je)<11904||!(Yt["Bopomofo Extended"](Ke)||Yt.Bopomofo(Ke)||Yt["CJK Compatibility Forms"](Ke)||Yt["CJK Compatibility Ideographs"](Ke)||Yt["CJK Compatibility"](Ke)||Yt["CJK Radicals Supplement"](Ke)||Yt["CJK Strokes"](Ke)||Yt["CJK Symbols and Punctuation"](Ke)||Yt["CJK Unified Ideographs Extension A"](Ke)||Yt["CJK Unified Ideographs"](Ke)||Yt["Enclosed CJK Letters and Months"](Ke)||Yt["Halfwidth and Fullwidth Forms"](Ke)||Yt.Hiragana(Ke)||Yt["Ideographic Description Characters"](Ke)||Yt["Kangxi Radicals"](Ke)||Yt["Katakana Phonetic Extensions"](Ke)||Yt.Katakana(Ke)||Yt["Vertical Forms"](Ke)||Yt["Yi Radicals"](Ke)||Yt["Yi Syllables"](Ke)));(jt[Je]||wt||at.image)&&Ie.push(Yi(Qe+1,qe,Ve,Ie,Er(Je,ce.getCodePoint(Qe+1),wt&&Ze),!1))}}var Ke;return Mt(Yi(ce.length(),qe,Ve,Ie,0,!0))}(B,k,d,n,u,C),{processBidirectionalText:te,processStyledBidirectionalText:re}=Yr;if(te&&B.sections.length===1){const ce=te(B.toString(),H);for(const me of ce){const Ce=new Tt;Ce.text=me,Ce.sections=B.sections;for(let Ae=0;Ae<me.length;Ae++)Ce.sectionIndex.push(0);q.push(Ce)}}else if(re){const ce=re(B.text,B.sectionIndex,H);for(const me of ce){const Ce=new Tt;Ce.text=me[0],Ce.sectionIndex=me[1],Ce.sections=B.sections,q.push(Ce)}}else q=function(ce,me){const Ce=[],Ae=ce.text;let Ee=0;for(const Ue of me)Ce.push(ce.substring(Ee,Ue)),Ee=Ue;return Ee<Ae.length&&Ce.push(ce.substring(Ee,Ae.length)),Ce}(B,H);const J=[],ie={positionedLines:J,text:B.toString(),top:w[1],bottom:w[1],left:w[0],right:w[0],writingMode:I,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(ce,me,Ce,Ae,Ee,Ue,Ie,Ve,Ze,qe,Ke,Qe){let at=0,Je=0,wt=0;const Rt=Ve==="right"?1:Ve==="left"?0:.5;let bt=!1;for(const ln of Ee){const pn=ln.getSections();for(const kn of pn){if(kn.image)continue;const Gn=me[kn.fontStack];if(Gn&&(bt=Gn.ascender!==void 0&&Gn.descender!==void 0,!bt))break}if(!bt)break}let an=0;for(const ln of Ee){ln.trim();const pn=ln.getMaxScale(),kn=(pn-1)*Ba,Gn={positionedGlyphs:[],lineOffset:0};ce.positionedLines[an]=Gn;const Zn=Gn.positionedGlyphs;let Wn=0;if(!ln.length()){Je+=Ue,++an;continue}let lr=0,ur=0;for(let Lr=0;Lr<ln.length();Lr++){const jn=ln.getSection(Lr),Pr=ln.getSectionIndex(Lr),Rr=ln.getCodePoint(Lr);let ri=jn.scale,Bi=null,Ji=null,Ni=null,Oi=Ba,Gi=0;const aa=!(Ze===Be.horizontal||!Ke&&!Dl(Rr)||Ke&&(mn[Rr]||(Jt=Rr,Yt.Arabic(Jt)||Yt["Arabic Supplement"](Jt)||Yt["Arabic Extended-A"](Jt)||Yt["Arabic Presentation Forms-A"](Jt)||Yt["Arabic Presentation Forms-B"](Jt))));if(jn.image){const mo=Ae[jn.image.serialize()];if(!mo)continue;Ni=jn.image.id,ce.iconsInText=ce.iconsInText||!0,Ji=mo.paddedRect;const Qr=mo.displaySize;ri=ri*Ba/Qe,Bi={width:Qr[0],height:Qr[1],left:0,top:-3,advance:aa?Qr[1]:Qr[0],localGlyph:!1},Gi=bt?-Bi.height*ri:pn*Ba-17-Qr[1]*ri,Oi=Bi.advance;const Vs=(aa?Qr[0]:Qr[1])*ri-Ba*pn;Vs>0&&Vs>Wn&&(Wn=Vs)}else{const mo=Ce[jn.fontStack];if(!mo)continue;mo[Rr]&&(Ji=mo[Rr]);const Qr=me[jn.fontStack];if(!Qr)continue;const Vs=Qr.glyphs[Rr];if(!Vs)continue;if(Bi=Vs.metrics,Oi=Rr!==8203?Ba:0,bt){const ju=Qr.ascender!==void 0?Math.abs(Qr.ascender):0,$c=Qr.descender!==void 0?Math.abs(Qr.descender):0,qc=(ju+$c)*ri;lr<qc&&(lr=qc,ur=(ju-$c)/2*ri),Gi=-ju*ri}else Gi=(pn-ri)*Ba-17}aa?(ce.verticalizable=!0,Zn.push({glyph:Rr,imageName:Ni,x:at,y:Je+Gi,vertical:aa,scale:ri,localGlyph:Bi.localGlyph,fontStack:jn.fontStack,sectionIndex:Pr,metrics:Bi,rect:Ji}),at+=Oi*ri+qe):(Zn.push({glyph:Rr,imageName:Ni,x:at,y:Je+Gi,vertical:aa,scale:ri,localGlyph:Bi.localGlyph,fontStack:jn.fontStack,sectionIndex:Pr,metrics:Bi,rect:Ji}),at+=Bi.advance*ri+qe)}Zn.length!==0&&(wt=Math.max(at-qe,wt),bt?Dt(Zn,Rt,Wn,ur,Ue*pn/2):Dt(Zn,Rt,Wn,0,Ue/2)),at=0;const Zr=Ue*pn+Wn;Gn.lineOffset=Math.max(Wn,kn),Je+=Zr,++an}var Jt;const Ut=Je,{horizontalAlign:zt,verticalAlign:vn}=xt(Ie);(function(ln,pn,kn,Gn,Zn,Wn){const lr=(pn-kn)*Zn,ur=-Wn*Gn;for(const Zr of ln)for(const Lr of Zr.positionedGlyphs)Lr.x+=lr,Lr.y+=ur})(ce.positionedLines,Rt,zt,vn,wt,Ut),ce.top+=-vn*Ut,ce.bottom=ce.top+Ut,ce.left+=-zt*wt,ce.right=ce.left+wt,ce.hasBaseline=bt}(ie,n,o,u,q,y,E,M,I,k,D,P),!function(ce){for(const me of ce)if(me.positionedGlyphs.length!==0)return!1;return!0}(J)&&ie}const mn={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},jt={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function Qt(c,n,o,u,_,d){if(n.image){const y=u[n.image.serialize()];return y?y.displaySize[0]*n.scale*Ba/d+_:0}{const y=o[n.fontStack],E=y&&y.glyphs[c];return E?E.metrics.advance*n.scale+_:0}}function Hn(c,n,o,u){const _=Math.pow(c-n,2);return u?c<n?_/2:2*_:_+Math.abs(o)*o}function Er(c,n,o){let u=0;return c===10&&(u-=1e4),o&&(u+=150),c!==40&&c!==65288||(u+=50),n!==41&&n!==65289||(u+=50),u}function Yi(c,n,o,u,_,d){let y=null,E=Hn(n,o,_,d);for(const M of u){const k=Hn(n-M.x,o,_,d)+M.badness;k<=E&&(y=M,E=k)}return{index:c,x:n,priorBreak:y,badness:E}}function Mt(c){return c?Mt(c.priorBreak).concat(c.index):[]}function xt(c){let n=.5,o=.5;switch(c){case"right":case"top-right":case"bottom-right":n=1;break;case"left":case"top-left":case"bottom-left":n=0}switch(c){case"bottom":case"bottom-right":case"bottom-left":o=1;break;case"top":case"top-right":case"top-left":o=0}return{horizontalAlign:n,verticalAlign:o}}function Dt(c,n,o,u,_){if(!(n||o||u||_))return;const d=c.length-1,y=c[d],E=(y.x+y.metrics.advance*y.scale)*n;for(let M=0;M<=d;M++)c[M].x-=E,c[M].y+=o+u+_}function un(c,n,o,u){const{horizontalAlign:_,verticalAlign:d}=xt(u),y=o[0]-c.displaySize[0]*_,E=o[1]-c.displaySize[1]*d;return{imagePrimary:c,imageSecondary:n,top:E,bottom:E+c.displaySize[1],left:y,right:y+c.displaySize[0]}}function Un(c,n,o,u,_,d){const y=c.imagePrimary;let E;if(y.content){const q=y.content,H=y.pixelRatio||1;E=[q[0]/H,q[1]/H,y.displaySize[0]-q[2]/H,y.displaySize[1]-q[3]/H]}const M=n.left*d,k=n.right*d;let w,I,D,C;o==="width"||o==="both"?(C=_[0]+M-u[3],I=_[0]+k+u[1]):(C=_[0]+(M+k-y.displaySize[0])/2,I=C+y.displaySize[0]);const P=n.top*d,B=n.bottom*d;return o==="height"||o==="both"?(w=_[1]+P-u[0],D=_[1]+B+u[2]):(w=_[1]+(P+B-y.displaySize[1])/2,D=w+y.displaySize[1]),{imagePrimary:y,imageSecondary:void 0,top:w,right:I,bottom:D,left:C,collisionPadding:E}}class wr extends It{constructor(n,o,u,_,d){super(n,o),this.angle=_,this.z=u,d!==void 0&&(this.segment=d)}clone(){return new wr(this.x,this.y,this.z,this.angle,this.segment)}}function nr(c,n,o,u,_){if(n.segment===void 0)return!0;let d=n,y=n.segment+1,E=0;for(;E>-o/2;){if(y--,y<0)return!1;E-=c[y].dist(d),d=c[y]}E+=c[y].dist(c[y+1]),y++;const M=[];let k=0;for(;E<o/2;){const w=c[y],I=c[y+1];if(!I)return!1;let D=c[y-1].angleTo(w)-w.angleTo(I);for(D=Math.abs((D+3*Math.PI)%(2*Math.PI)-Math.PI),M.push({distance:E,angleDelta:D}),k+=D;E-M[0].distance>u;)k-=M.shift().angleDelta;if(k>_)return!1;y++,E+=w.dist(I)}return!0}function fr(c){let n=0;for(let o=0;o<c.length-1;o++)n+=c[o].dist(c[o+1]);return n}function Wa(c,n,o){return c?.6*n*o:0}function Jr(c,n){return Math.max(c?c.right-c.left:0,n?n.right-n.left:0)}function Hh(c,n,o,u,_,d){const y=Wa(o,_,d),E=Jr(o,u)*d;let M=0;const k=fr(c)/2;for(let w=0;w<c.length-1;w++){const I=c[w],D=c[w+1],C=I.dist(D);if(M+C>k){const P=(k-M)/C,B=Mn(I.x,D.x,P),q=Mn(I.y,D.y,P),H=new wr(B,q,0,D.angleTo(I),w);return!y||nr(c,H,E,y,n)?H:void 0}M+=C}}function tS(c,n,o,u,_,d,y,E,M){const k=Wa(u,d,y),w=Jr(u,_),I=w*y,D=c[0].x===0||c[0].x===M||c[0].y===0||c[0].y===M;return n-I<n/4&&(n=I+n/4),$4(c,D?n/2*E%n:(w/2+2*d)*y*E%n,n,k,o,I,D,!1,M)}function $4(c,n,o,u,_,d,y,E,M){const k=d/2,w=fr(c);let I=0,D=n-o,C=[];for(let P=0;P<c.length-1;P++){const B=c[P],q=c[P+1],H=B.dist(q),te=q.angleTo(B);for(;D+o<I+H;){D+=o;const re=(D-I)/H,J=Mn(B.x,q.x,re),ie=Mn(B.y,q.y,re);if(J>=0&&J<M&&ie>=0&&ie<M&&D-k>=0&&D+k<=w){const ce=new wr(J,ie,0,te,P);u&&!nr(c,ce,d,u,_)||C.push(ce)}}I+=H}return E||C.length||y||(C=$4(c,I/2,o,u,_,d,y,!0,M)),C}function q4(c,n,o,u,_){const d=[];for(let y=0;y<c.length;y++){const E=c[y];let M;for(let k=0;k<E.length-1;k++){let w=E[k],I=E[k+1];w.x<n&&I.x<n||(w.x<n?w=new It(n,w.y+(n-w.x)/(I.x-w.x)*(I.y-w.y))._round():I.x<n&&(I=new It(n,w.y+(n-w.x)/(I.x-w.x)*(I.y-w.y))._round()),w.y<o&&I.y<o||(w.y<o?w=new It(w.x+(o-w.y)/(I.y-w.y)*(I.x-w.x),o)._round():I.y<o&&(I=new It(w.x+(o-w.y)/(I.y-w.y)*(I.x-w.x),o)._round()),w.x>=u&&I.x>=u||(w.x>=u?w=new It(u,w.y+(u-w.x)/(I.x-w.x)*(I.y-w.y))._round():I.x>=u&&(I=new It(u,w.y+(u-w.x)/(I.x-w.x)*(I.y-w.y))._round()),w.y>=_&&I.y>=_||(w.y>=_?w=new It(w.x+(_-w.y)/(I.y-w.y)*(I.x-w.x),_)._round():I.y>=_&&(I=new It(w.x+(_-w.y)/(I.y-w.y)*(I.x-w.x),_)._round()),M&&w.equals(M[M.length-1])||(M=[w],d.push(M)),M.push(I)))))}}return d}function G4(c){let n=0,o=0;for(const y of c)n+=y.w*y.h,o=Math.max(o,y.w);c.sort((y,E)=>E.h-y.h);const u=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(n/.95)),o),h:1/0}];let _=0,d=0;for(const y of c)for(let E=u.length-1;E>=0;E--){const M=u[E];if(!(y.w>M.w||y.h>M.h)){if(y.x=M.x,y.y=M.y,d=Math.max(d,y.y+y.h),_=Math.max(_,y.x+y.w),y.w===M.w&&y.h===M.h){const k=u.pop();E<u.length&&(u[E]=k)}else y.h===M.h?(M.x+=y.w,M.w-=y.w):y.w===M.w?(M.y+=y.h,M.h-=y.h):(u.push({x:M.x+y.w,y:M.y,w:M.w-y.w,h:y.h}),M.y+=y.h,M.h-=y.h);break}}return{w:_,h:d,fill:n/(_*d)||0}}hn(wr,"Anchor");const Ay=1;class Cy{static getImagePositionScale(n,o,u){return o&&n&&n.options&&n.options.transform?{x:n.options.transform.a,y:n.options.transform.d}:{x:u,y:u}}constructor(n,{pixelRatio:o,version:u,stretchX:_,stretchY:d,content:y,sdf:E,usvg:M},k,w){this.paddedRect=n,this.pixelRatio=o,this.stretchX=_,this.stretchY=d,this.content=y,this.version=u,this.padding=k,this.sdf=E,this.scale=Cy.getImagePositionScale(w,M,o)}get tl(){return[this.paddedRect.x+this.padding,this.paddedRect.y+this.padding]}get br(){return[this.paddedRect.x+this.paddedRect.w-this.padding,this.paddedRect.y+this.paddedRect.h-this.padding]}get displaySize(){return[(this.paddedRect.w-2*this.padding)/this.scale.x,(this.paddedRect.h-2*this.padding)/this.scale.y]}}class H4{constructor(n,o,u){const _={},d={};this.haveRenderCallbacks=[];const y=[];this.addImages(n,_,Ay,y),this.addImages(o,d,2,y);const{w:E,h:M}=G4(y),k=new Ta({width:E||1,height:M||1});for(const w in n){const I=n[w],D=_[w].paddedRect;Ta.copy(I.data,k,{x:0,y:0},{x:D.x+Ay,y:D.y+Ay},I.data,u,I.sdf)}for(const w in o){const I=o[w],D=d[w].paddedRect;let C=d[w].padding;const P=D.x+C,B=D.y+C,q=I.data.width,H=I.data.height;C=C>1?C-1:C,Ta.copy(I.data,k,{x:0,y:0},{x:P,y:B},I.data,u),Ta.copy(I.data,k,{x:0,y:H-C},{x:P,y:B-C},{width:q,height:C},u),Ta.copy(I.data,k,{x:0,y:0},{x:P,y:B+H},{width:q,height:C},u),Ta.copy(I.data,k,{x:q-C,y:0},{x:P-C,y:B},{width:C,height:H},u),Ta.copy(I.data,k,{x:0,y:0},{x:P+q,y:B},{width:C,height:H},u),Ta.copy(I.data,k,{x:q-C,y:H-C},{x:P-C,y:B-C},{width:C,height:C},u),Ta.copy(I.data,k,{x:0,y:H-C},{x:P+q,y:B-C},{width:C,height:C},u),Ta.copy(I.data,k,{x:0,y:0},{x:P+q,y:B+H},{width:C,height:C},u),Ta.copy(I.data,k,{x:q-C,y:0},{x:P-C,y:B+H},{width:C,height:C},u)}this.lut=u,this.image=k,this.iconPositions=_,this.patternPositions=d}addImages(n,o,u,_){for(const d in n){const y=n[d],E={x:0,y:0,w:y.data.width+2*u,h:y.data.height+2*u};_.push(E);const M=Ms.deserializeFromString(d);o[d]=new Cy(E,y,u,M),y.hasRenderCallback&&this.haveRenderCallbacks.push(M.id)}}patchUpdatedImages(n,o,u){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(_=>n.hasImage(_,u)),n.dispatchRenderCallbacks(this.haveRenderCallbacks,u);for(const _ in n.getUpdatedImages(u)){for(const d of Object.keys(this.iconPositions))Ms.deserializeId(d)===_&&this.patchUpdatedImage(this.iconPositions[d],n.getImage(_,u),o);for(const d of Object.keys(this.patternPositions))Ms.deserializeId(d)===_&&this.patchUpdatedImage(this.patternPositions[d],n.getImage(_,u),o)}}patchUpdatedImage(n,o,u){if(!n||!o||n.version===o.version)return;n.version=o.version;const[_,d]=n.tl,y=n.sdf;if(this.lut||y){const E={width:o.data.width,height:o.data.height},M=new Ta(E);Ta.copy(o.data,M,{x:0,y:0},{x:0,y:0},E,this.lut,y),u.update(M,{position:{x:_,y:d}})}else u.update(o.data,{position:{x:_,y:d}})}}hn(Cy,"ImagePosition"),hn(H4,"ImageAtlas");const d2=1e20;function Z4(c,n,o,u,_,d,y,E,M){for(let k=n;k<n+u;k++)W4(c,o*d+k,d,_,y,E,M);for(let k=o;k<o+_;k++)W4(c,k*d+n,1,u,y,E,M)}function W4(c,n,o,u,_,d,y){d[0]=0,y[0]=-1e20,y[1]=d2,_[0]=c[n];for(let E=1,M=0,k=0;E<u;E++){_[E]=c[n+E*o];const w=E*E;do{const I=d[M];k=(_[E]-_[I]+w-I*I)/(E-I)/2}while(k<=y[M]&&--M>-1);M++,d[M]=E,y[M]=k,y[M+1]=d2}for(let E=0,M=0;E<u;E++){for(;y[M+1]<E;)M++;const k=d[M],w=E-k;c[n+E*o]=_[k]+w*w}}const ku=2,nS={none:0,ideographs:1,all:2};class b_{constructor(n,o,u){this.requestManager=n,this.localGlyphMode=o,this.localFontFamily=u,this.urls={},this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(n,o){this.urls[o]=n}getGlyphs(n,o,u){const _=[],d=this.urls[o]||vi.GLYPHS_URL;for(const y in n)for(const E of n[y])_.push({stack:y,id:E});ml(_,({stack:y,id:E},M)=>{let k=this.entries[y];k||(k=this.entries[y]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let w=k.glyphs[E];if(w!==void 0)return void M(null,{stack:y,id:E,glyph:w});if(w=this._tinySDF(k,y,E),w)return k.glyphs[E]=w,void M(null,{stack:y,id:E,glyph:w});const I=Math.floor(E/256);if(256*I>65535)return qn("glyphs > 65535 not supported"),void M(null,{stack:y,id:E,glyph:w});if(k.ranges[I])return void M(null,{stack:y,id:E,glyph:w});let D=k.requests[I];D||(D=k.requests[I]=[],b_.loadGlyphRange(y,I,d,this.requestManager,(C,P)=>{if(P){k.ascender=P.ascender,k.descender=P.descender;for(const B in P.glyphs)this._doesCharSupportLocalGlyph(+B)||(k.glyphs[+B]=P.glyphs[+B]);k.ranges[I]=!0}for(const B of D)B(C,P);delete k.requests[I]})),D.push((C,P)=>{C?M(C):P&&M(null,{stack:y,id:E,glyph:P.glyphs[E]||null})})},(y,E)=>{if(y)u(y);else if(E){const M={};for(const{stack:k,id:w,glyph:I}of E)M[k]===void 0&&(M[k]={}),M[k].glyphs===void 0&&(M[k].glyphs={}),M[k].glyphs[w]=I&&{id:I.id,bitmap:I.bitmap.clone(),metrics:I.metrics},M[k].ascender=this.entries[k].ascender,M[k].descender=this.entries[k].descender;u(null,M)}})}_doesCharSupportLocalGlyph(n){return this.localGlyphMode!==nS.none&&(this.localGlyphMode===nS.all?!!this.localFontFamily:!!this.localFontFamily&&(Yt["CJK Unified Ideographs"](n)||Yt["Hangul Syllables"](n)||Yt.Hiragana(n)||Yt.Katakana(n)||Yt["CJK Symbols and Punctuation"](n)||Yt["CJK Unified Ideographs Extension A"](n)||Yt["CJK Unified Ideographs Extension B"](n)||Yt.Osage(n)))}_tinySDF(n,o,u){const _=this.localFontFamily;if(!_||!this._doesCharSupportLocalGlyph(u))return;let d=n.tinySDF;if(!d){let B="400";/bold/i.test(o)?B="900":/medium/i.test(o)?B="500":/light/i.test(o)&&(B="200"),d=n.tinySDF=new b_.TinySDF({fontFamily:_,fontWeight:B,fontSize:24*ku,buffer:3*ku,radius:8*ku}),d.fontWeight=B}if(this.localGlyphs[d.fontWeight][u])return this.localGlyphs[d.fontWeight][u];const y=String.fromCodePoint(u),{data:E,width:M,height:k,glyphWidth:w,glyphHeight:I,glyphLeft:D,glyphTop:C,glyphAdvance:P}=d.draw(y);return this.localGlyphs[d.fontWeight][u]={id:u,bitmap:new Du({width:M,height:k},E),metrics:{width:w/ku,height:I/ku,left:D/ku,top:C/ku-27,advance:P/ku,localGlyph:!0}}}}b_.loadGlyphRange=function(c,n,o,u,_){const d=256*n,y=d+255,E=u.transformRequest(u.normalizeGlyphsURL(o).replace("{fontstack}",c).replace("{range}",`${d}-${y}`),vr.Glyphs);ii(E,(M,k)=>{if(M)_(M);else if(k){const w={},I=function(D){return new g(D).readFields(L,{})}(k);for(const D of I.glyphs)w[D.id]=D;_(null,{glyphs:w,ascender:I.ascender,descender:I.descender})}})},b_.TinySDF=class{constructor({fontSize:c=24,buffer:n=3,radius:o=8,cutoff:u=.25,fontFamily:_="sans-serif",fontWeight:d="normal",fontStyle:y="normal"}={}){this.buffer=n,this.cutoff=u,this.radius=o;const E=this.size=c+4*n,M=this._createCanvas(E),k=this.ctx=M.getContext("2d",{willReadFrequently:!0});k.font=`${y} ${d} ${c}px ${_}`,k.textBaseline="alphabetic",k.textAlign="left",k.fillStyle="black",this.gridOuter=new Float64Array(E*E),this.gridInner=new Float64Array(E*E),this.f=new Float64Array(E),this.z=new Float64Array(E+1),this.v=new Uint16Array(E)}_createCanvas(c){const n=document.createElement("canvas");return n.width=n.height=c,n}draw(c){const{width:n,actualBoundingBoxAscent:o,actualBoundingBoxDescent:u,actualBoundingBoxLeft:_,actualBoundingBoxRight:d}=this.ctx.measureText(c),y=Math.ceil(o),E=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(d-_))),M=Math.min(this.size-this.buffer,y+Math.ceil(u)),k=E+2*this.buffer,w=M+2*this.buffer,I=Math.max(k*w,0),D=new Uint8ClampedArray(I),C={data:D,width:k,height:w,glyphWidth:E,glyphHeight:M,glyphTop:y,glyphLeft:0,glyphAdvance:n};if(E===0||M===0)return C;const{ctx:P,buffer:B,gridInner:q,gridOuter:H}=this;P.clearRect(B,B,E,M),P.fillText(c,B,B+y);const te=P.getImageData(B,B,E,M);H.fill(d2,0,I),q.fill(0,0,I);for(let re=0;re<M;re++)for(let J=0;J<E;J++){const ie=te.data[4*(re*E+J)+3]/255;if(ie===0)continue;const ce=(re+B)*k+J+B;if(ie===1)H[ce]=0,q[ce]=d2;else{const me=.5-ie;H[ce]=me>0?me*me:0,q[ce]=me<0?me*me:0}}Z4(H,0,0,k,w,k,this.f,this.v,this.z),Z4(q,B,B,E,M,k,this.f,this.v,this.z);for(let re=0;re<I;re++){const J=Math.sqrt(H[re])-Math.sqrt(q[re]);D[re]=Math.round(255-255*(J/this.radius+this.cutoff))}return C}};const Wm=Ay;function X4(c,n){return c+n[1]-n[0]}function Y4(c,n,o,u,_=1){const d=[],y=c.imagePrimary,E=y.pixelRatio,M=y.paddedRect.w-2*Wm,k=y.paddedRect.h-2*Wm,w=(c.right-c.left)*_,I=(c.bottom-c.top)*_,D=y.stretchX||[[0,M]],C=y.stretchY||[[0,k]],P=D.reduce(X4,0),B=C.reduce(X4,0),q=M-P,H=k-B;let te=0,re=P,J=0,ie=B,ce=0,me=q,Ce=0,Ae=H;if(y.content&&u){const Ue=y.content;te=p2(D,0,Ue[0]),J=p2(C,0,Ue[1]),re=p2(D,Ue[0],Ue[2]),ie=p2(C,Ue[1],Ue[3]),ce=Ue[0]-te,Ce=Ue[1]-J,me=Ue[2]-Ue[0]-re,Ae=Ue[3]-Ue[1]-ie}const Ee=(Ue,Ie,Ve,Ze)=>{const qe=m2(Ue.stretch-te,re,w,c.left*_),Ke=_2(Ue.fixed-ce,me,Ue.stretch,P),Qe=m2(Ie.stretch-J,ie,I,c.top*_),at=_2(Ie.fixed-Ce,Ae,Ie.stretch,B),Je=m2(Ve.stretch-te,re,w,c.left*_),wt=_2(Ve.fixed-ce,me,Ve.stretch,P),Rt=m2(Ze.stretch-J,ie,I,c.top*_),bt=_2(Ze.fixed-Ce,Ae,Ze.stretch,B),an=new It(qe,Qe),Jt=new It(Je,Qe),Ut=new It(Je,Rt),zt=new It(qe,Rt),vn=new It(Ke/E,at/E),ln=new It(wt/E,bt/E),pn=n*Math.PI/180;if(pn){const ur=Math.sin(pn),Zr=Math.cos(pn),Lr=[Zr,-ur,ur,Zr];an._matMult(Lr),Jt._matMult(Lr),zt._matMult(Lr),Ut._matMult(Lr)}const kn=Ue.stretch+Ue.fixed,Gn=Ve.stretch+Ve.fixed,Zn=Ie.stretch+Ie.fixed,Wn=Ze.stretch+Ze.fixed,lr=c.imageSecondary;return{tl:an,tr:Jt,bl:zt,br:Ut,texPrimary:{x:y.paddedRect.x+Wm+kn,y:y.paddedRect.y+Wm+Zn,w:Gn-kn,h:Wn-Zn},texSecondary:lr?{x:lr.paddedRect.x+Wm+kn,y:lr.paddedRect.y+Wm+Zn,w:Gn-kn,h:Wn-Zn}:void 0,writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:vn,pixelOffsetBR:ln,minFontScaleX:me/E/w,minFontScaleY:Ae/E/I,isSDF:o}};if(u&&(y.stretchX||y.stretchY)){const Ue=K4(D,q,P),Ie=K4(C,H,B);for(let Ve=0;Ve<Ue.length-1;Ve++){const Ze=Ue[Ve],qe=Ue[Ve+1];for(let Ke=0;Ke<Ie.length-1;Ke++)d.push(Ee(Ze,Ie[Ke],qe,Ie[Ke+1]))}}else d.push(Ee({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:M+1},{fixed:0,stretch:k+1}));return d}function p2(c,n,o){let u=0;for(const _ of c)u+=Math.max(n,Math.min(o,_[1]))-Math.max(n,Math.min(o,_[0]));return u}function K4(c,n,o){const u=[{fixed:-1,stretch:0}];for(const[_,d]of c){const y=u[u.length-1];u.push({fixed:_-y.stretch,stretch:y.stretch}),u.push({fixed:_-y.stretch,stretch:y.stretch+(d-_)})}return u.push({fixed:n+Wm,stretch:o}),u}function m2(c,n,o,u){return c/n*o+u}function _2(c,n,o,u){return c-n*o/u}function QF(c,n,o,u){const _=n+c.positionedLines[u].lineOffset;return u===0?o+_/2:o+(_+(n+c.positionedLines[u-1].lineOffset))/2}function ej(c,n=1,o=!1){let u=1/0,_=1/0,d=-1/0,y=-1/0;const E=c[0];for(let C=0;C<E.length;C++){const P=E[C];(!C||P.x<u)&&(u=P.x),(!C||P.y<_)&&(_=P.y),(!C||P.x>d)&&(d=P.x),(!C||P.y>y)&&(y=P.y)}const M=Math.min(d-u,y-_);let k=M/2;const w=new na([],tj);if(M===0)return new It(u,_);for(let C=u;C<d;C+=M)for(let P=_;P<y;P+=M)w.push(new w_(C+k,P+k,k,c));let I=function(C){let P=0,B=0,q=0;const H=C[0];for(let te=0,re=H.length,J=re-1;te<re;J=te++){const ie=H[te],ce=H[J],me=ie.x*ce.y-ce.x*ie.y;B+=(ie.x+ce.x)*me,q+=(ie.y+ce.y)*me,P+=3*me}return new w_(B/P,q/P,0,C)}(c),D=w.length;for(;w.length;){const C=w.pop();(C.d>I.d||!I.d)&&(I=C,o&&console.log("found best %d after %d probes",Math.round(1e4*C.d)/1e4,D)),C.max-I.d<=n||(k=C.h/2,w.push(new w_(C.p.x-k,C.p.y-k,k,c)),w.push(new w_(C.p.x+k,C.p.y-k,k,c)),w.push(new w_(C.p.x-k,C.p.y+k,k,c)),w.push(new w_(C.p.x+k,C.p.y+k,k,c)),D+=4)}return o&&(console.log(`num probes: ${D}`),console.log(`best distance: ${I.d}`)),I.p}function tj(c,n){return n.max-c.max}class w_{constructor(n,o,u,_){this.p=new It(n,o),this.h=u,this.d=function(d,y){let E=!1,M=1/0;for(let k=0;k<y.length;k++){const w=y[k];for(let I=0,D=w.length,C=D-1;I<D;C=I++){const P=w[I],B=w[C];P.y>d.y!=B.y>d.y&&d.x<(B.x-P.x)*(d.y-P.y)/(B.y-P.y)+P.x&&(E=!E),M=Math.min(M,Re(d,P,B))}}return(E?1:-1)*Math.sqrt(M)}(this.p,_),this.max=this.d+this.h*Math.SQRT2}}const rS=Number.POSITIVE_INFINITY,nj=Math.sqrt(2);function J4(c,[n,o]){let u=0,_=0;if(o===rS){n<0&&(n=0);const d=n/nj;switch(c){case"top-right":case"top-left":_=d-7;break;case"bottom-right":case"bottom-left":_=7-d;break;case"bottom":_=7-n;break;case"top":_=n-7}switch(c){case"top-right":case"bottom-right":u=-d;break;case"top-left":case"bottom-left":u=d;break;case"left":u=n;break;case"right":u=-n}}else{switch(n=Math.abs(n),o=Math.abs(o),c){case"top-right":case"top-left":case"top":_=o-7;break;case"bottom-right":case"bottom-left":case"bottom":_=7-o}switch(c){case"top-right":case"bottom-right":case"right":u=-n;break;case"top-left":case"bottom-left":case"left":u=n}}return[u,_]}function iS(c){switch(c){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function rj(c,n,o,u,_,d,y,E,M,k,w,I,D,C,P){let B=d.textMaxSize.evaluate(n,{},I);B===void 0?B=y*d.textScaleFactor:B*=d.textScaleFactor;const q=c.layers[0].layout,H=q.get("icon-offset").evaluate(n,{},I),te=eO(o.horizontal)||o.vertical,re=D.name==="globe",J=Ba,ie=y*d.textScaleFactor/J,ce=c.tilePixelRatio*B/J,me=(qe=c.overscaling,c.zoom>18&&qe>2&&(qe>>=1),Math.max(Kt/(512*qe),1)*q.get("symbol-spacing")),Ce=q.get("text-padding")*c.tilePixelRatio,Ae=q.get("icon-padding")*c.tilePixelRatio,Ee=$n(q.get("text-max-angle")),Ue=q.get("text-rotation-alignment")==="map"&&q.get("symbol-placement")!=="point",Ie=q.get("icon-rotation-alignment")==="map"&&q.get("symbol-placement")!=="point",Ve=q.get("symbol-placement"),Ze=me/2;var qe;const Ke=q.get("icon-text-fit").evaluate(n,{},I),Qe=q.get("icon-text-fit-padding").evaluate(n,{},I),at=Ke!=="none";let Je;c.hasAnyIconTextFit===!1&&at&&(c.hasAnyIconTextFit=!0),u&&at&&(c.allowVerticalPlacement&&o.vertical&&(Je=Un(u,o.vertical,Ke,Qe,H,ie)),te&&(u=Un(u,te,Ke,Qe,H,ie)));const wt=(Rt,bt,an)=>{if(bt.x<0||bt.x>=Kt||bt.y<0||bt.y>=Kt)return;let Jt=null;if(re){const{x:Ut,y:zt,z:vn}=D.projectTilePoint(bt.x,bt.y,an);Jt={anchor:new wr(Ut,zt,vn,0,void 0),up:D.upVector(an,bt.x,bt.y)}}(function(Ut,zt,vn,ln,pn,kn,Gn,Zn,Wn,lr,ur,Zr,Lr,jn,Pr,Rr,ri,Bi,Ji,Ni,Oi,Gi,aa,mo,Qr,Vs,ju){const $c=Ut.addToLineVertexArray(zt,ln);let qc,Qm,Lp,e0,Hy,LI,zI,kI=0,BI=0,NI=0,FI=0,FS=-1,jS=-1;const Zh={};let jI=ns("");const t0=vn?vn.anchor:zt,US=Wn.layout.get("icon-text-fit").evaluate(Oi,{},Qr)!=="none";let VS=0,$S=0;if(Wn._unevaluatedLayout.getValue("text-radial-offset")===void 0?[VS,$S]=Wn.layout.get("text-offset").evaluate(Oi,{},Qr).map(ql=>ql*Ba):(VS=Wn.layout.get("text-radial-offset").evaluate(Oi,{},Qr)*Ba,$S=rS),Ut.allowVerticalPlacement&&pn.vertical){const ql=pn.vertical;if(Pr)LI=aS(ql),Zn&&(zI=aS(Zn));else{const $s=Wn.layout.get("text-rotate").evaluate(Oi,{},Qr)+90;Lp=g2(lr,t0,zt,ur,Zr,Lr,ql,jn,$s,Rr),Zn&&(e0=g2(lr,t0,zt,ur,Zr,Lr,Zn,Bi,$s))}}if(kn){const ql=Ut.iconSizeData,$s=Wn.layout.get("icon-rotate").evaluate(Oi,{},Qr),Zy=Y4(kn,$s,aa,US,Gi.iconScaleFactor),GS=Zn?Y4(Zn,$s,aa,US,Gi.iconScaleFactor):void 0;Qm=g2(lr,t0,zt,ur,Zr,Lr,kn,Bi,$s,null),kI=4*Zy.length;let n0=null;ql.kind==="source"?(n0=[Wo*Wn.layout.get("icon-size").evaluate(Oi,{},Qr)*Gi.iconScaleFactor],n0[0]>Ip&&qn(`${Ut.layerIds[0]}: Value for "icon-size" is >= ${My}. Reduce your "icon-size".`)):ql.kind==="composite"&&(n0=[Wo*Gi.compositeIconSizes[0].evaluate(Oi,{},Qr)*Gi.iconScaleFactor,Wo*Gi.compositeIconSizes[1].evaluate(Oi,{},Qr)*Gi.iconScaleFactor],(n0[0]>Ip||n0[1]>Ip)&&qn(`${Ut.layerIds[0]}: Value for "icon-size" is >= ${My}. Reduce your "icon-size".`)),Ut.addSymbols(Ut.icon,Zy,n0,Ni,Ji,Oi,!1,vn,zt,$c.lineStartIndex,$c.lineLength,-1,mo,Qr,Vs,ju),FS=Ut.icon.placedSymbolArray.length-1,GS&&(BI=4*GS.length,Ut.addSymbols(Ut.icon,GS,n0,Ni,Ji,Oi,Be.vertical,vn,zt,$c.lineStartIndex,$c.lineLength,-1,mo,Qr,Vs,ju),jS=Ut.icon.placedSymbolArray.length-1)}for(const ql in pn.horizontal){const $s=pn.horizontal[ql];qc||(jI=ns($s.text),Pr?Hy=aS($s):qc=g2(lr,t0,zt,ur,Zr,Lr,$s,jn,Wn.layout.get("text-rotate").evaluate(Oi,{},Qr),Rr));const Zy=$s.positionedLines.length===1;if(NI+=Q4(Ut,vn,zt,$s,Gn,Wn,Pr,Oi,Rr,$c,pn.vertical?Be.horizontal:Be.horizontalOnly,Zy?Object.keys(pn.horizontal):[ql],Zh,FS,Gi,mo,Qr,Vs),Zy)break}pn.vertical&&(FI+=Q4(Ut,vn,zt,pn.vertical,Gn,Wn,Pr,Oi,Rr,$c,Be.vertical,["vertical"],Zh,jS,Gi,mo,Qr,Vs));let zp=-1;const qS=(ql,$s)=>ql?Math.max(ql,$s):$s;zp=qS(Hy,zp),zp=qS(LI,zp),zp=qS(zI,zp);const kU=zp>-1?1:0;Ut.glyphOffsetArray.length>=65535&&qn("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Oi.sortKey!==void 0&&Ut.addToSortKeyRanges(Ut.symbolInstances.length,Oi.sortKey),Ut.symbolInstances.emplaceBack(zt.x,zt.y,t0.x,t0.y,t0.z,Zh.right>=0?Zh.right:-1,Zh.center>=0?Zh.center:-1,Zh.left>=0?Zh.left:-1,Zh.vertical>=0?Zh.vertical:-1,FS,jS,jI,qc!==void 0?qc:Ut.collisionBoxArray.length,qc!==void 0?qc+1:Ut.collisionBoxArray.length,Lp!==void 0?Lp:Ut.collisionBoxArray.length,Lp!==void 0?Lp+1:Ut.collisionBoxArray.length,Qm!==void 0?Qm:Ut.collisionBoxArray.length,Qm!==void 0?Qm+1:Ut.collisionBoxArray.length,e0||Ut.collisionBoxArray.length,e0?e0+1:Ut.collisionBoxArray.length,ur,NI,FI,kI,BI,kU,0,VS,$S,zp,0,US?1:0)})(c,bt,Jt,Rt,o,u,_,Je,c.layers[0],c.collisionBoxArray,n.index,n.sourceLayerIndex,c.index,Ce,Ue,M,0,Ae,Ie,H,n,d,k,w,I,C,P)};if(Ve==="line")for(const Rt of q4(n.geometry,0,0,Kt,Kt)){const bt=tS(Rt,me,Ee,o.vertical||te,u,J,ce,c.overscaling,Kt);for(const an of bt)te&&ij(c,te.text,Ze,an)||wt(Rt,an,I)}else if(Ve==="line-center"){for(const Rt of n.geometry)if(Rt.length>1){const bt=Hh(Rt,Ee,o.vertical||te,u,J,ce);bt&&wt(Rt,bt,I)}}else if(n.type==="Polygon")for(const Rt of Us(n.geometry,0)){const bt=ej(Rt,16);wt(Rt[0],new wr(bt.x,bt.y,0,0,void 0),I)}else if(n.type==="LineString")for(const Rt of n.geometry)wt(Rt,new wr(Rt[0].x,Rt[0].y,0,0,void 0),I);else if(n.type==="Point")for(const Rt of n.geometry)for(const bt of Rt)wt([bt],new wr(bt.x,bt.y,0,0,void 0),I)}const My=255,Ip=My*Wo;function Q4(c,n,o,u,_,d,y,E,M,k,w,I,D,C,P,B,q,H){const te=function(ie,ce,me,Ce,Ae,Ee,Ue,Ie){const Ve=[];if(ce.positionedLines.length===0)return Ve;const Ze=Ce.layout.get("text-rotate").evaluate(Ee,{})*Math.PI/180,qe=function(wt){const Rt=wt[0],bt=wt[1],an=Rt*bt;return an>0?[Rt,-bt]:an<0?[-Rt,bt]:Rt===0?[bt,Rt]:[bt,-Rt]}(me);let Ke=Math.abs(ce.top-ce.bottom);for(const wt of ce.positionedLines)Ke-=wt.lineOffset;const Qe=ce.positionedLines.length,at=Ke/Qe;let Je=ce.top-me[1];for(let wt=0;wt<Qe;++wt){const Rt=ce.positionedLines[wt];Je=QF(ce,at,Je,wt);for(const bt of Rt.positionedGlyphs){if(!bt.rect)continue;const an=bt.rect||{};let Jt=be+1,Ut=!0,zt=1,vn=0;if(bt.imageName){const Ni=Ue[Oa.build(bt.imageName).getSerializedPrimary()];if(!Ni)continue;if(Ni.sdf){qn("SDF images are not supported in formatted text and will be ignored.");continue}Ut=!1,zt=Ni.pixelRatio,Jt=Ay/zt}const ln=(Ae||Ie)&&bt.vertical,pn=bt.metrics.advance*bt.scale/2,kn=bt.metrics,Gn=bt.rect;if(Gn===null)continue;Ie&&ce.verticalizable&&(vn=bt.imageName?pn-bt.metrics.width*bt.scale/2:0);const Zn=Ae?[bt.x+pn,bt.y]:[0,0];let Wn=[0,0],lr=[0,0],ur=!1;Ae||(ln?(lr=[bt.x+pn+qe[0],bt.y+qe[1]-vn],ur=!0):Wn=[bt.x+pn+me[0],bt.y+me[1]-vn]);const Zr=Gn.w*bt.scale/(zt*(bt.localGlyph?ku:1)),Lr=Gn.h*bt.scale/(zt*(bt.localGlyph?ku:1));let jn,Pr,Rr,ri;if(ln){const Ni=bt.y-Je,Oi=new It(-pn,pn-Ni),Gi=-Math.PI/2,aa=new It(...lr);jn=new It(-pn+Wn[0],Wn[1]),jn._rotateAround(Gi,Oi)._add(aa),jn.x+=-Ni+pn,jn.y-=(kn.left-Jt)*bt.scale;const mo=bt.imageName?kn.advance*bt.scale:Ba*bt.scale,Qr=String.fromCodePoint(bt.glyph);f2(Qr)?jn.x+=(1-Jt)*bt.scale:Zm(Qr)?jn.x+=mo-kn.height*bt.scale+(-Jt-1)*bt.scale:jn.x+=bt.imageName||kn.width+2*Jt===Gn.w&&kn.height+2*Jt===Gn.h?(mo-Lr)/2:(mo-(kn.height+2*Jt)*bt.scale)/2,Pr=new It(jn.x,jn.y-Zr),Rr=new It(jn.x+Lr,jn.y),ri=new It(jn.x+Lr,jn.y-Zr)}else{const Ni=(kn.left-Jt)*bt.scale-pn+Wn[0],Oi=(-kn.top-Jt)*bt.scale+Wn[1],Gi=Ni+Zr,aa=Oi+Lr;jn=new It(Ni,Oi),Pr=new It(Gi,Oi),Rr=new It(Ni,aa),ri=new It(Gi,aa)}if(Ze){let Ni;Ni=Ae?new It(0,0):ur?new It(qe[0],qe[1]):new It(me[0],me[1]),jn._rotateAround(Ze,Ni),Pr._rotateAround(Ze,Ni),Rr._rotateAround(Ze,Ni),ri._rotateAround(Ze,Ni)}const Bi=new It(0,0),Ji=new It(0,0);Ve.push({tl:jn,tr:Pr,bl:Rr,br:ri,texPrimary:an,texSecondary:void 0,writingMode:ce.writingMode,glyphOffset:Zn,sectionIndex:bt.sectionIndex,isSDF:Ut,pixelOffsetTL:Bi,pixelOffsetBR:Ji,minFontScaleX:0,minFontScaleY:0})}}return Ve}(0,u,M,d,y,E,_,c.allowVerticalPlacement),re=c.textSizeData;let J=null;re.kind==="source"?(J=[Wo*d.layout.get("text-size").evaluate(E,{},q)*P.textScaleFactor],J[0]>Ip&&qn(`${c.layerIds[0]}: Value for "text-size" is >= ${My}. Reduce your "text-size".`)):re.kind==="composite"&&(J=[Wo*P.compositeTextSizes[0].evaluate(E,{},q)*P.textScaleFactor,Wo*P.compositeTextSizes[1].evaluate(E,{},q)*P.textScaleFactor],(J[0]>Ip||J[1]>Ip)&&qn(`${c.layerIds[0]}: Value for "text-size" is >= ${My}. Reduce your "text-size".`)),c.addSymbols(c.text,te,J,M,y,E,w,n,o,k.lineStartIndex,k.lineLength,C,B,q,H,!1);for(const ie of I)D[ie]=c.text.placedSymbolArray.length-1;return 4*te.length}function eO(c){for(const n in c)return c[n];return null}function g2(c,n,o,u,_,d,y,E,M,k){let w=y.top,I=y.bottom,D=y.left,C=y.right;const P=y.collisionPadding;if(P&&(D-=P[0],w-=P[1],C+=P[2],I+=P[3]),M){const B=new It(D,w),q=new It(C,w),H=new It(D,I),te=new It(C,I),re=$n(M);let J=new It(0,0);k&&(J=new It(k[0],k[1])),B._rotateAround(re,J),q._rotateAround(re,J),H._rotateAround(re,J),te._rotateAround(re,J),D=Math.min(B.x,q.x,H.x,te.x),C=Math.max(B.x,q.x,H.x,te.x),w=Math.min(B.y,q.y,H.y,te.y),I=Math.max(B.y,q.y,H.y,te.y)}return c.emplaceBack(n.x,n.y,n.z,o.x,o.y,D,w,C,I,E,u,_,d),c.length-1}function aS(c){c.collisionPadding&&(c.top-=c.collisionPadding[1],c.bottom+=c.collisionPadding[3]);const n=c.bottom-c.top;return n>0?Math.max(10,n):null}function ij(c,n,o,u){const _=c.compareText;if(n in _){const d=_[n];for(let y=d.length-1;y>=0;y--)if(u.dist(d[y])<o)return!0}else _[n]=[];return _[n].push(u),!1}function tO(c,n){const o=c.fovAboveCenter,u=c.elevation?c.elevation.getMinElevationBelowMSL()*n:0,_=(c._camera.position[2]*c.worldSize-u)/Math.cos(c._pitch),d=Math.sin(o)*_/Math.sin(Math.max(Math.PI/2-c._pitch-o,.01));let y=Math.sin(c._pitch)*d+_;const E=_*(1/c._horizonShift);if(!c.elevation||c.elevation.exaggeration()===0){let M=Math.max(c.zoom-17,0);c.isOrthographic&&(M/=10),y*=1+M}return Math.min(1.01*y,E)}function Oy(c,n){if(!n.isReprojectedInTileSpace)return{scale:1<<c.z,x:c.x,y:c.y,x2:c.x+1,y2:c.y+1,projection:n};const o=Math.pow(2,-c.z),u=c.x*o,_=(c.x+1)*o,d=c.y*o,y=(c.y+1)*o,E=Ja(u),M=Ja(_),k=$i(d),w=$i(y),I=n.project(E,k),D=n.project(M,k),C=n.project(M,w),P=n.project(E,w);let B=Math.min(I.x,D.x,C.x,P.x),q=Math.min(I.y,D.y,C.y,P.y),H=Math.max(I.x,D.x,C.x,P.x),te=Math.max(I.y,D.y,C.y,P.y);const re=o/16;function J(ce,me,Ce,Ae,Ee,Ue){const Ie=(Ce+Ee)/2,Ve=(Ae+Ue)/2,Ze=n.project(Ja(Ie),$i(Ve)),qe=Math.max(0,B-Ze.x,q-Ze.y,Ze.x-H,Ze.y-te);B=Math.min(B,Ze.x),H=Math.max(H,Ze.x),q=Math.min(q,Ze.y),te=Math.max(te,Ze.y),qe>re&&(J(ce,Ze,Ce,Ae,Ie,Ve),J(Ze,me,Ie,Ve,Ee,Ue))}J(I,D,u,d,_,d),J(D,C,_,d,_,y),J(C,P,_,y,u,y),J(P,I,u,y,u,d),B-=re,q-=re,H+=re,te+=re;const ie=1/Math.max(H-B,te-q);return{scale:ie,x:B*ie,y:q*ie,x2:H*ie,y2:te*ie,projection:n}}function nO(c,{x:n,y:o},u=0){return new It(((n-u)*c.scale-c.x)*Kt,(o*c.scale-c.y)*Kt)}const aj=Ne.mat4.identity(new Float32Array(16));class Pp{constructor(n){this.spec=n,this.name=n.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(n,o){return{x:0,y:0,z:0}}unproject(n,o){return new pr(0,0)}projectTilePoint(n,o,u){return{x:n,y:o,z:0}}locationPoint(n,o,u=!0){return n._coordinatePoint(n.locationCoordinate(o),u)}pixelsPerMeter(n,o){return za(1,n)*o}pixelSpaceConversion(n,o,u){return 1}farthestPixelDistance(n){return tO(n,n.pixelsPerMeter)}pointCoordinate(n,o,u,_){const d=n.horizonLineFromTop(!1),y=new It(o,Math.max(d,u));return n.rayIntersectionCoordinate(n.pointRayIntersection(y,_))}pointCoordinate3D(n,o,u){const _=new It(o,u);if(n.elevation)return n.elevation.pointCoordinate(_);{const d=this.pointCoordinate(n,_.x,_.y,0);return[d.x,d.y,d.z]}}isPointAboveHorizon(n,o){if(n.elevation&&n.elevation.visibleDemTiles.length)return!this.pointCoordinate3D(n,o.x,o.y);const u=n.horizonLineFromTop();return o.y<u}createInversionMatrix(n,o){return aj}createTileMatrix(n,o,u){let _,d,y;const E=u.canonical,M=Ne.mat4.identity(new Float64Array(16));if(this.isReprojectedInTileSpace){const k=Oy(E,this);_=1,d=k.x+u.wrap*k.scale,y=k.y,Ne.mat4.scale(M,M,[_/k.scale,_/k.scale,n.pixelsPerMeter/o])}else _=o/n.zoomScale(E.z),d=(E.x+Math.pow(2,E.z)*u.wrap)*_,y=E.y*_;return Ne.mat4.translate(M,M,[d,y,0]),Ne.mat4.scale(M,M,[_/Kt,_/Kt,1]),M}upVector(n,o,u){return[0,0,1]}upVectorScale(n,o,u){return{metersToTile:1}}}class oj extends Pp{constructor(n){super(n),this.range=[4,7],this.center=n.center||[-96,37.5];const[o,u]=this.parallels=n.parallels||[29.5,45.5],_=Math.sin($n(o));this.n=(_+Math.sin($n(u)))/2,this.c=1+_*(2*this.n-_),this.r0=Math.sqrt(this.c)/this.n}project(n,o){const{n:u,c:_,r0:d}=this,y=$n(n-this.center[0]),E=$n(o),M=Math.sqrt(_-2*u*Math.sin(E))/u;return{x:M*Math.sin(y*u),y:M*Math.cos(y*u)-d,z:0}}unproject(n,o){const{n:u,c:_,r0:d}=this,y=d+o;let E=Math.atan2(n,Math.abs(y))*Math.sign(y);y*u<0&&(E-=Math.PI*Math.sign(n)*Math.sign(y));const M=$n(this.center[0])*u;E=Jo(E,-Math.PI-M,Math.PI-M);const k=Bn(si(E/u)+this.center[0],-180,180),w=Math.asin(Bn((_-(n*n+y*y)*u*u)/(2*u),-1,1)),I=Bn(si(w),-85.051129,Br);return new pr(k,I)}}const Iy=1.340264,Py=-.081106,Ry=893e-6,Dy=.003796,y2=Math.sqrt(3)/2;class sj extends Pp{project(n,o){o=o/180*Math.PI,n=n/180*Math.PI;const u=Math.asin(y2*Math.sin(o)),_=u*u,d=_*_*_;return{x:.5*(n*Math.cos(u)/(y2*(Iy+3*Py*_+d*(7*Ry+9*Dy*_)))/Math.PI+.5),y:1-.5*(u*(Iy+Py*_+d*(Ry+Dy*_))/Math.PI+1),z:0}}unproject(n,o){n=(2*n-.5)*Math.PI;let u=o=(2*(1-o)-1)*Math.PI,_=u*u,d=_*_*_;for(let w,I,D,C=0;C<12&&(I=u*(Iy+Py*_+d*(Ry+Dy*_))-o,D=Iy+3*Py*_+d*(7*Ry+9*Dy*_),w=I/D,u=Bn(u-w,-Math.PI/3,Math.PI/3),_=u*u,d=_*_*_,!(Math.abs(w)<1e-12));++C);const y=y2*n*(Iy+3*Py*_+d*(7*Ry+9*Dy*_))/Math.cos(u),E=Math.asin(Math.sin(u)/y2),M=Bn(180*y/Math.PI,-180,180),k=Bn(180*E/Math.PI,-85.051129,Br);return new pr(M,k)}}class lj extends Pp{constructor(n){super(n),this.wrap=!0,this.supportsWorldCopies=!0}project(n,o){return{x:.5+n/360,y:.5-o/360,z:0}}unproject(n,o){const u=360*(n-.5),_=Bn(360*(.5-o),-85.051129,Br);return new pr(u,_)}}const S_=Math.PI/2;function v2(c){return Math.tan((S_+c)/2)}class cj extends Pp{constructor(n){super(n),this.center=n.center||[0,30];const[o,u]=this.parallels=n.parallels||[30,30];let _=$n(o),d=$n(u);this.southernCenter=_+d<0,this.southernCenter&&(_=-_,d=-d);const y=Math.cos(_),E=v2(_);this.n=_===d?Math.sin(_):Math.log(y/Math.cos(d))/Math.log(v2(d)/E),this.f=y*Math.pow(v2(_),this.n)/this.n}project(n,o){o=$n(o),this.southernCenter&&(o=-o),n=$n(n-this.center[0]);const u=1e-6,{n:_,f:d}=this;d>0?o<-S_+u&&(o=-S_+u):o>S_-u&&(o=S_-u);const y=d/Math.pow(v2(o),_);let E=y*Math.sin(_*n),M=d-y*Math.cos(_*n);return E=.5*(E/Math.PI+.5),M=.5*(M/Math.PI+.5),{x:E,y:this.southernCenter?M:1-M,z:0}}unproject(n,o){n=(2*n-.5)*Math.PI,this.southernCenter&&(o=1-o),o=(2*(1-o)-.5)*Math.PI;const{n:u,f:_}=this,d=_-o,y=Math.sign(d),E=Math.sign(u)*Math.sqrt(n*n+d*d);let M=Math.atan2(n,Math.abs(d))*y;d*u<0&&(M-=Math.PI*Math.sign(n)*y);const k=Bn(si(M/u)+this.center[0],-180,180),w=Bn(si(2*Math.atan(Math.pow(_/E,1/u))-S_),-85.051129,Br);return new pr(k,this.southernCenter?-w:w)}}class rO extends Pp{constructor(n){super(n),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(n,o){return{x:js(n),y:ys(o),z:0}}unproject(n,o){const u=Ja(n),_=$i(o);return new pr(u,_)}}const iO=$n(Br);class uj extends Pp{project(n,o){const u=(o=$n(o))*o,_=u*u;return{x:.5*((n=$n(n))*(.8707-.131979*u+_*(_*(.003971*u-.001529*_)-.013791))/Math.PI+.5),y:1-.5*(o*(1.007226+u*(.015085+_*(.028874*u-.044475-.005916*_)))/Math.PI+1),z:0}}unproject(n,o){n=(2*n-.5)*Math.PI;let u=o=(2*(1-o)-1)*Math.PI,_=25,d=0,y=u*u;do{y=u*u;const k=y*y;d=(u*(1.007226+y*(.015085+k*(.028874*y-.044475-.005916*k)))-o)/(1.007226+y*(.045255+k*(.259866*y-.311325-.005916*11*k))),u=Bn(u-d,-iO,iO)}while(Math.abs(d)>1e-6&&--_>0);y=u*u;const E=Bn(si(n/(.8707+y*(y*(y*y*y*(.003971-.001529*y)-.013791)-.131979))),-180,180),M=si(u);return new pr(E,M)}}const aO=$n(Br);class hj extends Pp{project(n,o){o=$n(o),n=$n(n);const u=Math.cos(o),_=2/Math.PI,d=Math.acos(u*Math.cos(n/2)),y=Math.sin(d)/d,E=.5*(n*_+2*u*Math.sin(n/2)/y)||0,M=.5*(o+Math.sin(o)/y)||0;return{x:.5*(E/Math.PI+.5),y:1-.5*(M/Math.PI+1),z:0}}unproject(n,o){let u=n=(2*n-.5)*Math.PI,_=o=(2*(1-o)-1)*Math.PI,d=25;const y=1e-6;let E=0,M=0;do{const k=Math.cos(_),w=Math.sin(_),I=2*w*k,D=w*w,C=k*k,P=Math.cos(u/2),B=Math.sin(u/2),q=2*P*B,H=B*B,te=1-C*P*P,re=te?1/te:0,J=te?Math.acos(k*P)*Math.sqrt(1/te):0,ie=.5*(2*J*k*B+2*u/Math.PI)-n,ce=.5*(J*w+_)-o,me=.5*re*(C*H+J*k*P*D)+1/Math.PI,Ce=re*(q*I/4-J*w*B),Ae=.125*re*(I*B-J*w*C*q),Ee=.5*re*(D*P+J*H*k)+.5,Ue=Ce*Ae-Ee*me;E=(ce*Ce-ie*Ee)/Ue,M=(ie*Ae-ce*me)/Ue,u=Bn(u-E,-Math.PI,Math.PI),_=Bn(_-M,-aO,aO)}while((Math.abs(E)>y||Math.abs(M)>y)&&--d>0);return new pr(si(u),si(_))}}class oO extends Pp{constructor(n){super(n),this.center=n.center||[0,0],this.parallels=n.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos($n(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(n,o){const{scale:u,cosPhi:_}=this;return{x:$n(n)*_*u+.5,y:-Math.sin($n(o))/_*u+.5,z:0}}unproject(n,o){const{scale:u,cosPhi:_}=this,d=-(o-.5)/u,y=Bn(si((n-.5)/u)/_,-180,180),E=Math.asin(Bn(d*_,-1,1)),M=Bn(si(E),-85.051129,Br);return new pr(y,M)}}class fj extends rO{constructor(n){super(n),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(n,o,u){const _=Sr(n,o,u),d=xi(Kr(u));return Ne.vec3.transformMat4(_,_,d),{x:_[0],y:_[1],z:_[2]}}locationPoint(n,o){const u=kc(o.lat,o.lng),_=Ne.vec3.normalize([],u),d=n.elevation?n.elevation.getAtPointOrZero(n.locationCoordinate(o),n._centerAltitude):n._centerAltitude,y=za(1,0)*Kt*d;Ne.vec3.scaleAndAdd(u,u,_,y);const E=Ne.mat4.identity(new Float64Array(16));return Ne.mat4.multiply(E,n.pixelMatrix,n.globeMatrix),Ne.vec3.transformMat4(u,u,E),new It(u[0],u[1])}pixelsPerMeter(n,o){return za(1,0)*o}pixelSpaceConversion(n,o,u){const _=za(1,n)*o,d=Mn(za(1,45)*o,_,u);return this.pixelsPerMeter(n,o)/d}createTileMatrix(n,o,u){const _=Or(Kr(u.canonical));return Ne.mat4.multiply(new Float64Array(16),n.globeMatrix,_)}createInversionMatrix(n,o){const{center:u}=n,_=xi(Kr(o));return Ne.mat4.rotateY(_,_,$n(u.lng)),Ne.mat4.rotateX(_,_,$n(u.lat)),Ne.mat4.scale(_,_,[n._pixelsPerMercatorPixel,n._pixelsPerMercatorPixel,1]),Float32Array.from(_)}pointCoordinate(n,o,u,_){return Pn(n,o,u,!0)||new l(0,0)}pointCoordinate3D(n,o,u){const _=this.pointCoordinate(n,o,u,0);return[_.x,_.y,_.z]}isPointAboveHorizon(n,o){return!Pn(n,o.x,o.y,!1)}farthestPixelDistance(n){const o=function(_,d){const y=_.cameraToCenterDistance,E=_._centerAltitude*d,M=_._camera,k=_._camera.forward(),w=Ne.vec3.add([],Ne.vec3.scale([],k,-y),[0,0,E]),I=_.worldSize/(2*Math.PI),D=[0,0,-I],C=_.width/_.height,P=Math.tan(_.fovAboveCenter),B=Ne.vec3.scale([],M.up(),P),q=Ne.vec3.scale([],M.right(),P*C),H=Ne.vec3.normalize([],Ne.vec3.add([],Ne.vec3.add([],k,B),q)),te=[];let re;if(new Ln(w,H).closestPointOnSphere(D,I,te)){const J=Ne.vec3.add([],te,D),ie=Ne.vec3.sub([],J,w);re=Math.cos(_.fovAboveCenter)*Ne.vec3.length(ie)}else{const J=Ne.vec3.sub([],w,D),ie=Ne.vec3.sub([],D,w);Ne.vec3.normalize(ie,ie);const ce=Ne.vec3.length(J)-I;re=Math.sqrt(ce*(ce+2*I));const me=Math.acos(re/(I+ce))-Math.acos(Ne.vec3.dot(k,ie));re*=Math.cos(me)}return 1.01*re}(n,this.pixelsPerMeter(n.center.lat,n.worldSize)),u=ka(n.zoom);if(u>0){const _=tO(n,za(1,n.center.lat)*n.worldSize),d=n.worldSize/(2*Math.PI),y=Math.max(n.width,n.height)/n.worldSize*Math.PI;return Mn(o,_+d*(1-Math.cos(y)),Math.pow(u,10))}return o}upVector(n,o,u){return Sr(o,u,n,1)}upVectorScale(n){return{metersToTile:In(cr(Kr(n)))}}}function sO(c){const n=c.parallels,o=!!n&&Math.abs(n[0]+n[1])<.01;switch(c.name){case"mercator":return new rO(c);case"equirectangular":return new lj(c);case"naturalEarth":return new uj(c);case"equalEarth":return new sj(c);case"winkelTripel":return new hj(c);case"albers":return o?new oO(c):new oj(c);case"lambertConformalConic":return o?new oO(c):new cj(c);case"globe":return new fj(c)}throw new Error(`Invalid projection name: ${c.name}`)}const dj=rd.VectorTileFeature.types,pj=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function x2(c,n,o,u,_,d,y,E,M,k,w,I,D){const C=E?Math.min(Ip,Math.round(E[0])):0,P=E?Math.min(Ip,Math.round(E[1])):0;c.emplaceBack(n,o,Math.round(32*u),Math.round(32*_),d,y,(C<<1)+(M?1:0),P,16*k,16*w,256*I,256*D)}function b2(c,n,o){c.emplaceBack(n,o)}function w2(c,n,o,u,_,d,y){c.emplaceBack(n,o,u,_,d,y)}function S2(c,n,o,u,_){c.emplaceBack(n,o,u,_),c.emplaceBack(n,o,u,_),c.emplaceBack(n,o,u,_),c.emplaceBack(n,o,u,_)}function mj(c){for(const n of c.sections)if(wc(n.text))return!0;return!1}class oS{constructor(n){this.layoutVertexArray=new Uf,this.indexArray=new ia,this.programConfigurations=n,this.segments=new ci,this.dynamicLayoutVertexArray=new Ic,this.opacityVertexArray=new Tm,this.placedSymbolArray=new Em,this.iconTransitioningVertexArray=new Pc,this.globeExtVertexArray=new lp,this.zOffsetVertexArray=new zs}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0&&this.iconTransitioningVertexArray.length===0}upload(n,o,u,_,d){this.isEmpty()||(u&&(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,h2.members),this.indexBuffer=n.createIndexBuffer(this.indexArray,o),this.dynamicLayoutVertexBuffer=n.createVertexBuffer(this.dynamicLayoutVertexArray,Vh.members,!0),this.opacityVertexBuffer=n.createVertexBuffer(this.opacityVertexArray,pj,!0),this.iconTransitioningVertexArray.length>0&&(this.iconTransitioningVertexBuffer=n.createVertexBuffer(this.iconTransitioningVertexArray,qh.members,!0)),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=n.createVertexBuffer(this.globeExtVertexArray,wy.members,!0)),!this.zOffsetVertexBuffer&&(this.zOffsetVertexArray.length>0||d)&&(this.zOffsetVertexBuffer=n.createVertexBuffer(this.zOffsetVertexArray,$h.members,!0)),this.opacityVertexBuffer.itemSize=1),(u||_)&&this.programConfigurations.upload(n))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.iconTransitioningVertexBuffer&&this.iconTransitioningVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy(),this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy())}}hn(oS,"SymbolBuffers");class sS{constructor(n,o,u){this.layoutVertexArray=new n,this.layoutAttributes=o,this.indexArray=new u,this.segments=new ci,this.collisionVertexArray=new Mh,this.collisionVertexArrayExt=new Ic}upload(n){this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=n.createVertexBuffer(this.collisionVertexArray,Gm.members,!0),this.collisionVertexBufferExt=n.createVertexBuffer(this.collisionVertexArrayExt,Hm.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}hn(sS,"CollisionBuffers");class T2{constructor(n){this.collisionBoxArray=n.collisionBoxArray,this.zoom=n.zoom,this.lut=n.lut,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(y=>y.fqid),this.index=n.index,this.pixelRatio=n.pixelRatio,this.sourceLayerIndex=n.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.hasAnyIconTextFit=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Ne.mat4.identity([]),this.placementViewportMatrix=Ne.mat4.identity([]);const o=this.layers[0]._unevaluatedLayout._values;this.textSizeData=g_(this.zoom,o["text-size"]),this.iconSizeData=g_(this.zoom,o["icon-size"]);const u=this.layers[0].layout,_=u.get("symbol-sort-key"),d=u.get("symbol-z-order");this.canOverlap=u.get("text-allow-overlap")||u.get("icon-allow-overlap")||u.get("text-ignore-placement")||u.get("icon-ignore-placement"),this.sortFeaturesByKey=d!=="viewport-y"&&_.constantOr(1)!==void 0,this.sortFeaturesByY=(d==="viewport-y"||d==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=u.get("text-writing-mode").map(y=>Be[y]),this.stateDependentLayerIds=this.layers.filter(y=>y.isStateDependent()).map(y=>y.id),this.sourceID=n.sourceID,this.projection=n.projection,this.hasAnyZOffset=!1,this.zOffsetSortDirty=!1,this.zOffsetBuffersNeedUpload=u.get("symbol-z-elevate"),this.activeReplacements=[],this.replacementUpdateTime=0}createArrays(){this.text=new oS(new Co(this.layers,{zoom:this.zoom,lut:this.lut},n=>n.startsWith("text")||n.startsWith("symbol"))),this.icon=new oS(new Co(this.layers,{zoom:this.zoom,lut:this.lut},n=>n.startsWith("icon")||n.startsWith("symbol"))),this.glyphOffsetArray=new Cm,this.lineVertexArray=new wa,this.symbolInstances=new V0}calculateGlyphDependencies(n,o,u,_,d){for(const y of n){const E=y.codePointAt(0);if(E===void 0)break;if(o[E]=!0,_&&d&&E<=65535){const M=Gh[y];M&&(o[M.charCodeAt(0)]=!0)}}}updateFootprints(n,o){}updateReplacement(n,o){if(o.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=o.updateTime;const u=o.getReplacementRegionsForTile(n.toUnwrapped(),!0);return!Bm(this.activeReplacements,u)&&(this.activeReplacements=u,!0)}populate(n,o,u,_){const d=this.layers[0],y=d.layout,E=this.projection.name==="globe",M=y.get("text-font"),k=y.get("text-field"),w=y.get("icon-image"),[I,D]=y.get("icon-size-scale-range"),C=Bn(o.scaleFactor||1,I,D),P=(k.value.kind!=="constant"||k.value.value instanceof ta&&!k.value.value.isEmpty()||k.value.value.toString().length>0)&&(M.value.kind!=="constant"||M.value.value.length>0),B=w.value.kind!=="constant"||!!w.value.value||Object.keys(w.parameters).length>0,q=y.get("symbol-sort-key");if(this.features=[],!P&&!B)return;const H=o.iconDependencies,te=o.glyphDependencies,re=o.availableImages,J=new kr(this.zoom);for(const{feature:ie,id:ce,index:me,sourceLayerIndex:Ce}of n){const Ae=d._featureFilter.needGeometry,Ee=Z(ie,Ae);if(!d._featureFilter.filter(J,Ee,u))continue;if(Ae||(Ee.geometry=$(ie,u,_)),E&&ie.type!==1&&u.z<=5){const qe=Ee.geometry,Ke=.98078528056,Qe=(at,Je)=>{const wt=Sr(at.x,at.y,u,1),Rt=Sr(Je.x,Je.y,u,1);return Ne.vec3.dot(wt,Rt)<Ke};for(let at=0;at<qe.length;at++)qe[at]=A(qe[at],Qe)}let Ue,Ie;if(P){const qe=d.getValueAndResolveTokens("text-field",Ee,u,re),Ke=ta.factory(qe);mj(Ke)&&(this.hasRTLText=!0),(!this.hasRTLText||Sh()==="unavailable"||this.hasRTLText&&Yr.isParsed())&&(Ue=y_(Ke,d,Ee))}if(B){const qe=d.getValueAndResolveTokens("icon-image",Ee,u,re);Ie=qe instanceof Oa?qe:Oa.build(qe)}if(!Ue&&!Ie)continue;const Ve=this.sortFeaturesByKey?q.evaluate(Ee,{},u):void 0,Ze={id:ce,text:Ue,icon:Ie,index:me,sourceLayerIndex:Ce,geometry:Ee.geometry,properties:ie.properties,type:dj[ie.type],sortKey:Ve};if(this.features.push(Ze),Ie){const qe=Sy(this.iconSizeData,this.layers[0]._unevaluatedLayout._values["icon-size"],u,this.zoom,Ze)*C*this.pixelRatio,Ke=Ie.getPrimary().scaleSelf(qe);if(H[Ke.id]=H[Ke.id]||[],H[Ke.id].push(Ke),Ie.nameSecondary){const Qe=Ie.getSecondary().scaleSelf(qe);H[Qe.id]=H[Qe.id]||[],H[Qe.id].push(Qe)}}if(Ue){const qe=M.evaluate(Ee,{},u).join(","),Ke=y.get("text-rotation-alignment")==="map"&&y.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Be.vertical)>=0;for(const Qe of Ue.sections)if(Qe.image){const at=Qe.image.getPrimary().scaleSelf(this.pixelRatio);H[at.id]=H[at.id]||[],H[at.id].push(at)}else{const at=ti(Ue.toString()),Je=Qe.fontStack||qe,wt=te[Je]=te[Je]||{};this.calculateGlyphDependencies(Qe.text,wt,Ke,this.allowVerticalPlacement,at)}}}y.get("symbol-placement")==="line"&&(this.features=function(ie){const ce={},me={},Ce=[];let Ae=0;function Ee(Ze){Ce.push(ie[Ze]),Ae++}function Ue(Ze,qe,Ke){const Qe=me[Ze];return delete me[Ze],me[qe]=Qe,Ce[Qe].geometry[0].pop(),Ce[Qe].geometry[0]=Ce[Qe].geometry[0].concat(Ke[0]),Qe}function Ie(Ze,qe,Ke){const Qe=ce[qe];return delete ce[qe],ce[Ze]=Qe,Ce[Qe].geometry[0].shift(),Ce[Qe].geometry[0]=Ke[0].concat(Ce[Qe].geometry[0]),Qe}function Ve(Ze,qe,Ke){const Qe=Ke?qe[0][qe[0].length-1]:qe[0][0];return`${Ze}:${Qe.x}:${Qe.y}`}for(let Ze=0;Ze<ie.length;Ze++){const qe=ie[Ze],Ke=qe.geometry,Qe=qe.text?qe.text.toString():null;if(!Qe){Ee(Ze);continue}const at=Ve(Qe,Ke),Je=Ve(Qe,Ke,!0);if(at in me&&Je in ce&&me[at]!==ce[Je]){const wt=Ie(at,Je,Ke),Rt=Ue(at,Je,Ce[wt].geometry);delete ce[at],delete me[Je],me[Ve(Qe,Ce[Rt].geometry,!0)]=Rt,Ce[wt].geometry=null}else at in me?Ue(at,Je,Ke):Je in ce?Ie(at,Je,Ke):(Ee(Ze),ce[at]=Ae-1,me[Je]=Ae-1)}return Ce.filter(Ze=>Ze.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((ie,ce)=>ie.sortKey-ce.sortKey)}update(n,o,u,_,d,y,E){this.text.programConfigurations.updatePaintArrays(n,o,d,u,_,y,E),this.icon.programConfigurations.updatePaintArrays(n,o,d,u,_,y,E)}updateZOffset(){const n=(d,y,E)=>{u+=y,u>d.length&&d.resize(u);for(let M=-y;M<0;M++)d.emplace(M+u,E)},o=(d,y,E)=>{_+=y,_>d.length&&d.resize(_);for(let M=-y;M<0;M++)d.emplace(M+_,E)};if(!this.zOffsetBuffersNeedUpload)return;this.zOffsetBuffersNeedUpload=!1;let u=0,_=0;for(let d=0;d<this.symbolInstances.length;d++){const y=this.symbolInstances.get(d),{numHorizontalGlyphVertices:E,numVerticalGlyphVertices:M,numIconVertices:k}=y,w=y.zOffset,I=k>0;if((E>0||M>0)&&(n(this.text.zOffsetVertexArray,E,w),n(this.text.zOffsetVertexArray,M,w)),I){const{placedIconSymbolIndex:D,verticalPlacedIconSymbolIndex:C}=y;D>=0&&o(this.icon.zOffsetVertexArray,k,w),C>=0&&o(this.icon.zOffsetVertexArray,y.numVerticalIconVertices,w)}}this.text.zOffsetVertexBuffer&&this.text.zOffsetVertexBuffer.updateData(this.text.zOffsetVertexArray),this.icon.zOffsetVertexBuffer&&this.icon.zOffsetVertexBuffer.updateData(this.icon.zOffsetVertexArray)}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(n){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(n),this.iconCollisionBox.upload(n)),this.text.upload(n,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.icon.upload(n,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=sO(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(n,o){const u=this.lineVertexArray.length;if(n.segment!==void 0)for(const{x:_,y:d}of o)this.lineVertexArray.emplaceBack(_,d);return{lineStartIndex:u,lineLength:this.lineVertexArray.length-u}}addSymbols(n,o,u,_,d,y,E,M,k,w,I,D,C,P,B,q){const H=n.indexArray,te=n.layoutVertexArray,re=n.globeExtVertexArray,J=n.segments.prepareSegment(4*o.length,te,H,this.canOverlap?y.sortKey:void 0),ie=this.glyphOffsetArray.length,ce=J.vertexLength,me=this.allowVerticalPlacement&&E===Be.vertical?Math.PI/2:0,Ce=y.text&&y.text.sections;for(let Ee=0;Ee<o.length;Ee++){const{tl:Ue,tr:Ie,bl:Ve,br:Ze,texPrimary:qe,texSecondary:Ke,pixelOffsetTL:Qe,pixelOffsetBR:at,minFontScaleX:Je,minFontScaleY:wt,glyphOffset:Rt,isSDF:bt,sectionIndex:an}=o[Ee],Jt=J.vertexLength,Ut=Rt[1];if(x2(te,k.x,k.y,Ue.x,Ut+Ue.y,qe.x,qe.y,u,bt,Qe.x,Qe.y,Je,wt),x2(te,k.x,k.y,Ie.x,Ut+Ie.y,qe.x+qe.w,qe.y,u,bt,at.x,Qe.y,Je,wt),x2(te,k.x,k.y,Ve.x,Ut+Ve.y,qe.x,qe.y+qe.h,u,bt,Qe.x,at.y,Je,wt),x2(te,k.x,k.y,Ze.x,Ut+Ze.y,qe.x+qe.w,qe.y+qe.h,u,bt,at.x,at.y,Je,wt),M){const{x:zt,y:vn,z:ln}=M.anchor,[pn,kn,Gn]=M.up;w2(re,zt,vn,ln,pn,kn,Gn),w2(re,zt,vn,ln,pn,kn,Gn),w2(re,zt,vn,ln,pn,kn,Gn),w2(re,zt,vn,ln,pn,kn,Gn),S2(n.dynamicLayoutVertexArray,zt,vn,ln,me)}else S2(n.dynamicLayoutVertexArray,k.x,k.y,k.z,me);if(q){const zt=Ke||qe;b2(n.iconTransitioningVertexArray,zt.x,zt.y),b2(n.iconTransitioningVertexArray,zt.x+zt.w,zt.y),b2(n.iconTransitioningVertexArray,zt.x,zt.y+zt.h),b2(n.iconTransitioningVertexArray,zt.x+zt.w,zt.y+zt.h)}H.emplaceBack(Jt,Jt+1,Jt+2),H.emplaceBack(Jt+1,Jt+2,Jt+3),J.vertexLength+=4,J.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Rt[0]),Ee!==o.length-1&&an===o[Ee+1].sectionIndex||n.programConfigurations.populatePaintArrays(te.length,y,y.index,{},C,P,B,Ce&&Ce[an])}const Ae=M?M.anchor:k;n.placedSymbolArray.emplaceBack(Ae.x,Ae.y,Ae.z,k.x,k.y,ie,this.glyphOffsetArray.length-ie,ce,w,I,k.segment,u?u[0]:0,u?u[1]:0,_[0],_[1],E,0,!1,0,D,0)}_commitLayoutVertex(n,o,u,_,d,y,E){n.emplaceBack(o,u,_,d,y,Math.round(E.x),Math.round(E.y))}_addCollisionDebugVertices(n,o,u,_,d,y,E){const M=u.segments.prepareSegment(4,u.layoutVertexArray,u.indexArray),k=M.vertexLength,w=E.tileAnchorX,I=E.tileAnchorY;for(let C=0;C<4;C++)u.collisionVertexArray.emplaceBack(0,0,0,0,0,0);this._commitDebugCollisionVertexUpdate(u.collisionVertexArrayExt,o,n.padding,E.zOffset),this._commitLayoutVertex(u.layoutVertexArray,_,d,y,w,I,new It(n.x1,n.y1)),this._commitLayoutVertex(u.layoutVertexArray,_,d,y,w,I,new It(n.x2,n.y1)),this._commitLayoutVertex(u.layoutVertexArray,_,d,y,w,I,new It(n.x2,n.y2)),this._commitLayoutVertex(u.layoutVertexArray,_,d,y,w,I,new It(n.x1,n.y2)),M.vertexLength+=4;const D=u.indexArray;D.emplaceBack(k,k+1),D.emplaceBack(k+1,k+2),D.emplaceBack(k+2,k+3),D.emplaceBack(k+3,k),M.primitiveLength+=4}_addTextDebugCollisionBoxes(n,o,u,_,d,y){for(let E=_;E<d;E++){const M=u.get(E),k=this.getSymbolInstanceTextSize(n,y,o,E);this._addCollisionDebugVertices(M,k,this.textCollisionBox,M.projectedAnchorX,M.projectedAnchorY,M.projectedAnchorZ,y)}}_addIconDebugCollisionBoxes(n,o,u,_,d,y){for(let E=_;E<d;E++){const M=u.get(E),k=this.getSymbolInstanceIconSize(n,o,y.placedIconSymbolIndex);this._addCollisionDebugVertices(M,k,this.iconCollisionBox,M.projectedAnchorX,M.projectedAnchorY,M.projectedAnchorZ,y)}}generateCollisionDebugBuffers(n,o,u){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new sS(Rc,zu.members,Pc),this.iconCollisionBox=new sS(Rc,zu.members,Pc);const _=ud(this.iconSizeData,n),d=ud(this.textSizeData,n,u);for(let y=0;y<this.symbolInstances.length;y++){const E=this.symbolInstances.get(y);this._addTextDebugCollisionBoxes(d,n,o,E.textBoxStartIndex,E.textBoxEndIndex,E),this._addTextDebugCollisionBoxes(d,n,o,E.verticalTextBoxStartIndex,E.verticalTextBoxEndIndex,E),this._addIconDebugCollisionBoxes(_,n,o,E.iconBoxStartIndex,E.iconBoxEndIndex,E),this._addIconDebugCollisionBoxes(_,n,o,E.verticalIconBoxStartIndex,E.verticalIconBoxEndIndex,E)}}getSymbolInstanceTextSize(n,o,u,_){const d=this.text.placedSymbolArray.get(o.rightJustifiedTextSymbolIndex>=0?o.rightJustifiedTextSymbolIndex:o.centerJustifiedTextSymbolIndex>=0?o.centerJustifiedTextSymbolIndex:o.leftJustifiedTextSymbolIndex>=0?o.leftJustifiedTextSymbolIndex:o.verticalPlacedTextSymbolIndex>=0?o.verticalPlacedTextSymbolIndex:_),y=cd(this.textSizeData,n,d)/Ba;return this.tilePixelRatio*y}getSymbolInstanceIconSize(n,o,u){const _=this.icon.placedSymbolArray.get(u),d=cd(this.iconSizeData,n,_);return this.tilePixelRatio*d}_commitDebugCollisionVertexUpdate(n,o,u,_){n.emplaceBack(o,-u,-u,_),n.emplaceBack(o,u,-u,_),n.emplaceBack(o,u,u,_),n.emplaceBack(o,-u,u,_)}_updateTextDebugCollisionBoxes(n,o,u,_,d,y,E){for(let M=_;M<d;M++){const k=u.get(M),w=this.getSymbolInstanceTextSize(n,y,o,M);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,w,k.padding,y.zOffset)}}_updateIconDebugCollisionBoxes(n,o,u,_,d,y,E){for(let M=_;M<d;M++){const k=u.get(M),w=this.getSymbolInstanceIconSize(n,o,y.placedIconSymbolIndex);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,w,k.padding,y.zOffset)}}updateCollisionDebugBuffers(n,o,u,_){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const d=ud(this.iconSizeData,n,_),y=ud(this.textSizeData,n,u);for(let E=0;E<this.symbolInstances.length;E++){const M=this.symbolInstances.get(E);this._updateTextDebugCollisionBoxes(y,n,o,M.textBoxStartIndex,M.textBoxEndIndex,M,u),this._updateTextDebugCollisionBoxes(y,n,o,M.verticalTextBoxStartIndex,M.verticalTextBoxEndIndex,M,u),this._updateIconDebugCollisionBoxes(d,n,o,M.iconBoxStartIndex,M.iconBoxEndIndex,M,_),this._updateIconDebugCollisionBoxes(d,n,o,M.verticalIconBoxStartIndex,M.verticalIconBoxEndIndex,M,_)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(n,o,u,_,d,y,E,M,k){const w={};if(o<u){const{x1:I,y1:D,x2:C,y2:P,padding:B,projectedAnchorX:q,projectedAnchorY:H,projectedAnchorZ:te,tileAnchorX:re,tileAnchorY:J,featureIndex:ie}=n.get(o);w.textBox={x1:I,y1:D,x2:C,y2:P,padding:B,projectedAnchorX:q,projectedAnchorY:H,projectedAnchorZ:te,tileAnchorX:re,tileAnchorY:J},w.textFeatureIndex=ie}if(_<d){const{x1:I,y1:D,x2:C,y2:P,padding:B,projectedAnchorX:q,projectedAnchorY:H,projectedAnchorZ:te,tileAnchorX:re,tileAnchorY:J,featureIndex:ie}=n.get(_);w.verticalTextBox={x1:I,y1:D,x2:C,y2:P,padding:B,projectedAnchorX:q,projectedAnchorY:H,projectedAnchorZ:te,tileAnchorX:re,tileAnchorY:J},w.verticalTextFeatureIndex=ie}if(y<E){const{x1:I,y1:D,x2:C,y2:P,padding:B,projectedAnchorX:q,projectedAnchorY:H,projectedAnchorZ:te,tileAnchorX:re,tileAnchorY:J,featureIndex:ie}=n.get(y);w.iconBox={x1:I,y1:D,x2:C,y2:P,padding:B,projectedAnchorX:q,projectedAnchorY:H,projectedAnchorZ:te,tileAnchorX:re,tileAnchorY:J},w.iconFeatureIndex=ie}if(M<k){const{x1:I,y1:D,x2:C,y2:P,padding:B,projectedAnchorX:q,projectedAnchorY:H,projectedAnchorZ:te,tileAnchorX:re,tileAnchorY:J,featureIndex:ie}=n.get(M);w.verticalIconBox={x1:I,y1:D,x2:C,y2:P,padding:B,projectedAnchorX:q,projectedAnchorY:H,projectedAnchorZ:te,tileAnchorX:re,tileAnchorY:J},w.verticalIconFeatureIndex=ie}return w}deserializeCollisionBoxes(n){this.collisionArrays=[];for(let o=0;o<this.symbolInstances.length;o++){const u=this.symbolInstances.get(o);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(n,u.textBoxStartIndex,u.textBoxEndIndex,u.verticalTextBoxStartIndex,u.verticalTextBoxEndIndex,u.iconBoxStartIndex,u.iconBoxEndIndex,u.verticalIconBoxStartIndex,u.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}hasIconTextFit(){return this.hasAnyIconTextFit}addIndicesForPlacedSymbol(n,o){const u=n.placedSymbolArray.get(o),_=u.vertexStartIndex+4*u.numGlyphs;for(let d=u.vertexStartIndex;d<_;d+=4)n.indexArray.emplaceBack(d,d+1,d+2),n.indexArray.emplaceBack(d+1,d+2,d+3)}getSortedSymbolIndexes(n){if(this.sortedAngle===n&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const o=Math.sin(n),u=Math.cos(n),_=[],d=[],y=[];for(let E=0;E<this.symbolInstances.length;++E){y.push(E);const M=this.symbolInstances.get(E);_.push(0|Math.round(o*M.tileAnchorX+u*M.tileAnchorY)),d.push(M.featureIndex)}return y.sort((E,M)=>_[E]-_[M]||d[M]-d[E]),y}getSortedIndexesByZOffset(){if(!this.zOffsetSortDirty)return this.symbolInstanceIndexesSortedZOffset;if(!this.symbolInstanceIndexesSortedZOffset){this.symbolInstanceIndexesSortedZOffset=[];for(let n=0;n<this.symbolInstances.length;++n)this.symbolInstanceIndexesSortedZOffset.push(n)}return this.zOffsetSortDirty=!1,this.symbolInstanceIndexesSortedZOffset.sort((n,o)=>this.symbolInstances.get(o).zOffset-this.symbolInstances.get(n).zOffset)}addToSortKeyRanges(n,o){const u=this.sortKeyRanges[this.sortKeyRanges.length-1];u&&u.sortKey===o?u.symbolInstanceEnd=n+1:this.sortKeyRanges.push({sortKey:o,symbolInstanceStart:n,symbolInstanceEnd:n+1})}sortFeatures(n){if(this.sortFeaturesByY&&this.sortedAngle!==n&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(n),this.sortedAngle=n,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const o of this.symbolInstanceIndexes){const u=this.symbolInstances.get(o);this.featureSortOrder.push(u.featureIndex);const{rightJustifiedTextSymbolIndex:_,centerJustifiedTextSymbolIndex:d,leftJustifiedTextSymbolIndex:y,verticalPlacedTextSymbolIndex:E,placedIconSymbolIndex:M,verticalPlacedIconSymbolIndex:k}=u;_>=0&&this.addIndicesForPlacedSymbol(this.text,_),d>=0&&d!==_&&this.addIndicesForPlacedSymbol(this.text,d),y>=0&&y!==d&&y!==_&&this.addIndicesForPlacedSymbol(this.text,y),E>=0&&this.addIndicesForPlacedSymbol(this.text,E),M>=0&&this.addIndicesForPlacedSymbol(this.icon,M),k>=0&&this.addIndicesForPlacedSymbol(this.icon,k)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let lO,cO,lS;hn(T2,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),T2.addDynamicAttributes=S2;class uO{constructor(n){this.type=n.property.overrides?n.property.overrides.runtimeType:Cs,this.defaultValue=n}evaluate(n){if(n.formattedSection){const o=this.defaultValue.property.overrides;if(o&&o.hasOverride(n.formattedSection))return o.getOverride(n.formattedSection)}return n.feature&&n.featureState?this.defaultValue.evaluate(n.feature,n.featureState):this.defaultValue.property.specification.default}eachChild(n){this.defaultValue.isConstant()||n(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}hn(uO,"FormatSectionOverride",{omit:["defaultValue"]});const cS=()=>lS||(lS={layout:lO||(lO=new ni({"symbol-placement":new qt(st.layout_symbol["symbol-placement"]),"symbol-spacing":new qt(st.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new qt(st.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new cn(st.layout_symbol["symbol-sort-key"]),"symbol-z-order":new qt(st.layout_symbol["symbol-z-order"]),"symbol-z-elevate":new qt(st.layout_symbol["symbol-z-elevate"]),"symbol-elevation-reference":new qt(st.layout_symbol["symbol-elevation-reference"]),"icon-allow-overlap":new qt(st.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new qt(st.layout_symbol["icon-ignore-placement"]),"icon-optional":new qt(st.layout_symbol["icon-optional"]),"icon-rotation-alignment":new qt(st.layout_symbol["icon-rotation-alignment"]),"icon-size":new cn(st.layout_symbol["icon-size"]),"icon-size-scale-range":new qt(st.layout_symbol["icon-size-scale-range"]),"icon-text-fit":new cn(st.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new cn(st.layout_symbol["icon-text-fit-padding"]),"icon-image":new cn(st.layout_symbol["icon-image"]),"icon-rotate":new cn(st.layout_symbol["icon-rotate"]),"icon-padding":new qt(st.layout_symbol["icon-padding"]),"icon-keep-upright":new qt(st.layout_symbol["icon-keep-upright"]),"icon-offset":new cn(st.layout_symbol["icon-offset"]),"icon-anchor":new cn(st.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new qt(st.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new qt(st.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new qt(st.layout_symbol["text-rotation-alignment"]),"text-field":new cn(st.layout_symbol["text-field"]),"text-font":new cn(st.layout_symbol["text-font"]),"text-size":new cn(st.layout_symbol["text-size"]),"text-size-scale-range":new qt(st.layout_symbol["text-size-scale-range"]),"text-max-width":new cn(st.layout_symbol["text-max-width"]),"text-line-height":new cn(st.layout_symbol["text-line-height"]),"text-letter-spacing":new cn(st.layout_symbol["text-letter-spacing"]),"text-justify":new cn(st.layout_symbol["text-justify"]),"text-radial-offset":new cn(st.layout_symbol["text-radial-offset"]),"text-variable-anchor":new qt(st.layout_symbol["text-variable-anchor"]),"text-anchor":new cn(st.layout_symbol["text-anchor"]),"text-max-angle":new qt(st.layout_symbol["text-max-angle"]),"text-writing-mode":new qt(st.layout_symbol["text-writing-mode"]),"text-rotate":new cn(st.layout_symbol["text-rotate"]),"text-padding":new qt(st.layout_symbol["text-padding"]),"text-keep-upright":new qt(st.layout_symbol["text-keep-upright"]),"text-transform":new cn(st.layout_symbol["text-transform"]),"text-offset":new cn(st.layout_symbol["text-offset"]),"text-allow-overlap":new qt(st.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new qt(st.layout_symbol["text-ignore-placement"]),"text-optional":new qt(st.layout_symbol["text-optional"]),visibility:new qt(st.layout_symbol.visibility)})),paint:cO||(cO=new ni({"icon-opacity":new cn(st.paint_symbol["icon-opacity"]),"icon-occlusion-opacity":new cn(st.paint_symbol["icon-occlusion-opacity"]),"icon-emissive-strength":new cn(st.paint_symbol["icon-emissive-strength"]),"text-emissive-strength":new cn(st.paint_symbol["text-emissive-strength"]),"icon-color":new cn(st.paint_symbol["icon-color"]),"icon-halo-color":new cn(st.paint_symbol["icon-halo-color"]),"icon-halo-width":new cn(st.paint_symbol["icon-halo-width"]),"icon-halo-blur":new cn(st.paint_symbol["icon-halo-blur"]),"icon-translate":new qt(st.paint_symbol["icon-translate"]),"icon-translate-anchor":new qt(st.paint_symbol["icon-translate-anchor"]),"icon-image-cross-fade":new cn(st.paint_symbol["icon-image-cross-fade"]),"text-opacity":new cn(st.paint_symbol["text-opacity"]),"text-occlusion-opacity":new cn(st.paint_symbol["text-occlusion-opacity"]),"text-color":new cn(st.paint_symbol["text-color"],{runtimeType:pa,getOverride:c=>c.textColor,hasOverride:c=>!!c.textColor}),"text-halo-color":new cn(st.paint_symbol["text-halo-color"]),"text-halo-width":new cn(st.paint_symbol["text-halo-width"]),"text-halo-blur":new cn(st.paint_symbol["text-halo-blur"]),"text-translate":new qt(st.paint_symbol["text-translate"]),"text-translate-anchor":new qt(st.paint_symbol["text-translate-anchor"]),"icon-color-saturation":new qt(st.paint_symbol["icon-color-saturation"]),"icon-color-contrast":new qt(st.paint_symbol["icon-color-contrast"]),"icon-color-brightness-min":new qt(st.paint_symbol["icon-color-brightness-min"]),"icon-color-brightness-max":new qt(st.paint_symbol["icon-color-brightness-max"]),"symbol-z-offset":new cn(st.paint_symbol["symbol-z-offset"]),"icon-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"}),"icon-halo-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"}),"text-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"}),"text-halo-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"})}))},lS);class E2 extends Vi{constructor(n,o,u,_){super(n,cS(),o,u,_),this._colorAdjustmentMatrix=Ne.mat4.identity([]),this.hasInitialOcclusionOpacityProperties=n.paint!==void 0&&("icon-occlusion-opacity"in n.paint||"text-occlusion-opacity"in n.paint)}recalculate(n,o){super.recalculate(n,o),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const u=this.layout.get("text-writing-mode");if(u){const _=[];for(const d of u)_.indexOf(d)<0&&_.push(d);this.layout._values["text-writing-mode"]=_}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getColorAdjustmentMatrix(n,o,u,_){return this._saturation===n&&this._contrast===o&&this._brightnessMin===u&&this._brightnessMax===_||(this._colorAdjustmentMatrix=function(d,y,E,M){d=Qu(d),y=lf(y);const k=Ne.mat4.create(),w=d/3,I=1-2*w,D=[I,w,w,0,w,I,w,0,w,w,I,0,0,0,0,1],C=.5-.5*y,P=M-E;return Ne.mat4.multiply(k,[P,0,0,0,0,P,0,0,0,0,P,0,E,E,E,1],[y,0,0,0,0,y,0,0,0,0,y,0,C,C,C,1]),Ne.mat4.multiply(k,k,D),k}(n,o,u,_),this._saturation=n,this._contrast=o,this._brightnessMin=u,this._brightnessMax=_),this._colorAdjustmentMatrix}getValueAndResolveTokens(n,o,u,_){const d=this.layout.get(n).evaluate(o,{},u,_),y=this._unevaluatedLayout._values[n];return y.isDataDriven()||gh(y.value)||!d?d:function(E,M){return M.replace(/{([^{}]+)}/g,(k,w)=>w in E?String(E[w]):"")}(o.properties,d)}createBucket(n){return new T2(n)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const n of cS().paint.overridableProperties){if(!E2.hasPaintOverride(this.layout,n))continue;const o=this.paint.get(n),u=new uO(o),_=new rp(u,o.property.specification,this.scope,this.options);let d=null;d=o.value.kind==="constant"||o.value.kind==="source"?new yh("source",_):new Pl("composite",_,o.value.zoomStops,o.value._interpolationType),this.paint._values[n]=new Mc(o.property,d,o.parameters)}}_handleOverridablePaintPropertyUpdate(n,o,u){return!(!this.layout||o.isDataDriven()||u.isDataDriven())&&E2.hasPaintOverride(this.layout,n)}static hasPaintOverride(n,o){const u=n.get("text-field"),_=cS().paint.properties[o];let d=!1;const y=E=>{for(const M of E)if(_.overrides&&_.overrides.hasOverride(M))return void(d=!0)};if(u.value.kind==="constant"&&u.value.value instanceof ta)y(u.value.value.sections);else if(u.value.kind==="source"){const E=k=>{d||(k instanceof _a&&ai(k.value)===ko?y(k.value.sections):k instanceof ac?y(k.sections):k.eachChild(E))},M=u.value;M._styleExpression&&E(M._styleExpression.expression)}return d}getProgramIds(){return["symbol"]}getDefaultProgramParams(n,o,u){return{config:new il(this,{zoom:o,lut:u}),overrideFog:!1}}}let hO,fO,dO,pO;var uS=br([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);function hS(c){switch(c){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.RGBA;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.DEPTH_COMPONENT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.DEPTH_STENCIL;case WebGL2RenderingContext.R8:case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.RED}}function fS(c){switch(c){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.UNSIGNED_SHORT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.UNSIGNED_INT_24_8;case WebGL2RenderingContext.R8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.FLOAT}}class dS{constructor(n,o,u,_){this.context=n,this.format=u,this.useMipmap=_&&_.useMipmap,this.texture=n.gl.createTexture(),this.update(o,{premultiply:_&&_.premultiply})}update(n,o){const u=n&&n instanceof HTMLVideoElement&&n.width===0?n.videoWidth:n.width,_=n&&n instanceof HTMLVideoElement&&n.height===0?n.videoHeight:n.height,{context:d}=this,{gl:y}=d,{x:E,y:M}=o&&o.position?o.position:{x:0,y:0},k=E+u,w=M+_;!this.size||this.size[0]===k&&this.size[1]===w||(y.bindTexture(y.TEXTURE_2D,null),y.deleteTexture(this.texture),this.texture=y.createTexture(),this.size=null),y.bindTexture(y.TEXTURE_2D,this.texture),d.pixelStoreUnpackFlipY.set(!1),d.pixelStoreUnpack.set(1),d.pixelStoreUnpackPremultiplyAlpha.set(this.format===y.RGBA8&&(!o||o.premultiply!==!1));const I=n instanceof HTMLImageElement||n instanceof HTMLCanvasElement||n instanceof HTMLVideoElement||n instanceof ImageData||ImageBitmap&&n instanceof ImageBitmap;if(!this.size&&k>0&&w>0){const D=this.useMipmap?Math.floor(Math.log2(Math.max(k,w)))+1:1;y.texStorage2D(y.TEXTURE_2D,D,this.format,k,w),this.size=[k,w]}if(this.size)if(I)y.texSubImage2D(y.TEXTURE_2D,0,E,M,hS(this.format),fS(this.format),n);else{const D=n.data;D&&y.texSubImage2D(y.TEXTURE_2D,0,E,M,u,_,hS(this.format),fS(this.format),D)}this.useMipmap&&y.generateMipmap(y.TEXTURE_2D)}bind(n,o,u=!1){const{context:_}=this,{gl:d}=_;d.bindTexture(d.TEXTURE_2D,this.texture),n!==this.minFilter&&(d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,n),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,this.useMipmap&&!u?n===d.NEAREST?d.NEAREST_MIPMAP_NEAREST:d.LINEAR_MIPMAP_LINEAR:n),this.minFilter=n),o!==this.wrapS&&(d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,o),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,o),this.wrapS=o)}bindExtraParam(n,o,u,_){const{context:d}=this,{gl:y}=d;y.bindTexture(y.TEXTURE_2D,this.texture),o!==this.magFilter&&(y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MAG_FILTER,o),this.magFilter=o),n!==this.minFilter&&(y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MIN_FILTER,this.useMipmap?n===y.NEAREST?y.NEAREST_MIPMAP_NEAREST:y.LINEAR_MIPMAP_LINEAR:n),this.minFilter=n),u!==this.wrapS&&(y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_S,u),this.wrapS=u),_!==this.wrapT&&(y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_T,_),this.wrapT=_)}destroy(){const{gl:n}=this.context;n.deleteTexture(this.texture),this.texture=null}}class A2{constructor(n,o){this.context=n,this.texture=o}bind(n,o){const{context:u}=this,{gl:_}=u;_.bindTexture(_.TEXTURE_2D,this.texture),n!==this.minFilter&&(_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MAG_FILTER,n),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MIN_FILTER,n),this.minFilter=n),o!==this.wrapS&&(_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_S,o),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_T,o),this.wrapS=o)}}function C2(c,n,o,u,_,d,y,E){const M=[c,n,1,o,u,1,_,d,1],k=[y,E,1],w=Ne.mat3.adjoint([],M),[I,D,C]=Ne.vec3.transformMat3(k,k,w);return Ne.mat3.multiply(M,M,[I,0,0,0,D,0,0,0,C])}function mO(c,n,o,u,_,d,y,E){const M=function(k,w,I,D,C,P,B,q){const H=C2(0,0,1,0,1,1,0,1),te=C2(k,w,I,D,C,P,B,q),re=Ne.mat3.adjoint([],H);return Ne.mat3.multiply(te,te,re)}(c,n,o,u,_,d,y,E);return[M[2]/M[8]/Kt,M[5]/M[8]/Kt]}function M2(c){return[c[0],Math.min(Math.max(c[1],-85.051129),Br)]}class _O extends bl{constructor(n,o,u,_){super(),this.id=n,this.dispatcher=u,this.coordinates=o.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.onNorthPole=!1,this.onSouthPole=!1,this.setEventedParent(_),this.options=o,this._dirty=!1}load(n,o){if(this._loaded=o||!1,this.fire(new As("dataloading",{dataType:"source"})),this.url=this.options.url,!this.url)return n&&(this.coordinates=n),this._loaded=!0,void this._finishLoading();this._imageRequest=Bd(this.map._requestManager.transformRequest(this.url,vr.Image),(u,_)=>{this._imageRequest=null,this._loaded=!0,u?this.fire(new vl(u)):_&&(this.image=_ instanceof HTMLImageElement?ze.getImageData(_):_,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,n&&(this.coordinates=n),this._finishLoading())})}loaded(){return this._loaded}updateImage(n){return n.url?(this._imageRequest&&n.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=n.url,this.load(n.coordinates,this._loaded),this):this}setTexture(n){if(!(n.handle instanceof WebGLTexture))throw new Error("The provided handle is not a WebGLTexture instance");return this.texture=new A2(this.map.painter.context,n.handle),this.width=n.dimensions[0],this.height=n.dimensions[1],this._dirty=!1,this._loaded=!0,this._finishLoading(),this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new As("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(n){this.map=n,this.load()}onRemove(n){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),!this.texture||this.texture instanceof A2||this.texture.destroy(),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy())}setCoordinates(n){if(this.coordinates=n,this._boundsArray=void 0,this._unsupportedCoords=!1,!n.length)return this;this.onNorthPole=!1,this.onSouthPole=!1;let o=n[0][1],u=n[0][1];for(const d of n)d[1]>u&&(u=d[1]),d[1]<o&&(o=d[1]);const _=(u+o)/2;if(_>Br?this.onNorthPole=!0:_<-85.051129&&(this.onSouthPole=!0),!this.onNorthPole&&!this.onSouthPole){const d=n.map(l.fromLngLat);this.tileID=function(y){let E=1/0,M=1/0,k=-1/0,w=-1/0;for(const B of y)E=Math.min(E,B.x),M=Math.min(M,B.y),k=Math.max(k,B.x),w=Math.max(w,B.y);const I=Math.max(k-E,w-M),D=Math.max(0,Math.floor(-Math.log(I)/Math.LN2)),C=Math.pow(2,D);let P=Math.floor((E+k)/2*C);return P>1&&(P-=1),new Pt(D,P,Math.floor((M+w)/2*C))}(d),this.minzoom=this.maxzoom=this.tileID.z}return this.fire(new As("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0,this._unsupportedCoords=!1}_prepareData(n){for(const H in this.tiles){const te=this.tiles[H];te.state!=="loaded"&&(te.state="loaded",te.texture=this.texture)}if(this._boundsArray||this.onNorthPole||this.onSouthPole||this._unsupportedCoords)return;const o=Oy(new Pt(0,0,0),this.map.transform.projection),u=[o.projection.project(this.coordinates[0][0],this.coordinates[0][1]),o.projection.project(this.coordinates[1][0],this.coordinates[1][1]),o.projection.project(this.coordinates[2][0],this.coordinates[2][1]),o.projection.project(this.coordinates[3][0],this.coordinates[3][1])];if(!function(H){const te=H[1].x-H[0].x,re=H[1].y-H[0].y,J=H[2].x-H[1].x,ie=H[2].y-H[1].y,ce=H[3].x-H[2].x,me=H[3].y-H[2].y,Ce=H[0].x-H[3].x,Ae=H[0].y-H[3].y,Ee=te*ie-J*re,Ue=J*me-ce*ie,Ie=ce*Ae-Ce*me,Ve=Ce*re-te*Ae;return Ee>0&&Ue>0&&Ie>0&&Ve>0||Ee<0&&Ue<0&&Ie<0&&Ve<0}(u))return console.warn("Image source coordinates are defining non-convex area in the Mercator projection"),void(this._unsupportedCoords=!0);const _=Oy(this.tileID,this.map.transform.projection),[d,y,E,M]=this.coordinates.map(H=>{const te=_.projection.project(H[0],H[1]);return nO(_,te)._round()});this.perspectiveTransform=mO(d.x,d.y,y.x,y.y,E.x,E.y,M.x,M.y);const k=this._boundsArray=new Ls;k.emplaceBack(d.x,d.y,0,0),k.emplaceBack(y.x,y.y,Kt,0),k.emplaceBack(M.x,M.y,0,Kt),k.emplaceBack(E.x,E.y,Kt,Kt),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy()),this.boundsBuffer=n.createVertexBuffer(k,uS.members),this.boundsSegments=ci.simpleSegment(0,0,4,2);const w=[],I=[M2((D=this.coordinates)[0]),M2(D[1]),M2(D[2]),M2(D[3])];var D;const[C,P,B,q]=function(H){let te=H[0][0],re=te,J=H[0][1],ie=J;for(let ce=1;ce<H.length;ce++)H[ce][0]<te?te=H[ce][0]:H[ce][0]>re&&(re=H[ce][0]),H[ce][1]<J?J=H[ce][1]:H[ce][1]>ie&&(ie=H[ce][1]);return[te,J,re-te,ie-J]}(I);{const H=new Ls,[te,re,J,ie]=function(Qe){let at=Qe[0].x,Je=at,wt=Qe[0].y,Rt=wt;for(let bt=1;bt<Qe.length;bt++)Qe[bt].x<at?at=Qe[bt].x:Qe[bt].x>Je&&(Je=Qe[bt].x),Qe[bt].y<wt?wt=Qe[bt].y:Qe[bt].y>Rt&&(Rt=Qe[bt].y);return[at,wt,Je-at,Rt-wt]}(u),ce=Qe=>[(Qe.x-te)/J,(Qe.y-re)/ie],[me,Ce,Ae,Ee]=u.map(ce),Ue=function(Qe,at,Je,wt,Rt,bt,an,Jt){const Ut=C2(0,0,1,0,1,1,0,1),zt=C2(Qe,at,Je,wt,Rt,bt,an,Jt),vn=Ne.mat3.adjoint([],zt);return Ne.mat3.multiply(Ut,Ut,vn)}(me[0],me[1],Ce[0],Ce[1],Ae[0],Ae[1],Ee[0],Ee[1]);this.elevatedGlobePerspectiveTransform=mO(me[0],me[1],Ce[0],Ce[1],Ae[0],Ae[1],Ee[0],Ee[1]);const Ie=(Qe,at)=>{w.push(Qe.lng);const Je=Math.round((Qe.lng-C)/B*Kt),wt=Math.round((Qe.lat-P)/q*Kt),Rt=ce(at),bt=Ne.vec3.transformMat3([],[Rt[0],Rt[1],1],Ue),an=Math.round(bt[0]/bt[2]*Kt),Jt=Math.round(bt[1]/bt[2]*Kt);H.emplaceBack(Je,wt,an,Jt)},Ve=u[3].x-u[0].x,Ze=u[3].y-u[0].y,qe=u[2].x-u[1].x,Ke=u[2].y-u[1].y;for(let Qe=0;Qe<65;Qe++){const at=Qe/64,Je=[u[0].x+at*Ve,u[0].y+at*Ze],wt=[u[1].x+at*qe,u[1].y+at*Ke],Rt=wt[0]-Je[0],bt=wt[1]-Je[1];for(let an=0;an<65;an++){const Jt=an/64,Ut={x:Je[0]+Rt*Jt,y:Je[1]+bt*Jt};Ie(o.projection.unproject(Ut.x,Ut.y),Ut)}}this.elevatedGlobeVertexBuffer=n.createVertexBuffer(H,uS.members)}{this.maxLongitudeTriangleSize=0;let H=[],te=new ia;const re=(J,ie,ce)=>{te.emplaceBack(J,ie,ce);const me=w[J],Ce=w[ie],Ae=w[ce],Ee=Math.min(Math.min(me,Ce),Ae),Ue=Math.max(Math.max(me,Ce),Ae)-Ee;Ue>this.maxLongitudeTriangleSize&&(this.maxLongitudeTriangleSize=Ue),H.push(Ee+Ue/2)};for(let J=0;J<64;J++)for(let ie=0;ie<64;ie++){const ce=65*J+ie,me=ce+1,Ce=ce+65,Ae=Ce+1;re(ce,Ce,me),re(me,Ce,Ae)}[H,te]=function(J,ie){const ce=Array.from({length:J.length},(Ae,Ee)=>Ee);ce.sort((Ae,Ee)=>J[Ae]-J[Ee]);const me=[],Ce=new ia;for(let Ae=0;Ae<ce.length;Ae++){const Ee=ce[Ae];me.push(J[Ee]);const Ue=3*Ee,Ie=Ue+1;Ce.emplaceBack(ie.uint16[Ue],ie.uint16[Ie],ie.uint16[Ie+1])}return[me,Ce]}(H,te),this.elevatedGlobeTrianglesCenterLongitudes=H,this.elevatedGlobeIndexBuffer=n.createIndexBuffer(te)}this.elevatedGlobeSegments=ci.simpleSegment(0,0,4225,8192),this.elevatedGlobeGridMatrix=new Float32Array([0,B/Kt,0,q/Kt,0,0,P,C,0])}prepare(){const n=Object.keys(this.tiles).length!==0;if(this.tileID&&!n)return;const o=this.map.painter.context,u=o.gl;!this._dirty||this.texture instanceof A2||(this.texture?this.texture.update(this.image):(this.texture=new dS(o,this.image,u.RGBA8),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE)),this._dirty=!1),n&&this._prepareData(o)}loadTile(n,o){this.tileID&&this.tileID.equals(n.tileID.canonical)?(this.tiles[String(n.tileID.wrap)]=n,n.buckets={},o(null)):(n.state="errored",o(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}getSegmentsForLongitude(n){const o=this.elevatedGlobeSegments;if(!this.elevatedGlobeTrianglesCenterLongitudes||!o)return null;const u=this.elevatedGlobeTrianglesCenterLongitudes;let _=(d=n+180)+360*Math.round((u[0]-d)/360);var d;const y=new ci,E=(I,D)=>{y.segments.push({vertexOffset:0,primitiveOffset:I,vertexLength:o.segments[0].vertexLength,primitiveLength:D,sortKey:void 0,vaos:{}})},M=.51*this.maxLongitudeTriangleSize;if(Math.abs(u[0]-_)<=M){const I=au(u,0,u.length,_+M);return I===u.length||E(I,kd(u,I+1,u.length,_+360-M)-I),y}_<u[0]&&(_+=360);const k=kd(u,0,u.length,_-M);if(k===u.length)return E(0,u.length),y;E(0,k-0);const w=au(u,k+1,u.length,_+M);return w!==u.length&&E(w,u.length-w),y}}const _j=(Math.pow(256,2)-1)/16907520;class gO extends Vi{constructor(n,o,u,_){super(n,{layout:dO||(dO=new ni({visibility:new qt(st.layout_raster.visibility)})),paint:pO||(pO=new ni({"raster-opacity":new qt(st.paint_raster["raster-opacity"]),"raster-color":new Su(st.paint_raster["raster-color"]),"raster-color-mix":new qt(st.paint_raster["raster-color-mix"]),"raster-color-range":new qt(st.paint_raster["raster-color-range"]),"raster-hue-rotate":new qt(st.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new qt(st.paint_raster["raster-brightness-min"]),"raster-brightness-max":new qt(st.paint_raster["raster-brightness-max"]),"raster-saturation":new qt(st.paint_raster["raster-saturation"]),"raster-contrast":new qt(st.paint_raster["raster-contrast"]),"raster-resampling":new qt(st.paint_raster["raster-resampling"]),"raster-fade-duration":new qt(st.paint_raster["raster-fade-duration"]),"raster-emissive-strength":new qt(st.paint_raster["raster-emissive-strength"]),"raster-array-band":new qt(st.paint_raster["raster-array-band"]),"raster-elevation":new qt(st.paint_raster["raster-elevation"]),"raster-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"})}))},o,u,_),this.updateColorRamp(),this._curRampRange=[NaN,NaN]}getProgramIds(){return["raster"]}hasColorMap(){return!!this._transitionablePaint._values["raster-color"].value.value}tileCoverLift(){return this.paint.get("raster-elevation")}isDraped(n){return!(n&&n._source instanceof _O&&(n._source.onNorthPole||n._source.onSouthPole))&&this.paint.get("raster-elevation")===0}_handleSpecialPaintPropertyUpdate(n){n!=="raster-color"&&n!=="raster-color-range"||(this._curRampRange=[NaN,NaN],this.updateColorRamp())}updateColorRamp(n){if(!this.hasColorMap()||!this._curRampRange)return;const o=this._transitionablePaint._values["raster-color"].value.expression,[u,_]=n||this._transitionablePaint._values["raster-color-range"].value.expression.evaluate({zoom:0})||[NaN,NaN];isNaN(u)&&isNaN(_)||u===this._curRampRange[0]&&_===this._curRampRange[1]||(this.colorRamp=Jf({expression:o,evaluationKey:"rasterValue",image:this.colorRamp,clips:[{start:u,end:_}],resolution:256}),this.colorRampTexture=null,this._curRampRange=[u,_])}}let yO,vO,xO,bO,wO;class SO extends Vi{constructor(n,o,u,_){super(n,{layout:yO||(yO=new ni({visibility:new qt(st["layout_raster-particle"].visibility)})),paint:vO||(vO=new ni({"raster-particle-array-band":new qt(st["paint_raster-particle"]["raster-particle-array-band"]),"raster-particle-count":new qt(st["paint_raster-particle"]["raster-particle-count"]),"raster-particle-color":new Su(st["paint_raster-particle"]["raster-particle-color"]),"raster-particle-max-speed":new qt(st["paint_raster-particle"]["raster-particle-max-speed"]),"raster-particle-speed-factor":new qt(st["paint_raster-particle"]["raster-particle-speed-factor"]),"raster-particle-fade-opacity-factor":new qt(st["paint_raster-particle"]["raster-particle-fade-opacity-factor"]),"raster-particle-reset-rate-factor":new qt(st["paint_raster-particle"]["raster-particle-reset-rate-factor"]),"raster-particle-elevation":new qt(st["paint_raster-particle"]["raster-particle-elevation"]),"raster-particle-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"})}))},o,u,_),this._updateColorRamp(),this.lastInvalidatedAt=ze.now()}onRemove(n){this.colorRampTexture&&this.colorRampTexture.destroy(),this.tileFramebuffer&&this.tileFramebuffer.destroy(),this.particleFramebuffer&&this.particleFramebuffer.destroy()}hasColorMap(){return!!this._transitionablePaint._values["raster-particle-color"].value.value}getProgramIds(){return["rasterParticle"]}hasOffscreenPass(){return this.visibility!=="none"}isDraped(n){return!1}_handleSpecialPaintPropertyUpdate(n){n!=="raster-particle-color"&&n!=="raster-particle-max-speed"||(this._updateColorRamp(),this._invalidateAnimationState()),n==="raster-particle-count"&&this._invalidateAnimationState()}_updateColorRamp(){if(!this.hasColorMap())return;const n=this._transitionablePaint._values["raster-particle-color"].value.expression,o=this._transitionablePaint._values["raster-particle-max-speed"].value.expression.evaluate({zoom:0});this.colorRamp=Jf({expression:n,evaluationKey:"rasterParticleSpeed",image:this.colorRamp,clips:[{start:0,end:o}],resolution:256}),this.colorRampTexture=null}_invalidateAnimationState(){this.lastInvalidatedAt=ze.now()}tileCoverLift(){return this.paint.get("raster-particle-elevation")}}class gj extends Vi{constructor(n,o){super(n,{},o,null),this.implementation=n,n.slot&&(this.slot=n.slot)}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isDraped(n){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(n){this.implementation.onAdd&&this.implementation.onAdd(n,n.painter.context.gl)}onRemove(n){this.implementation.onRemove&&this.implementation.onRemove(n,n.painter.context.gl)}}function pS(c,n,o){const u=[0,0,1],_=Ne.quat.identity([]);return Ne.quat.rotateY(_,_,o?-$n(c)+Math.PI:$n(c)),Ne.quat.rotateX(_,_,-$n(n)),Ne.vec3.transformQuat(u,u,_),Ne.vec3.normalize(u,u)}function TO(c,n){const o=O2(c.projection,c.zoom,c.width,c.height),u=function(d,y,E,M,k){const w=new pr(E.lng-180*Rp,E.lat),I=new pr(E.lng+180*Rp,E.lat),D=d.project(w.lng,w.lat),C=d.project(I.lng,I.lat),P=-Math.atan2(C.y-D.y,C.x-D.x),B=l.fromLngLat(E);B.y=Bn(B.y,-1+Rp,1-Rp);const q=B.toLngLat(),H=d.project(q.lng,q.lat),te=l.fromLngLat(q);te.x+=Rp;const re=te.toLngLat(),J=d.project(re.lng,re.lat),ie=AO(J.x-H.x,J.y-H.y,P),ce=l.fromLngLat(q);ce.y+=Rp;const me=ce.toLngLat(),Ce=d.project(me.lng,me.lat),Ae=AO(Ce.x-H.x,Ce.y-H.y,P),Ee=Math.abs(ie.x)/Math.abs(Ae.y),Ue=Ne.mat4.identity([]);Ne.mat4.rotateZ(Ue,Ue,-P*(1-(k?0:M)));const Ie=Ne.mat4.identity([]);return Ne.mat4.scale(Ie,Ie,[1,1-(1-Ee)*M,1]),Ie[4]=-Ae.x/Ae.y*M,Ne.mat4.rotateZ(Ie,Ie,P),Ne.mat4.multiply(Ie,Ue,Ie),Ie}(c.projection,0,c.center,o,n),_=EO(c);return Ne.mat4.scale(u,u,[_,_,1]),u}function EO(c){const n=c.projection,o=O2(c.projection,c.zoom,c.width,c.height),u=mS(n,c.center),_=mS(n,pr.convert(n.center));return Math.pow(2,u*o+(1-o)*_)}function O2(c,n,o,u,_=1/0){const d=c.range;if(!d)return 0;const y=Math.min(_,Math.max(o,u)),E=Math.log(y/1024)/Math.LN2;return Lo(d[0]+E,d[1]+E,n)}const Rp=1/4e4;function mS(c,n){const o=Bn(n.lat,-85.051129,Br),u=new pr(n.lng-180*Rp,o),_=new pr(n.lng+180*Rp,o),d=c.project(u.lng,o),y=c.project(_.lng,o),E=l.fromLngLat(u),M=l.fromLngLat(_),k=y.x-d.x,w=y.y-d.y,I=M.x-E.x,D=M.y-E.y,C=Math.sqrt((I*I+D*D)/(k*k+w*w));return Math.log(C)/Math.LN2}function AO(c,n,o){const u=Math.cos(o),_=Math.sin(o);return{x:c*u-n*_,y:c*_+n*u}}function CO(c,n,o){Ne.mat4.identity(c),Ne.mat4.rotateZ(c,c,$n(n[2])),Ne.mat4.rotateX(c,c,$n(n[0])),Ne.mat4.rotateY(c,c,$n(n[1])),Ne.mat4.scale(c,c,o),Ne.mat4.multiply(c,c,[1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1])}function I2(c,n,o,u,_,d,y,E){const M=[o[0]-n[0],o[1]-n[1],0],k=[u[0]-n[0],u[1]-n[1],0];if(Ne.vec3.length(M)<1e-12||Ne.vec3.length(k)<1e-12)return Ne.quat.identity(c);const w=Ne.vec3.cross([],M,k);Ne.vec3.normalize(w,w),Ne.vec3.subtract(k,u,n),M[2]=(d-_)*E,k[2]=(y-_)*E;const I=M;return Ne.vec3.cross(I,M,k),Ne.vec3.normalize(I,I),Ne.quat.rotationTo(c,w,I)}function _S(c,n,o=!1){const u=ka(n.zoom),_=function(d,y,E){const M=y.worldSize,k=[d[12],d[13],d[14]],w=$i(k[1]/M),I=Ja(k[0]/M),D=Ne.mat4.identity([]),C=za(1,w)*M,P=za(1,0)*M*Ru(w,y.zoom),B=1/bi(M);let q=P*B;if(E){const J=O2(y.projection,y.zoom,y.width,y.height,1024);q=B*y.projection.pixelSpaceConversion(y.center.lat,M,J)}const H=kc(w,I);Ne.vec3.add(H,H,Ne.vec3.scale([],Ne.vec3.normalize([],H),C*q*k[2]));const te=function(J){const ie=[J[0],J[1],J[2]];let ce=[0,1,0];const me=Ne.vec3.cross([],ce,ie);return Ne.vec3.cross(ce,ie,me),Ne.vec3.squaredLength(ce)===0&&(ce=[0,1,0],Ne.vec3.cross(me,ie,ce)),Ne.vec3.normalize(me,me),Ne.vec3.normalize(ce,ce),Ne.vec3.normalize(ie,ie),[me[0],me[1],me[2],0,ce[0],ce[1],ce[2],0,ie[0],ie[1],ie[2],0,J[0],J[1],J[2],1]}(H);Ne.mat4.scale(D,D,[q,q,q*C]),Ne.mat4.translate(D,D,[-k[0],-k[1],-k[2]]);const re=Ne.mat4.multiply([],y.globeMatrix,te);return Ne.mat4.multiply(re,re,D),Ne.mat4.multiply(re,re,d),re}(c,n,o);if(u>0){const d=function(y,E){const M=E.worldSize,k=za(1,0)*M*Ru(E.center.lat,E.zoom)/bi(M),w=za(1,E.center.lat)*M,I=Ne.mat4.identity([]);return Ne.mat4.rotateY(I,I,$n(E.center.lng)),Ne.mat4.rotateX(I,I,$n(E.center.lat)),Ne.mat4.translate(I,I,[0,0,La]),Ne.mat4.scale(I,I,[k,k,k*w]),Ne.mat4.translate(I,I,[E.point.x-.5*M,E.point.y-.5*M,0]),Ne.mat4.multiply(I,I,y),Ne.mat4.multiply(I,E.globeMatrix,I)}(c,n);return function(y,E,M){const k=(P,B,q)=>{const H=Ne.vec3.length(P),te=Ne.vec3.length(B),re=hi(P,B,q);return Ne.vec3.scale(re,re,1/Ne.vec3.length(re)*Mn(H,te,q))},w=k([y[0],y[1],y[2]],[E[0],E[1],E[2]],M),I=k([y[4],y[5],y[6]],[E[4],E[5],E[6]],M),D=k([y[8],y[9],y[10]],[E[8],E[9],E[10]],M),C=hi([y[12],y[13],y[14]],[E[12],E[13],E[14]],M);return[w[0],w[1],w[2],0,I[0],I[1],I[2],0,D[0],D[1],D[2],0,C[0],C[1],C[2],1]}(_,d,u)}return _}function MO(c,n,o,u){const _=sn.projectAabbCorners(u,o);let d=Number.MAX_VALUE,y=-1;for(let k=0;k<_.length;++k){const w=_[k];w[0]=(.5*w[0]+.5)*n.width,w[1]=(.5-.5*w[1])*n.height,w[2]<d&&(y=k,d=w[2])}const E=k=>new It(_[k][0],_[k][1]);let M;switch(y){case 0:case 6:M=[E(1),E(5),E(4),E(7),E(3),E(2),E(1)];break;case 1:case 7:M=[E(0),E(4),E(5),E(6),E(2),E(3),E(0)];break;case 3:case 5:M=[E(1),E(0),E(4),E(7),E(6),E(2),E(1)];break;default:M=[E(1),E(5),E(6),E(7),E(3),E(0),E(1)]}if(oe(c,M))return d}const yj=br([{name:"a_pos_3f",components:3,type:"Float32"}]),vj=br([{name:"a_color_3f",components:3,type:"Float32"}]),xj=br([{name:"a_color_4f",components:4,type:"Float32"}]),bj=br([{name:"a_uv_2f",components:2,type:"Float32"}]),wj=br([{name:"a_normal_3f",components:3,type:"Float32"}]),Sj=br([{name:"a_normal_matrix0",components:4,type:"Float32"},{name:"a_normal_matrix1",components:4,type:"Float32"},{name:"a_normal_matrix2",components:4,type:"Float32"},{name:"a_normal_matrix3",components:4,type:"Float32"}]),Tj=br([{name:"a_pbr",components:4,type:"Uint16"},{name:"a_heightBasedEmissiveStrength",components:3,type:"Float32"}]),OO={None:0,Model:1,Symbol:2,FillExtrusion:4,All:7};class P2{constructor(n,o,u,_){this.message=(n?`${n}: `:"")+u,_&&(this.identifier=_),o!=null&&o.__line__&&(this.line=o.__line__)}}function IO(c,n){const o=c.indexOf("://")===-1;try{return new URL(c,o&&n?"http://example.com":void 0),!0}catch{return!1}}class PO{constructor(n,o){this.feature=n,this.instancedDataOffset=o,this.instancedDataCount=0,this.rotation=[0,0,0],this.scale=[1,1,1],this.translation=[0,0,0]}}class RO{constructor(){this.instancedDataArray=new Dc,this.instancesEvaluatedElevation=[],this.features=[],this.idToFeaturesIndex={}}}class gS{constructor(n){this.zoom=n.zoom,this.canonical=n.canonical,this.layers=n.layers,this.layerIds=this.layers.map(o=>o.fqid),this.projection=n.projection,this.index=n.index,this.hasZoomDependentProperties=this.layers[0].isZoomDependent(),this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id),this.hasPattern=!1,this.instancesPerModel={},this.validForExaggeration=0,this.maxVerticalOffset=0,this.maxScale=0,this.maxHeight=0,this.lookupDim=this.zoom>this.canonical.z?256:this.zoom>15?75:100,this.instanceCount=0,this.terrainElevationMin=0,this.terrainElevationMax=0,this.validForDEMTile={id:null,timestamp:0},this.modelUris=[],this.modelsRequested=!1,this.activeReplacements=[],this.replacementUpdateTime=0}updateFootprints(n,o){}populate(n,o,u,_){this.tileToMeter=r(u);const d=this.layers[0]._featureFilter.needGeometry;this.lookup=new Uint8Array(this.lookupDim*this.lookupDim);for(const{feature:y,id:E,index:M,sourceLayerIndex:k}of n){const w=E??(y.properties&&y.properties.hasOwnProperty("id")?y.properties.id:void 0),I=Z(y,d);if(!this.layers[0]._featureFilter.filter(new kr(this.zoom),I,u))continue;const D={id:w,sourceLayerIndex:k,index:M,geometry:d?I.geometry:$(y,u,_),properties:y.properties,type:y.type,patterns:{}},C=this.addFeature(D,D.geometry,I);C&&o.featureIndex.insert(y,D.geometry,M,k,this.index,this.instancesPerModel[C].instancedDataArray.length,Kt/32)}this.lookup=null}update(n,o,u,_){for(const d in this.instancesPerModel){const y=this.instancesPerModel[d];for(const E in n)y.idToFeaturesIndex.hasOwnProperty(E)&&(this.evaluate(y.features[y.idToFeaturesIndex[E]],n[E],y,!0),this.uploaded=!1)}this.maxHeight=0}updateZoomBasedPaintProperties(){if(!this.hasZoomDependentProperties)return!1;let n=!1;for(const o in this.instancesPerModel){const u=this.instancesPerModel[o];for(const _ of u.features){const d=this.layers[0],y=_.feature,E=this.canonical,M=d.paint.get("model-rotation").evaluate(y,{},E),k=d.paint.get("model-scale").evaluate(y,{},E),w=d.paint.get("model-translation").evaluate(y,{},E);Ne.vec3.exactEquals(_.rotation,M)&&Ne.vec3.exactEquals(_.scale,k)&&Ne.vec3.exactEquals(_.translation,w)||(this.evaluate(_,_.featureStates,u,!0),n=!0)}}return n}updateReplacement(n,o,u,_){if(o.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=o.updateTime;const d=o.getReplacementRegionsForTile(n.toUnwrapped(),!0);if(Bm(this.activeReplacements,d))return!1;this.activeReplacements=d;let y=!1;for(const E in this.instancesPerModel){const M=this.instancesPerModel[E],k=M.instancedDataArray;for(const w of M.features){const I=w.instancedDataOffset,D=w.instancedDataCount;for(let C=0;C<D;C++){const P=16*(C+I);let B=k.float32[P+0];const q=B>Kt;B=q?B-Kt:B;const H=Math.floor(B),te=k.float32[P+1];let re=!1;for(const J of this.activeReplacements)if(!s_(J,u,OO.Model,_)&&!(J.min.x>H||H>J.max.x||J.min.y>te||te>J.max.y)&&(re=e2(oy(H,te,n.canonical,J.footprintTileId.canonical),J.footprint),re))break;k.float32[P]=re?B+Kt:B,y=y||re!==q}}}return y}isEmpty(){for(const n in this.instancesPerModel)if(this.instancesPerModel[n].instancedDataArray.length!==0)return!1;return!0}uploadPending(){return!this.uploaded}upload(n){if(!this.uploaded)for(const o in this.instancesPerModel){const u=this.instancesPerModel[o];u.instancedDataArray.length<0||u.instancedDataArray.length===0||(u.instancedDataBuffer?u.instancedDataBuffer.updateData(u.instancedDataArray):u.instancedDataBuffer=n.createVertexBuffer(u.instancedDataArray,Sj.members,!0,void 0,this.instanceCount))}this.uploaded=!0}destroy(){for(const o in this.instancesPerModel){const u=this.instancesPerModel[o];u.instancedDataArray.length!==0&&u.instancedDataBuffer&&u.instancedDataBuffer.destroy()}const n=this.layers[0].modelManager;if(n&&this.modelUris)for(const o of this.modelUris)n.removeModel(o,"")}addFeature(n,o,u){const _=this.layers[0],d=_.layout.get("model-id").evaluate(u,{},this.canonical);if(!d)return qn(`modelId is not evaluated for layer ${_.id} and it is not going to get rendered.`),d;IO(d,!1)&&(this.modelUris.includes(d)||this.modelUris.push(d)),this.instancesPerModel[d]||(this.instancesPerModel[d]=new RO);const y=this.instancesPerModel[d],E=y.instancedDataArray,M=new PO(u,E.length);for(const k of o)for(const w of k){if(w.x<0||w.x>=Kt||w.y<0||w.y>=Kt)continue;const I=(this.lookupDim-1)/Kt,D=this.lookupDim*(w.y*I|0)+w.x*I|0;if(this.lookup){if(this.lookup[D]!==0)continue;this.lookup[D]=1}this.instanceCount++;const C=E.length;E.resize(C+1),y.instancesEvaluatedElevation.push(0),E.float32[16*C]=w.x,E.float32[16*C+1]=w.y}return M.instancedDataCount=y.instancedDataArray.length-M.instancedDataOffset,M.instancedDataCount>0&&(n.id&&(y.idToFeaturesIndex[n.id]=y.features.length),y.features.push(M),this.evaluate(M,{},y,!1)),d}getModelUris(){return this.modelUris}evaluate(n,o,u,_){const d=this.layers[0],y=n.feature,E=this.canonical,M=n.rotation=d.paint.get("model-rotation").evaluate(y,o,E),k=n.scale=d.paint.get("model-scale").evaluate(y,o,E),w=n.translation=d.paint.get("model-translation").evaluate(y,o,E),I=d.paint.get("model-color").evaluate(y,o,E);I.a=d.paint.get("model-color-mix-intensity").evaluate(y,o,E);const D=[];this.maxVerticalOffset<w[2]&&(this.maxVerticalOffset=w[2]),this.maxScale=Math.max(Math.max(this.maxScale,k[0]),Math.max(k[1],k[2])),CO(D,M,k);const C=Math.round(100*I.a)+I.b/1.05;for(let P=0;P<n.instancedDataCount;++P){const B=n.instancedDataOffset+P,q=16*B,H=u.instancedDataArray.float32;let te=0;_&&(te=H[q+6]-u.instancesEvaluatedElevation[B]);const re=0|H[q+1];H[q]=(0|H[q])+I.r/1.05,H[q+1]=re+I.g/1.05,H[q+2]=C,H[q+3]=1/(E.z>10?this.tileToMeter:r(E,re)),H[q+4]=w[0],H[q+5]=w[1],H[q+6]=w[2]+te,H[q+7]=D[0],H[q+8]=D[1],H[q+9]=D[2],H[q+10]=D[4],H[q+11]=D[5],H[q+12]=D[6],H[q+13]=D[8],H[q+14]=D[9],H[q+15]=D[10],u.instancesEvaluatedElevation[B]=w[2]}}}let DO,LO;hn(gS,"ModelBucket",{omit:["layers"]}),hn(RO,"PerModelAttributes"),hn(PO,"ModelFeature");const Xm=64,T_={CoordinateSpaceTile:1,CoordinateSpaceYUp:2,HasMapboxMeshFeatures:4,HasMeshoptCompression:8};function zO(c,n,o,u,_,d,y,E,M,k=!1){const w=o.zoom,I=o.project(u),D=Ru(u.lat,w),C=1/D;Ne.mat4.identity(c),Ne.mat4.translate(c,c,[I.x+y[0]*C,I.y+y[1]*C,y[2]]);let P=1,B=1;const q=o.worldSize;if(k){if(o.projection.name==="mercator"){let J=0;o.elevation&&(J=o.elevation.getAtPointOrZero(new l(I.x/q,I.y/q),0));const ie=Ne.vec4.transformMat4([],[I.x,I.y,J,1],o.projMatrix)[3]/o.cameraToCenterDistance;P=ie,B=ie*Ru(o.center.lat,w)}else if(o.projection.name==="globe"){const J=_S(c,o),ie=Ne.mat4.multiply([],o.projMatrix,J),ce=[0,0,0,1];Ne.vec4.transformMat4(ce,ce,ie);const me=ce[3]/o.cameraToCenterDistance,Ce=ka(w),Ae=o.projection.pixelsPerMeter(u.lat,q)*Ru(u.lat,w),Ee=o.projection.pixelsPerMeter(o.center.lat,q)*Ru(o.center.lat,w);P=me/Mn(Ae,Yf(o.center.lat),Ce),B=me*D/Ae,P*=Ee,B*=Ee}}else P=C;Ne.mat4.scale(c,c,[P,P,B]);const H=[...c],te=n.orientation,re=[];if(CO(re,[te[0]+_[0],te[1]+_[1],te[2]+_[2]],d),Ne.mat4.multiply(c,H,re),E&&o.elevation){let J=0;const ie=[];if(M&&o.elevation){J=function(Ce,Ae,Ee,Ue,Ie){const Ve=Ae.elevation;if(!Ve)return 0;const Ze=sn.projectAabbCorners(Ee,Ue),qe=za(1,Ie.lat)*Ae.worldSize,Ke=function(vn,ln){const pn=[0,0,1],kn=[{corners:[0,1,3,2],dotProductWithUp:0},{corners:[1,5,2,6],dotProductWithUp:0},{corners:[0,4,1,5],dotProductWithUp:0},{corners:[2,6,3,7],dotProductWithUp:0},{corners:[4,7,5,6],dotProductWithUp:0},{corners:[0,3,4,7],dotProductWithUp:0}];for(const Gn of kn){const Zn=vn[Gn.corners[0]],Wn=vn[Gn.corners[1]],lr=vn[Gn.corners[2]],ur=[Wn[0]-Zn[0],Wn[1]-Zn[1],ln*(Wn[2]-Zn[2])],Zr=Ne.vec3.cross(ur,ur,[lr[0]-Zn[0],lr[1]-Zn[1],ln*(lr[2]-Zn[2])]);Ne.vec3.normalize(Zr,Zr),Gn.dotProductWithUp=Ne.vec3.dot(Zr,pn)}return kn.sort((Gn,Zn)=>Gn.dotProductWithUp-Zn.dotProductWithUp),kn[0].corners}(Ze,qe),Qe=Ze[Ke[0]],at=Ze[Ke[1]],Je=Ze[Ke[2]],wt=Ze[Ke[3]],Rt=Ve.getAtPointOrZero(new l(Qe[0]/Ae.worldSize,Qe[1]/Ae.worldSize),0),bt=Ve.getAtPointOrZero(new l(at[0]/Ae.worldSize,at[1]/Ae.worldSize),0),an=Ve.getAtPointOrZero(new l(Je[0]/Ae.worldSize,Je[1]/Ae.worldSize),0),Jt=Ve.getAtPointOrZero(new l(wt[0]/Ae.worldSize,wt[1]/Ae.worldSize),0),Ut=(Rt+Jt)/2,zt=(bt+an)/2;return Ut>zt?bt<an?I2(Ce,at,wt,Qe,bt,Jt,Rt,qe):I2(Ce,Je,Qe,wt,an,Rt,Jt,qe):Rt<Jt?I2(Ce,Qe,at,Je,Rt,bt,an,qe):I2(Ce,wt,Je,at,Jt,an,bt,qe),Math.max(Ut,zt)}(ie,o,n.aabb,c,u);const ce=Ne.mat4.fromQuat([],ie),me=Ne.mat4.multiply([],ce,re);Ne.mat4.multiply(c,H,me)}else J=o.elevation.getAtPointOrZero(new l(I.x/q,I.y/q),0);J!==0&&(c[14]+=J)}}function Ly(c,n,o=!1){c.uploaded||(c.gfxTexture=new dS(n,c.image,o?n.gl.R8:n.gl.RGBA8,{useMipmap:c.sampler.minFilter>=n.gl.NEAREST_MIPMAP_NEAREST}),c.uploaded=!0,c.image=null)}function Ej(c,n,o){c.indexBuffer=n.createIndexBuffer(c.indexArray,!1,!0),c.vertexBuffer=n.createVertexBuffer(c.vertexArray,yj.members,!1,!0),c.normalArray&&(c.normalBuffer=n.createVertexBuffer(c.normalArray,wj.members,!1,!0)),c.texcoordArray&&(c.texcoordBuffer=n.createVertexBuffer(c.texcoordArray,bj.members,!1,!0)),c.colorArray&&(c.colorBuffer=n.createVertexBuffer(c.colorArray,(c.colorArray.bytesPerElement===12?vj:xj).members,!1,!0)),c.featureArray&&(c.pbrBuffer=n.createVertexBuffer(c.featureArray,Tj.members,!0)),c.segments=ci.simpleSegment(0,0,c.vertexArray.length,c.indexArray.length);const u=c.material;u.pbrMetallicRoughness.baseColorTexture&&Ly(u.pbrMetallicRoughness.baseColorTexture,n),u.pbrMetallicRoughness.metallicRoughnessTexture&&Ly(u.pbrMetallicRoughness.metallicRoughnessTexture,n),u.normalTexture&&Ly(u.normalTexture,n),u.occlusionTexture&&Ly(u.occlusionTexture,n,o),u.emissionTexture&&Ly(u.emissionTexture,n)}function yS(c,n,o){if(c.meshes)for(const u of c.meshes)Ej(u,n,o);if(c.children)for(const u of c.children)yS(u,n,o)}function R2(c){if(c.meshes)for(const n of c.meshes)n.indexArray.destroy(),n.vertexArray.destroy(),n.colorArray&&n.colorArray.destroy(),n.normalArray&&n.normalArray.destroy(),n.texcoordArray&&n.texcoordArray.destroy(),n.featureArray&&n.featureArray.destroy();if(c.children)for(const n of c.children)R2(n)}function vS(c){if(c.meshes)for(const o of c.meshes)o.vertexBuffer&&(o.vertexBuffer.destroy(),o.indexBuffer.destroy(),o.normalBuffer&&o.normalBuffer.destroy(),o.texcoordBuffer&&o.texcoordBuffer.destroy(),o.colorBuffer&&o.colorBuffer.destroy(),o.pbrBuffer&&o.pbrBuffer.destroy(),o.segments.destroy(),o.material&&((n=o.material).pbrMetallicRoughness.baseColorTexture&&n.pbrMetallicRoughness.baseColorTexture.gfxTexture&&n.pbrMetallicRoughness.baseColorTexture.gfxTexture.destroy(),n.pbrMetallicRoughness.metallicRoughnessTexture&&n.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture&&n.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture.destroy(),n.normalTexture&&n.normalTexture.gfxTexture&&n.normalTexture.gfxTexture.destroy(),n.emissionTexture&&n.emissionTexture.gfxTexture&&n.emissionTexture.gfxTexture.destroy(),n.occlusionTexture&&n.occlusionTexture.gfxTexture&&n.occlusionTexture.gfxTexture.destroy()));var n;if(c.children)for(const o of c.children)vS(o)}class E_{constructor(n,o,u){this._demTile=n,this._dem=this._demTile.dem,this._scale=o,this._offset=u}static create(n,o,u){const _=u||n.findDEMTileFor(o);if(!_||!_.dem)return;const d=_.dem,y=_.tileID,E=1<<o.canonical.z-y.canonical.z;return new E_(_,d.dim/Kt/E,[(o.canonical.x/E-y.canonical.x)*d.dim,(o.canonical.y/E-y.canonical.y)*d.dim])}tileCoordToPixel(n,o){const u=o*this._scale+this._offset[1],_=Math.floor(n*this._scale+this._offset[0]),d=Math.floor(u);return new It(_,d)}getElevationAt(n,o,u,_){const d=n*this._scale+this._offset[0],y=o*this._scale+this._offset[1],E=Math.floor(d),M=Math.floor(y),k=this._dem;return _=!!_,u?Mn(Mn(k.get(E,M,_),k.get(E,M+1,_),y-M),Mn(k.get(E+1,M,_),k.get(E+1,M+1,_),y-M),d-E):k.get(E,M,_)}getElevationAtPixel(n,o,u){return this._dem.get(n,o,!!u)}getMeterToDEM(n){return(1<<this._demTile.tileID.canonical.z)*za(1,n)*this._dem.stride}}const xS=new Float32Array(262144),Ym=new Uint8Array(262144);function kO(c){let n=0;if(c.meshes)for(const o of c.meshes)n=Math.max(n,o.aabb.max[2]);if(c.children)for(const o of c.children)n=Math.max(n,kO(o));return n}function BO(c,n,o){if(c.meshes)for(const u of c.meshes){if(u.aabb.min[0]===1/0)continue;const _=sn.applyTransform(u.aabb,c.matrix);o.insert(n,_.min[0],_.min[1],_.max[0],_.max[1])}if(c.children)for(const u of c.children)BO(u,n,o)}const NO=["","wall","door","roof","window","lamp","logo"];class FO{constructor(n){this.node=n,this.evaluatedRMEA=[[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[.4,1,0,1],[1,0,0,1],[1,0,0,1]],this.hiddenByReplacement=!1,this.evaluatedScale=[1,1,1],this.evaluatedColor=[],this.emissionHeightBasedParams=[],this.cameraCollisionOpacity=1,this.feature={type:"Point",id:n.id,geometry:[],properties:{height:kO(n)}},this.aabb=this._getLocalBounds(),this.state=null}_getLocalBounds(){if(!this.node.meshes)return new sn([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);if(!this.aabb){let n=0;const o=new sn([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);for(const u of this.node.meshes)this.node.lightMeshIndex!==n&&(u.transformedAabb=sn.applyTransformFast(u.aabb,this.node.matrix),o.encapsulate(u.transformedAabb)),n++;this.aabb=o}return this.aabb}}class D2{constructor(n,o,u,_,d,y,E){this.id=u,this.layers=n,this.layerIds=this.layers.map(M=>M.fqid),this.stateDependentLayerIds=this.layers.filter(M=>M.isStateDependent()).map(M=>M.id),this.modelTraits|=T_.CoordinateSpaceTile,this.uploaded=!1,this.hasPattern=!1,_&&(this.modelTraits|=T_.HasMapboxMeshFeatures),d&&(this.modelTraits|=T_.HasMeshoptCompression),this.zoom=-1,this.terrainExaggeration=1,this.projection={name:"mercator"},this.replacementUpdateTime=0,this.elevationReadFromZ=255,this.brightness=y,this.dirty=!0,this.needsUpload=!1,this.nodesInfo=[];for(const M of o)this.nodesInfo.push(new FO(M)),BO(M,E.featureIndexArray.length,E.grid),E.featureIndexArray.emplaceBack(this.nodesInfo.length-1,0,E.bucketLayerIDs.length-1,0);this.states={}}updateFootprints(n,o){for(const u of this.getNodesInfo()){const _=u.node;_.footprint&&o.push({footprint:_.footprint,id:n})}}update(n){const o=Object.keys(n).length!==0;if(o&&!this.stateDependentLayers.length)return;const u=o?this.stateDependentLayers:this.layers;if(!Ir(n,this.states))for(const _ of u)this.evaluate(_,n);this.states=structuredClone(n)}populate(){console.log("populate 3D model bucket")}uploadPending(){return!this.uploaded||this.needsUpload}upload(n){if(!this.needsUpload)return;const o=this.getNodesInfo();for(const u of o){const _=u.node;this.uploaded?this.updatePbrBuffer(_):yS(_,n,!0)}for(const u of o)R2(u.node);this.uploaded=!0,this.needsUpload=!1}updatePbrBuffer(n){let o=!1;if(!n.meshes)return o;for(const u of n.meshes)u.pbrBuffer&&(u.pbrBuffer.updateData(u.featureArray),o=!0);return o}needsReEvaluation(n,o,u){const _=n.transform.projectionOptions,d=n.style.getBrightness(),y=this.brightness!==d;if(!this.uploaded||this.dirty||_.name!==this.projection.name||zy(u.paint.get("model-color").value,y)||zy(u.paint.get("model-color-mix-intensity").value,y)||zy(u.paint.get("model-roughness").value,y)||zy(u.paint.get("model-emissive-strength").value,y)||zy(u.paint.get("model-height-based-emissive-strength-multiplier").value,y)){this.projection=_,this.brightness=d;const E=this.getNodesInfo();for(const M of E)M.state=null;return!0}return!1}evaluateScale(n,o){if(n.transform.zoom===this.zoom)return;this.zoom=n.transform.zoom;const u=this.getNodesInfo(),_=this.id.canonical;for(const d of u){const y=d.feature;d.evaluatedScale=o.paint.get("model-scale").evaluate(y,{},_)}}evaluate(n,o){const u=this.getNodesInfo();for(const _ of u){if(!_.node.meshes)continue;const d=_.feature,y=o&&o[d.id];if(Ir(y,_.state))continue;_.state=structuredClone(y);const E=_.node.meshes&&_.node.meshes[0].featureData,M=_.evaluatedColor[2],k=_.evaluatedRMEA[2],w=this.id.canonical;if(_.hasTranslucentParts=!1,E){for(let I=0;I<NO.length;I++){const D=NO[I];D.length&&(d.properties.part=D);const C=n.paint.get("model-color").evaluate(d,y,w).toRenderColor(null),P=n.paint.get("model-color-mix-intensity").evaluate(d,y,w);_.evaluatedColor[I]=[C.r,C.g,C.b,P],_.evaluatedRMEA[I][0]=n.paint.get("model-roughness").evaluate(d,y,w),_.evaluatedRMEA[I][2]=n.paint.get("model-emissive-strength").evaluate(d,y,w),_.evaluatedRMEA[I][3]=C.a,_.emissionHeightBasedParams[I]=n.paint.get("model-height-based-emissive-strength-multiplier").evaluate(d,y,w),!_.hasTranslucentParts&&C.a<1&&(_.hasTranslucentParts=!0)}delete d.properties.part,Cj(_,M!==_.evaluatedColor[2]||k!==_.evaluatedRMEA[2],this.modelTraits)}else _.evaluatedRMEA[0][2]=n.paint.get("model-emissive-strength").evaluate(d,y,w);_.evaluatedScale=n.paint.get("model-scale").evaluate(d,y,w),this.updatePbrBuffer(_.node)||(this.needsUpload=!0)}this.dirty=!1}elevationUpdate(n,o,u,_){const d=n.findDEMTileFor(u);if(d&&(d.tileID.canonical!==this.terrainTile||o!==this.terrainExaggeration)){if(d.dem&&d.tileID.overscaledZ!==this.elevationReadFromZ){this.elevationReadFromZ=d.tileID.overscaledZ;const y=E_.create(n,u,d);if(!y)return;this.modelTraits&T_.HasMapboxMeshFeatures&&this.updateDEM(n,y,u,_);for(const E of this.getNodesInfo()){const M=E.node;if(!M.footprint||!M.footprint.vertices||!M.footprint.vertices.length)continue;const k=M.footprint.vertices;let w=y.getElevationAt(k[0].x,k[0].y,!0,!0);for(let I=1;I<k.length;I++)w=Math.min(w,y.getElevationAt(k[I].x,k[I].y,!0,!0));M.elevation=w}}this.terrainTile=d.tileID.canonical,this.terrainExaggeration=o}}updateDEM(n,o,u,_){let d=o._dem._modifiedForSources[_];if(d===void 0&&(o._dem._modifiedForSources[_]=[],d=o._dem._modifiedForSources[_]),d.includes(u.canonical))return;const y=o._dem.dim;d.push(u.canonical);let E=!1;for(const M of this.getNodesInfo()){const k=M.node;if(!k.footprint||!k.footprint.grid)continue;const w=k.footprint.grid,I=o.tileCoordToPixel(w.min.x,w.min.y),D=o.tileCoordToPixel(w.max.x,w.max.y),C=Math.min(Math.min(y-D.y,I.x),Math.min(I.y,y-D.x));if(C<0)continue;const P=Bn(C,2,5);let B=Math.max(0,I.x-P),q=Math.max(0,I.y-P),H=Math.min(D.x+P,y-1),te=Math.min(D.y+P,y-1);for(let ce=q;ce<=te;++ce)for(let me=B;me<=H;++me)Ym[ce*y+me]=255;let re=0,J=0;for(let ce=0;ce<w.cellsY;++ce)for(let me=0;me<w.cellsX;++me){if(!w.cells[ce*w.cellsX+me])continue;const Ce=o.tileCoordToPixel(w.min.x+me/w.xScale,w.min.y+ce/w.yScale),Ae=o.tileCoordToPixel(w.min.x+(me+1)/w.xScale,w.min.y+(ce+1)/w.yScale);for(let Ee=Ce.y;Ee<=Math.min(Ae.y+1,y-1);++Ee)for(let Ue=Ce.x;Ue<=Math.min(Ae.x+1,y-1);++Ue)Ym[Ee*y+Ue]===255&&(Ym[Ee*y+Ue]=0,re+=o.getElevationAtPixel(Ue,Ee),J++)}const ie=re/J;B=Math.max(1,I.x-P),q=Math.max(1,I.y-P),H=Math.min(D.x+P,y-2),te=Math.min(D.y+P,y-2),E=!0;for(let ce=q;ce<=te;++ce)for(let me=B;me<=H;++me)Ym[ce*y+me]===0&&(xS[ce*y+me]=o._dem.set(me,ce,ie));for(let ce=1;ce<P;++ce){B=Math.max(1,I.x-ce),q=Math.max(1,I.y-ce),H=Math.min(D.x+ce,y-2),te=Math.min(D.y+ce,y-2);for(let me=q;me<=te;++me)for(let Ce=B;Ce<=H;++Ce){const Ae=me*y+Ce;if(Ym[Ae]===255){let Ee=0,Ue=0,Ie=-1,Ve=-1;for(let Ze=-1;Ze<=1;++Ze)for(let qe=-1;qe<=1;++qe){const Ke=(me+Ze)*y+Ce+qe;if(Ym[Ke]>=ce)continue;const Qe=xS[Ke],at=Math.abs(Qe);at>Ue&&(Ee=Qe,Ue=at,Ie=qe,Ve=Ze)}if(Ue>.1){const Ze=1-(ce+.5*Math.abs(Ie*Ve))/P;let qe=o._dem.get(Ce,me)+Ee*Ze;const Ke=o._dem.get(Ce+Ie,me+Ve),Qe=o._dem.get(Ce-Ie,me-Ve,!0);(qe-Ke)*(qe-Qe)>0&&(qe=(Ke+Qe)/2),xS[Ae]=o._dem.set(Ce,me,qe),Ym[Ae]=ce}}}}}E&&(o._demTile.needsDEMTextureUpload=!0,o._dem._timestamp=ze.now())}getNodesInfo(){return this.nodesInfo}destroy(){const n=this.getNodesInfo();for(const o of n)R2(o.node),vS(o.node)}isEmpty(){return!this.nodesInfo.length}updateReplacement(n,o){if(o.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=o.updateTime;const u=o.getReplacementRegionsForTile(n.toUnwrapped()),_=this.getNodesInfo();for(let d=0;d<this.nodesInfo.length;d++){const y=_[d].node;_[d].hiddenByReplacement=!!y.footprint&&!u.find(E=>E.footprint===y.footprint)}}getHeightAtTileCoord(n,o){const u=this.getNodesInfo(),_=[],d=[0,0,0],y=Ne.mat4.identity([]);for(let E=0;E<this.nodesInfo.length;E++){const M=u[E],k=M.node.meshes[0],w=k.transformedAabb;if(n<w.min[0]||o<w.min[1]||n>w.max[0]||o>w.max[1])continue;if(M.node.hidden===!0)return{height:1/0,maxHeight:M.feature.properties.height,hidden:!1,verticalScale:M.evaluatedScale[2]};Ne.mat4.invert(y,M.node.matrix),d[0]=n,d[1]=o,Ne.vec3.transformMat4(d,d,y);const I=(d[0]-k.aabb.min[0])/(k.aabb.max[0]-k.aabb.min[0])*Xm|0,D=Math.min(63,(d[1]-k.aabb.min[1])/(k.aabb.max[1]-k.aabb.min[1])*Xm|0)*Xm+Math.min(63,I),C=k.heightmap[D];if(!(C<0&&M.node.footprint))return M.hiddenByReplacement?void 0:{height:C,maxHeight:M.feature.properties.height,hidden:!1,verticalScale:M.evaluatedScale[2]};if(M.node.footprint.grid.query(new It(n,o),new It(n,o),_),_.length>0)return{height:void 0,maxHeight:M.feature.properties.height,hidden:M.hiddenByReplacement,verticalScale:M.evaluatedScale[2]}}}}function zy(c,n){return!c.isLightConstant&&n}function Aj(c,n,o,u,_,d,y,E){let M=(61440&n|(61440&n)>>4)>>8,k=(3840&n|(3840&n)>>4)>>4,w=240&n|(240&n)>>4;o[3]>0&&(M=Mn(M,255*o[0],o[3]),k=Mn(k,255*o[1],o[3]),w=Mn(w,255*o[2],o[3]));const I=M<<8|k,D=w<<8|Math.floor(255*u[3]),C=function(ce){const me=Bn(ce,0,2);return Math.min(Math.round(.5*me*255),255)}(u[2])<<8|15*u[0]<<4|15*u[1],P=Bn(_[0],0,1),B=Bn(_[1],0,1),q=Bn(_[2],0,1),H=Bn(_[3],0,1);let te,re,J,ie;if(P!==B&&y!==d&&B!==P){const ce=y-d;re=1/(ce*(B-P)),J=-(d+ce*P)/(ce*(B-P));const me=Bn(_[4],-1,1);ie=Math.pow(10,me),te=255*q<<8|255*H}else te=65535,re=0,J=1,ie=1;if(c.emplaceBack(I,D,C,te,re,J,ie),E){const ce=E.length;E.clear();for(let me=0;me<ce;me++)E.emplaceBack(I,D,C,te,re,J,ie)}}function Cj(c,n,o){const u=c.node;let _=0;const d=o&T_.HasMeshoptCompression;for(const y of u.meshes){if(u.lights&&u.lightMeshIndex===_||!y.featureData)continue;y.featureArray=new Ih,y.featureArray.reserve(y.featureData.length);let E=n;for(const M of y.featureData){const k=d?65535&M:M>>16&65535,w=d?M>>16&65535:65535&M,I=(15&w)<8?15&w:0,D=c.evaluatedRMEA[I],C=c.evaluatedColor[I],P=c.emissionHeightBasedParams[I];let B;if(E&&I===2&&u.lights&&(B=new Ih,B.resize(10*u.lights.length)),Aj(y.featureArray,k,C,D,P,y.aabb.min[2],y.aabb.max[2],B),B&&E){E=!1;const q=u.meshes[u.lightMeshIndex];q.featureArray=B,q.featureArray._trim()}}y.featureArray._trim(),_++}}function jO(c,n,o,u){const _=1<<c.z;n.lat=$i((u/Kt+c.y)/_),n.lng=Ja((o/Kt+c.x)/_)}hn(D2,"Tiled3dModelBucket",{omit:["layers"]}),hn(FO,"Tiled3dModelFeature");const Mj={circle:class extends Vi{constructor(c,n,o,u){super(c,{layout:Lt||(Lt=new ni({"circle-sort-key":new cn(st.layout_circle["circle-sort-key"]),"circle-elevation-reference":new qt(st.layout_circle["circle-elevation-reference"]),visibility:new qt(st.layout_circle.visibility)})),paint:tt||(tt=new ni({"circle-radius":new cn(st.paint_circle["circle-radius"]),"circle-color":new cn(st.paint_circle["circle-color"]),"circle-blur":new cn(st.paint_circle["circle-blur"]),"circle-opacity":new cn(st.paint_circle["circle-opacity"]),"circle-translate":new qt(st.paint_circle["circle-translate"]),"circle-translate-anchor":new qt(st.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new qt(st.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new qt(st.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new cn(st.paint_circle["circle-stroke-width"]),"circle-stroke-color":new cn(st.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new cn(st.paint_circle["circle-stroke-opacity"]),"circle-emissive-strength":new qt(st.paint_circle["circle-emissive-strength"]),"circle-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"}),"circle-stroke-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"})}))},n,o,u)}createBucket(c){return new ue(c)}queryRadius(c){const n=c;return Et("circle-radius",this,n)+Et("circle-stroke-width",this,n)+vt(this.paint.get("circle-translate"))}queryIntersectsFeature(c,n,o,u,_,d,y,E){const M=pt(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),d.angle,c.pixelToTileUnitsFactor),k=this.paint.get("circle-radius").evaluate(n,o)+this.paint.get("circle-stroke-width").evaluate(n,o);return Nc(c,u,d,y,E,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",M,k)}getProgramIds(){return["circle"]}getDefaultProgramParams(c,n,o){const u=Bc(this);return{config:new il(this,{zoom:n,lut:o}),defines:u,overrideFog:!1}}},heatmap:class extends Vi{createBucket(c){return new Xg(c)}constructor(c,n,o,u){super(c,{layout:H0||(H0=new ni({visibility:new qt(st.layout_heatmap.visibility)})),paint:Yg||(Yg=new ni({"heatmap-radius":new cn(st.paint_heatmap["heatmap-radius"]),"heatmap-weight":new cn(st.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new qt(st.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Su(st.paint_heatmap["heatmap-color"]),"heatmap-opacity":new qt(st.paint_heatmap["heatmap-opacity"]),"heatmap-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"})}))},n,o,u),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(c){c==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Jf({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(c){return Et("heatmap-radius",this,c)}queryIntersectsFeature(c,n,o,u,_,d,y,E){const M=this.paint.get("heatmap-radius").evaluate(n,o);return Nc(c,u,d,y,E,!0,!0,new It(0,0),M)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getDefaultProgramParams(c,n,o){return c==="heatmap"?{config:new il(this,{zoom:n,lut:o}),overrideFog:!1}:{}}},hillshade:class extends Vi{constructor(c,n,o,u){super(c,{layout:U1||(U1=new ni({visibility:new qt(st.layout_hillshade.visibility)})),paint:Fc||(Fc=new ni({"hillshade-illumination-direction":new qt(st.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new qt(st.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new qt(st.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new qt(st.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new qt(st.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new qt(st.paint_hillshade["hillshade-accent-color"]),"hillshade-emissive-strength":new qt(st.paint_hillshade["hillshade-emissive-strength"]),"hillshade-shadow-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"}),"hillshade-highlight-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"}),"hillshade-accent-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"})}))},n,o,u)}shouldRedrape(){return this.hasOffscreenPass()&&this.paint.get("hillshade-illumination-anchor")==="viewport"}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}getDefaultProgramParams(c,n,o){return{overrideFog:!1}}},fill:class extends Vi{constructor(c,n,o,u){super(c,{layout:W1||(W1=new ni({"fill-sort-key":new cn(st.layout_fill["fill-sort-key"]),visibility:new qt(st.layout_fill.visibility),"fill-elevation-reference":new qt(st.layout_fill["fill-elevation-reference"])})),paint:n_||(n_=new ni({"fill-antialias":new qt(st.paint_fill["fill-antialias"]),"fill-opacity":new cn(st.paint_fill["fill-opacity"]),"fill-color":new cn(st.paint_fill["fill-color"]),"fill-outline-color":new cn(st.paint_fill["fill-outline-color"]),"fill-translate":new qt(st.paint_fill["fill-translate"]),"fill-translate-anchor":new qt(st.paint_fill["fill-translate-anchor"]),"fill-pattern":new cn(st.paint_fill["fill-pattern"]),"fill-emissive-strength":new qt(st.paint_fill["fill-emissive-strength"]),"fill-z-offset":new cn(st.paint_fill["fill-z-offset"]),"fill-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"}),"fill-outline-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"})}))},n,o,u)}getProgramIds(){const c=this.paint.get("fill-pattern"),n=c&&c.constantOr(1),o=[n?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&o.push(n&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),o}getDefaultProgramParams(c,n,o){return{config:new il(this,{zoom:n,lut:o}),overrideFog:!1}}recalculate(c,n){super.recalculate(c,n);const o=this.paint._values["fill-outline-color"];o.value.kind==="constant"&&o.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(c){return new t_(c)}queryRadius(){return vt(this.paint.get("fill-translate"))}queryIntersectsFeature(c,n,o,u,_,d){return!c.queryGeometry.isAboveHorizon&&fe(nt(c.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),d.angle,c.pixelToTileUnitsFactor),u)}isTileClipped(){return!0}is3D(){return this.paint.get("fill-z-offset").constantOr(1)!==0}},"fill-extrusion":class extends Vi{constructor(c,n,o,u){super(c,{layout:jm||(jm=new ni({visibility:new qt(st["layout_fill-extrusion"].visibility),"fill-extrusion-edge-radius":new qt(st["layout_fill-extrusion"]["fill-extrusion-edge-radius"])})),paint:f_||(f_=new ni({"fill-extrusion-opacity":new qt(st["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new cn(st["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new qt(st["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new qt(st["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new cn(st["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new cn(st["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new cn(st["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-height-alignment":new qt(st["paint_fill-extrusion"]["fill-extrusion-height-alignment"]),"fill-extrusion-base-alignment":new qt(st["paint_fill-extrusion"]["fill-extrusion-base-alignment"]),"fill-extrusion-vertical-gradient":new qt(st["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new qt(st["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new qt(st["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-ambient-occlusion-wall-radius":new qt(st["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-wall-radius"]),"fill-extrusion-ambient-occlusion-ground-radius":new qt(st["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-radius"]),"fill-extrusion-ambient-occlusion-ground-attenuation":new qt(st["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-attenuation"]),"fill-extrusion-flood-light-color":new qt(st["paint_fill-extrusion"]["fill-extrusion-flood-light-color"]),"fill-extrusion-flood-light-intensity":new qt(st["paint_fill-extrusion"]["fill-extrusion-flood-light-intensity"]),"fill-extrusion-flood-light-wall-radius":new cn(st["paint_fill-extrusion"]["fill-extrusion-flood-light-wall-radius"]),"fill-extrusion-flood-light-ground-radius":new cn(st["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-radius"]),"fill-extrusion-flood-light-ground-attenuation":new qt(st["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-attenuation"]),"fill-extrusion-vertical-scale":new qt(st["paint_fill-extrusion"]["fill-extrusion-vertical-scale"]),"fill-extrusion-rounded-roof":new qt(st["paint_fill-extrusion"]["fill-extrusion-rounded-roof"]),"fill-extrusion-cutoff-fade-range":new qt(st["paint_fill-extrusion"]["fill-extrusion-cutoff-fade-range"]),"fill-extrusion-emissive-strength":new cn(st["paint_fill-extrusion"]["fill-extrusion-emissive-strength"]),"fill-extrusion-line-width":new cn(st["paint_fill-extrusion"]["fill-extrusion-line-width"]),"fill-extrusion-cast-shadows":new qt(st["paint_fill-extrusion"]["fill-extrusion-cast-shadows"]),"fill-extrusion-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"}),"fill-extrusion-flood-light-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"})}))},n,o,u),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(c){return new h_(c)}queryRadius(){return vt(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}hasShadowPass(){return this.paint.get("fill-extrusion-cast-shadows")}cutoffRange(){return this.paint.get("fill-extrusion-cutoff-fade-range")}canCastShadows(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}queryIntersectsFeature(c,n,o,u,_,d,y,E,M){const k=pt(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),d.angle,c.pixelToTileUnitsFactor),w=this.paint.get("fill-extrusion-height").evaluate(n,o),I=this.paint.get("fill-extrusion-base").evaluate(n,o),D=[0,0],C=E&&d.elevation,P=d.elevation?d.elevation.exaggeration():1,B=c.tile.getBucket(this);if(C&&B instanceof h_){const J=B.centroidVertexArray,ie=M+1;ie<J.length&&(D[0]=J.geta_centroid_pos0(ie),D[1]=J.geta_centroid_pos1(ie))}if(D[0]===0&&D[1]===1)return!1;d.projection.name==="globe"&&(u=Mp([u],[new It(0,0),new It(Kt,Kt)],c.tileID.canonical).map(J=>J.polygon).flat());const q=C?E:null,[H,te]=function(J,ie,ce,me,Ce,Ae,Ee,Ue,Ie,Ve,Ze){return J.projection.name==="globe"?function(qe,Ke,Qe,at,Je,wt,Rt,bt,an,Jt,Ut){const zt=[],vn=[],ln=qe.projection.upVectorScale(Ut,qe.center.lat,qe.worldSize).metersToTile,pn=[0,0,0,1],kn=[0,0,0,1],Gn=(Wn,lr,ur,Zr)=>{Wn[0]=lr,Wn[1]=ur,Wn[2]=Zr,Wn[3]=1},Zn=od();Qe>0&&(Qe+=Zn),at+=Zn;for(const Wn of Ke){const lr=[],ur=[];for(const Zr of Wn){const Lr=Zr.x+Je.x,jn=Zr.y+Je.y,Pr=qe.projection.projectTilePoint(Lr,jn,Ut),Rr=qe.projection.upVector(Ut,Zr.x,Zr.y);let ri=Qe,Bi=at;if(Rt){const Ji=fy(Lr,jn,Qe,at,Rt,bt,an,Jt);ri+=Ji.base,Bi+=Ji.top}Qe!==0?Gn(pn,Pr.x+Rr[0]*ln*ri,Pr.y+Rr[1]*ln*ri,Pr.z+Rr[2]*ln*ri):Gn(pn,Pr.x,Pr.y,Pr.z),Gn(kn,Pr.x+Rr[0]*ln*Bi,Pr.y+Rr[1]*ln*Bi,Pr.z+Rr[2]*ln*Bi),Ne.vec3.transformMat4(pn,pn,wt),Ne.vec3.transformMat4(kn,kn,wt),lr.push(new Uc(pn[0],pn[1],pn[2])),ur.push(new Uc(kn[0],kn[1],kn[2]))}zt.push(lr),vn.push(ur)}return[zt,vn]}(J,ie,ce,me,Ce,Ae,Ee,Ue,Ie,Ve,Ze):Ee?function(qe,Ke,Qe,at,Je,wt,Rt,bt,an){const Jt=[],Ut=[],zt=[0,0,0,1];for(const vn of qe){const ln=[],pn=[];for(const kn of vn){const Gn=kn.x+at.x,Zn=kn.y+at.y,Wn=fy(Gn,Zn,Ke,Qe,wt,Rt,bt,an);zt[0]=Gn,zt[1]=Zn,zt[2]=Wn.base,zt[3]=1,Ne.vec4.transformMat4(zt,zt,Je),zt[3]=Math.max(zt[3],1e-5);const lr=new Uc(zt[0]/zt[3],zt[1]/zt[3],zt[2]/zt[3]);zt[0]=Gn,zt[1]=Zn,zt[2]=Wn.top,zt[3]=1,Ne.vec4.transformMat4(zt,zt,Je),zt[3]=Math.max(zt[3],1e-5);const ur=new Uc(zt[0]/zt[3],zt[1]/zt[3],zt[2]/zt[3]);ln.push(lr),pn.push(ur)}Jt.push(ln),Ut.push(pn)}return[Jt,Ut]}(ie,ce,me,Ce,Ae,Ee,Ue,Ie,Ve):function(qe,Ke,Qe,at,Je){const wt=[],Rt=[],bt=Je[8]*Ke,an=Je[9]*Ke,Jt=Je[10]*Ke,Ut=Je[11]*Ke,zt=Je[8]*Qe,vn=Je[9]*Qe,ln=Je[10]*Qe,pn=Je[11]*Qe;for(const kn of qe){const Gn=[],Zn=[];for(const Wn of kn){const lr=Wn.x+at.x,ur=Wn.y+at.y,Zr=Je[0]*lr+Je[4]*ur+Je[12],Lr=Je[1]*lr+Je[5]*ur+Je[13],jn=Je[2]*lr+Je[6]*ur+Je[14],Pr=Je[3]*lr+Je[7]*ur+Je[15],Rr=Zr+bt,ri=Lr+an,Bi=jn+Jt,Ji=Math.max(Pr+Ut,1e-5),Ni=Zr+zt,Oi=Lr+vn,Gi=jn+ln,aa=Math.max(Pr+pn,1e-5);Gn.push(new Uc(Rr/Ji,ri/Ji,Bi/Ji)),Zn.push(new Uc(Ni/aa,Oi/aa,Gi/aa))}wt.push(Gn),Rt.push(Zn)}return[wt,Rt]}(ie,ce,me,Ce,Ae)}(d,u,I,w,k,y,q,D,P,d.center.lat,c.tileID.canonical),re=c.queryGeometry;return function(J,ie,ce){let me=1/0;fe(ce,ie)&&(me=Um(ce,ie[0]));for(let Ce=0;Ce<ie.length;Ce++){const Ae=ie[Ce],Ee=J[Ce];for(let Ue=0;Ue<Ae.length-1;Ue++){const Ie=Ae[Ue],Ve=[Ie,Ae[Ue+1],Ee[Ue+1],Ee[Ue],Ie];oe(ce,Ve)&&(me=Math.min(me,Um(ce,Ve)))}}return me!==1/0&&me}(H,te,re.isPointQuery()?re.screenBounds:re.screenGeometry)}},line:class extends Vi{constructor(c,n,o,u){const _=m_();super(c,_,n,o,u),_.layout&&(this.layout=new wu(_.layout)),this.gradientVersion=0,this.hasElevatedBuckets=!1,this.hasNonElevatedBuckets=!1}_handleSpecialPaintPropertyUpdate(c){if(c==="line-gradient"){const n=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=n._styleExpression&&n._styleExpression.expression instanceof Bo,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(c,n){super.recalculate(c,n),this.paint._values["line-floorwidth"]=(()=>{if(Uh)return Uh;const o=m_();return Uh=new by(o.paint.properties["line-width"].specification),Uh.useIntegerZoom=!0,Uh})().possiblyEvaluate(this._transitioningPaint._values["line-width"].value,c)}createBucket(c){return new ld(c)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getDefaultProgramParams(c,n,o){const u=qm(this);return{config:new il(this,{zoom:n,lut:o}),defines:u,overrideFog:!1}}queryRadius(c){const n=c,o=__(Et("line-width",this,n),Et("line-gap-width",this,n)),u=Et("line-offset",this,n);return o/2+Math.abs(u)+vt(this.paint.get("line-translate"))}queryIntersectsFeature(c,n,o,u,_,d){if(c.queryGeometry.isAboveHorizon)return!1;const y=nt(c.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),d.angle,c.pixelToTileUnitsFactor),E=c.pixelToTileUnitsFactor/2*__(this.paint.get("line-width").evaluate(n,o),this.paint.get("line-gap-width").evaluate(n,o)),M=this.paint.get("line-offset").evaluate(n,o);return M&&(u=function(k,w){const I=[],D=new It(0,0);for(let C=0;C<k.length;C++){const P=k[C],B=[];for(let q=0;q<P.length;q++){const H=P[q],te=P[q+1],re=q===0?D:H.sub(P[q-1])._unit()._perp(),J=q===P.length-1?D:te.sub(H)._unit()._perp(),ie=re._add(J)._unit();ie._mult(1/(ie.x*J.x+ie.y*J.y)),B.push(ie._mult(w)._add(H))}I.push(B)}return I}(u,M*c.pixelToTileUnitsFactor)),function(k,w,I){for(let D=0;D<w.length;D++){const C=w[D];if(k.length>=3){for(let P=0;P<C.length;P++)if(De(k,C[P]))return!0}if(Te(k,C,I))return!0}return!1}(y,u,E)}isTileClipped(){return!0}isDraped(c){return!this.hasElevatedBuckets}},symbol:E2,background:class extends Vi{constructor(c,n,o,u){super(c,{layout:hO||(hO=new ni({visibility:new qt(st.layout_background.visibility)})),paint:fO||(fO=new ni({"background-pitch-alignment":new qt(st.paint_background["background-pitch-alignment"]),"background-color":new qt(st.paint_background["background-color"]),"background-pattern":new qt(st.paint_background["background-pattern"]),"background-opacity":new qt(st.paint_background["background-opacity"]),"background-emissive-strength":new qt(st.paint_background["background-emissive-strength"]),"background-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"})}))},n,o,u)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}getDefaultProgramParams(c,n,o){return{overrideFog:!1}}is3D(){return this.paint.get("background-pitch-alignment")==="viewport"}},raster:gO,"raster-particle":SO,sky:class extends Vi{constructor(c,n,o,u){super(c,{layout:xO||(xO=new ni({visibility:new qt(st.layout_sky.visibility)})),paint:bO||(bO=new ni({"sky-type":new qt(st.paint_sky["sky-type"]),"sky-atmosphere-sun":new qt(st.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new qt(st.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new qt(st.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new qt(st.paint_sky["sky-gradient-radius"]),"sky-gradient":new Su(st.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new qt(st.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new qt(st.paint_sky["sky-atmosphere-color"]),"sky-opacity":new qt(st.paint_sky["sky-opacity"]),"sky-gradient-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"}),"sky-atmosphere-halo-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"}),"sky-atmosphere-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"})}))},n,o,u),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(c){c==="sky-gradient"?this._updateColorRamp():c!=="sky-atmosphere-sun"&&c!=="sky-atmosphere-halo-color"&&c!=="sky-atmosphere-color"&&c!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=Jf({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(c){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const n=c.style.light.properties.get("position");return this._lightPosition.azimuthal!==n.azimuthal||this._lightPosition.polar!==n.polar}return!1}getCenter(c,n){if(this.paint.get("sky-type")==="atmosphere"){const u=this.paint.get("sky-atmosphere-sun"),_=!u,d=c.style.light,y=d.properties.get("position");return _&&d.properties.get("anchor")==="viewport"&&qn("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),_?pS(y.azimuthal,90-y.polar,n):pS(u[0],90-u[1],n)}const o=this.paint.get("sky-gradient-center");return pS(o[0],90-o[1],n)}isSky(){return!0}markSkyboxValid(c){this._skyboxInvalidated=!1,this._lightPosition=c.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const c=this.paint.get("sky-type");return c==="atmosphere"?["skyboxCapture","skybox"]:c==="gradient"?["skyboxGradient"]:null}},slot:class extends Vi{constructor(c,n,o,u){super(c,{paint:wO||(wO=new ni({}))},n,null)}},model:class extends Vi{constructor(c,n,o,u){super(c,{layout:DO||(DO=new ni({visibility:new qt(st.layout_model.visibility),"model-id":new cn(st.layout_model["model-id"])})),paint:LO||(LO=new ni({"model-opacity":new cn(st.paint_model["model-opacity"]),"model-rotation":new cn(st.paint_model["model-rotation"]),"model-scale":new cn(st.paint_model["model-scale"]),"model-translation":new cn(st.paint_model["model-translation"]),"model-color":new cn(st.paint_model["model-color"]),"model-color-mix-intensity":new cn(st.paint_model["model-color-mix-intensity"]),"model-type":new qt(st.paint_model["model-type"]),"model-cast-shadows":new qt(st.paint_model["model-cast-shadows"]),"model-receive-shadows":new qt(st.paint_model["model-receive-shadows"]),"model-ambient-occlusion-intensity":new qt(st.paint_model["model-ambient-occlusion-intensity"]),"model-emissive-strength":new cn(st.paint_model["model-emissive-strength"]),"model-roughness":new cn(st.paint_model["model-roughness"]),"model-height-based-emissive-strength-multiplier":new cn(st.paint_model["model-height-based-emissive-strength-multiplier"]),"model-cutoff-fade-range":new qt(st.paint_model["model-cutoff-fade-range"]),"model-front-cutoff":new qt(st.paint_model["model-front-cutoff"]),"model-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"})}))},n,o,u),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(c){return new gS(c)}getProgramIds(){return["model"]}is3D(){return!0}hasShadowPass(){return!0}canCastShadows(){return!0}hasLightBeamPass(){return!0}cutoffRange(){return this.paint.get("model-cutoff-fade-range")}queryRadius(c){return c instanceof D2?Kt-1:0}queryIntersectsFeature(c,n,o,u,_,d){if(!this.modelManager)return!1;const y=this.modelManager,E=c.tile.getBucket(this);if(!(E&&E instanceof gS))return!1;for(const M in E.instancesPerModel){const k=E.instancesPerModel[M],w=n.id!==void 0?n.id:n.properties&&n.properties.hasOwnProperty("id")?n.properties.id:void 0;if(k.idToFeaturesIndex.hasOwnProperty(w)){const I=k.features[k.idToFeaturesIndex[w]],D=y.getModel(M,this.scope);if(!D)return!1;let C=Ne.mat4.create();const P=new pr(0,0),B=E.canonical;let q=Number.MAX_VALUE;for(let H=0;H<I.instancedDataCount;++H){const te=16*(I.instancedDataOffset+H),re=k.instancedDataArray.float32,J=[re[te+4],re[te+5],re[te+6]];jO(B,P,re[te],0|re[te+1]),zO(C,D,d,P,I.rotation,I.scale,J,!1,!1,!1),d.projection.name==="globe"&&(C=_S(C,d));const ie=Ne.mat4.multiply([],d.projMatrix,C),ce=c.queryGeometry,me=MO(ce.isPointQuery()?ce.screenBounds:ce.screenGeometry,d,ie,D.aabb);me!=null&&(q=Math.min(me,q))}return q!==Number.MAX_VALUE&&q}}return!1}_handleOverridablePaintPropertyUpdate(c,n,o){return!(!this.layout||n.isDataDriven()||o.isDataDriven()||c!=="model-color"&&c!=="model-color-mix-intensity"&&c!=="model-rotation"&&c!=="model-scale"&&c!=="model-translation"&&c!=="model-emissive-strength")}_isPropertyZoomDependent(c){const n=this._transitionablePaint._values[c];return n!=null&&n.value!=null&&n.value.expression!=null&&n.value.expression instanceof Pl}isZoomDependent(){return this._isPropertyZoomDependent("model-scale")||this._isPropertyZoomDependent("model-rotation")||this._isPropertyZoomDependent("model-translation")}},clip:class extends Vi{constructor(c,n,o,u){super(c,{layout:Qg||(Qg=new ni({"clip-layer-types":new qt(st.layout_clip["clip-layer-types"]),"clip-layer-scope":new qt(st.layout_clip["clip-layer-scope"])})),paint:ey||(ey=new ni({}))},n,o,u)}recalculate(c,n){super.recalculate(c,n)}createBucket(c){return new r_(c)}isTileClipped(){return!0}is3D(){return!0}}};class Oj{constructor(n){this._callback=n,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class Ij{constructor(){this.tasks={},this.taskQueue=[],Ku(["process"],this),this.invoker=new Oj(this.process),this.nextId=0}add(n,o){const u=this.nextId++,_=function({type:d,isSymbolTile:y,zoom:E}){return E=E||0,d==="message"?0:d!=="maybePrepare"||y?d!=="parseTile"||y?d==="parseTile"&&y?300-E:d==="maybePrepare"&&y?400-E:500:200-E:100-E}(o);if(_===0){try{n()}finally{}return null}return this.tasks[u]={fn:n,metadata:o,priority:_,id:u},this.taskQueue.push(u),this.invoker.trigger(),{cancel:()=>{delete this.tasks[u]}}}process(){try{if(this.taskQueue=this.taskQueue.filter(u=>!!this.tasks[u]),!this.taskQueue.length)return;const n=this.pick();if(n===null)return;const o=this.tasks[n];if(delete this.tasks[n],this.taskQueue.length&&this.invoker.trigger(),!o)return;o.fn()}finally{}}pick(){let n=null,o=1/0;for(let _=0;_<this.taskQueue.length;_++){const d=this.tasks[this.taskQueue[_]];d.priority<o&&(o=d.priority,n=_)}if(n===null)return null;const u=this.taskQueue[n];return this.taskQueue.splice(n,1),u}remove(){this.invoker.remove()}}class UO{constructor(n,o,u){this.target=n,this.parent=o,this.mapId=u,this.callbacks={},this.cancelCallbacks={},Ku(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.scheduler=new Ij}send(n,o,u,_,d=!1,y){const E=Math.round(1e18*Math.random()).toString(36).substring(0,10);u&&(u.metadata=y,this.callbacks[E]=u);const M=new Set;return this.target.postMessage({id:E,type:n,hasCallback:!!u,targetMapId:_,mustQueue:d,sourceMapId:this.mapId,data:Rl(o,M)},M),{cancel:()=>{u&&delete this.callbacks[E],this.target.postMessage({id:E,type:"<cancel>",targetMapId:_,sourceMapId:this.mapId})}}}receive(n){const o=n.data,u=o.id;if(u&&(!o.targetMapId||this.mapId===o.targetMapId))if(o.type==="<cancel>"){const _=this.cancelCallbacks[u];delete this.cancelCallbacks[u],_&&_.cancel()}else if(o.mustQueue||Qo()){const _=this.callbacks[u],d=this.scheduler.add(()=>this.processTask(u,o),_&&_.metadata||{type:"message"});d&&(this.cancelCallbacks[u]=d)}else this.processTask(u,o)}processTask(n,o){if(delete this.cancelCallbacks[n],o.type==="<response>"){const u=this.callbacks[n];delete this.callbacks[n],u&&(o.error?u(Eo(o.error)):u(null,Eo(o.data)))}else{const u=new Set,_=o.hasCallback?(y,E)=>{this.target.postMessage({id:n,type:"<response>",sourceMapId:this.mapId,error:y?Rl(y):null,data:Rl(E,u)},u)}:()=>{},d=Eo(o.data);if(this.parent[o.type])this.parent[o.type](o.sourceMapId,d,_);else if(this.parent.getWorkerSource){const y=o.type.split(".");this.parent.getWorkerSource(o.sourceMapId,y[0],d.source,d.scope)[y[1]](d,_)}else _(new Error(`Could not find function ${o.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}}var ky={workerUrl:"",workerClass:null,workerParams:void 0};const bS="mapboxgl_preloaded_worker_pool";class Km{constructor(){this.active={}}acquire(n,o=Km.workerCount){if(!this.workers)for(this.workers=[];this.workers.length<o;)this.workers.push(ky.workerClass!=null?new ky.workerClass:new self.Worker(ky.workerUrl,ky.workerParams));return this.active[n]=!0,this.workers.slice()}release(n){delete this.active[n],this.workers&&this.numActive()===0&&(this.workers.forEach(o=>{o.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[bS]}numActive(){return Object.keys(this.active).length}}Km.workerCount=2;class A_{constructor(n,o,u="Worker",_=Km.workerCount){this.workerPool=n,this.actors=[],this.currentActor=0,this.id=nc();const d=this.workerPool.acquire(this.id,_);for(let y=0;y<d.length;y++){const E=new A_.Actor(d[y],o,this.id);E.name=`${u} ${y}`,this.actors.push(E)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(n,o,u){ml(this.actors,(_,d)=>{_.send(n,o,d)},u=u||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(n=>{n.remove()}),this.actors=[],this.workerPool.release(this.id)}}let By,wS;function L2(){return By||(By=new Km),By}A_.Actor=UO;const SS=new _r(0,0,0);var TS=(c=>(c[c.PATH_RULE_UNSPECIFIED=0]="PATH_RULE_UNSPECIFIED",c[c.PATH_RULE_NON_ZERO=1]="PATH_RULE_NON_ZERO",c[c.PATH_RULE_EVEN_ODD=2]="PATH_RULE_EVEN_ODD",c))(TS||{}),z2=(c=>(c[c.LINE_CAP_UNSPECIFIED=0]="LINE_CAP_UNSPECIFIED",c[c.LINE_CAP_BUTT=1]="LINE_CAP_BUTT",c[c.LINE_CAP_ROUND=2]="LINE_CAP_ROUND",c[c.LINE_CAP_SQUARE=3]="LINE_CAP_SQUARE",c))(z2||{}),Ny=(c=>(c[c.LINE_JOIN_UNSPECIFIED=0]="LINE_JOIN_UNSPECIFIED",c[c.LINE_JOIN_MITER=1]="LINE_JOIN_MITER",c[c.LINE_JOIN_MITER_CLIP=2]="LINE_JOIN_MITER_CLIP",c[c.LINE_JOIN_ROUND=3]="LINE_JOIN_ROUND",c[c.LINE_JOIN_BEVEL=4]="LINE_JOIN_BEVEL",c))(Ny||{}),VO=(c=>(c[c.PAINT_ORDER_UNSPECIFIED=0]="PAINT_ORDER_UNSPECIFIED",c[c.PAINT_ORDER_FILL_AND_STROKE=1]="PAINT_ORDER_FILL_AND_STROKE",c[c.PAINT_ORDER_STROKE_AND_FILL=2]="PAINT_ORDER_STROKE_AND_FILL",c))(VO||{}),C_=(c=>(c[c.PATH_COMMAND_UNSPECIFIED=0]="PATH_COMMAND_UNSPECIFIED",c[c.PATH_COMMAND_MOVE=1]="PATH_COMMAND_MOVE",c[c.PATH_COMMAND_LINE=2]="PATH_COMMAND_LINE",c[c.PATH_COMMAND_QUAD=3]="PATH_COMMAND_QUAD",c[c.PATH_COMMAND_CUBIC=4]="PATH_COMMAND_CUBIC",c[c.PATH_COMMAND_CLOSE=5]="PATH_COMMAND_CLOSE",c))(C_||{}),$O=(c=>(c[c.MASK_TYPE_UNSPECIFIED=0]="MASK_TYPE_UNSPECIFIED",c[c.MASK_TYPE_LUMINANCE=1]="MASK_TYPE_LUMINANCE",c[c.MASK_TYPE_ALPHA=2]="MASK_TYPE_ALPHA",c))($O||{});function Pj(c,n,o){c===1&&n.icons.push(function(u,_){return function(d){if(d.usvg_tree.height||(d.usvg_tree.height=d.usvg_tree.width),!d.metadata)return d;const{metadata:y}=d;if(y.content_area){const{content_area:E}=y;E.top==null&&(E.top=E.left),E.width==null&&(E.width=d.usvg_tree.width),E.height==null&&(E.height=E.width)}return y.stretch_x&&y.stretch_x.length&&qO(y,"x"),y.stretch_y&&y.stretch_y.length&&qO(y,"y"),d}(u.readFields(Rj,{name:void 0},_))}(o,o.readVarint()+o.pos))}function qO(c,n){const o=[],u=c[`stretch_${n}`];let _=null;for(let d=0;d<u.length;d++)_===null?_=o.length===0?u[0]:o[o.length-1][1]+u[d]:(o.push([_,_+u[d]]),_=null);c[`stretch_${n}_areas`]=o}function Rj(c,n,o){c===1?n.name=o.readString():c===2?n.metadata=function(u,_){return u.readFields(Dj,{stretch_x:null,stretch_y:null,stretch_x_areas:null,stretch_y_areas:null,variables:[]},_)}(o,o.readVarint()+o.pos):c===3&&(n.usvg_tree=function(u,_){return u.readFields(kj,{width:20,children:[],linear_gradients:[],radial_gradients:[],clip_paths:[],masks:[]},_)}(o,o.readVarint()+o.pos),n.data="usvg_tree")}function Dj(c,n,o){c===1?n.stretch_x=o.readPackedVarint():c===2?n.stretch_y=o.readPackedVarint():c===3?n.content_area=function(u,_){return u.readFields(Lj,{left:0},_)}(o,o.readVarint()+o.pos):c===4&&n.variables.push(function(u,_){return u.readFields(zj,{name:void 0},_)}(o,o.readVarint()+o.pos))}function Lj(c,n,o){c===1?n.left=o.readVarint():c===2?n.width=o.readVarint():c===3?n.top=o.readVarint():c===4&&(n.height=o.readVarint())}function zj(c,n,o){c===1?n.name=o.readString():c===2&&(n.rgb_color=N2(o.readVarint()),n.value="rgb_color")}function kj(c,n,o){c===1?n.width=n.height=o.readVarint():c===2?n.height=o.readVarint():c===3?n.children.push(k2(o,o.readVarint()+o.pos)):c===4?n.linear_gradients.push(function(u,_){return u.readFields($j,{spread_method:1,stops:[],x1:0,y1:0,x2:1,y2:0},_)}(o,o.readVarint()+o.pos)):c===5?n.radial_gradients.push(function(u,_){return u.readFields(Gj,{spread_method:1,stops:[],cx:.5,cy:.5,r:.5,fx:.5,fy:.5,fr:0},_)}(o,o.readVarint()+o.pos)):c===7?n.clip_paths.push(function(u,_){return u.readFields(Hj,{children:[]},_)}(o,o.readVarint()+o.pos)):c===8&&n.masks.push(function(u,_){const d=u.readFields(Zj,{left:0,width:20,mask_type:1,children:[]},_);return d.height==null&&(d.height=d.width),d.top==null&&(d.top=d.left),d}(o,o.readVarint()+o.pos))}function k2(c,n){return c.readFields(Bj,{},n)}function Bj(c,n,o){c===1?(n.group=function(u,_){return u.readFields(Nj,{opacity:255,children:[]},_)}(o,o.readVarint()+o.pos),n.node="group"):c===2&&(n.path=function(u,_){return u.readFields(jj,{paint_order:1,commands:[],step:1,diffs:[],rule:1},_)}(o,o.readVarint()+o.pos),n.node="path")}function Nj(c,n,o){c===1?n.transform=B2(o,o.readVarint()+o.pos):c===2?n.opacity=o.readVarint():c===5?n.clip_path_idx=o.readVarint():c===6?n.mask_idx=o.readVarint():c===7&&n.children.push(k2(o,o.readVarint()+o.pos))}function B2(c,n){return c.readFields(Fj,{sx:1,ky:0,kx:0,sy:1,tx:0,ty:0},n)}function Fj(c,n,o){c===1?n.sx=o.readFloat():c===2?n.ky=o.readFloat():c===3?n.kx=o.readFloat():c===4?n.sy=o.readFloat():c===5?n.tx=o.readFloat():c===6&&(n.ty=o.readFloat())}function jj(c,n,o){c===1?n.fill=function(u,_){return u.readFields(Uj,{rgb_color:SS,paint:"rgb_color",opacity:255},_)}(o,o.readVarint()+o.pos):c===2?n.stroke=function(u,_){return u.readFields(Vj,{rgb_color:SS,paint:"rgb_color",dasharray:[],dashoffset:0,miterlimit:4,opacity:255,width:1,linecap:1,linejoin:1},_)}(o,o.readVarint()+o.pos):c===3?n.paint_order=o.readVarint():c===5?o.readPackedVarint(n.commands):c===6?n.step=o.readFloat():c===7?o.readPackedSVarint(n.diffs):c===8&&(n.rule=o.readVarint())}function Uj(c,n,o){c===1?(n.rgb_color=N2(o.readVarint()),n.paint="rgb_color"):c===2?(n.linear_gradient_idx=o.readVarint(),n.paint="linear_gradient_idx"):c===3?(n.radial_gradient_idx=o.readVarint(),n.paint="radial_gradient_idx"):c===5&&(n.opacity=o.readVarint())}function N2(c){return new _r((c>>16&255)/255,(c>>8&255)/255,(255&c)/255,1)}function Vj(c,n,o){c===1?(n.rgb_color=N2(o.readVarint()),n.paint="rgb_color"):c===2?(n.linear_gradient_idx=o.readVarint(),n.paint="linear_gradient_idx"):c===3?(n.radial_gradient_idx=o.readVarint(),n.paint="radial_gradient_idx"):c===5?o.readPackedFloat(n.dasharray):c===6?n.dashoffset=o.readFloat():c===7?n.miterlimit=o.readFloat():c===8?n.opacity=o.readVarint():c===9?n.width=o.readFloat():c===10?n.linecap=o.readVarint():c===11&&(n.linejoin=o.readVarint())}function $j(c,n,o){c===1?n.transform=B2(o,o.readVarint()+o.pos):c===2?n.spread_method=o.readVarint():c===3?n.stops.push(GO(o,o.readVarint()+o.pos)):c===4?n.x1=o.readFloat():c===5?n.y1=o.readFloat():c===6?n.x2=o.readFloat():c===7&&(n.y2=o.readFloat())}function GO(c,n){return c.readFields(qj,{offset:0,opacity:255,rgb_color:SS},n)}function qj(c,n,o){c===1?n.offset=o.readFloat():c===2?n.opacity=o.readVarint():c===3&&(n.rgb_color=N2(o.readVarint()))}function Gj(c,n,o){c===1?n.transform=B2(o,o.readVarint()+o.pos):c===2?n.spread_method=o.readVarint():c===3?n.stops.push(GO(o,o.readVarint()+o.pos)):c===4?n.cx=o.readFloat():c===5?n.cy=o.readFloat():c===6?n.r=o.readFloat():c===7?n.fx=o.readFloat():c===8?n.fy=o.readFloat():c===9&&(n.fr=o.readFloat())}function Hj(c,n,o){c===1?n.transform=B2(o,o.readVarint()+o.pos):c===2?n.clip_path_idx=o.readVarint():c===3&&n.children.push(k2(o,o.readVarint()+o.pos))}function Zj(c,n,o){c===1?n.left=n.top=o.readFloat():c===2?n.width=n.height=o.readFloat():c===3?n.top=o.readFloat():c===4?n.height=o.readFloat():c===5?n.mask_type=o.readVarint():c===6?n.mask_idx=o.readVarint():c===7&&n.children.push(k2(o,o.readVarint()+o.pos))}class Wj{static calculate(n,o){const u=new Map,_=new Map;if(Object.keys(n).length===0)return u;o.forEach(d=>{_.set(d.name,d.rgb_color||new _r(0,0,0))});for(const[d,y]of Object.entries(n))_.has(d)?u.set(_.get(d).toStringPremultipliedAlpha(),y):console.warn(`Ignoring unknown image variable "${d}"`);return u}}function M_(c,n=255,o){const u=n/255,_=c.toStringPremultipliedAlpha(),d=o.has(_)?o.get(_).clone():c.clone();return d.a=u,d.toString()}function Fy(c,n){if(!we()){const o=document.createElement("canvas");return o.width=c,o.height=n,o}return new OffscreenCanvas(c,n)}function Xj(c,n){const o=Wj.calculate(n.params,c.metadata?c.metadata.variables:[]),u=c.usvg_tree,_=u.width,d=u.height,y=n.transform?n.transform:new DOMMatrix,E=Math.max(1,Math.round(_*y.a)),M=Math.max(1,Math.round(d*y.d)),k=new DOMMatrix([E/_,0,0,M/d,0,0]),w=Fy(E,M).getContext("2d");return ES(w,k,u,u,o),w.getImageData(0,0,E,M)}function ES(c,n,o,u,_){for(const d of u.children)HO(c,n,o,d,_)}function HO(c,n,o,u,_){u.group?(c.save(),function(d,y,E,M,k){const w=M.mask_idx!=null?E.masks[M.mask_idx]:null,I=M.clip_path_idx!=null?E.clip_paths[M.clip_path_idx]:null;if(M.transform&&(y=F2(M.transform).preMultiplySelf(y)),!function(P,B,q){return P.opacity!==255||B||q}(M,I!=null,w!=null))return void ES(d,y,E,M,k);const D=Fy(d.canvas.width,d.canvas.height),C=D.getContext("2d");ES(C,y,E,M,k),I&&QO(C,y,E,I),w&&eI(C,y,E,w,k),d.globalAlpha=M.opacity/255,d.drawImage(D,0,0)}(c,n,o,u.group,_),c.restore()):u.path&&(c.save(),function(d,y,E,M,k){const w=tI(M);d.setTransform(y),M.paint_order===VO.PAINT_ORDER_FILL_AND_STROKE?(ZO(d,E,M,w,k),XO(d,E,M,w,k)):(XO(d,E,M,w,k),ZO(d,E,M,w,k))}(c,n,o,u.path,_),c.restore())}function ZO(c,n,o,u,_){const d=o.fill;if(!d)return;const y=d.opacity/255;switch(d.paint){case"rgb_color":c.fillStyle=M_(d.rgb_color,d.opacity,_);break;case"linear_gradient_idx":c.fillStyle=YO(c,n.linear_gradients[d.linear_gradient_idx],y,_);break;case"radial_gradient_idx":c.fillStyle=KO(c,n.radial_gradients[d.radial_gradient_idx],y,_)}c.fill(u,WO(o))}function WO(c){return c.rule===TS.PATH_RULE_NON_ZERO?"nonzero":c.rule===TS.PATH_RULE_EVEN_ODD?"evenodd":void 0}function XO(c,n,o,u,_){const d=o.stroke;if(!d)return;c.lineWidth=d.width,c.miterLimit=d.miterlimit,c.setLineDash(d.dasharray),c.lineDashOffset=d.dashoffset;const y=d.opacity/255;switch(d.paint){case"rgb_color":c.strokeStyle=M_(d.rgb_color,d.opacity,_);break;case"linear_gradient_idx":c.strokeStyle=YO(c,n.linear_gradients[d.linear_gradient_idx],y,_);break;case"radial_gradient_idx":c.strokeStyle=KO(c,n.radial_gradients[d.radial_gradient_idx],y,_)}switch(d.linejoin){case Ny.LINE_JOIN_MITER_CLIP:case Ny.LINE_JOIN_MITER:c.lineJoin="miter";break;case Ny.LINE_JOIN_ROUND:c.lineJoin="round";break;case Ny.LINE_JOIN_BEVEL:c.lineJoin="bevel"}switch(d.linecap){case z2.LINE_CAP_BUTT:c.lineCap="butt";break;case z2.LINE_CAP_ROUND:c.lineCap="round";break;case z2.LINE_CAP_SQUARE:c.lineCap="square"}c.stroke(u)}function YO(c,n,o,u){if(n.stops.length===1){const D=n.stops[0];return M_(D.rgb_color,D.opacity*o,u)}const _=F2(n.transform),{x1:d,y1:y,x2:E,y2:M}=n,k=_.transformPoint(new DOMPoint(d,y)),w=_.transformPoint(new DOMPoint(E,M)),I=c.createLinearGradient(k.x,k.y,w.x,w.y);for(const D of n.stops)I.addColorStop(D.offset,M_(D.rgb_color,D.opacity*o,u));return I}function KO(c,n,o,u){if(n.stops.length===1){const D=n.stops[0];return M_(D.rgb_color,D.opacity*o,u)}const _=F2(n.transform),{fx:d,fy:y,cx:E,cy:M}=n,k=_.transformPoint(new DOMPoint(d,y)),w=_.transformPoint(new DOMPoint(E,M)),I=c.createRadialGradient(k.x,k.y,0,w.x,w.y,n.r*((_.a+_.d)/2));for(const D of n.stops)I.addColorStop(D.offset,M_(D.rgb_color,D.opacity*o,u));return I}function JO(c,n,o,u){const _=u.transform?F2(u.transform).preMultiplySelf(n):n,d=Fy(c.canvas.width,c.canvas.height),y=d.getContext("2d");for(const M of u.children)if(M.group)JO(y,_,o,M.group);else if(M.path){const k=M.path,w=new Path2D;w.addPath(tI(k),_),y.fill(w,WO(k))}const E=u.clip_path_idx!=null?o.clip_paths[u.clip_path_idx]:null;E&&QO(y,_,o,E),c.globalCompositeOperation="source-over",c.drawImage(d,0,0)}function QO(c,n,o,u){const _=Fy(c.canvas.width,c.canvas.height);JO(_.getContext("2d"),n,o,u),c.globalCompositeOperation="destination-in",c.drawImage(_,0,0)}function eI(c,n,o,u,_){if(u.children.length===0)return;const d=u.mask_idx!=null?o.masks[u.mask_idx]:null;d&&eI(c,n,o,d,_);const y=c.canvas.width,E=c.canvas.height,M=Fy(y,E),k=M.getContext("2d"),w=u.width,I=u.height,D=u.left,C=u.top,P=new Path2D,B=new Path2D;B.rect(D,C,w,I),P.addPath(B,n),k.clip(P);for(const te of u.children)HO(k,n,o,te,_);const q=k.getImageData(0,0,y,E),H=q.data;if(u.mask_type===$O.MASK_TYPE_LUMINANCE)for(let te=0;te<H.length;te+=4)H[te+3]=H[te+3]/255*(.2126*H[te]+.7152*H[te+1]+.0722*H[te+2]);k.putImageData(q,0,0),c.globalCompositeOperation="destination-in",c.drawImage(M,0,0)}function F2(c){return c?new DOMMatrix([c.sx,c.ky,c.kx,c.sy,c.tx,c.ty]):new DOMMatrix}function tI(c){const n=new Path2D,o=c.step;let u=c.diffs[0]*o,_=c.diffs[1]*o;n.moveTo(u,_);for(let d=0,y=2;d<c.commands.length;d++)switch(c.commands[d]){case C_.PATH_COMMAND_MOVE:u+=c.diffs[y++]*o,_+=c.diffs[y++]*o,n.moveTo(u,_);break;case C_.PATH_COMMAND_LINE:u+=c.diffs[y++]*o,_+=c.diffs[y++]*o,n.lineTo(u,_);break;case C_.PATH_COMMAND_QUAD:{const E=u+c.diffs[y++]*o,M=_+c.diffs[y++]*o;u=E+c.diffs[y++]*o,_=M+c.diffs[y++]*o,n.quadraticCurveTo(E,M,u,_);break}case C_.PATH_COMMAND_CUBIC:{const E=u+c.diffs[y++]*o,M=_+c.diffs[y++]*o,k=E+c.diffs[y++]*o,w=M+c.diffs[y++]*o;u=k+c.diffs[y++]*o,_=w+c.diffs[y++]*o,n.bezierCurveTo(E,M,k,w,u,_);break}case C_.PATH_COMMAND_CLOSE:n.closePath()}return n}class AS{constructor(n){this.capacity=n,this.cache=new Map}get(n){if(!this.cache.has(n))return;const o=this.cache.get(n);return this.cache.delete(n),this.cache.set(n,o),o}put(n,o){this.cache.has(n)?this.cache.delete(n):this.cache.size===this.capacity&&this.cache.delete(this.cache.keys().next().value),this.cache.set(n,o)}delete(n){this.cache.delete(n)}}class CS{constructor(){this.cacheMap=new Map,this.cacheDependenciesMap=new Map}static _getImage(n){return new Ta(n,n.data)}getFromCache(n,o,u){return this.cacheMap.has(u)||this.cacheMap.set(u,new AS(150)),this.cacheMap.get(u).get(jo(n.serialize(),o))}setInCache(n,o,u,_){this.cacheDependenciesMap.has(_)||this.cacheDependenciesMap.set(_,new Map),this.cacheMap.has(_)||this.cacheMap.set(_,new AS(150));const d=this.cacheDependenciesMap.get(_);d.get(jo(n.id,u))||d.set(jo(n.id,u),new Set);const y=this.cacheMap.get(_),E=n.serialize();d.get(jo(n.id,u)).add(E),y.put(jo(n.serialize(),u),o)}removeImagesFromCacheByIds(n,o,u=""){if(!this.cacheMap.has(u)||!this.cacheDependenciesMap.has(u))return;const _=this.cacheMap.get(u),d=this.cacheDependenciesMap.get(u);for(const y of n)if(d.has(jo(y,o))){for(const E of d.get(jo(y,o)))_.delete(E);d.delete(jo(y,o))}}rasterize(n,o,u,_,d=Xj){const y=this.getFromCache(n,u,_);if(y)return y.clone();const E=d(o.icon,n.options),M=CS._getImage(E);return this.setInCache(n,M,u,_),M.clone()}}class nI{constructor(n){this.size=n,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(n,o){const u=this.toIdx(n,o);return{min:this.minimums[u],max:this.maximums[u]}}isLeaf(n,o){return this.leaves[this.toIdx(n,o)]}toIdx(n,o){return o*this.size+n}}function rI(c,n,o,u){let _=0,d=Number.MAX_VALUE;for(let y=0;y<3;y++)if(Math.abs(u[y])<1e-15){if(o[y]<c[y]||o[y]>n[y])return null}else{const E=1/u[y];let M=(c[y]-o[y])*E,k=(n[y]-o[y])*E;if(M>k){const w=M;M=k,k=w}if(M>_&&(_=M),k<d&&(d=k),_>d)return null}return _}function iI(c,n,o,u,_,d,y,E,M,k,w){const I=u-c,D=_-n,C=d-o,P=y-c,B=E-n,q=M-o,H=w[1]*q-w[2]*B,te=w[2]*P-w[0]*q,re=w[0]*B-w[1]*P,J=I*H+D*te+C*re;if(Math.abs(J)<1e-15)return null;const ie=1/J,ce=k[0]-c,me=k[1]-n,Ce=k[2]-o,Ae=(ce*H+me*te+Ce*re)*ie;if(Ae<0||Ae>1)return null;const Ee=me*C-Ce*D,Ue=Ce*I-ce*C,Ie=ce*D-me*I,Ve=(w[0]*Ee+w[1]*Ue+w[2]*Ie)*ie;return Ve<0||Ae+Ve>1?null:(P*Ee+B*Ue+q*Ie)*ie}function aI(c,n,o){return(c-n)/(o-n)}function oI(c,n,o,u,_,d,y,E,M){const k=1<<o,w=d-u,I=y-_,D=(c+1)/k*w+u,C=(n+0)/k*I+_,P=(n+1)/k*I+_;E[0]=(c+0)/k*w+u,E[1]=C,M[0]=D,M[1]=P}class sI{constructor(n){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=n,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const o=function(d){const y=Math.ceil(Math.log2(d.dim/8)),E=[];let M=Math.ceil(Math.pow(2,y));const k=1/M,w=(C,P,B,q,H)=>{const te=q?1:0,re=(C+1)*B-te,J=P*B,ie=(P+1)*B-te;H[0]=C*B,H[1]=J,H[2]=re,H[3]=ie};let I=new nI(M);const D=[];for(let C=0;C<M*M;C++){w(C%M,Math.floor(C/M),k,!1,D);const P=Dp(D[0],D[1],d),B=Dp(D[2],D[1],d),q=Dp(D[2],D[3],d),H=Dp(D[0],D[3],d);I.minimums.push(Math.min(P,B,q,H)),I.maximums.push(Math.max(P,B,q,H)),I.leaves.push(1)}for(E.push(I),M/=2;M>=1;M/=2){const C=E[E.length-1];I=new nI(M);for(let P=0;P<M*M;P++){w(P%M,Math.floor(P/M),2,!0,D);const B=C.getElevation(D[0],D[1]),q=C.getElevation(D[2],D[1]),H=C.getElevation(D[2],D[3]),te=C.getElevation(D[0],D[3]),re=C.isLeaf(D[0],D[1]),J=C.isLeaf(D[2],D[1]),ie=C.isLeaf(D[2],D[3]),ce=C.isLeaf(D[0],D[3]),me=Math.min(B.min,q.min,H.min,te.min),Ce=Math.max(B.max,q.max,H.max,te.max),Ae=re&&J&&ie&&ce;I.maximums.push(Ce),I.minimums.push(me),I.leaves.push(Ce-me<=5&&Ae?1:0)}E.push(I)}return E}(this.dem),u=o.length-1,_=o[u];this._addNode(_.minimums[0],_.maximums[0],_.leaves[0]),this._construct(o,0,0,u,0)}raycastRoot(n,o,u,_,d,y,E=1){return rI([n,o,-100],[u,_,this.maximums[0]*E],d,y)}raycast(n,o,u,_,d,y,E=1){if(!this.nodeCount)return null;const M=this.raycastRoot(n,o,u,_,d,y,E);if(M==null)return null;const k=[],w=[],I=[],D=[],C=[{idx:0,t:M,nodex:0,nodey:0,depth:0}];for(;C.length>0;){const{idx:P,t:B,nodex:q,nodey:H,depth:te}=C.pop();if(this.leaves[P]){oI(q,H,te,n,o,u,_,I,D);const J=1<<te,ie=(q+0)/J,ce=(q+1)/J,me=(H+0)/J,Ce=(H+1)/J,Ae=Dp(ie,me,this.dem)*E,Ee=Dp(ce,me,this.dem)*E,Ue=Dp(ce,Ce,this.dem)*E,Ie=Dp(ie,Ce,this.dem)*E,Ve=iI(I[0],I[1],Ae,D[0],I[1],Ee,D[0],D[1],Ue,d,y),Ze=iI(D[0],D[1],Ue,I[0],D[1],Ie,I[0],I[1],Ae,d,y),qe=Math.min(Ve!==null?Ve:Number.MAX_VALUE,Ze!==null?Ze:Number.MAX_VALUE);if(qe!==Number.MAX_VALUE)return qe;{const Ke=Ne.vec3.scaleAndAdd([],d,y,B);if(lI(Ae,Ee,Ie,Ue,aI(Ke[0],I[0],D[0]),aI(Ke[1],I[1],D[1]))>=Ke[2])return B}continue}let re=0;for(let J=0;J<this._siblingOffset.length;J++){oI((q<<1)+this._siblingOffset[J][0],(H<<1)+this._siblingOffset[J][1],te+1,n,o,u,_,I,D),I[2]=-100,D[2]=this.maximums[this.childOffsets[P]+J]*E;const ie=rI(I,D,d,y);if(ie!=null){const ce=ie;k[J]=ce;let me=!1;for(let Ce=0;Ce<re&&!me;Ce++)ce>=k[w[Ce]]&&(w.splice(Ce,0,J),me=!0);me||(w[re]=J),re++}}for(let J=0;J<re;J++){const ie=w[J];C.push({idx:this.childOffsets[P]+ie,t:k[ie],nodex:(q<<1)+this._siblingOffset[ie][0],nodey:(H<<1)+this._siblingOffset[ie][1],depth:te+1})}}return null}_addNode(n,o,u){return this.minimums.push(n),this.maximums.push(o),this.leaves.push(u),this.childOffsets.push(0),this.nodeCount++}_construct(n,o,u,_,d){if(n[_].isLeaf(o,u)===1)return;this.childOffsets[d]||(this.childOffsets[d]=this.nodeCount);const y=_-1,E=n[y];let M=0,k=0;for(let w=0;w<this._siblingOffset.length;w++){const I=2*o+this._siblingOffset[w][0],D=2*u+this._siblingOffset[w][1],C=E.getElevation(I,D),P=E.isLeaf(I,D),B=this._addNode(C.min,C.max,P);P&&(M|=1<<w),k||(k=B)}for(let w=0;w<this._siblingOffset.length;w++)M&1<<w||this._construct(n,2*o+this._siblingOffset[w][0],2*u+this._siblingOffset[w][1],y,k+w)}}function lI(c,n,o,u,_,d){return Mn(Mn(c,o,d),Mn(n,u,d),_)}function Dp(c,n,o){const u=o.dim,_=Bn(c*u-.5,0,u-1),d=Bn(n*u-.5,0,u-1),y=Math.floor(_),E=Math.floor(d),M=Math.min(y+1,u-1),k=Math.min(E+1,u-1);return lI(o.get(y,E),o.get(M,E),o.get(y,k),o.get(M,k),_-y,d-E)}const Yj={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function Kj(c,n,o){return(256*c*256+256*n+o)/10-1e4}function Jj(c,n,o){return 256*c+n+o/256-32768}class j2{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(n,o,u,_=!1){if(this.uid=n,o.height!==o.width)throw new RangeError("DEM tiles must be square");if(u&&u!=="mapbox"&&u!=="terrarium")return void qn(`"${u}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=o.height;const d=this.dim=o.height-2,y=new Uint32Array(o.data.buffer);if(this.pixels=new Uint8Array(o.data.buffer),this.floatView=new Float32Array(o.data.buffer),this.borderReady=_,this._modifiedForSources={},!_){for(let M=0;M<d;M++)y[this._idx(-1,M)]=y[this._idx(0,M)],y[this._idx(d,M)]=y[this._idx(d-1,M)],y[this._idx(M,-1)]=y[this._idx(M,0)],y[this._idx(M,d)]=y[this._idx(M,d-1)];y[this._idx(-1,-1)]=y[this._idx(0,0)],y[this._idx(d,-1)]=y[this._idx(d-1,0)],y[this._idx(-1,d)]=y[this._idx(0,d-1)],y[this._idx(d,d)]=y[this._idx(d-1,d-1)]}const E=u==="terrarium"?Jj:Kj;for(let M=0;M<y.length;++M){const k=4*M;this.floatView[M]=E(this.pixels[k],this.pixels[k+1],this.pixels[k+2])}this._timestamp=ze.now()}_buildQuadTree(){this._tree=new sI(this)}get(n,o,u=!1){u&&(n=Bn(n,-1,this.dim),o=Bn(o,-1,this.dim));const _=this._idx(n,o);return this.floatView[_]}set(n,o,u){const _=this._idx(n,o),d=this.floatView[_];return this.floatView[_]=u,u-d}static getUnpackVector(n){return Yj[n]}_idx(n,o){if(n<-1||n>=this.dim+1||o<-1||o>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(o+1)*this.stride+(n+1)}static pack(n,o){const u=[0,0,0,0],_=j2.getUnpackVector(o);let d=Math.floor((n+_[3])/_[2]);return u[2]=d%256,d=Math.floor(d/256),u[1]=d%256,d=Math.floor(d/256),u[0]=d,u}getPixels(){return new Kg({width:this.stride,height:this.stride},this.pixels)}backfillBorder(n,o,u){if(this.dim!==n.dim)throw new Error("dem dimension mismatch");let _=o*this.dim,d=o*this.dim+this.dim,y=u*this.dim,E=u*this.dim+this.dim;switch(o){case-1:_=d-1;break;case 1:d=_+1}switch(u){case-1:y=E-1;break;case 1:E=y+1}const M=-o*this.dim,k=-u*this.dim;for(let w=y;w<E;w++)for(let I=_;I<d;I++){const D=4*this._idx(I,w),C=4*this._idx(I+M,w+k);this.pixels[D+0]=n.pixels[C+0],this.pixels[D+1]=n.pixels[C+1],this.pixels[D+2]=n.pixels[C+2],this.pixels[D+3]=n.pixels[C+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}function Qj(c,n,o){c===1?n.headerLength=o.readFixed32():c===2?n.x=o.readVarint():c===3?n.y=o.readVarint():c===4?n.z=o.readVarint():c===5&&n.layers.push(function(u,_){return u.readFields(iU,{version:0,name:"",units:"",tileSize:0,buffer:0,pixelFormat:0,dataIndex:[]},_)}(o,o.readVarint()+o.pos))}function eU(c,n,o){c===1?(n.delta_filter=function(u,_){return u.readFields(tU,{blockSize:0},_)}(o,o.readVarint()+o.pos),n.filter="delta_filter"):c===2?(o.readVarint(),n.filter="zigzag_filter"):c===3?(o.readVarint(),n.filter="bitshuffle_filter"):c===4&&(o.readVarint(),n.filter="byteshuffle_filter")}function tU(c,n,o){c===1&&(n.blockSize=o.readVarint())}function nU(c,n,o){c===1?(o.readVarint(),n.codec="gzip_data"):c===2?(o.readVarint(),n.codec="jpeg_image"):c===3?(o.readVarint(),n.codec="webp_image"):c===4&&(o.readVarint(),n.codec="png_image")}function rU(c,n,o){let u=0,_=0;c===1?n.firstByte=o.readFixed64():c===2?n.lastByte=o.readFixed64():c===3?n.filters.push(function(d,y){return d.readFields(eU,{},y)}(o,o.readVarint()+o.pos)):c===4?n.codec=function(d,y){return d.readFields(nU,{},y)}(o,o.readVarint()+o.pos):c===5?_=o.readFloat():c===6?u=o.readFloat():c===7?n.bands.push(o.readString()):c===8?n.offset=o.readDouble():c===9&&(n.scale=o.readDouble()),n.offset===0&&(n.offset=_),n.scale===0&&(n.scale=u)}function iU(c,n,o){c===1?n.version=o.readVarint():c===2?n.name=o.readString():c===3?n.units=o.readString():c===4?n.tileSize=o.readVarint():c===5?n.buffer=o.readVarint():c===6?n.pixelFormat=o.readVarint():c===7&&n.dataIndex.push(function(u,_){return u.readFields(rU,{firstByte:0,lastByte:0,filters:[],codec:null,offset:0,scale:0,bands:[]},_)}(o,o.readVarint()+o.pos))}function aU(c,n,o){if(c===2)(function(u,_,d){u.readFields(oU,d,_)})(o,o.readVarint()+o.pos,n);else if(c===3)throw new Error("Not implemented")}function oU(c,n,o){if(c===1){let u=0;const _=o.readVarint()+o.pos;for(;o.pos<_;)n[u++]=o.readVarint()}}function sU(c,n){if(n.length!==4)throw new Error(`Expected data of dimension 4 but got ${n.length}.`);let o=n[3];for(let u=2;u>=1;u--){const _=u===1?1:0,d=u===2?1:0;for(let y=0;y<n[0];y++){const E=n[1]*y;for(let M=_;M<n[1];M++){const k=n[2]*(M+E);for(let w=d;w<n[2];w++){const I=n[3]*(w+k);for(let D=0;D<n[3];D++){const C=I+D;c[C]+=c[C-o]}}}}o*=n[u]}return c}function lU(c){for(let n=0,o=c.length;n<o;n++)c[n]=c[n]>>>1^-(1&c[n]);return c}function cU(c,n){switch(n){case"uint32":return c;case"uint16":for(let o=0;o<c.length;o+=2){const u=c[o],_=c[o+1];c[o]=(240&u)>>4|(61440&u)>>8|(240&_)<<4|61440&_,c[o+1]=15&u|(3840&u)>>4|(15&_)<<8|(3840&_)<<4}return c;case"uint8":for(let o=0;o<c.length;o+=4){const u=c[o],_=c[o+1],d=c[o+2],y=c[o+3];c[o+0]=(192&u)>>6|(192&_)>>4|(192&d)>>2|192&y,c[o+1]=(48&u)>>4|(48&_)>>2|48&d|(48&y)<<2,c[o+2]=(12&u)>>2|12&_|(12&d)<<2|(12&y)<<4,c[o+3]=3&u|(3&_)<<2|(3&d)<<4|(3&y)<<6}return c;default:throw new Error(`Invalid pixel format, "${n}"`)}}hn(j2,"DEMData"),hn(sI,"DemMinMaxQuadTree",{omit:["dem"]});var $l=Uint8Array,jy=Uint16Array,uU=Int32Array,cI=new $l([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),uI=new $l([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),hU=new $l([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),hI=function(c,n){for(var o=new jy(31),u=0;u<31;++u)o[u]=n+=1<<c[u-1];var _=new uU(o[30]);for(u=1;u<30;++u)for(var d=o[u];d<o[u+1];++d)_[d]=d-o[u]<<5|u;return{b:o,r:_}},fI=hI(cI,2),dI=fI.b,fU=fI.r;dI[28]=258,fU[258]=28;for(var dU=hI(uI,0).b,pI=new jy(32768),Ki=0;Ki<32768;++Ki){var O_=(43690&Ki)>>1|(21845&Ki)<<1;pI[Ki]=((65280&(O_=(61680&(O_=(52428&O_)>>2|(13107&O_)<<2))>>4|(3855&O_)<<4))>>8|(255&O_)<<8)>>1}var Uy=function(c,n,o){for(var u=c.length,_=0,d=new jy(n);_<u;++_)c[_]&&++d[c[_]-1];var y,E=new jy(n);for(_=1;_<n;++_)E[_]=E[_-1]+d[_-1]<<1;y=new jy(1<<n);var M=15-n;for(_=0;_<u;++_)if(c[_])for(var k=_<<4|c[_],w=n-c[_],I=E[c[_]-1]++<<w,D=I|(1<<w)-1;I<=D;++I)y[pI[I]>>M]=k;return y},Vy=new $l(288);for(Ki=0;Ki<144;++Ki)Vy[Ki]=8;for(Ki=144;Ki<256;++Ki)Vy[Ki]=9;for(Ki=256;Ki<280;++Ki)Vy[Ki]=7;for(Ki=280;Ki<288;++Ki)Vy[Ki]=8;var mI=new $l(32);for(Ki=0;Ki<32;++Ki)mI[Ki]=5;var pU=Uy(Vy,9),mU=Uy(mI,5),MS=function(c){for(var n=c[0],o=1;o<c.length;++o)c[o]>n&&(n=c[o]);return n},Bu=function(c,n,o){var u=n/8|0;return(c[u]|c[u+1]<<8)>>(7&n)&o},OS=function(c,n){var o=n/8|0;return(c[o]|c[o+1]<<8|c[o+2]<<16)>>(7&n)},_U=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Nu=function(c,n,o){var u=new Error(n||_U[c]);if(u.code=c,Error.captureStackTrace&&Error.captureStackTrace(u,Nu),!o)throw u;return u},gU=new $l(0),yU=typeof TextDecoder<"u"&&new TextDecoder;try{yU.decode(gU,{stream:!0})}catch{}const vU={gzip_data:"gzip"};class Vc extends Error{constructor(n){super(n),this.name="MRTError"}}const xU={0:"uint32",1:"uint32",2:"uint16",3:"uint8"},_I={uint32:1,uint16:2,uint8:4},bU={uint32:Uint32Array,uint16:Uint16Array,uint8:Uint8Array};let IS;class PS{constructor(n=5){this.x=NaN,this.y=NaN,this.z=NaN,this.layers={},this._cacheSize=n}getLayer(n){const o=this.layers[n];if(!o)throw new Vc(`Layer '${n}' not found`);return o}getHeaderLength(n){const o=new Uint8Array(n),u=new DataView(n);if(o[0]!==13)throw new Vc("File is not a valid MRT.");return u.getUint32(1,!0)}parseHeader(n){const o=new Uint8Array(n),u=this.getHeaderLength(n);if(o.length<u)throw new Vc(`Expected header with length >= ${u} but got buffer of length ${o.length}`);const _=function(d,y){return d.readFields(Qj,{headerLength:0,x:0,y:0,z:0,layers:[]},void 0)}(new IS(o.subarray(0,u)));if(!isNaN(this.x)&&(this.x!==_.x||this.y!==_.y||this.z!==_.z))throw new Vc(`Invalid attempt to parse header ${_.z}/${_.x}/${_.y} for tile ${this.z}/${this.x}/${this.y}`);this.x=_.x,this.y=_.y,this.z=_.z;for(const d of _.layers)this.layers[d.name]=new wU(d,{cacheSize:this._cacheSize});return this}createDecodingTask(n){const o=[],u=this.getLayer(n.layerName);for(let _ of n.blockIndices){const d=u.dataIndex[_],y=d.firstByte-n.firstByte,E=d.lastByte-n.firstByte;if(u._blocksInProgress.has(_))continue;const M={layerName:u.name,firstByte:y,lastByte:E,pixelFormat:u.pixelFormat,blockIndex:_,blockShape:[d.bands.length].concat(u.bandShape),buffer:u.buffer,codec:d.codec.codec,filters:d.filters.map(k=>k.filter)};u._blocksInProgress.add(_),o.push(M)}return new gI(o,()=>{o.forEach(_=>u._blocksInProgress.delete(_.blockIndex))},(_,d)=>{if(o.forEach(y=>u._blocksInProgress.delete(y.blockIndex)),_)throw _;d.forEach(y=>{this.getLayer(y.layerName).processDecodedData(y)})})}}class wU{constructor({version:n,name:o,units:u,tileSize:_,pixelFormat:d,buffer:y,dataIndex:E},M){if(this.version=n,this.version!==1)throw new Vc(`Cannot parse raster layer encoded with MRT version ${n}`);this.name=o,this.units=u,this.tileSize=_,this.buffer=y,this.pixelFormat=xU[d],this.dataIndex=E,this.bandShape=[_+2*y,_+2*y,_I[this.pixelFormat]],this._decodedBlocks=new AS(M?M.cacheSize:5),this._blocksInProgress=new Set}get dimension(){return _I[this.pixelFormat]}get cacheSize(){return this._decodedBlocks.capacity}getBandList(){return this.dataIndex.map(({bands:n})=>n).flat()}processDecodedData(n){const o=n.blockIndex.toString();this._decodedBlocks.get(o)||this._decodedBlocks.put(o,n.data)}getBlockForBand(n){let o=0;switch(typeof n){case"string":for(const[u,_]of this.dataIndex.entries()){for(const[d,y]of _.bands.entries())if(y===n)return{bandIndex:o+d,blockIndex:u,blockBandIndex:d};o+=_.bands.length}break;case"number":for(const[u,_]of this.dataIndex.entries()){if(n>=o&&n<o+_.bands.length)return{bandIndex:n,blockIndex:u,blockBandIndex:n-o};o+=_.bands.length}break;default:throw new Vc(`Invalid band \`${JSON.stringify(n)}\`. Expected string or integer.`)}throw new Vc(`Band not found: ${JSON.stringify(n)}`)}getDataRange(n){let o=1/0,u=-1/0;const _=[],d=new Set;for(const y of n){const{blockIndex:E}=this.getBlockForBand(y);if(E<0)throw new Vc(`Invalid band: ${JSON.stringify(y)}`);const M=this.dataIndex[E];_.includes(E)||_.push(E),d.add(E),o=Math.min(o,M.firstByte),u=Math.max(u,M.lastByte)}if(d.size>this.cacheSize)throw new Vc(`Number of blocks to decode (${d.size}) exceeds cache size (${this.cacheSize}).`);return{layerName:this.name,firstByte:o,lastByte:u,blockIndices:_}}hasBand(n){const{blockIndex:o}=this.getBlockForBand(n);return o>=0}hasDataForBand(n){const{blockIndex:o}=this.getBlockForBand(n);return o>=0&&!!this._decodedBlocks.get(o.toString())}getBandView(n){const{blockIndex:o,blockBandIndex:u}=this.getBlockForBand(n),_=this._decodedBlocks.get(o.toString());if(!_)throw new Vc(`Data for band ${JSON.stringify(n)} of layer "${this.name}" not decoded.`);const d=this.dataIndex[o],y=this.bandShape.reduce((k,w)=>k*w,1),E=u*y,M=_.subarray(E,E+y);return{data:M,bytes:new Uint8Array(M.buffer).subarray(M.byteOffset,M.byteOffset+M.byteLength),tileSize:this.tileSize,buffer:this.buffer,pixelFormat:this.pixelFormat,dimension:this.dimension,offset:d.offset,scale:d.scale}}}PS.setPbf=function(c){IS=c};class gI{constructor(n,o,u){this.tasks=n,this._onCancel=o,this._onComplete=u,this._finalized=!1}cancel(){this._finalized||(this._onCancel(),this._finalized=!0)}complete(n,o){this._finalized||(this._onComplete(n,o),this._finalized=!0)}}PS.performDecoding=function(c,n){const o=new Uint8Array(c);return Promise.all(n.tasks.map(u=>{const{layerName:_,firstByte:d,lastByte:y,pixelFormat:E,blockShape:M,blockIndex:k,filters:w,codec:I}=u,D=o.subarray(d,y+1),C=new Uint32Array(M[0]*M[1]*M[2]);let P;if(I!=="gzip_data")throw new Vc(`Unhandled codec: ${I}`);return P=function(B,q){if(!globalThis.DecompressionStream&&q==="gzip_data")return Promise.resolve(((J=function(me){me[0]==31&&me[1]==139&&me[2]==8||Nu(6,"invalid gzip data");var Ce=me[3],Ae=10;4&Ce&&(Ae+=2+(me[10]|me[11]<<8));for(var Ee=(Ce>>3&1)+(Ce>>4&1);Ee>0;Ee-=!me[Ae++]);return Ae+(2&Ce)}(re=B))+8>re.length&&Nu(6,"invalid gzip data"),function(me,Ce,Ae,Ee){var Ue=me.length;if(!Ue||Ce.f&&!Ce.l)return Ae||new $l(0);var Ie=!Ae,Ve=Ie||Ce.i!=2,Ze=Ce.i;Ie&&(Ae=new $l(3*Ue));var qe,Ke,Qe=function(Lp){var e0=Ae.length;if(Lp>e0){var Hy=new $l(Math.max(2*e0,Lp));Hy.set(Ae),Ae=Hy}},at=Ce.f||0,Je=Ce.p||0,wt=Ce.b||0,Rt=Ce.l,bt=Ce.d,an=Ce.m,Jt=Ce.n,Ut=8*Ue;do{if(!Rt){at=Bu(me,Je,1);var zt=Bu(me,Je+1,3);if(Je+=3,!zt){var vn=me[(jn=4+((Je+7)/8|0))-4]|me[jn-3]<<8,ln=jn+vn;if(ln>Ue){Ze&&Nu(0);break}Ve&&Qe(wt+vn),Ae.set(me.subarray(jn,ln),wt),Ce.b=wt+=vn,Ce.p=Je=8*ln,Ce.f=at;continue}if(zt==1)Rt=pU,bt=mU,an=9,Jt=5;else if(zt==2){var pn=Bu(me,Je,31)+257,kn=Bu(me,Je+10,15)+4,Gn=pn+Bu(me,Je+5,31)+1;Je+=14;for(var Zn=new $l(Gn),Wn=new $l(19),lr=0;lr<kn;++lr)Wn[hU[lr]]=Bu(me,Je+3*lr,7);Je+=3*kn;var ur=MS(Wn),Zr=(1<<ur)-1,Lr=Uy(Wn,ur);for(lr=0;lr<Gn;){var jn,Pr=Lr[Bu(me,Je,Zr)];if(Je+=15&Pr,(jn=Pr>>4)<16)Zn[lr++]=jn;else{var Rr=0,ri=0;for(jn==16?(ri=3+Bu(me,Je,3),Je+=2,Rr=Zn[lr-1]):jn==17?(ri=3+Bu(me,Je,7),Je+=3):jn==18&&(ri=11+Bu(me,Je,127),Je+=7);ri--;)Zn[lr++]=Rr}}var Bi=Zn.subarray(0,pn),Ji=Zn.subarray(pn);an=MS(Bi),Jt=MS(Ji),Rt=Uy(Bi,an),bt=Uy(Ji,Jt)}else Nu(1);if(Je>Ut){Ze&&Nu(0);break}}Ve&&Qe(wt+131072);for(var Ni=(1<<an)-1,Oi=(1<<Jt)-1,Gi=Je;;Gi=Je){var aa=(Rr=Rt[OS(me,Je)&Ni])>>4;if((Je+=15&Rr)>Ut){Ze&&Nu(0);break}if(Rr||Nu(2),aa<256)Ae[wt++]=aa;else{if(aa==256){Gi=Je,Rt=null;break}var mo=aa-254;aa>264&&(mo=Bu(me,Je,(1<<(ju=cI[lr=aa-257]))-1)+dI[lr],Je+=ju);var Qr=bt[OS(me,Je)&Oi],Vs=Qr>>4;if(Qr||Nu(3),Je+=15&Qr,Ji=dU[Vs],Vs>3){var ju=uI[Vs];Ji+=OS(me,Je)&(1<<ju)-1,Je+=ju}if(Je>Ut){Ze&&Nu(0);break}Ve&&Qe(wt+131072);var $c=wt+mo;if(wt<Ji){var qc=0-Ji,Qm=Math.min(Ji,$c);for(qc+wt<0&&Nu(3);wt<Qm;++wt)Ae[wt]=(void 0)[qc+wt]}for(;wt<$c;++wt)Ae[wt]=Ae[wt-Ji]}}Ce.l=Rt,Ce.p=Gi,Ce.b=wt,Ce.f=at,Rt&&(at=1,Ce.m=an,Ce.d=bt,Ce.n=Jt)}while(!at);return wt!=Ae.length&&Ie?(qe=Ae,((Ke=wt)==null||Ke>qe.length)&&(Ke=qe.length),new $l(qe.subarray(0,Ke))):Ae.subarray(0,wt)}(re.subarray(J,-8),{i:2},new $l(((H=re)[(te=H.length)-4]|H[te-3]<<8|H[te-2]<<16|H[te-1]<<24)>>>0))));var H,te,re,J;const ie=vU[q];if(!ie)throw new Error(`Unhandled codec: ${q}`);const ce=new globalThis.DecompressionStream(ie);return new Response(new Blob([B]).stream().pipeThrough(ce)).arrayBuffer().then(me=>new Uint8Array(me))}(D,I).then(B=>(function(q,H){q.readFields(aU,H)}(new IS(B),C),new bU[E](C.buffer))),P.then(B=>{for(let q=w.length-1;q>=0;q--)switch(w[q]){case"delta_filter":sU(B,M);break;case"zigzag_filter":lU(B);break;case"bitshuffle_filter":cU(B,E);break;default:throw new Vc(`Unhandled filter "${w[q]}"`)}return{layerName:_,blockIndex:k,data:B}}).catch(B=>{throw B})}))},hn(gI,"MRTDecodingBatch",{omit:["_onCancel","_onComplete"]});let $y,RS,Fu,I_,DS,P_=null;function yI(){return Qo()&&self.worker&&self.worker.dracoUrl?self.worker.dracoUrl:RS||vi.DRACO_URL}function vI(){if(Qo()&&self.worker&&self.worker.meshoptUrl)return self.worker.meshoptUrl;if(I_)return I_;const c=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]);if(typeof WebAssembly!="object")throw new Error("WebAssembly not supported, cannot instantiate meshoptimizer");return I_=WebAssembly.validate(c)?vi.MESHOPT_SIMD_URL:vi.MESHOPT_URL,I_}const U2={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},SU={5120:"DT_INT8",5121:"DT_UINT8",5122:"DT_INT16",5123:"DT_UINT16",5125:"DT_UINT32",5126:"DT_FLOAT32"},qy={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16};function xI(c,n,o){const u=o.json.bufferViews.length,_=o.buffers.length;n.bufferView=u,o.json.bufferViews[u]={buffer:_,byteLength:c.byteLength},o.buffers[_]=c}const LS="KHR_draco_mesh_compression";function TU(c,n){const o=c.extensions&&c.extensions[LS];if(!o)return;const u=new Fu.Decoder,_=TI(n,o.bufferView),d=new Fu.Mesh;if(!u.DecodeArrayToMesh(_,_.byteLength,d))throw new Error("Failed to decode Draco mesh");const y=n.json.accessors[c.indices],E=U2[y.componentType],M=y.count*E.BYTES_PER_ELEMENT,k=Fu._malloc(M);E===Uint16Array?u.GetTrianglesUInt16Array(d,M,k):u.GetTrianglesUInt32Array(d,M,k),xI(Fu.memory.buffer.slice(k,k+M),y,n),Fu._free(k);for(const w of Object.keys(o.attributes)){const I=u.GetAttributeByUniqueId(d,o.attributes[w]),D=n.json.accessors[c.attributes[w]],C=SU[D.componentType],P=D.count*qy[D.type]*U2[D.componentType].BYTES_PER_ELEMENT,B=Fu._malloc(P);u.GetAttributeDataArrayForAllPoints(d,I,Fu[C],P,B),xI(Fu.memory.buffer.slice(B,B+P),D,n),Fu._free(B)}u.destroy(),d.destroy(),delete c.extensions[LS]}const V2="EXT_meshopt_compression";function EU(c,n){if(!c.extensions||!c.extensions[V2])return;const o=c.extensions[V2],u=new Uint8Array(n.buffers[o.buffer],o.byteOffset||0,o.byteLength||0),_=new Uint8Array(o.count*o.byteStride);DS.decodeGltfBuffer(_,o.count,o.byteStride,u,o.mode,o.filter),c.buffer=n.buffers.length,c.byteOffset=0,n.buffers[c.buffer]=_.buffer,delete c.extensions[V2]}const bI=1179937895,wI=new TextDecoder("utf8");function SI(c,n){return new URL(c,n).href}function AU(c,n,o,u){return fetch(SI(c.uri,u)).then(_=>_.arrayBuffer()).then(_=>{n.buffers[o]=_})}function TI(c,n){const o=c.json.bufferViews[n];return new Uint8Array(c.buffers[o.buffer],o.byteOffset||0,o.byteLength)}function CU(c,n,o,u){if(c.uri){const _=SI(c.uri,u);return fetch(_).then(d=>d.blob()).then(d=>createImageBitmap(d)).then(d=>{n.images[o]=d})}if(c.bufferView!==void 0){const _=TI(n,c.bufferView),d=new Blob([_],{type:c.mimeType});return createImageBitmap(d).then(y=>{n.images[o]=y})}}function EI(c,n=0,o){const u={json:null,images:[],buffers:[]};if(new Uint32Array(c,n,1)[0]===bI){const w=new Uint32Array(c,n);let I=2;const D=(w[I++]>>2)-3,C=w[I++]>>2;if(I++,u.json=JSON.parse(wI.decode(w.subarray(I,I+C))),I+=C,I<D){const P=w[I++];I++;const B=n+(I<<2);u.buffers[0]=c.slice(B,B+P)}}else u.json=JSON.parse(wI.decode(new Uint8Array(c,n)));const{buffers:_,images:d,meshes:y,extensionsUsed:E,bufferViews:M}=u.json;let k=Promise.resolve();if(_){const w=[];for(let I=0;I<_.length;I++){const D=_[I];D.uri?w.push(AU(D,u,I,o)):u.buffers[I]||(u.buffers[I]=null)}k=Promise.all(w)}return k.then(()=>{const w=[],I=E&&E.includes(LS),D=E&&E.includes(V2);if(I&&w.push(function(){if(!Fu)return $y??($y=function(C){let P,B=null;function q(){P=new Uint8Array(B.buffer)}function H(){throw new Error("Unexpected Draco error.")}const te={a:{a:H,d:function(re,J,ie){return P.copyWithin(re,J,J+ie)},c:function(re){const J=P.length,ie=Math.max(re>>>0,Math.ceil(1.2*J)),ce=Math.ceil((ie-J)/65536);try{return B.grow(ce),q(),!0}catch{return!1}},b:H}};return(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(C,te):C.then(re=>re.arrayBuffer()).then(re=>WebAssembly.instantiate(re,te))).then(re=>{const{Rb:J,Qb:ie,P:ce,T:me,X:Ce,Ja:Ae,La:Ee,Qa:Ue,Va:Ie,Wa:Ve,eb:Ze,jb:qe,f:Ke,e:Qe,yb:at,zb:Je,Ab:wt,Bb:Rt,Db:bt,Gb:an}=re.instance.exports;B=Qe;const Jt=(()=>{let Ut=0,zt=0,vn=0,ln=0;return pn=>{vn&&(J(ln),J(Ut),zt+=vn,vn=Ut=0),Ut||(zt+=128,Ut=ie(zt));const kn=pn.length+7&-8;let Gn=Ut;kn>=zt&&(vn=kn,Gn=ln=ie(kn));for(let Zn=0;Zn<pn.length;Zn++)P[Gn+Zn]=pn[Zn];return Gn}})();return q(),Ke(),{memory:Qe,_free:J,_malloc:ie,Mesh:class{constructor(){this.ptr=ce()}destroy(){me(this.ptr)}},Decoder:class{constructor(){this.ptr=Ae()}destroy(){qe(this.ptr)}DecodeArrayToMesh(Ut,zt,vn){const ln=Jt(Ut),pn=Ee(this.ptr,ln,zt,vn.ptr);return!!Ce(pn)}GetAttributeByUniqueId(Ut,zt){return{ptr:Ue(this.ptr,Ut.ptr,zt)}}GetTrianglesUInt16Array(Ut,zt,vn){Ie(this.ptr,Ut.ptr,zt,vn)}GetTrianglesUInt32Array(Ut,zt,vn){Ve(this.ptr,Ut.ptr,zt,vn)}GetAttributeDataArrayForAllPoints(Ut,zt,vn,ln,pn){Ze(this.ptr,Ut.ptr,zt.ptr,vn,ln,pn)}},DT_INT8:at(),DT_UINT8:Je(),DT_INT16:wt(),DT_UINT16:Rt(),DT_UINT32:bt(),DT_FLOAT32:an()}})}(fetch(yI())),$y.then(C=>{Fu=C,$y=void 0}))}()),D&&w.push(function(){if(DS)return;const C=function(P){let B;const q=WebAssembly.instantiateStreaming(P,{}).then(re=>{B=re.instance,B.exports.__wasm_call_ctors()}),H={NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},te={ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return{ready:q,supported:!0,decodeGltfBuffer(re,J,ie,ce,me,Ce){(function(Ae,Ee,Ue,Ie,Ve,Ze,qe){const Ke=Ae.exports.sbrk,Qe=Ie+3&-4,at=Ke(Qe*Ve),Je=Ke(Ze.length),wt=new Uint8Array(Ae.exports.memory.buffer);wt.set(Ze,Je);const Rt=Ee(at,Ie,Ve,Je,Ze.length);if(Rt===0&&qe&&qe(at,Qe,Ve),Ue.set(wt.subarray(at,at+Ie*Ve)),Ke(at-Ke(0)),Rt!==0)throw new Error(`Malformed buffer data: ${Rt}`)})(B,B.exports[te[me]],re,J,ie,ce,B.exports[H[Ce]])}}}(fetch(vI()));return C.ready.then(()=>{DS=C})}()),d)for(let C=0;C<d.length;C++)w.push(CU(d[C],u,C,o));return(w.length?Promise.all(w):Promise.resolve()).then(()=>{if(I&&y)for(const{primitives:C}of y)for(const P of C)TU(P,u);if(D&&y&&M)for(const C of M)EU(C,u);return u})})}function Jm(c,n){const o=c.json.bufferViews[n.bufferView],u=U2[n.componentType];return new u(c.buffers[o.buffer],(n.byteOffset||0)+(o.byteOffset||0),n.count*(o.byteStride&&o.byteStride!==qy[n.type]*u.BYTES_PER_ELEMENT?o.byteStride/u.BYTES_PER_ELEMENT:qy[n.type]))}function zS(c,n,o,u){const _=U2[n.componentType],d=function(w){switch(w){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:return 1}}(_),y=c.json.bufferViews[n.bufferView],E=y.byteStride?y.byteStride/_.BYTES_PER_ELEMENT:qy[n.type],M=o.float32,k=M.length/o.capacity;for(let w=0,I=0;w<n.count*E;w+=E,I+=k)for(let D=0;D<k;D++)M[I+D]=u[w+D]*d;o._trim()}function MU(c,n,o){const u=c.indices,_=c.attributes,d={};d.indexArray=new ia;const y=n.json.accessors[u],E=y.count/3;d.indexArray.reserve(E);const M=Jm(n,y);for(let D=0;D<E;D++)d.indexArray.emplaceBack(M[3*D],M[3*D+1],M[3*D+2]);d.indexArray._trim(),d.vertexArray=new tl;const k=n.json.accessors[_.POSITION];d.vertexArray.reserve(k.count);const w=Jm(n,k);for(let D=0;D<k.count;D++)d.vertexArray.emplaceBack(w[3*D],w[3*D+1],w[3*D+2]);if(d.vertexArray._trim(),d.aabb=new sn(k.min,k.max),d.centroid=function(D,C){const P=[0,0,0],B=D.length;if(B>0){for(let q=0;q<B;q++){const H=3*D[q];P[0]+=C[H],P[1]+=C[H+1],P[2]+=C[H+2]}P[0]/=B,P[1]/=B,P[2]/=B}return P}(M,w),_.COLOR_0!==void 0){const D=n.json.accessors[_.COLOR_0],C=qy[D.type],P=Jm(n,D);d.colorArray=C===3?new tl:new Ic,d.colorArray.resize(D.count),zS(n,D,d.colorArray,P)}if(_.NORMAL!==void 0){d.normalArray=new tl;const D=n.json.accessors[_.NORMAL];d.normalArray.resize(D.count);const C=Jm(n,D);zS(n,D,d.normalArray,C)}if(_.TEXCOORD_0!==void 0&&o.length>0){d.texcoordArray=new Eu;const D=n.json.accessors[_.TEXCOORD_0];d.texcoordArray.resize(D.count);const C=Jm(n,D);zS(n,D,d.texcoordArray,C)}if(_._FEATURE_ID_RGBA4444!==void 0){const D=n.json.accessors[_._FEATURE_ID_RGBA4444];n.json.extensionsUsed&&n.json.extensionsUsed.includes("EXT_meshopt_compression")&&(d.featureData=Jm(n,D))}_._FEATURE_RGBA4444!==void 0&&(d.featureData=new Uint32Array(Jm(n,n.json.accessors[_._FEATURE_RGBA4444]).buffer));const I=c.material;return d.material=function(D,C){const{emissiveFactor:P=[0,0,0],alphaMode:B="OPAQUE",alphaCutoff:q=.5,normalTexture:H,occlusionTexture:te,emissiveTexture:re,doubleSided:J}=D,{baseColorFactor:ie=[1,1,1,1],metallicFactor:ce=1,roughnessFactor:me=1,baseColorTexture:Ce,metallicRoughnessTexture:Ae}=D.pbrMetallicRoughness||{},Ee=te?C[te.index]:void 0;if(te&&te.extensions&&te.extensions.KHR_texture_transform&&Ee){const Ue=te.extensions.KHR_texture_transform;Ee.offsetScale=[Ue.offset[0],Ue.offset[1],Ue.scale[0],Ue.scale[1]]}return{pbrMetallicRoughness:{baseColorFactor:new _r(...ie),metallicFactor:ce,roughnessFactor:me,baseColorTexture:Ce?C[Ce.index]:void 0,metallicRoughnessTexture:Ae?C[Ae.index]:void 0},doubleSided:J,emissiveFactor:P,alphaMode:B,alphaCutoff:q,normalTexture:H?C[H.index]:void 0,occlusionTexture:Ee,emissionTexture:re?C[re.index]:void 0,defined:D.defined===void 0}}(I!==void 0?n.json.materials[I]:{defined:!1},o),d}function AI(c,n,o){const{matrix:u,rotation:_,translation:d,scale:y,mesh:E,extras:M,children:k}=c,w={};if(w.matrix=u||Ne.mat4.fromRotationTranslationScale([],_||[0,0,0,1],d||[0,0,0],y||[1,1,1]),E!==void 0){w.meshes=o[E];const I=w.anchor=[0,0];for(const D of w.meshes){const{min:C,max:P}=D.aabb;I[0]+=C[0]+P[0],I[1]+=C[1]+P[1]}I[0]=Math.floor(I[0]/w.meshes.length/2),I[1]=Math.floor(I[1]/w.meshes.length/2)}if(M&&(M.id&&(w.id=M.id),M.lights&&(w.lights=function(I){if(!I.length)return[];const D=function(H){const te=atob(H),re=new Uint8Array(te.length);for(let J=0;J<te.length;J++)re[J]=te.codePointAt(J);return re}(I),C=[],P=D.length/24,B=new Uint16Array(D.buffer),q=new Float32Array(D.buffer);for(let H=0;H<P;H++){const te=B[2*H*6]/30,re=B[2*H*6+1]/30,J=B[2*H*6+10]/100,ie=q[6*H+1],ce=q[6*H+2],me=q[6*H+3],Ce=q[6*H+4],Ae=me-ie,Ee=Ce-ce,Ue=Math.hypot(Ae,Ee);C.push({pos:[ie+.5*Ae,ce+.5*Ee,re],normal:[Ee/Ue,-Ae/Ue,0],width:Ue,height:te,depth:J,points:[ie,ce,me,Ce]})}return C}(M.lights))),k){const I=[];for(const D of k)I.push(AI(n.json.nodes[D],n,o));w.children=I}return w}function OU(c){if(c.vertices.length===0||c.indices.length===0)return null;const n=new ty(c.vertices,c.indices,8,256),[o,u]=[n.min.clone(),n.max.clone()];return{vertices:c.vertices,indices:c.indices,grid:n,min:o,max:u}}function IU(c){if(!c.extras||!c.extras.ground)return null;const n=c.extras.ground;if(!n||!Array.isArray(n)||n.length===0)return null;const o=n[0];if(!o||!Array.isArray(o)||o.length===0)return null;const u=[];for(const y of o){if(!Array.isArray(y)||y.length!==2)continue;const E=y[0],M=y[1];typeof E=="number"&&typeof M=="number"&&u.push(new It(E,M))}if(u.length<3)return null;u.length>1&&u[u.length-1].equals(u[0])&&u.pop();let _=0;for(let y=0;y<u.length;y++){const E=u[y],M=u[(y+1)%u.length],k=u[(y+2)%u.length];_+=(E.x-M.x)*(k.y-M.y)-(k.x-M.x)*(E.y-M.y)}_>0&&u.reverse();const d=Pm(u.flatMap(y=>[y.x,y.y]),[]);return d.length===0?null:{vertices:u,indices:d}}function PU(c,n){const o=[],u=[];let _=0;const d=[];for(const y of c){_=o.length;const E=y.vertexArray.float32,M=y.indexArray.uint16;for(let k=0;k<y.vertexArray.length;k++)d[0]=E[3*k+0],d[1]=E[3*k+1],d[2]=E[3*k+2],Ne.vec3.transformMat4(d,d,n),o.push(new It(d[0],d[1]));for(let k=0;k<3*y.indexArray.length;k++)u.push(M[k]+_)}if(u.length%3!=0)return null;for(let y=0;y<u.length;y+=3){const E=o[u[y+0]],M=o[u[y+1]],k=o[u[y+2]];(E.x-M.x)*(k.y-M.y)-(k.x-M.x)*(E.y-M.y)>0&&([u[y+1],u[y+2]]=[u[y+2],u[y+1]])}return{vertices:o,indices:u}}function CI(c){const n=function(M,k){const w=[],I=WebGL2RenderingContext;if(M.json.textures)for(const D of M.json.textures){const C={magFilter:I.LINEAR,minFilter:I.NEAREST,wrapS:I.REPEAT,wrapT:I.REPEAT};D.sampler!==void 0&&Object.assign(C,M.json.samplers[D.sampler]),w.push({image:k[D.source],sampler:C,uploaded:!1})}return w}(c,c.images),o=function(M,k){const w=[];for(const I of M.json.meshes){const D=[];for(const C of I.primitives)D.push(MU(C,M,k));w.push(D)}return w}(c,n),{scenes:u,scene:_,nodes:d}=c.json,y=u?u[_||0].nodes:d,E=[];for(const M of y)E.push(AI(d[M],c,o));return function(M,k,w){const I={},D=new Set;for(let C=0;C<M.length;C++){const P=w[k[C]];if(!P.extras)continue;const B=P.extras["mapbox:footprint:version"],q=P.extras["mapbox:footprint:id"];(B||q)&&D.add(C),B==="1.0.0"&&q&&(I[q]=C)}for(let C=0;C<M.length;C++){if(D.has(C))continue;const P=M[C],B=w[k[C]];if(!B.extras)continue;let q=null;P.id in I&&(q=PU(M[I[P.id]].meshes,P.matrix)),q||(q=IU(B)),q&&(P.footprint=OU(q))}if(D.size>0){const C=Array.from(D.values()).sort((P,B)=>P-B);for(let P=C.length-1;P>=0;P--)M.splice(C[P],1)}}(E,y,c.json.nodes),E}function RU(c){c.heightmap=new Float32Array(4096),c.heightmap.fill(-1);const n=c.vertexArray.float32,o=c.aabb.min[0]-1,u=c.aabb.min[1]-1,_=Xm/(c.aabb.max[0]-o+2),d=Xm/(c.aabb.max[1]-u+2);for(let y=0;y<n.length;y+=3){const E=n[y+2],M=(n[y+0]-o)*_|0,k=(n[y+1]-u)*d|0;E>c.heightmap[k*Xm+M]&&(c.heightmap[k*Xm+M]=E)}}function DU(c,n){const o={};o.indexArray=new ia,o.indexArray.reserve(4*c.length),o.vertexArray=new tl,o.vertexArray.reserve(10*c.length),o.colorArray=new Ic,o.vertexArray.reserve(10*c.length);let u=0;for(const y of c){const E=Math.min(10,Math.max(4,1.3*y.height))*n,M=[-y.normal[1],y.normal[0],0],k=Math.min(.29,.1*y.width/y.depth),w=y.width-2*y.depth*n*(k+.01),I=Ne.vec3.scaleAndAdd([],y.pos,M,w/2),D=Ne.vec3.scaleAndAdd([],y.pos,M,-w/2),C=[I[0],I[1],I[2]+y.height],P=[D[0],D[1],D[2]+y.height],B=Ne.vec3.scaleAndAdd([],y.normal,M,k);Ne.vec3.scale(B,B,E);const q=Ne.vec3.scaleAndAdd([],y.normal,M,-k);Ne.vec3.scale(q,q,E),Ne.vec3.add(B,I,B),Ne.vec3.add(q,D,q),I[2]+=.1,D[2]+=.1,o.vertexArray.emplaceBack(B[0],B[1],B[2]),o.vertexArray.emplaceBack(q[0],q[1],q[2]),o.vertexArray.emplaceBack(I[0],I[1],I[2]),o.vertexArray.emplaceBack(D[0],D[1],D[2]),o.vertexArray.emplaceBack(C[0],C[1],C[2]),o.vertexArray.emplaceBack(P[0],P[1],P[2]),o.vertexArray.emplaceBack(I[0],I[1],I[2]),o.vertexArray.emplaceBack(D[0],D[1],D[2]),o.vertexArray.emplaceBack(B[0],B[1],B[2]),o.vertexArray.emplaceBack(q[0],q[1],q[2]);const H=w/E/2;o.colorArray.emplaceBack(-H-k,-1,H,.8),o.colorArray.emplaceBack(H+k,-1,H,.8),o.colorArray.emplaceBack(-H,0,H,1.3),o.colorArray.emplaceBack(H,0,H,1.3),o.colorArray.emplaceBack(H+k,-.8,H,.7),o.colorArray.emplaceBack(H+k,-.8,H,.7),o.colorArray.emplaceBack(0,0,H,1.3),o.colorArray.emplaceBack(0,0,H,1.3),o.colorArray.emplaceBack(H+k,-1.2,H,.8),o.colorArray.emplaceBack(H+k,-1.2,H,.8),o.indexArray.emplaceBack(6+u,4+u,8+u),o.indexArray.emplaceBack(7+u,9+u,5+u),o.indexArray.emplaceBack(0+u,1+u,2+u),o.indexArray.emplaceBack(1+u,3+u,2+u),u+=10}const _={defined:!0,emissiveFactor:[0,0,0]},d={};return d.baseColorFactor=_r.white,_.pbrMetallicRoughness=d,o.material=_,o.aabb=new sn([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),o}class MI{constructor(n){this._stringToNumber={},this._numberToString=[];for(let o=0;o<n.length;o++){const u=n[o];this._stringToNumber[u]=o,this._numberToString[o]=u}}encode(n){return this._stringToNumber[n]}decode(n){return this._numberToString[n]}}const LU=["id","tile","layer","source","sourceLayer","state"];class R_{constructor(n,o,u,_,d){this.type="Feature",this._vectorTileFeature=n,this._z=o,this._x=u,this._y=_,this.properties=n.properties,this.id=d}clone(){const n=new R_(this._vectorTileFeature,this._z,this._x,this._y,this.id);return this.state&&(n.state=Object.assign({},this.state)),this.layer&&(n.layer=Object.assign({},this.layer)),this.source&&(n.source=this.source),this.sourceLayer&&(n.sourceLayer=this.sourceLayer),n}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(n){this._geometry=n}toJSON(){const n={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};for(const o of LU)this[o]!==void 0&&(n[o]=this[o]);return n}}class OI{constructor(n,o){this.tileID=n,this.x=n.canonical.x,this.y=n.canonical.y,this.z=n.canonical.z,this.grid=new bu(Kt,16,0),this.featureIndexArray=new Ph,this.promoteId=o,this.is3DTile=!1,this.serializedLayersCache=new Map}insert(n,o,u,_,d,y=0,E=0){const M=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(u,_,d,y);const k=this.grid;for(let w=0;w<o.length;w++){const I=o[w],D=[1/0,1/0,-1/0,-1/0];for(let C=0;C<I.length;C++){const P=I[C];D[0]=Math.min(D[0],P.x),D[1]=Math.min(D[1],P.y),D[2]=Math.max(D[2],P.x),D[3]=Math.max(D[3],P.y)}E!==0&&(D[0]-=E,D[1]-=E,D[2]+=E,D[3]+=E),D[0]<Kt&&D[1]<Kt&&D[2]>=0&&D[3]>=0&&k.insert(M,D[0],D[1],D[2],D[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new rd.VectorTile(new g(this.rawTileData)).layers,this.sourceLayerCoder=new MI(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const n in this.vtLayers)this.vtFeatures[n]=[]}return this.vtLayers}query(n,o){const{tilespaceGeometry:u,transform:_,tileTransform:d,pixelPosMatrix:y,availableImages:E}=o;this.loadVTLayers(),this.serializedLayersCache.clear();const M=u.bufferedTilespaceBounds,k=this.grid.query(M.min.x,M.min.y,M.max.x,M.max.y,(C,P,B,q)=>$e(u.bufferedTilespaceGeometry,C,P,B,q));k.sort(zU);let w=null;_.elevation&&k.length>0&&(w=E_.create(_.elevation,this.tileID));const I={};let D;for(let C=0;C<k.length;C++){const P=k[C];if(P===D)continue;D=P;const B=this.featureIndexArray.get(P);let q=null;this.is3DTile?this.loadMatchingModelFeature(I,B,n,u,_):this.loadMatchingFeature(I,B,n,E,(H,te,re,J=0)=>(q||(q=$(H,this.tileID.canonical,d)),te.queryIntersectsFeature(u,H,re,q,this.z,_,y,w,J)))}return I}loadMatchingFeature(n,o,u,_,d){const{featureIndex:y,bucketIndex:E,sourceLayerIndex:M,layoutVertexArrayOffset:k}=o,w=this.bucketLayerIDs[E],I=u.layers,D=Object.keys(I);if(D.length&&!function(H,te){for(let re=0;re<H.length;re++)if(te.indexOf(H[re])>=0)return!0;return!1}(D,w))return;const C=u.sourceCache,P=this.sourceLayerCoder.decode(M),B=this.vtLayers[P].feature(y),q=this.getId(B,P);for(let H=0;H<w.length;H++){const te=w[H];if(!I[te])continue;const{styleLayer:re,targets:J}=I[te];let ie={};q!==void 0&&(ie=C.getFeatureState(re.sourceLayer,q));const ce=!d||d(B,re,ie,k);if(!ce)continue;const me=new R_(B,this.z,this.x,this.y,q);me.tile=this.tileID.canonical,me.state=ie;let Ce=this.serializedLayersCache.get(te);Ce||(Ce=re.serialize(),Ce.id=te,this.serializedLayersCache.set(te,Ce)),me.source=Ce.source,me.sourceLayer=Ce["source-layer"],me.layer=ua({},Ce),me.layer.paint=II(Ce.paint,re.paint,B,ie,_),me.layer.layout=II(Ce.layout,re.layout,B,ie,_);let Ae=!1;for(const Ee of J){this.updateFeatureProperties(me,Ee);const{filter:Ue}=Ee;if(Ue){if(B.properties=me.properties,Ue.needGeometry){const Ie=Z(B,!0);if(!Ue.filter(new kr(this.tileID.overscaledZ),Ie,this.tileID.canonical))continue}else if(!Ue.filter(new kr(this.tileID.overscaledZ),B))continue}Ae=!0,Ee.targetId&&this.addFeatureVariant(me,Ee)}Ae&&this.appendToResult(n,te,y,me,ce)}}loadMatchingModelFeature(n,o,u,_,d){const y=this.bucketLayerIDs[0][0],E=u.layers;if(!E[y])return;const{styleLayer:M,targets:k}=E[y];if(M.type!=="model")return;const w=_.tile,I=o.featureIndex,D=w.getBucket(M);if(!(D&&D instanceof D2))return;const C=function(Ce,Ae,Ee,Ue){const Ie=Ce.getNodesInfo()[Ae];if(Ie.hiddenByReplacement||!Ie.node.meshes)return;let Ve=Number.MAX_VALUE;const Ze=Ie.node,qe=Ee.tile,Ke=Ue.calculatePosMatrix(qe.tileID.toUnwrapped(),Ue.worldSize),Qe=Ie.evaluatedScale;let at=0;Ue.elevation&&Ze.elevation&&(at=Ze.elevation*Ue.elevation.exaggeration()),Ne.mat4.translate(Ke,Ke,[(Ze.anchor?Ze.anchor[0]:0)*(Qe[0]-1),(Ze.anchor?Ze.anchor[1]:0)*(Qe[1]-1),at]),Ne.mat4.scale(Ke,Ke,Qe);const Je=Ee.queryGeometry,wt=Je.isPointQuery()?Je.screenBounds:Je.screenGeometry,Rt=function(an){const Jt=Ne.mat4.multiply([],Ke,an.matrix);Ne.mat4.multiply(Jt,Ue.expandedFarZProjMatrix,Jt);for(let Ut=0;Ut<an.meshes.length;++Ut){const zt=an.meshes[Ut];if(Ut===an.lightMeshIndex)continue;const vn=MO(wt,Ue,Jt,zt.aabb);vn!=null&&(Ve=Math.min(vn,Ve))}if(an.children)for(const Ut of an.children)Rt(Ut)};if(Rt(Ze),Ve===Number.MAX_VALUE)return;const bt=new pr(0,0);return jO(qe.tileID.canonical,bt,Ie.node.anchor[0],Ie.node.anchor[1]),{intersectionZ:Ve,position:bt,feature:Ie.feature}}(D,I,_,d);if(!C)return;const{z:P,x:B,y:q}=w.tileID.canonical,{feature:H,intersectionZ:te,position:re}=C;let J={};H.id!==void 0&&(J=u.sourceCache.getFeatureState(M.sourceLayer,H.id));const ie=new R_({},P,B,q,H.id);ie.tile=this.tileID.canonical,ie.state=J,ie.properties=H.properties,ie.geometry={type:"Point",coordinates:[re.lng,re.lat]};let ce=this.serializedLayersCache.get(y);ce||(ce=M.serialize(),ce.id=y,this.serializedLayersCache.set(y,ce)),ie.source=ce.source,ie.sourceLayer=ce["source-layer"],ie.layer=ua({},ce);let me=!1;for(const Ce of k){this.updateFeatureProperties(ie,Ce);const{filter:Ae}=Ce;if(Ae){if(H.properties=ie.properties,Ae.needGeometry){if(!Ae.filter(new kr(this.tileID.overscaledZ),H,this.tileID.canonical))continue}else if(!Ae.filter(new kr(this.tileID.overscaledZ),H))continue}me=!0,Ce.targetId&&this.addFeatureVariant(ie,Ce)}me&&this.appendToResult(n,y,I,ie,te)}updateFeatureProperties(n,o,u){if(o.properties){const _={};for(const d in o.properties){const y=o.properties[d].evaluate({zoom:this.z},n._vectorTileFeature,n.state,n.tile,u);y!=null&&(_[d]=y)}n.properties=_}}addFeatureVariant(n,o,u){const _={target:o.target,namespace:o.namespace,uniqueFeatureID:o.uniqueFeatureID};o.properties&&(_.properties=n.properties),n.variants=n.variants||{},n.variants[o.targetId]=n.variants[o.targetId]||[],n.variants[o.targetId].push(_)}appendToResult(n,o,u,_,d){let y=n[o];y===void 0&&(y=n[o]=[]),y.push({featureIndex:u,feature:_,intersectionZ:d})}lookupSymbolFeatures(n,o,u,_,d){const y={};this.loadVTLayers();for(const E of n)this.loadMatchingFeature(y,{bucketIndex:o,sourceLayerIndex:u,featureIndex:E,layoutVertexArrayOffset:0},_,d);return y}loadFeature(n){const{featureIndex:o,sourceLayerIndex:u}=n;this.loadVTLayers();const _=this.sourceLayerCoder.decode(u),d=this.vtFeatures[_];if(d[o])return d[o];const y=this.vtLayers[_].feature(o);return d[o]=y,y}hasLayer(n){for(const o of this.bucketLayerIDs)for(const u of o)if(n===u)return!0;return!1}getId(n,o){let u=n.id;if(this.promoteId){const _=Array.isArray(this.promoteId)||typeof this.promoteId!="object"?this.promoteId:this.promoteId[o];if(_!=null)if(Array.isArray(_)){if(!this.promoteIdExpression){const d=Ri(_);if(d.result!=="success"){const y=d.value.map(E=>`${E.key}: ${E.message}`).join(", ");return void qn(`Failed to create expression for promoteId: ${y}`)}this.promoteIdExpression=d.value}this.promoteIdExpression._evaluator||(this.promoteIdExpression._evaluator=new im),u=this.promoteIdExpression.evaluate({zoom:0},n)}else u=n.properties[_];typeof u=="boolean"&&(u=Number(u))}return u}}function II(c,n,o,u,_){return Ca(c,(d,y)=>{const E=n instanceof wu?n.get(y):null;return E&&E.evaluate?E.evaluate(o,u,_):E})}function zU(c,n){return n-c}hn(OI,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});const PI=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class kS{static from(n){if(!(n instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[o,u]=new Uint8Array(n,0,2);if(o!==219)throw new Error("Data does not appear to be in a KDBush format.");const _=u>>4;if(_!==1)throw new Error(`Got v${_} data when expected v1.`);const d=PI[15&u];if(!d)throw new Error("Unrecognized array type.");const[y]=new Uint16Array(n,2,1),[E]=new Uint32Array(n,4,1);return new kS(E,y,d,n)}constructor(n,o=64,u=Float64Array,_){if(isNaN(n)||n<0)throw new Error(`Unpexpected numItems value: ${n}.`);this.numItems=+n,this.nodeSize=Math.min(Math.max(+o,2),65535),this.ArrayType=u,this.IndexArrayType=n<65536?Uint16Array:Uint32Array;const d=PI.indexOf(this.ArrayType),y=2*n*this.ArrayType.BYTES_PER_ELEMENT,E=n*this.IndexArrayType.BYTES_PER_ELEMENT,M=(8-E%8)%8;if(d<0)throw new Error(`Unexpected typed array class: ${u}.`);_&&_ instanceof ArrayBuffer?(this.data=_,this.ids=new this.IndexArrayType(this.data,8,n),this.coords=new this.ArrayType(this.data,8+E+M,2*n),this._pos=2*n,this._finished=!0):(this.data=new ArrayBuffer(8+y+E+M),this.ids=new this.IndexArrayType(this.data,8,n),this.coords=new this.ArrayType(this.data,8+E+M,2*n),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+d]),new Uint16Array(this.data,2,1)[0]=o,new Uint32Array(this.data,4,1)[0]=n)}add(n,o){const u=this._pos>>1;return this.ids[u]=u,this.coords[this._pos++]=n,this.coords[this._pos++]=o,u}finish(){const n=this._pos>>1;if(n!==this.numItems)throw new Error(`Added ${n} items when expected ${this.numItems}.`);return BS(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(n,o,u,_){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:d,coords:y,nodeSize:E}=this,M=[0,d.length-1,0],k=[];for(;M.length;){const w=M.pop()||0,I=M.pop()||0,D=M.pop()||0;if(I-D<=E){for(let q=D;q<=I;q++){const H=y[2*q],te=y[2*q+1];H>=n&&H<=u&&te>=o&&te<=_&&k.push(d[q])}continue}const C=D+I>>1,P=y[2*C],B=y[2*C+1];P>=n&&P<=u&&B>=o&&B<=_&&k.push(d[C]),(w===0?n<=P:o<=B)&&(M.push(D),M.push(C-1),M.push(1-w)),(w===0?u>=P:_>=B)&&(M.push(C+1),M.push(I),M.push(1-w))}return k}within(n,o,u){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:_,coords:d,nodeSize:y}=this,E=[0,_.length-1,0],M=[],k=u*u;for(;E.length;){const w=E.pop()||0,I=E.pop()||0,D=E.pop()||0;if(I-D<=y){for(let q=D;q<=I;q++)DI(d[2*q],d[2*q+1],n,o)<=k&&M.push(_[q]);continue}const C=D+I>>1,P=d[2*C],B=d[2*C+1];DI(P,B,n,o)<=k&&M.push(_[C]),(w===0?n-u<=P:o-u<=B)&&(E.push(D),E.push(C-1),E.push(1-w)),(w===0?n+u>=P:o+u>=B)&&(E.push(C+1),E.push(I),E.push(1-w))}return M}}function BS(c,n,o,u,_,d){if(_-u<=o)return;const y=u+_>>1;RI(c,n,y,u,_,d),BS(c,n,o,u,y-1,1-d),BS(c,n,o,y+1,_,1-d)}function RI(c,n,o,u,_,d){for(;_>u;){if(_-u>600){const k=_-u+1,w=o-u+1,I=Math.log(k),D=.5*Math.exp(2*I/3),C=.5*Math.sqrt(I*D*(k-D)/k)*(w-k/2<0?-1:1);RI(c,n,o,Math.max(u,Math.floor(o-w*D/k+C)),Math.min(_,Math.floor(o+(k-w)*D/k+C)),d)}const y=n[2*o+d];let E=u,M=_;for(Gy(c,n,u,o),n[2*_+d]>y&&Gy(c,n,u,_);E<M;){for(Gy(c,n,E,M),E++,M--;n[2*E+d]<y;)E++;for(;n[2*M+d]>y;)M--}n[2*u+d]===y?Gy(c,n,u,M):(M++,Gy(c,n,M,_)),M<=o&&(u=M+1),o<=M&&(_=M-1)}}function Gy(c,n,o,u){NS(c,o,u),NS(n,2*o,2*u),NS(n,2*o+1,2*u+1)}function NS(c,n,o){const u=c[n];c[n]=c[o],c[o]=u}function DI(c,n,o,u){const _=c-o,d=n-u;return _*_+d*d}i.$=gm,i.A=Oa,i.B=2,i.C=Cy,i.D=A_,i.E=bl,i.F=G4,i.G=class extends P2{},i.H=Is,i.I=CS,i.J=df,i.K=ap,i.L=Ya,i.M=mh,i.N=_h,i.O=gh,i.P=It,i.Q=kf,i.R=vr,i.S=vh,i.T=dS,i.U=Ri,i.V=P2,i.W=ch,i.X=Pa,i.Y=uu,i.Z=so,i._=rs,i.a=function(c){return vi.API_CDN_URL_REGEX.test(c)},i.a$=R_,i.a0=us,i.a1=tp,i.a2=function(c){const n=c.value;let o=[];if(!n)return o;const u=Is(n);return u!=="string"?(o=o.concat([new P2(c.key,n,`string expected, "${u}" found`)]),o):(IO(n,!0)||(o=o.concat([new P2(c.key,n,`invalid url "${n}"`)])),o)},i.a3=st,i.a4=Th,i.a5=ni,i.a6=qt,i.a7=class{constructor(c){this.specification=c}possiblyEvaluate(c,n){return $a(c.expression.evaluate(n))}interpolate(c,n,o){return{x:Mn(c.x,n.x,o),y:Mn(c.y,n.y,o),z:Mn(c.z,n.z,o),azimuthal:Mn(c.azimuthal,n.azimuthal,o),polar:Mn(c.polar,n.polar,o)}}},i.a8=kr,i.a9=Pl,i.aA=ys,i.aB=class{constructor(c){this.entries={},this.scheduler=c}request(c,n,o,u){const _=this.entries[c]=this.entries[c]||{callbacks:[]};if(_.result){const[d,y]=_.result;return this.scheduler?this.scheduler.add(()=>{u(d,y)},n):u(d,y),()=>{}}return _.callbacks.push(u),_.cancel||(_.cancel=o((d,y)=>{_.result=[d,y];for(const E of _.callbacks)this.scheduler?this.scheduler.add(()=>{E(d,y)},n):E(d,y);setTimeout(()=>delete this.entries[c],3e3)})),()=>{_.result||(_.callbacks=_.callbacks.filter(d=>d!==u),_.callbacks.length||(_.cancel(),delete this.entries[c]))}}},i.aC=jo,i.aD=function(c,n,o){const u=JSON.stringify(c.request);return c.data&&(this.deduped.entries[u]={result:[null,c.data]}),this.deduped.request(u,{type:"parseTile",isSymbolTile:c.isSymbolTile,zoom:c.tileZoom},_=>{const d=ii(c.request,(y,E,M,k)=>{y?_(y):E&&_(null,{vectorTile:o?void 0:new rd.VectorTile(new g(E)),rawData:E,cacheControl:M,expires:k})});return()=>{d.cancel(),_()}},n)},i.aE=function(c){gn++,gn>ct&&(c.getActor().send("enforceCacheSizeLimit",Ye),gn=0)},i.aF=function(c){return c<=1?1:Math.pow(2,Math.floor(Math.log(c)/Math.LN2))},i.aG=kt,i.aH=gO,i.aI=SO,i.aJ=_O,i.aK=function(c,n){const o=document.createElement("video");o.muted=!0,o.onloadstart=function(){n(null,o)};for(let u=0;u<c.length;u++){const _=document.createElement("source");di(c[u])||(o.crossOrigin="Anonymous"),_.src=c[u],o.appendChild(_)}return{cancel:()=>{}}},i.aL=A2,i.aM=function(c){return fetch(c).then(n=>n.arrayBuffer()).then(n=>EI(n,0,c))},i.aN=CI,i.aO=class{constructor(c,n,o,u){this.id=c,this.position=n!=null?new pr(n[0],n[1]):new pr(0,0),this.orientation=o??[0,0,0],this.nodes=u,this.uploaded=!1,this.aabb=new sn([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),this.matrix=[]}_applyTransformations(c,n){if(Ne.mat4.multiply(c.matrix,n,c.matrix),c.meshes)for(const o of c.meshes){const u=sn.applyTransformFast(o.aabb,c.matrix);this.aabb.encapsulate(u)}if(c.children)for(const o of c.children)this._applyTransformations(o,c.matrix)}computeBoundsAndApplyParent(){const c=Ne.mat4.identity([]);for(const n of this.nodes)this._applyTransformations(n,c)}computeModelMatrix(c,n,o,u,_,d,y=!1){zO(this.matrix,this,c.transform,this.position,n,o,u,_,d,y)}upload(c){if(!this.uploaded){for(const n of this.nodes)yS(n,c);for(const n of this.nodes)R2(n);this.uploaded=!0}}destroy(){for(const c of this.nodes)vS(c)}},i.aP=Ku,i.aQ=Oy,i.aR=Ja,i.aS=$i,i.aT=Ls,i.aU=ia,i.aV=nc,i.aW=dp,i.aX=T2,i.aY=function(){Yr.isLoading()||Yr.isLoaded()||Sh()!=="deferred"||Da()},i.aZ=ym,i.a_=Z,i.aa=l,i.ab=Ne,i.ac=Lo,i.ad=wu,i.ae=ka,i.af=Mn,i.ag=Kt,i.ah=ou,i.ai=$n,i.aj=_r,i.ak=class{constructor(c){this.specification=c}possiblyEvaluate(c,n){return function([o,u]){const _=$a([1,o,u]);return{x:_.x,y:_.y,z:_.z}}(c.expression.evaluate(n))}interpolate(c,n,o){return{x:Mn(c.x,n.x,o),y:Mn(c.y,n.y,o),z:Mn(c.z,n.z,o)}}},i.al=function(c,n,o=0,u=!0){const _=new It(o,o),d=c.sub(_),y=n.add(_),E=[d,new It(y.x,d.y),y,new It(d.x,y.y)];return u&&E.push(d.clone()),E},i.am=function(c,n){const o=[];for(let u=0;u<c.length;u++){const _=Jo(u-1,-1,c.length-1),d=Jo(u+1,-1,c.length-1),y=c[u],E=c[d],M=c[_].sub(y).unit(),k=E.sub(y).unit(),w=k.angleWithSep(M.x,M.y),I=M.add(k).unit().mult(-1*n/Math.sin(w/2));o.push(y.add(I))}return o},i.an=nO,i.ao=$e,i.ap=function(c,n,o=0){return Ne.vec3.fromValues(((n.x-o)*c.scale-c.x)*Kt,(n.y*c.scale-c.y)*Kt,ol(n.z,n.y))},i.aq=Ln,i.ar=gy,i.as=function(c){let n=1/0,o=1/0,u=-1/0,_=-1/0;for(const d of c)n=Math.min(n,d.x),o=Math.min(o,d.y),u=Math.max(u,d.x),_=Math.max(_,d.y);return{min:new It(n,o),max:new It(u,_)}},i.at=js,i.au=De,i.av=x,i.aw=Bn,i.ax=La,i.ay=function(c,n){const o={};for(let u=0;u<n.length;u++){const _=n[u];_ in c&&(o[_]=c[_])}return o},i.az=jl,i.b=function(c){return vi.API_FONTS_REGEX.test(c)},i.b$=O2,i.b0=es,i.b1=ld,i.b2=t_,i.b3=$,i.b4=el,i.b5=Bl,i.b6=bn,i.b7=ci,i.b8=Pm,i.b9=uS,i.bA=e2,i.bB=iS,i.bC=J4,i.bD=xt,i.bE=kS,i.bF=Jo,i.bG=Zs,i.bH=za,i.bI=function(c,n,o){c[4*n+0]=o[0],c[4*n+1]=o[1],c[4*n+2]=o[2],c[4*n+3]=o[3]},i.bJ=Wf,i.bK=Uo,i.bL=Lc,i.bM=pi,i.bN=Ou,i.bO=pr,i.bP=sO,i.bQ=At,i.bR=mr,i.bS=EO,i.bT=Pt,i.bU=Ci,i.bV=function(c,n,o,u,_,d,y,E,M){if(M.name==="globe")return Ci(c,n,new Pt(o,u,_),!1);const k=Oy({z:o,x:u,y:_},M);return new sn([(d+k.x/k.scale)*n,n*(k.y/k.scale),y],[(d+k.x2/k.scale)*n,n*(k.y2/k.scale),E])},i.bW=function(c,n,o){let u=0;for(let _=0;_<2;++_)c[_]>0&&(u+=(c[_]-0)*(c[_]-0)),n[_]<0&&(u+=(0-n[_])*(0-n[_]));return u},i.bX=Br,i.bY=Fl,i.bZ=function(c){const n=Ne.mat4.identity(new Float64Array(16));Ne.mat4.multiply(n,c.pixelMatrix,c.globeMatrix);const o=[0,Ga,0],u=[0,Ha,0];return Ne.vec3.transformMat4(o,o,n),Ne.vec3.transformMat4(u,u,n),[o[0]>0&&o[0]<=c.width&&o[1]>0&&o[1]<=c.height&&!Sa(c,new pr(c.center.lat,90)),u[0]>0&&u[0]<=c.width&&u[1]>0&&u[1]<=c.height&&!Sa(c,new pr(c.center.lat,-90))]},i.b_=function(c,n){const{scale:o}=c.tileTransform,u=o*Kt/(c.tileSize*Math.pow(2,n.zoom-c.tileID.overscaledZ+c.tileID.canonical.z));return Ne.mat2.scale(new Float32Array(4),n.inverseAdjustmentMatrix,[u,u])},i.ba=function(c,n){const o=ka(n.zoom);if(o===0)return Kr(c);const u=hr(c),_=Tr(u),d=js(u.getWest())*n.worldSize,y=js(u.getEast())*n.worldSize,E=ys(u.getNorth())*n.worldSize,M=ys(u.getSouth())*n.worldSize,k=[d,E,0],w=[y,E,0],I=[d,M,0],D=[y,M,0],C=Ne.mat4.invert([],n.globeMatrix);return Ne.vec3.transformMat4(k,k,C),Ne.vec3.transformMat4(w,w,C),Ne.vec3.transformMat4(I,I,C),Ne.vec3.transformMat4(D,D,C),_[0]=hi(_[0],I,o),_[1]=hi(_[1],D,o),_[2]=hi(_[2],w,o),_[3]=hi(_[3],k,o),sn.fromPoints(_)},i.bb=xi,i.bc=Sr,i.bd=hi,i.be=Tu,i.bf=Sn,i.bg=PS,i.bh=g,i.bi=ii,i.bj=function(c){const n=[];for(const o in c)n.push(c[o]);return n},i.bk=function(c,n){const o=[];for(const u in c)u in n||o.push(u);return o},i.bl=ml,i.bm=["type","source","source-layer","minzoom","maxzoom","filter","layout"],i.bn=Ir,i.bo=function(c,n){const{x:o,y:u}=c.point,_=Qa(o,u,c.worldSize/c._pixelsPerMercatorPixel,0,0);return Ne.mat4.multiply(_,_,Or(Kr(n)))},i.bp=ud,i.bq=Be,i.br=cd,i.bs=function(c,n,o,u,_){const d=5*n+2;c.float32[d+0]=o,c.float32[d+1]=u,c.float32[d+2]=_},i.bt=S2,i.bu=q4,i.bv=oe,i.bw=Ba,i.bx=s_,i.by=OO,i.bz=oy,i.c=uf,i.c$=(c,n,o,u,_,d,y,E)=>{const M=c.transform,k=M.pitch<15?yy(.07,.7,Bn((14-M.zoom)/5,0,1)):.07,w=o.paint.get("line-trim-color-use-theme").constantOr("default")==="none";return{u_matrix:vy(c,n,o,u),u_texsize:n.imageAtlasTexture?n.imageAtlasTexture.size:[0,0],u_pixels_to_tile_units:M.calculatePixelsToTileUnitsMatrix(n),u_device_pixel_ratio:_,u_width_scale:d,u_floor_width_scale:y,u_image:0,u_tile_units_to_pixels:p_(n,M),u_units_to_pixels:[1/M.pixelsToGLUnits[0],1/M.pixelsToGLUnits[1]],u_alpha_discard_threshold:0,u_trim_offset:E,u_trim_fade_range:o.paint.get("line-trim-fade-range"),u_trim_color:o.paint.get("line-trim-color").toRenderColor(w?null:o.lut).toArray01(),u_emissive_strength:o.paint.get("line-emissive-strength"),u_zbias_factor:k,u_tile_to_meter:r(n.tileID.canonical,0)}},i.c0=TO,i.c1=function(c){const n=TO(c,!0);return Ne.mat2.invert([],[n[0],n[1],n[4],n[5]])},i.c2=zn,i.c3=function(c){const{x:n,y:o}=c.point,{lng:u,lat:_}=c._center;return Qa(n,o,c.worldSize,u,_)},i.c4=si,i.c5=Wt,i.c6=$o,i.c7=function(c){const n=Math.round((c+45+360)%360/90)%4;return ca[n]},i.c8=45,i.c9=Xf,i.cA=class extends _s{constructor(c){super(c),this.current=gp}set(c,n,o){if(this.fetchUniformLocation(c,n)){for(let u=0;u<9;u++)if(o[u]!==this.current[u]){this.current=o,this.gl.uniformMatrix3fv(this.location,!1,o);break}}}},i.cB=Aa,i.cC=function(c,n,o){const u=ka(o.zoom),_=c.style.map._antialias,d=c.terrain&&c.terrain.exaggeration()>0;return u===0&&!_&&!d},i.cD=function(c){const n=c.pixelsPerMeter,o=n/za(1,c.center.lat),u=Ne.mat4.identity(new Float64Array(16));return Ne.mat4.translate(u,u,[c.point.x,c.point.y,0]),Ne.mat4.scale(u,u,[o,o,n]),Float32Array.from(u)},i.cE=hr,i.cF=function(c){const n=Br-5;c=Bn(c,-80.051129,n)/n*90;const o=Math.pow(Math.abs(Math.sin($n(c))),3);return Math.round(o*(zh.length-1))},i.cG=function(c,n,o,u){const _=n.getNorth(),d=n.getSouth(),y=n.getWest(),E=n.getEast(),M=1<<c.z,k=E-y,w=_-d,I=k/zc,D=-w/zh[o],C=[0,I,0,D,0,0,_,y,0];if(c.z>0){const P=180/u;Ne.mat3.multiply(C,C,[P/k+1,0,0,0,P/w+1,0,-.5*P/I,.5*P/D,1])}return C[2]=M,C[5]=c.x,C[8]=c.y,C},i.cH=Kr,i.cI=function(c,n,o){const u=Ne.mat4.identity(new Float64Array(16)),_=(n/(1<<c)-.5)*Math.PI*2;return Ne.mat4.rotateY(u,o.globeMatrix,_),Float32Array.from(u)},i.cJ=class{isDataAvailableAtPoint(c){const n=this._source();if(this.isUsingMockSource()||!n||c.y<0||c.y>1)return!1;const o=n.getSource().maxzoom,u=1<<o,_=Math.floor(c.x),d=Math.floor((c.x-_)*u),y=Math.floor(c.y*u),E=this.findDEMTileFor(new kt(o,_,o,d,y));return!(!E||!E.dem)}getAtPointOrZero(c,n=0){return this.getAtPoint(c,n)||0}getAtPoint(c,n,o=!0){if(this.isUsingMockSource())return null;n==null&&(n=null);const u=this._source();if(!u||c.y<0||c.y>1)return n;const _=u.getSource().maxzoom,d=1<<_,y=Math.floor(c.x),E=c.x-y,M=new kt(_,y,_,Math.floor(E*d),Math.floor(c.y*d)),k=this.findDEMTileFor(M);if(!k||!k.dem)return n;const w=k.dem,I=1<<k.tileID.canonical.z,D=(E*I-k.tileID.canonical.x)*w.dim,C=(c.y*I-k.tileID.canonical.y)*w.dim,P=Math.floor(D),B=Math.floor(C);return(o?this.exaggeration():1)*Mn(Mn(w.get(P,B),w.get(P,B+1),C-B),Mn(w.get(P+1,B),w.get(P+1,B+1),C-B),D-P)}getAtTileOffset(c,n,o){const u=1<<c.canonical.z;return this.getAtPointOrZero(new l(c.wrap+(c.canonical.x+n/Kt)/u,(c.canonical.y+o/Kt)/u))}getAtTileOffsetFunc(c,n,o,u){return _=>{const d=this.getAtTileOffset(c,_.x,_.y),y=u.upVector(c.canonical,_.x,_.y),E=u.upVectorScale(c.canonical,n,o).metersToTile;return Ne.vec3.scale(y,y,d*E),y}}getForTilePoints(c,n,o,u){if(this.isUsingMockSource())return!1;const _=E_.create(this,c,u);return!!_&&(n.forEach(d=>{d[2]=this.exaggeration()*_.getElevationAt(d[0],d[1],o)}),!0)}getMinMaxForTile(c){if(this.isUsingMockSource())return null;const n=this.findDEMTileFor(c);if(!n||!n.dem)return null;const o=n.dem.tree,u=n.tileID,_=1<<c.canonical.z-u.canonical.z;let d=c.canonical.x/_-u.canonical.x,y=c.canonical.y/_-u.canonical.y,E=0;for(let M=0;M<c.canonical.z-u.canonical.z&&!o.leaves[E];M++){d*=2,y*=2;const k=2*Math.floor(y)+Math.floor(d);E=o.childOffsets[E]+k,d%=1,y%=1}return{min:this.exaggeration()*o.minimums[E],max:this.exaggeration()*o.maximums[E]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(c,n,o){throw new Error("Pure virtual method called.")}pointCoordinate(c){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(c){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}getMinMaxForVisibleTiles(){const c=this.visibleDemTiles;if(c.length===0)return null;let n=!1,o=Number.MAX_VALUE,u=Number.MIN_VALUE;for(const _ of c){const d=this.getMinMaxForTile(_.tileID);d&&(o=Math.min(o,d.min),u=Math.max(u,d.max),n=!0)}return n?{min:o,max:u}:null}},i.cK=Kg,i.cL=In,i.cM=function(c,n){return[Math.pow(c[0],2.2)*n,Math.pow(c[1],2.2)*n,Math.pow(c[2],2.2)*n]},i.cN=Mo,i.cO=Qu,i.cP=lf,i.cQ=256,i.cR=function(c,n){const o=[0,0,0],u=xi(Kr(n.canonical));return Ne.vec3.transformMat4(o,o,u),Ne.vec3.transformMat4(o,o,c),o},i.cS=c=>({u_camera_to_center_distance:new pi(c),u_extrude_scale:new Nl(c),u_device_pixel_ratio:new pi(c),u_matrix:new Wf(c),u_inv_rot_matrix:new Wf(c),u_merc_center:new Uo(c),u_tile_id:new Lc(c),u_zoom_transition:new pi(c),u_up_dir:new Lc(c),u_emissive_strength:new pi(c)}),i.cT=c=>({u_matrix:new Wf(c),u_pixels_to_tile_units:new Nl(c),u_device_pixel_ratio:new pi(c),u_width_scale:new pi(c),u_floor_width_scale:new pi(c),u_units_to_pixels:new Uo(c),u_dash_image:new Ou(c),u_gradient_image:new Ou(c),u_image_height:new pi(c),u_texsize:new Uo(c),u_tile_units_to_pixels:new pi(c),u_alpha_discard_threshold:new pi(c),u_trim_offset:new Uo(c),u_trim_fade_range:new Uo(c),u_trim_color:new Dh(c),u_emissive_strength:new pi(c),u_zbias_factor:new pi(c),u_tile_to_meter:new pi(c)}),i.cU=c=>({u_matrix:new Wf(c),u_texsize:new Uo(c),u_pixels_to_tile_units:new Nl(c),u_device_pixel_ratio:new pi(c),u_width_scale:new pi(c),u_floor_width_scale:new pi(c),u_image:new Ou(c),u_units_to_pixels:new Uo(c),u_tile_units_to_pixels:new pi(c),u_alpha_discard_threshold:new pi(c),u_trim_offset:new Uo(c),u_trim_fade_range:new Uo(c),u_trim_color:new Dh(c),u_emissive_strength:new pi(c),u_zbias_factor:new pi(c),u_tile_to_meter:new pi(c)}),i.cV=Vf,i.cW=Qw,i.cX=eS,i.cY=Bc,i.cZ=(c,n,o,u,_,d)=>{const y=c.transform,E=y.projection.name==="globe";let M;if(d.paint.get("circle-pitch-alignment")==="map")if(E){const w=Mo(y.zoom,n.canonical)*y._pixelsPerMercatorPixel;M=Float32Array.from([w,0,0,w])}else M=y.calculatePixelsToTileUnitsMatrix(o);else M=new Float32Array([y.pixelsToGLUnits[0],0,0,y.pixelsToGLUnits[1]]);const k={u_camera_to_center_distance:c.transform.getCameraToCenterDistance(y.projection),u_matrix:c.translatePosMatrix(n.projMatrix,o,d.paint.get("circle-translate"),d.paint.get("circle-translate-anchor")),u_device_pixel_ratio:ze.devicePixelRatio,u_extrude_scale:M,u_inv_rot_matrix:Ul,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0],u_emissive_strength:d.paint.get("circle-emissive-strength")};if(E){k.u_inv_rot_matrix=u,k.u_merc_center=_,k.u_tile_id=[n.canonical.x,n.canonical.y,1<<n.canonical.z],k.u_zoom_transition=ka(y.zoom);const w=_[0]*Kt,I=_[1]*Kt;k.u_up_dir=y.projection.upVector(new Pt(0,0,0),w,I)}return k},i.c_=qm,i.ca=Dh,i.cb=function(c,n,o){const u=Math.sqrt(c*c+n*n+o*o),_=u>0?Math.acos(o/u)*ki:0;let d=c!==0||n!==0?Math.atan2(-n,-c)*ki+90:0;return d<0&&(d+=360),[u,d,_]},i.cc=r,i.cd=sn,i.ce=$a,i.cf=function(c){return[Math.pow(c[0],1/2.2),Math.pow(c[1],1/2.2),Math.pow(c[2],1/2.2)]},i.cg=function(c,n){return c.readFields(Pj,{icons:[]},n)},i.ch=function(c){return c({pluginStatus:co,pluginURL:zl}),Sc.on("pluginStateChange",c),c},i.ci=L2,i.cj=b_,i.ck=nS,i.cl=zo,i.cm=_m,i.cn=We,i.co=ns,i.cp=ea,i.cq=function(c){const n=c.indexOf(Nf);return n>=0?c.slice(0,n):c},i.cr=function(c){return c.indexOf(Nf)>=0},i.cs=function(c){const n=c.indexOf(Nf);return n>=0?c.slice(n+1):""},i.ct=function(c){const n=[],o=c.id;return o===void 0&&n.push({message:`layers.${o}: missing required property "id"`}),c.render===void 0&&n.push({message:`layers.${o}: missing required method "render"`}),c.renderingMode&&c.renderingMode!=="2d"&&c.renderingMode!=="3d"&&n.push({message:`layers.${o}: property "renderingMode" must be either "2d" or "3d"`}),n},i.cu=function(c,n,o,u){return c.type==="custom"?new gj(c,n):new Mj[c.type](c,n,o,u)},i.cv=Ju,i.cw=class extends R_{constructor(c,n){super(c._vectorTileFeature,c._z,c._x,c._y,c.id),c.state&&(this.state=Object.assign({},c.state)),this.target=n.target,this.namespace=n.namespace,n.properties&&(this.properties=n.properties),this.target&&("featuresetId"in this.target&&!this.target.importId||"layerId"in this.target)&&(this.source=c.source,this.sourceLayer=c.sourceLayer,this.layer=c.layer)}toJSON(){const c=super.toJSON();return c.target=this.target,c.namespace=this.namespace,c}},i.cx=Sc,i.cy=Ai,i.cz=rl,i.d=function(c){return vi.API_TILEJSON_REGEX.test(c)},i.d$=OI,i.d0=(c,n,o,u,_,d,y,E,M)=>{const k=c.transform,w=k.calculatePixelsToTileUnitsMatrix(n),I=o.paint.get("line-trim-color-use-theme").constantOr("default")==="none",D=k.pitch<15?yy(.07,.7,Bn((14-k.zoom)/5,0,1)):.07;return{u_matrix:vy(c,n,o,u),u_pixels_to_tile_units:w,u_device_pixel_ratio:d,u_width_scale:y,u_floor_width_scale:E,u_units_to_pixels:[1/k.pixelsToGLUnits[0],1/k.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:_,u_texsize:u2(o)&&n.lineAtlasTexture?n.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:p_(n,c.transform),u_alpha_discard_threshold:0,u_trim_offset:M,u_trim_fade_range:o.paint.get("line-trim-fade-range"),u_trim_color:o.paint.get("line-trim-color").toRenderColor(I?null:o.lut).toArray01(),u_emissive_strength:o.paint.get("line-emissive-strength"),u_zbias_factor:D,u_tile_to_meter:r(n.tileID.canonical,0)}},i.d1=Yu,i.d2=Jf,i.d3=od,i.d4=on,i.d5=h_,i.d6=Za,i.d7=450,i.d8=7,i.d9=_j,i.dA=Ss,i.dB=p,i.dC=kc,i.dD=function([c,n,o]){const u=Math.hypot(c,n,o),_=Math.atan2(c,o),d=.5*Math.PI-Math.acos(-n/u);return new pr(si(_),si(d))},i.dE=mS,i.dF=function(c){const n=c.navigator?c.navigator.userAgent:null;return!!function(o){if(gl==null){const u=o.navigator?o.navigator.userAgent:null;gl=!!o.safari||!(!u||!(/\b(iPad|iPhone|iPod)\b/.test(u)||u.match("Safari")&&!u.match("Chrome")))}return gl}(c)&&n&&(n.match("Version/15.4")||n.match("Version/15.5")||n.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},i.dG=function(c,n){Ye=c,ct=n},i.dH=Sa,i.dI=Go,i.dJ=function(c){const n=[0,0,0],o=Ne.mat4.identity(new Float64Array(16));return Ne.mat4.multiply(o,c.pixelMatrix,c.globeMatrix),Ne.vec3.transformMat4(n,n,o),new It(n[0],n[1])},i.dK=function(c,n,o=!1){if(co===Df||co===Di||co===Lf)throw new Error("setRTLTextPlugin cannot be called multiple times.");zl=ze.resolveURL(c),co=Df,hs=n,zf(),o||Da()},i.dL=Sh,i.dM=function(){L2().acquire(bS)},i.dN=function(){const c=By;c&&(c.isPreloaded()&&c.numActive()===1?(c.release(bS),By=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},i.dO=Km,i.dP=function(c){const n=Zt();if(!n)return;const o=n.delete(it);c&&o.catch(c).then(()=>c())},i.dQ=ky,i.dR=yI,i.dS=function(c){RS=ze.resolveURL(c),P_||(P_=new A_(L2(),new bl)),P_.broadcast("setDracoUrl",RS)},i.dT=vI,i.dU=function(c){I_=ze.resolveURL(c),P_||(P_=new A_(L2(),new bl)),P_.broadcast("setMeshoptUrl",I_)},i.dV=hn,i.dW=Du,i.dX=ku,i.dY=rd,i.dZ=class{constructor(c,n){this.pos=c,this.dir=n}intersectsPlane(c,n,o){const u=Ne.vec2.dot(n,this.dir);if(Math.abs(u)<1e-6)return!1;const _=((c[0]-this.pos[0])*n[0]+(c[1]-this.pos[1])*n[1])/u;return o[0]=this.pos[0]+this.dir[0]*_,o[1]=this.pos[1]+this.dir[1]*_,!0}},i.d_=MI,i.da=br,i.db=fp,i.dc=256,i.dd=Or,i.de=tl,i.df=uo,i.dg=nl,i.dh=function(c,n,o,u,_){return Bn((c-n)/(o-n)*(_-u)+u,u,_)},i.di=vc,i.dj=Ru,i.dk=class{constructor(c,n,o,u){this.context=c,this.format=u,this.size=o,this.texture=c.gl.createTexture();const[_,d,y]=this.size,{gl:E}=c;E.bindTexture(E.TEXTURE_3D,this.texture),c.pixelStoreUnpackFlipY.set(!1),c.pixelStoreUnpack.set(1),c.pixelStoreUnpackPremultiplyAlpha.set(!1),E.texImage3D(E.TEXTURE_3D,0,this.format,_,d,y,0,hS(this.format),fS(this.format),n.data)}bind(c,n){const{context:o}=this,{gl:u}=o;u.bindTexture(u.TEXTURE_3D,this.texture),c!==this.minFilter&&(u.texParameteri(u.TEXTURE_3D,u.TEXTURE_MAG_FILTER,c),u.texParameteri(u.TEXTURE_3D,u.TEXTURE_MIN_FILTER,c),this.minFilter=c),n!==this.wrapS&&(u.texParameteri(u.TEXTURE_3D,u.TEXTURE_WRAP_S,n),u.texParameteri(u.TEXTURE_3D,u.TEXTURE_WRAP_T,n),this.wrapS=n)}destroy(){const{gl:c}=this.context;c.deleteTexture(this.texture),this.texture=null}},i.dl=_S,i.dm=[1,1,1],i.dn=E_,i.dp=T_,i.dq=Pc,i.dr=Eu,i.ds=Fs,i.dt=Oh,i.du=ms,i.dv=class{constructor(){this._updateTime=0,this._sourceIds=[],this._activeRegions=[],this._prevRegions=[],this._globalClipBounds={min:new It(1/0,1/0),max:new It(-1/0,-1/0)}}clear(){this._activeRegions.length>0&&++this._updateTime,this._activeRegions=[],this._prevRegions=[]}get updateTime(){return this._updateTime}getReplacementRegionsForTile(c,n=!1){const o=c_(new It(0,0),new It(Kt,Kt),c),u=[];if(n&&!l_(o,this._globalClipBounds))return u;for(const _ of this._activeRegions){if(_.hiddenByOverlap||!l_(o,_))continue;const d=Vw(_.min,_.max,c);u.push({min:d.min,max:d.max,sourceId:this._sourceIds[_.priority],footprint:_.footprint,footprintTileId:_.tileId,order:_.order,clipMask:_.clipMask,clipScope:_.clipScope})}return u}setSources(c){this._setSources(c.map(n=>({getSourceId:()=>n.cache.id,getFootprints:()=>{const o=[];for(const u of n.cache.getVisibleCoordinates()){const _=n.cache.getTile(u).buckets[n.layer];_&&_.updateFootprints(u.toUnwrapped(),o)}return o},getOrder:()=>n.order,getClipMask:()=>n.clipMask,getClipScope:()=>n.clipScope})))}_addSource(c){const n=c.getFootprints();if(n.length===0)return;const o=c.getOrder(),u=c.getClipMask(),_=c.getClipScope();for(const d of n){if(!d.footprint)continue;const y=c_(d.footprint.min,d.footprint.max,d.id);this._activeRegions.push({min:y.min,max:y.max,hiddenByOverlap:!1,priority:this._sourceIds.length,tileId:d.id,footprint:d.footprint,order:o,clipMask:u,clipScope:_})}this._sourceIds.push(c.getSourceId())}_computeReplacement(){this._activeRegions.sort((n,o)=>n.priority-o.priority||id(n.min,o.min)||id(n.max,o.max)||n.order-o.order||n.clipMask-o.clipMask||function(u,_){const d=(y,E)=>y+E;return u.length-_.length||u.reduce(d,"").localeCompare(_.reduce(d,""))}(n.clipScope,o.clipScope));let c=this._activeRegions.length!==this._prevRegions.length;if(!c){let n=0;for(;!c&&n!==this._activeRegions.length;){const o=this._activeRegions[n],u=this._prevRegions[n];c=o.priority!==u.priority||!iy(o,u)||o.order!==u.order||o.clipMask!==u.clipMask||!Ir(o.clipScope,u.clipScope),++n}}if(c){++this._updateTime;for(const o of this._activeRegions)o.order!==Ep&&(this._globalClipBounds.min.x=Math.min(this._globalClipBounds.min.x,o.min.x),this._globalClipBounds.min.y=Math.min(this._globalClipBounds.min.y,o.min.y),this._globalClipBounds.max.x=Math.max(this._globalClipBounds.max.x,o.max.x),this._globalClipBounds.max.y=Math.max(this._globalClipBounds.max.y,o.max.y));const n=o=>{const u=this._activeRegions;if(o>=u.length)return o;const _=u[o].priority;for(;o<u.length&&u[o].priority===_;)++o;return o};if(this._sourceIds.length>1){let o=0,u=n(o);for(;o!==u;){let _=o;const d=o;for(;_!==u;){const y=this._activeRegions[_];y.hiddenByOverlap=!1;for(let E=0;E<d;E++){const M=this._activeRegions[E];if(!M.hiddenByOverlap&&y.order===Ep&&l_(y,M)&&(y.hiddenByOverlap=Q1(y.footprint,y.tileId,M.footprint,M.tileId),y.hiddenByOverlap))break}++_}o=u,u=n(o)}}}}_setSources(c){[this._prevRegions,this._activeRegions]=[this._activeRegions,[]],this._sourceIds=[];for(let n=c.length-1;n>=0;n--)this._addSource(c[n]);this._computeReplacement()}},i.dw=class{constructor(c){this._createGrid(c),this._createPoles(c)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const c of this._poleSegments)c.destroy();for(const c of this._gridSegments)c.withSkirts.destroy(),c.withoutSkirts.destroy()}_fillGridMeshWithLods(c,n){const o=new el,u=new ia,_=[],d=c+1+2,y=n[0]+1,E=n[0]+1+(1+n.length),M=(k,w,I)=>{let D=k===d-1?k-2:k===0?k:k-1;return D+=I?24575:0,[D,w]};for(let k=0;k<d;++k)o.emplaceBack(...M(k,0,!0));for(let k=0;k<y;++k)for(let w=0;w<d;++w)o.emplaceBack(...M(w,k,(w===0||w===d-1)&&!0));for(let k=0;k<n.length;++k){const w=n[k];for(let I=0;I<d;++I)o.emplaceBack(...M(I,w,!0))}for(let k=0;k<n.length;++k){const w=u.length,I=n[k]+1+2,D=new ia;for(let B=0;B<I-1;B++){const q=B===I-2,H=q?d*(E-n.length+k-B):d;for(let te=0;te<d-1;te++){const re=B*d+te;B===0||q||te===0||te===d-2?(D.emplaceBack(re+1,re,re+H),D.emplaceBack(re+H,re+H+1,re+1)):(u.emplaceBack(re+1,re,re+H),u.emplaceBack(re+H,re+H+1,re+1))}}const C=ci.simpleSegment(0,w,o.length,u.length-w);for(let B=0;B<D.uint16.length;B+=3)u.emplaceBack(D.uint16[B],D.uint16[B+1],D.uint16[B+2]);const P=ci.simpleSegment(0,w,o.length,u.length-w);_.push({withoutSkirts:C,withSkirts:P})}return{vertices:o,indices:u,segments:_}}_createGrid(c){const n=this._fillGridMeshWithLods(zc,zh);this._gridSegments=n.segments,this._gridBuffer=c.createVertexBuffer(n.vertices,bn.members),this._gridIndexBuffer=c.createIndexBuffer(n.indices,!0)}_createPoles(c){const n=new ia;for(let y=0;y<=zc;y++)n.emplaceBack(0,y+1,y+2);this._poleIndexBuffer=c.createIndexBuffer(n,!0);const o=new uo,u=new uo,_=new uo,d=new uo;this._poleSegments=[];for(let y=0,E=0;y<$o;y++){const M=360/(1<<y);o.emplaceBack(0,-La,0,.5,0),u.emplaceBack(0,-La,0,.5,1),_.emplaceBack(0,-La,0,.5,.5),d.emplaceBack(0,-La,0,.5,.5);for(let k=0;k<=zc;k++){let w=k/zc,I=0;const D=Mn(0,M,w),[C,P,B]=Iu(Ho,Oo,D,La);o.emplaceBack(C,P,B,w,I),u.emplaceBack(C,P,B,w,1-I);const q=$n(D);w=.5+.5*Math.sin(q),I=.5+.5*Math.cos(q),_.emplaceBack(C,P,B,w,I),d.emplaceBack(C,P,B,w,1-I)}this._poleSegments.push(ci.simpleSegment(E,0,66,64)),E+=66}this._poleNorthVertexBuffer=c.createVertexBuffer(o,En,!1),this._poleSouthVertexBuffer=c.createVertexBuffer(u,En,!1),this._texturedPoleNorthVertexBuffer=c.createVertexBuffer(_,En,!1),this._texturedPoleSouthVertexBuffer=c.createVertexBuffer(d,En,!1)}getGridBuffers(c,n){return[this._gridBuffer,this._gridIndexBuffer,n?this._gridSegments[c].withSkirts:this._gridSegments[c].withoutSkirts]}getPoleBuffers(c,n){return[n?this._texturedPoleNorthVertexBuffer:this._poleNorthVertexBuffer,n?this._texturedPoleSouthVertexBuffer:this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[c]]}},i.dx=Ep,i.dy=ao,i.dz=function(){return!!document.fullscreenElement||!!document.webkitFullscreenElement},i.e=vi,i.e0=$m,i.e1=Ca,i.e2=Ms,i.e3=H4,i.e4=function(c,n,o,u,_,d,y,E,M,k,w=1,I,D){c.createArrays(),c.tilePixelRatio=Kt/(512*c.overscaling),c.compareText={},c.iconsNeedLinear=!1;const C=c.layers[0].layout,P=c.layers[0]._unevaluatedLayout._values,B={};B.scaleFactor=w,B.textSizeScaleRange=C.get("text-size-scale-range"),B.iconSizeScaleRange=C.get("icon-size-scale-range");const[q,H]=B.textSizeScaleRange,[te,re]=B.iconSizeScaleRange;if(B.textScaleFactor=Bn(B.scaleFactor,q,H),B.iconScaleFactor=Bn(B.scaleFactor,te,re),c.textSizeData.kind==="composite"){const{minZoom:me,maxZoom:Ce}=c.textSizeData;B.compositeTextSizes=[P["text-size"].possiblyEvaluate(new kr(me),E),P["text-size"].possiblyEvaluate(new kr(Ce),E)]}if(c.iconSizeData.kind==="composite"){const{minZoom:me,maxZoom:Ce}=c.iconSizeData;B.compositeIconSizes=[P["icon-size"].possiblyEvaluate(new kr(me),E),P["icon-size"].possiblyEvaluate(new kr(Ce),E)]}B.layoutTextSize=P["text-size"].possiblyEvaluate(new kr(M+1),E),B.layoutIconSize=P["icon-size"].possiblyEvaluate(new kr(M+1),E),B.textMaxSize=P["text-size"].possiblyEvaluate(new kr(18),E);const J=C.get("text-rotation-alignment")==="map"&&C.get("symbol-placement")!=="point",ie=C.get("text-size");let ce=!1;for(const me of c.features)if(me.icon&&me.icon.nameSecondary){ce=!0;break}for(const me of c.features){const Ce=C.get("text-font").evaluate(me,{},E).join(","),Ae=ie.evaluate(me,{},E)*B.textScaleFactor,Ee=B.layoutTextSize.evaluate(me,{},E)*B.textScaleFactor,Ue=(B.layoutIconSize.evaluate(me,{},E),{horizontal:{},vertical:void 0}),Ie=me.text;let Ve,Ze=[0,0];if(Ie){const Qe=Ie.toString(),at=C.get("text-letter-spacing").evaluate(me,{},E)*Ba,Je=C.get("text-line-height").evaluate(me,{},E)*Ba,wt=ra(Qe)?at:0,Rt=C.get("text-anchor").evaluate(me,{},E),bt=C.get("text-variable-anchor");if(!bt){const vn=C.get("text-radial-offset").evaluate(me,{},E);Ze=vn?J4(Rt,[vn*Ba,rS]):C.get("text-offset").evaluate(me,{},E).map(ln=>ln*Ba)}let an=J?"center":C.get("text-justify").evaluate(me,{},E);const Jt=C.get("symbol-placement")==="point",Ut=Jt?C.get("text-max-width").evaluate(me,{},E)*Ba:1/0,zt=vn=>{c.allowVerticalPlacement&&ti(Qe)&&(Ue.vertical=en(Ie,n,o,_,Ce,Ut,Je,Rt,vn,wt,Ze,Be.vertical,!0,Ee,Ae))};if(!J&&bt){const vn=an==="auto"?bt.map(pn=>iS(pn)):[an];let ln=!1;for(let pn=0;pn<vn.length;pn++){const kn=vn[pn];if(!Ue.horizontal[kn])if(ln)Ue.horizontal[kn]=Ue.horizontal[0];else{const Gn=en(Ie,n,o,_,Ce,Ut,Je,"center",kn,wt,Ze,Be.horizontal,!1,Ee,Ae);Gn&&(Ue.horizontal[kn]=Gn,ln=Gn.positionedLines.length===1)}}zt("left")}else{if(an==="auto"&&(an=iS(Rt)),Jt||C.get("text-writing-mode").indexOf("horizontal")>=0||!ti(Qe)){const vn=en(Ie,n,o,_,Ce,Ut,Je,Rt,an,wt,Ze,Be.horizontal,!1,Ee,Ae);vn&&(Ue.horizontal[an]=vn)}zt(Jt?"left":an)}}let qe=!1;if(me.icon&&me.icon.namePrimary){const Qe=Sy(c.iconSizeData,P["icon-size"],E,c.zoom,me)*B.iconScaleFactor*I,at=me.icon.getPrimary().scaleSelf(Qe).serialize(),Je=u[at];Je&&(Ve=un(_[at],me.icon.nameSecondary?_[me.icon.getSecondary().scaleSelf(Qe).serialize()]:void 0,C.get("icon-offset").evaluate(me,{},E),C.get("icon-anchor").evaluate(me,{},E)),qe=Je.sdf,c.sdfIcons===void 0?c.sdfIcons=Je.sdf:c.sdfIcons!==Je.sdf&&qn("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Je.pixelRatio!==c.pixelRatio||C.get("icon-rotate").constantOr(1)!==0)&&(c.iconsNeedLinear=!0))}const Ke=eO(Ue.horizontal)||Ue.vertical;c.iconsInText||(c.iconsInText=!!Ke&&Ke.iconsInText),(Ke||Ve)&&rj(c,me,Ue,Ve,u,B,Ee,0,Ze,qe,y,E,k,D,ce)}d&&c.generateCollisionDebugBuffers(M,c.collisionBoxArray,B.textScaleFactor)},i.e5=j2,i.e6=Dr,i.e7=ry,i.e8=h,i.e9=O,i.ea=function(c){let n=0;if(new Uint32Array(c,0,1)[0]!==bI){const o=new Uint32Array(c,0,7),[,,u,_,d,y]=o;n=o.byteLength+_+d+y+d,(u!==c.byteLength||n>=c.byteLength)&&qn("Invalid b3dm header information.")}return EI(c,n)},i.eb=function(c,n){const o=CI(c);for(const u of o){for(const _ of u.meshes)RU(_);u.lights&&(u.lightMeshIndex=u.meshes.length,u.meshes.push(DU(u.lights,n)))}return o},i.ec=D2,i.ed=UO,i.ee=Yr,i.ef=function(c){Xt(),ut!=null&&ut.then(n=>{n.keys().then(o=>{for(let u=0;u<o.length-c;u++)n.delete(o[u])})})},i.f=function(c){return c.indexOf("mapbox:")===0},i.g=function(c,n){return Ai(ua(c,{method:"GET"}),n)},i.h=cf,i.i=function(c){return vi.API_STYLE_REGEX.test(c)&&!uf(c)},i.j=function(c){return decodeURIComponent(atob(c).split("").map(n=>"%"+("00"+n.charCodeAt(0).toString(16)).slice(-2)).join(""))},i.k=function(c){return btoa(encodeURIComponent(c).replace(/%([0-9A-F]{2})/g,(n,o)=>String.fromCharCode(+("0x"+o))))},i.l=ua,i.m=Cn,i.n=function(c,n){return Ai(ua(c,{type:"json"}),n)},i.o=Bd,i.p=function(c,n){return Ai(ua(c,{method:"POST"}),n)},i.q=ze,i.r=Ta,i.s=function(c){try{const n=self[c];return n.setItem("_mapbox_test_",1),n.removeItem("_mapbox_test_"),!0}catch{return!1}},i.t=we,i.u=function(){return function c(n){return n?(n^Math.random()*(16>>n/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,c)}()},i.v=function(c){return!!c&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(c)},i.w=qn,i.x=function(){return wS||(wS=new Km),wS},i.y=vl,i.z=As}),v(["./shared"],function(i){function O(dt){const le=dt?dt.url.toString():void 0;return le?performance.getEntriesByName(le):[]}function z(dt){if(typeof dt=="number"||typeof dt=="boolean"||typeof dt=="string"||dt==null)return JSON.stringify(dt);if(Array.isArray(dt)){let pe="[";for(const we of dt)pe+=`${z(we)},`;return`${pe}]`}let le="{";for(const pe of Object.keys(dt).sort())le+=`${pe}:${z(dt[pe])},`;return`${le}}`}function j(dt){let le="";for(const pe of i.bm)(dt.type!=="model"||pe!=="minzoom"&&pe!=="maxzoom")&&(le+=`/${z(dt[pe])}`);return le}class F{constructor(le){this.keyCache={},this._layers={},this._layerConfigs={},le&&this.replace(le)}replace(le,pe){this._layerConfigs={},this._layers={},this.update(le,[],pe)}update(le,pe,we){this._options=we;for(const je of le)this._layerConfigs[je.id]=je,(this._layers[je.id]=i.cu(je,this.scope,null,this._options)).compileFilter(we),this.keyCache[je.id]&&delete this.keyCache[je.id];for(const je of pe)delete this.keyCache[je],delete this._layerConfigs[je],delete this._layers[je];this.familiesBySource={};const ze=function(je,We){const it={};for(let ct=0;ct<je.length;ct++){const lt=je[ct];let ut=We&&We[lt.id];!ut&&(ut=j(lt),lt.type==="line"&&lt.paint)&&function Zt(Xt){return typeof Xt=="string"&&Xt==="line-progress"||(Array.isArray(Xt)?Xt.some(Zt):!(!Xt||typeof Xt!="object")&&Object.values(Xt).some(Zt))}(lt.paint["line-width"])&&(ut+=`/${z(lt.paint["line-width"])}`),We&&(We[lt.id]=ut);let Ct=it[ut];Ct||(Ct=it[ut]=[]),Ct.push(lt)}const Ye=[];for(const ct in it)Ye.push(it[ct]);return Ye}(i.bj(this._layerConfigs),this.keyCache);for(const je of ze){const We=je.map(Ct=>this._layers[Ct.id]),it=We[0];if(it.visibility==="none")continue;const Ye=it.source||"";let ct=this.familiesBySource[Ye];ct||(ct=this.familiesBySource[Ye]={});const lt=it.sourceLayer||"_geojsonTileLayer";let ut=ct[lt];ut||(ut=ct[lt]=[]),ut.push(We)}}}const G=1*i.dX;class Y{constructor(le){const pe={},we=[];for(const it in le){const Ye=le[it],ct=pe[it]={};for(const lt in Ye.glyphs){const ut=Ye.glyphs[+lt];if(!ut||ut.bitmap.width===0||ut.bitmap.height===0)continue;const Ct=ut.metrics.localGlyph?G:1,Zt={x:0,y:0,w:ut.bitmap.width+2*Ct,h:ut.bitmap.height+2*Ct};we.push(Zt),ct[lt]=Zt}}const{w:ze,h:je}=i.F(we),We=new i.dW({width:ze||1,height:je||1});for(const it in le){const Ye=le[it];for(const ct in Ye.glyphs){const lt=Ye.glyphs[+ct];if(!lt||lt.bitmap.width===0||lt.bitmap.height===0)continue;const ut=pe[it][ct],Ct=lt.metrics.localGlyph?G:1;i.dW.copy(lt.bitmap,We,{x:0,y:0},{x:ut.x+Ct,y:ut.y+Ct},lt.bitmap)}}this.image=We,this.positions=pe}}i.dV(Y,"GlyphAtlas");const X="3d_elevation_id",K="hd_road_elevation";class ne{constructor(){this._valid=!1}reset(le){return this.feature=le,this._valid=!0,this._geometry=le.loadGeometry(),this._geometry.length!==0&&this._geometry[0].length!==0||(this._valid=!1),this}geometry(le,pe){return this._valid&&le(pe(this._geometry)),this}require(le,pe,we){return this.get(le,!0,pe,we)}optional(le,pe,we){return this.get(le,!1,pe,we)}success(){return this._valid}get(le,pe,we,ze){const je=this.feature.properties.hasOwnProperty(le)?+this.feature.properties[le]:void 0;return this._valid&&je!==void 0?we(ze?ze(je):je):pe&&(this._valid=!1),this}}class se{constructor(le,pe){this.featureFunc=le,this.vertexFunc=pe}parseFeature(le,pe,we){return this.featureFunc(le,pe,we)}parseVertex(le,pe,we){return this.vertexFunc(le,pe,we)}}const ge=new se((dt,le,pe)=>dt.reset(le).require(X,we=>{pe.id=we}).optional("fixed_height_relative",we=>{pe.constantHeight=we},xe.decodeRelativeHeight).geometry(we=>{pe.bounds=we},xe.computeBounds).success(),(dt,le,pe)=>dt.reset(le).require(X,we=>{pe.id=we}).require("elevation_idx",we=>{pe.idx=we}).require("extent",we=>{pe.extent=we}).require("height_relative",we=>{pe.height=we},xe.decodeRelativeHeight).geometry(we=>{pe.position=we},xe.getPoint).success()),_e=new se((dt,le,pe)=>dt.reset(le).require(X,we=>{pe.id=we}).optional("fixed_height",we=>{pe.constantHeight=we},xe.decodeMetricHeight).geometry(we=>{pe.bounds=we},xe.computeBounds).success(),(dt,le,pe)=>dt.reset(le).require(X,we=>{pe.id=we}).require("elevation_idx",we=>{pe.idx=we}).require("extent",we=>{pe.extent=we}).require("height",we=>{pe.height=we},xe.decodeMetricHeight).geometry(we=>{pe.position=we},xe.getPoint).success());class xe{static computeBounds(le){const pe=new i.P(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),we=new i.P(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY);for(const ze of le[0])pe.x>ze.x&&(pe.x=ze.x),pe.y>ze.y&&(pe.y=ze.y),we.x<ze.x&&(we.x=ze.x),we.y<ze.y&&(we.y=ze.y);return{min:pe,max:we}}static getPoint(le){return i.ab.vec2.fromValues(le[0][0].x,le[0][0].y)}static decodeRelativeHeight(le){return 1e-4*le*5}static decodeMetricHeight(le){return 1e-4*le}static parse(le){const pe=[],we=[],ze=le.length,je=new ne;for(let it=0;it<ze;it++){const Ye=le.feature(it),ct=Ye.properties.hasOwnProperty("version")?String(Ye.properties.version):void 0,lt=(We=ct)?We==="1.0.1"?_e:void 0:ge;if(lt===void 0){i.w(`Unknown elevation feature version number ${ct||"(unknown)"}`);continue}const ut=Ye.properties.hasOwnProperty("type")?Ye.properties.type:void 0;if(ut){if(i.dY.VectorTileFeature.types[Ye.type]==="Point"&&ut==="curve_point"){const Ct={};lt.parseVertex(je,Ye,Ct)&&pe.push(Ct)}else if(i.dY.VectorTileFeature.types[Ye.type]==="Polygon"&&ut==="curve_meta"){const Ct={};lt.parseFeature(je,Ye,Ct)&&we.push(Ct)}}}var We;return{vertices:pe,features:we}}}class ae{constructor(le,pe,we,ze,je,We){if(this.vertices=new Array,this.vertexProps=new Array,this.edges=new Array,this.edgeProps=new Array,this.id=le,this.heightRange={min:we,max:we},this.safeArea=pe,this.constantHeight=we,this.constantHeight==null&&(this.constantHeight!=null||ze.length!==0)){this.vertices=ze,this.edges=je,this.edges=this.edges.filter(it=>it.a<this.vertices.length&&it.b<this.vertices.length&&!i.ab.vec2.exactEquals(this.vertices[it.a].position,this.vertices[it.b].position)),this.heightRange={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};for(const it of this.vertices)this.vertexProps.push({dir:i.ab.vec2.fromValues(0,0)}),this.heightRange.min=Math.min(this.heightRange.min,it.height),this.heightRange.max=Math.max(this.heightRange.max,it.height);for(const it of this.edges){const Ye=this.vertices[it.a].position,ct=this.vertices[it.b].position,lt=i.ab.vec2.subtract(i.ab.vec2.create(),ct,Ye),ut=i.ab.vec2.length(lt),Ct=i.ab.vec2.scale(i.ab.vec2.create(),lt,1/ut);this.edgeProps.push({vec:lt,dir:Ct,len:ut});const Zt=this.vertexProps[it.a].dir,Xt=this.vertexProps[it.b].dir;i.ab.vec2.add(Zt,Zt,Ct),i.ab.vec2.add(Xt,Xt,Ct)}for(const it of this.vertexProps)it.dir[0]===0&&it.dir[1]===0||i.ab.vec2.normalize(it.dir,it.dir);this.tessellate(We)}}pointElevation(le){if(this.constantHeight!=null)return this.constantHeight;const pe=this.getClosestEdge(le);if(pe==null)return 0;const[we,ze]=pe;return(1-(je=ze))*this.vertices[this.edges[we].a].height+je*this.vertices[this.edges[we].b].height;var je}getClosestEdge(le){if(this.edges.length===0)return;let pe=0,we=Number.POSITIVE_INFINITY,ze=0;const je=i.ab.vec2.fromValues(le.x,le.y);for(let We=0;We<this.edges.length;We++){const it=this.edges[We],Ye=this.edgeProps[We].dir,ct=new i.dZ(je,this.edgeProps[We].dir),lt=this.vertices[it.a].position,ut=this.vertices[it.b].position,Ct=i.ab.vec2.create(),Zt=i.ab.vec2.create(),Xt=ct.intersectsPlane(lt,this.vertexProps[it.a].dir,Ct),gn=ct.intersectsPlane(ut,this.vertexProps[it.b].dir,Zt);if(!Xt||!gn)continue;const Cn=i.ab.vec2.subtract(i.ab.vec2.create(),Zt,Ct),On=i.ab.vec2.subtract(i.ab.vec2.create(),je,Ct),wn=i.ab.vec2.dot(Cn,Cn),er=wn>0?i.ab.vec2.dot(On,Cn)/wn:0,tr=i.aw(er,0,1),Yn=Math.abs((er-tr)*this.edgeProps[We].len),dr=i.ab.vec2.subtract(i.ab.vec2.create(),je,lt),vr=Yn+Math.abs(i.ab.vec2.dot(dr,i.ab.vec2.fromValues(Ye[1],-Ye[0])));vr<we&&(pe=We,we=vr,ze=tr)}return[pe,ze]}tessellate(le){for(let pe=this.edges.length-1;pe>=0;--pe){const we=this.edges[pe].a,ze=this.edges[pe].b,{position:je,height:We,extent:it}=this.vertices[we],{position:Ye,height:ct,extent:lt}=this.vertices[ze],ut=this.vertexProps[we].dir,Ct=this.vertexProps[ze].dir,Zt=i.ab.vec3.fromValues(je[0]/le,je[1]/le,We),Xt=i.ab.vec3.fromValues(Ye[0]/le,Ye[1]/le,ct),gn=i.ab.vec3.fromValues(ut[1],-ut[0],0);i.ab.vec3.scale(gn,gn,it);const Cn=i.ab.vec3.fromValues(Ct[1],-Ct[0],0);if(i.ab.vec3.scale(Cn,Cn,lt),this.distSqLines(i.ab.vec3.fromValues(Zt[0]+.5*gn[0],Zt[1]+.5*gn[1],Zt[2]+.5*gn[2]),i.ab.vec3.fromValues(Xt[0]-.5*Cn[0],Xt[1]-.5*Cn[1],Xt[2]-.5*Cn[2]),i.ab.vec3.fromValues(Zt[0]-.5*gn[0],Zt[1]-.5*gn[1],Zt[2]-.5*gn[2]),i.ab.vec3.fromValues(Xt[0]+.5*Cn[0],Xt[1]+.5*Cn[1],Xt[2]+.5*Cn[2]))<=.05*.05)continue;const On=this.vertices.length,wn=i.ab.vec2.add(i.ab.vec2.create(),je,Ye);this.vertices.push({position:i.ab.vec2.scale(wn,wn,.5),height:.5*(We+ct),extent:.5*(it+lt)});const er=i.ab.vec2.add(i.ab.vec2.create(),ut,Ct);this.vertexProps.push({dir:i.ab.vec2.normalize(er,er)}),this.edges.splice(pe,1),this.edgeProps.splice(pe,1),this.edges.push({a:we,b:On}),this.edges.push({a:On,b:ze});const tr=i.ab.vec2.subtract(i.ab.vec2.create(),this.vertices[On].position,je),Yn=i.ab.vec2.length(tr),dr={vec:tr,dir:i.ab.vec2.scale(i.ab.vec2.create(),tr,1/Yn),len:Yn};this.edgeProps.push(dr),this.edgeProps.push(dr)}}distSqLines(le,pe,we,ze){const je=i.ab.vec3.subtract(i.ab.vec3.create(),pe,le),We=i.ab.vec3.subtract(i.ab.vec3.create(),ze,we),it=i.ab.vec3.subtract(i.ab.vec3.create(),le,we),Ye=i.ab.vec3.dot(je,je),ct=i.ab.vec3.dot(je,We),lt=i.ab.vec3.dot(je,it),ut=i.ab.vec3.dot(We,We),Ct=i.ab.vec3.dot(We,it),Zt=Ye*ut-ct*ct;if(Zt===0){const wn=i.ab.vec3.dot(it,We)/i.ab.vec3.dot(We,We),er=i.ab.vec3.lerp(i.ab.vec3.create(),we,ze,wn);return i.ab.vec3.squaredDistance(er,le)}const Xt=(ct*Ct-lt*ut)/Zt,gn=(Ye*Ct-ct*lt)/Zt,Cn=i.ab.vec3.lerp(i.ab.vec3.create(),le,pe,Xt),On=i.ab.vec3.lerp(i.ab.vec3.create(),we,ze,gn);return i.ab.vec3.squaredDistance(Cn,On)}}class ve{static parseFrom(le,pe){const we=xe.parse(le);if(!we)return[];let{vertices:ze,features:je}=we;const We=1/i.cc(pe);je.sort((lt,ut)=>lt.id-ut.id),ze.sort((lt,ut)=>lt.id-ut.id||lt.idx-ut.idx),ze=ze.filter((lt,ut,Ct)=>ut===Ct.findIndex(Zt=>Zt.id===lt.id&&Zt.idx===lt.idx));const it=new Array;let Ye=0;const ct=ze.length;for(const lt of je){if(lt.constantHeight){it.push(new ae(lt.id,lt.bounds,lt.constantHeight));continue}for(;Ye!==ct&&ze[Ye].id<lt.id;)Ye++;if(Ye===ct||ze[Ye].id!==lt.id)continue;const ut=new Array,Ct=new Array,Zt=Ye;for(;Ye!==ct&&ze[Ye].id===lt.id;){const Xt=ze[Ye];if(ut.push({position:Xt.position,height:Xt.height,extent:Xt.extent}),Ye!==Zt&&ze[Ye-1].idx===Xt.idx-1){const gn=Ye-Zt;Ct.push({a:gn-1,b:gn})}Ye++}it.push(new ae(lt.id,lt.bounds,void 0,ut,Ct,We))}return it}}i.dV(ae,"ElevationFeature");class Se{constructor(le){this.tileID=new i.aG(le.tileID.overscaledZ,le.tileID.wrap,le.tileID.canonical.z,le.tileID.canonical.x,le.tileID.canonical.y),this.tileZoom=le.tileZoom,this.uid=le.uid,this.zoom=le.zoom,this.lut=le.lut,this.canonical=le.tileID.canonical,this.pixelRatio=le.pixelRatio,this.tileSize=le.tileSize,this.source=le.source,this.scope=le.scope,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=le.showCollisionBoxes,this.collectResourceTiming=!!le.request&&le.request.collectResourceTiming,this.promoteId=le.promoteId,this.isSymbolTile=le.isSymbolTile,this.tileTransform=i.aQ(le.tileID.canonical,le.projection),this.projection=le.projection,this.worldview=le.worldview,this.localizableLayerIds=le.localizableLayerIds,this.brightness=le.brightness,this.extraShadowCaster=!!le.extraShadowCaster,this.tessellationStep=le.tessellationStep,this.scaleFactor=le.scaleFactor}parse(le,pe,we,ze,je){this.status="parsing",this.data=le,this.collisionBoxArray=new i.aW;const We=new i.d_(Object.keys(le.layers).sort()),it=new i.d$(this.tileID,this.promoteId);it.bucketLayerIDs=[];const Ye={},ct=new i.e0(256,256),lt={featureIndex:it,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:ct,availableImages:we,brightness:this.brightness,scaleFactor:this.scaleFactor,elevationFeatures:void 0},ut=pe.familiesBySource[this.source];for(const wn in ut){const er=le.layers[wn];if(!er)continue;let tr=!1,Yn=!1,dr=!1;for(const Ai of ut[wn])Ai[0].type==="symbol"?tr=!0:Yn=!0,Ai[0].is3D()&&Ai[0].type!=="model"&&(dr=!0);if(this.extraShadowCaster&&!dr||this.isSymbolTile===!0&&!tr||this.isSymbolTile===!1&&!Yn)continue;er.version===1&&i.w(`Vector tile source "${this.source}" layer "${wn}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const vr=We.encode(wn),Ii=[];let zo=!1;for(let Ai=0,ii=0;Ai<er.length;Ai++){const di=er.feature(Ai),th=it.getId(di,wn);if(this.localizableLayerIds&&this.localizableLayerIds.has(wn)){const yl=di.properties?di.properties.worldview:null;if(this.worldview&&typeof yl=="string")if(yl==="all")di.properties.$localized=!0;else{if(!yl.split(",").includes(this.worldview))continue;di.properties.$localized=!0,di.properties.worldview=this.worldview}}!zo&&di.properties&&di.properties.hasOwnProperty(X)&&(zo=!0),Ii.push({feature:di,id:th,index:ii,sourceLayerIndex:vr}),ii++}zo&&le.layers.hasOwnProperty(K)&&(lt.elevationFeatures=ve.parseFrom(le.layers[K],this.canonical));for(const Ai of ut[wn]){const ii=Ai[0];(!this.extraShadowCaster||ii.is3D()&&ii.type!=="model")&&(this.isSymbolTile!==void 0&&ii.type==="symbol"!==this.isSymbolTile||ii.minzoom&&this.zoom<Math.floor(ii.minzoom)||ii.maxzoom&&this.zoom>=ii.maxzoom||ii.visibility!=="none"&&(He(Ai,this.zoom,lt.brightness,we),(Ye[ii.id]=ii.createBucket({index:it.bucketLayerIDs.length,layers:Ai,zoom:this.zoom,lut:this.lut,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:vr,sourceID:this.source,projection:this.projection.spec,tessellationStep:this.tessellationStep})).populate(Ii,lt,this.tileID.canonical,this.tileTransform),it.bucketLayerIDs.push(Ai.map(di=>i.aC(di.id,di.scope)))))}}let Ct,Zt,Xt,gn;ct.trim();const Cn={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},On=()=>{if(Ct)return this.status="done",je(Ct);if(this.extraShadowCaster)this.status="done",je(null,{buckets:i.bj(Ye).filter(wn=>!wn.isEmpty()),featureIndex:it,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:lt.brightness,glyphMap:null,iconMap:null,glyphPositions:null});else if(Zt&&Xt&&gn){const wn=new Y(Zt),er=new i.e3(Xt,gn,this.lut);for(const tr in Ye){const Yn=Ye[tr];Yn instanceof i.aX?(He(Yn.layers,this.zoom,lt.brightness,we),i.e4(Yn,Zt,wn.positions,Xt,er.iconPositions,this.showCollisionBoxes,we,this.tileID.canonical,this.tileZoom,this.projection,this.scaleFactor,this.pixelRatio,this.brightness)):Yn.hasPattern&&(Yn instanceof i.b1||Yn instanceof i.b2||Yn instanceof i.d5)&&(He(Yn.layers,this.zoom,lt.brightness,we),Yn.addFeatures(lt,this.tileID.canonical,er.patternPositions,we,this.tileTransform,this.brightness))}this.status="done",je(null,{buckets:i.bj(Ye).filter(tr=>!tr.isEmpty()),featureIndex:it,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:wn.image,lineAtlas:ct,imageAtlas:er,brightness:lt.brightness})}};if(!this.extraShadowCaster){const wn=i.e1(lt.glyphDependencies,Yn=>Object.keys(Yn).map(Number));Object.keys(wn).length?ze.send("getGlyphs",{uid:this.uid,stacks:wn,scope:this.scope},(Yn,dr)=>{Ct||(Ct=Yn,Zt=dr,On())},void 0,!1,Cn):Zt={};const er=Object.keys(lt.iconDependencies);er.length?ze.send("getImages",{icons:er,source:this.source,scope:this.scope,tileID:this.tileID,type:"icons"},(Yn,dr)=>{if(Ct)return;Ct=Yn;const vr={};Object.values(dr).some(Ii=>Ii.usvg)?this.rasterize(ze,vr,dr,lt.iconDependencies,()=>{Xt=vr,On()}):(this.fillImageMap(vr,lt.iconDependencies,dr),Xt=vr,On())},void 0,!1,Cn):Xt={};const tr=Object.keys(lt.patternDependencies);tr.length?ze.send("getImages",{icons:tr,source:this.source,scope:this.scope,tileID:this.tileID,type:"patterns"},(Yn,dr)=>{if(!Ct){Ct=Yn;const vr={};Object.values(dr).some(Ii=>Ii.usvg)?this.rasterize(ze,vr,dr,lt.patternDependencies,()=>{gn=vr,On()}):(this.fillImageMap(vr,lt.patternDependencies,dr),gn=vr,On())}},void 0,!1,Cn):gn={}}On()}fillImageMap(le,pe,we){for(const ze in we){const je=pe[ze]||[];for(const We of je)we[We.id].usvg||(le[We.serialize()]=we[We.id])}}getImageTaskQueue(le,pe,we){const ze={};for(const je in pe){const We=we[je]||[];for(const it of We){const Ye=it.serialize();pe[it.id].usvg?ze[Ye]||(ze[Ye]=it):le[Ye]=pe[it.id]}}return ze}rasterize(le,pe,we,ze,je){const We=this.getImageTaskQueue(pe,we,ze);this.rasterizeTask=le.send("rasterizeImages",{scope:this.scope,imageTasks:We},(it,Ye)=>{if(!it)for(const ct in Ye){const{id:lt}=i.e2.deserializeFromString(ct);pe[ct]=Object.assign({},we[lt],{data:Ye[ct]})}je()})}cancelRasterize(){this.rasterizeTask&&this.rasterizeTask.cancel()}}function He(dt,le,pe,we){const ze=new i.a8(le,{brightness:pe});for(const je of dt)je.recalculate(ze,we)}class Ge extends i.E{constructor(le,pe,we,ze,je,We){super(),this.actor=le,this.layerIndex=pe,this.availableImages=we,this.loadVectorData=je||i.aD,this.loading={},this.loaded={},this.deduped=new i.aB(le.scheduler),this.isSpriteLoaded=ze,this.scheduler=le.scheduler,this.brightness=We}loadTile(le,pe){const we=le.uid,ze=le&&le.request,je=ze&&ze.collectResourceTiming,We=this.loading[we]=new Se(le);We.abort=this.loadVectorData(le,(it,Ye)=>{const ct=!this.loading[we];if(delete this.loading[we],We.cancelRasterize(),ct||it||!Ye)return We.status="done",ct||(this.loaded[we]=We),pe(it);const lt=Ye.rawData,ut={};Ye.expires&&(ut.expires=Ye.expires),Ye.cacheControl&&(ut.cacheControl=Ye.cacheControl),We.vectorTile=Ye.vectorTile||new i.dY.VectorTile(new i.bh(lt));const Ct=()=>{We.parse(We.vectorTile,this.layerIndex,this.availableImages,this.actor,(Zt,Xt)=>{if(Zt||!Xt)return pe(Zt);const gn={};if(je){const Cn=O(ze);Cn.length>0&&(gn.resourceTiming=JSON.parse(JSON.stringify(Cn)))}pe(null,i.l({rawTileData:lt.slice(0)},Xt,ut,gn))})};this.isSpriteLoaded?Ct():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(Ct,{type:"parseTile",isSymbolTile:le.isSymbolTile,zoom:le.tileZoom}):Ct()}),this.loaded=this.loaded||{},this.loaded[we]=We})}reloadTile(le,pe){const we=this.loaded,ze=le.uid;if(we&&we[ze]){const je=we[ze];je.scaleFactor=le.scaleFactor,je.showCollisionBoxes=le.showCollisionBoxes,je.projection=le.projection,je.brightness=le.brightness,je.tileTransform=i.aQ(le.tileID.canonical,le.projection),je.extraShadowCaster=le.extraShadowCaster,je.lut=le.lut;const We=(it,Ye)=>{const ct=je.reloadCallback;ct&&(delete je.reloadCallback,je.parse(je.vectorTile,this.layerIndex,this.availableImages,this.actor,ct)),pe(it,Ye)};je.status==="parsing"?je.reloadCallback=We:je.status==="done"&&(je.vectorTile?je.parse(je.vectorTile,this.layerIndex,this.availableImages,this.actor,We):We())}else pe(null,void 0)}abortTile(le,pe){const we=le.uid,ze=this.loading[we];ze&&(ze.abort&&ze.abort(),delete this.loading[we]),pe()}removeTile(le,pe){const we=this.loaded,ze=le.uid;we&&we[ze]&&delete we[ze],pe()}}class ye{loadTile(le,pe){const{uid:we,encoding:ze,rawImageData:je,padding:We}=le,it=ImageBitmap&&je instanceof ImageBitmap?this.getImageData(je,We):je;pe(null,new i.e5(we,it,ze,We<1))}getImageData(le,pe){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(le.width,le.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=le.width,this.offscreenCanvas.height=le.height,this.offscreenCanvasContext.drawImage(le,0,0,le.width,le.height);const we=this.offscreenCanvasContext.getImageData(-pe,-pe,le.width+2*pe,le.height+2*pe);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),we}}i.bg.setPbf(i.bh);class Le{decodeRasterArray({task:le,buffer:pe},we){i.bg.performDecoding(pe,le).then(ze=>{we(null,ze)},ze=>{we(ze)})}}const ht=i.dY.VectorTileFeature.prototype.toGeoJSON;class gt{constructor(le){this._feature=le,this.extent=i.ag,this.type=le.type,this.properties=le.tags,"id"in le&&!isNaN(le.id)&&(this.id=parseInt(le.id,10))}loadGeometry(){if(this._feature.type===1){const le=[];for(const pe of this._feature.geometry)le.push([new i.P(pe[0],pe[1])]);return le}{const le=[];for(const pe of this._feature.geometry){const we=[];for(const ze of pe)we.push(new i.P(ze[0],ze[1]));le.push(we)}return le}}toGeoJSON(le,pe,we){return ht.call(this,le,pe,we)}}class Ft{constructor(le){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=i.ag,this.length=le.length,this._features=le}feature(le){return new gt(this._features[le])}}const _t=64/4096,yt=128;class Vt{constructor(){this.features=new Map}clear(){this.features.clear()}load(le=[],pe){for(const we of le){const ze=we.id;if(ze==null)continue;let je=this.features.get(ze);je&&this.updateCache(je,pe),we.geometry?(je=Bt(we),this.updateCache(je,pe),this.features.set(ze,je)):this.features.delete(ze),this.updateCache(je,pe)}}updateCache(le,pe){for(const{canonical:we,uid:ze}of Object.values(pe)){const{z:je,x:We,y:it}=we;Ht(le,Math.pow(2,je),We,it)&&delete pe[ze]}}getTile(le,pe,we){const ze=Math.pow(2,le),je=[];for(const We of this.features.values())Ht(We,ze,pe,we)&&je.push(Nt(We,ze,pe,we));return{features:je}}getFeatures(){return[...this.features.values()]}}function Ht({minX:dt,minY:le,maxX:pe,maxY:we},ze,je,We){return dt<(je+1+_t)/ze&&le<(We+1+_t)/ze&&pe>(je-_t)/ze&&we>(We-_t)/ze}function Bt(dt){const{id:le,geometry:pe,properties:we}=dt;if(!pe)return;if(pe.type==="GeometryCollection")throw new Error("GeometryCollection not supported in dynamic mode.");const{type:ze,coordinates:je}=pe,We={id:le,type:1,geometry:[],tags:we,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0},it=We.geometry;if(ze==="Point")et(je,it,We);else if(ze==="MultiPoint")for(const Ye of je)et(Ye,it,We);else if(ze==="LineString")We.type=2,$t(je,it,We);else if(ze==="MultiLineString")We.type=2,rn(je,it,We);else if(ze==="Polygon")We.type=3,rn(je,it,We,!0);else{if(ze!=="MultiPolygon")throw new Error("Input data is not a valid GeoJSON object.");We.type=3;for(const Ye of je)rn(Ye,it,We,!0)}return We}function et([dt,le],pe,we){const ze=i.at(dt);let je=i.aA(le);je=je<0?0:je>1?1:je,pe.push(ze,je),we.minX=Math.min(we.minX,ze),we.minY=Math.min(we.minY,je),we.maxX=Math.max(we.maxX,ze),we.maxY=Math.max(we.maxY,je)}function $t(dt,le,pe,we=!1,ze=!1){const je=[];for(const We of dt)et(We,je,pe);le.push(je),we&&function(We,it){let Ye=0;for(let ct=0,lt=We.length,ut=lt-2;ct<lt;ut=ct,ct+=2)Ye+=(We[ct]-We[ut])*(We[ct+1]+We[ut+1]);if(Ye>0===it)for(let ct=0,lt=We.length;ct<lt/2;ct+=2){const ut=We[ct],Ct=We[ct+1];We[ct]=We[lt-2-ct],We[ct+1]=We[lt-1-ct],We[lt-2-ct]=ut,We[lt-1-ct]=Ct}}(je,ze)}function rn(dt,le,pe,we=!1){for(let ze=0;ze<dt.length;ze++)$t(dt[ze],le,pe,we,ze===0)}function Nt(dt,le,pe,we){const{id:ze,type:je,geometry:We,tags:it}=dt,Ye=[];if(je===1)(function(ct,lt,ut,Ct,Zt){for(let Xt=0;Xt<ct.length;Xt+=2){const gn=Math.round(i.ag*(ct[Xt+0]*lt-ut)),Cn=Math.round(i.ag*(ct[Xt+1]*lt-Ct));Zt.push([gn,Cn])}})(We,le,pe,we,Ye);else for(const ct of We)xn(ct,le,pe,we,Ye);return{id:ze,type:je,geometry:Ye,tags:it}}function xn(dt,le,pe,we,ze){const We=i.ag+yt;let it;for(let Ye=0;Ye<dt.length-2;Ye+=2){let ct=Math.round(i.ag*(dt[Ye+0]*le-pe)),lt=Math.round(i.ag*(dt[Ye+1]*le-we)),ut=Math.round(i.ag*(dt[Ye+2]*le-pe)),Ct=Math.round(i.ag*(dt[Ye+3]*le-we));const Zt=ut-ct,Xt=Ct-lt;ct<-128&&ut<-128||(ct<-128?(lt+=Math.round(Xt*((-128-ct)/Zt)),ct=-128):ut<-128&&(Ct=lt+Math.round(Xt*((-128-ct)/Zt)),ut=-128),lt<-128&&Ct<-128||(lt<-128?(ct+=Math.round(Zt*((-128-lt)/Xt)),lt=-128):Ct<-128&&(ut=ct+Math.round(Zt*((-128-lt)/Xt)),Ct=-128),ct>=We&&ut>=We||(ct>=We?(lt+=Math.round(Xt*((We-ct)/Zt)),ct=We):ut>=We&&(Ct=lt+Math.round(Xt*((We-ct)/Zt)),ut=We),lt>=We&&Ct>=We||(lt>=We?(ct+=Math.round(Zt*((We-lt)/Xt)),lt=We):Ct>=We&&(ut=ct+Math.round(Zt*((We-lt)/Xt)),Ct=We),it&&ct===it[it.length-1][0]&&lt===it[it.length-1][1]||(it=[[ct,lt]],ze.push(it)),it.push([ut,Ct])))))}}var rr,Xn,yi,ir={exports:{}},yn=function(){if(yi)return ir.exports;yi=1;var dt=i.e8(),le=function(){if(Xn)return rr;Xn=1;var lt=i.e6(),ut=i.e7().VectorTileFeature;function Ct(Xt,gn){this.options=gn||{},this.features=Xt,this.length=Xt.length}function Zt(Xt,gn){this.id=typeof Xt.id=="number"?Xt.id:void 0,this.type=Xt.type,this.rawGeometry=Xt.type===1?[Xt.geometry]:Xt.geometry,this.properties=Xt.tags,this.extent=gn||4096}return rr=Ct,Ct.prototype.feature=function(Xt){return new Zt(this.features[Xt],this.options.extent)},Zt.prototype.loadGeometry=function(){var Xt=this.rawGeometry;this.geometry=[];for(var gn=0;gn<Xt.length;gn++){for(var Cn=Xt[gn],On=[],wn=0;wn<Cn.length;wn++)On.push(new lt(Cn[wn][0],Cn[wn][1]));this.geometry.push(On)}return this.geometry},Zt.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Xt=this.geometry,gn=1/0,Cn=-1/0,On=1/0,wn=-1/0,er=0;er<Xt.length;er++)for(var tr=Xt[er],Yn=0;Yn<tr.length;Yn++){var dr=tr[Yn];gn=Math.min(gn,dr.x),Cn=Math.max(Cn,dr.x),On=Math.min(On,dr.y),wn=Math.max(wn,dr.y)}return[gn,On,Cn,wn]},Zt.prototype.toGeoJSON=ut.prototype.toGeoJSON,rr}();function pe(lt){var ut=new dt;return function(Ct,Zt){for(var Xt in Ct.layers)Zt.writeMessage(3,we,Ct.layers[Xt])}(lt,ut),ut.finish()}function we(lt,ut){var Ct;ut.writeVarintField(15,lt.version||1),ut.writeStringField(1,lt.name||""),ut.writeVarintField(5,lt.extent||4096);var Zt={keys:[],values:[],keycache:{},valuecache:{}};for(Ct=0;Ct<lt.length;Ct++)Zt.feature=lt.feature(Ct),ut.writeMessage(2,ze,Zt);var Xt=Zt.keys;for(Ct=0;Ct<Xt.length;Ct++)ut.writeStringField(3,Xt[Ct]);var gn=Zt.values;for(Ct=0;Ct<gn.length;Ct++)ut.writeMessage(4,ct,gn[Ct])}function ze(lt,ut){var Ct=lt.feature;Ct.id!==void 0&&ut.writeVarintField(1,Ct.id),ut.writeMessage(2,je,lt),ut.writeVarintField(3,Ct.type),ut.writeMessage(4,Ye,Ct)}function je(lt,ut){var Ct=lt.feature,Zt=lt.keys,Xt=lt.values,gn=lt.keycache,Cn=lt.valuecache;for(var On in Ct.properties){var wn=Ct.properties[On],er=gn[On];if(wn!==null){er===void 0&&(Zt.push(On),gn[On]=er=Zt.length-1),ut.writeVarint(er);var tr=typeof wn;tr!=="string"&&tr!=="boolean"&&tr!=="number"&&(wn=JSON.stringify(wn));var Yn=tr+":"+wn,dr=Cn[Yn];dr===void 0&&(Xt.push(wn),Cn[Yn]=dr=Xt.length-1),ut.writeVarint(dr)}}}function We(lt,ut){return(ut<<3)+(7&lt)}function it(lt){return lt<<1^lt>>31}function Ye(lt,ut){for(var Ct=lt.loadGeometry(),Zt=lt.type,Xt=0,gn=0,Cn=Ct.length,On=0;On<Cn;On++){var wn=Ct[On],er=1;Zt===1&&(er=wn.length),ut.writeVarint(We(1,er));for(var tr=Zt===3?wn.length-1:wn.length,Yn=0;Yn<tr;Yn++){Yn===1&&Zt!==1&&ut.writeVarint(We(2,tr-1));var dr=wn[Yn].x-Xt,vr=wn[Yn].y-gn;ut.writeVarint(it(dr)),ut.writeVarint(it(vr)),Xt+=dr,gn+=vr}Zt===3&&ut.writeVarint(We(7,1))}}function ct(lt,ut){var Ct=typeof lt;Ct==="string"?ut.writeStringField(1,lt):Ct==="boolean"?ut.writeBooleanField(7,lt):Ct==="number"&&(lt%1!=0?ut.writeDoubleField(3,lt):lt<0?ut.writeSVarintField(6,lt):ut.writeVarintField(5,lt))}return ir.exports=pe,ir.exports.fromVectorTileJs=pe,ir.exports.fromGeojsonVt=function(lt,ut){ut=ut||{};var Ct={};for(var Zt in lt)Ct[Zt]=new le(lt[Zt].features,ut),Ct[Zt].name=Zt,Ct[Zt].version=ut.version,Ct[Zt].extent=ut.extent;return pe({layers:Ct})},ir.exports.GeoJSONWrapper=le,ir.exports}(),Ne=i.e9(yn);const Qn={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:dt=>dt},fn=Math.fround||(Dr=new Float32Array(1),dt=>(Dr[0]=+dt,Dr[0]));var Dr;const It=3,Ir=5,Cr=6;class ki{constructor(le){this.options=Object.assign(Object.create(Qn),le),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(le){const{log:pe,minZoom:we,maxZoom:ze}=this.options;pe&&console.time("total time");const je=`prepare ${le.length} points`;pe&&console.time(je),this.points=le;const We=[];for(let Ye=0;Ye<le.length;Ye++){const ct=le[Ye];if(!ct.geometry)continue;const[lt,ut]=ct.geometry.coordinates,Ct=fn(ca(lt)),Zt=fn(Aa(ut));We.push(Ct,Zt,1/0,Ye,-1,1),this.options.reduce&&We.push(0)}let it=this.trees[ze+1]=this._createTree(We);pe&&console.timeEnd(je);for(let Ye=ze;Ye>=we;Ye--){const ct=+Date.now();it=this.trees[Ye]=this._createTree(this._cluster(it,Ye)),pe&&console.log("z%d: %d clusters in %dms",Ye,it.numItems,+Date.now()-ct)}return pe&&console.timeEnd("total time"),this}getClusters(le,pe){let we=((le[0]+180)%360+360)%360-180;const ze=Math.max(-90,Math.min(90,le[1]));let je=le[2]===180?180:((le[2]+180)%360+360)%360-180;const We=Math.max(-90,Math.min(90,le[3]));if(le[2]-le[0]>=360)we=-180,je=180;else if(we>je){const ut=this.getClusters([we,ze,180,We],pe),Ct=this.getClusters([-180,ze,je,We],pe);return ut.concat(Ct)}const it=this.trees[this._limitZoom(pe)],Ye=it.range(ca(we),Aa(We),ca(je),Aa(ze)),ct=it.data,lt=[];for(const ut of Ye){const Ct=this.stride*ut;lt.push(ct[Ct+Ir]>1?$n(ct,Ct,this.clusterProps):this.points[ct[Ct+It]])}return lt}getChildren(le){const pe=this._getOriginId(le),we=this._getOriginZoom(le),ze="No cluster with the specified id.",je=this.trees[we];if(!je)throw new Error(ze);const We=je.data;if(pe*this.stride>=We.length)throw new Error(ze);const it=this.options.radius/(this.options.extent*Math.pow(2,we-1)),Ye=je.within(We[pe*this.stride],We[pe*this.stride+1],it),ct=[];for(const lt of Ye){const ut=lt*this.stride;We[ut+4]===le&&ct.push(We[ut+Ir]>1?$n(We,ut,this.clusterProps):this.points[We[ut+It]])}if(ct.length===0)throw new Error(ze);return ct}getLeaves(le,pe,we){const ze=[];return this._appendLeaves(ze,le,pe=pe||10,we=we||0,0),ze}getTile(le,pe,we){const ze=this.trees[this._limitZoom(le)],je=Math.pow(2,le),{extent:We,radius:it}=this.options,Ye=it/We,ct=(we-Ye)/je,lt=(we+1+Ye)/je,ut={features:[]};return this._addTileFeatures(ze.range((pe-Ye)/je,ct,(pe+1+Ye)/je,lt),ze.data,pe,we,je,ut),pe===0&&this._addTileFeatures(ze.range(1-Ye/je,ct,1,lt),ze.data,je,we,je,ut),pe===je-1&&this._addTileFeatures(ze.range(0,ct,Ye/je,lt),ze.data,-1,we,je,ut),ut.features.length?ut:null}getClusterExpansionZoom(le){let pe=this._getOriginZoom(le)-1;for(;pe<=this.options.maxZoom;){const we=this.getChildren(le);if(pe++,we.length!==1)break;le=we[0].properties.cluster_id}return pe}_appendLeaves(le,pe,we,ze,je){const We=this.getChildren(pe);for(const it of We){const Ye=it.properties;if(Ye&&Ye.cluster?je+Ye.point_count<=ze?je+=Ye.point_count:je=this._appendLeaves(le,Ye.cluster_id,we,ze,je):je<ze?je++:le.push(it),le.length===we)break}return je}_createTree(le){const pe=new i.bE(le.length/this.stride|0,this.options.nodeSize,Float32Array);for(let we=0;we<le.length;we+=this.stride)pe.add(le[we],le[we+1]);return pe.finish(),pe.data=le,pe}_addTileFeatures(le,pe,we,ze,je,We){for(const it of le){const Ye=it*this.stride,ct=pe[Ye+Ir]>1;let lt,ut,Ct;if(ct)lt=si(pe,Ye,this.clusterProps),ut=pe[Ye],Ct=pe[Ye+1];else{const gn=this.points[pe[Ye+It]];lt=gn.properties;const[Cn,On]=gn.geometry.coordinates;ut=ca(Cn),Ct=Aa(On)}const Zt={type:1,geometry:[[Math.round(this.options.extent*(ut*je-we)),Math.round(this.options.extent*(Ct*je-ze))]],tags:lt};let Xt;Xt=ct||this.options.generateId?pe[Ye+It]:this.points[pe[Ye+It]].id,Xt!==void 0&&(Zt.id=Xt),We.features.push(Zt)}}_limitZoom(le){return Math.max(this.options.minZoom,Math.min(Math.floor(+le),this.options.maxZoom+1))}_cluster(le,pe){const{radius:we,extent:ze,reduce:je,minPoints:We}=this.options,it=we/(ze*Math.pow(2,pe)),Ye=le.data,ct=[],lt=this.stride;for(let ut=0;ut<Ye.length;ut+=lt){if(Ye[ut+2]<=pe)continue;Ye[ut+2]=pe;const Ct=Ye[ut],Zt=Ye[ut+1],Xt=le.within(Ye[ut],Ye[ut+1],it),gn=Ye[ut+Ir];let Cn=gn;for(const On of Xt){const wn=On*lt;Ye[wn+2]>pe&&(Cn+=Ye[wn+Ir])}if(Cn>gn&&Cn>=We){let On,wn=Ct*gn,er=Zt*gn,tr=-1;const Yn=(ut/lt<<5)+(pe+1)+this.points.length;for(const dr of Xt){const vr=dr*lt;if(Ye[vr+2]<=pe)continue;Ye[vr+2]=pe;const Ii=Ye[vr+Ir];wn+=Ye[vr]*Ii,er+=Ye[vr+1]*Ii,Ye[vr+4]=Yn,je&&(On||(On=this._map(Ye,ut,!0),tr=this.clusterProps.length,this.clusterProps.push(On)),je(On,this._map(Ye,vr)))}Ye[ut+4]=Yn,ct.push(wn/Cn,er/Cn,1/0,Yn,-1,Cn),je&&ct.push(tr)}else{for(let On=0;On<lt;On++)ct.push(Ye[ut+On]);if(Cn>1)for(const On of Xt){const wn=On*lt;if(!(Ye[wn+2]<=pe)){Ye[wn+2]=pe;for(let er=0;er<lt;er++)ct.push(Ye[wn+er])}}}}return ct}_getOriginId(le){return le-this.points.length>>5}_getOriginZoom(le){return(le-this.points.length)%32}_map(le,pe,we){if(le[pe+Ir]>1){const We=this.clusterProps[le[pe+Cr]];return we?Object.assign({},We):We}const ze=this.points[le[pe+It]].properties,je=this.options.map(ze);return we&&je===ze?Object.assign({},je):je}}function $n(dt,le,pe){return{type:"Feature",id:dt[le+It],properties:si(dt,le,pe),geometry:{type:"Point",coordinates:[(we=dt[le],360*(we-.5)),ao(dt[le+1])]}};var we}function si(dt,le,pe){const we=dt[le+Ir],ze=we>=1e4?`${Math.round(we/1e3)}k`:we>=1e3?Math.round(we/100)/10+"k":we,je=dt[le+Cr],We=je===-1?{}:Object.assign({},pe[je]);return Object.assign(We,{cluster:!0,cluster_id:dt[le+It],point_count:we,point_count_abbreviated:ze})}function ca(dt){return dt/360+.5}function Aa(dt){const le=Math.sin(dt*Math.PI/180),pe=.5-.25*Math.log((1+le)/(1-le))/Math.PI;return pe<0?0:pe>1?1:pe}function ao(dt){const le=(180-360*dt)*Math.PI/180;return 360*Math.atan(Math.exp(le))/Math.PI-90}function Ss(dt,le,pe,we){let ze=we;const je=le+(pe-le>>1);let We,it=pe-le;const Ye=dt[le],ct=dt[le+1],lt=dt[pe],ut=dt[pe+1];for(let Ct=le+3;Ct<pe;Ct+=3){const Zt=Bn(dt[Ct],dt[Ct+1],Ye,ct,lt,ut);if(Zt>ze)We=Ct,ze=Zt;else if(Zt===ze){const Xt=Math.abs(Ct-je);Xt<it&&(We=Ct,it=Xt)}}ze>we&&(We-le>3&&Ss(dt,le,We,we),dt[We+2]=ze,pe-We>3&&Ss(dt,We,pe,we))}function Bn(dt,le,pe,we,ze,je){let We=ze-pe,it=je-we;if(We!==0||it!==0){const Ye=((dt-pe)*We+(le-we)*it)/(We*We+it*it);Ye>1?(pe=ze,we=je):Ye>0&&(pe+=We*Ye,we+=it*Ye)}return We=dt-pe,it=le-we,We*We+it*it}function Lo(dt,le,pe,we){const ze={id:dt??null,type:le,geometry:pe,tags:we,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(le==="Point"||le==="MultiPoint"||le==="LineString")Jo(ze,pe);else if(le==="Polygon")Jo(ze,pe[0]);else if(le==="MultiLineString")for(const je of pe)Jo(ze,je);else if(le==="MultiPolygon")for(const je of pe)Jo(ze,je[0]);return ze}function Jo(dt,le){for(let pe=0;pe<le.length;pe+=3)dt.minX=Math.min(dt.minX,le[pe]),dt.minY=Math.min(dt.minY,le[pe+1]),dt.maxX=Math.max(dt.maxX,le[pe]),dt.maxY=Math.max(dt.maxY,le[pe+1])}function ml(dt,le,pe,we){if(!le.geometry)return;const ze=le.geometry.coordinates;if(ze&&ze.length===0)return;const je=le.geometry.type,We=Math.pow(pe.tolerance/((1<<pe.maxZoom)*pe.extent),2);let it=[],Ye=le.id;if(pe.promoteId?Ye=le.properties[pe.promoteId]:pe.generateId&&(Ye=we||0),je==="Point")ua(ze,it);else if(je==="MultiPoint")for(const ct of ze)ua(ct,it);else if(je==="LineString")_l(ze,it,We,!1);else if(je==="MultiLineString"){if(pe.lineMetrics){for(const ct of ze)it=[],_l(ct,it,We,!1),dt.push(Lo(Ye,"LineString",it,le.properties));return}nc(ze,it,We,!1)}else if(je==="Polygon")nc(ze,it,We,!0);else{if(je!=="MultiPolygon"){if(je==="GeometryCollection"){for(const ct of le.geometry.geometries)ml(dt,{id:Ye,geometry:ct,properties:le.properties},pe,we);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const ct of ze){const lt=[];nc(ct,lt,We,!0),it.push(lt)}}dt.push(Lo(Ye,je,it,le.properties))}function ua(dt,le){le.push(Yu(dt[0]),Ku(dt[1]),0)}function _l(dt,le,pe,we){let ze,je,We=0;for(let Ye=0;Ye<dt.length;Ye++){const ct=Yu(dt[Ye][0]),lt=Ku(dt[Ye][1]);le.push(ct,lt,0),Ye>0&&(We+=we?(ze*lt-ct*je)/2:Math.sqrt(Math.pow(ct-ze,2)+Math.pow(lt-je,2))),ze=ct,je=lt}const it=le.length-3;le[2]=1,Ss(le,0,it,pe),le[it+2]=1,le.size=Math.abs(We),le.start=0,le.end=le.size}function nc(dt,le,pe,we){for(let ze=0;ze<dt.length;ze++){const je=[];_l(dt[ze],je,pe,we),le.push(je)}}function Yu(dt){return dt/360+.5}function Ku(dt){const le=Math.sin(dt*Math.PI/180),pe=.5-.25*Math.log((1+le)/(1-le))/Math.PI;return pe<0?0:pe>1?1:pe}function ha(dt,le,pe,we,ze,je,We,it){if(we/=le,je>=(pe/=le)&&We<we)return dt;if(We<pe||je>=we)return null;const Ye=[];for(const ct of dt){const lt=ct.geometry;let ut=ct.type;const Ct=ze===0?ct.minX:ct.minY,Zt=ze===0?ct.maxX:ct.maxY;if(Ct>=pe&&Zt<we){Ye.push(ct);continue}if(Zt<pe||Ct>=we)continue;let Xt=[];if(ut==="Point"||ut==="MultiPoint")Ca(lt,Xt,pe,we,ze);else if(ut==="LineString")Ju(lt,Xt,pe,we,ze,!1,it.lineMetrics);else if(ut==="MultiLineString")fa(lt,Xt,pe,we,ze,!1);else if(ut==="Polygon")fa(lt,Xt,pe,we,ze,!0);else if(ut==="MultiPolygon")for(const gn of lt){const Cn=[];fa(gn,Cn,pe,we,ze,!0),Cn.length&&Xt.push(Cn)}if(Xt.length){if(it.lineMetrics&&ut==="LineString"){for(const gn of Xt)Ye.push(Lo(ct.id,ut,gn,ct.tags));continue}ut!=="LineString"&&ut!=="MultiLineString"||(Xt.length===1?(ut="LineString",Xt=Xt[0]):ut="MultiLineString"),ut!=="Point"&&ut!=="MultiPoint"||(ut=Xt.length===3?"Point":"MultiPoint"),Ye.push(Lo(ct.id,ut,Xt,ct.tags))}}return Ye.length?Ye:null}function Ca(dt,le,pe,we,ze){for(let je=0;je<dt.length;je+=3){const We=dt[je+ze];We>=pe&&We<=we&&qn(le,dt[je],dt[je+1],dt[je+2])}}function Ju(dt,le,pe,we,ze,je,We){let it=ea(dt);const Ye=ze===0?Hs:zd;let ct,lt,ut=dt.start;for(let Cn=0;Cn<dt.length-3;Cn+=3){const On=dt[Cn],wn=dt[Cn+1],er=dt[Cn+2],tr=dt[Cn+3],Yn=dt[Cn+4],dr=ze===0?On:wn,vr=ze===0?tr:Yn;let Ii=!1;We&&(ct=Math.sqrt(Math.pow(On-tr,2)+Math.pow(wn-Yn,2))),dr<pe?vr>pe&&(lt=Ye(it,On,wn,tr,Yn,pe),We&&(it.start=ut+ct*lt)):dr>we?vr<we&&(lt=Ye(it,On,wn,tr,Yn,we),We&&(it.start=ut+ct*lt)):qn(it,On,wn,er),vr<pe&&dr>=pe&&(lt=Ye(it,On,wn,tr,Yn,pe),Ii=!0),vr>we&&dr<=we&&(lt=Ye(it,On,wn,tr,Yn,we),Ii=!0),!je&&Ii&&(We&&(it.end=ut+ct*lt),le.push(it),it=ea(dt)),We&&(ut+=ct)}let Ct=dt.length-3;const Zt=dt[Ct],Xt=dt[Ct+1],gn=ze===0?Zt:Xt;gn>=pe&&gn<=we&&qn(it,Zt,Xt,dt[Ct+2]),Ct=it.length-3,je&&Ct>=3&&(it[Ct]!==it[0]||it[Ct+1]!==it[1])&&qn(it,it[0],it[1],it[2]),it.length&&le.push(it)}function ea(dt){const le=[];return le.size=dt.size,le.start=dt.start,le.end=dt.end,le}function fa(dt,le,pe,we,ze,je){for(const We of dt)Ju(We,le,pe,we,ze,je,!1)}function qn(dt,le,pe,we){dt.push(le,pe,we)}function Hs(dt,le,pe,we,ze,je){const We=(je-le)/(we-le);return qn(dt,je,pe+(ze-pe)*We,1),We}function zd(dt,le,pe,we,ze,je){const We=(je-pe)/(ze-pe);return qn(dt,le+(we-le)*We,je,1),We}function $a(dt,le){const pe=[];for(let we=0;we<dt.length;we++){const ze=dt[we],je=ze.type;let We;if(je==="Point"||je==="MultiPoint"||je==="LineString")We=Qo(ze.geometry,le);else if(je==="MultiLineString"||je==="Polygon"){We=[];for(const it of ze.geometry)We.push(Qo(it,le))}else if(je==="MultiPolygon"){We=[];for(const it of ze.geometry){const Ye=[];for(const ct of it)Ye.push(Qo(ct,le));We.push(Ye)}}pe.push(Lo(ze.id,je,We,ze.tags))}return pe}function Qo(dt,le){const pe=[];pe.size=dt.size,dt.start!==void 0&&(pe.start=dt.start,pe.end=dt.end);for(let we=0;we<dt.length;we+=3)pe.push(dt[we]+le,dt[we+1],dt[we+2]);return pe}function es(dt,le){if(dt.transformed)return dt;const pe=1<<dt.z,we=dt.x,ze=dt.y;for(const je of dt.features){const We=je.geometry,it=je.type;if(je.geometry=[],it===1)for(let Ye=0;Ye<We.length;Ye+=2)je.geometry.push(gl(We[Ye],We[Ye+1],le,pe,we,ze));else for(let Ye=0;Ye<We.length;Ye++){const ct=[];for(let lt=0;lt<We[Ye].length;lt+=2)ct.push(gl(We[Ye][lt],We[Ye][lt+1],le,pe,we,ze));je.geometry.push(ct)}}return dt.transformed=!0,dt}function gl(dt,le,pe,we,ze,je){return[Math.round(pe*(dt*we-ze)),Math.round(pe*(le*we-je))]}function Zs(dt,le,pe,we,ze){const je=le===ze.maxZoom?0:ze.tolerance/((1<<le)*ze.extent),We={features:[],numPoints:0,numSimplified:0,numFeatures:dt.length,source:null,x:pe,y:we,z:le,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const it of dt)kd(We,it,je,ze);return We}function kd(dt,le,pe,we){const ze=le.geometry,je=le.type,We=[];if(dt.minX=Math.min(dt.minX,le.minX),dt.minY=Math.min(dt.minY,le.minY),dt.maxX=Math.max(dt.maxX,le.maxX),dt.maxY=Math.max(dt.maxY,le.maxY),je==="Point"||je==="MultiPoint")for(let it=0;it<ze.length;it+=3)We.push(ze[it],ze[it+1]),dt.numPoints++,dt.numSimplified++;else if(je==="LineString")au(We,ze,dt,pe,!1,!1);else if(je==="MultiLineString"||je==="Polygon")for(let it=0;it<ze.length;it++)au(We,ze[it],dt,pe,je==="Polygon",it===0);else if(je==="MultiPolygon")for(let it=0;it<ze.length;it++){const Ye=ze[it];for(let ct=0;ct<Ye.length;ct++)au(We,Ye[ct],dt,pe,!0,ct===0)}if(We.length){let it=le.tags||null;if(je==="LineString"&&we.lineMetrics){it={};for(const ct in le.tags)it[ct]=le.tags[ct];it.mapbox_clip_start=ze.start/ze.size,it.mapbox_clip_end=ze.end/ze.size}const Ye={geometry:We,type:je==="Polygon"||je==="MultiPolygon"?3:je==="LineString"||je==="MultiLineString"?2:1,tags:it};le.id!==null&&(Ye.id=le.id),dt.features.push(Ye)}}function au(dt,le,pe,we,ze,je){const We=we*we;if(we>0&&le.size<(ze?We:we))return void(pe.numPoints+=le.length/3);const it=[];for(let Ye=0;Ye<le.length;Ye+=3)(we===0||le[Ye+2]>We)&&(pe.numSimplified++,it.push(le[Ye],le[Ye+1])),pe.numPoints++;ze&&function(Ye,ct){let lt=0;for(let ut=0,Ct=Ye.length,Zt=Ct-2;ut<Ct;Zt=ut,ut+=2)lt+=(Ye[ut]-Ye[Zt])*(Ye[ut+1]+Ye[Zt+1]);if(lt>0===ct)for(let ut=0,Ct=Ye.length;ut<Ct/2;ut+=2){const Zt=Ye[ut],Xt=Ye[ut+1];Ye[ut]=Ye[Ct-2-ut],Ye[ut+1]=Ye[Ct-1-ut],Ye[Ct-2-ut]=Zt,Ye[Ct-1-ut]=Xt}}(it,je),dt.push(it)}const lf={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class Qu{constructor(le,pe){const we=(pe=this.options=function(je,We){for(const it in We)je[it]=We[it];return je}(Object.create(lf),pe)).debug;if(we&&console.time("preprocess data"),pe.maxZoom<0||pe.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(pe.promoteId&&pe.generateId)throw new Error("promoteId and generateId cannot be used together.");let ze=function(je,We){const it=[];if(je.type==="FeatureCollection")for(let Ye=0;Ye<je.features.length;Ye++)ml(it,je.features[Ye],We,Ye);else ml(it,je.type==="Feature"?je:{geometry:je},We);return it}(le,pe);this.tiles={},this.tileCoords=[],we&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",pe.indexMaxZoom,pe.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),ze=function(je,We){const it=We.buffer/We.extent;let Ye=je;const ct=ha(je,1,-1-it,it,0,-1,2,We),lt=ha(je,1,1-it,2+it,0,-1,2,We);return(ct||lt)&&(Ye=ha(je,1,-it,1+it,0,-1,2,We)||[],ct&&(Ye=$a(ct,1).concat(Ye)),lt&&(Ye=Ye.concat($a(lt,-1)))),Ye}(ze,pe),ze.length&&this.splitTile(ze,0,0,0),we&&(ze.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(le,pe,we,ze,je,We,it){const Ye=[le,pe,we,ze],ct=this.options,lt=ct.debug;for(;Ye.length;){ze=Ye.pop(),we=Ye.pop(),pe=Ye.pop(),le=Ye.pop();const ut=1<<pe,Ct=vi(pe,we,ze);let Zt=this.tiles[Ct];if(!Zt&&(lt>1&&console.time("creation"),Zt=this.tiles[Ct]=Zs(le,pe,we,ze,ct),this.tileCoords.push({z:pe,x:we,y:ze}),lt)){lt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",pe,we,ze,Zt.numFeatures,Zt.numPoints,Zt.numSimplified),console.timeEnd("creation"));const Ii=`z${pe}`;this.stats[Ii]=(this.stats[Ii]||0)+1,this.total++}if(Zt.source=le,je==null){if(pe===ct.indexMaxZoom||Zt.numPoints<=ct.indexMaxPoints)continue}else{if(pe===ct.maxZoom||pe===je)continue;if(je!=null){const Ii=je-pe;if(we!==We>>Ii||ze!==it>>Ii)continue}}if(Zt.source=null,le.length===0)continue;lt>1&&console.time("clipping");const Xt=.5*ct.buffer/ct.extent,gn=.5-Xt,Cn=.5+Xt,On=1+Xt;let wn=null,er=null,tr=null,Yn=null,dr=ha(le,ut,we-Xt,we+Cn,0,Zt.minX,Zt.maxX,ct),vr=ha(le,ut,we+gn,we+On,0,Zt.minX,Zt.maxX,ct);le=null,dr&&(wn=ha(dr,ut,ze-Xt,ze+Cn,1,Zt.minY,Zt.maxY,ct),er=ha(dr,ut,ze+gn,ze+On,1,Zt.minY,Zt.maxY,ct),dr=null),vr&&(tr=ha(vr,ut,ze-Xt,ze+Cn,1,Zt.minY,Zt.maxY,ct),Yn=ha(vr,ut,ze+gn,ze+On,1,Zt.minY,Zt.maxY,ct),vr=null),lt>1&&console.timeEnd("clipping"),Ye.push(wn||[],pe+1,2*we,2*ze),Ye.push(er||[],pe+1,2*we,2*ze+1),Ye.push(tr||[],pe+1,2*we+1,2*ze),Ye.push(Yn||[],pe+1,2*we+1,2*ze+1)}}getTile(le,pe,we){le=+le,pe=+pe,we=+we;const ze=this.options,{extent:je,debug:We}=ze;if(le<0||le>24)return null;const it=1<<le,Ye=vi(le,pe=pe+it&it-1,we);if(this.tiles[Ye])return es(this.tiles[Ye],je);We>1&&console.log("drilling down to z%d-%d-%d",le,pe,we);let ct,lt=le,ut=pe,Ct=we;for(;!ct&&lt>0;)lt--,ut>>=1,Ct>>=1,ct=this.tiles[vi(lt,ut,Ct)];return ct&&ct.source?(We>1&&(console.log("found parent tile z%d-%d-%d",lt,ut,Ct),console.time("drilling down")),this.splitTile(ct.source,lt,ut,Ct,le,pe,we),We>1&&console.timeEnd("drilling down"),this.tiles[Ye]?es(this.tiles[Ye],je):null):null}}function vi(dt,le,pe){return 32*((1<<dt)*pe+le)+dt}function cf(dt,le){const pe=dt.tileID.canonical;if(!this._geoJSONIndex)return void le(null,null);const we=this._geoJSONIndex.getTile(pe.z,pe.x,pe.y);if(!we)return void le(null,null);const ze=new Ft(we.features);let je=Ne(ze);je.byteOffset===0&&je.byteLength===je.buffer.byteLength||(je=new Uint8Array(je)),le(null,{vectorTile:ze,rawData:je.buffer})}class uf extends Ge{constructor(le,pe,we,ze,je,We){super(le,pe,we,ze,cf,We),je&&(this.loadGeoJSON=je),this._dynamicIndex=new Vt}loadData(le,pe){const we=le&&le.request,ze=we&&we.collectResourceTiming;this.loadGeoJSON(le,(je,We)=>{if(je||!We)return pe(je);if(typeof We!="object")return pe(new Error(`Input data given to '${le.source}' is not a valid GeoJSON object.`));{try{if(le.filter){const Ye=i.U(le.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Ye.result==="error")throw new Error(Ye.value.map(ct=>`${ct.key}: ${ct.message}`).join(", "));We.features=We.features.filter(ct=>Ye.value.evaluate({zoom:0},ct))}le.dynamic?(We.type==="Feature"&&(We={type:"FeatureCollection",features:[We]}),le.append||(this._dynamicIndex.clear(),this.loaded={}),this._dynamicIndex.load(We.features,this.loaded),le.cluster&&(We.features=this._dynamicIndex.getFeatures())):this.loaded={},this._geoJSONIndex=le.cluster?new ki(function({superclusterOptions:Ye,clusterProperties:ct}){if(!ct||!Ye)return Ye;const lt={},ut={},Ct={accumulated:null,zoom:0},Zt={properties:null},Xt=Object.keys(ct);for(const gn of Xt){const[Cn,On]=ct[gn],wn=i.U(On),er=i.U(typeof Cn=="string"?[Cn,["accumulated"],["get",gn]]:Cn);lt[gn]=wn.value,ut[gn]=er.value}return Ye.map=gn=>{Zt.properties=gn;const Cn={};for(const On of Xt)Cn[On]=lt[On].evaluate(Ct,Zt);return Cn},Ye.reduce=(gn,Cn)=>{Zt.properties=Cn;for(const On of Xt)Ct.accumulated=gn[On],gn[On]=ut[On].evaluate(Ct,Zt)},Ye}(le)).load(We.features):le.dynamic?this._dynamicIndex:function(Ye,ct){return new Qu(Ye,ct)}(We,le.geojsonVtOptions)}catch(Ye){return pe(Ye)}const it={};if(ze){const Ye=O(we);Ye&&(it.resourceTiming={},it.resourceTiming[le.source]=JSON.parse(JSON.stringify(Ye)))}pe(null,it)}})}reloadTile(le,pe){const we=this.loaded;return we&&we[le.uid]?le.partial?pe(null,void 0):super.reloadTile(le,pe):this.loadTile(le,pe)}loadGeoJSON(le,pe){if(le.request)i.n(le.request,pe);else{if(typeof le.data!="string")return pe(new Error(`Input data given to '${le.source}' is not a valid GeoJSON object.`));try{return pe(null,JSON.parse(le.data))}catch{return pe(new Error(`Input data given to '${le.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(le,pe){try{pe(null,this._geoJSONIndex.getClusterExpansionZoom(le.clusterId))}catch(we){pe(we)}}getClusterChildren(le,pe){try{pe(null,this._geoJSONIndex.getChildren(le.clusterId))}catch(we){pe(we)}}getClusterLeaves(le,pe){try{pe(null,this._geoJSONIndex.getLeaves(le.clusterId,le.limit,le.offset))}catch(we){pe(we)}}}class eh{constructor(le,pe){this.tileID=new i.aG(le.tileID.overscaledZ,le.tileID.wrap,le.tileID.canonical.z,le.tileID.canonical.x,le.tileID.canonical.y),this.tileZoom=le.tileZoom,this.uid=le.uid,this.zoom=le.zoom,this.canonical=le.tileID.canonical,this.pixelRatio=le.pixelRatio,this.tileSize=le.tileSize,this.source=le.source,this.overscaling=this.tileID.overscaleFactor(),this.projection=le.projection,this.brightness=pe}parse(le,pe,we,ze){this.status="parsing";const je=new i.aG(we.tileID.overscaledZ,we.tileID.wrap,we.tileID.canonical.z,we.tileID.canonical.x,we.tileID.canonical.y),We=[],it=pe.familiesBySource[we.source],Ye=new i.d$(je,we.promoteId);return Ye.bucketLayerIDs=[],Ye.is3DTile=!0,i.ea(le).then(ct=>{if(!ct)return ze(new Error("Could not parse tile"));const lt=i.eb(ct,1/i.cc(we.tileID.canonical)),ut=ct.json.extensionsUsed&&ct.json.extensionsUsed.includes("MAPBOX_mesh_features")||ct.json.asset.extras&&ct.json.asset.extras.MAPBOX_mesh_features,Ct=ct.json.extensionsUsed&&ct.json.extensionsUsed.includes("EXT_meshopt_compression"),Zt=new i.a8(this.zoom,{brightness:this.brightness});for(const Xt in it)for(const gn of it[Xt]){const Cn=gn[0];Ye.bucketLayerIDs.push(gn.map(wn=>i.aC(wn.id,wn.scope))),Cn.recalculate(Zt,[]);const On=new i.ec(gn,lt,je,ut,Ct,this.brightness,Ye);ut||(On.needsUpload=!0),We.push(On),On.evaluate(Cn)}this.status="done",ze(null,{buckets:We,featureIndex:Ye,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:null})}).catch(ct=>ze(new Error(ct.message)))}}class da{constructor(le,pe,we,ze,je,We){this.actor=le,this.layerIndex=pe,this.availableImages=we,this.brightness=We,this.loading={},this.loaded={}}loadTile(le,pe){const we=le.uid,ze=this.loading[we]=new eh(le,this.brightness);i.bi(le.request,(je,We)=>{const it=!this.loading[we];return delete this.loading[we],it||je?(ze.status="done",it||(this.loaded[we]=ze),pe(je)):We&&We.byteLength!==0?void ze.parse(We,this.layerIndex,le,(Ye,ct)=>{ze.status="done",this.loaded=this.loaded||{},this.loaded[we]=ze,Ye||!ct?pe(Ye):pe(null,ct)}):(ze.status="done",this.loaded[we]=ze,pe())})}reloadTile(le,pe){const we=this.loaded,ze=le.uid;if(we&&we[ze]){const je=we[ze];je.projection=le.projection,je.brightness=le.brightness;const We=(it,Ye)=>{je.reloadCallback&&(delete je.reloadCallback,this.loadTile(le,pe)),pe(it,Ye)};je.status==="parsing"?je.reloadCallback=We:je.status==="done"&&this.loadTile(le,pe)}}abortTile(le,pe){const we=le.uid;this.loading[we]&&delete this.loading[we],pe()}removeTile(le,pe){const we=this.loaded,ze=le.uid;we&&we[ze]&&delete we[ze],pe()}}class Ts{constructor(le){this.self=le,this.actor=new i.ed(le,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.imageRasterizer=new i.I,this.projections={},this.defaultProjection=i.bP({name:"mercator"}),this.workerSourceTypes={vector:Ge,geojson:uf,"batched-model":da},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(pe,we)=>{if(this.workerSourceTypes[pe])throw new Error(`Worker source with name "${pe}" already registered.`);this.workerSourceTypes[pe]=we},this.self.registerRTLTextPlugin=pe=>{if(i.ee.isParsed())throw new Error("RTL text plugin already registered.");i.ee.applyArabicShaping=pe.applyArabicShaping,i.ee.processBidirectionalText=pe.processBidirectionalText,i.ee.processStyledBidirectionalText=pe.processStyledBidirectionalText}}clearCaches(le,pe,we){delete this.layerIndexes[le],delete this.availableImages[le],delete this.workerSources[le],delete this.demWorkerSources[le],delete this.rasterArrayWorkerSource,we()}checkIfReady(le,pe,we){we()}setReferrer(le,pe){this.referrer=pe}spriteLoaded(le,{scope:pe,isLoaded:we}){if(this.isSpriteLoaded[le]||(this.isSpriteLoaded[le]={}),this.isSpriteLoaded[le][pe]=we,this.workerSources[le]&&this.workerSources[le][pe])for(const ze in this.workerSources[le][pe]){const je=this.workerSources[le][pe][ze];for(const We in je){const it=je[We];it instanceof Ge&&(it.isSpriteLoaded=we,it.fire(new i.z("isSpriteLoaded")))}}}setImages(le,{scope:pe,images:we},ze){if(this.availableImages[le]||(this.availableImages[le]={}),this.availableImages[le][pe]=we,this.workerSources[le]&&this.workerSources[le][pe]){for(const je in this.workerSources[le][pe]){const We=this.workerSources[le][pe][je];for(const it in We)We[it].availableImages=we}ze()}else ze()}setProjection(le,pe){this.projections[le]=i.bP(pe)}setBrightness(le,pe,we){this.brightness=pe,we()}setLayers(le,pe,we){this.getLayerIndex(le,pe.scope).replace(pe.layers,pe.options),we()}updateLayers(le,pe,we){this.getLayerIndex(le,pe.scope).update(pe.layers,pe.removedIds,pe.options),we()}loadTile(le,pe,we){pe.projection=this.projections[le]||this.defaultProjection,this.getWorkerSource(le,pe.type,pe.source,pe.scope).loadTile(pe,we)}loadDEMTile(le,pe,we){this.getDEMWorkerSource(le,pe.source,pe.scope).loadTile(pe,we)}decodeRasterArray(le,pe,we){this.getRasterArrayWorkerSource().decodeRasterArray(pe,we)}reloadTile(le,pe,we){pe.projection=this.projections[le]||this.defaultProjection,this.getWorkerSource(le,pe.type,pe.source,pe.scope).reloadTile(pe,we)}abortTile(le,pe,we){this.getWorkerSource(le,pe.type,pe.source,pe.scope).abortTile(pe,we)}removeTile(le,pe,we){this.getWorkerSource(le,pe.type,pe.source,pe.scope).removeTile(pe,we)}removeSource(le,pe,we){if(!(this.workerSources[le]&&this.workerSources[le][pe.scope]&&this.workerSources[le][pe.scope][pe.type]&&this.workerSources[le][pe.scope][pe.type][pe.source]))return;const ze=this.workerSources[le][pe.scope][pe.type][pe.source];delete this.workerSources[le][pe.scope][pe.type][pe.source],ze.removeSource!==void 0?ze.removeSource(pe,we):we()}loadWorkerSource(le,pe,we){try{this.self.importScripts(pe.url),we()}catch(ze){we(ze.toString())}}syncRTLPluginState(le,pe,we){try{i.ee.setState(pe);const ze=i.ee.getPluginURL();if(i.ee.isLoaded()&&!i.ee.isParsed()&&ze!=null){this.self.importScripts(ze);const je=i.ee.isParsed();we(je?void 0:new Error(`RTL Text Plugin failed to import scripts from ${ze}`),je)}}catch(ze){we(ze.toString())}}setDracoUrl(le,pe){this.dracoUrl=pe}getAvailableImages(le,pe){this.availableImages[le]||(this.availableImages[le]={});let we=this.availableImages[le][pe];return we||(we=[]),we}getLayerIndex(le,pe){this.layerIndexes[le]||(this.layerIndexes[le]={});let we=this.layerIndexes[le][pe];return we||(we=this.layerIndexes[le][pe]=new F,we.scope=pe),we}getWorkerSource(le,pe,we,ze){return this.workerSources[le]||(this.workerSources[le]={}),this.workerSources[le][ze]||(this.workerSources[le][ze]={}),this.workerSources[le][ze][pe]||(this.workerSources[le][ze][pe]={}),this.isSpriteLoaded[le]||(this.isSpriteLoaded[le]={}),this.workerSources[le][ze][pe][we]||(this.workerSources[le][ze][pe][we]=new this.workerSourceTypes[pe]({send:(je,We,it,Ye,ct,lt)=>{this.actor.send(je,We,it,le,ct,lt)},scheduler:this.actor.scheduler},this.getLayerIndex(le,ze),this.getAvailableImages(le,ze),this.isSpriteLoaded[le][ze],void 0,this.brightness)),this.workerSources[le][ze][pe][we]}rasterizeImages(le,pe,we){const{imageTasks:ze,scope:je}=pe,We={};for(const it in ze){const{image:Ye,imageIdWithOptions:ct}=ze[it];We[it]=this.imageRasterizer.rasterize(ct,Ye,je,le)}we(void 0,We)}removeRasterizedImages(le,pe,we){const{imageIds:ze,scope:je}=pe;this.imageRasterizer.removeImagesFromCacheByIds(ze,je,le),we()}getDEMWorkerSource(le,pe,we){return this.demWorkerSources[le]||(this.demWorkerSources[le]={}),this.demWorkerSources[le][we]||(this.demWorkerSources[le][we]={}),this.demWorkerSources[le][we][pe]||(this.demWorkerSources[le][we][pe]=new ye),this.demWorkerSources[le][we][pe]}getRasterArrayWorkerSource(){return this.rasterArrayWorkerSource||(this.rasterArrayWorkerSource=new Le),this.rasterArrayWorkerSource}enforceCacheSizeLimit(le,pe){i.ef(pe)}getWorkerPerformanceMetrics(le,pe,we){we(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new Ts(self)),Ts}),v(["./shared"],function(i){var O="3.10.0";const z={create:"create",load:"load",fullLoad:"fullLoad"},j={mark(p){performance.mark(p)},measure(p,r,l){performance.measure(p,r,l)}};function F(p){const r=p.name.split("?")[0];return i.a(r)&&r.includes("mapbox-gl.js")?"javascript":i.a(r)&&r.includes("mapbox-gl.css")?"css":i.b(r)?"fontRange":i.c(r)?"sprite":i.i(r)?"style":i.d(r)?"tilejson":"other"}var G,Y={},X=function(){if(G)return Y;function p(m){return!r(m)}function r(m){return typeof window>"u"||typeof document>"u"?"not a browser":function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var b,A,R=new Blob([""],{type:"text/javascript"}),N=URL.createObjectURL(R);try{A=new Worker(N),b=!0}catch{b=!1}return A&&A.terminate(),URL.revokeObjectURL(N),b}()?function(){var b=document.createElement("canvas");b.width=b.height=1;var A=b.getContext("2d");if(!A)return!1;var R=A.getImageData(0,0,1,1);return R&&R.width===b.width}()?(l[x=m&&m.failIfMajorPerformanceCaveat]===void 0&&(l[x]=function(b){var A,R=function(N){var U=document.createElement("canvas"),$=Object.create(p.webGLContextAttributes);return $.failIfMajorPerformanceCaveat=N,U.getContext("webgl2",$)}(b);if(!R)return!1;try{A=R.createShader(R.VERTEX_SHADER)}catch{return!1}return!(!A||R.isContextLost())&&(R.shaderSource(A,"void main() {}"),R.compileShader(A),R.getShaderParameter(A,R.COMPILE_STATUS)===!0)}(x)),l[x]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL2 support"):"insufficient Canvas/getImageData support":"insufficient worker support";var x}G=1,Y.supported=p,Y.notSupportedReason=r;var l={};return p.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0},Y}();function K(p,r,l){const m=document.createElement(p);return r!=null&&(m.className=r),l&&l.appendChild(m),m}function ne(p,r,l){const m=document.createElementNS("http://www.w3.org/2000/svg",p);for(const x of Object.keys(r))m.setAttributeNS(null,x,String(r[x]));return l&&l.appendChild(m),m}const se=typeof document<"u"?document.documentElement&&document.documentElement.style:null,ge=se&&se.userSelect!==void 0?"userSelect":"WebkitUserSelect";let _e;function xe(){se&&ge&&(_e=se[ge],se[ge]="none")}function ae(){se&&ge&&(se[ge]=_e)}function ve(p){p.preventDefault(),p.stopPropagation(),window.removeEventListener("click",ve,!0)}function Se(){window.addEventListener("click",ve,!0),window.setTimeout(()=>{window.removeEventListener("click",ve,!0)},0)}function He(p,r){const l=p.getBoundingClientRect();return Le(p,l,r)}function Ge(p,r){const l=p.getBoundingClientRect(),m=[];for(let x=0;x<r.length;x++)m.push(Le(p,l,r[x]));return m}function ye(p){return/firefox/i.test(navigator.userAgent)&&/macintosh/i.test(navigator.userAgent)&&p.button===2&&p.ctrlKey?0:p.button}function Le(p,r,l){const m=p.offsetWidth===r.width?1:p.offsetWidth/r.width;return new i.P((l.clientX-r.left)*m,(l.clientY-r.top)*m)}const ht="01",gt="NO_ACCESS_TOKEN";class Ft{constructor(r,l,m){this._transformRequestFn=r,this._customAccessToken=l,this._silenceAuthErrors=!!m,this._createSkuToken()}_createSkuToken(){const r=function(){let l="";for(let m=0;m<10;m++)l+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",ht,l].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=r.token,this._skuTokenExpiresAt=r.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(r,l){return this._transformRequestFn&&this._transformRequestFn(r,l)||{url:r}}normalizeStyleURL(r,l){if(!i.f(r))return r;const m=yt(r);return m.params.push(`sdk=js-${O}`),m.path=`/styles/v1${m.path}`,this._makeAPIURL(m,this._customAccessToken||l)}normalizeGlyphsURL(r,l){if(!i.f(r))return r;const m=yt(r);return m.path=`/fonts/v1${m.path}`,this._makeAPIURL(m,this._customAccessToken||l)}normalizeModelURL(r,l){if(!i.f(r))return r;const m=yt(r);return m.path=`/models/v1${m.path}`,this._makeAPIURL(m,this._customAccessToken||l)}normalizeSourceURL(r,l,m,x){if(!i.f(r))return r;const b=yt(r);return b.path=`/v4/${b.authority}.json`,b.params.push("secure"),m&&b.params.push(`language=${m}`),x&&b.params.push(`worldview=${x}`),this._makeAPIURL(b,this._customAccessToken||l)}normalizeIconsetURL(r,l){const m=yt(r);return i.f(r)?(m.path=`/styles/v1${m.path}/iconset.pbf`,this._makeAPIURL(m,this._customAccessToken||l)):Vt(m)}normalizeSpriteURL(r,l,m,x){const b=yt(r);return i.f(r)?(b.path=`/styles/v1${b.path}/sprite${l}${m}`,this._makeAPIURL(b,this._customAccessToken||x)):(b.path+=`${l}${m}`,Vt(b))}normalizeTileURL(r,l,m){if(this._isSkuTokenExpired()&&this._createSkuToken(),r&&!i.f(r))return r;const x=yt(r);x.path=x.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${l||m&&x.authority!=="raster"&&m===512?"@2x":""}${i.m.supported?".webp":"$1"}`),x.authority==="raster"?x.path=`/${i.e.RASTER_URL_PREFIX}${x.path}`:x.authority==="rasterarrays"?x.path=`/${i.e.RASTERARRAYS_URL_PREFIX}${x.path}`:x.authority==="3dtiles"?x.path=`/${i.e.TILES3D_URL_PREFIX}${x.path}`:(x.path=x.path.replace(/^.+\/v4\//,"/"),x.path=`/${i.e.TILE_URL_VERSION}${x.path}`);const b=this._customAccessToken||function(A){for(const R of A){const N=R.match(/^access_token=(.*)$/);if(N)return N[1]}return null}(x.params)||i.e.ACCESS_TOKEN;return i.e.REQUIRE_ACCESS_TOKEN&&b&&this._skuToken&&x.params.push(`sku=${this._skuToken}`),this._makeAPIURL(x,b)}canonicalizeTileURL(r,l){const m=yt(r);if(!m.path.match(/^(\/v4\/|\/(raster|rasterarrays)\/v1\/)/)||!m.path.match(/\.[\w]+$/))return r;let x="mapbox://";m.path.match(/^\/raster\/v1\//)?x+=`raster/${m.path.replace(`/${i.e.RASTER_URL_PREFIX}/`,"")}`:m.path.match(/^\/rasterarrays\/v1\//)?x+=`rasterarrays/${m.path.replace(`/${i.e.RASTERARRAYS_URL_PREFIX}/`,"")}`:x+=`tiles/${m.path.replace(`/${i.e.TILE_URL_VERSION}/`,"")}`;let b=m.params;return l&&(b=b.filter(A=>!A.match(/^access_token=/))),b.length&&(x+=`?${b.join("&")}`),x}canonicalizeTileset(r,l){const m=!!l&&i.f(l),x=[];for(const b of r.tiles||[])i.h(b)?x.push(this.canonicalizeTileURL(b,m)):x.push(b);return x}_makeAPIURL(r,l){const m="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",x=yt(i.e.API_URL);if(r.protocol=x.protocol,r.authority=x.authority,r.protocol==="http"){const b=r.params.indexOf("secure");b>=0&&r.params.splice(b,1)}if(x.path!=="/"&&(r.path=`${x.path}${r.path}`),!i.e.REQUIRE_ACCESS_TOKEN)return Vt(r);if(l=l||i.e.ACCESS_TOKEN,!this._silenceAuthErrors){if(!l)throw new Error(`An API access token is required to use Mapbox GL. ${m}`);if(l[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${m}`)}return r.params=r.params.filter(b=>b.indexOf("access_token")===-1),r.params.push(`access_token=${l||""}`),Vt(r)}}const _t=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function yt(p){const r=p.match(_t);if(!r)throw new Error("Unable to parse URL object");return{protocol:r[1],authority:r[2],path:r[3]||"/",params:r[4]?r[4].split("&"):[]}}function Vt(p){const r=p.params.length?`?${p.params.join("&")}`:"";return`${p.protocol}://${p.authority}${p.path}${r}`}const Ht="mapbox.eventData";function Bt(p){if(!p)return null;const r=p.split(".");if(!r||r.length!==3)return null;try{return JSON.parse(i.j(r[1]))}catch{return null}}class et{constructor(r){this.type=r,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(r){const l=Bt(i.e.ACCESS_TOKEN);let m="";return m=l&&l.u?i.k(l.u):i.e.ACCESS_TOKEN||"",r?`${Ht}.${r}:${m}`:`${Ht}:${m}`}fetchEventData(){const r=i.s("localStorage"),l=this.getStorageKey(),m=this.getStorageKey("uuid");if(r)try{const x=localStorage.getItem(l);x&&(this.eventData=JSON.parse(x));const b=localStorage.getItem(m);b&&(this.anonId=b)}catch{i.w("Unable to read from LocalStorage")}}saveEventData(){const r=i.s("localStorage"),l=this.getStorageKey(),m=this.getStorageKey("uuid"),x=this.anonId;if(r&&x)try{localStorage.setItem(m,x),Object.keys(this.eventData).length>=1&&localStorage.setItem(l,JSON.stringify(this.eventData))}catch{i.w("Unable to write to LocalStorage")}}processRequests(r){}postEvent(r,l,m,x){if(!i.e.EVENTS_URL)return;const b=yt(i.e.EVENTS_URL);b.params.push(`access_token=${x||i.e.ACCESS_TOKEN||""}`);const A={event:this.type,created:new Date(r).toISOString()},R=l?i.l(A,l):A,N={url:Vt(b),headers:{"Content-Type":"text/plain"},body:JSON.stringify([R])};this.pendingRequest=i.p(N,U=>{this.pendingRequest=null,m(U),this.saveEventData(),this.processRequests(x)})}queueRequest(r,l){this.queue.push(r),this.processRequests(l)}}const $t=new class extends et{constructor(p){super("appUserTurnstile"),this._customAccessToken=p}postTurnstileEvent(p,r){i.e.EVENTS_URL&&i.e.ACCESS_TOKEN&&Array.isArray(p)&&p.some(l=>i.f(l)||i.h(l))&&this.queueRequest(Date.now(),r)}processRequests(p){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const r=Bt(i.e.ACCESS_TOKEN),l=r?r.u:i.e.ACCESS_TOKEN;let m=l!==this.eventData.tokenU;i.v(this.anonId)||(this.anonId=i.u(),m=!0);const x=this.queue.shift();if(this.eventData.lastSuccess){const b=new Date(this.eventData.lastSuccess),A=new Date(x),R=(x-this.eventData.lastSuccess)/864e5;m=m||R>=1||R<-1||b.getDate()!==A.getDate()}else m=!0;m?this.postEvent(x,{sdkIdentifier:"mapbox-gl-js",sdkVersion:O,skuId:ht,"enabled.telemetry":!1,userId:this.anonId},b=>{b||(this.eventData.lastSuccess=x,this.eventData.tokenU=l)},p):this.processRequests()}},rn=$t.postTurnstileEvent.bind($t),Nt=new class extends et{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(p,r,l,m){this.skuToken=r,this.errorCb=m,i.e.EVENTS_URL&&(l||i.e.ACCESS_TOKEN?this.queueRequest({id:p,timestamp:Date.now()},l):this.errorCb(new Error(gt)))}processRequests(p){if(this.pendingRequest||this.queue.length===0)return;const{id:r,timestamp:l}=this.queue.shift();r&&this.success[r]||(this.anonId||this.fetchEventData(),i.v(this.anonId)||(this.anonId=i.u()),this.postEvent(l,{sdkIdentifier:"mapbox-gl-js",sdkVersion:O,skuId:ht,skuToken:this.skuToken,userId:this.anonId},m=>{m?this.errorCb(m):r&&(this.success[r]=!0)},p))}remove(){this.errorCb=null}},xn=Nt.postMapLoadEvent.bind(Nt),rr=new class extends et{constructor(){super("style.load"),this.eventIdPerMapInstanceMap=new Map,this.mapInstanceIdMap=new WeakMap}getMapInstanceId(p){let r=this.mapInstanceIdMap.get(p);return r||(r=i.u(),this.mapInstanceIdMap.set(p,r)),r}getEventId(p){const r=this.eventIdPerMapInstanceMap.get(p)||0;return this.eventIdPerMapInstanceMap.set(p,r+1),r}postStyleLoadEvent(p,r){const{map:l,style:m,importedStyles:x}=r;if(!i.e.EVENTS_URL||!p&&!i.e.ACCESS_TOKEN)return;const b=this.getMapInstanceId(l),A={mapInstanceId:b,eventId:this.getEventId(b),style:m};x.length&&(A.importedStyles=x),this.queueRequest({timestamp:Date.now(),payload:A},p)}processRequests(p){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:r,payload:l}=this.queue.shift();this.postEvent(r,l,()=>{},p)}},Xn=rr.postStyleLoadEvent.bind(rr),yi=new class extends et{constructor(){super("gljs.performance")}postPerformanceEvent(p,r){i.e.EVENTS_URL&&(p||i.e.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:r},p)}processRequests(p){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:r,performanceData:l}=this.queue.shift(),m=function(x){const b=performance.getEntriesByType("resource"),A=performance.getEntriesByType("mark"),R=function(ee){const ue={};if(ee){for(const oe in ee)if(oe!=="other")for(const de of ee[oe]){const fe=`${oe}ResolveRangeMin`,Te=`${oe}ResolveRangeMax`,Pe=`${oe}RequestCount`,Oe=`${oe}RequestCachedCount`;ue[fe]=Math.min(ue[fe]||1/0,de.startTime),ue[Te]=Math.max(ue[Te]||-1/0,de.responseEnd);const Fe=Re=>{ue[Re]===void 0&&(ue[Re]=0),++ue[Re]};de.transferSize!==void 0&&de.transferSize===0&&Fe(Oe),Fe(Pe)}}return ue}(function(ee,ue){const oe={};if(ee)for(const de of ee){const fe=ue(de);oe[fe]===void 0&&(oe[fe]=[]),oe[fe].push(de)}return oe}(b,F)),N=window.devicePixelRatio,U=navigator.connection||navigator.mozConnection||navigator.webkitConnection,$=U?U.effectiveType:void 0,Z={counters:[],metadata:[],attributes:[]},W=(ee,ue,oe)=>{oe!=null&&ee.push({name:ue,value:oe.toString()})};for(const ee in R)W(Z.counters,ee,R[ee]);if(x.interactionRange[0]!==1/0&&x.interactionRange[1]!==-1/0&&(W(Z.counters,"interactionRangeMin",x.interactionRange[0]),W(Z.counters,"interactionRangeMax",x.interactionRange[1])),A)for(const ee of Object.keys(z)){const ue=z[ee],oe=A.find(de=>de.name===ue);oe&&W(Z.counters,ue,oe.startTime)}return W(Z.counters,"visibilityHidden",x.visibilityHidden),W(Z.attributes,"style",function(ee){if(ee)for(const ue of ee){const oe=ue.name.split("?")[0];if(i.i(oe)){const de=oe.split("/").slice(-2);if(de.length===2)return`mapbox://styles/${de[0]}/${de[1]}`}}}(b)),W(Z.attributes,"terrainEnabled",x.terrainEnabled?"true":"false"),W(Z.attributes,"fogEnabled",x.fogEnabled?"true":"false"),W(Z.attributes,"projection",x.projection),W(Z.attributes,"zoom",x.zoom),W(Z.metadata,"devicePixelRatio",N),W(Z.metadata,"connectionEffectiveType",$),W(Z.metadata,"navigatorUserAgent",navigator.userAgent),W(Z.metadata,"screenWidth",window.screen.width),W(Z.metadata,"screenHeight",window.screen.height),W(Z.metadata,"windowWidth",window.innerWidth),W(Z.metadata,"windowHeight",window.innerHeight),W(Z.metadata,"mapWidth",x.width/N),W(Z.metadata,"mapHeight",x.height/N),W(Z.metadata,"webglRenderer",x.renderer),W(Z.metadata,"webglVendor",x.vendor),W(Z.metadata,"sdkVersion",O),W(Z.metadata,"sdkIdentifier","mapbox-gl-js"),Z}(l);for(const x of m.metadata);for(const x of m.counters);for(const x of m.attributes);this.postEvent(r,m,()=>{},p)}},ir=yi.postPerformanceEvent.bind(yi),yn=new class extends et{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(p,r,l,m){if(!i.e.API_URL||!i.e.SESSION_PATH)return;const x=yt(i.e.API_URL+i.e.SESSION_PATH);x.params.push(`sku=${r||""}`),x.params.push(`access_token=${m||i.e.ACCESS_TOKEN||""}`);const b={url:Vt(x),headers:{"Content-Type":"text/plain"}};this.pendingRequest=i.g(b,A=>{this.pendingRequest=null,l(A),this.saveEventData(),this.processRequests(m)})}getSessionAPI(p,r,l,m){this.skuToken=r,this.errorCb=m,i.e.SESSION_PATH&&i.e.API_URL&&(l||i.e.ACCESS_TOKEN?this.queueRequest({id:p,timestamp:Date.now()},l):this.errorCb(new Error(gt)))}processRequests(p){if(this.pendingRequest||this.queue.length===0)return;const{id:r,timestamp:l}=this.queue.shift();r&&this.success[r]||this.getSession(l,this.skuToken,m=>{m?this.errorCb(m):r&&(this.success[r]=!0)},p)}remove(){this.errorCb=null}},Ne=yn.getSessionAPI.bind(yn),Qn=new Set;function fn(p,r){r?Qn.add(p):Qn.delete(p)}class Dr{constructor(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps=new Set,this._updatedImages=new Set}isDirty(){return this._changed}setDirty(){this._changed=!0}getUpdatedSourceCaches(){return this._updatedSourceCaches}updateSourceCache(r,l){this._updatedSourceCaches[r]=l,this.setDirty()}discardSourceCacheUpdate(r){delete this._updatedSourceCaches[r]}updateLayer(r){const l=r.scope;this._updatedLayers[l]=this._updatedLayers[l]||new Set,this._updatedLayers[l].add(r.id),this.setDirty()}removeLayer(r){const l=r.scope;this._removedLayers[l]=this._removedLayers[l]||{},this._updatedLayers[l]=this._updatedLayers[l]||new Set,this._removedLayers[l][r.id]=r,this._updatedLayers[l].delete(r.id),this._updatedPaintProps.delete(r.fqid),this.setDirty()}getRemovedLayer(r){return this._removedLayers[r.scope]?this._removedLayers[r.scope][r.id]:null}discardLayerRemoval(r){this._removedLayers[r.scope]&&delete this._removedLayers[r.scope][r.id]}getLayerUpdatesByScope(){const r={};for(const l in this._updatedLayers)r[l]=r[l]||{},r[l].updatedIds=Array.from(this._updatedLayers[l].values());for(const l in this._removedLayers)r[l]=r[l]||{},r[l].removedIds=Object.keys(this._removedLayers[l]);return r}getUpdatedPaintProperties(){return this._updatedPaintProps}updatePaintProperties(r){this._updatedPaintProps.add(r.fqid),this.setDirty()}getUpdatedImages(){return Array.from(this._updatedImages.values())}updateImage(r){this._updatedImages.add(r),this.setDirty()}resetUpdatedImages(){this._updatedImages.clear()}reset(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps.clear(),this._updatedImages.clear()}}function It(p){const{userImage:r}=p;return!!(r&&r.render&&r.render())&&(p.data.replace(new Uint8Array(r.data.buffer)),!0)}class Ir extends i.E{constructor(r){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded={},this.requestors=[],this.patterns={},this.atlasImage={},this.atlasTexture={},this.dirty=!0,this.spriteFormat=r,r!=="raster"&&i.t()&&(this.imageRasterizerDispatcher=new i.D(i.x(),this,"Image Rasterizer Worker",1))}get imageRasterizer(){return this._imageRasterizer||(this._imageRasterizer=new i.I),this._imageRasterizer}createScope(r){this.images[r]={},this.loaded[r]=!1,this.updatedImages[r]={},this.patterns[r]={},this.callbackDispatchedThisFrame[r]={},this.atlasImage[r]=new i.r({width:1,height:1})}isLoaded(){for(const r in this.loaded)if(!this.loaded[r])return!1;return!0}setLoaded(r,l){if(this.loaded[l]!==r&&(this.loaded[l]=r,r)){for(const{ids:m,callback:x}of this.requestors)this._notify(m,l,x);this.requestors=[]}}hasImage(r,l){return!!this.getImage(r,l)}getImage(r,l){return this.images[l][r]}addImage(r,l,m){this._validate(r,m)&&(this.images[l][r]=m)}_validate(r,l){let m=!0;return this._validateStretch(l.stretchX,l.data&&l.data.width)||(this.fire(new i.y(new Error(`Image "${r}" has invalid "stretchX" value`))),m=!1),this._validateStretch(l.stretchY,l.data&&l.data.height)||(this.fire(new i.y(new Error(`Image "${r}" has invalid "stretchY" value`))),m=!1),this._validateContent(l.content,l)||(this.fire(new i.y(new Error(`Image "${r}" has invalid "content" value`))),m=!1),m}_validateStretch(r,l){if(!r)return!0;let m=0;for(const x of r){if(x[0]<m||x[1]<x[0]||l<x[1])return!1;m=x[1]}return!0}_validateContent(r,l){return r?r.length!==4||!l.usvg&&(r[0]<0||l.data.width<r[0]||r[1]<0||l.data.height<r[1]||r[2]<0||l.data.width<r[2]||r[3]<0||l.data.height<r[3])?!1:!(r[2]<r[0]||r[3]<r[1]):!0}updateImage(r,l,m){m.version=this.images[l][r].version+1,this.images[l][r]=m,this.updatedImages[l][r]=!0,this.removeFromImageRasterizerCache(r,l)}removeFromImageRasterizerCache(r,l){this.spriteFormat!=="raster"&&(i.t()?this.imageRasterizerDispatcher.getActor().send("removeRasterizedImages",{imageIds:[r],scope:l}):this.imageRasterizer.removeImagesFromCacheByIds([r],l))}removeImage(r,l){const m=this.images[l][r];delete this.images[l][r],delete this.patterns[l][r],this.removeFromImageRasterizerCache(r,l),m.userImage&&m.userImage.onRemove&&m.userImage.onRemove()}listImages(r){return Object.keys(this.images[r])}getImages(r,l,m){let x=!0;const b=!!this.loaded[l];if(!b)for(const A of r)this.images[l][A]||(x=!1);b||x?this._notify(r,l,m):this.requestors.push({ids:r,scope:l,callback:m})}rasterizeImages({scope:r,imageTasks:l},m){const x={};for(const b in l){const A=l[b],R=this.getImage(A.id,r);R&&(x[b]={image:R,imageIdWithOptions:A})}i.t()?this.imageRasterizerDispatcher.getActor().send("rasterizeImages",{imageTasks:x,scope:r},m):this.rasterizeImagesInMainThread({imageTasks:x,scope:r},m)}rasterizeImagesInMainThread(r,l){const{imageTasks:m,scope:x}=r,b={};for(const A in m){const{image:R,imageIdWithOptions:N}=m[A];b[A]=this.imageRasterizer.rasterize(N,R,x,"")}l(void 0,b)}getUpdatedImages(r){return this.updatedImages[r]}_notify(r,l,m){const x={};for(const b of r){this.images[l][b]||this.fire(new i.z("styleimagemissing",{id:b}));const A=this.images[l][b];A?x[b]={data:A.usvg?null:A.data.clone(),pixelRatio:A.pixelRatio,sdf:A.sdf,usvg:A.usvg,version:A.version,stretchX:A.stretchX,stretchY:A.stretchY,content:A.content,hasRenderCallback:!!(A.userImage&&A.userImage.render)}:i.w(`Image "${b}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}m(null,x)}getPixelSize(r){const{width:l,height:m}=this.atlasImage[r];return{width:l,height:m}}getPattern(r,l,m){const x=this.patterns[l][r],b=this.getImage(r,l);if(!b)return null;if(x&&x.position.version===b.version)return x.position;if(x)x.position.version=b.version;else{b.usvg&&!b.data&&(b.data=this.imageRasterizer.rasterize(i.A.from(r).getPrimary(),b,l,""));const A={w:b.data.width+2*i.B,h:b.data.height+2*i.B,x:0,y:0},R=new i.C(A,b,i.B);this.patterns[l][r]={bin:A,position:R}}return this._updatePatternAtlas(l,m),this.patterns[l][r].position}bind(r,l){const m=r.gl;let x=this.atlasTexture[l];x?this.dirty&&(x.update(this.atlasImage[l]),this.dirty=!1):(x=new i.T(r,this.atlasImage[l],m.RGBA8),this.atlasTexture[l]=x),x.bind(m.LINEAR,m.CLAMP_TO_EDGE)}_updatePatternAtlas(r,l){const m=[];for(const R in this.patterns[r])m.push(this.patterns[r][R].bin);const{w:x,h:b}=i.F(m),A=this.atlasImage[r];A.resize({width:x||1,height:b||1});for(const R in this.patterns[r]){const{bin:N,position:U}=this.patterns[r][R];let $=U.padding;const Z=N.x+$,W=N.y+$,ee=this.images[r][R].data,ue=ee.width,oe=ee.height;$=$>1?$-1:$,i.r.copy(ee,A,{x:0,y:0},{x:Z,y:W},{width:ue,height:oe},l),i.r.copy(ee,A,{x:0,y:oe-$},{x:Z,y:W-$},{width:ue,height:$},l),i.r.copy(ee,A,{x:0,y:0},{x:Z,y:W+oe},{width:ue,height:$},l),i.r.copy(ee,A,{x:ue-$,y:0},{x:Z-$,y:W},{width:$,height:oe},l),i.r.copy(ee,A,{x:0,y:0},{x:Z+ue,y:W},{width:$,height:oe},l),i.r.copy(ee,A,{x:ue-$,y:oe-$},{x:Z-$,y:W-$},{width:$,height:$},l),i.r.copy(ee,A,{x:0,y:oe-$},{x:Z+ue,y:W-$},{width:$,height:$},l),i.r.copy(ee,A,{x:0,y:0},{x:Z+ue,y:W+oe},{width:$,height:$},l),i.r.copy(ee,A,{x:ue-$,y:0},{x:Z-$,y:W+oe},{width:$,height:$},l)}this.dirty=!0}beginFrame(){for(const r in this.images)this.callbackDispatchedThisFrame[r]={}}dispatchRenderCallbacks(r,l){for(const m of r){if(this.callbackDispatchedThisFrame[l][m])continue;this.callbackDispatchedThisFrame[l][m]=!0;const x=this.images[l][m];It(x)&&this.updateImage(m,l,x)}}}function Cr(p){const r=p.key,l=p.value,m=p.valueSpec||{},x=p.objectElementValidators||{},b=p.style,A=p.styleSpec;let R=[];const N=i.H(l);if(N!=="object")return[new i.V(r,l,`object expected, ${N} found`)];for(const U in l){const $=U.split(".")[0];let Z;x[$]?Z=x[$]:m[$]?Z=qn:x["*"]?Z=x["*"]:m["*"]&&(Z=qn),Z?R=R.concat(Z({key:(r&&`${r}.`)+U,value:l[U],valueSpec:m[$]||m["*"],style:b,styleSpec:A,object:l,objectKey:U},l)):R.push(new i.G(r,l[U],`unknown property "${U}"`))}for(const U in m)x[U]||m[U].required&&m[U].default===void 0&&l[U]===void 0&&R.push(new i.V(r,l,`missing required property "${U}"`));return R}function ki(p){const r=p.value,l=p.valueSpec,m=p.style,x=p.styleSpec,b=p.key,A=p.arrayElementValidator||qn;if(i.H(r)!=="array")return[new i.V(b,r,`array expected, ${i.H(r)} found`)];if(l.length&&r.length!==l.length)return[new i.V(b,r,`array length ${l.length} expected, length ${r.length} found`)];if(l["min-length"]&&r.length<l["min-length"])return[new i.V(b,r,`array length at least ${l["min-length"]} expected, length ${r.length} found`)];let R={type:l.value,values:l.values,minimum:l.minimum,maximum:l.maximum,function:void 0};x.$version<7&&(R.function=l.function),i.H(l.value)==="object"&&(R=l.value);let N=[];for(let U=0;U<r.length;U++)N=N.concat(A({array:r,arrayIndex:U,value:r[U],valueSpec:R,style:m,styleSpec:x,key:`${b}[${U}]`},!0));return N}function $n(p){const r=p.key,l=p.value,m=p.valueSpec;let x=i.H(l);if(x==="number"&&l!=l&&(x="NaN"),x!=="number")return[new i.V(r,l,`number expected, ${x} found`)];if("minimum"in m){let b=m.minimum;if(i.H(m.minimum)==="array"&&(b=m.minimum[p.arrayIndex]),l<b)return[new i.V(r,l,`${l} is less than the minimum value ${b}`)]}if("maximum"in m){let b=m.maximum;if(i.H(m.maximum)==="array"&&(b=m.maximum[p.arrayIndex]),l>b)return[new i.V(r,l,`${l} is greater than the maximum value ${b}`)]}return[]}function si(p){const r=p.valueSpec,l=i.K(p.value.type);let m,x,b,A={};const R=l!=="categorical"&&p.value.property===void 0,N=!R,U=i.H(p.value.stops)==="array"&&i.H(p.value.stops[0])==="array"&&i.H(p.value.stops[0][0])==="object",$=Cr({key:p.key,value:p.value,valueSpec:p.styleSpec.function,style:p.style,styleSpec:p.styleSpec,objectElementValidators:{stops:function(ee){if(l==="identity")return[new i.V(ee.key,ee.value,'identity function may not have a "stops" property')];let ue=[];const oe=ee.value;return ue=ue.concat(ki({key:ee.key,value:oe,valueSpec:ee.valueSpec,style:ee.style,styleSpec:ee.styleSpec,arrayElementValidator:Z})),i.H(oe)==="array"&&oe.length===0&&ue.push(new i.V(ee.key,oe,"array must have at least one stop")),ue},default:function(ee){return qn({key:ee.key,value:ee.value,valueSpec:r,style:ee.style,styleSpec:ee.styleSpec})}}});return l==="identity"&&R&&$.push(new i.V(p.key,p.value,'missing required property "property"')),l==="identity"||p.value.stops||$.push(new i.V(p.key,p.value,'missing required property "stops"')),l==="exponential"&&p.valueSpec.expression&&!i.L(p.valueSpec)&&$.push(new i.V(p.key,p.value,"exponential functions not supported")),p.styleSpec.$version>=8&&(N&&!i.M(p.valueSpec)?$.push(new i.V(p.key,p.value,"property functions not supported")):R&&!i.N(p.valueSpec)&&$.push(new i.V(p.key,p.value,"zoom functions not supported"))),l!=="categorical"&&!U||p.value.property!==void 0||$.push(new i.V(p.key,p.value,'"property" property is required')),$;function Z(ee){let ue=[];const oe=ee.value,de=ee.key;if(i.H(oe)!=="array")return[new i.V(de,oe,`array expected, ${i.H(oe)} found`)];if(oe.length!==2)return[new i.V(de,oe,`array length 2 expected, length ${oe.length} found`)];if(U){if(i.H(oe[0])!=="object")return[new i.V(de,oe,`object expected, ${i.H(oe[0])} found`)];if(oe[0].zoom===void 0)return[new i.V(de,oe,"object stop key must have zoom")];if(oe[0].value===void 0)return[new i.V(de,oe,"object stop key must have value")];const fe=i.K(oe[0].zoom);if(typeof fe!="number")return[new i.V(de,oe[0].zoom,"stop zoom values must be numbers")];if(b&&b>fe)return[new i.V(de,oe[0].zoom,"stop zoom values must appear in ascending order")];fe!==b&&(b=fe,x=void 0,A={}),ue=ue.concat(Cr({key:`${de}[0]`,value:oe[0],valueSpec:{zoom:{}},style:ee.style,styleSpec:ee.styleSpec,objectElementValidators:{zoom:$n,value:W}}))}else ue=ue.concat(W({key:`${de}[0]`,value:oe[0],style:ee.style,styleSpec:ee.styleSpec},oe));return i.O(i.Q(oe[1]))?ue.concat([new i.V(`${de}[1]`,oe[1],"expressions are not allowed in function stops.")]):ue.concat(qn({key:`${de}[1]`,value:oe[1],valueSpec:r,style:ee.style,styleSpec:ee.styleSpec}))}function W(ee,ue){const oe=i.H(ee.value),de=i.K(ee.value),fe=ee.value!==null?ee.value:ue;if(m){if(oe!==m)return[new i.V(ee.key,fe,`${oe} stop domain type must match previous stop domain type ${m}`)]}else m=oe;if(oe!=="number"&&oe!=="string"&&oe!=="boolean"&&typeof de!="number"&&typeof de!="string"&&typeof de!="boolean")return[new i.V(ee.key,fe,"stop domain value must be a number, string, or boolean")];if(oe!=="number"&&l!=="categorical"){let Te=`number expected, ${oe} found`;return i.M(r)&&l===void 0&&(Te+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new i.V(ee.key,fe,Te)]}return l!=="categorical"||oe!=="number"||typeof de=="number"&&isFinite(de)&&Math.floor(de)===de?l!=="categorical"&&oe==="number"&&typeof de=="number"&&typeof x=="number"&&x!==void 0&&de<x?[new i.V(ee.key,fe,"stop domain values must appear in ascending order")]:(x=de,l==="categorical"&&de in A?[new i.V(ee.key,fe,"stop domain values must be unique")]:(A[de]=!0,[])):[new i.V(ee.key,fe,`integer expected, found ${String(de)}`)]}}function ca(p){const r=(p.expressionContext==="property"?i.S:i.U)(i.Q(p.value),p.valueSpec);if(r.result==="error")return r.value.map(m=>new i.V(`${p.key}${m.key}`,p.value,m.message));const l=r.value.expression||r.value._styleExpression.expression;if(p.expressionContext==="property"&&p.propertyKey==="text-font"&&!l.outputDefined())return[new i.V(p.key,p.value,`Invalid data expression for "${p.propertyKey}". Output values must be contained as literals within the expression.`)];if(p.expressionContext==="property"&&p.propertyType==="layout"&&!i.W(l))return[new i.V(p.key,p.value,'"feature-state" data expressions are not supported with layout properties.')];if(p.expressionContext==="filter")return Aa(l,p);if(p.expressionContext&&p.expressionContext.indexOf("cluster")===0){if(!i.X(l,["zoom","feature-state"]))return[new i.V(p.key,p.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(p.expressionContext==="cluster-initial"&&!i.Y(l))return[new i.V(p.key,p.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Aa(p,r){const l=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(r.valueSpec&&r.valueSpec.expression)for(const x of r.valueSpec.expression.parameters)l.delete(x);if(l.size===0)return[];const m=[];return p instanceof i.Z&&l.has(p.name)?[new i.V(r.key,r.value,`["${p.name}"] expression is not supported in a filter for a ${r.object.type} layer with id: ${r.object.id}`)]:(p.eachChild(x=>{m.push(...Aa(x,r))}),m)}function ao(p){const r=p.key,l=p.value,m=p.valueSpec,x=[];return Array.isArray(m.values)?m.values.indexOf(i.K(l))===-1&&x.push(new i.V(r,l,`expected one of [${m.values.join(", ")}], ${JSON.stringify(l)} found`)):Object.keys(m.values).indexOf(i.K(l))===-1&&x.push(new i.V(r,l,`expected one of [${Object.keys(m.values).join(", ")}], ${JSON.stringify(l)} found`)),x}function Ss(p){return i.$(i.Q(p.value))?ca(i.J({},p,{expressionContext:"filter",valueSpec:p.styleSpec[`filter_${p.layerType||"fill"}`]})):Bn(p)}function Bn(p){const r=p.value,l=p.key;if(i.H(r)!=="array")return[new i.V(l,r,`array expected, ${i.H(r)} found`)];const m=p.styleSpec;let x,b=[];if(r.length<1)return[new i.V(l,r,"filter array must have at least 1 element")];switch(b=b.concat(ao({key:`${l}[0]`,value:r[0],valueSpec:m.filter_operator,style:p.style,styleSpec:p.styleSpec})),i.K(r[0])){case"<":case"<=":case">":case">=":r.length>=2&&i.K(r[1])==="$type"&&b.push(new i.V(l,r,`"$type" cannot be use with operator "${r[0]}"`));case"==":case"!=":r.length!==3&&b.push(new i.V(l,r,`filter array for operator "${r[0]}" must have 3 elements`));case"in":case"!in":r.length>=2&&(x=i.H(r[1]),x!=="string"&&b.push(new i.V(`${l}[1]`,r[1],`string expected, ${x} found`)));for(let A=2;A<r.length;A++)x=i.H(r[A]),i.K(r[1])==="$type"?b=b.concat(ao({key:`${l}[${A}]`,value:r[A],valueSpec:m.geometry_type,style:p.style,styleSpec:p.styleSpec})):x!=="string"&&x!=="number"&&x!=="boolean"&&b.push(new i.V(`${l}[${A}]`,r[A],`string, number, or boolean expected, ${x} found`));break;case"any":case"all":case"none":for(let A=1;A<r.length;A++)b=b.concat(Bn({key:`${l}[${A}]`,value:r[A],style:p.style,styleSpec:p.styleSpec}));break;case"has":case"!has":x=i.H(r[1]),r.length!==2?b.push(new i.V(l,r,`filter array for "${r[0]}" operator must have 2 elements`)):x!=="string"&&b.push(new i.V(`${l}[1]`,r[1],`string expected, ${x} found`))}return b}function Lo(p,r){const l=p.key,m=p.style,x=p.layer,b=p.styleSpec,A=p.value,R=p.objectKey,N=b[`${r}_${p.layerType}`];if(!N)return[];const U=R.match(/^(.*)-use-theme$/);if(r==="paint"&&U&&N[U[1]])return i.O(A)?[].concat(qn({key:p.key,value:A,valueSpec:{type:"string",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},style:m,styleSpec:b,expressionContext:"property",propertyType:r,propertyKey:R})):qn({key:l,value:A,valueSpec:{type:"string"},style:m,styleSpec:b});const $=R.match(/^(.*)-transition$/);if(r==="paint"&&$&&N[$[1]]&&N[$[1]].transition)return qn({key:l,value:A,valueSpec:b.transition,style:m,styleSpec:b});const Z=p.valueSpec||N[R];if(!Z)return[new i.G(l,A,`unknown property "${R}"`)];let W;if(i.H(A)==="string"&&i.M(Z)&&!Z.tokens&&(W=/^{([^}]+)}$/.exec(A))){const ue=`\`{ "type": "identity", "property": ${W?JSON.stringify(W[1]):'"_"'} }\``;return[new i.V(l,A,`"${R}" does not support interpolation syntax
Use an identity property function instead: ${ue}.`)]}const ee=[];if(p.layerType==="symbol")R!=="text-field"||!m||m.glyphs||m.imports||ee.push(new i.V(l,A,'use of "text-field" requires a style "glyphs" property')),R==="text-font"&&i.a0(i.Q(A))&&i.K(A.type)==="identity"&&ee.push(new i.V(l,A,'"text-font" does not support identity functions'));else if(p.layerType==="model"&&r==="paint"&&x&&x.layout&&x.layout.hasOwnProperty("model-id")&&i.M(Z)&&(i.a1(Z)||i.N(Z))){const ue=i.S(i.Q(A),Z),oe=ue.value.expression||ue.value._styleExpression.expression;oe&&!i.X(oe,["measure-light"])&&(R==="model-emissive-strength"&&i.Y(oe)&&i.W(oe)||ee.push(new i.V(l,A,`${R} does not support measure-light expressions when the model layer source is vector tile or GeoJSON.`)))}return ee.concat(qn({key:p.key,value:A,valueSpec:Z,style:m,styleSpec:b,expressionContext:"property",propertyType:r,propertyKey:R}))}function Jo(p){return Lo(p,"paint")}function ml(p){return Lo(p,"layout")}function ua(p){let r=[];const l=p.value,m=p.key,x=p.style,b=p.styleSpec;l.type||l.ref||r.push(new i.V(m,l,'either "type" or "ref" is required'));let A=i.K(l.type);const R=i.K(l.ref);if(l.id){const N=i.K(l.id);for(let U=0;U<p.arrayIndex;U++){const $=x.layers[U];i.K($.id)===N&&r.push(new i.V(m,l.id,`duplicate layer id "${l.id}", previously used at line ${$.id.__line__}`))}}if("ref"in l){let N;["type","source","source-layer","filter","layout"].forEach(U=>{U in l&&r.push(new i.V(m,l[U],`"${U}" is prohibited for ref layers`))}),x.layers.forEach(U=>{i.K(U.id)===R&&(N=U)}),N?N.ref?r.push(new i.V(m,l.ref,"ref cannot reference another ref layer")):A=i.K(N.type):typeof R=="string"&&r.push(new i.V(m,l.ref,`ref layer "${R}" not found`))}else if(A!=="background"&&A!=="sky"&&A!=="slot")if(l.source){const N=x.sources&&x.sources[l.source],U=N&&i.K(N.type);N?U==="vector"&&A==="raster"?r.push(new i.V(m,l.source,`layer "${l.id}" requires a raster source`)):U==="raster"&&A!=="raster"?r.push(new i.V(m,l.source,`layer "${l.id}" requires a vector source`)):U!=="vector"||l["source-layer"]?U==="raster-dem"&&A!=="hillshade"?r.push(new i.V(m,l.source,"raster-dem source can only be used with layer type 'hillshade'.")):U!=="raster-array"||["raster","raster-particle"].includes(A)?A!=="line"||!l.paint||!l.paint["line-gradient"]&&!l.paint["line-trim-offset"]||U==="geojson"&&N.lineMetrics?A==="raster-particle"&&U!=="raster-array"&&r.push(new i.V(m,l.source,`layer "${l.id}" requires a 'raster-array' source.`)):r.push(new i.V(m,l,`layer "${l.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):r.push(new i.V(m,l.source,"raster-array source can only be used with layer type 'raster'.")):r.push(new i.V(m,l,`layer "${l.id}" must specify a "source-layer"`)):r.push(new i.V(m,l.source,`source "${l.source}" not found`))}else r.push(new i.V(m,l,'missing required property "source"'));return r=r.concat(Cr({key:m,value:l,valueSpec:b.layer,style:p.style,styleSpec:p.styleSpec,objectElementValidators:{"*":()=>[],type:()=>qn({key:`${m}.type`,value:l.type,valueSpec:b.layer.type,style:p.style,styleSpec:p.styleSpec,object:l,objectKey:"type"}),filter:N=>Ss(i.J({layerType:A},N)),layout:N=>Cr({layer:l,key:N.key,value:N.value,valueSpec:{},style:N.style,styleSpec:N.styleSpec,objectElementValidators:{"*":U=>ml(i.J({layerType:A},U))}}),paint:N=>Cr({layer:l,key:N.key,value:N.value,valueSpec:{},style:N.style,styleSpec:N.styleSpec,objectElementValidators:{"*":U=>Jo(i.J({layerType:A,layer:l},U))}})}})),r}function _l(p){const r=p.value,l=p.key,m=i.H(r);return m!=="string"?[new i.V(l,r,`string expected, ${m} found`)]:[]}const nc={promoteId:function p({key:r,value:l}){if(i.H(l)==="string")return _l({key:r,value:l});if(Array.isArray(l)){const m=[],x=i.Q(l),b=i.U(x);return b.result==="error"&&b.value.forEach(A=>{m.push(new i.V(`${r}${A.key}`,null,`${A.message}`))}),i.X(b.value.expression,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])||m.push(new i.V(`${r}`,null,"promoteId expression should be only feature dependent")),m}{const m=[];for(const x in l)m.push(...p({key:`${r}.${x}`,value:l[x]}));return m}}};function Yu(p){const r=p.value,l=p.key,m=p.styleSpec,x=p.style;if(!r.type)return[new i.V(l,r,'"type" is required')];const b=i.K(r.type);let A=[];switch(["vector","raster","raster-dem","raster-array"].includes(b)&&(r.url||r.tiles||A.push(new i.G(l,r,'Either "url" or "tiles" is required.'))),b){case"vector":case"raster":case"raster-dem":case"raster-array":return A=A.concat(Cr({key:l,value:r,valueSpec:m[`source_${b.replace("-","_")}`],style:p.style,styleSpec:m,objectElementValidators:nc})),A;case"geojson":if(A=Cr({key:l,value:r,valueSpec:m.source_geojson,style:x,styleSpec:m,objectElementValidators:nc}),r.cluster)for(const R in r.clusterProperties){const[N,U]=r.clusterProperties[R],$=typeof N=="string"?[N,["accumulated"],["get",R]]:N;A.push(...ca({key:`${l}.${R}.map`,value:U,expressionContext:"cluster-map"})),A.push(...ca({key:`${l}.${R}.reduce`,value:$,expressionContext:"cluster-reduce"}))}return A;case"video":return Cr({key:l,value:r,valueSpec:m.source_video,style:x,styleSpec:m});case"image":return Cr({key:l,value:r,valueSpec:m.source_image,style:x,styleSpec:m});case"canvas":return[new i.V(l,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return ao({key:`${l}.type`,value:r.type,valueSpec:{values:Ku(m)}})}}function Ku(p){return p.source.reduce((r,l)=>{const m=p[l];return m.type.type==="enum"&&(r=r.concat(Object.keys(m.type.values))),r},[])}function ha(p){const r=p.value,l=p.styleSpec,m=l.light,x=p.style;let b=[];const A=i.H(r);if(r===void 0)return b;if(A!=="object")return b=b.concat([new i.V("light",r,`object expected, ${A} found`)]),b;for(const R in r){const N=R.match(/^(.*)-transition$/),U=R.match(/^(.*)-use-theme$/);b=b.concat(U&&m[U[1]]?qn({key:R,value:r[R],valueSpec:{type:"string"},style:x,styleSpec:l}):N&&m[N[1]]&&m[N[1]].transition?qn({key:R,value:r[R],valueSpec:l.transition,style:x,styleSpec:l}):m[R]?qn({key:R,value:r[R],valueSpec:m[R],style:x,styleSpec:l}):[new i.V(R,r[R],`unknown property "${R}"`)])}return b}function Ca(p){const r=p.value;let l=[];if(!r)return l;const m=i.H(r);if(m!=="object")return l=l.concat([new i.V("light-3d",r,`object expected, ${m} found`)]),l;const x=p.styleSpec,b=x["light-3d"],A=p.key,R=p.style,N=p.style.lights;for(const Z of["type","id"])if(!(Z in r))return l=l.concat([new i.V("light-3d",r,`missing property ${Z} on light`)]),l;if(r.type&&N)for(let Z=0;Z<p.arrayIndex;Z++){const W=i.K(r.type),ee=N[Z];i.K(ee.type)===W&&l.push(new i.V(A,r.id,`duplicate light type "${r.type}", previously defined at line ${ee.id.__line__}`))}const U=`properties_light_${r.type}`;if(!(U in x))return l=l.concat([new i.V("light-3d",r,`Invalid light type ${r.type}`)]),l;const $=x[U];for(const Z in r)if(Z==="properties"){const W=r[Z],ee=i.H(W);if(ee!=="object")return l=l.concat([new i.V("properties",W,`object expected, ${ee} found`)]),l;for(const ue in W)l=l.concat($[ue]?qn({key:ue,value:W[ue],valueSpec:$[ue],style:R,styleSpec:x}):[new i.G(p.key,W[ue],`unknown property "${ue}"`)])}else{const W=Z.match(/^(.*)-transition$/),ee=Z.match(/^(.*)-use-theme$/);l=l.concat(ee&&b[ee[1]]?qn({key:Z,value:r[Z],valueSpec:{type:"string"},style:R,styleSpec:x}):W&&b[W[1]]&&b[W[1]].transition?qn({key:Z,value:r[Z],valueSpec:x.transition,style:R,styleSpec:x}):b[Z]?qn({key:Z,value:r[Z],valueSpec:b[Z],style:R,styleSpec:x}):[new i.G(Z,r[Z],`unknown property "${Z}"`)])}return l}function Ju(p){const r=p.value,l=p.key,m=p.style,x=p.styleSpec,b=x.terrain;let A=[];const R=i.H(r);if(r===void 0||R==="null")return A;if(R!=="object")return A=A.concat([new i.V("terrain",r,`object expected, ${R} found`)]),A;for(const N in r){const U=N.match(/^(.*)-transition$/),$=N.match(/^(.*)-use-theme$/);A=A.concat($&&b[$[1]]?qn({key:N,value:r[N],valueSpec:{type:"string"},style:m,styleSpec:x}):U&&b[U[1]]&&b[U[1]].transition?qn({key:N,value:r[N],valueSpec:x.transition,style:m,styleSpec:x}):b[N]?qn({key:N,value:r[N],valueSpec:b[N],style:m,styleSpec:x}):[new i.G(N,r[N],`unknown property "${N}"`)])}if(r.source){const N=m.sources&&m.sources[r.source],U=N&&i.K(N.type);N?U!=="raster-dem"&&A.push(new i.V(l,r.source,`terrain cannot be used with a source of type ${String(U)}, it only be used with a "raster-dem" source type`)):A.push(new i.V(l,r.source,`source "${r.source}" not found`))}else A.push(new i.V(l,r,'terrain is missing required property "source"'));return A}function ea(p){const r=p.value,l=p.style,m=p.styleSpec,x=m.fog;let b=[];const A=i.H(r);if(r===void 0)return b;if(A!=="object")return b=b.concat([new i.V("fog",r,`object expected, ${A} found`)]),b;for(const R in r){const N=R.match(/^(.*)-transition$/),U=R.match(/^(.*)-use-theme$/);b=b.concat(U&&x[U[1]]?qn({key:R,value:r[R],valueSpec:{type:"string"},style:l,styleSpec:m}):N&&x[N[1]]&&x[N[1]].transition?qn({key:R,value:r[R],valueSpec:m.transition,style:l,styleSpec:m}):x[R]?qn({key:R,value:r[R],valueSpec:x[R],style:l,styleSpec:m}):[new i.G(R,r[R],`unknown property "${R}"`)])}return b}const fa={"*":()=>[],array:ki,boolean:function(p){const r=p.value,l=p.key,m=i.H(r);return m!=="boolean"?[new i.V(l,r,`boolean expected, ${m} found`)]:[]},number:$n,color:function(p){const r=p.key,l=p.value,m=i.H(l);return m!=="string"?[new i.V(r,l,`color expected, ${m} found`)]:i._.parseCSSColor(l)===null?[new i.V(r,l,`color expected, "${l}" found`)]:[]},enum:ao,filter:Ss,function:si,layer:ua,object:Cr,source:Yu,model:i.a2,light:ha,"light-3d":Ca,terrain:Ju,fog:ea,string:_l,formatted:function(p){return _l(p).length===0?[]:ca(p)},resolvedImage:function(p){return _l(p).length===0?[]:ca(p)},projection:function(p){const r=p.value,l=p.styleSpec,m=l.projection,x=p.style;let b=[];const A=i.H(r);if(A==="object")for(const R in r)b=b.concat(qn({key:R,value:r[R],valueSpec:m[R],style:x,styleSpec:l}));else A!=="string"&&(b=b.concat([new i.V("projection",r,`object or string expected, ${A} found`)]));return b},import:function(p){const{value:r,styleSpec:l}=p,{data:m,...x}=r;Object.defineProperty(x,"__line__",{value:r.__line__,enumerable:!1});let b=Cr(i.J({},p,{value:x,valueSpec:l.import}));return i.K(x.id)===""&&b.push(new i.V(`${p.key}.id`,x,"import id can't be an empty string")),m&&(b=b.concat(zd(m,l,{key:`${p.key}.data`}))),b}};function qn(p,r=!1){const l=p.value,m=p.valueSpec,x=p.styleSpec;if(m.expression&&i.a0(i.K(l)))return si(p);if(m.expression&&i.O(i.Q(l)))return ca(p);if(m.type&&fa[m.type]){const b=fa[m.type](p);return r===!0&&b.length>0&&i.H(p.value)==="array"?ca(p):b}return Cr(i.J({},p,{valueSpec:m.type?x[m.type]:m}))}function Hs(p){const r=p.value,l=p.key,m=_l(p);return m.length||(r.indexOf("{fontstack}")===-1&&m.push(new i.V(l,r,'"glyphs" url must include a "{fontstack}" token')),r.indexOf("{range}")===-1&&m.push(new i.V(l,r,'"glyphs" url must include a "{range}" token'))),m}function zd(p,r=i.a3,l={}){return qn({key:l.key||"",value:p,valueSpec:r.$root,styleSpec:r,style:p,objectElementValidators:{glyphs:Hs,"*":()=>[]}})}function $a(p,r=i.a3){return da(zd(p,r))}const Qo=p=>da(Yu(p)),es=p=>da(ha(p)),gl=p=>da(Ca(p)),Zs=p=>da(Ju(p)),kd=p=>da(ea(p)),au=p=>da(function(r){const l=r.value,m=r.style,x=r.styleSpec,b=x.snow;let A=[];const R=i.H(l);if(l===void 0)return A;if(R!=="object")return A=A.concat([new i.V("snow",l,`object expected, ${R} found`)]),A;for(const N in l){const U=N.match(/^(.*)-transition$/);A=A.concat(U&&b[U[1]]&&b[U[1]].transition?qn({key:N,value:l[N],valueSpec:x.transition,style:m,styleSpec:x}):b[N]?qn({key:N,value:l[N],valueSpec:b[N],style:m,styleSpec:x}):[new i.G(N,l[N],`unknown property "${N}"`)])}return A}(p)),lf=p=>da(function(r){const l=r.value,m=r.style,x=r.styleSpec,b=x.rain;let A=[];const R=i.H(l);if(l===void 0)return A;if(R!=="object")return A=A.concat([new i.V("rain",l,`object expected, ${R} found`)]),A;for(const N in l){const U=N.match(/^(.*)-transition$/);A=A.concat(U&&b[U[1]]&&b[U[1]].transition?qn({key:N,value:l[N],valueSpec:x.transition,style:m,styleSpec:x}):b[N]?qn({key:N,value:l[N],valueSpec:b[N],style:m,styleSpec:x}):[new i.G(N,l[N],`unknown property "${N}"`)])}return A}(p)),Qu=p=>da(ua(p)),vi=p=>da(Ss(p)),cf=p=>da(Jo(p)),uf=p=>da(ml(p)),eh=p=>da(i.a2(p));function da(p){return p.slice().sort((r,l)=>r.line&&l.line?r.line-l.line:0)}function Ts(p,r){let l=!1;if(r&&r.length)for(const m of r)m instanceof i.G?i.w(m.message):(p.fire(new i.y(new Error(m.message))),l=!0);return l}let dt;class le extends i.E{constructor(r,l="flat"){super(),this._transitionable=new i.a4(dt||(dt=new i.a5({anchor:new i.a6(i.a3.light.anchor),position:new i.a7(i.a3.light.position),color:new i.a6(i.a3.light.color),intensity:new i.a6(i.a3.light.intensity)}))),this.setLight(r,l),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(r,l,m={}){this._validate(es,r,m)||(this._transitionable.setTransitionOrValue(r),this.id=l)}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}_validate(r,l,m){return(!m||m.validate!==!1)&&Ts(this,r.call($a,i.l({value:l,style:{glyphs:!0,sprite:!0},styleSpec:i.a3})))}}let pe=class extends i.E{constructor(p,r,l,m){super(),this.scope=l,this._transitionable=new i.a4(new i.a5({source:new i.a6(i.a3.terrain.source),exaggeration:new i.a6(i.a3.terrain.exaggeration)}),l,m),this._transitionable.setTransitionOrValue(p,m),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=r}get(){return this._transitionable.serialize()}set(p,r){this._transitionable.setTransitionOrValue(p,r)}updateTransitions(p){this._transitioning=this._transitionable.transitioned(p,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(p){this.properties=this._transitioning.possiblyEvaluate(p)}getExaggeration(p){return this._transitioning.possiblyEvaluate(new i.a8(p)).get("exaggeration")}getAttenuationRange(){if(!this.isZoomDependent())return null;const p=this._transitionable._values.exaggeration;if(!p)return null;const r=p.value.expression;if(!r)return null;let l=-1,m=-1,x=1;for(const b of r.zoomStops)x=r.evaluate(new i.a8(b)),x>.01?(l=b,m=-1):m=b;return x<.01&&l>0&&m>l?[l,m]:null}isZoomDependent(){const p=this._transitionable._values.exaggeration;return p!=null&&p.value!=null&&p.value.expression!=null&&p.value.expression instanceof i.a9}};const we=45,ze=65,je=.05;function We(p,r,l,m){const x=i.ac(we,ze,l),[b,A]=it(p,m);let R=1-Math.min(1,Math.exp((r-b)/(A-b)*-6));return R*=R*R,R=Math.min(1,1.00747*R),R*x*p.alpha}function it(p,r){const l=.5/Math.tan(.5*r);return[p.range[0]+l,p.range[1]+l]}function Ye(p,r,l,m,x){const b=i.ab.vec3.transformMat4([],[r,l,m],x.mercatorFogMatrix);return We(p,i.ab.vec3.length(b),x.pitch,x._fov)}function ct(p,r,l,m,x,b,A){const R=[[l,m,0],[x,m,0],[x,b,0],[l,b,0]];let N=Number.MAX_VALUE,U=-Number.MAX_VALUE;for(const $ of R){const Z=i.ab.vec3.transformMat4([],$,r),W=i.ab.vec3.length(Z);N=Math.min(N,W),U=Math.max(U,W)}return[We(p,N,A.pitch,A._fov),We(p,U,A.pitch,A._fov)]}class lt extends i.E{constructor(r,l,m,x){super();const b=new i.a5({range:new i.a6(i.a3.fog.range),color:new i.a6(i.a3.fog.color),"color-use-theme":new i.a6({type:"string","property-type":"data-constant",default:"default"}),"high-color":new i.a6(i.a3.fog["high-color"]),"high-color-use-theme":new i.a6({type:"string","property-type":"data-constant",default:"default"}),"space-color":new i.a6(i.a3.fog["space-color"]),"space-color-use-theme":new i.a6({type:"string","property-type":"data-constant",default:"default"}),"horizon-blend":new i.a6(i.a3.fog["horizon-blend"]),"star-intensity":new i.a6(i.a3.fog["star-intensity"]),"vertical-range":new i.a6(i.a3.fog["vertical-range"])});this._transitionable=new i.a4(b,m,new Map(x)),this.set(r,x),this._transitioning=this._transitionable.untransitioned(),this._transform=l,this.properties=new i.ad(b),this.scope=m}get state(){const r=this._transform,l=r.projection.name==="globe",m=i.ae(r.zoom),x=this.properties.get("range"),b=[.5,3];return{range:l?[i.af(b[0],x[0],m),i.af(b[1],x[1],m)]:x,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(r,l,m={}){if(this._validate(kd,r,m))return;const x=i.l({},r);for(const b of Object.keys(i.a3.fog))x[b]===void 0&&(x[b]=i.a3.fog[b].default);this._options=x,this._transitionable.setTransitionOrValue(this._options,l)}getOpacity(r){if(!this._transform.projection.supportsFog)return 0;const l=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:i.ac(we,ze,r))*l.a}getOpacityAtLatLng(r,l){return this._transform.projection.supportsFog?function(m,x,b){const A=i.aa.fromLngLat(x),R=b.elevation?b.elevation.getAtPointOrZero(A):0;return Ye(m,A.x,A.y,R,b)}(this.state,r,l):0}getOpacityForTile(r){if(!this._transform.projection.supportsFog)return[1,1];const l=this._transform.calculateFogTileMatrix(r.toUnwrapped());return ct(this.state,l,0,0,i.ag,i.ag,this._transform)}getOpacityForBounds(r,l,m,x,b){return this._transform.projection.supportsFog?ct(this.state,r,l,m,x,b,this._transform):[1,1]}getFovAdjustedRange(r){return this._transform.projection.supportsFog?it(this.state,r):[0,1]}isVisibleOnFrustum(r){if(!this._transform.projection.supportsFog)return!1;const l=[4,5,6,7];for(const m of l){const x=r.points[m];let b;if(x[2]>=0)b=x;else{const A=r.points[m-4];b=i.ah(A,x,A[2]/(A[2]-x[2]))}if(Ye(this.state,b[0],b[1],0,this._transform)>=je)return!0}return!1}updateConfig(r){this._transitionable.setTransitionOrValue(this._options,new Map(r))}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}_validate(r,l,m){return(!m||m.validate!==!1)&&Ts(this,r.call($a,i.l({value:l,style:{glyphs:!0,sprite:!0},styleSpec:i.a3})))}}let ut,Ct,Zt,Xt,gn=class extends i.E{constructor(p,r,l,m){super();const x=ut||(ut=new i.a5({density:new i.a6(i.a3.snow.density),intensity:new i.a6(i.a3.snow.intensity),color:new i.a6(i.a3.snow.color),opacity:new i.a6(i.a3.snow.opacity),vignette:new i.a6(i.a3.snow.vignette),"vignette-color":new i.a6(i.a3.snow["vignette-color"]),"center-thinning":new i.a6(i.a3.snow["center-thinning"]),direction:new i.a6(i.a3.snow.direction),"flake-size":new i.a6(i.a3.snow["flake-size"])}));this._transitionable=new i.a4(x,l,new Map(m)),this.set(p,m),this._transitioning=this._transitionable.untransitioned(),this.properties=new i.ad(x),this.scope=l}get state(){const p=this.properties.get("opacity"),r=this.properties.get("color"),l=this.properties.get("direction"),m=i.ai(l[0]),x=-Math.max(i.ai(l[1]),.01),b=[Math.cos(m)*Math.cos(x),Math.sin(m)*Math.cos(x),Math.sin(x)],A=this.properties.get("vignette"),R=this.properties.get("vignette-color");return R.a=A,{density:this.properties.get("density"),intensity:this.properties.get("intensity"),color:new i.aj(r.r,r.g,r.b,r.a*p),direction:b,centerThinning:this.properties.get("center-thinning"),flakeSize:this.properties.get("flake-size"),vignetteColor:R}}get(){return this._transitionable.serialize()}set(p,r,l={}){if(this._validate(au,p,l))return;const m=i.l({},p);for(const x of Object.keys(i.a3.snow))m[x]===void 0&&(m[x]=i.a3.snow[x].default);this._options=m,this._transitionable.setTransitionOrValue(this._options,r)}updateConfig(p){this._transitionable.setTransitionOrValue(this._options,new Map(p))}updateTransitions(p){this._transitioning=this._transitionable.transitioned(p,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(p){this.properties=this._transitioning.possiblyEvaluate(p)}_validate(p,r,l){return(!l||l.validate!==!1)&&Ts(this,p.call($a,i.l({value:r,style:{glyphs:!0,sprite:!0},styleSpec:i.a3})))}},Cn=class extends i.E{constructor(p,r,l,m){super();const x=Ct||(Ct=new i.a5({density:new i.a6(i.a3.rain.density),intensity:new i.a6(i.a3.rain.intensity),color:new i.a6(i.a3.rain.color),opacity:new i.a6(i.a3.rain.opacity),vignette:new i.a6(i.a3.rain.vignette),"vignette-color":new i.a6(i.a3.rain["vignette-color"]),"center-thinning":new i.a6(i.a3.rain["center-thinning"]),direction:new i.a6(i.a3.rain.direction),"droplet-size":new i.a6(i.a3.rain["droplet-size"]),"distortion-strength":new i.a6(i.a3.rain["distortion-strength"])}));this._transitionable=new i.a4(x,l,new Map(m)),this.set(p,m),this._transitioning=this._transitionable.untransitioned(),this.properties=new i.ad(x),this.scope=l}get state(){const p=this.properties.get("opacity"),r=this.properties.get("color"),l=this.properties.get("direction"),m=i.ai(l[0]),x=-Math.max(i.ai(l[1]),.01),b=[Math.cos(m)*Math.cos(x),Math.sin(m)*Math.cos(x),Math.sin(x)],A=this.properties.get("vignette-color");return A.a=this.properties.get("vignette"),{density:this.properties.get("density"),intensity:this.properties.get("intensity"),color:new i.aj(r.r,r.g,r.b,r.a*p),direction:b,centerThinning:this.properties.get("center-thinning"),dropletSize:this.properties.get("droplet-size"),distortionStrength:this.properties.get("distortion-strength"),vignetteColor:A}}get(){return this._transitionable.serialize()}set(p,r,l={}){if(this._validate(lf,p,l))return;const m=i.l({},p);for(const x of Object.keys(i.a3.rain))m[x]===void 0&&(m[x]=i.a3.rain[x].default);this._options=m,this._transitionable.setTransitionOrValue(this._options,r)}updateConfig(p){this._transitionable.setTransitionOrValue(this._options,new Map(p))}updateTransitions(p){this._transitioning=this._transitionable.transitioned(p,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(p){this.properties=this._transitioning.possiblyEvaluate(p)}_validate(p,r,l){return(!l||l.validate!==!1)&&Ts(this,p.call($a,i.l({value:r,style:{glyphs:!0,sprite:!0},styleSpec:i.a3})))}};class On extends i.E{constructor(r,l,m,x){super(),this.scope=m,this._options=r,this.properties=new i.ad(l),this._transitionable=new i.a4(l,m,new Map(x)),this._transitionable.setTransitionOrValue(r.properties),this._transitioning=this._transitionable.untransitioned()}updateConfig(r){this._transitionable.setTransitionOrValue(this._options.properties,new Map(r))}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}get(){return this._options.properties=this._transitionable.serialize(),this._options}set(r,l){this._options=r,this._transitionable.setTransitionOrValue(r.properties,l)}shadowsEnabled(){return!!this.properties&&this.properties.get("cast-shadows")===!0}}class wn{constructor(r,l,m,x){this.screenBounds=r,this.cameraPoint=l,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=m,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,x)}static createFromScreenPoints(r,l){let m,x;if(r instanceof i.P||typeof r[0]=="number"){const b=i.P.convert(r);m=[b],x=l.isPointAboveHorizon(b)}else{const b=i.P.convert(r[0]),A=i.P.convert(r[1]);m=[b,A],x=i.al(b,A).every(R=>l.isPointAboveHorizon(R))}return new wn(m,l.getCameraPoint(),x,l)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(r){return i.al(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],r)}bufferedCameraGeometry(r){const l=this.screenBounds[0],m=this.screenBounds.length===1?this.screenBounds[0].add(new i.P(1,1)):this.screenBounds[1],x=i.al(l,m,0,!1);return this.cameraPoint.y>m.y&&(this.cameraPoint.x>l.x&&this.cameraPoint.x<m.x?x.splice(3,0,this.cameraPoint):this.cameraPoint.x>=m.x?x[2]=this.cameraPoint:this.cameraPoint.x<=l.x&&(x[3]=this.cameraPoint)),i.am(x,r)}bufferedCameraGeometryGlobe(r){const l=this.screenBounds[0],m=this.screenBounds.length===1?this.screenBounds[0].add(new i.P(1,1)):this.screenBounds[1],x=i.al(l,m,r),b=this.cameraPoint.clone();switch(3*((b.y>l.y)+(b.y>m.y))+((b.x>l.x)+(b.x>m.x))){case 0:x[0]=b,x[4]=b.clone();break;case 1:x.splice(1,0,b);break;case 2:x[1]=b;break;case 3:x.splice(4,0,b);break;case 5:x.splice(2,0,b);break;case 6:x[3]=b;break;case 7:x.splice(3,0,b);break;case 8:x[2]=b}return x}containsTile(r,l,m,x=0){const b=r.queryPadding/l._pixelsPerMercatorPixel+1,A=m?this._bufferedCameraMercator(b,l):this._bufferedScreenMercator(b,l);let R=r.tileID.wrap+(A.unwrapped?x:0);const N=A.polygon.map(de=>i.an(r.tileTransform,de,R));if(!i.ao(N,0,0,i.ag,i.ag))return;R=r.tileID.wrap+(this.screenGeometryMercator.unwrapped?x:0);const U=this.screenGeometryMercator.polygon.map(de=>i.ap(r.tileTransform,de,R)),$=U.map(de=>new i.P(de[0],de[1])),Z=l.getFreeCameraOptions().position||new i.aa(0,0,0),W=i.ap(r.tileTransform,Z,R),ee=U.map(de=>{const fe=i.ab.vec3.sub(de,de,W);return i.ab.vec3.normalize(fe,fe),new i.aq(W,fe)}),ue=i.ar(r,1,l.zoom)*l._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:$,tilespaceRays:ee,bufferedTilespaceGeometry:N,bufferedTilespaceBounds:(oe=i.as(N),oe.min.x=i.aw(oe.min.x,0,i.ag),oe.min.y=i.aw(oe.min.y,0,i.ag),oe.max.x=i.aw(oe.max.x,0,i.ag),oe.max.y=i.aw(oe.max.y,0,i.ag),oe),tile:r,tileID:r.tileID,pixelToTileUnitsFactor:ue};var oe}_bufferedScreenMercator(r,l){const m=Yn(r);if(this._screenRaycastCache[m])return this._screenRaycastCache[m];{let x;return x=l.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(r),l):{polygon:this.bufferedScreenGeometry(r).map(b=>l.pointCoordinate3D(b)),unwrapped:!0},this._screenRaycastCache[m]=x,x}}_bufferedCameraMercator(r,l){const m=Yn(r);if(this._cameraRaycastCache[m])return this._cameraRaycastCache[m];{let x;return x=l.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(r),l):{polygon:this.bufferedCameraGeometry(r).map(b=>l.pointCoordinate3D(b)),unwrapped:!0},this._cameraRaycastCache[m]=x,x}}_projectAndResample(r,l){const m=function(b,A){const R=i.ab.mat4.multiply([],A.pixelMatrix,A.globeMatrix),N=[0,-i.ax,0,1],U=[0,i.ax,0,1],$=[0,0,0,1];i.ab.vec4.transformMat4(N,N,R),i.ab.vec4.transformMat4(U,U,R),i.ab.vec4.transformMat4($,$,R);const Z=new i.P(N[0]/N[3],N[1]/N[3]),W=new i.P(U[0]/U[3],U[1]/U[3]),ee=i.au(b,Z)&&N[3]<$[3],ue=i.au(b,W)&&U[3]<$[3];if(!ee&&!ue)return null;const oe=function(ke,De,$e){for(let Xe=1;Xe<ke.length;Xe++){const ft=tr(De.pointCoordinate3D(ke[Xe-1]).x),ot=tr(De.pointCoordinate3D(ke[Xe]).x);if($e<0){if(ft<ot)return{idx:Xe,t:-ft/(ot-1-ft)}}else if(ot<ft)return{idx:Xe,t:(1-ft)/(ot+1-ft)}}return null}(b,A,ee?-1:1);if(!oe)return null;const{idx:de,t:fe}=oe;let Te=de>1?er(b.slice(0,de),A):[],Pe=de<b.length?er(b.slice(de),A):[];Te=Te.map(ke=>new i.P(tr(ke.x),ke.y)),Pe=Pe.map(ke=>new i.P(tr(ke.x),ke.y));const Oe=[...Te];Oe.length===0&&Oe.push(Pe[Pe.length-1]);const Fe=i.af(Oe[Oe.length-1].y,(Pe.length===0?Te[0]:Pe[0]).y,fe);let Re;return Re=ee?[new i.P(0,Fe),new i.P(0,0),new i.P(1,0),new i.P(1,Fe)]:[new i.P(1,Fe),new i.P(1,1),new i.P(0,1),new i.P(0,Fe)],Oe.push(...Re),Pe.length===0?Oe.push(Te[0]):Oe.push(...Pe),{polygon:Oe.map(ke=>new i.aa(ke.x,ke.y)),unwrapped:!1}}(r,l);if(m)return m;const x=function(b,A){let R=!1,N=-1/0,U=0;for(let Z=0;Z<b.length-1;Z++)b[Z].x>N&&(N=b[Z].x,U=Z);for(let Z=0;Z<b.length-1;Z++){const W=(U+Z)%(b.length-1),ee=b[W],ue=b[W+1];Math.abs(ee.x-ue.x)>.5&&(ee.x<ue.x?(ee.x+=1,W===0&&(b[b.length-1].x+=1)):(ue.x+=1,W+1===b.length-1&&(b[0].x+=1)),R=!0)}const $=i.at(A.center.lng);return R&&$<Math.abs($-1)&&b.forEach(Z=>{Z.x-=1}),{polygon:b,unwrapped:R}}(er(r,l).map(b=>new i.P(tr(b.x),b.y)),l);return{polygon:x.polygon.map(b=>new i.aa(b.x,b.y)),unwrapped:x.unwrapped}}}function er(p,r){return i.av(p,l=>{const m=r.pointCoordinate3D(l);l.x=m.x,l.y=m.y},1/256)}function tr(p){return p<0?1+p%1:p%1}function Yn(p){return 100*p|0}function dr(p,r,l,m,x){const b=function(R,N){if(R)return x(R);if(N){if(p.url&&N.tiles&&p.tiles&&delete p.tiles,N.variants){if(!Array.isArray(N.variants))return x(new Error("variants must be an array"));for(const $ of N.variants){if($==null||typeof $!="object"||$.constructor!==Object)return x(new Error("variant must be an object"));if(!Array.isArray($.capabilities))return x(new Error("capabilities must be an array"));if($.capabilities.length===1&&$.capabilities[0]==="meshopt"){N=i.l(N,$);break}}}const U=i.ay(i.l({},N,p),["tilejson","tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding","vector_layers","raster_layers","worldview_options","worldview_default","worldview"]);U.tiles=r.canonicalizeTileset(U,p.url),x(null,U)}},A=function(R,N,U){if(!R)return null;if(!N&&!U)return R;U=U||R.worldview_default;const $=Object.values(R.language||{});if($.length===0)return null;const Z=Object.values(R.worldview||{});if(Z.length===0)return null;const W=$.every(ue=>ue===N),ee=Z.every(ue=>ue===U);return W&&ee?R:N in(R.language_options||{})||U in(R.worldview_options||{})?null:R.language_options&&R.worldview_options?R:null}(p.data,l,m);return A?i.q.frame(()=>b(null,A)):p.url?i.n(r.transformRequest(r.normalizeSourceURL(p.url,null,l,m),i.R.Source),b):i.q.frame(()=>{const{data:R,...N}=p;b(null,N)})}class vr{constructor(r,l,m){this.bounds=i.az.convert(this.validateBounds(r)),this.minzoom=l||0,this.maxzoom=m||24}validateBounds(r){return Array.isArray(r)&&r.length===4?[Math.max(-180,r[0]),Math.max(-90,r[1]),Math.min(180,r[2]),Math.min(90,r[3])]:[-180,-90,180,90]}contains(r){const l=Math.pow(2,r.z),m=Math.floor(i.at(this.bounds.getWest())*l),x=Math.floor(i.aA(this.bounds.getNorth())*l),b=Math.ceil(i.at(this.bounds.getEast())*l),A=Math.ceil(i.aA(this.bounds.getSouth())*l);return r.x>=m&&r.x<b&&r.y>=x&&r.y<A}}class Ii extends i.E{constructor(r,l,m,x){if(super(),this.id=r,this.dispatcher=m,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,i.l(this,i.ay(l,["url","scheme","tileSize","promoteId"])),this._options=i.l({type:"vector"},l),this._collectResourceTiming=!!l.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(x),this._tileWorkers={},this._deduped=new i.aB}load(r){this._loaded=!1,this.fire(new i.z("dataloading",{dataType:"source"}));const l=Array.isArray(this.map._language)?this.map._language.join():this.map._language,m=this.map.getWorldview();this._tileJSONRequest=dr(this._options,this.map._requestManager,l,m,(x,b)=>{if(this._tileJSONRequest=null,this._loaded=!0,x)l&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${l}`),m&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${m}`),this.fire(new i.y(x));else if(b){if(i.l(this,b),this.hasWorldviews=!!b.worldview_options,b.worldview_default&&(this.worldviewDefault=b.worldview_default),b.vector_layers){this.vectorLayers=b.vector_layers,this.vectorLayerIds=[],this.localizableLayerIds=new Set;for(const A of b.vector_layers)this.vectorLayerIds.push(A.id),b.worldview&&b.worldview[A.source]&&this.localizableLayerIds.add(A.id)}b.bounds&&(this.tileBounds=new vr(b.bounds,this.minzoom,this.maxzoom)),rn(b.tiles,this.map._requestManager._customAccessToken),this.fire(new i.z("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.z("data",{dataType:"source",sourceDataType:"content"}))}r&&r(x)})}loaded(){return this._loaded}hasTile(r){return!this.tileBounds||this.tileBounds.contains(r.canonical)}onAdd(r){this.map=r,this.load()}reload(){this.cancelTileJSONRequest();const r=i.aC(this.id,this.scope);this.load(()=>this.map.style.clearSource(r))}setTiles(r){return this._options.tiles=r,this.reload(),this}setUrl(r){return this.url=r,this._options.url=r,this.reload(),this}onRemove(r){this.cancelTileJSONRequest()}serialize(){return i.l({},this._options)}loadTile(r,l){const m=r.tileID.canonical.url(this.tiles,this.scheme),x=this.map._requestManager.normalizeTileURL(m),b=this.map._requestManager.transformRequest(x,i.R.Tile),A=this.map.style?this.map.style.getLut(this.scope):null,R=A?{image:A.image.clone()}:null,N={request:b,data:void 0,uid:r.uid,tileID:r.tileID,tileZoom:r.tileZoom,zoom:r.tileID.overscaledZ,maxZoom:this.maxzoom,lut:R,tileSize:this.tileSize*r.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,pixelRatio:i.q.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:r.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:r.isExtraShadowCaster,tessellationStep:this.map._tessellationStep,scaleFactor:this.map.getScaleFactor()};if(this.hasWorldviews&&i.f(m)&&(N.worldview=this.map.getWorldview()||this.worldviewDefault,N.localizableLayerIds=this.localizableLayerIds),N.request.collectResourceTiming=this._collectResourceTiming,r.actor&&r.state!=="expired")r.state==="loading"?r.reloadCallback=l:r.request=r.actor.send("reloadTile",N,U.bind(this));else if(r.actor=this._tileWorkers[x]=this._tileWorkers[x]||this.dispatcher.getActor(),this.dispatcher.ready)r.request=r.actor.send("loadTile",N,U.bind(this),void 0,!0);else{const $=i.aD.call({deduped:this._deduped},N,(Z,W)=>{Z||!W?U.call(this,Z):(N.data={cacheControl:W.cacheControl,expires:W.expires,rawData:W.rawData.slice(0)},r.actor&&r.actor.send("loadTile",N,U.bind(this),void 0,!0))},!0);r.request={cancel:$}}function U($,Z){return delete r.request,r.aborted?l(null):$&&$.status!==404?l($):(Z&&Z.resourceTiming&&(r.resourceTiming=Z.resourceTiming),this.map._refreshExpiredTiles&&Z&&r.setExpiryData(Z),r.loadVectorData(Z,this.map.painter),i.aE(this.dispatcher),l(null),void(r.reloadCallback&&(this.loadTile(r,r.reloadCallback),r.reloadCallback=null)))}}abortTile(r){r.request&&(r.request.cancel(),delete r.request),r.actor&&r.actor.send("abortTile",{uid:r.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(r,l){r.actor&&r.actor.send("removeTile",{uid:r.uid,type:this.type,source:this.id,scope:this.scope}),r.destroy()}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class zo extends i.E{constructor(r,l,m,x){super(),this.id=r,this.dispatcher=m,this.setEventedParent(x),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=i.l({type:"raster"},l),i.l(this,i.ay(l,["url","scheme","tileSize"]))}load(r){this._loaded=!1,this.fire(new i.z("dataloading",{dataType:"source"})),this._tileJSONRequest=dr(this._options,this.map._requestManager,null,null,(l,m)=>{this._tileJSONRequest=null,this._loaded=!0,l?this.fire(new i.y(l)):m&&(i.l(this,m),m.raster_layers&&(this.rasterLayers=m.raster_layers,this.rasterLayerIds=this.rasterLayers.map(x=>x.id)),m.bounds&&(this.tileBounds=new vr(m.bounds,this.minzoom,this.maxzoom)),rn(m.tiles),this.fire(new i.z("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.z("data",{dataType:"source",sourceDataType:"content"}))),r&&r(l)})}loaded(){return this._loaded}onAdd(r){this.map=r,this.load()}reload(){this.cancelTileJSONRequest();const r=i.aC(this.id,this.scope);this.load(()=>this.map.style.clearSource(r))}setTiles(r){return this._options.tiles=r,this.reload(),this}setUrl(r){return this.url=r,this._options.url=r,this.reload(),this}onRemove(r){this.cancelTileJSONRequest()}serialize(){return i.l({},this._options)}hasTile(r){return!this.tileBounds||this.tileBounds.contains(r.canonical)}loadTile(r,l){const m=i.q.devicePixelRatio>=2,x=this.map._requestManager.normalizeTileURL(r.tileID.canonical.url(this.tiles,this.scheme),m,this.tileSize);r.request=i.o(this.map._requestManager.transformRequest(x,i.R.Tile),(b,A,R,N)=>(delete r.request,r.aborted?(r.state="unloaded",l(null)):b?(r.state="errored",l(b)):A?(this.map._refreshExpiredTiles&&r.setExpiryData({cacheControl:R,expires:N}),r.setTexture(A,this.map.painter),r.state="loaded",i.aE(this.dispatcher),void l(null)):l(null)))}abortTile(r,l){r.request&&(r.request.cancel(),delete r.request),l&&l()}unloadTile(r,l){r.texture&&r.texture instanceof i.T?(r.destroy(!0),r.texture&&r.texture instanceof i.T&&this.map.painter.saveTileTexture(r.texture)):r.destroy(),l&&l()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class Ai extends zo{constructor(r,l,m,x){super(r,l,m,x),this.type="raster-array",this.maxzoom=22,this._options=i.l({type:"raster-array"},l)}triggerRepaint(r){const l=this.map.painter._terrain,m=this.map.style.getSourceCache(this.id);l&&l.enabled&&m&&l._clearRenderCacheForTile(m.id,r.tileID),this.map.triggerRepaint()}loadTile(r,l){const m=this.map._requestManager.normalizeTileURL(r.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize),x=this.map._requestManager.transformRequest(m,i.R.Tile);r.requestParams=x,r.actor||(r.actor=this.dispatcher.getActor()),r.request=r.fetchHeader(void 0,(b,A,R,N)=>{if(delete r.request,r.aborted)return r.state="unloaded",l(null);if(b)return b.code===20?void 0:(r.state="errored",l(b));this.map._refreshExpiredTiles&&r.setExpiryData({cacheControl:R,expires:N}),r.state="empty",l(null)})}unloadTile(r,l){const m=r.texture;m&&m instanceof i.T?(r.destroy(!0),this.map.painter.saveTileTexture(m)):(r.destroy(),r.flushQueues(),r._isHeaderLoaded=!1,delete r._mrt,delete r.textureDescriptor),r.fbo&&(r.fbo.destroy(),delete r.fbo),delete r.request,delete r.requestParams,delete r.neighboringTiles,r.state="unloaded"}prepareTile(r,l,m){r._isHeaderLoaded&&(r.state!=="empty"&&(r.state="reloading"),r.fetchBand(l,m,(x,b)=>{if(x)return r.state="errored",this.fire(new i.y(x)),void this.triggerRepaint(r);b&&(r.setTexture(b,this.map.painter),r.state="loaded",this.triggerRepaint(r))}))}getInitialBand(r){if(!this.rasterLayers)return 0;const l=this.rasterLayers.find(({id:b})=>b===r),m=l&&l.fields,x=m&&m.bands&&m.bands;return x?x[0]:0}getTextureDescriptor(r,l,m){if(!r)return;const x=l.sourceLayer||this.rasterLayerIds&&this.rasterLayerIds[0];if(!x)return;let b=null;l instanceof i.aH?b=l.paint.get("raster-array-band"):l instanceof i.aI&&(b=l.paint.get("raster-particle-array-band"));const A=b||this.getInitialBand(x);if(A!=null)if(r.textureDescriptor){if(!r.updateNeeded(x,A)||m)return Object.assign({},r.textureDescriptor,{texture:r.texture})}else this.prepareTile(r,x,A)}}const ii={vector:Ii,raster:zo,"raster-dem":class extends zo{constructor(p,r,l,m){super(p,r,l,m),this.type="raster-dem",this.maxzoom=22,this._options=i.l({type:"raster-dem"},r),this.encoding=r.encoding||"mapbox"}loadTile(p,r){const l=this.map._requestManager.normalizeTileURL(p.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function m(x,b){x&&(p.state="errored",r(x)),b&&(p.dem=b,p.dem.onDeserialize(),p.needsHillshadePrepare=!0,p.needsDEMTextureUpload=!0,p.state="loaded",r(null))}p.request=i.o(this.map._requestManager.transformRequest(l,i.R.Tile),(function(x,b,A,R){if(delete p.request,p.aborted)p.state="unloaded",r(null);else if(x)p.state="errored",r(x);else if(b){this.map._refreshExpiredTiles&&p.setExpiryData({cacheControl:A,expires:R});const N=ImageBitmap&&b instanceof ImageBitmap&&i.t(),U=1-(b.width-i.aF(b.width))/2;U<1||p.neighboringTiles||(p.neighboringTiles=this._getNeighboringTiles(p.tileID));const $=N?b:i.q.getImageData(b,U),Z={uid:p.uid,coord:p.tileID,source:this.id,scope:this.scope,rawImageData:$,encoding:this.encoding,padding:U};p.actor&&p.state!=="expired"||(p.actor=this.dispatcher.getActor(),p.actor.send("loadDEMTile",Z,m.bind(this),void 0,!0))}}).bind(this))}_getNeighboringTiles(p){const r=p.canonical,l=Math.pow(2,r.z),m=(r.x-1+l)%l,x=r.x===0?p.wrap-1:p.wrap,b=(r.x+1+l)%l,A=r.x+1===l?p.wrap+1:p.wrap,R={};return R[new i.aG(p.overscaledZ,x,r.z,m,r.y).key]={backfilled:!1},R[new i.aG(p.overscaledZ,A,r.z,b,r.y).key]={backfilled:!1},r.y>0&&(R[new i.aG(p.overscaledZ,x,r.z,m,r.y-1).key]={backfilled:!1},R[new i.aG(p.overscaledZ,p.wrap,r.z,r.x,r.y-1).key]={backfilled:!1},R[new i.aG(p.overscaledZ,A,r.z,b,r.y-1).key]={backfilled:!1}),r.y+1<l&&(R[new i.aG(p.overscaledZ,x,r.z,m,r.y+1).key]={backfilled:!1},R[new i.aG(p.overscaledZ,p.wrap,r.z,r.x,r.y+1).key]={backfilled:!1},R[new i.aG(p.overscaledZ,A,r.z,b,r.y+1).key]={backfilled:!1}),R}},"raster-array":Ai,geojson:class extends i.E{constructor(p,r,l,m){super(),this.id=p,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=l.getActor(),this.setEventedParent(m),this._data=r.data,this._options=i.l({},r),this._collectResourceTiming=r.collectResourceTiming,r.maxzoom!==void 0&&(this.maxzoom=r.maxzoom),r.minzoom!==void 0&&(this.minzoom=r.minzoom),r.type&&(this.type=r.type),r.attribution&&(this.attribution=r.attribution),this.promoteId=r.promoteId;const x=i.ag/this.tileSize;this.workerOptions=i.l({source:this.id,scope:this.scope,cluster:r.cluster||!1,geojsonVtOptions:{buffer:(r.buffer!==void 0?r.buffer:128)*x,tolerance:(r.tolerance!==void 0?r.tolerance:.375)*x,extent:i.ag,maxZoom:this.maxzoom,lineMetrics:r.lineMetrics||!1,generateId:r.generateId||!1},superclusterOptions:{maxZoom:r.clusterMaxZoom!==void 0?r.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,r.clusterMinPoints||2),extent:i.ag,radius:(r.clusterRadius!==void 0?r.clusterRadius:50)*x,log:!1,generateId:r.generateId||!1},clusterProperties:r.clusterProperties,filter:r.filter,dynamic:r.dynamic},r.workerOptions)}onAdd(p){this.map=p,this.setData(this._data)}setData(p){return this._data=p,this._updateWorkerData(),this}updateData(p){if(!this._options.dynamic)return this.fire(new i.y(new Error("Can't call updateData on a GeoJSON source with dynamic set to false.")));if(typeof p!="string"&&(p.type==="Feature"&&(p={type:"FeatureCollection",features:[p]}),p.type!=="FeatureCollection"))return this.fire(new i.y(new Error("Data to update should be a feature or a feature collection.")));if(this._coalesce&&typeof p!="string"&&typeof this._data!="string"&&this._data.type==="FeatureCollection"){const r=new Map;for(const l of this._data.features)r.set(l.id,l);for(const l of p.features)r.set(l.id,l);this._data.features=[...r.values()]}else this._data=p;return this._updateWorkerData(!0),this}getClusterExpansionZoom(p,r){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:p,source:this.id,scope:this.scope},r),this}getClusterChildren(p,r){return this.actor.send("geojson.getClusterChildren",{clusterId:p,source:this.id,scope:this.scope},r),this}getClusterLeaves(p,r,l,m){return this.actor.send("geojson.getClusterLeaves",{source:this.id,scope:this.scope,clusterId:p,limit:r,offset:l},m),this}_updateWorkerData(p=!1){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new i.z("dataloading",{dataType:"source"})),this._loaded=!1;const r=i.l({append:p},this.workerOptions);r.scope=this.scope;const l=this._data;typeof l=="string"?(r.request=this.map._requestManager.transformRequest(i.q.resolveURL(l),i.R.Source),r.request.collectResourceTiming=this._collectResourceTiming):r.data=JSON.stringify(l),this._pendingLoad=this.actor.send(`${this.type}.loadData`,r,(m,x)=>{if(this._loaded=!0,this._pendingLoad=null,m)this.fire(new i.y(m));else{const b={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&x&&x.resourceTiming&&x.resourceTiming[this.id]&&(b.resourceTiming=x.resourceTiming[this.id]),p&&(this._partialReload=!0),this.fire(new i.z("data",b)),this._partialReload=!1,this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(p),this._coalesce=!1)})}loaded(){return this._loaded}reload(){const p=i.aC(this.id,this.scope);this.map.style.clearSource(p),this._updateWorkerData()}loadTile(p,r){const l=p.actor?"reloadTile":"loadTile";p.actor=this.actor;const m=this.map.style?this.map.style.getLut(this.scope):null,x=m?{image:m.image.clone()}:null,b=this._partialReload,A={type:this.type,uid:p.uid,tileID:p.tileID,tileZoom:p.tileZoom,zoom:p.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,lut:x,scope:this.scope,pixelRatio:i.q.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,brightness:this.map.style&&this.map.style.getBrightness()||0,scaleFactor:this.map.getScaleFactor(),partial:b};p.request=this.actor.send(l,A,(R,N)=>b&&!N?(p.state="loaded",r(null)):(delete p.request,p.destroy(),p.aborted?r(null):R?r(R):(p.loadVectorData(N,this.map.painter,l==="reloadTile"),r(null))),void 0,l==="loadTile")}abortTile(p){p.request&&(p.request.cancel(),delete p.request),p.aborted=!0}unloadTile(p,r){this.actor.send("removeTile",{uid:p.uid,type:this.type,source:this.id,scope:this.scope}),p.destroy()}onRemove(p){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return i.l({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends i.aJ{constructor(p,r,l,m){super(p,r,l,m),this.roundZoom=!0,this.type="video",this.options=r}load(){this._loaded=!1;const p=this.options;this.urls=[];for(const r of p.urls)this.urls.push(this.map._requestManager.transformRequest(r,i.R.Source).url);i.aK(this.urls,(r,l)=>{this._loaded=!0,r?this.fire(new i.y(r)):l&&(this.video=l,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(p){if(this.video){const r=this.video.seekable;p<r.start(0)||p>r.end(0)?this.fire(new i.y(new i.V(`sources.${this.id}`,null,`Playback for this video can be set only between the ${r.start(0)} and ${r.end(0)}-second mark.`))):this.video.currentTime=p}}getVideo(){return this.video}onAdd(p){this.map||(this.map=p,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const p=this.map.painter.context,r=p.gl;this.texture?this.video.paused||(this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE),r.texSubImage2D(r.TEXTURE_2D,0,0,0,r.RGBA,r.UNSIGNED_BYTE,this.video)):(this.texture=new i.T(p,this.video,r.RGBA8),this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(p)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:i.aJ,model:class extends i.E{constructor(p,r,l,m){super(),this.id=p,this.type="model",this.models=[],this._loaded=!1,this._options=r}load(){const p=[];for(const r in this._options.models){const l=this._options.models[r],m=i.aM(this.map._requestManager.transformRequest(l.uri,i.R.Model).url).then(x=>{if(!x)return;const b=i.aN(x),A=new i.aO(r,l.position,l.orientation,b);A.computeBoundsAndApplyParent(),this.models.push(A)}).catch(x=>{this.fire(new i.y(new Error(`Could not load model ${r} from ${l.uri}: ${x.message}`)))});p.push(m)}return Promise.allSettled(p).then(()=>{this._loaded=!0,this.fire(new i.z("data",{dataType:"source",sourceDataType:"metadata"}))}).catch(r=>{this.fire(new i.y(new Error(`Could not load models: ${r.message}`)))})}onAdd(p){this.map=p,this.load()}hasTransition(){return!1}loaded(){return this._loaded}getModels(){return this.models}loadTile(p,r){}serialize(){return{type:"model"}}},"batched-model":class extends i.E{constructor(p,r,l,m){super(),this.type="batched-model",this.id=p,this.tileSize=512,this._options=r,this.tiles=this._options.tiles,this.maxzoom=r.maxzoom||19,this.minzoom=r.minzoom||0,this.roundZoom=!0,this.usedInConflation=!0,this.dispatcher=l,this.reparseOverscaled=!1,this.scheme="xyz",this._loaded=!1,this.setEventedParent(m)}onAdd(p){this.map=p,this.load()}reload(){this.cancelTileJSONRequest();const p=i.aC(this.id,this.scope);this.load(()=>this.map.style.clearSource(p))}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}load(p){this._loaded=!1,this.fire(new i.z("dataloading",{dataType:"source"}));const r=Array.isArray(this.map._language)?this.map._language.join():this.map._language,l=this.map.getWorldview();this._tileJSONRequest=dr(this._options,this.map._requestManager,r,l,(m,x)=>{this._tileJSONRequest=null,this._loaded=!0,m?(r&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${r}`),l&&l.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${l}`),this.fire(new i.y(m))):x&&(i.l(this,x),x.bounds&&(this.tileBounds=new vr(x.bounds,this.minzoom,this.maxzoom)),rn(x.tiles,this.map._requestManager._customAccessToken),this.fire(new i.z("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.z("data",{dataType:"source",sourceDataType:"content"}))),p&&p(m)})}hasTransition(){return!1}hasTile(p){return!this.tileBounds||this.tileBounds.contains(p.canonical)}loaded(){return this._loaded}loadTile(p,r){const l=this.map._requestManager.normalizeTileURL(p.tileID.canonical.url(this.tiles,this.scheme)),m={request:this.map._requestManager.transformRequest(l,i.R.Tile),data:void 0,uid:p.uid,tileID:p.tileID,tileZoom:p.tileZoom,zoom:p.tileID.overscaledZ,tileSize:this.tileSize*p.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,showCollisionBoxes:this.map.showCollisionBoxes,isSymbolTile:p.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,lut:null,maxZoom:null,promoteId:null,pixelRatio:null,scaleFactor:null};if(p.actor&&p.state!=="expired")if(p.state==="loading")p.reloadCallback=r;else{if(p.buckets){const b=Object.values(p.buckets);for(const A of b)A.dirty=!0;return void(p.state="loaded")}p.request=p.actor.send("reloadTile",m,x.bind(this))}else p.actor=this.dispatcher.getActor(),p.request=p.actor.send("loadTile",m,x.bind(this),void 0,!0);function x(b,A){return p.aborted?r(null):b&&b.status!==404?r(b):(this.map._refreshExpiredTiles&&A&&p.setExpiryData(A),p.loadModelData(A,this.map.painter),p.state="loaded",void r(null))}}serialize(){return i.l({},this._options)}},canvas:class extends i.aJ{constructor(p,r,l,m){super(p,r,l,m),r.coordinates?Array.isArray(r.coordinates)&&r.coordinates.length===4&&!r.coordinates.some(x=>!Array.isArray(x)||x.length!==2||x.some(b=>typeof b!="number"))||this.fire(new i.y(new i.V(`sources.${p}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new i.y(new i.V(`sources.${p}`,null,'missing required property "coordinates"'))),r.animate&&typeof r.animate!="boolean"&&this.fire(new i.y(new i.V(`sources.${p}`,null,'optional "animate" property must be a boolean value'))),r.canvas?typeof r.canvas=="string"||r.canvas instanceof HTMLCanvasElement||this.fire(new i.y(new i.V(`sources.${p}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new i.y(new i.V(`sources.${p}`,null,'missing required property "canvas"'))),this.options=r,this.animate=r.animate===void 0||r.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new i.y(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(p){this.map=p,this.load(),this.canvas&&this.animate&&this.play()}onRemove(p){this.pause()}prepare(){let p=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,p=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,p=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const r=this.map.painter.context;this.texture?!p&&!this._playing||this.texture instanceof i.aL||this.texture.update(this.canvas,{premultiply:!0}):this.texture=new i.T(r,this.canvas,r.gl.RGBA8,{premultiply:!0}),this._prepareData(r)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const p of[this.canvas.width,this.canvas.height])if(isNaN(p)||p<=0)return!0;return!1}},custom:class extends i.E{constructor(p,r,l,m){super(),this.id=p,this.type="custom",this._dataType="raster",this._dispatcher=l,this._implementation=r,this.setEventedParent(m),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new i.y(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new i.y(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new vr(this._implementation.bounds,this.minzoom,this.maxzoom)),r.update=this._update.bind(this),r.clearTiles=this._clearTiles.bind(this),r.coveringTiles=this._coveringTiles.bind(this),i.l(this,i.ay(r,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return i.ay(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new i.z("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.z("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(p){this.map=p,this._loaded=!1,this.fire(new i.z("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(p),this.load()}onRemove(p){this._implementation.onRemove&&this._implementation.onRemove(p)}hasTile(p){if(this._implementation.hasTile){const{x:r,y:l,z:m}=p.canonical;return this._implementation.hasTile({x:r,y:l,z:m})}return!this.tileBounds||this.tileBounds.contains(p.canonical)}loadTile(p,r){const{x:l,y:m,z:x}=p.tileID.canonical,b=new AbortController;p.request=Promise.resolve(this._implementation.loadTile({x:l,y:m,z:x},{signal:b.signal})).then((function(A){return delete p.request,p.aborted?(p.state="unloaded",r(null)):A===void 0?(p.state="errored",r(null)):A===null?(this.loadTileData(p,{width:this.tileSize,height:this.tileSize,data:null}),p.state="loaded",r(null)):function(R){return R instanceof ImageData||R instanceof HTMLCanvasElement||R instanceof ImageBitmap||R instanceof HTMLImageElement}(A)?(this.loadTileData(p,A),p.state="loaded",void r(null)):(p.state="errored",r(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}).bind(this)).catch(A=>{A.code!==20&&(p.state="errored",r(A))}),p.request.cancel=()=>b.abort()}loadTileData(p,r){p.setTexture(r,this.map.painter)}unloadTile(p,r){if(p.texture&&p.texture instanceof i.T?(p.destroy(!0),p.texture&&p.texture instanceof i.T&&this.map.painter.saveTileTexture(p.texture)):p.destroy(),this._implementation.unloadTile){const{x:l,y:m,z:x}=p.tileID.canonical;this._implementation.unloadTile({x:l,y:m,z:x})}r&&r()}abortTile(p,r){p.request&&p.request.cancel&&(p.request.cancel(),delete p.request),r&&r()}hasTransition(){return!1}_coveringTiles(){return this.map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(p=>({x:p.canonical.x,y:p.canonical.y,z:p.canonical.z}))}_clearTiles(){const p=i.aC(this.id,this.scope);this.map.style.clearSource(p)}_update(){this.fire(new i.z("data",{dataType:"source",sourceDataType:"content"}))}}},di=function(p,r,l,m){const x=new ii[r.type](p,r,l,m);if(x.id!==p)throw new Error(`Expected Source id to be ${p} instead of ${x.id}`);return i.aP(["load","abort","unload","serialize","prepare"],x),x};function th(p,r,l=""){return`${l}:${r.id||""}:${r.layer.id}:${function(m){if("layerId"in m)return`layer:${m.layerId}`;{const{featuresetId:x,importId:b}=m;return`featureset:${x}${b?`:import:${b}`:""}`}}(p.target)}`}function yl(p,r,l,m=""){if(p.uniqueFeatureID){const x=th(p,r,m);if(l.has(x))return!0;l.add(x)}return!1}function rc(p,r,l,m,x=!1){const b=r.sourceCache.transform,A=r.sourceCache.tilesIn(p,r.has3DLayers,x);A.sort(Jp);const R=[];for(const N of A){const U=N.tile.queryRenderedFeatures(r,N,l,m,b,x);Object.keys(U).length&&R.push({wrappedTileID:N.tile.tileID.wrapped().key,queryResults:U})}return R.length===0?{}:function(N){const U={},$={};for(const Z of N){const W=Z.queryResults,ee=Z.wrappedTileID,ue=$[ee]=$[ee]||{};for(const oe in W){const de=W[oe],fe=ue[oe]=ue[oe]||{},Te=U[oe]=U[oe]||[];for(const Pe of de)fe[Pe.featureIndex]||(fe[Pe.featureIndex]=!0,Te.push(Pe))}}return U}(R)}function Bd(p,r,l,m,x){const b={},A=m.queryRenderedSymbols(p),R=[];for(const N of Object.keys(A).map(Number))R.push(x[N]);R.sort(Jp);for(const N of R){const U=N.featureIndex.lookupSymbolFeatures(A[N.bucketInstanceId],N.bucketIndex,N.sourceLayerIndex,r,l);for(const $ in U){const Z=b[$]=b[$]||[],W=U[$];W.sort((ee,ue)=>{const oe=N.featureSortOrder;if(oe){const de=oe.indexOf(ee.featureIndex);return oe.indexOf(ue.featureIndex)-de}return ue.featureIndex-ee.featureIndex});for(const ee of W)Z.push(ee)}}return b}function hf(p,r){const l=p.getRenderableIds().map(b=>p.getTileByID(b)),m=[],x={};for(let b=0;b<l.length;b++){const A=l[b],R=A.tileID.canonical.key;x[R]||(x[R]=!0,A.querySourceFeatures(m,r))}return m}function Jp(p,r){const l=p.tileID,m=r.tileID;return l.overscaledZ-m.overscaledZ||l.canonical.y-m.canonical.y||l.wrap-m.wrap||l.canonical.x-m.canonical.x}function xo(p,r){const l={};if(!r)return l;for(const m of p){const x=m.layerIds.map(b=>r.getLayer(b)).filter(Boolean);if(x.length!==0){m.layers=x,m.stateDependentLayerIds&&(m.stateDependentLayers=m.stateDependentLayerIds.map(b=>x.filter(A=>A.id===b)[0]));for(const b of x)l[b.fqid]=m}}return l}const Ma=32,ts=33,Es=new Uint16Array(8184);for(let p=0;p<2046;p++){let r=p+2,l=0,m=0,x=0,b=0,A=0,R=0;for(1&r?x=b=A=Ma:l=m=R=Ma;(r>>=1)>1;){const U=l+x>>1,$=m+b>>1;1&r?(x=l,b=m,l=A,m=R):(l=x,m=b,x=A,b=R),A=U,R=$}const N=4*p;Es[N+0]=l,Es[N+1]=m,Es[N+2]=x,Es[N+3]=b}const oo=new Uint16Array(2178),ns=new Uint8Array(1089),As=new Uint16Array(1089);function vl(p){return p===0?-.03125:p===32?.03125:0}const Qp={type:2,extent:i.ag,loadGeometry:()=>[[new i.P(0,0),new i.P(i.ag+1,0),new i.P(i.ag+1,i.ag+1),new i.P(0,i.ag+1),new i.P(0,0)]]};class xl{constructor(r,l,m,x,b){this.tileID=r,this.uid=i.aV(),this.uses=0,this.tileSize=l,this.tileZoom=m,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=b,x&&x.style&&(this._lastUpdatedBrightness=x.style.getBrightness()),this.expiredRequestCount=0,this.state="loading",x&&x.transform&&(this.projection=x.transform.projection)}registerFadeDuration(r){const l=r+this.timeAdded;l<i.q.now()||this.fadeEndTime&&l<this.fadeEndTime||(this.fadeEndTime=l)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=i.aQ(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(r,l,m){if(this.unloadVectorData(),this.state="loaded",r){r.featureIndex&&(this.latestFeatureIndex=r.featureIndex,r.rawTileData?(this.latestRawTileData=r.rawTileData,this.latestFeatureIndex.rawTileData=r.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=r.collisionBoxArray,this.buckets=xo(r.buckets,l.style),this.hasSymbolBuckets=!1;for(const x in this.buckets){const b=this.buckets[x];if(b instanceof i.aX){if(this.hasSymbolBuckets=!0,!m)break;b.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const x in this.buckets){const b=this.buckets[x];if(b instanceof i.aX&&b.hasRTLText){this.hasRTLText=!0,i.aY();break}}this.queryPadding=0;for(const x in this.buckets){const b=this.buckets[x],A=l.style.getOwnLayer(x);if(!A)continue;const R=A.queryRadius(b);this.queryPadding=Math.max(this.queryPadding,R)}r.imageAtlas&&(this.imageAtlas=r.imageAtlas),r.glyphAtlasImage&&(this.glyphAtlasImage=r.glyphAtlasImage),r.lineAtlas&&(this.lineAtlas=r.lineAtlas),this._lastUpdatedBrightness=r.brightness}else this.collisionBoxArray=new i.aW}unloadVectorData(){if(this.hasData()){for(const r in this.buckets)this.buckets[r].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}loadModelData(r,l,m){r&&(r.resourceTiming&&(this.resourceTiming=r.resourceTiming),this.buckets=Object.assign({},this.buckets,xo(r.buckets,l.style)),r.featureIndex&&(this.latestFeatureIndex=r.featureIndex))}getBucket(r){return this.buckets[r.fqid]}upload(r){for(const x in this.buckets){const b=this.buckets[x];b.uploadPending()&&b.upload(r)}const l=r.gl,m=this.imageAtlas;if(m&&!m.uploaded){const x=!!Object.keys(m.patternPositions).length;this.imageAtlasTexture=new i.T(r,m.image,l.RGBA8,{useMipmap:x}),this.imageAtlas.uploaded=!0}this.glyphAtlasImage&&(this.glyphAtlasTexture=new i.T(r,this.glyphAtlasImage,l.R8),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new i.T(r,this.lineAtlas.image,l.R8),this.lineAtlas.uploaded=!0)}prepare(r,l,m){if(this.imageAtlas&&this.imageAtlasTexture&&this.imageAtlas.patchUpdatedImages(r,this.imageAtlasTexture,m),!l||!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData)return;const x=l.style.getBrightness();(this._lastUpdatedBrightness||x)&&(this._lastUpdatedBrightness&&x&&Math.abs(this._lastUpdatedBrightness-x)<.001||(this.updateBuckets(l,this._lastUpdatedBrightness!==x),this._lastUpdatedBrightness=x))}queryRenderedFeatures(r,l,m,x,b,A){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData&&!this.latestFeatureIndex.is3DTile)return{};const R=function(N,U){const $=i.ab.mat4.fromScaling([],[.5*N.width,.5*-N.height,1]);return i.ab.mat4.translate($,$,[1,-1,0]),i.ab.mat4.multiply($,$,N.calculateProjMatrix(U.toUnwrapped())),Float32Array.from($)}(b,this.tileID);return this.latestFeatureIndex.query(r,{tilespaceGeometry:l,pixelPosMatrix:R,transform:x,availableImages:m,tileTransform:this.tileTransform})}querySourceFeatures(r,l){const m=this.latestFeatureIndex;if(!m||!m.rawTileData)return;const x=m.loadVTLayers(),b=l?l.sourceLayer:"",A=x._geojsonTileLayer||x[b];if(!A)return;const R=i.aZ(l&&l.filter),{z:N,x:U,y:$}=this.tileID.canonical,Z={z:N,x:U,y:$};for(let W=0;W<A.length;W++){const ee=A.feature(W);if(R.needGeometry){const de=i.a_(ee,!0);if(!R.filter(new i.a8(this.tileID.overscaledZ),de,this.tileID.canonical))continue}else if(!R.filter(new i.a8(this.tileID.overscaledZ),ee))continue;const ue=m.getId(ee,b),oe=new i.a$(ee,N,U,$,ue);oe.tile=Z,r.push(oe)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(r){const l=this.expirationTime;if(r.cacheControl){const m=i.b0(r.cacheControl);m["max-age"]&&(this.expirationTime=Date.now()+1e3*m["max-age"])}else r.expires&&(this.expirationTime=new Date(r.expires).getTime());if(this.expirationTime){const m=Date.now();let x=!1;if(this.expirationTime>m)x=!1;else if(l)if(this.expirationTime<l)x=!0;else{const b=this.expirationTime-l;b?this.expirationTime=m+Math.max(b,3e4):x=!0}else x=!0;x?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}refreshFeatureState(r){this.latestFeatureIndex&&(this.latestFeatureIndex.rawTileData||this.latestFeatureIndex.is3DTile)&&r&&this.updateBuckets(r)}updateBuckets(r,l){if(!this.latestFeatureIndex||!r.style)return;const m=this.latestFeatureIndex.loadVTLayers(),x=r.style.listImages(),b=r.style.getBrightness();for(const A in this.buckets){if(!r.style.hasLayer(A))continue;const R=this.buckets[A],N=R.layers[0],U=N.sourceLayer||"_geojsonTileLayer",$=m[U],Z=r.style.getLayerSourceCache(N);let W={};Z&&(W=Z._state.getState(U,void 0));const ee=this.imageAtlas&&this.imageAtlas.patternPositions||{},ue=Object.keys(W).length>0&&!l;ue&&!R.stateDependentLayers.length&&!l||R.update(W,$,x,ee,ue?R.stateDependentLayers:R.layers,l,b),(R instanceof i.b1||R instanceof i.b2)&&r._terrain&&r._terrain.enabled&&Z&&R.programConfigurations.needsUpload&&r._terrain._clearRenderCacheForTile(Z.id,this.tileID);const oe=r&&r.style&&r.style.getOwnLayer(A);oe&&(this.queryPadding=Math.max(this.queryPadding,oe.queryRadius(R)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<i.q.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(r){this.symbolFadeHoldUntil=i.q.now()+r}setTexture(r,l){const m=l.context,x=m.gl;this.texture=this.texture||l.getTileTexture(r.width),this.texture&&this.texture instanceof i.T?this.texture.update(r):(this.texture=new i.T(m,r,x.RGBA8,{useMipmap:!0}),this.texture.bind(x.LINEAR,x.CLAMP_TO_EDGE))}setDependencies(r,l){const m={};for(const x of l)m[x]=!0;this.dependencies[r]=m}hasDependency(r,l){for(const m of r){const x=this.dependencies[m];if(x){for(const b of l)if(x[b])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(r,l){if(!l||l.name==="mercator"||this._tileDebugBuffer)return;const m=i.b3(Qp,this.tileID.canonical,this.tileTransform)[0],x=new i.b4,b=new i.b5;for(let A=0;A<m.length;A++){const{x:R,y:N}=m[A];x.emplaceBack(R,N),b.emplaceBack(A)}b.emplaceBack(0),this._tileDebugIndexBuffer=r.createIndexBuffer(b),this._tileDebugBuffer=r.createVertexBuffer(x,i.b6.members),this._tileDebugSegments=i.b7.simpleSegment(0,0,x.length,b.length)}_makeTileBoundsBuffers(r,l){if(this._tileBoundsBuffer||!l||l.name==="mercator")return;const m=i.b3(Qp,this.tileID.canonical,this.tileTransform)[0];let x,b;if(this.isRaster){const A=function(R,N){const U=i.aQ(R,N),$=Math.pow(2,R.z);for(let de=0;de<ts;de++)for(let fe=0;fe<ts;fe++){const Te=i.aR((R.x+(fe+vl(fe))/Ma)/$),Pe=i.aS((R.y+(de+vl(de))/Ma)/$),Oe=N.project(Te,Pe),Fe=de*ts+fe;oo[2*Fe+0]=Math.round((Oe.x*U.scale-U.x)*i.ag),oo[2*Fe+1]=Math.round((Oe.y*U.scale-U.y)*i.ag)}ns.fill(0),As.fill(0);for(let de=2045;de>=0;de--){const fe=4*de,Te=Es[fe+0],Pe=Es[fe+1],Oe=Es[fe+2],Fe=Es[fe+3],Re=Te+Oe>>1,ke=Pe+Fe>>1,De=Re+ke-Pe,$e=ke+Te-Re,Xe=Pe*ts+Te,ft=Fe*ts+Oe,ot=ke*ts+Re,Et=Math.hypot((oo[2*Xe+0]+oo[2*ft+0])/2-oo[2*ot+0],(oo[2*Xe+1]+oo[2*ft+1])/2-oo[2*ot+1])>=16;ns[ot]=ns[ot]||(Et?1:0),de<1022&&(ns[ot]=ns[ot]||ns[(Pe+$e>>1)*ts+(Te+De>>1)]||ns[(Fe+$e>>1)*ts+(Oe+De>>1)])}const Z=new i.aT,W=new i.aU;let ee=0;function ue(de,fe){const Te=fe*ts+de;return As[Te]===0&&(Z.emplaceBack(oo[2*Te+0],oo[2*Te+1],de*i.ag/Ma,fe*i.ag/Ma),As[Te]=++ee),As[Te]-1}function oe(de,fe,Te,Pe,Oe,Fe){const Re=de+Te>>1,ke=fe+Pe>>1;if(Math.abs(de-Oe)+Math.abs(fe-Fe)>1&&ns[ke*ts+Re])oe(Oe,Fe,de,fe,Re,ke),oe(Te,Pe,Oe,Fe,Re,ke);else{const De=ue(de,fe),$e=ue(Te,Pe),Xe=ue(Oe,Fe);W.emplaceBack(De,$e,Xe)}}return oe(0,0,Ma,Ma,Ma,0),oe(Ma,Ma,0,0,0,Ma),{vertices:Z,indices:W}}(this.tileID.canonical,l);x=A.vertices,b=A.indices}else{x=new i.aT,b=new i.aU;for(const{x:R,y:N}of m)x.emplaceBack(R,N,0,0);const A=i.b8(x.int16,void 0,4);for(let R=0;R<A.length;R+=3)b.emplaceBack(A[R],A[R+1],A[R+2])}this._tileBoundsBuffer=r.createVertexBuffer(x,i.b9.members),this._tileBoundsIndexBuffer=r.createIndexBuffer(b),this._tileBoundsSegments=i.b7.simpleSegment(0,0,x.length,b.length)}_makeGlobeTileDebugBuffers(r,l){const m=l.projection;if(!m||m.name!=="globe"||l.freezeTileCoverage)return;const x=this.tileID.canonical,b=i.ba(x,l),A=i.bb(b),R=i.ae(l.zoom);let N;R>0&&(N=i.ab.mat4.invert(new Float64Array(16),l.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(r,x,l,A,N,R),this._makeGlobeTileDebugTextBuffer(r,x,l,A,N,R)}_globePoint(r,l,m,x,b,A,R){let N=i.bc(r,l,m);if(A){const U=1<<m.z,$=i.at(x.center.lng),Z=i.aA(x.center.lat),W=(m.x+.5)/U-$;let ee=0;W>.5?ee=-1:W<-.5&&(ee=1);let ue=(r/i.ag+m.x)/U+ee,oe=(l/i.ag+m.y)/U;ue=(ue-$)*x._pixelsPerMercatorPixel+$,oe=(oe-Z)*x._pixelsPerMercatorPixel+Z;const de=[ue*x.worldSize,oe*x.worldSize,0];i.ab.vec3.transformMat4(de,de,A),N=i.bd(N,de,R)}return i.ab.vec3.transformMat4(N,N,b)}_makeGlobeTileDebugBorderBuffer(r,l,m,x,b,A){const R=new i.b4,N=new i.b5,U=new i.be,$=(W,ee,ue,oe,de)=>{const fe=(ue-W)/(de-1),Te=(oe-ee)/(de-1),Pe=R.length;for(let Oe=0;Oe<de;Oe++){const Fe=W+Oe*fe,Re=ee+Oe*Te;R.emplaceBack(Fe,Re);const ke=this._globePoint(Fe,Re,l,m,x,b,A);U.emplaceBack(ke[0],ke[1],ke[2]),N.emplaceBack(Pe+Oe)}},Z=i.ag;$(0,0,Z,0,16),$(Z,0,Z,Z,16),$(Z,Z,0,Z,16),$(0,Z,0,0,16),this._tileDebugIndexBuffer=r.createIndexBuffer(N),this._tileDebugBuffer=r.createVertexBuffer(R,i.b6.members),this._globeTileDebugBorderBuffer=r.createVertexBuffer(U,i.bf.members),this._tileDebugSegments=i.b7.simpleSegment(0,0,R.length,N.length)}_makeGlobeTileDebugTextBuffer(r,l,m,x,b,A){const R=i.ag/4,N=new i.b4,U=new i.aU,$=new i.be,Z=25;U.reserve(32),N.reserve(Z),$.reserve(Z);const W=(ee,ue)=>Z*ee+ue;for(let ee=0;ee<Z;ee++){const ue=ee*R;for(let oe=0;oe<Z;oe++){const de=oe*R;N.emplaceBack(de,ue);const fe=this._globePoint(de,ue,l,m,x,b,A);$.emplaceBack(fe[0],fe[1],fe[2])}}for(let ee=0;ee<4;ee++)for(let ue=0;ue<4;ue++){const oe=W(ee,ue),de=W(ee,ue+1),fe=W(ee+1,ue),Te=W(ee+1,ue+1);U.emplaceBack(oe,de,fe),U.emplaceBack(fe,de,Te)}this._tileDebugTextIndexBuffer=r.createIndexBuffer(U),this._tileDebugTextBuffer=r.createVertexBuffer(N,i.b6.members),this._globeTileDebugTextBuffer=r.createVertexBuffer($,i.bf.members),this._tileDebugTextSegments=i.b7.simpleSegment(0,0,Z,32)}destroy(r=!1){for(const l in this.buckets)this.buckets[l].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&(this.imageAtlasTexture.destroy(),delete this.imageAtlasTexture),this.glyphAtlasTexture&&(this.glyphAtlasTexture.destroy(),delete this.glyphAtlasTexture),this.lineAtlasTexture&&(this.lineAtlasTexture.destroy(),delete this.lineAtlasTexture),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),!r&&this.texture&&this.texture instanceof i.T&&(this.texture.destroy(),delete this.texture),this.hillshadeFBO&&(this.hillshadeFBO.destroy(),delete this.hillshadeFBO),this.dem&&delete this.dem,this.neighboringTiles&&delete this.neighboringTiles,this.demTexture&&(this.demTexture.destroy(),delete this.demTexture),this.rasterParticleState&&(this.rasterParticleState.destroy(),delete this.rasterParticleState),this.latestFeatureIndex=null,this.state="unloaded"}}i.bg.setPbf(i.bh);class bl extends xl{constructor(r,l,m,x,b){super(r,l,m,x,b),this._workQueue=[],this._fetchQueue=[],this._isHeaderLoaded=!1}setTexture(r,l){const m=l.context,x=m.gl;this.texture=this.texture||l.getTileTexture(r.width),this.texture&&this.texture instanceof i.T?this.texture.update(r,{premultiply:!1}):this.texture=new i.T(m,r,x.RGBA8,{premultiply:!1})}flushQueues(){for(;this._workQueue.length;)this._workQueue.pop()();for(;this._fetchQueue.length;)this._fetchQueue.pop()()}fetchHeader(r=16384,l){const m=this._mrt=new i.bg(30),x=Object.assign({},this.requestParams,{headers:{Range:"bytes=0-"+(r-1)}});return this.entireBuffer=null,this.request=i.bi(x,(b,A,R,N)=>{if(b)l(b);else try{const U=m.getHeaderLength(A);if(U>r)return void(this.request=this.fetchHeader(U,l));m.parseHeader(A),this._isHeaderLoaded=!0;let $=0;for(const Z of Object.values(m.layers))$=Math.max($,Z.dataIndex[Z.dataIndex.length-1].last_byte);A.byteLength>=$&&(this.entireBuffer=A),l(null,this.entireBuffer||A,R,N)}catch(U){l(U)}}),this.request}fetchBand(r,l,m){const x=this._mrt;if(!this._isHeaderLoaded||!x)return void m(new Error("Tile header is not ready"));const b=this.actor;if(!b)return void m(new Error("Can't fetch tile band without an actor"));let A;const R=(Z,W)=>{A.complete(Z,W),Z?m(Z):(this.updateTextureDescriptor(r,l),m(null,this.textureDescriptor&&this.textureDescriptor.img))},N=(Z,W)=>{if(Z)return m(Z);const ee=b.send("decodeRasterArray",{buffer:W,task:A},R,void 0,!0);this._workQueue.push(()=>{ee&&ee.cancel(),A.cancel()})},U=x.getLayer(r);if(!U)return void m(new Error(`Unknown sourceLayer "${r}"`));if(U.hasDataForBand(l))return this.updateTextureDescriptor(r,l),void m(null,this.textureDescriptor?this.textureDescriptor.img:null);const $=U.getDataRange([l]);if(A=x.createDecodingTask($),!A||A.tasks.length)if(this.flushQueues(),this.entireBuffer)N(null,this.entireBuffer.slice($.firstByte,$.lastByte+1));else{const Z=Object.assign({},this.requestParams,{headers:{Range:`bytes=${$.firstByte}-${$.lastByte}`}}),W=i.bi(Z,N);this._fetchQueue.push(()=>{W.cancel(),A.cancel()})}else m(null)}updateNeeded(r,l){return(!this.textureDescriptor||this.textureDescriptor.band!==l||this.textureDescriptor.layer!==r)&&this.state!=="errored"}updateTextureDescriptor(r,l){if(!this._mrt)return;const m=this._mrt.getLayer(r);if(!m||!m.hasBand(l)||!m.hasDataForBand(l))return;const{bytes:x,tileSize:b,buffer:A,offset:R,scale:N}=m.getBandView(l),U=b+2*A,$={data:x,width:U,height:U},Z=this.texture;Z&&Z instanceof i.T&&Z.update($,{premultiply:!1}),this.textureDescriptor={layer:r,band:l,img:$,buffer:A,offset:R,tileSize:b,format:m.pixelFormat,mix:[N,256*N,65536*N,16777216*N]}}}class Nd{constructor(r,l){this.max=r,this.onRemove=l,this.reset()}reset(){for(const r in this.data)for(const l of this.data[r])l.timeout&&clearTimeout(l.timeout),this.onRemove(l.value);return this.data={},this.order=[],this}add(r,l,m){const x=r.wrapped().key;this.data[x]===void 0&&(this.data[x]=[]);const b={value:l,timeout:void 0};if(m!==void 0&&(b.timeout=setTimeout(()=>{this.remove(r,b)},m)),this.data[x].push(b),this.order.push(x),this.order.length>this.max){const A=this._getAndRemoveByKey(this.order[0]);A&&this.onRemove(A)}return this}has(r){return r.wrapped().key in this.data}getAndRemove(r){return this.has(r)?this._getAndRemoveByKey(r.wrapped().key):null}_getAndRemoveByKey(r){const l=this.data[r].shift();return l.timeout&&clearTimeout(l.timeout),this.data[r].length===0&&delete this.data[r],this.order.splice(this.order.indexOf(r),1),l.value}getByKey(r){const l=this.data[r];return l?l[0].value:null}get(r){return this.has(r)?this.data[r.wrapped().key][0].value:null}remove(r,l){if(!this.has(r))return this;const m=r.wrapped().key,x=l===void 0?0:this.data[m].indexOf(l),b=this.data[m][x];return this.data[m].splice(x,1),b.timeout&&clearTimeout(b.timeout),this.data[m].length===0&&delete this.data[m],this.onRemove(b.value),this.order.splice(this.order.indexOf(m),1),this}setMaxSize(r){for(this.max=r;this.order.length>this.max;){const l=this._getAndRemoveByKey(this.order[0]);l&&this.onRemove(l)}return this}filter(r){const l=[];for(const m in this.data)for(const x of this.data[m])r(x.value)||l.push(x);for(const m of l)this.remove(m.value.tileID,m)}}class em{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(r,l,m){const x=String(l);if(this.stateChanges[r]=this.stateChanges[r]||{},this.stateChanges[r][x]=this.stateChanges[r][x]||{},i.l(this.stateChanges[r][x],m),this.deletedStates[r]===null){this.deletedStates[r]={};for(const b in this.state[r])b!==x&&(this.deletedStates[r][b]=null)}else if(this.deletedStates[r]&&this.deletedStates[r][x]===null){this.deletedStates[r][x]={};for(const b in this.state[r][x])m[b]||(this.deletedStates[r][x][b]=null)}else for(const b in m)this.deletedStates[r]&&this.deletedStates[r][x]&&this.deletedStates[r][x][b]===null&&delete this.deletedStates[r][x][b]}removeFeatureState(r,l,m){if(this.deletedStates[r]===null)return;const x=String(l);if(this.deletedStates[r]=this.deletedStates[r]||{},m&&l!==void 0)this.deletedStates[r][x]!==null&&(this.deletedStates[r][x]=this.deletedStates[r][x]||{},this.deletedStates[r][x][m]=null);else if(l!==void 0)if(this.stateChanges[r]&&this.stateChanges[r][x])for(m in this.deletedStates[r][x]={},this.stateChanges[r][x])this.deletedStates[r][x][m]=null;else this.deletedStates[r][x]=null;else this.deletedStates[r]=null}getState(r,l){const m=this.state[r]||{},x=this.stateChanges[r]||{},b=this.deletedStates[r];if(b===null)return{};if(l!==void 0){const R=String(l),N=i.l({},m[R],x[R]);if(b){const U=b[l];if(U===null)return{};for(const $ in U)delete N[$]}return N}const A=i.l({},m,x);if(b)for(const R in b)delete A[R];return A}initializeTileState(r,l){r.refreshFeatureState(l)}coalesceChanges(r,l){const m={};for(const x in this.stateChanges){this.state[x]=this.state[x]||{};const b={};for(const A in this.stateChanges[x])this.state[x][A]||(this.state[x][A]={}),i.l(this.state[x][A],this.stateChanges[x][A]),b[A]=this.state[x][A];m[x]=b}for(const x in this.deletedStates){this.state[x]=this.state[x]||{};const b={};if(this.deletedStates[x]===null)for(const A in this.state[x])b[A]={},this.state[x][A]={};else for(const A in this.deletedStates[x]){if(this.deletedStates[x][A]===null)this.state[x][A]={};else if(this.state[x][A])for(const R of Object.keys(this.deletedStates[x][A]))delete this.state[x][A][R];b[A]=this.state[x][A]}m[x]=m[x]||{},i.l(m[x],b)}if(this.stateChanges={},this.deletedStates={},Object.keys(m).length!==0)for(const x in r)r[x].refreshFeatureState(l)}}class rs extends i.E{constructor(r,l,m){super(),this.id=r,this._onlySymbols=m,l.on("data",x=>{x.dataType==="source"&&x.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&x.dataType==="source"&&x.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),l.on("error",()=>{this._sourceErrored=!0}),this._source=l,this._tiles={},this._cache=new Nd(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=l.minTileCacheSize,this._maxTileCacheSize=l.maxTileCacheSize,this._loadedParentTiles={},this.castsShadows=!1,this.tileCoverLift=0,this._coveredTiles={},this._shadowCasterTiles={},this._state=new em,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="raster-array"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(r){this.map=r,this._minTileCacheSize=this._minTileCacheSize===void 0&&r?r._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&r?r._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const r in this._tiles){const l=this._tiles[r];if(l.state!=="loaded"&&l.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const r=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,r&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(r,l){return r.isSymbolTile=this._onlySymbols,r.isExtraShadowCaster=this._shadowCasterTiles[r.tileID.key],this._source.loadTile(r,l)}_unloadTile(r){if(this._source.unloadTile)return this._source.unloadTile(r)}_abortTile(r){if(this._source.abortTile)return this._source.abortTile(r)}serialize(){return this._source.serialize()}prepare(r){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const l in this._tiles){const m=this._tiles[l];m.upload(r),m.prepare(this.map.style.imageManager,this.map?this.map.painter:null,this._source.scope)}}getIds(){return i.bj(this._tiles).map(r=>r.tileID).sort(_r).map(r=>r.key)}getRenderableIds(r,l){const m=[];for(const x in this._tiles)this._isIdRenderable(+x,r,l)&&m.push(this._tiles[x]);return r?m.sort((x,b)=>{const A=x.tileID,R=b.tileID,N=new i.P(A.canonical.x,A.canonical.y)._rotate(this.transform.angle),U=new i.P(R.canonical.x,R.canonical.y)._rotate(this.transform.angle);return A.overscaledZ-R.overscaledZ||U.y-N.y||U.x-N.x}).map(x=>x.tileID.key):m.map(x=>x.tileID).sort(_r).map(x=>x.key)}hasRenderableParent(r){const l=this.findLoadedParent(r,0);return!!l&&this._isIdRenderable(l.tileID.key)}_isIdRenderable(r,l,m){return this._tiles[r]&&this._tiles[r].hasData()&&!this._coveredTiles[r]&&(l||!this._tiles[r].holdingForFade())&&(m||!this._shadowCasterTiles[r])}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const r in this._tiles)this._tiles[r].state!=="errored"&&this._reloadTile(+r,"reloading")}}_reloadTile(r,l){const m=this._tiles[r];m&&(m.state!=="loading"&&(m.state=l),this._loadTile(m,this._tileLoaded.bind(this,m,r,l)))}_tileLoaded(r,l,m,x){if(x)if(r.state="errored",x.status!==404)this._source.fire(new i.y(x,{tile:r}));else{if(this._source.fire(new i.z("data",{dataType:"source",sourceDataType:"error",sourceId:this._source.id,tile:r})),!(r.tileID.key in this._loadedParentTiles))return;if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const b=this.map.painter.terrain;this.update(this.transform,b.getScaledDemTileSize(),!0),b.resetTileLookupCache(this.id)}else this.update(this.transform)}else r.timeAdded=i.q.now(),m==="expired"&&(r.refreshedUponExpiration=!0),this._setTileReloadTimer(l,r),this._source.type==="raster-dem"&&r.dem&&this._backfillDEM(r),this._state.initializeTileState(r,this.map?this.map.painter:null),this._source.fire(new i.z("data",{dataType:"source",tile:r,coord:r.tileID,sourceCacheId:this.id}))}_backfillDEM(r){const l=this.getRenderableIds();for(let x=0;x<l.length;x++){const b=l[x];if(r.neighboringTiles&&r.neighboringTiles[b]){const A=this.getTileByID(b);m(r,A),m(A,r)}}function m(x,b){if(!x.dem||x.dem.borderReady)return;x.needsHillshadePrepare=!0,x.needsDEMTextureUpload=!0;let A=b.tileID.canonical.x-x.tileID.canonical.x;const R=b.tileID.canonical.y-x.tileID.canonical.y,N=Math.pow(2,x.tileID.canonical.z),U=b.tileID.key;A===0&&R===0||Math.abs(R)>1||(Math.abs(A)>1&&(Math.abs(A+N)===1?A+=N:Math.abs(A-N)===1&&(A-=N)),b.dem&&x.dem&&(x.dem.backfillBorder(b.dem,A,R),x.neighboringTiles&&x.neighboringTiles[U]&&(x.neighboringTiles[U].backfilled=!0)))}}getTile(r){return this.getTileByID(r.key)}getTileByID(r){return this._tiles[r]}_retainLoadedChildren(r,l,m,x){for(const b in this._tiles){let A=this._tiles[b];if(x[b]||!A.hasData()||A.tileID.overscaledZ<=l||A.tileID.overscaledZ>m)continue;let R=A.tileID;for(;A&&A.tileID.overscaledZ>l+1;){const U=A.tileID.scaledTo(A.tileID.overscaledZ-1);A=this._tiles[U.key],A&&A.hasData()&&(R=U)}let N=R;for(;N.overscaledZ>l;)if(N=N.scaledTo(N.overscaledZ-1),r[N.key]){x[R.key]=R;break}}}findLoadedParent(r,l){if(r.key in this._loadedParentTiles){const m=this._loadedParentTiles[r.key];return m&&m.tileID.overscaledZ>=l?m:null}for(let m=r.overscaledZ-1;m>=l;m--){const x=r.scaledTo(m),b=this._getLoadedTile(x);if(b)return b}}_getLoadedTile(r){const l=this._tiles[r.key];return l&&l.hasData()?l:this._cache.getByKey(this._source.reparseOverscaled?r.wrapped().key:r.canonical.key)}updateCacheSize(r,l){l=l||this._source.tileSize;const m=Math.ceil(r.width/l)+1,x=Math.ceil(r.height/l)+1,b=Math.floor(m*x*5),A=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,b):b,R=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,A):A;this._cache.setMaxSize(R)}handleWrapJump(r){const l=Math.round((r-(this._prevLng===void 0?r:this._prevLng))/360);if(this._prevLng=r,l){const m={};for(const x in this._tiles){const b=this._tiles[x];b.tileID=b.tileID.unwrapTo(b.tileID.wrap+l),m[b.tileID.key]=b}this._tiles=m;for(const x in this._timers)clearTimeout(this._timers[x]),delete this._timers[x];for(const x in this._tiles)this._setTileReloadTimer(+x,this._tiles[x])}}update(r,l,m,x){if(this.transform=r,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!m)return;this.updateCacheSize(r,l),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._shadowCasterTiles={},this._coveredTiles={};const b=this._source.type==="batched-model";let A,R=this._source.maxzoom;const N=this.map&&this.map.painter?this.map.painter._terrain:null;if(N&&N.sourceCache===this&&N.attenuationRange()){const Z=N.attenuationRange()[0],W=Math.floor(Z)-Math.log2(N.getDemUpscale());R>W&&(R=W)}if(this.used||this.usedForTerrain){if(this._source.tileID)A=r.getVisibleUnwrappedCoordinates(this._source.tileID).map(Z=>new i.aG(Z.canonical.z,Z.wrap,Z.canonical.z,Z.canonical.x,Z.canonical.y));else if(this.tileCoverLift!==0){const Z=r.clone();Z.tileCoverLift=this.tileCoverLift,A=Z.coveringTiles({tileSize:l||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:R,roundZoom:this._source.roundZoom&&!m,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:b}),this._source.minzoom<=1&&r.projection.name==="globe"&&(A.push(new i.aG(1,0,1,0,0)),A.push(new i.aG(1,0,1,1,0)),A.push(new i.aG(1,0,1,0,1)),A.push(new i.aG(1,0,1,1,1)))}else if(A=r.coveringTiles({tileSize:l||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:R,roundZoom:this._source.roundZoom&&!m,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:b}),this._source.hasTile){const Z=this._source.hasTile.bind(this._source);A=A.filter(W=>Z(W))}}else A=[];if(A.length>0&&this.castsShadows&&x&&this.transform.projection.name!=="globe"&&!this.usedForTerrain&&!ff(this._source.type)){const Z=r.coveringZoomLevel({tileSize:l||this._source.tileSize,roundZoom:this._source.roundZoom&&!m}),W=Math.min(Z,this._source.maxzoom);if(b){const ee=r.extendTileCover(A,W);for(const ue of ee)A.push(ue)}else{const ee=r.extendTileCover(A,W,x);for(const ue of ee)this._shadowCasterTiles[ue.key]=!0,A.push(ue)}}const U=this._updateRetainedTiles(A);if(ff(this._source.type)&&A.length!==0){const Z={},W={},ee=Object.keys(U);for(const oe of ee){const de=U[oe],fe=this._tiles[oe];if(!fe||fe.fadeEndTime&&fe.fadeEndTime<=i.q.now())continue;const Te=this.findLoadedParent(de,Math.max(de.overscaledZ-rs.maxOverzooming,this._source.minzoom));Te&&(this._addTile(Te.tileID),Z[Te.tileID.key]=Te.tileID),W[oe]=de}const ue=A[A.length-1].overscaledZ;for(const oe in this._tiles){const de=this._tiles[oe];if(U[oe]||!de.hasData())continue;let fe=de.tileID;for(;fe.overscaledZ>ue;){fe=fe.scaledTo(fe.overscaledZ-1);const Te=this._tiles[fe.key];if(Te&&Te.hasData()&&W[fe.key]){U[oe]=de.tileID;break}}}for(const oe in Z)U[oe]||(this._coveredTiles[oe]=!0,U[oe]=Z[oe])}for(const Z in U)this._tiles[Z].clearFadeHold();const $=i.bk(this._tiles,U);for(const Z of $){const W=this._tiles[Z];W.hasSymbolBuckets&&!W.holdingForFade()?W.setHoldDuration(this.map._fadeDuration):W.hasSymbolBuckets&&!W.symbolFadeFinished()||this._removeTile(+Z)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const r in this._tiles)this._tiles[r].holdingForFade()&&this._removeTile(+r)}_updateRetainedTiles(r){const l={};if(r.length===0)return l;const m={},x=r.reduce((U,$)=>Math.min(U,$.overscaledZ),1/0),b=r[0].overscaledZ,A=Math.max(b-rs.maxOverzooming,this._source.minzoom),R=Math.max(b+rs.maxUnderzooming,this._source.minzoom),N={};for(const U of r){const $=this._addTile(U);l[U.key]=U,$.hasData()||x<this._source.maxzoom&&(N[U.key]=U)}this._retainLoadedChildren(N,x,R,l);for(const U of r){let $=this._tiles[U.key];if($.hasData())continue;if(U.canonical.z>=this._source.maxzoom){const W=U.children(this._source.maxzoom)[0],ee=this.getTile(W);if(ee&&ee.hasData()){l[W.key]=W;continue}}else{const W=U.children(this._source.maxzoom);if(l[W[0].key]&&l[W[1].key]&&l[W[2].key]&&l[W[3].key])continue}let Z=$.wasRequested();for(let W=U.overscaledZ-1;W>=A;--W){const ee=U.scaledTo(W);if(m[ee.key]||(m[ee.key]=!0,$=this.getTile(ee),!$&&Z&&($=this._addTile(ee)),$&&(l[ee.key]=ee,Z=$.wasRequested(),$.hasData())))break}}return l}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const r in this._tiles){const l=[];let m,x=this._tiles[r].tileID;for(;x.overscaledZ>0;){if(x.key in this._loadedParentTiles){m=this._loadedParentTiles[x.key];break}l.push(x.key);const b=x.scaledTo(x.overscaledZ-1);if(m=this._getLoadedTile(b),m)break;x=b}for(const b of l)this._loadedParentTiles[b]=m}}_addTile(r){let l=this._tiles[r.key];if(l)return l.isExtraShadowCaster!==!0||this._shadowCasterTiles[r.key]||this._reloadTile(r.key,"reloading"),l;l=this._cache.getAndRemove(r),l&&(this._setTileReloadTimer(r.key,l),l.tileID=r,this._state.initializeTileState(l,this.map?this.map.painter:null),this._cacheTimers[r.key]&&(clearTimeout(this._cacheTimers[r.key]),delete this._cacheTimers[r.key],this._setTileReloadTimer(r.key,l)));const m=!!l;if(!m){const x=this.map?this.map.painter:null,b=this._source.tileSize*r.overscaleFactor();l=this._source.type==="raster-array"?new bl(r,b,this.transform.tileZoom,x,this._isRaster):new xl(r,b,this.transform.tileZoom,x,this._isRaster),this._loadTile(l,this._tileLoaded.bind(this,l,r.key,l.state))}return l?(l.uses++,this._tiles[r.key]=l,m||this._source.fire(new i.z("dataloading",{tile:l,coord:l.tileID,dataType:"source"})),l):null}_setTileReloadTimer(r,l){r in this._timers&&(clearTimeout(this._timers[r]),delete this._timers[r]);const m=l.getExpiryTimeout();m&&(this._timers[r]=setTimeout(()=>{this._reloadTile(r,"expired"),delete this._timers[r]},m))}_removeTile(r){const l=this._tiles[r];l&&(l.uses--,delete this._tiles[r],this._timers[r]&&(clearTimeout(this._timers[r]),delete this._timers[r]),l.uses>0||(l.hasData()&&l.state!=="reloading"||l.state==="empty"?this._cache.add(l.tileID,l,l.getExpiryTimeout()):(l.aborted=!0,this._abortTile(l),this._unloadTile(l))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const r in this._tiles)this._removeTile(+r);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(r,l,m){const x=[],b=this.transform;if(!b)return x;const A=b.projection.name==="globe",R=i.at(b.center.lng);for(const N in this._tiles){const U=this._tiles[N];if(m&&U.clearQueryDebugViz(),U.holdingForFade())continue;let $;if(A){const Z=U.tileID.canonical;if(Z.z===0){const W=[Math.abs(i.aw(R,...Mn(Z,-1))-R),Math.abs(i.aw(R,...Mn(Z,1))-R)];$=[0,2*W.indexOf(Math.min(...W))-1]}else{const W=[Math.abs(i.aw(R,...Mn(Z,-1))-R),Math.abs(i.aw(R,...Mn(Z,0))-R),Math.abs(i.aw(R,...Mn(Z,1))-R)];$=[W.indexOf(Math.min(...W))-1]}}else $=[0];for(const Z of $){const W=r.containsTile(U,b,l,Z);W&&x.push(W)}}return x}getShadowCasterCoordinates(){return this._getRenderableCoordinates(!1,!0)}getVisibleCoordinates(r){return this._getRenderableCoordinates(r)}_getRenderableCoordinates(r,l){const m=this.getRenderableIds(r,l).map(b=>this._tiles[b].tileID),x=this.transform.projection.name==="globe";for(const b of m)b.projMatrix=this.transform.calculateProjMatrix(b.toUnwrapped()),b.expandedProjMatrix=x?this.transform.calculateProjMatrix(b.toUnwrapped(),!1,!0):b.projMatrix;return m}sortCoordinatesByDistance(r){const l=r.slice(),m=this.transform._camera.position,x=this.transform._camera.forward(),b={};for(const A of l){const R=1/(1<<A.canonical.z);b[A.key]=((A.canonical.x+.5)*R+A.wrap-m[0])*x[0]+((A.canonical.y+.5)*R-m[1])*x[1]-m[2]*x[2]}return l.sort((A,R)=>b[A.key]-b[R.key]),l}hasTransition(){if(this._source.hasTransition())return!0;if(ff(this._source.type))for(const r in this._tiles){const l=this._tiles[r];if(l.fadeEndTime!==void 0&&l.fadeEndTime>=i.q.now())return!0}return!1}setFeatureState(r,l,m){this._state.updateState(r=r||"_geojsonTileLayer",l,m)}removeFeatureState(r,l,m){this._state.removeFeatureState(r=r||"_geojsonTileLayer",l,m)}getFeatureState(r,l){return this._state.getState(r=r||"_geojsonTileLayer",l)}setDependencies(r,l,m){const x=this._tiles[r];x&&x.setDependencies(l,m)}reloadTilesForDependencies(r,l){for(const m in this._tiles)this._tiles[m].hasDependency(r,l)&&this._reloadTile(+m,"reloading");this._cache.filter(m=>!m.hasDependency(r,l))}_preloadTiles(r,l){if(!this._sourceLoaded){const N=()=>{this._sourceLoaded&&(this._source.off("data",N),this._preloadTiles(r,l))};return void this._source.on("data",N)}const m=new Map,x=Array.isArray(r)?r:[r],b=this.map.painter.terrain,A=this.usedForTerrain&&b?b.getScaledDemTileSize():this._source.tileSize;for(const N of x){const U=N.coveringTiles({tileSize:A,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const $ of U)m.set($.key,$);this.usedForTerrain&&N.updateElevation(!1)}const R=Array.from(m.values());i.bl(R,(N,U)=>{const $=new xl(N,this._source.tileSize*N.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile($,Z=>{this._source.type==="raster-dem"&&$.dem&&this._backfillDEM($),U(Z,$)})},l)}}function _r(p,r){const l=Math.abs(2*p.wrap)-+(p.wrap<0),m=Math.abs(2*r.wrap)-+(r.wrap<0);return p.overscaledZ-r.overscaledZ||m-l||r.canonical.y-p.canonical.y||r.canonical.x-p.canonical.x}function ff(p){return p==="raster"||p==="image"||p==="video"||p==="custom"}function Mn(p,r){const l=1<<p.z;return[p.x/l+r,(p.x+1)/l+r]}rs.maxOverzooming=10,rs.maxUnderzooming=3;class ou{constructor(r){this.style=r,this.layersGotHidden=!1,this.layers=[]}processLayersChanged(){this.layers=[];const r=!1,l=!1;for(const m in this.style._mergedLayers){const x=this.style._mergedLayers[m];if(x.type==="fill-extrusion")this.layers.push({layer:x,visible:r,visibilityChanged:l});else if(x.type==="model"){const b=this.style.getLayerSource(x);b&&b.type==="batched-model"&&this.layers.push({layer:x,visible:r,visibilityChanged:l})}}}onNewFrame(r){this.layersGotHidden=!1;for(const l of this.layers){const m=l.layer;let x=!1;m.type==="fill-extrusion"?x=!m.isHidden(r)&&m.paint.get("fill-extrusion-opacity")>0:m.type==="model"&&(x=!m.isHidden(r)&&m.paint.get("model-opacity").constantOr(1)>0),this.layersGotHidden=this.layersGotHidden||!x&&l.visible,l.visible=x}}updateZOffset(r,l){this.currentBuildingBuckets=[];for(const x of this.layers){const b=x.layer,A=this.style.getLayerSourceCache(b);let R=1;b.type==="fill-extrusion"&&(R=x.visible?b.paint.get("fill-extrusion-vertical-scale"):0);let N=A?A.getTile(l):null;if(!N&&A&&l.canonical.z>A.getSource().minzoom){let U=l.scaledTo(Math.min(A.getSource().maxzoom,l.overscaledZ-1));for(;U.overscaledZ>=A.getSource().minzoom&&(N=A.getTile(U),!N&&U.overscaledZ!==0);)U=U.scaledTo(U.overscaledZ-1)}this.currentBuildingBuckets.push({bucket:N?N.getBucket(b):null,tileID:N?N.tileID:l,verticalScale:R})}r.hasAnyZOffset=!1;let m=!1;for(let x=0;x<r.symbolInstances.length;x++){const b=r.symbolInstances.get(x),A=b.zOffset,R=this._getHeightAtTileOffset(l,b.tileAnchorX,b.tileAnchorY);b.zOffset=R!==Number.NEGATIVE_INFINITY?R:A,m||A===b.zOffset||(m=!0),r.hasAnyZOffset||b.zOffset===0||(r.hasAnyZOffset=!0)}m&&(r.zOffsetBuffersNeedUpload=!0,r.zOffsetSortDirty=!0)}_mapCoordToOverlappingTile(r,l,m,x){let b=l,A=m;if(r.canonical.z!==x.canonical.z){const R=x.canonical,N=1/(1<<r.canonical.z-R.z);b=(l+r.canonical.x*i.ag)*N-R.x*i.ag|0,A=(m+r.canonical.y*i.ag)*N-R.y*i.ag|0}return{tileX:b,tileY:A}}_getHeightAtTileOffset(r,l,m){let x,b;for(let A=0;A<this.layers.length;++A){if(this.layers[A].layer.type!=="fill-extrusion")continue;const{bucket:R,tileID:N,verticalScale:U}=this.currentBuildingBuckets[A];if(!R)continue;const{tileX:$,tileY:Z}=this._mapCoordToOverlappingTile(r,l,m,N),W=R.getHeightAtTileCoord($,Z);W&&W.height!==void 0&&(W.hidden?x=W.height:b=Math.max(W.height*U,b||0))}if(b!==void 0)return b;for(let A=0;A<this.layers.length;++A){const R=this.layers[A];if(R.layer.type!=="model"||!R.visible)continue;const{bucket:N,tileID:U}=this.currentBuildingBuckets[A];if(!N)continue;const{tileX:$,tileY:Z}=this._mapCoordToOverlappingTile(r,l,m,U),W=N.getHeightAtTileCoord($,Z);if(W&&!W.hidden)return W.height===void 0&&x!==void 0?Math.min(W.maxHeight,x)*W.verticalScale:W.height?W.height*W.verticalScale:Number.NEGATIVE_INFINITY}return this.layersGotHidden?0:Number.NEGATIVE_INFINITY}}function wl(p,r){const l={};for(const m in p)m!=="ref"&&(l[m]=p[m]);return i.bm.forEach(m=>{m in r&&(l[m]=r[m])}),l}function df(p){p=p.slice();const r=Object.create(null);for(let l=0;l<p.length;l++)r[p[l].id]=p[l];for(let l=0;l<p.length;l++)"ref"in p[l]&&(p[l]=wl(p[l],r[p[l].ref]));return p}const Kn={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setSlot:"setSlot",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setSnow:"setSnow",setRain:"setRain",setCamera:"setCamera",setLights:"setLights",setProjection:"setProjection",addImport:"addImport",removeImport:"removeImport",updateImport:"updateImport"};function pf(p,r,l){l.push({command:Kn.addSource,args:[p,r[p]]})}function Cs(p,r,l){r.push({command:Kn.removeSource,args:[p]}),l[p]=!0}function _n(p,r,l,m){Cs(p,l,m),pf(p,r,l)}function xr(p,r,l){let m;for(m in p[l])if(p[l].hasOwnProperty(m)&&m!=="data"&&!i.bn(p[l][m],r[l][m]))return!1;for(m in r[l])if(r[l].hasOwnProperty(m)&&m!=="data"&&!i.bn(p[l][m],r[l][m]))return!1;return!0}function ar(p,r,l,m,x,b){let A;for(A in r=r||{},p=p||{})p.hasOwnProperty(A)&&(i.bn(p[A],r[A])||l.push({command:b,args:[m,A,r[A],x]}));for(A in r)r.hasOwnProperty(A)&&!p.hasOwnProperty(A)&&(i.bn(p[A],r[A])||l.push({command:b,args:[m,A,r[A],x]}))}function pa(p){return p.id}function is(p,r){return p[r.id]=r,p}class gr{constructor(r,l){this.reset(r,l)}reset(r,l){this.points=r||[],this._distances=[0];for(let m=1;m<this.points.length;m++)this._distances[m]=this._distances[m-1]+this.points[m].dist(this.points[m-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(l||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(r){if(this.points.length===1)return this.points[0];r=i.aw(r,0,1);let l=1,m=this._distances[l];const x=r*this.paddedLength+this.padding;for(;m<x&&l<this._distances.length;)m=this._distances[++l];const b=l-1,A=this._distances[b],R=m-A,N=R>0?(x-A)/R:0;return this.points[b].mult(1-N).add(this.points[l].mult(N))}}class ic{constructor(r,l,m){const x=this.boxCells=[],b=this.circleCells=[];this.xCellCount=Math.ceil(r/m),this.yCellCount=Math.ceil(l/m);for(let A=0;A<this.xCellCount*this.yCellCount;A++)x.push([]),b.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=r,this.height=l,this.xScale=this.xCellCount/r,this.yScale=this.yCellCount/l,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(r,l,m,x,b){this._forEachCell(l,m,x,b,this._insertBoxCell,this.boxUid++),this.boxKeys.push(r),this.bboxes.push(l),this.bboxes.push(m),this.bboxes.push(x),this.bboxes.push(b)}insertCircle(r,l,m,x){this._forEachCell(l-x,m-x,l+x,m+x,this._insertCircleCell,this.circleUid++),this.circleKeys.push(r),this.circles.push(l),this.circles.push(m),this.circles.push(x)}_insertBoxCell(r,l,m,x,b,A){this.boxCells[b].push(A)}_insertCircleCell(r,l,m,x,b,A){this.circleCells[b].push(A)}_query(r,l,m,x,b,A){if(m<0||r>this.width||x<0||l>this.height)return!b&&[];const R=[];if(r<=0&&l<=0&&this.width<=m&&this.height<=x){if(b)return!0;for(let N=0;N<this.boxKeys.length;N++)R.push({key:this.boxKeys[N],x1:this.bboxes[4*N],y1:this.bboxes[4*N+1],x2:this.bboxes[4*N+2],y2:this.bboxes[4*N+3]});for(let N=0;N<this.circleKeys.length;N++){const U=this.circles[3*N],$=this.circles[3*N+1],Z=this.circles[3*N+2];R.push({key:this.circleKeys[N],x1:U-Z,y1:$-Z,x2:U+Z,y2:$+Z})}return A?R.filter(A):R}return this._forEachCell(r,l,m,x,this._queryCell,R,{hitTest:b,seenUids:{box:{},circle:{}}},A),b?R.length>0:R}_queryCircle(r,l,m,x,b){const A=r-m,R=r+m,N=l-m,U=l+m;if(R<0||A>this.width||U<0||N>this.height)return!x&&[];const $=[];return this._forEachCell(A,N,R,U,this._queryCellCircle,$,{hitTest:x,circle:{x:r,y:l,radius:m},seenUids:{box:{},circle:{}}},b),x?$.length>0:$}query(r,l,m,x,b){return this._query(r,l,m,x,!1,b)}hitTest(r,l,m,x,b){return this._query(r,l,m,x,!0,b)}hitTestCircle(r,l,m,x){return this._queryCircle(r,l,m,!0,x)}_queryCell(r,l,m,x,b,A,R,N){const U=R.seenUids,$=this.boxCells[b];if($!==null){const W=this.bboxes;for(const ee of $)if(!U.box[ee]){U.box[ee]=!0;const ue=4*ee;if(r<=W[ue+2]&&l<=W[ue+3]&&m>=W[ue+0]&&x>=W[ue+1]&&(!N||N(this.boxKeys[ee]))){if(R.hitTest)return A.push(!0),!0;A.push({key:this.boxKeys[ee],x1:W[ue],y1:W[ue+1],x2:W[ue+2],y2:W[ue+3]})}}}const Z=this.circleCells[b];if(Z!==null){const W=this.circles;for(const ee of Z)if(!U.circle[ee]){U.circle[ee]=!0;const ue=3*ee;if(this._circleAndRectCollide(W[ue],W[ue+1],W[ue+2],r,l,m,x)&&(!N||N(this.circleKeys[ee]))){if(R.hitTest)return A.push(!0),!0;{const oe=W[ue],de=W[ue+1],fe=W[ue+2];A.push({key:this.circleKeys[ee],x1:oe-fe,y1:de-fe,x2:oe+fe,y2:de+fe})}}}}}_queryCellCircle(r,l,m,x,b,A,R,N){const U=R.circle,$=R.seenUids,Z=this.boxCells[b];if(Z!==null){const ee=this.bboxes;for(const ue of Z)if(!$.box[ue]){$.box[ue]=!0;const oe=4*ue;if(this._circleAndRectCollide(U.x,U.y,U.radius,ee[oe+0],ee[oe+1],ee[oe+2],ee[oe+3])&&(!N||N(this.boxKeys[ue])))return A.push(!0),!0}}const W=this.circleCells[b];if(W!==null){const ee=this.circles;for(const ue of W)if(!$.circle[ue]){$.circle[ue]=!0;const oe=3*ue;if(this._circlesCollide(ee[oe],ee[oe+1],ee[oe+2],U.x,U.y,U.radius)&&(!N||N(this.circleKeys[ue])))return A.push(!0),!0}}}_forEachCell(r,l,m,x,b,A,R,N){const U=this._convertToXCellCoord(r),$=this._convertToYCellCoord(l),Z=this._convertToXCellCoord(m),W=this._convertToYCellCoord(x);for(let ee=U;ee<=Z;ee++)for(let ue=$;ue<=W;ue++)if(b.call(this,r,l,m,x,this.xCellCount*ue+ee,A,R,N))return}_convertToXCellCoord(r){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(r*this.xScale)))}_convertToYCellCoord(r){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(r*this.yScale)))}_circlesCollide(r,l,m,x,b,A){const R=x-r,N=b-l,U=m+A;return U*U>R*R+N*N}_circleAndRectCollide(r,l,m,x,b,A,R){const N=(A-x)/2,U=Math.abs(r-(x+N));if(U>N+m)return!1;const $=(R-b)/2,Z=Math.abs(l-(b+$));if(Z>$+m)return!1;if(U<=N||Z<=$)return!0;const W=U-N,ee=Z-$;return W*W+ee*ee<=m*m}}const ko={unknown:0,flipRequired:1,flipNotRequired:2},nh=Math.tan(85*Math.PI/180);function Wr(p,r,l,m,x,b,A){const R=i.ab.mat4.create();if(l)if(b.name==="globe"){const N=i.bo(x,r);i.ab.mat4.multiply(R,R,N)}else{const N=i.ab.mat2.invert([],A);R[0]=N[0],R[1]=N[1],R[4]=N[2],R[5]=N[3],m||i.ab.mat4.rotateZ(R,R,x.angle)}else i.ab.mat4.multiply(R,x.labelPlaneMatrix,p);return R}function Xr(p,r,l,m,x,b,A){const R=Wr(p,r,l,m,x,b,A);return b.name==="globe"&&l||(R[2]=R[6]=R[10]=R[14]=0),R}function rh(p,r,l,m,x,b,A){if(l){if(b.name==="globe"){const R=Wr(p,r,l,m,x,b,A);return i.ab.mat4.invert(R,R),i.ab.mat4.multiply(R,p,R),R}{const R=i.ab.mat4.clone(p),N=i.ab.mat4.identity([]);return N[0]=A[0],N[1]=A[1],N[4]=A[2],N[5]=A[3],i.ab.mat4.multiply(R,R,N),m||i.ab.mat4.rotateZ(R,R,-x.angle),R}}return x.glCoordMatrix}function ma(p,r,l,m){const x=[p,r,l,1];l?i.ab.vec4.transformMat4(x,x,m):as(x,x,m);const b=x[3];return x[0]/=b,x[1]/=b,x[2]/=b,x}function Fd(p,r){return Math.min(.5+p/r*.5,1.5)}function su(p,r){const l=p[0]/p[3],m=p[1]/p[3];return l>=-r[0]&&l<=r[0]&&m>=-r[1]&&m<=r[1]}function ih(p,r,l,m,x,b,A,R,N,U){const $=l.transform,Z=m?p.textSizeData:p.iconSizeData,W=i.bp(Z,l.transform.zoom),ee=$.projection.name==="globe",ue=[256/l.width*2+1,256/l.height*2+1],oe=m?p.text.dynamicLayoutVertexArray:p.icon.dynamicLayoutVertexArray;oe.clear();let de=null;ee&&(de=m?p.text.globeExtVertexArray:p.icon.globeExtVertexArray);const fe=p.lineVertexArray,Te=m?p.text.placedSymbolArray:p.icon.placedSymbolArray,Pe=l.transform.width/l.transform.height;let Oe,Fe=!1;for(let Re=0;Re<Te.length;Re++){const ke=Te.get(Re),{numGlyphs:De,writingMode:$e}=ke;if($e!==i.bq.vertical||Fe||Oe===i.bq.horizontal||(Fe=!0),Oe=$e,(ke.hidden||$e===i.bq.vertical)&&!Fe){ai(De,oe);continue}Fe=!1;const Xe=new i.P(ke.tileAnchorX,ke.tileAnchorY);let{x:ft,y:ot,z:Et}=$.projection.projectTilePoint(Xe.x,Xe.y,U.canonical);if(N){const[At,kt,Wt]=N(Xe);ft+=At,ot+=kt,Et+=Wt}const vt=[ft,ot,Et,1];if(i.ab.vec4.transformMat4(vt,vt,r),!su(vt,ue)){ai(De,oe);continue}const nt=vt[3],pt=Fd(l.transform.getCameraToCenterDistance($.projection),nt),Lt=i.br(Z,W,ke),tt=A?Lt/pt:Lt*pt,St=ma(ft,ot,Et,x);if(St[3]<=0){ai(De,oe);continue}let mt={};const Gt=A?null:N,Pt=Ms(ke,tt,!1,R,r,x,b,p.glyphOffsetArray,fe,oe,de,St,Xe,mt,Pe,Gt,$.projection,U,A);Fe=Pt.useVertical,Gt&&Pt.needsFlipping&&(mt={}),(Pt.notEnoughRoom||Fe||Pt.needsFlipping&&Ms(ke,tt,!0,R,r,x,b,p.glyphOffsetArray,fe,oe,de,St,Xe,mt,Pe,Gt,$.projection,U,A).notEnoughRoom)&&ai(De,oe)}m?(p.text.dynamicLayoutVertexBuffer.updateData(oe),de&&p.text.globeExtVertexBuffer&&p.text.globeExtVertexBuffer.updateData(de)):(p.icon.dynamicLayoutVertexBuffer.updateData(oe),de&&p.icon.globeExtVertexBuffer&&p.icon.globeExtVertexBuffer.updateData(de))}function Sl(p,r,l,m,x,b,A,R,N,U,$,Z,W,ee,ue,oe){const{lineStartIndex:de,glyphStartIndex:fe,segment:Te}=R,Pe=fe+R.numGlyphs,Oe=de+R.lineLength,Fe=r.getoffsetX(fe),Re=r.getoffsetX(Pe-1),ke=Tl(p*Fe,l,m,x,b,A,Te,de,Oe,N,U,$,Z,W,!0,ee,ue,oe);if(!ke)return null;const De=Tl(p*Re,l,m,x,b,A,Te,de,Oe,N,U,$,Z,W,!0,ee,ue,oe);return De?{first:ke,last:De}:null}function ta(p,r,l,m){return p===i.bq.horizontal&&Math.abs(m)>Math.abs(l)?{useVertical:!0}:p===i.bq.vertical?m>0?{needsFlipping:!0}:null:r!==ko.unknown&&function(x,b){return x===0||Math.abs(b/x)>nh}(l,m)?r===ko.flipRequired?{needsFlipping:!0}:null:l<0?{needsFlipping:!0}:null}function Ms(p,r,l,m,x,b,A,R,N,U,$,Z,W,ee,ue,oe,de,fe,Te){const Pe=r/24,Oe=p.lineOffsetX*Pe,Fe=p.lineOffsetY*Pe,{lineStartIndex:Re,glyphStartIndex:ke,numGlyphs:De,segment:$e,writingMode:Xe,flipState:ft}=p,ot=Re+p.lineLength,Et=vt=>{if($){const[tt,St,mt]=vt.up,Gt=U.length;i.bs($,Gt+0,tt,St,mt),i.bs($,Gt+1,tt,St,mt),i.bs($,Gt+2,tt,St,mt),i.bs($,Gt+3,tt,St,mt)}const[nt,pt,Lt]=vt.point;i.bt(U,nt,pt,Lt,vt.angle)};if(De>1){const vt=Sl(Pe,R,Oe,Fe,l,Z,W,p,N,b,ee,oe,!1,de,fe,Te);if(!vt)return{notEnoughRoom:!0};if(m&&!l){let[nt,pt,Lt]=vt.first.point,[tt,St,mt]=vt.last.point;[nt,pt]=ma(nt,pt,Lt,A),[tt,St]=ma(tt,St,mt,A);const Gt=ta(Xe,ft,(tt-nt)*ue,St-pt);if(p.flipState=Gt&&Gt.needsFlipping?ko.flipRequired:ko.flipNotRequired,Gt)return Gt}Et(vt.first);for(let nt=ke+1;nt<ke+De-1;nt++){const pt=Tl(Pe*R.getoffsetX(nt),Oe,Fe,l,Z,W,$e,Re,ot,N,b,ee,oe,!1,!1,de,fe,Te);if(!pt)return U.length-=4*(nt-ke),{notEnoughRoom:!0};Et(pt)}Et(vt.last)}else{if(m&&!l){const nt=ma(W.x,W.y,0,x),pt=Re+$e+1,Lt=new i.P(N.getx(pt),N.gety(pt)),tt=ma(Lt.x,Lt.y,0,x),St=tt[3]>0?tt:tm(W,Lt,nt,1,x,void 0,de,fe.canonical),mt=ta(Xe,ft,(St[0]-nt[0])*ue,St[1]-nt[1]);if(p.flipState=mt&&mt.needsFlipping?ko.flipRequired:ko.flipNotRequired,mt)return mt}const vt=Tl(Pe*R.getoffsetX(ke),Oe,Fe,l,Z,W,$e,Re,ot,N,b,ee,oe,!1,!1,de,fe,Te);if(!vt)return{notEnoughRoom:!0};Et(vt)}return{}}function Oa(p,r,l,m,x){const{x:b,y:A,z:R}=m.projectTilePoint(p.x,p.y,r);if(!x)return ma(b,A,R,l);const[N,U,$]=x(p);return ma(b+N,A+U,R+$,l)}function tm(p,r,l,m,x,b,A,R){const N=Oa(p.sub(r)._unit()._add(p),R,x,A,b);return i.ab.vec3.sub(N,l,N),i.ab.vec3.normalize(N,N),i.ab.vec3.scaleAndAdd(N,l,N,m)}function Tl(p,r,l,m,x,b,A,R,N,U,$,Z,W,ee,ue,oe,de,fe){const Te=m?p-r:p+r;let Pe=Te>0?1:-1,Oe=0;m&&(Pe*=-1,Oe=Math.PI),Pe<0&&(Oe+=Math.PI);let Fe=R+A+(Pe>0?0:1)|0,Re=x,ke=x,De=0,$e=0;const Xe=Math.abs(Te),ft=[],ot=[];let Et=b,vt=Et;const nt=()=>tm(vt,Et,ke,Xe-De+1,$,W,oe,de.canonical);for(;De+$e<=Xe;){if(Fe+=Pe,Fe<R||Fe>=N)return null;if(ke=Re,vt=Et,ft.push(ke),ee&&ot.push(vt),Et=new i.P(U.getx(Fe),U.gety(Fe)),Re=Z[Fe],!Re){const kt=Oa(Et,de.canonical,$,oe,W);Re=kt[3]>0?Z[Fe]=kt:nt()}De+=$e,$e=i.ab.vec3.distance(ke,Re)}ue&&W&&(Z[Fe]&&(Re=nt(),$e=i.ab.vec3.distance(ke,Re)),Z[Fe]=Re);const pt=(Xe-De)/$e,Lt=Et.sub(vt)._mult(pt)._add(vt),tt=i.ab.vec3.sub([],Re,ke),St=i.ab.vec3.scaleAndAdd([],ke,tt,pt);let mt=[0,0,1],Gt=tt[0],Pt=tt[1];if(fe&&(mt=oe.upVector(de.canonical,Lt.x,Lt.y),mt[0]!==0||mt[1]!==0||mt[2]!==1)){const kt=[mt[2],0,-mt[0]],Wt=i.ab.vec3.cross([],mt,kt);i.ab.vec3.normalize(kt,kt),i.ab.vec3.normalize(Wt,Wt),Gt=i.ab.vec3.dot(tt,kt),Pt=i.ab.vec3.dot(tt,Wt)}if(l){const kt=i.ab.vec3.cross([],mt,tt);i.ab.vec3.normalize(kt,kt),i.ab.vec3.scaleAndAdd(St,St,kt,l*Pe)}const At=Oe+Math.atan2(Pt,Gt);return ft.push(St),ee&&ot.push(Lt),{point:St,angle:At,path:ft,tilePath:ot,up:mt}}function ai(p,r){const l=r.length,m=l+4*p;r.resize(m),r.float32.fill(-1/0,4*l,4*m)}function as(p,r,l){const m=r[0],x=r[1];return p[0]=l[0]*m+l[4]*x+l[12],p[1]=l[1]*m+l[5]*x+l[13],p[3]=l[3]*m+l[7]*x+l[15],p}const _a=100;class Pi{constructor(r,l,m=new ic(r.width+200,r.height+200,25),x=new ic(r.width+200,r.height+200,25)){this.transform=r,this.grid=m,this.ignoredGrid=x,this.pitchfactor=Math.cos(r._pitch)*r.cameraToCenterDistance,this.screenRightBoundary=r.width+_a,this.screenBottomBoundary=r.height+_a,this.gridRightBoundary=r.width+200,this.gridBottomBoundary=r.height+200,this.fogState=l}placeCollisionBox(r,l,m,x,b,A,R,N){let U=m.projectedAnchorX,$=m.projectedAnchorY,Z=m.projectedAnchorZ;const W=m.elevation,ee=m.tileID,ue=r.getProjection();if(W&&ee){const[Re,ke,De]=ue.upVector(ee.canonical,m.tileAnchorX,m.tileAnchorY),$e=ue.upVectorScale(ee.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;U+=Re*W*$e,$+=ke*W*$e,Z+=De*W*$e}const oe=this.projectAndGetPerspectiveRatio(R,U,$,Z,m.tileID,ue.name==="globe"||!!W||this.transform.pitch>0,ue),de=A*oe.perspectiveRatio,fe=(m.x1*l+x.x-m.padding)*de+oe.point.x,Te=(m.y1*l+x.y-m.padding)*de+oe.point.y,Pe=(m.x2*l+x.x+m.padding)*de+oe.point.x,Oe=(m.y2*l+x.y+m.padding)*de+oe.point.y,Fe=oe.perspectiveRatio<=.55||oe.occluded;return!this.isInsideGrid(fe,Te,Pe,Oe)||!b&&this.grid.hitTest(fe,Te,Pe,Oe,N)||Fe?{box:[],offscreen:!1,occluded:oe.occluded}:{box:[fe,Te,Pe,Oe],offscreen:this.isOffscreen(fe,Te,Pe,Oe),occluded:!1}}placeCollisionCircles(r,l,m,x,b,A,R,N,U,$,Z,W,ee,ue,oe){const de=[],fe=this.transform.elevation,Te=r.getProjection(),Pe=fe?fe.getAtTileOffsetFunc(oe,this.transform.center.lat,this.transform.worldSize,Te):null,Oe=new i.P(m.tileAnchorX,m.tileAnchorY);let{x:Fe,y:Re,z:ke}=Te.projectTilePoint(Oe.x,Oe.y,oe.canonical);if(Pe){const[Lt,tt,St]=Pe(Oe);Fe+=Lt,Re+=tt,ke+=St}const De=Te.name==="globe",$e=this.projectAndGetPerspectiveRatio(R,Fe,Re,ke,oe,De||!!fe||this.transform.pitch>0,Te),{perspectiveRatio:Xe}=$e,ft=(Z?A/Xe:A*Xe)/i.bw,ot=ma(Fe,Re,ke,N),Et=$e.signedDistanceFromCamera>0?Sl(ft,b,m.lineOffsetX*ft,m.lineOffsetY*ft,!1,ot,Oe,m,x,N,{},fe&&!Z?Pe:null,Z&&!!fe,Te,oe,Z):null;let vt=!1,nt=!1,pt=!0;if(Et&&!$e.occluded){const Lt=.5*ee*Xe+ue,tt=new i.P(-100,-100),St=new i.P(this.screenRightBoundary,this.screenBottomBoundary),mt=new gr,{first:Gt,last:Pt}=Et,At=Gt.path.length;let kt=[];for(let dn=At-1;dn>=1;dn--)kt.push(Gt.path[dn]);for(let dn=1;dn<Pt.path.length;dn++)kt.push(Pt.path[dn]);const Wt=2.5*Lt;U&&(kt=kt.map(([dn,En,Sn],bn)=>(Pe&&!De&&(Sn=Pe(bn<At-1?Gt.tilePath[At-1-bn]:Pt.tilePath[bn-At+2])[2]),ma(dn,En,Sn,U))),kt.some(dn=>dn[3]<=0)&&(kt=[]));let on=[];if(kt.length>0){let dn=1/0,En=-1/0,Sn=1/0,bn=-1/0;for(const Ln of kt)dn=Math.min(dn,Ln[0]),Sn=Math.min(Sn,Ln[1]),En=Math.max(En,Ln[0]),bn=Math.max(bn,Ln[1]);En>=tt.x&&dn<=St.x&&bn>=tt.y&&Sn<=St.y&&(on=[kt.map(Ln=>new i.P(Ln[0],Ln[1]))],(dn<tt.x||En>St.x||Sn<tt.y||bn>St.y)&&(on=i.bu(on,tt.x,tt.y,St.x,St.y)))}for(const dn of on){mt.reset(dn,.25*Lt);let En=0;En=mt.length<=.5*Lt?1:Math.ceil(mt.paddedLength/Wt)+1;for(let Sn=0;Sn<En;Sn++){const bn=Sn/Math.max(En-1,1),Ln=mt.lerp(bn),zn=Ln.x+_a,Mr=Ln.y+_a;de.push(zn,Mr,Lt,0);const ui=zn-Lt,qr=Mr-Lt,Fn=zn+Lt,mr=Mr+Lt;if(pt=pt&&this.isOffscreen(ui,qr,Fn,mr),nt=nt||this.isInsideGrid(ui,qr,Fn,mr),!l&&this.grid.hitTestCircle(zn,Mr,Lt,W)&&(vt=!0,!$))return{circles:[],offscreen:!1,collisionDetected:vt,occluded:!1}}}}return{circles:!$&&vt||!nt?[]:de,offscreen:pt,collisionDetected:vt,occluded:$e.occluded}}queryRenderedSymbols(r){if(r.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const l=[];let m=1/0,x=1/0,b=-1/0,A=-1/0;for(const $ of r){const Z=new i.P($.x+_a,$.y+_a);m=Math.min(m,Z.x),x=Math.min(x,Z.y),b=Math.max(b,Z.x),A=Math.max(A,Z.y),l.push(Z)}const R=this.grid.query(m,x,b,A).concat(this.ignoredGrid.query(m,x,b,A)),N={},U={};for(const $ of R){const Z=$.key;if(N[Z.bucketInstanceId]===void 0&&(N[Z.bucketInstanceId]={}),N[Z.bucketInstanceId][Z.featureIndex])continue;const W=[new i.P($.x1,$.y1),new i.P($.x2,$.y1),new i.P($.x2,$.y2),new i.P($.x1,$.y2)];i.bv(l,W)&&(N[Z.bucketInstanceId][Z.featureIndex]=!0,U[Z.bucketInstanceId]===void 0&&(U[Z.bucketInstanceId]=[]),U[Z.bucketInstanceId].push(Z.featureIndex))}return U}insertCollisionBox(r,l,m,x,b){(l?this.ignoredGrid:this.grid).insert({bucketInstanceId:m,featureIndex:x,collisionGroupID:b},r[0],r[1],r[2],r[3])}insertCollisionCircles(r,l,m,x,b){const A=l?this.ignoredGrid:this.grid,R={bucketInstanceId:m,featureIndex:x,collisionGroupID:b};for(let N=0;N<r.length;N+=4)A.insertCircle(R,r[N],r[N+1],r[N+2])}projectAndGetPerspectiveRatio(r,l,m,x,b,A,R){const N=[l,m,x,1];let U=!1;x||this.transform.pitch>0?(i.ab.vec4.transformMat4(N,N,r),this.fogState&&b&&R.name!=="globe"&&(U=function(W,ee,ue,oe,de,fe){const Te=fe.calculateFogTileMatrix(de),Pe=[ee,ue,oe];return i.ab.vec3.transformMat4(Pe,Pe,Te),We(W,i.ab.vec3.length(Pe),fe.pitch,fe._fov)}(this.fogState,l,m,x,b.toUnwrapped(),this.transform)>.9)):as(N,N,r);const $=N[3];return{point:new i.P((N[0]/$+1)/2*this.transform.width+_a,(-N[1]/$+1)/2*this.transform.height+_a),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(R)/$*.5,1.5),signedDistanceFromCamera:$,occluded:A&&N[2]>$||U}}isOffscreen(r,l,m,x){return m<_a||r>=this.screenRightBoundary||x<_a||l>this.screenBottomBoundary}isInsideGrid(r,l,m,x){return m>=0&&r<this.gridRightBoundary&&x>=0&&l<this.gridBottomBoundary}getViewportMatrix(){const r=i.ab.mat4.identity([]);return i.ab.mat4.translate(r,r,[-100,-100,0]),r}}function mf(p,r,l){const m=r.createTileMatrix(p,p.worldSize,l.toUnwrapped());return i.ab.mat4.multiply(new Float32Array(16),p.projMatrix,m)}function Os(p,r,l){if(r.projection.name===l.projection.name)return p.projMatrix;const m=l.clone();return m.setProjection(r.projection),mf(m,r.getProjection(),p)}function ac(p,r,l){return r.name===l.projection.name?p.projMatrix:mf(l,r,p)}class _f{constructor(r,l,m,x){this.opacity=r?Math.max(0,Math.min(1,r.opacity+(r.placed?l:-l))):x&&m?1:0,this.placed=m}isHidden(){return this.opacity===0&&!this.placed}}class Is{constructor(r,l,m,x,b,A=!1){this.text=new _f(r?r.text:null,l,m,b),this.icon=new _f(r?r.icon:null,l,x,b),this.clipped=A}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class nm{constructor(r,l,m,x=!1){this.text=r,this.icon=l,this.skipFade=m,this.clipped=x}}class El{constructor(){this.invProjMatrix=i.ab.mat4.create(),this.viewportMatrix=i.ab.mat4.create(),this.circles=[]}}class rm{constructor(r,l,m,x,b){this.bucketInstanceId=r,this.featureIndex=l,this.sourceLayerIndex=m,this.bucketIndex=x,this.tileID=b}}class im{constructor(r){this.crossSourceCollisions=r,this.maxGroupID=0,this.collisionGroups={}}get(r){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[r]){const l=++this.maxGroupID;this.collisionGroups[r]={ID:l,predicate:m=>m.collisionGroupID===l}}return this.collisionGroups[r]}}function so(p,r,l,m,x){const{horizontalAlign:b,verticalAlign:A}=i.bD(p),R=-(b-.5)*r,N=-(A-.5)*l,U=i.bC(p,m);return new i.P(R+U[0]*x,N+U[1]*x)}function am(p,r,l,m,x){const b=new i.P(p,r);return l&&b._rotate(m?x:-x),b}class gf{constructor(r,l,m,x,b,A){this.transform=r.clone(),this.projection=r.projection.name,this.collisionIndex=new Pi(this.transform,b),this.buildingIndex=A,this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=l,this.retainedQueryData={},this.collisionGroups=new im(m),this.collisionCircleArrays={},this.prevPlacement=x,x&&(x.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(r,l,m,x,b=1){const A=m.getBucket(l),R=m.latestFeatureIndex;if(!A||!R||l.fqid!==A.layerIds[0])return;const N=A.layers[0].layout,U=A.layers[0].paint,$=m.collisionBoxArray,Z=Math.pow(2,this.transform.zoom-m.tileID.overscaledZ),W=m.tileSize/i.ag,ee=m.tileID.toUnwrapped();this.transform.setProjection(A.projection);const ue=(oe=m.tileID,de=A.getProjection(),fe=this.transform,de.name===this.projection?fe.calculateProjMatrix(oe.toUnwrapped()):mf(fe,de,oe));var oe,de,fe;const Te=N.get("text-pitch-alignment")==="map",Pe=N.get("text-rotation-alignment")==="map";l.compileFilter(l.options);const Oe=l.dynamicFilter(),Fe=l.dynamicFilterNeedsFeature(),Re=this.transform.calculatePixelsToTileUnitsMatrix(m),ke=Xr(ue,m.tileID.canonical,Te,Pe,this.transform,A.getProjection(),Re);let De=null;if(Te){const Lt=rh(ue,m.tileID.canonical,Te,Pe,this.transform,A.getProjection(),Re);De=i.ab.mat4.multiply([],this.transform.labelPlaneMatrix,Lt)}let $e=null;Oe&&m.latestFeatureIndex&&($e={unwrappedTileID:ee,dynamicFilter:Oe,dynamicFilterNeedsFeature:Fe}),this.retainedQueryData[A.bucketInstanceId]=new rm(A.bucketInstanceId,R,A.sourceLayerIndex,A.index,m.tileID);const[Xe,ft]=A.layers[0].layout.get("text-size-scale-range"),ot=i.aw(b,Xe,ft),[Et,vt]=N.get("icon-size-scale-range"),nt=i.aw(b,Et,vt),pt={bucket:A,layout:N,paint:U,posMatrix:ue,textLabelPlaneMatrix:ke,labelToScreenMatrix:De,clippingData:$e,scale:Z,textPixelRatio:W,holdingForFade:m.holdingForFade(),collisionBoxArray:$,partiallyEvaluatedTextSize:i.bp(A.textSizeData,this.transform.zoom,ot),partiallyEvaluatedIconSize:i.bp(A.iconSizeData,this.transform.zoom,nt),collisionGroup:this.collisionGroups.get(A.sourceID),latestFeatureIndex:m.latestFeatureIndex};if(x)for(const Lt of A.sortKeyRanges){const{sortKey:tt,symbolInstanceStart:St,symbolInstanceEnd:mt}=Lt;r.push({sortKey:tt,symbolInstanceStart:St,symbolInstanceEnd:mt,parameters:pt})}else r.push({symbolInstanceStart:0,symbolInstanceEnd:A.symbolInstances.length,parameters:pt})}attemptAnchorPlacement(r,l,m,x,b,A,R,N,U,$,Z,W,ee,ue,oe,de,fe,Te){const{textOffset0:Pe,textOffset1:Oe,crossTileID:Fe}=W,Re=[Pe,Oe],ke=so(r,m,x,Re,b),De=this.collisionIndex.placeCollisionBox(ue,b,l,am(ke.x,ke.y,A,R,this.transform.angle),Z,N,U,$.predicate);if(de){const $e=ue.getSymbolInstanceIconSize(Te,this.transform.zoom,W.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(ue,$e,de,am(ke.x,ke.y,A,R,this.transform.angle),Z,N,U,$.predicate).box.length===0)return}if(De.box.length>0){let $e;return this.prevPlacement&&this.prevPlacement.variableOffsets[Fe]&&this.prevPlacement.placements[Fe]&&this.prevPlacement.placements[Fe].text&&($e=this.prevPlacement.variableOffsets[Fe].anchor),this.variableOffsets[Fe]={textOffset:Re,width:m,height:x,anchor:r,textScale:b,prevAnchor:$e},this.markUsedJustification(ue,r,W,oe),ue.allowVerticalPlacement&&(this.markUsedOrientation(ue,oe,W),this.placedOrientations[Fe]=oe),{shift:ke,placedGlyphBoxes:De}}}placeLayerBucketPart(r,l,m,x,b=1){const{bucket:A,layout:R,paint:N,posMatrix:U,textLabelPlaneMatrix:$,labelToScreenMatrix:Z,clippingData:W,textPixelRatio:ee,holdingForFade:ue,collisionBoxArray:oe,partiallyEvaluatedTextSize:de,partiallyEvaluatedIconSize:fe,collisionGroup:Te,latestFeatureIndex:Pe}=r.parameters,Oe=R.get("text-optional"),Fe=R.get("icon-optional"),Re=R.get("text-allow-overlap"),ke=R.get("icon-allow-overlap"),De=R.get("text-rotation-alignment")==="map",$e=R.get("text-pitch-alignment")==="map",Xe=R.get("symbol-z-elevate"),ft=N.get("symbol-z-offset"),ot=R.get("symbol-elevation-reference")==="sea",[Et,vt]=R.get("text-size-scale-range"),[nt,pt]=R.get("icon-size-scale-range"),Lt=i.aw(b,Et,vt),tt=i.aw(b,nt,pt);this.transform.setProjection(A.projection);let St=Re&&(ke||!A.hasIconData()||Fe),mt=ke&&(Re||!A.hasTextData()||Oe);const Gt=!ft.isConstant();!A.collisionArrays&&oe&&A.deserializeCollisionBoxes(oe),m&&x&&A.updateCollisionDebugBuffers(this.transform.zoom,oe,Lt,tt);const Pt=(At,kt,Wt)=>{const{crossTileID:on,numVerticalGlyphVertices:dn}=At;let En=null;if(W&&W.dynamicFilterNeedsFeature||Gt){const Tr=this.retainedQueryData[A.bucketInstanceId];En=Pe.loadFeature({featureIndex:At.featureIndex,bucketIndex:Tr.bucketIndex,sourceLayerIndex:Tr.sourceLayerIndex,layoutVertexArrayOffset:0})}if(W&&!(0,W.dynamicFilter)({zoom:this.transform.zoom,pitch:this.transform.pitch},En,this.retainedQueryData[A.bucketInstanceId].tileID.canonical,new i.P(At.tileAnchorX,At.tileAnchorY),this.transform.calculateDistanceTileData(W.unwrappedTileID)))return this.placements[on]=new nm(!1,!1,!1,!0),void l.add(on);const Sn=ft.evaluate(En,{});if(l.has(on))return;if(ue)return void(this.placements[on]=new nm(!1,!1,!1));let bn=!1,Ln=!1,zn=!0,Mr=!1,ui=!1,qr=null,Fn={box:null,offscreen:null,occluded:null},mr={box:null},sn=null,In=null,An=null,Pn=0,or=0,Gr=0;Wt.textFeatureIndex?Pn=Wt.textFeatureIndex:At.useRuntimeCollisionCircles&&(Pn=At.featureIndex),Wt.verticalTextFeatureIndex&&(or=Wt.verticalTextFeatureIndex);const Kr=Tr=>{Tr.tileID=this.retainedQueryData[A.bucketInstanceId].tileID;const Sr=this.transform.elevation;Tr.elevation=ot?Sn:Sn+(Sr?Sr.getAtTileOffset(Tr.tileID,Tr.tileAnchorX,Tr.tileAnchorY):0),Tr.elevation+=At.zOffset},hi=Wt.textBox;if(hi){Kr(hi);const Tr=cr=>{let Nr=i.bq.horizontal;if(A.allowVerticalPlacement&&!cr&&this.prevPlacement){const xi=this.prevPlacement.placedOrientations[on];xi&&(this.placedOrientations[on]=xi,Nr=xi,this.markUsedOrientation(A,Nr,At))}return Nr},Sr=(cr,Nr)=>{if(A.allowVerticalPlacement&&dn>0&&Wt.verticalTextBox){for(const xi of A.writingModes)if(xi===i.bq.vertical?(Fn=Nr(),mr=Fn):Fn=cr(),Fn&&Fn.box&&Fn.box.length)break}else Fn=cr()};if(R.get("text-variable-anchor")){let cr=R.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[on]){const Or=this.prevPlacement.variableOffsets[on];cr.indexOf(Or.anchor)>0&&(cr=cr.filter(bi=>bi!==Or.anchor),cr.unshift(Or.anchor))}const Nr=(Or,bi,Mo)=>{const Qa=A.getSymbolInstanceTextSize(de,At,this.transform.zoom,kt),ka=(Or.x2-Or.x1)*Qa+2*Or.padding,Go=(Or.y2-Or.y1)*Qa+2*Or.padding,Sa=At.hasIconTextFit&&!ke?bi:null;Sa&&Kr(Sa);let eo={box:[],offscreen:!1,occluded:!1};const Ho=Re?2*cr.length:cr.length;for(let Oo=0;Oo<Ho;++Oo){const Ul=this.attemptAnchorPlacement(cr[Oo%cr.length],Or,ka,Go,Qa,De,$e,ee,U,Te,Oo>=cr.length,At,kt,A,Mo,Sa,de,fe);if(Ul&&(eo=Ul.placedGlyphBoxes,eo&&eo.box&&eo.box.length)){bn=!0,qr=Ul.shift;break}}return eo};Sr(()=>Nr(hi,Wt.iconBox,i.bq.horizontal),()=>{const Or=Wt.verticalTextBox;return Or&&Kr(Or),A.allowVerticalPlacement&&!(Fn&&Fn.box&&Fn.box.length)&&dn>0&&Or?Nr(Or,Wt.verticalIconBox,i.bq.vertical):{box:null,offscreen:null,occluded:null}}),Fn&&(bn=Fn.box,zn=Fn.offscreen,Mr=Fn.occluded);const xi=Tr(!(!Fn||!Fn.box));if(!bn&&this.prevPlacement){const Or=this.prevPlacement.variableOffsets[on];Or&&(this.variableOffsets[on]=Or,this.markUsedJustification(A,Or.anchor,At,xi))}}else{const cr=(Nr,xi)=>{const Or=A.getSymbolInstanceTextSize(de,At,this.transform.zoom,kt,b),bi=this.collisionIndex.placeCollisionBox(A,Or,Nr,new i.P(0,0),Re,ee,U,Te.predicate);return bi&&bi.box&&bi.box.length&&(this.markUsedOrientation(A,xi,At),this.placedOrientations[on]=xi),bi};Sr(()=>cr(hi,i.bq.horizontal),()=>{const Nr=Wt.verticalTextBox;return A.allowVerticalPlacement&&dn>0&&Nr?(Kr(Nr),cr(Nr,i.bq.vertical)):{box:null,offscreen:null,occluded:null}}),Tr(!!(Fn&&Fn.box&&Fn.box.length))}}if(sn=Fn,bn=sn&&sn.box&&sn.box.length>0,zn=sn&&sn.offscreen,Mr=sn&&sn.occluded,At.useRuntimeCollisionCircles){const Tr=A.text.placedSymbolArray.get(At.centerJustifiedTextSymbolIndex>=0?At.centerJustifiedTextSymbolIndex:At.verticalPlacedTextSymbolIndex),Sr=i.br(A.textSizeData,de,Tr),cr=R.get("text-padding");In=this.collisionIndex.placeCollisionCircles(A,Re,Tr,A.lineVertexArray,A.glyphOffsetArray,Sr,U,$,Z,m,$e,Te.predicate,At.collisionCircleDiameter*Sr/i.bw,cr,this.retainedQueryData[A.bucketInstanceId].tileID),bn=Re||In.circles.length>0&&!In.collisionDetected,zn=zn&&In.offscreen,Mr=In.occluded}if(Wt.iconFeatureIndex&&(Gr=Wt.iconFeatureIndex),Wt.iconBox){const Tr=Sr=>{Kr(Sr);const cr=At.hasIconTextFit&&qr?am(qr.x,qr.y,De,$e,this.transform.angle):new i.P(0,0),Nr=A.getSymbolInstanceIconSize(fe,this.transform.zoom,At.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(A,Nr,Sr,cr,ke,ee,U,Te.predicate)};mr&&mr.box&&mr.box.length&&Wt.verticalIconBox?(An=Tr(Wt.verticalIconBox),Ln=An.box.length>0):(An=Tr(Wt.iconBox),Ln=An.box.length>0),zn=zn&&An.offscreen,ui=An.occluded}const po=Oe||At.numHorizontalGlyphVertices===0&&dn===0,Ci=Fe||At.numIconVertices===0;if(po||Ci?Ci?po||(Ln=Ln&&bn):bn=Ln&&bn:Ln=bn=Ln&&bn,bn&&sn&&sn.box&&this.collisionIndex.insertCollisionBox(sn.box,R.get("text-ignore-placement"),A.bucketInstanceId,mr&&mr.box&&or?or:Pn,Te.ID),Ln&&An&&this.collisionIndex.insertCollisionBox(An.box,R.get("icon-ignore-placement"),A.bucketInstanceId,Gr,Te.ID),In&&(bn&&this.collisionIndex.insertCollisionCircles(In.circles,R.get("text-ignore-placement"),A.bucketInstanceId,Pn,Te.ID),m)){const Tr=A.bucketInstanceId;let Sr=this.collisionCircleArrays[Tr];Sr===void 0&&(Sr=this.collisionCircleArrays[Tr]=new El);for(let cr=0;cr<In.circles.length;cr+=4)Sr.circles.push(In.circles[cr+0]),Sr.circles.push(In.circles[cr+1]),Sr.circles.push(In.circles[cr+2]),Sr.circles.push(In.collisionDetected?1:0)}const hr=A.projection.name!=="globe";St=St&&(hr||!Mr),mt=mt&&(hr||!ui),this.placements[on]=new nm(bn||St,Ln||mt,zn||A.justReloaded),l.add(on)};if(Xe&&this.buildingIndex&&(this.buildingIndex.updateZOffset(A,this.retainedQueryData[A.bucketInstanceId].tileID),A.updateZOffset()),A.sortFeaturesByY){const At=A.getSortedSymbolIndexes(this.transform.angle);for(let kt=At.length-1;kt>=0;--kt){const Wt=At[kt];Pt(A.symbolInstances.get(Wt),Wt,A.collisionArrays[Wt])}A.hasAnyZOffset&&i.w(`${A.layerIds[0]} layer symbol-z-elevate: symbols are not sorted by elevation if symbol-z-order is evaluated to viewport-y`)}else if(A.hasAnyZOffset){const At=A.getSortedIndexesByZOffset();for(let kt=0;kt<At.length;++kt){const Wt=At[kt];Pt(A.symbolInstances.get(Wt),Wt,A.collisionArrays[Wt])}}else for(let At=r.symbolInstanceStart;At<r.symbolInstanceEnd;At++)Pt(A.symbolInstances.get(At),At,A.collisionArrays[At]);if(m&&A.bucketInstanceId in this.collisionCircleArrays){const At=this.collisionCircleArrays[A.bucketInstanceId];i.ab.mat4.invert(At.invProjMatrix,U),At.viewportMatrix=this.collisionIndex.getViewportMatrix()}A.justReloaded=!1}markUsedJustification(r,l,m,x){const{leftJustifiedTextSymbolIndex:b,centerJustifiedTextSymbolIndex:A,rightJustifiedTextSymbolIndex:R,verticalPlacedTextSymbolIndex:N,crossTileID:U}=m,$=i.bB(l),Z=x===i.bq.vertical?N:$==="left"?b:$==="center"?A:$==="right"?R:-1;b>=0&&(r.text.placedSymbolArray.get(b).crossTileID=Z>=0&&b!==Z?0:U),A>=0&&(r.text.placedSymbolArray.get(A).crossTileID=Z>=0&&A!==Z?0:U),R>=0&&(r.text.placedSymbolArray.get(R).crossTileID=Z>=0&&R!==Z?0:U),N>=0&&(r.text.placedSymbolArray.get(N).crossTileID=Z>=0&&N!==Z?0:U)}markUsedOrientation(r,l,m){const x=l===i.bq.horizontal||l===i.bq.horizontalOnly?l:0,b=l===i.bq.vertical?l:0,{leftJustifiedTextSymbolIndex:A,centerJustifiedTextSymbolIndex:R,rightJustifiedTextSymbolIndex:N,verticalPlacedTextSymbolIndex:U}=m,$=r.text.placedSymbolArray;A>=0&&($.get(A).placedOrientation=x),R>=0&&($.get(R).placedOrientation=x),N>=0&&($.get(N).placedOrientation=x),U>=0&&($.get(U).placedOrientation=b)}commit(r){this.commitTime=r,this.zoomAtLastRecencyCheck=this.transform.zoom;const l=this.prevPlacement;let m=!1;this.prevZoomAdjustment=l?l.zoomAdjustment(this.transform.zoom):0;const x=l?l.symbolFadeChange(r):1,b=l?l.opacities:{},A=l?l.variableOffsets:{},R=l?l.placedOrientations:{};for(const N in this.placements){const U=this.placements[N],$=b[N];$?(this.opacities[N]=new Is($,x,U.text,U.icon,null,U.clipped),m=m||U.text!==$.text.placed||U.icon!==$.icon.placed):(this.opacities[N]=new Is(null,x,U.text,U.icon,U.skipFade,U.clipped),m=m||U.text||U.icon)}for(const N in b){const U=b[N];if(!this.opacities[N]){const $=new Is(U,x,!1,!1);$.isHidden()||(this.opacities[N]=$,m=m||U.text.placed||U.icon.placed)}}for(const N in A)this.variableOffsets[N]||!this.opacities[N]||this.opacities[N].isHidden()||(this.variableOffsets[N]=A[N]);for(const N in R)this.placedOrientations[N]||!this.opacities[N]||this.opacities[N].isHidden()||(this.placedOrientations[N]=R[N]);m?this.lastPlacementChangeTime=r:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=l?l.lastPlacementChangeTime:r)}updateLayerOpacities(r,l,m,x){const b=new Set;for(const A of l){const R=A.getBucket(r);R&&A.latestFeatureIndex&&r.fqid===R.layerIds[0]&&(this.updateBucketOpacities(R,b,A,A.collisionBoxArray,m,x,A.tileID,r.scope),R.layers[0].layout.get("symbol-z-elevate")&&this.buildingIndex&&(this.buildingIndex.updateZOffset(R,A.tileID),R.updateZOffset()))}}updateBucketOpacities(r,l,m,x,b,A,R,N){r.hasTextData()&&r.text.opacityVertexArray.clear(),r.hasIconData()&&r.icon.opacityVertexArray.clear(),r.hasIconCollisionBoxData()&&r.iconCollisionBox.collisionVertexArray.clear(),r.hasTextCollisionBoxData()&&r.textCollisionBox.collisionVertexArray.clear();const U=r.layers[0].layout,$=r.layers[0].paint,Z=!!r.layers[0].dynamicFilter(),W=new Is(null,0,!1,!1,!0),ee=U.get("text-allow-overlap"),ue=U.get("icon-allow-overlap"),oe=U.get("text-variable-anchor"),de=U.get("text-rotation-alignment")==="map",fe=U.get("text-pitch-alignment")==="map",Te=$.get("symbol-z-offset"),Pe=U.get("symbol-elevation-reference")==="sea",Oe=!Te.isConstant(),Fe=new Is(null,0,ee&&(ue||!r.hasIconData()||U.get("icon-optional")),ue&&(ee||!r.hasTextData()||U.get("text-optional")),!0);!r.collisionArrays&&x&&(r.hasIconCollisionBoxData()||r.hasTextCollisionBoxData())&&r.deserializeCollisionBoxes(x);const Re=(De,$e,Xe)=>{for(let ft=0;ft<$e/4;ft++)De.opacityVertexArray.emplaceBack(Xe)};let ke=0;A&&r.updateReplacement(R,A);for(let De=0;De<r.symbolInstances.length;De++){const $e=r.symbolInstances.get(De),{numHorizontalGlyphVertices:Xe,numVerticalGlyphVertices:ft,crossTileID:ot,numIconVertices:Et,tileAnchorX:vt,tileAnchorY:nt}=$e;let pt=null;const Lt=this.retainedQueryData[r.bucketInstanceId];Oe&&$e&&Lt&&(pt=m.latestFeatureIndex.loadFeature({featureIndex:$e.featureIndex,bucketIndex:Lt.bucketIndex,sourceLayerIndex:Lt.sourceLayerIndex,layoutVertexArrayOffset:0}));const tt=Te.evaluate(pt,{}),St=l.has(ot);let mt=this.opacities[ot];St?mt=W:mt||(mt=Fe,this.opacities[ot]=mt),l.add(ot);const Gt=Xe>0||ft>0,Pt=Et>0,At=this.placedOrientations[ot],kt=At===i.bq.vertical,Wt=At===i.bq.horizontal||At===i.bq.horizontalOnly;!Gt&&!Pt||mt.isHidden()||ke++;let on=!1;if((Gt||Pt)&&A)for(const dn of r.activeReplacements){if(i.bx(dn,b,i.by.Symbol,N)||dn.min.x>vt||vt>dn.max.x||dn.min.y>nt||nt>dn.max.y)continue;const En=i.bz(vt,nt,R.canonical,dn.footprintTileId.canonical);if(on=i.bA(En,dn.footprint),on)break}if(Gt){const dn=on?Ps:om(mt.text);Re(r.text,Xe,kt?Ps:dn),Re(r.text,ft,Wt?Ps:dn);const En=mt.text.isHidden(),{leftJustifiedTextSymbolIndex:Sn,centerJustifiedTextSymbolIndex:bn,rightJustifiedTextSymbolIndex:Ln,verticalPlacedTextSymbolIndex:zn}=$e,Mr=r.text.placedSymbolArray,ui=En||kt?1:0;Sn>=0&&(Mr.get(Sn).hidden=ui),bn>=0&&(Mr.get(bn).hidden=ui),Ln>=0&&(Mr.get(Ln).hidden=ui),zn>=0&&(Mr.get(zn).hidden=En||Wt?1:0);const qr=this.variableOffsets[ot];qr&&this.markUsedJustification(r,qr.anchor,$e,At);const Fn=this.placedOrientations[ot];Fn&&(this.markUsedJustification(r,"left",$e,Fn),this.markUsedOrientation(r,Fn,$e))}if(Pt){const dn=on?Ps:om(mt.icon),{placedIconSymbolIndex:En,verticalPlacedIconSymbolIndex:Sn}=$e,bn=r.icon.placedSymbolArray,Ln=mt.icon.isHidden()?1:0;En>=0&&(Re(r.icon,Et,kt?Ps:dn),bn.get(En).hidden=Ln),Sn>=0&&(Re(r.icon,$e.numVerticalIconVertices,Wt?Ps:dn),bn.get(Sn).hidden=Ln)}if(r.hasIconCollisionBoxData()||r.hasTextCollisionBoxData()){const dn=r.collisionArrays[De];if(dn){let En=new i.P(0,0),Sn=!0;if(dn.textBox||dn.verticalTextBox){if(oe){const Ln=this.variableOffsets[ot];Ln?(En=so(Ln.anchor,Ln.width,Ln.height,Ln.textOffset,Ln.textScale),de&&En._rotate(fe?this.transform.angle:-this.transform.angle)):Sn=!1}Z&&(Sn=!mt.clipped),dn.textBox&&yf(r.textCollisionBox.collisionVertexArray,mt.text.placed,!Sn||kt,tt,Pe,En.x,En.y),dn.verticalTextBox&&yf(r.textCollisionBox.collisionVertexArray,mt.text.placed,!Sn||Wt,tt,Pe,En.x,En.y)}const bn=Sn&&!!(!Wt&&dn.verticalIconBox);dn.iconBox&&yf(r.iconCollisionBox.collisionVertexArray,mt.icon.placed,bn,tt,Pe,$e.hasIconTextFit?En.x:0,$e.hasIconTextFit?En.y:0),dn.verticalIconBox&&yf(r.iconCollisionBox.collisionVertexArray,mt.icon.placed,!bn,tt,Pe,$e.hasIconTextFit?En.x:0,$e.hasIconTextFit?En.y:0)}}}if(r.fullyClipped=ke===0,r.sortFeatures(this.transform.angle),this.retainedQueryData[r.bucketInstanceId]&&(this.retainedQueryData[r.bucketInstanceId].featureSortOrder=r.featureSortOrder),r.hasTextData()&&r.text.opacityVertexBuffer&&r.text.opacityVertexBuffer.updateData(r.text.opacityVertexArray),r.hasIconData()&&r.icon.opacityVertexBuffer&&r.icon.opacityVertexBuffer.updateData(r.icon.opacityVertexArray),r.hasIconCollisionBoxData()&&r.iconCollisionBox.collisionVertexBuffer&&r.iconCollisionBox.collisionVertexBuffer.updateData(r.iconCollisionBox.collisionVertexArray),r.hasTextCollisionBoxData()&&r.textCollisionBox.collisionVertexBuffer&&r.textCollisionBox.collisionVertexBuffer.updateData(r.textCollisionBox.collisionVertexArray),r.bucketInstanceId in this.collisionCircleArrays){const De=this.collisionCircleArrays[r.bucketInstanceId];r.placementInvProjMatrix=De.invProjMatrix,r.placementViewportMatrix=De.viewportMatrix,r.collisionCircleArray=De.circles,delete this.collisionCircleArrays[r.bucketInstanceId]}}symbolFadeChange(r){return this.fadeDuration===0?1:(r-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(r){return Math.max(0,(this.transform.zoom-r)/1.5)}hasTransitions(r){return this.stale||r-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(r,l){const m=this.zoomAtLastRecencyCheck===l?1-this.zoomAdjustment(l):1;return this.zoomAtLastRecencyCheck=l,this.commitTime+this.fadeDuration*m>r}setStale(){this.stale=!0}}function yf(p,r,l,m,x,b,A){p.emplaceBack(r?1:0,l?1:0,b||0,A||0,m,x?1:0),p.emplaceBack(r?1:0,l?1:0,b||0,A||0,m,x?1:0),p.emplaceBack(r?1:0,l?1:0,b||0,A||0,m,x?1:0),p.emplaceBack(r?1:0,l?1:0,b||0,A||0,m,x?1:0)}const vf=Math.pow(2,25),Gg=Math.pow(2,24),Hg=Math.pow(2,17),xf=Math.pow(2,16),bf=Math.pow(2,9),Zg=Math.pow(2,8),ah=Math.pow(2,1);function om(p){if(p.opacity===0&&!p.placed)return 0;if(p.opacity===1&&p.placed)return 4294967295;const r=p.placed?1:0,l=Math.floor(127*p.opacity);return l*vf+r*Gg+l*Hg+r*xf+l*bf+r*Zg+l*ah+r}const Ps=0;class os{constructor(r){this._sortAcrossTiles=r.layout.get("symbol-z-order")!=="viewport-y"&&r.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(r,l,m,x,b,A){const R=this._bucketParts;for(;this._currentTileIndex<r.length;)if(l.getBucketParts(R,x,r[this._currentTileIndex],this._sortAcrossTiles,A),this._currentTileIndex++,b())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,R.sort((N,U)=>N.sortKey-U.sortKey));this._currentPartIndex<R.length;){const N=R[this._currentPartIndex];if(l.placeLayerBucketPart(N,this._seenCrossTileIDs,m,N.symbolInstanceStart===0,A),this._currentPartIndex++,b())return!0}return!1}}class Wg{constructor(r,l,m,x,b,A,R,N,U){this.placement=new gf(r,b,A,R,N,U),this._currentPlacementIndex=l.length-1,this._forceFullPlacement=m,this._showCollisionBoxes=x,this._done=!1}isDone(){return this._done}continuePlacement(r,l,m,x,b){const A=i.q.now(),R=()=>{const N=i.q.now()-A;return!this._forceFullPlacement&&N>2};for(;this._currentPlacementIndex>=0;){const N=l[r[this._currentPlacementIndex]],U=this.placement.collisionIndex.transform.zoom;if(N.type==="symbol"&&(!N.minzoom||N.minzoom<=U)&&(!N.maxzoom||N.maxzoom>U)){const $=N,Z=$.layout.get("symbol-z-elevate"),W=$.layout.get("symbol-sort-key").constantOr(1)!==void 0,ee=$.layout.get("symbol-z-order"),ue=ee==="viewport-y"||ee==="auto"&&!(ee!=="viewport-y"&&W),oe=$.layout.get("text-allow-overlap")||$.layout.get("icon-allow-overlap")||$.layout.get("text-ignore-placement")||$.layout.get("icon-ignore-placement"),de=ue&&oe,fe=this._inProgressLayer=this._inProgressLayer||new os($),Te=i.aC(N.source,N.scope);if(fe.continuePlacement(Z||de?x[Te]:m[Te],this.placement,this._showCollisionBoxes,N,R,b))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(r){return this.placement.commit(r),this.placement}}const jd=512/i.ag/2;class M0{constructor(r,l,m){this.tileID=r,this.bucketInstanceId=m,this.index=new i.bE(l.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const x=r.canonical.x*i.ag,b=r.canonical.y*i.ag;for(let A=0;A<l.length;A++){const{key:R,crossTileID:N,tileAnchorX:U,tileAnchorY:$}=l.get(A),Z=Math.floor((x+U)*jd),W=Math.floor((b+$)*jd);this.index.add(Z,W),this.keys.push(R),this.crossTileIDs.push(N)}this.index.finish()}findMatches(r,l,m){const x=this.tileID.canonical.z<l.canonical.z?1:Math.pow(2,this.tileID.canonical.z-l.canonical.z),b=jd/Math.pow(2,l.canonical.z-this.tileID.canonical.z),A=l.canonical.x*i.ag,R=l.canonical.y*i.ag;for(let N=0;N<r.length;N++){const U=r.get(N);if(U.crossTileID)continue;const{key:$,tileAnchorX:Z,tileAnchorY:W}=U,ee=Math.floor((A+Z)*b),ue=Math.floor((R+W)*b),oe=this.index.range(ee-x,ue-x,ee+x,ue+x);for(const de of oe){const fe=this.crossTileIDs[de];if(this.keys[de]===$&&!m.has(fe)){m.add(fe),U.crossTileID=fe;break}}}}}class sm{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class O0{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(r){const l=Math.round((r-this.lng)/360);if(l!==0)for(const m in this.indexes){const x=this.indexes[m],b={};for(const A in x){const R=x[A];R.tileID=R.tileID.unwrapTo(R.tileID.wrap+l),b[R.tileID.key]=R}this.indexes[m]=b}this.lng=r}addBucket(r,l,m){if(this.indexes[r.overscaledZ]&&this.indexes[r.overscaledZ][r.key]){if(this.indexes[r.overscaledZ][r.key].bucketInstanceId===l.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(r.overscaledZ,this.indexes[r.overscaledZ][r.key])}for(let b=0;b<l.symbolInstances.length;b++)l.symbolInstances.get(b).crossTileID=0;this.usedCrossTileIDs[r.overscaledZ]||(this.usedCrossTileIDs[r.overscaledZ]=new Set);const x=this.usedCrossTileIDs[r.overscaledZ];for(const b in this.indexes){const A=this.indexes[b];if(Number(b)>r.overscaledZ)for(const R in A){const N=A[R];N.tileID.isChildOf(r)&&N.findMatches(l.symbolInstances,r,x)}else{const R=A[r.scaledTo(Number(b)).key];R&&R.findMatches(l.symbolInstances,r,x)}}for(let b=0;b<l.symbolInstances.length;b++){const A=l.symbolInstances.get(b);A.crossTileID||(A.crossTileID=m.generate(),x.add(A.crossTileID))}return this.indexes[r.overscaledZ]===void 0&&(this.indexes[r.overscaledZ]={}),this.indexes[r.overscaledZ][r.key]=new M0(r,l.symbolInstances,l.bucketInstanceId),!0}removeBucketCrossTileIDs(r,l){for(const m of l.crossTileIDs)this.usedCrossTileIDs[r].delete(m)}removeStaleBuckets(r){let l=!1;for(const m in this.indexes){const x=this.indexes[m];for(const b in x)r[x[b].bucketInstanceId]||(this.removeBucketCrossTileIDs(m,x[b]),delete x[b],l=!0)}return l}}class Ud{constructor(){this.layerIndexes={},this.crossTileIDs=new sm,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(r,l,m,x){let b=this.layerIndexes[r.fqid];b===void 0&&(b=this.layerIndexes[r.fqid]=new O0);let A=!1;const R={};x.name!=="globe"&&b.handleWrapJump(m);for(const N of l){const U=N.getBucket(r);U&&r.fqid===U.layerIds[0]&&(U.bucketInstanceId||(U.bucketInstanceId=++this.maxBucketInstanceId),b.addBucket(N.tileID,U,this.crossTileIDs)&&(A=!0),R[U.bucketInstanceId]=!0)}return b.removeStaleBuckets(R)&&(A=!0),A}pruneUnusedLayers(r){const l={};r.forEach(m=>{l[m]=!0});for(const m in this.layerIndexes)l[m]||delete this.layerIndexes[m]}}const ss=771;class Jn{constructor(r,l,m,x){this.blendFunction=r,this.blendColor=l,this.mask=m,this.blendEquation=x}}Jn.Replace=[1,0,1,0],Jn.disabled=new Jn(Jn.Replace,i.aj.transparent,[!1,!1,!1,!1]),Jn.unblended=new Jn(Jn.Replace,i.aj.transparent,[!0,!0,!0,!0]),Jn.alphaBlended=new Jn([1,ss,1,ss],i.aj.transparent,[!0,!0,!0,!0]),Jn.alphaBlendedNonPremultiplied=new Jn([770,ss,770,ss],i.aj.transparent,[!0,!0,!0,!0]),Jn.multiply=new Jn([774,0,774,0],i.aj.transparent,[!0,!0,!0,!0]);class Tn{constructor(r,l,m){this.func=r,this.mask=l,this.range=m}}Tn.ReadOnly=!1,Tn.ReadWrite=!0,Tn.disabled=new Tn(519,Tn.ReadOnly,[0,1]);const Vd=7680;class Dn{constructor(r,l,m,x,b,A){this.test=r,this.ref=l,this.mask=m,this.fail=x,this.depthFail=b,this.pass=A}}Dn.disabled=new Dn({func:519,mask:0},0,0,Vd,Vd,Vd);const lu=1029,oc=2305;class Rn{constructor(r,l,m){this.enable=r,this.mode=l,this.frontFace=m}}function oh(p,r){const l=i.bG(p,3);i.ab.mat4.fromQuat(p,r),i.bI(p,3,l)}function Ws(p,r){const l=i.ab.quat.identity([]);return i.ab.quat.rotateZ(l,l,-r),i.ab.quat.rotateX(l,l,-p),l}function $d(p,r){const l=[p[0],p[1],0],m=[r[0],r[1],0];if(i.ab.vec3.length(l)>=1e-15){const A=i.ab.vec3.normalize([],l);i.ab.vec3.scale(m,A,i.ab.vec3.dot(m,A)),r[0]=m[0],r[1]=m[1]}const x=i.ab.vec3.cross([],r,p);if(i.ab.vec3.len(x)<1e-15)return null;const b=Math.atan2(-x[1],x[0]);return Ws(Math.atan2(Math.sqrt(p[0]*p[0]+p[1]*p[1]),-p[2]),b)}Rn.disabled=new Rn(!1,lu,oc),Rn.backCCW=new Rn(!0,lu,oc),Rn.backCW=new Rn(!0,lu,2304),Rn.frontCW=new Rn(!0,1028,2304),Rn.frontCCW=new Rn(!0,1028,oc);class wf{constructor(r,l){this.position=r,this.orientation=l}get position(){return this._position}set position(r){if(r){const l=r instanceof i.aa?r:new i.aa(r[0],r[1],r[2]);this._renderWorldCopies&&(l.x=i.bF(l.x,0,1)),this._position=l}else this._position=null}lookAtPoint(r,l){if(this.orientation=null,!this.position)return;const m=this.position,x=this._elevation?this._elevation.getAtPointOrZero(i.aa.fromLngLat(r)):0,b=i.aa.fromLngLat(r,x),A=[b.x-m.x,b.y-m.y,b.z-m.z];l||(l=[0,0,1]),l[2]=Math.abs(l[2]),this.orientation=$d(A,l)}setPitchBearing(r,l){this.orientation=Ws(i.ai(r),i.ai(-l))}}class qa{constructor(r,l){this._transform=i.ab.mat4.identity([]),this.orientation=l,this.position=r}get mercatorPosition(){const r=this.position;return new i.aa(r[0],r[1],r[2])}get position(){const r=i.bG(this._transform,3);return[r[0],r[1],r[2]]}set position(r){var l;r&&i.bI(this._transform,3,[(l=r)[0],l[1],l[2],1])}get orientation(){return this._orientation}set orientation(r){this._orientation=r||i.ab.quat.identity([]),r&&oh(this._transform,this._orientation)}getPitchBearing(){const r=this.forward(),l=this.right();return{bearing:Math.atan2(-l[1],l[0]),pitch:Math.atan2(Math.sqrt(r[0]*r[0]+r[1]*r[1]),-r[2])}}setPitchBearing(r,l){this._orientation=Ws(r,l),oh(this._transform,this._orientation)}forward(){const r=i.bG(this._transform,2);return[-r[0],-r[1],-r[2]]}up(){const r=i.bG(this._transform,1);return[-r[0],-r[1],-r[2]]}right(){const r=i.bG(this._transform,0);return[r[0],r[1],r[2]]}getCameraToWorld(r,l){const m=new Float64Array(16);return i.ab.mat4.invert(m,this.getWorldToCamera(r,l)),m}getCameraToWorldMercator(){return this._transform}getWorldToCameraPosition(r,l,m){const x=this.position;i.ab.vec3.scale(x,x,-r);const b=new Float64Array(16);return i.ab.mat4.fromScaling(b,[m,m,m]),i.ab.mat4.translate(b,b,x),b[10]*=l,b}getWorldToCamera(r,l){const m=new Float64Array(16),x=new Float64Array(4),b=this.position;return i.ab.quat.conjugate(x,this._orientation),i.ab.vec3.scale(b,b,-r),i.ab.mat4.fromQuat(m,x),i.ab.mat4.translate(m,m,b),m[1]*=-1,m[5]*=-1,m[9]*=-1,m[13]*=-1,m[8]*=l,m[9]*=l,m[10]*=l,m[11]*=l,m}getCameraToClipPerspective(r,l,m,x){const b=new Float64Array(16);return i.ab.mat4.perspective(b,r,l,m,x),b}getCameraToClipOrthographic(r,l,m,x,b,A){const R=new Float64Array(16);return i.ab.mat4.ortho(R,r,l,m,x,b,A),R}getDistanceToElevation(r,l=!1){const m=r===0?0:i.bH(r,l?i.aS(this.position[1]):this.position[1]),x=this.forward();return(m-this.position[2])/x[2]}clone(){return new qa([...this.position],[...this.orientation])}}const na={BaseColor:5,MetallicRoughness:6,Normal:7,Occlusion:8,Emission:9,LUT:10,ShadowMap0:11};class Kt{constructor(r=0,l=0,m=0,x=0){if(isNaN(r)||r<0||isNaN(l)||l<0||isNaN(m)||m<0||isNaN(x)||x<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=r,this.bottom=l,this.left=m,this.right=x}interpolate(r,l,m){return l.top!=null&&r.top!=null&&(this.top=i.af(r.top,l.top,m)),l.bottom!=null&&r.bottom!=null&&(this.bottom=i.af(r.bottom,l.bottom,m)),l.left!=null&&r.left!=null&&(this.left=i.af(r.left,l.left,m)),l.right!=null&&r.right!=null&&(this.right=i.af(r.right,l.right,m)),this}getCenter(r,l){const m=i.aw((this.left+r-this.right)/2,0,r),x=i.aw((this.top+l-this.bottom)/2,0,l);return new i.P(m,x)}equals(r){return this.top===r.top&&this.bottom===r.bottom&&this.left===r.left&&this.right===r.right}clone(){return new Kt(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const qd=(p,r,l)=>(1-l)*p+l*r,Sf=p=>p*p*p*p*p;class Tf{constructor(r,l,m,x,b,A,R){this.tileSize=512,this._renderWorldCopies=b===void 0||b,this._minZoom=r||0,this._maxZoom=l||22,this._minPitch=m??0,this._maxPitch=x??60,this.setProjection(A),this.setMaxBounds(R),this.width=0,this.height=0,this._center=new i.bO(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new Kt,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._expandedProjMatrixCache={},this._distanceTileDataCache={},this._camera=new qa,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._tileCoverLift=0,this.freezeTileCoverage=!1,this._horizonShift=.1,this._orthographicProjectionAtLowPitch=!1}clone(){const r=new Tf(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return r._elevation=this._elevation,r._centerAltitude=this._centerAltitude,r._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,r.tileSize=this.tileSize,r.mercatorFromTransition=this.mercatorFromTransition,r.width=this.width,r.height=this.height,r.cameraElevationReference=this.cameraElevationReference,r._center=this._center,r._setZoom(this.zoom),r._seaLevelZoom=this._seaLevelZoom,r.angle=this.angle,r._fov=this._fov,r._pitch=this._pitch,r._nearZ=this._nearZ,r._farZ=this._farZ,r._averageElevation=this._averageElevation,r._orthographicProjectionAtLowPitch=this._orthographicProjectionAtLowPitch,r._unmodified=this._unmodified,r._edgeInsets=this._edgeInsets.clone(),r._camera=this._camera.clone(),r._calcMatrices(),r.freezeTileCoverage=this.freezeTileCoverage,r.frustumCorners=this.frustumCorners,r}get isOrthographic(){return this.projection.name!=="globe"&&this._orthographicProjectionAtLowPitch&&this.pitch<15}get elevation(){return this._elevation}set elevation(r){this._elevation!==r&&(this._elevation=r,this._updateCameraOnTerrain(),this._calcMatrices())}get depthOcclusionForSymbolsAndCircles(){return this.projection.name!=="globe"&&!this.isOrthographic}updateElevation(r,l=!1){const m=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||m)&&this._updateCameraOnTerrain(),(r||m)&&this._constrainCamera(l),this._calcMatrices()}getProjection(){return i.ay(this.projection,["name","center","parallels"])}setProjection(r){this.projectionOptions=r||{name:"mercator"};const l=this.projection?this.getProjection():void 0;this.projection=i.bP(this.projectionOptions);const m=this.getProjection(),x=!i.bn(l,m);return x&&this._calcMatrices(),this.mercatorFromTransition=!1,x}setOrthographicProjectionAtLowPitch(r){return this._orthographicProjectionAtLowPitch!==r&&(this._orthographicProjectionAtLowPitch=r,this._calcMatrices(),!0)}setMercatorFromTransition(){const r=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=i.bP({name:"mercator"});const l=r!==this.projection.name;return l&&this._calcMatrices(),l}get minZoom(){return this._minZoom}set minZoom(r){this._minZoom!==r&&(this._minZoom=r,this.zoom=Math.max(this.zoom,r))}get maxZoom(){return this._maxZoom}set maxZoom(r){this._maxZoom!==r&&(this._maxZoom=r,this.zoom=Math.min(this.zoom,r))}get minPitch(){return this._minPitch}set minPitch(r){this._minPitch!==r&&(this._minPitch=r,this.pitch=Math.max(this.pitch,r))}get maxPitch(){return this._maxPitch}set maxPitch(r){this._maxPitch!==r&&(this._maxPitch=r,this.pitch=Math.min(this.pitch,r))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(r){r===void 0?r=!0:r===null&&(r=!1),this._renderWorldCopies=r}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const r=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(r))}get cameraWorldSize(){const r=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(r))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return i.bH(1,this.center.lat)*this.cameraWorldSizeForFog}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new i.P(this.width,this.height)}get bearing(){return i.bF(this.rotation,-180,180)}set bearing(r){this.rotation=r}get rotation(){return-this.angle/Math.PI*180}set rotation(r){const l=-r*Math.PI/180;this.angle!==l&&(this._unmodified=!1,this.angle=l,this._calcMatrices(),this.rotationMatrix=i.ab.mat2.create(),i.ab.mat2.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(r){const l=i.aw(r,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==l&&(this._unmodified=!1,this._pitch=l,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const r=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/r)}set fov(r){r=Math.max(.01,Math.min(60,r)),this._fov!==r&&(this._unmodified=!1,this._fov=i.ai(r),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(r){this._averageElevation=r,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(r){const l=Math.min(Math.max(r,this.minZoom),this.maxZoom);this._zoom!==l&&(this._unmodified=!1,this._setZoom(l),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(r){this._zoom=r,this.scale=this.zoomScale(r),this.tileZoom=Math.floor(r),this.zoomFraction=r-this.tileZoom}get tileCoverLift(){return this._tileCoverLift}set tileCoverLift(r){this._tileCoverLift!==r&&(this._tileCoverLift=r)}_updateCameraOnTerrain(){const r=this.elevation?this.elevation.getAtPoint(this.locationCoordinate(this.center),Number.NEGATIVE_INFINITY):Number.NEGATIVE_INFINITY,l=this.elevation&&r===Number.NEGATIVE_INFINITY&&this.elevation.visibleDemTiles.length>0&&this.elevation.exaggeration()>0&&this._centerAltitudeValidForExaggeration;if(!this._elevation||r===Number.NEGATIVE_INFINITY&&(!l||!this._centerAltitude))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const m=this._elevation;l||this._centerAltitude&&this._centerAltitudeValidForExaggeration&&m.exaggeration()&&this._centerAltitudeValidForExaggeration!==m.exaggeration()?(this._centerAltitude=this._centerAltitude/this._centerAltitudeValidForExaggeration*m.exaggeration(),this._centerAltitudeValidForExaggeration=m.exaggeration()):(this._centerAltitude=r||0,this._centerAltitudeValidForExaggeration=m.exaggeration()),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const r=this._elevation,l=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],m=this.horizonLineFromTop();let x=0,b=0;for(let A=0;A<l.length;A++){const R=new i.P(l[A][0]*this.width,m+l[A][1]*(this.height-m)),N=r.pointCoordinate(R);if(!N)continue;const U=1/Math.hypot(N[0]-this._camera.position[0],N[1]-this._camera.position[1]);x+=N[3]*U,b+=U}return b===0?NaN:x/b}get center(){return this._center}set center(r){r.lat===this._center.lat&&r.lng===this._center.lng||(this._unmodified=!1,this._center=r,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const r=this._seaLevelZoom,l=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),m=this.pixelsPerMeter/this.worldSize*l,x=this._mercatorZfromZoom(r),b=this._mercatorZfromZoom(this._maxZoom),A=Math.max(x-m,b);this._setZoom(this._zoomFromMercatorZ(A))}get padding(){return this._edgeInsets.toJSON()}set padding(r){this._edgeInsets.equals(r)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,r,1),this._calcMatrices())}computeZoomRelativeTo(r){const l=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,r.toAltitude()));let m;m=r.z<this._camera.position[2]?[l.x,l.y,l.z]:[r.x,r.y,r.z];const x=i.ab.vec3.length(i.ab.vec3.sub([],this._camera.position,m));return i.aw(this._zoomFromMercatorZ(x),this._minZoom,this._maxZoom)}setFreeCameraOptions(r){if(!this.height||!r.position&&!r.orientation)return;this._updateCameraState();let l=!1;if(r.orientation&&!i.ab.quat.exactEquals(r.orientation,this._camera.orientation)&&(l=this._setCameraOrientation(r.orientation)),r.position){const m=[r.position.x,r.position.y,r.position.z];i.ab.vec3.exactEquals(m,this._camera.position)||(this._setCameraPosition(m),l=!0)}l&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const r=this._camera.position,l=new wf;return l.position=new i.aa(r[0],r[1],r[2]),l.orientation=this._camera.orientation,l._elevation=this.elevation,l._renderWorldCopies=this.renderWorldCopies,l}_setCameraOrientation(r){if(!i.ab.quat.length(r))return!1;i.ab.quat.normalize(r,r);const l=i.ab.vec3.transformQuat([],[0,0,-1],r),m=i.ab.vec3.transformQuat([],[0,-1,0],r);if(m[2]<0)return!1;const x=$d(l,m);return!!x&&(this._camera.orientation=x,!0)}_setCameraPosition(r){const l=this.zoomScale(this.minZoom)*this.tileSize,m=this.zoomScale(this.maxZoom)*this.tileSize,x=this.cameraToCenterDistance;r[2]=i.aw(r[2],x/m,x/l),this._camera.position=r}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(r){return this._edgeInsets.equals(r)}interpolatePadding(r,l,m){this._unmodified=!1,this._edgeInsets.interpolate(r,l,m),this._constrain(),this._calcMatrices()}coveringZoomLevel(r){const l=(r.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/r.tileSize));return Math.max(0,l)}getVisibleUnwrappedCoordinates(r){const l=[new i.bQ(0,r)];if(this.renderWorldCopies){const m=this.pointCoordinate(new i.P(0,0)),x=this.pointCoordinate(new i.P(this.width,0)),b=this.pointCoordinate(new i.P(this.width,this.height)),A=this.pointCoordinate(new i.P(0,this.height)),R=Math.floor(Math.min(m.x,x.x,b.x,A.x)),N=Math.floor(Math.max(m.x,x.x,b.x,A.x)),U=1;for(let $=R-U;$<=N+U;$++)$!==0&&l.push(new i.bQ($,r))}return l}isLODDisabled(r){return(!r||this.pitch<=60)&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace}extendTileCover(r,l,m){let x=[];const b=m!==void 0,A=!b;if(A&&this.zoom<l||b&&m[0]===0&&m[1]===0)return x;const R=new Set,N=($,Z,W,ee,ue)=>{const oe=i.c5(Z,$,W,ee,ue);R.has(oe)||(x.push(new i.aG($,Z,W,ee,ue)),R.add(oe))};for(let $=0;$<r.length;$++){const Z=r[$];if(A&&Z.canonical.z!==l)continue;const W=Z.canonical,ee=Z.overscaledZ,ue=Z.wrap,oe=1<<W.z,de=W.x+1<oe,fe=W.x>0,Te=W.y+1<oe,Pe=W.y>0,Oe=Z.wrap-(fe?0:1),Fe=Z.wrap+(de?0:1),Re=fe?W.x-1:oe-1,ke=de?W.x+1:0;if(b)m[0]<0?(N(ee,Fe,W.z,ke,W.y),m[1]<0&&Te&&(N(ee,ue,W.z,W.x,W.y+1),N(ee,Fe,W.z,ke,W.y+1)),m[1]>0&&Pe&&(N(ee,ue,W.z,W.x,W.y-1),N(ee,Fe,W.z,ke,W.y-1))):m[0]>0?(N(ee,Oe,W.z,Re,W.y),m[1]<0&&Te&&(N(ee,ue,W.z,W.x,W.y+1),N(ee,Oe,W.z,Re,W.y+1)),m[1]>0&&Pe&&(N(ee,ue,W.z,W.x,W.y-1),N(ee,Oe,W.z,Re,W.y-1))):m[1]<0&&Te?N(ee,ue,W.z,W.x,W.y+1):Pe&&N(ee,ue,W.z,W.x,W.y-1);else{const De=Z.visibleQuadrants;1&De&&(N(ee,Oe,W.z,Re,W.y),Pe&&(N(ee,ue,W.z,W.x,W.y-1),N(ee,Oe,W.z,Re,W.y-1))),2&De&&(N(ee,Fe,W.z,ke,W.y),Pe&&(N(ee,ue,W.z,W.x,W.y-1),N(ee,Fe,W.z,ke,W.y-1))),4&De&&(N(ee,Oe,W.z,Re,W.y),Te&&(N(ee,ue,W.z,W.x,W.y+1),N(ee,Oe,W.z,Re,W.y+1))),8&De&&(N(ee,Fe,W.z,ke,W.y),Te&&(N(ee,ue,W.z,W.x,W.y+1),N(ee,Fe,W.z,ke,W.y+1)))}}const U=[];for(const $ of x)x.some(Z=>$.isChildOf(Z))||U.push($);if(x=U.filter($=>!r.some(Z=>!!($.overscaledZ<l&&Z.isChildOf($))||$.equals(Z)||$.isChildOf(Z))),A){const $=1<<l,Z=this.projection.name==="globe"?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),W=[$*Z.x,$*Z.y],ee=4,ue=ee*ee;x=x.filter(oe=>{const de=oe.canonical.x+.5-W[0],fe=oe.canonical.y+.5-W[1];return de*de+fe*fe<ue})}return x}coveringTiles(r){let l=this.coveringZoomLevel(r);const m=l,x=this.elevation&&this.elevation.exaggeration(),b=x&&!r.isTerrainDEM,A=this.projection.name==="mercator";if(r.minzoom!==void 0&&l<r.minzoom)return[];r.maxzoom!==void 0&&l>r.maxzoom&&(l=r.maxzoom);const R=this.locationCoordinate(this.center),N=this.center.lat,U=1<<l,$=[U*R.x,U*R.y,0],Z=this.projection.name==="globe",W=!Z,ee=i.bR.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,l,W),ue=Z?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),oe=U*i.bH(1,this.center.lat),de=this._camera.position[2]/i.bH(1,this.center.lat),fe=[U*ue.x,U*ue.y,de*(W?1:oe)],Te=Z||x,Pe=this.cameraToCenterDistance/r.tileSize*(r.roundZoom?1:.502),Oe=this.isLODDisabled(!0)?l:0;let Fe;if(this._elevation&&r.isTerrainDEM)Fe=1e4*this._elevation.exaggeration();else if(this._elevation){const tt=this._elevation.getMinMaxForVisibleTiles();Fe=tt?tt.max:this._centerAltitude}else Fe=this._centerAltitude;const Re=r.isTerrainDEM?-Fe:this._elevation?this._elevation.getMinElevationBelowMSL():0,ke=this.projection.isReprojectedInTileSpace?i.bS(this):1,De=tt=>{const mt=new i.aa(tt.x+25e-6,tt.y,tt.z),Gt=new i.aa(tt.x,tt.y+25e-6,tt.z),Pt=tt.toLngLat(),At=mt.toLngLat(),kt=Gt.toLngLat(),Wt=this.locationCoordinate(Pt),on=this.locationCoordinate(At),dn=this.locationCoordinate(kt),En=Math.hypot(on.x-Wt.x,on.y-Wt.y),Sn=Math.hypot(dn.x-Wt.x,dn.y-Wt.y);return Math.sqrt(En*Sn)*ke/25e-6},$e=tt=>{const St=Fe,mt=Re;return{aabb:i.bV(this,U,0,0,0,tt,mt,St,this.projection),zoom:0,x:0,y:0,minZ:mt,maxZ:St,wrap:tt,fullyVisible:!1}},Xe=[];let ft=[];const ot=l,Et=r.reparseOverscaled?m:l,vt=(de-this._centerAltitude)*oe,nt=tt=>{if(!this._elevation||!tt.tileID||!A)return;const St=this._elevation.getMinMaxForTile(tt.tileID),mt=tt.aabb;St?(mt.min[2]=St.min,mt.max[2]=St.max,mt.center[2]=(mt.min[2]+mt.max[2])/2):(tt.shouldSplit=Lt(tt),tt.shouldSplit||(mt.min[2]=mt.max[2]=mt.center[2]=this._centerAltitude))},pt=(tt,St)=>{if(.707*St<tt)return 1;const mt=St/tt;return mt/(1.4144271570014144+(Math.pow(1.1,mt-1.4144271570014144+1)-1)/(1.1-1)-1)},Lt=tt=>{if(tt.zoom<Oe)return!0;if(tt.zoom===ot)return!1;if(tt.shouldSplit!=null)return tt.shouldSplit;const St=tt.aabb.distanceX(fe),mt=tt.aabb.distanceY(fe);let Gt=vt,Pt=1;if(Z){Gt=tt.aabb.distanceZ(fe);const Sn=Math.pow(2,tt.zoom),bn=i.aS((tt.y+1)/Sn),Ln=i.aS(tt.y/Sn),zn=Math.min(Math.max(N,bn),Ln),Mr=i.c9(zn)/i.c9(N);if(Pt=zn===N?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,Mr/this._mercatorScaleRatio),this.zoom<=i.c6&&tt.zoom===ot-1&&Mr>=.9)return!0}else if(b&&(Gt=tt.aabb.distanceZ(fe)*oe),this.projection.isReprojectedInTileSpace&&m<=5){const Sn=Math.pow(2,tt.zoom),bn=De(new i.aa((tt.x+.5)/Sn,(tt.y+.5)/Sn));Pt=bn>.85?1:bn}if(!A){const Sn=Math.sqrt(St*St+mt*mt+Gt*Gt);let bn=(1<<ot-tt.zoom)*Pe*Pt;return bn*=pt(Math.max(Gt,vt),Sn),Sn<bn}let At=Number.MAX_VALUE,kt=0;const Wt=tt.aabb.getCorners(),on=[];for(const Sn of Wt){i.ab.vec3.sub(on,Sn,fe),Z||(b?on[2]*=oe:on[2]=vt);const bn=i.ab.vec3.dot(on,this._camera.forward());bn<At&&(At=bn,kt=Math.abs(on[2]))}let dn=(1<<ot-tt.zoom)*Pe*Pt;if(dn*=pt(Math.max(kt,vt),At),At<dn)return!0;const En=tt.aabb.closestPoint($);return En[0]===$[0]&&En[1]===$[1]};if(this.renderWorldCopies)for(let tt=1;tt<=3;tt++)Xe.push($e(-tt)),Xe.push($e(tt));for(Xe.push($e(0));Xe.length>0;){const tt=Xe.pop(),St=tt.x,mt=tt.y;let Gt=tt.fullyVisible;const Pt=()=>this.projection.name==="globe"&&(tt.y===0||tt.y===(1<<tt.zoom)-1);if(!Gt){let At=Te?tt.aabb.intersects(ee):tt.aabb.intersectsFlat(ee);if(At===0&&Pt()){const kt=new i.bT(tt.zoom,St,mt);At=i.bU(this,U,kt,!0).intersects(ee)}if(At===0)continue;Gt=At===2}if(tt.zoom!==ot&&Lt(tt))for(let At=0;At<4;At++){const kt=(St<<1)+At%2,Wt=(mt<<1)+(At>>1),on={aabb:A?tt.aabb.quadrant(At):i.bV(this,U,tt.zoom+1,kt,Wt,tt.wrap,tt.minZ,tt.maxZ,this.projection),zoom:tt.zoom+1,x:kt,y:Wt,wrap:tt.wrap,fullyVisible:Gt,tileID:void 0,shouldSplit:void 0,minZ:tt.minZ,maxZ:tt.maxZ};b&&!Z&&(on.tileID=new i.aG(tt.zoom+1===ot?Et:tt.zoom+1,tt.wrap,tt.zoom+1,kt,Wt),nt(on)),Xe.push(on)}else{const At=tt.zoom===ot?Et:tt.zoom;if(r.minzoom&&r.minzoom>At)continue;let kt=0;if(!Gt){let En=Te?tt.aabb.intersectsPrecise(ee):tt.aabb.intersectsPreciseFlat(ee);if(En===0&&Pt()){const Sn=new i.bT(tt.zoom,St,mt);En=i.bU(this,U,Sn,!0).intersectsPrecise(ee)}if(En===0)continue;if(r.calculateQuadrantVisibility)if(ee.containsPoint(tt.aabb.center))kt=15;else for(let Sn=0;Sn<4;Sn++)tt.aabb.quadrant(Sn).intersects(ee)!==0&&(kt|=1<<Sn)}const Wt=$[0]-(.5+St+(tt.wrap<<tt.zoom))*(1<<l-tt.zoom),on=$[1]-.5-mt,dn=tt.tileID?tt.tileID:new i.aG(At,tt.wrap,tt.zoom,St,mt);r.calculateQuadrantVisibility&&(dn.visibleQuadrants=kt),ft.push({tileID:dn,distanceSq:Wt*Wt+on*on})}}if(this.fogCullDistSq){const tt=this.fogCullDistSq,St=this.horizonLineFromTop();ft=ft.filter(mt=>{const Gt=[0,0,0,1],Pt=[i.ag,i.ag,0,1],At=this.calculateFogTileMatrix(mt.tileID.toUnwrapped());i.ab.vec4.transformMat4(Gt,Gt,At),i.ab.vec4.transformMat4(Pt,Pt,At);const kt=i.ab.vec4.min([],Gt,Pt),Wt=i.ab.vec4.max([],Gt,Pt),on=i.bW(kt,Wt);if(on===0)return!0;let dn=!1;const En=this._elevation;if(En&&on>tt&&St!==0){const Sn=this.calculateProjMatrix(mt.tileID.toUnwrapped());let bn;r.isTerrainDEM||(bn=En.getMinMaxForTile(mt.tileID)),bn||(bn={min:Re,max:Fe});const Ln=i.c7(this.rotation),zn=[Ln[0]*i.ag,Ln[1]*i.ag,bn.max];i.ab.vec3.transformMat4(zn,zn,Sn),dn=(1-zn[1])*this.height*.5<St}return on<tt||dn})}return ft.sort((tt,St)=>tt.distanceSq-St.distanceSq).map(tt=>tt.tileID)}resize(r,l){this.width=r,this.height=l,this.pixelsToGLUnits=[2/r,-2/l],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(r){return Math.pow(2,r)}scaleZoom(r){return Math.log(r)/Math.LN2}project(r){const l=i.aw(r.lat,-i.bX,i.bX),m=this.projection.project(r.lng,l);return new i.P(m.x*this.worldSize,m.y*this.worldSize)}unproject(r){return this.projection.unproject(r.x/this.worldSize,r.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/i.bH(1,this.center.lat)/this.worldSize}setLocationAtPoint(r,l){let m,x;const b=this.centerPoint;if(this.projection.name==="globe"){const R=this.worldSize;m=(l.x-b.x)/R,x=(l.y-b.y)/R}else{const R=this.pointCoordinate(l),N=this.pointCoordinate(b);m=R.x-N.x,x=R.y-N.y}const A=this.locationCoordinate(r);this.setLocation(new i.aa(A.x-m,A.y-x))}setLocation(r){this.center=this.coordinateLocation(r),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(r){return this.projection.locationPoint(this,r)}locationPoint3D(r){return this.projection.locationPoint(this,r,!0)}pointLocation(r){return this.coordinateLocation(this.pointCoordinate(r))}pointLocation3D(r){return this.coordinateLocation(this.pointCoordinate3D(r))}locationCoordinate(r,l){const m=l?i.bH(l,r.lat):void 0,x=this.projection.project(r.lng,r.lat);return new i.aa(x.x,x.y,m)}coordinateLocation(r){return this.projection.unproject(r.x,r.y)}pointRayIntersection(r,l){const m=l??this._centerAltitude,x=[r.x,r.y,0,1],b=[r.x,r.y,1,1];i.ab.vec4.transformMat4(x,x,this.pixelMatrixInverse),i.ab.vec4.transformMat4(b,b,this.pixelMatrixInverse);const A=b[3];i.ab.vec4.scale(x,x,1/x[3]),i.ab.vec4.scale(b,b,1/A);const R=x[2],N=b[2];return{p0:x,p1:b,t:R===N?0:(m-R)/(N-R)}}screenPointToMercatorRay(r){const l=[r.x,r.y,0,1],m=[r.x,r.y,1,1];return i.ab.vec4.transformMat4(l,l,this.pixelMatrixInverse),i.ab.vec4.transformMat4(m,m,this.pixelMatrixInverse),i.ab.vec4.scale(l,l,1/l[3]),i.ab.vec4.scale(m,m,1/m[3]),l[2]=i.bH(l[2],this._center.lat)*this.worldSize,m[2]=i.bH(m[2],this._center.lat)*this.worldSize,i.ab.vec4.scale(l,l,1/this.worldSize),i.ab.vec4.scale(m,m,1/this.worldSize),new i.aq([l[0],l[1],l[2]],i.ab.vec3.normalize([],i.ab.vec3.sub([],m,l)))}rayIntersectionCoordinate(r){const{p0:l,p1:m,t:x}=r,b=i.bH(l[2],this._center.lat),A=i.bH(m[2],this._center.lat);return new i.aa(i.af(l[0],m[0],x)/this.worldSize,i.af(l[1],m[1],x)/this.worldSize,i.af(b,A,x))}pointCoordinate(r,l=this._centerAltitude){return this.projection.pointCoordinate(this,r.x,r.y,l)}pointCoordinate3D(r){if(!this.elevation)return this.pointCoordinate(r);let l=this.projection.pointCoordinate3D(this,r.x,r.y);if(l)return new i.aa(l[0],l[1],l[2]);let m=0,x=this.horizonLineFromTop();if(r.y>x)return this.pointCoordinate(r);const b=.02*x,A=r.clone();for(let R=0;R<10&&x-m>b;R++){A.y=i.af(m,x,.66);const N=this.projection.pointCoordinate3D(this,A.x,A.y);N?(x=A.y,l=N):m=A.y}return l?new i.aa(l[0],l[1],l[2]):this.pointCoordinate(r)}isPointAboveHorizon(r){return this.projection.isPointAboveHorizon(this,r)}isPointOnSurface(r){if(r.y<0||r.y>this.height||r.x<0||r.x>this.width)return!1;if(this.elevation||this.zoom>=i.bY)return!this.isPointAboveHorizon(r);const l=this.pointCoordinate(r);return l.y>=0&&l.y<=1}_coordinatePoint(r,l){const m=l&&this.elevation?this.elevation.getAtPointOrZero(r,this._centerAltitude):this._centerAltitude,x=[r.x*this.worldSize,r.y*this.worldSize,m+r.toAltitude(),1];return i.ab.vec4.transformMat4(x,x,this.pixelMatrix),x[3]>0?new i.P(x[0]/x[3],x[1]/x[3]):new i.P(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:r,left:l}=this._edgeInsets,m=this.height-this._edgeInsets.bottom,x=this.width-this._edgeInsets.right,b=this.pointLocation3D(new i.P(l,r)),A=this.pointLocation3D(new i.P(x,r)),R=this.pointLocation3D(new i.P(x,m)),N=this.pointLocation3D(new i.P(l,m));let U=Math.min(b.lng,A.lng,R.lng,N.lng),$=Math.max(b.lng,A.lng,R.lng,N.lng),Z=Math.min(b.lat,A.lat,R.lat,N.lat),W=Math.max(b.lat,A.lat,R.lat,N.lat);const ee=Math.pow(2,-this.zoom)/16*270,ue=this.projection.name==="globe"?1:4,oe=(de,fe,Te,Pe,Oe)=>{const Fe=(de+Te)/2,Re=(fe+Pe)/2,ke=new i.P(Fe,Re),{lng:De,lat:$e}=this.pointLocation3D(ke),Xe=Math.max(0,U-De,Z-$e,De-$,$e-W);U=Math.min(U,De),$=Math.max($,De),Z=Math.min(Z,$e),W=Math.max(W,$e),(Oe<ue||Xe>ee)&&(oe(de,fe,Fe,Re,Oe+1),oe(Fe,Re,Te,Pe,Oe+1))};if(oe(l,r,x,r,1),oe(x,r,x,m,1),oe(x,m,l,m,1),oe(l,m,l,r,1),this.projection.name==="globe"){const[de,fe]=i.bZ(this);de?(W=90,$=180,U=-180):fe&&(Z=-90,$=180,U=-180)}return new i.az(new i.bO(U,Z),new i.bO($,W))}_getBoundsRectangular(r,l){const{top:m,left:x}=this._edgeInsets,b=this.height-this._edgeInsets.bottom,A=this.width-this._edgeInsets.right,R=new i.P(x,m),N=new i.P(A,m),U=new i.P(A,b),$=new i.P(x,b);let Z=this.pointCoordinate(R,r),W=this.pointCoordinate(N,r);const ee=this.pointCoordinate(U,l),ue=this.pointCoordinate($,l),oe=(de,fe)=>(fe.y-de.y)/(fe.x-de.x);return Z.y>1&&W.y>=0?Z=new i.aa((1-ue.y)/oe(ue,Z)+ue.x,1):Z.y<0&&W.y<=1&&(Z=new i.aa(-ue.y/oe(ue,Z)+ue.x,0)),W.y>1&&Z.y>=0?W=new i.aa((1-ee.y)/oe(ee,W)+ee.x,1):W.y<0&&Z.y<=1&&(W=new i.aa(-ee.y/oe(ee,W)+ee.x,0)),new i.az().extend(this.coordinateLocation(Z)).extend(this.coordinateLocation(W)).extend(this.coordinateLocation(ue)).extend(this.coordinateLocation(ee))}_getBoundsRectangularTerrain(){const r=this.elevation;if(!r.visibleDemTiles.length||r.isUsingMockSource())return this._getBoundsRectangular(0,0);const l=r.visibleDemTiles.reduce((m,x)=>{if(x.dem){const b=x.dem.tree;m.min=Math.min(m.min,b.minimums[0]),m.max=Math.max(m.max,b.maximums[0])}return m},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(l.min*r.exaggeration(),l.max*r.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(r=!0){const l=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))-this.centerOffset.y,m=this.height/2-l*(1-this._horizonShift);return r?Math.max(0,m):m}getMaxBounds(){return this.maxBounds}setMaxBounds(r){this.maxBounds=r,this.minLat=-i.bX,this.maxLat=i.bX,this.minLng=-180,this.maxLng=180,r&&(this.minLat=r.getSouth(),this.maxLat=r.getNorth(),this.minLng=r.getWest(),this.maxLng=r.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=i.at(this.minLng)*this.tileSize,this.worldMaxX=i.at(this.maxLng)*this.tileSize,this.worldMinY=i.aA(this.maxLat)*this.tileSize,this.worldMaxY=i.aA(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(r,l){return this.projection.createTileMatrix(this,l,r)}calculateDistanceTileData(r){const l=r.key,m=this._distanceTileDataCache;if(m[l])return m[l];const x=r.canonical,b=1/this.height,A=this.cameraWorldSize,R=A/this.zoomScale(x.z),N=(x.x+Math.pow(2,x.z)*r.wrap)*R,U=x.y*R,$=this.point;$.x*=A/this.worldSize,$.y*=A/this.worldSize;const Z=this.angle,W=Math.sin(-Z),ee=-Math.cos(-Z);return m[l]={bearing:[W,ee],center:[($.x-N)*b,($.y-U)*b],scale:R/i.ag*b},m[l]}calculateFogTileMatrix(r){const l=r.key,m=this._fogTileMatrixCache;if(m[l])return m[l];const x=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,r);return i.ab.mat4.multiply(x,this.worldToFogMatrix,x),m[l]=new Float32Array(x),m[l]}calculateProjMatrix(r,l=!1,m=!1){const x=r.key;let b;if(b=m?this._expandedProjMatrixCache:l?this._alignedProjMatrixCache:this._projMatrixCache,b[x])return b[x];const A=this.calculatePosMatrix(r,this.worldSize);let R;return R=this.projection.isReprojectedInTileSpace?this.mercatorMatrix:m?this.expandedFarZProjMatrix:l?this.alignedProjMatrix:this.projMatrix,i.ab.mat4.multiply(A,R,A),b[x]=new Float32Array(A),b[x]}calculatePixelsToTileUnitsMatrix(r){const l=r.tileID.key,m=this._pixelsToTileUnitsCache;if(m[l])return m[l];const x=i.b_(r,this);return m[l]=x,m[l]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const r=1/this.worldSize,l=i.ab.mat4.fromScaling([],[r,r,r]);return i.ab.mat4.multiply(l,l,this.globeMatrix),l}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const r=this._elevation;this._updateCameraState();const l=i.bH(1,this._center.lat)*this.worldSize,m=this._computeCameraPosition(l),x=this._camera.forward(),b=i.bH(1,this._center.lat);m[2]/=b,x[2]/=b,i.ab.vec3.normalize(x,x);const A=r.raycast(m,x,r.exaggeration());if(A){const R=i.ab.vec3.scaleAndAdd([],m,x,A),N=new i.aa(R[0],R[1],i.bH(R[2],i.aS(R[1]))),U=(N.z+i.ab.vec3.length([N.x-m[0],N.y-m[1],N.z-m[2]*b]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(U),this._centerAltitude=N.toAltitude(),this._center=this.coordinateLocation(N),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(r=!1){if(!this._elevation)return;const l=this._elevation,m=i.bH(1,this._center.lat)*this.worldSize,x=this._computeCameraPosition(m),b=l.getAtPointOrZero(new i.aa(...x)),A=this.pixelsPerMeter/this.worldSize*b,R=this._minimumHeightOverTerrain(),N=x[2]-A;if(N<=R)if(N<0||r){const U=this.locationCoordinate(this._center,this._centerAltitude),$=[x[0],x[1],U.z-x[2]],Z=i.ab.vec3.length($);$[2]-=(R-N)/this._pixelsPerMercatorPixel;const W=i.ab.vec3.length($);if(W===0)return;i.ab.vec3.scale($,$,Z/W*this._pixelsPerMercatorPixel),this._camera.position=[x[0],x[1],U.z*this._pixelsPerMercatorPixel-$[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const r=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||r){const W=this.center;return W.lat=i.aw(W.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!r)&&(W.lng=i.aw(W.lng,this.minLng,this.maxLng)),this.center=W,void(this._constraining=!1)}const l=this._unmodified,{x:m,y:x}=this.point;let b=0,A=m,R=x;const N=this.width/2,U=this.height/2,$=this.worldMinY*this.scale,Z=this.worldMaxY*this.scale;if(x-U<$&&(R=$+U),x+U>Z&&(R=Z-U),Z-$<this.height&&(b=Math.max(b,this.height/(Z-$)),R=(Z+$)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const W=this.worldMinX*this.scale,ee=this.worldMaxX*this.scale,ue=this.worldSize/2-(W+ee)/2;A=(m+ue+this.worldSize)%this.worldSize-ue,A-N<W&&(A=W+N),A+N>ee&&(A=ee-N),ee-W<this.width&&(b=Math.max(b,this.width/(ee-W)),A=(ee+W)/2)}A===m&&R===x||(this.center=this.unproject(new i.P(A,R))),b&&(this.zoom+=this.scaleZoom(b)),this._constrainCamera(),this._unmodified=l,this._constraining=!1}_minZoomForBounds(){let r=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(r=Math.max(r,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),r}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const r=this.centerOffset,l=this.projection.name==="globe",m=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=i.bH(1,this.center.lat)/i.bH(1,i.c8));const x=i.b$(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,x),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const b=this.projection.zAxisUnit==="meters"?m:1,A=this._camera.getWorldToCamera(this.worldSize,b);let R;const N=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);if(N[8]=2*-r.x/this.width,N[9]=2*r.y/this.height,this.isOrthographic){let $e=.5*this.height/Math.tan(this._fov/2)*1*Math.tan(.5*this._fov),Xe=$e*this.aspect,ft=-Xe,ot=-$e;Xe-=r.x,ft-=r.x,$e+=r.y,ot+=r.y,R=this._camera.getCameraToClipOrthographic(ft,Xe,ot,$e,this._nearZ,this._farZ),((Et,vt,nt,pt)=>{for(let Lt=0;Lt<16;Lt++)Et[Lt]=qd(vt[Lt],nt[Lt],pt)})(R,R,N,Sf(this.pitch>=15?1:this.pitch/15))}else R=N;const U=i.ab.mat4.mul([],N,A);let $=i.ab.mat4.mul([],R,A);if(this.projection.isReprojectedInTileSpace){const $e=this.locationCoordinate(this.center),Xe=i.ab.mat4.identity([]);i.ab.mat4.translate(Xe,Xe,[$e.x*this.worldSize,$e.y*this.worldSize,0]),i.ab.mat4.multiply(Xe,Xe,i.c0(this)),i.ab.mat4.translate(Xe,Xe,[-$e.x*this.worldSize,-$e.y*this.worldSize,0]),i.ab.mat4.multiply($,$,Xe),i.ab.mat4.multiply(U,U,Xe),this.inverseAdjustmentMatrix=i.c1(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];if(this.mercatorMatrix=i.ab.mat4.scale([],$,[this.worldSize,this.worldSize,this.worldSize/b,1]),this.projMatrix=$,this.invProjMatrix=i.ab.mat4.invert(new Float64Array(16),this.projMatrix),l){const $e=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,1/0);$e[8]=2*-r.x/this.width,$e[9]=2*r.y/this.height,this.expandedFarZProjMatrix=i.ab.mat4.mul([],$e,A)}else this.expandedFarZProjMatrix=this.projMatrix;const Z=i.ab.mat4.invert([],R);this.frustumCorners=i.c2.fromInvProjectionMatrix(Z,this.horizonLineFromTop(),this.height),this.cameraFrustum=i.bR.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,0,!l);const W=new Float32Array(16);i.ab.mat4.identity(W),i.ab.mat4.scale(W,W,[1,-1,1]),i.ab.mat4.rotateX(W,W,this._pitch),i.ab.mat4.rotateZ(W,W,this.angle);const ee=i.ab.mat4.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ);this.starsProjMatrix=i.ab.mat4.clone(ee);const ue=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;ee[8]=2*-r.x/this.width,ee[9]=2*(r.y+ue)/this.height,this.skyboxMatrix=i.ab.mat4.multiply(W,ee,W);const oe=this.point,de=oe.x,fe=oe.y,Te=this.width%2/2,Pe=this.height%2/2,Oe=Math.cos(this.angle),Fe=Math.sin(this.angle),Re=de-Math.round(de)+Oe*Te+Fe*Pe,ke=fe-Math.round(fe)+Oe*Pe+Fe*Te,De=new Float64Array($);if(i.ab.mat4.translate(De,De,[Re>.5?Re-1:Re,ke>.5?ke-1:ke,0]),this.alignedProjMatrix=De,$=i.ab.mat4.create(),i.ab.mat4.scale($,$,[this.width/2,-this.height/2,1]),i.ab.mat4.translate($,$,[1,-1,0]),this.labelPlaneMatrix=$,$=i.ab.mat4.create(),i.ab.mat4.scale($,$,[1,-1,1]),i.ab.mat4.translate($,$,[-1,-1,0]),i.ab.mat4.scale($,$,[2/this.width,2/this.height,1]),this.glCoordMatrix=$,this.pixelMatrix=i.ab.mat4.multiply(new Float64Array(16),this.labelPlaneMatrix,U),this._calcFogMatrices(),this._distanceTileDataCache={},$=i.ab.mat4.invert(new Float64Array(16),this.pixelMatrix),!$)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=$,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=i.c3(this);const $e=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=i.ab.vec3.transformMat4($e,$e,A),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=$;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={},this._expandedProjMatrixCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const r=this.cameraWorldSizeForFog,l=this.cameraPixelsPerMeter,m=this._camera.position,x=1/this.height/this._pixelsPerMercatorPixel,b=[r,r,l];i.ab.vec3.scale(b,b,x),i.ab.vec3.scale(m,m,-1),i.ab.vec3.multiply(m,m,b);const A=i.ab.mat4.create();i.ab.mat4.translate(A,A,m),i.ab.mat4.scale(A,A,b),this.mercatorFogMatrix=A,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(r,l,x)}_computeCameraPosition(r){const l=(r=r||this.pixelsPerMeter)/this.pixelsPerMeter,m=this._camera.forward(),x=this.point,b=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*l-r/this.worldSize*this._centerAltitude;return[x.x/this.worldSize-m[0]*b,x.y/this.worldSize-m[1]*b,r/this.worldSize*this._centerAltitude-m[2]*b]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(r){const l=this._maxCameraBoundsDistance()*Math.cos(this._pitch),m=this._camera.position[2],x=r[2];let b=1;this.projection.wrap&&(this.center=this.center.wrap()),x>0&&(b=Math.min((l-m)/x,1)),this._camera.position=i.ab.vec3.scaleAndAdd([],this._camera.position,r,b),this._updateStateFromCamera()}_updateStateFromCamera(){const r=this._camera.position,l=this._camera.forward(),{pitch:m,bearing:x}=this._camera.getPitchBearing(),b=i.bH(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,A=this._mercatorZfromZoom(this._maxZoom)*Math.cos(i.ai(this._maxPitch)),R=Math.max((r[2]-b)/Math.cos(m),A),N=this._zoomFromMercatorZ(R);i.ab.vec3.scaleAndAdd(r,r,l,R),this._pitch=i.aw(m,i.ai(this.minPitch),i.ai(this.maxPitch)),this.angle=i.bF(x,-Math.PI,Math.PI),this._setZoom(i.aw(N,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new i.aa(r[0],r[1],r[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(r){return Math.pow(2,r)*this.tileSize}_mercatorZfromZoom(r){return this.cameraToCenterDistance/this._worldSizeFromZoom(r)}_minimumHeightOverTerrain(){const r=Math.min(this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom,this._maxZoom)+4;return this._mercatorZfromZoom(r)}_zoomFromMercatorZ(r){return this.scaleZoom(this.cameraToCenterDistance/(r*this.tileSize))}zoomFromMercatorZAdjusted(r){let l=0,m=i.bY,x=0,b=1/0;for(;m-l>1e-6&&m>l;){const A=l+.5*(m-l),R=this.tileSize*Math.pow(2,A),N=this.getCameraToCenterDistance(this.projection,A,R),U=this.scaleZoom(N/(r*this.tileSize)),$=Math.abs(A-U);$<b&&(b=$,x=A),A<U?l=A:m=A}return x}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(i.w("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(r,l){const m=Math.min(r.x,l.x),x=Math.max(r.x,l.x),b=Math.min(r.y,l.y),A=Math.max(r.y,l.y);if(b<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const R=[new i.P(m,b),new i.P(x,A),new i.P(m,A),new i.P(x,b)],N=this.renderWorldCopies?-3:0,U=this.renderWorldCopies?4:1;for(const $ of R){const Z=this.pointRayIntersection($);if(Z.t<0)return!0;const W=this.rayIntersectionCoordinate(Z);if(W.x<N||W.y<0||W.x>U||W.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+i.c4(this.fovAboveCenter)>88||this.anyCornerOffEdge(new i.P(0,0),new i.P(this.width,this.height))}zoomDeltaToMovement(r,l){const m=i.ab.vec3.length(i.ab.vec3.sub([],this._camera.position,r)),x=this._zoomFromMercatorZ(m)+l;return m-this._mercatorZfromZoom(x)}getCameraPoint(){if(this.projection.name==="globe"){const r=function([l,m,x],b){const A=[l,m,x,1];i.ab.vec4.transformMat4(A,A,b);const R=A[3]=Math.max(A[3],1e-6);return A[0]/=R,A[1]/=R,A[2]/=R,A}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new i.P(r[0],r[1])}{const r=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new i.P(0,r))}}getCameraToCenterDistance(r,l=this.zoom,m=this.worldSize){const x=i.b$(r,l,this.width,this.height,1024),b=r.pixelSpaceConversion(this.center.lat,m,x);let A=.5/Math.tan(.5*this._fov)*this.height*b;return this.isOrthographic&&(A=qd(1,A,Sf(this.pitch>=15?1:this.pitch/15))),A}getWorldToCameraMatrix(){const r=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&i.ab.mat4.multiply(r,r,this.globeMatrix),r}getFrustum(r){return i.bR.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,r,this.projection.zAxisUnit==="meters")}}const sc=(p,r)=>{if(r>0&&p.terrain&&i.w("Cutoff is currently disabled on terrain"),r<=0||p.terrain)return{shouldRenderCutoff:!1,uniformValues:{u_cutoff_params:[0,0,0,1]}};const l=p.transform,m=Math.max(Math.abs(l._zoom-(p.minCutoffZoom-1)),1),x=l.isLODDisabled(!1)?i.ac(60,45,l.pitch):i.ac(30,15,l.pitch),b=l._farZ-l._nearZ,A=r*l.height,R=((1-(N=x))*l.cameraToCenterDistance+N*(l._farZ+A))*m;var N;return{shouldRenderCutoff:x<1,uniformValues:{u_cutoff_params:[l._nearZ,l._farZ,(R-l._nearZ)/b,(R-A-l._nearZ)/b]}}},ga={cascadeCount:2,normalOffset:3,shadowMapResolution:2048};class Al{constructor(r,l){this.aabb=r,this.lastCascade=l}}class lm{add(r,l){const m=this.receivers[r.key];m!==void 0?(m.aabb.min[0]=Math.min(m.aabb.min[0],l.min[0]),m.aabb.min[1]=Math.min(m.aabb.min[1],l.min[1]),m.aabb.min[2]=Math.min(m.aabb.min[2],l.min[2]),m.aabb.max[0]=Math.max(m.aabb.max[0],l.max[0]),m.aabb.max[1]=Math.max(m.aabb.max[1],l.max[1]),m.aabb.max[2]=Math.max(m.aabb.max[2],l.max[2])):this.receivers[r.key]=new Al(l,null)}clear(){this.receivers={}}get(r){return this.receivers[r.key]}computeRequiredCascades(r,l,m){const x=i.cd.fromPoints(r.points);let b=0;for(const A in this.receivers){const R=this.receivers[A];if(!R||!x.intersectsAabb(R.aabb))continue;R.aabb.min=x.closestPoint(R.aabb.min),R.aabb.max=x.closestPoint(R.aabb.max);const N=R.aabb.getCorners();for(let U=0;U<m.length;U++){let $=!0;for(const Z of N){const W=[Z[0]*l,Z[1]*l,Z[2]];if(i.ab.vec3.transformMat4(W,W,m[U].matrix),W[0]<-1||W[0]>1||W[1]<-1||W[1]>1){$=!1;break}}if(R.lastCascade=U,b=Math.max(b,U),$)break}}return b+1}}class ya{constructor(r){this.painter=r,this._enabled=!1,this._shadowLayerCount=0,this._numCascadesToRender=0,this._cascades=[],this._groundShadowTiles=[],this._receivers=new lm,this._depthMode=new Tn(r.context.gl.LEQUAL,Tn.ReadWrite,[0,1]),this._uniformValues={u_light_matrix_0:new Float32Array(16),u_light_matrix_1:new Float32Array(16),u_shadow_intensity:0,u_fade_range:[0,0],u_shadow_normal_offset:[1,1,1],u_shadow_texel_size:1,u_shadow_map_resolution:1,u_shadow_direction:[0,0,1],u_shadow_bias:[36e-5,.0012,.012],u_shadowmap_0:0,u_shadowmap_1:0},this._forceDisable=!1,this.useNormalOffset=!1,r.tp.registerParameter(this,["Shadows"],"_forceDisable",{label:"forceDisable"},()=>{this.painter.style.map.triggerRepaint()}),r.tp.registerParameter(ga,["Shadows"],"cascadeCount",{min:1,max:2,step:1}),r.tp.registerParameter(ga,["Shadows"],"normalOffset",{min:0,max:10,step:.05}),r.tp.registerParameter(ga,["Shadows"],"shadowMapResolution",{min:32,max:2048,step:32}),r.tp.registerBinding(this,["Shadows"],"_numCascadesToRender",{readonly:!0,label:"numCascadesToRender"})}destroy(){for(const r of this._cascades)r.texture.destroy(),r.framebuffer.destroy();this._cascades=[]}updateShadowParameters(r,l){const m=this.painter;if(this._enabled=!1,this._shadowLayerCount=0,this._receivers.clear(),!l||!l.properties)return;const x=l.properties.get("shadow-intensity");if(!l.shadowsEnabled()||x<=0||(this._shadowLayerCount=m.style.order.reduce((ue,oe)=>{const de=m.style._mergedLayers[oe];return ue+(de.hasShadowPass()&&!de.isHidden(r.zoom)?1:0)},0),this._enabled=this._shadowLayerCount>0,!this.enabled))return;const b=m.context,A=ga.shadowMapResolution,R=ga.shadowMapResolution;if(this._cascades.length===0||ga.shadowMapResolution!==this._cascades[0].texture.size[0]){this._cascades=[];for(let ue=0;ue<ga.cascadeCount;++ue){const oe=m._shadowMapDebug,de=b.gl,fe=b.createFramebuffer(A,R,oe,"texture"),Te=new i.T(b,{width:A,height:R,data:null},de.DEPTH_COMPONENT16);if(fe.depthAttachment.set(Te.texture),oe){const Pe=new i.T(b,{width:A,height:R,data:null},de.RGBA8);fe.colorAttachment.set(Pe.texture)}this._cascades.push({framebuffer:fe,texture:Te,matrix:[],far:0,boundingSphereRadius:0,frustum:new i.bR,scale:0})}}this.shadowDirection=lc(l);let N=0;if(r.elevation){const ue=r.elevation,oe=[1e4,-1e4];ue.visibleDemTiles.filter(de=>de.dem).forEach(de=>{const fe=de.dem.tree;oe[0]=Math.min(oe[0],fe.minimums[0]),oe[1]=Math.max(oe[1],fe.maximums[0])}),oe[0]!==1e4&&(N=(oe[1]-oe[0])*ue.exaggeration())}const U=1.5*r.cameraToCenterDistance,$=3*U,Z=new Float64Array(16);for(let ue=0;ue<this._cascades.length;++ue){const oe=this._cascades[ue];let de=r.height/50,fe=1;ga.cascadeCount===1?fe=$:ue===0?fe=U:(de=U,fe=$);const[Te,Pe]=I0(r,this.shadowDirection,de,fe,ga.shadowMapResolution,N);oe.scale=r.scale,oe.matrix=Te,oe.boundingSphereRadius=Pe,i.ab.mat4.invert(Z,oe.matrix),oe.frustum=i.bR.fromInvProjectionMatrix(Z,1,0,!0),oe.far=fe}const W=this._cascades.length-1;this._uniformValues.u_fade_range=[.75*this._cascades[W].far,this._cascades[W].far],this._uniformValues.u_shadow_intensity=x,this._uniformValues.u_shadow_direction=[this.shadowDirection[0],this.shadowDirection[1],this.shadowDirection[2]],this._uniformValues.u_shadow_texel_size=1/ga.shadowMapResolution,this._uniformValues.u_shadow_map_resolution=ga.shadowMapResolution,this._uniformValues.u_shadowmap_0=na.ShadowMap0,this._uniformValues.u_shadowmap_1=na.ShadowMap0+1,this._groundShadowTiles=m.transform.coveringTiles({tileSize:512,renderWorldCopies:!0});const ee=m.transform.elevation;for(const ue of this._groundShadowTiles){let oe={min:0,max:0};if(ee){const de=ee.getMinMaxForTile(ue);de&&(oe=de)}this.addShadowReceiver(ue.toUnwrapped(),oe.min,oe.max)}}get enabled(){return this._enabled&&!this._forceDisable}set enabled(r){this._enabled=r}drawShadowPass(r,l){if(!this.enabled)return;const m=this.painter,x=m.context;this._numCascadesToRender=this._receivers.computeRequiredCascades(m.transform.getFrustum(0),m.transform.worldSize,this._cascades),x.viewport.set([0,0,ga.shadowMapResolution,ga.shadowMapResolution]);for(let b=0;b<this._numCascadesToRender;++b){m.currentShadowCascade=b,x.bindFramebuffer.set(this._cascades[b].framebuffer.framebuffer),x.clear({color:i.aj.white,depth:1});for(const A of r.order){const R=r._mergedLayers[A];if(!R.hasShadowPass()||R.isHidden(m.transform.zoom))continue;const N=r.getLayerSourceCache(R),U=N?l[N.id]:void 0;(R.type==="model"||U&&U.length)&&m.renderLayer(m,N,R,U)}}m.currentShadowCascade=0}drawGroundShadows(){if(!this.enabled)return;const r=this.painter,l=r.style,m=r.context,x=l.directionalLight,b=l.ambientLight;if(!x||!b)return;const A=[],R=sc(r,r.longestCutoffRange);R.shouldRenderCutoff&&A.push("RENDER_CUTOFF"),A.push("RENDER_SHADOWS","DEPTH_TEXTURE"),this.useNormalOffset&&A.push("NORMAL_OFFSET");const N=Gd(l,x,b),U=new Tn(m.gl.LEQUAL,Tn.ReadOnly,r.depthRangeFor3D);for(const $ of this._groundShadowTiles){const Z=$.toUnwrapped(),W=r.isTileAffectedByFog($),ee=r.getOrCreateProgram("groundShadow",{defines:A,overrideFog:W});this.setupShadows(Z,ee),r.uploadCommonUniforms(m,ee,Z,null,R);const ue={u_matrix:r.transform.calculateProjMatrix(Z),u_ground_shadow_factor:N};ee.draw(r,m.gl.TRIANGLES,U,Dn.disabled,Jn.multiply,Rn.disabled,ue,"ground_shadow",r.tileExtentBuffer,r.quadTriangleIndexBuffer,r.tileExtentSegments,{},r.transform.zoom,null,null)}}getShadowPassColorMode(){return this.painter._shadowMapDebug?Jn.unblended:Jn.disabled}getShadowPassDepthMode(){return this._depthMode}getShadowCastingLayerCount(){return this._shadowLayerCount}calculateShadowPassMatrixFromTile(r){const l=this.painter.transform,m=l.calculatePosMatrix(r,l.worldSize);return i.ab.mat4.multiply(m,this._cascades[this.painter.currentShadowCascade].matrix,m),Float32Array.from(m)}calculateShadowPassMatrixFromMatrix(r){return i.ab.mat4.multiply(r,this._cascades[this.painter.currentShadowCascade].matrix,r),Float32Array.from(r)}setupShadows(r,l,m,x=0){if(!this.enabled)return;const b=this.painter.transform,A=this.painter.context,R=A.gl,N=this._uniformValues,U=new Float64Array(16),$=b.calculatePosMatrix(r,b.worldSize);for(let Z=0;Z<this._cascades.length;Z++)i.ab.mat4.multiply(U,this._cascades[Z].matrix,$),N[Z===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(U),A.activeTexture.set(R.TEXTURE0+na.ShadowMap0+Z),this._cascades[Z].texture.bind(R.NEAREST,R.CLAMP_TO_EDGE);if(this.useNormalOffset=!!m,this.useNormalOffset){const Z=i.cc(r.canonical),W=2/b.tileSize*i.ag/ga.shadowMapResolution,ee=W*this._cascades[0].boundingSphereRadius,ue=W*this._cascades[this._cascades.length-1].boundingSphereRadius,oe=(m==="vector-tile"?1:3)/Math.pow(2,x-r.canonical.z-(1-b.zoom+Math.floor(b.zoom)));N.u_shadow_normal_offset=[Z,ee*oe,ue*oe],N.u_shadow_bias=[6e-5,.0012,.012]}else N.u_shadow_bias=[36e-5,.0012,.012];l.setShadowUniformValues(A,N)}setupShadowsFromMatrix(r,l,m=!1){if(!this.enabled)return;const x=this.painter.context,b=x.gl,A=this._uniformValues,R=new Float64Array(16);for(let N=0;N<ga.cascadeCount;N++)i.ab.mat4.multiply(R,this._cascades[N].matrix,r),A[N===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(R),x.activeTexture.set(b.TEXTURE0+na.ShadowMap0+N),this._cascades[N].texture.bind(b.NEAREST,b.CLAMP_TO_EDGE);if(this.useNormalOffset=m,m){const N=ga.normalOffset;A.u_shadow_normal_offset=[1,N,N],A.u_shadow_bias=[6e-5,.0012,.012]}else A.u_shadow_bias=[36e-5,.0012,.012];l.setShadowUniformValues(x,A)}getShadowUniformValues(){return this._uniformValues}getCurrentCascadeFrustum(){return this._cascades[this.painter.currentShadowCascade].frustum}computeSimplifiedTileShadowVolume(r,l,m,x){if(x[2]>=0)return{};const b=function(N,U,$){const Z=$/(1<<N.canonical.z);return new i.cd([N.canonical.x*Z+N.wrap*$,N.canonical.y*Z+N.wrap*$,0],[(N.canonical.x+1)*Z+N.wrap*$,(N.canonical.y+1)*Z+N.wrap*$,U])}(r,l,m).getCorners(),A=l/-x[2];x[0]<0?(i.ab.vec3.add(b[0],b[0],[x[0]*A,0,0]),i.ab.vec3.add(b[3],b[3],[x[0]*A,0,0])):x[0]>0&&(i.ab.vec3.add(b[1],b[1],[x[0]*A,0,0]),i.ab.vec3.add(b[2],b[2],[x[0]*A,0,0])),x[1]<0?(i.ab.vec3.add(b[0],b[0],[0,x[1]*A,0]),i.ab.vec3.add(b[1],b[1],[0,x[1]*A,0])):x[1]>0&&(i.ab.vec3.add(b[2],b[2],[0,x[1]*A,0]),i.ab.vec3.add(b[3],b[3],[0,x[1]*A,0]));const R={};return R.vertices=b,R.planes=[Rs(b[1],b[0],b[4]),Rs(b[2],b[1],b[5]),Rs(b[3],b[2],b[6]),Rs(b[0],b[3],b[7])],R}addShadowReceiver(r,l,m){this._receivers.add(r,i.cd.fromTileIdAndHeight(r,l,m))}getMaxCascadeForTile(r){const l=this._receivers.get(r);return l&&l.lastCascade?l.lastCascade:0}}function Rs(p,r,l){const m=i.ab.vec3.sub([],l,r),x=i.ab.vec3.sub([],p,r),b=i.ab.vec3.cross([],m,x),A=i.ab.vec3.length(b);return A===0?[0,0,1,0]:(i.ab.vec3.scale(b,b,1/A),[b[0],b[1],b[2],-i.ab.vec3.dot(b,r)])}function lc(p){const r=p.properties.get("direction"),l=i.cb(r.x,r.y,r.z);l[2]=i.aw(l[2],0,75);const m=i.ce([l[0],l[1],l[2]]);return i.ab.vec3.fromValues(m.x,m.y,m.z)}function Gd(p,r,l){const m=r.properties.get("color-use-theme")==="none",x=r.properties.get("color"),b=r.properties.get("intensity"),A=r.properties.get("direction"),R=[A.x,A.y,A.z],N=l.properties.get("color-use-theme")==="none",U=l.properties.get("color"),$=l.properties.get("intensity"),Z=Math.max(i.ab.vec3.dot([0,0,1],R),0),W=[0,0,0];i.ab.vec3.scale(W,U.toRenderColor(N?null:p.getLut(r.scope)).toArray01Linear().slice(0,3),$);const ee=[0,0,0];return i.ab.vec3.scale(ee,x.toRenderColor(m?null:p.getLut(l.scope)).toArray01Linear().slice(0,3),Z*b),i.cf([W[0]>0?W[0]/(W[0]+ee[0]):0,W[1]>0?W[1]/(W[1]+ee[1]):0,W[2]>0?W[2]/(W[2]+ee[2]):0])}function I0(p,r,l,m,x,b){const A=p.zoom,R=p.scale,N=p.worldSize,U=1/N,$=p.aspect,Z=Math.sqrt(1+$*$)*Math.tan(.5*p.fovX),W=Z*Z,ee=m-l,ue=m+l;let oe,de;W>ee/ue?(oe=m,de=m*Z):(oe=.5*ue*(1+W),de=.5*Math.sqrt(ee*ee+2*(m*m+l*l)*W+ue*ue*W*W));const fe=p.projection.pixelsPerMeter(p.center.lat,N),Te=p._camera.getCameraToWorldMercator(),Pe=[0,0,-oe*U];i.ab.vec3.transformMat4(Pe,Pe,Te);let Oe=de*U;const Fe=p._edgeInsets;if(!(Fe.left===0&&Fe.top===0&&Fe.right===0&&Fe.bottom===0||Fe.left===Fe.right&&Fe.top===Fe.bottom)){const Gt=p._camera.getWorldToCamera(p.worldSize,p.projection.zAxisUnit==="meters"?fe:1),Pt=p._camera.getCameraToClipPerspective(p._fov,p.width/p.height,l,m);Pt[8]=2*-p.centerOffset.x/p.width,Pt[9]=2*p.centerOffset.y/p.height;const At=new Float64Array(16);i.ab.mat4.mul(At,Pt,Gt);const kt=new Float64Array(16);i.ab.mat4.invert(kt,At);const Wt=i.bR.fromInvProjectionMatrix(kt,N,A,!0);for(const on of Wt.points){const dn=((Re=on)[0]/=R,Re[1]/=R,Re[2]=i.bH(Re[2],p._center.lat),Re);Oe=Math.max(Oe,i.ab.vec3.len(i.ab.vec3.subtract([],Pe,dn)))}}var Re;Oe*=x/(x-1);const ke=Math.acos(r[2]),De=Math.atan2(-r[0],-r[1]),$e=new qa;$e.position=Pe,$e.setPitchBearing(ke,De);const Xe=$e.getWorldToCamera(N,fe),ft=Oe*N,ot=Math.min(p._mercatorZfromZoom(17)*N*-2,-2*ft),Et=$e.getCameraToClipOrthographic(-ft,ft,-ft,ft,ot,(ft+b*fe)/r[2]),vt=new Float64Array(16);i.ab.mat4.multiply(vt,Et,Xe);const nt=i.ab.vec3.fromValues(Math.floor(1e6*Pe[0])/1e6*N,Math.floor(1e6*Pe[1])/1e6*N,0),pt=.5*x,Lt=[0,0,0];i.ab.vec3.transformMat4(Lt,nt,vt),i.ab.vec3.scale(Lt,Lt,pt);const tt=[Math.floor(Lt[0]),Math.floor(Lt[1]),Math.floor(Lt[2])],St=[0,0,0];i.ab.vec3.sub(St,Lt,tt),i.ab.vec3.scale(St,St,-1/pt);const mt=new Float64Array(16);return i.ab.mat4.identity(mt),i.ab.mat4.translate(mt,mt,St),i.ab.mat4.multiply(vt,mt,vt),[vt,ft]}class Hd extends i.E{constructor(r){super(),this.requestManager=r,this.models={"":{}},this.modelUris={"":{}},this.numModelsLoading={}}loadModel(r,l){return i.aM(this.requestManager.transformRequest(l,i.R.Model).url).then(m=>{if(!m)return;const x=i.aN(m),b=new i.aO(r,void 0,void 0,x);return b.computeBoundsAndApplyParent(),b}).catch(m=>{if(m&&m.status===404)return null;this.fire(new i.y(new Error(`Could not load model ${r} from ${l}: ${m.message}`)))})}load(r,l,m={keepNumReferences:!1}){this.models[l]||(this.models[l]={});const x=Object.keys(r);this.numModelsLoading[l]=(this.numModelsLoading[l]||0)+x.length;const b=[];for(const A of x)b.push(this.loadModel(A,r[A]));Promise.allSettled(b).then(A=>{for(let R=0;R<A.length;R++){const{status:N,value:U}=A[R];if(N==="fulfilled"&&U){const $=this.models[l][x[R]];this.models[l][x[R]]={model:U,numReferences:m.keepNumReferences&&$?$.numReferences:1}}}this.numModelsLoading[l]-=x.length,this.fire(new i.z("data",{dataType:"style"}))}).catch(A=>{this.fire(new i.y(new Error(`Could not load models: ${A.message}`)))})}isLoaded(){for(const r in this.numModelsLoading)if(this.numModelsLoading[r]>0)return!1;return!0}hasModel(r,l){return!!this.getModel(r,l)}getModel(r,l){return this.models[l]||(this.models[l]={}),this.models[l][r]?this.models[l][r].model:void 0}addModel(r,l,m){this.models[m]||(this.models[m]={}),this.modelUris[m]||(this.modelUris[m]={}),this.hasModel(r,m)&&this.models[m][r].numReferences++,this.modelUris[m][r]=this.requestManager.normalizeModelURL(l),this.load({[r]:this.modelUris[m][r]},m)}addModels(r,l){this.models[l]||(this.models[l]={}),this.modelUris[l]||(this.modelUris[l]={});const m=this.modelUris[l];for(const x in r)this.models[l][x]={},m[x]=this.requestManager.normalizeModelURL(r[x]);this.load(m,l,{keepNumReferences:!0})}reloadModels(r){this.load(this.modelUris[r],r)}addModelsFromBucket(r,l){this.models[l]||(this.models[l]={}),this.modelUris[l]||(this.modelUris[l]={});const m={};for(const x of r)this.hasModel(x,l)?this.models[l][x].numReferences++:(this.modelUris[l][x]=this.requestManager.normalizeModelURL(x),m[x]=this.modelUris[l][x]);this.load(m,l)}removeModel(r,l){if(this.models[l]&&this.models[l][r]&&(this.models[l][r].numReferences--,this.models[l][r].numReferences===0)){const m=this.models[l][r].model;delete this.models[l][r],delete this.modelUris[l][r],m.destroy()}}listModels(r){return this.models[r]||(this.models[r]={}),Object.keys(this.models[r])}upload(r,l){this.models[l]||(this.models[l]={});for(const m in this.models[l])this.models[l][m].model&&this.models[l][m].model.upload(r.context)}}const cm=new i.a5({data:new i.a6(i.a3.colorTheme.data)}),P0={"mbx-indoor-active-floorplans":{default:["literal",[]]},"mbx-indoor-underground":{default:["literal",!1]},"mbx-indoor-loaded-levels":{default:["literal",[]]},"mbx-indoor-level-height":{default:["literal",{}]},"mbx-indoor-level-base":{default:["literal",{}]},"mbx-indoor-level-selected":{default:["literal",{}]},"mbx-indoor-level-overlapped":{default:["literal",{}]}};function um(p){return p=p||{},Object.assign(p,P0)}class cc extends i.E{constructor(r){super(),this.mergeFloors=!0,this._scope=void 0,this._queryFeatureSetId=void 0,this._buildingEntryFeatureSetId=void 0,this._selectedFloorplan=void 0,this._indoorData=void 0,this._selectedLevel=void 0,this._floorplanStates={},i.aP(["_onLoad","_onMove","_checkFloorplanVisible"],this),this._map=r,this._checkFloorplanVisible(!0),this._map.on("load",this._onLoad),this._map.on("move",this._onMove)}destroy(){this._map.indoor.off("load",this._onLoad),this._map.indoor.off("move",this._onMove),this._map=void 0}_onLoad(){this._map.style.forEachFragmentStyle(r=>{r.stylesheet.indoor&&(this._queryFeatureSetId?this.fire(new i.y(new Error("Multiple indoor map styles detected, simultaneous usage is not allowed currently."))):(this._queryFeatureSetId=r.stylesheet.indoor.floorplanFeaturesetId,this._buildingEntryFeatureSetId=r.stylesheet.indoor.buildingFeaturesetId,this._scope=r.scope))}),this._queryFeatureSetId&&this._buildingEntryFeatureSetId&&this._map.addInteraction("mbx-indoor-buildingclick",{type:"click",target:{featuresetId:this._buildingEntryFeatureSetId,importId:this._scope},handler:r=>(r.feature&&r.feature.properties.floorplan&&this.selectFloorplan(r.feature.properties.floorplan),!0)}),this._checkFloorplanVisible(!0)}_onMove(){this._checkFloorplanVisible(!1)}_checkFloorplanVisible(r){if(!this._queryFeatureSetId||!this._map.isStyleLoaded()||this._map.transform.zoom<13)return;this._indoorData&&!function(A,R){const[N,U]=A,{center:$,radius:Z}=R,[W,ee]=$,ue=Math.abs(N-W);return Math.sqrt((ue>180?360-ue:ue)**2+(U-ee)**2)<=Z}([this._map.getCenter().lng,this._map.getCenter().lat],this._indoorData.circumCircle)&&(this._indoorData=void 0,this._selectedFloorplan=void 0,this._map.setConfigProperty(this._scope,"mbx-indoor-underground",!1),this._map.setConfigProperty(this._scope,"mbx-indoor-active-floorplans",["literal",[]]),this.fire(new i.z("floorplangone")));const l={target:{featuresetId:this._queryFeatureSetId,importId:this._scope}},m=new i.P(this._map.transform.width/2,this._map.transform.height/2),x=[new i.P(0,0),new i.P(this._map.transform.width,this._map.transform.height)],b=this._map.queryRenderedFeatures(r?x:m,l);b.length>0&&(this._selectedFloorplan&&b[0].properties.id===this._selectedFloorplan.properties.id||(this._selectedFloorplan=b[0],this._floorplanSelected(!1)))}_floorplanSelected(r){this._indoorData=JSON.parse(this._selectedFloorplan.properties["indoor-data"]),this._indoorData.id=this._selectedFloorplan.properties.id,this._indoorData.circumCircle=function(b){const[[A,R],[N,U]]=b,$=(N-A+360)%360,Z=$>180?360-$:$;return{center:[(A+Z/2+360)%360,(R+U)/2],radius:Math.sqrt(Z**2+(U-R)**2)/2}}(this._indoorData.extent),this._floorplanStates[this._indoorData.id]||(this._floorplanStates[this._indoorData.id]={});const l=this._floorplanStates[this._indoorData.id].selectedBuilding,m=this._floorplanStates[this._indoorData.id].selectedLevel;let x;if(this._map.setConfigProperty(this._scope,"mbx-indoor-active-floorplans",this._indoorData.floorplanIDs),this._selectedLevel)for(const b of this._indoorData.levels)b.id===this._selectedLevel.id&&(x=b.id);if(this.fire(new i.z("floorplanselected",{buildings:this._indoorData.buildings,levels:this._indoorData.levels,selectedLevelId:x})),l){const b=this._indoorData.buildings.find(A=>A.id===l);this._buildingSelected(b,!1)}else this._indoorData.buildings.length>0&&this._buildingSelected(this._indoorData.buildings[0],!1);if(m){const b=this._indoorData.levels.find(A=>A.id===m);this._updateLevels(b,r)}else r&&this._indoorData["default-levels"].length>0&&this.selectLevel(this._indoorData["default-levels"][0])}_buildingSelected(r,l){l&&r&&r.extent&&this._map.fitBounds(r.extent,{pitch:this._map.getPitch(),bearing:this._map.getBearing()}),this._floorplanStates[this._indoorData.id].selectedBuilding=r?r.id:void 0;const m=this._indoorData.levels.filter(x=>r.levels.includes(x.id));this.fire(new i.z("buildingselected",{buildingId:r.id,levels:m}))}_levelSelected(r){if(r==="overview")this._updateLevels(void 0,!0);else{const l=this._indoorData.levels.find(m=>m.id===r);this._updateLevels(l,!0)}this.fire(new i.z("levelselected",{levelId:r==="overview"?void 0:r}))}_updateLevels(r,l){if(!r)return this._map.setConfigProperty(this._scope,"mbx-indoor-loaded-levels",["literal",[]]),this._map.setConfigProperty(this._scope,"mbx-indoor-underground",!1),this._floorplanStates[this._indoorData.id].selectedLevel=void 0,void(l&&this._indoorData.extent&&this._map.fitBounds(this._indoorData.extent,{pitch:this._map.getPitch(),bearing:this._map.getBearing()}));function m(U){const $=U.indexOf("/floor/");if($===-1)return U;const Z=$+7,W=U.indexOf("/",Z);return W===-1?U.slice(Z):U.slice(Z,W)}this._selectedLevel=r,this._floorplanStates[this._indoorData.id].selectedLevel=r?r.id:void 0;const x=[],b={},A={},R={},N={};for(const U of this._indoorData.levels)if(x.push(U.id),b[U.id]=U.height,A[U.id]=U.base,r){if(this.mergeFloors){const $=m(r.id),Z=m(U.id);R[U.id]=Z===$?"true":"false"}else R[U.id]=U.id===r.id?"true":"false";N[U.id]=U.base<r.base?"true":"false"}else N[U.id]=!0;if(this._map.setConfigProperty(this._scope,"mbx-indoor-loaded-levels",["literal",x]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-height",["literal",b]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-base",["literal",A]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-selected",["literal",R]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-overlapped",["literal",N]),r&&(this._map.setConfigProperty(this._scope,"mbx-indoor-underground",!!r.isUnderground),l&&r.extent)){const U=this._map.cameraForBounds(r.extent,{pitch:this._map.getPitch(),bearing:this._map.getBearing()}),$=this._map.getZoom(),Z=U.zoom?Math.abs($-U.zoom):0;this._map.fitBounds(r.extent,Z>=1?{pitch:this._map.getPitch(),bearing:this._map.getBearing()}:{pitch:this._map.getPitch(),bearing:this._map.getBearing(),zoom:$})}}selectFloorplan(r){const l={target:{featuresetId:this._queryFeatureSetId,importId:this._scope}},m=[new i.P(0,0),new i.P(this._map.transform.width,this._map.transform.height)],x=this._map.queryRenderedFeatures(m,l);if(x.length>0){for(const b of x)if(JSON.parse(b.properties["indoor-data"]).floorplanIDs.includes(r)){this._selectedFloorplan=b,this._floorplanSelected(!0);break}}}selectBuilding(r){const l=this._indoorData.buildings.find(m=>m.id===r);this._buildingSelected(l,!0)}selectLevel(r){this._levelSelected(r)}}function hm(p){if(!p.metadata||!p.metadata.content_area)return;const r=i.q.devicePixelRatio,{left:l,top:m,width:x,height:b}=p.metadata.content_area,A=l*r,R=m*r;return[A,R,A+x*r,R+b*r]}function sh(p){if(p)return p.map(([r,l])=>[r*i.q.devicePixelRatio,l*i.q.devicePixelRatio])}const Cl=(p,r)=>Ts(p,r&&r.filter(l=>l.identifier!=="source.canvas")),R0=i.ay(Kn,["addLayer","removeLayer","setLights","setPaintProperty","setLayoutProperty","setSlot","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setSnow","setRain","setProjection","setCamera","addImport","removeImport","updateImport"]),uc=i.ay(Kn,["setCenter","setZoom","setBearing","setPitch"]),hc=new Set(["background","sky","slot","custom"]),cu={version:8,layers:[],sources:{}},fm={duration:300,delay:0};class Ia extends i.E{constructor(r,l={}){super(),this.map=r,this.scope=l.scope||"",this.globalId=null,this.fragments=[],this.importDepth=l.importDepth||0,this.importsCache=l.importsCache||new Map,this.resolvedImports=l.resolvedImports||new Set,this.transition=i.l({},fm),this._buildingIndex=new ou(this),this.crossTileSymbolIndex=new Ud,this._mergedOrder=[],this._drapedFirstOrder=[],this._mergedLayers={},this._mergedSourceCaches={},this._mergedOtherSourceCaches={},this._mergedSymbolSourceCaches={},this._clipLayerPresent=!1,this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this._changes=l.styleChanges||new Dr,this.dispatcher=l.dispatcher?l.dispatcher:new i.D(i.ci(),this),l.imageManager?this.imageManager=l.imageManager:(this.imageManager=new Ir(this.map._spriteFormat),this.imageManager.setEventedParent(this)),this.imageManager.createScope(this.scope),this.glyphManager=l.glyphManager?l.glyphManager:new i.cj(r._requestManager,l.localFontFamily?i.ck.all:l.localIdeographFontFamily?i.ck.ideographs:i.ck.none,l.localFontFamily||l.localIdeographFontFamily),l.modelManager?this.modelManager=l.modelManager:(this.modelManager=new Hd(r._requestManager),this.modelManager.setEventedParent(this)),this._layers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._precompileDone=!1,this._shouldPrecompile=!1,this._availableImages=[],this._order=[],this._markersNeedUpdate=!1,this.options=l.configOptions?l.configOptions:new Map,this._configDependentLayers=l.configDependentLayers?l.configDependentLayers:new Set,this._config=l.config,this._styleColorTheme={lut:null,lutLoading:!1,lutLoadingCorrelationID:0,colorTheme:null,colorThemeOverride:l.colorThemeOverride},this._styleColorThemeForScope={},this._initialConfig=l.initialConfig,this.dispatcher.broadcast("setReferrer",i.cl());const m=this;this._rtlTextPluginCallback=Ia.registerForPluginStateChange(x=>{m.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:x.pluginStatus,pluginURL:x.pluginURL},(b,A)=>{if(i.cm(b),A&&A.every(R=>R))for(const R in m._sourceCaches){const N=m._sourceCaches[R],U=N.getSource().type;U!=="vector"&&U!=="geojson"||N.reload()}})}),this.on("data",x=>{if(x.dataType!=="source"||x.sourceDataType!=="metadata")return;const b=this.getOwnSource(x.sourceId);if(b&&b.vectorLayerIds)for(const A in this._layers){const R=this._layers[A];R.source===b.id&&this._validateLayer(R)}})}load(r){return r?(typeof r=="string"?this.loadURL(r):this.loadJSON(r),this):this}_getGlobalId(r){if(!r)return null;if(typeof r=="string"){if(i.f(r))return r;const l=i.cn(r);if(!l.startsWith("http"))try{return new URL(l,location.href).toString()}catch{return l}return l}return`json://${i.co(JSON.stringify(r))}`}_diffStyle(r,l,m){this.globalId=this._getGlobalId(r);const x=(b,A)=>{try{A(null,this.setState(b,m))}catch(R){A(R,!1)}};if(typeof r=="string"){const b=this.map._requestManager.normalizeStyleURL(r),A=this.map._requestManager.transformRequest(b,i.R.Style);i.n(A,(R,N)=>{R?this.fire(new i.y(R)):N&&x(N,l)})}else typeof r=="object"&&x(r,l)}loadURL(r,l={}){this.fire(new i.z("dataloading",{dataType:"style"}));const m=typeof l.validate=="boolean"?l.validate:!i.f(r);this.globalId=this._getGlobalId(r),r=this.map._requestManager.normalizeStyleURL(r,l.accessToken),this.resolvedImports.add(r);const x=this.importsCache.get(r);if(x)return this._load(x,m);const b=this.map._requestManager.transformRequest(r,i.R.Style);this._request=i.n(b,(A,R)=>{if(this._request=null,A)this.fire(new i.y(A));else if(R)return this.importsCache.set(r,R),this._load(R,m)})}loadJSON(r,l={}){this.fire(new i.z("dataloading",{dataType:"style"})),this.globalId=this._getGlobalId(r),this._request=i.q.frame(()=>{this._request=null,this._load(r,l.validate!==!1)})}loadEmpty(){this.fire(new i.z("dataloading",{dataType:"style"})),this._load(cu,!1)}_loadImports(r,l,m){if(this.importDepth>=4)return i.w("Style doesn't support nesting deeper than 5"),Promise.resolve();const x=[];for(const b of r){const A=this._createFragmentStyle(b),R=new Promise($=>{A.once("style.import.load",$),A.once("error",$)}).then(()=>this.mergeAll());if(x.push(R),this.resolvedImports.has(b.url)){A.loadEmpty();continue}const N=b.data||this.importsCache.get(b.url);N?(A.loadJSON(N,{validate:l}),this._isInternalStyle(N)&&(A.globalId=null)):b.url?A.loadURL(b.url,{validate:l}):A.loadEmpty();const U={style:A,id:b.id,config:b.config};if(m){const $=this.fragments.findIndex(({id:Z})=>Z===m);this.fragments=this.fragments.slice(0,$).concat(U).concat(this.fragments.slice($))}else this.fragments.push(U)}return Promise.allSettled(x)}getImportGlobalIds(r=this,l=new Set){for(const m of r.fragments)m.style.globalId&&l.add(m.style.globalId),this.getImportGlobalIds(m.style,l);return[...l.values()]}_createFragmentStyle(r){const l=this.scope?i.aC(r.id,this.scope):r.id;let m;const x=this._initialConfig&&this._initialConfig[l];(r.config||x)&&(m=i.l({},r.config,x));const b=new Ia(this.map,{scope:l,styleChanges:this._changes,importDepth:this.importDepth+1,importsCache:this.importsCache,resolvedImports:new Set(this.resolvedImports),dispatcher:this.dispatcher,imageManager:this.imageManager,glyphManager:this.glyphManager,modelManager:this.modelManager,config:m,configOptions:this.options,colorThemeOverride:r["color-theme"],configDependentLayers:this._configDependentLayers});return b.setEventedParent(this.map,{style:b}),b}_reloadImports(){this.mergeAll(),this._updateMapProjection(),this.updateConfigDependencies(),this.map._triggerCameraUpdate(this.camera),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),this._shouldPrecompile=this.map._precompilePrograms&&this.isRootStyle()}_isInternalStyle(r){return this.isRootStyle()&&(r.fragment||!!r.schema&&r.fragment!==!1)}_load(r,l){const m=r.indoor?um(r.schema):r.schema;if(this._isInternalStyle(r)){const A=i.l({},cu,{imports:[{id:"basemap",data:r,url:""}]});return void this._load(A,l)}if(this.updateConfig(this._config,m),l&&Cl(this,$a(r)))return;this._loaded=!0,this.stylesheet=i.cp(r);const x=()=>{for(const U in r.sources)this.addSource(U,r.sources[U],{validate:!1,isInitialLoad:!0});r.sprite?this._loadIconset(r.sprite):(this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0})),this.glyphManager.setURL(r.glyphs,this.scope);const A=df(this.stylesheet.layers);if(this._order=A.map(U=>U.id),this.stylesheet.light&&i.w("The `light` root property is deprecated, prefer using `lights` with `flat` light type instead."),this.stylesheet.lights)if(this.stylesheet.lights.length===1&&this.stylesheet.lights[0].type==="flat"){const U=this.stylesheet.lights[0];this.light=new le(U.properties,U.id)}else this.setLights(this.stylesheet.lights);this.light||(this.light=new le(this.stylesheet.light)),this._layers={};for(const U of A){const $=i.cu(U,this.scope,this._styleColorTheme.lut,this.options);$.configDependencies.size!==0&&this._configDependentLayers.add($.fqid),$.setEventedParent(this,{layer:{id:$.id}}),this._layers[$.id]=$;const Z=this.getOwnLayerSourceCache($),W=!!this.directionalLight&&this.directionalLight.shadowsEnabled();Z&&$.canCastShadows()&&W&&(Z.castsShadows=!0)}this.stylesheet.featuresets&&this.setFeaturesetSelectors(this.stylesheet.featuresets),this.stylesheet.models&&this.modelManager.addModels(this.stylesheet.models,this.scope);const R=this.stylesheet.terrain;R&&(this.checkCanvasFingerprintNoise(),this.disableElevatedTerrain||this.terrainSetForDrapingOnly()||this._createTerrain(R,1)),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this.stylesheet.snow&&this._createSnow(this.stylesheet.snow),this.stylesheet.rain&&this._createRain(this.stylesheet.rain),this.stylesheet.transition&&this.setTransition(this.stylesheet.transition),this.fire(new i.z("data",{dataType:"style"}));const N=this.isRootStyle();r.imports?this._loadImports(r.imports,l).then(()=>{this._reloadImports(),this.fire(new i.z(N?"style.load":"style.import.load"))}):(this._reloadImports(),this.fire(new i.z(N?"style.load":"style.import.load")))};this._styleColorTheme.colorTheme=this.stylesheet["color-theme"];const b=this._styleColorTheme.colorThemeOverride?this._styleColorTheme.colorThemeOverride:this._styleColorTheme.colorTheme;if(b){const A=this._evaluateColorThemeData(b);this._loadColorTheme(A).then(()=>{x()}).catch(R=>{i.w(`Couldn't load color theme from the stylesheet: ${R}`),x()})}else this._styleColorTheme.lut=null,x()}isRootStyle(){return this.importDepth===0}mergeAll(){let r,l,m,x,b,A,R,N,U,$;const Z={};this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(W=>{if(W.stylesheet){if(W.light!=null&&(r=W.light),W.stylesheet.lights)for(const ee of W.stylesheet.lights)ee.type==="ambient"&&W.ambientLight!=null&&(l=W.ambientLight),ee.type==="directional"&&W.directionalLight!=null&&(m=W.directionalLight);x=this._prioritizeTerrain(x,W.terrain,W.stylesheet.terrain),W.stylesheet.fog&&W.fog!=null&&(b=W.fog),W.stylesheet.snow&&W.snow!=null&&(A=W.snow),W.stylesheet.rain&&W.rain!=null&&(R=W.rain),W.stylesheet.camera!=null&&($=W.stylesheet.camera),W.stylesheet.projection!=null&&(N=W.stylesheet.projection),W.stylesheet.transition!=null&&(U=W.stylesheet.transition),Z[W.scope]=W._styleColorTheme}}),this.light=r,this.ambientLight=l,this.directionalLight=m,this.fog=b,this.snow=A,this.rain=R,this._styleColorThemeForScope=Z,x===null?delete this.terrain:this.terrain=x,this.camera=$||{"camera-projection":"perspective"},this.projection=N||{name:"mercator"},this.transition=i.l({},fm,U),this.mergeSources(),this.mergeLayers()}forEachFragmentStyle(r){const l=m=>{for(const x of m.fragments)l(x.style);r(m)};l(this)}_prioritizeTerrain(r,l,m){const x=r&&r.drapeRenderMode===0;return m===null?l&&l.drapeRenderMode===0?l:x?r:null:l!=null&&(!r||x||l&&l.drapeRenderMode===1)?l:r}mergeTerrain(){let r;this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(l=>{r=this._prioritizeTerrain(r,l.terrain,l.stylesheet.terrain)}),r===null?delete this.terrain:this.terrain=r}mergeProjection(){let r;this.forEachFragmentStyle(l=>{l.stylesheet.projection!=null&&(r=l.stylesheet.projection)}),this.projection=r||{name:"mercator"}}mergeSources(){const r={},l={},m={};this.forEachFragmentStyle(x=>{for(const b in x._sourceCaches){const A=i.aC(b,x.scope);r[A]=x._sourceCaches[b]}for(const b in x._otherSourceCaches){const A=i.aC(b,x.scope);l[A]=x._otherSourceCaches[b]}for(const b in x._symbolSourceCaches){const A=i.aC(b,x.scope);m[A]=x._symbolSourceCaches[b]}}),this._mergedSourceCaches=r,this._mergedOtherSourceCaches=l,this._mergedSymbolSourceCaches=m}mergeLayers(){const r={},l=[],m={};this._mergedSlots=[],this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this.forEachFragmentStyle(b=>{for(const A of b._order){const R=b._layers[A];if(R.type==="slot"){const N=i.cq(A);if(r[N])continue;r[N]=[]}R.slot&&r[R.slot]?r[R.slot].push(R):l.push(R)}}),this._mergedOrder=[];const x=(b=[])=>{for(const A of b)if(A.type==="slot"){const R=i.cq(A.id);r[R]&&x(r[R]),this._mergedSlots.push(R)}else{const R=i.aC(A.id,A.scope);this._mergedOrder.push(R),m[R]=A,A.is3D()&&(this._has3DLayers=!0),A.type==="circle"&&(this._hasCircleLayers=!0),A.type==="symbol"&&(this._hasSymbolLayers=!0),A.type==="clip"&&(this._clipLayerPresent=!0)}};x(l),this._mergedOrder.sort((b,A)=>{const R=m[b],N=m[A];return R.hasInitialOcclusionOpacityProperties?N.is3D()?1:0:R.is3D()&&N.hasInitialOcclusionOpacityProperties?-1:0}),this._mergedLayers=m,this.updateDrapeFirstLayers(),this._buildingIndex.processLayersChanged()}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}getCamera(){return this.stylesheet.camera}setCamera(r){return this.stylesheet.camera=i.l({},this.stylesheet.camera,r),this.camera=this.stylesheet.camera,this}_evaluateColorThemeData(r){return r.data?function(l,m,x){const b=i.l({},m);for(const R of Object.keys(i.a3.colorTheme))b[R]===void 0&&(b[R]=i.a3.colorTheme[R].default);const A=new i.a4(cm,l,new Map(x));return A.setTransitionOrValue(b,x),A.untransitioned().possiblyEvaluate(new i.a8(0))}(this.scope,r,this.options).get("data"):null}_loadColorTheme(r){this._styleColorTheme.lutLoading=!0,this._styleColorTheme.lutLoadingCorrelationID+=1;const l=this._styleColorTheme.lutLoadingCorrelationID;return new Promise((m,x)=>{const b="data:image/png;base64,";if(!r||r.length===0)return this._styleColorTheme.lut=null,this._styleColorTheme.lutLoading=!1,void m();let A=r;A.startsWith(b)||(A=b+A);const R="mapbox-reserved-lut",N=new Image;N.src=A,N.onerror=()=>{this._styleColorTheme.lutLoading=!1,x(new Error("Failed to load image data"))},N.onload=()=>{if(this._styleColorTheme.lutLoadingCorrelationID!==l)return void m();this._styleColorTheme.lutLoading=!1;const{width:U,height:$,data:Z}=i.q.getImageData(N);if($>32)return void x(new Error("The height of the image must be less than or equal to 32 pixels."));if(U!==$*$)return void x(new Error("The width of the image must be equal to the height squared."));this.getImage(R)&&this.removeImage(R),this.addImage(R,{data:new i.r({width:U,height:$},Z),pixelRatio:1,sdf:!1,usvg:!1,version:0});const W=this.imageManager.getImage(R,this.scope);W?(this._styleColorTheme.lut={image:W.data,data:r},m()):x(new Error("Missing LUT image."))}})}getLut(r){const l=this._styleColorThemeForScope[r];return l?l.lut:null}setProjection(r){r?this.stylesheet.projection=r:delete this.stylesheet.projection,this.mergeProjection(),this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?(this.getTerrain()||this.stylesheet.terrain)&&!this.disableElevatedTerrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null,0))}_updateMapProjection(){this.isRootStyle()&&(this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.projection))}_loadSprite(r){this._spriteRequest=function(l,m,x){let b,A,R;const N=i.q.devicePixelRatio>1?"@2x":"";let U=i.n(m.transformRequest(m.normalizeSpriteURL(l,N,".json"),i.R.SpriteJSON),(W,ee)=>{U=null,R||(R=W,b=ee,Z())}),$=i.o(m.transformRequest(m.normalizeSpriteURL(l,N,".png"),i.R.SpriteImage),(W,ee)=>{$=null,R||(R=W,A=ee,Z())});function Z(){if(R)x(R);else if(b&&A){const W=i.q.getImageData(A),ee={};for(const ue in b){const{width:oe,height:de,x:fe,y:Te,sdf:Pe,pixelRatio:Oe,stretchX:Fe,stretchY:Re,content:ke}=b[ue],De=new i.r({width:oe,height:de});i.r.copy(W,De,{x:fe,y:Te},{x:0,y:0},{width:oe,height:de},null),ee[ue]={data:De,pixelRatio:Oe,sdf:Pe,stretchX:Fe,stretchY:Re,content:ke,usvg:!1}}x(null,ee)}}return{cancel(){U&&(U.cancel(),U=null),$&&($.cancel(),$=null)}}}(r,this.map._requestManager,(l,m)=>{if(this._spriteRequest=null,l)this.fire(new i.y(l));else if(m)for(const x in m)this.imageManager.addImage(x,this.scope,m[x]);this.imageManager.setLoaded(!0,this.scope),this._availableImages=this.imageManager.listImages(this.scope),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new i.z("data",{dataType:"style"}))})}_loadIconset(r){if(!i.f(r)&&this.map._spriteFormat!=="icon_set"||this.map._spriteFormat==="raster")return void this._loadSprite(r);const l=this.map._spriteFormat==="auto";var m,x;this._spriteRequest=(x=(b,A)=>{if(this._spriteRequest=null,b)l?this._loadSprite(r):this.fire(new i.y(b));else if(A)for(const R in A)this.imageManager.addImage(R,this.scope,A[R]);this.imageManager.setLoaded(!0,this.scope),this._availableImages=this.imageManager.listImages(this.scope),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new i.z("data",{dataType:"style"}))},i.bi((m=this.map._requestManager).transformRequest(m.normalizeIconsetURL(r),i.R.Iconset),(b,A)=>{if(b)return void x(b);const R={},N=i.cg(new i.bh(A));for(const U of N.icons){const $={version:1,pixelRatio:i.q.devicePixelRatio,content:hm(U),stretchX:U.metadata?sh(U.metadata.stretch_x_areas):void 0,stretchY:U.metadata?sh(U.metadata.stretch_y_areas):void 0,sdf:!1,usvg:!0,icon:U};R[U.name]=$}x(null,R)}))}_validateLayer(r){const l=this.getOwnSource(r.source);if(!l)return;const m=r.sourceLayer;m&&(l.type==="geojson"||l.vectorLayerIds&&l.vectorLayerIds.indexOf(m)===-1)&&this.fire(new i.y(new Error(`Source layer "${m}" does not exist on source "${l.id}" as specified by style layer "${r.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._changes.getUpdatedSourceCaches()).length)return!1;for(const r in this._sourceCaches)if(!this._sourceCaches[r].loaded())return!1;if(!this.imageManager.isLoaded()||!this.modelManager.isLoaded()||this._styleColorTheme.lutLoading)return!1;for(const{style:r}of this.fragments)if(!r.loaded())return!1;return!0}_serializeImports(){if(this.stylesheet.imports)return this.stylesheet.imports.map((r,l)=>{const m=this.fragments[l];return m&&m.style&&(r.data=m.style.serialize()),r})}_serializeSources(){const r={};for(const l in this._sourceCaches){const m=this._sourceCaches[l].getSource();r[m.id]||(r[m.id]=m.serialize())}return r}_serializeLayers(r){const l=[];for(const m of r){const x=this._layers[m];x&&x.type!=="custom"&&l.push(x.serialize())}return l}hasLightTransitions(){return!(!this.light||!this.light.hasTransition())||!(!this.ambientLight||!this.ambientLight.hasTransition())||!(!this.directionalLight||!this.directionalLight.hasTransition())}hasFogTransition(){return!!this.fog&&this.fog.hasTransition()}hasSnowTransition(){return!!this.snow&&this.snow.hasTransition()}hasRainTransition(){return!!this.rain&&this.rain.hasTransition()}hasTransitions(){if(this.hasLightTransitions()||this.hasFogTransition()||this.hasSnowTransition()||this.hasRainTransition())return!0;for(const r in this._sourceCaches)if(this._sourceCaches[r].hasTransition())return!0;for(const r in this._layers)if(this._layers[r].hasTransition())return!0;return!1}get order(){return this.terrain?this._drapedFirstOrder:this._mergedOrder}_getOrder(r){return r?this.order:this._mergedOrder}isLayerDraped(r){return!!this.terrain&&r.isDraped(this.getLayerSourceCache(r))}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}_checkLayer(r){const l=this.getOwnLayer(r);if(l)return l;this.fire(new i.y(new Error(`The layer '${r}' does not exist in the map's style.`)))}_checkSource(r){const l=this.getOwnSource(r);if(l)return l;this.fire(new i.y(new Error(`The source '${r}' does not exist in the map's style.`)))}precompilePrograms(r,l){const m=this.map.painter;if(m)for(let x=r.minzoom||0;x<(r.maxzoom||25.5);x++){const b=r.getProgramIds();if(b)for(const A of b){const R=r.getDefaultProgramParams(A,l.zoom,this._styleColorTheme.lut);R&&(m.style=this,this.fog&&(m._fogVisible=!0,R.overrideFog=!0,m.getOrCreateProgram(A,R)),m._fogVisible=!1,R.overrideFog=!1,m.getOrCreateProgram(A,R),(this.stylesheet.terrain||this.stylesheet.projection&&this.stylesheet.projection.name==="globe")&&(R.overrideRtt=!0,m.getOrCreateProgram(A,R)))}}}update(r){if(!this._loaded)return;this.ambientLight&&this.ambientLight.recalculate(r),this.directionalLight&&this.directionalLight.recalculate(r);const l=this.calculateLightsBrightness();r.brightness=l||0,l!==this._brightness&&(this._brightness=l,this.dispatcher.broadcast("setBrightness",l));const m=this._changes.isDirty();let x=!1;if(this._changes.isDirty()){const A=this._changes.getLayerUpdatesByScope();for(const R in A){const{updatedIds:N,removedIds:U}=A[R];(N||U)&&(this._updateWorkerLayers(R,N,U),x=!0)}this.updateSourceCaches(),this._updateTilesForChangedImages(),this.updateLayers(r),this.light&&this.light.updateTransitions(r),this.ambientLight&&this.ambientLight.updateTransitions(r),this.directionalLight&&this.directionalLight.updateTransitions(r),this.fog&&this.fog.updateTransitions(r),this.snow&&this.snow.updateTransitions(r),this.rain&&this.rain.updateTransitions(r),this._changes.reset()}const b={};for(const A in this._mergedSourceCaches){const R=this._mergedSourceCaches[A];b[A]=R.used,R.used=!1,R.tileCoverLift=0}for(const A of this._mergedOrder){const R=this._mergedLayers[A];if(R.recalculate(r,this._availableImages),!R.isHidden(r.zoom)){const N=this.getLayerSourceCache(R);N&&(N.used=!0,N.tileCoverLift=Math.max(N.tileCoverLift,R.tileCoverLift()))}!this._precompileDone&&this._shouldPrecompile&&("requestIdleCallback"in window?requestIdleCallback(()=>{this.precompilePrograms(R,r)}):this.precompilePrograms(R,r))}this._shouldPrecompile&&(this._precompileDone=!0),this.terrain&&x&&this.mergeLayers();for(const A in b){const R=this._mergedSourceCaches[A];b[A]!==R.used&&R.getSource().fire(new i.z("data",{sourceDataType:"visibility",dataType:"source",sourceId:R.getSource().id}))}this.light&&this.light.recalculate(r),this.terrain&&this.terrain.recalculate(r),this.fog&&this.fog.recalculate(r),this.snow&&this.snow.recalculate(r),this.rain&&this.rain.recalculate(r),this.z=r.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),m&&this.fire(new i.z("data",{dataType:"style"}))}_updateTilesForChangedImages(){const r=this._changes.getUpdatedImages();if(r.length){for(const l in this._sourceCaches)this._sourceCaches[l].reloadTilesForDependencies(["icons","patterns"],r);this._changes.resetUpdatedImages()}}_updateWorkerLayers(r,l,m){const x=this.getFragmentStyle(r);x&&this.dispatcher.broadcast("updateLayers",{layers:l?x._serializeLayers(l):[],scope:r,removedIds:m||[],options:x.options})}setState(r,l){if(this._checkLoaded(),Cl(this,$a(r)))return!1;(r=i.cp(r)).layers=df(r.layers);const m=function(A,R){if(!A)return[{command:Kn.setStyle,args:[R]}];let N=[];try{if(!i.bn(A.version,R.version))return[{command:Kn.setStyle,args:[R]}];if(i.bn(A.center,R.center)||N.push({command:Kn.setCenter,args:[R.center]}),i.bn(A.zoom,R.zoom)||N.push({command:Kn.setZoom,args:[R.zoom]}),i.bn(A.bearing,R.bearing)||N.push({command:Kn.setBearing,args:[R.bearing]}),i.bn(A.pitch,R.pitch)||N.push({command:Kn.setPitch,args:[R.pitch]}),i.bn(A.sprite,R.sprite)||N.push({command:Kn.setSprite,args:[R.sprite]}),i.bn(A.glyphs,R.glyphs)||N.push({command:Kn.setGlyphs,args:[R.glyphs]}),i.bn(A.imports,R.imports)||function(ee=[],ue=[],oe){ue=ue||[];const de=(ee=ee||[]).map(pa),fe=ue.map(pa),Te=ee.reduce(is,{}),Pe=ue.reduce(is,{}),Oe=de.slice();let Fe,Re,ke,De;for(Fe=0,Re=0;Fe<de.length;Fe++)ke=de[Fe],Pe.hasOwnProperty(ke)?Re++:(oe.push({command:Kn.removeImport,args:[ke]}),Oe.splice(Oe.indexOf(ke,Re),1));for(Fe=0,Re=0;Fe<fe.length;Fe++)ke=fe[fe.length-1-Fe],Oe[Oe.length-1-Fe]!==ke&&(Te.hasOwnProperty(ke)?(oe.push({command:Kn.removeImport,args:[ke]}),Oe.splice(Oe.lastIndexOf(ke,Oe.length-Re),1)):Re++,De=Oe[Oe.length-Fe],oe.push({command:Kn.addImport,args:[Pe[ke],De]}),Oe.splice(Oe.length-Fe,0,ke));for(const $e of ue){const Xe=Te[$e.id];Xe&&!i.bn(Xe,$e)&&oe.push({command:Kn.updateImport,args:[$e.id,$e]})}}(A.imports,R.imports,N),i.bn(A.transition,R.transition)||N.push({command:Kn.setTransition,args:[R.transition]}),i.bn(A.light,R.light)||N.push({command:Kn.setLight,args:[R.light]}),i.bn(A.fog,R.fog)||N.push({command:Kn.setFog,args:[R.fog]}),i.bn(A.snow,R.snow)||N.push({command:Kn.setSnow,args:[R.snow]}),i.bn(A.rain,R.rain)||N.push({command:Kn.setRain,args:[R.rain]}),i.bn(A.projection,R.projection)||N.push({command:Kn.setProjection,args:[R.projection]}),i.bn(A.lights,R.lights)||N.push({command:Kn.setLights,args:[R.lights]}),i.bn(A.camera,R.camera)||N.push({command:Kn.setCamera,args:[R.camera]}),!i.bn(A["color-theme"],R["color-theme"]))return[{command:Kn.setStyle,args:[R]}];const U={},$=[];(function(ee,ue,oe,de){let fe;for(fe in ue=ue||{},ee=ee||{})ee.hasOwnProperty(fe)&&(ue.hasOwnProperty(fe)||Cs(fe,oe,de));for(fe in ue){if(!ue.hasOwnProperty(fe))continue;const Te=ue[fe];ee.hasOwnProperty(fe)?i.bn(ee[fe],Te)||(ee[fe].type==="geojson"&&Te.type==="geojson"&&xr(ee,ue,fe)?oe.push({command:Kn.setGeoJSONSourceData,args:[fe,Te.data]}):_n(fe,ue,oe,de)):pf(fe,ue,oe)}})(A.sources,R.sources,$,U);const Z=[];A.layers&&A.layers.forEach(ee=>{ee.source&&U[ee.source]?N.push({command:Kn.removeLayer,args:[ee.id]}):Z.push(ee)});let W=A.terrain;W&&U[W.source]&&(N.push({command:Kn.setTerrain,args:[void 0]}),W=void 0),N=N.concat($),i.bn(W,R.terrain)||N.push({command:Kn.setTerrain,args:[R.terrain]}),function(ee,ue,oe){ue=ue||[];const de=(ee=ee||[]).map(pa),fe=ue.map(pa),Te=ee.reduce(is,{}),Pe=ue.reduce(is,{}),Oe=de.slice(),Fe=Object.create(null);let Re,ke,De,$e,Xe,ft,ot;for(Re=0,ke=0;Re<de.length;Re++)De=de[Re],Pe.hasOwnProperty(De)?ke++:(oe.push({command:Kn.removeLayer,args:[De]}),Oe.splice(Oe.indexOf(De,ke),1));for(Re=0,ke=0;Re<fe.length;Re++)De=fe[fe.length-1-Re],Oe[Oe.length-1-Re]!==De&&(Te.hasOwnProperty(De)?(oe.push({command:Kn.removeLayer,args:[De]}),Oe.splice(Oe.lastIndexOf(De,Oe.length-ke),1)):ke++,ft=Oe[Oe.length-Re],oe.push({command:Kn.addLayer,args:[Pe[De],ft]}),Oe.splice(Oe.length-Re,0,De),Fe[De]=!0);for(Re=0;Re<fe.length;Re++)if(De=fe[Re],$e=Te[De],Xe=Pe[De],!Fe[De]&&!i.bn($e,Xe))if(i.bn($e.source,Xe.source)&&i.bn($e["source-layer"],Xe["source-layer"])&&i.bn($e.type,Xe.type)){for(ot in ar($e.layout,Xe.layout,oe,De,null,Kn.setLayoutProperty),ar($e.paint,Xe.paint,oe,De,null,Kn.setPaintProperty),i.bn($e.slot,Xe.slot)||oe.push({command:Kn.setSlot,args:[De,Xe.slot]}),i.bn($e.filter,Xe.filter)||oe.push({command:Kn.setFilter,args:[De,Xe.filter]}),i.bn($e.minzoom,Xe.minzoom)&&i.bn($e.maxzoom,Xe.maxzoom)||oe.push({command:Kn.setLayerZoomRange,args:[De,Xe.minzoom,Xe.maxzoom]}),$e)$e.hasOwnProperty(ot)&&ot!=="layout"&&ot!=="paint"&&ot!=="filter"&&ot!=="metadata"&&ot!=="minzoom"&&ot!=="maxzoom"&&ot!=="slot"&&(ot.indexOf("paint.")===0?ar($e[ot],Xe[ot],oe,De,ot.slice(6),Kn.setPaintProperty):i.bn($e[ot],Xe[ot])||oe.push({command:Kn.setLayerProperty,args:[De,ot,Xe[ot]]}));for(ot in Xe)Xe.hasOwnProperty(ot)&&!$e.hasOwnProperty(ot)&&ot!=="layout"&&ot!=="paint"&&ot!=="filter"&&ot!=="metadata"&&ot!=="minzoom"&&ot!=="maxzoom"&&ot!=="slot"&&(ot.indexOf("paint.")===0?ar($e[ot],Xe[ot],oe,De,ot.slice(6),Kn.setPaintProperty):i.bn($e[ot],Xe[ot])||oe.push({command:Kn.setLayerProperty,args:[De,ot,Xe[ot]]}))}else oe.push({command:Kn.removeLayer,args:[De]}),ft=Oe[Oe.lastIndexOf(De)+1],oe.push({command:Kn.addLayer,args:[Xe,ft]})}(Z,R.layers,N)}catch(U){console.warn("Unable to compute style diff:",U),N=[{command:Kn.setStyle,args:[R]}]}return N}(this.serialize(),r).filter(A=>!(A.command in uc));if(m.length===0)return!1;const x=m.filter(A=>!(A.command in R0));if(x.length>0)throw new Error(`Unimplemented: ${x.map(A=>A.command).join(", ")}.`);const b=[];return m.forEach(A=>{b.push(this[A.command].apply(this,A.args))}),l&&Promise.all(b).then(l),this.stylesheet=r,this.mergeAll(),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),!0}addImage(r,l){return this.getImage(r)?this.fire(new i.y(new Error("An image with this name already exists."))):(this.imageManager.addImage(r,this.scope,l),this._afterImageUpdated(r),this)}updateImage(r,l,m=!1){this.imageManager.updateImage(r,this.scope,l),m&&this._afterImageUpdated(r)}getImage(r){return this.imageManager.getImage(r,this.scope)}removeImage(r){return this.getImage(r)?(this.imageManager.removeImage(r,this.scope),this._afterImageUpdated(r),this):this.fire(new i.y(new Error("No image with this name exists.")))}_afterImageUpdated(r){this._availableImages=this.imageManager.listImages(this.scope),this._changes.updateImage(r),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.fire(new i.z("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addModel(r,l,m={}){return this._checkLoaded(),this._validate(eh,`models.${r}`,l,null,m)||(this.modelManager.addModel(r,l,this.scope),this._changes.setDirty()),this}hasModel(r){return this.modelManager.hasModel(r,this.scope)}removeModel(r){return this.hasModel(r)?(this.modelManager.removeModel(r,this.scope),this):this.fire(new i.y(new Error("No model with this ID exists.")))}listModels(){return this._checkLoaded(),this.modelManager.listModels(this.scope)}addSource(r,l,m={}){if(this._checkLoaded(),this.getOwnSource(r)!==void 0)throw new Error(`There is already a source with ID "${r}".`);if(!l.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(l).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(l.type)>=0&&this._validate(Qo,`sources.${r}`,l,null,m))return;this.map&&this.map._collectResourceTiming&&(l.collectResourceTiming=!0);const x=di(r,l,this.dispatcher,this);x.scope=this.scope,x.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(x.id),source:x.serialize(),sourceId:x.id}));const b=A=>{const R=(A?"symbol:":"other:")+x.id,N=i.aC(R,this.scope),U=this._sourceCaches[R]=new rs(N,x,A);(A?this._symbolSourceCaches:this._otherSourceCaches)[x.id]=U,U.onAdd(this.map)};b(!1),l.type!=="vector"&&l.type!=="geojson"||b(!0),x.onAdd&&x.onAdd(this.map),m.isInitialLoad||(this.mergeSources(),this._changes.setDirty())}removeSource(r){this._checkLoaded();const l=this.getOwnSource(r);if(!l)throw new Error("There is no source with this ID");for(const x in this._layers)if(this._layers[x].source===r)return this.fire(new i.y(new Error(`Source "${r}" cannot be removed while layer "${x}" is using it.`)));if(this.terrain&&this.terrain.scope===this.scope&&this.terrain.get().source===r)return this.fire(new i.y(new Error(`Source "${r}" cannot be removed while terrain is using it.`)));const m=this.getOwnSourceCaches(r);for(const x of m){const b=i.cq(x.id);delete this._sourceCaches[b],this._changes.discardSourceCacheUpdate(x.id),x.fire(new i.z("data",{sourceDataType:"metadata",dataType:"source",sourceId:x.getSource().id})),x.setEventedParent(null),x.clearTiles()}return delete this._otherSourceCaches[r],delete this._symbolSourceCaches[r],this.mergeSources(),l.setEventedParent(null),l.onRemove&&l.onRemove(this.map),this._changes.setDirty(),this}setGeoJSONSourceData(r,l){this._checkLoaded(),this.getOwnSource(r).setData(l),this._changes.setDirty()}getOwnSource(r){const l=this.getOwnSourceCache(r);return l&&l.getSource()}getOwnSources(){const r=[];for(const l in this._otherSourceCaches){const m=this.getOwnSourceCache(l);m&&r.push(m.getSource())}return r}areTilesLoaded(){const r=this._mergedSourceCaches;for(const l in r){const m=r[l]._tiles;for(const x in m){const b=m[x];if(b.state!=="loaded"&&b.state!=="errored")return!1}}return!0}setLights(r){if(this._checkLoaded(),!r)return delete this.ambientLight,void delete this.directionalLight;const l=this._getTransitionParameters();for(const x of r){if(this._validate(gl,"lights",x))return;switch(x.type){case"ambient":if(this.ambientLight){const b=this.ambientLight;b.set(x),b.updateTransitions(l)}else this.ambientLight=new On(x,Zt||(Zt=new i.a5({color:new i.a6(i.a3.properties_light_ambient.color),"color-use-theme":new i.a6({type:"string",default:"default","property-type":"data-constant"}),intensity:new i.a6(i.a3.properties_light_ambient.intensity)})),this.scope,this.options);break;case"directional":if(this.directionalLight){const b=this.directionalLight;b.set(x),b.updateTransitions(l)}else this.directionalLight=new On(x,Xt||(Xt=new i.a5({direction:new i.ak(i.a3.properties_light_directional.direction),color:new i.a6(i.a3.properties_light_directional.color),"color-use-theme":new i.a6({type:"string",default:"default","property-type":"data-constant"}),intensity:new i.a6(i.a3.properties_light_directional.intensity),"cast-shadows":new i.a6(i.a3.properties_light_directional["cast-shadows"]),"shadow-quality":new i.a6(i.a3.properties_light_directional["shadow-quality"]),"shadow-intensity":new i.a6(i.a3.properties_light_directional["shadow-intensity"])})),this.scope,this.options)}}const m=new i.a8(this.z||0,l);this.ambientLight&&this.ambientLight.recalculate(m),this.directionalLight&&this.directionalLight.recalculate(m),this._brightness=this.calculateLightsBrightness(),this.dispatcher.broadcast("setBrightness",this._brightness)}calculateLightsBrightness(){const r=this.directionalLight,l=this.ambientLight;if(!r||!l)return;const m=W=>.2126*(W[0]<=.03928?W[0]/12.92:Math.pow((W[0]+.055)/1.055,2.4))+.7152*(W[1]<=.03928?W[1]/12.92:Math.pow((W[1]+.055)/1.055,2.4))+.0722*(W[2]<=.03928?W[2]/12.92:Math.pow((W[2]+.055)/1.055,2.4)),x=r.properties.get("color").toRenderColor(null).toArray01(),b=r.properties.get("intensity"),A=r.properties.get("direction"),R=1-i.cb(A.x,A.y,A.z)[2]/90,N=m(x)*b*R,U=l.properties.get("color").toRenderColor(null).toArray01(),$=l.properties.get("intensity"),Z=m(U)*$;return Number(((N+Z)/2).toFixed(6))}getBrightness(){return this._brightness}getLights(){if(!this.enable3dLights())return null;const r=[];return this.directionalLight&&r.push(this.directionalLight.get()),this.ambientLight&&r.push(this.ambientLight.get()),r}enable3dLights(){return!!this.ambientLight&&!!this.directionalLight}getFragmentStyle(r){if(!r)return this;if(i.cr(r)){const l=i.cs(r),m=this.fragments.find(({id:b})=>b===l);if(!m)throw new Error(`Style import '${r}' not found`);const x=i.cq(r);return m.style.getFragmentStyle(x)}{const l=this.fragments.find(({id:m})=>m===r);return l?l.style:void 0}}setFeaturesetSelectors(r){if(!r)return;const l={},m=(x,b="")=>`${x}::${b}`;this._featuresetSelectors={};for(const x in r){const b=this._featuresetSelectors[x]=[];for(const A of r[x].selectors){if(A.featureNamespace){const N=this.getOwnLayer(A.layer);if(!N){i.w(`Layer is undefined for selector: ${A.layer}`);continue}const U=m(N.source,N.sourceLayer);if(U in l&&l[U]!==A.featureNamespace){i.w(`"featureNamespace ${A.featureNamespace} of featureset ${x}'s selector is not associated to the same source, skip this selector`);continue}l[U]=A.featureNamespace}let R;if(A.properties)for(const N in A.properties){const U=i.U(A.properties[N]);U.result==="success"&&(R=R||{},R[N]=U.value)}b.push({layerId:A.layer,namespace:A.featureNamespace,properties:R,uniqueFeatureID:A._uniqueFeatureID})}}}getFeaturesetDescriptors(r){const l=this.getFragmentStyle(r);if(!l||!l.stylesheet.featuresets)return[];const m=[];for(const x in l.stylesheet.featuresets)m.push({featuresetId:x,importId:l.scope?l.scope:void 0});return m}getFeaturesetLayers(r,l){const m=this.getFragmentStyle(l),x=m.stylesheet.featuresets;if(!x||!x[r])return this.fire(new i.y(new Error(`The featureset '${r}' does not exist in the map's style and cannot be queried.`))),[];const b=[];for(const A of x[r].selectors){const R=m.getOwnLayer(A.layer);R&&b.push(R)}return b}getConfigProperty(r,l){const m=this.getFragmentStyle(r);if(!m)return null;const x=i.aC(l,m.scope),b=m.options.get(x),A=b?b.value||b.default:null;return A?A.serialize():null}setConfigProperty(r,l,m){const x=this.getFragmentStyle(r);if(!x)return;const b=x.stylesheet.indoor?um(x.stylesheet.schema):x.stylesheet.schema;if(!b||!b[l])return;const A=i.U(m);if(A.result!=="success")return void Cl(this,A.value);const R=A.value.expression,N=i.aC(l,x.scope),U=x.options.get(N);if(!U)return;let $;const{minValue:Z,maxValue:W,stepValue:ee,type:ue,values:oe}=b[l],de=i.U(b[l].default);de.result==="success"&&($=de.value.expression),$?(this.options.set(N,Object.assign({},U,{value:R,default:$,minValue:Z,maxValue:W,stepValue:ee,type:ue,values:oe})),this.updateConfigDependencies(l)):this.fire(new i.y(new Error(`No schema defined for the config option "${l}" in the "${r}" fragment.`)))}getConfig(r){const l=this.getFragmentStyle(r);if(!l)return null;const m=l.stylesheet.schema;if(!m)return null;const x={};for(const b in m){const A=i.aC(b,l.scope),R=l.options.get(A),N=R?R.value||R.default:null;x[b]=N?N.serialize():null}return x}setConfig(r,l){const m=this.getFragmentStyle(r);m&&(m.updateConfig(l,m.stylesheet.schema),this.updateConfigDependencies())}getSchema(r){const l=this.getFragmentStyle(r);return l?l.stylesheet.schema:null}setSchema(r,l){const m=this.getFragmentStyle(r);m&&(m.stylesheet.schema=l,m.updateConfig(m._config,l),this.updateConfigDependencies())}updateConfig(r,l){if(this._config=r,r||l)if(l)for(const m in l){let x,b;const A=i.U(l[m].default);if(A.result==="success"&&(x=A.value.expression),r&&r[m]!==void 0){const W=i.U(r[m]);W.result==="success"&&(b=W.value.expression)}const{minValue:R,maxValue:N,stepValue:U,type:$,values:Z}=l[m];if(x){const W=i.aC(m,this.scope);this.options.set(W,{default:x,value:b,minValue:R,maxValue:N,stepValue:U,type:$,values:Z})}else this.fire(new i.y(new Error(`No schema defined for config option "${m}".`)))}else this.fire(new i.y(new Error("Attempting to set config for a style without schema.")))}updateConfigDependencies(r){for(const l of this._configDependentLayers){const m=this.getLayer(l);if(m){if(r&&!m.configDependencies.has(r))continue;m.possiblyEvaluateVisibility(),this._updateLayer(m)}}this.ambientLight&&this.ambientLight.updateConfig(this.options),this.directionalLight&&this.directionalLight.updateConfig(this.options),this.fog&&this.fog.updateConfig(this.options),this.snow&&this.snow.updateConfig(this.options),this.rain&&this.rain.updateConfig(this.options),this.forEachFragmentStyle(l=>{const m=l._styleColorTheme.colorThemeOverride?l._styleColorTheme.colorThemeOverride:l._styleColorTheme.colorTheme;if(m){const x=l._evaluateColorThemeData(m);(!l._styleColorTheme.lut&&x!==""||l._styleColorTheme.lut&&x!==l._styleColorTheme.lut.data)&&l.setColorTheme(m)}}),this._changes.setDirty()}addLayer(r,l,m={}){this._checkLoaded();const x=r.id;if(this._layers[x])return void this.fire(new i.y(new Error(`Layer with id "${x}" already exists on this map`)));let b;if(r.type==="custom"){if(Cl(this,i.ct(r)))return;b=i.cu(r,this.scope,this._styleColorTheme.lut,this.options)}else{if(typeof r.source=="object"&&(this.addSource(x,r.source),r=i.cp(r),r=i.l(r,{source:x})),this._validate(Qu,`layers.${x}`,r,{arrayIndex:-1},m))return;b=i.cu(r,this.scope,this._styleColorTheme.lut,this.options),this._validateLayer(b),b.setEventedParent(this,{layer:{id:x}})}b.configDependencies.size!==0&&this._configDependentLayers.add(b.fqid);let A=this._order.length;if(l){const $=this._order.indexOf(l);if($===-1)return void this.fire(new i.y(new Error(`Layer with id "${l}" does not exist on this map.`)));b.slot===this._layers[l].slot?A=$:i.w(`Layer with id "${l}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(A,0,x),this._layerOrderChanged=!0,this._layers[x]=b;const R=this.getOwnLayerSourceCache(b),N=!!this.directionalLight&&this.directionalLight.shadowsEnabled();R&&b.canCastShadows()&&N&&(R.castsShadows=!0);const U=this._changes.getRemovedLayer(b);if(U&&b.source&&R&&b.type!=="custom"){this._changes.discardLayerRemoval(b);const $=i.aC(b.source,b.scope);U.type!==b.type?this._changes.updateSourceCache($,"clear"):(this._changes.updateSourceCache($,"reload"),R.pause())}this._updateLayer(b),b.onAdd&&b.onAdd(this.map),b.scope=this.scope,this.mergeLayers()}moveLayer(r,l){this._checkLoaded();const m=this._checkLayer(r);if(!m||r===l)return;const x=this._order.indexOf(r);this._order.splice(x,1);let b=this._order.length;if(l){const A=this._order.indexOf(l);if(A===-1)return void this.fire(new i.y(new Error(`Layer with id "${l}" does not exist on this map.`)));m.slot===this._layers[l].slot?b=A:i.w(`Layer with id "${l}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(b,0,r),this._changes.setDirty(),this._layerOrderChanged=!0,this.mergeLayers()}removeLayer(r){this._checkLoaded();const l=this._checkLayer(r);if(!l)return;l.setEventedParent(null);const m=this._order.indexOf(r);this._order.splice(m,1),delete this._layers[r],this._changes.setDirty(),this._layerOrderChanged=!0,this._configDependentLayers.delete(l.fqid),this._changes.removeLayer(l);const x=this.getOwnLayerSourceCache(l);if(x&&x.castsShadows){let b=!1;for(const A in this._layers)if(this._layers[A].source===l.source&&this._layers[A].canCastShadows()){b=!0;break}x.castsShadows=b}l.onRemove&&l.onRemove(this.map),this.mergeLayers()}getOwnLayer(r){return this._layers[r]}hasLayer(r){return r in this._mergedLayers}hasLayerType(r){for(const l in this._layers)if(this._layers[l].type===r)return!0;return!1}setLayerZoomRange(r,l,m){this._checkLoaded();const x=this._checkLayer(r);x&&(x.minzoom===l&&x.maxzoom===m||(l!=null&&(x.minzoom=l),m!=null&&(x.maxzoom=m),this._updateLayer(x)))}getSlots(){return this._checkLoaded(),this._mergedSlots}setSlot(r,l){this._checkLoaded();const m=this._checkLayer(r);m&&m.slot!==l&&(m.slot=l,this._updateLayer(m))}setFilter(r,l,m={}){this._checkLoaded();const x=this._checkLayer(r);if(x&&!i.bn(x.filter,l))return l==null?(x.filter=void 0,void this._updateLayer(x)):void(this._validate(vi,`layers.${x.id}.filter`,l,{layerType:x.type},m)||(x.filter=i.cp(l),this._updateLayer(x)))}getFilter(r){const l=this._checkLayer(r);if(l)return i.cp(l.filter)}setLayoutProperty(r,l,m,x={}){this._checkLoaded();const b=this._checkLayer(r);if(b&&!i.bn(b.getLayoutProperty(l),m)){if(m!=null&&(!x||x.validate!==!1)&&Cl(b,uf.call($a,{key:`layers.${r}.layout.${l}`,layerType:b.type,objectKey:l,value:m,styleSpec:i.a3,style:{glyphs:!0,sprite:!0}})))return;b.setLayoutProperty(l,m),b.configDependencies.size!==0&&this._configDependentLayers.add(b.fqid),this._updateLayer(b)}}getLayoutProperty(r,l){const m=this._checkLayer(r);if(m)return m.getLayoutProperty(l)}setPaintProperty(r,l,m,x={}){this._checkLoaded();const b=this._checkLayer(r);if(!b||i.bn(b.getPaintProperty(l),m)||m!=null&&(!x||x.validate!==!1)&&Cl(b,cf.call($a,{key:`layers.${r}.paint.${l}`,layerType:b.type,objectKey:l,value:m,styleSpec:i.a3})))return;const A=b.setPaintProperty(l,m);b.configDependencies.size!==0&&this._configDependentLayers.add(b.fqid),A&&this._updateLayer(b),this._changes.updatePaintProperties(b)}getPaintProperty(r,l){const m=this._checkLayer(r);if(m)return m.getPaintProperty(l)}setFeatureState(r,l){if(this._checkLoaded(),"target"in r){if("featuresetId"in r.target){const{featuresetId:N,importId:U}=r.target,$=this.getFragmentStyle(U),Z=$.getFeaturesetLayers(N);for(const{source:W,sourceLayer:ee}of Z)$.setFeatureState({id:r.id,source:W,sourceLayer:ee},l)}else if("layerId"in r.target){const{layerId:N}=r.target,U=this.getLayer(N);this.setFeatureState({id:r.id,source:U.source,sourceLayer:U.sourceLayer},l)}return}const m=r.source,x=r.sourceLayer,b=this._checkSource(m);if(!b)return;const A=b.type;if(A==="geojson"&&x)return void this.fire(new i.y(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(A==="vector"&&!x)return void this.fire(new i.y(new Error("The sourceLayer parameter must be provided for vector source types.")));r.id===void 0&&this.fire(new i.y(new Error("The feature id parameter must be provided.")));const R=this.getOwnSourceCaches(m);for(const N of R)N.setFeatureState(x,r.id,l)}removeFeatureState(r,l){if(this._checkLoaded(),"target"in r){if("featuresetId"in r.target){const{featuresetId:N,importId:U}=r.target,$=this.getFragmentStyle(U),Z=$.getFeaturesetLayers(N);for(const{source:W,sourceLayer:ee}of Z)$.removeFeatureState({id:r.id,source:W,sourceLayer:ee},l)}else if("layerId"in r.target){const{layerId:N}=r.target,U=this.getLayer(N);this.removeFeatureState({id:r.id,source:U.source,sourceLayer:U.sourceLayer},l)}return}const m=r.source,x=this._checkSource(m);if(!x)return;const b=x.type,A=b==="vector"?r.sourceLayer:void 0;if(b==="vector"&&!A)return void this.fire(new i.y(new Error("The sourceLayer parameter must be provided for vector source types.")));if(l&&typeof r.id!="string"&&typeof r.id!="number")return void this.fire(new i.y(new Error("A feature id is required to remove its specific state property.")));const R=this.getOwnSourceCaches(m);for(const N of R)N.removeFeatureState(A,r.id,l)}getFeatureState(r){if(this._checkLoaded(),"target"in r){let b;if("featuresetId"in r.target){const{featuresetId:A,importId:R}=r.target,N=this.getFragmentStyle(R),U=N.getFeaturesetLayers(A);for(const{source:$,sourceLayer:Z}of U){const W=N.getFeatureState({id:r.id,source:$,sourceLayer:Z});if(W&&!b)b=W;else if(!i.bn(b,W))return void this.fire(new i.y(new Error("The same feature id exists in multiple sources in the featureset, but their feature states are not consistent through the sources.")))}}else if("layerId"in r.target){const{layerId:A}=r.target,R=this.getLayer(A);b=this.getFeatureState({id:r.id,source:R.source,sourceLayer:R.sourceLayer})}return b}const l=r.source,m=r.sourceLayer,x=this._checkSource(l);if(x){if(x.type!=="vector"||m)return r.id===void 0&&this.fire(new i.y(new Error("The feature id parameter must be provided."))),this.getOwnSourceCaches(l)[0].getFeatureState(m,r.id);this.fire(new i.y(new Error("The sourceLayer parameter must be provided for vector source types.")))}}setTransition(r){return this.stylesheet.transition=i.l({},this.stylesheet.transition,r),this.transition=this.stylesheet.transition,this}getTransition(){return i.l({},this.stylesheet.transition)}serialize(){this._checkLoaded();const r=this.getTerrain(),l=r&&this.terrain&&this.terrain.scope===this.scope?r:this.stylesheet.terrain;return i.cv({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,fragment:this.stylesheet.fragment,imports:this._serializeImports(),schema:this.stylesheet.schema,camera:this.stylesheet.camera,light:this.stylesheet.light,lights:this.stylesheet.lights,terrain:l,fog:this.stylesheet.fog,snow:this.stylesheet.snow,rain:this.stylesheet.rain,center:this.stylesheet.center,"color-theme":this.stylesheet["color-theme"],zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:this._serializeSources(),layers:this._serializeLayers(this._order)},m=>m!==void 0)}_updateFilteredLayers(r){for(const l of Object.values(this._mergedLayers))r(l)&&this._updateLayer(l)}_updateLayer(r){this._changes.updateLayer(r);const l=this.getLayerSourceCache(r),m=i.aC(r.source,r.scope),x=this._changes.getUpdatedSourceCaches();r.source&&!x[m]&&l&&l.getSource().type!=="raster"&&(this._changes.updateSourceCache(m,"reload"),l.pause()),r.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(r){const l=R=>this._mergedLayers[R].is3D(),m=this.order,x={},b=[];for(let R=m.length-1;R>=0;R--){const N=m[R];if(l(N)){x[N]=R;for(const U of r){const $=U[N];if($)for(const Z of $)b.push(Z)}}}b.sort((R,N)=>N.intersectionZ-R.intersectionZ);const A=[];for(let R=m.length-1;R>=0;R--){const N=m[R];if(l(N))for(let U=b.length-1;U>=0;U--){const $=b[U].feature;if($.layer&&x[$.layer.id]<R)break;A.push($),b.pop()}else for(const U of r){const $=U[N];if($)for(const Z of $)A.push(Z.feature)}}return A}queryRenderedFeatures(r,l,m){let x;l&&!Array.isArray(l)&&l.filter&&(this._validate(vi,"queryRenderedFeatures.filter",l.filter,null,l),x=i.aZ(l.filter));const b={},A=$=>{if(hc.has($.type))return;const Z=this.getOwnLayerSourceCache($),W=b[Z.id]=b[Z.id]||{sourceCache:Z,layers:{},has3DLayers:!1};$.is3D()&&(W.has3DLayers=!0),W.layers[$.fqid]=W.layers[$.fqid]||{styleLayer:$,targets:[]},W.layers[$.fqid].targets.push({filter:x})};if(l&&l.layers){if(!Array.isArray(l.layers))return this.fire(new i.y(new Error("parameters.layers must be an Array."))),[];for(const $ of l.layers){const Z=this._layers[$];if(!Z)return this.fire(new i.y(new Error(`The layer '${$}' does not exist in the map's style and cannot be queried for features.`))),[];A(Z)}}else for(const $ in this._layers)A(this._layers[$]);const R=this._queryRenderedFeatures(r,b,m),N=this._flattenAndSortRenderedFeatures(R),U=[];for(const $ of N)i.cs($.layer.id)===this.scope&&U.push($);return U}queryRenderedFeatureset(r,l,m){let x;l&&!Array.isArray(l)&&l.filter&&(this._validate(vi,"queryRenderedFeatures.filter",l.filter,null,l),x=i.aZ(l.filter));const b="mock",A=[];if(l&&l.target)A.push(Object.assign({},l,{targetId:b,filter:x}));else{const $=this.getFeaturesetDescriptors();for(const Z of $)A.push({targetId:b,filter:x,target:Z});for(const{style:Z}of this.fragments){const W=Z.getFeaturesetDescriptors();for(const ee of W)A.push({targetId:b,filter:x,target:ee})}}const R=this.queryRenderedTargets(r,A,m),N=[],U=new Set;for(const $ of R)for(const Z of $.variants[b])yl(Z,$,U)||N.push(new i.cw($,Z));return N}queryRenderedTargets(r,l,m){const x={},b=(R,N,U,$)=>{const Z=x[N.id]=x[N.id]||{sourceCache:N,layers:{},has3DLayers:!1};if(Z.layers[R.fqid]=Z.layers[R.fqid]||{styleLayer:R,targets:[]},R.is3D()&&(Z.has3DLayers=!0),!$)return U.uniqueFeatureID=!1,void Z.layers[R.fqid].targets.push(U);Z.layers[R.fqid].targets.push(Object.assign({},U,{namespace:$.namespace,properties:$.properties,uniqueFeatureID:$.uniqueFeatureID}))};for(const R of l)if("featuresetId"in R.target){const{featuresetId:N,importId:U}=R.target,$=this.getFragmentStyle(U);if(!$||!$._featuresetSelectors)continue;const Z=$._featuresetSelectors[N];if(!Z){this.fire(new i.y(new Error(`The featureset '${N}' does not exist in the map's style and cannot be queried for features.`)));continue}for(const W of Z){const ee=$.getOwnLayer(W.layerId);ee&&!hc.has(ee.type)&&b(ee,$.getOwnLayerSourceCache(ee),R,W)}}else if("layerId"in R.target){const{layerId:N}=R.target,U=this.getLayer(N);if(!U||hc.has(U.type))continue;b(U,this.getLayerSourceCache(U),R)}const A=this._queryRenderedFeatures(r,x,m);return this._flattenAndSortRenderedFeatures(A)}_queryRenderedFeatures(r,l,m){const x=[],b=!!this.map._showQueryGeometry,A=wn.createFromScreenPoints(r,m);for(const R in l){const N=rc(A,l[R],this._availableImages,m,b);Object.keys(N).length&&x.push(N)}if(this.placement)for(const R in l){if(!l[R].sourceCache._onlySymbols)continue;const N=Bd(A.screenGeometry,l[R],this._availableImages,this.placement.collisionIndex,this.placement.retainedQueryData);Object.keys(N).length&&x.push(N)}return x}querySourceFeatures(r,l){const m=l&&l.filter;m&&this._validate(vi,"querySourceFeatures.filter",m,null,l);let x=[];const b=this.getOwnSourceCaches(r);for(const A of b)x=x.concat(hf(A,l));return x}addSourceType(r,l,m){return Ia.getSourceType(r)?m(new Error(`A source type called "${r}" already exists.`)):(Ia.setSourceType(r,l),l.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:r,url:l.workerSourceURL},m):m(null,null))}getFlatLight(){return this.light.getLight()}setFlatLight(r,l,m={}){this._checkLoaded();const x=this.light.getLight();let b=!1;for(const R in r)if(!i.bn(r[R],x[R])){b=!0;break}if(!b)return;const A=this._getTransitionParameters();this.light.setLight(r,l,m),this.light.updateTransitions(A)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}checkCanvasFingerprintNoise(){this.disableElevatedTerrain===void 0&&(this.disableElevatedTerrain=i.q.hasCanvasFingerprintNoise(),this.disableElevatedTerrain&&i.w("Terrain and hillshade are disabled because of Canvas2D limitations when fingerprinting protection is enabled (e.g. in private browsing mode)."))}setTerrain(r,l=1){if(this._checkLoaded(),!r)return this.terrainSetForDrapingOnly()||(delete this.terrain,this.map.transform.projection.requiresDraping&&this.setTerrainForDraping()),l===0&&delete this.terrain,r===null?this.stylesheet.terrain=null:delete this.stylesheet.terrain,this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);this.checkCanvasFingerprintNoise();let m=r;const x=r.source==null;if(l===1){if(this.disableElevatedTerrain)return;if(typeof m.source=="object"){const R="terrain-dem-src";this.addSource(R,m.source),m=i.cp(m),m=i.l(m,{source:R})}const b=i.l({},m),A={};if(this.terrain&&x){b.source=this.terrain.get().source;const R=this.terrain?this.getFragmentStyle(this.terrain.scope):null;R&&(A.style=R.serialize())}if(this._validate(Zs,"terrain",b,A))return}if(!this.terrain||this.terrain.scope!==this.scope&&!x||this.terrain&&l!==this.terrain.drapeRenderMode){if(!m)return;this._createTerrain(m,l),this.fire(new i.z("data",{dataType:"style"}))}else{const b=this.terrain,A=b.get();for(const R of Object.keys(i.a3.terrain))!m.hasOwnProperty(R)&&i.a3.terrain[R].default&&(m[R]=i.a3.terrain[R].default);for(const R in r)if(!i.bn(r[R],A[R])){b.set(r,this.options),this.stylesheet.terrain=r;const N=this._getTransitionParameters({duration:0});b.updateTransitions(N),this.fire(new i.z("data",{dataType:"style"}));break}}this.mergeTerrain(),this.updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(r){const l=this.fog=new lt(r,this.map.transform,this.scope,this.options);this.stylesheet.fog=l.get();const m=this._getTransitionParameters({duration:0});l.updateTransitions(m)}_createSnow(r){const l=this.snow=new gn(r,this.map.transform,this.scope,this.options);this.stylesheet.snow=l.get();const m=this._getTransitionParameters({duration:0});l.updateTransitions(m)}_createRain(r){const l=this.rain=new Cn(r,this.map.transform,this.scope,this.options);this.stylesheet.rain=l.get();const m=this._getTransitionParameters({duration:0});l.updateTransitions(m)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const r of this.map._markers)r._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(r){if(this._checkLoaded(),!r)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const l=this.fog;if(!i.bn(l.get(),r)){l.set(r,this.options),this.stylesheet.fog=l.get();const m=this._getTransitionParameters({duration:0});l.updateTransitions(m)}}else this._createFog(r);this._markersNeedUpdate=!0}getSnow(){return this.snow?this.snow.get():null}setSnow(r){if(this._checkLoaded(),!r)return delete this.snow,void delete this.stylesheet.snow;if(this.snow){const l=this.snow;if(!i.bn(l.get(),r)){l.set(r,this.options),this.stylesheet.snow=l.get();const m=this._getTransitionParameters({duration:0});l.updateTransitions(m)}}else this._createSnow(r);this._markersNeedUpdate=!0}getRain(){return this.rain?this.rain.get():null}setRain(r){if(this._checkLoaded(),!r)return delete this.rain,void delete this.stylesheet.rain;if(this.rain){const l=this.rain;if(!i.bn(l.get(),r)){l.set(r,this.options),this.stylesheet.rain=l.get();const m=this._getTransitionParameters({duration:0});l.updateTransitions(m)}}else this._createRain(r);this._markersNeedUpdate=!0}_reloadColorTheme(){const r=()=>{for(const x in this._layers)this._layers[x].lut=this._styleColorTheme.lut;for(const x in this._sourceCaches)this._sourceCaches[x].clearTiles()},l=this._styleColorTheme.colorThemeOverride?this._styleColorTheme.colorThemeOverride:this._styleColorTheme.colorTheme;if(!l)return this._styleColorTheme.lut=null,void r();const m=this._evaluateColorThemeData(l);this._loadColorTheme(m).then(()=>{this.fire(new i.z("colorthemeset")),r()}).catch(x=>{i.w(`Couldn't set color theme: ${x}`)})}setColorTheme(r){this._checkLoaded(),this._styleColorTheme.colorThemeOverride&&i.w("Note: setColorTheme is called on a style with a color-theme override, the passed color-theme won't be visible."),this._styleColorTheme.colorTheme=r,this._reloadColorTheme()}setImportColorTheme(r,l){const m=this.getFragmentStyle(r);m&&(m._styleColorTheme.colorThemeOverride=l,m._reloadColorTheme())}_getTransitionParameters(r){return{now:i.q.now(),transition:i.l(this.transition,r)}}updateDrapeFirstLayers(){if(!this.terrain)return;const r=[],l=[];for(const m of this._mergedOrder)this.isLayerDraped(this._mergedLayers[m])?r.push(m):l.push(m);this._drapedFirstOrder=[],this._drapedFirstOrder.push(...r),this._drapedFirstOrder.push(...l)}_createTerrain(r,l){const m=this.terrain=new pe(r,l,this.scope,this.options);l===1&&(this.stylesheet.terrain=r),this.mergeTerrain(),this.updateDrapeFirstLayers(),this._force3DLayerUpdate();const x=this._getTransitionParameters({duration:0});m.updateTransitions(x)}_force3DLayerUpdate(){for(const r in this._layers){const l=this._layers[r];l.type==="fill-extrusion"&&this._updateLayer(l)}}_forceSymbolLayerUpdate(){for(const r in this._layers){const l=this._layers[r];l.type==="symbol"&&this._updateLayer(l)}}_validate(r,l,m,x,b={}){if(b&&b.validate===!1)return!1;const A=i.l({},this.serialize());return Cl(this,r.call($a,i.l({key:l,style:A,value:m,styleSpec:i.a3},x)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),i.cx.off("pluginStateChange",this._rtlTextPluginCallback);for(const r in this._mergedLayers)this._mergedLayers[r].setEventedParent(null);for(const r in this._mergedSourceCaches)this._mergedSourceCaches[r].clearTiles(),this._mergedSourceCaches[r].setEventedParent(null);this.setEventedParent(null),delete this.fog,delete this.snow,delete this.rain,delete this.terrain,delete this.ambientLight,delete this.directionalLight,this.isRootStyle()&&(this.imageManager.setEventedParent(null),this.modelManager.setEventedParent(null),this.dispatcher.remove())}clearSource(r){const l=this.getSourceCaches(r);for(const m of l)m.clearTiles()}clearSources(){for(const r in this._mergedSourceCaches)this._mergedSourceCaches[r].clearTiles()}reloadSource(r){const l=this.getSourceCaches(r);for(const m of l)m.resume(),m.reload()}reloadSources(){for(const r of this.getSources())r.reload&&r.reload()}reloadModels(){this.modelManager.reloadModels(""),this.forEachFragmentStyle(r=>{r.modelManager.reloadModels(r.scope)})}updateSources(r){let l;this.directionalLight&&(l=lc(this.directionalLight));for(const m in this._mergedSourceCaches)this._mergedSourceCaches[m].update(r,void 0,void 0,l)}_generateCollisionBoxes(){for(const r in this._sourceCaches){const l=this._sourceCaches[r];l.resume(),l.reload()}}_updatePlacement(r,l,m,x,b,A,R=!1){let N=!1,U=!1;const $={},Z={};for(const W of this._mergedOrder){const ee=this._mergedLayers[W];if(ee.type!=="symbol")continue;const ue=i.aC(ee.source,ee.scope);let oe=$[ue];if(!oe){const fe=this.getLayerSourceCache(ee);if(!fe)continue;const Te=fe.getRenderableIds(!0).map(Pe=>fe.getTileByID(Pe));Z[ue]=Te.slice(),oe=$[ue]=Te.sort((Pe,Oe)=>Oe.tileID.overscaledZ-Pe.tileID.overscaledZ||(Pe.tileID.isLessThan(Oe.tileID)?-1:1))}const de=this.crossTileSymbolIndex.addLayer(ee,oe,l.center.lng,l.projection);N=N||de}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._mergedOrder),R=R||this._layerOrderChanged||x===0,this._layerOrderChanged&&this.fire(new i.z("neworder")),(R||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(i.q.now(),l.zoom))&&(this.pauseablePlacement=new Wg(l,this._mergedOrder,R,m,x,b,this.placement,this.fog&&l.projection.supportsFog?this.fog.state:null,this._buildingIndex),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._mergedOrder,this._mergedLayers,$,Z,this.map.painter.scaleFactor),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(i.q.now()),U=!0),N&&this.pauseablePlacement.placement.setStale()),U||N){this._buildingIndex.onNewFrame(l.zoom);for(let W=0;W<this._mergedOrder.length;W++){const ee=this._mergedLayers[this._mergedOrder[W]];if(ee.type!=="symbol")continue;const ue=this.isLayerClipped(ee);this.placement.updateLayerOpacities(ee,$[i.aC(ee.source,ee.scope)],W,ue?A:null)}}return{needsRerender:!this.pauseablePlacement.isDone()||this.placement.hasTransitions(i.q.now())}}_releaseSymbolFadeTiles(){for(const r in this._sourceCaches)this._sourceCaches[r].releaseSymbolFadeTiles()}addImport(r,l){this._checkLoaded();const m=this.stylesheet.imports=this.stylesheet.imports||[];if(m.findIndex(({id:b})=>b===r.id)!==-1)return void this.fire(new i.y(new Error(`Import with id '${r.id}' already exists in the map's style.`)));if(!l)return m.push(r),this._loadImports([r],!0);const x=m.findIndex(({id:b})=>b===l);return x===-1&&this.fire(new i.y(new Error(`Import with id "${l}" does not exist on this map.`))),this.stylesheet.imports=m.slice(0,x).concat(r).concat(m.slice(x)),this._loadImports([r],!0,l)}updateImport(r,l){this._checkLoaded();const m=this.stylesheet.imports||[],x=this.getImportIndex(r);return x===-1?this:typeof l=="string"?(this.setImportUrl(r,l),this):(l.url&&l.url!==m[x].url&&this.setImportUrl(r,l.url),i.bn(l.config,m[x].config)||this.setImportConfig(r,l.config,l.data.schema),i.bn(l.data,m[x].data)||this.setImportData(r,l.data),this)}moveImport(r,l){this._checkLoaded();let m=this.stylesheet.imports||[];const x=this.getImportIndex(r);if(x===-1)return this;const b=this.getImportIndex(l);if(b===-1)return this;const A=m[x],R=this.fragments[x];return m=m.filter(({id:N})=>N!==r),this.fragments=this.fragments.filter(({id:N})=>N!==r),this.stylesheet.imports=m.slice(0,b).concat(A).concat(m.slice(b)),this.fragments=this.fragments.slice(0,b).concat(R).concat(this.fragments.slice(b)),this.mergeLayers(),this}setImportUrl(r,l){this._checkLoaded();const m=this.stylesheet.imports||[],x=this.getImportIndex(r);if(x===-1)return this;m[x].url=l;const b=this.fragments[x];return b.style=this._createFragmentStyle(m[x]),b.style.on("style.import.load",()=>this.mergeAll()),b.style.loadURL(l),this}setImportData(r,l){this._checkLoaded();const m=this.getImportIndex(r),x=this.stylesheet.imports||[];return m===-1?this:l?(this.fragments[m].style.setState(l),this._reloadImports(),this):(delete x[m].data,this.setImportUrl(r,x[m].url))}setImportConfig(r,l,m){this._checkLoaded();const x=this.getImportIndex(r),b=this.stylesheet.imports||[];if(x===-1)return this;l?b[x].config=l:delete b[x].config;const A=this.fragments[x];m&&A.style.stylesheet&&(A.style.stylesheet.schema=m);const R=A.style.stylesheet&&A.style.stylesheet.schema;return A.config=l,A.style.updateConfig(l,R),this.updateConfigDependencies(),this}removeImport(r){this._checkLoaded();const l=this.stylesheet.imports||[],m=this.getImportIndex(r);m!==-1&&(l.splice(m,1),this.fragments[m].style._remove(),this.fragments.splice(m,1),this._reloadImports())}getImportIndex(r){const l=(this.stylesheet.imports||[]).findIndex(m=>m.id===r);return l===-1&&this.fire(new i.y(new Error(`Import '${r}' does not exist in the map's style and cannot be updated.`))),l}getLayer(r){return this._mergedLayers[r]}getSources(){const r=[];for(const l in this._mergedOtherSourceCaches){const m=this._mergedOtherSourceCaches[l];m&&r.push(m.getSource())}return r}getSource(r,l){const m=this.getSourceCache(r,l);return m&&m.getSource()}getLayerSource(r){const l=this.getLayerSourceCache(r);return l&&l.getSource()}getSourceCache(r,l){const m=i.aC(r,l);return this._mergedOtherSourceCaches[m]}getLayerSourceCache(r){const l=i.aC(r.source,r.scope);return r.type==="symbol"?this._mergedSymbolSourceCaches[l]:this._mergedOtherSourceCaches[l]}getSourceCaches(r){if(r==null)return Object.values(this._mergedSourceCaches);const l=[];return this._mergedOtherSourceCaches[r]&&l.push(this._mergedOtherSourceCaches[r]),this._mergedSymbolSourceCaches[r]&&l.push(this._mergedSymbolSourceCaches[r]),l}updateSourceCaches(){const r=this._changes.getUpdatedSourceCaches();for(const l in r){const m=r[l];m==="reload"?this.reloadSource(l):m==="clear"&&this.clearSource(l)}}updateLayers(r){const l=this._changes.getUpdatedPaintProperties();for(const m of l){const x=this.getLayer(m);x&&x.updateTransitions(r)}}getImages(r,l,m){this.imageManager.getImages(l.icons,l.scope,m),this._updateTilesForChangedImages();const x=b=>{b&&b.setDependencies(l.tileID.key,l.type,l.icons)};x(this._otherSourceCaches[l.source]),x(this._symbolSourceCaches[l.source])}rasterizeImages(r,l,m){this.imageManager.rasterizeImages(l,m)}getGlyphs(r,l,m){this.glyphManager.getGlyphs(l.stacks,l.scope,m)}getResource(r,l,m){return i.cy(l,m)}getOwnSourceCache(r){return this._otherSourceCaches[r]}getOwnLayerSourceCache(r){return r.type==="symbol"?this._symbolSourceCaches[r.source]:this._otherSourceCaches[r.source]}getOwnSourceCaches(r){const l=[];return this._otherSourceCaches[r]&&l.push(this._otherSourceCaches[r]),this._symbolSourceCaches[r]&&l.push(this._symbolSourceCaches[r]),l}_isSourceCacheLoaded(r){const l=this.getOwnSourceCaches(r);return l.length===0?(this.fire(new i.y(new Error(`There is no source with ID '${r}'`))),!1):l.every(m=>m.loaded())}has3DLayers(){return this._has3DLayers}hasSymbolLayers(){return this._hasSymbolLayers}hasCircleLayers(){return this._hasCircleLayers}isLayerClipped(r,l){if(!this._clipLayerPresent&&r.type!=="fill-extrusion")return!1;const m=r.type==="fill-extrusion"&&r.sourceLayer==="building";if(r.is3D()){if(m||l&&l.type==="batched-model"||r.type==="model")return!0}else if(r.type==="symbol")return!0;return!1}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.fragments.forEach(r=>{r.style._remove()}),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}Ia.getSourceType=function(p){return ii[p]},Ia.setSourceType=function(p,r){ii[p]=r},Ia.registerForPluginStateChange=i.ch;var Ef=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#ifdef RENDER_CUTOFF
float cutoff_opacity(vec4 cutoff_params,float depth) {float near=cutoff_params.x;float far=cutoff_params.y;float cutoffStart=cutoff_params.z;float cutoffEnd=cutoff_params.w;float linearDepth=(depth-near)/(far-near);return clamp((linearDepth-cutoffStart)/(cutoffEnd-cutoffStart),0.0,1.0);}
#endif`,lh=`
out vec4 glFragColor;highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}
#ifdef INDICATOR_CUTOUT
uniform vec3 u_indicator_cutout_centers;uniform vec4 u_indicator_cutout_params;
#endif
vec4 applyCutout(vec4 color,float height) {
#ifdef INDICATOR_CUTOUT
float verticalFadeRange=u_indicator_cutout_centers.z*0.25;float holeMinOpacity=mix(1.0,u_indicator_cutout_params.x,smoothstep(u_indicator_cutout_centers.z,u_indicator_cutout_centers.z+verticalFadeRange,height));float holeRadius=max(u_indicator_cutout_params.y,0.0);float holeAspectRatio=u_indicator_cutout_params.z;float fadeStart=u_indicator_cutout_params.w;float distA=distance(vec2(gl_FragCoord.x,gl_FragCoord.y*holeAspectRatio),vec2(u_indicator_cutout_centers[0],u_indicator_cutout_centers[1]*holeAspectRatio));return color*min(smoothstep(fadeStart,holeRadius,distA)+holeMinOpacity,1.0);
#else
return color;
#endif
}
#ifdef DEBUG_WIREFRAME
#define HANDLE_WIREFRAME_DEBUG \\
glFragColor=vec4(0.7,0.0,0.0,0.7); \\
gl_FragDepth=gl_FragCoord.z-0.0001;
#else
#define HANDLE_WIREFRAME_DEBUG
#endif
#ifdef RENDER_CUTOFF
uniform highp vec4 u_cutoff_params;in float v_cutoff_opacity;
#endif
vec4 textureLodCustom(sampler2D image,highp vec2 pos,highp vec2 lod_coord) {highp vec2 size=vec2(textureSize(image,0));highp vec2 dx=dFdx(lod_coord.xy*size);highp vec2 dy=dFdy(lod_coord.xy*size);highp float delta_max_sqr=max(dot(dx,dx),dot(dy,dy));highp float lod=0.5*log2(delta_max_sqr);return textureLod(image,pos,lod);}vec4 applyLUT(highp sampler3D lut,vec4 col) {vec3 size=vec3(textureSize(lut,0));vec3 uvw=(col.rbg*float(size-1.0)+0.5)/size;return vec4(texture(lut,uvw).rgb,col.a);}vec3 applyLUT(highp sampler3D lut,vec3 col) {return applyLUT(lut,vec4(col,1.0)).rgb;}`,Af=`
#define EXTENT 8192.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const vec2 units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (units_to_pixels*pos+offset)/pattern_size;}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {return get_pattern_pos(pixel_coord_upper,pixel_coord_lower,pattern_size,vec2(tile_units_to_pixels),pos);}float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(PI/4.0+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}
#ifdef RENDER_CUTOFF
uniform vec4 u_cutoff_params;out float v_cutoff_opacity;
#endif
const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}`,fc="in highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;out highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",Zd=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
#ifdef TERRAIN
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(dd,0)).r;float bl=texture(u_dem,pos+vec2(0,dd)).r;float br=texture(u_dem,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem_prev,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem_prev,pos).r;float tr=texture(u_dem_prev,pos+vec2(dd,0)).r;float bl=texture(u_dem_prev,pos+vec2(0,dd)).r;float br=texture(u_dem_prev,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
vec4 fourSample(vec2 pos,vec2 off) {float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(off.x,0.0)).r;float bl=texture(u_dem,pos+vec2(0.0,off.y)).r;float br=texture(u_dem,pos+off).r;return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }
#endif
#ifdef DEPTH_OCCLUSION
uniform highp sampler2D u_depth;uniform highp vec2 u_depth_size_inv;uniform highp vec2 u_depth_range_unpack;uniform highp float u_occluder_half_size;uniform highp float u_occlusion_depth_offset;
#ifdef DEPTH_D24
float unpack_depth(float depth) {return depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}vec4 unpack_depth4(vec4 depth) {return depth*u_depth_range_unpack.x+vec4(u_depth_range_unpack.y);}
#else
highp float unpack_depth_rgba(vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;
#ifdef DEPTH_D24
float depth=unpack_depth(texture(u_depth,(coord.xy+1.0)*0.5).r);
#else
float depth=unpack_depth_rgba(texture(u_depth,(coord.xy+1.0)*0.5));
#endif
return coord.z+u_occlusion_depth_offset > depth;}highp vec4 getCornerDepths(vec2 coord) {highp vec3 df=vec3(u_occluder_half_size*u_depth_size_inv,0.0);highp vec2 uv=0.5*coord.xy+0.5;
#ifdef DEPTH_D24
highp vec4 depth=vec4(
texture(u_depth,uv-df.xz).r,texture(u_depth,uv+df.xz).r,texture(u_depth,uv-df.zy).r,texture(u_depth,uv+df.zy).r
);depth=unpack_depth4(depth);
#else
highp vec4 depth=vec4(
unpack_depth_rgba(texture(u_depth,uv-df.xz)),unpack_depth_rgba(texture(u_depth,uv+df.xz)),unpack_depth_rgba(texture(u_depth,uv-df.zy)),unpack_depth_rgba(texture(u_depth,uv+df.zy))
);
#endif
return depth;}highp float occlusionFadeMultiSample(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec2 uv=0.5*coord.xy+0.5;int NX=3;int NY=4;highp vec2 df=u_occluder_half_size*u_depth_size_inv;highp vec2 oneStep=2.0*u_occluder_half_size*u_depth_size_inv/vec2(NX-1,NY-1);highp float res=0.0;for (int y=0; y < NY;++y) {for (int x=0; x < NX;++x) {
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)));
#endif
res+=1.0-clamp(300.0*(coord.z+u_occlusion_depth_offset-depth),0.0,1.0);}}res=clamp(2.0*res/float(NX*NY)-0.5,0.0,1.0);return res;}highp float occlusionFade(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec4 depth=getCornerDepths(coord.xy);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z+u_occlusion_depth_offset)-depth),0.0,1.0));}
#else
bool isOccluded(vec4 frag) { return false; }highp float occlusionFade(vec4 frag) { return 1.0; }highp float occlusionFadeMultiSample(vec4 frag) { return 1.0; }
#endif//DEPTH_OCCLUSION`,dm=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;out vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,dc=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump vec2 u_fog_vertical_limit;uniform mediump float u_fog_temporal_offset;in vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos,float opacity_limit) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,min(opacity,opacity_limit));}vec3 fog_apply(vec3 color,vec3 pos) {return fog_apply(color,pos,1.0);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec4 fog_apply_premultiplied(vec4 color,vec3 pos,float heightMeters) {float verticalProgress=(u_fog_vertical_limit.x > 0.0 || u_fog_vertical_limit.y > 0.0) ? smoothstep(u_fog_vertical_limit.x,u_fog_vertical_limit.y,heightMeters) : 0.0;float opacityLimit=1.0-smoothstep(0.9,1.0,fog_opacity(pos));return mix(fog_apply_premultiplied(color,pos),color,min(verticalProgress,opacityLimit));}vec3 fog_dither(vec3 color) {return color;}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`,uu=`#ifdef RASTER_ARRAY
uniform highp sampler2D u_image0;uniform sampler2D u_image1;const vec4 NODATA=vec4(1);ivec4 _raTexLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}vec2 _raTexLinearMix(highp vec2 fxy,highp vec4 colorMix,highp float colorOffset,highp vec4 t00,highp vec4 t10,highp vec4 t01,highp vec4 t11) {vec2 c00=t00==NODATA ? vec2(0) : vec2(colorOffset+dot(t00,colorMix),1);vec2 c10=t10==NODATA ? vec2(0) : vec2(colorOffset+dot(t10,colorMix),1);vec2 c01=t01==NODATA ? vec2(0) : vec2(colorOffset+dot(t01,colorMix),1);vec2 c11=t11==NODATA ? vec2(0) : vec2(colorOffset+dot(t11,colorMix),1);return mix(mix(c01,c11,fxy.x),mix(c00,c10,fxy.x),fxy.y);}vec2 raTexture2D_image0_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image0,c.yz,0),texelFetch(u_image0,c.xz,0),texelFetch(u_image0,c.yw,0),texelFetch(u_image0,c.xw,0)
);}vec2 raTexture2D_image1_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image1,c.yz,0),texelFetch(u_image1,c.xz,0),texelFetch(u_image1,c.yw,0),texelFetch(u_image1,c.xw,0)
);}vec2 raTexture2D_image0_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image0,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}vec2 raTexture2D_image1_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image1,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}
#endif`,ch=`#ifdef RASTER_ARRAY
uniform sampler2D u_velocity;uniform mediump vec2 u_velocity_res;uniform mediump float u_max_speed;const vec4 NO_DATA=vec4(1);const vec2 INVALID_VELOCITY=vec2(-1);uniform highp vec2 u_uv_offset;uniform highp float u_data_offset;uniform highp vec2 u_data_scale;ivec4 rasterArrayLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}highp vec2 lookup_velocity(highp vec2 uv) {uv=u_uv_offset.x+u_uv_offset.y*uv;highp vec2 fxy;ivec4 c=rasterArrayLinearCoord(uv,u_velocity_res,fxy);highp vec4 tl=texelFetch(u_velocity,c.yz,0);highp vec4 tr=texelFetch(u_velocity,c.xz,0);highp vec4 bl=texelFetch(u_velocity,c.yw,0);highp vec4 br=texelFetch(u_velocity,c.xw,0);if (tl==NO_DATA) {return INVALID_VELOCITY;}if (tr==NO_DATA) {return INVALID_VELOCITY;}if (bl==NO_DATA) {return INVALID_VELOCITY;}if (br==NO_DATA) {return INVALID_VELOCITY;}highp vec4 t=mix(mix(bl,br,fxy.x),mix(tl,tr,fxy.x),fxy.y);highp vec2 velocity=u_data_offset+vec2(dot(t.rg,u_data_scale),dot(t.ba,u_data_scale));velocity.y=-velocity.y;velocity/=max(u_max_speed,length(velocity));return velocity;}
#endif
uniform highp float u_particle_pos_scale;uniform highp vec2 u_particle_pos_offset;highp vec4 pack_pos_to_rgba(highp vec2 p) {highp vec2 v=(p+u_particle_pos_offset)/u_particle_pos_scale;highp vec4 r=vec4(v.x,fract(v.x*255.0),v.y,fract(v.y*255.0));return vec4(r.x-r.y/255.0,r.y,r.z-r.w/255.0,r.w);}highp vec2 unpack_pos_from_rgba(highp vec4 v) {v=floor(v*255.0+0.5)/255.0;highp vec2 p=vec2(v.x+(v.y/255.0),v.z+(v.w/255.0));return u_particle_pos_scale*p-u_particle_pos_offset;}`,lo=`#ifdef RENDER_SHADOWS
uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_normal_offset;vec3 shadow_normal_offset(vec3 normal) {float tileInMeters=u_shadow_normal_offset[0];vec3 n=vec3(-normal.xy,tileInMeters*normal.z);float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return n*dotScale;}vec3 shadow_normal_offset_model(vec3 normal) {vec3 transformed_normal=vec3(-normal.xy,normal.z);float NDotL=dot(normalize(transformed_normal),u_shadow_direction);float dotScale=min(1.0-NDotL,1.0)*0.5+0.5;return normal*dotScale;}float shadow_normal_offset_multiplier0() {return u_shadow_normal_offset[1];}float shadow_normal_offset_multiplier1() {return u_shadow_normal_offset[2];}
#endif//RENDER_SHADOWS`,Pa=`#ifdef RENDER_SHADOWS
#ifdef DEPTH_TEXTURE
uniform highp sampler2D u_shadowmap_0;uniform highp sampler2D u_shadowmap_1;
#else
uniform sampler2D u_shadowmap_0;uniform sampler2D u_shadowmap_1;
#endif
uniform float u_shadow_intensity;uniform float u_shadow_map_resolution;uniform float u_shadow_texel_size;uniform highp vec3 u_shadow_normal_offset;uniform vec2 u_fade_range;uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_bias;highp float shadow_sample_1(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture(u_shadowmap_1,uv).r;
#else
shadow_depth=unpack_depth(texture(u_shadowmap_1,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}highp float shadow_sample_0(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture(u_shadowmap_0,uv).r;
#else
shadow_depth=unpack_depth(texture(u_shadowmap_0,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}float shadow_occlusion_1(highp vec4 pos,highp float bias) {highp vec2 uv=pos.xy;return shadow_sample_1(uv,pos.z-bias);}float shadow_occlusion_0(highp vec4 pos,highp float bias) {highp float compare0=pos.z-bias;
#ifdef TEXTURE_GATHER
highp vec2 uv=pos.xy;highp vec4 samples=textureGather(u_shadowmap_0,uv,0);lowp vec4 stepSamples=step(samples,vec4(compare0));
#else
highp vec2 uv00=pos.xy-vec2(0.5*u_shadow_texel_size);highp vec2 uv10=uv00+vec2(u_shadow_texel_size,0.0);highp vec2 uv01=uv00+vec2(0.0,u_shadow_texel_size);highp vec2 uv11=uv01+vec2(u_shadow_texel_size,0.0);lowp vec4 stepSamples=vec4(
shadow_sample_0(uv01,compare0),shadow_sample_0(uv11,compare0),shadow_sample_0(uv10,compare0),shadow_sample_0(uv00,compare0)
);
#endif
vec2 f=fract(pos.xy*u_shadow_map_resolution-vec2(0.5));lowp vec2 lerpx=mix(stepSamples.wx,stepSamples.zy,f.xx);return mix(lerpx.x,lerpx.y,f.y);}float shadow_occlusion(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,highp float bias) {
#ifdef SHADOWS_SINGLE_CASCADE
light_view_pos0.xyz/=light_view_pos0.w;vec2 abs_bounds=abs(light_view_pos0.xy);if (abs_bounds.x >=1.0 || abs_bounds.y >=1.0) {return 0.0;}light_view_pos0.xyz=light_view_pos0.xyz*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);
#else
light_view_pos0.xyz/=light_view_pos0.w;light_view_pos1.xyz/=light_view_pos1.w;vec4 uv=vec4(light_view_pos0.xy,light_view_pos1.xy);vec4 abs_bounds=abs(uv);if (abs_bounds.x < 1.0 && abs_bounds.y < 1.0) {light_view_pos0.xyz=light_view_pos0.xyz*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);}if (abs_bounds.z >=1.0 || abs_bounds.w >=1.0) {return 0.0;}light_view_pos1.xyz=light_view_pos1.xyz*0.5+0.5;float occlusion1=shadow_occlusion_1(light_view_pos1,bias);return mix(occlusion1,0.0,smoothstep(u_fade_range.x,u_fade_range.y,view_depth));
#endif
}highp float calculate_shadow_bias(float NDotL) {
#ifdef NORMAL_OFFSET
return 0.5*u_shadow_bias.x;
#else
return 0.5*(u_shadow_bias.x+clamp(u_shadow_bias.y*tan(acos(NDotL)),0.0,u_shadow_bias.z));
#endif
}float shadowed_light_factor_normal(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_opacity(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,float shadow_opacity) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias)*shadow_opacity;return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_unbiased(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}highp vec2 compute_receiver_plane_depth_bias(highp vec3 pos_dx,highp vec3 pos_dy)
{highp vec2 biasUV=vec2(
pos_dy.y*pos_dx.z-pos_dx.y*pos_dy.z,pos_dx.x*pos_dy.z-pos_dy.x*pos_dx.z);biasUV*=1.0/((pos_dx.x*pos_dy.y)-(pos_dx.y*pos_dy.x));return biasUV;}float shadowed_light_factor_plane_bias(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {highp vec3 light_view_pos0_xyz=light_view_pos0.xyz/light_view_pos0.w*0.5+0.5;highp vec3 light_view_pos0_ddx=dFdx(light_view_pos0_xyz);highp vec3 light_view_pos0_ddy=dFdy(light_view_pos0_xyz);highp vec2 plane_depth_bias=compute_receiver_plane_depth_bias(light_view_pos0_ddx,light_view_pos0_ddy);highp float bias=dot(vec2(u_shadow_texel_size,u_shadow_texel_size),plane_depth_bias)+0.0001;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadowed_light_factor(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadow_occlusion(float ndotl,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=calculate_shadow_bias(ndotl);return shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);}
#endif`;const ls=[];_c(Ef,ls),_c(Af,ls),_c(lh,ls);const pc={"_prelude_fog.vertex.glsl":dm,"_prelude_terrain.vertex.glsl":Zd,"_prelude_shadow.vertex.glsl":lo,"_prelude_fog.fragment.glsl":dc,"_prelude_shadow.fragment.glsl":Pa,"_prelude_lighting.glsl":`
#ifdef LIGHTING_3D_MODE
uniform mediump vec3 u_lighting_ambient_color;uniform mediump vec3 u_lighting_directional_dir;uniform mediump vec3 u_lighting_directional_color;uniform mediump vec3 u_ground_radiance;float calculate_ambient_directional_factor(vec3 normal) {float NdotL=dot(normal,u_lighting_directional_dir);const float factor_reduction_max=0.3;float dir_luminance=dot(u_lighting_directional_color,vec3(0.2126,0.7152,0.0722));float directional_factor_min=1.0-factor_reduction_max*min(dir_luminance,1.0);float ambient_directional_factor=mix(directional_factor_min,1.0,min((NdotL+1.0),1.0));const float vertical_factor_min=0.92;float vertical_factor=mix(vertical_factor_min,1.0,normal.z*0.5+0.5);return vertical_factor*ambient_directional_factor;}vec3 linearProduct(vec3 srgbIn,vec3 k) {return srgbIn*pow(k,vec3(1./2.2));}vec3 apply_lighting(vec3 color,vec3 normal,float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return linearProduct(color,ambient_contrib+directional_contrib);}vec4 apply_lighting(vec4 color,vec3 normal,float dir_factor) {return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting(vec3 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return apply_lighting(color.rgb,normal,dir_factor);}vec4 apply_lighting(vec4 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting_ground(vec3 color) {return color*u_ground_radiance;}vec4 apply_lighting_ground(vec4 color) {return vec4(apply_lighting_ground(color.rgb),color.a);}float calculate_NdotL(vec3 normal) {const float ext=0.70710678118;return (clamp(dot(normal,u_lighting_directional_dir),-ext,1.0)+ext)/(1.0+ext);}vec4 apply_lighting_with_emission_ground(vec4 color,float emissive_strength) {return mix(apply_lighting_ground(color),color,emissive_strength);}vec3 compute_flood_lighting(vec3 flood_light_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=flood_light_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);float occlusion_ramp=smoothstep(0.0,0.2,1.0-occlusion);return mix(fully_occluded_color,flood_light_color,occlusion_ramp);}vec3 compute_emissive_draped(vec3 unlit_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=unlit_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);return mix(fully_occluded_color,unlit_color,1.0-occlusion);}
#endif//LIGHTING_3D_MODE`,"_prelude_raster_array.glsl":uu,"_prelude_raster_particle.glsl":ch},mc={};sr("",Zd),sr(dc,dm),sr(Pa,lo),sr(uu,""),sr(ch,"");const hu=sr(lh,Af),fu=Ef;var Bo={background:sr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
in vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_lighting.glsl"
in vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform mediump vec4 u_color;out vec4 v_color;uniform float u_emissive_strength;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting_with_emission_ground(u_color,u_emissive_strength);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:sr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform float u_emissive_strength;uniform sampler2D u_image;in highp vec2 v_pos;void main() {highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=textureLodCustom(u_image,pos,v_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec2 u_pattern_units_to_pixels;in vec2 a_pos;out highp vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_pattern_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:sr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
uniform float u_emissive_strength;void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float blur_positive=blur < 0.0 ? 0.0 : 1.0;lowp float antialiasblur=v_data.z;float extrude_length=length(extrude)+antialiasblur*(1.0-blur_positive);float antialiased_blur=-max(abs(blur),antialiasblur);float antialiase_blur_opacity=smoothstep(0.0,antialiasblur,extrude_length-1.0);float opacity_t=blur_positive==1.0 ? 
smoothstep(0.0,-antialiased_blur,1.0-extrude_length) : 
smoothstep(antialiased_blur,0.0,extrude_length-1.0)-antialiase_blur_opacity;float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
glFragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
#ifdef ELEVATED_ROADS
in float a_circle_z_offset;
#endif
out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
#ifdef ELEVATED_ROADS
world_center.z+=a_circle_z_offset+ELEVATION_BIAS;
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:sr("void main() {glFragColor=vec4(1.0);}","in vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:sr(`#include "_prelude_fog.fragment.glsl"
uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);glFragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {glFragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:sr(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));glFragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(0.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,"in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:sr("in float v_placed;in float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);glFragColor =mix(red,blue,step(0.5,v_placed))*0.5;glFragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`#include "_prelude_terrain.vertex.glsl"
in vec3 a_pos;in vec2 a_anchor_pos;in vec2 a_extrude;in vec2 a_placed;in vec2 a_shift;in vec2 a_elevation_from_sea;in float a_size_scale;in vec2 a_padding;in float a_auto_z_offset;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;out float v_placed;out float v_notUsed;void main() {float feature_elevation=a_elevation_from_sea.x+a_auto_z_offset;float terrain_elevation=(a_elevation_from_sea.y==1.0 ? 0.0 : elevation(a_anchor_pos));vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*(feature_elevation+terrain_elevation),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:sr("in float v_radius;in vec2 v_extrude;in float v_perspective_ratio;in float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);glFragColor=color*alpha*opacity_t;}",`in vec2 a_pos_2f;in float a_radius;in vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;out float v_radius;out vec2 v_extrude;out float v_perspective_ratio;out float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:sr("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);glFragColor=mix(u_color,overlay_color,overlay_color.a);}",`#include "_prelude_terrain.vertex.glsl"
in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;
#endif
out vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:sr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=opacity;
#ifdef INDICATOR_CUTOUT
if (v_z_offset >=0.0) {out_color=applyCutout(out_color,v_z_offset);}
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=z_offset;
#endif
}`),fillOutline:sr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
in highp vec2 v_pos;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
uniform mat4 u_matrix;uniform vec2 u_world;out highp vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:sr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
in highp vec2 v_pos;in highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
out highp vec2 v_pos;out highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:sr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;in highp vec2 v_pos;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
out highp vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:sr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec4 v_color;in vec4 v_flat;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;
#endif
uniform lowp float u_opacity;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec2 v_ao;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
in vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
in highp vec3 v_normal;
#endif
uniform vec3 u_flood_light_color;uniform highp float u_vertical_scale;uniform float u_flood_light_intensity;uniform vec3 u_ground_shadow_factor;
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
in float v_flood_radius;in float v_has_floodlight;
#endif
in float v_height;
#pragma mapbox: define highp float emissive_strength
void main() {
#pragma mapbox: initialize highp float emissive_strength
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
vec3 normal=normalize(v_normal);
#endif
float z;vec4 color=v_color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);
#ifdef LIGHTING_3D_MODE
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#else
color=mix(v_color,v_roof_color,z);
#endif
#endif
float h=max(0.0,v_height);float ao_shade=1.0;
#ifdef FAUX_AO
float intensity=u_ao[0];float h_floors=h/(u_ao[1]*u_vertical_scale);float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);ao_shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);ao_shade*=mix(1.0,x_shade*x_shade*x_shade,concave);
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
color.rgb*=mix(ao_shade,1.0,v_has_floodlight);
#else
color.rgb*=ao_shade;
#endif
#else
color.rgb*=ao_shade;
#endif
#endif
#ifdef LIGHTING_3D_MODE
float flood_radiance=0.0;
#ifdef FLOOD_LIGHT
flood_radiance=(1.0-min(h/v_flood_radius,1.0))*u_flood_light_intensity*v_has_floodlight;
#endif
#ifdef RENDER_SHADOWS
#ifdef FLOOD_LIGHT
float ndotl_unclamped=dot(normal,u_shadow_direction);float ndotl=max(0.0,ndotl_unclamped);float occlusion=ndotl_unclamped < 0.0 ? 1.0 : shadow_occlusion(ndotl,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 litColor=apply_lighting(color.rgb,normal,(1.0-u_shadow_intensity*occlusion)*ndotl);vec3 floodLitColor=compute_flood_lighting(u_flood_light_color*u_opacity,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=mix(litColor,floodLitColor,flood_radiance);
#else
float shadowed_lighting_factor;
#ifdef RENDER_CUTOFF
shadowed_lighting_factor=shadowed_light_factor_normal_opacity(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,v_cutoff_opacity);if (v_cutoff_opacity==0.0) {discard;}
#else
shadowed_lighting_factor=shadowed_light_factor_normal(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);
#endif
color.rgb=apply_lighting(color.rgb,normal,shadowed_lighting_factor);
#endif
#else
color.rgb=apply_lighting(color.rgb,normal);
#ifdef FLOOD_LIGHT
color.rgb=mix(color.rgb,u_flood_light_color*u_opacity,flood_radiance);
#endif
#endif
color.rgb=mix(color.rgb,v_flat.rgb,emissive_strength);color*=u_opacity;
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos,h));
#endif
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,h);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;uniform float u_width_scale;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
uniform highp float u_vertical_scale;out vec4 v_color;out vec4 v_flat;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
out vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
out highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec2 v_ao;
#endif
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
out float v_flood_radius;out float v_has_floodlight;
#endif
out float v_height;vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define highp float flood_light_wall_radius
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp float emissive_strength
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize highp float flood_light_wall_radius
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp float emissive_strength
base*=u_vertical_scale;height*=u_vertical_scale;vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
v_normal=normal;
#endif
base=max(0.0,base);float attr_height=height;height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele=0.0;vec3 pos;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;ele=elevation(pos_nx.xy);c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);h=t > 0.0 ? max(h_base,h_height) : h_base;pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float cutoff=1.0;vec3 scaled_pos=pos;
#ifdef RENDER_CUTOFF
vec3 centroid_random=vec3(centroid_pos.xy,centroid_pos.x+centroid_pos.y+1.0);vec3 ground_pos=centroid_pos.x==0.0 ? pos.xyz : (centroid_random/8.0);vec4 ground=u_matrix*vec4(ground_pos.xy,ele,1.0);cutoff=cutoff_opacity(u_cutoff_params,ground.z);if (centroid_pos.y !=0.0 && centroid_pos.x !=0.0) {vec3 g=floor(ground_pos);vec3 mod_=centroid_random-g*8.0;float seed=min(1.0,0.1*(min(3.5,max(mod_.x+mod_.y,0.2*attr_height))*0.35+mod_.z));if (cutoff < 0.8-seed) {cutoff=0.0;}}float cutoff_scale=cutoff;v_cutoff_opacity=cutoff;scaled_pos.z=mix(c_ele,h,cutoff_scale);
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (cutoff==0.0 && centroid_pos.x !=0.0) || (color.a==0.0));
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);scaled_pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;scaled_pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
gl_Position=mix(u_matrix*vec4(scaled_pos,1),AWAY,hidden);h=h-ele;v_height=h;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=pos;vec3 shd_pos1=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(normal);shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifndef LIGHTING_3D_MODE
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);if (normal.y !=0.0) {float r=0.84;r=mix(0.7,0.98,1.0-u_lightintensity);NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#endif
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec2(mix(concave,-concave,start),y_ground);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
float is_wall=1.0-float(t > 0.0 && top_up_ny.y > 0.0);v_has_floodlight=float(flood_light_wall_radius > 0.0 && is_wall > 0.0);v_flood_radius=flood_light_wall_radius*u_vertical_scale;
#endif
v_color=vec4(color.rgb,1.0);float ndotl=calculate_NdotL(normal);v_flat.rgb=sRGBToLinear(color.rgb);v_flat.rgb=v_flat.rgb*(ndotl+(1.0-min(ndotl*57.29,1.0))*emissive_strength);v_flat=vec4(linearTosRGB(v_flat.rgb),1.0);
#else
v_color=vec4(0.0,0.0,0.0,1.0);v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color=vec4(0.0,0.0,0.0,1.0);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionDepth:sr(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_edge_radius;uniform float u_width_scale;uniform float u_vertical_scale;
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp vec4 color
out highp float v_depth;void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp vec4 color
base*=u_vertical_scale;height*=u_vertical_scale;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
vec3 pos;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;float ele=elevation(pos_nx.xy);float c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);float h=t > 0.0 ? max(h_base,h_height) : h_base;pos=vec3(pos_nx.xy,h);
#else
pos=vec3(pos_nx.xy,t > 0.0 ? height : base);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);v_depth=gl_Position.z/gl_Position.w;}`),fillExtrusionPattern:sr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
in vec3 v_normal;
#endif
in highp vec2 v_pos;in vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define highp float pixel_ratio
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize highp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,normalize(v_normal))*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,height);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_width_scale;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
out highp vec2 v_pos;out vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
out vec3 v_normal;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define highp float pixel_ratio
#pragma mapbox: define highp float line_width
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize highp float pixel_ratio
#pragma mapbox: initialize highp float line_width
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;ele=elevation(pos_nx.xy);c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);h=t > 0.0 ? max(h_base,h_height) : h_base;p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);p.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;p.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_normal=normal;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif 
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),groundShadow:sr(`#include "_prelude_shadow.fragment.glsl"
precision highp float;uniform vec3 u_ground_shadow_factor;in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#ifdef FOG
in float v_fog_opacity;
#endif
void main() {float light=shadowed_light_factor_plane_bias(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 shadow=mix(u_ground_shadow_factor,vec3(1.0),light);
#ifdef RENDER_CUTOFF
shadow=mix(vec3(1.0),shadow,cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w));
#endif
#ifdef FOG
shadow=mix(shadow,vec3(1.0),v_fog_opacity);
#endif
#ifdef INDICATOR_CUTOUT
shadow=mix(shadow,vec3(1.0),1.0-applyCutout(vec4(1.0),0.0).r);
#endif
glFragColor=vec4(shadow,1.0);}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;in vec2 a_pos;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;
#ifdef FOG
out float v_fog_opacity;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0.0,1.0);v_pos_light_view_0=u_light_matrix_0*vec4(a_pos,0.0,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(a_pos,0.0,1.0);
#ifdef FOG
v_fog_pos=fog_position(a_pos);v_fog_opacity=fog(v_fog_pos);
#endif
}`),fillExtrusionGroundEffect:sr(`uniform highp float u_ao_pass;uniform highp float u_opacity;uniform highp float u_flood_light_intensity;uniform highp vec3 u_flood_light_color;uniform highp float u_attenuation;uniform sampler2D u_fb;uniform float u_fb_size;
#ifdef SDF_SUBPASS
in highp vec2 v_pos;in highp vec4 v_line_segment;in highp float v_flood_light_radius_tile;in highp vec2 v_ao;float line_df(highp vec2 a,highp vec2 b,highp vec2 p) {highp vec2 ba=b-a;highp vec2 pa=p-a;highp float r=clamp(dot(pa,ba)/dot(ba,ba),0.0,1.0);return length(pa-r*ba);}
#ifdef FOG
in highp float v_fog;
#endif
#endif
void main() {
#ifdef CLEAR_SUBPASS
vec4 color=vec4(1.0);
#ifdef CLEAR_FROM_TEXTURE
color=texture(u_fb,gl_FragCoord.xy/vec2(u_fb_size));
#endif
glFragColor=color;
#else
#ifdef SDF_SUBPASS
highp float d=line_df(v_line_segment.xy,v_line_segment.zw,v_pos);highp float effect_radius=mix(v_flood_light_radius_tile,v_ao.y,u_ao_pass);d/=effect_radius;d=min(d,1.0);d=1.0-pow(1.0-d,u_attenuation);highp float effect_intensity=mix(u_flood_light_intensity,v_ao.x,u_ao_pass);highp float fog=1.0;
#ifdef FOG
fog=v_fog;
#endif
#ifdef RENDER_CUTOFF
fog*=v_cutoff_opacity;
#endif
glFragColor=vec4(vec3(0.0),mix(1.0,d,effect_intensity*u_opacity*fog));
#else
vec4 color=mix(vec4(u_flood_light_color,1.0),vec4(vec3(0.0),1.0),u_ao_pass);
#ifdef OVERDRAW_INSPECTOR
color=vec4(1.0);
#endif
glFragColor=color;
#endif
HANDLE_WIREFRAME_DEBUG;
#endif
}`,`#include "_prelude_fog.vertex.glsl"
in highp vec4 a_pos_end;in highp float a_angular_offset_factor;in highp float a_hidden_by_landmark;
#ifdef SDF_SUBPASS
out highp vec2 v_pos;out highp vec4 v_line_segment;out highp float v_flood_light_radius_tile;out highp vec2 v_ao;
#ifdef FOG
out highp float v_fog;
#endif
#endif
uniform highp float u_flood_light_intensity;uniform highp mat4 u_matrix;uniform highp float u_ao_pass;uniform highp float u_meter_to_tile;uniform highp float u_edge_radius;uniform highp float u_dynamic_offset;uniform highp vec2 u_ao;
#pragma mapbox: define highp float flood_light_ground_radius
const float TANGENT_CUTOFF=4.0;const float NORM=32767.0;void main() {
#pragma mapbox: initialize highp float flood_light_ground_radius
vec2 p=a_pos_end.xy;vec2 q=floor(a_pos_end.zw*0.5);vec2 start_bottom=a_pos_end.zw-q*2.0;float fl_ground_radius=flood_light_ground_radius;fl_ground_radius=abs(flood_light_ground_radius);float direction=flood_light_ground_radius < 0.0 ?-1.0 : 1.0;float flood_radius_tile=fl_ground_radius*u_meter_to_tile;vec2 v=normalize(q-p);float ao_radius=u_ao.y/3.5;float effect_radius=mix(flood_radius_tile,ao_radius,u_ao_pass)+u_edge_radius;float angular_offset_factor=a_angular_offset_factor/NORM*TANGENT_CUTOFF;float angular_offset=direction*angular_offset_factor*effect_radius;float top=1.0-start_bottom.y;float side=(0.5-start_bottom.x)*2.0;vec2 extrusion_parallel=v*side*mix(u_dynamic_offset,angular_offset,top);vec2 perp=vec2(v.y,-v.x);vec2 extrusion_perp=direction*perp*effect_radius*top;vec3 pos=vec3(mix(q,p,start_bottom.x),0.0);pos.xy+=extrusion_parallel+extrusion_perp;
#ifdef SDF_SUBPASS
v_pos=pos.xy;v_line_segment=vec4(p,q)+perp.xyxy*u_edge_radius;v_flood_light_radius_tile=flood_radius_tile;v_ao=vec2(u_ao.x,ao_radius);
#ifdef FOG
v_fog_pos=fog_position(pos);v_fog=1.0-fog(v_fog_pos);
#endif
#endif
float hidden_by_landmark=0.0;
#ifdef HAS_CENTROID
hidden_by_landmark=a_hidden_by_landmark;
#endif
float isFloodlit=float(fl_ground_radius > 0.0 && u_flood_light_intensity > 0.0);float hidden=mix(1.0-isFloodlit,isFloodlit,u_ao_pass);hidden+=hidden_by_landmark;gl_Position=mix(u_matrix*vec4(pos,1.0),AWAY,float(hidden > 0.0));
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
}`),hillshadePrepare:sr(`precision highp float;uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;float getElevation(vec2 coord) {return texture(u_image,coord).r/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));glFragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:sr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;uniform float u_emissive_strength;void main() {vec4 pixel=texture(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);glFragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
glFragColor=apply_lighting_with_emission_ground(glFragColor,u_emissive_strength);
#endif
#ifdef FOG
glFragColor=fog_dither(fog_apply_premultiplied(glFragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:sr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform lowp float u_device_pixel_ratio;uniform highp float u_width_scale;uniform highp float u_floor_width_scale;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;uniform highp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec3 v_uv;
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;in vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float dist=length(v_normal)*v_width2.s;float blur2=(u_width_scale*blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture(u_dash_image,v_tex).r;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;float scaled_floorwidth=(floorwidth*u_floor_width_scale);alpha*=linearstep(0.5-sdfgamma/scaled_floorwidth,0.5+sdfgamma/scaled_floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trim_alpha=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=v_uv[2];if (trim_end > trim_start) {highp float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/max(u_trim_fade_range[0],1.0e-9)));highp float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/max(u_trim_fade_range[1],1.0e-9)));highp float transition_factor=min(start_transition,end_transition);out_color=mix(out_color,u_trim_color,transition_factor);trim_alpha=1.0-transition_factor;}
#endif
if (u_alpha_discard_threshold !=0.0) {if (alpha < u_alpha_discard_threshold) {discard;}}
#ifdef RENDER_LINE_BORDER
float edgeBlur=((border_width*u_width_scale)+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);if (border_color.a==0.0) {float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}} else {out_color=mix(border_color*trim_alpha,out_color,smoothAlpha);}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
out_color.rgb*=mix(v_road_z_offset > 0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=(alpha*opacity);
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_z_offset);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define EXTRUDE_SCALE 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS) || defined(VARIABLE_LINE_WIDTH)
in vec3 a_z_offset_width;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
in highp vec3 a_packed;
#endif
#ifdef RENDER_LINE_DASH
in float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;uniform float u_width_scale;uniform highp float u_floor_width_scale;
#ifdef ELEVATED
uniform lowp float u_zbias_factor;uniform lowp float u_tile_to_meter;float sample_elevation(vec2 apos) {
#ifdef ELEVATION_REFERENCE_SEA
return 0.0;
#else
return elevation(apos);
#endif
}
#endif
out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec3 v_uv;
#ifdef ELEVATED_ROADS
out highp float v_road_z_offset;
#endif
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;out vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float a_z_offset;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
a_z_offset=a_z_offset_width.x;
#endif
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth;
#ifdef VARIABLE_LINE_WIDTH
float left=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);halfwidth=(u_width_scale*(left==1.0 ? a_z_offset_width.y : a_z_offset_width.z))/2.0;
#else
halfwidth=(u_width_scale*width)/2.0;
#endif
offset=-1.0*offset*u_width_scale;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec2 extrude=dist*u_pixels_to_tile_units;vec4 projected_extrude=u_matrix*vec4(extrude,0.0,0.0);vec2 projected_extrude_xy=projected_extrude.xy;
#ifdef ELEVATED_ROADS
v_road_z_offset=a_z_offset;gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset,1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 offset_pos=pos+offsetTile;float ele=0.0;
#ifdef CROSS_SLOPE_VERTICAL
float top=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);float line_height=2.0*u_tile_to_meter*outset*top*u_pixels_to_tile_units[1][1]+a_z_offset;ele=sample_elevation(offset_pos)+line_height;projected_extrude=vec4(0);
#else
#ifdef CROSS_SLOPE_HORIZONTAL
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,max(ele1,ele2));ele=ele_max+a_z_offset;
#else
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,0.5*(ele1+ele2));ele=ele_max-ele0+ele1+a_z_offset;
#endif
#endif
gl_Position=u_matrix*vec4(offset_pos,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*u_zbias_factor*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifdef ELEVATED_ROADS
#ifdef RENDER_SHADOWS
vec3 shd_pos=vec3(pos+(offset2+dist)*u_pixels_to_tile_units,a_z_offset);vec3 shd_pos0=shd_pos;vec3 shd_pos1=shd_pos;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude_xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=mix(extrude_length_without_perspective/extrude_length_with_perspective,1.0,step(0.01,blur));
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
highp float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float line_progress=a_packed[2];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec3(a_uv_x,a_split_index*texel_height-half_texel_height,line_progress);
#else
v_uv=vec3(a_uv_x,0.0,line_progress);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/(floorwidth*u_floor_width_scale),(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=a_z_offset;
#endif
}`),linePattern:sr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform highp float u_device_pixel_ratio;uniform highp float u_width_scale;uniform highp float u_alpha_discard_threshold;uniform highp vec2 u_texsize;uniform highp float u_tile_units_to_pixels;uniform highp vec2 u_trim_offset;uniform highp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in highp float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec3 v_uv;
#endif
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef LINE_JOIN_NONE
in vec2 v_pattern_data;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
uniform float u_emissive_strength;
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define mediump float pixel_ratio
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize mediump float pixel_ratio
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;highp float pattern_size=display_size.x/u_tile_units_to_pixels;float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(u_width_scale*blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);highp float pattern_x=v_linesofar/pattern_size*aspect;highp float x=mod(pattern_x,1.0);highp float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;highp vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));highp vec2 lod_pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(pattern_x,y));vec4 color=textureLodCustom(u_image,pos,lod_pos);
#ifdef RENDER_LINE_TRIM_OFFSET
highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=v_uv[2];if (trim_end > trim_start) {highp float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/max(u_trim_fade_range[0],1.0e-9)));highp float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/max(u_trim_fade_range[1],1.0e-9)));highp float transition_factor=min(start_transition,end_transition);color=mix(color,color.a*u_trim_color,transition_factor);}
#endif
#ifdef LINE_JOIN_NONE
highp float pattern_len=pattern_size/aspect;highp float segment_phase=pattern_len-mod(v_linesofar-v_pattern_data.x+pattern_len,pattern_len);highp float visible_start=segment_phase-step(pattern_len*0.5,segment_phase)*pattern_len;highp float visible_end=floor((v_pattern_data.y-segment_phase)/pattern_len)*pattern_len+segment_phase;visible_end+=step(pattern_len*0.5,v_pattern_data.y-visible_end)*pattern_len;if (v_pattern_data.x < visible_start || v_pattern_data.x >=visible_end) {color=vec4(0.0);}
#endif
#ifdef LIGHTING_3D_MODE
color=apply_lighting_with_emission_ground(color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
color.rgb*=mix(v_road_z_offset > 0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=(alpha*opacity);if (u_alpha_discard_threshold !=0.0) {if (color.a < u_alpha_discard_threshold) {discard;}}
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,v_z_offset);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
in vec3 a_z_offset_width;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec3 a_packed;
#endif
in highp float a_linesofar;
#ifdef LINE_JOIN_NONE
in highp vec3 a_pattern_data;out vec2 v_pattern_data;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
uniform mat4 u_matrix;uniform float u_tile_units_to_pixels;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform float u_device_pixel_ratio;uniform float u_width_scale;uniform float u_floor_width_scale;
#ifdef ELEVATED
uniform lowp float u_zbias_factor;uniform lowp float u_tile_to_meter;float sample_elevation(vec2 apos) {
#ifdef ELEVATION_REFERENCE_SEA
return 0.0;
#else
return elevation(apos);
#endif
}
#endif
out vec2 v_normal;out vec2 v_width2;out highp float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
out highp vec3 v_uv;
#endif
#ifdef ELEVATED_ROADS
out highp float v_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
#pragma mapbox: define mediump float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define mediump float floorwidth
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define mediump float pixel_ratio
void main() {
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
#pragma mapbox: initialize mediump float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize mediump float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize mediump float pixel_ratio
float a_z_offset;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
a_z_offset=a_z_offset_width.x;
#endif
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=(u_width_scale*width)/2.0;offset=-1.0*offset*u_width_scale;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);vec2 dist=outset*a_extrude*scale;float u=0.5*a_direction;float t=1.0-abs(u);vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec2 extrude=dist*u_pixels_to_tile_units;vec4 projected_extrude=u_matrix*vec4(extrude,0.0,0.0);vec2 projected_extrude_xy=projected_extrude.xy;
#ifdef ELEVATED_ROADS
v_road_z_offset=a_z_offset;gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset,1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 offset_pos=pos+offsetTile;float ele=0.0;
#ifdef CROSS_SLOPE_VERTICAL
float top=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);float line_height=2.0*u_tile_to_meter*outset*top*u_pixels_to_tile_units[1][1]+a_z_offset;ele=sample_elevation(offset_pos)+line_height;projected_extrude=vec4(0);
#else
#ifdef CROSS_SLOPE_HORIZONTAL
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,max(ele1,ele2));ele=ele_max+a_z_offset;
#else
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,0.5*(ele1+ele2));ele=ele_max-ele0+ele1+a_z_offset;
#endif
#endif
gl_Position=u_matrix*vec4(offset_pos,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*u_zbias_factor*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifdef ELEVATED_ROADS
#ifdef RENDER_SHADOWS
vec3 shd_pos=vec3(pos+(offset2+dist)*u_pixels_to_tile_units,a_z_offset);vec3 shd_pos0=shd_pos;vec3 shd_pos1=shd_pos;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude_xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=mix(extrude_length_without_perspective/extrude_length_with_perspective,1.0,step(0.01,blur));
#else
v_gamma_scale=1.0;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
highp float a_uv_x=a_packed[0];highp float line_progress=a_packed[2];v_uv=vec3(a_uv_x,0.0,line_progress);
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=(floorwidth*u_floor_width_scale);
#ifdef LINE_JOIN_NONE
v_width=(floorwidth*u_floor_width_scale)+ANTIALIASING;mediump float pixels_to_tile_units=1.0/u_tile_units_to_pixels;mediump float pixel_ratio_inverse=1.0/pixel_ratio;mediump float aspect=v_width/((pattern.w-pattern.y)*pixel_ratio_inverse);highp float subt_multiple=(pattern.z-pattern.x)*pixel_ratio_inverse*pixels_to_tile_units*aspect*32.0;highp float subt=floor(a_pattern_data.z/subt_multiple)*subt_multiple;float offset_sign=(fract(a_pattern_data.x)-0.5)*4.0;float line_progress_offset=offset_sign*v_width*0.5*pixels_to_tile_units;v_linesofar=(a_pattern_data.z-subt)+a_linesofar+line_progress_offset;v_pattern_data=vec2(a_pattern_data.x+line_progress_offset,a_pattern_data.y);
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=a_z_offset;
#endif
}`),raster:sr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_raster_array.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;uniform highp float u_zoom_transition;in vec2 v_pos0;in vec2 v_pos1;in float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
in float v_split_fade;
#endif
uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;uniform float u_emissive_strength;
#ifndef RASTER_ARRAY
uniform highp sampler2D u_image0;uniform sampler2D u_image1;
#endif
#ifdef RASTER_COLOR
uniform sampler2D u_color_ramp;uniform highp vec4 u_colorization_mix;uniform highp float u_colorization_offset;uniform vec2 u_texture_res;
#endif
void main() {vec4 color0,color1,color;vec2 value;
#ifdef RASTER_COLOR
#ifdef RASTER_ARRAY
#ifdef RASTER_ARRAY_LINEAR
value=mix(
raTexture2D_image0_linear(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_linear(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#else
value=mix(
raTexture2D_image0_nearest(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_nearest(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#endif
if (value.y > 0.0) value.x/=value.y;
#else
color=mix(texture(u_image0,v_pos0),texture(u_image1,v_pos1),u_fade_t);value=vec2(u_colorization_offset+dot(color.rgb,u_colorization_mix.rgb),color.a);
#endif
color=texture(u_color_ramp,vec2(value.x,0.5));if (color.a > 0.0) color.rgb/=color.a;color.a*=value.y;
#else
color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);
#endif
color.a*=u_opacity;
#ifdef GLOBE_POLES
color.a*=1.0-smoothstep(0.0,0.05,u_zoom_transition);
#endif
vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),u_emissive_strength).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef PROJECTION_GLOBE_VIEW
glFragColor*=mix(1.0,1.0-smoothstep(0.0,0.05,u_zoom_transition),smoothstep(0.8,0.9,v_split_fade));
#endif
#ifdef RENDER_CUTOFF
glFragColor=glFragColor*cutoff_opacity(u_cutoff_params,v_depth);
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;uniform vec2 u_texture_offset;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;in vec2 a_texture_pos;
#endif
out vec2 v_pos0;out vec2 v_pos1;out float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
out float v_split_fade;
#endif
void main() {vec2 uv;
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;gl_Position=u_matrix*u_globe_matrix*vec4(globe_pos   ,1.0);uv=a_uv;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(a_globe_pos,1.0)).xyz);
#endif
#else
float w=1.0+dot(a_texture_pos,u_perspective_transform);uv=a_texture_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);    
v_split_fade=0.0;if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;float opposite_merc_center=mod(u_merc_center.x+0.5,1.0);float dist_from_poles=(abs(mercatorY-0.5)*2.0);float range=0.1;v_split_fade=abs(opposite_merc_center-mercatorX);v_split_fade=clamp(1.0-v_split_fade,0.0,1.0);v_split_fade=max(smoothstep(1.0-range,1.0,dist_from_poles),max(smoothstep(1.0-range,1.0,v_split_fade),smoothstep(1.0-range,1.0,1.0-v_split_fade)));}float tiles=u_grid_matrix[0][2];if (tiles > 0.0) {float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvY=mercatorY*tiles-idy;float uvX=mercatorX*tiles-idx;uv=vec2(uvX,uvY);}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;v_pos0=u_texture_offset.x+u_texture_offset.y*v_pos0;v_pos1=u_texture_offset.x+u_texture_offset.y*v_pos1;
#ifdef RENDER_CUTOFF
v_depth=gl_Position.z;
#endif
}`),rasterParticle:sr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;in vec2 v_pos0;in vec2 v_pos1;uniform sampler2D u_image0;uniform sampler2D u_image1;void main() {vec4 color0,color1,color;color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 out_color=color.rgb;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),0.0).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {float w=1.0;vec2 uv;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvX=mercatorX*tiles-idx;float uvY=mercatorY*tiles-idy;uv=vec2(uvX,uvY);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
uv=a_texture_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),rasterParticleDraw:sr("uniform sampler2D u_color_ramp;in float v_particle_speed;void main() {glFragColor=texture(u_color_ramp,vec2(v_particle_speed,0.5));}",`#include "_prelude_raster_particle.glsl"
in float a_index;uniform sampler2D u_particle_texture;uniform float u_particle_texture_side_len;uniform vec2 u_tile_offset;out float v_particle_speed;void main() {ivec2 pixel_coord=ivec2(
mod(a_index,u_particle_texture_side_len),a_index/u_particle_texture_side_len);vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);vec2 pos=unpack_pos_from_rgba(pixel)+u_tile_offset;vec2 tex_coord=fract(pos);vec2 velocity=lookup_velocity(tex_coord);if (velocity==INVALID_VELOCITY) {gl_Position=AWAY;v_particle_speed=0.0;} else {gl_Position=vec4(2.0*pos-1.0,0,1);v_particle_speed=length(velocity);}gl_PointSize=1.0;}`),rasterParticleTexture:sr("uniform sampler2D u_texture;uniform float u_opacity;in vec2 v_tex_pos;void main() {vec4 color=texture(u_texture,v_tex_pos);glFragColor=vec4(floor(255.0*color*u_opacity)/255.0);}","in vec2 a_pos;out vec2 v_tex_pos;void main() {vec2 uv=0.5*a_pos+vec2(0.5);v_tex_pos=uv;gl_Position=vec4(a_pos,0.0,1.0);}"),rasterParticleUpdate:sr(`#include "_prelude_raster_particle.glsl"
uniform sampler2D u_particle_texture;uniform mediump float u_particle_texture_side_len;uniform mediump float u_speed_factor;uniform highp float u_reset_rate;uniform highp float u_rand_seed;in highp vec2 v_tex_coord;vec2 linearstep(vec2 edge0,vec2 edge1,vec2 x) {return  clamp((x-edge0)/(edge1-edge0),vec2(0),vec2(1));}const highp vec3 rand_constants=vec3(12.9898,78.233,4375.85453);highp float rand(const highp vec2 co) {highp float t=dot(rand_constants.xy,co);return fract(sin(t)*(rand_constants.z+t));}void main() {ivec2 pixel_coord=ivec2(v_tex_coord*u_particle_texture_side_len);highp vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);highp vec2 pos=unpack_pos_from_rgba(pixel);highp vec2 velocity=lookup_velocity(clamp(pos,0.0,1.0));highp vec2 dp=velocity==INVALID_VELOCITY ? vec2(0) : velocity*u_speed_factor;pos=pos+dp;highp vec2 seed=(pos+v_tex_coord)*u_rand_seed;highp vec2 random_pos=vec2(rand(seed+1.3),rand(seed+2.1));highp vec2 persist_rate=pow(
linearstep(vec2(-u_particle_pos_offset),vec2(0),pos)*linearstep(vec2(1.0+u_particle_pos_offset),vec2(1),pos),vec2(4)
);highp vec2 per_frame_persist=pow(persist_rate,abs(dp)/u_particle_pos_offset);highp float drop_rate=1.0-per_frame_persist.x*per_frame_persist.y;drop_rate=any(greaterThanEqual(abs(pos-0.5),vec2(0.5+u_particle_pos_offset))) ? 1.0 : drop_rate;highp float drop=step(1.0-drop_rate-u_reset_rate,rand(seed));highp vec2 next_pos=mix(pos,random_pos,drop);glFragColor=pack_pos_to_rgba(next_pos);}`,"in vec2 a_pos;out vec2 v_tex_coord;void main() {v_tex_coord=0.5*(a_pos+vec2(1.0));gl_Position=vec4(a_pos,0.0,1.0);}"),symbol:sr(`#include "_prelude_lighting.glsl"
#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;uniform bool u_is_halo;uniform lowp float u_scale_factor;
#ifdef ICON_TRANSITION
uniform float u_icon_transition;
#endif
#ifdef COLOR_ADJUSTMENT
uniform mat4 u_color_adj_mat;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
in vec2 v_tex_a;
#ifdef ICON_TRANSITION
in vec2 v_tex_b;
#endif
in float v_draw_halo;in vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
in float is_sdf;in vec2 v_tex_a_icon;
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
vec4 out_color;float fade_opacity=v_gamma_scale_size_fade_opacity[2];
#ifdef RENDER_TEXT_AND_SYMBOL
if (is_sdf==ICON) {vec2 tex_icon=v_tex_a_icon;lowp float alpha=opacity*fade_opacity;glFragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
return;}
#endif
#ifdef RENDER_SDF
float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_gamma_scale_size_fade_opacity.x;float size=v_gamma_scale_size_fade_opacity.y;float fontScale=u_is_text ? size/24.0 : size;out_color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo=v_draw_halo > 0.0;if (draw_halo) {out_color=halo_color;gamma=(halo_blur*u_scale_factor*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width*u_scale_factor/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,v_tex_a).r;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);out_color*=alpha;
#else
#ifdef ICON_TRANSITION
vec4 a=texture(u_texture,v_tex_a)*(1.0-u_icon_transition);vec4 b=texture(u_texture,v_tex_b)*u_icon_transition;out_color=(a+b);
#else
out_color=texture(u_texture,v_tex_a);
#endif
#ifdef COLOR_ADJUSTMENT
out_color=u_color_adj_mat*out_color;
#endif
#endif
out_color*=opacity*fade_opacity;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_z_offset);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
in vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_pixeloffset;in vec4 a_projected_pos;in float a_fade_opacity;
#ifdef Z_OFFSET
in float a_auto_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_globe_anchor;in vec3 a_globe_normal;
#endif
#ifdef ICON_TRANSITION
in vec2 a_texb;
#endif
#ifdef OCCLUSION_QUERIES
in float a_occlusion_query_opacity;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_elevation_from_sea;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;uniform bool u_is_halo;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
out vec2 v_tex_a;
#ifdef ICON_TRANSITION
out vec2 v_tex_b;
#endif
out float v_draw_halo;out vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
out float is_sdf;out vec2 v_tex_a_icon;
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
#pragma mapbox: define lowp float occlusion_opacity
#pragma mapbox: define lowp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
#pragma mapbox: initialize lowp float occlusion_opacity
#pragma mapbox: initialize lowp float z_offset
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=u_elevation_from_sea ? z_offset : z_offset+elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_auto_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;vec3 world_pos_globe;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos_globe=a_globe_anchor+h;world_pos=mix_globe_mercator(world_pos_globe,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;vec2 a;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);vec4 projected_point_globe=u_matrix*vec4(world_pos_globe,1);a=projected_point_globe.xy/projected_point_globe.w;
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);a=projected_point.xy/projected_point.w;
#endif
vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
#ifdef PROJECTED_POS_ON_VIEWPORT
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xyz+h,1.0);
#else
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz,mercator_pos,u_zoom_transition)+h;projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);    
#endif
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
#ifdef Z_OFFSET
z+=u_pitch_with_map ? a_auto_z_offset+(u_elevation_from_sea ? z_offset : z_offset) : 0.0;
#else
z+=u_pitch_with_map ? (u_elevation_from_sea ? z_offset : z_offset) : 0.0;
#endif
float occlusion_fade=globe_occlusion_fade;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float out_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));
#ifdef DEPTH_OCCLUSION
float depth_occlusion=occlusionFadeMultiSample(projected_point);float depth_occlusion_multplier=mix(occlusion_opacity,1.0,depth_occlusion);out_fade_opacity*=depth_occlusion_multplier;
#endif
#ifdef OCCLUSION_QUERIES
float occludedFadeMultiplier=mix(occlusion_opacity,1.0,a_occlusion_query_opacity);out_fade_opacity*=occludedFadeMultiplier;
#endif
float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);
#endif
float gamma_scale=gl_Position.w;v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;v_gamma_scale_size_fade_opacity=vec3(gamma_scale,size,out_fade_opacity);v_tex_a=a_tex/u_texsize;
#ifdef RENDER_TEXT_AND_SYMBOL
is_sdf=a_size[0]-2.0*a_size_min;v_tex_a_icon=a_tex/u_texsize_icon;
#endif
#ifdef ICON_TRANSITION
v_tex_b=a_texb/u_texsize;
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=e;
#endif
}`),terrainRaster:sr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;in vec2 v_pos0;
#ifdef FOG
in float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#endif
uniform vec3 u_ground_shadow_factor;void main() {vec4 image_color=texture(u_image0,v_pos0);vec4 color;
#ifdef LIGHTING_3D_MODE
const vec3 normal=vec3(0.0,0.0,1.0);
#ifdef RENDER_SHADOWS
float cutoffOpacity=1.0;
#ifdef RENDER_CUTOFF
cutoffOpacity=cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w);
#endif
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
vec3 unlit_base=image_color.rgb*(1.0-image_color.a);vec3 emissive_base=image_color.rgb*image_color.a;float ndotl=u_shadow_direction.z;float occlusion=ndotl < 0.0 ? 1.0 : shadow_occlusion(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,0.0);ndotl=max(0.0,ndotl);vec3 lit=apply_lighting(unlit_base,normal,mix(1.0,(1.0-(u_shadow_intensity*occlusion))*ndotl,cutoffOpacity));vec3 emissive=compute_emissive_draped(emissive_base,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=lit+emissive;color.a=1.0;
#else
float lighting_factor=shadowed_light_factor_normal_unbiased(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);color=apply_lighting(image_color,normal,mix(1.0,lighting_factor,cutoffOpacity));
#endif
#else
float lighting_factor=u_lighting_directional_dir.z;color=apply_lighting(image_color,normal,lighting_factor);
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color.rgb=mix(color.rgb,image_color.rgb,image_color.a);color.a=1.0;
#endif
#endif
#else
color=image_color;
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_skirt_height;in vec2 a_pos;out vec2 v_pos0;
#ifdef FOG
out float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;out float v_depth;
#endif
void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);
#endif
}`),terrainDepth:sr("precision highp float;in float v_depth;void main() {glFragColor=pack_depth(v_depth);}",`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;out float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}`),skybox:sr(`#include "_prelude_fog.fragment.glsl"
in lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=texture(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color+=0.1*sun_disk(v_uv,u_sun_direction);glFragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,fc),skyboxGradient:sr(`#include "_prelude_fog.fragment.glsl"
in highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,fc),skyboxCapture:sr(`
in highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;precision highp float;
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;glFragColor=vec4(color,1.0);}`,"in highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;out highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:sr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;uniform float u_far_z_cutoff;in vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;highp float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);highp float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
raster=apply_lighting_with_emission_ground(raster,raster.a);color=vec4(clamp(raster.rgb,vec3(0),vec3(1))*antialias,antialias);
#else
raster=apply_lighting_ground(raster);color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color=apply_lighting_with_emission_ground(color,color.a);color.a=1.0;
#else
color=apply_lighting_ground(color);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=1.0-step(u_far_z_cutoff,1.0/gl_FragCoord.w);glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;
#endif
out vec2 v_pos0;void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:sr(`#include "_prelude_fog.fragment.glsl"
uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec4 u_color;uniform vec4 u_high_color;uniform vec4 u_space_color;uniform float u_horizon_angle;in highp vec3 v_ray_dir;in highp vec3 v_horizon_dir;void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {
#ifdef ALPHA_PASS
glFragColor=vec4(0,0,0,0);return;
#else
#ifdef NATIVE
glFragColor=vec4(1,1,1,1);
#else
glFragColor=vec4(0,0,0,1);
#endif
return;
#endif
}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(clamp(dot(dir,horizon_dir),-1.0,1.0)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;highp float closest_point_to_center=length(closest_point-u_globe_pos);highp float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;
#ifdef ALPHA_PASS
float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);glFragColor=vec4(1.0,1.0,1.0,a);
#else
vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c=c2;glFragColor=vec4(c*t,t);
#endif
}`,`in vec3 a_pos;in vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;out highp vec3 v_ray_dir;out highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`),model:sr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_opacity;uniform vec3 u_lightcolor;uniform vec3 u_lightpos;uniform float u_lightintensity;uniform vec4 u_baseColorFactor;uniform vec4 u_emissiveFactor;uniform float u_metallicFactor;uniform float u_roughnessFactor;uniform float u_emissive_strength;in highp vec4 v_position_height;in lowp vec4 v_color_mix;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth_shadows;
#endif
#ifdef OCCLUSION_TEXTURE_TRANSFORM
uniform vec4 u_occlusionTextureTransform;
#endif
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#ifdef HAS_ATTRIBUTE_a_pbr
in lowp vec4 v_roughness_metallic_emissive_alpha;in mediump vec4 v_height_based_emission_params;
#endif
#ifdef HAS_TEXTURE_u_baseColorTexture
uniform sampler2D u_baseColorTexture;uniform bool u_baseTextureIsAlpha;uniform bool u_alphaMask;uniform float u_alphaCutoff;
#endif
#ifdef HAS_TEXTURE_u_metallicRoughnessTexture
uniform sampler2D u_metallicRoughnessTexture;
#endif
#ifdef HAS_TEXTURE_u_occlusionTexture
uniform sampler2D u_occlusionTexture;uniform float u_aoIntensity;
#endif
#ifdef HAS_TEXTURE_u_normalTexture
uniform sampler2D u_normalTexture;
#endif
#ifdef HAS_TEXTURE_u_emissionTexture
uniform sampler2D u_emissionTexture;
#endif
#ifdef APPLY_LUT_ON_GPU
uniform highp sampler3D u_lutTexture;
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
in highp float v_depth;uniform highp sampler2D u_depthTexture;uniform highp vec2 u_inv_depth_size;uniform highp vec2 u_depth_range_unpack;
#ifdef DEPTH_D24
highp float unpack_depth(highp float depth) {return  depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}
#else
highp float unpack_depth_rgba(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded() {highp vec2 coord=gl_FragCoord.xy*u_inv_depth_size;
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depthTexture,coord).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depthTexture,coord));
#endif
return v_depth > depth+0.0005;}
#endif
#define saturate(_x) clamp(_x,0.,1.)
vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}float calculate_NdotL(vec3 normal,vec3 lightDir) {const float ext=0.70710678118;return (clamp(dot(normal,lightDir),-ext,1.0)+ext)/(1.0+ext);}vec3 getDiffuseShadedColor(vec3 albedo,vec3 normal,vec3 lightDir,vec3 lightColor)
{
#ifdef LIGHTING_3D_MODE
vec3 transformed_normal=vec3(-normal.xy,normal.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=saturate(dot(transformed_normal,u_lighting_directional_dir));
#endif
return apply_lighting(albedo,transformed_normal,lighting_factor);
#else
vec3 n=normal;float colorvalue=((albedo.x*0.2126)+(albedo.y*0.7152))+(albedo.z*0.0722);vec3 c=vec3(0.03,0.03,0.03);float directional=clamp(dot(n,vec3(lightDir)),0.0,1.0);directional=mix(1.0-u_lightintensity,max((1.0-colorvalue)+u_lightintensity,1.0),directional);vec3 c3=c+clamp((albedo*directional)*lightColor,mix(vec3(0.0),vec3(0.3),vec3(1.0)-lightColor),vec3(1.0));return c3;
#endif
}vec4 getBaseColor() {vec4 albedo=u_baseColorFactor;
#ifdef HAS_ATTRIBUTE_a_color_3f
albedo*=vec4(color_3f,1.0);
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#else
#ifdef HAS_ATTRIBUTE_a_color_4f
albedo*=color_4f;
#endif
#endif
#if defined (HAS_TEXTURE_u_baseColorTexture) && defined (HAS_ATTRIBUTE_a_uv_2f)
vec4 texColor=texture(u_baseColorTexture,uv_2f);if(u_alphaMask) {if (texColor.w < u_alphaCutoff) {discard;}}
#ifdef UNPREMULT_TEXTURE_IN_SHADER
if(texColor.w > 0.0) {texColor.rgb/=texColor.w;}texColor.w=1.0;
#endif
if(u_baseTextureIsAlpha) {if (texColor.r < 0.5) {discard;}} else {texColor.rgb=sRGBToLinear(texColor.rgb);albedo*=texColor;}
#endif
vec4 color=vec4(mix(albedo.rgb,v_color_mix.rgb,v_color_mix.a),albedo.a);
#ifdef APPLY_LUT_ON_GPU
color=applyLUT(u_lutTexture,color);
#endif
return color;}highp mat3 cotangentFrame(highp vec3 N,highp vec3 p,highp vec2 uv ) {
#ifdef HAS_TEXTURE_u_normalTexture
highp vec3 dp1=vec3(dFdx(p.x),dFdx(p.y),dFdx(p.z));highp vec3 dp2=vec3(dFdy(p.x),dFdy(p.y),dFdy(p.z));highp vec2 duv1=vec2(dFdx(uv.x),dFdx(uv.y));highp vec2 duv2=vec2(dFdy(uv.x),dFdy(uv.y));highp vec3 dp2perp=cross( dp2,N );highp vec3 dp1perp=cross( N,dp1 );highp vec3 T=dp2perp*duv1.x+dp1perp*duv2.x;highp vec3 B=dp2perp*duv1.y+dp1perp*duv2.y;highp float lengthT=dot(T,T);highp float lengthB=dot(B,B);highp float maxLength=max(lengthT,lengthB);highp float invmax=inversesqrt( maxLength );highp mat3 res=mat3( T*invmax,B*invmax,N );return res;
#else
return mat3(1.0);
#endif
}highp vec3 getNormal(){highp vec3 n;
#ifdef HAS_ATTRIBUTE_a_normal_3f
n=normalize(normal_3f);
#else
highp vec3 fdx=vec3(dFdx(v_position_height.x),dFdx(v_position_height.y),dFdx(v_position_height.z));highp vec3 fdy=vec3(dFdy(v_position_height.x),dFdy(v_position_height.y),dFdy(v_position_height.z));n=normalize(cross(fdx,fdy))*-1.0;
#endif
#if defined(HAS_TEXTURE_u_normalTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
vec3 nMap=texture( u_normalTexture,uv_2f).xyz;nMap=normalize(2.0*nMap-vec3(1.0));highp vec3 v=normalize(-v_position_height.xyz);highp mat3 TBN=cotangentFrame(n,v,uv_2f);n=normalize(TBN*nMap);
#endif
return n;}struct Material {float perceptualRoughness;float alphaRoughness;float metallic;vec3 f90;vec4 baseColor;vec3 diffuseColor;vec3 specularColor;highp vec3 normal;};Material getPBRMaterial() {Material mat;mat.baseColor=getBaseColor();mat.perceptualRoughness=u_roughnessFactor;mat.metallic=u_metallicFactor;
#ifdef HAS_ATTRIBUTE_a_pbr
mat.perceptualRoughness=v_roughness_metallic_emissive_alpha.x;mat.metallic=v_roughness_metallic_emissive_alpha.y;mat.baseColor.w*=v_roughness_metallic_emissive_alpha.w;
#endif
#if defined(HAS_TEXTURE_u_metallicRoughnessTexture) && defined(HAS_ATTRIBUTE_a_uv_2f) 
vec4 mrSample=texture(u_metallicRoughnessTexture,uv_2f);mat.perceptualRoughness*=mrSample.g;mat.metallic*=mrSample.b;
#endif
const float c_minRoughness=0.04;mat.perceptualRoughness=clamp(mat.perceptualRoughness,c_minRoughness,1.0);mat.metallic=saturate(mat.metallic);mat.alphaRoughness=mat.perceptualRoughness*mat.perceptualRoughness;const vec3 f0=vec3(0.04);mat.diffuseColor=mat.baseColor.rgb*(vec3(1.0)-f0);mat.diffuseColor*=1.0-mat.metallic;mat.specularColor=mix(f0,mat.baseColor.rgb,mat.metallic);highp float reflectance=max(max(mat.specularColor.r,mat.specularColor.g),mat.specularColor.b);highp float reflectance90=saturate(reflectance*25.0);mat.f90=vec3(reflectance90);mat.normal=getNormal();return mat;}float V_GGX(float NdotL,float NdotV,float roughness)
{float a2=roughness*roughness;float GGXV=NdotL*sqrt(NdotV*NdotV*(1.0-a2)+a2);float GGXL=NdotV*sqrt(NdotL*NdotL*(1.0-a2)+a2);return 0.5/(GGXV+GGXL);}float V_GGXFast(float NdotL,float NdotV,float roughness) {float a=roughness;float GGXV=NdotL*(NdotV*(1.0-a)+a);float GGXL=NdotV*(NdotL*(1.0-a)+a);return 0.5/(GGXV+GGXL);}vec3 F_Schlick(vec3 specularColor,vec3 f90,float VdotH)
{return specularColor+(f90-specularColor)*pow(clamp(1.0-VdotH,0.0,1.0),5.0);}vec3 F_SchlickFast(vec3 specularColor,float VdotH)
{float x=1.0-VdotH;float x4=x*x*x*x;return specularColor+(1.0-specularColor)*x4*x;}float D_GGX(highp float NdotH,float alphaRoughness)
{highp float a4=alphaRoughness*alphaRoughness;highp float f=(NdotH*a4-NdotH)*NdotH+1.0;return a4/(PI*f*f);}vec3 diffuseBurley(Material mat,float LdotH,float NdotL,float NdotV)
{float f90=2.0*LdotH*LdotH*mat.alphaRoughness-0.5;return (mat.diffuseColor/PI)*(1.0+f90*pow((1.0-NdotL),5.0))*(1.0+f90*pow((1.0-NdotV),5.0));}vec3 diffuseLambertian(Material mat)
{
#ifdef LIGHTING_3D_MODE
return mat.diffuseColor;
#else
return mat.diffuseColor/PI;
#endif
}vec3 EnvBRDFApprox(vec3 specularColor,float roughness,highp float NdotV)
{vec4 c0=vec4(-1,-0.0275,-0.572,0.022);vec4 c1=vec4(1,0.0425,1.04,-0.04);highp vec4 r=roughness*c0+c1;highp float a004=min(r.x*r.x,exp2(-9.28*NdotV))*r.x+r.y;vec2 AB=vec2(-1.04,1.04)*a004+r.zw;return specularColor*AB.x+AB.y;}vec3 computeIndirectLightContribution(Material mat,float NdotV,vec3 normal)
{vec3 env_light=vec3(0.65,0.65,0.65);
#ifdef LIGHTING_3D_MODE
float ambient_factor=calculate_ambient_directional_factor(normal);env_light=u_lighting_ambient_color*ambient_factor;
#endif
vec3 envBRDF=EnvBRDFApprox(mat.specularColor,mat.perceptualRoughness,NdotV);vec3 indirectSpecular= envBRDF*env_light;vec3 indirectDiffuse=mat.diffuseColor*env_light;return indirectSpecular+indirectDiffuse;}vec3 computeLightContribution(Material mat,vec3 lightPosition,vec3 lightColor)
{highp vec3 n=mat.normal;highp vec3 v=normalize(-v_position_height.xyz);highp vec3 l=normalize(lightPosition);highp vec3 h=normalize(v+l);float NdotV=clamp(abs(dot(n,v)),0.001,1.0);float NdotL=saturate(dot(n,l));highp float NdotH=saturate(dot(n,h));float VdotH=saturate(dot(v,h));vec3 f=F_SchlickFast(mat.specularColor,VdotH);float g=V_GGXFast(NdotL,NdotV,mat.alphaRoughness);float d=D_GGX(NdotH,mat.alphaRoughness);vec3 diffuseTerm=(1.0-f)*diffuseLambertian(mat);vec3 specularTerm=f*g*d;vec3 transformed_normal=vec3(-n.xy,n.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=NdotL;
#endif
vec3 directLightColor=(specularTerm+diffuseTerm)*lighting_factor*lightColor;vec3 indirectLightColor=computeIndirectLightContribution(mat,NdotV,transformed_normal);vec3 color=(saturate(directLightColor)+indirectLightColor);float intensityFactor=1.0;
#if !defined(LIGHTING_3D_MODE)
const vec3 luminosityFactor=vec3(0.2126,0.7152,0.0722);float luminance=dot(diffuseTerm,luminosityFactor);intensityFactor=mix((1.0-u_lightintensity),max((1.0-luminance+u_lightintensity),1.0),NdotL);
#endif
color*=intensityFactor;return color;}void main() {
#ifdef TERRAIN_FRAGMENT_OCCLUSION
if (isOccluded()) {discard;}
#endif
vec3 lightDir=u_lightpos;vec3 lightColor=u_lightcolor;
#ifdef LIGHTING_3D_MODE
lightDir=u_lighting_directional_dir;lightDir.xy=-lightDir.xy;lightColor=u_lighting_directional_color;
#endif
vec4 finalColor;
#ifdef DIFFUSE_SHADED
vec3 N=getNormal();vec3 baseColor=getBaseColor().rgb;vec3 diffuse=getDiffuseShadedColor(baseColor,N,lightDir,lightColor);
#ifdef HAS_TEXTURE_u_occlusionTexture
float ao=(texture(u_occlusionTexture,uv_2f).r-1.0)*u_aoIntensity+1.0;diffuse*=ao;
#endif
finalColor=vec4(mix(diffuse,baseColor,u_emissive_strength),1.0)*u_opacity;
#else
Material mat=getPBRMaterial();vec3 color=computeLightContribution(mat,lightDir,lightColor);float ao=1.0;
#if defined (HAS_TEXTURE_u_occlusionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
#ifdef OCCLUSION_TEXTURE_TRANSFORM
vec2 uv=uv_2f.xy*u_occlusionTextureTransform.zw+u_occlusionTextureTransform.xy;
#else
vec2 uv=uv_2f;
#endif
ao=(texture(u_occlusionTexture,uv).x-1.0)*u_aoIntensity+1.0;color*=ao;
#endif
vec4 emissive=u_emissiveFactor;
#if defined(HAS_TEXTURE_u_emissionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
emissive.rgb*=sRGBToLinear(texture(u_emissionTexture,uv_2f).rgb);
#endif
#ifdef APPLY_LUT_ON_GPU
float emissiveFactorLength=max(length(u_emissiveFactor.rgb),0.001);emissive.rgb=sRGBToLinear(applyLUT(u_lutTexture,linearTosRGB(emissive.rgb/emissiveFactorLength).rbg))*emissiveFactorLength;
#endif
color+=emissive.rgb;float opacity=mat.baseColor.w*u_opacity;
#ifdef HAS_ATTRIBUTE_a_pbr
float resEmission=v_roughness_metallic_emissive_alpha.z;resEmission*=v_height_based_emission_params.z+v_height_based_emission_params.w*pow(clamp(v_height_based_emission_params.x,0.0,1.0),v_height_based_emission_params.y);vec3 color_mix=v_color_mix.rgb;
#ifdef APPLY_LUT_ON_GPU
color_mix=applyLUT(u_lutTexture,color_mix);
#endif
color=mix(color,color_mix,min(1.0,resEmission));
#ifdef HAS_ATTRIBUTE_a_color_4f
float distance=length(vec2(1.3*max(0.0,abs(color_4f.x)-color_4f.z),color_4f.y));distance+= mix(0.5,0.0,clamp(resEmission-1.0,0.0,1.0));opacity*=v_roughness_metallic_emissive_alpha.w*saturate(1.0-distance*distance);
#endif
#endif
vec3 unlitColor=mat.baseColor.rgb*ao+emissive.rgb;color=mix(color,unlitColor,u_emissive_strength);color=linearTosRGB(color);color*=opacity;finalColor=vec4(color,opacity);
#endif
#ifdef FOG
finalColor=fog_dither(fog_apply_premultiplied(finalColor,v_fog_pos,v_position_height.w));
#endif
#ifdef RENDER_CUTOFF
finalColor*=v_cutoff_opacity;
#endif
#ifdef INDICATOR_CUTOUT
finalColor=applyCutout(finalColor,v_position_height.w);
#endif
glFragColor=finalColor;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec3 a_pos_3f;
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute-vertex-shader-only highp vec4 pbr
#pragma mapbox: define-attribute-vertex-shader-only highp vec3 heightBasedEmissiveStrength
uniform mat4 u_matrix;uniform mat4 u_node_matrix;uniform mat4 u_lighting_matrix;uniform vec3 u_camera_pos;uniform vec4 u_color_mix;
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_normal_matrix;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth_shadows;
#endif
out vec4 v_position_height;out lowp vec4 v_color_mix;
#ifdef TERRAIN_FRAGMENT_OCCLUSION
out highp float v_depth;
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
out lowp vec4 v_roughness_metallic_emissive_alpha;out mediump vec4 v_height_based_emission_params;
#endif
vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}void main() {
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute-custom highp vec4 pbr
#pragma mapbox: initialize-attribute-custom highp vec3 heightBasedEmissiveStrength
highp mat4 normal_matrix;
#ifdef INSTANCED_ARRAYS
normal_matrix=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
normal_matrix=u_normal_matrix;
#endif
vec3 local_pos;mat3 rs;
#ifdef MODEL_POSITION_ON_GPU
vec3 pos_color=normal_matrix[0].xyz;vec4 translate=normal_matrix[1];vec3 pos_a=floor(pos_color);vec3 rgb=1.05*(pos_color-pos_a);float hidden=float(pos_a.x > EXTENT);float color_mix=pos_a.z/100.0;v_color_mix=vec4(sRGBToLinear(rgb),color_mix);float meter_to_tile=normal_matrix[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);rs[0].x=normal_matrix[1].w;rs[0].yz=normal_matrix[2].xy;rs[1].xy=normal_matrix[2].zw;rs[1].z=normal_matrix[3].x;rs[2].xyz=normal_matrix[3].yzw;vec4 pos_node=u_lighting_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;local_pos=pos.xyz;gl_Position=mix(u_matrix*pos,AWAY,hidden);pos.z*=meter_to_tile;v_position_height.xyz=pos.xyz-u_camera_pos;
#else
local_pos=a_pos_3f;gl_Position=u_matrix*vec4(a_pos_3f,1);v_position_height.xyz=vec3(u_lighting_matrix*vec4(a_pos_3f,1));v_color_mix=vec4(sRGBToLinear(u_color_mix.rgb),u_color_mix.a);
#endif
v_position_height.w=a_pos_3f.z;
#ifdef HAS_ATTRIBUTE_a_pbr
vec4 albedo_c=decode_color(pbr.xy);vec2 e_r_m=unpack_float(pbr.z);vec2 r_m= unpack_float(e_r_m.y*16.0);r_m.r=r_m.r*16.0;v_color_mix=vec4(albedo_c.rgb,1.0);v_roughness_metallic_emissive_alpha=vec4(vec3(r_m,e_r_m.x)/255.0,albedo_c.a);v_roughness_metallic_emissive_alpha.z*=2.0;float heightBasedRelativeIntepolation=a_pos_3f.z*heightBasedEmissiveStrength.x+heightBasedEmissiveStrength.y;v_height_based_emission_params.x=heightBasedRelativeIntepolation;v_height_based_emission_params.y=heightBasedEmissiveStrength.z;vec2 emissionMultiplierValues=unpack_float(pbr.w)/256.0;v_height_based_emission_params.z=emissionMultiplierValues.x;v_height_based_emission_params.w=emissionMultiplierValues.y-emissionMultiplierValues.x;
#endif
#ifdef FOG
v_fog_pos=fog_position(local_pos);
#endif
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
float x_squared_scale=dot(rs[0],rs[0]);float y_squared_scale=dot(rs[1],rs[1]);float z_squared_scale=dot(rs[2],rs[2]);vec3 squared_scale=vec3(x_squared_scale,y_squared_scale,z_squared_scale);normal_3f=rs*((u_lighting_matrix*vec4(normal_3f,0.0)).xyz/squared_scale);normal_3f=normalize(normal_3f);
#else
normal_3f=vec3(normal_matrix*vec4(normal_3f,0));
#endif
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#ifdef HAS_ATTRIBUTE_a_color_4f
v_roughness_metallic_emissive_alpha.w=clamp(color_4f.a*v_roughness_metallic_emissive_alpha.w*(v_roughness_metallic_emissive_alpha.z-1.0),0.0,1.0);
#endif
#endif
#ifdef RENDER_SHADOWS
vec4 shadow_pos=u_node_matrix*vec4(local_pos,1.0);
#ifdef NORMAL_OFFSET
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
vec3 offset=shadow_normal_offset(vec3(-normal_3f.xy,normal_3f.z));shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#else
vec3 offset=shadow_normal_offset_model(normal_3f);shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#endif
#endif
#endif
v_pos_light_view_0=u_light_matrix_0*shadow_pos;v_pos_light_view_1=u_light_matrix_1*shadow_pos;v_depth_shadows=gl_Position.w;
#endif
}`),modelDepth:sr(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`in vec3 a_pos_3f;uniform mat4 u_matrix;out highp float v_depth;
#ifdef MODEL_POSITION_ON_GPU
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_instance;
#endif
uniform highp mat4 u_node_matrix;
#endif
void main() {
#ifdef MODEL_POSITION_ON_GPU
highp mat4 instance;
#ifdef INSTANCED_ARRAYS
instance=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
instance=u_instance;
#endif
vec3 pos_color=instance[0].xyz;vec4 translate=instance[1];vec3 pos_a=floor(pos_color);float hidden=float(pos_a.x > EXTENT);float meter_to_tile=instance[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);mat3 rs;rs[0].x=instance[1].w;rs[0].yz=instance[2].xy;rs[1].xy=instance[2].zw;rs[1].z=instance[3].x;rs[2].xyz=instance[3].yzw;vec4 pos_node=u_node_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;gl_Position=mix(u_matrix*pos,AWAY,hidden);
#else
gl_Position=u_matrix*vec4(a_pos_3f,1);
#endif
v_depth=gl_Position.z/gl_Position.w;}`),stars:sr(`in highp vec2 v_uv;in mediump float v_intensity;float shapeCircle(in vec2 uv)
{float beginFade=0.6;float lengthFromCenter=length(v_uv);return 1.0-clamp((lengthFromCenter-beginFade)/(1.0-beginFade),0.0,1.0);}void main() {float alpha=shapeCircle(v_uv);vec3 color=vec3(1.0,1.0,1.0);alpha*=v_intensity;glFragColor=vec4(color*alpha,alpha);HANDLE_WIREFRAME_DEBUG;}`,`
in vec3 a_pos_3f;in vec2 a_uv;in float a_size_scale;in float a_fade_opacity;uniform mat4 u_matrix;uniform vec3 u_up;uniform vec3 u_right;uniform float u_intensity_multiplier;out highp vec2 v_uv;out mediump float v_intensity;void main() {v_uv=a_uv;v_intensity=a_fade_opacity*u_intensity_multiplier;vec3 pos=a_pos_3f;pos+=a_uv.x*u_right*a_size_scale;pos+=a_uv.y*u_up*a_size_scale;gl_Position=u_matrix*vec4(pos,1.0);}`),snowParticle:sr("in highp vec2 uv;in highp float alphaMultiplier;uniform vec4 u_particleColor;uniform vec2 u_simpleShapeParameters;void main() {float t=clamp((length(uv)-u_simpleShapeParameters.x)/(1.0-u_simpleShapeParameters.x),0.0,1.0);float alpha=1.0-pow(t,pow(10.0,u_simpleShapeParameters.y));alpha*=alphaMultiplier;alpha*=u_particleColor.a;vec3 color=u_particleColor.rgb*alpha;glFragColor=vec4(color,alpha) ;HANDLE_WIREFRAME_DEBUG;}",`
in highp vec3 a_pos_3f;in highp vec2 a_uv;in highp vec4 a_snowParticleData;in highp vec4 a_snowParticleDataHorizontalOscillation;uniform mat4 u_modelview;uniform mat4 u_projection;uniform vec3 u_cam_pos;uniform vec2 u_screenSize;uniform float u_time;uniform float u_boxSize;uniform float u_velocityConeAperture; 
uniform float u_velocity;uniform vec3 u_direction;uniform float u_horizontalOscillationRadius; 
uniform float u_horizontalOscillationRate; 
uniform float u_billboardSize;uniform vec2 u_thinningCenterPos;uniform vec3 u_thinningShape;uniform float u_thinningAffectedRatio;uniform float u_thinningParticleOffset;out highp vec2 uv;out highp float alphaMultiplier;void main() {vec3 pos=a_pos_3f;float halfBoxSize=0.5*u_boxSize;pos.xyz*=halfBoxSize;pos+=u_cam_pos;float velocityConeApertureRad=radians(u_velocityConeAperture*0.5);float coneAnglePichRad=velocityConeApertureRad*a_snowParticleData.z;float coneAngleHeadingRad=a_snowParticleData.w*radians(360.0);vec3 localZ=normalize(u_direction);vec3 localX=normalize(cross(localZ,vec3(1,0,0)));vec3 localY=normalize(cross(localZ,localX));vec3 direction;direction.x=cos(coneAngleHeadingRad)*sin(coneAnglePichRad);direction.y=sin(coneAngleHeadingRad)*sin(coneAnglePichRad);direction.z=cos(coneAnglePichRad);direction=normalize(direction);vec3 simPosLocal=vec3(0,0,0);float velocityScale=(1.0+3.0*a_snowParticleData.y)*u_velocity;simPosLocal+=direction*velocityScale*u_time;float horizontalOscillationRadius=u_horizontalOscillationRadius*a_snowParticleDataHorizontalOscillation.x;float horizontalOscillationAngle=u_horizontalOscillationRate*u_time*(-1.0+2.0*a_snowParticleDataHorizontalOscillation.y);simPosLocal.xy+=horizontalOscillationRadius*vec2(cos(horizontalOscillationAngle),sin(horizontalOscillationAngle));vec3 simPos=localX*simPosLocal.x+
localY*simPosLocal.y+localZ*simPosLocal.z;pos+=simPos;pos=fract((pos+vec3(halfBoxSize))/vec3(u_boxSize))*u_boxSize-vec3(halfBoxSize);float clipZ=-u_cam_pos.z+pos.z;vec4 posView=u_modelview*vec4(pos,1.0);float size=u_billboardSize;alphaMultiplier=1.0;vec4 posScreen=u_projection*posView;posScreen/=posScreen.w;posScreen.xy=vec2(0.5)+posScreen.xy*0.5;posScreen.xy*=u_screenSize;vec2 thinningCenterPos=u_thinningCenterPos.xy;thinningCenterPos.y=u_screenSize.y-thinningCenterPos.y;float screenDist=length((thinningCenterPos-posScreen.xy)/(0.5*u_screenSize));screenDist+=a_snowParticleData.x*u_thinningParticleOffset;float scaleFactorMode=0.0;float thinningShapeDist=u_thinningShape.x+u_thinningShape.y;if (screenDist < thinningShapeDist) {float thinningFadeRatio=clamp((screenDist-u_thinningShape.x)/u_thinningShape.y,0.0,1.0);thinningFadeRatio=pow(thinningFadeRatio,u_thinningShape.z);if (a_snowParticleData.x < u_thinningAffectedRatio) {scaleFactorMode=1.0-thinningFadeRatio;alphaMultiplier=thinningFadeRatio;}}vec4 posScreen1=u_projection*vec4(posView.x-size,posView.yzw);posScreen1/=posScreen1.w;vec4 posScreen2=u_projection*vec4(posView.x+size,posView.yzw);posScreen2/=posScreen2.w;posScreen1.xy=vec2(0.5)+posScreen1.xy*0.5;posScreen1.xy*=u_screenSize;posScreen2.xy=vec2(0.5)+posScreen2.xy*0.5;posScreen2.xy*=u_screenSize;float screenLength=length(posScreen1.xy-posScreen2.xy);float screenEpsilon=3.0;float scaleFactor=1.0;if (screenLength < screenEpsilon) {scaleFactor=screenEpsilon/max(screenLength,0.01);scaleFactor=mix(scaleFactor,1.0,scaleFactorMode);}float screenEpsilon2=15.0;if (screenLength > screenEpsilon2) {scaleFactor=screenEpsilon2/max(screenLength,0.01);}size*=scaleFactor;vec2 right=size*vec2(1,0);vec2 up=size*vec2(0,1);posView.xy+=right*a_uv.x;posView.xy+=up*a_uv.y;uv=a_uv;gl_Position=u_projection*posView;}`),rainParticle:sr("in highp vec2 uv;in highp float particleRandomValue;uniform sampler2D u_texScreen;uniform float u_distortionStrength;uniform vec4 u_color;uniform vec2 u_thinningCenterPos;uniform vec3 u_thinningShape;uniform float u_thinningAffectedRatio;uniform float u_thinningParticleOffset;uniform float u_shapeDirectionalPower;uniform float u_mode;void main() {vec2 st=uv*0.5+vec2(0.5);vec2 uvm=uv;uvm.y=-1.0+2.0*pow(st.y,u_shapeDirectionalPower);float shape=clamp(1.0-length(uvm),0.0,1.0);float alpha=abs(shape)*u_color.a;vec2 screenSize=vec2(textureSize(u_texScreen,0));vec2 thinningCenterPos=u_thinningCenterPos.xy;thinningCenterPos.y=screenSize.y-thinningCenterPos.y;float screenDist=length((thinningCenterPos-gl_FragCoord.xy)/(0.5*screenSize));screenDist+=(0.5+0.5*particleRandomValue)*u_thinningParticleOffset;float thinningShapeDist=u_thinningShape.x+u_thinningShape.y;float thinningAlpha=1.0;if (screenDist < thinningShapeDist) {float thinningFadeRatio=clamp((screenDist-u_thinningShape.x)/u_thinningShape.y,0.0,1.0);thinningFadeRatio=pow(thinningFadeRatio,u_thinningShape.z);thinningAlpha*=thinningFadeRatio;}vec2 offsetXY=normalize(uvm)*abs(shape);vec2 stScreen=(gl_FragCoord.xy+offsetXY*u_distortionStrength*thinningAlpha)/screenSize;vec3 colorScreen=texture(u_texScreen,stScreen).rgb;alpha*=thinningAlpha;glFragColor=mix(vec4(colorScreen,1.0),vec4(u_color.rgb*alpha,alpha),u_mode);HANDLE_WIREFRAME_DEBUG;}",`
in highp vec3 a_pos_3f;in highp vec2 a_uv;in highp vec4 a_rainParticleData;uniform mat4 u_modelview;uniform mat4 u_projection;uniform vec3 u_cam_pos;uniform float u_time;uniform float u_boxSize;uniform float u_velocityConeAperture; 
uniform float u_velocity; 
uniform vec2 u_rainDropletSize;uniform vec3 u_rainDirection;out highp vec2 uv;out highp float particleRandomValue;void main() {vec3 pos=a_pos_3f;float halfBoxSize=0.5*u_boxSize;pos*=halfBoxSize; 
pos+=u_cam_pos;float velocityConeApertureRad=radians(u_velocityConeAperture*0.5);float coneAnglePichRad=velocityConeApertureRad*a_rainParticleData.z;float coneAngleHeadingRad=a_rainParticleData.w*radians(360.0);vec3 localZ=normalize(u_rainDirection);vec3 localX=normalize(cross(localZ,vec3(1,0,0)));vec3 localY=normalize(cross(localZ,localX));vec3 directionLocal;directionLocal.x=cos(coneAngleHeadingRad)*sin(coneAnglePichRad);directionLocal.y=sin(coneAngleHeadingRad)*sin(coneAnglePichRad);directionLocal.z=cos(coneAnglePichRad);directionLocal=normalize(directionLocal);vec3 directionWorld=localX*directionLocal.x+localY*directionLocal.y+localZ*directionLocal.z;float velocityScale=(1.0+3.0*a_rainParticleData.y)*u_velocity;vec3 simPosLocal=vec3(0,0,0);simPosLocal+=directionLocal*velocityScale*u_time;vec3 simPos=localX*simPosLocal.x+
localY*simPosLocal.y+localZ*simPosLocal.z;pos+=simPos;pos=fract((pos+vec3(halfBoxSize))/vec3(u_boxSize))*u_boxSize-vec3(halfBoxSize);vec4 posView=u_modelview*vec4(pos,1.0);vec3 directionView=normalize((u_modelview*vec4(directionWorld,0.0)).xyz);vec3 side=cross(directionView,normalize(posView.xyz));posView.xyz+=side*a_uv.x*u_rainDropletSize.x;posView.xyz+=directionView*a_uv.y*u_rainDropletSize.y;uv=a_uv;particleRandomValue=a_rainParticleData.x;gl_Position=u_projection*posView;}`),vignette:sr("uniform vec3 u_vignetteShape;uniform vec4 u_vignetteColor;in vec2 st;void main() {float screenDist=length(st);float alpha=clamp((screenDist-u_vignetteShape.x)/u_vignetteShape.y,0.0,1.0);alpha=pow(alpha,u_vignetteShape.z)*u_vignetteColor.a;vec3 color=u_vignetteColor.rgb;glFragColor=vec4(color*alpha,alpha) ;}","in vec2 a_pos_2f;out vec2 st;void main() {st=a_pos_2f;gl_Position=vec4(a_pos_2f,0,1);}"),occlusion:sr("uniform vec4 u_color;void main() {glFragColor=u_color;}",`#include "_prelude_terrain.vertex.glsl"
in highp vec2 a_offset_xy;uniform highp vec3 u_anchorPos;uniform mat4 u_matrix;uniform vec2 u_screenSizePx;uniform vec2 u_occluderSizePx;void main() {vec3 world_pos=u_anchorPos;
#ifdef TERRAIN
float e=elevation(world_pos.xy);world_pos.z+=e;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1.0);projected_point.xy+=projected_point.w*a_offset_xy*0.5*u_occluderSizePx/u_screenSizePx;gl_Position=projected_point;}`)};function _c(p,r){const l=p.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let m of l)if(m=m.trim(),m[0]==="#"&&m.includes("if")&&!m.includes("endif")){m=m.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const x=m.split(" ");for(const b of x)r.includes(b)||r.push(b)}}function sr(p,r){const l=/#include\s+"([^"]+)"/g,m=/#pragma mapbox: ([\w\-]+) ([\w]+) ([\w]+) ([\w]+)/g;let x=r.match(/(attribute(\S*)|(^\s*|;)in) (highp |mediump |lowp )?([\w]+) ([\w]+)/gm);x&&(x=x.map(U=>{const $=U.split(" ");return $[$.length-1]}),x=[...new Set(x)]);const b={},A=[],R=[];if(p=p.replace(l,(U,$)=>(R.push($),"")),(r=r.replace(l,(U,$)=>(A.push($),""))).includes("flat out"))return void console.error('The usage of "flat" qualifier is disallowed, see: https://bugs.webkit.org/show_bug.cgi?id=268071');let N=[...ls];_c(p,N),_c(r,N);for(const U of[...A,...R])pc[U]||console.error(`Undefined include: ${U}`),mc[U]||(mc[U]=[],_c(pc[U],mc[U])),N=[...N,...mc[U]];return{fragmentSource:p=p.replace(m,(U,$,Z,W,ee)=>(b[ee]=!0,$==="define"?`
#ifndef HAS_UNIFORM_u_${ee}
in ${Z} ${W} ${ee};
#else
uniform ${Z} ${W} u_${ee};
#endif
`:$==="initialize"?`
#ifdef HAS_UNIFORM_u_${ee}
    ${Z} ${W} ${ee} = u_${ee};
#endif
`:$==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${ee}
    in ${Z} ${W} ${ee};
#endif
`:$==="initialize-attribute"?"":void 0)),vertexSource:r=r.replace(m,(U,$,Z,W,ee)=>{const ue=W==="float"?"vec2":W,oe=ee.match(/color/)?"color":ue;return $==="define-attribute-vertex-shader-only"?`
#ifdef HAS_ATTRIBUTE_a_${ee}
in ${Z} ${W} a_${ee};
#endif
`:b[ee]?$==="define"?`
#ifndef HAS_UNIFORM_u_${ee}
uniform lowp float u_${ee}_t;
in ${Z} ${ue} a_${ee};
out ${Z} ${W} ${ee};
#else
uniform ${Z} ${W} u_${ee};
#endif
`:$==="initialize"?oe==="vec4"?`
#ifndef HAS_UNIFORM_u_${ee}
    ${ee} = a_${ee};
#else
    ${Z} ${W} ${ee} = u_${ee};
#endif
`:`
#ifndef HAS_UNIFORM_u_${ee}
    ${ee} = unpack_mix_${oe}(a_${ee}, u_${ee}_t);
#else
    ${Z} ${W} ${ee} = u_${ee};
#endif
`:$==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${ee}
    in ${Z} ${W} a_${ee};
    out ${Z} ${W} ${ee};
#endif
`:$==="initialize-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${ee}
    ${ee} = a_${ee};
#endif
`:void 0:$==="define"?`
#ifndef HAS_UNIFORM_u_${ee}
uniform lowp float u_${ee}_t;
in ${Z} ${ue} a_${ee};
#else
uniform ${Z} ${W} u_${ee};
#endif
`:$==="define-instanced"?oe==="mat4"?`
#ifdef INSTANCED_ARRAYS
in vec4 a_${ee}0;
in vec4 a_${ee}1;
in vec4 a_${ee}2;
in vec4 a_${ee}3;
#else
uniform ${Z} ${W} u_${ee};
#endif
`:`
#ifdef INSTANCED_ARRAYS
in ${Z} ${ue} a_${ee};
#else
uniform ${Z} ${W} u_${ee};
#endif
`:$==="initialize-attribute-custom"?`
#ifdef HAS_ATTRIBUTE_a_${ee}
    ${Z} ${W} ${ee} = a_${ee};
#endif
`:oe==="vec4"?`
#ifndef HAS_UNIFORM_u_${ee}
    ${Z} ${W} ${ee} = a_${ee};
#else
    ${Z} ${W} ${ee} = u_${ee};
#endif
`:`
#ifndef HAS_UNIFORM_u_${ee}
    ${Z} ${W} ${ee} = unpack_mix_${oe}(a_${ee}, u_${ee}_t);
#else
    ${Z} ${W} ${ee} = u_${ee};
#endif
`}),staticAttributes:x,usedDefines:N,vertexIncludes:A,fragmentIncludes:R}}class du{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(r,l,m,x,b,A,R,N){this.context=r;let U=this.boundPaintVertexBuffers.length!==x.length;for(let Z=0;!U&&Z<x.length;Z++)this.boundPaintVertexBuffers[Z]!==x[Z]&&(U=!0);let $=this.boundDynamicVertexBuffers.length!==R.length;for(let Z=0;!$&&Z<R.length;Z++)this.boundDynamicVertexBuffers[Z]!==R[Z]&&($=!0);if(!this.vao||this.boundProgram!==l||this.boundLayoutVertexBuffer!==m||U||$||this.boundIndexBuffer!==b||this.boundVertexOffset!==A)this.freshBind(l,m,x,b,A,R,N);else{r.bindVertexArrayOES.set(this.vao);for(const Z of R)Z&&(Z.bind(),N&&Z.instanceCount&&Z.setVertexAttribDivisor(r.gl,l,N));b&&b.dynamicDraw&&b.bind()}}freshBind(r,l,m,x,b,A,R){const N=r.numAttributes,U=this.context,$=U.gl;this.vao&&this.destroy(),this.vao=U.gl.createVertexArray(),U.bindVertexArrayOES.set(this.vao),this.boundProgram=r,this.boundLayoutVertexBuffer=l,this.boundPaintVertexBuffers=m,this.boundIndexBuffer=x,this.boundVertexOffset=b,this.boundDynamicVertexBuffers=A,l.enableAttributes($,r),l.bind(),l.setVertexAttribPointers($,r,b);for(const Z of m)Z.enableAttributes($,r),Z.bind(),Z.setVertexAttribPointers($,r,b);for(const Z of A)Z&&(Z.enableAttributes($,r),Z.bind(),Z.setVertexAttribPointers($,r,b),R&&Z.instanceCount&&Z.setVertexAttribDivisor($,r,R));x&&x.bind(),U.currentNumAttributes=N}destroy(){this.vao&&(this.context.gl.deleteVertexArray(this.vao),this.vao=null)}}function pu(p,r){const l=Math.pow(2,r.canonical.z),m=r.canonical.y;return[new i.aa(0,m/l).toLngLat().lat,new i.aa(0,(m+1)/l).toLngLat().lat]}function No(p,r,l,m,x,b,A){const R=p.context,N=R.gl,U=l.hillshadeFBO;if(!U)return;p.prepareDrawTile();const $=p.isTileAffectedByFog(r),Z=p.getOrCreateProgram("hillshade",{overrideFog:$});R.activeTexture.set(N.TEXTURE0),N.bindTexture(N.TEXTURE_2D,U.colorAttachment.get());const W=((de,fe,Te,Pe)=>{const Oe=Te.paint.get("hillshade-shadow-color"),Fe=Te.paint.get("hillshade-shadow-color-use-theme").constantOr("default")==="none",Re=Te.paint.get("hillshade-highlight-color"),ke=Te.paint.get("hillshade-highlight-color-use-theme").constantOr("default")==="none",De=Te.paint.get("hillshade-accent-color"),$e=Te.paint.get("hillshade-accent-color-use-theme").constantOr("default")==="none",Xe=Te.paint.get("hillshade-emissive-strength");let ft=i.ai(Te.paint.get("hillshade-illumination-direction"));if(Te.paint.get("hillshade-illumination-anchor")==="viewport")ft-=de.transform.angle;else if(de.style&&de.style.enable3dLights()&&de.style.directionalLight){const Et=de.style.directionalLight.properties.get("direction"),vt=i.cb(Et.x,Et.y,Et.z);ft=i.ai(vt[1])}const ot=!de.options.moving;return{u_matrix:Pe||de.transform.calculateProjMatrix(fe.tileID.toUnwrapped(),ot),u_image:0,u_latrange:pu(0,fe.tileID),u_light:[Te.paint.get("hillshade-exaggeration"),ft],u_shadow:Oe.toRenderColor(Fe?null:Te.lut),u_highlight:Re.toRenderColor(ke?null:Te.lut),u_emissive_strength:Xe,u_accent:De.toRenderColor($e?null:Te.lut)}})(p,l,m,p.terrain?r.projMatrix:null);p.uploadCommonUniforms(R,Z,r.toUnwrapped());const{tileBoundsBuffer:ee,tileBoundsIndexBuffer:ue,tileBoundsSegments:oe}=p.getTileBoundsBuffers(l);Z.draw(p,N.TRIANGLES,x,b,A,Rn.disabled,W,m.id,ee,ue,oe)}function mu(p,r,l){if(!r.needsDEMTextureUpload)return;const m=p.context,x=m.gl;m.pixelStoreUnpackPremultiplyAlpha.set(!1),r.demTexture=r.demTexture||p.getTileTexture(l.stride);const b=l.getPixels();r.demTexture?r.demTexture.update(b,{premultiply:!1}):r.demTexture=new i.T(m,b,x.R32F,{premultiply:!1}),r.needsDEMTextureUpload=!1}function uh(p,r,l){const m=p.context,x=m.gl;if(!r.dem)return;const b=r.dem;if(m.activeTexture.set(x.TEXTURE1),mu(p,r,b),!r.demTexture)return;r.demTexture.bind(x.NEAREST,x.CLAMP_TO_EDGE);const A=b.dim;m.activeTexture.set(x.TEXTURE0);let R=r.hillshadeFBO;if(!R){const W=new i.T(m,{width:A,height:A,data:null},x.RGBA8);W.bind(x.LINEAR,x.CLAMP_TO_EDGE),R=r.hillshadeFBO=m.createFramebuffer(A,A,!0,"renderbuffer"),R.colorAttachment.set(W.texture)}m.bindFramebuffer.set(R.framebuffer),m.viewport.set([0,0,A,A]);const{tileBoundsBuffer:N,tileBoundsIndexBuffer:U,tileBoundsSegments:$}=p.getMercatorTileBoundsBuffers(),Z=[];p.linearFloatFilteringSupported()&&Z.push("TERRAIN_DEM_FLOAT_FORMAT"),p.getOrCreateProgram("hillshadePrepare",{defines:Z}).draw(p,x.TRIANGLES,Tn.disabled,Dn.disabled,Jn.unblended,Rn.disabled,((W,ee)=>{const ue=ee.stride,oe=i.ab.mat4.create();return i.ab.mat4.ortho(oe,0,i.ag,-i.ag,0,0,1),i.ab.mat4.translate(oe,oe,[0,-i.ag,0]),{u_matrix:oe,u_image:1,u_dimension:[ue,ue],u_zoom:W.overscaledZ}})(r.tileID,b),l.id,N,U,$),r.needsHillshadePrepare=!1}class jr{constructor(r){this.gl=r.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(r){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class hh extends jr{getDefault(){return i.aj.transparent}set(r){const l=this.current;(r.r!==l.r||r.g!==l.g||r.b!==l.b||r.a!==l.a||this.dirty)&&(this.gl.clearColor(r.r,r.g,r.b,r.a),this.current=r,this.dirty=!1)}}class bo extends jr{getDefault(){return 1}set(r){(r!==this.current||this.dirty)&&(this.gl.clearDepth(r),this.current=r,this.dirty=!1)}}class wo extends jr{getDefault(){return 0}set(r){(r!==this.current||this.dirty)&&(this.gl.clearStencil(r),this.current=r,this.dirty=!1)}}class Ml extends jr{getDefault(){return[!0,!0,!0,!0]}set(r){const l=this.current;(r[0]!==l[0]||r[1]!==l[1]||r[2]!==l[2]||r[3]!==l[3]||this.dirty)&&(this.gl.colorMask(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)}}class Xs extends jr{getDefault(){return!0}set(r){(r!==this.current||this.dirty)&&(this.gl.depthMask(r),this.current=r,this.dirty=!1)}}class Ys extends jr{getDefault(){return 255}set(r){(r!==this.current||this.dirty)&&(this.gl.stencilMask(r),this.current=r,this.dirty=!1)}}class _u extends jr{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(r){const l=this.current;(r.func!==l.func||r.ref!==l.ref||r.mask!==l.mask||this.dirty)&&(this.gl.stencilFunc(r.func,r.ref,r.mask),this.current=r,this.dirty=!1)}}class fh extends jr{getDefault(){const r=this.gl;return[r.KEEP,r.KEEP,r.KEEP]}set(r){const l=this.current;(r[0]!==l[0]||r[1]!==l[1]||r[2]!==l[2]||this.dirty)&&(this.gl.stencilOp(r[0],r[1],r[2]),this.current=r,this.dirty=!1)}}class gu extends jr{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;r?l.enable(l.STENCIL_TEST):l.disable(l.STENCIL_TEST),this.current=r,this.dirty=!1}}class Wd extends jr{getDefault(){return[0,1]}set(r){const l=this.current;(r[0]!==l[0]||r[1]!==l[1]||this.dirty)&&(this.gl.depthRange(r[0],r[1]),this.current=r,this.dirty=!1)}}class li extends jr{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;r?l.enable(l.DEPTH_TEST):l.disable(l.DEPTH_TEST),this.current=r,this.dirty=!1}}class va extends jr{getDefault(){return this.gl.LESS}set(r){(r!==this.current||this.dirty)&&(this.gl.depthFunc(r),this.current=r,this.dirty=!1)}}class Ur extends jr{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;r?l.enable(l.BLEND):l.disable(l.BLEND),this.current=r,this.dirty=!1}}class So extends jr{getDefault(){const r=this.gl;return[r.ONE,r.ZERO,r.ONE,r.ZERO]}set(r){const l=this.current;(r[0]!==l[0]||r[1]!==l[1]||r[2]!==l[2]||r[3]!==l[3]||this.dirty)&&(this.gl.blendFuncSeparate(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)}}class cs extends jr{getDefault(){return i.aj.transparent}set(r){const l=this.current;(r.r!==l.r||r.g!==l.g||r.b!==l.b||r.a!==l.a||this.dirty)&&(this.gl.blendColor(r.r,r.g,r.b,r.a),this.current=r,this.dirty=!1)}}class Cf extends jr{getDefault(){return this.gl.FUNC_ADD}set(r){(r!==this.current||this.dirty)&&(this.gl.blendEquationSeparate(r,r),this.current=r,this.dirty=!1)}}class Ks extends jr{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;r?l.enable(l.CULL_FACE):l.disable(l.CULL_FACE),this.current=r,this.dirty=!1}}class Xd extends jr{getDefault(){return this.gl.BACK}set(r){(r!==this.current||this.dirty)&&(this.gl.cullFace(r),this.current=r,this.dirty=!1)}}class Yd extends jr{getDefault(){return this.gl.CCW}set(r){(r!==this.current||this.dirty)&&(this.gl.frontFace(r),this.current=r,this.dirty=!1)}}let gc=class extends jr{getDefault(){return null}set(p){(p!==this.current||this.dirty)&&(this.gl.useProgram(p),this.current=p,this.dirty=!1)}};class dh extends jr{getDefault(){return this.gl.TEXTURE0}set(r){(r!==this.current||this.dirty)&&(this.gl.activeTexture(r),this.current=r,this.dirty=!1)}}class ph extends jr{getDefault(){const r=this.gl;return[0,0,r.drawingBufferWidth,r.drawingBufferHeight]}set(r){const l=this.current;(r[0]!==l[0]||r[1]!==l[1]||r[2]!==l[2]||r[3]!==l[3]||this.dirty)&&(this.gl.viewport(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)}}class Js extends jr{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;l.bindFramebuffer(l.FRAMEBUFFER,r),this.current=r,this.dirty=!1}}class D0 extends jr{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;l.bindRenderbuffer(l.RENDERBUFFER,r),this.current=r,this.dirty=!1}}class pm extends jr{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;l.bindTexture(l.TEXTURE_2D,r),this.current=r,this.dirty=!1}}class L0 extends jr{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;l.bindBuffer(l.ARRAY_BUFFER,r),this.current=r,this.dirty=!1}}class Kd extends jr{getDefault(){return null}set(r){const l=this.gl;l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,r),this.current=r,this.dirty=!1}}class z0 extends jr{getDefault(){return null}set(r){this.gl&&(r!==this.current||this.dirty)&&(this.gl.bindVertexArray(r),this.current=r,this.dirty=!1)}}class Mf extends jr{getDefault(){return 4}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;l.pixelStorei(l.UNPACK_ALIGNMENT,r),this.current=r,this.dirty=!1}}class Jd extends jr{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;l.pixelStorei(l.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r),this.current=r,this.dirty=!1}}class yc extends jr{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;l.pixelStorei(l.UNPACK_FLIP_Y_WEBGL,r),this.current=r,this.dirty=!1}}class vc extends jr{constructor(r,l){super(r),this.context=r,this.parent=l}getDefault(){return null}}class Ol extends vc{setDirty(){this.dirty=!0}set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const l=this.gl;l.framebufferTexture2D(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0,l.TEXTURE_2D,r,0),this.current=r,this.dirty=!1}}class yu extends vc{attachment(){return this.gl.DEPTH_ATTACHMENT}set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const l=this.gl;l.framebufferRenderbuffer(l.FRAMEBUFFER,this.attachment(),l.RENDERBUFFER,r),this.current=r,this.dirty=!1}}class Of extends vc{attachment(){return this.gl.DEPTH_ATTACHMENT}set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const l=this.gl;l.framebufferTexture2D(l.FRAMEBUFFER,this.attachment(),l.TEXTURE_2D,r,0),this.current=r,this.dirty=!1}}class mm extends yu{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}const Qd=(p,r,l)=>({u_matrix:p,u_image0:0,u_skirt_height:r,u_ground_shadow_factor:l}),To=(p,r,l,m,x,b,A,R,N,U,$,Z,W,ee,ue,oe)=>({u_proj_matrix:Float32Array.from(p),u_globe_matrix:r,u_normalize_matrix:Float32Array.from(m),u_merc_matrix:l,u_zoom_transition:x,u_merc_center:b,u_image0:0,u_frustum_tl:A,u_frustum_tr:R,u_frustum_br:N,u_frustum_bl:U,u_globe_pos:$,u_globe_radius:Z,u_viewport:W,u_grid_matrix:oe?Float32Array.from(oe):new Float32Array(9),u_skirt_height:ee,u_far_z_cutoff:ue});function ep(p,r){return p!=null&&r!=null&&!(!p.hasData()||!r.hasData())&&p.demTexture!=null&&r.demTexture!=null&&p.tileID.key!==r.tileID.key}const Ra=new class{constructor(){this.operations={}}newMorphing(p,r,l,m,x){if(p in this.operations){const b=this.operations[p];b.to.tileID.key!==l.tileID.key&&(b.queued=l)}else this.operations[p]={startTime:m,phase:0,duration:x,from:r,to:l,queued:null}}getMorphValuesForProxy(p){if(!(p in this.operations))return null;const r=this.operations[p];return{from:r.from,to:r.to,phase:r.phase}}update(p){for(const r in this.operations){const l=this.operations[r];for(l.phase=(p-l.startTime)/l.duration;l.phase>=1||!this._validOp(l);)if(!this._nextOp(l,p)){delete this.operations[r];break}}}_nextOp(p,r){return!!p.queued&&(p.from=p.to,p.to=p.queued,p.queued=null,p.phase=0,p.startTime=r,!0)}_validOp(p){return p.from.hasData()&&p.to.hasData()}},vu={0:null,1:"TERRAIN_VERTEX_MORPHING"};function mh(p,r,l){if(r===0)return 0;const m=r<1&&l===514?.25/r:1;return 6*Math.pow(1.5,22-p)*Math.max(r,1)*m}function tp(p,r){const l=1<<p.z;return!r&&(p.x===0||p.x===l-1)||p.y===0||p.y===l-1}const _h=p=>({u_matrix:p});function Ya(p,r,l,m,x){if(x>0){const b=i.q.now(),A=(b-p.timeAdded)/x,R=r?(b-r.timeAdded)/x:-1,N=l.getSource(),U=m.coveringZoomLevel({tileSize:N.tileSize,roundZoom:N.roundZoom}),$=!r||Math.abs(r.tileID.overscaledZ-U)>Math.abs(p.tileID.overscaledZ-U),Z=$&&p.refreshedUponExpiration?1:i.aw($?A:1-R,0,1);return p.refreshedUponExpiration&&A>=1&&(p.refreshedUponExpiration=!1),r?{opacity:1,mix:1-Z}:{opacity:Z,mix:0}}return{opacity:1,mix:0}}class us extends rs{constructor(r){const l={type:"raster-dem",maxzoom:r.transform.maxZoom},m=new i.D(i.ci(),null),x=di("mock-dem",l,m,r.style);super("mock-dem",x,!1),x.setEventedParent(this),this._sourceLoaded=!0}_loadTile(r,l){r.state="loaded",l(null)}}class xc extends rs{constructor(r){const l=di("proxy",{type:"geojson",maxzoom:r.transform.maxZoom},new i.D(i.ci(),null),r.style);super("proxy",l,!1),l.setEventedParent(this),this.map=this.getSource().map=r,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(r,l,m){if(r.freezeTileCoverage)return;this.transform=r;const x=r.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((b,A)=>{if(b[A.key]="",!this._tiles[A.key]){const R=new xl(A,this._source.tileSize*A.overscaleFactor(),r.tileZoom);R.state="loaded",this._tiles[A.key]=R}return b},{});for(const b in this._tiles)b in x||(this.freeFBO(b),this._tiles[b].unloadVectorData(),delete this._tiles[b])}freeFBO(r){const l=this.proxyCachedFBO[r];if(l!==void 0){const m=Object.values(l);this.renderCachePool.push(...m),delete this.proxyCachedFBO[r]}}deallocRenderCache(){this.renderCache.forEach(r=>r.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class np extends i.aG{constructor(r,l,m){super(r.overscaledZ,r.wrap,r.canonical.z,r.canonical.x,r.canonical.y),this.proxyTileKey=l,this.projMatrix=m}}class Fo extends i.cJ{constructor(r,l){super(),this._debugParams={sortTilesHiZFirst:!0,disableRenderCache:!1},r.tp.registerParameter(this._debugParams,["Terrain"],"sortTilesHiZFirst",{},()=>{this._style.map.triggerRepaint()}),r.tp.registerParameter(this._debugParams,["Terrain"],"disableRenderCache",{},()=>{this._style.map.triggerRepaint()}),r.tp.registerButton(["Terrain"],"Invalidate Render Cache",()=>{this.invalidateRenderCache=!0,this._style.map.triggerRepaint()}),this.painter=r,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[m,x,b]=function(N){const U=new i.b4,$=new i.aU,Z=131;U.reserve(17161),$.reserve(33800);const W=i.ag/128,ee=i.ag+W/2,ue=ee+W;for(let de=-W;de<ue;de+=W)for(let fe=-W;fe<ue;fe+=W){const Te=fe<0||fe>ee||de<0||de>ee?24575:0,Pe=i.aw(Math.round(fe),0,i.ag),Oe=i.aw(Math.round(de),0,i.ag);U.emplaceBack(Pe+Te,Oe)}const oe=(de,fe)=>{const Te=fe*Z+de;$.emplaceBack(Te+1,Te,Te+Z),$.emplaceBack(Te+Z,Te+Z+1,Te+1)};for(let de=1;de<129;de++)for(let fe=1;fe<129;fe++)oe(fe,de);return[0,129].forEach(de=>{for(let fe=0;fe<130;fe++)oe(fe,de),oe(de,fe)}),[U,$,32768]}(),A=r.context;this.gridBuffer=A.createVertexBuffer(m,i.b6.members),this.gridIndexBuffer=A.createIndexBuffer(x),this.gridSegments=i.b7.simpleSegment(0,0,m.length,x.length),this.gridNoSkirtSegments=i.b7.simpleSegment(0,0,m.length,b),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new xc(l.map),this.orthoMatrix=i.ab.mat4.create(),i.ab.mat4.ortho(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,i.ag,0,i.ag,0,1);const R=A.gl;this._overlapStencilMode=new Dn({func:R.GEQUAL,mask:255},0,255,R.KEEP,R.KEEP,R.REPLACE),this._previousZoom=r.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=l,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new us(l.map),this._pendingGroundEffectLayers=[]}set style(r){r.on("data",this._onStyleDataEvent.bind(this)),this._style=r,this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(r,l,m){if(r&&r.terrain){this._style!==r&&(this.style=r,this._evaluationZoom=void 0);const x=r.terrain.properties,b=r.terrain.drapeRenderMode===0,A=r.terrain.isZoomDependent();this._previousUpdateTimestamp=this.enabled?this._updateTimestamp:void 0,this._updateTimestamp=i.q.now();const R=r.terrain&&r.terrain.scope,N=x.get("source"),U=b?this._mockSourceCache:r.getSourceCache(N,R);if(!U)return void i.w(`Couldn't find terrain source "${N}".`);if(this.sourceCache=U,this._attenuationRange=r.terrain.getAttenuationRange(),this._exaggeration=A?this.calculateExaggeration(l):x.get("exaggeration"),!l.projection.requiresDraping&&A&&this._exaggeration===0)return void this._disable();this.enabled=!0;const $=()=>{this.sourceCache.used&&i.w(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const Z=this.getScaledDemTileSize();this.sourceCache.update(l,Z,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,$(),this._initializing=!0),$(),l.updateElevation(!0,m),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(l),this._emptyDEMTextureDirty=!0,this._previousZoom=l.zoom}else this._disable()}calculateExaggeration(r){if(this._attenuationRange&&r.zoom>=Math.ceil(this._attenuationRange[1]))return this._style.terrain.getExaggeration(r.zoom);const l=this._previousCameraAltitude,m=r.getFreeCameraOptions().position.z/r.pixelsPerMeter*r.worldSize;this._previousCameraAltitude=m;const x=l!=null?m-l:Number.MAX_VALUE;if(Math.abs(x)<2)return this._exaggeration;const b=r.zoom,A=this._style.terrain;if(!this._previousUpdateTimestamp)return A.getExaggeration(b);let R=b-this._previousZoom;const N=this._previousUpdateTimestamp;let U=b;this._evaluationZoom!=null&&(U=this._evaluationZoom,Math.abs(b-U)>.5&&(R=.5*(b-U+R)),R*x<0&&(U+=R)),this._evaluationZoom=U;const $=A.getExaggeration(U),Z=$===A.getExaggeration(Math.max(0,U-.1));if(Z&&Math.abs($-this._exaggeration)<.01)return $;let W=Math.min(.1,.00375*(this._updateTimestamp-N));return(Z||$<.1||Math.abs(R)<1e-4)&&(W=Math.min(.2,4*W)),i.af(this._exaggeration,$,W)}resetTileLookupCache(r){this._findCoveringTileCache[r]={}}attenuationRange(){return this._attenuationRange}getDemUpscale(){return this.proxySourceCache.getSource().tileSize/128}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_onStyleDataEvent(r){r.coord&&r.dataType==="source"?this._clearRenderCacheForTile(r.sourceCacheId,r.coord):r.dataType==="style"&&(this.invalidateRenderCache=!0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this._previousCameraAltitude=void 0)}_disable(){if(this.enabled&&(this.enabled=!1,this._emptyDEMTextureDirty=!0,this._sharedDepthStencil=void 0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const r in this._style._mergedSourceCaches)this._style._mergedSourceCaches[r].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this.pool.forEach(r=>r.fb.destroy()),this.pool=[],this.framebufferCopyTexture&&this.framebufferCopyTexture.destroy()}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this.enabled?this._exaggeration:0}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const r=2*this.proxySourceCache.getSource().tileSize;return[r,r]}set useVertexMorphing(r){this._useVertexMorphing=r}updateTileBinding(r){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const l=this.proxySourceCache,m=this.painter.transform;this._initializing&&(this._initializing=m._centerAltitude===0&&this.getAtPointOrZero(i.aa.fromLngLat(m.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const x=this.proxyCoords=l.getIds().map(N=>{const U=l.getTileByID(N).tileID;return U.projMatrix=m.calculateProjMatrix(U.toUnwrapped()),U});(function(N,U){const $=U.transform.pointCoordinate(U.transform.getCameraPoint()),Z=new i.P($.x,$.y);N.sort((W,ee)=>{if(ee.overscaledZ-W.overscaledZ)return ee.overscaledZ-W.overscaledZ;const ue=new i.P(W.canonical.x+(1<<W.canonical.z)*W.wrap,W.canonical.y),oe=new i.P(ee.canonical.x+(1<<ee.canonical.z)*ee.wrap,ee.canonical.y),de=Z.mult(1<<W.canonical.z);return de.x-=.5,de.y-=.5,de.distSqr(ue)-de.distSqr(oe)})})(x,this.painter);const b=this.proxyToSource||{};this.proxyToSource={},x.forEach(N=>{this.proxyToSource[N.key]={}}),this.terrainTileForTile={};const A=this._style._mergedSourceCaches;for(const N in A){const U=A[N];if(!U.used||(U!==this.sourceCache&&this.resetTileLookupCache(U.id),this._setupProxiedCoordsForOrtho(U,r[N],b),U.usedForTerrain))continue;const $=r[N];U.getSource().reparseOverscaled&&this._assignTerrainTiles($)}this.proxiedCoords[l.id]=x.map(N=>new np(N,N.key,this.orthoMatrix)),this._assignTerrainTiles(x),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(b),this.renderingToTexture=!1;const R={};this._visibleDemTiles=[];for(const N of this.proxyCoords){const U=this.terrainTileForTile[N.key];if(!U)continue;const $=U.tileID.key;$ in R||(this._visibleDemTiles.push(U),R[$]=$)}}_assignTerrainTiles(r){this._initializing||r.forEach(l=>{if(this.terrainTileForTile[l.key])return;const m=this._findTileCoveringTileID(l,this.sourceCache);m&&(this.terrainTileForTile[l.key]=m)})}_prepareDEMTextures(){const r=this.painter.context,l=r.gl;for(const m in this.terrainTileForTile){const x=this.terrainTileForTile[m],b=x.dem;!b||x.demTexture&&!x.needsDEMTextureUpload||(r.activeTexture.set(l.TEXTURE1),mu(this.painter,x,b))}}_prepareDemTileUniforms(r,l,m,x){if(!l||l.demTexture==null)return!1;const b=r.tileID.canonical,A=Math.pow(2,l.tileID.canonical.z-b.z),R=x||"";return m[`u_dem_tl${R}`]=[b.x*A%1,b.y*A%1],m[`u_dem_scale${R}`]=A,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}_getLoadedAreaMinimum(){if(!this.enabled)return 0;let r=0;const l=this._visibleDemTiles.reduce((m,x)=>{if(!x.dem)return m;const b=x.dem.tree.minimums[0];return b>0&&r++,m+b},0);return r?l/r:0}_updateEmptyDEMTexture(){const r=this.painter.context,l=r.gl;r.activeTexture.set(l.TEXTURE2);const m=this._getLoadedAreaMinimum(),x=new i.cK({width:1,height:1},new Float32Array([m]));this._emptyDEMTextureDirty=!1;let b=this._emptyDEMTexture;return b?b.update(x,{premultiply:!1}):b=this._emptyDEMTexture=new i.T(r,x,l.R32F,{premultiply:!1}),b}setupElevationDraw(r,l,m){const x=this.painter.context,b=x.gl,A={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0};A.u_exaggeration=this.exaggeration();let R=null,N=null,U=1;if(m&&m.morphing&&this._useVertexMorphing){const ee=m.morphing.srcDemTile,ue=m.morphing.dstDemTile;U=m.morphing.phase,ee&&ue&&(this._prepareDemTileUniforms(r,ee,A,"_prev")&&(N=ee),this._prepareDemTileUniforms(r,ue,A)&&(R=ue))}const $=ee=>ee&&ee.demTexture&&this.painter.linearFloatFilteringSupported()?b.LINEAR:b.NEAREST;let Z=null;var W;if(this.enabled?N&&R?(Z=R.demTexture,x.activeTexture.set(b.TEXTURE4),N.demTexture.bind($(N),b.CLAMP_TO_EDGE),A.u_dem_lerp=U):(R=this.terrainTileForTile[r.tileID.key],Z=this._prepareDemTileUniforms(r,R,A)?R.demTexture:this.emptyDEMTexture):Z=this.emptyDEMTexture,x.activeTexture.set(b.TEXTURE2),Z&&(A.u_dem_size=(W=Z).size[0]===1?1:W.size[0]-2,Z.bind($(R),b.CLAMP_TO_EDGE)),this.painter.setupDepthForOcclusion(m&&m.useDepthForOcclusion,l,A),m&&m.useMeterToDem&&R){const ee=(1<<R.tileID.canonical.z)*i.bH(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;A.u_meter_to_dem=ee}if(m&&m.labelPlaneMatrixInv&&(A.u_label_plane_matrix_inv=m.labelPlaneMatrixInv),l.setTerrainUniformValues(x,A),this.painter.transform.projection.name==="globe"){const ee=this.globeUniformValues(this.painter.transform,r.tileID.canonical,m&&m.useDenormalizedUpVectorScale);l.setGlobeUniformValues(x,ee)}}globeUniformValues(r,l,m){const x=r.projection;return{u_tile_tl_up:x.upVector(l,0,0),u_tile_tr_up:x.upVector(l,i.ag,0),u_tile_br_up:x.upVector(l,i.ag,i.ag),u_tile_bl_up:x.upVector(l,0,i.ag),u_tile_up_scale:m?i.cL(1):x.upVectorScale(l,r.center.lat,r.worldSize).metersToTile}}renderToBackBuffer(r){const l=this.painter,m=this.painter.context;r.length!==0&&(m.bindFramebuffer.set(null),m.viewport.set([0,0,l.width,l.height]),l.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(x,b,A,R,N){if(x.transform.projection.name==="globe")(function(U,$,Z,W,ee){const ue=U.context,oe=ue.gl;let de,fe;const Te=U.transform,Pe=i.cC(U,ue,Te),Oe=(Et,vt)=>{if(fe===vt)return;const nt=[vu[vt],"PROJECTION_GLOBE_VIEW"];Pe&&nt.push("CUSTOM_ANTIALIASING");const pt=U.isTileAffectedByFog(Et);de=U.getOrCreateProgram("globeRaster",{defines:nt,overrideFog:pt}),fe=vt},Fe=U.colorModeForRenderPass(),Re=new Tn(oe.LEQUAL,Tn.ReadWrite,U.depthRangeFor3D);Ra.update(ee);const ke=i.cD(Te),De=[i.at(Te.center.lng),i.aA(Te.center.lat)],$e=U.globeSharedBuffers,Xe=[Te.width*i.q.devicePixelRatio,Te.height*i.q.devicePixelRatio],ft=Float32Array.from(Te.globeMatrix),ot={useDenormalizedUpVectorScale:!0};{const Et=U.transform,vt=mh(Et.zoom,$.exaggeration(),$.sourceCache._source.tileSize);fe=-1;const nt=oe.TRIANGLES;for(const pt of W){const Lt=Z.getTile(pt),tt=Dn.disabled,St=$.prevTerrainTileForTile[pt.key],mt=$.terrainTileForTile[pt.key];ep(St,mt)&&Ra.newMorphing(pt.key,St,mt,ee,250),ue.activeTexture.set(oe.TEXTURE0),Lt.texture&&Lt.texture.bind(oe.LINEAR,oe.CLAMP_TO_EDGE);const Gt=Ra.getMorphValuesForProxy(pt.key),Pt=Gt?1:0;Gt&&i.J(ot,{morphing:{srcDemTile:Gt.from,dstDemTile:Gt.to,phase:i.cB(Gt.phase)}});const At=i.cE(pt.canonical),kt=i.cF(At.getCenter().lat),Wt=i.cG(pt.canonical,At,kt,Et.worldSize/Et._pixelsPerMercatorPixel),on=i.bb(i.cH(pt.canonical)),dn=To(Et.expandedFarZProjMatrix,ft,ke,on,i.ae(Et.zoom),De,Et.frustumCorners.TL,Et.frustumCorners.TR,Et.frustumCorners.BR,Et.frustumCorners.BL,Et.globeCenterInViewSpace,Et.globeRadius,Xe,vt,Et._farZ,Wt);if(Oe(pt,Pt),de&&($.setupElevationDraw(Lt,de,ot),U.uploadCommonUniforms(ue,de,pt.toUnwrapped()),$e)){const[En,Sn,bn]=$e.getGridBuffers(kt,vt!==0);de.draw(U,nt,Re,tt,Fe,Rn.backCCW,dn,"globe_raster",En,Sn,bn)}}}if($e&&(U.renderDefaultNorthPole||U.renderDefaultSouthPole)){const Et=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];Pe&&Et.push("CUSTOM_ANTIALIASING"),de=U.getOrCreateProgram("globeRaster",{defines:Et});for(const vt of W){const{x:nt,y:pt,z:Lt}=vt.canonical,tt=pt===0,St=pt===(1<<Lt)-1,[mt,Gt,Pt,At]=$e.getPoleBuffers(Lt,!1);if(At&&(tt||St)){const kt=Z.getTile(vt);ue.activeTexture.set(oe.TEXTURE0),kt.texture&&kt.texture.bind(oe.LINEAR,oe.CLAMP_TO_EDGE);let Wt=i.cI(Lt,nt,Te);const on=i.bb(i.cH(vt.canonical)),dn=(En,Sn)=>En.draw(U,oe.TRIANGLES,Re,Dn.disabled,Fe,Rn.disabled,To(Te.expandedFarZProjMatrix,Wt,Wt,on,0,De,Te.frustumCorners.TL,Te.frustumCorners.TR,Te.frustumCorners.BR,Te.frustumCorners.BL,Te.globeCenterInViewSpace,Te.globeRadius,Xe,0,Te._farZ),"globe_pole_raster",Sn,Pt,At);$.setupElevationDraw(kt,de,ot),U.uploadCommonUniforms(ue,de,vt.toUnwrapped()),tt&&U.renderDefaultNorthPole&&dn(de,mt),St&&U.renderDefaultSouthPole&&(Wt=i.ab.mat4.scale(i.ab.mat4.create(),Wt,[1,-1,1]),dn(de,Gt))}}}})(x,b,A,R,N);else{const U=x.context,$=U.gl;let Z,W;const ee=x.shadowRenderer,ue=sc(x,x.longestCutoffRange),oe=Fe=>{if(W===Fe)return;const Re=[];Re.push(vu[Fe]),ue.shouldRenderCutoff&&Re.push("RENDER_CUTOFF"),ee&&(Re.push("RENDER_SHADOWS","DEPTH_TEXTURE"),ee.useNormalOffset&&Re.push("NORMAL_OFFSET")),Z=x.getOrCreateProgram("terrainRaster",{defines:Re}),W=Fe},de=x.colorModeForRenderPass(),fe=new Tn($.LEQUAL,Tn.ReadWrite,x.depthRangeFor3D);Ra.update(N);const Te=x.transform,Pe=mh(Te.zoom,b.exaggeration(),b.sourceCache._source.tileSize);let Oe=[0,0,0];if(ee){const Fe=x.style.directionalLight,Re=x.style.ambientLight;Fe&&Re&&(Oe=Gd(x.style,Fe,Re))}{W=-1;const Fe=$.TRIANGLES,[Re,ke]=[b.gridIndexBuffer,b.gridSegments];for(const De of R){const $e=A.getTile(De),Xe=Dn.disabled,ft=b.prevTerrainTileForTile[De.key],ot=b.terrainTileForTile[De.key];ep(ft,ot)&&Ra.newMorphing(De.key,ft,ot,N,250),U.activeTexture.set($.TEXTURE0),$e.texture&&$e.texture.bind($.LINEAR,$.CLAMP_TO_EDGE);const Et=Ra.getMorphValuesForProxy(De.key),vt=Et?1:0;let nt;Et&&(nt={morphing:{srcDemTile:Et.from,dstDemTile:Et.to,phase:i.cB(Et.phase)}});const pt=Qd(De.projMatrix,tp(De.canonical,Te.renderWorldCopies)?Pe/10:Pe,Oe);if(oe(vt),!Z)continue;b.setupElevationDraw($e,Z,nt);const Lt=De.toUnwrapped();ee&&ee.setupShadows(Lt,Z),x.uploadCommonUniforms(U,Z,Lt,null,ue),Z.draw(x,Fe,fe,Xe,de,Rn.backCCW,pt,"terrain_raster",b.gridBuffer,Re,ke)}}}}(l,this,this.proxySourceCache,r,this._updateTimestamp),this.renderingToTexture=!0,l.gpuTimingDeferredRenderEnd(),r.splice(0,r.length))}renderBatch(r){if(this._drapedRenderBatches.length===0)return r+1;this.renderingToTexture=!0;const l=this.painter,m=this.painter.context,x=this.proxySourceCache,b=this.proxiedCoords[x.id],A=this._drapedRenderBatches.shift(),R=l.style.order,N=[];let U=0;for(const $ of b){const Z=x.getTileByID($.proxyTileKey),W=x.proxyCachedFBO[$.key]?x.proxyCachedFBO[$.key][r]:void 0,ee=W!==void 0?x.renderCache[W]:this.pool[U++],ue=W!==void 0;if(Z.texture=ee.tex,ue&&!ee.dirty){N.push(Z.tileID);continue}let oe;m.bindFramebuffer.set(ee.fb.framebuffer),this.renderedToTile=!1,ee.dirty&&(m.clear({color:i.aj.transparent,stencil:0}),ee.dirty=!1);for(let de=A.start;de<=A.end;++de){const fe=l.style._mergedLayers[R[de]];if(fe.isHidden(l.transform.zoom))continue;const Te=l.style.getLayerSourceCache(fe),Pe=Te?this.proxyToSource[$.key][Te.id]:[$];if(!Pe)continue;const Oe=Pe;m.viewport.set([0,0,ee.fb.width,ee.fb.height]),oe!==(Te?Te.id:null)&&(this._setupStencil(ee,Pe,fe,Te),oe=Te?Te.id:null),l.renderLayer(l,Te,fe,Oe)}if(this._drapedRenderBatches.length===0)for(const de of this._pendingGroundEffectLayers){const fe=l.style._mergedLayers[R[de]];if(fe.isHidden(l.transform.zoom))continue;const Te=l.style.getLayerSourceCache(fe),Pe=Te?this.proxyToSource[$.key][Te.id]:[$];if(!Pe)continue;const Oe=Pe;m.viewport.set([0,0,ee.fb.width,ee.fb.height]),oe!==(Te?Te.id:null)&&(this._setupStencil(ee,Pe,fe,Te),oe=Te?Te.id:null),l.renderLayer(l,Te,fe,Oe)}this.renderedToTile?(ee.dirty=!0,N.push(Z.tileID)):ue||--U,U===5&&(U=0,this.renderToBackBuffer(N))}return this.renderToBackBuffer(N),this.renderingToTexture=!1,m.bindFramebuffer.set(null),m.viewport.set([0,0,l.width,l.height]),A.end+1}postRender(){}isLayerOrderingCorrect(r){const l=r.order.length;let m=-1,x=l;for(let b=0;b<l;++b)this._style.isLayerDraped(r._mergedLayers[r.order[b]])?m=Math.max(m,b):x=Math.min(x,b);return x>m}getMinElevationBelowMSL(){let r=0;return this._visibleDemTiles.filter(l=>l.dem).forEach(l=>{r=Math.min(r,l.dem.tree.minimums[0])}),r===0?r:(r-30)*this._exaggeration}raycast(r,l,m){if(!this._visibleDemTiles)return null;const x=this._visibleDemTiles.filter(b=>b.dem).map(b=>{const A=b.tileID,R=1<<A.overscaledZ,{x:N,y:U}=A.canonical,$=N/R,Z=(N+1)/R,W=U/R,ee=(U+1)/R;return{minx:$,miny:W,maxx:Z,maxy:ee,t:b.dem.tree.raycastRoot($,W,Z,ee,r,l,m),tile:b}});x.sort((b,A)=>(b.t!==null?b.t:Number.MAX_VALUE)-(A.t!==null?A.t:Number.MAX_VALUE));for(const b of x){if(b.t==null)return null;const A=b.tile.dem.tree.raycast(b.minx,b.miny,b.maxx,b.maxy,r,l,m);if(A!=null)return A}return null}_createFBO(){const r=this.painter.context,l=r.gl,m=this.drapeBufferSize;r.activeTexture.set(l.TEXTURE0);const x=new i.T(r,{width:m[0],height:m[1],data:null},l.RGBA8);x.bind(l.LINEAR,l.CLAMP_TO_EDGE);const b=r.createFramebuffer(m[0],m[1],!0,null);return b.colorAttachment.set(x.texture),b.depthAttachment=new mm(r,b.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=r.createRenderbuffer(r.gl.DEPTH_STENCIL,m[0],m[1]),this._stencilRef=0,b.depthAttachment.set(this._sharedDepthStencil),r.clear({stencil:0})):b.depthAttachment.set(this._sharedDepthStencil),r.extTextureFilterAnisotropic&&l.texParameterf(l.TEXTURE_2D,r.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,r.extTextureFilterAnisotropicMax),{fb:b,tex:x,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._debugParams.disableRenderCache||this._style.hasLightTransitions())return!0;for(const r in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[r].hasTransition())return!0;return this._style.order.some(r=>{const l=this._style._mergedLayers[r],m=l.isHidden(this.painter.transform.zoom);return l.type==="hillshade"||l.type==="custom"?!m&&l.shouldRedrape():!m&&l.hasTransition()})}_clearLineLayersFromRenderCache(){let r=!1;for(const m of this._style.getSources())if(m instanceof Ii){r=!0;break}if(!r)return;const l={};for(let m=0;m<this._style.order.length;++m){const x=this._style._mergedLayers[this._style.order[m]],b=this._style.getLayerSourceCache(x);if(b&&!l[b.id]&&!x.isHidden(this.painter.transform.zoom)&&x.type==="line"&&x.widthExpression()instanceof i.a9){l[b.id]=!0;for(const A of this.proxyCoords){const R=this.proxyToSource[A.key][b.id];if(R)for(const N of R)this._clearRenderCacheForTile(b.id,N)}}}}_clearRasterLayersFromRenderCache(){let r=!1;for(const m in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[m]._source instanceof zo){r=!0;break}if(!r)return;const l={};for(let m=0;m<this._style.order.length;++m){const x=this._style._mergedLayers[this._style.order[m]],b=this._style.getLayerSourceCache(x);if(!b||l[b.id]||x.isHidden(this.painter.transform.zoom)||x.type!=="raster")continue;const A=x.paint.get("raster-fade-duration");for(const R of this.proxyCoords){const N=this.proxyToSource[R.key][b.id];if(N)for(const U of N){const $=Ya(b.getTile(U),b.findLoadedParent(U,0),b,this.painter.transform,A);($.opacity!==1||$.mix!==0)&&this._clearRenderCacheForTile(b.id,U)}}}}_setupDrapedRenderBatches(){this._style.updateDrapeFirstLayers();const r=this._style.order,l=r.length;if(l===0)return;const m=[];this._pendingGroundEffectLayers=[];let x,b=0,A=this._style._mergedLayers[r[b]];for(;!this._style.isLayerDraped(A)&&A.isHidden(this.painter.transform.zoom)&&++b<l;)A=this._style._mergedLayers[r[b]];for(;b<l;++b){const R=this._style._mergedLayers[r[b]];R.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(R)?x===void 0&&(x=b):(R.type==="fill-extrusion"&&this._pendingGroundEffectLayers.push(b),x!==void 0&&(m.push({start:x,end:b-1}),x=void 0)))}if(x!==void 0&&m.push({start:x,end:b-1}),m.length!==0){const R=m[m.length-1];this._pendingGroundEffectLayers.every(N=>N>R.end)||i.w("fill-extrusion with flood lighting and/or ground ambient occlusion should be moved to be on top of all draped layers.")}this._drapedRenderBatches=m}_setupRenderCache(r){const l=this.proxySourceCache;if(this._shouldDisableRenderCache()||this.invalidateRenderCache){if(this.invalidateRenderCache=!1,l.renderCache.length>l.renderCachePool.length){const A=Object.values(l.proxyCachedFBO);l.proxyCachedFBO={};for(let R=0;R<A.length;++R){const N=Object.values(A[R]);l.renderCachePool.push(...N)}}return}this._clearRasterLayersFromRenderCache();const m=this.proxyCoords,x=this._tilesDirty;for(let A=m.length-1;A>=0;A--){const R=m[A];if(l.getTileByID(R.key),l.proxyCachedFBO[R.key]!==void 0){const N=r[R.key],U=this.proxyToSource[R.key];let $=0;for(const Z in U){const W=U[Z],ee=N[Z];if(!ee||ee.length!==W.length||W.some((ue,oe)=>ue!==ee[oe]||x[Z]&&x[Z].hasOwnProperty(ue.key))){$=-1;break}++$}for(const Z in l.proxyCachedFBO[R.key])l.renderCache[l.proxyCachedFBO[R.key][Z]].dirty=$<0||$!==Object.values(N).length}}const b=[...this._drapedRenderBatches];b.sort((A,R)=>R.end-R.start-(A.end-A.start));for(const A of b)for(const R of m){if(l.proxyCachedFBO[R.key])continue;let N=l.renderCachePool.pop();N===void 0&&l.renderCache.length<50&&(N=l.renderCache.length,l.renderCache.push(this._createFBO())),N!==void 0&&(l.proxyCachedFBO[R.key]={},l.proxyCachedFBO[R.key][A.start]=N,l.renderCache[N].dirty=!0)}this._tilesDirty={}}_setupStencil(r,l,m,x){if(!x||!this._sourceTilesOverlap[x.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const b=this.painter.context,A=b.gl;if(l.length<=1)return void(this._overlapStencilType=!1);let R;if(m.isTileClipped())R=l.length,this._overlapStencilMode.test={func:A.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(l[0].overscaledZ>l[l.length-1].overscaledZ))return void(this._overlapStencilType=!1);R=1,this._overlapStencilMode.test={func:A.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+R>255&&(b.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=R,this._overlapStencilMode.ref=this._stencilRef,m.isTileClipped()&&this._renderTileClippingMasks(l,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(r){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[r.key]),this._overlapStencilMode):Dn.disabled}_renderTileClippingMasks(r,l){const m=this.painter,x=this.painter.context,b=x.gl;m._tileClippingMaskIDs={},x.setColorMode(Jn.disabled),x.setDepthMode(Tn.disabled);const A=m.getOrCreateProgram("clippingMask");for(const R of r){const N=m._tileClippingMaskIDs[R.key]=--l;A.draw(m,b.TRIANGLES,Tn.disabled,new Dn({func:b.ALWAYS,mask:0},N,255,b.KEEP,b.KEEP,b.REPLACE),Jn.disabled,Rn.disabled,_h(R.projMatrix),"$clipping",m.tileExtentBuffer,m.quadTriangleIndexBuffer,m.tileExtentSegments)}}pointCoordinate(r){const l=this.painter.transform;if(r.x<0||r.x>l.width||r.y<0||r.y>l.height)return null;const m=[r.x,r.y,1,1];i.ab.vec4.transformMat4(m,m,l.pixelMatrixInverse),i.ab.vec4.scale(m,m,1/m[3]),m[0]/=l.worldSize,m[1]/=l.worldSize;const x=l._camera.position,b=i.bH(1,l.center.lat),A=[x[0],x[1],x[2]/b,0],R=i.ab.vec3.subtract([],m.slice(0,3),A);i.ab.vec3.normalize(R,R);const N=this.raycast(A,R,this._exaggeration);return N!==null&&N?(i.ab.vec3.scaleAndAdd(A,A,R,N),A[3]=A[2],A[2]*=b,A):null}_setupProxiedCoordsForOrtho(r,l,m){if(r.getSource()instanceof i.aJ)return this._setupProxiedCoordsForImageSource(r,l,m);this._findCoveringTileCache[r.id]=this._findCoveringTileCache[r.id]||{};const x=this.proxiedCoords[r.id]=[],b=this.proxyCoords;for(let N=0;N<b.length;N++){const U=b[N],$=this._findTileCoveringTileID(U,r);if($){const Z=this._createProxiedId(U,$,m[U.key]&&m[U.key][r.id]);x.push(Z),this.proxyToSource[U.key][r.id]=[Z]}}let A=!1;const R=new Set;for(let N=0;N<l.length;N++){const U=r.getTile(l[N]);if(!U||!U.hasData())continue;const $=this._findTileCoveringTileID(U.tileID,this.proxySourceCache);if($&&$.tileID.canonical.z!==U.tileID.canonical.z){const Z=this.proxyToSource[$.tileID.key][r.id],W=this._createProxiedId($.tileID,U,m[$.tileID.key]&&m[$.tileID.key][r.id]);Z?Z.splice(Z.length-1,0,W):this.proxyToSource[$.tileID.key][r.id]=[W];const ee=this.proxyToSource[$.tileID.key][r.id];R.has(ee)||R.add(ee),x.push(W),A=!0}}if(this._sourceTilesOverlap[r.id]=A,A&&this._debugParams.sortTilesHiZFirst)for(const N of R)N.sort((U,$)=>$.overscaledZ-U.overscaledZ)}_setupProxiedCoordsForImageSource(r,l,m){if(!r.getSource().loaded())return;const x=this.proxiedCoords[r.id]=[],b=this.proxyCoords,A=r.getSource(),R=A.tileID;if(!R)return;const N=new i.P(R.x,R.y)._div(1<<R.z),U=A.coordinates.map(i.aa.fromLngLat).reduce((Z,W)=>(Z.min.x=Math.min(Z.min.x,W.x-N.x),Z.min.y=Math.min(Z.min.y,W.y-N.y),Z.max.x=Math.max(Z.max.x,W.x-N.x),Z.max.y=Math.max(Z.max.y,W.y-N.y),Z),{min:new i.P(Number.MAX_VALUE,Number.MAX_VALUE),max:new i.P(-Number.MAX_VALUE,-Number.MAX_VALUE)}),$=(Z,W)=>{const ee=Z.wrap+Z.canonical.x/(1<<Z.canonical.z),ue=Z.canonical.y/(1<<Z.canonical.z),oe=i.ag/(1<<Z.canonical.z),de=W.wrap+W.canonical.x/(1<<W.canonical.z),fe=W.canonical.y/(1<<W.canonical.z);return ee+oe<de+U.min.x||ee>de+U.max.x||ue+oe<fe+U.min.y||ue>fe+U.max.y};for(let Z=0;Z<b.length;Z++){const W=b[Z];for(let ee=0;ee<l.length;ee++){const ue=r.getTile(l[ee]);if(!ue||!ue.hasData()||$(W,ue.tileID))continue;const oe=this._createProxiedId(W,ue,m[W.key]&&m[W.key][r.id]),de=this.proxyToSource[W.key][r.id];de?de.push(oe):this.proxyToSource[W.key][r.id]=[oe],x.push(oe)}}}_createProxiedId(r,l,m){let x=this.orthoMatrix;if(m){const b=m.find(A=>A.key===l.tileID.key);if(b)return b}if(l.tileID.key!==r.key){const b=r.canonical.z-l.tileID.canonical.z;let A,R,N;x=i.ab.mat4.create();const U=l.tileID.wrap-r.wrap<<r.overscaledZ;b>0?(A=i.ag>>b,R=A*((l.tileID.canonical.x<<b)-r.canonical.x+U),N=A*((l.tileID.canonical.y<<b)-r.canonical.y)):(A=i.ag<<-b,R=i.ag*(l.tileID.canonical.x-(r.canonical.x+U<<-b)),N=i.ag*(l.tileID.canonical.y-(r.canonical.y<<-b))),i.ab.mat4.ortho(x,0,A,0,A,0,1),i.ab.mat4.translate(x,x,[R,N,0])}return new np(l.tileID,r.key,x)}_findTileCoveringTileID(r,l){let m=l.getTile(r);if(m&&m.hasData())return m;const x=this._findCoveringTileCache[l.id],b=x[r.key];if(m=b?l.getTileByID(b):null,m&&m.hasData()||b===null)return m;let A=m?m.tileID:r,R=A.overscaledZ;const N=l.getSource().minzoom,U=[];if(!b){const Z=l.getSource().maxzoom;if(r.canonical.z>=Z){const W=r.canonical.z-Z;l.getSource().reparseOverscaled?(R=Math.max(r.canonical.z+2,l.transform.tileZoom),A=new i.aG(R,r.wrap,Z,r.canonical.x>>W,r.canonical.y>>W)):W!==0&&(R=Z,A=new i.aG(R,r.wrap,Z,r.canonical.x>>W,r.canonical.y>>W))}A.key!==r.key&&(U.push(A.key),m=l.getTile(A))}const $=Z=>{U.forEach(W=>{x[W]=Z}),U.length=0};for(R-=1;R>=N&&(!m||!m.hasData());R--){m&&$(m.tileID.key);const Z=A.calculateScaledKey(R);if(m=l.getTileByID(Z),m&&m.hasData())break;const W=x[Z];if(W===null)break;W===void 0?U.push(Z):m=l.getTileByID(W)}return $(m?m.tileID.key:null),m&&m.hasData()?m:null}findDEMTileFor(r){return this.enabled?this._findTileCoveringTileID(r,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(r,l){let m=this._tilesDirty[r];m||(m=this._tilesDirty[r]={}),m[l.key]=!0}}function Il(p,r,l){const m=function(R,N,U){const $=i.ab.vec3.dot(N,R),Z=i.ab.vec3.dot(U,[.2126,.7152,.0722]),W=(ue,oe,de)=>(1-de)*ue+de*oe,ee=W(1-.3*Math.min(Z,1),1,Math.min($+1,1));return W(.92,1,Math.asin(i.aw(N[2],-1,1))/Math.PI+.5)*ee}(p,[0,0,1],r),x=[0,0,0];i.ab.vec3.scale(x,l.slice(0,3),m);const b=[0,0,0];i.ab.vec3.scale(b,r.slice(0,3),p[2]);const A=[0,0,0];return i.ab.vec3.add(A,x,b),i.cf(A)}const xa=["fill","fillOutline","fillPattern","line","linePattern","background","backgroundPattern","hillshade","raster"],If=["stars","rainParticle","snowParticle","fillExtrusion","fillExtrusionGroundEffect","model","symbol"];class k0{static cacheKey(r,l,m,x){let b=`${l}${x?x.cacheKey:""}`;for(const A of m)r.usedDefines.includes(A)&&(b+=`/${A}`);return b}constructor(r,l,m,x,b,A){const R=r.gl;this.program=R.createProgram(),this.configuration=x,this.name=l,this.fixedDefines=[...A];const N=x?x.getBinderAttributes():[],U=(m.staticAttributes||[]).concat(N);let $=x?x.defines():[];$=$.concat(A.map(de=>`#define ${de}`));const Z=`#version 300 es
`;let W=Z+$.concat("precision mediump float;",fu,hu.fragmentSource).join(`
`);for(const de of m.fragmentIncludes)W+=`
${pc[de]}`;W+=`
${m.fragmentSource}`;let ee=Z+$.concat("precision highp float;",fu,hu.vertexSource).join(`
`);for(const de of m.vertexIncludes)ee+=`
${pc[de]}`;this.forceManualRenderingForInstanceIDShaders=r.forceManualRenderingForInstanceIDShaders&&m.vertexSource.indexOf("gl_InstanceID")!==-1,this.forceManualRenderingForInstanceIDShaders&&(ee+=`
uniform int u_instanceID;
`),ee+=`
${m.vertexSource}`,this.forceManualRenderingForInstanceIDShaders&&(ee=ee.replaceAll("gl_InstanceID","u_instanceID"));const ue=R.createShader(R.FRAGMENT_SHADER);if(R.isContextLost())return void(this.failedToCreate=!0);R.shaderSource(ue,W),R.compileShader(ue),R.attachShader(this.program,ue);const oe=R.createShader(R.VERTEX_SHADER);if(R.isContextLost())this.failedToCreate=!0;else{R.shaderSource(oe,ee),R.compileShader(oe),R.attachShader(this.program,oe),this.attributes={},this.numAttributes=U.length;for(let de=0;de<this.numAttributes;de++)if(U[de]){const fe=U[de].startsWith("a_")?U[de]:`a_${U[de]}`;R.bindAttribLocation(this.program,de,fe),this.attributes[fe]=de}R.linkProgram(this.program),R.deleteShader(oe),R.deleteShader(ue),this.fixedUniforms=b(r),this.binderUniforms=x?x.getUniforms(r):[],this.forceManualRenderingForInstanceIDShaders&&(this.instancingUniforms=(de=>({u_instanceID:new i.bN(de)}))(r)),(A.includes("TERRAIN")||l.indexOf("symbol")!==-1||l.indexOf("circle")!==-1)&&(this.terrainUniforms=(de=>({u_dem:new i.bN(de),u_dem_prev:new i.bN(de),u_dem_tl:new i.bK(de),u_dem_scale:new i.bM(de),u_dem_tl_prev:new i.bK(de),u_dem_scale_prev:new i.bM(de),u_dem_size:new i.bM(de),u_dem_lerp:new i.bM(de),u_exaggeration:new i.bM(de),u_depth:new i.bN(de),u_depth_size_inv:new i.bK(de),u_depth_range_unpack:new i.bK(de),u_occluder_half_size:new i.bM(de),u_occlusion_depth_offset:new i.bM(de),u_meter_to_dem:new i.bM(de),u_label_plane_matrix_inv:new i.bJ(de)}))(r)),A.includes("GLOBE")&&(this.globeUniforms=(de=>({u_tile_tl_up:new i.bL(de),u_tile_tr_up:new i.bL(de),u_tile_br_up:new i.bL(de),u_tile_bl_up:new i.bL(de),u_tile_up_scale:new i.bM(de)}))(r)),A.includes("FOG")&&(this.fogUniforms=(de=>({u_fog_matrix:new i.bJ(de),u_fog_range:new i.bK(de),u_fog_color:new i.ca(de),u_fog_horizon_blend:new i.bM(de),u_fog_vertical_limit:new i.bK(de),u_fog_temporal_offset:new i.bM(de),u_frustum_tl:new i.bL(de),u_frustum_tr:new i.bL(de),u_frustum_br:new i.bL(de),u_frustum_bl:new i.bL(de),u_globe_pos:new i.bL(de),u_globe_radius:new i.bM(de),u_globe_transition:new i.bM(de),u_is_globe:new i.bN(de),u_viewport:new i.bK(de)}))(r)),A.includes("RENDER_CUTOFF")&&(this.cutoffUniforms=(de=>({u_cutoff_params:new i.ca(de)}))(r)),A.includes("LIGHTING_3D_MODE")&&(this.lightsUniforms=(de=>({u_lighting_ambient_color:new i.bL(de),u_lighting_directional_dir:new i.bL(de),u_lighting_directional_color:new i.bL(de),u_ground_radiance:new i.bL(de)}))(r)),A.includes("RENDER_SHADOWS")&&(this.shadowUniforms=(de=>({u_light_matrix_0:new i.bJ(de),u_light_matrix_1:new i.bJ(de),u_fade_range:new i.bK(de),u_shadow_normal_offset:new i.bL(de),u_shadow_intensity:new i.bM(de),u_shadow_texel_size:new i.bM(de),u_shadow_map_resolution:new i.bM(de),u_shadow_direction:new i.bL(de),u_shadow_bias:new i.bL(de),u_shadowmap_0:new i.bN(de),u_shadowmap_1:new i.bN(de)}))(r))}}setTerrainUniformValues(r,l){if(!this.terrainUniforms)return;const m=this.terrainUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const x in l)m[x]&&m[x].set(this.program,x,l[x])}}setGlobeUniformValues(r,l){if(!this.globeUniforms)return;const m=this.globeUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const x in l)m[x]&&m[x].set(this.program,x,l[x])}}setFogUniformValues(r,l){if(!this.fogUniforms)return;const m=this.fogUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const x in l)m[x].set(this.program,x,l[x])}}setCutoffUniformValues(r,l){if(!this.cutoffUniforms)return;const m=this.cutoffUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const x in l)m[x].set(this.program,x,l[x])}}setLightsUniformValues(r,l){if(!this.lightsUniforms)return;const m=this.lightsUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const x in l)m[x].set(this.program,x,l[x])}}setShadowUniformValues(r,l){if(this.failedToCreate||!this.shadowUniforms)return;const m=this.shadowUniforms;r.program.set(this.program);for(const x in l)m[x].set(this.program,x,l[x])}_drawDebugWireframe(r,l,m,x,b,A,R,N,U,$){const Z=r.options.wireframe;if(Z.terrain===!1&&Z.layers2D===!1&&Z.layers3D===!1)return;const W=r.context;if(!(!(!Z.terrain||this.name!=="terrainRaster"&&this.name!=="globeRaster")||!(!Z.layers2D||r._terrain&&r._terrain.renderingToTexture||!xa.includes(this.name))||!(!Z.layers3D||!If.includes(this.name))))return;const ee=W.gl,ue=r.wireframeDebugCache.getLinesFromTrianglesBuffer(r.frameCounter,b,W);if(!ue)return;const oe=[...this.fixedDefines];oe.push("DEBUG_WIREFRAME");const de=r.getOrCreateProgram(this.name,{config:this.configuration,defines:oe});W.program.set(de.program);const fe=(Oe,Fe,Re)=>{if(Fe[Oe]&&Re[Oe])for(const ke in Fe[Oe])Re[Oe][ke]&&Re[Oe][ke].set(Re.program,ke,Fe[Oe][ke].current)};U&&U.setUniforms(de.program,W,de.binderUniforms,R,{zoom:N}),fe("fixedUniforms",this,de),fe("terrainUniforms",this,de),fe("globeUniforms",this,de),fe("fogUniforms",this,de),fe("lightsUniforms",this,de),fe("shadowUniforms",this,de),ue.bind(),W.setColorMode(new Jn([ee.ONE,ee.ONE_MINUS_SRC_ALPHA,ee.ZERO,ee.ONE],i.aj.transparent,[!0,!0,!0,!1])),W.setDepthMode(new Tn(l.func===ee.LESS?ee.LEQUAL:l.func,Tn.ReadOnly,l.range)),W.setStencilMode(Dn.disabled);const Te=3*A.primitiveLength*2,Pe=3*A.primitiveOffset*2*2;if(this.forceManualRenderingForInstanceIDShaders){const Oe=$||1;for(let Fe=0;Fe<Oe;++Fe)de.instancingUniforms.u_instanceID.set(this.program,"u_instanceID",Fe),ee.drawElements(ee.LINES,Te,ee.UNSIGNED_SHORT,Pe)}else $&&$>1?ee.drawElementsInstanced(ee.LINES,Te,ee.UNSIGNED_SHORT,Pe,$):ee.drawElements(ee.LINES,Te,ee.UNSIGNED_SHORT,Pe);b.bind(),W.program.set(this.program),W.setDepthMode(l),W.setStencilMode(m),W.setColorMode(x)}checkUniforms(r,l,m){if(this.fixedDefines.includes(l)){for(const x of Object.keys(m))if(!m[x].initialized)throw new Error(`Program '${this.name}', from draw '${r}': uniform ${x} not set but required by ${l} being defined`)}}draw(r,l,m,x,b,A,R,N,U,$,Z,W,ee,ue,oe,de){const fe=r.context,Te=fe.gl;if(this.failedToCreate)return;fe.program.set(this.program),fe.setDepthMode(m),fe.setStencilMode(x),fe.setColorMode(b),fe.setCullFace(A);for(const Fe of Object.keys(this.fixedUniforms))this.fixedUniforms[Fe].set(this.program,Fe,R[Fe]);ue&&ue.setUniforms(this.program,fe,this.binderUniforms,W,{zoom:ee});const Pe={[Te.POINTS]:1,[Te.LINES]:2,[Te.TRIANGLES]:3,[Te.LINE_STRIP]:1}[l];this.checkUniforms(N,"RENDER_SHADOWS",this.shadowUniforms);const Oe=de&&de>0?1:void 0;for(const Fe of Z.get()){const Re=Fe.vaos||(Fe.vaos={});if((Re[N]||(Re[N]=new du)).bind(fe,this,U,ue?ue.getPaintVertexBuffers():[],$,Fe.vertexOffset,oe||[],Oe),this.forceManualRenderingForInstanceIDShaders){const ke=de||1;for(let De=0;De<ke;++De)this.instancingUniforms.u_instanceID.set(this.program,"u_instanceID",De),$?Te.drawElements(l,Fe.primitiveLength*Pe,Te.UNSIGNED_SHORT,Fe.primitiveOffset*Pe*2):Te.drawArrays(l,Fe.vertexOffset,Fe.vertexLength)}else de&&de>1?Te.drawElementsInstanced(l,Fe.primitiveLength*Pe,Te.UNSIGNED_SHORT,Fe.primitiveOffset*Pe*2,de):$?Te.drawElements(l,Fe.primitiveLength*Pe,Te.UNSIGNED_SHORT,Fe.primitiveOffset*Pe*2):Te.drawArrays(l,Fe.vertexOffset,Fe.vertexLength);l===Te.TRIANGLES&&$&&this._drawDebugWireframe(r,m,x,b,$,Fe,W,ee,ue,de)}}}function rp(p,r){const l=Math.pow(2,r.tileID.overscaledZ),m=r.tileSize*Math.pow(2,p.transform.tileZoom)/l,x=m*(r.tileID.canonical.x+r.tileID.wrap*l),b=m*r.tileID.canonical.y;return{u_image:0,u_texsize:r.imageAtlasTexture?r.imageAtlasTexture.size:[0,0],u_tile_units_to_pixels:1/i.ar(r,1,p.transform.tileZoom),u_pixel_coord_upper:[x>>16,b>>16],u_pixel_coord_lower:[65535&x,65535&b]}}const gh={terrain:0,flat:1},Ri=i.ab.mat4.create(),yh=(p,r,l,m,x,b,A,R,N,U,$,Z,W,ee,ue,oe,de,fe)=>{const Te=r.style.light,Pe=Te.properties.get("position"),Oe=[Pe.x,Pe.y,Pe.z],Fe=i.ab.mat3.create();Te.properties.get("anchor")==="viewport"&&(i.ab.mat3.fromRotation(Fe,-r.transform.angle),i.ab.vec3.transformMat3(Oe,Oe,Fe));const Re=Te.properties.get("color"),ke=r.transform,De={u_matrix:p,u_lightpos:Oe,u_lightintensity:Te.properties.get("intensity"),u_lightcolor:[Re.r,Re.g,Re.b],u_vertical_gradient:+l,u_opacity:m,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Ri,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_height_type:gh[U],u_base_type:gh[$],u_ao:x,u_edge_radius:b,u_width_scale:A,u_flood_light_color:ue,u_vertical_scale:oe,u_flood_light_intensity:de,u_ground_shadow_factor:fe};return ke.projection.name==="globe"&&(De.u_tile_id=[R.canonical.x,R.canonical.y,1<<R.canonical.z],De.u_zoom_transition=Z,De.u_inv_rot_matrix=ee,De.u_merc_center=W,De.u_up_dir=ke.projection.upVector(new i.bT(0,0,0),W[0]*i.ag,W[1]*i.ag),De.u_height_lift=N),De},Pl=(p,r,l,m,x,b)=>({u_matrix:p,u_edge_radius:r,u_width_scale:l,u_vertical_scale:m,u_height_type:gh[x],u_base_type:gh[b]}),vh=(p,r,l,m,x,b,A,R,N,U,$,Z,W,ee,ue,oe,de)=>{const fe=yh(p,r,l,m,x,b,A,R,U,$,Z,W,ee,ue,oe,de,1,[0,0,0]),Te={u_height_factor:-Math.pow(2,R.overscaledZ)/N.tileSize/8};return i.l(fe,rp(r,N),Te)},xu=(p,r)=>({u_matrix:p,u_emissive_strength:r}),Qs=(p,r,l,m)=>i.l(xu(p,r),rp(l,m)),bc=(p,r,l)=>({u_matrix:p,u_world:l,u_emissive_strength:r}),B0=(p,r,l,m,x)=>i.l(Qs(p,r,l,m),{u_world:x}),N0=(p,r,l,m)=>{const x=i.ag/l.tileSize;return{u_matrix:p,u_camera_to_center_distance:r.getCameraToCenterDistance(m),u_extrude_scale:[r.pixelsToGLUnits[0]/x,r.pixelsToGLUnits[1]/x]}},bu=(p,r,l=1)=>({u_matrix:p,u_color:r.toRenderColor(null),u_overlay:0,u_overlay_scale:l}),Pf=i.ab.mat4.create(),hn=(p,r,l,m,x,b,A)=>{const R=p.transform,N=R.projection.name==="globe",U=N?i.cN(R.zoom,r.canonical)*R._pixelsPerMercatorPixel:i.ar(l,1,b),$={u_matrix:r.projMatrix,u_extrude_scale:U,u_intensity:A,u_inv_rot_matrix:Pf,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(N){$.u_inv_rot_matrix=m,$.u_merc_center=x,$.u_tile_id=[r.canonical.x,r.canonical.y,1<<r.canonical.z],$.u_zoom_transition=i.ae(R.zoom);const Z=x[0]*i.ag,W=x[1]*i.ag;$.u_up_dir=R.projection.upVector(new i.bT(0,0,0),Z,W)}return $};function Rf(p,[r,l,m,x],[b,A]){if(b===A)return[0,0,0,0];const R=255*(p-1)/(p*(A-b));return[r*R,l*R,m*R,x*R]}function xh(p,r,[l,m]){return l===m?0:.5/p+(r-l)*(p-1)/(p*(m-l))}const Rl=(p,r,l,m,x,b,A,R,N,U,$,Z,W,ee,ue,oe,de,fe,Te,Pe,Oe)=>({u_matrix:p,u_normalize_matrix:r,u_globe_matrix:l,u_merc_matrix:m,u_grid_matrix:x,u_tl_parent:b,u_scale_parent:U,u_fade_t:$.mix,u_opacity:$.opacity*Z.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:Z.paint.get("raster-brightness-min"),u_brightness_high:Z.paint.get("raster-brightness-max"),u_saturation_factor:i.cO(Z.paint.get("raster-saturation")),u_contrast_factor:i.cP(Z.paint.get("raster-contrast")),u_spin_weights:Eo(Z.paint.get("raster-hue-rotate")),u_perspective_transform:W,u_raster_elevation:ee,u_zoom_transition:A,u_merc_center:R,u_cutoff_params:N,u_colorization_mix:Rf(i.cQ,oe,fe),u_colorization_offset:xh(i.cQ,de,fe),u_color_ramp:ue,u_texture_offset:[Pe/(Te+2*Pe),Te/(Te+2*Pe)],u_texture_res:[Te+2*Pe,Te+2*Pe],u_emissive_strength:Oe});function Eo(p){p*=Math.PI/180;const r=Math.sin(p),l=Math.cos(p);return[(2*l+1)/3,(-Math.sqrt(3)*r-l+1)/3,(Math.sqrt(3)*r-l+1)/3]}const Yt=.05,ti=(p,r,l,m,x,b,A,R,N,U,$,Z)=>({u_matrix:p,u_normalize_matrix:r,u_globe_matrix:l,u_merc_matrix:m,u_grid_matrix:x,u_tl_parent:b,u_scale_parent:U,u_fade_t:$.mix,u_opacity:$.opacity,u_image0:0,u_image1:1,u_raster_elevation:Z,u_zoom_transition:A,u_merc_center:R,u_cutoff_params:N}),ra=(p,r,l,m,x,b,A,R,N,U)=>({u_particle_texture:p,u_particle_texture_side_len:r,u_tile_offset:l,u_velocity:m,u_color_ramp:b,u_velocity_res:x,u_max_speed:A,u_uv_offset:R,u_data_scale:[255*N[0],255*N[1]],u_data_offset:U,u_particle_pos_scale:1.1,u_particle_pos_offset:[Yt,Yt]}),ip=(p,r,l,m,x,b,A,R,N,U)=>({u_particle_texture:p,u_particle_texture_side_len:r,u_velocity:l,u_velocity_res:m,u_max_speed:x,u_speed_factor:b,u_reset_rate:A,u_rand_seed:Math.random(),u_uv_offset:R,u_data_scale:[255*N[0],255*N[1]],u_data_offset:U,u_particle_pos_scale:1.1,u_particle_pos_offset:[Yt,Yt]}),Dl=i.ab.mat4.create(),Ll=(p,r,l,m,x,b,A,R,N,U,$,Z,W,ee,ue,oe,de,fe,Te,Pe,Oe,Fe)=>{const Re=x.transform,ke={u_is_size_zoom_constant:+(p==="constant"||p==="source"),u_is_size_feature_constant:+(p==="constant"||p==="camera"),u_size_t:r?r.uSizeT:0,u_size:r?r.uSize:0,u_camera_to_center_distance:Re.getCameraToCenterDistance(Te),u_rotate_symbol:+l,u_aspect_ratio:Re.width/Re.height,u_fade_change:x.options.fadeDuration?x.symbolFadeChange:1,u_matrix:b,u_label_plane_matrix:A,u_coord_matrix:R,u_is_text:+U,u_elevation_from_sea:N?1:0,u_pitch_with_map:+m,u_texsize:$,u_texsize_icon:Z,u_texture:0,u_texture_icon:1,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Dl,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:Dl,u_up_vector:[0,-1,0],u_color_adj_mat:Pe,u_icon_transition:Oe||0,u_gamma_scale:m?x.transform.getCameraToCenterDistance(Te)*Math.cos(x.terrain?0:x.transform._pitch):1,u_device_pixel_ratio:i.q.devicePixelRatio,u_is_halo:1,u_scale_factor:Fe||1};return Te.name==="globe"&&(ke.u_tile_id=[ee.canonical.x,ee.canonical.y,1<<ee.canonical.z],ke.u_zoom_transition=ue,ke.u_inv_rot_matrix=de,ke.u_merc_center=oe,ke.u_camera_forward=Re._camera.forward(),ke.u_ecef_origin=i.cR(Re.globeMatrix,ee.toUnwrapped()),ke.u_tile_matrix=Float32Array.from(Re.globeMatrix),ke.u_up_vector=fe),ke},bh=(p,r,l,m)=>({u_matrix:p,u_emissive_strength:r,u_opacity:l,u_color:m}),wh=(p,r,l,m,x,b,A,R,N)=>i.l(function(U,$,Z,W,ee,ue){const{width:oe,height:de}=W.imageManager.getPixelSize($),fe=Math.pow(2,ue.tileID.overscaledZ),Te=ue.tileSize*Math.pow(2,W.transform.tileZoom)/fe,Pe=Te*(ue.tileID.canonical.x+ue.tileID.wrap*fe),Oe=Te*ue.tileID.canonical.y;return{u_image:0,u_pattern_tl:Z.tl,u_pattern_br:Z.br,u_texsize:[oe,de],u_pattern_size:Z.displaySize,u_pattern_units_to_pixels:ee?[W.transform.width,-1*W.transform.height]:[1/i.ar(ue,1,W.transform.tileZoom),1/i.ar(ue,1,W.transform.tileZoom)],u_pixel_coord_upper:[Pe>>16,Oe>>16],u_pixel_coord_lower:[65535&Pe,65535&Oe]}}(0,b,A,m,R,N),{u_matrix:p,u_emissive_strength:r,u_opacity:l}),wc=new Float32Array(i.ab.mat4.identity([])),Df=(p,r,l,m,x,b,A,R,N,U,$,Z,W,ee=[0,0,0],ue)=>{const oe=x.style.light,de=oe.properties.get("position"),fe=[-de.x,-de.y,de.z],Te=i.ab.mat3.create();oe.properties.get("anchor")==="viewport"&&(i.ab.mat3.fromRotation(Te,-x.transform.angle),i.ab.vec3.transformMat3(fe,fe,Te));const Pe=$.alphaMode==="MASK",Oe=oe.properties.get("color").toRenderColor(null),Fe=W.paint.get("model-ambient-occlusion-intensity"),Re=W.paint.get("model-color").constantOr(i.aj.white).toRenderColor(null),ke=W.paint.get("model-color-mix-intensity").constantOr(0);return{u_matrix:p,u_lighting_matrix:r,u_normal_matrix:l,u_node_matrix:m||wc,u_lightpos:fe,u_lightintensity:oe.properties.get("intensity"),u_lightcolor:[Oe.r,Oe.g,Oe.b],u_camera_pos:ee,u_opacity:b,u_baseTextureIsAlpha:0,u_alphaMask:+Pe,u_alphaCutoff:$.alphaCutoff,u_baseColorFactor:[A.r,A.g,A.b,A.a],u_emissiveFactor:[R[0],R[1],R[2],1],u_metallicFactor:N,u_roughnessFactor:U,u_baseColorTexture:na.BaseColor,u_metallicRoughnessTexture:na.MetallicRoughness,u_normalTexture:na.Normal,u_occlusionTexture:na.Occlusion,u_emissionTexture:na.Emission,u_lutTexture:na.LUT,u_color_mix:[Re.r,Re.g,Re.b,ke],u_aoIntensity:Fe,u_emissive_strength:Z,u_occlusionTextureTransform:ue||[0,0,0,0]}},Di=(p,r=wc,l=wc)=>({u_matrix:p,u_instance:r,u_node_matrix:l}),Lf={fillExtrusion:p=>({u_matrix:new i.bJ(p),u_lightpos:new i.bL(p),u_lightintensity:new i.bM(p),u_lightcolor:new i.bL(p),u_vertical_gradient:new i.bM(p),u_opacity:new i.bM(p),u_edge_radius:new i.bM(p),u_width_scale:new i.bM(p),u_ao:new i.bK(p),u_height_type:new i.bN(p),u_base_type:new i.bN(p),u_tile_id:new i.bL(p),u_zoom_transition:new i.bM(p),u_inv_rot_matrix:new i.bJ(p),u_merc_center:new i.bK(p),u_up_dir:new i.bL(p),u_height_lift:new i.bM(p),u_flood_light_color:new i.bL(p),u_vertical_scale:new i.bM(p),u_flood_light_intensity:new i.bM(p),u_ground_shadow_factor:new i.bL(p)}),fillExtrusionDepth:p=>({u_matrix:new i.bJ(p),u_edge_radius:new i.bM(p),u_width_scale:new i.bM(p),u_vertical_scale:new i.bM(p),u_height_type:new i.bN(p),u_base_type:new i.bN(p)}),fillExtrusionPattern:p=>({u_matrix:new i.bJ(p),u_lightpos:new i.bL(p),u_lightintensity:new i.bM(p),u_lightcolor:new i.bL(p),u_vertical_gradient:new i.bM(p),u_height_factor:new i.bM(p),u_edge_radius:new i.bM(p),u_width_scale:new i.bM(p),u_ao:new i.bK(p),u_height_type:new i.bN(p),u_base_type:new i.bN(p),u_tile_id:new i.bL(p),u_zoom_transition:new i.bM(p),u_inv_rot_matrix:new i.bJ(p),u_merc_center:new i.bK(p),u_up_dir:new i.bL(p),u_height_lift:new i.bM(p),u_image:new i.bN(p),u_texsize:new i.bK(p),u_pixel_coord_upper:new i.bK(p),u_pixel_coord_lower:new i.bK(p),u_tile_units_to_pixels:new i.bM(p),u_opacity:new i.bM(p)}),fillExtrusionGroundEffect:p=>({u_matrix:new i.bJ(p),u_opacity:new i.bM(p),u_ao_pass:new i.bM(p),u_meter_to_tile:new i.bM(p),u_ao:new i.bK(p),u_flood_light_intensity:new i.bM(p),u_flood_light_color:new i.bL(p),u_attenuation:new i.bM(p),u_edge_radius:new i.bM(p),u_fb:new i.bN(p),u_fb_size:new i.bM(p),u_dynamic_offset:new i.bM(p)}),fill:p=>({u_matrix:new i.bJ(p),u_emissive_strength:new i.bM(p)}),fillPattern:p=>({u_matrix:new i.bJ(p),u_emissive_strength:new i.bM(p),u_image:new i.bN(p),u_texsize:new i.bK(p),u_pixel_coord_upper:new i.bK(p),u_pixel_coord_lower:new i.bK(p),u_tile_units_to_pixels:new i.bM(p)}),fillOutline:p=>({u_matrix:new i.bJ(p),u_emissive_strength:new i.bM(p),u_world:new i.bK(p)}),fillOutlinePattern:p=>({u_matrix:new i.bJ(p),u_emissive_strength:new i.bM(p),u_world:new i.bK(p),u_image:new i.bN(p),u_texsize:new i.bK(p),u_pixel_coord_upper:new i.bK(p),u_pixel_coord_lower:new i.bK(p),u_tile_units_to_pixels:new i.bM(p)}),circle:i.cS,collisionBox:p=>({u_matrix:new i.bJ(p),u_camera_to_center_distance:new i.bM(p),u_extrude_scale:new i.bK(p)}),collisionCircle:p=>({u_matrix:new i.bJ(p),u_inv_matrix:new i.bJ(p),u_camera_to_center_distance:new i.bM(p),u_viewport_size:new i.bK(p)}),debug:p=>({u_color:new i.cz(p),u_matrix:new i.bJ(p),u_overlay:new i.bN(p),u_overlay_scale:new i.bM(p)}),clippingMask:p=>({u_matrix:new i.bJ(p)}),heatmap:p=>({u_extrude_scale:new i.bM(p),u_intensity:new i.bM(p),u_matrix:new i.bJ(p),u_inv_rot_matrix:new i.bJ(p),u_merc_center:new i.bK(p),u_tile_id:new i.bL(p),u_zoom_transition:new i.bM(p),u_up_dir:new i.bL(p)}),heatmapTexture:p=>({u_image:new i.bN(p),u_color_ramp:new i.bN(p),u_opacity:new i.bM(p)}),hillshade:p=>({u_matrix:new i.bJ(p),u_image:new i.bN(p),u_latrange:new i.bK(p),u_light:new i.bK(p),u_shadow:new i.cz(p),u_highlight:new i.cz(p),u_emissive_strength:new i.bM(p),u_accent:new i.cz(p)}),hillshadePrepare:p=>({u_matrix:new i.bJ(p),u_image:new i.bN(p),u_dimension:new i.bK(p),u_zoom:new i.bM(p)}),line:i.cT,linePattern:i.cU,raster:p=>({u_matrix:new i.bJ(p),u_normalize_matrix:new i.bJ(p),u_globe_matrix:new i.bJ(p),u_merc_matrix:new i.bJ(p),u_grid_matrix:new i.cA(p),u_tl_parent:new i.bK(p),u_scale_parent:new i.bM(p),u_fade_t:new i.bM(p),u_opacity:new i.bM(p),u_image0:new i.bN(p),u_image1:new i.bN(p),u_brightness_low:new i.bM(p),u_brightness_high:new i.bM(p),u_saturation_factor:new i.bM(p),u_contrast_factor:new i.bM(p),u_spin_weights:new i.bL(p),u_perspective_transform:new i.bK(p),u_raster_elevation:new i.bM(p),u_zoom_transition:new i.bM(p),u_merc_center:new i.bK(p),u_cutoff_params:new i.ca(p),u_colorization_mix:new i.ca(p),u_colorization_offset:new i.bM(p),u_color_ramp:new i.bN(p),u_texture_offset:new i.bK(p),u_texture_res:new i.bK(p),u_emissive_strength:new i.bM(p)}),rasterParticle:p=>({u_matrix:new i.bJ(p),u_normalize_matrix:new i.bJ(p),u_globe_matrix:new i.bJ(p),u_merc_matrix:new i.bJ(p),u_grid_matrix:new i.cA(p),u_tl_parent:new i.bK(p),u_scale_parent:new i.bM(p),u_fade_t:new i.bM(p),u_opacity:new i.bM(p),u_image0:new i.bN(p),u_image1:new i.bN(p),u_raster_elevation:new i.bM(p),u_zoom_transition:new i.bM(p),u_merc_center:new i.bK(p),u_cutoff_params:new i.ca(p)}),rasterParticleTexture:p=>({u_texture:new i.bN(p),u_opacity:new i.bM(p)}),rasterParticleDraw:p=>({u_particle_texture:new i.bN(p),u_particle_texture_side_len:new i.bM(p),u_tile_offset:new i.bK(p),u_velocity:new i.bN(p),u_color_ramp:new i.bN(p),u_velocity_res:new i.bK(p),u_max_speed:new i.bM(p),u_uv_offset:new i.bK(p),u_data_scale:new i.bK(p),u_data_offset:new i.bM(p),u_particle_pos_scale:new i.bM(p),u_particle_pos_offset:new i.bK(p)}),rasterParticleUpdate:p=>({u_particle_texture:new i.bN(p),u_particle_texture_side_len:new i.bM(p),u_velocity:new i.bN(p),u_velocity_res:new i.bK(p),u_max_speed:new i.bM(p),u_speed_factor:new i.bM(p),u_reset_rate:new i.bM(p),u_rand_seed:new i.bM(p),u_uv_offset:new i.bK(p),u_data_scale:new i.bK(p),u_data_offset:new i.bM(p),u_particle_pos_scale:new i.bM(p),u_particle_pos_offset:new i.bK(p)}),symbol:p=>({u_is_size_zoom_constant:new i.bN(p),u_is_size_feature_constant:new i.bN(p),u_size_t:new i.bM(p),u_size:new i.bM(p),u_camera_to_center_distance:new i.bM(p),u_rotate_symbol:new i.bN(p),u_aspect_ratio:new i.bM(p),u_fade_change:new i.bM(p),u_matrix:new i.bJ(p),u_label_plane_matrix:new i.bJ(p),u_coord_matrix:new i.bJ(p),u_is_text:new i.bN(p),u_elevation_from_sea:new i.bN(p),u_pitch_with_map:new i.bN(p),u_texsize:new i.bK(p),u_texsize_icon:new i.bK(p),u_texture:new i.bN(p),u_texture_icon:new i.bN(p),u_gamma_scale:new i.bM(p),u_device_pixel_ratio:new i.bM(p),u_tile_id:new i.bL(p),u_zoom_transition:new i.bM(p),u_inv_rot_matrix:new i.bJ(p),u_merc_center:new i.bK(p),u_camera_forward:new i.bL(p),u_tile_matrix:new i.bJ(p),u_up_vector:new i.bL(p),u_ecef_origin:new i.bL(p),u_is_halo:new i.bN(p),u_icon_transition:new i.bM(p),u_color_adj_mat:new i.bJ(p),u_scale_factor:new i.bM(p)}),background:p=>({u_matrix:new i.bJ(p),u_emissive_strength:new i.bM(p),u_opacity:new i.bM(p),u_color:new i.cz(p)}),backgroundPattern:p=>({u_matrix:new i.bJ(p),u_emissive_strength:new i.bM(p),u_opacity:new i.bM(p),u_image:new i.bN(p),u_pattern_tl:new i.bK(p),u_pattern_br:new i.bK(p),u_texsize:new i.bK(p),u_pattern_size:new i.bK(p),u_pixel_coord_upper:new i.bK(p),u_pixel_coord_lower:new i.bK(p),u_pattern_units_to_pixels:new i.bK(p)}),terrainRaster:p=>({u_matrix:new i.bJ(p),u_image0:new i.bN(p),u_skirt_height:new i.bM(p),u_ground_shadow_factor:new i.bL(p)}),skybox:p=>({u_matrix:new i.bJ(p),u_sun_direction:new i.bL(p),u_cubemap:new i.bN(p),u_opacity:new i.bM(p),u_temporal_offset:new i.bM(p)}),skyboxGradient:p=>({u_matrix:new i.bJ(p),u_color_ramp:new i.bN(p),u_center_direction:new i.bL(p),u_radius:new i.bM(p),u_opacity:new i.bM(p),u_temporal_offset:new i.bM(p)}),skyboxCapture:p=>({u_matrix_3f:new i.cA(p),u_sun_direction:new i.bL(p),u_sun_intensity:new i.bM(p),u_color_tint_r:new i.ca(p),u_color_tint_m:new i.ca(p),u_luminance:new i.bM(p)}),globeRaster:p=>({u_proj_matrix:new i.bJ(p),u_globe_matrix:new i.bJ(p),u_normalize_matrix:new i.bJ(p),u_merc_matrix:new i.bJ(p),u_zoom_transition:new i.bM(p),u_merc_center:new i.bK(p),u_image0:new i.bN(p),u_grid_matrix:new i.cA(p),u_skirt_height:new i.bM(p),u_far_z_cutoff:new i.bM(p),u_frustum_tl:new i.bL(p),u_frustum_tr:new i.bL(p),u_frustum_br:new i.bL(p),u_frustum_bl:new i.bL(p),u_globe_pos:new i.bL(p),u_globe_radius:new i.bM(p),u_viewport:new i.bK(p)}),globeAtmosphere:p=>({u_frustum_tl:new i.bL(p),u_frustum_tr:new i.bL(p),u_frustum_br:new i.bL(p),u_frustum_bl:new i.bL(p),u_horizon:new i.bM(p),u_transition:new i.bM(p),u_fadeout_range:new i.bM(p),u_color:new i.ca(p),u_high_color:new i.ca(p),u_space_color:new i.ca(p),u_temporal_offset:new i.bM(p),u_horizon_angle:new i.bM(p)}),model:p=>({u_matrix:new i.bJ(p),u_lighting_matrix:new i.bJ(p),u_normal_matrix:new i.bJ(p),u_node_matrix:new i.bJ(p),u_lightpos:new i.bL(p),u_lightintensity:new i.bM(p),u_lightcolor:new i.bL(p),u_camera_pos:new i.bL(p),u_opacity:new i.bM(p),u_baseColorFactor:new i.ca(p),u_emissiveFactor:new i.ca(p),u_metallicFactor:new i.bM(p),u_roughnessFactor:new i.bM(p),u_baseTextureIsAlpha:new i.bN(p),u_alphaMask:new i.bN(p),u_alphaCutoff:new i.bM(p),u_baseColorTexture:new i.bN(p),u_metallicRoughnessTexture:new i.bN(p),u_normalTexture:new i.bN(p),u_occlusionTexture:new i.bN(p),u_emissionTexture:new i.bN(p),u_lutTexture:new i.bN(p),u_color_mix:new i.ca(p),u_aoIntensity:new i.bM(p),u_emissive_strength:new i.bM(p),u_occlusionTextureTransform:new i.ca(p)}),modelDepth:p=>({u_matrix:new i.bJ(p),u_instance:new i.bJ(p),u_node_matrix:new i.bJ(p)}),groundShadow:p=>({u_matrix:new i.bJ(p),u_ground_shadow_factor:new i.bL(p)}),stars:p=>({u_matrix:new i.bJ(p),u_up:new i.bL(p),u_right:new i.bL(p),u_intensity_multiplier:new i.bM(p)}),snowParticle:p=>({u_modelview:new i.bJ(p),u_projection:new i.bJ(p),u_time:new i.bM(p),u_cam_pos:new i.bL(p),u_velocityConeAperture:new i.bM(p),u_velocity:new i.bM(p),u_horizontalOscillationRadius:new i.bM(p),u_horizontalOscillationRate:new i.bM(p),u_boxSize:new i.bM(p),u_billboardSize:new i.bM(p),u_simpleShapeParameters:new i.bK(p),u_screenSize:new i.bK(p),u_thinningCenterPos:new i.bK(p),u_thinningShape:new i.bL(p),u_thinningAffectedRatio:new i.bM(p),u_thinningParticleOffset:new i.bM(p),u_particleColor:new i.ca(p),u_direction:new i.bL(p)}),rainParticle:p=>({u_modelview:new i.bJ(p),u_projection:new i.bJ(p),u_time:new i.bM(p),u_cam_pos:new i.bL(p),u_texScreen:new i.bN(p),u_velocityConeAperture:new i.bM(p),u_velocity:new i.bM(p),u_boxSize:new i.bM(p),u_rainDropletSize:new i.bK(p),u_distortionStrength:new i.bM(p),u_rainDirection:new i.bL(p),u_color:new i.ca(p),u_screenSize:new i.bK(p),u_thinningCenterPos:new i.bK(p),u_thinningShape:new i.bL(p),u_thinningAffectedRatio:new i.bM(p),u_thinningParticleOffset:new i.bM(p),u_shapeDirectionalPower:new i.bM(p),u_shapeNormalPower:new i.bM(p),u_mode:new i.bM(p)}),vignette:p=>({u_vignetteShape:new i.bL(p),u_vignetteColor:new i.ca(p)}),occlusion:p=>({u_matrix:new i.bJ(p),u_anchorPos:new i.bL(p),u_screenSizePx:new i.bK(p),u_occluderSizePx:new i.bK(p),u_color:new i.ca(p)})};class hs{constructor(r,l,m,x){this.id=hs.uniqueIdxCounter,hs.uniqueIdxCounter++,this.context=r;const b=r.gl;this.buffer=b.createBuffer(),this.dynamicDraw=!!m,this.context.unbindVAO(),r.bindElementBuffer.set(this.buffer),b.bufferData(b.ELEMENT_ARRAY_BUFFER,l.arrayBuffer,this.dynamicDraw?b.DYNAMIC_DRAW:b.STATIC_DRAW),this.dynamicDraw||x||l.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(r){this.id=hs.uniqueIdxCounter,hs.uniqueIdxCounter++;const l=this.context.gl;this.context.unbindVAO(),this.bind(),l.bufferSubData(l.ELEMENT_ARRAY_BUFFER,0,r.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}hs.uniqueIdxCounter=0;const co={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class zl{constructor(r,l,m,x,b,A){this.length=l.length,this.attributes=m,this.itemSize=l.bytesPerElement,this.dynamicDraw=x,this.instanceCount=A,this.context=r;const R=r.gl;this.buffer=R.createBuffer(),r.bindVertexBuffer.set(this.buffer),R.bufferData(R.ARRAY_BUFFER,l.arrayBuffer,this.dynamicDraw?R.DYNAMIC_DRAW:R.STATIC_DRAW),this.dynamicDraw||b||l.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(r){const l=this.context.gl;this.bind(),l.bufferSubData(l.ARRAY_BUFFER,0,r.arrayBuffer)}enableAttributes(r,l){for(let m=0;m<this.attributes.length;m++){const x=l.attributes[this.attributes[m].name];x!==void 0&&r.enableVertexAttribArray(x)}}setVertexAttribPointers(r,l,m){for(let x=0;x<this.attributes.length;x++){const b=this.attributes[x],A=l.attributes[b.name];A!==void 0&&r.vertexAttribPointer(A,b.components,r[co[b.type]],!1,this.itemSize,b.offset+this.itemSize*(m||0))}}setVertexAttribDivisor(r,l,m){for(let x=0;x<this.attributes.length;x++){const b=l.attributes[this.attributes[x].name];b!==void 0&&this.instanceCount&&this.instanceCount>0&&r.vertexAttribDivisor(b,m)}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class _m{constructor(r,l,m,x,b){this.context=r,this.width=l,this.height=m;const A=this.framebuffer=r.gl.createFramebuffer();x&&(this.colorAttachment=new Ol(r,A)),b&&(this.depthAttachmentType=b,this.depthAttachment=b==="renderbuffer"?new yu(r,A):new Of(r,A))}destroy(){const r=this.context.gl;if(this.colorAttachment){const l=this.colorAttachment.get();l&&r.deleteTexture(l)}if(this.depthAttachment&&this.depthAttachmentType)if(this.depthAttachmentType==="renderbuffer"){const l=this.depthAttachment.get();l&&r.deleteRenderbuffer(l)}else{const l=this.depthAttachment.get();l&&r.deleteTexture(l)}r.deleteFramebuffer(this.framebuffer)}}class zf{constructor(r,l){this.gl=r,this.clearColor=new hh(this),this.clearDepth=new bo(this),this.clearStencil=new wo(this),this.colorMask=new Ml(this),this.depthMask=new Xs(this),this.stencilMask=new Ys(this),this.stencilFunc=new _u(this),this.stencilOp=new fh(this),this.stencilTest=new gu(this),this.depthRange=new Wd(this),this.depthTest=new li(this),this.depthFunc=new va(this),this.blend=new Ur(this),this.blendFunc=new So(this),this.blendColor=new cs(this),this.blendEquation=new Cf(this),this.cullFace=new Ks(this),this.cullFaceSide=new Xd(this),this.frontFace=new Yd(this),this.program=new gc(this),this.activeTexture=new dh(this),this.viewport=new ph(this),this.bindFramebuffer=new Js(this),this.bindRenderbuffer=new D0(this),this.bindTexture=new pm(this),this.bindVertexBuffer=new L0(this),this.bindElementBuffer=new Kd(this),this.bindVertexArrayOES=new z0(this),this.pixelStoreUnpack=new Mf(this),this.pixelStoreUnpackPremultiplyAlpha=new Jd(this),this.pixelStoreUnpackFlipY=new yc(this),this.options=l?Object.assign({},l):{},this.options.extTextureFilterAnisotropicForceOff||(this.extTextureFilterAnisotropic=r.getExtension("EXT_texture_filter_anisotropic")||r.getExtension("MOZ_EXT_texture_filter_anisotropic")||r.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=r.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT))),this.extDebugRendererInfo=r.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=r.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=r.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),this.forceManualRenderingForInstanceIDShaders=l&&!!l.forceManualRenderingForInstanceIDShaders||this.renderer&&this.renderer.indexOf("PowerVR")!==-1,this.options.extTextureFloatLinearForceOff||(this.extTextureFloatLinear=r.getExtension("OES_texture_float_linear")),this.extRenderToTextureHalfFloat=r.getExtension("EXT_color_buffer_half_float"),this.extTimerQuery=r.getExtension("EXT_disjoint_timer_query_webgl2"),this.maxTextureSize=r.getParameter(r.MAX_TEXTURE_SIZE),this.maxPointSize=r.getParameter(r.ALIASED_POINT_SIZE_RANGE)[1]}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArrayOES.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(r,l,m){return new hs(this,r,l,m)}createVertexBuffer(r,l,m,x,b){return new zl(this,r,l,m,x,b)}createRenderbuffer(r,l,m){const x=this.gl,b=x.createRenderbuffer();return this.bindRenderbuffer.set(b),x.renderbufferStorage(x.RENDERBUFFER,r,l,m),this.bindRenderbuffer.set(null),b}createFramebuffer(r,l,m,x){return new _m(this,r,l,m,x)}clear({color:r,depth:l,stencil:m,colorMask:x}){const b=this.gl;let A=0;r&&(A|=b.COLOR_BUFFER_BIT,this.clearColor.set(r),this.colorMask.set(x||[!0,!0,!0,!0])),l!==void 0&&(A|=b.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(l),this.depthMask.set(!0)),m!==void 0&&(A|=b.STENCIL_BUFFER_BIT,this.clearStencil.set(m),this.stencilMask.set(255)),b.clear(A)}setCullFace(r){r.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(r.mode),this.frontFace.set(r.frontFace))}setDepthMode(r){r.func!==this.gl.ALWAYS||r.mask?(this.depthTest.set(!0),this.depthFunc.set(r.func),this.depthMask.set(r.mask),this.depthRange.set(r.range)):this.depthTest.set(!1)}setStencilMode(r){r.test.func!==this.gl.ALWAYS||r.mask?(this.stencilTest.set(!0),this.stencilMask.set(r.mask),this.stencilOp.set([r.fail,r.depthFail,r.pass]),this.stencilFunc.set({func:r.test.func,ref:r.ref,mask:r.test.mask})):this.stencilTest.set(!1)}setColorMode(r){i.bn(r.blendFunction,Jn.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(r.blendFunction),this.blendColor.set(r.blendColor),r.blendEquation?this.blendEquation.set(r.blendEquation):this.blendEquation.setDefault()),this.colorMask.set(r.mask)}unbindVAO(){this.bindVertexArrayOES.set(null)}}let Sc;function Sh(p,r,l,m,x,b,A){const R=p.context,N=R.gl,U=p.transform,$=p.getOrCreateProgram("collisionBox"),Z=[];let W=0,ee=0;for(let Oe=0;Oe<m.length;Oe++){const Fe=m[Oe],Re=r.getTile(Fe),ke=Re.getBucket(l);if(!ke)continue;const De=Os(Fe,ke,U);let $e=De;x[0]===0&&x[1]===0||($e=p.translatePosMatrix(De,Re,x,b));const Xe=A?ke.textCollisionBox:ke.iconCollisionBox,ft=ke.collisionCircleArray;if(ft.length>0){const ot=i.ab.mat4.create(),Et=$e;i.ab.mat4.mul(ot,ke.placementInvProjMatrix,U.glCoordMatrix),i.ab.mat4.mul(ot,ot,ke.placementViewportMatrix),Z.push({circleArray:ft,circleOffset:ee,transform:Et,invTransform:ot,projection:ke.getProjection()}),W+=ft.length/4,ee=W}Xe&&(p.terrain&&p.terrain.setupElevationDraw(Re,$),$.draw(p,N.LINES,Tn.disabled,Dn.disabled,p.colorModeForRenderPass(),Rn.disabled,N0($e,U,Re,ke.getProjection()),l.id,Xe.layoutVertexBuffer,Xe.indexBuffer,Xe.segments,null,U.zoom,null,[Xe.collisionVertexBuffer,Xe.collisionVertexBufferExt]))}if(!A||!Z.length)return;const ue=p.getOrCreateProgram("collisionCircle"),oe=new i.cV;oe.resize(4*W),oe._trim();let de=0;for(const Oe of Z)for(let Fe=0;Fe<Oe.circleArray.length/4;Fe++){const Re=4*Fe,ke=Oe.circleArray[Re+0],De=Oe.circleArray[Re+1],$e=Oe.circleArray[Re+2],Xe=Oe.circleArray[Re+3];oe.emplace(de++,ke,De,$e,Xe,0),oe.emplace(de++,ke,De,$e,Xe,1),oe.emplace(de++,ke,De,$e,Xe,2),oe.emplace(de++,ke,De,$e,Xe,3)}(!Sc||Sc.length<2*W)&&(Sc=function(Oe){const Fe=2*Oe,Re=new i.aU;Re.resize(Fe),Re._trim();for(let ke=0;ke<Fe;ke++){const De=6*ke;Re.uint16[De+0]=4*ke+0,Re.uint16[De+1]=4*ke+1,Re.uint16[De+2]=4*ke+2,Re.uint16[De+3]=4*ke+2,Re.uint16[De+4]=4*ke+3,Re.uint16[De+5]=4*ke+0}return Re}(W));const fe=R.createIndexBuffer(Sc,!0),Te=R.createVertexBuffer(oe,i.cW.members,!0);for(const Oe of Z){const Fe={u_matrix:Oe.transform,u_inv_matrix:Oe.invTransform,u_camera_to_center_distance:(Pe=U).getCameraToCenterDistance(Oe.projection),u_viewport_size:[Pe.width,Pe.height]};ue.draw(p,N.TRIANGLES,Tn.disabled,Dn.disabled,p.colorModeForRenderPass(),Rn.disabled,Fe,l.id,Te,fe,i.b7.simpleSegment(0,2*Oe.circleOffset,Oe.circleArray.length,Oe.circleArray.length/2),null,U.zoom)}var Pe;Te.destroy(),fe.destroy()}const Da=i.ab.mat4.create();function Yr(p){const r=p._camera.getWorldToCamera(p.worldSize,1),l=i.ab.mat4.multiply([],r,p.globeMatrix);i.ab.mat4.invert(l,l);const m=[0,0,0],x=[0,1,0,0];return i.ab.vec4.transformMat4(x,x,l),m[0]=x[0],m[1]=x[1],m[2]=x[2],i.ab.vec3.normalize(m,m),m}function kr({width:p,height:r,anchor:l,textOffset:m,textScale:x},b){const{horizontalAlign:A,verticalAlign:R}=i.bD(l),N=-(A-.5)*p,U=-(R-.5)*r,$=i.bC(l,m);return new i.P((N/x+$[0])*b,(U/x+$[1])*b)}function Tc(p,r,l,m,x,b,A,R,N,U,$){const Z=p.text.placedSymbolArray,W=p.text.dynamicLayoutVertexArray,ee=p.icon.dynamicLayoutVertexArray,ue={},oe=p.getProjection(),de=ac(R,oe,b),fe=b.elevation,Te=oe.upVectorScale(R.canonical,b.center.lat,b.worldSize).metersToTile;W.clear();for(let Pe=0;Pe<Z.length;Pe++){const Oe=Z.get(Pe),{tileAnchorX:Fe,tileAnchorY:Re,numGlyphs:ke}=Oe,De=Oe.hidden||!Oe.crossTileID||p.allowVerticalPlacement&&!Oe.placedOrientation?null:m[Oe.crossTileID];if(De){let $e=0,Xe=0,ft=0;if(fe){const mt=fe?fe.getAtTileOffset(R,Fe,Re):0,[Gt,Pt,At]=oe.upVector(R.canonical,Fe,Re);$e=mt*Gt*Te,Xe=mt*Pt*Te,ft=mt*At*Te}let[ot,Et,vt,nt]=ma(Oe.projectedAnchorX+$e,Oe.projectedAnchorY+Xe,Oe.projectedAnchorZ+ft,l?de:A);const pt=Fd(b.getCameraToCenterDistance(oe),nt);let Lt=x.evaluateSizeForFeature(p.textSizeData,U,Oe)*pt/i.bw;l&&(Lt*=p.tilePixelRatio/N);const tt=kr(De,Lt);l?({x:ot,y:Et,z:vt}=oe.projectTilePoint(Fe+tt.x,Re+tt.y,R.canonical),[ot,Et,vt]=ma(ot+$e,Et+Xe,vt+ft,A)):(r&&tt._rotate(-b.angle),ot+=tt.x,Et+=tt.y,vt=0);const St=p.allowVerticalPlacement&&Oe.placedOrientation===i.bq.vertical?Math.PI/2:0;for(let mt=0;mt<ke;mt++)i.bt(W,ot,Et,vt,St);$&&Oe.associatedIconIndex>=0&&(ue[Oe.associatedIconIndex]={x:ot,y:Et,z:vt,angle:St})}else ai(ke,W)}if($){ee.clear();const Pe=p.icon.placedSymbolArray;for(let Oe=0;Oe<Pe.length;Oe++){const Fe=Pe.get(Oe),{numGlyphs:Re}=Fe,ke=ue[Oe];if(Fe.hidden||!ke)ai(Re,ee);else{const{x:De,y:$e,z:Xe,angle:ft}=ke;for(let ot=0;ot<Re;ot++)i.bt(ee,De,$e,Xe,ft)}}p.icon.dynamicLayoutVertexBuffer.updateData(ee)}p.text.dynamicLayoutVertexBuffer.updateData(W)}function Ec(p,r,l,m,x,b,A={}){const R=l.paint.get("icon-translate"),N=l.paint.get("text-translate"),U=l.paint.get("icon-translate-anchor"),$=l.paint.get("text-translate-anchor"),Z=l.layout.get("icon-rotation-alignment"),W=l.layout.get("text-rotation-alignment"),ee=l.layout.get("icon-pitch-alignment"),ue=l.layout.get("text-pitch-alignment"),oe=l.layout.get("icon-keep-upright"),de=l.layout.get("text-keep-upright"),fe=l.paint.get("icon-color-saturation"),Te=l.paint.get("icon-color-contrast"),Pe=l.paint.get("icon-color-brightness-min"),Oe=l.paint.get("icon-color-brightness-max"),Fe=l.layout.get("symbol-elevation-reference")==="sea",Re=p.context,ke=Re.gl,De=p.transform,$e=Z==="map",Xe=W==="map",ft=ee==="map",ot=ue==="map",Et=l.layout.get("symbol-sort-key").constantOr(1)!==void 0;let vt=!1;const nt=p.depthModeForSublayer(0,Tn.ReadOnly),pt=[i.at(De.center.lng),i.aA(De.center.lat)],Lt=l.layout.get("text-variable-anchor"),tt=De.projection.name==="globe",St=[],mt=[0,-1,0];for(const Gt of m){const Pt=r.getTile(Gt),At=Pt.getBucket(l);if(!At||At.projection.name==="mercator"&&tt||At.fullyClipped)continue;const kt=At.projection.name==="globe",Wt=kt?i.ae(De.zoom):0,on=ac(Gt,At.getProjection(),De),dn=De.calculatePixelsToTileUnitsMatrix(Pt),En=Lt&&At.hasTextData(),Sn=At.hasIconTextFit()&&En&&At.hasIconData(),bn=At.getProjection().createInversionMatrix(De,Gt.canonical),Ln=An=>{De.depthOcclusionForSymbolsAndCircles&&(l.hasInitialOcclusionOpacityProperties||p.terrain)&&(An.push("DEPTH_D24"),An.push("DEPTH_OCCLUSION"))},zn=()=>{const An=$e&&l.layout.get("symbol-placement")!=="point",Pn=[];Ln(Pn);const or=An||Sn,Gr=l.paint.get("icon-image-cross-fade").constantOr(0);p.terrainRenderModeElevated()&&ft&&Pn.push("PITCH_WITH_MAP_TERRAIN"),kt&&(Pn.push("PROJECTION_GLOBE_VIEW"),or&&Pn.push("PROJECTED_POS_ON_VIEWPORT")),Gr>0&&Pn.push("ICON_TRANSITION"),At.icon.zOffsetVertexBuffer&&Pn.push("Z_OFFSET"),fe===0&&Te===0&&Pe===0&&Oe===1||Pn.push("COLOR_ADJUSTMENT"),At.sdfIcons&&Pn.push("RENDER_SDF");const Kr=At.icon.programConfigurations.get(l.id),hi=p.getOrCreateProgram("symbol",{config:Kr,defines:Pn}),po=Pt.imageAtlasTexture?Pt.imageAtlasTexture.size:[0,0],Ci=At.iconSizeData,hr=i.bp(Ci,De.zoom),Tr=ft||De.pitch!==0,Sr=Wr(on,Pt.tileID.canonical,ft,$e,De,At.getProjection(),dn),cr=rh(on,Pt.tileID.canonical,ft,$e,De,At.getProjection(),dn),Nr=p.translatePosMatrix(cr,Pt,R,U,!0),xi=p.translatePosMatrix(on,Pt,R,U),Or=or?Da:Sr,bi=$e&&!ft&&!An;let Mo=mt;!tt&&!De.mercatorFromTransition||$e||(Mo=Yr(De));const Qa=kt?Mo:mt,ka=l.getColorAdjustmentMatrix(fe,Te,Pe,Oe),Go=Ll(Ci.kind,hr,bi,ft,p,xi,Or,Nr,Fe,!1,po,[0,0],!0,Gt,Wt,pt,bn,Qa,At.getProjection(),ka,Gr),Sa=Pt.imageAtlasTexture?Pt.imageAtlasTexture:null,eo=l.layout.get("icon-size").constantOr(0)!==1||At.iconsNeedLinear,Ho=At.sdfIcons||p.options.rotating||p.options.zooming||eo||Tr?ke.LINEAR:ke.NEAREST,Oo=At.sdfIcons&&l.paint.get("icon-halo-width").constantOr(1)!==0,Ul=p.terrain&&ft&&An?i.ab.mat4.invert(i.ab.mat4.create(),Sr):Da;if(An&&At.icon){const Bc=De.elevation,Nc=Bc?Bc.getAtTileOffsetFunc(Gt,De.center.lat,De.worldSize,At.getProjection()):null,Kf=Xr(on,Pt.tileID.canonical,ft,$e,De,At.getProjection(),dn);ih(At,on,p,!1,Kf,cr,ft,oe,Nc,Gt)}return{program:hi,buffers:At.icon,uniformValues:Go,atlasTexture:Sa,atlasTextureIcon:null,atlasInterpolation:Ho,atlasInterpolationIcon:null,isSDF:At.sdfIcons,hasHalo:Oo,tile:Pt,labelPlaneMatrixInv:Ul}},Mr=()=>{const An=Xe&&l.layout.get("symbol-placement")!=="point",Pn=[],or=An||Lt||Sn;p.terrainRenderModeElevated()&&ot&&Pn.push("PITCH_WITH_MAP_TERRAIN"),kt&&(Pn.push("PROJECTION_GLOBE_VIEW"),or&&Pn.push("PROJECTED_POS_ON_VIEWPORT")),At.text.zOffsetVertexBuffer&&Pn.push("Z_OFFSET"),At.iconsInText&&Pn.push("RENDER_TEXT_AND_SYMBOL"),Pn.push("RENDER_SDF"),Ln(Pn);const Gr=At.text.programConfigurations.get(l.id),Kr=p.getOrCreateProgram("symbol",{config:Gr,defines:Pn});let hi,po=[0,0],Ci=null;const hr=At.textSizeData;At.iconsInText&&(po=Pt.imageAtlasTexture?Pt.imageAtlasTexture.size:[0,0],Ci=Pt.imageAtlasTexture?Pt.imageAtlasTexture:null,hi=ot||De.pitch!==0||p.options.rotating||p.options.zooming||hr.kind==="composite"||hr.kind==="camera"?ke.LINEAR:ke.NEAREST);const Tr=Pt.glyphAtlasTexture?Pt.glyphAtlasTexture.size:[0,0],Sr=l.layout.get("text-size-scale-range"),cr=i.aw(p.scaleFactor,Sr[0],Sr[1]),Nr=i.bp(hr,De.zoom,cr),xi=Wr(on,Pt.tileID.canonical,ot,Xe,De,At.getProjection(),dn),Or=rh(on,Pt.tileID.canonical,ot,Xe,De,At.getProjection(),dn),bi=p.translatePosMatrix(Or,Pt,N,$,!0),Mo=p.translatePosMatrix(on,Pt,N,$),Qa=or?Da:xi,ka=Xe&&!ot&&!An;let Go=mt;!tt&&!De.mercatorFromTransition||Xe||(Go=Yr(De));const Sa=Ll(hr.kind,Nr,ka,ot,p,Mo,Qa,bi,Fe,!0,Tr,po,!0,Gt,Wt,pt,bn,kt?Go:mt,At.getProjection(),null,null,cr),eo=Pt.glyphAtlasTexture?Pt.glyphAtlasTexture:null,Ho=ke.LINEAR,Oo=l.paint.get("text-halo-width").constantOr(1)!==0,Ul=p.terrain&&ot&&An?i.ab.mat4.invert(i.ab.mat4.create(),xi):Da;if(An&&At.text){const Bc=De.elevation,Nc=Bc?Bc.getAtTileOffsetFunc(Gt,De.center.lat,De.worldSize,At.getProjection()):null,Kf=Xr(on,Pt.tileID.canonical,ot,Xe,De,At.getProjection(),dn);ih(At,on,p,!0,Kf,Or,ot,de,Nc,Gt)}return{program:Kr,buffers:At.text,uniformValues:Sa,atlasTexture:eo,atlasTextureIcon:Ci,atlasInterpolation:Ho,atlasInterpolationIcon:hi,isSDF:!0,hasHalo:Oo,tile:Pt,labelPlaneMatrixInv:Ul}},ui=At.icon.segments.get().length,qr=At.text.segments.get().length,Fn=ui&&!A.onlyText?zn():null,mr=qr&&!A.onlyIcons?Mr():null,sn=l.paint.get("icon-opacity").constantOr(1),In=l.paint.get("text-opacity").constantOr(1);if(Et&&At.canOverlap){vt=!0;const An=sn&&!A.onlyText?At.icon.segments.get():[],Pn=In&&!A.onlyIcons?At.text.segments.get():[];for(const or of An)St.push({segments:new i.b7([or]),sortKey:or.sortKey,state:Fn});for(const or of Pn)St.push({segments:new i.b7([or]),sortKey:or.sortKey,state:mr})}else A.onlyText||St.push({segments:sn?At.icon.segments:new i.b7([]),sortKey:0,state:Fn}),A.onlyIcons||St.push({segments:In?At.text.segments:new i.b7([]),sortKey:0,state:mr})}vt&&St.sort((Gt,Pt)=>Gt.sortKey-Pt.sortKey);for(const Gt of St){const Pt=Gt.state;if(Pt)if(p.terrain?p.terrain.setupElevationDraw(Pt.tile,Pt.program,{useDepthForOcclusion:De.depthOcclusionForSymbolsAndCircles,labelPlaneMatrixInv:Pt.labelPlaneMatrixInv}):p.setupDepthForOcclusion(De.depthOcclusionForSymbolsAndCircles,Pt.program),Re.activeTexture.set(ke.TEXTURE0),Pt.atlasTexture&&Pt.atlasTexture.bind(Pt.atlasInterpolation,ke.CLAMP_TO_EDGE,!0),Pt.atlasTextureIcon&&(Re.activeTexture.set(ke.TEXTURE1),Pt.atlasTextureIcon&&Pt.atlasTextureIcon.bind(Pt.atlasInterpolationIcon,ke.CLAMP_TO_EDGE,!0)),p.uploadCommonLightUniforms(p.context,Pt.program),Pt.hasHalo){const At=Pt.uniformValues;At.u_is_halo=1,Th(Pt.buffers,Gt.segments,l,p,Pt.program,nt,x,b,At,2),At.u_is_halo=0}else{if(Pt.isSDF){const At=Pt.uniformValues;Pt.hasHalo&&(At.u_is_halo=1,Th(Pt.buffers,Gt.segments,l,p,Pt.program,nt,x,b,At,1)),At.u_is_halo=0}Th(Pt.buffers,Gt.segments,l,p,Pt.program,nt,x,b,Pt.uniformValues,1)}}}function Th(p,r,l,m,x,b,A,R,N,U){const $=[p.dynamicLayoutVertexBuffer,p.opacityVertexBuffer,p.iconTransitioningVertexBuffer,p.globeExtVertexBuffer,p.zOffsetVertexBuffer];x.draw(m,m.context.gl.TRIANGLES,b,A,R,Rn.disabled,N,l.id,p.layoutVertexBuffer,p.indexBuffer,r,l.paint,m.transform.zoom,p.programConfigurations.get(l.id),$,U)}function Ds(p,r,l,m,x,b,A){const R=p.context.gl,N=l.paint.get("fill-pattern"),U=l.is3D(),$=U?p.stencilModeFor3D():Dn.disabled,Z=N&&N.constantOr(1);let W,ee,ue,oe,de;A?(ee=Z&&!l.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",W=R.LINES):(ee=Z?"fillPattern":"fill",W=R.TRIANGLES);for(const fe of m){const Te=r.getTile(fe);if(Z&&!Te.patternsLoaded())continue;const Pe=Te.getBucket(l);if(!Pe)continue;p.prepareDrawTile();const Oe=Pe.programConfigurations.get(l.id),Fe=p.isTileAffectedByFog(fe),Re=p.getOrCreateProgram(ee,{config:Oe,overrideFog:Fe});Z&&(p.context.activeTexture.set(R.TEXTURE0),Te.imageAtlasTexture&&Te.imageAtlasTexture.bind(R.LINEAR,R.CLAMP_TO_EDGE),Oe.updatePaintBuffers());const ke=N.constantOr(null);if(ke&&Te.imageAtlas){const Xe=Te.imageAtlas,ft=i.A.from(ke).getPrimary().scaleSelf(i.q.devicePixelRatio).serialize(),ot=Xe.patternPositions[ft];ot&&Oe.setConstantPatternPositions(ot)}const De=p.translatePosMatrix(fe.projMatrix,Te,l.paint.get("fill-translate"),l.paint.get("fill-translate-anchor")),$e=l.paint.get("fill-emissive-strength");if(A){oe=Pe.indexBuffer2,de=Pe.segments2;const Xe=p.terrain&&p.terrain.renderingToTexture?p.terrain.drapeBufferSize:[R.drawingBufferWidth,R.drawingBufferHeight];ue=ee==="fillOutlinePattern"&&Z?B0(De,$e,p,Te,Xe):bc(De,$e,Xe)}else oe=Pe.indexBuffer,de=Pe.segments,ue=Z?Qs(De,$e,p,Te):xu(De,$e);p.uploadCommonUniforms(p.context,Re,fe.toUnwrapped()),Re.draw(p,W,x,U?$:p.stencilModeForClipping(fe),b,Rn.disabled,ue,l.id,Pe.layoutVertexBuffer,oe,de,l.paint,p.transform.zoom,Oe,void 0)}}function Ac(p,r,l,m,x,b,A,R){l.resetLayerRenderingStats(p);const N=p.context,U=N.gl,$=p.transform,Z=l.paint.get("fill-extrusion-pattern"),W=Z.constantOr(1),ee=l.paint.get("fill-extrusion-opacity"),ue=p.style.enable3dLights(),oe=l.paint.get(ue&&!W?"fill-extrusion-ambient-occlusion-wall-radius":"fill-extrusion-ambient-occlusion-radius"),de=[l.paint.get("fill-extrusion-ambient-occlusion-intensity"),oe],fe=l.layout.get("fill-extrusion-edge-radius"),Te=fe>0&&!l.paint.get("fill-extrusion-rounded-roof"),Pe=Te?0:fe,Oe=$.projection.name==="globe"?i.d3():0,Fe=$.projection.name==="globe",Re=Fe?i.ae($.zoom):0,ke=[i.at($.center.lng),i.aA($.center.lat)],De=l.paint.get("fill-extrusion-flood-light-color-use-theme").constantOr("default")==="none",$e=l.paint.get("fill-extrusion-flood-light-color").toRenderColor(De?null:l.lut).toArray01().slice(0,3),Xe=l.paint.get("fill-extrusion-flood-light-intensity"),ft=l.paint.get("fill-extrusion-vertical-scale"),ot=l.paint.get("fill-extrusion-line-width").constantOr(1)!==0,Et=l.paint.get("fill-extrusion-height-alignment"),vt=l.paint.get("fill-extrusion-base-alignment"),nt=sc(p,l.paint.get("fill-extrusion-cutoff-fade-range")),pt=[];let Lt;Fe&&pt.push("PROJECTION_GLOBE_VIEW"),de[0]>0&&pt.push("FAUX_AO"),Te&&pt.push("ZERO_ROOF_RADIUS"),R&&pt.push("HAS_CENTROID"),Xe>0&&pt.push("FLOOD_LIGHT"),nt.shouldRenderCutoff&&pt.push("RENDER_CUTOFF"),ot&&pt.push("RENDER_WALL_MODE");const tt=p.renderPass==="shadow",St=p.shadowRenderer,mt=tt&&!!St;p.shadowRenderer&&(p.shadowRenderer.useNormalOffset=!0);let Gt=[0,0,0];if(St){const kt=p.style.directionalLight,Wt=p.style.ambientLight;kt&&Wt&&(Gt=Gd(p.style,kt,Wt)),tt||(pt.push("RENDER_SHADOWS","DEPTH_TEXTURE"),St.useNormalOffset&&pt.push("NORMAL_OFFSET")),Lt=pt.concat(["SHADOWS_SINGLE_CASCADE"])}const Pt=mt?"fillExtrusionDepth":W?"fillExtrusionPattern":"fillExtrusion",At=l.getLayerRenderingStats();for(const kt of m){const Wt=r.getTile(kt),on=Wt.getBucket(l);if(!on||on.projection.name!==$.projection.name)continue;let dn=!1;St&&(dn=St.getMaxCascadeForTile(kt.toUnwrapped())===0);const En=p.isTileAffectedByFog(kt),Sn=on.programConfigurations.get(l.id),bn=p.getOrCreateProgram(Pt,{config:Sn,defines:dn?Lt:pt,overrideFog:En});if(p.terrain&&p.terrain.setupElevationDraw(Wt,bn,{useMeterToDem:!0}),!on.centroidVertexBuffer){const mr=bn.attributes.a_centroid_pos;mr!==void 0&&U.vertexAttrib2f(mr,0,0)}!tt&&St&&St.setupShadows(Wt.tileID.toUnwrapped(),bn,"vector-tile",Wt.tileID.overscaledZ),W&&(p.context.activeTexture.set(U.TEXTURE0),Wt.imageAtlasTexture&&Wt.imageAtlasTexture.bind(U.LINEAR,U.CLAMP_TO_EDGE),Sn.updatePaintBuffers());const Ln=Z.constantOr(null);if(Ln&&Wt.imageAtlas){const mr=Wt.imageAtlas,sn=i.A.from(Ln).getPrimary().scaleSelf(i.q.devicePixelRatio),In=mr.patternPositions[sn.serialize()];In&&Sn.setConstantPatternPositions(In)}const zn=l.paint.get("fill-extrusion-vertical-gradient"),Mr=1/on.tileToMeter;let ui;if(tt&&St){if(Su(Wt.tileID,on,p))continue;const mr=St.calculateShadowPassMatrixFromTile(Wt.tileID.toUnwrapped());ui=Pl(mr,Pe,Mr,ft,Et,vt)}else{const mr=p.translatePosMatrix(kt.expandedProjMatrix,Wt,l.paint.get("fill-extrusion-translate"),l.paint.get("fill-extrusion-translate-anchor")),sn=$.projection.createInversionMatrix($,kt.canonical);ui=W?vh(mr,p,zn,ee,de,Pe,Mr,kt,Wt,Oe,Et,vt,Re,ke,sn,$e,ft):yh(mr,p,zn,ee,de,Pe,Mr,kt,Oe,Et,vt,Re,ke,sn,$e,ft,Xe,Gt)}p.uploadCommonUniforms(N,bn,kt.toUnwrapped(),null,nt);let qr=on.segments;if($.projection.name==="mercator"&&!tt&&(qr=on.getVisibleSegments(Wt.tileID,p.terrain,p.transform.getFrustum(0)),!qr.get().length))continue;if(At)if(tt)for(const mr of qr.get())At.numRenderedVerticesInShadowPass+=mr.primitiveLength;else for(const mr of qr.get())At.numRenderedVerticesInTransparentPass+=mr.primitiveLength;const Fn=[];(p.terrain||R)&&Fn.push(on.centroidVertexBuffer),Fe&&Fn.push(on.layoutVertexExtBuffer),ot&&Fn.push(on.wallVertexBuffer),bn.draw(p,N.gl.TRIANGLES,x,b,A,Rn.backCCW,ui,l.id,on.layoutVertexBuffer,on.indexBuffer,qr,l.paint,p.transform.zoom,Sn,Fn)}p.shadowRenderer&&(p.shadowRenderer.useNormalOffset=!1)}function Cc(p,r,l,m,x,b,A,R,N,U,$,Z,W,ee,ue,oe,de,fe,Te){const Pe=p.context,Oe=Pe.gl,Fe=p.transform,Re=p.transform.zoom,ke=[],De=sc(p,l.paint.get("fill-extrusion-cutoff-fade-range"));U==="clear"?(ke.push("CLEAR_SUBPASS"),Te&&(ke.push("CLEAR_FROM_TEXTURE"),Pe.activeTexture.set(Oe.TEXTURE0),Te.bind(Oe.LINEAR,Oe.CLAMP_TO_EDGE))):U==="sdf"&&ke.push("SDF_SUBPASS"),de&&ke.push("HAS_CENTROID"),De.shouldRenderCutoff&&ke.push("RENDER_CUTOFF");const $e=l.layout.get("fill-extrusion-edge-radius"),Xe=(ft,ot,Et,vt,nt)=>{const pt=ot.programConfigurations.get(l.id),Lt=p.isTileAffectedByFog(ft),tt=p.getOrCreateProgram("fillExtrusionGroundEffect",{config:pt,defines:ke,overrideFog:Lt}),St=((Gt,Pt,At,kt,Wt,on,dn,En,Sn,bn,Ln)=>({u_matrix:Pt,u_opacity:At,u_ao_pass:kt?1:0,u_meter_to_tile:Wt,u_ao:on,u_flood_light_intensity:dn,u_flood_light_color:En,u_attenuation:Sn,u_edge_radius:bn,u_fb:0,u_fb_size:Ln,u_dynamic_offset:1}))(0,vt,$,N,nt,[Z,W*nt],ee,ue,oe,Re>=17?0:$e*nt,Te?Te.size[0]:0),mt=[];de&&mt.push(ot.hiddenByLandmarkVertexBuffer),p.uploadCommonUniforms(Pe,tt,ft.toUnwrapped(),null,De),tt.draw(p,Pe.gl.TRIANGLES,x,b,A,R,St,l.id,ot.vertexBuffer,ot.indexBuffer,Et,l.paint,Re,pt,mt)};for(const ft of m){const ot=r.getTile(ft),Et=ot.getBucket(l);if(!Et||Et.projection.name!==Fe.projection.name||!Et.groundEffect||Et.groundEffect&&!Et.groundEffect.hasData())continue;const vt=Et.groundEffect,nt=1/Et.tileToMeter;{const pt=p.translatePosMatrix(ft.projMatrix,ot,l.paint.get("fill-extrusion-translate"),l.paint.get("fill-extrusion-translate-anchor")),Lt=vt.getDefaultSegment();Xe(ft,vt,Lt,pt,nt)}if(fe)for(let pt=0;pt<4;pt++){const Lt=i.d4[pt](ft),tt=r.getTile(Lt);if(!tt)continue;const St=tt.getBucket(l);if(!St||St.projection.name!==Fe.projection.name||!St.groundEffect||St.groundEffect&&!St.groundEffect.hasData())continue;const mt=St.groundEffect;let Gt,Pt;pt===0?(Gt=[-i.ag,0,0],Pt=1):pt===1?(Gt=[i.ag,0,0],Pt=0):pt===2?(Gt=[0,-i.ag,0],Pt=3):(Gt=[0,i.ag,0],Pt=2);const At=mt.regionSegments[Pt];if(!At)continue;const kt=new Float32Array(16);i.ab.mat4.translate(kt,ft.projMatrix,Gt),Xe(ft,mt,At,p.translatePosMatrix(kt,ot,l.paint.get("fill-extrusion-translate"),l.paint.get("fill-extrusion-translate-anchor")),nt)}}}function Mc(p,r,l,m,x,b,A){m.centroidVertexArray.length===0&&m.createCentroidsBuffer();const R=b?b.findDEMTileFor(l):null;if(!(R&&R.dem||A))return;b&&R&&R.dem&&m.selfDEMTileTimestamp!==R.dem._timestamp&&(m.borderDoneWithNeighborZ=[-1,-1,-1,-1],m.selfDEMTileTimestamp=R.dem._timestamp);const N=fe=>new i.P(Math.ceil((fe+i.d7)*i.d8),0),U=fe=>{const Te=r.getSource().minzoom,Pe=Fe=>{const Re=r.getTileByID(Fe);if(Re&&Re.hasData())return Re.getBucket(x)},Oe=[0,-1,1];for(const Fe of Oe){if(fe.overscaledZ+Fe<Te)continue;const Re=Pe(fe.calculateScaledKey(fe.overscaledZ+Fe));if(Re)return Re}},$=[0,0,0],Z=(fe,Te)=>($[0]=Math.min(fe.min.y,Te.min.y),$[1]=Math.max(fe.max.y,Te.max.y),$[2]=i.ag-Te.min.x>fe.max.x?Te.min.x-i.ag:fe.max.x,$),W=(fe,Te)=>($[0]=Math.min(fe.min.x,Te.min.x),$[1]=Math.max(fe.max.x,Te.max.x),$[2]=i.ag-Te.min.y>fe.max.y?Te.min.y-i.ag:fe.max.y,$),ee=[(fe,Te)=>Z(fe,Te),(fe,Te)=>Z(Te,fe),(fe,Te)=>W(fe,Te),(fe,Te)=>W(Te,fe)],ue=(fe,Te,Pe,Oe,Fe,Re,ke)=>{if(!b)return 0;const De=[[Re?Pe:fe,Re?fe:Pe,0],[Re?Pe:Te,Re?Te:Pe,0]],$e=ke<0?i.ag+ke:ke,Xe=[Re?$e:(fe+Te)/2,Re?(fe+Te)/2:$e,0];return Pe===0&&ke<0||Pe!==0&&ke>0?b.getForTilePoints(Fe,[Xe],!0,Oe):De.push(Xe),b.getForTilePoints(l,De,!0,R),Math.max(De[0][2],De[1][2],Xe[2])/b.exaggeration()};for(let fe=0;fe<4;fe++){const Te=m.borderFeatureIndices[fe];if(Te.length===0)continue;const Pe=i.d4[fe](l),Oe=U(Pe);if(!(Oe&&Oe instanceof i.d5))continue;const Fe=b?b.findDEMTileFor(Pe):null;if(!(Fe&&Fe.dem||A)||(b&&Fe&&Fe.dem&&m.borderDEMTileTimestamp[fe]!==Fe.dem._timestamp&&(m.borderDoneWithNeighborZ[fe]=-1,m.borderDEMTileTimestamp[fe]=Fe.dem._timestamp),m.borderDoneWithNeighborZ[fe]===Oe.canonical.z))continue;Oe.centroidVertexArray.length===0&&Oe.createCentroidsBuffer();const Re=(fe<2?1:5)-fe,ke=Oe.borderDoneWithNeighborZ[Re]!==m.canonical.z,De=Oe.borderFeatureIndices[Re];let $e=0;if(m.canonical.z!==Oe.canonical.z){for(const Xe of Te)m.showCentroid(m.featuresOnBorder[Xe]);if(ke)for(const Xe of De)Oe.showCentroid(Oe.featuresOnBorder[Xe]);m.borderDoneWithNeighborZ[fe]=Oe.canonical.z,Oe.borderDoneWithNeighborZ[Re]=m.canonical.z}for(const Xe of Te){const ft=m.featuresOnBorder[Xe],ot=m.centroidData[ft.centroidDataIndex],Et=ft.borders[fe];let vt;for(;$e<De.length;){vt=Oe.featuresOnBorder[De[$e]];const nt=vt.borders[Re];if(nt[1]>Et[0]+3||nt[0]>Et[0]-3)break;Oe.showCentroid(vt),$e++}if(vt&&$e<De.length){const nt=$e;let pt=0;for(;!(vt.borders[Re][0]>Et[1]-3)&&(pt++,++$e!==De.length);)vt=Oe.featuresOnBorder[De[$e]];vt=Oe.featuresOnBorder[De[nt]];let Lt=!1;if(pt>=1){const mt=vt.borders[Re];Math.abs(Et[0]-mt[0])<3&&Math.abs(Et[1]-mt[1])<3&&(pt=1,Lt=!0,$e=nt+1)}else if(pt===0){m.showCentroid(ft);continue}const tt=Oe.centroidData[vt.centroidDataIndex];A&&Lt&&(((oe=ot).flags|(de=tt).flags)&i.d6?(oe.flags|=i.d6,de.flags|=i.d6):(oe.flags&=~i.d6,de.flags&=~i.d6));const St=ft.intersectsCount()>1||vt.intersectsCount()>1;if(pt>1)$e=nt,ot.centroidXY=tt.centroidXY=new i.P(0,0);else if(Fe&&Fe.dem&&!St){const mt=ee[fe](ot,tt),Gt=fe%2?i.ag-1:0,Pt=ue(mt[0],Math.min(i.ag-1,mt[1]),Gt,Fe,Pe,fe<2,mt[2]);ot.centroidXY=tt.centroidXY=N(Pt)}else St?ot.centroidXY=tt.centroidXY=new i.P(0,0):(ot.centroidXY=m.encodeBorderCentroid(ft),tt.centroidXY=Oe.encodeBorderCentroid(vt));m.writeCentroidToBuffer(ot),Oe.writeCentroidToBuffer(tt)}else m.showCentroid(ft)}m.borderDoneWithNeighborZ[fe]=Oe.canonical.z,Oe.borderDoneWithNeighborZ[Re]=m.canonical.z}var oe,de;(m.needsCentroidUpdate||!m.centroidVertexBuffer&&m.centroidVertexArray.length!==0)&&m.uploadCentroid(p)}const wu=[1,0,0],qt=[0,1,0],cn=[0,0,1];function Su(p,r,l){const m=l.transform,x=l.shadowRenderer;if(!x)return!0;const b=p.toUnwrapped(),A=m.tileSize*x._cascades[l.currentShadowCascade].scale;let R=r.maxHeight;if(m.elevation){const oe=m.elevation.getMinMaxForTile(p);oe&&(R+=oe.max)}const N=[...x.shadowDirection];N[2]=-N[2];const U=x.computeSimplifiedTileShadowVolume(b,R,A,N);if(!U)return!1;const $=[wu,qt,cn,N,[N[0],0,N[2]],[0,N[1],N[2]]],Z=m.projection.name==="globe",W=m.scaleZoom(A),ee=i.bR.fromInvProjectionMatrix(m.invProjMatrix,m.worldSize,W,!Z),ue=x.getCurrentCascadeFrustum();return ee.intersectsPrecise(U.vertices,U.planes,$)===0||ue.intersectsPrecise(U.vertices,U.planes,$)===0}function ni(p){return[p[0]*i.d9,p[1]*i.d9,p[2]*i.d9,0]}function st(p,r,l,m,x,b,A,R,N){const U=m.getSource(),$=l.globeSharedBuffers;if(!$)return;let Z,W,ee;if(r&&(Z=m.getTile(r)),U instanceof i.aJ?(W=U.texture,ee=i.cI(0,0,l.transform)):Z&&r&&(W=Z.texture,ee=i.cI(r.canonical.z,r.canonical.x,l.transform)),!W||!ee)return;p||(ee=i.ab.mat4.scale(i.ab.mat4.create(),ee,[1,-1,1]));const ue=l.context,oe=ue.gl,de=x.paint.get("raster-resampling")==="nearest"?oe.NEAREST:oe.LINEAR,fe=l.colorModeForDrapableLayerRenderPass(b),Te=A.defines;Te.push("GLOBE_POLES");const Pe=new Tn(oe.LEQUAL,Tn.ReadWrite,l.depthRangeFor3D),Oe=Float32Array.from(l.transform.expandedFarZProjMatrix),Fe=Float32Array.from(i.bb(i.cH(new i.bT(0,0,0))));l.terrain&&l.terrain.prepareDrawTile(),ue.activeTexture.set(oe.TEXTURE0),W.bind(de,oe.CLAMP_TO_EDGE),ue.activeTexture.set(oe.TEXTURE1),W.bind(de,oe.CLAMP_TO_EDGE),W.useMipmap&&ue.extTextureFilterAnisotropic&&l.transform.pitch>20&&oe.texParameterf(oe.TEXTURE_2D,ue.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,ue.extTextureFilterAnisotropicMax);const[Re,ke,De,$e]=r?$.getPoleBuffers(r.canonical.z,!1):$.getPoleBuffers(0,!0),Xe=x.paint.get("raster-elevation");let ft;p?(ft=Re,l.renderDefaultNorthPole=Xe!==0):(ft=ke,l.renderDefaultSouthPole=Xe!==0);const ot=ni(A.mix),Et=((nt,pt,Lt,tt,St,mt,Gt,Pt,At,kt,Wt,on,dn)=>Rl(nt,pt,Lt,new Float32Array(16),new Float32Array(9),[0,0],tt,[0,0],[0,0,0,0],1,{opacity:1,mix:0},mt,[0,0],Pt,2,kt,Wt,on,1,0,dn))(Oe,Fe,ee,i.ae(l.transform.zoom),0,x,0,Xe,0,ot,A.offset,A.range,b),vt=l.getOrCreateProgram("raster",{defines:Te});l.uploadCommonUniforms(ue,vt,null),vt.draw(l,oe.TRIANGLES,Pe,N,fe,R,Et,x.id,ft,De,$e)}function ap(p){const r=p._nearZ,l=p.projection.farthestPixelDistance(p),m=l-r,x=.2*p.height,b=r+x;return[r,l,(b-x-r)/m,(b-r)/m]}function kf(p,r,l,m){if(p)return r instanceof Ai&&p instanceof bl?r.getTextureDescriptor(p,l,!0):{texture:p.texture,mix:ni(m.mix),offset:m.offset,buffer:0,tileSize:1}}var gm=i.da([{name:"a_index",type:"Int16",components:1}]);class ym{constructor(r,l,m,x){const b={width:m[0],height:m[1],data:null},A=r.gl;this.targetColorTexture=new i.T(r,b,A.RGBA8,{useMipmap:!1}),this.backgroundColorTexture=new i.T(r,b,A.RGBA8,{useMipmap:!1}),this.context=r,this.updateParticleTexture(l,x),this.lastInvalidatedAt=0}updateParticleTexture(r,l){if(this.particleTextureDimension===l.width)return;(this.particleTexture0||this.particleTexture1||this.particleIndexBuffer||this.particleSegment)&&(this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleIndexBuffer.destroy(),this.particleSegment.destroy());const m=this.context.gl,x=l.width*l.height;this.particleTexture0=new i.T(this.context,l,m.RGBA8,{premultiply:!1,useMipmap:!1}),this.particleTexture1=new i.T(this.context,l,m.RGBA8,{premultiply:!1,useMipmap:!1});const b=new i.db;b.reserve(x);for(let A=0;A<x;A++)b.emplaceBack(A);this.particleIndexBuffer=this.context.createVertexBuffer(b,gm.members,!0),this.particleSegment=i.b7.simpleSegment(0,0,this.particleIndexBuffer.length,0),this.particleTextureDimension=l.width}update(r){return!(this.lastInvalidatedAt<r&&(this.lastInvalidatedAt=i.q.now(),1))}destroy(){this.targetColorTexture.destroy(),this.backgroundColorTexture.destroy(),this.particleIndexBuffer.destroy(),this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleSegment.destroy()}}function vm(p,r,l){if(!p)return null;const m=r.getTextureDescriptor(p,l,!0);if(!m)return null;let{texture:x,mix:b,offset:A,tileSize:R,buffer:N,format:U}=m;if(!x||!U)return null;let $=!1;return U==="uint32"&&($=!0,b[3]=0,b=Rf(i.dc,b,[0,l.paint.get("raster-particle-max-speed")]),A=xh(i.dc,A,[0,l.paint.get("raster-particle-max-speed")])),{texture:x,textureOffset:[N/(R+2*N),R/(R+2*N)],tileSize:R,scalarData:$,scale:b,offset:A,defines:["RASTER_ARRAY",{uint8:"DATA_FORMAT_UINT8",uint16:"DATA_FORMAT_UINT16",uint32:"DATA_FORMAT_UINT32"}[U]]}}function xm(p){const r=p._nearZ,l=p.projection.farthestPixelDistance(p),m=l-r,x=.2*p.height,b=r+x;return[r,l,(b-x-r)/m,(b-r)/m]}const Oc=new i.aj(1,0,0,1),F0=new i.aj(0,1,0,1),j0=new i.aj(0,0,1,1),bm=new i.aj(1,0,1,1),Bf=new i.aj(0,1,1,1);function kl(p,r,l,m,x,b,A){const R=p.context,N=p.transform,U=R.gl,$=N.projection.name==="globe",Z=$?["PROJECTION_GLOBE_VIEW"]:[];let W=i.ab.mat4.clone(l.projMatrix);if($&&i.ae(N.zoom)>0){const ot=i.ba(l.canonical,N),Et=i.dd(ot);W=i.ab.mat4.multiply(new Float32Array(16),N.globeMatrix,Et),i.ab.mat4.multiply(W,N.projMatrix,W)}const ee=i.ab.mat4.create();ee[12]+=2*x/(i.q.devicePixelRatio*N.width),ee[13]+=2*b/(i.q.devicePixelRatio*N.height),i.ab.mat4.multiply(W,ee,W);const ue=p.getOrCreateProgram("debug",{defines:Z}),oe=r.getTileByID(l.key);p.terrain&&p.terrain.setupElevationDraw(oe,ue);const de=Tn.disabled,fe=Dn.disabled,Te=p.colorModeForRenderPass(),Pe="$debug";R.activeTexture.set(U.TEXTURE0),p.emptyTexture.bind(U.LINEAR,U.CLAMP_TO_EDGE),$?oe._makeGlobeTileDebugBuffers(p.context,N):oe._makeDebugTileBoundsBuffers(p.context,N.projection);const Oe=oe._tileDebugBuffer||p.debugBuffer,Fe=oe._tileDebugIndexBuffer||p.debugIndexBuffer,Re=oe._tileDebugSegments||p.debugSegments;if(ue.draw(p,U.LINE_STRIP,de,fe,Te,Rn.disabled,bu(W,m),Pe,Oe,Fe,Re,null,null,null,[oe._globeTileDebugBorderBuffer]),A){const ot=oe.latestRawTileData,Et=Math.floor((ot&&ot.byteLength||0)/1024);let vt=l.canonical.toString();l.overscaledZ!==l.canonical.z&&(vt+=` => ${l.overscaledZ}`),vt+=` ${oe.state}`,vt+=` ${Et}kb`,function(nt,pt){nt.initDebugOverlayCanvas();const Lt=nt.debugOverlayCanvas,tt=nt.context.gl,St=nt.debugOverlayCanvas.getContext("2d");St.clearRect(0,0,Lt.width,Lt.height),St.shadowColor="white",St.shadowBlur=2,St.lineWidth=1.5,St.strokeStyle="white",St.textBaseline="top",St.font="bold 36px Open Sans, sans-serif",St.fillText(pt,5,5),St.strokeText(pt,5,5),nt.debugOverlayTexture.update(Lt),nt.debugOverlayTexture.bind(tt.LINEAR,tt.CLAMP_TO_EDGE)}(p,vt)}const ke=r.getTile(l).tileSize,De=512/Math.min(ke,512)*(l.overscaledZ/N.zoom)*.5,$e=oe._tileDebugTextBuffer||p.debugBuffer,Xe=oe._tileDebugTextIndexBuffer||p.quadTriangleIndexBuffer,ft=oe._tileDebugTextSegments||p.debugSegments;ue.draw(p,U.TRIANGLES,de,fe,Jn.alphaBlended,Rn.disabled,bu(W,i.aj.transparent,De),Pe,$e,Xe,ft,null,null,null,[oe._globeTileDebugTextBuffer])}function wm(p,r,l,m){fs(p,0,r+l/2,p.transform.width,l,m)}function op(p,r,l,m){fs(p,r-l/2,0,l,p.transform.height,m)}function fs(p,r,l,m,x,b){const A=p.context,R=A.gl;R.enable(R.SCISSOR_TEST),R.scissor(r*i.q.devicePixelRatio,l*i.q.devicePixelRatio,m*i.q.devicePixelRatio,x*i.q.devicePixelRatio),A.clear({color:b}),R.disable(R.SCISSOR_TEST)}const Nf=i.da([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:jo}=Nf;function ds(p,r,l,m){p.emplaceBack(r,l,m)}class Sm{constructor(r){this.vertexArray=new i.de,this.indices=new i.aU,ds(this.vertexArray,-1,-1,1),ds(this.vertexArray,1,-1,1),ds(this.vertexArray,-1,1,1),ds(this.vertexArray,1,1,1),ds(this.vertexArray,-1,-1,-1),ds(this.vertexArray,1,-1,-1),ds(this.vertexArray,-1,1,-1),ds(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=r.createVertexBuffer(this.vertexArray,jo),this.indexBuffer=r.createIndexBuffer(this.indices),this.segment=i.b7.simpleSegment(0,0,36,12)}}function Vi(p,r,l,m,x,b){const A=p.context.gl,R=r.paint.get("sky-atmosphere-color"),N=r.paint.get("sky-atmosphere-halo-color"),U=r.paint.get("sky-atmosphere-sun-intensity"),$=((Z,W,ee,ue,oe)=>({u_matrix_3f:Z,u_sun_direction:W,u_sun_intensity:ee,u_color_tint_r:[ue.r,ue.g,ue.b,ue.a],u_color_tint_m:[oe.r,oe.g,oe.b,oe.a],u_luminance:5e-5}))(i.ab.mat3.fromMat4(i.ab.mat3.create(),m),x,U,R,N);A.framebufferTexture2D(A.FRAMEBUFFER,A.COLOR_ATTACHMENT0,A.TEXTURE_CUBE_MAP_POSITIVE_X+b,r.skyboxTexture,0),l.draw(p,A.TRIANGLES,Tn.disabled,Dn.disabled,Jn.unblended,Rn.frontCW,$,"skyboxCapture",r.skyboxGeometry.vertexBuffer,r.skyboxGeometry.indexBuffer,r.skyboxGeometry.segment)}const U0=i.da([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class Eh{constructor(r){const l=new i.df;l.emplaceBack(-1,1,1,0,0),l.emplaceBack(1,1,1,1,0),l.emplaceBack(1,-1,1,1,1),l.emplaceBack(-1,-1,1,0,1);const m=new i.aU;m.emplaceBack(0,1,2),m.emplaceBack(2,3,0),this.vertexBuffer=r.createVertexBuffer(l,U0.members),this.indexBuffer=r.createIndexBuffer(m),this.segments=i.b7.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const $r=i.da([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_size_scale",components:1},{type:"Float32",name:"a_fade_opacity",components:1}]);class br{constructor(){this.starsCount=16e3,this.sizeMultiplier=.15,this.sizeRange=100,this.intensityRange=200}}class sp{constructor(r){this.colorModeAlphaBlendedWriteRGB=new Jn([1,ss,1,ss],i.aj.transparent,[!0,!0,!0,!1]),this.colorModeWriteAlpha=new Jn([1,0,1,0],i.aj.transparent,[!1,!1,!1,!0]),this.params=new br,this.updateNeeded=!0,r.tp.registerParameter(this.params,["Stars"],"starsCount",{min:100,max:16e3,step:1},()=>{this.updateNeeded=!0}),r.tp.registerParameter(this.params,["Stars"],"sizeMultiplier",{min:.01,max:2,step:.01}),r.tp.registerParameter(this.params,["Stars"],"sizeRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0}),r.tp.registerParameter(this.params,["Stars"],"intensityRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0})}update(r){const l=r.context;if(!this.atmosphereBuffer||this.updateNeeded){this.updateNeeded=!1,this.atmosphereBuffer=new Eh(l);const m=this.params.sizeRange,x=this.params.intensityRange,b=function($){const Z=i.di(30),W=[];for(let ee=0;ee<$;++ee){const ue=2*Math.PI*Z(),oe=Math.acos(1-2*Z())-.5*Math.PI;W.push(i.ab.vec3.fromValues(Math.cos(oe)*Math.cos(ue),Math.cos(oe)*Math.sin(ue),Math.sin(oe)))}return W}(this.params.starsCount),A=i.di(300),R=new i.dg,N=new i.aU;let U=0;for(let $=0;$<b.length;++$){const Z=i.ab.vec3.scale([],b[$],200),W=Math.max(0,1+.01*m*(1*A()-.5)),ee=Math.max(0,1+.01*x*(1*A()-.5));R.emplaceBack(Z[0],Z[1],Z[2],-1,-1,W,ee),R.emplaceBack(Z[0],Z[1],Z[2],1,-1,W,ee),R.emplaceBack(Z[0],Z[1],Z[2],1,1,W,ee),R.emplaceBack(Z[0],Z[1],Z[2],-1,1,W,ee),N.emplaceBack(U+0,U+1,U+2),N.emplaceBack(U+0,U+2,U+3),U+=4}this.starsVx=l.createVertexBuffer(R,$r.members),this.starsIdx=l.createIndexBuffer(N),this.starsSegments=i.b7.simpleSegment(0,0,R.length,N.length)}}destroy(){this.atmosphereBuffer&&this.atmosphereBuffer.destroy(),this.starsVx&&this.starsVx.destroy(),this.starsIdx&&this.starsIdx.destroy()}drawAtmosphereGlow(r,l){const m=r.context,x=m.gl,b=r.transform,A=new Tn(x.LEQUAL,Tn.ReadOnly,[0,1]),R=i.ae(b.zoom),N=r.style.getLut(l.scope),U=l.properties.get("color-use-theme")==="none",$=l.properties.get("color").toRenderColor(U?null:N).toArray01(),Z=l.properties.get("high-color-use-theme")==="none",W=l.properties.get("high-color").toRenderColor(Z?null:N).toArray01(),ee=l.properties.get("space-color-use-theme")==="none",ue=l.properties.get("space-color").toRenderColor(ee?null:N).toArray01PremultipliedAlpha(),oe=5e-4,de=i.dh(l.properties.get("horizon-blend"),0,1,oe,.25),fe=i.cC(r,m,b)&&de===oe?b.worldSize/(2*Math.PI*1.025)-1:b.globeRadius,Te=r.frameCounter/1e3%1,Pe=i.ab.vec3.length(b.globeCenterInViewSpace),Oe=Math.sqrt(Math.pow(Pe,2)-Math.pow(fe,2)),Fe=Math.acos(Oe/Pe),Re=ke=>{const De=b.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"];ke&&De.push("ALPHA_PASS");const $e=r.getOrCreateProgram("globeAtmosphere",{defines:De}),Xe=((ot,Et,vt,nt,pt,Lt,tt,St,mt,Gt,Pt,At)=>({u_frustum_tl:ot,u_frustum_tr:Et,u_frustum_br:vt,u_frustum_bl:nt,u_horizon:pt,u_transition:Lt,u_fadeout_range:tt,u_color:St,u_high_color:mt,u_space_color:Gt,u_temporal_offset:Pt,u_horizon_angle:At}))(b.frustumCorners.TL,b.frustumCorners.TR,b.frustumCorners.BR,b.frustumCorners.BL,b.frustumCorners.horizon,R,de,$,W,ue,Te,Fe);r.uploadCommonUniforms(m,$e);const ft=this.atmosphereBuffer;ft&&$e.draw(r,x.TRIANGLES,A,Dn.disabled,ke?this.colorModeWriteAlpha:this.colorModeAlphaBlendedWriteRGB,Rn.backCW,Xe,ke?"atmosphere_glow_alpha":"atmosphere_glow",ft.vertexBuffer,ft.indexBuffer,ft.segments)};Re(!1),Re(!0)}drawStars(r,l){const m=i.aw(l.properties.get("star-intensity"),0,1);if(m===0)return;const x=r.context,b=x.gl,A=r.transform,R=r.getOrCreateProgram("stars"),N=i.ab.quat.identity([]);i.ab.quat.rotateX(N,N,-A._pitch),i.ab.quat.rotateZ(N,N,-A.angle),i.ab.quat.rotateX(N,N,i.ai(A._center.lat)),i.ab.quat.rotateY(N,N,-i.ai(A._center.lng));const U=i.ab.mat4.fromQuat(new Float32Array(16),N),$=i.ab.mat4.multiply([],A.starsProjMatrix,U),Z=i.ab.mat3.fromMat4([],U),W=i.ab.mat3.invert([],Z),ee=[0,1,0];i.ab.vec3.transformMat3(ee,ee,W),i.ab.vec3.scale(ee,ee,this.params.sizeMultiplier);const ue=[1,0,0];i.ab.vec3.transformMat3(ue,ue,W),i.ab.vec3.scale(ue,ue,this.params.sizeMultiplier);const oe=(de=ee,fe=ue,Te=m,{u_matrix:Float32Array.from($),u_up:de,u_right:fe,u_intensity_multiplier:Te});var de,fe,Te;r.uploadCommonUniforms(x,R),this.starsVx&&this.starsIdx&&R.draw(r,b.TRIANGLES,Tn.disabled,Dn.disabled,this.colorModeAlphaBlendedWriteRGB,Rn.disabled,oe,"atmosphere_stars",this.starsVx,this.starsIdx,this.starsSegments)}}function el(p,r){const l=[...p],m=r.cameraWorldSizeForFog/r.worldSize,x=i.ab.mat4.identity([]);return i.ab.mat4.scale(x,x,[m,m,1]),i.ab.mat4.multiply(l,x,l),i.ab.mat4.multiply(l,r.worldToFogMatrix,l),l}function Tu(p,r,l,m,x){const b=l.material,A=m.context,{baseColorTexture:R,metallicRoughnessTexture:N}=b.pbrMetallicRoughness,{normalTexture:U,occlusionTexture:$,emissionTexture:Z}=b;function W(ue,oe,de){if(ue&&(p.push(oe),A.activeTexture.set(A.gl.TEXTURE0+de),ue.gfxTexture)){const{minFilter:fe,magFilter:Te,wrapS:Pe,wrapT:Oe}=ue.sampler;ue.gfxTexture.bindExtraParam(fe,Te,Pe,Oe)}}W(R,"HAS_TEXTURE_u_baseColorTexture",na.BaseColor),W(N,"HAS_TEXTURE_u_metallicRoughnessTexture",na.MetallicRoughness),W(U,"HAS_TEXTURE_u_normalTexture",na.Normal),W($,"HAS_TEXTURE_u_occlusionTexture",na.Occlusion),W(Z,"HAS_TEXTURE_u_emissionTexture",na.Emission),x&&(x.texture||(x.texture=new i.dk(m.context,x.image,[x.image.height,x.image.height,x.image.height],A.gl.RGBA8)),A.activeTexture.set(A.gl.TEXTURE0+na.LUT),x.texture&&x.texture.bind(A.gl.LINEAR,A.gl.CLAMP_TO_EDGE),p.push("APPLY_LUT_ON_GPU")),l.texcoordBuffer&&(p.push("HAS_ATTRIBUTE_a_uv_2f"),r.push(l.texcoordBuffer)),l.colorBuffer&&(p.push(l.colorBuffer.itemSize===12?"HAS_ATTRIBUTE_a_color_3f":"HAS_ATTRIBUTE_a_color_4f"),r.push(l.colorBuffer)),l.normalBuffer&&(p.push("HAS_ATTRIBUTE_a_normal_3f"),r.push(l.normalBuffer)),l.pbrBuffer&&(p.push("HAS_ATTRIBUTE_a_pbr"),p.push("HAS_ATTRIBUTE_a_heightBasedEmissiveStrength"),r.push(l.pbrBuffer)),b.alphaMode!=="OPAQUE"&&b.alphaMode!=="MASK"||p.push("UNPREMULT_TEXTURE_IN_SHADER"),b.defined||p.push("DIFFUSE_SHADED");const ee=m.shadowRenderer;ee&&(p.push("RENDER_SHADOWS","DEPTH_TEXTURE"),ee.useNormalOffset&&p.push("NORMAL_OFFSET"))}function Ls(p,r,l,m,x,b){const A=l.paint.get("model-opacity").constantOr(1),R=r.context,N=new Tn(r.context.gl.LEQUAL,Tn.ReadWrite,r.depthRangeFor3D),U=r.transform,$=p.mesh,Z=$.material,W=Z.pbrMetallicRoughness,ee=r.style.fog;let ue;ue=r.transform.projection.zAxisUnit==="pixels"?[...p.nodeModelMatrix]:i.ab.mat4.multiply([],m.zScaleMatrix,p.nodeModelMatrix),i.ab.mat4.multiply(ue,m.negCameraPosMatrix,ue);const oe=i.ab.mat4.invert([],ue);i.ab.mat4.transpose(oe,oe);const de=l.paint.get("model-color-use-theme").constantOr("default")==="none",fe=l.paint.get("model-emissive-strength").constantOr(0),Te=Df(new Float32Array(p.worldViewProjection),new Float32Array(ue),new Float32Array(oe),null,r,A,W.baseColorFactor.toRenderColor(null),Z.emissiveFactor,W.metallicFactor,W.roughnessFactor,Z,fe,l),Pe={defines:[]},Oe=[],Fe=r.shadowRenderer;Fe&&(Fe.useNormalOffset=!1),Tu(Pe.defines,Oe,$,r,de?null:l.lut);let Re=null;if(ee){const $e=el(p.nodeModelMatrix,r.transform);if(Re=new Float32Array($e),U.projection.name!=="globe"){const Xe=$.aabb.min,ft=$.aabb.max,[ot,Et]=ee.getOpacityForBounds($e,Xe[0],Xe[1],ft[0],ft[1]);Pe.overrideFog=ot>=je||Et>=je}}const ke=sc(r,l.paint.get("model-cutoff-fade-range"));ke.shouldRenderCutoff&&Pe.defines.push("RENDER_CUTOFF");const De=r.getOrCreateProgram("model",Pe);r.uploadCommonUniforms(R,De,null,Re,ke),r.renderPass!=="shadow"&&Fe&&Fe.setupShadowsFromMatrix(p.nodeModelMatrix,De),De.draw(r,R.gl.TRIANGLES,N,x,b,$.material.doubleSided?Rn.disabled:Rn.backCCW,Te,l.id,$.vertexBuffer,$.indexBuffer,$.segments,l.paint,r.transform.zoom,void 0,Oe)}function Ff(p,r,l,m,x,b,A){let R;R=p.projection.name==="globe"?i.dl(l,p):[...l],i.ab.mat4.multiply(R,R,r.matrix);const N=i.ab.mat4.multiply([],m,R);if(r.meshes)for(const U of r.meshes){if(U.material.alphaMode!=="BLEND"){A.push({mesh:U,depth:0,modelIndex:x,worldViewProjection:N,nodeModelMatrix:R});continue}const $=i.ab.vec3.transformMat4([],U.centroid,N);!p.isOrthographic&&$[2]<=0||b.push({mesh:U,depth:$[2],modelIndex:x,worldViewProjection:N,nodeModelMatrix:R})}if(r.children)for(const U of r.children)Ff(p,U,l,m,x,b,A)}function Ah(p,r,l,m){const x=l.shadowRenderer;if(!x)return;const b=x.getShadowPassDepthMode(),A=x.getShadowPassColorMode(),R=x.calculateShadowPassMatrixFromMatrix(r),N=Di(R);l.getOrCreateProgram("modelDepth",{defines:l._shadowMapDebug?[]:["DEPTH_TEXTURE"]}).draw(l,l.context.gl.TRIANGLES,b,Dn.disabled,A,Rn.backCCW,N,m.id,p.vertexBuffer,p.indexBuffer,p.segments,m.paint,l.transform.zoom,void 0,void 0)}function tl(p,r,l){const m=r.updateZoomBasedPaintProperties(),x=function(b,A,R){let N,U,$,Z=b.terrain?b.terrain.exaggeration():0;if(b.terrain&&Z>0){const W=b.terrain,ee=W.findDEMTileFor(R);ee&&ee.dem?N=i.dn.create(W,R,ee):Z=0}if(Z===0&&(A.terrainElevationMin=0,A.terrainElevationMax=0),Z===A.validForExaggeration&&(Z===0||N&&N._demTile&&N._demTile.tileID===A.validForDEMTile.id&&N._dem._timestamp===A.validForDEMTile.timestamp))return!1;for(const W in A.instancesPerModel){const ee=A.instancesPerModel[W];for(let ue=0;ue<ee.instancedDataArray.length;++ue){const oe=(N?Z*N.getElevationAt(0|ee.instancedDataArray.float32[16*ue],0|ee.instancedDataArray.float32[16*ue+1],!0,!0):0)+ee.instancesEvaluatedElevation[ue];ee.instancedDataArray.float32[16*ue+6]=oe,U=U?Math.min(A.terrainElevationMin,oe):oe,$=$?Math.max(A.terrainElevationMax,oe):oe}}return A.terrainElevationMin=U||0,A.terrainElevationMax=$||0,A.validForExaggeration=Z,A.validForDEMTile=N&&N._demTile?{id:N._demTile.tileID,timestamp:N._dem._timestamp}:{id:void 0,timestamp:0},!0}(p,r,l);(m||x)&&(r.uploaded=!1,r.upload(p.context))}const ba={shadowUniformsInitialized:!1,useSingleShadowCascade:!1,tileMatrix:new Float64Array(16),shadowTileMatrix:new Float32Array(16),aabb:new i.cd([0,0,0],[i.ag,i.ag,0])};function jf(p,r){const l=1<<p.canonical.z,m=r.getFreeCameraOptions().position,x=r.elevation,b=p.canonical.x/l,A=(p.canonical.x+1)/l,R=p.canonical.y/l,N=(p.canonical.y+1)/l;let U=r._centerAltitude;if(x){const ee=x.getMinMaxForTile(p);ee&&ee.max>U&&(U=ee.max)}const $=i.aw(m.x,b,A)-m.x,Z=i.aw(m.y,R,N)-m.y,W=i.bH(U,r.center.lat)-m.z;return r._zoomFromMercatorZ(Math.sqrt($*$+Z*Z+W*W))}function Ch(p,r,l,m,x,b,A){const R=p.context,N=p.renderPass==="shadow",U=p.shadowRenderer,$=N&&U?U.getShadowPassDepthMode():new Tn(R.gl.LEQUAL,Tn.ReadWrite,p.depthRangeFor3D),Z=p.isTileAffectedByFog(b);if(l.meshes)for(const W of l.meshes){const ee=["MODEL_POSITION_ON_GPU"],ue=[];let oe,de,fe;m.instancedDataArray.length>20&&ee.push("INSTANCED_ARRAYS");const Te=sc(p,r.paint.get("model-cutoff-fade-range"));if(Te.shouldRenderCutoff&&ee.push("RENDER_CUTOFF"),N&&U)oe=p.getOrCreateProgram("modelDepth",{defines:ee}),de=Di(A.shadowTileMatrix,A.shadowTileMatrix,Float32Array.from(l.matrix)),fe=U.getShadowPassColorMode();else{Tu(ee,ue,W,p,r.paint.get("model-color-use-theme").constantOr("default")==="none"?null:r.lut),oe=p.getOrCreateProgram("model",{defines:ee,overrideFog:Z});const Oe=W.material,Fe=Oe.pbrMetallicRoughness,Re=r.paint.get("model-opacity").constantOr(1),ke=r.paint.get("model-emissive-strength").constantOr(0);de=Df(b.expandedProjMatrix,Float32Array.from(l.matrix),new Float32Array(16),null,p,Re,Fe.baseColorFactor.toRenderColor(null),Oe.emissiveFactor,Fe.metallicFactor,Fe.roughnessFactor,Oe,ke,r,x),U&&(A.shadowUniformsInitialized?oe.setShadowUniformValues(R,U.getShadowUniformValues()):(U.setupShadows(b.toUnwrapped(),oe,"model-tile",b.overscaledZ),A.shadowUniformsInitialized=!0)),fe=Te.shouldRenderCutoff||Re<1||Oe.alphaMode!=="OPAQUE"?Jn.alphaBlended:Jn.unblended}p.uploadCommonUniforms(R,oe,b.toUnwrapped(),null,Te);const Pe=W.material.doubleSided?Rn.disabled:Rn.backCCW;if(m.instancedDataArray.length>20)ue.push(m.instancedDataBuffer),oe.draw(p,R.gl.TRIANGLES,$,Dn.disabled,fe,Pe,de,r.id,W.vertexBuffer,W.indexBuffer,W.segments,r.paint,p.transform.zoom,void 0,ue,m.instancedDataArray.length);else{const Oe=N?"u_instance":"u_normal_matrix";for(let Fe=0;Fe<m.instancedDataArray.length;++Fe)de[Oe]=new Float32Array(m.instancedDataArray.arrayBuffer,64*Fe,16),oe.draw(p,R.gl.TRIANGLES,$,Dn.disabled,fe,Pe,de,r.id,W.vertexBuffer,W.indexBuffer,W.segments,r.paint,p.transform.zoom,void 0,ue)}}if(l.children)for(const W of l.children)Ch(p,r,W,m,x,b,A)}const Uf=[1,-1,1];function lp(p,r,l,m){if(!l.modelManager)return!0;const x=l.modelManager;if(!l.shadowRenderer)return!0;const b=l.shadowRenderer,A=r.aabb;let R=!0,N=p.maxHeight;if(N===0){let $=0;for(const Z in p.instancesPerModel){const W=x.getModel(Z,m);W?$=Math.max($,Math.max(Math.max(W.aabb.max[0],W.aabb.max[1]),W.aabb.max[2])):R=!1}N=p.maxScale*$*1.41+p.maxVerticalOffset,R&&(p.maxHeight=N)}A.max[2]=N,A.min[2]+=p.terrainElevationMin,A.max[2]+=p.terrainElevationMax,i.ab.vec3.transformMat4(A.min,A.min,r.tileMatrix),i.ab.vec3.transformMat4(A.max,A.max,r.tileMatrix);const U=A.intersects(b.getCurrentCascadeFrustum());return l.currentShadowCascade===0&&(p.isInsideFirstShadowMapFrustum=U===2),U===0}function Ic(p,r){const l=p.uniformValues.u_cutoff_params[0],m=p.uniformValues.u_cutoff_params[1],x=p.uniformValues.u_cutoff_params[2],b=p.uniformValues.u_cutoff_params[3];return m===l||b===x?1:i.aw(((r-l)/(m-l)-x)/(b-x),0,1)}function Tm(p,r,l,m){if(r.pitch<20)return 1;const x=r.getWorldToCameraMatrix();i.ab.mat4.multiply(x,x,p);const b=i.ab.vec4.fromValues(l.min[0],l.min[1],l.min[2],1);let A=i.ab.vec4.transformMat4(i.ab.vec4.create(),b,x),R=A,N=A;b[1]=l.max[1],A=i.ab.vec4.transformMat4(i.ab.vec4.create(),b,x),R=A[1]<R[1]?A:R,N=A[1]>N[1]?A:N,b[0]=l.max[0],A=i.ab.vec4.transformMat4(i.ab.vec4.create(),b,x),R=A[1]<R[1]?A:R,N=A[1]>N[1]?A:N,b[1]=l.min[1],A=i.ab.vec4.transformMat4(i.ab.vec4.create(),b,x),R=A[1]<R[1]?A:R,N=A[1]>N[1]?A:N;const U=i.aw(m[0],0,1),$=100*r.pixelsPerMeter*i.aw(m[1],0,1),Z=i.aw(m[2],0,1),W=i.ab.vec4.lerp(i.ab.vec4.create(),R,N,U),ee=Math.tan(.5*r.fovX),ue=-W[2]*ee;if($===0)return W[1]<-Math.abs(ue)?Z:1;const oe=(-Math.abs(ue)-W[1])/$,de=(Te,Pe,Oe)=>(1-Oe)*Te+Oe*Pe,fe=i.aw(de(1,Z,oe),Z,1);return de(1,fe,i.aw((r.pitch-20)/20,0,1))}class Pc{}class cp{constructor(){this._storage=new Map}getLinesFromTrianglesBuffer(r,l,m){{const Z=this._storage.get(l.id);if(Z)return Z.lastUsedFrameIdx=r,Z.buf}const x=m.gl,b=x.getBufferParameter(x.ELEMENT_ARRAY_BUFFER,x.BUFFER_SIZE),A=new ArrayBuffer(b),R=new Int16Array(A);x.getBufferSubData(x.ELEMENT_ARRAY_BUFFER,0,new Int16Array(A));const N=new i.dq;for(let Z=0;Z<b/2;Z+=3){const W=R[Z],ee=R[Z+1],ue=R[Z+2];N.emplaceBack(W,ee),N.emplaceBack(ee,ue),N.emplaceBack(ue,W)}const U=m.bindVertexArrayOES.current,$=new Pc;return $.buf=new hs(m,N),$.lastUsedFrameIdx=r,this._storage.set(l.id,$),m.bindVertexArrayOES.set(U),$.buf}update(r){for(const[l,m]of this._storage)r-m.lastUsedFrameIdx>30&&(m.buf.destroy(),this._storage.delete(l))}destroy(){for(const[r,l]of this._storage)l.buf.destroy(),this._storage.delete(r)}}class Rc{constructor(r){this.occluderSize=30,this.depthOffset=-1e-4,r.registerParameter(this,["Occlusion"],"occluderSize",{min:1,max:100,step:1}),r.registerParameter(this,["Occlusion"],"depthOffset",{min:-.05,max:0,step:1e-5})}}const Vf=i.da([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_rainParticleData",components:4}]);class Mh{registerParameter(){}registerButton(){}registerBinding(){}refreshUI(){}}class ia{constructor(r,l){this.revealStart=11,this.revealRange=2,r.registerParameter(this,[...l,"Reveal"],"revealStart",{min:0,max:17,step:.05}),r.registerParameter(this,[...l,"Reveal"],"revealRange",{min:.1,max:5.1,step:.05})}}const up=i.da([{type:"Float32",name:"a_pos_2f",components:2}]);class ps{destroy(){this.vignetteVx&&this.vignetteVx.destroy(),this.vignetteIdx&&this.vignetteIdx.destroy()}draw(r,l){const m=r.getOrCreateProgram("vignette");if(!this.vignetteVx||!this.vignetteIdx){const A=new i.dr,R=new i.aU;A.emplaceBack(-1,-1),A.emplaceBack(1,-1),A.emplaceBack(1,1),A.emplaceBack(-1,1),R.emplaceBack(0,1,2),R.emplaceBack(0,2,3),this.vignetteVx=r.context.createVertexBuffer(A,up.members),this.vignetteIdx=r.context.createIndexBuffer(R)}const x=i.b7.simpleSegment(0,0,4,6);if(this.vignetteVx&&this.vignetteIdx){r.uploadCommonUniforms(r.context,m);const A={u_vignetteShape:(b={vignetteShape:[l.start,l.range,Math.pow(10,l.fadePower)],vignetteColor:[l.color.r,l.color.g,l.color.b,l.color.a*l.strength]}).vignetteShape,u_vignetteColor:b.vignetteColor};m.draw(r,r.context.gl.TRIANGLES,Tn.disabled,Dn.disabled,Jn.alphaBlended,Rn.disabled,A,"vignette",this.vignetteVx,this.vignetteIdx,x,{})}var b}}class zs{constructor(){this._accumulatedOffsetX=0,this._accumulatedOffsetY=0,this._accumulatedElevation=0}update(r,l){const m=r.getFreeCameraOptions().position,x=m.toAltitude(),b=m.toLngLat(),A=i.ai(b.lng),R=i.ai(b.lat),N=r.pixelsPerMeter/l,U=A*i.ds,$=i.ds*Math.log(Math.tan(Math.PI/4+R/2));if(this._offsetXPrev===void 0)this._offsetXPrev=0,this._offsetYPrev=0,this._elevationPrev=0,this._accumulatedOffsetX=0,this._accumulatedOffsetY=0,this._accumulatedElevation=0;else{const Z=-this._offsetYPrev+$,W=-this._elevationPrev+x;this._accumulatedOffsetX+=(-this._offsetXPrev+U)*N,this._accumulatedOffsetY+=Z*N,this._accumulatedElevation+=W*N,this._offsetXPrev=U,this._offsetYPrev=$,this._elevationPrev=x}}getPosition(){return[this._accumulatedOffsetX,this._accumulatedOffsetY,this._accumulatedElevation]}}function uo(p,r){return[-(p[0]-Math.floor(p[0]/r)*r),-(p[1]-Math.floor(p[1]/r)*r),-(p[2]-Math.floor(p[2]/r)*r)]}function nl(p){const r=i.di(1323123451230),l=[];for(let m=0;m<p;++m){const x=2*r()-1,b=2*r()-1,A=2*r()-1;l.push(i.ab.vec3.fromValues(x,b,A))}return l}function ms(p,r,l,m,x){const b=i.aw((x-l)/(m-l),0,1);return(1-b)*p+b*r}class Oh{constructor(r){this._movement=new zs,this._accumulatedTimeFromStart=0,this._prevTime=Date.now()/1e3,this._vignette=new ps,this._ppmScaleFactor=r}destroy(){this.particlesVx&&this.particlesVx.destroy(),this.particlesIdx&&this.particlesIdx.destroy(),this._vignette&&this._vignette.destroy()}updateOnRender(r,l){const m=r.transform;this._movement.update(m,this._ppmScaleFactor);const x=m.starsProjMatrix,b=i.ab.quat.identity([]);i.ab.quat.rotateX(b,b,i.ai(90)-m._pitch),i.ab.quat.rotateZ(b,b,-m.angle);const A=i.ab.mat4.fromQuat(new Float32Array(16),b),R=i.ab.mat4.fromValues(1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1),N=i.ab.mat4.transpose([],R),U=i.ab.mat4.multiply([],N,A),$=Date.now()/1e3;return this._accumulatedTimeFromStart+=($-this._prevTime)*l,this._prevTime=$,{projectionMatrix:x,modelviewMatrix:U}}}class Eu extends Oh{constructor(r){super(4.25),this._params={overrideStyleParameters:!1,intensity:.5,timeFactor:1,velocityConeAperture:0,velocity:300,boxSize:2500,dropletSizeX:1,dropletSizeYScale:10,distortionStrength:70,screenThinning:{intensity:.57,start:.46,range:1.17,fadePower:.17,affectedRatio:1,particleOffset:-.2},color:{r:.66,g:.68,b:.74,a:.7},direction:{x:-50,y:-35},shapeDirPower:2,shapeNormalPower:1},this._revealParams=new ia(r.tp,["Precipitation","Rain"]),this._vignetteParams={strength:1,start:.7,range:1,fadePower:.4,color:{r:.27,g:.27,b:.27,a:1}},this.particlesCount=16e3}update(r){const l=r.context;if(!this.particlesVx){const m=nl(this.particlesCount),x=new i.dt,b=new i.aU;let A=0;const R=i.di(1323123451230);for(let N=0;N<m.length;++N){const U=m[N],$=[2*R()-1,R(),R(),R()];x.emplaceBack(U[0],U[1],U[2],-1,-1,...$),x.emplaceBack(U[0],U[1],U[2],1,-1,...$),x.emplaceBack(U[0],U[1],U[2],1,1,...$),x.emplaceBack(U[0],U[1],U[2],-1,1,...$),b.emplaceBack(A+0,A+1,A+2),b.emplaceBack(A+0,A+2,A+3),A+=4}this.particlesVx=l.createVertexBuffer(x,Vf.members),this.particlesIdx=l.createIndexBuffer(b)}}draw(r){if(!this._params.overrideStyleParameters&&!r.style.rain)return;const l=this._params.overrideStyleParameters?this._revealParams:{revealStart:0,revealRange:.01},m=r.transform.zoom;if(l.revealStart>m)return;const x=ms(0,1,l.revealStart,l.revealStart+l.revealRange,m);if(!this.particlesVx||!this.particlesIdx)return;const b=structuredClone(this._params);let A=[-b.direction.x,b.direction.y,-100];i.ab.vec3.normalize(A,A);const R=structuredClone(this._vignetteParams);R.strength*=x,b.overrideStyleParameters||(b.intensity=r.style.rain.state.density,b.timeFactor=r.style.rain.state.intensity,b.color=structuredClone(r.style.rain.state.color),A=structuredClone(r.style.rain.state.direction),b.screenThinning.intensity=r.style.rain.state.centerThinning,b.dropletSizeX=r.style.rain.state.dropletSize[0],b.dropletSizeYScale=r.style.rain.state.dropletSize[1]/r.style.rain.state.dropletSize[0],b.distortionStrength=100*r.style.rain.state.distortionStrength,R.strength=1,R.color=structuredClone(r.style.rain.state.vignetteColor));const N=this.updateOnRender(r,b.timeFactor),U=r.context,$=U.gl,Z=r.transform;this.screenTexture&&this.screenTexture.size[0]===r.width&&this.screenTexture.size[1]===r.height||(this.screenTexture=new i.T(U,{width:r.width,height:r.height,data:null},$.RGBA8)),b.distortionStrength>0&&(U.activeTexture.set($.TEXTURE0),this.screenTexture.bind($.LINEAR,$.CLAMP_TO_EDGE),$.copyTexSubImage2D($.TEXTURE_2D,0,0,0,0,0,r.width,r.height));const W=r.getOrCreateProgram("rainParticle");r.uploadCommonUniforms(U,W),U.activeTexture.set($.TEXTURE0),this.screenTexture.bind($.LINEAR,$.CLAMP_TO_EDGE);const ee=[b.color.r,b.color.g,b.color.b,b.color.a],ue=(oe,de)=>{const fe=uo(this._movement.getPosition(),oe),Te=b.dropletSizeX,Pe=b.dropletSizeX*b.dropletSizeYScale,Oe=r.width/2,Fe=r.height/2,Re=ms(0,b.screenThinning.start,0,1,b.screenThinning.intensity),ke=ms(.001,b.screenThinning.range,0,1,b.screenThinning.intensity),De=ms(0,b.screenThinning.particleOffset,0,1,b.screenThinning.intensity),$e=(Xe={modelview:N.modelviewMatrix,projection:N.projectionMatrix,time:this._accumulatedTimeFromStart,camPos:fe,velocityConeAperture:b.velocityConeAperture,velocity:b.velocity,boxSize:oe,rainDropletSize:[Te,Pe],distortionStrength:b.distortionStrength,rainDirection:A,color:ee,screenSize:[Z.width,Z.height],thinningCenterPos:[Oe,Fe],thinningShape:[Re,ke,Math.pow(10,b.screenThinning.fadePower)],thinningAffectedRatio:b.screenThinning.affectedRatio,thinningParticleOffset:De,shapeDirectionalPower:b.shapeDirPower,shapeNormalPower:b.shapeNormalPower,mode:de?0:1},{u_modelview:Float32Array.from(Xe.modelview),u_projection:Float32Array.from(Xe.projection),u_time:Xe.time,u_cam_pos:Xe.camPos,u_texScreen:0,u_velocityConeAperture:Xe.velocityConeAperture,u_velocity:Xe.velocity,u_boxSize:Xe.boxSize,u_rainDropletSize:Xe.rainDropletSize,u_distortionStrength:Xe.distortionStrength,u_rainDirection:Xe.rainDirection,u_color:Xe.color,u_screenSize:Xe.screenSize,u_thinningCenterPos:Xe.thinningCenterPos,u_thinningShape:Xe.thinningShape,u_thinningAffectedRatio:Xe.thinningAffectedRatio,u_thinningParticleOffset:Xe.thinningParticleOffset,u_shapeDirectionalPower:Xe.shapeDirectionalPower,u_shapeNormalPower:Xe.shapeNormalPower,u_mode:Xe.mode});var Xe;const ft=Math.round(b.intensity*this.particlesCount),ot=i.b7.simpleSegment(0,0,4*ft,2*ft);W.draw(r,$.TRIANGLES,Tn.disabled,Dn.disabled,Jn.alphaBlended,Rn.disabled,$e,"rain_particles",this.particlesVx,this.particlesIdx,ot,{})};b.distortionStrength>0&&ue(b.boxSize,!0),ue(b.boxSize,!1),this._vignette.draw(r,R)}}const hp=i.da([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_snowParticleData",components:4},{type:"Float32",name:"a_snowParticleDataHorizontalOscillation",components:2}]);class Bl extends Oh{constructor(r){super(2.25),this._params={overrideStyleParameters:!1,intensity:.85,timeFactor:.75,velocityConeAperture:70,velocity:40,horizontalOscillationRadius:4,horizontalOscillationRate:1.5,boxSize:2e3,billboardSize:2,shapeFadeStart:.27,shapeFadePower:.21,screenThinning:{intensity:.4,start:.15,range:1.4,fadePower:.24,affectedRatio:1,particleOffset:-.2},color:{r:1,g:1,b:1,a:1},direction:{x:-50,y:-35}},this._revealParams=new ia(r.tp,["Precipitation","Snow"]),this._vignetteParams={strength:.3,start:.78,range:.46,fadePower:.2,color:{r:1,g:1,b:1,a:1}},this.particlesCount=16e3}update(r){const l=r.context;if(!this.particlesVx){const m=nl(this.particlesCount),x=new i.du,b=new i.aU;let A=0;const R=i.di(1323123451230);for(let N=0;N<m.length;++N){const U=m[N],$=R(),Z=R(),W=R(),ee=[N/m.length,$,Z,W],ue=[R(),R()];x.emplaceBack(U[0],U[1],U[2],-1,-1,...ee,...ue),x.emplaceBack(U[0],U[1],U[2],1,-1,...ee,...ue),x.emplaceBack(U[0],U[1],U[2],1,1,...ee,...ue),x.emplaceBack(U[0],U[1],U[2],-1,1,...ee,...ue),b.emplaceBack(A+0,A+1,A+2),b.emplaceBack(A+0,A+2,A+3),A+=4}this.particlesVx=l.createVertexBuffer(x,hp.members),this.particlesIdx=l.createIndexBuffer(b)}}draw(r){if(!this._params.overrideStyleParameters&&!r.style.snow)return;const l=structuredClone(this._params);let m=[-l.direction.x,l.direction.y,-100];i.ab.vec3.normalize(m,m);const x=structuredClone(this._vignetteParams),b=l.overrideStyleParameters?this._revealParams:{revealStart:0,revealRange:.01},A=r.transform.zoom;if(b.revealStart>A)return;const R=ms(0,1,b.revealStart,b.revealStart+b.revealRange,A);x.strength*=R,l.overrideStyleParameters||(l.intensity=r.style.snow.state.density,l.timeFactor=r.style.snow.state.intensity,l.color=structuredClone(r.style.snow.state.color),m=structuredClone(r.style.snow.state.direction),l.screenThinning.intensity=r.style.snow.state.centerThinning,l.billboardSize=2.79*r.style.snow.state.flakeSize,x.strength=1,x.color=structuredClone(r.style.snow.state.vignetteColor));const N=this.updateOnRender(r,l.timeFactor);if(!this.particlesVx||!this.particlesIdx)return;const U=r.context,$=U.gl,Z=r.transform,W=r.getOrCreateProgram("snowParticle");r.uploadCommonUniforms(U,W),((ee,ue,oe)=>{const de=uo(this._movement.getPosition(),ee),fe=Z.width/2,Te=Z.height/2,Pe=ms(0,oe.screenThinning.start,0,1,oe.screenThinning.intensity),Oe=ms(.001,oe.screenThinning.range,0,1,oe.screenThinning.intensity),Fe=ms(0,oe.screenThinning.particleOffset,0,1,oe.screenThinning.intensity),Re=(ke={modelview:N.modelviewMatrix,projection:N.projectionMatrix,time:this._accumulatedTimeFromStart,camPos:de,velocityConeAperture:oe.velocityConeAperture,velocity:oe.velocity,horizontalOscillationRadius:oe.horizontalOscillationRadius,horizontalOscillationRate:oe.horizontalOscillationRate,boxSize:ee,billboardSize:1*oe.billboardSize,simpleShapeParameters:[oe.shapeFadeStart,oe.shapeFadePower],screenSize:[Z.width,Z.height],thinningCenterPos:[fe,Te],thinningShape:[Pe,Oe,Math.pow(10,oe.screenThinning.fadePower)],thinningAffectedRatio:oe.screenThinning.affectedRatio,thinningParticleOffset:Fe,color:[oe.color.r,oe.color.g,oe.color.b,oe.color.a],direction:m},{u_modelview:Float32Array.from(ke.modelview),u_projection:Float32Array.from(ke.projection),u_time:ke.time,u_cam_pos:ke.camPos,u_velocityConeAperture:ke.velocityConeAperture,u_velocity:ke.velocity,u_horizontalOscillationRadius:ke.horizontalOscillationRadius,u_horizontalOscillationRate:ke.horizontalOscillationRate,u_boxSize:ke.boxSize,u_billboardSize:ke.billboardSize,u_simpleShapeParameters:ke.simpleShapeParameters,u_screenSize:ke.screenSize,u_thinningCenterPos:ke.thinningCenterPos,u_thinningShape:ke.thinningShape,u_thinningAffectedRatio:ke.thinningAffectedRatio,u_thinningParticleOffset:ke.thinningParticleOffset,u_particleColor:ke.color,u_direction:ke.direction});var ke;const De=Math.round(oe.intensity*this.particlesCount),$e=i.b7.simpleSegment(0,0,4*De,2*De);this.particlesVx&&this.particlesIdx&&W.draw(r,$.TRIANGLES,Tn.disabled,Dn.disabled,Jn.alphaBlended,Rn.disabled,Re,"snow_particles",this.particlesVx,this.particlesIdx,$e,{})})(l.boxSize,0,l),this._vignette.draw(r,x)}}const Dc={symbol:function(p,r,l,m,x){if(p.renderPass!=="translucent")return;const b=Dn.disabled,A=p.colorModeForRenderPass(),R=l.layout.get("text-variable-anchor"),N=l.layout.get("text-size-scale-range"),U=i.aw(p.scaleFactor,N[0],N[1]);R&&function(W,ee,ue,oe,de,fe,Te,Pe){const Oe=ee.transform,Fe=de==="map",Re=fe==="map";for(const ke of W){const De=oe.getTile(ke),$e=De.getBucket(ue);if(!$e||!$e.text||!$e.text.segments.get().length)continue;const Xe=i.bp($e.textSizeData,Oe.zoom,Pe),ft=ac(ke,$e.getProjection(),Oe),ot=Oe.calculatePixelsToTileUnitsMatrix(De),Et=Wr(ft,De.tileID.canonical,Re,Fe,Oe,$e.getProjection(),ot),vt=$e.hasIconTextFit()&&$e.hasIconData();if(Xe){const nt=Math.pow(2,Oe.zoom-De.tileID.overscaledZ);Tc($e,Fe,Re,Te,i.cX,Oe,Et,ke,nt,Xe,vt)}}}(m,p,l,r,l.layout.get("text-rotation-alignment"),l.layout.get("text-pitch-alignment"),x,U);const $=l.paint.get("icon-opacity").constantOr(1)!==0,Z=l.paint.get("text-opacity").constantOr(1)!==0;l.layout.get("symbol-sort-key").constantOr(1)!==void 0&&($||Z)?Ec(p,r,l,m,b,A):($&&Ec(p,r,l,m,b,A,{onlyIcons:!0}),Z&&Ec(p,r,l,m,b,A,{onlyText:!0})),r.map.showCollisionBoxes&&(Sh(p,r,l,m,l.paint.get("text-translate"),l.paint.get("text-translate-anchor"),!0),Sh(p,r,l,m,l.paint.get("icon-translate"),l.paint.get("icon-translate-anchor"),!1))},circle:function(p,r,l,m){if(p.renderPass!=="translucent")return;const x=l.paint.get("circle-opacity"),b=l.paint.get("circle-stroke-width"),A=l.paint.get("circle-stroke-opacity"),R=l.layout.get("circle-sort-key").constantOr(1)!==void 0,N=l.paint.get("circle-emissive-strength");if(x.constantOr(1)===0&&(b.constantOr(1)===0||A.constantOr(1)===0))return;const U=p.context,$=U.gl,Z=p.transform,W=p.depthModeForSublayer(0,Tn.ReadOnly),ee=Dn.disabled,ue=p.colorModeForDrapableLayerRenderPass(N),oe=Z.projection.name==="globe",de=[i.at(Z.center.lng),i.aA(Z.center.lat)],fe=[];for(let Pe=0;Pe<m.length;Pe++){const Oe=m[Pe],Fe=r.getTile(Oe),Re=Fe.getBucket(l);if(!Re||Re.projection.name!==Z.projection.name)continue;const ke=Re.programConfigurations.get(l.id),De=i.cY(l),$e=p.isTileAffectedByFog(Oe);oe&&De.push("PROJECTION_GLOBE_VIEW"),De.push("DEPTH_D24"),p.terrain&&Z.depthOcclusionForSymbolsAndCircles&&De.push("DEPTH_OCCLUSION");const Xe=p.getOrCreateProgram("circle",{config:ke,defines:De,overrideFog:$e}),ft=Re.layoutVertexBuffer,ot=Re.globeExtVertexBuffer,Et=Re.indexBuffer,vt=Z.projection.createInversionMatrix(Z,Oe.canonical),nt={programConfiguration:ke,program:Xe,layoutVertexBuffer:ft,globeExtVertexBuffer:ot,indexBuffer:Et,uniformValues:i.cZ(p,Oe,Fe,vt,de,l),tile:Fe};if(R){const pt=Re.segments.get();for(const Lt of pt)fe.push({segments:new i.b7([Lt]),sortKey:Lt.sortKey,state:nt})}else fe.push({segments:Re.segments,sortKey:0,state:nt})}R&&fe.sort((Pe,Oe)=>Pe.sortKey-Oe.sortKey);const Te={useDepthForOcclusion:Z.depthOcclusionForSymbolsAndCircles};for(const Pe of fe){const{programConfiguration:Oe,program:Fe,layoutVertexBuffer:Re,globeExtVertexBuffer:ke,indexBuffer:De,uniformValues:$e,tile:Xe}=Pe.state,ft=Pe.segments;p.terrain&&p.terrain.setupElevationDraw(Xe,Fe,Te),p.uploadCommonUniforms(U,Fe,Xe.tileID.toUnwrapped()),Fe.draw(p,$.TRIANGLES,W,ee,ue,Rn.disabled,$e,l.id,Re,De,ft,l.paint,Z.zoom,Oe,[ke])}},heatmap:function(p,r,l,m){if(l.paint.get("heatmap-opacity")!==0)if(p.renderPass==="offscreen"){const x=p.context,b=x.gl,A=Dn.disabled,R=new Jn([b.ONE,b.ONE,b.ONE,b.ONE],i.aj.transparent,[!0,!0,!0,!0]);(function(ee,ue,oe,de){const fe=ee.gl,Te=ue.width*de,Pe=ue.height*de;ee.activeTexture.set(fe.TEXTURE1),ee.viewport.set([0,0,Te,Pe]);let Oe=oe.heatmapFbo;if(!Oe||Oe&&(Oe.width!==Te||Oe.height!==Pe)){Oe&&Oe.destroy();const Fe=fe.createTexture();fe.bindTexture(fe.TEXTURE_2D,Fe),fe.texParameteri(fe.TEXTURE_2D,fe.TEXTURE_WRAP_S,fe.CLAMP_TO_EDGE),fe.texParameteri(fe.TEXTURE_2D,fe.TEXTURE_WRAP_T,fe.CLAMP_TO_EDGE),fe.texParameteri(fe.TEXTURE_2D,fe.TEXTURE_MIN_FILTER,fe.LINEAR),fe.texParameteri(fe.TEXTURE_2D,fe.TEXTURE_MAG_FILTER,fe.LINEAR),Oe=oe.heatmapFbo=ee.createFramebuffer(Te,Pe,!0,null),function(Re,ke,De,$e,Xe,ft){const ot=Re.gl;ot.texImage2D(ot.TEXTURE_2D,0,Re.extRenderToTextureHalfFloat?ot.RGBA16F:ot.RGBA,Xe,ft,0,ot.RGBA,Re.extRenderToTextureHalfFloat?ot.HALF_FLOAT:ot.UNSIGNED_BYTE,null),$e.colorAttachment.set(De)}(ee,0,Fe,Oe,Te,Pe)}else fe.bindTexture(fe.TEXTURE_2D,Oe.colorAttachment.get()),ee.bindFramebuffer.set(Oe.framebuffer)})(x,p,l,p.transform.projection.name==="globe"?.5:.25),x.clear({color:i.aj.transparent});const N=p.transform,U=N.projection.name==="globe",$=U?["PROJECTION_GLOBE_VIEW"]:[],Z=U?Rn.frontCCW:Rn.disabled,W=[i.at(N.center.lng),i.aA(N.center.lat)];for(let ee=0;ee<m.length;ee++){const ue=m[ee];if(r.hasRenderableParent(ue))continue;const oe=r.getTile(ue),de=oe.getBucket(l);if(!de||de.projection.name!==N.projection.name)continue;const fe=p.isTileAffectedByFog(ue),Te=de.programConfigurations.get(l.id),Pe=p.getOrCreateProgram("heatmap",{config:Te,defines:$,overrideFog:fe}),{zoom:Oe}=p.transform;p.terrain&&p.terrain.setupElevationDraw(oe,Pe),p.uploadCommonUniforms(x,Pe,ue.toUnwrapped());const Fe=N.projection.createInversionMatrix(N,ue.canonical);Pe.draw(p,b.TRIANGLES,Tn.disabled,A,R,Z,hn(p,ue,oe,Fe,W,Oe,l.paint.get("heatmap-intensity")),l.id,de.layoutVertexBuffer,de.indexBuffer,de.segments,l.paint,p.transform.zoom,Te,U?[de.globeExtVertexBuffer]:null)}x.viewport.set([0,0,p.width,p.height])}else p.renderPass==="translucent"&&(p.context.setColorMode(p.colorModeForRenderPass()),function(x,b){const A=x.context,R=A.gl,N=b.heatmapFbo;if(!N)return;A.activeTexture.set(R.TEXTURE0),R.bindTexture(R.TEXTURE_2D,N.colorAttachment.get()),A.activeTexture.set(R.TEXTURE1);let U=b.colorRampTexture;U||(U=b.colorRampTexture=new i.T(A,b.colorRamp,R.RGBA8)),U.bind(R.LINEAR,R.CLAMP_TO_EDGE),x.getOrCreateProgram("heatmapTexture").draw(x,R.TRIANGLES,Tn.disabled,Dn.disabled,x.colorModeForRenderPass(),Rn.disabled,(($,Z,W,ee)=>({u_image:0,u_color_ramp:1,u_opacity:Z.paint.get("heatmap-opacity")}))(0,b),b.id,x.viewportBuffer,x.quadTriangleIndexBuffer,x.viewportSegments,b.paint,x.transform.zoom)}(p,l))},line:function(p,r,l,m){if(p.renderPass!=="translucent")return;const x=l.paint.get("line-opacity"),b=l.paint.get("line-width");if(x.constantOr(1)===0||b.constantOr(1)===0)return;const A=l.paint.get("line-emissive-strength"),R=l.paint.get("line-occlusion-opacity"),N=l.layout.get("line-elevation-reference"),U=l.layout.get("line-width-unit")==="meters",$=N==="sea",Z=p.context,W=Z.gl;if(l.hasElevatedBuckets&&p.transform.projection.name==="globe")return;const ee=l.layout.get("line-cross-slope"),ue=ee!==void 0,oe=ee<1,de=p.colorModeForDrapableLayerRenderPass(A),fe=p.terrain&&p.terrain.renderingToTexture,Te=fe?1:i.q.devicePixelRatio,Pe=l.paint.get("line-dasharray"),Oe=Pe.constantOr(1),Fe=l.layout.get("line-cap"),Re=Pe.constantOr(null),ke=Fe.constantOr(null),De=l.paint.get("line-pattern"),$e=De.constantOr(1),Xe=De.constantOr(null),ft=l.paint.get("line-opacity").constantOr(1);let ot=!$e&&ft!==1||p.depthOcclusion&&R>0&&R<1;const Et=l.paint.get("line-gradient"),vt=$e?"linePattern":"line",nt=i.c_(l);let pt;if(fe&&p.terrain&&p.terrain.clipOrMaskOverlapStencilType()&&(ot=!1),R!==0&&p.depthOcclusion){const tt=l.paint._values["line-opacity"];tt&&tt.value&&tt.value.kind==="constant"?pt=tt.value:i.w(`Occlusion opacity for layer ${l.id} is supported only when line-opacity isn't data-driven.`)}b.value.kind!=="constant"&&b.value.isLineProgressConstant===!1&&nt.push("VARIABLE_LINE_WIDTH");const Lt=(tt,St,mt,Gt,Pt)=>{for(const At of tt){const kt=r.getTile(At);if($e&&!kt.patternsLoaded())continue;const Wt=kt.getBucket(l);if(!Wt||Wt.hasZOffset&&!Pt||!Wt.hasZOffset&&Pt)continue;p.prepareDrawTile();const on=Wt.programConfigurations.get(l.id),dn=p.isTileAffectedByFog(At),En=p.getOrCreateProgram(vt,{config:on,defines:St,overrideFog:dn,overrideRtt:!Pt&&void 0});if(Xe&&kt.imageAtlas){const Fn=i.A.from(Xe).getPrimary().scaleSelf(Te).serialize(),mr=kt.imageAtlas.patternPositions[Fn];mr&&on.setConstantPatternPositions(mr)}if(!$e&&Re&&ke&&kt.lineAtlas){const Fn=kt.lineAtlas.getDash(Re,ke);Fn&&on.setConstantPatternPositions(Fn)}let[Sn,bn]=l.paint.get("line-trim-offset");(ke==="round"||ke==="square")&&Sn!==bn&&(Sn===0&&(Sn-=1),bn===1&&(bn+=1));const Ln=fe?At.projMatrix:null,zn=U?1/Wt.tileToMeter/i.ar(kt,1,p.transform.zoom):1,Mr=U?1/Wt.tileToMeter/i.ar(kt,1,Math.floor(p.transform.zoom)):1,ui=$e?i.c$(p,kt,l,Ln,Te,zn,Mr,[Sn,bn]):i.d0(p,kt,l,Ln,Wt.lineClipsArray.length,Te,zn,Mr,[Sn,bn]);if(Et){const Fn=Wt.gradients[l.id];let mr=Fn.texture;if(l.gradientVersion!==Fn.version){let sn=256;if(l.stepInterpolant){const In=r.getSource().maxzoom,An=At.canonical.z===In?Math.ceil(1<<p.transform.maxZoom-At.canonical.z):1;sn=i.aw(i.d1(Wt.maxLineLength/i.ag*1024*An),256,Z.maxTextureSize)}Fn.gradient=i.d2({expression:l.gradientExpression(),evaluationKey:"lineProgress",resolution:sn,image:Fn.gradient||void 0,clips:Wt.lineClipsArray}),Fn.texture?Fn.texture.update(Fn.gradient):Fn.texture=new i.T(Z,Fn.gradient,W.RGBA8),Fn.version=l.gradientVersion,mr=Fn.texture}Z.activeTexture.set(W.TEXTURE1),mr.bind(l.stepInterpolant?W.NEAREST:W.LINEAR,W.CLAMP_TO_EDGE)}Oe&&(Z.activeTexture.set(W.TEXTURE0),kt.lineAtlasTexture&&kt.lineAtlasTexture.bind(W.LINEAR,W.REPEAT),on.updatePaintBuffers()),$e&&(Z.activeTexture.set(W.TEXTURE0),kt.imageAtlasTexture&&kt.imageAtlasTexture.bind(W.LINEAR,W.CLAMP_TO_EDGE),on.updatePaintBuffers()),Pt&&!$&&p.terrain.setupElevationDraw(kt,En),p.uploadCommonUniforms(Z,En,At.toUnwrapped());const qr=Fn=>{pt!=null&&(pt.value=ft*R),En.draw(p,W.TRIANGLES,mt,Fn,de,Rn.disabled,ui,l.id,Wt.layoutVertexBuffer,Wt.indexBuffer,Wt.segments,l.paint,p.transform.zoom,on,[Wt.layoutVertexBuffer2,Wt.patternVertexBuffer,Wt.zOffsetVertexBuffer]),pt!=null&&(pt.value=ft)};if(ot&&!Pt){const Fn=p.stencilModeForClipping(At).ref;Fn===0&&fe&&Z.clear({stencil:0});const mr={func:W.EQUAL,mask:255};ui.u_alpha_discard_threshold=.8,qr(new Dn(mr,Fn,255,W.KEEP,W.KEEP,W.INVERT)),ui.u_alpha_discard_threshold=0,qr(new Dn(mr,Fn,255,W.KEEP,W.KEEP,W.KEEP))}else ot&&Pt&&(ui.u_alpha_discard_threshold=.001),qr(Pt?Gt:p.stencilModeForClipping(At))}};if(l.hasNonElevatedBuckets){const tt=!fe&&p.terrain;R!==0&&tt?i.w(`Occlusion opacity for layer ${l.id} is supported on terrain only if the layer has line-z-offset enabled.`):tt?i.w(`Cannot render non-elevated lines in immediate mode when terrain is enabled. Layer: ${l.id}.`):Lt(m,nt,p.depthModeForSublayer(0,Tn.ReadOnly),Dn.disabled,!1)}if(l.hasElevatedBuckets){nt.push("ELEVATED"),ue&&nt.push(oe?"CROSS_SLOPE_HORIZONTAL":"CROSS_SLOPE_VERTICAL"),$&&nt.push("ELEVATION_REFERENCE_SEA");const tt=ot?p.stencilModeFor3D():Dn.disabled,St=new Tn(p.depthOcclusion?W.GREATER:W.LEQUAL,Tn.ReadOnly,p.depthRangeFor3D);p.forceTerrainMode=!0,Lt(m,nt,St,tt,!0),p.forceTerrainMode=!1}ot&&(p.resetStencilClippingMasks(),fe&&Z.clear({stencil:0})),R===0||p.depthOcclusion||fe||p.layersWithOcclusionOpacity.push(p.currentLayer)},fill:function(p,r,l,m){const x=l.paint.get("fill-color"),b=l.paint.get("fill-opacity"),A=l.is3D(),R=new Tn(p.context.gl.LEQUAL,Tn.ReadWrite,p.depthRangeFor3D);if(b.constantOr(1)===0)return;const N=l.paint.get("fill-emissive-strength"),U=p.colorModeForDrapableLayerRenderPass(N),$=l.paint.get("fill-pattern"),Z=p.opaquePassEnabledForLayer()&&!$.constantOr(1)&&x.constantOr(i.aj.transparent).a===1&&b.constantOr(0)===1?"opaque":"translucent";if(p.renderPass===Z){const W=A?R:p.depthModeForSublayer(1,p.renderPass==="opaque"?Tn.ReadWrite:Tn.ReadOnly);Ds(p,r,l,m,W,U,!1)}if(!A&&p.renderPass==="translucent"&&l.paint.get("fill-antialias")){const W=A?R:p.depthModeForSublayer(l.getPaintProperty("fill-outline-color")?2:0,Tn.ReadOnly);Ds(p,r,l,m,W,U,!0)}},"fill-extrusion":function(p,r,l,m){const x=l.paint.get("fill-extrusion-opacity"),b=p.context,A=b.gl,R=p.terrain,N=R&&R.renderingToTexture;if(x===0)return;const U=p.conflationActive&&p.style.isLayerClipped(l,r.getSource()),$=p.style.order.indexOf(l.fqid);if(U&&function(Z,W,ee,ue,oe){for(const de of ue){const fe=W.getTile(de).getBucket(ee);fe&&(fe.updateReplacement(de,Z.replacementSource,oe),fe.uploadCentroid(Z.context))}}(p,r,l,m,$),R||U)for(const Z of m){const W=r.getTile(Z).getBucket(l);W&&Mc(p.context,r,Z,W,l,R,U)}if(p.renderPass==="shadow"&&p.shadowRenderer){const Z=p.shadowRenderer;if(R&&x<.65&&l._transitionablePaint._values["fill-extrusion-opacity"].value.expression instanceof i.a9)return;const W=Z.getShadowPassDepthMode(),ee=Z.getShadowPassColorMode();Ac(p,r,l,m,W,Dn.disabled,ee,U)}else if(p.renderPass==="translucent"){const Z=!l.paint.get("fill-extrusion-pattern").constantOr(1),W=l.paint.get("fill-extrusion-color").constantOr(i.aj.white);if(!N&&W.a!==0){const ee=new Tn(p.context.gl.LEQUAL,Tn.ReadWrite,p.depthRangeFor3D);x===1&&Z?Ac(p,r,l,m,ee,Dn.disabled,Jn.unblended,U):(Ac(p,r,l,m,ee,Dn.disabled,Jn.disabled,U),Ac(p,r,l,m,ee,p.stencilModeFor3D(),p.colorModeForRenderPass(),U),p.resetStencilClippingMasks())}if(p.style.enable3dLights()&&Z&&(!R&&p.transform.projection.name!=="globe"||N)){const ee=l.paint.get("fill-extrusion-opacity"),ue=l.paint.get("fill-extrusion-ambient-occlusion-intensity"),oe=l.paint.get("fill-extrusion-ambient-occlusion-ground-radius"),de=l.paint.get("fill-extrusion-flood-light-intensity"),fe=l.paint.get("fill-extrusion-flood-light-color-use-theme").constantOr("default")==="none",Te=l.paint.get("fill-extrusion-flood-light-color").toRenderColor(fe?null:l.lut).toArray01().slice(0,3),Pe=ue>0&&oe>0,Oe=de>0,Fe=(ke,De,$e)=>(1-$e)*ke+$e*De,Re=ke=>{const De=p.depthModeForSublayer(1,Tn.ReadOnly,A.LEQUAL,!0),$e=l.paint.get(ke?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),Xe=Fe(.1,3,$e),ft=p._showOverdrawInspector;if(!ft){const ot=new Dn({func:A.ALWAYS,mask:255},255,255,A.KEEP,A.KEEP,A.REPLACE),Et=new Jn([A.ONE,A.ONE,A.ONE,A.ONE],i.aj.transparent,[!1,!1,!1,!0],A.MIN);Cc(p,r,l,m,De,ot,Et,Rn.disabled,ke,"sdf",ee,ue,oe,de,Te,Xe,U,!1)}{const ot=ft?Dn.disabled:new Dn({func:A.EQUAL,mask:255},255,255,A.KEEP,A.DECR,A.DECR),Et=ft?p.colorModeForRenderPass():new Jn([A.ONE_MINUS_DST_ALPHA,A.DST_ALPHA,A.ONE,A.ONE],i.aj.transparent,[!0,!0,!0,!0]);Cc(p,r,l,m,De,ot,Et,Rn.disabled,ke,"color",ee,ue,oe,de,Te,Xe,U,!1)}};if(N){const ke=(De,$e,Xe)=>{const ft=p.depthModeForSublayer(1,Tn.ReadOnly,A.LEQUAL,!1),ot=l.paint.get(De?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),Et=Fe(.1,3,ot);{const vt=new Jn([A.ONE,A.ONE,A.ONE,A.ONE],i.aj.transparent,[!1,!1,!1,!0]);Cc(p,r,l,m,ft,Dn.disabled,vt,Rn.disabled,De,"clear",ee,ue,oe,de,Te,Et,U,$e)}{const vt=new Dn({func:A.ALWAYS,mask:255},255,255,A.KEEP,A.KEEP,A.REPLACE),nt=new Jn([A.ONE,A.ONE,A.ONE,A.ONE],i.aj.transparent,[!1,!1,!1,!0],A.MIN);Cc(p,r,l,m,ft,vt,nt,Rn.disabled,De,"sdf",ee,ue,oe,de,Te,Et,U,$e)}{const vt=De?A.ZERO:A.ONE_MINUS_DST_ALPHA,nt=new Dn({func:A.EQUAL,mask:255},255,255,A.KEEP,A.DECR,A.DECR),pt=new Jn([vt,A.DST_ALPHA,A.ONE_MINUS_DST_ALPHA,A.ZERO],i.aj.transparent,[!0,!0,!0,!0]);Cc(p,r,l,m,ft,nt,pt,Rn.disabled,De,"color",ee,ue,oe,de,Te,Et,U,$e)}{const vt=new Jn([A.ONE,A.ONE,A.ONE,De?A.ZERO:A.ONE],i.aj.transparent,[!1,!1,!1,!0],De?A.FUNC_ADD:A.MAX);Cc(p,r,l,m,ft,Dn.disabled,vt,Rn.disabled,De,"clear",ee,ue,oe,de,Te,Et,U,$e,Xe)}};if(Pe||Oe){let De;if(p.prepareDrawTile(),R){const $e=R.drapeBufferSize[0],Xe=R.drapeBufferSize[1];De=R.framebufferCopyTexture,De&&(!De||De.size[0]===$e&&De.size[1]===Xe)||(De&&De.destroy(),De=R.framebufferCopyTexture=new i.T(b,new i.r({width:$e,height:Xe}),A.RGBA8)),De.bind(A.LINEAR,A.CLAMP_TO_EDGE),A.copyTexSubImage2D(A.TEXTURE_2D,0,0,0,0,0,$e,Xe)}Pe&&ke(!0,!1,De),Oe&&ke(!1,!0,De)}}else Pe&&Re(!0),Oe&&Re(!1),(Pe||Oe)&&p.resetStencilClippingMasks()}}},hillshade:function(p,r,l,m){if(p.renderPass!=="offscreen"&&p.renderPass!=="translucent"||p.style.disableElevatedTerrain)return;const x=p.context,b=p.terrain&&p.terrain.renderingToTexture,[A,R]=p.renderPass!=="translucent"||b?[{},m]:p.stencilConfigForOverlap(m);for(const N of R){const U=r.getTile(N);if(U.needsHillshadePrepare&&p.renderPass==="offscreen")uh(p,U,l);else if(p.renderPass==="translucent"){const $=p.depthModeForSublayer(0,Tn.ReadOnly),Z=l.paint.get("hillshade-emissive-strength"),W=p.colorModeForDrapableLayerRenderPass(Z),ee=b&&p.terrain?p.terrain.stencilModeForRTTOverlap(N):A[N.overscaledZ];No(p,N,U,l,$,ee,W)}}x.viewport.set([0,0,p.width,p.height]),p.resetStencilClippingMasks()},raster:function(p,r,l,m,x,b){if(p.renderPass!=="translucent"||l.paint.get("raster-opacity")===0)return;const A=p.transform.projection.name==="globe",R=l.paint.get("raster-elevation")!==0,N=R&&A;if(p.renderElevatedRasterBackface&&!N)return;const U=p.context,$=U.gl,Z=r.getSource(),W=function(Re,ke,De,$e){const Xe=ke.paint.get("raster-color"),ft=Re.type==="raster-array",ot=[],Et=ke.paint.get("raster-resampling"),vt=ke.paint.get("raster-color-mix");let nt=ke.paint.get("raster-color-range");const pt=[vt[0],vt[1],vt[2],0],Lt=vt[3];let tt=Et==="nearest"?$e.NEAREST:$e.LINEAR;if(ft&&(ot.push("RASTER_ARRAY"),Xe||ot.push("RASTER_COLOR"),Et==="linear"&&ot.push("RASTER_ARRAY_LINEAR"),tt=$e.NEAREST,!nt&&Re.rasterLayers)){const St=Re.rasterLayers.find(({id:mt})=>mt===ke.sourceLayer);St&&St.fields&&St.fields.range&&(nt=St.fields.range)}if(nt=nt||[0,1],Xe){ot.push("RASTER_COLOR"),De.activeTexture.set($e.TEXTURE2),ke.updateColorRamp(nt);let St=ke.colorRampTexture;St||(St=ke.colorRampTexture=new i.T(De,ke.colorRamp,$e.RGBA8)),St.bind($e.LINEAR,$e.CLAMP_TO_EDGE)}return{mix:pt,range:nt,offset:Lt,defines:ot,resampling:tt}}(Z,l,U,$);if(Z instanceof i.aJ&&!m.length&&!A)return;const ee=l.paint.get("raster-emissive-strength"),ue=p.colorModeForDrapableLayerRenderPass(ee),oe=p.terrain&&p.terrain.renderingToTexture,de=!p.options.moving,fe=l.paint.get("raster-resampling")==="nearest"?$.NEAREST:$.LINEAR;if(Z instanceof i.aJ&&!m.length&&(Z.onNorthPole||Z.onSouthPole)){const Re=R?p.stencilModeFor3D():Dn.disabled;return void st(!!Z.onNorthPole,null,p,r,l,ee,W,Rn.disabled,Re)}if(!m.length)return;const[Te,Pe]=Z instanceof i.aJ||oe?[{},m]:p.stencilConfigForOverlap(m),Oe=Pe[Pe.length-1].overscaledZ;N&&W.defines.push("PROJECTION_GLOBE_VIEW"),R&&W.defines.push("RENDER_CUTOFF");const Fe=(Re,ke,De)=>{for(const $e of Re){const Xe=$e.toUnwrapped(),ft=r.getTile($e);if(oe&&(!ft||!ft.hasData()))continue;U.activeTexture.set($.TEXTURE0);const ot=kf(ft,Z,l,W);if(!ot||!ot.texture)continue;const{texture:Et,mix:vt,offset:nt,tileSize:pt,buffer:Lt}=ot;let tt,St;oe?(tt=Tn.disabled,St=$e.projMatrix):R?(tt=new Tn($.LEQUAL,Tn.ReadWrite,p.depthRangeFor3D),St=A?Float32Array.from(p.transform.expandedFarZProjMatrix):p.transform.calculateProjMatrix(Xe,de)):(tt=p.depthModeForSublayer($e.overscaledZ-Oe,l.paint.get("raster-opacity")===1?Tn.ReadWrite:Tn.ReadOnly,$.LESS),St=p.transform.calculateProjMatrix(Xe,de));const mt=p.terrain&&oe?p.terrain.stencilModeForRTTOverlap($e):Te[$e.overscaledZ],Gt=b?0:l.paint.get("raster-fade-duration");ft.registerFadeDuration(Gt);const Pt=r.findLoadedParent($e,0),At=Ya(ft,Pt,r,p.transform,Gt);let kt,Wt;p.terrain&&p.terrain.prepareDrawTile(),U.activeTexture.set($.TEXTURE0),Et.bind(fe,$.CLAMP_TO_EDGE),U.activeTexture.set($.TEXTURE1),Pt?(Pt.texture&&Pt.texture.bind(fe,$.CLAMP_TO_EDGE),kt=Math.pow(2,Pt.tileID.overscaledZ-ft.tileID.overscaledZ),Wt=[ft.tileID.canonical.x*kt%1,ft.tileID.canonical.y*kt%1]):Et.bind(fe,$.CLAMP_TO_EDGE),Et.useMipmap&&U.extTextureFilterAnisotropic&&p.transform.pitch>20&&$.texParameterf($.TEXTURE_2D,U.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,U.extTextureFilterAnisotropicMax);const on=p.transform;let dn;const En=R?ap(on):[0,0,0,0];let Sn,bn,Ln,zn,Mr,ui=0;if(N&&Z instanceof i.aJ&&Z.coordinates.length>3)Sn=Float32Array.from(i.bb(i.cH(new i.bT(0,0,0)))),bn=Float32Array.from(on.globeMatrix),Ln=Float32Array.from(i.cD(on)),zn=[i.at(on.center.lng),i.aA(on.center.lat)],dn=Z.elevatedGlobePerspectiveTransform,Mr=Z.elevatedGlobeGridMatrix||new Float32Array(9);else if(N){const sn=i.cE($e.canonical);ui=i.cF(sn.getCenter().lat),Sn=Float32Array.from(i.bb(i.cH($e.canonical))),bn=Float32Array.from(on.globeMatrix),Ln=Float32Array.from(i.cD(on)),zn=[i.at(on.center.lng),i.aA(on.center.lat)],dn=[0,0],Mr=Float32Array.from(i.cG($e.canonical,sn,ui,on.worldSize/on._pixelsPerMercatorPixel))}else dn=Z instanceof i.aJ?Z.perspectiveTransform:[0,0],Sn=new Float32Array(16),bn=new Float32Array(9),Ln=new Float32Array(16),zn=[0,0],Mr=new Float32Array(9);const qr=Rl(St,Sn,bn,Ln,Mr,Wt||[0,0],i.ae(p.transform.zoom),zn,En,kt||1,At,l,dn,R?l.paint.get("raster-elevation"):0,2,vt,nt,W.range,pt,Lt,ee),Fn=p.isTileAffectedByFog($e),mr=p.getOrCreateProgram("raster",{defines:W.defines,overrideFog:Fn});if(p.uploadCommonUniforms(U,mr,Xe),Z instanceof i.aJ){const sn=Z.elevatedGlobeVertexBuffer,In=Z.elevatedGlobeIndexBuffer;if(oe||!A)Z.boundsBuffer&&Z.boundsSegments&&mr.draw(p,$.TRIANGLES,tt,Dn.disabled,ue,Rn.disabled,qr,l.id,Z.boundsBuffer,p.quadTriangleIndexBuffer,Z.boundsSegments);else if(sn&&In){const An=on.zoom<=i.c6?Z.elevatedGlobeSegments:Z.getSegmentsForLongitude(on.center.lng);An&&mr.draw(p,$.TRIANGLES,tt,Dn.disabled,ue,ke,qr,l.id,sn,In,An)}}else if(N){tt=new Tn($.LEQUAL,Tn.ReadOnly,p.depthRangeFor3D);const sn=p.globeSharedBuffers;if(sn){const[In,An,Pn]=sn.getGridBuffers(ui,!1);mr.draw(p,$.TRIANGLES,tt,De||mt,p.colorModeForRenderPass(),ke,qr,l.id,In,An,Pn)}}else{const{tileBoundsBuffer:sn,tileBoundsIndexBuffer:In,tileBoundsSegments:An}=p.getTileBoundsBuffers(ft);mr.draw(p,$.TRIANGLES,tt,mt,ue,Rn.disabled,qr,l.id,sn,In,An)}}if(!(Z instanceof i.aJ)&&N)for(const $e of Re){const Xe=$e.canonical.y===(1<<$e.canonical.z)-1;$e.canonical.y===0&&st(!0,$e,p,r,l,ee,W,ke,De||Dn.disabled),Xe&&st(!1,$e,p,r,l,ee,W,ke===Rn.frontCW?Rn.backCW:Rn.frontCW,De||Dn.disabled)}};N?Fe(Pe,p.renderElevatedRasterBackface?Rn.backCW:Rn.frontCW,p.stencilModeFor3D()):Fe(Pe,Rn.disabled,void 0),p.resetStencilClippingMasks()},"raster-particle":function(p,r,l,m,x,b){p.renderPass==="offscreen"&&function(A,R,N,U){if(!U.length)return;const $=A.context,Z=$.gl,W=R.getSource();if(!(W instanceof Ai))return;const ee=Math.ceil(Math.sqrt(N.paint.get("raster-particle-count")));let ue=N.particlePositionRGBAImage;if(!ue||ue.width!==ee){const Pe=function(Oe){const Fe=Oe*Oe,Re=new Uint8Array(4*Fe),ke=function($e){return $e|=0,$e=Math.imul(2747636419^$e,2654435769),$e=Math.imul($e^$e>>>16,2654435769),(($e=Math.imul($e^$e>>>16,2654435769))>>>0)/4294967296},De=1/1.1;for(let $e=0;$e<Fe;$e++){const Xe=De*(ke(2*$e+0)+Yt),ft=De*(ke(2*$e+1)+Yt),ot=255*Xe%1,Et=255*ft%1,vt=ot,nt=ft-Et/255,pt=Et;Re[4*$e+0]=255*(Xe-ot/255),Re[4*$e+1]=255*vt,Re[4*$e+2]=255*nt,Re[4*$e+3]=255*pt}return Re}(ee);ue=N.particlePositionRGBAImage=new i.r({width:ee,height:ee},Pe)}let oe=N.particleFramebuffer;oe?oe.width!==ee&&(oe.destroy(),oe=N.particleFramebuffer=$.createFramebuffer(ee,ee,!0,null)):oe=N.particleFramebuffer=$.createFramebuffer(ee,ee,!0,null);const de=[];for(const Pe of U){const Oe=R.getTile(Pe);if(!(Oe instanceof bl))continue;const Fe=vm(Oe,W,N);if(!Fe)continue;const Re=[Oe.tileSize,Oe.tileSize];let ke=N.tileFramebuffer;ke||(ke=N.tileFramebuffer=$.createFramebuffer(Re[0],Re[1],!0,null));let De=Oe.rasterParticleState;De||(De=Oe.rasterParticleState=new ym($,Pe,Re,ue));const $e=De.update(N.lastInvalidatedAt);De.particleTextureDimension!==ee&&De.updateParticleTexture(Pe,ue);const Xe=De.targetColorTexture;De.targetColorTexture=De.backgroundColorTexture,De.backgroundColorTexture=Xe;const ft=De.particleTexture0;De.particleTexture0=De.particleTexture1,De.particleTexture1=ft,de.push([Pe,Fe,De,$e])}if(de.length===0)return;const fe=i.q.now(),Te=N.previousDrawTimestamp?.001*(fe-N.previousDrawTimestamp):.0167;if(N.previousDrawTimestamp=fe,N.hasColorMap()){$.activeTexture.set(Z.TEXTURE0+2);let Pe=N.colorRampTexture;Pe||(Pe=N.colorRampTexture=new i.T($,N.colorRamp,Z.RGBA8)),Pe.bind(Z.LINEAR,Z.CLAMP_TO_EDGE)}$.bindFramebuffer.set(N.tileFramebuffer.framebuffer),function(Pe,Oe,Fe){const Re=Pe.context,ke=Re.gl,De=Oe.tileFramebuffer;Re.activeTexture.set(ke.TEXTURE0);const $e={u_texture:0,u_opacity:1.05*(ft=Oe.paint.get("raster-particle-fade-opacity-factor"))/(ft+.05)},Xe=Pe.getOrCreateProgram("rasterParticleTexture",{defines:[],overrideFog:!1});var ft;for(const ot of Fe){const[,,Et,vt]=ot;De.colorAttachment.set(Et.targetColorTexture.texture),Re.viewport.set([0,0,De.width,De.height]),Re.clear({color:i.aj.transparent}),vt&&(Et.backgroundColorTexture.bind(ke.NEAREST,ke.CLAMP_TO_EDGE),Xe.draw(Pe,ke.TRIANGLES,Tn.disabled,Dn.disabled,Jn.alphaBlended,Rn.disabled,$e,Oe.id,Pe.viewportBuffer,Pe.quadTriangleIndexBuffer,Pe.viewportSegments))}}(A,N,de),function(Pe,Oe,Fe,Re){const ke=Pe.context,De=ke.gl,$e=Fe.tileFramebuffer,Xe=Pe.transform.projection.name==="globe",ft=Fe.paint.get("raster-particle-max-speed");for(const ot of Re){const[Et,vt,nt]=ot;ke.activeTexture.set(De.TEXTURE0+0),vt.texture.bind(De.LINEAR,De.CLAMP_TO_EDGE),$e.colorAttachment.set(nt.targetColorTexture.texture);const pt=Pe.getOrCreateProgram("rasterParticleDraw",{defines:vt.defines,overrideFog:!1});ke.activeTexture.set(De.TEXTURE0+1);const Lt=vt.scalarData?[]:[0,1,2,3].map(mt=>i.d4[mt](Et));Lt.push(Et);const tt=Et.canonical.x,St=Et.canonical.y;for(const mt of Lt){const Gt=Oe.getTile(Xe?mt.wrapped():mt);if(!Gt)continue;const Pt=Gt.rasterParticleState;if(!Pt)continue;const At=mt.canonical.x+(1<<mt.canonical.z)*(mt.wrap-Et.wrap),kt=mt.canonical.y;Pt.particleTexture0.bind(De.NEAREST,De.CLAMP_TO_EDGE);const Wt=ra(1,Pt.particleTexture0.size[0],[At-tt,kt-St],0,vt.texture.size,2,ft,vt.textureOffset,vt.scale,vt.offset);pt.draw(Pe,De.POINTS,Tn.disabled,Dn.disabled,Jn.alphaBlended,Rn.disabled,Wt,Fe.id,Pt.particleIndexBuffer,void 0,Pt.particleSegment)}}}(A,R,N,de),$.bindFramebuffer.set(N.particleFramebuffer.framebuffer),function(Pe,Oe,Fe,Re){const ke=Pe.context,De=ke.gl,$e=Oe.paint.get("raster-particle-max-speed"),Xe=Re*Oe.paint.get("raster-particle-speed-factor")*.15,ft=function(Et){return Math.pow(Et,6)}(.01+1*Oe.paint.get("raster-particle-reset-rate-factor")),ot=Oe.particleFramebuffer;ke.viewport.set([0,0,ot.width,ot.height]);for(const Et of Fe){const[,vt,nt]=Et;ke.activeTexture.set(De.TEXTURE0+0),vt.texture.bind(De.LINEAR,De.CLAMP_TO_EDGE),ke.activeTexture.set(De.TEXTURE0+1);const pt=nt.particleTexture0;pt.bind(De.NEAREST,De.CLAMP_TO_EDGE);const Lt=ip(1,pt.size[0],0,vt.texture.size,$e,Xe,ft,vt.textureOffset,vt.scale,vt.offset);ot.colorAttachment.set(nt.particleTexture1.texture),ke.clear({color:i.aj.transparent}),Pe.getOrCreateProgram("rasterParticleUpdate",{defines:vt.defines}).draw(Pe,De.TRIANGLES,Tn.disabled,Dn.disabled,Jn.unblended,Rn.disabled,Lt,Oe.id,Pe.viewportBuffer,Pe.quadTriangleIndexBuffer,Pe.viewportSegments)}}(A,N,de,Te)}(p,r,l,m),p.renderPass==="translucent"&&(function(A,R,N,U,$){const Z=A.context,W=Z.gl,ee=R.getSource().tileSize,ue=5*(1-i.ac(i.bY,i.bY+1,A.transform.zoom))*ee+N.paint.get("raster-particle-elevation"),oe=!A.options.moving,de=A.transform.projection.name==="globe";if(!U.length)return;const[fe,Te]=A.stencilConfigForOverlap(U),Pe=[];de&&Pe.push("PROJECTION_GLOBE_VIEW");const Oe=A.stencilModeFor3D();for(const Fe of Te){const Re=Fe.toUnwrapped(),ke=R.getTile(Fe);if(!ke.rasterParticleState)continue;const De=ke.rasterParticleState,$e=100;ke.registerFadeDuration($e);const Xe=R.findLoadedParent(Fe,0),ft=Ya(ke,Xe,R,A.transform,$e);let ot,Et;A.terrain&&A.terrain.prepareDrawTile(),Z.activeTexture.set(W.TEXTURE0),De.targetColorTexture.bind(W.LINEAR,W.CLAMP_TO_EDGE),Z.activeTexture.set(W.TEXTURE1),Xe&&Xe.rasterParticleState?(Xe.rasterParticleState.targetColorTexture.bind(W.LINEAR,W.CLAMP_TO_EDGE),ot=Math.pow(2,Xe.tileID.overscaledZ-ke.tileID.overscaledZ),Et=[ke.tileID.canonical.x*ot%1,ke.tileID.canonical.y*ot%1]):De.targetColorTexture.bind(W.LINEAR,W.CLAMP_TO_EDGE);const vt=de?Float32Array.from(A.transform.expandedFarZProjMatrix):A.transform.calculateProjMatrix(Re,oe),nt=A.transform,pt=xm(nt),Lt=i.cE(Fe.canonical),tt=i.cF(Lt.getCenter().lat);let St,mt,Gt,Pt,At;de?(St=Float32Array.from(i.bb(i.cH(Fe.canonical))),mt=Float32Array.from(nt.globeMatrix),Gt=Float32Array.from(i.cD(nt)),Pt=[i.at(nt.center.lng),i.aA(nt.center.lat)],At=Float32Array.from(i.cG(Fe.canonical,Lt,tt,nt.worldSize/nt._pixelsPerMercatorPixel))):(St=new Float32Array(16),mt=new Float32Array(9),Gt=new Float32Array(16),Pt=[0,0],At=new Float32Array(9));const kt=ti(vt,St,mt,Gt,At,Et||[0,0],i.ae(A.transform.zoom),Pt,pt,ot||1,ft,ue),Wt=A.isTileAffectedByFog(Fe),on=A.getOrCreateProgram("rasterParticle",{defines:Pe,overrideFog:Wt});if(A.uploadCommonUniforms(Z,on,Re),de){const dn=new Tn(W.LEQUAL,Tn.ReadOnly,A.depthRangeFor3D),En=0,Sn=A.globeSharedBuffers;if(Sn){const[bn,Ln,zn]=Sn.getGridBuffers(tt,En!==0);on.draw(A,W.TRIANGLES,dn,Oe,Jn.alphaBlended,A.renderElevatedRasterBackface?Rn.frontCCW:Rn.backCCW,kt,N.id,bn,Ln,zn)}}else{const dn=A.depthModeForSublayer(0,Tn.ReadOnly),En=fe[Fe.overscaledZ],{tileBoundsBuffer:Sn,tileBoundsIndexBuffer:bn,tileBoundsSegments:Ln}=A.getTileBoundsBuffers(ke);on.draw(A,W.TRIANGLES,dn,En,Jn.alphaBlended,Rn.disabled,kt,N.id,Sn,bn,Ln)}}A.resetStencilClippingMasks()}(p,r,l,m),p.style.map.triggerRepaint())},background:function(p,r,l,m){const x=l.paint.get("background-color"),b=l.paint.get("background-color-use-theme").constantOr("default")==="none",A=l.paint.get("background-opacity"),R=l.paint.get("background-emissive-strength"),N=l.paint.get("background-pitch-alignment")==="viewport";if(A===0)return;const U=p.context,$=U.gl,Z=p.transform,W=Z.tileSize,ee=l.paint.get("background-pattern");let ue;if(ee!==void 0&&(ee===null||(ue=p.imageManager.getPattern(ee.toString(),l.scope,p.style.getLut(l.scope)),!ue)))return;const oe=!ee&&x.a===1&&A===1&&p.opaquePassEnabledForLayer()?"opaque":"translucent";if(p.renderPass!==oe)return;const de=Dn.disabled,fe=p.depthModeForSublayer(0,oe==="opaque"?Tn.ReadWrite:Tn.ReadOnly),Te=p.colorModeForDrapableLayerRenderPass(R),Pe=ee?"backgroundPattern":"background";let Oe,Fe=m;if(Fe||(Oe=p.getBackgroundTiles(),Fe=Object.values(Oe).map(Re=>Re.tileID)),ee&&(U.activeTexture.set($.TEXTURE0),p.imageManager.bind(p.context,l.scope)),N){const Re=p.getOrCreateProgram(Pe,{overrideFog:!1,overrideRtt:!0}),ke=new Float32Array(i.ab.mat4.identity([])),De=new i.aG(0,0,0,0,0),$e=ee?wh(ke,R,A,p,0,l.scope,ue,N,{tileID:De,tileSize:W}):bh(ke,R,A,x.toRenderColor(b?null:l.lut));Re.draw(p,$.TRIANGLES,fe,de,Te,Rn.disabled,$e,l.id,p.viewportBuffer,p.quadTriangleIndexBuffer,p.viewportSegments)}else for(const Re of Fe){const ke=p.isTileAffectedByFog(Re),De=p.getOrCreateProgram(Pe,{overrideFog:ke}),$e=Re.toUnwrapped(),Xe=m?Re.projMatrix:p.transform.calculateProjMatrix($e);p.prepareDrawTile();const ft=r?r.getTile(Re):Oe?Oe[Re.key]:new xl(Re,W,Z.zoom,p),ot=ee?wh(Xe,R,A,p,0,l.scope,ue,N,{tileID:Re,tileSize:W}):bh(Xe,R,A,x.toRenderColor(b?null:l.lut));p.uploadCommonUniforms(U,De,$e);const{tileBoundsBuffer:Et,tileBoundsIndexBuffer:vt,tileBoundsSegments:nt}=p.getTileBoundsBuffers(ft);De.draw(p,$.TRIANGLES,fe,de,Te,Rn.disabled,ot,l.id,Et,vt,nt)}},sky:function(p,r,l){const m=p._atmosphere?i.ae(p.transform.zoom):1,x=l.paint.get("sky-opacity")*m;if(x===0)return;const b=p.context,A=l.paint.get("sky-type"),R=new Tn(b.gl.LEQUAL,Tn.ReadOnly,[0,1]),N=p.frameCounter/1e3%1;A==="atmosphere"?p.renderPass==="offscreen"?l.needsSkyboxCapture(p)&&(function(U,$,Z,W){const ee=U.context,ue=ee.gl;let oe=$.skyboxFbo;if(!oe){oe=$.skyboxFbo=ee.createFramebuffer(32,32,!0,null),$.skyboxGeometry=new Sm(ee),$.skyboxTexture=ee.gl.createTexture(),ue.bindTexture(ue.TEXTURE_CUBE_MAP,$.skyboxTexture),ue.texParameteri(ue.TEXTURE_CUBE_MAP,ue.TEXTURE_WRAP_S,ue.CLAMP_TO_EDGE),ue.texParameteri(ue.TEXTURE_CUBE_MAP,ue.TEXTURE_WRAP_T,ue.CLAMP_TO_EDGE),ue.texParameteri(ue.TEXTURE_CUBE_MAP,ue.TEXTURE_MIN_FILTER,ue.LINEAR),ue.texParameteri(ue.TEXTURE_CUBE_MAP,ue.TEXTURE_MAG_FILTER,ue.LINEAR);for(let Pe=0;Pe<6;++Pe)ue.texImage2D(ue.TEXTURE_CUBE_MAP_POSITIVE_X+Pe,0,ue.RGBA,32,32,0,ue.RGBA,ue.UNSIGNED_BYTE,null)}ee.bindFramebuffer.set(oe.framebuffer),ee.viewport.set([0,0,32,32]);const de=$.getCenter(U,!0),fe=U.getOrCreateProgram("skyboxCapture"),Te=new Float64Array(16);i.ab.mat4.identity(Te),i.ab.mat4.rotateY(Te,Te,.5*-Math.PI),Vi(U,$,fe,Te,de,0),i.ab.mat4.identity(Te),i.ab.mat4.rotateY(Te,Te,.5*Math.PI),Vi(U,$,fe,Te,de,1),i.ab.mat4.identity(Te),i.ab.mat4.rotateX(Te,Te,.5*-Math.PI),Vi(U,$,fe,Te,de,2),i.ab.mat4.identity(Te),i.ab.mat4.rotateX(Te,Te,.5*Math.PI),Vi(U,$,fe,Te,de,3),i.ab.mat4.identity(Te),Vi(U,$,fe,Te,de,4),i.ab.mat4.identity(Te),i.ab.mat4.rotateY(Te,Te,Math.PI),Vi(U,$,fe,Te,de,5),ee.viewport.set([0,0,U.width,U.height])}(p,l),l.markSkyboxValid(p)):p.renderPass==="sky"&&function(U,$,Z,W,ee){const ue=U.context,oe=ue.gl,de=U.transform,fe=U.getOrCreateProgram("skybox");ue.activeTexture.set(oe.TEXTURE0),oe.bindTexture(oe.TEXTURE_CUBE_MAP,$.skyboxTexture);const Te=((Pe,Oe,Fe,Re,ke)=>({u_matrix:Pe,u_sun_direction:Oe,u_cubemap:0,u_opacity:Re,u_temporal_offset:ke}))(de.skyboxMatrix,$.getCenter(U,!1),0,W,ee);U.uploadCommonUniforms(ue,fe),fe.draw(U,oe.TRIANGLES,Z,Dn.disabled,U.colorModeForRenderPass(),Rn.backCW,Te,"skybox",$.skyboxGeometry.vertexBuffer,$.skyboxGeometry.indexBuffer,$.skyboxGeometry.segment)}(p,l,R,x,N):A==="gradient"&&p.renderPass==="sky"&&function(U,$,Z,W,ee){const ue=U.context,oe=ue.gl,de=U.transform,fe=U.getOrCreateProgram("skyboxGradient");$.skyboxGeometry||($.skyboxGeometry=new Sm(ue)),ue.activeTexture.set(oe.TEXTURE0);let Te=$.colorRampTexture;Te||(Te=$.colorRampTexture=new i.T(ue,$.colorRamp,oe.RGBA8)),Te.bind(oe.LINEAR,oe.CLAMP_TO_EDGE);const Pe=((Oe,Fe,Re,ke,De)=>({u_matrix:Oe,u_color_ramp:0,u_center_direction:Fe,u_radius:i.ai(Re),u_opacity:ke,u_temporal_offset:De}))(de.skyboxMatrix,$.getCenter(U,!1),$.paint.get("sky-gradient-radius"),W,ee);U.uploadCommonUniforms(ue,fe),fe.draw(U,oe.TRIANGLES,Z,Dn.disabled,U.colorModeForRenderPass(),Rn.backCW,Pe,"skyboxGradient",$.skyboxGeometry.vertexBuffer,$.skyboxGeometry.indexBuffer,$.skyboxGeometry.segment)}(p,l,R,x,N)},debug:function(p,r,l,m,x,b){for(let A=0;A<l.length;A++)if(x){const U=new i.aj(m.r*.8,m.g*.8,m.b*.8,1);kl(p,r,l[A],m,-1,-1,b),kl(p,r,l[A],m,-1,1,b),kl(p,r,l[A],m,1,1,b),kl(p,r,l[A],m,1,-1,b),kl(p,r,l[A],U,0,0,b)}else kl(p,r,l[A],m,0,0,b)},custom:function(p,r,l,m){const x=p.context,b=l.implementation;if(!p.transform.projection.unsupportedLayers||!p.transform.projection.unsupportedLayers.includes("custom")||p.terrain&&(p.terrain.renderingToTexture||p.renderPass==="offscreen")&&l.isDraped(r)){if(p.renderPass==="offscreen"){const A=b.prerender;if(A){if(p.setCustomLayerDefaults(),x.setColorMode(p.colorModeForRenderPass()),p.transform.projection.name==="globe"){const R=p.transform.pointMerc;A.call(b,x.gl,p.transform.customLayerMatrix(),p.transform.getProjection(),p.transform.globeToMercatorMatrix(),i.ae(p.transform.zoom),[R.x,R.y],p.transform.pixelsPerMeterRatio)}else A.call(b,x.gl,p.transform.customLayerMatrix());x.setDirty(),p.setBaseState()}}else if(p.renderPass==="translucent"){if(p.terrain&&p.terrain.renderingToTexture){const R=b.renderToTile;if(R){const N=m[0].canonical,U=new i.aa(N.x+m[0].wrap*(1<<N.z),N.y,N.z);x.setDepthMode(Tn.disabled),x.setStencilMode(Dn.disabled),x.setColorMode(p.colorModeForRenderPass()),p.setCustomLayerDefaults(),R.call(b,x.gl,U),x.setDirty(),p.setBaseState()}return}p.setCustomLayerDefaults(),x.setColorMode(p.colorModeForRenderPass()),x.setStencilMode(Dn.disabled);const A=b.renderingMode==="3d"?new Tn(p.context.gl.LEQUAL,Tn.ReadWrite,p.depthRangeFor3D):p.depthModeForSublayer(0,Tn.ReadOnly);if(x.setDepthMode(A),p.transform.projection.name==="globe"){const R=p.transform.pointMerc;b.render(x.gl,p.transform.customLayerMatrix(),p.transform.getProjection(),p.transform.globeToMercatorMatrix(),i.ae(p.transform.zoom),[R.x,R.y],p.transform.pixelsPerMeterRatio)}else b.render(x.gl,p.transform.customLayerMatrix());x.setDirty(),p.setBaseState(),x.bindFramebuffer.set(null)}}else i.w("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")},model:function(p,r,l,m){if(p.renderPass==="opaque")return;const x=l.paint.get("model-opacity").constantOr(1);if(x===0)return;const b=l.paint.get("model-cast-shadows");if(p.renderPass==="shadow"&&(!b||p.terrain&&x<.65&&l._transitionablePaint._values["model-opacity"].value.expression instanceof i.a9))return;const A=p.shadowRenderer,R=l.paint.get("model-receive-shadows");A&&(A.useNormalOffset=!0,R||(A.enabled=!1));const N=()=>{A&&(A.useNormalOffset=!0,R||(A.enabled=!0))},U=r.getSource();if(p.renderPass==="light-beam"&&U.type!=="batched-model")return;if(U.type==="vector"||U.type==="geojson")return function(fe,Te,Pe,Oe,Fe){const Re=fe.transform;if(Re.projection.name!=="mercator")return void i.w(`Drawing 3D models for ${Re.projection.name} projection is not yet implemented`);const ke=Re.getFreeCameraOptions().position;if(!fe.modelManager)return;const De=fe.modelManager;Pe.modelManager=De;const $e=fe.shadowRenderer;if(!Pe._unevaluatedLayout._values.hasOwnProperty("model-id"))return;const Xe=Pe._unevaluatedLayout._values["model-id"],ft=Object.assign({},Pe.layout.get("model-id").parameters),ot=fe.style.order.indexOf(Pe.fqid);for(const Et of Oe){const vt=Te.getTile(Et).getBucket(Pe);if(!vt||vt.projection.name!==Re.projection.name)continue;const nt=vt.getModelUris();nt&&!vt.modelsRequested&&(De.addModelsFromBucket(nt,Fe),vt.modelsRequested=!0);const pt=jf(Et,Re);ft.zoom=pt;const Lt=Xe.possiblyEvaluate(ft);if(tl(fe,vt,Et),ba.shadowUniformsInitialized=!1,ba.useSingleShadowCascade=!!$e&&$e.getMaxCascadeForTile(Et.toUnwrapped())===0,fe.renderPass==="shadow"&&$e){if(fe.currentShadowCascade===1&&vt.isInsideFirstShadowMapFrustum)continue;const mt=Re.calculatePosMatrix(Et.toUnwrapped(),Re.worldSize);if(ba.tileMatrix.set(mt),ba.shadowTileMatrix=Float32Array.from($e.calculateShadowPassMatrixFromMatrix(mt)),ba.aabb.min.fill(0),ba.aabb.max[0]=ba.aabb.max[1]=i.ag,ba.aabb.max[2]=0,lp(vt,ba,fe,Pe.scope))continue}const tt=1<<Et.canonical.z,St=[((ke.x-Et.wrap)*tt-Et.canonical.x)*i.ag,(ke.y*tt-Et.canonical.y)*i.ag,ke.z*tt*i.ag];fe.conflationActive&&Object.keys(vt.instancesPerModel).length>0&&fe.style.isLayerClipped(Pe,Te.getSource())&&vt.updateReplacement(Et,fe.replacementSource,ot,Fe)&&(vt.uploaded=!1,vt.upload(fe.context));for(let mt in vt.instancesPerModel){const Gt=vt.instancesPerModel[mt];Gt.features.length>0&&(mt=Lt.evaluate(Gt.features[0].feature,{}));const Pt=De.getModel(mt,Fe);if(Pt&&Pt.uploaded)for(const At of Pt.nodes)Ch(fe,Pe,At,Gt,St,Et,ba)}}}(p,r,l,m,U.type==="vector"?l.scope:""),void N();if(!U.loaded())return;if(U.type==="batched-model")return function(fe,Te,Pe,Oe){Pe.resetLayerRenderingStats(fe);const Fe=fe.context,Re=fe.transform,ke=fe.style.fog,De=fe.shadowRenderer;if(Re.projection.name!=="mercator")return void i.w(`Drawing 3D landmark models for ${Re.projection.name} projection is not yet implemented`);const $e=fe.transform.getFreeCameraOptions().position,Xe=i.ab.vec3.scale([],[$e.x,$e.y,$e.z],fe.transform.worldSize),ft=i.ab.vec3.negate([],Xe),ot=i.ab.mat4.identity([]),Et=i.dj(Re.center.lat,Re.zoom),vt=i.ab.mat4.fromScaling([],[1,1,1/Et]);i.ab.mat4.translate(ot,ot,ft);const nt=Pe.paint.get("model-opacity").constantOr(1),pt=new Tn(Fe.gl.LEQUAL,Tn.ReadWrite,fe.depthRangeFor3D),Lt=new Tn(Fe.gl.LEQUAL,Tn.ReadOnly,fe.depthRangeFor3D),tt=new i.cd([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),St=fe.renderPass==="shadow",mt=St&&De?De.getCurrentCascadeFrustum():Re.getFrustum(Re.scaleZoom(Re.worldSize)),Gt=Pe.paint.get("model-front-cutoff"),Pt=Gt[2]<1,At=sc(fe,Pe.paint.get("model-cutoff-fade-range")),kt=Pe.getLayerRenderingStats();(function(Wt,on,dn,En){const Sn=Wt.terrain?Wt.terrain.exaggeration():0,bn=Wt.transform.zoom;for(const Ln of En){const zn=on.getTile(Ln).getBucket(dn);zn&&(Wt.conflationActive&&zn.updateReplacement(Ln,Wt.replacementSource),zn.evaluateScale(Wt,dn),Wt.terrain&&Sn>0&&zn.elevationUpdate(Wt.terrain,Sn,Ln,dn.source),zn.needsReEvaluation(Wt,bn,dn)&&zn.evaluate(dn))}})(fe,Te,Pe,Oe),function(){let Wt,on,dn;Pt?(Wt=Oe.length-1,on=-1,dn=-1):(Wt=0,on=Oe.length,dn=1);const En=new Float64Array(16),Sn=i.ab.vec3.create(),bn=new i.P(0,0);for(let Ln=Wt;Ln!==on;Ln+=dn){const zn=Oe[Ln],Mr=Te.getTile(zn).getBucket(Pe);if(!Mr||!Mr.uploaded)continue;let ui=!1;De&&(ui=De.getMaxCascadeForTile(zn.toUnwrapped())===0);const qr=Re.calculatePosMatrix(zn.toUnwrapped(),Re.worldSize),Fn=Mr.modelTraits;!St&&Pt&&(i.ab.mat4.invert(En,qr),i.ab.vec3.transformMat4(Sn,Xe,En),bn.x=Sn[0],bn.y=Sn[1]);const mr=[];for(const sn of Mr.getNodesInfo()){if(sn.hiddenByReplacement||!sn.node.meshes)continue;const In=sn.node;let An=0;fe.terrain&&In.elevation&&(An=In.elevation*fe.terrain.exaggeration());const Pn=(()=>{const cr=sn.aabb;return tt.min=[...cr.min],tt.max=[...cr.max],tt.min[2]+=An,tt.max[2]+=An,i.ab.vec3.transformMat4(tt.min,tt.min,qr),i.ab.vec3.transformMat4(tt.max,tt.max,qr),tt})(),or=sn.evaluatedScale;if(or[0]<=1&&or[1]<=1&&or[2]<=1&&Pn.intersects(mt)===0)continue;if(!St&&Pt){const cr=.16666666666666666;sn.cameraCollisionOpacity=Xe[0]>Pn.min[0]&&Xe[0]<Pn.max[0]&&Xe[1]>Pn.min[1]&&Xe[1]<Pn.max[1]&&Xe[2]*Et<Pn.max[2]&&In.footprint&&i.bA(bn,In.footprint)?Math.max(sn.cameraCollisionOpacity-cr,0):Math.min(1,sn.cameraCollisionOpacity+cr)}const Gr=[...qr],Kr=In.anchor?In.anchor[0]:0,hi=In.anchor?In.anchor[1]:0;i.ab.mat4.translate(Gr,Gr,[Kr*(or[0]-1),hi*(or[1]-1),An]),i.ab.vec3.exactEquals(or,i.dm)||i.ab.mat4.scale(Gr,Gr,or);const po=i.ab.mat4.multiply([],Gr,In.matrix),Ci=i.ab.mat4.multiply([],Re.expandedFarZProjMatrix,po),hr=i.ab.mat4.multiply([],Re.expandedFarZProjMatrix,Gr),Tr=i.ab.vec4.transformMat4([],[Kr,hi,An,1],Ci)[2];In.hidden=!1;let Sr=nt;St||(Pt&&(Sr*=sn.cameraCollisionOpacity,Sr*=Tm(Gr,Re,sn.aabb,Gt)),Sr*=Ic(At,Tr)),Sr!==0?mr.push({nodeInfo:sn,depth:Tr,opacity:Sr,wvpForNode:Ci,wvpForTile:hr,nodeModelMatrix:po,tileModelMatrix:Gr}):In.hidden=!0}St||mr.sort((sn,In)=>!Pt||sn.opacity===1&&In.opacity===1?sn.depth<In.depth?-1:1:sn.opacity===1?-1:In.opacity===1?1:sn.depth>In.depth?-1:1);for(const sn of mr){const In=sn.nodeInfo,An=In.node;let Pn=i.ab.mat4.multiply([],vt,sn.tileModelMatrix);i.ab.mat4.multiply(Pn,ot,Pn);const or=i.ab.mat4.invert([],Pn);i.ab.mat4.transpose(or,or),i.ab.mat4.scale(or,or,Uf),Pn=i.ab.mat4.multiply(Pn,Pn,An.matrix);const Gr=fe.renderPass==="light-beam",Kr=Pe.paint.get("model-color-use-theme").constantOr("default")==="none",hi=Fn&i.dp.HasMapboxMeshFeatures,po=hi?0:In.evaluatedRMEA[0][2];for(let Ci=0;Ci<An.meshes.length;++Ci){const hr=An.meshes[Ci],Tr=Ci===An.lightMeshIndex;let Sr=sn.wvpForNode;if(Tr){if(!Gr&&!fe.terrain&&fe.shadowRenderer){fe.currentLayer<fe.firstLightBeamLayer&&(fe.firstLightBeamLayer=fe.currentLayer);continue}Sr=sn.wvpForTile}else if(Gr)continue;const cr={defines:[]},Nr=[];if(!St&&De&&(De.useNormalOffset=!!hr.normalBuffer),Tu(cr.defines,Nr,hr,fe,Kr?null:Pe.lut),hi||cr.defines.push("DIFFUSE_SHADED"),ui&&cr.defines.push("SHADOWS_SINGLE_CASCADE"),kt&&(St?kt.numRenderedVerticesInShadowPass+=hr.vertexArray.length:kt.numRenderedVerticesInTransparentPass+=hr.vertexArray.length),St){Ah(hr,sn.nodeModelMatrix,fe,Pe);continue}let xi=null;if(ke){const Go=el(sn.nodeModelMatrix,fe.transform);if(xi=new Float32Array(Go),Re.projection.name!=="globe"){const Sa=hr.aabb.min,eo=hr.aabb.max,[Ho,Oo]=ke.getOpacityForBounds(Go,Sa[0],Sa[1],eo[0],eo[1]);cr.overrideFog=Ho>=je||Oo>=je}}const Or=hr.material;let bi;Or.occlusionTexture&&Or.occlusionTexture.offsetScale&&(bi=Or.occlusionTexture.offsetScale,cr.defines.push("OCCLUSION_TEXTURE_TRANSFORM"));const Mo=fe.getOrCreateProgram("model",cr);!St&&De&&De.setupShadowsFromMatrix(sn.tileModelMatrix,Mo,De.useNormalOffset),fe.uploadCommonUniforms(Fe,Mo,null,xi);const Qa=Or.pbrMetallicRoughness;Qa.metallicFactor=.9,Qa.roughnessFactor=.5;const ka=Df(new Float32Array(Sr),new Float32Array(Pn),new Float32Array(or),new Float32Array(An.matrix),fe,sn.opacity,Qa.baseColorFactor.toRenderColor(null),Or.emissiveFactor,Qa.metallicFactor,Qa.roughnessFactor,Or,po,Pe,[0,0,0],bi);!Tr&&(In.hasTranslucentParts||sn.opacity<1)&&Mo.draw(fe,Fe.gl.TRIANGLES,pt,Dn.disabled,Jn.disabled,Rn.backCCW,ka,Pe.id,hr.vertexBuffer,hr.indexBuffer,hr.segments,Pe.paint,fe.transform.zoom,void 0,Nr),Mo.draw(fe,Fe.gl.TRIANGLES,Tr?Lt:pt,Dn.disabled,Tr||sn.opacity<1||In.hasTranslucentParts?Jn.alphaBlended:Jn.unblended,Rn.backCCW,ka,Pe.id,hr.vertexBuffer,hr.indexBuffer,hr.segments,Pe.paint,fe.transform.zoom,void 0,Nr)}}}}()}(p,r,l,m),void N();if(U.type!=="model")return;const $=U.getModels(),Z=[],W=p.transform.getFreeCameraOptions().position,ee=i.ab.vec3.scale([],[W.x,W.y,W.z],p.transform.worldSize);i.ab.vec3.negate(ee,ee);const ue=[],oe=[];let de=0;for(const fe of $){const Te=l.paint.get("model-rotation").constantOr(null),Pe=l.paint.get("model-scale").constantOr(null),Oe=l.paint.get("model-translation").constantOr(null);fe.computeModelMatrix(p,Te,Pe,Oe,!0,!0,!1);const Fe=i.ab.mat4.identity([]),Re=i.dj(fe.position.lat,p.transform.zoom),ke=i.ab.mat4.fromScaling([],[1,1,1/Re]);i.ab.mat4.translate(Fe,Fe,ee),Z.push({zScaleMatrix:ke,negCameraPosMatrix:Fe});for(const De of fe.nodes)Ff(p.transform,De,fe.matrix,p.transform.expandedFarZProjMatrix,de,ue,oe);de++}if(ue.sort((fe,Te)=>Te.depth-fe.depth),p.renderPass!=="shadow"){if(x===1)for(const fe of oe)Ls(fe,p,l,Z[fe.modelIndex],Dn.disabled,p.colorModeForRenderPass());else{for(const fe of oe)Ls(fe,p,l,Z[fe.modelIndex],Dn.disabled,Jn.disabled);for(const fe of oe)Ls(fe,p,l,Z[fe.modelIndex],p.stencilModeFor3D(),p.colorModeForRenderPass());p.resetStencilClippingMasks()}for(const fe of ue)Ls(fe,p,l,Z[fe.modelIndex],Dn.disabled,p.colorModeForRenderPass());N()}else{for(const fe of oe)Ah(fe.mesh,fe.nodeModelMatrix,p,l);for(const fe of ue)Ah(fe.mesh,fe.nodeModelMatrix,p,l);N()}}},Ih={line:function(p,r,l){if(p.hasElevatedBuckets=!1,p.hasNonElevatedBuckets=!1,p._unevaluatedLayout.getValue("line-elevation-reference")!==void 0||p._unevaluatedLayout.getValue("line-z-offset")!==void 0){if(r){const m=r.getVisibleCoordinates();for(const x of m){const b=r.getTile(x).getBucket(p);if(b&&(b.hasZOffset?p.hasElevatedBuckets=!0:p.hasNonElevatedBuckets=!0,p.hasElevatedBuckets&&p.hasNonElevatedBuckets))break}}}else p.hasNonElevatedBuckets=!0},model:function(p,r,l){const m=r.getSource();if(!m.loaded())return;if(m.type==="vector"||m.type==="geojson")return void(l.modelManager&&l.modelManager.upload(l,m.type==="vector"?p.scope:""));if(m.type==="batched-model"||m.type!=="model")return;const x=m.getModels();for(const b of x)b.upload(l.context)},raster:function(p,r,l){const m=r.getSource();if(!(m instanceof Ai&&m.loaded()))return;const x=p.sourceLayer||m.rasterLayerIds&&m.rasterLayerIds[0];if(!x)return;const b=p.paint.get("raster-array-band")||m.getInitialBand(x);if(b==null)return;const A=r.getIds().map(R=>r.getTileByID(R));for(const R of A)R.updateNeeded(x,b)&&m.prepareTile(R,x,b)},"raster-particle":function(p,r,l){const m=r.getSource();if(!(m instanceof Ai&&m.loaded()))return;const x=p.sourceLayer||m.rasterLayerIds&&m.rasterLayerIds[0];if(!x)return;const b=p.paint.get("raster-particle-array-band")||m.getInitialBand(x);if(b==null)return;const A=r.getIds().map(R=>r.getTileByID(R));for(const R of A)R.updateNeeded(x,b)&&m.prepareTile(R,x,b)}};class fp{constructor(r,l,m,x,b){this.context=new zf(r,l),this.transform=m,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.tp=b,this._timeStamp=i.q.now(),this._averageFPS=0,this._fpsHistory=[],this._dt=0,this._debugParams={forceEnablePrecipitation:!1,showTerrainProxyTiles:!1,fpsWindow:30,continousRedraw:!1,enabledLayers:{}};const A=["fill","line","symbol","circle","heatmap","fill-extrusion","raster","raster-particle","hillshade","model","background","sky"];for(const N of A)this._debugParams.enabledLayers[N]=!0;b.registerParameter(this._debugParams,["Terrain"],"showTerrainProxyTiles",{},()=>{this.style.map.triggerRepaint()}),b.registerParameter(this._debugParams,["Precipitation"],"forceEnablePrecipitation"),b.registerParameter(this._debugParams,["FPS"],"fpsWindow",{min:1,max:100,step:1}),b.registerBinding(this._debugParams,["FPS"],"continousRedraw",{readonly:!0,label:"continuous redraw"}),b.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"value"}),b.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"graph",view:"graph",min:0,max:200});for(const N of A)b.registerParameter(this._debugParams.enabledLayers,["Debug","Layers"],N);this.occlusionParams=new Rc(b),this.setup(),this.numSublayers=rs.maxUnderzooming+rs.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={},this.conflationActive=!1,this.replacementSource=new i.dv,this.longestCutoffRange=0,this.minCutoffZoom=0,this._fogVisible=!1,this._cachedTileFogOpacities={},this._shadowRenderer=new ya(this),this._wireframeDebugCache=new cp,this.renderDefaultNorthPole=!0,this.renderDefaultSouthPole=!0,this.layersWithOcclusionOpacity=[];const R=new i.r({width:1,height:1},Uint8Array.of(0,0,0,0));this.emptyDepthTexture=new i.T(this.context,R,r.RGBA8),this._clippingActiveLastFrame=!1,this.scaleFactor=x}updateTerrain(r,l){const m=!!r&&!!r.terrain&&this.transform.projection.supportsTerrain;if(!(m||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new Fo(this,r));const x=this._terrain;this.transform.elevation=m?x:null,x.update(r,this.transform,l),this.transform.elevation&&!x.enabled&&(this.transform.elevation=null)}_updateFog(r){const l=r.fog;if(!l||this.transform.projection.name==="globe"||l.getOpacity(this.transform.pitch)<1||l.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[m,x]=l.getFovAdjustedRange(this.transform._fov);if(m>x)return void(this.transform.fogCullDistSq=null);const b=m+.78*(x-m);this.transform.fogCullDistSq=b*b}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled||this._forceTerrainMode?this._terrain:null}get forceTerrainMode(){return this._forceTerrainMode}set forceTerrainMode(r){r&&!this._terrain&&(this._terrain=new Fo(this,this.style)),this._forceTerrainMode=r}get shadowRenderer(){return this._shadowRenderer&&this._shadowRenderer.enabled?this._shadowRenderer:null}get wireframeDebugCache(){return this._wireframeDebugCache}resize(r,l){if(this.width=r*i.q.devicePixelRatio,this.height=l*i.q.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const m of this.style.order)this.style._mergedLayers[m].resize()}setup(){const r=this.context,l=new i.b4;l.emplaceBack(0,0),l.emplaceBack(i.ag,0),l.emplaceBack(0,i.ag),l.emplaceBack(i.ag,i.ag),this.tileExtentBuffer=r.createVertexBuffer(l,i.b6.members),this.tileExtentSegments=i.b7.simpleSegment(0,0,4,2);const m=new i.b4;m.emplaceBack(0,0),m.emplaceBack(i.ag,0),m.emplaceBack(0,i.ag),m.emplaceBack(i.ag,i.ag),this.debugBuffer=r.createVertexBuffer(m,i.b6.members),this.debugSegments=i.b7.simpleSegment(0,0,4,5);const x=new i.b4;x.emplaceBack(-1,-1),x.emplaceBack(1,-1),x.emplaceBack(-1,1),x.emplaceBack(1,1),this.viewportBuffer=r.createVertexBuffer(x,i.b6.members),this.viewportSegments=i.b7.simpleSegment(0,0,4,2);const b=new i.aT;b.emplaceBack(0,0,0,0),b.emplaceBack(i.ag,0,i.ag,0),b.emplaceBack(0,i.ag,0,i.ag),b.emplaceBack(i.ag,i.ag,i.ag,i.ag),this.mercatorBoundsBuffer=r.createVertexBuffer(b,i.b9.members),this.mercatorBoundsSegments=i.b7.simpleSegment(0,0,4,2);const A=new i.aU;A.emplaceBack(0,1,2),A.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=r.createIndexBuffer(A);const R=new i.b5;for(const U of[0,1,3,2,0])R.emplaceBack(U);this.debugIndexBuffer=r.createIndexBuffer(R),this.emptyTexture=new i.T(r,new i.r({width:1,height:1},Uint8Array.of(0,0,0,0)),r.gl.RGBA8),this.identityMat=i.ab.mat4.create();const N=this.context.gl;this.stencilClearMode=new Dn({func:N.ALWAYS,mask:0},0,255,N.ZERO,N.ZERO,N.ZERO),this.loadTimeStamps.push(performance.now())}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(r){return r._makeTileBoundsBuffers(this.context,this.transform.projection),r._tileBoundsBuffer?{tileBoundsBuffer:r._tileBoundsBuffer,tileBoundsIndexBuffer:r._tileBoundsIndexBuffer,tileBoundsSegments:r._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const r=this.context.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.getOrCreateProgram("clippingMask").draw(this,r.TRIANGLES,Tn.disabled,this.stencilClearMode,Jn.disabled,Rn.disabled,_h(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(r,l,m){if(!l||this.currentStencilSource===l.id||!r.isTileClipped()||!m||m.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let R=!1;for(const N of m)if(this._tileClippingMaskIDs[N.key]===void 0){R=!0;break}if(!R)return}this.currentStencilSource=l.id;const x=this.context,b=x.gl;this.nextStencilID+m.length>256&&this.clearStencil(),x.setColorMode(Jn.disabled),x.setDepthMode(Tn.disabled);const A=this.getOrCreateProgram("clippingMask");this._tileClippingMaskIDs={};for(const R of m){const N=l.getTile(R),U=this._tileClippingMaskIDs[R.key]=this.nextStencilID++,{tileBoundsBuffer:$,tileBoundsIndexBuffer:Z,tileBoundsSegments:W}=this.getTileBoundsBuffers(N);A.draw(this,b.TRIANGLES,Tn.disabled,new Dn({func:b.ALWAYS,mask:0},U,255,b.KEEP,b.KEEP,b.REPLACE),Jn.disabled,Rn.disabled,_h(R.projMatrix),"$clipping",$,Z,W)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const r=this.nextStencilID++,l=this.context.gl;return new Dn({func:l.NOTEQUAL,mask:255},r,255,l.KEEP,l.KEEP,l.REPLACE)}stencilModeForClipping(r){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(r);const l=this.context.gl;return new Dn({func:l.EQUAL,mask:255},this._tileClippingMaskIDs[r.key],0,l.KEEP,l.KEEP,l.REPLACE)}stencilConfigForOverlap(r){const l=this.context.gl,m=r.sort((A,R)=>R.overscaledZ-A.overscaledZ),x=m[m.length-1].overscaledZ,b=m[0].overscaledZ-x+1;if(b>1){this.currentStencilSource=void 0,this.nextStencilID+b>256&&this.clearStencil();const A={};for(let R=0;R<b;R++)A[R+x]=new Dn({func:l.GEQUAL,mask:255},R+this.nextStencilID,255,l.KEEP,l.KEEP,l.REPLACE);return this.nextStencilID+=b,[A,m]}return[{[x]:Dn.disabled},m]}colorModeForRenderPass(){const r=this.context.gl;return this._showOverdrawInspector?new Jn([r.CONSTANT_COLOR,r.ONE,r.CONSTANT_COLOR,r.ONE],new i.aj(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Jn.unblended:Jn.alphaBlended}colorModeForDrapableLayerRenderPass(r){const l=this.context.gl;return this.style&&this.style.enable3dLights()&&this.terrain&&this.terrain.renderingToTexture&&this.renderPass==="translucent"?new Jn([l.ONE,l.ONE_MINUS_SRC_ALPHA,l.CONSTANT_ALPHA,l.ONE_MINUS_SRC_ALPHA],new i.aj(0,0,0,r===void 0?0:r),[!0,!0,!0,!0]):this.colorModeForRenderPass()}depthModeForSublayer(r,l,m,x=!1){if(this.depthOcclusion)return new Tn(this.context.gl.GREATER,Tn.ReadOnly,this.depthRangeFor3D);if(!this.opaquePassEnabledForLayer()&&!x)return Tn.disabled;const b=1-((1+this.currentLayer)*this.numSublayers+r)*this.depthEpsilon;return new Tn(m||this.context.gl.LEQUAL,l,[b,b])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}blitDepth(){const r=this.context.gl,l=Math.ceil(this.width),m=Math.ceil(this.height),x=this.context.bindFramebuffer.get(),b=r.getParameter(r.TEXTURE_BINDING_2D);this.depthFBO&&this.depthFBO.width===l&&this.depthFBO.height===m||(this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),l!==0&&m!==0&&(this.depthFBO=new _m(this.context,l,m,!1,"texture"),this.depthTexture=new i.T(this.context,{width:l,height:m,data:null},r.DEPTH24_STENCIL8),this.depthFBO.depthAttachment.set(this.depthTexture.texture))),this.context.bindFramebuffer.set(x),r.bindTexture(r.TEXTURE_2D,b),this.depthFBO&&(r.bindFramebuffer(r.READ_FRAMEBUFFER,null),r.bindFramebuffer(r.DRAW_FRAMEBUFFER,this.depthFBO.framebuffer),r.blitFramebuffer(0,0,l,m,0,0,l,m,r.DEPTH_BUFFER_BIT,r.NEAREST),r.bindFramebuffer(r.FRAMEBUFFER,this.context.bindFramebuffer.current))}updateAverageFPS(){this._fpsHistory.push(this._dt===0?0:1e3/this._dt),this._fpsHistory.length>this._debugParams.fpsWindow&&this._fpsHistory.splice(0,this._fpsHistory.length-this._debugParams.fpsWindow),this._averageFPS=Math.round(this._fpsHistory.reduce((r,l)=>r+l/this._fpsHistory.length,0))}render(r,l){const m=i.q.now();this._dt=m-this._timeStamp,this._timeStamp=m,this._wireframeDebugCache.update(this.frameCounter),this._debugParams.continousRedraw=r.map.repaint,this.style=r,this.options=l;const x=this.style._mergedLayers,b=!(!this.terrain||!this.terrain.enabled),A=()=>this.style._getOrder(b).filter(nt=>{const pt=x[nt];return!(pt.type in this._debugParams.enabledLayers)||this._debugParams.enabledLayers[pt.type]});let R=A(),N=!1,U=!1;for(const nt of R){const pt=x[nt];pt.type==="circle"&&(N=!0),pt.type==="symbol"&&(pt.hasInitialOcclusionOpacityProperties?U=!0:N=!0)}let $=R.map(nt=>x[nt]);const Z=this.style._mergedSourceCaches;this.imageManager=r.imageManager,this.modelManager=r.modelManager,this.symbolFadeChange=r.placement.symbolFadeChange(i.q.now()),this.imageManager.beginFrame();let W=0,ee=!1;for(const nt in Z){const pt=Z[nt];pt.used&&(pt.prepare(this.context),pt.getSource().usedInConflation&&++W)}let ue=!1;for(const nt of $)nt.isHidden(this.transform.zoom)||(nt.type==="clip"&&(ue=!0),this.prepareLayer(nt));const oe={},de={},fe={},Te={},Pe={};for(const nt in Z){const pt=Z[nt];oe[nt]=pt.getVisibleCoordinates(),de[nt]=oe[nt].slice().reverse(),fe[nt]=pt.getVisibleCoordinates(!0).reverse(),Te[nt]=pt.getShadowCasterCoordinates(),Pe[nt]=pt.sortCoordinatesByDistance(oe[nt])}const Oe=nt=>{const pt=this.style.getLayerSourceCache(nt);return pt&&pt.used?pt.getSource():null};if(W||ue||this._clippingActiveLastFrame){const nt=[],pt=[];let Lt=0;for(const tt of $)this.isSourceForClippingOrConflation(tt,Oe(tt))&&(nt.push(tt),pt.push(Lt)),Lt++;if(nt&&(ue||nt.length>1)||this._clippingActiveLastFrame){ue=!1;const tt=[];for(let St=0;St<nt.length;St++){const mt=nt[St],Gt=pt[St],Pt=this.style.getLayerSourceCache(mt);if(!Pt||!Pt.used||!Pt.getSource().usedInConflation&&mt.type!=="clip")continue;let At=i.dx,kt=i.by.None;const Wt=[];let on=!0;if(mt.type==="clip"){At=Gt;for(const dn of mt.layout.get("clip-layer-types"))kt|=dn==="model"?i.by.Model:dn==="symbol"?i.by.Symbol:i.by.FillExtrusion;for(const dn of mt.layout.get("clip-layer-scope"))Wt.push(dn);mt.isHidden(this.transform.zoom)?on=!1:ue=!0}on&&tt.push({layer:mt.fqid,cache:Pt,order:At,clipMask:kt,clipScope:Wt})}this.replacementSource.setSources(tt),ee=!0}}this._clippingActiveLastFrame=ue,ee||this.replacementSource.clear(),this.conflationActive=ee,this.minCutoffZoom=0,this.longestCutoffRange=0,this.opaquePassCutoff=1/0,this._lastOcclusionLayer=-1,this.layersWithOcclusionOpacity=[];for(let nt=0;nt<$.length;nt++){const pt=$[nt],Lt=pt.cutoffRange();if(this.longestCutoffRange=Math.max(Lt,this.longestCutoffRange),Lt>0){const tt=Oe(pt);tt&&(this.minCutoffZoom=Math.max(tt.minzoom,this.minCutoffZoom)),pt.minzoom&&(this.minCutoffZoom=Math.max(pt.minzoom,this.minCutoffZoom))}pt.is3D()&&(this.opaquePassCutoff===1/0&&(this.opaquePassCutoff=nt),this._lastOcclusionLayer=nt)}const Fe=this.style&&this.style.fog;Fe?(this._fogVisible=Fe.getOpacity(this.transform.pitch)!==0,this._fogVisible&&this.transform.projection.name!=="globe"&&(this._fogVisible=Fe.isVisibleOnFrustum(this.transform.cameraFrustum))):this._fogVisible=!1,this._cachedTileFogOpacities={},this.terrain&&(this.terrain.updateTileBinding(fe),this.opaquePassCutoff=0,R=A(),$=R.map(nt=>x[nt]));const Re=this._shadowRenderer;if(Re){Re.updateShadowParameters(this.transform,this.style.directionalLight);for(const nt in Z)for(const pt of oe[nt]){let Lt={min:0,max:0};this.terrain&&(Lt=this.terrain.getMinMaxForTile(pt)||Lt),Re.addShadowReceiver(pt.toUnwrapped(),Lt.min,Lt.max)}}this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new i.dw(this.context)),this.style.fog&&this.transform.projection.supportsFog?(this._atmosphere||(this._atmosphere=new sp(this)),this._atmosphere.update(this)):this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0);const ke=this._debugParams.forceEnablePrecipitation||!(!this.style||!this.style.snow),De=this._debugParams.forceEnablePrecipitation||!(!this.style||!this.style.rain);if(ke&&!this._snow&&(this._snow=new Bl(this)),!ke&&this._snow&&(this._snow.destroy(),delete this._snow),De&&!this._rain&&(this._rain=new Eu(this)),!De&&this._rain&&(this._rain.destroy(),delete this._rain),this._snow&&this._snow.update(this),this._rain&&this._rain.update(this),!Qn.has(this.context.gl))return;this.renderPass="offscreen";for(const nt of $){const pt=r.getLayerSourceCache(nt);if(!nt.hasOffscreenPass()||nt.isHidden(this.transform.zoom))continue;const Lt=pt?de[pt.id]:void 0;(nt.type==="custom"||nt.type==="raster"||nt.type==="raster-particle"||nt.isSky()||Lt&&Lt.length)&&this.renderLayer(this,pt,nt,Lt)}this.depthRangeFor3D=[0,1-($.length+2)*this.numSublayers*this.depthEpsilon],this._shadowRenderer&&(this.renderPass="shadow",this._shadowRenderer.drawShadowPass(this.style,Te)),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);const $e=this.transform.projection.name==="globe"||this.transform.isHorizonVisible(),Xe=(()=>{if(l.showOverdrawInspector)return i.aj.black;const nt=this.style.fog;if(nt&&this.transform.projection.supportsFog){const pt=this.style.getLut(nt.scope);if(!$e){const Lt=nt.properties.get("color-use-theme")==="none",tt=nt.properties.get("color").toRenderColor(Lt?null:pt).toArray01();return new i.aj(...tt)}if($e){const Lt=nt.properties.get("space-color-use-theme")==="none",tt=nt.properties.get("space-color").toRenderColor(Lt?null:pt).toArray01();return new i.aj(...tt)}}return i.aj.transparent})();if(this.context.clear({color:Xe,depth:1}),this.clearStencil(),this._showOverdrawInspector=l.showOverdrawInspector,this.renderPass="opaque",this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&$e&&this._atmosphere.drawStars(this,this.style.fog),!this.terrain)for(this.currentLayer=R.length-1;this.currentLayer>=0;this.currentLayer--){const nt=$[this.currentLayer],pt=r.getLayerSourceCache(nt);if(nt.isSky())continue;const Lt=pt?(nt.is3D()?Pe:de)[pt.id]:void 0;this._renderTileClippingMasks(nt,pt,Lt),this.renderLayer(this,pt,nt,Lt)}if(this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&$e&&this._atmosphere.drawAtmosphereGlow(this,this.style.fog),this.renderPass="sky",(!this._atmosphere||i.ae(this.transform.zoom)>0)&&(this.transform.projection.name==="globe"||this.transform.isHorizonVisible()))for(this.currentLayer=0;this.currentLayer<R.length;this.currentLayer++){const nt=$[this.currentLayer],pt=r.getLayerSourceCache(nt);nt.isSky()&&this.renderLayer(this,pt,nt,pt?de[pt.id]:void 0)}function ft(nt,pt){let Lt;return pt&&(Lt=(nt.type==="symbol"?fe:nt.is3D()?Pe:de)[pt.id]),Lt}if(this.renderPass="translucent",this.transform.projection.name==="globe"){for(this.renderElevatedRasterBackface=!0,this.currentLayer=0;this.currentLayer<R.length;){const nt=$[this.currentLayer];if(nt.type==="raster"||nt.type==="raster-particle"){const pt=r.getLayerSourceCache(nt);this.renderLayer(this,pt,nt,ft(nt,pt))}++this.currentLayer}this.renderElevatedRasterBackface=!1}this.currentLayer=0,this.firstLightBeamLayer=Number.MAX_SAFE_INTEGER;let ot=0;Re&&(ot=Re.getShadowCastingLayerCount());let Et=!1,vt=-1;for(let nt=0;nt<R.length;++nt){const pt=$[nt];pt.isHidden(this.transform.zoom)||pt.is3D()&&(vt=nt)}for(U&&vt===-1&&(N=!0);this.currentLayer<R.length;){const nt=$[this.currentLayer],pt=r.getLayerSourceCache(nt);if(nt.isSky())++this.currentLayer;else if(this.terrain&&this.style.isLayerDraped(nt)){if(nt.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer),this._lastOcclusionLayer=Math.max(this.currentLayer,this._lastOcclusionLayer)}else{if(N&&!Et&&this.terrain&&!this.transform.isOrthographic&&(Et=!0,this.blitDepth()),U&&vt!==-1&&this.currentLayer===vt+1&&!this.transform.isOrthographic&&this.blitDepth(),nt.is3D()||this.terrain||this._renderTileClippingMasks(nt,pt,pt?oe[pt.id]:void 0),this.renderLayer(this,pt,nt,ft(nt,pt)),!this.terrain&&Re&&ot>0&&nt.hasShadowPass()&&--ot==0&&(Re.drawGroundShadows(),this.firstLightBeamLayer<=this.currentLayer)){const Lt=this.currentLayer;for(this.renderPass="light-beam",this.currentLayer=this.firstLightBeamLayer;this.currentLayer<=Lt;this.currentLayer++){const tt=$[this.currentLayer];if(!tt.hasLightBeamPass())continue;const St=r.getLayerSourceCache(tt);this.renderLayer(this,St,tt,St?de[St.id]:void 0)}this.currentLayer=Lt,this.renderPass="translucent"}if(this.currentLayer>=this._lastOcclusionLayer&&this.layersWithOcclusionOpacity.length>0){const Lt=this.currentLayer;this.depthOcclusion=!0;for(const tt of this.layersWithOcclusionOpacity){this.currentLayer=tt;const St=$[this.currentLayer],mt=r.getLayerSourceCache(St),Gt=mt?de[mt.id]:void 0;St.is3D()||this.terrain||this._renderTileClippingMasks(St,mt,mt?oe[mt.id]:void 0),this.renderLayer(this,mt,St,Gt)}this.depthOcclusion=!1,this.currentLayer=Lt,this.renderPass="translucent",this.layersWithOcclusionOpacity=[]}++this.currentLayer}}if(this.terrain&&this.terrain.postRender(),this._snow&&this._snow.draw(this),this._rain&&this._rain.draw(this),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let nt=null;$.forEach(pt=>{const Lt=r.getLayerSourceCache(pt);Lt&&!pt.isHidden(this.transform.zoom)&&Lt.getVisibleCoordinates().length&&(!nt||nt.getSource().maxzoom<Lt.getSource().maxzoom)&&(nt=Lt)}),nt&&this.options.showTileBoundaries&&Dc.debug(this,nt,nt.getVisibleCoordinates(),i.aj.red,!1,this.options.showParseStatus)}this.terrain&&this._debugParams.showTerrainProxyTiles&&Dc.debug(this,this.terrain.proxySourceCache,this.terrain.proxyCoords,new i.aj(1,.8,.1,1),!0,this.options.showParseStatus),this.options.showPadding&&function(nt){const pt=nt.transform.padding;wm(nt,nt.transform.height-(pt.top||0),3,Oc),wm(nt,pt.bottom||0,3,F0),op(nt,pt.left||0,3,j0),op(nt,nt.transform.width-(pt.right||0),3,bm);const Lt=nt.transform.centerPoint;(function(tt,St,mt,Gt){fs(tt,St-1,mt-10,2,20,Gt),fs(tt,St-10,mt-1,20,2,Gt)})(nt,Lt.x,nt.transform.height-Lt.y,Bf)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(performance.now()),this.saveCanvasCopy()),ee||(this.conflationActive=!1)}prepareLayer(r){this.gpuTimingStart(r);const{unsupportedLayers:l}=this.transform.projection,m=!l||!l.includes(r.type);if(Ih[r.type]&&(m||this.terrain&&r.type==="custom")){const x=this.style.getLayerSourceCache(r);Ih[r.type](r,x,this)}this.gpuTimingEnd()}renderLayer(r,l,m,x){m.isHidden(this.transform.zoom)||(m.type==="background"||m.type==="sky"||m.type==="custom"||m.type==="model"||m.type==="raster"||m.type==="raster-particle"||x&&x.length)&&(this.id=m.id,this.gpuTimingStart(m),r.transform.projection.unsupportedLayers&&r.transform.projection.unsupportedLayers.includes(m.type)&&(!r.terrain||m.type!=="custom")||m.type==="clip"||Dc[m.type](r,l,m,x,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(r){if(!this.options.gpuTiming)return;const l=this.context.extTimerQuery,m=this.context.gl;let x=this.gpuTimers[r.id];x||(x=this.gpuTimers[r.id]={calls:0,cpuTime:0,query:m.createQuery()}),x.calls++,m.beginQuery(l.TIME_ELAPSED_EXT,x.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const r=this.context.extTimerQuery,l=this.context.gl,m=l.createQuery();this.deferredRenderGpuTimeQueries.push(m),l.beginQuery(r.TIME_ELAPSED_EXT,m)}}gpuTimingDeferredRenderEnd(){this.options.gpuTimingDeferredRender&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}gpuTimingEnd(){this.options.gpuTiming&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}collectGpuTimers(){const r=this.gpuTimers;return this.gpuTimers={},r}collectDeferredRenderGpuQueries(){const r=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],r}queryGpuTimers(r){const l={};for(const m in r){const x=r[m],b=this.context.extTimerQuery,A=b.getQueryParameter(x.query,this.context.gl.QUERY_RESULT)/1e6;b.deleteQueryEXT(x.query),l[m]=A}return l}queryGpuTimeDeferredRender(r){if(!this.options.gpuTimingDeferredRender)return 0;const l=this.context.gl;let m=0;for(const x of r)m+=l.getQueryParameter(x,l.QUERY_RESULT)/1e6,l.deleteQuery(x);return m}translatePosMatrix(r,l,m,x,b){if(!m[0]&&!m[1])return r;const A=b?x==="map"?this.transform.angle:0:x==="viewport"?-this.transform.angle:0;if(A){const U=Math.sin(A),$=Math.cos(A);m=[m[0]*$-m[1]*U,m[0]*U+m[1]*$]}const R=[b?m[0]:i.ar(l,m[0],this.transform.zoom),b?m[1]:i.ar(l,m[1],this.transform.zoom),0],N=new Float32Array(16);return i.ab.mat4.translate(N,r,R),N}saveTileTexture(r){const l=r.size[0],m=this._tileTextures[l];m?m.push(r):this._tileTextures[l]=[r]}getTileTexture(r){const l=this._tileTextures[r];return l&&l.length>0?l.pop():null}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture||this.forceTerrainMode}linearFloatFilteringSupported(){return this.context.extTextureFloatLinear!=null}currentGlobalDefines(r,l,m){const x=m===void 0?this.terrain&&this.terrain.renderingToTexture:m,b=[];return this.style&&this.style.enable3dLights()&&(r==="globeRaster"||r==="terrainRaster"?(b.push("LIGHTING_3D_MODE"),b.push("LIGHTING_3D_ALPHA_EMISSIVENESS")):x||b.push("LIGHTING_3D_MODE")),this.renderPass==="shadow"&&(this._shadowMapDebug||b.push("DEPTH_TEXTURE")),this.terrainRenderModeElevated()&&(b.push("TERRAIN"),this.linearFloatFilteringSupported()&&b.push("TERRAIN_DEM_FLOAT_FORMAT")),this.transform.projection.name==="globe"&&b.push("GLOBE"),!this._fogVisible||x||l!==void 0&&!l||b.push("FOG","FOG_DITHERING"),x&&b.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&b.push("OVERDRAW_INSPECTOR"),b}getOrCreateProgram(r,l){this.cache=this.cache||{};const m=l&&l.defines||[],x=l&&l.config,b=this.currentGlobalDefines(r,l&&l.overrideFog,l&&l.overrideRtt).concat(m),A=k0.cacheKey(Bo[r],r,b,x);return this.cache[A]||(this.cache[A]=new k0(this.context,r,Bo[r],x,Lf[r],b)),this.cache[A]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const r=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(r.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new i.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA8))}destroy(){this._terrain&&this._terrain.destroy(),this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this._wireframeDebugCache.destroy(),this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),this.emptyDepthTexture&&this.emptyDepthTexture.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}uploadCommonLightUniforms(r,l){if(this.style.enable3dLights()){const m=this.style.directionalLight,x=this.style.ambientLight;if(m&&x){const b=((A,R,N)=>{const U=A.properties.get("direction"),$=A.properties.get("color-use-theme")==="none",Z=A.properties.get("color").toRenderColor($?null:N.getLut(A.scope)).toArray01(),W=A.properties.get("intensity"),ee=R.properties.get("color-use-theme")==="none",ue=R.properties.get("color").toRenderColor(ee?null:N.getLut(R.scope)).toArray01(),oe=R.properties.get("intensity"),de=[U.x,U.y,U.z],fe=i.cM(ue,oe),Te=i.cM(Z,W);return{u_lighting_ambient_color:fe,u_lighting_directional_dir:de,u_lighting_directional_color:Te,u_ground_radiance:Il(de,Te,fe)}})(m,x,this.style);l.setLightsUniformValues(r,b)}}}uploadCommonUniforms(r,l,m,x,b){if(this.uploadCommonLightUniforms(r,l),this.terrain&&this.terrain.renderingToTexture)return;const A=this.style.fog;if(A){const R=A.getOpacity(this.transform.pitch),N=((U,$,Z,W,ee,ue,oe,de,fe,Te,Pe,Oe)=>{const Fe=U.transform,Re=$.properties.get("color-use-theme")==="none",ke=$.properties.get("color").toRenderColor(Re?null:U.style.getLut($.scope)).toArray01();ke[3]=W;const De=U.frameCounter/1e3%1,[$e,Xe]=$.properties.get("vertical-range");return{u_fog_matrix:Z?Fe.calculateFogTileMatrix(Z):Oe||U.identityMat,u_fog_range:$.getFovAdjustedRange(Fe._fov),u_fog_color:ke,u_fog_horizon_blend:$.properties.get("horizon-blend"),u_fog_vertical_limit:[Math.min($e,Xe),Xe],u_fog_temporal_offset:De,u_frustum_tl:ee,u_frustum_tr:ue,u_frustum_br:oe,u_frustum_bl:de,u_globe_pos:fe,u_globe_radius:Te,u_viewport:Pe,u_globe_transition:i.ae(Fe.zoom),u_is_globe:+(Fe.projection.name==="globe")}})(this,A,m,R,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*i.q.devicePixelRatio,this.transform.height*i.q.devicePixelRatio],x);l.setFogUniformValues(r,N)}b&&l.setCutoffUniformValues(r,b.uniformValues)}setTileLoadedFlag(r){this.tileLoaded=r}saveCanvasCopy(){const r=this.canvasCopy();r&&(this.frameCopies.push(r),this.tileLoaded=!1)}canvasCopy(){const r=this.context.gl,l=r.createTexture();return r.bindTexture(r.TEXTURE_2D,l),r.copyTexImage2D(r.TEXTURE_2D,0,r.RGBA,0,0,r.drawingBufferWidth,r.drawingBufferHeight,0),l}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const r=this.style&&this.style.fog;return!!r&&r.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const r=this._backgroundTiles,l=this._backgroundTiles={},m=this.transform.coveringTiles({tileSize:512});for(const x of m)l[x.key]=r[x.key]||new xl(x,512,this.transform.tileZoom,this);return l}clearBackgroundTiles(){this._backgroundTiles={}}isSourceForClippingOrConflation(r,l){return!(!r.is3D()||r.type!=="clip"&&(r.minzoom&&r.minzoom>this.transform.zoom||(this.style._clipLayerPresent||r.sourceLayer!=="building")&&(!l||l.type!=="batched-model")))}isTileAffectedByFog(r){if(!this.style||!this.style.fog)return!1;if(this.transform.projection.name==="globe")return!0;let l=this._cachedTileFogOpacities[r.key];return l||(this._cachedTileFogOpacities[r.key]=l=this.style.fog.getOpacityForTile(r)),l[0]>=je||l[1]>=je}setupDepthForOcclusion(r,l,m){const x=this.context,b=x.gl,A=!!m;var R;m||(m={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0}),x.activeTexture.set(b.TEXTURE3),r&&this.depthFBO&&this.depthTexture?(this.depthTexture.bind(b.NEAREST,b.CLAMP_TO_EDGE),m.u_depth_size_inv=[1/this.depthFBO.width,1/this.depthFBO.height],m.u_depth_range_unpack=[2/((R=this.depthRangeFor3D)[1]-R[0]),-1-2*R[0]/(R[1]-R[0])],m.u_occluder_half_size=.5*this.occlusionParams.occluderSize,m.u_occlusion_depth_offset=this.occlusionParams.depthOffset):this.emptyDepthTexture.bind(b.NEAREST,b.CLAMP_TO_EDGE),x.activeTexture.set(b.TEXTURE0),A||l.setTerrainUniformValues(x,m)}}function $f(p,r){let l=!1,m=null;const x=()=>{m=null,l&&(p(),m=setTimeout(x,r),l=!1)};return()=>(l=!0,m||x(),m)}class qf{constructor(r){this._hashName=r&&encodeURIComponent(r),i.aP(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=$f(this._updateHashUnthrottled.bind(this),300)}addTo(r){return this._map=r,window.addEventListener("hashchange",this._onHashChange,!1),r.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const r=this._map;if(!r)return"";const l=dp(r);if(this._hashName){const m=this._hashName;let x=!1;const b=location.hash.slice(1).split("&").map(A=>{const R=A.split("=")[0];return R===m?(x=!0,`${R}=${l}`):A}).filter(A=>A);return x||b.push(`${m}=${l}`),`#${b.join("&")}`}return`#${l}`}_getCurrentHash(){const r=location.hash.replace("#","");if(this._hashName){let l;return r.split("&").map(m=>m.split("=")).forEach(m=>{m[0]===this._hashName&&(l=m)}),(l&&l[1]||"").split("/")}return r.split("/")}_onHashChange(){const r=this._map;if(!r)return!1;const l=this._getCurrentHash();if(l.length>=3&&!l.some(m=>isNaN(m))){const m=r.dragRotate.isEnabled()&&r.touchZoomRotate.isEnabled()?+(l[3]||0):r.getBearing();return r.jumpTo({center:[+l[2],+l[1]],zoom:+l[0],bearing:m,pitch:+(l[4]||0)}),!0}return!1}_updateHashUnthrottled(){history.replaceState(history.state,"",location.href.replace(/(#.+)?$/,this.getHashString()))}}function dp(p,r){const l=p.getCenter(),m=Math.round(100*p.getZoom())/100,x=Math.ceil((m*Math.LN2+Math.log(512/360/.5))/Math.LN10),b=Math.pow(10,x),A=Math.round(l.lng*b)/b,R=Math.round(l.lat*b)/b,N=p.getBearing(),U=p.getPitch();let $=r?`/${A}/${R}/${m}`:`${m}/${R}/${A}`;return(N||U)&&($+="/"+Math.round(10*N)/10),U&&($+=`/${Math.round(U)}`),$}const Au={linearity:.3,easing:i.dy(0,0,.3,1)},Em=i.l({deceleration:2500,maxSpeed:1400},Au),Am=i.l({deceleration:20,maxSpeed:1400},Au),V0=i.l({deceleration:1e3,maxSpeed:360},Au),Cm=i.l({deceleration:1e3,maxSpeed:90},Au);class wa{constructor(r){this._map=r,this.clear()}clear(){this._inertiaBuffer=[]}record(r){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:i.q.now(),settings:r})}_drainInertiaBuffer(){const r=this._inertiaBuffer,l=i.q.now();for(;r.length>0&&l-r[0].time>160;)r.shift()}_onMoveEnd(r){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const l={zoom:0,bearing:0,pitch:0,pan:new i.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:b}of this._inertiaBuffer)l.zoom+=b.zoomDelta||0,l.bearing+=b.bearingDelta||0,l.pitch+=b.pitchDelta||0,b.panDelta&&l.pan._add(b.panDelta),b.around&&(l.around=b.around),b.pinchAround&&(l.pinchAround=b.pinchAround);const m=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,x={};if(l.pan.mag()){const b=Ph(l.pan.mag(),m,i.l({},Em,r||{}));x.offset=l.pan.mult(b.amount/l.pan.mag()),x.center=this._map.transform.center,Xi(x,b)}if(l.zoom){const b=Ph(l.zoom,m,Am);x.zoom=this._map.transform.zoom+b.amount,Xi(x,b)}if(l.bearing){const b=Ph(l.bearing,m,V0);x.bearing=this._map.transform.bearing+i.aw(b.amount,-179,179),Xi(x,b)}if(l.pitch){const b=Ph(l.pitch,m,Cm);x.pitch=this._map.transform.pitch+b.amount,Xi(x,b)}if(x.zoom||x.bearing){const b=l.pinchAround===void 0?l.around:l.pinchAround;x.around=b?this._map.unproject(b):this._map.getCenter()}return this.clear(),x.noMoveStart=!0,x}}function Xi(p,r){(!p.duration||p.duration<r.duration)&&(p.duration=r.duration,p.easing=r.easing)}function Ph(p,r,l){const{maxSpeed:m,linearity:x,deceleration:b}=l,A=i.aw(p*x/(r/1e3),-m,m),R=Math.abs(A)/(b*x);return{easing:l.easing,duration:1e3*R,amount:A*(R/2)}}class ho extends i.z{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,l,m,x={}){const b=He(l.getCanvasContainer(),m),A=l.unproject(b);super(r,i.l({point:b,lngLat:A,originalEvent:m},x)),this._defaultPrevented=!1,this.target=l}}class Rh extends i.z{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,l,m){const x=r==="touchend"?m.changedTouches:m.touches,b=Ge(l.getCanvasContainer(),x),A=b.map(N=>l.unproject(N)),R=b.reduce((N,U,$,Z)=>N.add(U.div(Z.length)),new i.P(0,0));super(r,{points:b,point:R,lngLats:A,lngLat:l.unproject(R),originalEvent:m}),this._defaultPrevented=!1}}class Mm extends i.z{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,l){super("wheel",{originalEvent:l}),this._defaultPrevented=!1}}class $0{constructor(r,l){this._map=r,this._clickTolerance=l.clickTolerance}reset(){this._mousedownPos=void 0}wheel(r){return this._firePreventable(new Mm(this._map,r))}mousedown(r,l){return this._mousedownPos=l,this._firePreventable(new ho(r.type,this._map,r))}mouseup(r){this._map.fire(new ho(r.type,this._map,r))}preclick(r){const l=i.l({},r);l.type="preclick",this._map.fire(new ho(l.type,this._map,l))}click(r,l){this._mousedownPos&&this._mousedownPos.dist(l)>=this._clickTolerance||(this.preclick(r),this._map.fire(new ho(r.type,this._map,r)))}dblclick(r){return this._firePreventable(new ho(r.type,this._map,r))}mouseover(r){this._map.fire(new ho(r.type,this._map,r))}mouseout(r){this._map.fire(new ho(r.type,this._map,r))}touchstart(r){return this._firePreventable(new Rh(r.type,this._map,r))}touchmove(r){this._map.fire(new Rh(r.type,this._map,r))}touchend(r){this._map.fire(new Rh(r.type,this._map,r))}touchcancel(r){this._map.fire(new Rh(r.type,this._map,r))}_firePreventable(r){if(this._map.fire(r),r.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Gf{constructor(r){this._map=r}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(r){this._map.fire(new ho(r.type,this._map,r))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new ho("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(r){this._delayContextMenu?this._contextMenuEvent=r:this._map.fire(new ho(r.type,this._map,r)),this._map.listens("contextmenu")&&r.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class ci{constructor(r,l){this._map=r,this._el=r.getCanvasContainer(),this._container=r.getContainer(),this._clickTolerance=l.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(r,l){this.isEnabled()&&r.shiftKey&&r.button===0&&(xe(),this._startPos=this._lastPos=l,this._active=!0)}mousemoveWindow(r,l){if(!this._active)return;const m=l,x=this._startPos,b=this._lastPos;if(!x||!b||b.equals(m)||!this._box&&m.dist(x)<this._clickTolerance)return;this._lastPos=m,this._box||(this._box=K("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",r));const A=Math.min(x.x,m.x),R=Math.max(x.x,m.x),N=Math.min(x.y,m.y),U=Math.max(x.y,m.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${A}px,${N}px)`,this._box.style.width=R-A+"px",this._box.style.height=U-N+"px")})}mouseupWindow(r,l){if(!this._active)return;const m=this._startPos,x=l;if(m&&r.button===0){if(this.reset(),Se(),m.x!==x.x||m.y!==x.y)return this._map.fire(new i.z("boxzoomend",{originalEvent:r})),{cameraAnimation:b=>b.fitScreenCoordinates(m,x,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",r)}}keydown(r){this._active&&r.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",r))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),ae(),delete this._startPos,delete this._lastPos}_fireEvent(r,l){return this._map.fire(new i.z(r,{originalEvent:l}))}}function Hf(p,r){const l={};for(let m=0;m<p.length;m++)l[p[m].identifier]=r[m];return l}class q0{constructor(r){this.reset(),this.numTouches=r.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(r,l,m){(this.centroid||m.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=r.timeStamp),m.length===this.numTouches&&(this.centroid=function(x){const b=new i.P(0,0);for(const A of x)b._add(A);return b.div(x.length)}(l),this.touches=Hf(m,l)))}touchmove(r,l,m){if(this.aborted||!this.centroid)return;const x=Hf(m,l);for(const b in this.touches){const A=x[b];(!A||A.dist(this.touches[b])>30)&&(this.aborted=!0)}}touchend(r,l,m){if((!this.centroid||r.timeStamp-this.startTime>500)&&(this.aborted=!0),m.length===0){const x=!this.aborted&&this.centroid;if(this.reset(),x)return x}}}class pp{constructor(r){this.singleTap=new q0(r),this.numTaps=r.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(r,l,m){this.singleTap.touchstart(r,l,m)}touchmove(r,l,m){this.singleTap.touchmove(r,l,m)}touchend(r,l,m){const x=this.singleTap.touchend(r,l,m);if(x){const b=r.timeStamp-this.lastTime<500,A=!this.lastTap||this.lastTap.dist(x)<30;if(b&&A||this.reset(),this.count++,this.lastTime=r.timeStamp,this.lastTap=x,this.count===this.numTaps)return this.reset(),x}}}class Cu{constructor(){this._zoomIn=new pp({numTouches:1,numTaps:2}),this._zoomOut=new pp({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(r,l,m){this._zoomIn.touchstart(r,l,m),this._zoomOut.touchstart(r,l,m)}touchmove(r,l,m){this._zoomIn.touchmove(r,l,m),this._zoomOut.touchmove(r,l,m)}touchend(r,l,m){const x=this._zoomIn.touchend(r,l,m),b=this._zoomOut.touchend(r,l,m);return x?(this._active=!0,r.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:A=>A.easeTo({duration:300,zoom:A.getZoom()+1,around:A.unproject(x)},{originalEvent:r})}):b?(this._active=!0,r.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:A=>A.easeTo({duration:300,zoom:A.getZoom()-1,around:A.unproject(b)},{originalEvent:r})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const mp={0:1,2:2};class Mu{constructor(r){this.reset(),this._clickTolerance=r.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(r,l){return!1}_move(r,l){return{}}mousedown(r,l){if(this._lastPoint)return;const m=ye(r);this._correctButton(r,m)&&(this._lastPoint=l,this._eventButton=m)}mousemoveWindow(r,l){const m=this._lastPoint;if(m){if(r.preventDefault(),this._eventButton!=null&&function(x,b){const A=mp[b];return x.buttons===void 0||(x.buttons&A)!==A}(r,this._eventButton))this.reset();else if(this._moved||!(l.dist(m)<this._clickTolerance))return this._moved=!0,this._lastPoint=l,this._move(m,l)}}mouseupWindow(r){this._lastPoint&&ye(r)===this._eventButton&&(this._moved&&Se(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Zf extends Mu{mousedown(r,l){super.mousedown(r,l),this._lastPoint&&(this._active=!0)}_correctButton(r,l){return l===0&&!r.ctrlKey}_move(r,l){return{around:l,panDelta:l.sub(r)}}}class _s extends Mu{_correctButton(r,l){return l===0&&r.ctrlKey||l===2}_move(r,l){const m=.8*(l.x-r.x);if(m)return this._active=!0,{bearingDelta:m}}contextmenu(r){r.preventDefault()}}class Ou extends Mu{_correctButton(r,l){return l===0&&r.ctrlKey||l===2}_move(r,l){const m=-.5*(l.y-r.y);if(m)return this._active=!0,{pitchDelta:m}}contextmenu(r){r.preventDefault()}}class pi{constructor(r,l){this._map=r,this._el=r.getCanvasContainer(),this._minTouches=1,this._clickTolerance=l.clickTolerance||1,this.reset(),i.aP(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new i.P(0,0)}touchstart(r,l,m){return this._calculateTransform(r,l,m)}touchmove(r,l,m){if(this._active&&!(m.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(m.length===1&&!i.dz())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return r.cancelable&&r.preventDefault(),this._calculateTransform(r,l,m)}}touchend(r,l,m){this._calculateTransform(r,l,m),this._active&&m.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(r,l,m){m.length>0&&(this._active=!0);const x=Hf(m,l),b=new i.P(0,0),A=new i.P(0,0);let R=0;for(const U in x){const $=x[U],Z=this._touches[U];Z&&(b._add($),A._add($.sub(Z)),R++,x[U]=$)}if(this._touches=x,R<this._minTouches||!A.mag())return;const N=A.div(R);return this._sum._add(N),this._sum.mag()<this._clickTolerance?void 0:{around:b.div(R),panDelta:N}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=K("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.removeAttribute("role")},500)}}class Uo{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(r){}_move(r,l,m){return{}}touchstart(r,l,m){this._firstTwoTouches||m.length<2||(this._firstTwoTouches=[m[0].identifier,m[1].identifier],this._start([l[0],l[1]]))}touchmove(r,l,m){const x=this._firstTwoTouches;if(!x)return;r.preventDefault();const[b,A]=x,R=Lc(m,l,b),N=Lc(m,l,A);if(!R||!N)return;const U=this._aroundCenter?null:R.add(N).div(2);return this._move([R,N],U,r)}touchend(r,l,m){if(!this._firstTwoTouches)return;const[x,b]=this._firstTwoTouches,A=Lc(m,l,x),R=Lc(m,l,b);A&&R||(this._active&&Se(),this.reset())}touchcancel(){this.reset()}enable(r){this._enabled=!0,this._aroundCenter=!!r&&r.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Lc(p,r,l){for(let m=0;m<p.length;m++)if(p[m].identifier===l)return r[m]}function Dh(p,r){return Math.log(p/r)/Math.LN2}class rl extends Uo{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(r){this._startDistance=this._distance=r[0].dist(r[1])}_move(r,l){const m=this._distance;if(this._distance=r[0].dist(r[1]),this._active||!(Math.abs(Dh(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Dh(this._distance,m),pinchAround:l}}}function _p(p,r){return 180*p.angleWith(r)/Math.PI}class Wf extends Uo{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(r){this._startVector=this._vector=r[0].sub(r[1]),this._minDiameter=r[0].dist(r[1])}_move(r,l){const m=this._vector;if(this._vector=r[0].sub(r[1]),m&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:_p(this._vector,m),pinchAround:l}}_isBelowThreshold(r){this._minDiameter=Math.min(this._minDiameter,r.mag());const l=25/(Math.PI*this._minDiameter)*360,m=this._startVector;if(!m)return!1;const x=_p(r,m);return Math.abs(x)<l}}function gp(p){return Math.abs(p.y)>Math.abs(p.x)}class Om extends Uo{constructor(r){super(),this._map=r}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(r){this._lastPoints=r,gp(r[0].sub(r[1]))&&(this._valid=!1)}_move(r,l,m){const x=this._lastPoints;if(!x)return;const b=r[0].sub(x[0]),A=r[1].sub(x[1]);return this._map._cooperativeGestures&&!i.dz()&&m.touches.length<3||(this._valid=this.gestureBeginsVertically(b,A,m.timeStamp),!this._valid)?void 0:(this._lastPoints=r,this._active=!0,{pitchDelta:(b.y+A.y)/2*-.5})}gestureBeginsVertically(r,l,m){if(this._valid!==void 0)return this._valid;const x=r.mag()>=2,b=l.mag()>=2;if(!x&&!b)return;if(!x||!b)return this._firstMove==null&&(this._firstMove=m),m-this._firstMove<100&&void 0;const A=r.y>0==l.y>0;return gp(r)&&gp(l)&&A}}const Nl={panStep:100,bearingStep:15,pitchStep:10};class ks{constructor(){const r=Nl;this._panStep=r.panStep,this._bearingStep=r.bearingStep,this._pitchStep=r.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(r){if(r.altKey||r.ctrlKey||r.metaKey)return;let l=0,m=0,x=0,b=0,A=0;switch(r.keyCode){case 61:case 107:case 171:case 187:l=1;break;case 189:case 109:case 173:l=-1;break;case 37:r.shiftKey?m=-1:(r.preventDefault(),b=-1);break;case 39:r.shiftKey?m=1:(r.preventDefault(),b=1);break;case 38:r.shiftKey?x=1:(r.preventDefault(),A=-1);break;case 40:r.shiftKey?x=-1:(r.preventDefault(),A=1);break;default:return}return this._rotationDisabled&&(m=0,x=0),{cameraAnimation:R=>{const N=R.getZoom();R.easeTo({duration:300,easeId:"keyboardHandler",easing:Ao,zoom:l?Math.round(N)+l*(r.shiftKey?2:1):N,bearing:R.getBearing()+m*this._bearingStep,pitch:R.getPitch()+x*this._pitchStep,offset:[-b*this._panStep,-A*this._panStep],center:R.getCenter()},{originalEvent:r})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Ao(p){return p*(2-p)}const fo=4.000244140625,Bs=1/450;class Vo{constructor(r,l){this._map=r,this._el=r.getCanvasContainer(),this._handler=l,this._delta=0,this._lastDelta=0,this._defaultZoomRate=.01,this._wheelZoomRate=Bs,i.aP(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(r){this._defaultZoomRate=r}setWheelZoomRate(r){this._wheelZoomRate=r}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(r){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!r&&r.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(r){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(r.ctrlKey||r.metaKey||this.isZooming()||i.dz()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let l=r.deltaMode===WheelEvent.DOM_DELTA_LINE?40*r.deltaY:r.deltaY;const m=i.q.now(),x=m-(this._lastWheelEventTime||0);this._lastWheelEventTime=m,l!==0&&l%fo==0?this._type="wheel":l!==0&&Math.abs(l)<4?this._type="trackpad":x>400?(this._type=null,this._lastValue=l,this._timeout=window.setTimeout(this._onTimeout,40,r)):this._type||(this._type=Math.abs(x*l)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,l+=this._lastValue)),r.shiftKey&&l&&(l/=4),this._type&&(this._lastWheelEvent=r,this._delta-=l,this._active||this._start(r)),r.preventDefault()}_onTimeout(r){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(r)}_start(r){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const l=He(this._el,r);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:l,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const r=this._map.transform;this._type==="wheel"&&r.projection.wrap&&(r._center.lng>=180||r._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const l=()=>r._terrainEnabled()&&this._aroundCoord?r.computeZoomRelativeTo(this._aroundCoord):r.zoom;if(this._delta!==0){const U=this._type==="wheel"&&Math.abs(this._delta)>fo?this._wheelZoomRate:this._defaultZoomRate;let $=2/(1+Math.exp(-Math.abs(this._delta*U)));this._delta<0&&$!==0&&($=1/$);const Z=l(),W=Math.pow(2,Z),ee=typeof this._targetZoom=="number"?r.zoomScale(this._targetZoom):W;this._targetZoom=Math.min(r.maxZoom,Math.max(r.minZoom,r.scaleZoom(ee*$))),this._type==="wheel"&&(this._startZoom=Z,this._easing=this._smoothOutEasing(200)),this._lastDelta=this._delta,this._delta=0}const m=typeof this._targetZoom=="number"?this._targetZoom:l(),x=this._startZoom,b=this._easing;let A,R=!1;if(this._type==="wheel"&&x&&b){const U=Math.min((i.q.now()-this._lastWheelEventTime)/200,1),$=b(U);A=i.af(x,m,$),U<1?this._frameId||(this._frameId=!0):R=!0}else A=m,R=!0;this._active=!0,R&&(this._active=!1,this._finishTimeout=window.setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200));let N=A-l();return N*this._lastDelta<0&&(N=0),{noInertia:!0,needsRenderFrame:!R,zoomDelta:N,around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(r){let l=i.dA;if(this._prevEase){const m=this._prevEase,x=(i.q.now()-m.start)/m.duration,b=m.easing(x+.01)-m.easing(x),A=.27/Math.sqrt(b*b+1e-4)*.01,R=Math.sqrt(.0729-A*A);l=i.dy(A,R,.25,1)}return this._prevEase={start:i.q.now(),duration:r,easing:l},l}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=K("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.removeAttribute("role")},200)}}class gs{constructor(r,l){this._clickZoom=r,this._tapZoom=l}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class il{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(r,l){return r.preventDefault(),{cameraAnimation:m=>{m.easeTo({duration:300,zoom:m.getZoom()+(r.shiftKey?-1:1),around:m.unproject(l)},{originalEvent:r})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Co{constructor(){this._tap=new pp({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(r,l,m){this._swipePoint||(this._tapTime&&r.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?m.length>0&&(this._swipePoint=l[0],this._swipeTouch=m[0].identifier):this._tap.touchstart(r,l,m))}touchmove(r,l,m){if(this._tapTime){if(this._swipePoint){if(m[0].identifier!==this._swipeTouch)return;const x=l[0],b=x.y-this._swipePoint.y;return this._swipePoint=x,r.preventDefault(),this._active=!0,{zoomDelta:b/128}}}else this._tap.touchmove(r,l,m)}touchend(r,l,m){this._tapTime?this._swipePoint&&m.length===0&&this.reset():this._tap.touchend(r,l,m)&&(this._tapTime=r.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ka{constructor(r,l,m){this._el=r,this._mousePan=l,this._touchPan=m}enable(r){this._inertiaOptions=r||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class yp{constructor(r,l,m){this._pitchWithRotate=r.pitchWithRotate,this._mouseRotate=l,this._mousePitch=m}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class G0{constructor(r,l,m,x){this._el=r,this._touchZoom=l,this._touchRotate=m,this._tapDragZoom=x,this._rotationDisabled=!1,this._enabled=!0}enable(r){this._touchZoom.enable(r),this._rotationDisabled||this._touchRotate.enable(r),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Ns=p=>p.zoom||p.drag||p.pitch||p.rotate;class vp extends i.z{}class La{constructor(){this.constants=[1,1,.01],this.radius=0}setup(r,l){const m=i.ab.vec3.sub([],l,r);this.radius=i.ab.vec3.length(m[2]<0?i.ab.vec3.div([],m,this.constants):[m[0],m[1],0])}projectRay(r){i.ab.vec3.div(r,r,this.constants),i.ab.vec3.normalize(r,r),i.ab.vec3.mul(r,r,this.constants);const l=i.ab.vec3.scale([],r,this.radius);if(l[2]>0){const m=i.ab.vec3.scale([],[0,0,1],i.ab.vec3.dot(l,[0,0,1])),x=i.ab.vec3.scale([],i.ab.vec3.normalize([],[l[0],l[1],0]),this.radius),b=i.ab.vec3.add([],l,i.ab.vec3.scale([],i.ab.vec3.sub([],i.ab.vec3.add([],x,m),l),2));l[0]=b[0],l[1]=b[1]}return l}}function $o(p){return p.panDelta&&p.panDelta.mag()||p.zoomDelta||p.bearingDelta||p.pitchDelta}class Fl{constructor(r,l){this._map=r,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new wa(r),this._bearingSnap=l.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new La,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(l),i.aP(["handleEvent","handleWindowEvent"],this);const m=this._el;this._listeners=[[m,"touchstart",{passive:!0}],[m,"touchmove",{passive:!1}],[m,"touchend",void 0],[m,"touchcancel",void 0],[m,"mousedown",void 0],[m,"mousemove",void 0],[m,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[m,"mouseover",void 0],[m,"mouseout",void 0],[m,"dblclick",void 0],[m,"click",void 0],[m,"keydown",{capture:!1}],[m,"keyup",void 0],[m,"wheel",{passive:!1}],[m,"contextmenu",void 0],[window,"blur",void 0]];for(const[x,b,A]of this._listeners){const R=x===document?this.handleWindowEvent:this.handleEvent;x.addEventListener(b,R,A)}}destroy(){for(const[r,l,m]of this._listeners){const x=r===document?this.handleWindowEvent:this.handleEvent;r.removeEventListener(l,x,m)}}_addDefaultHandlers(r){const l=this._map,m=l.getCanvasContainer();this._add("mapEvent",new $0(l,r));const x=l.boxZoom=new ci(l,r);this._add("boxZoom",x);const b=new Cu,A=new il;l.doubleClickZoom=new gs(A,b),this._add("tapZoom",b),this._add("clickZoom",A);const R=new Co;this._add("tapDragZoom",R);const N=l.touchPitch=new Om(l);this._add("touchPitch",N);const U=new _s(r),$=new Ou(r);l.dragRotate=new yp(r,U,$),this._add("mouseRotate",U,["mousePitch"]),this._add("mousePitch",$,["mouseRotate"]);const Z=new Zf(r),W=new pi(l,r);l.dragPan=new Ka(m,Z,W),this._add("mousePan",Z),this._add("touchPan",W,["touchZoom","touchRotate"]);const ee=new Wf,ue=new rl;l.touchZoomRotate=new G0(m,ue,ee,R),this._add("touchRotate",ee,["touchPan","touchZoom"]),this._add("touchZoom",ue,["touchPan","touchRotate"]),this._add("blockableMapEvent",new Gf(l));const oe=l.scrollZoom=new Vo(l,this);this._add("scrollZoom",oe,["mousePan"]);const de=l.keyboard=new ks;this._add("keyboard",de);for(const fe of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])r.interactive&&r[fe]&&l[fe].enable(r[fe])}_add(r,l,m){this._handlers.push({handlerName:r,handler:l,allowed:m}),this._handlersById[r]=l}stop(r){if(!this._updatingCamera){for(const{handler:l}of this._handlers)l.reset();this._inertia.clear(),this._fireEvents({},{},r),this._changes=[],this._originalZoom=void 0}}isActive(){for(const{handler:r}of this._handlers)if(r.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Ns(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(r,l,m){for(const x in r)if(x!==m&&(!l||l.indexOf(x)<0))return!0;return!1}handleWindowEvent(r){this.handleEvent(r,`${r.type}Window`)}_getMapTouches(r){const l=[];for(const m of r)this._el.contains(m.target)&&l.push(m);return l}handleEvent(r,l){this._updatingCamera=!0;const m=r.type==="renderFrame",x=m?void 0:r,b={needsRenderFrame:!1},A={},R={},N=r.touches?this._getMapTouches(r.touches):void 0,U=N?Ge(this._el,N):m?void 0:He(this._el,r);for(const{handlerName:W,handler:ee,allowed:ue}of this._handlers){if(!ee.isEnabled())continue;let oe;this._blockedByActive(R,ue,W)?ee.reset():ee[l||r.type]&&(oe=ee[l||r.type](r,U,N),this.mergeHandlerResult(b,A,oe,W,x),oe&&oe.needsRenderFrame&&this._triggerRenderFrame()),(oe||ee.isActive())&&(R[W]=ee)}const $={};for(const W in this._previousActiveHandlers)R[W]||($[W]=x);this._previousActiveHandlers=R,(Object.keys($).length||$o(b))&&(this._changes.push([b,A,$]),this._triggerRenderFrame()),(Object.keys(R).length||$o(b))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:Z}=b;Z&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],Z(this._map))}mergeHandlerResult(r,l,m,x,b){if(!m)return;i.l(r,m);const A={handlerName:x,originalEvent:m.originalEvent||b};m.zoomDelta!==void 0&&(l.zoom=A),m.panDelta!==void 0&&(l.drag=A),m.pitchDelta!==void 0&&(l.pitch=A),m.bearingDelta!==void 0&&(l.rotate=A)}_applyChanges(){const r={},l={},m={};for(const[x,b,A]of this._changes)x.panDelta&&(r.panDelta=(r.panDelta||new i.P(0,0))._add(x.panDelta)),x.zoomDelta&&(r.zoomDelta=(r.zoomDelta||0)+x.zoomDelta),x.bearingDelta&&(r.bearingDelta=(r.bearingDelta||0)+x.bearingDelta),x.pitchDelta&&(r.pitchDelta=(r.pitchDelta||0)+x.pitchDelta),x.around!==void 0&&(r.around=x.around),x.aroundCoord!==void 0&&(r.aroundCoord=x.aroundCoord),x.pinchAround!==void 0&&(r.pinchAround=x.pinchAround),x.noInertia&&(r.noInertia=x.noInertia),i.l(l,b),i.l(m,A);this._updateMapTransform(r,l,m),this._changes=[]}_updateMapTransform(r,l,m){const x=this._map,b=x.transform,A=Te=>[Te.x,Te.y,Te.z];if((Te=>{const Pe=this._eventsInProgress.drag;return Pe&&!this._handlersById[Pe.handlerName].isActive()})()&&!$o(r)){const Te=b.zoom;b.cameraElevationReference="sea",this._originalZoom!=null&&b._orthographicProjectionAtLowPitch&&b.projection.name!=="globe"&&b.pitch===0?(b.cameraElevationReference="ground",b.zoom=this._originalZoom):(b.recenterOnTerrain(),b.cameraElevationReference="ground"),Te!==b.zoom&&this._map._update(!0)}if(b._isCameraConstrained&&x._stop(!0),!$o(r))return void this._fireEvents(l,m,!0);let{panDelta:R,zoomDelta:N,bearingDelta:U,pitchDelta:$,around:Z,aroundCoord:W,pinchAround:ee}=r;b._isCameraConstrained&&(N>0&&(N=0),b._isCameraConstrained=!1),ee!==void 0&&(Z=ee),(N||(Te=>l[Te]&&!this._eventsInProgress[Te])("drag"))&&Z&&(this._dragOrigin=A(b.pointCoordinate3D(Z)),this._originalZoom=b.zoom,this._trackingEllipsoid.setup(b._camera.position,this._dragOrigin)),b.cameraElevationReference="sea",x._stop(!0),Z=Z||x.transform.centerPoint,U&&(b.bearing+=U),$&&(b.pitch+=$),b._updateCameraState();const ue=[0,0,0];if(R)if(b.projection.name==="mercator"){const Te=this._trackingEllipsoid.projectRay(b.screenPointToMercatorRay(Z).dir),Pe=this._trackingEllipsoid.projectRay(b.screenPointToMercatorRay(Z.sub(R)).dir);ue[0]=Pe[0]-Te[0],ue[1]=Pe[1]-Te[1]}else{const Te=b.pointCoordinate(Z);if(b.projection.name==="globe"){R=R.rotate(-b.angle);const Pe=b._pixelsPerMercatorPixel/b.worldSize;ue[0]=-R.x*i.dB(i.aS(Te.y))*Pe,ue[1]=-R.y*i.dB(b.center.lat)*Pe}else{const Pe=b.pointCoordinate(Z.sub(R));Te&&Pe&&(ue[0]=Pe.x-Te.x,ue[1]=Pe.y-Te.y)}}const oe=b.zoom,de=[0,0,0];if(N){const Te=A(W||b.pointCoordinate3D(Z)),Pe={dir:i.ab.vec3.normalize([],i.ab.vec3.sub([],Te,b._camera.position))};if(Pe.dir[2]<0){const Oe=b.zoomDeltaToMovement(Te,N);i.ab.vec3.scale(de,Pe.dir,Oe)}}const fe=i.ab.vec3.add(ue,ue,de);b._translateCameraConstrained(fe),N&&Math.abs(b.zoom-oe)>1e-4&&b.recenterOnTerrain(),b.cameraElevationReference="ground",this._map._update(),r.noInertia||this._inertia.record(r),this._fireEvents(l,m,!0)}_fireEvents(r,l,m){const x=Ns(this._eventsInProgress),b=Ns(r),A={};for(const $ in r){const{originalEvent:Z}=r[$];this._eventsInProgress[$]||(A[`${$}start`]=Z),this._eventsInProgress[$]=r[$]}!x&&b&&this._fireEvent("movestart",b.originalEvent);for(const $ in A)this._fireEvent($,A[$]);b&&this._fireEvent("move",b.originalEvent);for(const $ in r){const{originalEvent:Z}=r[$];this._fireEvent($,Z)}const R={};let N;for(const $ in this._eventsInProgress){const{handlerName:Z,originalEvent:W}=this._eventsInProgress[$];this._handlersById[Z].isActive()||(delete this._eventsInProgress[$],N=l[Z]||W,R[`${$}end`]=N)}for(const $ in R)this._fireEvent($,R[$]);const U=Ns(this._eventsInProgress);if(m&&(x||b)&&!U){this._updatingCamera=!0;const $=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),Z=W=>W!==0&&-this._bearingSnap<W&&W<this._bearingSnap;$?(Z($.bearing||this._map.getBearing())&&($.bearing=0),this._map.easeTo($,{originalEvent:N})):(this._map.fire(new i.z("moveend",{originalEvent:N})),Z(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(r,l){this._map.fire(new i.z(r,l?{originalEvent:l}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(r=>{this._frameId=void 0,this.handleEvent(new vp("renderFrame",{timeStamp:r})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const Lh="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class zc extends i.E{constructor(r,l){super(),this._moving=!1,this._zooming=!1,this.transform=r,this._bearingSnap=l.bearingSnap,this._respectPrefersReducedMotion=l.respectPrefersReducedMotion!==!1,i.aP(["_renderFrameCallback"],this)}getCenter(){return new i.bO(this.transform.center.lng,this.transform.center.lat)}setCenter(r,l){return this.jumpTo({center:r},l)}panBy(r,l,m){return r=i.P.convert(r).mult(-1),this.panTo(this.transform.center,i.l({offset:r},l),m)}panTo(r,l,m){return this.easeTo(i.l({center:r},l),m)}getZoom(){return this.transform.zoom}setZoom(r,l){return this.jumpTo({zoom:r},l),this}zoomTo(r,l,m){return this.easeTo(i.l({zoom:r},l),m)}zoomIn(r,l){return this.zoomTo(this.getZoom()+1,r,l),this}zoomOut(r,l){return this.zoomTo(this.getZoom()-1,r,l),this}getBearing(){return this.transform.bearing}setBearing(r,l){return this.jumpTo({bearing:r},l),this}getPadding(){return this.transform.padding}setPadding(r,l){return this.jumpTo({padding:r},l),this}rotateTo(r,l,m){return this.easeTo(i.l({bearing:r},l),m)}resetNorth(r,l){return this.rotateTo(0,i.l({duration:1e3},r),l),this}resetNorthPitch(r,l){return this.easeTo(i.l({bearing:0,pitch:0,duration:1e3},r),l),this}snapToNorth(r,l){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(r,l):this}getPitch(){return this.transform.pitch}setPitch(r,l){return this.jumpTo({pitch:r},l),this}cameraForBounds(r,l){r=i.az.convert(r);const m=l&&l.bearing||0,x=l&&l.pitch||0,b=r.getNorthWest(),A=r.getSouthEast();return this._cameraForBounds(this.transform,b,A,m,x,l)}_extendPadding(r){const l={top:0,right:0,bottom:0,left:0};return r==null?i.l({},l,this.transform.padding):typeof r=="number"?{top:r,bottom:r,right:r,left:r}:i.l({},l,r)}_extendCameraOptions(r){return(r=i.l({offset:[0,0],maxZoom:this.transform.maxZoom},r)).padding=this._extendPadding(r.padding),r}_minimumAABBFrustumDistance(r,l){const m=l.max[0]-l.min[0],x=l.max[1]-l.min[1];return m/x>r.aspect?m/(2*Math.tan(.5*r.fovX)*r.aspect):x/(2*Math.tan(.5*r.fovY)*r.aspect)}_cameraForBoundsOnGlobe(r,l,m,x,b,A){const R=r.clone(),N=this._extendCameraOptions(A);R.bearing=x,R.pitch=b;const U=i.bO.convert(l),$=i.bO.convert(m),Z=.5*(U.lat+$.lat),W=.5*(U.lng+$.lng),ee=i.dC(Z,W),ue=i.ab.vec3.normalize([],ee),oe=i.ab.vec3.normalize([],i.ab.vec3.cross([],ue,[0,1,0])),de=i.ab.vec3.cross([],oe,ue),fe=[oe[0],oe[1],oe[2],0,de[0],de[1],de[2],0,ue[0],ue[1],ue[2],0,0,0,0,1],Te=[ee,i.dC(U.lat,U.lng),i.dC($.lat,U.lng),i.dC($.lat,$.lng),i.dC(U.lat,$.lng),i.dC(Z,U.lng),i.dC(Z,$.lng),i.dC(U.lat,W),i.dC($.lat,W)];let Pe=i.cd.fromPoints(Te.map(mt=>[i.ab.vec3.dot(oe,mt),i.ab.vec3.dot(de,mt),i.ab.vec3.dot(ue,mt)]));const Oe=i.ab.vec3.transformMat4([],Pe.center,fe);i.ab.vec3.squaredLength(Oe)===0&&i.ab.vec3.set(Oe,0,0,1),i.ab.vec3.normalize(Oe,Oe),i.ab.vec3.scale(Oe,Oe,i.ax),R.center=i.dD(Oe);const Fe=R.getWorldToCameraMatrix(),Re=i.ab.mat4.invert(new Float64Array(16),Fe);Pe=i.cd.applyTransform(Pe,i.ab.mat4.multiply([],Fe,fe));const ke=this._extendAABB(Pe,R,N,x);if(!ke)return void i.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");Pe=ke,i.ab.vec3.transformMat4(Oe,Oe,Fe);const De=.5*(Pe.max[2]-Pe.min[2]),$e=this._minimumAABBFrustumDistance(R,Pe),Xe=i.ab.vec3.scale([],[0,0,1],De),ft=i.ab.vec3.add(Xe,Oe,Xe),ot=$e+(R.pitch===0?0:i.ab.vec3.distance(Oe,ft)),Et=R.globeCenterInViewSpace,vt=i.ab.vec3.sub([],Oe,[Et[0],Et[1],Et[2]]);i.ab.vec3.normalize(vt,vt),i.ab.vec3.scale(vt,vt,ot);const nt=i.ab.vec3.add([],Oe,vt);i.ab.vec3.transformMat4(nt,nt,Re);const pt=i.ds/i.ax,Lt=i.ab.vec3.length(nt),tt=i.bH(Math.max(Lt*pt-i.ds,Number.EPSILON),0),St=Math.min(R.zoomFromMercatorZAdjusted(tt),N.maxZoom);return St>.5*(i.c6+i.bY)?(R.setProjection({name:"mercator"}),R.zoom=St,this._cameraForBounds(R,l,m,x,b,A)):{center:R.center,zoom:St,bearing:x,pitch:b}}_extendAABB(r,l,m,x){const b=.5*((m.padding.left||0)+(m.padding.right||0)),A=.5*((m.padding.top||0)+(m.padding.bottom||0)),R=A,N=b,U=b,$=A,Z=l.width-(N+U),W=l.height-(R+$),ee=i.ab.vec3.sub([],r.max,r.min),ue=Math.min(Z/ee[0],W/ee[1]),oe=Math.min(l.scaleZoom(l.scale*ue),m.maxZoom);if(isNaN(oe))return null;const de=l.scale/l.zoomScale(oe),fe=new i.cd([r.min[0]-N*de,r.min[1]-$*de,r.min[2]],[r.max[0]+U*de,r.max[1]+R*de,r.max[2]]),Te=(typeof m.offset.x=="number"&&typeof m.offset.y=="number"?new i.P(m.offset.x,m.offset.y):i.P.convert(m.offset)).rotate(-i.ai(x));return fe.center[0]-=Te.x*de,fe.center[1]+=Te.y*de,fe}queryTerrainElevation(r,l){const m=this.transform.elevation;return m?(l=i.l({},{exaggerated:!0},l),m.getAtPoint(i.aa.fromLngLat(r),null,l.exaggerated)):null}_cameraForBounds(r,l,m,x,b,A){if(r.projection.name==="globe")return this._cameraForBoundsOnGlobe(r,l,m,x,b,A);const R=r.clone(),N=this._extendCameraOptions(A);R.bearing=x,R.pitch=b;const U=i.bO.convert(l),$=i.bO.convert(m),Z=new i.bO(U.lng,$.lat),W=new i.bO($.lng,U.lat),ee=R.project(U),ue=R.project($),oe=this.queryTerrainElevation(U),de=this.queryTerrainElevation($),fe=this.queryTerrainElevation(Z),Te=this.queryTerrainElevation(W),Pe=[[ee.x,ee.y,Math.min(oe||0,de||0,fe||0,Te||0)],[ue.x,ue.y,Math.max(oe||0,de||0,fe||0,Te||0)]];let Oe=i.cd.fromPoints(Pe);const Fe=R.getWorldToCameraMatrix(),Re=i.ab.mat4.invert(new Float64Array(16),Fe);Oe=i.cd.applyTransform(Oe,Fe);const ke=this._extendAABB(Oe,R,N,x);if(!ke)return void i.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");Oe=ke;const De=.5*i.ab.vec3.sub([],Oe.max,Oe.min)[2],$e=this._minimumAABBFrustumDistance(R,Oe),Xe=[0,0,1,0];i.ab.vec4.transformMat4(Xe,Xe,Fe),i.ab.vec4.normalize(Xe,Xe);const ft=i.ab.vec3.scale([],Xe,$e+De),ot=i.ab.vec3.add([],Oe.center,ft);i.ab.vec3.transformMat4(Oe.center,Oe.center,Re),i.ab.vec3.transformMat4(ot,ot,Re);const Et=R.unproject(new i.P(Oe.center[0],Oe.center[1])),vt=i.dE(R.projection,Et),nt=Math.pow(2,vt),pt=Math.min(R._zoomFromMercatorZ(ot[2]*R.pixelsPerMeter*nt/R.worldSize),N.maxZoom);return R.mercatorFromTransition&&pt<.5*(i.c6+i.bY)?(R.setProjection({name:"globe"}),R.zoom=pt,this._cameraForBounds(R,l,m,x,b,A)):{center:Et,zoom:pt,bearing:x,pitch:b}}fitBounds(r,l,m){const x=this.cameraForBounds(r,l);return this._fitInternal(x,l,m)}fitScreenCoordinates(r,l,m,x,b){const A=i.P.convert(r),R=i.P.convert(l),N=new i.P(Math.min(A.x,R.x),Math.min(A.y,R.y)),U=new i.P(Math.max(A.x,R.x),Math.max(A.y,R.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(A,R))return this;const $=this.transform.pointLocation3D(N),Z=this.transform.pointLocation3D(U),W=this.transform.pointLocation3D(new i.P(N.x,U.y)),ee=this.transform.pointLocation3D(new i.P(U.x,N.y)),ue=[Math.min($.lng,Z.lng,W.lng,ee.lng),Math.min($.lat,Z.lat,W.lat,ee.lat)],oe=[Math.max($.lng,Z.lng,W.lng,ee.lng),Math.max($.lat,Z.lat,W.lat,ee.lat)],de=x&&x.pitch?x.pitch:this.getPitch(),fe=this._cameraForBounds(this.transform,ue,oe,m,de,x);return this._fitInternal(fe,x,b)}_fitInternal(r,l,m){return r?(l=i.l(r,l)).linear?this.easeTo(l,m):this.flyTo(l,m):this}jumpTo(r,l){this.stop();const m=r.preloadOnly?this.transform.clone():this.transform;let x=!1,b=!1,A=!1;"zoom"in r&&m.zoom!==+r.zoom&&(x=!0,m.zoom=+r.zoom),r.center!==void 0&&(m.center=i.bO.convert(r.center)),"bearing"in r&&m.bearing!==+r.bearing&&(b=!0,m.bearing=+r.bearing),"pitch"in r&&m.pitch!==+r.pitch&&(A=!0,m.pitch=+r.pitch);const R=typeof r.padding=="number"?this._extendPadding(r.padding):r.padding;if(r.padding!=null&&!m.isPaddingEqual(R))if(r.retainPadding===!1){const N=m.clone();N.padding=R,m.setLocationAtPoint(m.center,N.centerPoint)}else m.padding=R;return r.preloadOnly?(this._preloadTiles(m),this):(this.fire(new i.z("movestart",l)).fire(new i.z("move",l)),x&&this.fire(new i.z("zoomstart",l)).fire(new i.z("zoom",l)).fire(new i.z("zoomend",l)),b&&this.fire(new i.z("rotatestart",l)).fire(new i.z("rotate",l)).fire(new i.z("rotateend",l)),A&&this.fire(new i.z("pitchstart",l)).fire(new i.z("pitch",l)).fire(new i.z("pitchend",l)),this.fire(new i.z("moveend",l)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||i.w(Lh),this.transform.getFreeCameraOptions()}setFreeCameraOptions(r,l){const m=this.transform;if(!m.projection.supportsFreeCamera)return i.w(Lh),this;this.stop();const x=m.zoom,b=m.pitch,A=m.bearing;m.setFreeCameraOptions(r);const R=x!==m.zoom,N=b!==m.pitch,U=A!==m.bearing;return this.fire(new i.z("movestart",l)).fire(new i.z("move",l)),R&&this.fire(new i.z("zoomstart",l)).fire(new i.z("zoom",l)).fire(new i.z("zoomend",l)),U&&this.fire(new i.z("rotatestart",l)).fire(new i.z("rotate",l)).fire(new i.z("rotateend",l)),N&&this.fire(new i.z("pitchstart",l)).fire(new i.z("pitch",l)).fire(new i.z("pitchend",l)),this.fire(new i.z("moveend",l)),this}easeTo(r,l){this._stop(!1,r.easeId),((r=i.l({offset:[0,0],duration:500,easing:i.dA},r)).animate===!1||this._prefersReducedMotion(r))&&(r.duration=0);const m=this.transform,x=this.getZoom(),b=this.getBearing(),A=this.getPitch(),R=this.getPadding(),N="zoom"in r?+r.zoom:x,U="bearing"in r?this._normalizeBearing(r.bearing,b):b,$="pitch"in r?+r.pitch:A,Z=this._extendPadding(r.padding),W=i.P.convert(r.offset);let ee,ue,oe;if(m.projection.name==="globe"){const Xe=i.aa.fromLngLat(m.center),ft=W.rotate(-m.angle);Xe.x+=ft.x/m.worldSize,Xe.y+=ft.y/m.worldSize;const ot=Xe.toLngLat(),Et=i.bO.convert(r.center||ot);this._normalizeCenter(Et),ee=m.centerPoint.add(ft),ue=new i.P(Xe.x,Xe.y).mult(m.worldSize),oe=new i.P(i.at(Et.lng),i.aA(Et.lat)).mult(m.worldSize).sub(ue)}else{ee=m.centerPoint.add(W);const Xe=m.pointLocation(ee),ft=i.bO.convert(r.center||Xe);this._normalizeCenter(ft),ue=m.project(Xe),oe=m.project(ft).sub(ue)}const de=m.zoomScale(N-x);let fe,Te;r.around&&(fe=i.bO.convert(r.around),Te=m.locationPoint(fe));const Pe=this._zooming||N!==x,Oe=this._rotating||b!==U,Fe=this._pitching||$!==A,Re=!m.isPaddingEqual(Z),ke=r.retainPadding===!1?m.clone():m,De=Xe=>ft=>{if(Pe&&(Xe.zoom=i.af(x,N,ft)),Oe&&(Xe.bearing=i.af(b,U,ft)),Fe&&(Xe.pitch=i.af(A,$,ft)),Re&&(ke.interpolatePadding(R,Z,ft),ee=ke.centerPoint.add(W)),fe)Xe.setLocationAtPoint(fe,Te);else{const ot=Xe.zoomScale(Xe.zoom-x),Et=N>x?Math.min(2,de):Math.max(.5,de),vt=Math.pow(Et,1-ft),nt=Xe.unproject(ue.add(oe.mult(ft*vt)).mult(ot));Xe.setLocationAtPoint(Xe.renderWorldCopies?nt.wrap():nt,ee)}return r.preloadOnly||this._fireMoveEvents(l),Xe};if(r.preloadOnly){const Xe=this._emulate(De,r.duration,m);return this._preloadTiles(Xe),this}const $e={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=Pe,this._rotating=Oe,this._pitching=Fe,this._padding=Re,this._easeId=r.easeId,this._prepareEase(l,r.noMoveStart,$e),this._ease(De(m),Xe=>{m.cameraElevationReference==="sea"&&m.recenterOnTerrain(),this._afterEase(l,Xe)},r),this}_prepareEase(r,l,m={}){this._moving=!0,this.transform.cameraElevationReference="sea",this.transform._orthographicProjectionAtLowPitch&&this.transform.pitch===0&&this.transform.projection.name!=="globe"&&(this.transform.cameraElevationReference="ground"),l||m.moving||this.fire(new i.z("movestart",r)),this._zooming&&!m.zooming&&this.fire(new i.z("zoomstart",r)),this._rotating&&!m.rotating&&this.fire(new i.z("rotatestart",r)),this._pitching&&!m.pitching&&this.fire(new i.z("pitchstart",r))}_fireMoveEvents(r){this.fire(new i.z("move",r)),this._zooming&&this.fire(new i.z("zoom",r)),this._rotating&&this.fire(new i.z("rotate",r)),this._pitching&&this.fire(new i.z("pitch",r))}_afterEase(r,l){if(this._easeId&&l&&this._easeId===l)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const m=this._zooming,x=this._rotating,b=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,m&&this.fire(new i.z("zoomend",r)),x&&this.fire(new i.z("rotateend",r)),b&&this.fire(new i.z("pitchend",r)),this.fire(new i.z("moveend",r))}flyTo(r,l){if(this._prefersReducedMotion(r)){const mt=i.ay(r,["center","zoom","bearing","pitch","around","padding","retainPadding"]);return this.jumpTo(mt,l)}this.stop(),r=i.l({offset:[0,0],speed:1.2,curve:1.42,easing:i.dA},r);const m=this.transform,x=this.getZoom(),b=this.getBearing(),A=this.getPitch(),R=this.getPadding(),N="zoom"in r?i.aw(+r.zoom,m.minZoom,m.maxZoom):x,U="bearing"in r?this._normalizeBearing(r.bearing,b):b,$="pitch"in r?+r.pitch:A,Z=this._extendPadding(r.padding),W=m.zoomScale(N-x),ee=i.P.convert(r.offset);let ue=m.centerPoint.add(ee);const oe=m.pointLocation(ue),de=i.bO.convert(r.center||oe);this._normalizeCenter(de);const fe=m.project(oe),Te=m.project(de).sub(fe);let Pe=r.curve;const Oe=Math.max(m.width,m.height),Fe=Oe/W,Re=Te.mag();if("minZoom"in r){const mt=i.aw(Math.min(r.minZoom,x,N),m.minZoom,m.maxZoom),Gt=Oe/m.zoomScale(mt-x);Pe=Math.sqrt(Gt/Re*2)}const ke=Pe*Pe;function De(mt){const Gt=(Fe*Fe-Oe*Oe+(mt?-1:1)*ke*ke*Re*Re)/(2*(mt?Fe:Oe)*ke*Re);return Math.log(Math.sqrt(Gt*Gt+1)-Gt)}function $e(mt){return(Math.exp(mt)-Math.exp(-mt))/2}function Xe(mt){return(Math.exp(mt)+Math.exp(-mt))/2}const ft=De(0);let ot=function(mt){return Xe(ft)/Xe(ft+Pe*mt)},Et=function(mt){return Oe*((Xe(ft)*($e(Gt=ft+Pe*mt)/Xe(Gt))-$e(ft))/ke)/Re;var Gt},vt=(De(1)-ft)/Pe;if(Math.abs(Re)<1e-6||!isFinite(vt)){if(Math.abs(Oe-Fe)<1e-6)return this.easeTo(r,l);const mt=Fe<Oe?-1:1;vt=Math.abs(Math.log(Fe/Oe))/Pe,Et=function(){return 0},ot=function(Gt){return Math.exp(mt*Pe*Gt)}}r.duration="duration"in r?+r.duration:1e3*vt/("screenSpeed"in r?+r.screenSpeed/Pe:+r.speed),r.maxDuration&&r.duration>r.maxDuration&&(r.duration=0);const nt=b!==U,pt=$!==A,Lt=!m.isPaddingEqual(Z),tt=r.retainPadding===!1?m.clone():m,St=mt=>Gt=>{const Pt=Gt*vt,At=1/ot(Pt);mt.zoom=Gt===1?N:x+mt.scaleZoom(At),nt&&(mt.bearing=i.af(b,U,Gt)),pt&&(mt.pitch=i.af(A,$,Gt)),Lt&&(tt.interpolatePadding(R,Z,Gt),ue=tt.centerPoint.add(ee));const kt=Gt===1?de:mt.unproject(fe.add(Te.mult(Et(Pt))).mult(At));return mt.setLocationAtPoint(mt.renderWorldCopies?kt.wrap():kt,ue),mt._updateCameraOnTerrain(),r.preloadOnly||this._fireMoveEvents(l),mt};if(r.preloadOnly){const mt=this._emulate(St,r.duration,m);return this._preloadTiles(mt),this}return this._zooming=!0,this._rotating=nt,this._pitching=pt,this._padding=Lt,this._prepareEase(l,!1),this._ease(St(m),()=>this._afterEase(l),r),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_requestRenderFrame(r){}_cancelRenderFrame(r){}_stop(r,l){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const m=this._onEaseEnd;this._onEaseEnd=void 0,m.call(this,l)}if(!r){const m=this.handlers;m&&m.stop(!1)}return this}_ease(r,l,m){m.animate===!1||m.duration===0?(r(1),l()):(this._easeStart=i.q.now(),this._easeOptions=m,this._onEaseFrame=r,this._onEaseEnd=l,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const r=Math.min((i.q.now()-this._easeStart)/this._easeOptions.duration,1),l=this._onEaseFrame;l&&l(this._easeOptions.easing(r)),r<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(r,l){r=i.bF(r,-180,180);const m=Math.abs(r-l);return Math.abs(r-360-l)<m&&(r-=360),Math.abs(r+360-l)<m&&(r+=360),r}_normalizeCenter(r){const l=this.transform;if(l.maxBounds||l.projection.name!=="globe"&&!l.renderWorldCopies)return;const m=r.lng-l.center.lng;r.lng+=m>180?-360:m<-180?360:0}_prefersReducedMotion(r){return this._respectPrefersReducedMotion&&i.q.prefersReducedMotion&&!(r&&r.essential)}_emulate(r,l,m){const x=Math.ceil(15*l/1e3),b=[],A=r(m.clone());for(let R=0;R<=x;R++){const N=A(R/x);b.push(N.clone())}return b}_preloadTiles(r,l){}}class zh{constructor(r={}){this.options=r,i.aP(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(r){const l=this.options&&this.options.compact,m=r._getUIString("AttributionControl.ToggleAttribution");this._map=r,this._container=K("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=K("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._compactButton.setAttribute("aria-label",m);const x=K("span","mapboxgl-ctrl-icon",this._compactButton);return x.setAttribute("aria-hidden","true"),x.setAttribute("title",m),this._innerContainer=K("div","mapboxgl-ctrl-attrib-inner",this._container),l&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),l===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let r=this._editLink;r||(r=this._editLink=this._container.querySelector(".mapbox-improve-map"));const l=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||i.e.ACCESS_TOKEN}];if(r){const m=l.reduce((x,b,A)=>(b.value&&(x+=`${b.key}=${b.value}${A<l.length-1?"&":""}`),x),"?");r.href=`${i.e.FEEDBACK_URL}/${m}#${dp(this._map,!0)}`,r.rel="noopener nofollow"}}_updateData(r){!r||r.sourceDataType!=="metadata"&&r.sourceDataType!=="visibility"&&r.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let r=[];if(this._map.style.stylesheet){const x=this._map.style.stylesheet;this.styleOwner=x.owner,this.styleId=x.id}const l=this._map.style._mergedSourceCaches;for(const x in l){const b=l[x];if(b.used){const A=b.getSource();A.attribution&&r.indexOf(A.attribution)<0&&r.push(A.attribution)}}r.sort((x,b)=>x.length-b.length),r=r.filter((x,b)=>{for(let A=b+1;A<r.length;A++)if(r[A].indexOf(x)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?r=[...this.options.customAttribution,...r]:r.unshift(this.options.customAttribution));const m=r.join(" | ");m!==this._attribHTML&&(this._attribHTML=m,r.length?(this._innerContainer.innerHTML=m,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class Ga{constructor(){i.aP(["_updateLogo","_updateCompact"],this)}onAdd(r){this._map=r,this._container=K("div","mapboxgl-ctrl");const l=K("a","mapboxgl-ctrl-logo");return l.target="_blank",l.rel="noopener nofollow",l.href="https://www.mapbox.com/",l.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),l.setAttribute("rel","noopener nofollow"),this._container.appendChild(l),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(r){r&&r.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const r=this._map.style._sourceCaches;if(Object.entries(r).length===0)return!0;for(const l in r){const m=r[l].getSource();if(m.hasOwnProperty("mapbox_logo")&&!m.mapbox_logo)return!1}return!0}_updateCompact(){const r=this._container.children;if(r.length){const l=r[0];this._map.getCanvasContainer().offsetWidth<250?l.classList.add("mapboxgl-compact"):l.classList.remove("mapboxgl-compact")}}}class Ha{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(r){const l=++this._id;return this._queue.push({callback:r,id:l,cancelled:!1}),l}remove(r){const l=this._currentlyRunning,m=l?this._queue.concat(l):this._queue;for(const x of m)if(x.id===r)return void(x.cancelled=!0)}run(r=0){const l=this._currentlyRunning=this._queue;this._queue=[];for(const m of l)if(!m.cancelled&&(m.callback(r),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}class Iu{constructor(r){this.jumpTo(r)}getValue(r){if(r<=this._startTime)return this._start;if(r>=this._endTime)return this._end;const l=i.cB((r-this._startTime)/(this._endTime-this._startTime));return this._start*(1-l)+this._end*l}isEasing(r){return r>=this._startTime&&r<=this._endTime}jumpTo(r){this._startTime=-1/0,this._endTime=-1/0,this._start=r,this._end=r}easeTo(r,l,m){this._start=this.getValue(l),this._end=r,this._startTime=l,this._endTime=l+m}}const kc={"AttributionControl.ToggleAttribution":"Toggle attribution","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox homepage","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use ⌘ + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"};class Fs extends i.z{constructor(r,l,m,x){const{point:b,lngLat:A,originalEvent:R,target:N}=r;super(r.type,{point:b,lngLat:A,originalEvent:R,target:N}),this.preventDefault=()=>{r.preventDefault()},this.id=l,this.interaction=m,this.feature=x}}class al{constructor(r){this.map=r,this.interactionsByType=new Map,this.delegatedInteractions=new Map,this.typeById=new Map,this.filters=new Map,this.handleType=this.handleType.bind(this),this.handleMove=this.handleMove.bind(this),this.handleOut=this.handleOut.bind(this),this.hoveredFeatures=new Map,this.prevHoveredFeatures=new Map}add(r,l){if(this.typeById.has(r))throw new Error(`Interaction id "${r}" already exists.`);const m=l.filter;let x=l.type;m&&this.filters.set(r,i.aZ(m)),x==="mouseover"&&(x="mouseenter"),x==="mouseout"&&(x="mouseleave");const b=this.interactionsByType.get(x)||new Map;x==="mouseenter"||x==="mouseleave"?(this.delegatedInteractions.size===0&&(this.map.on("mousemove",this.handleMove),this.map.on("mouseout",this.handleOut)),this.delegatedInteractions.set(r,l)):b.size===0&&this.map.on(x,this.handleType),b.size===0&&this.interactionsByType.set(x,b),b.set(r,l),this.typeById.set(r,x)}get(r){const l=this.typeById.get(r);if(!l)return;const m=this.interactionsByType.get(l);return m?m.get(r):void 0}remove(r){const l=this.typeById.get(r);if(!l)return;this.typeById.delete(r),this.filters.delete(r);const m=this.interactionsByType.get(l);m&&(m.delete(r),l==="mouseenter"||l==="mouseleave"?(this.delegatedInteractions.delete(r),this.delegatedInteractions.size===0&&(this.map.off("mousemove",this.handleMove),this.map.off("mouseout",this.handleOut))):m.size===0&&this.map.off(l,this.handleType))}queryTargets(r,l){const m=[];for(const[x,b]of l)b.target&&m.push({targetId:x,target:b.target,filter:this.filters.get(x)});return this.map.style.queryRenderedTargets(r,m,this.map.transform)}handleMove(r){this.prevHoveredFeatures=this.hoveredFeatures,this.hoveredFeatures=new Map;const l=this.queryTargets(r.point,Array.from(this.delegatedInteractions).reverse());l.length&&(r.type="mouseenter",this.handleType(r,l));const m=new Map;for(const[x,{feature:b}]of this.prevHoveredFeatures)this.hoveredFeatures.has(x)||m.set(b.id,b);m.size&&(r.type="mouseleave",this.handleType(r,Array.from(m.values())))}handleOut(r){const l=Array.from(this.hoveredFeatures.values()).map(({feature:m})=>m);l.length&&(r.type="mouseleave",this.handleType(r,l)),this.hoveredFeatures.clear()}handleType(r,l){const m=Array.from(this.interactionsByType.get(r.type)).reverse(),x=!!l;l=l||this.queryTargets(r.point,m);const b=r.type==="mouseenter";let A=!1;const R=new Set;for(const N of l){for(const[U,$]of m){if(!$.target)continue;const Z=N.variants?N.variants[U]:null;if(Z){for(const W of Z){if(yl(W,N,R,U))continue;const ee=new i.cw(N,W),ue=th(W,N,U);x&&(ee.state=this.map.getFeatureState(ee));const oe=b?this.prevHoveredFeatures.get(ue):null,de=new Fs(r,U,$,ee),fe=oe?oe.stop:$.handler(de);if(b&&this.hoveredFeatures.set(ue,{feature:N,stop:fe}),fe!==!1){A=!0;break}}if(A)break}}if(A)break}if(!A)for(const[N,U]of m){const{handler:$,target:Z}=U;if(!Z&&$(new Fs(r,N,U,null))!==!1)break}}}function pr(p,r){if(Array.isArray(p)&&Array.isArray(r)){const l=new Set(p),m=new Set(r);return l.size===m.size&&p.every(x=>m.has(x))}return i.bn(p,r)}const jl={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,antialias:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0,collectResourceTiming:!1,testMode:!1,precompilePrograms:!0,scaleFactor:1,spriteFormat:"auto"},Pu={showCompass:!0,showZoom:!0,visualizePitch:!1};class qo{constructor(r,l,m=!1){this._clickTolerance=10,this.element=l,this.mouseRotate=new _s({clickTolerance:r.dragRotate._mouseRotate._clickTolerance}),this.map=r,m&&(this.mousePitch=new Ou({clickTolerance:r.dragRotate._mousePitch._clickTolerance})),i.aP(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),l.addEventListener("mousedown",this.mousedown),l.addEventListener("touchstart",this.touchstart,{passive:!1}),l.addEventListener("touchmove",this.touchmove),l.addEventListener("touchend",this.touchend),l.addEventListener("touchcancel",this.reset)}down(r,l){this.mouseRotate.mousedown(r,l),this.mousePitch&&this.mousePitch.mousedown(r,l),xe()}move(r,l){const m=this.map,x=this.mouseRotate.mousemoveWindow(r,l),b=x&&x.bearingDelta;if(b&&m.setBearing(m.getBearing()+b),this.mousePitch){const A=this.mousePitch.mousemoveWindow(r,l),R=A&&A.pitchDelta;R&&m.setPitch(m.getPitch()+R)}}off(){const r=this.element;r.removeEventListener("mousedown",this.mousedown),r.removeEventListener("touchstart",this.touchstart,{passive:!1}),r.removeEventListener("touchmove",this.touchmove),r.removeEventListener("touchend",this.touchend),r.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){ae(),window.removeEventListener("mousemove",this.mousemove),window.removeEventListener("mouseup",this.mouseup)}mousedown(r){this.down(i.l({},r,{ctrlKey:!0,preventDefault:()=>r.preventDefault()}),He(this.element,r)),window.addEventListener("mousemove",this.mousemove),window.addEventListener("mouseup",this.mouseup)}mousemove(r){this.move(r,He(this.element,r))}mouseup(r){this.mouseRotate.mouseupWindow(r),this.mousePitch&&this.mousePitch.mouseupWindow(r),this.offTemp()}touchstart(r){r.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=Ge(this.element,r.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>r.preventDefault()},this._startPos))}touchmove(r){r.targetTouches.length!==1?this.reset():(this._lastPos=Ge(this.element,r.targetTouches)[0],this.move({preventDefault:()=>r.preventDefault()},this._lastPos))}touchend(r){r.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}function Xf(p,r,l){if(p=new i.bO(p.lng,p.lat),r){const m=new i.bO(p.lng-360,p.lat),x=new i.bO(p.lng+360,p.lat),b=360*Math.ceil(Math.abs(p.lng-l.center.lng)/360),A=l.locationPoint(p).distSqr(r),R=r.x<0||r.y<0||r.x>l.width||r.y>l.height;l.locationPoint(m).distSqr(r)<A&&(R||Math.abs(m.lng-l.center.lng)<b)?p=m:l.locationPoint(x).distSqr(r)<A&&(R||Math.abs(x.lng-l.center.lng)<b)&&(p=x)}for(;Math.abs(p.lng-l.center.lng)>180;){const m=l.locationPoint(p);if(m.x>=0&&m.y>=0&&m.x<=l.width&&m.y<=l.height)break;p.lng>l.center.lng?p.lng-=360:p.lng+=360}return p}const js={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class ys extends i.E{constructor(r,l){if(super(),(r instanceof HTMLElement||l)&&(r=i.l({element:r},l)),i.aP(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=r&&r.anchor||"center",this._color=r&&r.color||"#3FB1CE",this._scale=r&&r.scale||1,this._draggable=r&&r.draggable||!1,this._clickTolerance=r&&r.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=r&&r.rotation||0,this._rotationAlignment=r&&r.rotationAlignment||"auto",this._pitchAlignment=r&&r.pitchAlignment&&r.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=r&&r.occludedOpacity||.2,r&&r.element)this._element=r.element,this._offset=i.P.convert(r&&r.offset||[0,0]);else{this._defaultMarker=!0,this._element=K("div");const b=41,A=27,R=ne("svg",{display:"block",height:b*this._scale+"px",width:A*this._scale+"px",viewBox:`0 0 ${A} ${b}`},this._element),N=ne("radialGradient",{id:"shadowGradient"},ne("defs",{},R));ne("stop",{offset:"10%","stop-opacity":.4},N),ne("stop",{offset:"100%","stop-opacity":.05},N),ne("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},R),ne("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},R),ne("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},R),ne("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},R),this._offset=i.P.convert(r&&r.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.hasAttribute("role")||this._element.setAttribute("role","img"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",b=>{b.preventDefault()}),this._element.addEventListener("mousedown",b=>{b.preventDefault()});const m=this._element.classList;for(const b in js)m.remove(`mapboxgl-marker-anchor-${b}`);m.add(`mapboxgl-marker-anchor-${this._anchor}`);const x=r&&r.className?r.className.trim().split(/\s+/):[];m.add(...x),this._popup=null}addTo(r){return r===this._map||(this.remove(),this._map=r,r.getCanvasContainer().appendChild(this._element),r.on("move",this._updateMoving),r.on("moveend",this._update),r.on("remove",this._clearFadeTimer),r._addMarker(this),this.setDraggable(this._draggable),this._update(),r.on("click",this._onMapClick)),this}remove(){const r=this._map;return r&&(r.off("click",this._onMapClick),r.off("move",this._updateMoving),r.off("moveend",this._update),r.off("mousedown",this._addDragHandler),r.off("touchstart",this._addDragHandler),r.off("mouseup",this._onUp),r.off("touchend",this._onUp),r.off("mousemove",this._onMove),r.off("touchmove",this._onMove),r.off("remove",this._clearFadeTimer),r._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(r){return this._lngLat=i.bO.convert(r),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(r){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),r){if(!("offset"in r.options)){const x=Math.sqrt(Math.pow(13.5,2)/2);r.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[x,-1*(38.1-13.5+x)],"bottom-right":[-x,-1*(38.1-13.5+x)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=r,r._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(r){const l=r.code,m=r.charCode||r.keyCode;l!=="Space"&&l!=="Enter"&&m!==32&&m!==13||this.togglePopup()}_onMapClick(r){const l=r.originalEvent.target,m=this._element;this._popup&&(l===m||m.contains(l))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const r=this._popup;return r?(r.isOpen()?(r.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(r.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const r=this._map,l=this._pos;if(!r||!l)return!1;const m=r.unproject(l),x=r.getFreeCameraOptions();if(!x.position)return!1;const b=x.position.toLngLat();return b.distanceTo(m)<.9*b.distanceTo(this._lngLat)}_evaluateOpacity(){const r=this._map;if(!r)return;const l=this._pos;if(!l||l.x<0||l.x>r.transform.width||l.y<0||l.y>r.transform.height)return void this._clearFadeTimer();const m=r.unproject(l);let x;r._showingGlobe()&&i.dH(r.transform,this._lngLat)?x=0:(x=1-r._queryFogOpacity(m),r.transform._terrainEnabled()&&r.getTerrain()&&this._behindTerrain()&&(x*=this._occludedOpacity)),this._element.style.opacity=`${x}`,this._element.style.pointerEvents=x>0?"auto":"none",this._popup&&this._popup._setOpacity(x),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const r=this._pos;if(!r||!this._map)return;const l=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${r.x}px,${r.y}px)
            ${js[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${l.x}px,${l.y}px)
        `}_calculateXYTransform(){const r=this._pos,l=this._map,m=this.getPitchAlignment();if(!l||!r||m!=="map")return"";if(!l._showingGlobe()){const N=l.getPitch();return N?`rotateX(${N}deg)`:""}const x=i.c4(i.dI(l.transform,this._lngLat)),b=r.sub(i.dJ(l.transform)),A=Math.abs(b.x)+Math.abs(b.y);if(A===0)return"";const R=x/A;return`rotateX(${-b.y*R}deg) rotateY(${b.x*R}deg)`}_calculateZTransform(){const r=this._pos,l=this._map;if(!l||!r)return"";let m=0;const x=this.getRotationAlignment();if(x==="map")if(l._showingGlobe()){const b=l.project(new i.bO(this._lngLat.lng,this._lngLat.lat+.001)),A=l.project(new i.bO(this._lngLat.lng,this._lngLat.lat-.001)).sub(b);m=i.c4(Math.atan2(A.y,A.x))-90}else m=-l.getBearing();else if(x==="horizon"){const b=i.ac(4,6,l.getZoom()),A=i.dJ(l.transform);A.y+=b*l.transform.height;const R=r.sub(A),N=i.c4(Math.atan2(R.y,R.x));m=(N>90?N-270:N+90)*(1-b)}return m+=this._rotation,m?`rotateZ(${m}deg)`:""}_update(r){cancelAnimationFrame(this._updateFrameId);const l=this._map;l&&(l.transform.renderWorldCopies&&(this._lngLat=Xf(this._lngLat,this._pos,l.transform)),this._pos=l.project(this._lngLat),r===!0?this._updateFrameId=requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),l._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(l._showingGlobe()||l.getTerrain()||l.getFog())&&!this._fadeTimer&&(this._fadeTimer=window.setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(r){return this._offset=i.P.convert(r),this._update(),this}addClassName(r){return this._element.classList.add(r),this}removeClassName(r){return this._element.classList.remove(r),this}toggleClassName(r){return this._element.classList.toggle(r)}_onMove(r){const l=this._map;if(!l)return;const m=this._pointerdownPos,x=this._positionDelta;if(m&&x){if(!this._isDragging){const b=this._clickTolerance||l._clickTolerance;if(r.point.dist(m)<b)return;this._isDragging=!0}this._pos=r.point.sub(x),this._lngLat=l.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new i.z("dragstart"))),this.fire(new i.z("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const r=this._map;r&&(r.off("mousemove",this._onMove),r.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new i.z("dragend")),this._state="inactive"}_addDragHandler(r){const l=this._map,m=this._pos;l&&m&&this._element.contains(r.originalEvent.target)&&(r.preventDefault(),this._positionDelta=r.point.sub(m),this._pointerdownPos=r.point,this._state="pending",l.on("mousemove",this._onMove),l.on("touchmove",this._onMove),l.once("mouseup",this._onUp),l.once("touchend",this._onUp))}setDraggable(r){this._draggable=!!r;const l=this._map;return l&&(r?(l.on("mousedown",this._addDragHandler),l.on("touchstart",this._addDragHandler)):(l.off("mousedown",this._addDragHandler),l.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(r){return this._rotation=r||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(r){return this._rotationAlignment=r||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(r){return this._pitchAlignment=r||"auto",this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(r){return this._occludedOpacity=r||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const za={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},Ja={maxWidth:100,unit:"metric"},$i={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},ol={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Br=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Yf(p=new i.P(0,0),r="bottom"){if(typeof p=="number"){const l=Math.round(Math.sqrt(.5*Math.pow(p,2)));switch(r){case"top":return new i.P(0,p);case"top-left":return new i.P(l,l);case"top-right":return new i.P(-l,l);case"bottom":return new i.P(0,-p);case"bottom-left":return new i.P(l,-l);case"bottom-right":return new i.P(-l,-l);case"left":return new i.P(p,0);case"right":return new i.P(-p,0)}return new i.P(0,0)}return p instanceof i.P||Array.isArray(p)?i.P.convert(p):i.P.convert(p[r]||[0,0])}return{version:O,supported:X.supported,setRTLTextPlugin:i.dK,getRTLTextPluginStatus:i.dL,Map:class extends zc{constructor(p){j.mark(z.create);const r=p;if((p=i.l({},jl,p)).minZoom!=null&&p.maxZoom!=null&&p.minZoom>p.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(p.minPitch!=null&&p.maxPitch!=null&&p.minPitch>p.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(p.minPitch!=null&&p.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(p.maxPitch!=null&&p.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(p.antialias&&i.dF(window)&&(p.antialias=!1,i.w("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new Tf(p.minZoom,p.maxZoom,p.minPitch,p.maxPitch,p.renderWorldCopies),p),this._repaint=!!p.repaint,this._interactive=p.interactive,this._minTileCacheSize=p.minTileCacheSize,this._maxTileCacheSize=p.maxTileCacheSize,this._failIfMajorPerformanceCaveat=p.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=p.preserveDrawingBuffer,this._antialias=p.antialias,this._trackResize=p.trackResize,this._bearingSnap=p.bearingSnap,this._refreshExpiredTiles=p.refreshExpiredTiles,this._fadeDuration=p.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=p.crossSourceCollisions,this._collectResourceTiming=p.collectResourceTiming,this._language=this._parseLanguage(p.language),this._worldview=p.worldview,this._renderTaskQueue=new Ha,this._domRenderTaskQueue=new Ha,this._controls=[],this._markers=[],this._popups=[],this._mapId=i.aV(),this._locale=i.l({},kc,p.locale),this._clickTolerance=p.clickTolerance,this._cooperativeGestures=p.cooperativeGestures,this._performanceMetricsCollection=p.performanceMetricsCollection,this._tessellationStep=p.tessellationStep,this._containerWidth=0,this._containerHeight=0,this._showParseStatus=!0,this._precompilePrograms=p.precompilePrograms,this._scaleFactorChanged=!1,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new Iu(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._frameId=0,this._scaleFactor=p.scaleFactor,this._requestManager=new Ft(p.transformRequest,p.accessToken,p.testMode),this._silenceAuthErrors=!!p.testMode,this._contextCreateOptions=p.contextCreateOptions?Object.assign({},p.contextCreateOptions):{},typeof p.container=="string"){const l=document.getElementById(p.container);if(!l)throw new Error(`Container '${p.container.toString()}' not found.`);this._container=l}else{if(!(p.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=p.container}if(this._container.childNodes.length>0&&i.w("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),p.maxBounds&&this.setMaxBounds(p.maxBounds),this._spriteFormat=p.spriteFormat,i.aP(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._tp||(this._tp=new Mh),this._tp.registerParameter(this,["Debug"],"showOverdrawInspector"),this._tp.registerParameter(this,["Debug"],"showTileBoundaries"),this._tp.registerParameter(this,["Debug"],"showParseStatus"),this._tp.registerParameter(this,["Debug"],"repaint"),this._tp.registerParameter(this,["Debug"],"showTileAABBs"),this._tp.registerParameter(this,["Debug"],"showPadding"),this._tp.registerParameter(this,["Debug"],"showCollisionBoxes",{noSave:!0}),this._tp.registerParameter(this.transform,["Debug"],"freezeTileCoverage",{noSave:!0},()=>{this._update()}),this._tp.registerParameter(this,["Debug","Wireframe"],"showTerrainWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers2DWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers3DWireframe"),this._tp.registerParameter(this,["Scaling"],"_scaleFactor",{min:.1,max:10,step:.1},()=>{this.setScaleFactor(this._scaleFactor)}),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");if(this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this._fullscreenchangeEvent="onfullscreenchange"in document?"fullscreenchange":"webkitfullscreenchange",window.addEventListener("online",this._onWindowOnline,!1),window.addEventListener("resize",this._onWindowResize,!1),window.addEventListener("orientationchange",this._onWindowResize,!1),window.addEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.addEventListener("visibilitychange",this._onVisibilityChange,!1),this.handlers=new Fl(this,p),this._localFontFamily=p.localFontFamily,this._localIdeographFontFamily=p.localIdeographFontFamily,(p.style||!p.testMode)&&this.setStyle(p.style||i.e.DEFAULT_STYLE,{config:p.config,localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),p.projection&&this.setProjection(p.projection),this.indoor=new cc(this),p.hash&&(this._hash=new qf(typeof p.hash=="string"&&p.hash||void 0).addTo(this)),!this._hash||!this._hash._onHashChange()){r.center==null&&r.zoom==null||(this.transform._unmodified=!1),this.jumpTo({center:p.center,zoom:p.zoom,bearing:p.bearing,pitch:p.pitch});const l=p.bounds;l&&(this.resize(),this.fitBounds(l,i.l({},p.fitBoundsOptions,{duration:0})))}this.resize(),p.attributionControl&&this.addControl(new zh({customAttribution:p.customAttribution})),this._logoControl=new Ga,this.addControl(this._logoControl,p.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet),this._postStyleLoadEvent()}),this.on("data",l=>{this._update(l.dataType==="style"),this.fire(new i.z(`${l.dataType}data`,l))}),this.on("dataloading",l=>{this.fire(new i.z(`${l.dataType}dataloading`,l))}),this._interactions=new al(this)}_getMapId(){return this._mapId}addControl(p,r){if(r===void 0&&(r=p.getDefaultPosition?p.getDefaultPosition():"top-right"),!p||!p.onAdd)return this.fire(new i.y(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const l=p.onAdd(this);this._controls.push(p);const m=this._controlPositions[r];return r.indexOf("bottom")!==-1?m.insertBefore(l,m.firstChild):m.appendChild(l),this}removeControl(p){if(!p||!p.onRemove)return this.fire(new i.y(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const r=this._controls.indexOf(p);return r>-1&&this._controls.splice(r,1),p.onRemove(this),this}hasControl(p){return this._controls.indexOf(p)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(p){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const r=!this._moving;return r&&this.fire(new i.z("movestart",p)).fire(new i.z("move",p)),this.fire(new i.z("resize",p)),r&&this.fire(new i.z("moveend",p)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(p){return this.transform.setMaxBounds(i.az.convert(p)),this._update()}setMinZoom(p){if((p=p??-2)>=-2&&p<=this.transform.maxZoom)return this.transform.minZoom=p,this._update(),this.getZoom()<p?this.setZoom(p):this.fire(new i.z("zoomstart")).fire(new i.z("zoom")).fire(new i.z("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(p){if((p=p??22)>=this.transform.minZoom)return this.transform.maxZoom=p,this._update(),this.getZoom()>p?this.setZoom(p):this.fire(new i.z("zoomstart")).fire(new i.z("zoom")).fire(new i.z("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(p){if((p=p??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(p>=0&&p<=this.transform.maxPitch)return this.transform.minPitch=p,this._update(),this.getPitch()<p?this.setPitch(p):this.fire(new i.z("pitchstart")).fire(new i.z("pitch")).fire(new i.z("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(p){if((p=p??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(p>=this.transform.minPitch)return this.transform.maxPitch=p,this._update(),this.getPitch()>p?this.setPitch(p):this.fire(new i.z("pitchstart")).fire(new i.z("pitch")).fire(new i.z("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getScaleFactor(){return this._scaleFactor}setScaleFactor(p){return this._scaleFactor=p,this.painter.scaleFactor=p,this._tp.refreshUI(),this._scaleFactorChanged=!0,this.style._updateFilteredLayers(r=>r.type==="symbol"),this._update(!0),this}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(p){return this.transform.renderWorldCopies=p,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(p){return p==="auto"?navigator.language:Array.isArray(p)?p.length===0?void 0:p.map(r=>r==="auto"?navigator.language:r):p}setLanguage(p){const r=this._parseLanguage(p);if(!this.style||r===this._language)return this;this._language=r,this.style.reloadSources();for(const l of this._controls)l._setLanguage&&l._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(p){return this.style&&p!==this._worldview?(this._worldview=p,this.style.reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(p){return this._lazyInitEmptyStyle(),p?typeof p=="string"&&(p={name:p}):p=null,this._useExplicitProjection=!!p,this._prioritizeAndUpdateProjection(p,this.style.projection)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const p=this.transform,r=p.projection.name;let l;r==="globe"&&p.zoom>=i.bY?(p.setMercatorFromTransition(),l=!0):r==="mercator"&&p.zoom<i.bY&&(p.setProjection({name:"globe"}),l=!0),l&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(p,r){return this._updateProjection(p||r||{name:"mercator"})}_updateProjection(p){let r;return r=p.name==="globe"&&this.transform.zoom>=i.bY?this.transform.setMercatorFromTransition():this.transform.setProjection(p),this.style.applyProjectionUpdate(),r&&(this.painter.clearBackgroundTiles(),this.style.clearSources(),this._update(!0),this._forceMarkerAndPopupUpdate(!0)),this}project(p){return this.transform.locationPoint3D(i.bO.convert(p))}unproject(p){return this.transform.pointLocation3D(i.P.convert(p))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(p,r,l){const m=x=>{let b=[];if(Array.isArray(r)){const A=r.filter(R=>this.getLayer(R));b=A.length?this.queryRenderedFeatures(x,{layers:A}):[]}else b=this.queryRenderedFeatures(x,{target:r});return b};if(p==="mouseenter"||p==="mouseover"){let x=!1;return{listener:l,targets:r,delegates:{mousemove:A=>{const R=m(A.point);R.length?x||(x=!0,l.call(this,new ho(p,this,A.originalEvent,{features:R}))):x=!1},mouseout:()=>{x=!1}}}}if(p==="mouseleave"||p==="mouseout"){let x=!1;return{listener:l,targets:r,delegates:{mousemove:R=>{m(R.point).length?x=!0:x&&(x=!1,l.call(this,new ho(p,this,R.originalEvent)))},mouseout:R=>{x&&(x=!1,l.call(this,new ho(p,this,R.originalEvent)))}}}}{const x=b=>{const A=m(b.point);A.length&&(b.features=A,l.call(this,b),delete b.features)};return{listener:l,targets:r,delegates:{[p]:x}}}}on(p,r,l){if(typeof r=="function"||l===void 0)return super.on(p,r);if(typeof r=="string"&&(r=[r]),!this._areTargetsValid(r))return this;const m=this._createDelegatedListener(p,r,l);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[p]=this._delegatedListeners[p]||[],this._delegatedListeners[p].push(m);for(const x in m.delegates)this.on(x,m.delegates[x]);return this}once(p,r,l){if(typeof r=="function"||l===void 0)return super.once(p,r);if(typeof r=="string"&&(r=[r]),!this._areTargetsValid(r))return this;const m=this._createDelegatedListener(p,r,l);for(const x in m.delegates)this.once(x,m.delegates[x]);return this}off(p,r,l){if(typeof r=="function"||l===void 0)return super.off(p,r);if(typeof r=="string"&&(r=[r]),!this._areTargetsValid(r))return this;const m=this._delegatedListeners?this._delegatedListeners[p]:void 0;return m&&(x=>{for(let b=0;b<x.length;b++){const A=x[b];if(A.listener===l&&pr(A.targets,r)){for(const R in A.delegates)this.off(R,A.delegates[R]);return x.splice(b,1),this}}})(m),this}queryRenderedFeatures(p,r){if(!this.style)return[];if(p===void 0||p instanceof i.P||Array.isArray(p)||r!==void 0||(r=p,p=void 0),p=p||[[0,0],[this.transform.width,this.transform.height]],!r){const b=this.style.queryRenderedFeatures(p,void 0,this.transform),A=this.style.queryRenderedFeatureset(p,void 0,this.transform);return b.concat(A)}let l=!0;if(r.target&&(l=this._isTargetValid(r.target),l&&!r.layers))return this.style.queryRenderedFeatureset(p,r,this.transform);let m=!0;if(r.layers&&Array.isArray(r.layers)){for(const b of r.layers)if(!this._isValidId(b)){m=!1;break}if(m&&!r.target)return this.style.queryRenderedFeatures(p,r,this.transform)}let x=[];return m&&(x=x.concat(this.style.queryRenderedFeatures(p,r,this.transform))),l&&(x=x.concat(this.style.queryRenderedFeatureset(p,r,this.transform))),x}querySourceFeatures(p,r){return!p||typeof p=="string"&&!this._isValidId(p)?[]:this.style.querySourceFeatures(p,r)}isPointOnSurface(p){const{name:r}=this.transform.projection;return r!=="globe"&&r!=="mercator"&&i.w(`${r} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(i.P.convert(p))}addInteraction(p,r){return this._interactions.add(p,r),this}removeInteraction(p){return this._interactions.remove(p),this}setStyle(p,r){return r=i.l({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},r),this.style&&p&&r.diff!==!1&&r.localFontFamily===this._localFontFamily&&r.localIdeographFontFamily===this._localIdeographFontFamily&&!r.config?(this.style._diffStyle(p,(l,m)=>{l?(i.w(`Unable to perform style diff: ${String(l.message||l.error||l)}. Rebuilding the style from scratch.`),this._updateStyle(p,r)):m&&this._update(!0)},()=>{this._postStyleLoadEvent()}),this):(this._localIdeographFontFamily=r.localIdeographFontFamily,this._localFontFamily=r.localFontFamily,this._updateStyle(p,r))}_getUIString(p){const r=this._locale[p];if(r==null)throw new Error(`Missing UI string '${p}'`);return r}_updateStyle(p,r){if(this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),p){const l=i.l({},r);r&&r.config&&(l.initialConfig=r.config,delete l.config),this.style=new Ia(this,l).load(p),this.style.setEventedParent(this,{style:this.style})}return this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Ia(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(i.w("There is no style added to the map."),!1)}_isValidId(p){return p==null?(this.fire(new i.y(new Error("IDs can't be empty."))),!1):!i.cr(p)||(this.fire(new i.y(new Error(`IDs can't contain special symbols: "${p}".`))),!1)}_isTargetValid(p){return"featuresetId"in p?this._isValidId("importId"in p?p.importId:p.featuresetId):"layerId"in p&&this._isValidId(p.layerId)}_areTargetsValid(p){if(Array.isArray(p)){for(const r of p)if(!this._isValidId(r))return!1;return!0}return this._isTargetValid(p)}addSource(p,r){return this._isValidId(p)?(this._lazyInitEmptyStyle(),this.style.addSource(p,r),this._update(!0)):this}isSourceLoaded(p){return!!this._isValidId(p)&&!!this.style&&this.style._isSourceCacheLoaded(p)}areTilesLoaded(){return this.style.areTilesLoaded()}addSourceType(p,r,l){this._lazyInitEmptyStyle(),this.style.addSourceType(p,r,l)}removeSource(p){return this._isValidId(p)?(this.style.removeSource(p),this._updateTerrain(),this._update(!0)):this}getSource(p){return this._isValidId(p)?this.style.getOwnSource(p):null}addImage(p,r,{pixelRatio:l=1,sdf:m=!1,stretchX:x,stretchY:b,content:A}={}){if(this._lazyInitEmptyStyle(),r instanceof HTMLImageElement||ImageBitmap&&r instanceof ImageBitmap){const{width:R,height:N,data:U}=i.q.getImageData(r);this.style.addImage(p,{data:new i.r({width:R,height:N},U),pixelRatio:l,stretchX:x,stretchY:b,content:A,sdf:m,version:0,usvg:!1})}else if(r.width===void 0||r.height===void 0)this.fire(new i.y(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:R,height:N}=r,U=r;this.style.addImage(p,{data:new i.r({width:R,height:N},new Uint8Array(U.data)),pixelRatio:l,stretchX:x,stretchY:b,content:A,sdf:m,usvg:!1,version:0,userImage:U}),U.onAdd&&U.onAdd(this,p)}}updateImage(p,r){this._lazyInitEmptyStyle();const l=this.style.getImage(p);if(!l)return void this.fire(new i.y(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const m=r instanceof HTMLImageElement||ImageBitmap&&r instanceof ImageBitmap?i.q.getImageData(r):r,{width:x,height:b,data:A}=m;if(x===void 0||b===void 0)return void this.fire(new i.y(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(x!==(l.usvg?l.icon.usvg_tree.width:l.data.width)||b!==(l.usvg?l.icon.usvg_tree.height:l.data.height))return void this.fire(new i.y(new Error(`The width and height of the updated image (${x}, ${b})
                must be that same as the previous version of the image
                (${l.data.width}, ${l.data.height})`)));const R=!(r instanceof HTMLImageElement||ImageBitmap&&r instanceof ImageBitmap);let N=!1;l.usvg?(l.data=new i.r({width:x,height:b},new Uint8Array(A)),l.usvg=!1,l.icon=void 0,N=!0):l.data.replace(A,R),this.style.updateImage(p,l,N)}hasImage(p){return p?!!this.style&&!!this.style.getImage(p):(this.fire(new i.y(new Error("Missing required image id"))),!1)}removeImage(p){this.style.removeImage(p)}loadImage(p,r){i.o(this._requestManager.transformRequest(p,i.R.Image),(l,m)=>{r(l,m instanceof HTMLImageElement?i.q.getImageData(m):m)})}listImages(){return this.style.listImages()}addModel(p,r){this._lazyInitEmptyStyle(),this.style.addModel(p,r)}hasModel(p){return p?this.style.hasModel(p):(this.fire(new i.y(new Error("Missing required model id"))),!1)}removeModel(p){this.style.removeModel(p)}listModels(){return this.style.listModels()}addLayer(p,r){return this._isValidId(p.id)?(this._lazyInitEmptyStyle(),this.style.addLayer(p,r),this._update(!0)):this}getSlot(p){const r=this.getLayer(p);return r&&r.slot||null}setSlot(p,r){return this.style.setSlot(p,r),this.style.mergeLayers(),this._update(!0)}addImport(p,r){return this.style.addImport(p,r),this}updateImport(p,r){return typeof r!="string"&&r.id!==p?(this.removeImport(p),this.addImport(r)):(this.style.updateImport(p,r),this._update(!0))}removeImport(p){return this.style.removeImport(p),this}moveImport(p,r){return this.style.moveImport(p,r),this._update(!0)}moveLayer(p,r){return this._isValidId(p)?(this.style.moveLayer(p,r),this._update(!0)):this}removeLayer(p){return this._isValidId(p)?(this.style.removeLayer(p),this._update(!0)):this}getLayer(p){if(!this._isValidId(p))return null;const r=this.style.getOwnLayer(p);return r?r.type==="custom"?r.implementation:r.serialize():void 0}getSlots(){return this.style.getSlots()}setLayerZoomRange(p,r,l){return this._isValidId(p)?(this.style.setLayerZoomRange(p,r,l),this._update(!0)):this}setFilter(p,r,l={}){return this._isValidId(p)?(this.style.setFilter(p,r,l),this._update(!0)):this}getFilter(p){return this._isValidId(p)?this.style.getFilter(p):null}setPaintProperty(p,r,l,m={}){return this._isValidId(p)?(this.style.setPaintProperty(p,r,l,m),this._update(!0)):this}getPaintProperty(p,r){return this._isValidId(p)?this.style.getPaintProperty(p,r):null}setLayoutProperty(p,r,l,m={}){return this._isValidId(p)?(this.style.setLayoutProperty(p,r,l,m),this._update(!0)):this}getLayoutProperty(p,r){return this._isValidId(p)?this.style.getLayoutProperty(p,r):null}getSchema(p){return this.style.getSchema(p)}setSchema(p,r){return this.style.setSchema(p,r),this._update(!0)}getConfig(p){return this.style.getConfig(p)}setConfig(p,r){return this.style.setConfig(p,r),this._update(!0)}getConfigProperty(p,r){return this.style.getConfigProperty(p,r)}setConfigProperty(p,r,l){return this.style.setConfigProperty(p,r,l),this._update(!0)}getFeaturesetDescriptors(p){return this.style.getFeaturesetDescriptors(p)}setLights(p){if(this._lazyInitEmptyStyle(),p&&p.length===1&&p[0].type==="flat"){const r=p[0];r.properties?this.style.setFlatLight(r.properties,r.id,{}):this.style.setFlatLight({},"flat")}else this.style.setLights(p),this.painter.terrain&&(this.painter.terrain.invalidateRenderCache=!0);return this._update(!0)}getLights(){const p=this.style.getLights()||[];return p.length===0&&p.push({id:this.style.light.id,type:"flat",properties:this.style.getFlatLight()}),p}setLight(p,r={}){return console.log("The `map.setLight` function is deprecated, prefer using `map.setLights` with `flat` light type instead."),this.setLights([{id:"flat",type:"flat",properties:p}])}getLight(){return console.log("The `map.getLight` function is deprecated, prefer using `map.getLights` instead."),this.style.getFlatLight()}setTerrain(p){return this._lazyInitEmptyStyle(),!p&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(p),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(p){return this._lazyInitEmptyStyle(),this.style.setFog(p),this._update(!0)}getFog(){return this.style?this.style.getFog():null}setSnow(p){return this._lazyInitEmptyStyle(),this.style.setSnow(p),this._update(!0)}getSnow(){return this.style?this.style.getSnow():null}setRain(p){return this._lazyInitEmptyStyle(),this.style.setRain(p),this._update(!0)}getRain(){return this.style?this.style.getRain():null}setColorTheme(p){return this._lazyInitEmptyStyle(),this.style.setColorTheme(p),this._update(!0)}setImportColorTheme(p,r){return this._lazyInitEmptyStyle(),this.style.setImportColorTheme(p,r),this._update(!0)}setCamera(p){return this.style.setCamera(p),this._triggerCameraUpdate(p)}_triggerCameraUpdate(p){return this._update(this.transform.setOrthographicProjectionAtLowPitch(p["camera-projection"]==="orthographic"))}getCamera(){return this.style.camera}_queryFogOpacity(p){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(i.bO.convert(p),this.transform):0}setFeatureState(p,r){return p.source&&!this._isValidId(p.source)?this:(this.style.setFeatureState(p,r),this._update())}removeFeatureState(p,r){return p.source&&!this._isValidId(p.source)?this:(this.style.removeFeatureState(p,r),this._update())}getFeatureState(p){return p.source&&!this._isValidId(p.source)?null:this.style.getFeatureState(p)}_updateContainerDimensions(){if(!this._container)return;const p=this._container.getBoundingClientRect().width||400,r=this._container.getBoundingClientRect().height||300;let l,m,x,b=this._container;for(;b&&(!m||!x);){const A=window.getComputedStyle(b).transform;A&&A!=="none"&&(l=A.match(/matrix.*\((.+)\)/)[1].split(", "),l[0]&&l[0]!=="0"&&l[0]!=="1"&&(m=l[0]),l[3]&&l[3]!=="0"&&l[3]!=="1"&&(x=l[3])),b=b.parentElement}this._containerWidth=m?Math.abs(p/m):p,this._containerHeight=x?Math.abs(r/x):r}_detectMissingCSS(){window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&i.w("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const p=this._container;p.classList.add("mapboxgl-map"),(this._missingCSSCanary=K("div","mapboxgl-canary",p)).style.visibility="hidden",this._detectMissingCSS();const r=this._canvasContainer=K("div","mapboxgl-canvas-container",p);this._canvas=K("canvas","mapboxgl-canvas",r),this._interactive&&(r.classList.add("mapboxgl-interactive"),this._canvas.setAttribute("tabindex","0")),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const l=this._controlContainer=K("div","mapboxgl-control-container",p),m=this._controlPositions={};["top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"].forEach(x=>{m[x]=K("div",`mapboxgl-ctrl-${x}`,l)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(p,r){const l=i.q.devicePixelRatio||1;this._canvas.width=l*Math.ceil(p),this._canvas.height=l*Math.ceil(r),this._canvas.style.width=`${p}px`,this._canvas.style.height=`${r}px`}_addMarker(p){this._markers.push(p)}_removeMarker(p){const r=this._markers.indexOf(p);r!==-1&&this._markers.splice(r,1)}_addPopup(p){this._popups.push(p)}_removePopup(p){const r=this._popups.indexOf(p);r!==-1&&this._popups.splice(r,1)}_setupPainter(){const p=i.l({},X.supported.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),r=this._canvas.getContext("webgl2",p);r?(fn(r,!0),this.painter=new fp(r,this._contextCreateOptions,this.transform,this._scaleFactor,this._tp),this.on("data",l=>{l.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),i.m.testSupport(r)):this.fire(new i.y(new Error("Failed to initialize WebGL")))}_contextLost(p){p.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new i.z("webglcontextlost",{originalEvent:p}))}_contextRestored(p){this._setupPainter(),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight)),this._updateTerrain(),this.style.reloadModels(),this.style.clearSources(),this._update(),this.fire(new i.z("webglcontextrestored",{originalEvent:p}))}_onMapScroll(p){if(p.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}idle(){return!this.isMoving()&&this.loaded()}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}frameReady(){return this.loaded()&&!this._placementDirty}_update(p){return this.style?(this._styleDirty=this._styleDirty||p,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(p){return this._update(),this._renderTaskQueue.add(p)}_cancelRenderFrame(p){this._renderTaskQueue.remove(p)}_requestDomTask(p){!this.loaded()||this.loaded()&&!this.isMoving()?p():this._domRenderTaskQueue.add(p)}_render(p){let r;this.fire(new i.z("renderstart")),++this._frameId;const l=this.painter.context.extTimerQuery,m=i.q.now(),x=this.painter.context.gl;if(this.listens("gpu-timing-frame")&&(r=x.createQuery(),x.beginQuery(l.TIME_ELAPSED_EXT,r)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],performance.now())),this._renderTaskQueue.run(p),this._domRenderTaskQueue.run(p),this._removed)return;this._updateProjectionTransition();const b=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const U=this.transform.zoom,$=this.transform.pitch,Z=i.q.now(),W=new i.a8(U,{now:Z,fadeDuration:b,pitch:$,transition:this.style.transition});this.style.update(W)}this.style&&this.style.hasFogTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let A=!1;this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),A=this._updateAverageElevation(m),this.style.updateSources(this.transform),this._forceMarkerAndPopupUpdate()):A=this._updateAverageElevation(m);const R=this.style&&this.style._updatePlacement(this.painter,this.painter.transform,this.showCollisionBoxes,b,this._crossSourceCollisions,this.painter.replacementSource,this._scaleFactorChanged);if(this._scaleFactorChanged&&(this._scaleFactorChanged=!1),R&&(this._placementDirty=R.needsRerender),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showParseStatus:this.showParseStatus,wireframe:{terrain:this.showTerrainWireframe,layers2D:this.showLayers2DWireframe,layers3D:this.showLayers3DWireframe},showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:b,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new i.z("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,j.mark(z.load),this.fire(new i.z("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&(this.style.snow||this.style.rain)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),r){const U=i.q.now()-m;x.endQuery(l.TIME_ELAPSED_EXT),setTimeout(()=>{const $=x.getQueryParameter(r,x.QUERY_RESULT)/1e6;x.deleteQuery(r),this.fire(new i.z("gpu-timing-frame",{cpuTime:U,gpuTime:$}))},50)}if(this.listens("gpu-timing-layer")){const U=this.painter.collectGpuTimers();setTimeout(()=>{const $=this.painter.queryGpuTimers(U);this.fire(new i.z("gpu-timing-layer",{layerTimes:$}))},50)}if(this.listens("gpu-timing-deferred-render")){const U=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const $=this.painter.queryGpuTimeDeferredRender(U);this.fire(new i.z("gpu-timing-deferred-render",{gpuTime:$}))},50)}const N=this._sourcesDirty||this._styleDirty||this._placementDirty||A;if(N||this._repaint)this.triggerRepaint();else{const U=this.idle();if(U&&(A=this._updateAverageElevation(m,!0)),A)this.triggerRepaint();else if(this._triggerFrame(!1),U&&(this.fire(new i.z("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const $=this._calculateSpeedIndex();this.fire(new i.z("speedindexcompleted",{speedIndex:$})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||N||(this._fullyLoaded=!0,j.mark(z.fullLoad),this._performanceMetricsCollection&&ir(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(p){for(const r of this._markers)p&&!this.getRenderWorldCopies()&&(r._lngLat=r._lngLat.wrap()),r._update();for(const r of this._popups)!p||this.getRenderWorldCopies()||r._trackPointer||(r._lngLat=r._lngLat.wrap()),r._update()}_updateAverageElevation(p,r=!1){const l=x=>(this.transform.averageElevation=x,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&l(0);const m=this.transform.elevation&&this.transform.elevation.exaggeration()!==this._averageElevationExaggeration;if(m||(r||p-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(p)){const x=this.transform.averageElevation;let b=this.transform.sampleAverageElevation();this.transform.elevation!=null&&(this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(b)?b=0:this._averageElevationLastSampledAt=p;const A=Math.abs(x-b);if(A>1){if(this._isInitialLoad||m)return this._averageElevation.jumpTo(b),l(b);this._averageElevation.easeTo(b,p,300)}else if(A>1e-4)return this._averageElevation.jumpTo(b),l(b)}return!!this._averageElevation.isEasing(p)&&l(this._averageElevation.getValue(p))}_authenticate(){Ne(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,p=>{if(p&&(p.message===gt||p.status===401)){const r=this.painter.context.gl;fn(r,!1),this._logoControl instanceof Ga&&this._logoControl._updateLogo(),r&&r.clear(r.DEPTH_BUFFER_BIT|r.COLOR_BUFFER_BIT|r.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new i.y(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),xn(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_postStyleLoadEvent(){this.style.globalId&&Xn(this._requestManager._customAccessToken,{map:this,skuToken:this._requestManager._skuToken,style:this.style.globalId,importedStyles:this.style.getImportGlobalIds()})}_updateTerrain(){const p=this._isDragging();this.painter.updateTerrain(this.style,p)}_calculateSpeedIndex(){const p=this.painter.canvasCopy(),r=this.painter.getCanvasCopiesAndTimestamps();r.timeStamps.push(performance.now());const l=this.painter.context.gl,m=l.createFramebuffer();function x(b){l.framebufferTexture2D(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0,l.TEXTURE_2D,b,0);const A=new Uint8Array(l.drawingBufferWidth*l.drawingBufferHeight*4);return l.readPixels(0,0,l.drawingBufferWidth,l.drawingBufferHeight,l.RGBA,l.UNSIGNED_BYTE,A),A}return l.bindFramebuffer(l.FRAMEBUFFER,m),this._canvasPixelComparison(x(p),r.canvasCopies.map(x),r.timeStamps)}_canvasPixelComparison(p,r,l){let m=l[1]-l[0];const x=p.length/4;for(let b=0;b<r.length;b++){const A=r[b];let R=0;for(let N=0;N<A.length;N+=4)A[N]===p[N]&&A[N+1]===p[N+1]&&A[N+2]===p[N+2]&&A[N+3]===p[N+3]&&(R+=1);m+=(l[b+2]-l[b+1])*(1-R/x)}return m}remove(){this._hash&&this._hash.remove();for(const r of this._controls)r.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.indoor.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),window.removeEventListener("resize",this._onWindowResize,!1),window.removeEventListener("orientationchange",this._onWindowResize,!1),window.removeEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.removeEventListener("online",this._onWindowOnline,!1),window.removeEventListener("visibilitychange",this._onVisibilityChange,!1);const p=this.painter.context.gl.getExtension("WEBGL_lose_context");p&&p.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),Qn.delete(this.painter.context.gl),yn.remove(),Nt.remove(),this._removed=!0,this.fire(new i.z("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(p){this._renderNextFrame=this._renderNextFrame||p,this.style&&!this._frame&&(this._frame=i.q.frame(r=>{const l=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,l&&this._render(r)}))}_preloadTiles(p){const r=this.style?this.style.getSourceCaches():[];return i.bl(r,(l,m)=>l._preloadTiles(p,m),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(p){this._trackResize&&this.resize({originalEvent:p})._update()}_onVisibilityChange(){document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(p){this._showTileBoundaries!==p&&(this._showTileBoundaries=p,this._tp.refreshUI(),this._update())}get showParseStatus(){return!!this._showParseStatus}set showParseStatus(p){this._showParseStatus!==p&&(this._showParseStatus=p,this._tp.refreshUI(),this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(p){this._showTerrainWireframe!==p&&(this._showTerrainWireframe=p,this._tp.refreshUI(),this._update())}get showLayers2DWireframe(){return!!this._showLayers2DWireframe}set showLayers2DWireframe(p){this._showLayers2DWireframe!==p&&(this._showLayers2DWireframe=p,this._tp.refreshUI(),this._update())}get showLayers3DWireframe(){return!!this._showLayers3DWireframe}set showLayers3DWireframe(p){this._showLayers3DWireframe!==p&&(this._showLayers3DWireframe=p,this._tp.refreshUI(),this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(p){this._speedIndexTiming!==p&&(this._speedIndexTiming=p,this._update())}get showPadding(){return!!this._showPadding}set showPadding(p){this._showPadding!==p&&(this._showPadding=p,this._tp.refreshUI(),this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(p){this._showCollisionBoxes!==p&&(this._showCollisionBoxes=p,this._tp.refreshUI(),p?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(p){this._showOverdrawInspector!==p&&(this._showOverdrawInspector=p,this._tp.refreshUI(),this._update())}get repaint(){return!!this._repaint}set repaint(p){this._repaint!==p&&(this._repaint=p,this._tp.refreshUI(),this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(p){this._vertices=p,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(p){this._showTileAABBs!==p&&(this._showTileAABBs=p,this._tp.refreshUI(),p&&this._update())}_setCacheLimits(p,r){i.dG(p,r)}get version(){return O}},NavigationControl:class{constructor(p={}){this.options=i.l({},Pu,p),this._container=K("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",r=>r.preventDefault()),this.options.showZoom&&(i.aP(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",r=>{this._map&&this._map.zoomIn({},{originalEvent:r})}),K("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",r=>{this._map&&this._map.zoomOut({},{originalEvent:r})}),K("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(i.aP(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",r=>{const l=this._map;l&&(this.options.visualizePitch?l.resetNorthPitch({},{originalEvent:r}):l.resetNorth({},{originalEvent:r}))}),this._compassIcon=K("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const p=this._map;if(!p)return;const r=p.getZoom(),l=r===p.getMaxZoom(),m=r===p.getMinZoom();this._zoomInButton.disabled=l,this._zoomOutButton.disabled=m,this._zoomInButton.setAttribute("aria-disabled",l.toString()),this._zoomOutButton.setAttribute("aria-disabled",m.toString())}_rotateCompassArrow(){const p=this._map;if(!p)return;const r=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(p.transform.pitch*(Math.PI/180)),.5)}) rotateX(${p.transform.pitch}deg) rotateZ(${p.transform.angle*(180/Math.PI)}deg)`:`rotate(${p.transform.angle*(180/Math.PI)}deg)`;p._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=r)})}onAdd(p){return this._map=p,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),p.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&p.on("pitch",this._rotateCompassArrow),p.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new qo(p,this._compass,this.options.visualizePitch)),this._container}onRemove(){const p=this._map;p&&(this._container.remove(),this.options.showZoom&&p.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&p.off("pitch",this._rotateCompassArrow),p.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(p,r){const l=K("button",p,this._container);return l.type="button",l.addEventListener("click",r),l}_setButtonTitle(p,r){if(!this._map)return;const l=this._map._getUIString(`NavigationControl.${r}`);p.setAttribute("aria-label",l),p.firstElementChild&&p.firstElementChild.setAttribute("title",l)}},GeolocateControl:class extends i.E{constructor(p={}){super();const r=navigator.geolocation;this.options=i.l({geolocation:r},za,p),i.aP(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=$f(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(p){return this._map=p,this._container=K("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(p){const r=(l=!!this.options.geolocation)=>{this._supportsGeolocation=l,p(l)};this._supportsGeolocation!==void 0?p(this._supportsGeolocation):navigator.permissions!==void 0?navigator.permissions.query({name:"geolocation"}).then(l=>r(l.state!=="denied")).catch(()=>r()):r()}_isOutOfMapMaxBounds(p){const r=this._map.getMaxBounds(),l=p.coords;return!!r&&(l.longitude<r.getWest()||l.longitude>r.getEast()||l.latitude<r.getSouth()||l.latitude>r.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(p){if(this._map){if(this._isOutOfMapMaxBounds(p))return this._setErrorState(),this.fire(new i.z("outofmaxbounds",p)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=p,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(p),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(p),this.options.showUserLocation&&this._userLocationDotMarker.removeClassName("mapboxgl-user-location-dot-stale"),this.fire(new i.z("geolocate",p)),this._finish()}}_updateCamera(p){const r=new i.bO(p.coords.longitude,p.coords.latitude),l=p.coords.accuracy,m=this._map.getBearing(),x=i.l({bearing:m},this.options.fitBoundsOptions);this._map.fitBounds(r.toBounds(l),x,{geolocateSource:!0})}_updateMarker(p){if(p){const r=new i.bO(p.coords.longitude,p.coords.latitude);this._accuracyCircleMarker.setLngLat(r).addTo(this._map),this._userLocationDotMarker.setLngLat(r).addTo(this._map),this._accuracy=p.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const p=this._map.transform,r=i.bH(1,p._center.lat)*p.worldSize,l=Math.ceil(2*this._accuracy*r);this._circleElement.style.width=`${l}px`,this._circleElement.style.height=`${l}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._userLocationDotMarker.addClassName("mapboxgl-user-location-show-heading")):(this._userLocationDotMarker.removeClassName("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(p){if(this._map){if(this.options.trackUserLocation)if(p.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",r),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",r),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(p.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._userLocationDotMarker.addClassName("mapboxgl-user-location-dot-stale"),this.fire(new i.z("error",p)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(p){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",r=>r.preventDefault()),this._geolocateButton=K("button","mapboxgl-ctrl-geolocate",this._container),K("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",p===!1){i.w("Geolocation support is not available so the GeolocateControl will be disabled.");const r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",r),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",r)}else{const r=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",r),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",r)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=K("div","mapboxgl-user-location"),this._dotElement.appendChild(K("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(K("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new ys({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=K("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new ys({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",r=>{r.geolocateSource||this._watchState!=="ACTIVE_LOCK"||r.originalEvent&&r.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new i.z("trackuserlocationend")))})}}_onDeviceOrientation(p){this._userLocationDotMarker&&(p.webkitCompassHeading?this._heading=p.webkitCompassHeading:p.absolute===!0&&(this._heading=-1*p.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return i.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new i.z("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new i.z("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new i.z("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let p;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(p={maximumAge:6e5,timeout:0},this._noTimeout=!0):(p=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,p),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=window.setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const p=()=>{"ondeviceorientationabsolute"in window?window.addEventListener("deviceorientationabsolute",this._onDeviceOrientation):window.addEventListener("deviceorientation",this._onDeviceOrientation)};typeof DeviceMotionEvent<"u"&&typeof DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(r=>{r==="granted"&&p()}).catch(console.error):p()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),window.removeEventListener("deviceorientation",this._onDeviceOrientation),window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:zh,ScaleControl:class{constructor(p={}){this.options=i.l({},Ja,p),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),i.aP(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const p=this.options.maxWidth||100,r=this._map,l=r._containerHeight/2,m=r._containerWidth/2-p/2,x=r.unproject([m,l]),b=r.unproject([m+p,l]),A=x.distanceTo(b);if(this.options.unit==="imperial"){const R=3.2808*A;R>5280?this._setScale(p,R/5280,"mile"):this._setScale(p,R,"foot")}else this.options.unit==="nautical"?this._setScale(p,A/1852,"nautical-mile"):A>=1e3?this._setScale(p,A/1e3,"kilometer"):this._setScale(p,A,"meter")}_setScale(p,r,l){this._map._requestDomTask(()=>{const m=function(b){const A=Math.pow(10,`${Math.floor(b)}`.length-1);let R=b/A;return R=R>=10?10:R>=5?5:R>=3?3:R>=2?2:R>=1?1:function(N){const U=Math.pow(10,Math.ceil(-Math.log(N)/Math.LN10));return Math.round(N*U)/U}(R),A*R}(r),x=m/r;this._container.innerHTML=this._isNumberFormatSupported&&l!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:l}).format(m):`${m}&nbsp;${$i[l]}`,this._container.style.width=p*x+"px"})}onAdd(p){return this._map=p,this._language=p.getLanguage(),this._container=K("div","mapboxgl-ctrl mapboxgl-ctrl-scale",p.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(p){this._language=p,this._update()}setUnit(p){this.options.unit=p,this._update()}},FullscreenControl:class{constructor(p={}){this._fullscreen=!1,p&&p.container&&(p.container instanceof HTMLElement?this._container=p.container:i.w("Full screen control 'container' must be a DOM element.")),i.aP(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(p){return this._map=p,this._container||(this._container=this._map.getContainer()),this._controlContainer=K("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",i.w("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!document.fullscreenEnabled&&!document.webkitFullscreenEnabled)}_setupUI(){const p=this._fullscreenButton=K("button","mapboxgl-ctrl-fullscreen",this._controlContainer);K("span","mapboxgl-ctrl-icon",p).setAttribute("aria-hidden","true"),p.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const p=this._getTitle();this._fullscreenButton.setAttribute("aria-label",p),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",p)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(document.fullscreenElement||document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?document.exitFullscreen?document.exitFullscreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends i.E{constructor(p){super(),this.options=i.l(Object.create(ol),p),i.aP(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(p&&p.className?p.className.trim().split(/\s+/):[])}addTo(p){return this._map&&this.remove(),this._map=p,this.options.closeOnClick&&p.on("preclick",this._onClose),this.options.closeOnMove&&p.on("move",this._onClose),p.on("remove",this.remove),this._update(),p._addPopup(this),this._focusFirstElement(),this._trackPointer?(p.on("mousemove",this._onMouseEvent),p.on("mouseup",this._onMouseEvent),p._canvasContainer.classList.add("mapboxgl-track-pointer")):p.on("move",this._update),this.fire(new i.z("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const p=this._map;return p&&(p.off("move",this._update),p.off("move",this._onClose),p.off("preclick",this._onClose),p.off("click",this._onClose),p.off("remove",this.remove),p.off("mousemove",this._onMouseEvent),p.off("mouseup",this._onMouseEvent),p.off("drag",this._onMouseEvent),p._canvasContainer&&p._canvasContainer.classList.remove("mapboxgl-track-pointer"),p._removePopup(this),this._map=void 0),this.fire(new i.z("close")),this}getLngLat(){return this._lngLat}setLngLat(p){this._lngLat=i.bO.convert(p),this._pos=null,this._trackPointer=!1,this._update();const r=this._map;return r&&(r.on("move",this._update),r.off("mousemove",this._onMouseEvent),r._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const p=this._map;return p&&(p.off("move",this._update),p.on("mousemove",this._onMouseEvent),p.on("drag",this._onMouseEvent),p._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(p){return this.setDOMContent(document.createTextNode(p))}setHTML(p){const r=document.createDocumentFragment(),l=document.createElement("body");let m;for(l.innerHTML=p;m=l.firstChild,m;)r.appendChild(m);return this.setDOMContent(r)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(p){return this.options.maxWidth=p,this._update(),this}setDOMContent(p){let r=this._content;if(r)for(;r.hasChildNodes();)r.firstChild&&r.removeChild(r.firstChild);else r=this._content=K("div","mapboxgl-popup-content",this._container||void 0);if(r.appendChild(p),this.options.closeButton){const l=this._closeButton=K("button","mapboxgl-popup-close-button",r);l.type="button",l.setAttribute("aria-label","Close popup"),l.innerHTML='<span aria-hidden="true">&#215;</span>',l.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(p){return this._classList.add(p),this._updateClassList(),this}removeClassName(p){return this._classList.delete(p),this._updateClassList(),this}setOffset(p){return this.options.offset=p,this._update(),this}toggleClassName(p){let r;return this._classList.delete(p)?r=!1:(this._classList.add(p),r=!0),this._updateClassList(),r}_onMouseEvent(p){this._update(p.point)}_getAnchor(p){if(this.options.anchor)return this.options.anchor;const r=this._map,l=this._container,m=this._pos;if(!r||!l||!m)return"bottom";const x=l.offsetWidth,b=l.offsetHeight,A=m.x<x/2,R=m.x>r.transform.width-x/2;if(m.y+p<b)return A?"top-left":R?"top-right":"top";if(m.y>r.transform.height-b){if(A)return"bottom-left";if(R)return"bottom-right"}return A?"left":R?"right":"bottom"}_updateClassList(){const p=this._container;if(!p)return;const r=[...this._classList];r.push("mapboxgl-popup"),this._anchor&&r.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&r.push("mapboxgl-popup-track-pointer"),p.className=r.join(" ")}_update(p){const r=this._map,l=this._content;if(!r||!this._lngLat&&!this._trackPointer||!l)return;let m=this._container;if(m||(m=this._container=K("div","mapboxgl-popup",r.getContainer()),this._tip=K("div","mapboxgl-popup-tip",m),m.appendChild(l)),this.options.maxWidth&&m.style.maxWidth!==this.options.maxWidth&&(m.style.maxWidth=this.options.maxWidth),r.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Xf(this._lngLat,this._pos,r.transform)),!this._trackPointer||p){const x=this._pos=this._trackPointer&&p instanceof i.P?p:r.project(this._lngLat),b=Yf(this.options.offset),A=this._anchor=this._getAnchor(b.y),R=Yf(this.options.offset,A),N=x.add(R).round();r._requestDomTask(()=>{this._container&&A&&(this._container.style.transform=`${js[A]} translate(${N.x}px,${N.y}px)`)})}if(!this._marker&&r._showingGlobe()){const x=i.dH(r.transform,this._lngLat)?0:1;this._setOpacity(x)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const p=this._container.querySelector(Br);p&&p.focus()}_onClose(){this.remove()}_setOpacity(p){this._container&&(this._container.style.opacity=`${p}`),this._content&&(this._content.style.pointerEvents=p?"auto":"none")}},Marker:ys,Style:Ia,LngLat:i.bO,LngLatBounds:i.az,Point:i.P,MercatorCoordinate:i.aa,FreeCameraOptions:wf,Evented:i.E,config:i.e,prewarm:i.dM,clearPrewarmedResources:i.dN,get accessToken(){return i.e.ACCESS_TOKEN},set accessToken(p){i.e.ACCESS_TOKEN=p},get baseApiUrl(){return i.e.API_URL},set baseApiUrl(p){i.e.API_URL=p},get workerCount(){return i.dO.workerCount},set workerCount(p){i.dO.workerCount=p},get maxParallelImageRequests(){return i.e.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(p){i.e.MAX_PARALLEL_IMAGE_REQUESTS=p},clearStorage(p){i.dP(p)},get workerUrl(){return i.dQ.workerUrl},set workerUrl(p){i.dQ.workerUrl=p},get workerClass(){return i.dQ.workerClass},set workerClass(p){i.dQ.workerClass=p},get workerParams(){return i.dQ.workerParams},set workerParams(p){i.dQ.workerParams=p},get dracoUrl(){return i.dR()},set dracoUrl(p){i.dS(p)},get meshoptUrl(){return i.dT()},set meshoptUrl(p){i.dU(p)},setNow:i.q.setNow,restoreNow:i.q.restoreNow}});var S=f;return S})}(Dx)),Dx.exports}var GF=r0e();const HF=Ei(GF),i0e=_8({__proto__:null,default:HF},[GF]),Hk=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],bC=1,pv=8;class j4{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[a,s]=new Uint8Array(t,0,2);if(a!==219)throw new Error("Data does not appear to be in a KDBush format.");const f=s>>4;if(f!==bC)throw new Error(`Got v${f} data when expected v${bC}.`);const v=Hk[s&15];if(!v)throw new Error("Unrecognized array type.");const[S]=new Uint16Array(t,2,1),[i]=new Uint32Array(t,4,1);return new j4(i,S,v,t)}constructor(t,a=64,s=Float64Array,f){if(isNaN(t)||t<0)throw new Error(`Unpexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+a,2),65535),this.ArrayType=s,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;const v=Hk.indexOf(this.ArrayType),S=t*2*this.ArrayType.BYTES_PER_ELEMENT,i=t*this.IndexArrayType.BYTES_PER_ELEMENT,O=(8-i%8)%8;if(v<0)throw new Error(`Unexpected typed array class: ${s}.`);f&&f instanceof ArrayBuffer?(this.data=f,this.ids=new this.IndexArrayType(this.data,pv,t),this.coords=new this.ArrayType(this.data,pv+i+O,t*2),this._pos=t*2,this._finished=!0):(this.data=new ArrayBuffer(pv+S+i+O),this.ids=new this.IndexArrayType(this.data,pv,t),this.coords=new this.ArrayType(this.data,pv+i+O,t*2),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,(bC<<4)+v]),new Uint16Array(this.data,2,1)[0]=a,new Uint32Array(this.data,4,1)[0]=t)}add(t,a){const s=this._pos>>1;return this.ids[s]=s,this.coords[this._pos++]=t,this.coords[this._pos++]=a,s}finish(){const t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return l5(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,a,s,f){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:v,coords:S,nodeSize:i}=this,O=[0,v.length-1,0],z=[];for(;O.length;){const j=O.pop()||0,F=O.pop()||0,G=O.pop()||0;if(F-G<=i){for(let ne=G;ne<=F;ne++){const se=S[2*ne],ge=S[2*ne+1];se>=t&&se<=s&&ge>=a&&ge<=f&&z.push(v[ne])}continue}const Y=G+F>>1,X=S[2*Y],K=S[2*Y+1];X>=t&&X<=s&&K>=a&&K<=f&&z.push(v[Y]),(j===0?t<=X:a<=K)&&(O.push(G),O.push(Y-1),O.push(1-j)),(j===0?s>=X:f>=K)&&(O.push(Y+1),O.push(F),O.push(1-j))}return z}within(t,a,s){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:f,coords:v,nodeSize:S}=this,i=[0,f.length-1,0],O=[],z=s*s;for(;i.length;){const j=i.pop()||0,F=i.pop()||0,G=i.pop()||0;if(F-G<=S){for(let ne=G;ne<=F;ne++)Zk(v[2*ne],v[2*ne+1],t,a)<=z&&O.push(f[ne]);continue}const Y=G+F>>1,X=v[2*Y],K=v[2*Y+1];Zk(X,K,t,a)<=z&&O.push(f[Y]),(j===0?t-s<=X:a-s<=K)&&(i.push(G),i.push(Y-1),i.push(1-j)),(j===0?t+s>=X:a+s>=K)&&(i.push(Y+1),i.push(F),i.push(1-j))}return O}}function l5(e,t,a,s,f,v){if(f-s<=a)return;const S=s+f>>1;ZF(e,t,S,s,f,v),l5(e,t,a,s,S-1,1-v),l5(e,t,a,S+1,f,1-v)}function ZF(e,t,a,s,f,v){for(;f>s;){if(f-s>600){const z=f-s+1,j=a-s+1,F=Math.log(z),G=.5*Math.exp(2*F/3),Y=.5*Math.sqrt(F*G*(z-G)/z)*(j-z/2<0?-1:1),X=Math.max(s,Math.floor(a-j*G/z+Y)),K=Math.min(f,Math.floor(a+(z-j)*G/z+Y));ZF(e,t,a,X,K,v)}const S=t[2*a+v];let i=s,O=f;for(mv(e,t,s,a),t[2*f+v]>S&&mv(e,t,s,f);i<O;){for(mv(e,t,i,O),i++,O--;t[2*i+v]<S;)i++;for(;t[2*O+v]>S;)O--}t[2*s+v]===S?mv(e,t,s,O):(O++,mv(e,t,O,f)),O<=a&&(s=O+1),a<=O&&(f=O-1)}}function mv(e,t,a,s){wC(e,a,s),wC(t,2*a,2*s),wC(t,2*a+1,2*s+1)}function wC(e,t,a){const s=e[t];e[t]=e[a],e[a]=s}function Zk(e,t,a,s){const f=e-a,v=t-s;return f*f+v*v}const a0e={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:e=>e},Wk=Math.fround||(e=>t=>(e[0]=+t,e[0]))(new Float32Array(1)),c0=2,Up=3,SC=4,Np=5,WF=6;class o0e{constructor(t){this.options=Object.assign(Object.create(a0e),t),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(t){const{log:a,minZoom:s,maxZoom:f}=this.options;a&&console.time("total time");const v=`prepare ${t.length} points`;a&&console.time(v),this.points=t;const S=[];for(let O=0;O<t.length;O++){const z=t[O];if(!z.geometry)continue;const[j,F]=z.geometry.coordinates,G=Wk(bx(j)),Y=Wk(wx(F));S.push(G,Y,1/0,O,-1,1),this.options.reduce&&S.push(0)}let i=this.trees[f+1]=this._createTree(S);a&&console.timeEnd(v);for(let O=f;O>=s;O--){const z=+Date.now();i=this.trees[O]=this._createTree(this._cluster(i,O)),a&&console.log("z%d: %d clusters in %dms",O,i.numItems,+Date.now()-z)}return a&&console.timeEnd("total time"),this}getClusters(t,a){let s=((t[0]+180)%360+360)%360-180;const f=Math.max(-90,Math.min(90,t[1]));let v=t[2]===180?180:((t[2]+180)%360+360)%360-180;const S=Math.max(-90,Math.min(90,t[3]));if(t[2]-t[0]>=360)s=-180,v=180;else if(s>v){const F=this.getClusters([s,f,180,S],a),G=this.getClusters([-180,f,v,S],a);return F.concat(G)}const i=this.trees[this._limitZoom(a)],O=i.range(bx(s),wx(S),bx(v),wx(f)),z=i.data,j=[];for(const F of O){const G=this.stride*F;j.push(z[G+Np]>1?Xk(z,G,this.clusterProps):this.points[z[G+Up]])}return j}getChildren(t){const a=this._getOriginId(t),s=this._getOriginZoom(t),f="No cluster with the specified id.",v=this.trees[s];if(!v)throw new Error(f);const S=v.data;if(a*this.stride>=S.length)throw new Error(f);const i=this.options.radius/(this.options.extent*Math.pow(2,s-1)),O=S[a*this.stride],z=S[a*this.stride+1],j=v.within(O,z,i),F=[];for(const G of j){const Y=G*this.stride;S[Y+SC]===t&&F.push(S[Y+Np]>1?Xk(S,Y,this.clusterProps):this.points[S[Y+Up]])}if(F.length===0)throw new Error(f);return F}getLeaves(t,a,s){a=a||10,s=s||0;const f=[];return this._appendLeaves(f,t,a,s,0),f}getTile(t,a,s){const f=this.trees[this._limitZoom(t)],v=Math.pow(2,t),{extent:S,radius:i}=this.options,O=i/S,z=(s-O)/v,j=(s+1+O)/v,F={features:[]};return this._addTileFeatures(f.range((a-O)/v,z,(a+1+O)/v,j),f.data,a,s,v,F),a===0&&this._addTileFeatures(f.range(1-O/v,z,1,j),f.data,v,s,v,F),a===v-1&&this._addTileFeatures(f.range(0,z,O/v,j),f.data,-1,s,v,F),F.features.length?F:null}getClusterExpansionZoom(t){let a=this._getOriginZoom(t)-1;for(;a<=this.options.maxZoom;){const s=this.getChildren(t);if(a++,s.length!==1)break;t=s[0].properties.cluster_id}return a}_appendLeaves(t,a,s,f,v){const S=this.getChildren(a);for(const i of S){const O=i.properties;if(O&&O.cluster?v+O.point_count<=f?v+=O.point_count:v=this._appendLeaves(t,O.cluster_id,s,f,v):v<f?v++:t.push(i),t.length===s)break}return v}_createTree(t){const a=new j4(t.length/this.stride|0,this.options.nodeSize,Float32Array);for(let s=0;s<t.length;s+=this.stride)a.add(t[s],t[s+1]);return a.finish(),a.data=t,a}_addTileFeatures(t,a,s,f,v,S){for(const i of t){const O=i*this.stride,z=a[O+Np]>1;let j,F,G;if(z)j=XF(a,O,this.clusterProps),F=a[O],G=a[O+1];else{const K=this.points[a[O+Up]];j=K.properties;const[ne,se]=K.geometry.coordinates;F=bx(ne),G=wx(se)}const Y={type:1,geometry:[[Math.round(this.options.extent*(F*v-s)),Math.round(this.options.extent*(G*v-f))]],tags:j};let X;z||this.options.generateId?X=a[O+Up]:X=this.points[a[O+Up]].id,X!==void 0&&(Y.id=X),S.features.push(Y)}}_limitZoom(t){return Math.max(this.options.minZoom,Math.min(Math.floor(+t),this.options.maxZoom+1))}_cluster(t,a){const{radius:s,extent:f,reduce:v,minPoints:S}=this.options,i=s/(f*Math.pow(2,a)),O=t.data,z=[],j=this.stride;for(let F=0;F<O.length;F+=j){if(O[F+c0]<=a)continue;O[F+c0]=a;const G=O[F],Y=O[F+1],X=t.within(O[F],O[F+1],i),K=O[F+Np];let ne=K;for(const se of X){const ge=se*j;O[ge+c0]>a&&(ne+=O[ge+Np])}if(ne>K&&ne>=S){let se=G*K,ge=Y*K,_e,xe=-1;const ae=((F/j|0)<<5)+(a+1)+this.points.length;for(const ve of X){const Se=ve*j;if(O[Se+c0]<=a)continue;O[Se+c0]=a;const He=O[Se+Np];se+=O[Se]*He,ge+=O[Se+1]*He,O[Se+SC]=ae,v&&(_e||(_e=this._map(O,F,!0),xe=this.clusterProps.length,this.clusterProps.push(_e)),v(_e,this._map(O,Se)))}O[F+SC]=ae,z.push(se/ne,ge/ne,1/0,ae,-1,ne),v&&z.push(xe)}else{for(let se=0;se<j;se++)z.push(O[F+se]);if(ne>1)for(const se of X){const ge=se*j;if(!(O[ge+c0]<=a)){O[ge+c0]=a;for(let _e=0;_e<j;_e++)z.push(O[ge+_e])}}}}return z}_getOriginId(t){return t-this.points.length>>5}_getOriginZoom(t){return(t-this.points.length)%32}_map(t,a,s){if(t[a+Np]>1){const S=this.clusterProps[t[a+WF]];return s?Object.assign({},S):S}const f=this.points[t[a+Up]].properties,v=this.options.map(f);return s&&v===f?Object.assign({},v):v}}function Xk(e,t,a){return{type:"Feature",id:e[t+Up],properties:XF(e,t,a),geometry:{type:"Point",coordinates:[s0e(e[t]),l0e(e[t+1])]}}}function XF(e,t,a){const s=e[t+Np],f=s>=1e4?`${Math.round(s/1e3)}k`:s>=1e3?`${Math.round(s/100)/10}k`:s,v=e[t+WF],S=v===-1?{}:Object.assign({},a[v]);return Object.assign(S,{cluster:!0,cluster_id:e[t+Up],point_count:s,point_count_abbreviated:f})}function bx(e){return e/360+.5}function wx(e){const t=Math.sin(e*Math.PI/180),a=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return a<0?0:a>1?1:a}function s0e(e){return(e-.5)*360}function l0e(e){const t=(180-e*360)*Math.PI/180;return 360*Math.atan(Math.exp(t))/Math.PI-90}const c0e="_map_ql5b8_1",u0e="_map__loading_ql5b8_11",h0e="_map__popUp_ql5b8_15",f0e="_map__coordinates_ql5b8_20",d0e="_popUp__container_ql5b8_26",_v={map:c0e,map__loading:u0e,map__popUp:h0e,map__coordinates:f0e,popUp__container:d0e},p0e=e=>({type:"Feature",geometry:{type:"Point",coordinates:e}}),m0e="_marker_c74k7_1",_0e="_marker__text_c74k7_29",Yk={marker:m0e,marker__text:_0e};function g0e(e){return he.jsx("div",{className:Yk.marker,onClick:()=>{e.onClick&&e.onClick()},children:he.jsx("a",{className:Yk.marker__text,children:e.count})})}const y0e="_coordinates_1x0ss_1",v0e="_coordinates__text_1x0ss_15",TC={coordinates:y0e,coordinates__text:v0e};function x0e(e){return he.jsxs("div",{className:TC.coordinates,children:[he.jsx("a",{className:TC.coordinates__text,children:e.latitude.substring(0,10)}),he.jsx("a",{className:TC.coordinates__text,children:e.longitude.substring(0,10)})]})}const b0e=16,Kk=4,EC=50,AC=55,w0e=74,S0e="modulepreload",T0e=function(e){return"/"+e},Jk={},E0e=function(t,a,s){let f=Promise.resolve();if(a&&a.length>0){document.getElementsByTagName("link");const S=document.querySelector("meta[property=csp-nonce]"),i=(S==null?void 0:S.nonce)||(S==null?void 0:S.getAttribute("nonce"));f=Promise.allSettled(a.map(O=>{if(O=T0e(O),O in Jk)return;Jk[O]=!0;const z=O.endsWith(".css"),j=z?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${O}"]${j}`))return;const F=document.createElement("link");if(F.rel=z?"stylesheet":S0e,z||(F.as="script"),F.crossOrigin="",F.href=O,i&&F.setAttribute("nonce",i),document.head.appendChild(F),z)return new Promise((G,Y)=>{F.addEventListener("load",G),F.addEventListener("error",()=>Y(new Error(`Unable to preload CSS for ${O}`)))})}))}function v(S){const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=S,window.dispatchEvent(i),!i.defaultPrevented)throw S}return f.then(S=>{for(const i of S||[])i.status==="rejected"&&v(i.reason);return t().catch(v)})},A0e=Me.createContext(null);function C0e(e,t){const a=Array.isArray(e)?e[0]:e?e.x:0,s=Array.isArray(e)?e[1]:e?e.y:0,f=Array.isArray(t)?t[0]:t?t.x:0,v=Array.isArray(t)?t[1]:t?t.y:0;return a===f&&s===v}function _d(e,t){if(e===t)return!0;if(!e||!t)return!1;if(Array.isArray(e)){if(!Array.isArray(t)||e.length!==t.length)return!1;for(let a=0;a<e.length;a++)if(!_d(e[a],t[a]))return!1;return!0}else if(Array.isArray(t))return!1;if(typeof e=="object"&&typeof t=="object"){const a=Object.keys(e),s=Object.keys(t);if(a.length!==s.length)return!1;for(const f of a)if(!t.hasOwnProperty(f)||!_d(e[f],t[f]))return!1;return!0}return!1}function M0e(e){const t=e.clone();return t.pixelsToGLUnits=e.pixelsToGLUnits,t}function Qk(e,t){if(!e.getProjection)return;const a=e.getProjection(),s=t.getProjection();_d(a,s)||t.setProjection(a)}function e8(e){return{longitude:e.center.lng,latitude:e.center.lat,zoom:e.zoom,pitch:e.pitch,bearing:e.bearing,padding:e.padding}}function t8(e,t){const a=t.viewState||t;let s=!1;if("zoom"in a){const f=e.zoom;e.zoom=a.zoom,s=s||f!==e.zoom}if("bearing"in a){const f=e.bearing;e.bearing=a.bearing,s=s||f!==e.bearing}if("pitch"in a){const f=e.pitch;e.pitch=a.pitch,s=s||f!==e.pitch}if(a.padding&&!e.isPaddingEqual(a.padding)&&(s=!0,e.padding=a.padding),"longitude"in a&&"latitude"in a){const f=e.center;e.center=new f.constructor(a.longitude,a.latitude),s=s||f!==e.center}return s}const O0e=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function n8(e){if(!e)return null;if(typeof e=="string"||("toJS"in e&&(e=e.toJS()),!e.layers))return e;const t={};for(const s of e.layers)t[s.id]=s;const a=e.layers.map(s=>{let f=null;"interactive"in s&&(f=Object.assign({},s),delete f.interactive);const v=t[s.ref];if(v){f=f||Object.assign({},s),delete f.ref;for(const S of O0e)S in v&&(f[S]=v[S])}return f||s});return{...e,layers:a}}var r8={};const i8={version:8,sources:{},layers:[]},a8={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},CC={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},o8={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},I0e=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],P0e=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class zg{constructor(t,a,s){this._map=null,this._internalUpdate=!1,this._inRender=!1,this._hoveredFeatures=null,this._deferredEvents={move:!1,zoom:!1,pitch:!1,rotate:!1},this._onEvent=f=>{const v=this.props[o8[f.type]];v?v(f):f.type==="error"&&console.error(f.error)},this._onPointerEvent=f=>{(f.type==="mousemove"||f.type==="mouseout")&&this._updateHover(f);const v=this.props[a8[f.type]];v&&(this.props.interactiveLayerIds&&f.type!=="mouseover"&&f.type!=="mouseout"&&(f.features=this._hoveredFeatures||this._queryRenderedFeatures(f.point)),v(f),delete f.features)},this._onCameraEvent=f=>{if(!this._internalUpdate){const v=this.props[CC[f.type]];v&&v(f)}f.type in this._deferredEvents&&(this._deferredEvents[f.type]=!1)},this._MapClass=t,this.props=a,this._initialize(s)}get map(){return this._map}get transform(){return this._renderTransform}setProps(t){const a=this.props;this.props=t;const s=this._updateSettings(t,a);s&&this._createShadowTransform(this._map);const f=this._updateSize(t),v=this._updateViewState(t,!0);this._updateStyle(t,a),this._updateStyleComponents(t,a),this._updateHandlers(t,a),(s||f||v&&!this._map.isMoving())&&this.redraw()}static reuse(t,a){const s=zg.savedMaps.pop();if(!s)return null;const f=s.map,v=f.getContainer();for(a.className=v.className;v.childNodes.length>0;)a.appendChild(v.childNodes[0]);f._container=a,s.setProps({...t,styleDiffing:!1}),f.resize();const{initialViewState:S}=t;return S&&(S.bounds?f.fitBounds(S.bounds,{...S.fitBoundsOptions,duration:0}):s._updateViewState(S,!1)),f.isStyleLoaded()?f.fire("load"):f.once("styledata",()=>f.fire("load")),f._update(),s}_initialize(t){const{props:a}=this,{mapStyle:s=i8}=a,f={...a,...a.initialViewState,accessToken:a.mapboxAccessToken||R0e()||null,container:t,style:n8(s)},v=f.initialViewState||f.viewState||f;if(Object.assign(f,{center:[v.longitude||0,v.latitude||0],zoom:v.zoom||0,pitch:v.pitch||0,bearing:v.bearing||0}),a.gl){const j=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=j,a.gl)}const S=new this._MapClass(f);v.padding&&S.setPadding(v.padding),a.cursor&&(S.getCanvas().style.cursor=a.cursor),this._createShadowTransform(S);const i=S._render;S._render=j=>{this._inRender=!0,i.call(S,j),this._inRender=!1};const O=S._renderTaskQueue.run;S._renderTaskQueue.run=j=>{O.call(S._renderTaskQueue,j),this._onBeforeRepaint()},S.on("render",()=>this._onAfterRepaint());const z=S.fire;S.fire=this._fireEvent.bind(this,z),S.on("resize",()=>{this._renderTransform.resize(S.transform.width,S.transform.height)}),S.on("styledata",()=>{this._updateStyleComponents(this.props,{}),Qk(S.transform,this._renderTransform)}),S.on("sourcedata",()=>this._updateStyleComponents(this.props,{}));for(const j in a8)S.on(j,this._onPointerEvent);for(const j in CC)S.on(j,this._onCameraEvent);for(const j in o8)S.on(j,this._onEvent);this._map=S}recycle(){const a=this.map.getContainer().querySelector("[mapboxgl-children]");a==null||a.remove(),zg.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){const t=this._map;!this._inRender&&t.style&&(t._frame&&(t._frame.cancel(),t._frame=null),t._render())}_createShadowTransform(t){const a=M0e(t.transform);t.painter.transform=a,this._renderTransform=a}_updateSize(t){const{viewState:a}=t;if(a){const s=this._map;if(a.width!==s.transform.width||a.height!==s.transform.height)return s.resize(),!0}return!1}_updateViewState(t,a){if(this._internalUpdate)return!1;const s=this._map,f=this._renderTransform,{zoom:v,pitch:S,bearing:i}=f,O=s.isMoving();O&&(f.cameraElevationReference="sea");const z=t8(f,{...e8(s.transform),...t});if(O&&(f.cameraElevationReference="ground"),z&&a){const j=this._deferredEvents;j.move=!0,j.zoom||(j.zoom=v!==f.zoom),j.rotate||(j.rotate=i!==f.bearing),j.pitch||(j.pitch=S!==f.pitch)}return O||t8(s.transform,t),z}_updateSettings(t,a){const s=this._map;let f=!1;for(const v of I0e)if(v in t&&!_d(t[v],a[v])){f=!0;const S=s[`set${v[0].toUpperCase()}${v.slice(1)}`];S==null||S.call(s,t[v])}return f}_updateStyle(t,a){if(t.cursor!==a.cursor&&(this._map.getCanvas().style.cursor=t.cursor||""),t.mapStyle!==a.mapStyle){const{mapStyle:s=i8,styleDiffing:f=!0}=t,v={diff:f};return"localIdeographFontFamily"in t&&(v.localIdeographFontFamily=t.localIdeographFontFamily),this._map.setStyle(n8(s),v),!0}return!1}_updateStyleComponents(t,a){const s=this._map;let f=!1;return s.isStyleLoaded()&&("light"in t&&s.setLight&&!_d(t.light,a.light)&&(f=!0,s.setLight(t.light)),"fog"in t&&s.setFog&&!_d(t.fog,a.fog)&&(f=!0,s.setFog(t.fog)),"terrain"in t&&s.setTerrain&&!_d(t.terrain,a.terrain)&&(!t.terrain||s.getSource(t.terrain.source))&&(f=!0,s.setTerrain(t.terrain))),f}_updateHandlers(t,a){const s=this._map;let f=!1;for(const v of P0e){const S=t[v]??!0,i=a[v]??!0;_d(S,i)||(f=!0,S?s[v].enable(S):s[v].disable())}return f}_queryRenderedFeatures(t){const a=this._map,s=a.transform,{interactiveLayerIds:f=[]}=this.props;try{return a.transform=this._renderTransform,a.queryRenderedFeatures(t,{layers:f.filter(a.getLayer.bind(a))})}catch{return[]}finally{a.transform=s}}_updateHover(t){var f;const{props:a}=this;if(a.interactiveLayerIds&&(a.onMouseMove||a.onMouseEnter||a.onMouseLeave)){const v=t.type,S=((f=this._hoveredFeatures)==null?void 0:f.length)>0,i=this._queryRenderedFeatures(t.point),O=i.length>0;!O&&S&&(t.type="mouseleave",this._onPointerEvent(t)),this._hoveredFeatures=i,O&&!S&&(t.type="mouseenter",this._onPointerEvent(t)),t.type=v}else this._hoveredFeatures=null}_fireEvent(t,a,s){const f=this._map,v=f.transform,S=typeof a=="string"?a:a.type;return S==="move"&&this._updateViewState(this.props,!1),S in CC&&(typeof a=="object"&&(a.viewState=e8(v)),this._map.isMoving())?(f.transform=this._renderTransform,t.call(f,a,s),f.transform=v,f):(t.call(f,a,s),f)}_onBeforeRepaint(){const t=this._map;this._internalUpdate=!0;for(const s in this._deferredEvents)this._deferredEvents[s]&&t.fire(s);this._internalUpdate=!1;const a=this._map.transform;t.transform=this._renderTransform,this._onAfterRepaint=()=>{Qk(this._renderTransform,a),t.transform=a}}}zg.savedMaps=[];function R0e(){let e=null;if(typeof location<"u"){const t=/access_token=([^&\/]*)/.exec(location.search);e=t&&t[1]}try{e=e||r8.MapboxAccessToken}catch{}try{e=e||r8.REACT_APP_MAPBOX_ACCESS_TOKEN}catch{}return e}const D0e=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function L0e(e){if(!e)return null;const t=e.map,a={getMap:()=>t,getCenter:()=>e.transform.center,getZoom:()=>e.transform.zoom,getBearing:()=>e.transform.bearing,getPitch:()=>e.transform.pitch,getPadding:()=>e.transform.padding,getBounds:()=>e.transform.getBounds(),project:s=>{const f=t.transform;t.transform=e.transform;const v=t.project(s);return t.transform=f,v},unproject:s=>{const f=t.transform;t.transform=e.transform;const v=t.unproject(s);return t.transform=f,v},queryTerrainElevation:(s,f)=>{const v=t.transform;t.transform=e.transform;const S=t.queryTerrainElevation(s,f);return t.transform=v,S},queryRenderedFeatures:(s,f)=>{const v=t.transform;t.transform=e.transform;const S=t.queryRenderedFeatures(s,f);return t.transform=v,S}};for(const s of z0e(t))!(s in a)&&!D0e.includes(s)&&(a[s]=t[s].bind(t));return a}function z0e(e){const t=new Set;let a=e;for(;a;){for(const s of Object.getOwnPropertyNames(a))s[0]!=="_"&&typeof e[s]=="function"&&s!=="fire"&&s!=="setEventedParent"&&t.add(s);a=Object.getPrototypeOf(a)}return Array.from(t)}const k0e=typeof document<"u"?Me.useLayoutEffect:Me.useEffect,B0e=["baseApiUrl","maxParallelImageRequests","workerClass","workerCount","workerUrl"];function N0e(e,t){for(const s of B0e)s in t&&(e[s]=t[s]);const{RTLTextPlugin:a="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.js"}=t;a&&e.getRTLTextPluginStatus&&e.getRTLTextPluginStatus()==="unavailable"&&e.setRTLTextPlugin(a,s=>{s&&console.error(s)},!0)}const zw=Me.createContext(null);function F0e(e,t){const a=Me.useContext(A0e),[s,f]=Me.useState(null),v=Me.useRef(),{current:S}=Me.useRef({mapLib:null,map:null});Me.useEffect(()=>{const z=e.mapLib;let j=!0,F;return Promise.resolve(z||E0e(()=>Promise.resolve().then(()=>i0e),[])).then(G=>{if(!j)return;if(!G)throw new Error("Invalid mapLib");const Y="Map"in G?G:G.default;if(!Y.Map)throw new Error("Invalid mapLib");if(N0e(Y,e),!Y.supported||Y.supported(e))e.reuseMaps&&(F=zg.reuse(e,v.current)),F||(F=new zg(Y.Map,e,v.current)),S.map=L0e(F),S.mapLib=Y,f(F),a==null||a.onMapMount(S.map,e.id);else throw new Error("Map is not supported by this browser")}).catch(G=>{const{onError:Y}=e;Y?Y({type:"error",target:null,error:G}):console.error(G)}),()=>{j=!1,F&&(a==null||a.onMapUnmount(e.id),e.reuseMaps?F.recycle():F.destroy())}},[]),k0e(()=>{s&&s.setProps(e)}),Me.useImperativeHandle(t,()=>S.map,[s]);const i=Me.useMemo(()=>({position:"relative",width:"100%",height:"100%",...e.style}),[e.style]),O={height:"100%"};return Me.createElement("div",{id:e.id,ref:v,style:i},s&&Me.createElement(zw.Provider,{value:S},Me.createElement("div",{"mapboxgl-children":"",style:O},e.children)))}const j0e=Me.forwardRef(F0e),U0e=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function C0(e,t){if(!e||!t)return;const a=e.style;for(const s in t){const f=t[s];Number.isFinite(f)&&!U0e.test(s)?a[s]=`${f}px`:a[s]=f}}const V0e=Me.memo(Me.forwardRef((e,t)=>{const{map:a,mapLib:s}=Me.useContext(zw),f=Me.useRef({props:e});f.current.props=e;const v=Me.useMemo(()=>{let K=!1;Me.Children.forEach(e.children,ge=>{ge&&(K=!0)});const ne={...e,element:K?document.createElement("div"):null},se=new s.Marker(ne);return se.setLngLat([e.longitude,e.latitude]),se.getElement().addEventListener("click",ge=>{var _e,xe;(xe=(_e=f.current.props).onClick)==null||xe.call(_e,{type:"click",target:se,originalEvent:ge})}),se.on("dragstart",ge=>{var xe,ae;const _e=ge;_e.lngLat=v.getLngLat(),(ae=(xe=f.current.props).onDragStart)==null||ae.call(xe,_e)}),se.on("drag",ge=>{var xe,ae;const _e=ge;_e.lngLat=v.getLngLat(),(ae=(xe=f.current.props).onDrag)==null||ae.call(xe,_e)}),se.on("dragend",ge=>{var xe,ae;const _e=ge;_e.lngLat=v.getLngLat(),(ae=(xe=f.current.props).onDragEnd)==null||ae.call(xe,_e)}),se},[]);Me.useEffect(()=>(v.addTo(a.getMap()),()=>{v.remove()}),[]);const{longitude:S,latitude:i,offset:O,style:z,draggable:j=!1,popup:F=null,rotation:G=0,rotationAlignment:Y="auto",pitchAlignment:X="auto"}=e;return Me.useEffect(()=>{C0(v.getElement(),z)},[z]),Me.useImperativeHandle(t,()=>v,[]),(v.getLngLat().lng!==S||v.getLngLat().lat!==i)&&v.setLngLat([S,i]),O&&!C0e(v.getOffset(),O)&&v.setOffset(O),v.isDraggable()!==j&&v.setDraggable(j),v.getRotation()!==G&&v.setRotation(G),v.getRotationAlignment()!==Y&&v.setRotationAlignment(Y),v.getPitchAlignment()!==X&&v.setPitchAlignment(X),v.getPopup()!==F&&v.setPopup(F),fF.createPortal(e.children,v.getElement())}));function s8(e){return new Set(e?e.trim().split(/\s+/):[])}const $0e=Me.memo(Me.forwardRef((e,t)=>{const{map:a,mapLib:s}=Me.useContext(zw),f=Me.useMemo(()=>document.createElement("div"),[]),v=Me.useRef({props:e});v.current.props=e;const S=Me.useMemo(()=>{const i={...e},O=new s.Popup(i);return O.setLngLat([e.longitude,e.latitude]),O.once("open",z=>{var j,F;(F=(j=v.current.props).onOpen)==null||F.call(j,z)}),O},[]);if(Me.useEffect(()=>{const i=O=>{var z,j;(j=(z=v.current.props).onClose)==null||j.call(z,O)};return S.on("close",i),S.setDOMContent(f).addTo(a.getMap()),()=>{S.off("close",i),S.isOpen()&&S.remove()}},[]),Me.useEffect(()=>{C0(S.getElement(),e.style)},[e.style]),Me.useImperativeHandle(t,()=>S,[]),S.isOpen()&&((S.getLngLat().lng!==e.longitude||S.getLngLat().lat!==e.latitude)&&S.setLngLat([e.longitude,e.latitude]),e.offset&&!_d(S.options.offset,e.offset)&&S.setOffset(e.offset),(S.options.anchor!==e.anchor||S.options.maxWidth!==e.maxWidth)&&(S.options.anchor=e.anchor,S.setMaxWidth(e.maxWidth)),S.options.className!==e.className)){const i=s8(S.options.className),O=s8(e.className);for(const z of i)O.has(z)||S.removeClassName(z);for(const z of O)i.has(z)||S.addClassName(z);S.options.className=e.className}return fF.createPortal(e.children,f)}));function F1(e,t,a,s){const f=Me.useContext(zw),v=Me.useMemo(()=>e(f),[]);return Me.useEffect(()=>{const S=t,i=null,O=typeof t=="function"?t:null,{map:z}=f;return z.hasControl(v)||(z.addControl(v,S==null?void 0:S.position),i&&i(f)),()=>{O&&O(f),z.hasControl(v)&&z.removeControl(v)}},[]),v}function q0e(e){const t=F1(({mapLib:a})=>new a.AttributionControl(e),{position:e.position});return Me.useEffect(()=>{C0(t._container,e.style)},[e.style]),null}Me.memo(q0e);function G0e(e){const t=F1(({mapLib:a})=>new a.FullscreenControl({container:e.containerId&&document.getElementById(e.containerId)}),{position:e.position});return Me.useEffect(()=>{C0(t._controlContainer,e.style)},[e.style]),null}Me.memo(G0e);function H0e(e,t){const a=Me.useRef({props:e}),s=F1(({mapLib:f})=>{const v=new f.GeolocateControl(e),S=v._setupUI.bind(v);return v._setupUI=i=>{v._container.hasChildNodes()||S(i)},v.on("geolocate",i=>{var O,z;(z=(O=a.current.props).onGeolocate)==null||z.call(O,i)}),v.on("error",i=>{var O,z;(z=(O=a.current.props).onError)==null||z.call(O,i)}),v.on("outofmaxbounds",i=>{var O,z;(z=(O=a.current.props).onOutOfMaxBounds)==null||z.call(O,i)}),v.on("trackuserlocationstart",i=>{var O,z;(z=(O=a.current.props).onTrackUserLocationStart)==null||z.call(O,i)}),v.on("trackuserlocationend",i=>{var O,z;(z=(O=a.current.props).onTrackUserLocationEnd)==null||z.call(O,i)}),v},{position:e.position});return a.current.props=e,Me.useImperativeHandle(t,()=>s,[]),Me.useEffect(()=>{C0(s._container,e.style)},[e.style]),null}Me.memo(Me.forwardRef(H0e));function Z0e(e){const t=F1(({mapLib:a})=>new a.NavigationControl(e),{position:e.position});return Me.useEffect(()=>{C0(t._container,e.style)},[e.style]),null}Me.memo(Z0e);function W0e(e){const t=F1(({mapLib:v})=>new v.ScaleControl(e),{position:e.position}),a=Me.useRef(e),s=a.current;a.current=e;const{style:f}=e;return e.maxWidth!==void 0&&e.maxWidth!==s.maxWidth&&(t.options.maxWidth=e.maxWidth),e.unit!==void 0&&e.unit!==s.unit&&t.setUnit(e.unit),Me.useEffect(()=>{C0(t._container,f)},[f]),null}Me.memo(W0e);function X0e(e){var se,ge,_e,xe;const{windowSizes:t}=C7(),a=e.maxZoom??b0e,s=e.minZoom??Kk,[f,v]=Me.useState(!1),[S,i]=Me.useState({zoom:e.startZoom??Kk,longitude:((se=e.viewCoordinates)==null?void 0:se.longitude)??EC,latitude:((ge=e.viewCoordinates)==null?void 0:ge.latitude)??AC}),[O,z]=Me.useState({longitude:((_e=e.viewCoordinates)==null?void 0:_e.longitude)??EC,latitude:((xe=e.viewCoordinates)==null?void 0:xe.latitude)??AC}),[j,F]=Me.useState([]),[G,Y]=Me.useState(null),[X,K]=Me.useState([]);Me.useEffect(()=>{HF.accessToken="pk.eyJ1IjoiZW5zdWItMTIiLCJhIjoiY204NHd6dXpvMTJ6aDJqcXYyczJmczFudiJ9.mqTIXJmg2hQXjkJ8eSsw1g"},[]),Me.useEffect(()=>{var ae;e.fixedLatAndLon||z({latitude:S.latitude,longitude:S.longitude}),(ae=e.onChangeViewState)==null||ae.call(e,{...S})},[S]),Me.useEffect(()=>{e.loading!==void 0&&v(!e.loading)},[e.loading]),Me.useEffect(()=>{K(e.markers.map(ae=>p0e([ae.longitude,ae.latitude])))},[e.markers]),Me.useEffect(()=>{const ae=new o0e({radius:40,maxZoom:a-2});ae.load(X);const ve=ae.getClusters([-180,-85,180,85],S.zoom);ve.length<j.length&&Y(null),F(ve)},[X,S.zoom,a]);const ne=()=>{var ve,Se;if(!j.length)return{latitude:AC,longitude:EC};let ae=j[0];for(const He of j)(((ve=He.properties)==null?void 0:ve.point_count)??1)>(((Se=ae.properties)==null?void 0:Se.point_count)??1)&&(ae=He);return{longitude:ae.geometry.coordinates[0],latitude:ae.geometry.coordinates[1]}};return Me.useEffect(()=>{if(f||e.viewCoordinates)return;const ae=ne();i({...S,latitude:ae.latitude,longitude:ae.longitude})},[j]),he.jsxs("div",{className:`${_v.map} ${e.className}`,style:{height:t.height-w0e+"px"},children:[!f&&he.jsx(Hp,{className:_v.map__loading}),he.jsxs(j0e,{...S,mapStyle:"mapbox://styles/mapbox/streets-v12",doubleClickZoom:!0,minZoom:s,maxZoom:a,fadeDuration:100,onClick:()=>{G&&Y(null)},onMove:ae=>{i({zoom:ae.viewState.zoom,latitude:ae.viewState.latitude,longitude:ae.viewState.longitude})},onZoomEnd:ae=>i({...S,zoom:ae.target.getZoom()}),onLoad:()=>{e.loading||v(!0),e.whenLoaded&&e.whenLoaded()},style:{opacity:f?1:e.showMapIfLoading?.3:0},projection:{name:"mercator"},children:[j.map((ae,ve)=>{var ht,gt,Ft;const Se=((ht=ae.properties)==null?void 0:ht.point_count)??1,He=ae.geometry.coordinates[0],Ge=ae.geometry.coordinates[1],ye=e.markers.find(_t=>_t.longitude===He&&_t.latitude===Ge);if(!ye&&!((gt=ae.properties)!=null&&gt.cluster))return he.jsx("div",{},ve);const Le=e.useMarkerAutoSize?`${36+Se/X.length*10}px`:"auto";return he.jsx(V0e,{longitude:He,latitude:Ge,onClick:()=>setTimeout(()=>{G&&G.latitude===Ge&&G.longitude===He?Y(null):Y({longitude:He,latitude:Ge})},10),children:he.jsx("div",{style:{width:Le,height:Le},children:(Ft=ae.properties)!=null&&Ft.cluster?he.jsx(g0e,{count:Se}):e.getDefaultMarker(ye)})},ve)}),G&&he.jsx($0e,{longitude:G.longitude,latitude:G.latitude,closeOnClick:!1,className:_v.map__popUp,children:he.jsx("div",{className:_v.popUp__container,children:e.getPopUp&&e.getPopUp(G)})}),e.showLatAndLon&&he.jsx("div",{className:_v.map__coordinates,children:he.jsx(x0e,{latitude:O.latitude+"",longitude:O.longitude+""})})]})]})}const Y0e=(e,t)=>{if(e.id===t.id)return!1;const a=Math.max(e.latitude,t.latitude)-Math.min(e.latitude,t.latitude),s=Math.max(e.longitude,t.longitude)-Math.min(e.longitude,t.longitude);return a<=1e-4&&s<=1e-4},K0e="_block_wt7vj_1",J0e="_block__header_wt7vj_18",Q0e="_header__button_wt7vj_41",e_e="_header__text_wt7vj_45",t_e="_block__content_wt7vj_53",Z_={block:K0e,block__header:J0e,header__button:Q0e,header__text:e_e,block__content:t_e},n_e="data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M15%2018L9%2012L15%206'%20stroke='%23373435'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",r_e="data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M9%2018L15%2012L9%206'%20stroke='%23373435'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e";function i_e(e){var i,O;const t=yo(),[a,s]=Me.useState(0),f=(((i=e.otherStations)==null?void 0:i.length)??0)>0,v=f?[e.station].concat(...e.otherStations??[])[a]:e.station,S=()=>{t(A1+v.id+hl([{key:Td.PREVIOUS_PAGE,value:xd.MAIN}]))};return he.jsxs("div",{className:Z_.block,children:[he.jsxs("div",{className:Z_.block__header,children:[he.jsx("div",{className:Z_.header__button,children:f&&a!==0&&he.jsx(Jl,{iconSrc:n_e,onClick:()=>s(a-1),variant:"iconSmall"})}),f?he.jsxs("div",{className:Z_.header__text,children:["Станция №",a+1]}):he.jsx(he.Fragment,{}),he.jsx("div",{className:Z_.header__button,children:f&&((O=e.otherStations)==null?void 0:O.length)!==a&&he.jsx(Jl,{iconSrc:r_e,onClick:()=>s(a+1),variant:"iconSmall"})})]}),he.jsx("div",{className:Z_.block__content,children:he.jsx(P7,{onClick:S,station:v})})]})}const a_e="_marker_4qn5c_1",o_e="_groupMarker_4qn5c_2",s_e="_green_4qn5c_43",l_e="_orange_4qn5c_51",c_e="_grey_4qn5c_59",u_e="_groupMarker__counter_4qn5c_67",Ib={marker:a_e,groupMarker:o_e,green:s_e,orange:l_e,grey:c_e,groupMarker__counter:u_e};function h_e(e){return he.jsx("div",{className:Ib.groupMarker,children:he.jsx("a",{className:Ib.groupMarker__counter,children:e.stationsCount})})}function f_e(e){return he.jsx("div",{className:`${Ib.marker} ${Ib[e.color]}`,children:he.jsx(I7,{color:e.color})})}function d_e(e){const{stations:t,mapViewState:a,setMapViewState:s}=Me.useContext(Va),[f,v]=Me.useState(!0),[S,i]=Me.useState([]);Me.useEffect(()=>{i(t.map((z,j)=>({id:j,latitude:Number.parseFloat(z.coordinates.latitude)??0,longitude:Number.parseFloat(z.coordinates.longitude)??0,color:y5[z.status]})))},[t]);const O=z=>{const j=[];for(const F of S)Y0e(F,z)&&j.push(F);return j};return he.jsx(X0e,{useMarkerAutoSize:!0,markers:S,startZoom:a==null?void 0:a.zoom,viewCoordinates:a,onChangeViewState:z=>s(z),getPopUp:z=>{const j=S.find(X=>X.longitude===z.longitude&&X.latitude===z.latitude);if(!j)return he.jsx(he.Fragment,{});const F=t.find((X,K)=>K===j.id),Y=O(j).map(X=>t.find((K,ne)=>X.id===ne)).filter(X=>!!X).sort((X,K)=>X.id<K.id?-1:1);return F?he.jsx(i_e,{station:F,otherStations:Y}):he.jsx(he.Fragment,{})},whenLoaded:()=>v(!1),getDefaultMarker:z=>{const j=O(z);return j.length?[z.id].concat(j.map(G=>G.id)).sort((G,Y)=>G<Y?-1:1)[0]===z.id?he.jsx(h_e,{stationsCount:j.length+1}):he.jsx(he.Fragment,{}):he.jsx(f_e,{color:z.color})},loading:e.loading||f})}const p_e="_header_14gd7_1",m_e="_footer_14gd7_2",__e="_header__activeSession_14gd7_27",MC={header:p_e,footer:m_e,header__activeSession:__e},g_e="_button_3nd9u_1",y_e="_button__icon_3nd9u_30",l8={button:g_e,button__icon:y_e};function gv(e){return he.jsx("button",{className:l8.button,onClick:e.onClick,children:he.jsx("img",{className:l8.button__icon,src:e.iconSrc,alt:"Control"})})}const v_e="_panel_yv6a8_1",x_e={panel:v_e},b_e="data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M9.99988%202.00006H8.99988C6.17145%202.00006%204.75724%202.00006%203.87856%202.87874C2.99988%203.75742%202.99988%205.17163%202.99988%208.00006V21.2501H1.99988C1.58566%2021.2501%201.24988%2021.5858%201.24988%2022.0001C1.24988%2022.4143%201.58566%2022.7501%201.99988%2022.7501H17.2499C17.6641%2022.7501%2017.9999%2022.4143%2017.9999%2022.0001C17.9999%2021.5858%2017.6641%2021.2501%2017.2499%2021.2501H15.9999V17.7501H17.5713C17.9461%2017.7501%2018.2499%2018.0539%2018.2499%2018.4287V18.5001C18.2499%2019.7427%2019.2572%2020.7501%2020.4999%2020.7501C21.7425%2020.7501%2022.7499%2019.7427%2022.7499%2018.5001V7.60183C22.7499%207.44517%2022.7499%207.33708%2022.744%207.23167C22.6883%206.24069%2022.2421%205.3122%2021.503%204.64968C21.4244%204.57921%2021.34%204.5117%2021.2177%204.41384L19.9684%203.41444C19.645%203.15568%2019.173%203.20812%2018.9142%203.53157C18.6555%203.85501%2018.7079%204.32698%2019.0314%204.58574L20.2644%205.57221C20.4089%205.6878%2020.4584%205.72774%2020.5018%205.76659C20.9452%206.16411%2021.2129%206.7212%2021.2463%207.31579C21.2496%207.3739%2021.2499%207.43749%2021.2499%207.62253V8.00006H20.4999C19.6715%208.00006%2018.9999%208.67163%2018.9999%209.50006V11.9189C18.9999%2012.5646%2019.413%2013.1378%2020.0255%2013.3419L21.2499%2013.7501V18.5001C21.2499%2018.9143%2020.9141%2019.2501%2020.4999%2019.2501C20.0857%2019.2501%2019.7499%2018.9143%2019.7499%2018.5001V18.4287C19.7499%2017.2255%2018.7745%2016.2501%2017.5713%2016.2501H15.9999V8.00006C15.9999%205.17163%2015.9999%203.75742%2015.1212%202.87874C14.2425%202.00006%2012.8283%202.00006%209.99988%202.00006ZM9.88575%209.35694C10.2409%209.57005%2010.3561%2010.0307%2010.143%2010.3859L9.32452%2011.7501H10.9999C11.2701%2011.7501%2011.5194%2011.8954%2011.6525%2012.1305C11.7857%2012.3657%2011.782%2012.6542%2011.643%2012.8859L10.143%2015.3859C9.92989%2015.7411%209.46919%2015.8563%209.11401%2015.6432C8.75882%2015.4301%208.64365%2014.9694%208.85676%2014.6142L9.67524%2013.2501H7.99988C7.72967%2013.2501%207.48036%2013.1047%207.34723%2012.8696C7.2141%2012.6345%207.21774%2012.3459%207.35676%2012.1142L8.85676%209.61419C9.06987%209.259%209.53056%209.14383%209.88575%209.35694Z'%20fill='%2316B8AF'/%3e%3c/svg%3e",w_e="data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M1.75024%2010.0004V14.0004C1.75024%2016.8288%201.75024%2018.2431%202.62892%2019.1217C2.84626%2019.3391%203.09636%2019.5026%203.39252%2019.6258C3.38581%2019.5813%203.37946%2019.5367%203.37346%2019.492C3.2501%2018.5746%203.25017%2017.4288%203.25024%2016.0991L3.25024%208.00036L3.25024%207.90161V7.90161C3.25017%206.57188%203.2501%205.42616%203.37346%204.50867C3.37945%204.46405%203.3858%204.41951%203.39251%204.37506C3.09635%204.49818%202.84626%204.66176%202.62892%204.87909C1.75024%205.75777%201.75024%207.17198%201.75024%2010.0004Z'%20fill='%2316B8AF'/%3e%3cpath%20d='M21.7502%2010.0004V14.0004C21.7502%2016.8288%2021.7502%2018.2431%2020.8716%2019.1217C20.6542%2019.3391%2020.4041%2019.5026%2020.108%2019.6258C20.1147%2019.5813%2020.121%2019.5367%2020.127%2019.492C20.2504%2018.5746%2020.2503%2017.4288%2020.2502%2016.0991V7.90162C20.2503%206.57189%2020.2504%205.42616%2020.127%204.50867C20.121%204.46405%2020.1147%204.41951%2020.108%204.37506C20.4041%204.49818%2020.6542%204.66176%2020.8716%204.87909C21.7502%205.75777%2021.7502%207.17198%2021.7502%2010.0004Z'%20fill='%2316B8AF'/%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M5.62892%202.87874C4.75024%203.75742%204.75024%205.17163%204.75024%208.00006V16.0001C4.75024%2018.8285%204.75024%2020.2427%205.62892%2021.1214C6.5076%2022.0001%207.92182%2022.0001%2010.7502%2022.0001H12.7502C15.5787%2022.0001%2016.9929%2022.0001%2017.8716%2021.1214C18.7502%2020.2427%2018.7502%2018.8285%2018.7502%2016.0001V8.00006C18.7502%205.17163%2018.7502%203.75742%2017.8716%202.87874C16.9929%202.00006%2015.5787%202.00006%2012.7502%202.00006H10.7502C7.92182%202.00006%206.5076%202.00006%205.62892%202.87874ZM8.00024%2017.0001C8.00024%2016.5858%208.33603%2016.2501%208.75024%2016.2501H11.7502C12.1645%2016.2501%2012.5002%2016.5858%2012.5002%2017.0001C12.5002%2017.4143%2012.1645%2017.7501%2011.7502%2017.7501H8.75024C8.33603%2017.7501%208.00024%2017.4143%208.00024%2017.0001ZM8.75024%2012.2501C8.33603%2012.2501%208.00024%2012.5858%208.00024%2013.0001C8.00024%2013.4143%208.33603%2013.7501%208.75024%2013.7501H14.7502C15.1645%2013.7501%2015.5002%2013.4143%2015.5002%2013.0001C15.5002%2012.5858%2015.1645%2012.2501%2014.7502%2012.2501H8.75024ZM8.00024%209.00006C8.00024%208.58585%208.33603%208.25006%208.75024%208.25006H14.7502C15.1645%208.25006%2015.5002%208.58585%2015.5002%209.00006C15.5002%209.41427%2015.1645%209.75006%2014.7502%209.75006H8.75024C8.33603%209.75006%208.00024%209.41427%208.00024%209.00006Z'%20fill='%2316B8AF'/%3e%3c/svg%3e",S_e="data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M21.1011%208.00353C21.0445%207.99996%2020.9828%207.99998%2020.9188%208L20.9028%208.00001H18.3944C16.3267%208.00001%2014.5575%209.62757%2014.5575%2011.75C14.5575%2013.8724%2016.3267%2015.5%2018.3944%2015.5H20.9028L20.9188%2015.5C20.9828%2015.5%2021.0445%2015.5001%2021.1011%2015.4965C21.941%2015.4434%2022.6838%2014.7862%2022.7462%2013.8682C22.7503%2013.808%2022.7503%2013.7431%2022.7502%2013.683L22.7502%2013.6667V9.83334L22.7502%209.81702C22.7503%209.75688%2022.7503%209.69199%2022.7462%209.6318C22.6838%208.71381%2021.941%208.05657%2021.1011%208.00353ZM18.1719%2012.75C18.7042%2012.75%2019.1358%2012.3023%2019.1358%2011.75C19.1358%2011.1977%2018.7042%2010.75%2018.1719%2010.75C17.6396%2010.75%2017.2081%2011.1977%2017.2081%2011.75C17.2081%2012.3023%2017.6396%2012.75%2018.1719%2012.75Z'%20fill='%2316B8AF'/%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M20.9182%2017C21.0673%2016.9961%2021.1801%2017.1342%2021.1397%2017.2778C20.9389%2017.9902%2020.6203%2018.5975%2020.109%2019.1088C19.3606%2019.8571%2018.4117%2020.1892%2017.2393%2020.3469C16.1001%2020.5%2014.6444%2020.5%2012.8067%2020.5H10.6938C8.85607%2020.5%207.40044%2020.5%206.26122%2020.3469C5.0888%2020.1892%204.13985%2019.8571%203.39149%2019.1088C2.64312%2018.3604%202.31101%2017.4114%202.15338%2016.239C2.00022%2015.0998%202.00023%2013.6442%202.00024%2011.8064V11.6936C2.00023%209.85583%202.00022%208.40019%202.15338%207.26098C2.31101%206.08856%202.64312%205.13961%203.39149%204.39124C4.13985%203.64288%205.0888%203.31076%206.26122%203.15314C7.40044%202.99997%208.85607%202.99998%2010.6938%203L12.8067%203C14.6444%202.99998%2016.1001%202.99997%2017.2393%203.15314C18.4117%203.31076%2019.3606%203.64288%2020.109%204.39124C20.6203%204.90252%2020.9389%205.50974%2021.1396%206.22218C21.1801%206.36575%2021.0672%206.50387%2020.9181%206.5L18.3943%206.50001C15.5576%206.50001%2013.0574%208.74091%2013.0574%2011.75C13.0574%2014.7591%2015.5576%2017%2018.3943%2017L20.9182%2017ZM5.75024%207C5.33603%207%205.00024%207.33579%205.00024%207.75C5.00024%208.16421%205.33603%208.5%205.75024%208.5H9.75024C10.1645%208.5%2010.5002%208.16421%2010.5002%207.75C10.5002%207.33579%2010.1645%207%209.75024%207H5.75024Z'%20fill='%2316B8AF'/%3e%3c/svg%3e",T_e="data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M6%2019C4.34314%2019%203%2017.6569%203%2016V10C3%206.22877%203%204.34316%204.17157%203.17157C5.34315%202%207.22876%202%2011%202H15C16.6569%202%2018%203.34315%2018%205.00001'%20fill='%2316B8AF'/%3e%3cpath%20d='M5%2010.3529C5%207.35813%205%205.86074%205.93724%204.93035C6.87452%204%208.383%204%2011.4%204H14.6C17.617%204%2019.1255%204%2020.0628%204.93035C21%205.86074%2021%207.35813%2021%2010.3529V15.6471C21%2018.6419%2021%2020.1393%2020.0628%2021.0697C19.1255%2022%2017.617%2022%2014.6%2022H11.4C8.383%2022%206.87452%2022%205.93724%2021.0697C5%2020.1393%205%2018.6419%205%2015.6471V10.3529Z'%20fill='white'/%3e%3cpath%20d='M6%2011C6%208.17156%206%206.75736%206.87866%205.87866C7.75736%205%209.17156%205%2012%205H15C17.8284%205%2019.2426%205%2020.1213%205.87866C21%206.75736%2021%208.17156%2021%2011V16C21%2018.8284%2021%2020.2426%2020.1213%2021.1213C19.2426%2022%2017.8284%2022%2015%2022H12C9.17156%2022%207.75736%2022%206.87866%2021.1213C6%2020.2426%206%2018.8284%206%2016V11Z'%20fill='%2316B8AF'/%3e%3c/svg%3e",E_e="data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3ccircle%20cx='9.00073'%20cy='6'%20r='4'%20fill='%2316B8AF'/%3e%3cellipse%20cx='9.00073'%20cy='17.001'%20rx='7'%20ry='4'%20fill='%2316B8AF'/%3e%3cpath%20d='M20.9994%2017.0005C20.9994%2018.6573%2018.9638%2020.0004%2016.4786%2020.0004C17.2108%2019.2001%2017.7142%2018.1955%2017.7142%2017.0018C17.7142%2015.8068%2017.2096%2014.8013%2016.476%2014.0005C18.9613%2014.0005%2020.9994%2015.3436%2020.9994%2017.0005Z'%20fill='%2316B8AF'/%3e%3cpath%20d='M17.9994%206.00073C17.9994%207.65759%2016.6562%209.00073%2014.9994%209.00073C14.6381%209.00073%2014.2917%208.93687%2013.9709%208.81981C14.444%207.98772%2014.7142%207.02522%2014.7142%205.99962C14.7142%204.97477%2014.4444%204.01294%2013.972%203.18127C14.2925%203.06446%2014.6385%203.00073%2014.9994%203.00073C16.6562%203.00073%2017.9994%204.34388%2017.9994%206.00073Z'%20fill='%2316B8AF'/%3e%3c/svg%3e";function A_e(){const e=yo();return he.jsxs("div",{className:x_e.panel,children:[he.jsx(gv,{iconSrc:b_e,onClick:()=>e(E1)}),he.jsx(gv,{iconSrc:w_e,onClick:()=>e(qp)}),he.jsx(gv,{iconSrc:S_e,onClick:()=>e(L8)}),he.jsx(gv,{iconSrc:T_e,onClick:()=>e(zv)}),he.jsx(gv,{iconSrc:E_e,onClick:()=>window.location.replace("https://t.me/egine_cpo")})]})}const C_e="data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20clip-path='url(%23clip0_1_383)'%3e%3cpath%20d='M17.1268%200.102663C17.2736%200.18777%2017.3872%200.320148%2017.4491%200.478169C17.5109%200.63619%2017.5173%200.810514%2017.4673%200.972663L14.7658%209.75066H19.7503C19.8968%209.7506%2020.0401%209.79344%2020.1625%209.87389C20.2849%209.95434%2020.3811%2010.0689%2020.4392%2010.2034C20.4972%2010.3378%2020.5146%2010.4864%2020.4893%2010.6306C20.4639%2010.7749%2020.3968%2010.9086%2020.2963%2011.0152L8.2963%2023.7652C8.18019%2023.8886%208.02568%2023.9691%207.85796%2023.9935C7.69024%2024.018%207.51919%2023.9848%207.3727%2023.8996C7.22622%2023.8143%207.11292%2023.682%207.05129%2023.5241C6.98965%2023.3662%206.98331%2023.1921%207.0333%2023.0302L9.7348%2014.2507H4.7503C4.60382%2014.2507%204.46052%2014.2079%204.33811%2014.1274C4.21569%2014.047%204.11951%2013.9325%204.06145%2013.798C4.00338%2013.6635%203.98596%2013.5149%204.01135%2013.3707C4.03674%2013.2264%204.10381%2013.0927%204.2043%2012.9862L16.2043%200.236163C16.3203%200.112861%2016.4745%200.0324155%2016.642%200.00790543C16.8095%20-0.0166046%2016.9804%200.0162624%2017.1268%200.101163V0.102663Z'%20fill='white'/%3e%3c/g%3e%3cdefs%3e%3cclipPath%20id='clip0_1_383'%3e%3crect%20width='24'%20height='24'%20fill='white'/%3e%3c/clipPath%3e%3c/defs%3e%3c/svg%3e",M_e="_notify_1rshs_1",O_e="_notify__blinkingCircle_1rshs_10",c8={notify:M_e,notify__blinkingCircle:O_e};function I_e(){const e=yo(),{activeSession:t}=$F();return t?he.jsxs("div",{className:c8.notify,children:[he.jsx("div",{className:c8.notify__blinkingCircle}),he.jsx(Jl,{onClick:()=>e(Lb+t.id+hl([{key:Bv.PREVIOUS_PAGE,value:Nv.MAIN}])),variant:"icon",iconSrc:C_e})]}):he.jsx(he.Fragment,{})}const P_e=()=>{const{setStations:e,stationFilters:t,position:a}=Me.useContext(Va),{getStationsFromApi:s}=nu(),[f,v]=Me.useState(!0);return Me.useEffect(()=>{if(!t.shouldUpdateStations){v(!1);return}v(!0),s(LC(t,a)).then(S=>{e(S)}).finally(()=>v(!1))},[t]),{stationsLoading:f}};function R_e(){const e=yo(),{position:t,setPosition:a,stationFilters:s}=Me.useContext(Va),{stationsLoading:f}=P_e();Me.useEffect(()=>{const i=navigator.geolocation;if(t!==void 0||!i)return;const O=i.watchPosition(z=>{a({latitude:z.coords.latitude,longitude:z.coords.longitude})},()=>{a(null)});return()=>i.clearWatch(O)},[]);const v=()=>{e(_5+hl([{key:kv.PREVIOUS_PAGE,value:cg.MAIN}]))},S=()=>{e(E1+hl([{key:zx.SEARCH_FOCUSED,value:"true"}]))};return he.jsxs("div",{children:[!f&&he.jsxs("div",{className:MC.header,children:[he.jsx(D7,{placeholder:"Поиск",variant:"shadow",onClick:S,value:s.partOfName}),he.jsx(zb,{onClick:v,variant:"outlined",iconSrc:g5}),he.jsx("div",{className:MC.header__activeSession,children:he.jsx(I_e,{})})]}),he.jsx(d_e,{loading:f}),he.jsx("div",{className:MC.footer,children:he.jsx(A_e,{})})]})}const D_e="_page__main_1qqlj_1",L_e={page__main:D_e},z_e="_actionButton_atat6_1",k_e="_actionButton_green_atat6_31",B_e="_actionButton_red_atat6_39",N_e="_actionButton_disabled_atat6_47",F_e="_actionButton__loader_atat6_55",Sx={actionButton:z_e,actionButton_green:k_e,actionButton_red:B_e,actionButton_disabled:N_e,actionButton__loader:F_e};function U4(e){return he.jsx("button",{className:`${Sx.actionButton} ${Sx[`actionButton_${e.variant}`]} ${e.disabled||e.loading?Sx.actionButton_disabled:""}`,onClick:()=>{!e.loading&&!e.disabled&&e.onClick()},disabled:e.disabled,children:e.loading?he.jsx(Hp,{className:Sx.actionButton__loader}):e.text})}const j_e="_content__info_vlca4_1",U_e="_info__title_vlca4_16",V_e="_info__icon_vlca4_30",$_e="_info__text_vlca4_36",q_e="_info__text_paymentMethod_vlca4_45",yv={content__info:j_e,info__title:U_e,info__icon:V_e,info__text:$_e,info__text_paymentMethod:q_e},V4="data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3ccircle%20cx='12'%20cy='12'%20r='10'%20fill='%23F89520'/%3e%3cpath%20d='M12%207V13'%20stroke='white'%20stroke-width='1.5'%20stroke-linecap='round'/%3e%3ccircle%20cx='12'%20cy='16'%20r='1'%20fill='white'/%3e%3c/svg%3e",YF="data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3ccircle%20cx='12'%20cy='12'%20r='10'%20fill='%2327AE60'/%3e%3cpath%20d='M8.5%2012.5L10.5%2014.5L15.5%209.5'%20stroke='white'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e";function G_e(e){const t=!!e.paymentMethod;return he.jsxs("div",{className:yv.content__info,children:[he.jsx("p",{className:yv.info__title,children:t?"Способ оплаты привязан":"Способ оплаты не привязан"}),he.jsx("img",{src:t?YF:V4,alt:"Notify icon",className:yv.info__icon}),he.jsx("p",{className:`${yv.info__text} ${t?yv.info__text_paymentMethod:""}`,children:t?e.paymentMethod:"Без способа оплаты вы не сможете заряжаться на платных станциях"})]})}const H_e=()=>{const{setPaymentMethod:e}=Me.useContext(Va),{getPaymentMethodFromApi:t}=nu(),[a,s]=Me.useState(!0);return Me.useEffect(()=>{t({}).then(f=>{e(f)}).finally(()=>s(!1))},[]),{loading:a}};function Z_e(){const e=yo(),{loading:t}=H_e(),{paymentMethod:a,setPaymentMethod:s,showSnackbar:f}=Me.useContext(Va),{createPaymentMethodFromApi:v,getPaymentUrlFromApi:S,deletePaymentMethodFromApi:i}=nu(),[O,z]=Me.useState(!1),[j,F]=Me.useState(!1),G=async()=>{F(!0),await v({});let ne=await S({});ne=ne?JSON.parse(ne):void 0,ne?window.Telegram.WebApp.openLink(ne,!0):f("error","Не удалось создать способ оплаты"),F(!1)},Y=async()=>{const ne=await i({});if(ne&&ne.error)return ne},X=()=>{a&&!a.error?z(!0):G()},K=async()=>{f("warning","Способ оплаты удалён"),s(void 0)};return he.jsxs(Pd,{onReturn:()=>e("/"),title:"Способ оплаты",loading:t,children:[he.jsx($v,{isOpen:O,onClose:()=>z(!1),children:he.jsx(Kb,{title:he.jsxs(he.Fragment,{children:["Вы действительно хотите ",he.jsx("br",{})," удалить способ оплаты?"]}),errorTitle:he.jsxs(he.Fragment,{children:["Не удалось удалить ",he.jsx("br",{})," способ оплаты"]}),onConfirm:Y,onSuccess:K,onClose:()=>z(!1)})}),he.jsx($v,{isOpen:j,onClose:()=>{},children:he.jsx(Hp,{})}),he.jsx("div",{className:L_e.page__main,children:he.jsx(G_e,{paymentMethod:a&&!a.error?a:void 0})}),he.jsx(U4,{text:a&&!a.error?"Удалить способ оплаты":"Привязать способ оплаты",variant:a&&!a.error?"red":"green",onClick:X,disabled:j})]})}const W_e="_page__content_withCard_7dsr3_1",X_e="_page__content_withoutCard_7dsr3_2",u8={page__content_withCard:W_e,page__content_withoutCard:X_e},Y_e=()=>{const{setRfidCard:e}=Me.useContext(Va),{getRfidCardFromApi:t}=nu(),[a,s]=Me.useState(!0);return Me.useEffect(()=>{t({}).then(f=>{e(f)}).finally(()=>s(!1))},[]),{loading:a}},K_e="data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M20%2012.421C20%205.74751%2015.7143%202.38016%2015.5306%202.25771C14.9796%201.82914%2014.2449%201.95159%2013.8163%202.50261C13.6193%202.75663%2013.5283%203.07712%2013.5626%203.39678C13.5968%203.71644%2013.7536%204.01039%2014%204.2169C14.1224%204.33935%2017.4898%207.03322%2017.4898%2012.421C17.4898%2017.8087%2014.1224%2020.5026%2014%2020.6251C13.8509%2020.7419%2013.7296%2020.8903%2013.6449%2021.0597C13.5602%2021.2292%2013.5142%2021.4153%2013.5102%2021.6047C13.5102%2021.8495%2013.5714%2022.1557%2013.7551%2022.3393C14.2449%2022.8904%2014.9796%2023.0128%2015.5306%2022.5842C15.7143%2022.4618%2020%2019.0944%2020%2012.421Z'%20fill='%23373435'%20stroke='%23373435'%20stroke-width='0.000533333'/%3e%3cpath%20d='M15.4082%2012.4209C15.4082%208.5638%2013.0204%206.17605%2012.898%206.0536C12.6699%205.83005%2012.3627%205.70556%2012.0434%205.70717C11.724%205.70878%2011.4181%205.83637%2011.1923%206.06221C10.9664%206.28805%2010.8389%206.59389%2010.8372%206.91328C10.8356%207.23266%2010.9601%207.53977%2011.1837%207.76788C12.3104%209.0582%2012.9399%2010.7081%2012.9592%2012.4209C12.9399%2014.1338%2012.3104%2015.7837%2011.1837%2017.074C11.0676%2017.1846%2010.9753%2017.3176%2010.9122%2017.4649C10.8491%2017.6122%2010.8165%2017.7709%2010.8165%2017.9311C10.8165%2018.0914%2010.8491%2018.25%2010.9122%2018.3974C10.9753%2018.5447%2011.0676%2018.6777%2011.1837%2018.7883C11.2943%2018.9043%2011.4272%2018.9967%2011.5746%2019.0598C11.7219%2019.1229%2011.8805%2019.1555%2012.0408%2019.1555C12.2011%2019.1555%2012.3597%2019.1229%2012.5071%2019.0598C12.6544%2018.9967%2012.7874%2018.9043%2012.898%2018.7883C13.0204%2018.6658%2015.4082%2016.2781%2015.4082%2012.4209Z'%20fill='%23373435'%20stroke='%23373435'%20stroke-width='0.000533333'/%3e%3cpath%20d='M7.44898%2012.421C7.44898%2012.0962%207.31997%2011.7848%207.09034%2011.5551C6.8607%2011.3255%206.54925%2011.1965%206.22449%2011.1965C5.98231%2011.1965%205.74557%2011.2683%205.5442%2011.4028C5.34284%2011.5374%205.18589%2011.7286%205.09321%2011.9524C5.00053%2012.1761%204.97628%2012.4223%205.02353%2012.6598C5.07078%2012.8974%205.1874%2013.1156%205.35865%2013.2868C5.52989%2013.4581%205.74808%2013.5747%205.98561%2013.6219C6.22313%2013.6692%206.46934%2013.6449%206.69308%2013.5522C6.91683%2013.4596%207.10807%2013.3026%207.24262%2013.1013C7.37717%2012.8999%207.44898%2012.6631%207.44898%2012.421Z'%20fill='%23373435'%20stroke='%23373435'%20stroke-width='0.000533333'/%3e%3cpath%20d='M9.83674%2015.6659C10.0204%2015.5434%2011.1225%2014.2577%2011.1225%2012.421C11.1225%2010.6455%2010.0204%209.29854%209.89796%209.17609C9.683%208.9388%209.38476%208.79361%209.06539%208.7708C8.74603%208.74799%208.43018%208.84931%208.18368%209.05364C7.69388%209.48221%207.57143%2010.2781%208%2010.7679C8%2010.7679%208.61225%2011.5638%208.61225%2012.421C8.61225%2013.3394%208%2014.074%208%2014.074C7.82001%2014.3024%207.7133%2014.5799%207.69388%2014.87C7.69281%2015.0452%207.73071%2015.2185%207.80483%2015.3774C7.87895%2015.5362%207.98744%2015.6766%208.12245%2015.7883C8.61225%2016.2169%209.40817%2016.2169%209.83674%2015.6659Z'%20fill='%23373435'%20stroke='%23373435'%20stroke-width='0.000533333'/%3e%3c/svg%3e",J_e="_card_4ol5v_1",Q_e="_card__header_4ol5v_17",ege="_header__left_4ol5v_30",tge="_left__text_4ol5v_43",nge="_left__icon_4ol5v_51",rge="_card__content_4ol5v_58",W_={card:J_e,card__header:Q_e,header__left:ege,left__text:tge,left__icon:nge,card__content:rge},ige="_number_1hfm8_1",age="_number__text_1hfm8_16",h8={number:ige,number__text:age},oge="data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M3.27489%2015.2957C2.42496%2014.1915%202%2013.6394%202%2012C2%2010.3606%202.42496%209.80853%203.27489%208.70433C4.97196%206.49956%207.81811%204%2012%204C16.1819%204%2019.028%206.49956%2020.7251%208.70433C21.575%209.80853%2022%2010.3606%2022%2012C22%2013.6394%2021.575%2014.1915%2020.7251%2015.2957C19.028%2017.5004%2016.1819%2020%2012%2020C7.81811%2020%204.97196%2017.5004%203.27489%2015.2957Z'%20stroke='%23373435'%20stroke-width='1.5'/%3e%3cpath%20d='M15%2012C15%2013.6569%2013.6569%2015%2012%2015C10.3431%2015%209%2013.6569%209%2012C9%2010.3431%2010.3431%209%2012%209C13.6569%209%2015%2010.3431%2015%2012Z'%20stroke='%23373435'%20stroke-width='1.5'/%3e%3c/svg%3e",sge="data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M2.68936%206.70456C2.52619%206.32384%202.08528%206.14747%201.70456%206.31064C1.32384%206.47381%201.14747%206.91472%201.31064%207.29544L2.68936%206.70456ZM15.5872%2013.3287L15.3125%2012.6308L15.5872%2013.3287ZM9.04145%2013.7377C9.26736%2013.3906%209.16904%2012.926%208.82185%2012.7001C8.47466%2012.4742%208.01008%2012.5725%207.78417%2012.9197L9.04145%2013.7377ZM6.37136%2015.091C6.14545%2015.4381%206.24377%2015.9027%206.59096%2016.1286C6.93815%2016.3545%207.40273%2016.2562%207.62864%2015.909L6.37136%2015.091ZM22.6894%207.29544C22.8525%206.91472%2022.6762%206.47381%2022.2954%206.31064C21.9147%206.14747%2021.4738%206.32384%2021.3106%206.70456L22.6894%207.29544ZM19%2011.1288L18.4867%2010.582V10.582L19%2011.1288ZM19.9697%2013.1592C20.2626%2013.4521%2020.7374%2013.4521%2021.0303%2013.1592C21.3232%2012.8663%2021.3232%2012.3914%2021.0303%2012.0985L19.9697%2013.1592ZM11.25%2016.5C11.25%2016.9142%2011.5858%2017.25%2012%2017.25C12.4142%2017.25%2012.75%2016.9142%2012.75%2016.5H11.25ZM16.3714%2015.909C16.5973%2016.2562%2017.0619%2016.3545%2017.409%2016.1286C17.7562%2015.9027%2017.8545%2015.4381%2017.6286%2015.091L16.3714%2015.909ZM5.53033%2011.6592C5.82322%2011.3663%205.82322%2010.8914%205.53033%2010.5985C5.23744%2010.3056%204.76256%2010.3056%204.46967%2010.5985L5.53033%2011.6592ZM2.96967%2012.0985C2.67678%2012.3914%202.67678%2012.8663%202.96967%2013.1592C3.26256%2013.4521%203.73744%2013.4521%204.03033%2013.1592L2.96967%2012.0985ZM12%2013.25C8.77611%2013.25%206.46133%2011.6446%204.9246%209.98966C4.15645%209.16243%203.59325%208.33284%203.22259%207.71014C3.03769%207.3995%202.90187%207.14232%202.8134%206.96537C2.76919%206.87696%202.73689%206.80875%202.71627%206.76411C2.70597%206.7418%202.69859%206.7254%202.69411%206.71533C2.69187%206.7103%202.69036%206.70684%202.68957%206.70503C2.68917%206.70413%202.68896%206.70363%202.68892%206.70355C2.68891%206.70351%202.68893%206.70357%202.68901%206.70374C2.68904%206.70382%202.68913%206.70403%202.68915%206.70407C2.68925%206.7043%202.68936%206.70456%202%207C1.31064%207.29544%201.31077%207.29575%201.31092%207.29609C1.31098%207.29624%201.31114%207.2966%201.31127%207.2969C1.31152%207.29749%201.31183%207.2982%201.31218%207.299C1.31287%207.30062%201.31376%207.30266%201.31483%207.30512C1.31698%207.31003%201.31988%207.31662%201.32353%207.32483C1.33083%207.34125%201.34115%207.36415%201.35453%207.39311C1.38127%207.45102%201.42026%207.5332%201.47176%207.63619C1.57469%207.84206%201.72794%208.13175%201.93366%208.47736C2.34425%209.16716%202.96855%2010.0876%203.8254%2011.0103C5.53867%2012.8554%208.22389%2014.75%2012%2014.75V13.25ZM15.3125%2012.6308C14.3421%2013.0128%2013.2417%2013.25%2012%2013.25V14.75C13.4382%2014.75%2014.7246%2014.4742%2015.8619%2014.0266L15.3125%2012.6308ZM7.78417%2012.9197L6.37136%2015.091L7.62864%2015.909L9.04145%2013.7377L7.78417%2012.9197ZM22%207C21.3106%206.70456%2021.3107%206.70441%2021.3108%206.70427C21.3108%206.70423%2021.3108%206.7041%2021.3109%206.70402C21.3109%206.70388%2021.311%206.70376%2021.311%206.70368C21.3111%206.70352%2021.3111%206.70349%2021.3111%206.7036C21.311%206.7038%2021.3107%206.70452%2021.3101%206.70576C21.309%206.70823%2021.307%206.71275%2021.3041%206.71924C21.2983%206.73223%2021.2889%206.75309%2021.2758%206.78125C21.2495%206.83757%2021.2086%206.92295%2021.1526%207.03267C21.0406%207.25227%2020.869%207.56831%2020.6354%207.9432C20.1669%208.69516%2019.4563%209.67197%2018.4867%2010.582L19.5133%2011.6757C20.6023%2010.6535%2021.3917%209.56587%2021.9085%208.73646C22.1676%208.32068%2022.36%207.9668%2022.4889%207.71415C22.5533%207.58775%2022.602%207.48643%2022.6353%207.41507C22.6519%207.37939%2022.6647%207.35118%2022.6737%207.33104C22.6782%207.32097%2022.6818%207.31292%2022.6844%207.30696C22.6857%207.30398%2022.6867%207.30153%2022.6876%207.2996C22.688%207.29864%2022.6883%207.29781%2022.6886%207.29712C22.6888%207.29677%2022.6889%207.29646%2022.689%207.29618C22.6891%207.29604%2022.6892%207.29585%2022.6892%207.29578C22.6893%207.29561%2022.6894%207.29544%2022%207ZM18.4867%2010.582C17.6277%2011.3882%2016.5739%2012.1343%2015.3125%2012.6308L15.8619%2014.0266C17.3355%2013.4466%2018.5466%2012.583%2019.5133%2011.6757L18.4867%2010.582ZM18.4697%2011.6592L19.9697%2013.1592L21.0303%2012.0985L19.5303%2010.5985L18.4697%2011.6592ZM11.25%2014V16.5H12.75V14H11.25ZM14.9586%2013.7377L16.3714%2015.909L17.6286%2015.091L16.2158%2012.9197L14.9586%2013.7377ZM4.46967%2010.5985L2.96967%2012.0985L4.03033%2013.1592L5.53033%2011.6592L4.46967%2010.5985Z'%20fill='%23373435'/%3e%3c/svg%3e",lge=(e,t="*")=>{const a=e.length;let s=0;return a>8?s=4:a>6?s=3:a>4&&(s=1),t.repeat(e.length-s)+e.slice(-s)};function cge(e){const[t,a]=Me.useState(!0);return he.jsxs("div",{className:h8.number,children:[he.jsx("a",{className:h8.number__text,children:t?lge(e.number):e.number}),he.jsx(Jl,{variant:"text",iconSrc:t?oge:sge,onClick:()=>a(!t),text:t?"Посмотреть":"Скрыть"})]})}const uge="_row_1ddjm_1",hge="_row__first_1ddjm_14",fge="_row__second_1ddjm_15",OC={row:uge,row__first:hge,row__second:fge};function f8(e){return he.jsxs("div",{className:OC.row,children:[he.jsxs("a",{className:OC.row__first,children:[e.name,":"]}),he.jsx("a",{className:OC.row__second,children:e.value})]})}function dge(e){return he.jsxs(Ro,{className:W_.card,children:[he.jsxs("div",{className:W_.card__header,children:[he.jsxs("div",{className:W_.header__left,children:[he.jsx("a",{className:W_.left__text,children:"RFID"}),he.jsx("img",{className:W_.left__icon,src:K_e,alt:"NFC"})]}),he.jsx(cge,{number:e.card.visual_number})]}),he.jsxs("div",{className:W_.card__content,children:[he.jsx(f8,{name:"Тип",value:"Персональная"}),e.card.group&&he.jsx(f8,{name:"Группа",value:e.card.group})]})]})}const pge="_card_ylh5q_1",mge="_card__title_ylh5q_15",_ge="_card__icon_ylh5q_24",gge="_card__description_ylh5q_29",Tx={card:pge,card__title:mge,card__icon:_ge,card__description:gge};function yge(){const{rfidCard:e}=Me.useContext(Va);return e?he.jsx(dge,{card:e}):he.jsxs("div",{className:Tx.card,children:[he.jsx("a",{className:Tx.card__title,children:"Карта RFID не привязана"}),he.jsx("img",{className:Tx.card__icon,src:V4,alt:"Warning"}),he.jsx("a",{className:Tx.card__description,children:"Без зарядной карты вы не сможете заряжаться на станциях"})]})}function vge(){const e=yo(),{detachRfidCardFromApi:t}=nu(),{rfidCard:a,setRfidCard:s,showSnackbar:f}=Me.useContext(Va),{loading:v}=Y_e(),[S,i]=Me.useState(!1),O=()=>{a?i(!0):e(D8)};return he.jsxs(Pd,{onReturn:()=>e("/"),title:"Зарядная карта",loading:v,children:[he.jsx($v,{isOpen:S,onClose:()=>i(!1),children:he.jsx(Kb,{title:he.jsxs(he.Fragment,{children:["Вы действительно хотите ",he.jsx("br",{})," удалить карту?"]}),errorTitle:he.jsxs(he.Fragment,{children:["Не удалось удалить ",he.jsx("br",{})," зарядную карту"]}),description:"После удаления вы не сможете заряжаться по данной карте",onConfirm:()=>t({visualCardNumber:(a==null?void 0:a.visual_number)??""}),onSuccess:()=>{f("warning","Зарядная карта удалена"),s(void 0)},onClose:()=>i(!1)})}),he.jsx("div",{className:a?u8.page__content_withCard:u8.page__content_withoutCard,children:he.jsx(yge,{})}),he.jsx(U4,{text:a?"Удалить карту":"Привязать карту",variant:a?"red":"green",onClick:O})]})}const xge="_page_dk4vk_1",bge="_page__content_dk4vk_5",d8={page:xge,page__content:bge},wge="_container_r94e4_1",Sge="_container__input_r94e4_11",Tge="_input__required_r94e4_85",Ege="_container__input_error_r94e4_89",Age="_container__error_r94e4_93",vv={container:wge,container__input:Sge,input__required:Tge,container__input_error:Ege,container__error:Age};function Cge(e){var v;const t=Me.useId(),[a,s]=Me.useState(((v=e.value)==null?void 0:v.toString())??"");Me.useEffect(()=>{e.value!==void 0&&s(e.value.toString())},[e.value]);const f=e.id??t;return he.jsxs("div",{className:vv.container,children:[he.jsxs("div",{className:vv.container__input,children:[he.jsx("input",{id:e.id??f,placeholder:" ",required:e.required,className:e.error?vv.container__input_error:"",disabled:e.disabled,value:a,onChange:S=>{var O;const i=S.target.value;s(i),(O=e.onChange)==null||O.call(e,i)},maxLength:e.maxLength}),he.jsxs("label",{htmlFor:f,children:[e.label," ",e.required&&he.jsx("span",{className:vv.input__required,children:"*"})]})]}),e.error&&e.errorText&&he.jsx("p",{className:vv.container__error,children:e.errorText})]})}const Mge="_form_j1bg8_1",Oge="_form__description_j1bg8_12",p8={form:Mge,form__description:Oge},KF={visualNumber:""},JF=Me.createContext({form:KF,setForm:e=>{}});function Ige(){const{form:e,setForm:t,error:a}=Me.useContext(JF);return he.jsxs("div",{className:p8.form,children:[he.jsx("a",{className:p8.form__description,children:"Введите визуальный номер с одной из сторон вашей физической карты:"}),he.jsx(Cge,{label:"Номер карты",required:!0,value:e.visualNumber,onChange:s=>t({...e,visualNumber:s}),error:!!a,errorText:a})]})}const Pge=()=>{const{attachRfidCardFromApi:e}=nu(),[t,a]=Me.useState(!1);return{addRfidCard:async f=>(a(!0),e({visualCardNumber:f.visualNumber}).then(v=>v==null?void 0:v.message).finally(()=>a(!1))),loading:t}};function Rge(){const e=yo(),{showSnackbar:t}=Me.useContext(Va),{addRfidCard:a,loading:s}=Pge(),[f,v]=Me.useState(KF),[S,i]=Me.useState(),O=!!f.visualNumber.length,z=async()=>{const j=await a(f);j?i(j):(e(zv),t("success","Зарядная карта добавлена"))};return he.jsxs(Pd,{onReturn:()=>e(zv),title:"Добавление зарядной карты",className:d8.page,children:[he.jsx("div",{className:d8.page__content,children:he.jsx(JF.Provider,{value:{form:f,setForm:j=>{v(j),i(void 0)},error:S},children:he.jsx(Ige,{})})}),he.jsx(U4,{text:"Привязать карту",variant:"green",onClick:z,disabled:!O||!!S,loading:s})]})}function Dge(){return he.jsxs(BV,{children:[he.jsx(qu,{path:_5,element:he.jsx(SK,{})}),he.jsx(qu,{path:R8,element:he.jsx(NK,{})}),he.jsx(qu,{path:E1,element:he.jsx(pX,{})}),he.jsx(qu,{path:`${A1}:id`,element:he.jsx(UY,{})}),he.jsx(qu,{path:qp,element:he.jsx(dQ,{})}),he.jsx(qu,{path:`${Lb}:id`,element:he.jsx(t0e,{})}),he.jsx(qu,{path:L8,element:he.jsx(Z_e,{})}),he.jsx(qu,{path:zv,element:he.jsx(vge,{})}),he.jsx(qu,{path:D8,element:he.jsx(Rge,{})}),he.jsx(qu,{path:"*",element:he.jsx(R_e,{})})]})}const Lge="_snackbar_11h18_1",zge="_snackbar__content_11h18_11",kge="_content__icon_11h18_28",Bge="_content__text_11h18_34",Nge="_snackbar_success_11h18_42",Fge="_snackbar_warning_11h18_46",jge="_snackbar_error_11h18_50",xv={snackbar:Lge,snackbar__content:zge,content__icon:kge,content__text:Bge,snackbar_success:Nge,snackbar_warning:Fge,snackbar_error:jge};function Uge(e){const a=(()=>{switch(e.variant){case"success":return YF;case"warning":return V4;case"error":return H7;default:throw new Error("Snackbar variant does not exist")}})();return he.jsx("div",{className:xv.snackbar,children:he.jsxs("div",{className:`${xv.snackbar__content} ${xv[`snackbar_${e.variant}`]}`,children:[he.jsx("img",{src:a,alt:e.variant,className:xv.content__icon}),he.jsx("p",{className:xv.content__text,children:e.text})]})})}const Vge="_snackbarLayout_1q6vz_1",$ge="_visible_1q6vz_21",m8={snackbarLayout:Vge,visible:$ge};function qge(e){return he.jsx("div",{className:`${m8.snackbarLayout} ${e.isVisible?m8.visible:""}`,onClick:e.onClose,children:he.jsx(Uge,{variant:e.variant,text:e.text})})}function Gge(){const[e,t]=Me.useState({text:void 0,variant:void 0,isVisible:!1}),a=(v,S)=>{t({variant:v,text:S,isVisible:!1}),requestAnimationFrame(()=>{t(i=>({...i,isVisible:!0}))})},s=()=>{t(v=>({...v,isVisible:!1}))};Me.useEffect(()=>{if(e.isVisible){const v=setTimeout(()=>{s()},3e3);return()=>clearTimeout(v)}},[e.isVisible]),Me.useEffect(()=>{if(!e.isVisible&&e.text){const v=setTimeout(()=>{t({text:void 0,variant:void 0,isVisible:!1})},500);return()=>clearTimeout(v)}},[e.isVisible,e.text]);const f=e.text&&e.variant?he.jsx(qge,{variant:e.variant,text:e.text,isVisible:e.isVisible,onClose:s}):null;return{showSnackbar:a,snackbar:f}}function Hge(){const[e,t]=Me.useState(k8),{snackbar:a,showSnackbar:s}=Gge();return he.jsxs(Va.Provider,{value:{...e,setStationFilters:f=>t({...e,stationFilters:f}),setStations:f=>t({...e,stations:f,stationFilters:{...e.stationFilters,shouldUpdateStations:!1}}),setSessionFilters:f=>t({...e,sessionFilters:f}),setSessions:f=>t({...e,sessions:f,sessionFilters:{...e.sessionFilters,shouldUpdateSessions:!1}}),showSnackbar:s,setRfidCard:f=>t({...e,rfidCard:f}),setPaymentMethod:f=>t({...e,paymentMethod:f}),setPosition:f=>t({...e,position:f}),setMapViewState:f=>t({...e,mapViewState:f}),setLastStoppedChargingSessionId:f=>t({...e,lastStoppedChargingSessionId:f})},children:[a,he.jsx(Dge,{})]})}GU.createRoot(document.getElementById("root")).render(he.jsx(Me.StrictMode,{children:he.jsx(l$,{children:he.jsx(Hge,{})})}));
